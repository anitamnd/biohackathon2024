<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle report98741?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">F1000Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">F1000Res</journal-id>
    <journal-title-group>
      <journal-title>F1000Research</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2046-1402</issn>
    <publisher>
      <publisher-name>F1000 Research Limited</publisher-name>
      <publisher-loc>London, UK</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8406447</article-id>
    <article-id pub-id-type="pmid">34504687</article-id>
    <article-id pub-id-type="doi">10.12688/f1000research.53926.2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software Tool Article</subject>
      </subj-group>
      <subj-group>
        <subject>Articles</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PEGS: An efficient tool for gene set enrichment within defined sets of genomic intervals</article-title>
      <fn-group content-type="pub-status">
        <fn>
          <p>[version 2; peer review: 2 approved]</p>
        </fn>
      </fn-group>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Briggs</surname>
          <given-names>Peter</given-names>
        </name>
        <role content-type="http://credit.niso.org/">Data Curation</role>
        <role content-type="http://credit.niso.org/">Investigation</role>
        <role content-type="http://credit.niso.org/">Resources</role>
        <role content-type="http://credit.niso.org/">Software</role>
        <role content-type="http://credit.niso.org/">Visualization</role>
        <xref rid="a1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hunter</surname>
          <given-names>A. Louise</given-names>
        </name>
        <role content-type="http://credit.niso.org/">Data Curation</role>
        <role content-type="http://credit.niso.org/">Investigation</role>
        <role content-type="http://credit.niso.org/">Resources</role>
        <role content-type="http://credit.niso.org/">Validation</role>
        <role content-type="http://credit.niso.org/">Writing – Review &amp; Editing</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-3874-4852</contrib-id>
        <xref rid="a2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Shen-hsi</given-names>
        </name>
        <role content-type="http://credit.niso.org/">Resources</role>
        <role content-type="http://credit.niso.org/">Validation</role>
        <role content-type="http://credit.niso.org/">Writing – Review &amp; Editing</role>
        <xref rid="a3" ref-type="aff">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sharrocks</surname>
          <given-names>Andrew D.</given-names>
        </name>
        <role content-type="http://credit.niso.org/">Resources</role>
        <role content-type="http://credit.niso.org/">Supervision</role>
        <role content-type="http://credit.niso.org/">Validation</role>
        <role content-type="http://credit.niso.org/">Writing – Review &amp; Editing</role>
        <xref rid="a3" ref-type="aff">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Iqbal</surname>
          <given-names>Mudassar</given-names>
        </name>
        <role content-type="http://credit.niso.org/">Conceptualization</role>
        <role content-type="http://credit.niso.org/">Investigation</role>
        <role content-type="http://credit.niso.org/">Methodology</role>
        <role content-type="http://credit.niso.org/">Project Administration</role>
        <role content-type="http://credit.niso.org/">Software</role>
        <role content-type="http://credit.niso.org/">Supervision</role>
        <role content-type="http://credit.niso.org/">Writing – Original Draft Preparation</role>
        <role content-type="http://credit.niso.org/">Writing – Review &amp; Editing</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-5006-4331</contrib-id>
        <xref rid="c1" ref-type="corresp">a</xref>
        <xref rid="a4" ref-type="aff">4</xref>
      </contrib>
      <aff id="a1"><label>1</label>Bioinformatics Core Facility, Faculty of Biology, Medicine and Health, University of Manchester, Manchester, M13 9PL, UK</aff>
      <aff id="a2"><label>2</label>Division of Diabetes, Endocrinology &amp; Gastroenterology, Faculty of Biology, Medicine and Health, University of Manchester, Manchester, M13 9PL, UK</aff>
      <aff id="a3"><label>3</label>Division of Molecular &amp; Cellular Function, Faculty of Biology, Medicine and Health, University of Manchester, Manchester, M13 9PL, UK</aff>
      <aff id="a4"><label>4</label>Division of Informatics, Imaging &amp; Data Sciences, Faculty of Biology, Medicine and Health, University of Manchester, Manchester, M13 9PL, UK</aff>
    </contrib-group>
    <author-notes>
      <corresp id="c1">
        <label>a</label>
        <email xlink:href="mailto:mudassar.iqbal@manchester.ac.uk">mudassar.iqbal@manchester.ac.uk</email>
      </corresp>
      <fn fn-type="COI-statement">
        <p>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>11</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>10</volume>
    <elocation-id>ISCB Comm J-570</elocation-id>
    <history>
      <date date-type="accepted">
        <day>25</day>
        <month>10</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright: © 2021 Briggs P et al.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="f1000research-10-78711.pdf"/>
    <abstract>
      <p>Many biological studies of transcriptional control mechanisms produce lists of genes and non-coding genomic intervals from corresponding gene expression and epigenomic assays. In higher organisms, such as eukaryotes, genes may be regulated by distal elements, with these elements lying 10s–100s of kilobases away from a gene transcription start site. To gain insight into these distal regulatory mechanisms, it is important to determine comparative enrichment of genes of interest in relation to genomic regions of interest, and to be able to do so at a range of distances. Existing bioinformatics tools can annotate genomic regions to nearest known genes, or look for transcription factor binding sites in relation to gene transcription start sites. Here, we present PEGS (
<underline>P</underline>eak set
<underline>E</underline>nrichment in
<underline>G</underline>ene
<underline>S</underline>ets). This tool efficiently provides an exploratory analysis by calculating enrichment of multiple gene sets, associated with multiple non-coding elements (peak sets), at multiple genomic distances, and within topologically associated domains. We apply PEGS to gene sets derived from gene expression studies, and genomic intervals from corresponding ChIP-seq and ATAC-seq experiments to derive biologically meaningful results. We also demonstrate an extended application to tissue-specific gene sets and publicly available GWAS data, to find enrichment of sleep trait associated SNPs in relation to tissue-specific gene expression profiles.</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>Genomic data integration</kwd>
      <kwd>ChIP-seq</kwd>
      <kwd>RNA-seq</kwd>
      <kwd>gene set enrichment</kwd>
      <kwd>genomic intervals</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="fund-1" xlink:href="http://dx.doi.org/10.13039/501100000265">
        <funding-source>Medical Research Council (MRC)</funding-source>
        <award-id>(MR/M012174/1)</award-id>
      </award-group>
      <award-group id="fund-2" xlink:href="http://dx.doi.org/10.13039/100010269">
        <funding-source>Wellcome Trust</funding-source>
        <award-id>103857/Z/14/Z</award-id>
      </award-group>
      <award-group id="fund-3">
        <funding-source>Medical Research Council (MRC)</funding-source>
        <award-id>(MR/N021479/1)</award-id>
      </award-group>
      <funding-statement>MI was funded by the MRC (MR/M012174/1). ALH was funded by the MRC (MR/N021479/1). ADS and SHY were funded by the Wellcome Trust (103857/Z/14/Z)</funding-statement>
      <funding-statement>
        <italic toggle="yes">The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</italic>
      </funding-statement>
    </funding-group>
  </article-meta>
  <notes notes-type="version-changes">
    <sec sec-type="version-changes">
      <label>Revised</label>
      <title>Amendments from Version 1</title>
      <p>In this version, in response to reviewer’s feedback, we have made following changes: We have updated our software package to a newer version (0.6.3) with improved functionality in terms of command line options for input and output files. We have updated the documentation accordingly. We have also uploaded updated versions of all three figures and improved the text throughout the manuscript.</p>
    </sec>
  </notes>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Gene expression control in higher organisms is achieved through a complex hierarchical process involving opening of chromatin, histone modifications, and binding of transcription factors (TFs). Experimental approaches to understand transcriptional regulatory mechanisms in a biological context involve large-scale measurement of gene expression. Depending on the design of the experiment, these analyses produce differentially expressed gene sets or clusters for further analysis. These studies are often complemented by assays which map, on a genome-wide scale, TF binding sites (ChIP-seq) or regions of chromatin accessibility (DNase-seq, ATAC-seq). Analyses of these data produce a collection of genomic intervals (peak sets). An important computational task is then to integrate these data to produce meaningful results; i.e. to relate gene sets to peak sets to aid functional interpretation. Bearing in mind distal regulation, an important consideration here is to be able to calculate gene set enrichment at multiple genomic distances from peak sets, and to be able to do this efficiently within the same analysis.</p>
    <p>We present a new tool – PEGS (
<underline>P</underline>eak set
<underline>E</underline>nrichment in
<underline>G</underline>ene
<underline>S</underline>ets)
<sup><xref rid="ref-1" ref-type="bibr">1</xref></sup> – which calculates mutual enrichment of multiple gene sets associated with multiple peak sets, simultaneously and efficiently. This can be at user-defined peak-to-TSS (transcription start site) distances, as well as constraining to topologically associated domains (TADs). Thus, PEGS quickly produces an overall picture of gene set enrichment in relation to peaks, and shows at what genomic distances this is most pronounced. It is applicable to gene sets derived from any source, and peak sets derived from different epigenomic assays, as well as single nucleotide polymorphisms (SNPs) from genome-wide association studies (GWAS).</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Architecture and implementation</title>
      <p>In PEGS, input peaks are extended in both directions using user-provided genomic distances or constrained within known TAD boundaries, if provided (
<xref rid="f1" ref-type="fig">Figure 1</xref>). Subsequently, the enrichment of the input gene set is calculated among the genes whose TSSs overlap with the extended peaks, separately for each genomic distance and/or TADs. These tasks are performed in PEGS as follows:</p>
      <list list-type="simple">
        <list-item>
          <label>1.</label>
          <p>Creating a gene interval file in BED (Browser Extensible Data) format for all TSSs in the given genome using
<italic toggle="yes">refGene</italic> from UCSC Table Browser. This reference TSSs BED file only needs to be created once (human hg38 and mouse mm10 are provided with the tool; a utility is provided to create these for other genomes).</p>
        </list-item>
        <list-item>
          <label>2.</label>
          <p>For a given peak set, peaks are extended to a specified genomic distance in both directions (and up to overlapping TAD boundaries, if provided). Intersection of these extended peaks with the gene intervals BED file from step 1 is calculated using BEDTools (RRID:SCR_006646)
<sup><xref rid="ref-2" ref-type="bibr">2</xref></sup>. This leads to a gene set with TSSs overlapping with extended peaks.</p>
        </list-item>
        <list-item>
          <label>3.</label>
          <p>Using the intersection of the input gene set, and unique genes from step 2 (thus removing genes with multiple TSSs), a Hypergeometric test is performed to calculate the p-value using
<xref rid="e1" ref-type="disp-formula">Equation 1</xref>, similar to GREAT (RRID:SCR_00580)
<sup><xref rid="ref-3" ref-type="bibr">3</xref></sup>. Here,
<italic toggle="yes">M</italic> is the total number of genes in the genome,
<italic toggle="yes">N</italic>
<sub>c</sub> is the number of genes in the input cluster/set
<italic toggle="yes">c</italic>,
<italic toggle="yes">N</italic>
<sub>p</sub> is the number of unique genes overlapping the peaks for given distance and
<italic toggle="yes">n
<sub>pc</sub>
</italic> is the intersection of two gene sets.</p>
        </list-item>
      </list>
      <fig position="float" fig-type="figure" id="f1">
        <label>Figure 1. </label>
        <caption>
          <p>Cartoon showing peak expansion and overlapping TSSs in PEGS, with a specified genomic distance
<italic toggle="yes">λ</italic> from the centre of the peak in both directions (
<bold>a</bold>) where
<italic toggle="yes">TSS</italic>
<sub>2</sub> and
<italic toggle="yes">TSS</italic>
<sub>3</sub> are included, and a TAD overlapping with the left peak in (
<bold>b</bold>) where all four TSSs within the TAD are included</p>
        </caption>
        <graphic xlink:href="f1000research-10-78711-g0000" position="float"/>
      </fig>
      <p>
        <disp-formula id="e1">
          <mml:math id="math" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mi>p</mml:mi>
              <mml:mtext> </mml:mtext>
              <mml:mo>−</mml:mo>
              <mml:mtext> </mml:mtext>
              <mml:mi>v</mml:mi>
              <mml:mi>a</mml:mi>
              <mml:mi>l</mml:mi>
              <mml:mi>u</mml:mi>
              <mml:mi>e</mml:mi>
              <mml:mtext> </mml:mtext>
              <mml:mo>=</mml:mo>
              <mml:mtext> </mml:mtext>
              <mml:mstyle displaystyle="true">
                <mml:munderover>
                  <mml:mo>∑</mml:mo>
                  <mml:mrow>
                    <mml:mi>x</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:msub>
                      <mml:mi>n</mml:mi>
                      <mml:mrow>
                        <mml:mi>p</mml:mi>
                        <mml:mi>c</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>min</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msub>
                      <mml:mi>N</mml:mi>
                      <mml:mi>p</mml:mi>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mi>N</mml:mi>
                      <mml:mi>c</mml:mi>
                    </mml:msub>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:munderover>
                <mml:mrow>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mtable>
                            <mml:mtr>
                              <mml:mtd>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mi>N</mml:mi>
                                    <mml:mi>c</mml:mi>
                                  </mml:msub>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                            <mml:mtr>
                              <mml:mtd>
                                <mml:mi>x</mml:mi>
                              </mml:mtd>
                            </mml:mtr>
                          </mml:mtable>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mtext> </mml:mtext>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mtable>
                            <mml:mtr>
                              <mml:mtd>
                                <mml:mrow>
                                  <mml:mo stretchy="false">(</mml:mo>
                                  <mml:mi>M</mml:mi>
                                  <mml:mo>−</mml:mo>
                                  <mml:msub>
                                    <mml:mi>N</mml:mi>
                                    <mml:mi>p</mml:mi>
                                  </mml:msub>
                                  <mml:mo stretchy="false">)</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                            <mml:mtr>
                              <mml:mtd>
                                <mml:mrow>
                                  <mml:mo stretchy="false">(</mml:mo>
                                  <mml:msub>
                                    <mml:mi>N</mml:mi>
                                    <mml:mi>c</mml:mi>
                                  </mml:msub>
                                  <mml:mo>−</mml:mo>
                                  <mml:mi>x</mml:mi>
                                  <mml:mo stretchy="false">)</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                          </mml:mtable>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mtable>
                            <mml:mtr>
                              <mml:mtd>
                                <mml:mi>M</mml:mi>
                              </mml:mtd>
                            </mml:mtr>
                            <mml:mtr>
                              <mml:mtd>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mi>N</mml:mi>
                                    <mml:mi>c</mml:mi>
                                  </mml:msub>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                          </mml:mtable>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mrow>
              </mml:mstyle>
              <mml:mspace width="12em"/>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mn>1</mml:mn>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>Step 2 and 3 are repeated for every combination of gene cluster, peak set and genomic distance and/or TADs. The final combined heatmap shows −
<italic toggle="yes">log</italic>
<sub>10</sub> of the resulting p-values.</p>
      <p>PEGS is implemented in Python 3, where we have reused functions from existing Python packages included with Python distributions, or available from the Python Package Index (PyPI). We also make use of BEDTools
<sup><xref rid="ref-2" ref-type="bibr">2</xref></sup> for working with genomic intervals. We provide online documentation (
<ext-link xlink:href="https://pegs.readthedocs.io/en/latest/" ext-link-type="uri">https://pegs.readthedocs.io/en/latest/</ext-link>), and an example analysis with input data at the
<ext-link xlink:href="https://github.com/fls-bioinformatics-core/pegs" ext-link-type="uri">PEGS GitHub repository</ext-link>. </p>
    </sec>
    <sec>
      <title>Operation</title>
      <p>PEGS works with Python &gt;= 3.6 and, when installed through pip, automatically installs all the dependencies. These are listed in
<italic toggle="yes">requirements.txt</italic> file in our
<ext-link xlink:href="https://github.com/fls-bioinformatics-core/pegs" ext-link-type="uri">PEGS GitHub repository</ext-link>. We provide extensive documentation online at
<ext-link xlink:href="https://pegs.readthedocs.io/en/latest/" ext-link-type="uri">https://pegs.readthedocs.io</ext-link> which includes easy-to-follow instructions about:</p>
      <list list-type="bullet">
        <list-item>
          <p>Installation and system requirements</p>
        </list-item>
        <list-item>
          <p>Format of input files, output files, and graphics</p>
        </list-item>
        <list-item>
          <p>PEGS commands for standard operations, as well as running PEGS with additional input options, e.g. TAD definition files</p>
        </list-item>
        <list-item>
          <p>Creating customised reference TSSs files for new genomes</p>
        </list-item>
      </list>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <sec>
      <title>Use cases</title>
      <p>Here, we present three use cases where we apply PEGS to different publicly available data sets. The format of input files is the same for all use cases below. Gene clusters are provided as text files with one gene symbol on each line; genomic region coordinates are provided in standard BED format. These input files for Use Case 1, as well as example analysis reproducing
<xref rid="f2" ref-type="fig">Figure 2A</xref>, are provided in our GitHub repository (
<ext-link xlink:href="https://github.com/fls-bioinformatics-core/pegs" ext-link-type="uri">https://github.com/fls-bioinformatics-core/pegs</ext-link>). </p>
      <fig position="float" fig-type="figure" id="f2">
        <label>Figure 2. </label>
        <caption>
          <p>PEGS applications: (
<bold>A</bold>) gene expression, ChIP-seq and DNase I data on mouse liver; upper two panels correspond to GR ChIP-seq and DNase peaks expanded to different genomic distances while the bottom panel shows both GR ChIP-seq and DNase peaks expanded to overlapping TAD boundaries (
<bold>B</bold>) gene clusters derived from scRNA-seq and intergenic putative enhancer clusters from bulk ATAC-seq from three matching early stem cell differentiation time-points. In both plots, numbers in the cells show common genes among the input genes (x-axis) and genes overlapping with expanded peaks (y-axis) and the colour shows −
<italic toggle="yes">log</italic>
<sub>10</sub> of p-value (Hypergeometric test).</p>
        </caption>
        <graphic xlink:href="f1000research-10-78711-g0001" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>Use case 1: Application of PEGS provides insight into glucocorticoid-mediated gene regulation in mouse liver</title>
      <p>The first application (
<xref rid="f2" ref-type="fig">Figure 2A</xref>) uses the gene sets consisting of putative targets of glucocorticoid receptor (GR) in mouse liver. These are up- and down-regulated genes obtained by an RNA-seq study of liver samples from mice treated acutely with synthetic glucocorticoid dexamethasone or vehicle
<sup><xref rid="ref-4" ref-type="bibr">4</xref></sup>. Corresponding GR ChIP-seq and chromatin accessibility data (DNase I hypersensitive (DHS) regions) were obtained from
<xref rid="ref-5" ref-type="bibr">5</xref>, and
<xref rid="ref-6" ref-type="bibr">6</xref> respectively, whilst the mouse liver TAD boundaries were obtained from
<xref rid="ref-7" ref-type="bibr">7</xref>. Raw published datasets were downloaded from GEO Sequence Read Archive (RRID:SCR_005012) using
<italic toggle="yes">sratoolkit</italic> v2.9.2 (
<ext-link xlink:href="http://ncbi.github.io/sra-tools/" ext-link-type="uri">http://ncbi.github.io/sra-tools/</ext-link>). Reads were aligned to the reference genome (mouse
<italic toggle="yes">mm10</italic>), sorted and indexed using
<italic toggle="yes">Bowtie2</italic> (v2.3.4.3, RRID:SCR_005476,
<sup><xref rid="ref-8" ref-type="bibr">8</xref></sup>) and SAMtools (v1.9, RRID:SCR_002105,
<sup><xref rid="ref-9" ref-type="bibr">9</xref></sup>). MACS2 (v2.1.1.20160309, RRID:SCR_013291,
<sup><xref rid="ref-10" ref-type="bibr">10</xref></sup>) was used to call peaks, using default settings. Using these GR ChIP-seq peaks and DHSs as peak sets, PEGS analysis shows strong association of dexamethasone up-regulated genes with dexamethasone-induced GR peaks at distances up to 500kbp from these peaks, but no enrichment of down-regulated genes (
<xref rid="f2" ref-type="fig">Figure 2A</xref>, top panel), indicating distinct mechanisms of gene activation and repression by glucocorticoids. At the same time, there is promoter proximal enrichment for both up- and down-regulated genes in the DHS regions (
<xref rid="f2" ref-type="fig">Figure 2A</xref>, middle panel). On the other hand, PEGS analysis using TADs boundaries (
<xref rid="f2" ref-type="fig">Figure 2A</xref>, bottom panel) shows significant enrichment only in the case of up-regulated genes in GR ChIP-seq. This is suggestive of a direct role for GR in gene activation rather than repression.</p>
    </sec>
    <sec>
      <title>Use case 2: PEGS demonstrates association of differential chromatin accessibility and gene expression during embryonic stem cell differentiation</title>
      <p>Next, using PEGS, we calculated enrichment of gene clusters derived from single-cell RNA-seq and open chromatin regions defined by bulk ATAC-seq at three matching time points (ESCs- embryonic stem cells, day1 EpiLCs - epiblast-like cells, day2 EpiLCs) during early embryonic stem cell differentiation
<sup><xref rid="ref-11" ref-type="bibr">11</xref></sup>. Early embryonic development (naïve mouse ESCs to EpiLCs) involves large changes in the chromatin landscape through the action of many transcription factors and chromatin regulators leading to specific gene expression programs. Using our publicly available data
<sup><xref rid="ref-11" ref-type="bibr">11</xref></sup>, we defined our open chromatin peak sets as the intergenic regions with differential accessibility between any two time points. These were clustered into four profiles based on z-score of tag densities, as described in
<xref rid="ref-11" ref-type="bibr">11</xref>. Similarly, differentially expressed genes were identified from pseudo-bulk gene expression data at each time point, and were similarly clustered into four patterns across three time points. These constituted our gene sets for PEGS analysis. As shown in
<xref rid="f2" ref-type="fig">Figure 2B</xref>, application of PEGS to these data shows strong association between the matching gene expression (x-axis) and chromatin opening profiles (y-axis) at intergenic enhancers, reflecting correspondence between differential accessibility and gene expression changes at corresponding time points. This application shows the utility of PEGS for integrating chromatin accessibility and gene expression data, leading to biologically meaningful association of enhancer and gene clusters.</p>
    </sec>
    <sec>
      <title>Use case 3: Extended application: PEGS detects enrichment of sleep trait SNPs in tissue-specific genes</title>
      <p>Genome-wide association studies (GWAS) are commonly employed to study genotype-disease associations. Here, we present an extended application of PEGS to GWAS data and find associations of SNPs for different sleep phenotypes with sets of tissue-specific genes from the Genotype-Tissue Expression (
<ext-link xlink:href="https://www.gtexportal.org/home/" ext-link-type="uri">GTEx</ext-link>) Portal, RRID:SCR_013042). For this purpose, we downloaded GWAS data from the
<ext-link xlink:href="https://sleep.hugeamp.org/" ext-link-type="uri">Sleep Disorder Knowledge Portal</ext-link> (RRID:SCR_016611) which provides data, as well as analysis and visualisation resources for human genetic information regarding sleep and related traits. We extracted SNPs (single nucleotide polymorphisms) for certain sleep associated phenotypes (with genome wide p-value cutoff &lt;=5
<italic toggle="yes">e</italic> − 8). These SNPs constitute our input peak sets to PEGS, while we defined corresponding gene sets as tissue-specific genes from GTEx portal. These were created as following; we obtained median transcripts per million (TPM) data for different tissues in GTEx, and a gene list for a specific tissue was defined as genes with greater than 5x median TPM compared to the average in the remaining tissues.</p>
      <p>In
<xref rid="f3" ref-type="fig">Figure 3</xref>, using PEGS, we show enrichment of SNPs from three sleep related phenotypes, namely chronotype, daytime sleepiness adjusted for BMI, and sleep duration. These enrichments are calculated for tissue-specific genes lists created from GTEx for 22 tissues, the majority of them from the brain. Application of PEGS to these data reveals some strong associations, e.g. chronotype SNPs strongly enriched for genes expressed in liver and blood, while daytime sleepiness SNPs are enriched in gene sets for different brain tissues. Some of these associations are reported in the literature, e.g. daytime sleepiness SNPs in brain tissue
<sup><xref rid="ref-12" ref-type="bibr">12</xref></sup>, others may warrant further investigation.</p>
      <fig position="float" fig-type="figure" id="f3">
        <label>Figure 3. </label>
        <caption>
          <title>Enrichment of sleep traits SNPs in tissue-specific gene lists (GTEx).</title>
          <p>The x-axis shows different tissue-specific gene lists, and y-axis shows three sets of sleep related SNPs, expanded to multiple genomic distances. The colour of the cells show −
<italic toggle="yes">log</italic>
<sub>10</sub> of p-value of enrichment of corresponding gene list (x-axis) in the genes identified through overlap with expanded SNP intervals, the numbers in the cells show the common genes among the two (used in the calculation of Hypergeometric p-value)</p>
        </caption>
        <graphic xlink:href="f1000research-10-78711-g0002" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p>Through the three different applications above, we demonstrate that PEGS is a versatile and highly efficient tool to integrate different genomic data, and is able to generate hypotheses for further analysis. The implementation of PEGS is highly efficient and as an example of computational efficiency, with pre-created reference TSS files, it only took 7.6 seconds to produce the output for
<xref rid="f2" ref-type="fig">Figure 2A</xref> on a laptop with Intel(R) Core(TM) i5-7200U CPU @ 2.50GHz processor with 16GB RAM.</p>
    <p>Furthermore, the user can adjust the background population and control for bias. For example, depending on the scientific question at hand, the background population could be limited to include only those genes known to be expressed in the tissue of interest. The efficiency of PEGS allows multiple gene and peak input files (e.g. with varying false discovery rate or fold-change cut-offs) to be tested quickly.</p>
    <p>PEGS analysis is limited to enhancer-genes associations based on genomic proximity. It builds on some aspects of, and is complementary to, GREAT
<sup><xref rid="ref-3" ref-type="bibr">3</xref></sup>, an existing tool, which performs functional enrichment of regulatory regions using annotations of nearby genes. PEGS could also be used in conjunction with other tools to gain further mechanistic understanding (e.g. by finding enriched transcription factors with TFEA.ChIP
<sup><xref rid="ref-13" ref-type="bibr">13</xref></sup>, ranking of their target genes with Cistrome-GO
<sup><xref rid="ref-14" ref-type="bibr">14</xref></sup> or BETA
<sup><xref rid="ref-15" ref-type="bibr">15</xref></sup>, or predicting which TFs might regulate differentially expressed gene sets with Lisa
<sup><xref rid="ref-16" ref-type="bibr">16</xref></sup>).</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>All data underlying the results are available as part of the article or available publicly.</p>
  </sec>
  <sec>
    <title>Software availability</title>
    <p>Software is available from Zenodo:
<ext-link xlink:href="https://doi.org/10.5281/zenodo.5596224" ext-link-type="uri">https://doi.org/10.5281/zenodo.5596224</ext-link>
<sup><xref rid="ref-1" ref-type="bibr">1</xref></sup>. It is easily installable through the Python Package Index (PyPI).</p>
    <p>Source code available from Github:
<ext-link xlink:href="https://github.com/fls-bioinformatics-core/pegs" ext-link-type="uri">https://github.com/fls-bioinformatics-core/pegs</ext-link>.</p>
    <p>Archived source code at the time of publication:
<ext-link xlink:href="https://doi.org/10.5281/zenodo.5596224" ext-link-type="uri">https://doi.org/10.5281/zenodo.5596224</ext-link>
<sup><xref rid="ref-1" ref-type="bibr">1</xref></sup>
</p>
    <p>License: PEGS is distributed under BSD 3-Clause license.</p>
    <p>Online manual:
<ext-link xlink:href="https://pegs.readthedocs.io/en/latest/" ext-link-type="uri">https://pegs.readthedocs.io</ext-link>
</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thankfully acknowledge useful discussions with Magnus Rattray and Leo Zeef.</p>
  </ack>
  <ref-list>
    <ref id="ref-1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Briggs</surname><given-names>P</given-names></name><name><surname>mudassariqbal</surname></name></person-group>:
<article-title>fls-bioinformatics-core/pegs: pegs-0.6.3 (0.6.3).</article-title><source><italic toggle="yes">Zenodo.</italic></source><year>2021</year>.
<pub-id pub-id-type="doi">10.5281/zenodo.5596224</pub-id></mixed-citation>
    </ref>
    <ref id="ref-2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quinlan</surname><given-names>AR</given-names></name><name><surname>Hall</surname><given-names>IM</given-names></name></person-group>:
<article-title>BEDTools: A flexible suite of utilities for comparing genomic features.</article-title><source><italic toggle="yes">Bioinformatics.</italic></source><year>2010</year>;<volume>26</volume>(<issue>6</issue>):<fpage>841</fpage>–<lpage>842</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btq033</pub-id><!--<pub-id pub-id-type="pmcid">2832824</pub-id>--><?supplied-pmid 20110278?><pub-id pub-id-type="pmid">20110278</pub-id></mixed-citation>
    </ref>
    <ref id="ref-3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McLean</surname><given-names>CY</given-names></name><name><surname>Bristor</surname><given-names>D</given-names></name><name><surname>Hiller</surname><given-names>M</given-names></name><etal/></person-group>:
<article-title>GREAT improves functional interpretation of cis-regulatory regions.</article-title><source><italic toggle="yes">Nat Biotechnol.</italic></source><year>2010</year>;<volume>28</volume>(<issue>5</issue>):<fpage>495</fpage>–<lpage>501</lpage>.
<pub-id pub-id-type="doi">10.1038/nbt.1630</pub-id><!--<pub-id pub-id-type="pmcid">4840234</pub-id>--><?supplied-pmid 20436461?><pub-id pub-id-type="pmid">20436461</pub-id></mixed-citation>
    </ref>
    <ref id="ref-4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Caratti</surname><given-names>G</given-names></name><name><surname>Iqbal</surname><given-names>M</given-names></name><name><surname>Hunter</surname><given-names>L</given-names></name><etal/></person-group>:
<article-title>REVERBa couples the circadian clock to hepatic glucocorticoid action.</article-title><source><italic toggle="yes">J Clin Invest.</italic></source><year>2018</year>;<volume>128</volume>(<issue>10</issue>):<fpage>4454</fpage>–<lpage>4471</lpage>.
<pub-id pub-id-type="doi">10.1172/JCI96138</pub-id><!--<pub-id pub-id-type="pmcid">6160001</pub-id>--><?supplied-pmid 30179226?><pub-id pub-id-type="pmid">30179226</pub-id></mixed-citation>
    </ref>
    <ref id="ref-5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grøntved</surname><given-names>L</given-names></name><name><surname>John</surname><given-names>S</given-names></name><name><surname>Baek</surname><given-names>S</given-names></name><etal/></person-group>:
<article-title>C/EBP maintains chromatin accessibility in liver and facilitates glucocorticoid receptor recruitment to steroid response elements.</article-title><source><italic toggle="yes">EMBO J.</italic></source><year>2013</year>;<volume>32</volume>(<issue>11</issue>):<fpage>1568</fpage>–<lpage>1583</lpage>.
<pub-id pub-id-type="doi">10.1038/emboj.2013.106</pub-id><!--<pub-id pub-id-type="pmcid">3671252</pub-id>--><?supplied-pmid 23665916?><pub-id pub-id-type="pmid">23665916</pub-id></mixed-citation>
    </ref>
    <ref id="ref-6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sobel</surname><given-names>JA</given-names></name><name><surname>Krier</surname><given-names>I</given-names></name><name><surname>Andersin</surname><given-names>T</given-names></name><etal/></person-group>:
<article-title>Transcriptional regulatory logic of the diurnal cycle in the mouse liver.</article-title><source><italic toggle="yes">PLoS Biol.</italic></source><year>2017</year>;<volume>15</volume>(<issue>4</issue>):<fpage>e2001069</fpage>.
<pub-id pub-id-type="doi">10.1371/journal.pbio.2001069</pub-id><!--<pub-id pub-id-type="pmcid">5393560</pub-id>--><?supplied-pmid 28414715?><pub-id pub-id-type="pmid">28414715</pub-id></mixed-citation>
    </ref>
    <ref id="ref-7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>YH</given-names></name><name><surname>Marhon</surname><given-names>SA</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><etal/></person-group>:
<article-title>Rev-erbα dynamically modulates chromatin looping to control circadian gene transcription.</article-title><source><italic toggle="yes">Science.</italic></source><year>2018</year>;<volume>359</volume>(<issue>6381</issue>):<fpage>1274</fpage>–<lpage>1277</lpage>.
<pub-id pub-id-type="doi">10.1126/science.aao6891</pub-id><!--<pub-id pub-id-type="pmcid">5995144</pub-id>--><?supplied-pmid 29439026?><pub-id pub-id-type="pmid">29439026</pub-id></mixed-citation>
    </ref>
    <ref id="ref-8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langmead</surname><given-names>B</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name></person-group>:
<article-title>Fast gapped-read alignment with bowtie 2.</article-title><source><italic toggle="yes">Nat Methods.</italic></source><year>2012</year>;<volume>9</volume>(<issue>4</issue>):<fpage>357</fpage>–<lpage>9</lpage>.
<pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id><!--<pub-id pub-id-type="pmcid">3322381</pub-id>--><?supplied-pmid 22388286?><pub-id pub-id-type="pmid">22388286</pub-id></mixed-citation>
    </ref>
    <ref id="ref-9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Handsaker</surname><given-names>B</given-names></name><name><surname>Wysoker</surname><given-names>A</given-names></name><etal/></person-group>:
<article-title>The Sequence Alignment/Map format and SAMtools.</article-title><source><italic toggle="yes">Bioinformatics.</italic></source><year>2009</year>;<volume>25</volume>(<issue>16</issue>):<fpage>2078</fpage>–<lpage>9</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id><!--<pub-id pub-id-type="pmcid">2723002</pub-id>--><?supplied-pmid 19505943?><pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="ref-10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Liu</surname><given-names>T</given-names></name><name><surname>Meyer</surname><given-names>CA</given-names></name><etal/></person-group>:
<article-title>Model-based analysis of chip-seq (macs).</article-title><source><italic toggle="yes">Genome Biol.</italic></source><year>2008</year>;<volume>9</volume>(<issue>9</issue>):<fpage>R137</fpage>.
<pub-id pub-id-type="doi">10.1186/gb-2008-9-9-r137</pub-id><!--<pub-id pub-id-type="pmcid">2592715</pub-id>--><?supplied-pmid 18798982?><pub-id pub-id-type="pmid">18798982</pub-id></mixed-citation>
    </ref>
    <ref id="ref-11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>SH</given-names></name><name><surname>Andrabi</surname><given-names>M</given-names></name><name><surname>Biss</surname><given-names>R</given-names></name><etal/></person-group>:
<article-title>ZIC3 Controls the Transition from Naive to Primed Pluripotency.</article-title><source><italic toggle="yes">Cell Rep.</italic></source><year>2019</year>;<volume>27</volume>(<issue>11</issue>):<fpage>3215</fpage>–<lpage>3227.e6</lpage>.
<pub-id pub-id-type="doi">10.1016/j.celrep.2019.05.026</pub-id><!--<pub-id pub-id-type="pmcid">6581693</pub-id>--><?supplied-pmid 31189106?><pub-id pub-id-type="pmid">31189106</pub-id></mixed-citation>
    </ref>
    <ref id="ref-12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>H</given-names></name><name><surname>Lane</surname><given-names>JM</given-names></name><name><surname>Jones</surname><given-names>SE</given-names></name><etal/></person-group>:
<article-title>Genome-wide association analysis of self-reported daytime sleepiness identifies 42 loci that suggest biological subtypes.</article-title><source><italic toggle="yes">Nat Commun.</italic></source><year>2019</year>;<volume>10</volume>(<issue>1</issue>):<fpage>3503</fpage>.
<pub-id pub-id-type="doi">10.1038/s41467-019-11456-7</pub-id><!--<pub-id pub-id-type="pmcid">6692391</pub-id>--><?supplied-pmid 31409809?><pub-id pub-id-type="pmid">31409809</pub-id></mixed-citation>
    </ref>
    <ref id="ref-13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Puente-Santamaria</surname><given-names>L</given-names></name><name><surname>Wasserman</surname><given-names>WW</given-names></name><name><surname>Del Peso</surname><given-names>L</given-names></name></person-group>:
<article-title>TFEA.ChIP: A tool kit for transcription factor binding site enrichment analysis capitalizing on ChIP-seq datasets.</article-title><source><italic toggle="yes">Bioinformatics.</italic></source><year>2019</year>;<volume>35</volume>(<issue>24</issue>):<fpage>5339</fpage>–<lpage>5340</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btz573</pub-id><?supplied-pmid 31347689?><pub-id pub-id-type="pmid">31347689</pub-id></mixed-citation>
    </ref>
    <ref id="ref-14">
      <label>14</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>S</given-names></name><name><surname>Wan</surname><given-names>C</given-names></name><name><surname>Zheng</surname><given-names>R</given-names></name><etal/></person-group>:
<article-title>Cistrome-GO: A web server for functional enrichment analysis of transcription factor ChIP-seq peaks.</article-title><source><italic toggle="yes">Nucleic Acids Res.</italic></source><year>2019</year>;<volume>47</volume>(<issue>W1</issue>):<fpage>W206</fpage>–<lpage>W211</lpage>.
<pub-id pub-id-type="doi">10.1093/nar/gkz332</pub-id><!--<pub-id pub-id-type="pmcid">6602521</pub-id>--><?supplied-pmid 31053864?><pub-id pub-id-type="pmid">31053864</pub-id></mixed-citation>
    </ref>
    <ref id="ref-15">
      <label>15</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>S</given-names></name><name><surname>Sun</surname><given-names>H</given-names></name><name><surname>Ma</surname><given-names>J</given-names></name><etal/></person-group>:
<article-title>Target analysis by integration of transcriptome and ChIP-seq data with BETA.</article-title><source><italic toggle="yes">Nat Protoc.</italic></source><year>2013</year>;<volume>8</volume>(<issue>12</issue>):<fpage>2502</fpage>–<lpage>2515</lpage>.
<pub-id pub-id-type="doi">10.1038/nprot.2013.150</pub-id><!--<pub-id pub-id-type="pmcid">4135175</pub-id>--><?supplied-pmid 24263090?><pub-id pub-id-type="pmid">24263090</pub-id></mixed-citation>
    </ref>
    <ref id="ref-16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qin</surname><given-names>Q</given-names></name><name><surname>Fan</surname><given-names>J</given-names></name><name><surname>Zheng</surname><given-names>R</given-names></name><etal/></person-group>:
<article-title>Lisa: inferring transcriptional regulators through integrative modeling of public chromatin accessibility and ChIP-seq data.</article-title><source><italic toggle="yes">Genome Biol.</italic></source><year>2020</year>;<volume>21</volume>(<issue>1</issue>):<fpage>32</fpage>.
<pub-id pub-id-type="doi">10.1186/s13059-020-1934-6</pub-id><!--<pub-id pub-id-type="pmcid">7007693</pub-id>--><?supplied-pmid 32033573?><pub-id pub-id-type="pmid">32033573</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="peer-review" id="report98741">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.78711.r98741</article-id>
    <title-group>
      <article-title>Reviewer response for version 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Khan</surname>
          <given-names>Aziz</given-names>
        </name>
        <xref rid="r98741a1" ref-type="aff">1</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-6459-6224</contrib-id>
      </contrib>
      <aff id="r98741a1"><label>1</label>Stanford Cancer Institute, Stanford University, Stanford, CA, USA</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>25</day>
      <month>2</month>
      <year>2022</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2022 Khan A</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" ext-link-type="doi" id="relatedArticleReport98741" xlink:href="10.12688/f1000research.53926.2">Version 2</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>The authors addressed all of my concerns/suggestions in the revised version.</p>
    <p>Are the conclusions about the tool and its performance adequately supported by the findings presented in the article?</p>
    <p>Yes</p>
    <p>Is the rationale for developing the new software tool clearly explained?</p>
    <p>Yes</p>
    <p>Is the description of the software tool technically sound?</p>
    <p>Yes</p>
    <p>Are sufficient details of the code, methods and analysis (if applicable) provided to allow replication of the software development and its use by others?</p>
    <p>Yes</p>
    <p>Is sufficient information provided to allow interpretation of the expected output datasets and any results generated using the tool?</p>
    <p>Yes</p>
    <p>Reviewer Expertise:</p>
    <p>bioinformatics, gene regulation, regulatory genomics, epigenomics</p>
    <p>I confirm that I have read this submission and believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
</sub-article>
<sub-article article-type="peer-review" id="report98740">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.78711.r98740</article-id>
    <title-group>
      <article-title>Reviewer response for version 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zabet</surname>
          <given-names>Nicolae Radu</given-names>
        </name>
        <xref rid="r98740a1" ref-type="aff">1</xref>
        <role>Referee</role>
      </contrib>
      <aff id="r98740a1"><label>1</label>Blizard Institute, Barts and The London School of Medicine and Dentistry, Queen Mary University of London, London, E1 2AT, UK</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>11</month>
      <year>2021</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2021 Zabet NR</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" ext-link-type="doi" id="relatedArticleReport98740" xlink:href="10.12688/f1000research.53926.2">Version 2</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>The authors have addressed all my comments.</p>
    <p>Are the conclusions about the tool and its performance adequately supported by the findings presented in the article?</p>
    <p>Yes</p>
    <p>Is the rationale for developing the new software tool clearly explained?</p>
    <p>Yes</p>
    <p>Is the description of the software tool technically sound?</p>
    <p>Yes</p>
    <p>Are sufficient details of the code, methods and analysis (if applicable) provided to allow replication of the software development and its use by others?</p>
    <p>Yes</p>
    <p>Is sufficient information provided to allow interpretation of the expected output datasets and any results generated using the tool?</p>
    <p>Yes</p>
    <p>Reviewer Expertise:</p>
    <p>Computational biology, bioinformatics, chromatin and epigenetics</p>
    <p>I confirm that I have read this submission and believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
</sub-article>
<sub-article article-type="peer-review" id="report89907">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.57359.r89907</article-id>
    <title-group>
      <article-title>Reviewer response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Khan</surname>
          <given-names>Aziz</given-names>
        </name>
        <xref rid="r89907a1" ref-type="aff">1</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-6459-6224</contrib-id>
      </contrib>
      <aff id="r89907a1"><label>1</label>Stanford Cancer Institute, Stanford University, Stanford, CA, USA</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>26</day>
      <month>8</month>
      <year>2021</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2021 Khan A</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" ext-link-type="doi" id="relatedArticleReport89907" xlink:href="10.12688/f1000research.53926.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>In this paper, the authors presented a Python-based command-line tool, PEGS, for gene set enrichment in association with genomic regions. PEGS computes the enrichment of gene sets with proximity-based association with genomic region sets. These associations are further restricted within the Topologically Associated Domains (TADs), which is good. The manuscript is moderately written and it provides three use cases of the tool.</p>
    <p> The tool itself is very useful but it lacks several key options to give users the flexibility to customize the input data and also the output heatmap.</p>
    <p> I have the following comments for the authors to address:
<list list-type="order"><list-item><p>It is useful to restrict peak-gene association within the TAD boundaries, but it is not the case that all the interactions, such as enhancer-gene interactions occur within the TAD boundaries. The enhancer–gene communication can also occur outside topological domains or in-between TADs. Do authors plan to provide an optional feature to integrate chromatin interaction data, such as HI-C?</p></list-item><list-item><p>The command-line tool can be further improved by providing additional options to improve user experience and its usage. Below are some recommendations.
<list list-type="bullet"><list-item><p>Currently, the peaks sets and gene lists inputs arguments are positional and the tools can only scan files available in the provided folders. Instead of looking into provided folders for BEDs files and gene lists, the argument should also allow chaining a list of bed files with a path. This is because in real analysis scenarios BEDs can be spread across multiple folders or a single folder can have other visible/hidden files. For example, I was testing the tool on a Mac machine, and PEGS started processing peaks for 
<italic toggle="yes">.DS_Store</italic>, which is the default directory structure and a hidden file. </p></list-item><list-item><p>The tool arguments could be:
<italic toggle="yes">pegs --peaks peaks/*.bed --genes genes/*.txt </italic> and also
<italic toggle="yes">pegs --peaks A.bed B.bed --genes A.txt B.txt</italic>
</p></list-item><list-item><p>The output heatmap should also have an option to generate vector-based plots, such as PDF or SVG.</p></list-item><list-item><p>Authors may consider adding additional options to adjust the heatmap, such as setting labels, dimensions, colors, and gene/peak set names.</p></list-item></list>
</p></list-item><list-item><p>Figures can be further improved.</p></list-item><list-item><p>Please highlight the limitations of the tool such as the enhancer–gene associations are solely based on proximity.</p></list-item><list-item><p>Providing an installation option through Conda using the bioconda channel (https://bioconda.github.io/) will be useful and it will increase the usage/availability of the tool.</p></list-item></list>
</p>
    <p>Are the conclusions about the tool and its performance adequately supported by the findings presented in the article?</p>
    <p>Yes</p>
    <p>Is the rationale for developing the new software tool clearly explained?</p>
    <p>Yes</p>
    <p>Is the description of the software tool technically sound?</p>
    <p>Yes</p>
    <p>Are sufficient details of the code, methods and analysis (if applicable) provided to allow replication of the software development and its use by others?</p>
    <p>Yes</p>
    <p>Is sufficient information provided to allow interpretation of the expected output datasets and any results generated using the tool?</p>
    <p>Yes</p>
    <p>Reviewer Expertise:</p>
    <p>bioinformatics, gene regulation, regulatory genomics, epigenomics</p>
    <p>I confirm that I have read this submission and believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
  <sub-article article-type="response" id="comment7342-89907">
    <front-stub>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Iqbal</surname>
            <given-names>Mudassar</given-names>
          </name>
          <aff>University of Manchester, UK</aff>
        </contrib>
      </contrib-group>
      <author-notes>
        <fn fn-type="COI-statement">
          <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="epub">
        <day>22</day>
        <month>10</month>
        <year>2021</year>
      </pub-date>
    </front-stub>
    <body>
      <p>We thank the reviewer for constructive review and useful suggestions. We have updated the software taking into account the reviewer’s suggestions, improved the manuscript overall and added more text. Here we will address their individual comments.</p>
      <p>
        <italic toggle="yes">1 - It is useful to restrict peak-gene association within the TAD boundaries, but it is not the case that all the interactions, such as enhancer-gene interactions occur within the TAD boundaries. The enhancer–gene communication can also occur outside topological domains or in-between TADs. Do authors plan to provide an optional feature to integrate chromatin interaction data, such as HI-C?</italic>
      </p>
      <p> We would like to emphasise that the genomic distances are not restricted to TAD boundaries. PEGS provides the user with the option of supplying any distances. In addition, we also provide the user with the option to restrict peak expansion to TADs boundaries (if available), as a separate analysis (Fig 2A). We have revised the relevant text and we hope this will address reviewer’s main concerns and clarify any confusion. Integration of HiC data is beyond the scope of this work, but we will think of ways to incorporate that in future developments of PEGS.</p>
      <p><italic toggle="yes">2 - The command-line tool can be further improved by providing additional options to improve user experience and its usage. Below are some recommendations.</italic><list list-type="bullet"><list-item><p><italic toggle="yes">Currently, the peaks sets and gene lists inputs arguments are positional and the tools can only scan files available in the provided folders. Instead of looking into provided folders for BEDs files and gene lists, the argument should also allow chaining a list of bed files with a path. This is because in real analysis scenarios BEDs can be spread across multiple folders or a single folder can have other visible/hidden files. For example, I was testing the tool on a Mac machine, and PEGS started processing peaks for .DS_Store, which is the default directory structure and a hidden file. </italic></p></list-item><list-item><p><italic toggle="yes">The tool arguments could be: pegs --peaks peaks/*.bed --genes genes/*.txt and also pegs --peaks A.bed B.bed --genes A.txt B.txt</italic></p></list-item><list-item><p><italic toggle="yes">The output heatmap should also have an option to generate vector-based plots, such as PDF or SVG.</italic></p></list-item><list-item><p><italic toggle="yes">Authors may consider adding additional options to adjust the heatmap, such as setting labels, dimensions, colors, and gene/peak set names.</italic></p></list-item></list> We thank the reviewer as these are very useful suggestions and we have updated PEGS to a new version (please see latest version 0.6.2), which includes all of the above command line options. We also output the heatmap data as an excel file, so the user can customise their heatmaps/plots according to their choice/requirements. We have updated the documentation accordingly.</p>
      <p>
        <italic toggle="yes">3 - Figures can be further improved.</italic>
      </p>
      <p> We have improved and updated all of the figures (please see new version of the manuscript)</p>
      <p>
        <italic toggle="yes">4 - Please highlight the limitations of the tool such as the enhancer–gene associations are solely based on proximity.</italic>
      </p>
      <p> We have updated the manuscript text making it clear that our enrichment calculations are based on genomic proximity, expanding peaks (in both directions) with given distances (and/or TADs), and obtaining genes whose TSSs overlap with the expanded peaks.</p>
      <p>
        <italic toggle="yes">5 - Providing an installation option through Conda using the bioconda channel (https://bioconda.github.io/) will be useful and it will increase the usage/availability of the tool.</italic>
      </p>
      <p> We thank the reviewer; our tool is now installable through Conda.</p>
    </body>
  </sub-article>
</sub-article>
<sub-article article-type="peer-review" id="report89906">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.57359.r89906</article-id>
    <title-group>
      <article-title>Reviewer response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zabet</surname>
          <given-names>Nicolae Radu</given-names>
        </name>
        <xref rid="r89906a1" ref-type="aff">1</xref>
        <role>Referee</role>
      </contrib>
      <aff id="r89906a1"><label>1</label>Blizard Institute, Barts and The London School of Medicine and Dentistry, Queen Mary University of London, London, E1 2AT, UK</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>8</month>
      <year>2021</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2021 Zabet NR</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" ext-link-type="doi" id="relatedArticleReport89906" xlink:href="10.12688/f1000research.53926.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>Briggs and co-authors present a new tool called PEGS to generate gene set enrichment for ChIP-seq and DNase-seq datasets. In fact, the tool can be applied to any set of genomic intervals, including SNPs datasets. Generation of gene set enrichment for genomic intervals is a very important task and the authors propose an interesting approach to address it. Particularly, I appreciate the use of TADs to limit the expansion of genomic intervals. They also provide three use cases with different datasets and prove the applicability of this tool.</p>
    <p> I have the following comments:
<list list-type="order"><list-item><p>Do you consider alternative TSS? Would a gene with multiple TSSs be overrepresented or not?</p></list-item><list-item><p>Do you think that distal loops connecting TSS with enhancers residing outside of TADs would affect your results?</p></list-item><list-item><p>While readable, the resolution of figure 2 is low. I would advise the authors to upload a higher resolution figure.</p></list-item><list-item><p>For case1, maybe I missed it, but I think it would be interesting to interpret the results with or without TADs. This would allow us to see the impact of TAD annotation on the analysis.</p></list-item><list-item><p>I think the authors should add more explanations in the text about the results of their three cases.</p></list-item></list>
</p>
    <p>Are the conclusions about the tool and its performance adequately supported by the findings presented in the article?</p>
    <p>Yes</p>
    <p>Is the rationale for developing the new software tool clearly explained?</p>
    <p>Yes</p>
    <p>Is the description of the software tool technically sound?</p>
    <p>Yes</p>
    <p>Are sufficient details of the code, methods and analysis (if applicable) provided to allow replication of the software development and its use by others?</p>
    <p>Yes</p>
    <p>Is sufficient information provided to allow interpretation of the expected output datasets and any results generated using the tool?</p>
    <p>Yes</p>
    <p>Reviewer Expertise:</p>
    <p>Computational biology, bioinformatics, chromatin and epigenetics</p>
    <p>I confirm that I have read this submission and believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
  <sub-article article-type="response" id="comment7341-89906">
    <front-stub>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Iqbal</surname>
            <given-names>Mudassar</given-names>
          </name>
          <aff>University of Manchester, UK</aff>
        </contrib>
      </contrib-group>
      <author-notes>
        <fn fn-type="COI-statement">
          <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="epub">
        <day>22</day>
        <month>10</month>
        <year>2021</year>
      </pub-date>
    </front-stub>
    <body>
      <p>We thank the reviewer for constructive comments, here we will address their points one by one.</p>
      <p>
        <italic toggle="yes">1 - Do you consider alternative TSS? Would a gene with multiple TSSs be overrepresented or not?</italic>
      </p>
      <p> We consider all TSSs defined in the given genome build, which can include multiple TSSs for some genes. When calculating the enrichment for gene sets obtained through overlap of TSSs with expanded peaks, we remove duplicates. Therefore, genes with multiple TSSs are not over-represented.</p>
      <p>
        <italic toggle="yes">2 - Do you think that distal loops connecting TSS with enhancers residing outside of TADs would affect your results?</italic>
      </p>
      <p> We have two scenarios for enrichment calculations in PEGS. First, the user can provide genomic distances which are not constrained to TADs. Hence enhancers residing in a separate TAD to the TSS could be included. Secondly, we provide an option to the user to constrain the peak expansion to TAD/subTAD boundaries, if available. This will exclude enhancers outside the TAD boundaries, but the distances option can still be utilised to test multiple distances within and beyond TAD boundaries.</p>
      <p>
        <italic toggle="yes">3 - While readable, the resolution of figure 2 is low. I would advise the authors to upload a higher resolution figure.</italic>
      </p>
      <p> We agree, and have added a high-resolution version of Fig. 2</p>
      <p>
        <italic toggle="yes">4 - For case1, maybe I missed it, but I think it would be interesting to interpret the results with or without TADs. This would allow us to see the impact of TAD annotation on the analysis.</italic>
      </p>
      <p> This is related to point 2. In Fig.2A, we do provide the analysis with and without TADs for case 1. Enrichment for multiple distances is at the top two panels, and enrichment calculations using TADs are at the bottom. We have improved Fig 2 to make this clear. </p>
      <p>
        <italic toggle="yes">5 - I think the authors should add more explanations in the text about the results of their three cases.</italic>
      </p>
      <p> We have added more text in the manuscript, further explaining the three cases.</p>
    </body>
  </sub-article>
</sub-article>
