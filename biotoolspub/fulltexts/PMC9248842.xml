<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Acta Crystallogr D Struct Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Acta Crystallogr D Struct Biol</journal-id>
    <journal-id journal-id-type="publisher-id">Acta Cryst. D</journal-id>
    <journal-title-group>
      <journal-title>Acta Crystallographica. Section D, Structural Biology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2059-7983</issn>
    <publisher>
      <publisher-name>International Union of Crystallography</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9248842</article-id>
    <article-id pub-id-type="publisher-id">ih5003</article-id>
    <article-id pub-id-type="doi">10.1107/S2059798322005009</article-id>
    <article-id pub-id-type="coden">ACSDAD</article-id>
    <article-id pub-id-type="pii">S2059798322005009</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Ccp-EM</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Sequence-assignment validation in cryo-EM models with <italic toggle="yes">checkMySequence</italic>
</article-title>
      <alt-title>
        <italic toggle="yes">checkMySequence</italic>
      </alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-3796-8352</contrib-id>
        <name>
          <surname>Chojnowski</surname>
          <given-names>Grzegorz</given-names>
        </name>
        <xref rid="a" ref-type="aff">a</xref>
        <xref rid="cor" ref-type="corresp">*</xref>
      </contrib>
      <aff id="a"><label>a</label><institution>European Molecular Biology Laboratory, Hamburg Unit</institution>, Notkestrasse 85, 22607 Hamburg, <country>Germany</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor">Correspondence e-mail: <email>gchojnowski@embl-hamburg.de</email>
</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>7</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>07</day>
      <month>6</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>07</day>
      <month>6</month>
      <year>2022</year>
    </pub-date>
    <!--PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>.-->
    <volume>78</volume>
    <issue>Pt 7</issue>
    <issue-id pub-id-type="publisher-id">d220700</issue-id>
    <fpage>806</fpage>
    <lpage>816</lpage>
    <history>
      <date date-type="received">
        <day>04</day>
        <month>1</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>5</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Grzegorz Chojnowski 2022</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution (CC-BY) Licence, which permits
unrestricted use, distribution, and reproduction in any medium, provided the original authors and source are cited.</license-p>
      </license>
      <ali:free_to_read xmlns:ali="http://www.niso.org/schemas/ali/1.0/"/>
    </permissions>
    <self-uri xlink:href="https://doi.org/10.1107/S2059798322005009">A full version of this article is available from Crystallography Journals Online.</self-uri>
    <abstract abstract-type="toc">
      <p>A new method, <italic toggle="yes">checkMySequence</italic>, for the fast and automated detection of register errors in protein models built into cryo-EM reconstructions is presented.</p>
    </abstract>
    <abstract>
      <p>The availability of new artificial intelligence-based protein-structure-prediction tools has radically changed the way that cryo-EM maps are interpreted, but it has not eliminated the challenges of map interpretation faced by a microscopist. Models will continue to be locally rebuilt and refined using interactive tools. This inevitably results in occasional errors, among which register shifts remain one of the most difficult to identify and correct. Here, <italic toggle="yes">checkMySequence</italic>, a fast, fully automated and parameter-free method for detecting register shifts in protein models built into cryo-EM maps, is introduced. It is shown that the method can assist model building in cases where poorer map resolution hinders visual interpretation. It is also shown that <italic toggle="yes">checkMySequence</italic> could have helped to avoid a widely discussed sequence-register error in a model of SARS-CoV-2 RNA-dependent RNA polymerase that was originally detected thanks to a visual residue-by-residue inspection by members of the structural biology community. The software is freely available at <ext-link xlink:href="https://gitlab.com/gchojnowski/checkmysequence" ext-link-type="uri">https://gitlab.com/gchojnowski/checkmysequence</ext-link>.</p>
    </abstract>
    <kwd-group>
      <kwd>cryo-EM</kwd>
      <kwd>register shifts</kwd>
      <kwd>sequence assignment</kwd>
      <kwd>model validation</kwd>
      <kwd>
        <italic toggle="yes">checkMySequence</italic>
      </kwd>
    </kwd-group>
    <counts>
      <page-count count="11"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="introduction" id="sec1">
    <label>1.</label>
    <title>Introduction</title>
    <p>Five years after the resolution revolution in cryogenic electron microscopy (cryo-EM) began, we are witnessing another revolution: in the accuracy of protein structure-prediction techniques. The former paved the way to the structure determination of large macromolecular complexes in the absence of crystals and at a level of detail that enabled the study of biological processes at the atomic scale (Kühlbrandt, 2014<xref rid="bb25" ref-type="bibr"> ▸</xref>; Kokic <italic toggle="yes">et al.</italic>, 2021<xref rid="bb23" ref-type="bibr"> ▸</xref>). The latter provided a means for the accurate and widely accessible structure prediction of protein structures. Although the release of the artificial intelligence-based <italic toggle="yes">AlphaFold</italic>2 (AF2; Jumper <italic toggle="yes">et al.</italic>, 2021<xref rid="bb22" ref-type="bibr"> ▸</xref>) and the similar <italic toggle="yes">RoseTTAFold</italic> (Baek <italic toggle="yes">et al.</italic>, 2021<xref rid="bb4" ref-type="bibr"> ▸</xref>) represent dramatic progress in the way that protein structures are predicted, they did not solve the problem of protein structure determination. Structural studies of multimeric, highly dynamic complexes or of specific ligand-bound states of proteins still require experimental approaches, and from this perspective the new structure-prediction approaches perfectly complement cryo-EM (Perrakis &amp; Sixma, 2021<xref rid="bb33" ref-type="bibr"> ▸</xref>). Nevertheless, the new predictive methods have dramatically changed the way that cryo-EM reconstructions are interpreted (Mosalaganti <italic toggle="yes">et al.</italic>, 2021<xref rid="bb29" ref-type="bibr"> ▸</xref>).</p>
    <p>With the availability of accurate protein structure-prediction tools, the interpretation of most cryo-EM reconstructions does not require <italic toggle="yes">de novo</italic> model tracing [for example, with <italic toggle="yes">ARP</italic>/<italic toggle="yes">wARP</italic> (Chojnowski <italic toggle="yes">et al.</italic>, 2021<xref rid="bb12" ref-type="bibr"> ▸</xref>), <italic toggle="yes">Buccaneer</italic> (Hoh <italic toggle="yes">et al.</italic>, 2020<xref rid="bb19" ref-type="bibr"> ▸</xref>) or <italic toggle="yes">phenix.map_to_model</italic> (Terwilliger <italic toggle="yes">et al.</italic>, 2018<xref rid="bb36" ref-type="bibr"> ▸</xref>)] or parallel structure determination of the model components using X-ray crystallography (Beckham <italic toggle="yes">et al.</italic>, 2021<xref rid="bb7" ref-type="bibr"> ▸</xref>). Instead, one can follow an approach that is often used in cryo-EM at lower resolutions, in which whole models are assembled from experimentally or theoretically determined structures of their components (Allegretti <italic toggle="yes">et al.</italic>, 2020<xref rid="bb2" ref-type="bibr"> ▸</xref>). The structure-assembly procedure, however, does not eliminate the need for interactive (or ‘manual’) model rebuilding. This is still required in regions where a reliable structure cannot be predicted due to low sequence coverage or is predicted in a conformational state incompatible with a target (Perrakis &amp; Sixma, 2021<xref rid="bb33" ref-type="bibr"> ▸</xref>). Similarly, interfaces within homo- or hetero-multimers often cannot be reliably modelled even with the excellent, community-driven AF2 extension <italic toggle="yes">ColabFold</italic> (Mirdita <italic toggle="yes">et al.</italic>, 2021<xref rid="bb28" ref-type="bibr"> ▸</xref>) or the recently released <italic toggle="yes">AlphaFold-Multimer</italic> (Evans <italic toggle="yes">et al.</italic>, 2021<xref rid="bb17" ref-type="bibr"> ▸</xref>). In such cases tools such as <italic toggle="yes">Coot</italic> (Casañal <italic toggle="yes">et al.</italic>, 2020<xref rid="bb9" ref-type="bibr"> ▸</xref>) or <italic toggle="yes">ISOLDE</italic> (Croll, 2018<xref rid="bb13" ref-type="bibr"> ▸</xref>) make interactive model refinement and rebuilding relatively fast and simple, but subjective visual interpretation of a map by a user is still required. This process, although significantly simplified due to the availability of reliably predicted initial models, inevitably results in sporadic errors.</p>
    <p>Errors may occur in every structure, regardless of the resolution or the best efforts of the experimentalist. However, they seem to be more common in cryo-EM, where models are often built quickly, under pressure and into reconstructions spanning a wide range of local resolutions. Although many issues can be corrected automatically (Joosten <italic toggle="yes">et al.</italic>, 2014<xref rid="bb20" ref-type="bibr"> ▸</xref>; Liebschner <italic toggle="yes">et al.</italic>, 2021<xref rid="bb27" ref-type="bibr"> ▸</xref>), visual residue-by-residue inspection by an experienced structural biologist remains the best way to judge the quality of a model. This, however, is time-consuming and requires a level of expertise that is rarely available (Croll, Williams <italic toggle="yes">et al.</italic>, 2021<xref rid="bb15" ref-type="bibr"> ▸</xref>). Therefore, computational expert systems for model validation such as <italic toggle="yes">MolProbity</italic> (Chen <italic toggle="yes">et al.</italic>, 2010<xref rid="bb10" ref-type="bibr"> ▸</xref>) are indispensable in the routine detection of modelling errors. Even these tools, however, usually require experience in separating severe problems that must be corrected from unusual features that may be left in a model. Moreover, finding an optimal way of correcting an issue is not always straightforward.</p>
    <p>In cryo-EM, one of the most difficult problems to identify and correct are register-shift errors, where residues are systematically assigned the identity of a residue a few amino acids up or down in the sequence. When the resolution allows, register shifts can be identified using aromatic residues, which are usually well resolved in the density. This can conveniently be performed using a dedicated, interactive tool implemented in <italic toggle="yes">ISOLDE</italic>. The process, however, cannot easily be automated as map-fit measures are usually more sensitive to atoms outside density than to density left without a model (Croll, Williams <italic toggle="yes">et al.</italic>, 2021<xref rid="bb15" ref-type="bibr"> ▸</xref>). Nevertheless, tools such as <italic toggle="yes">EMRinger</italic> (Barad <italic toggle="yes">et al.</italic>, 2015<xref rid="bb6" ref-type="bibr"> ▸</xref>), <italic toggle="yes">Q</italic>-score (Pintilie <italic toggle="yes">et al.</italic>, 2020<xref rid="bb34" ref-type="bibr"> ▸</xref>) and <italic toggle="yes">SMOC</italic> (Joseph <italic toggle="yes">et al.</italic>, 2016<xref rid="bb21" ref-type="bibr"> ▸</xref>) can in principle be used to detect register shifts, even though there are no clear criteria that might be used to translate validation-score fluctuations to specific problems in a model. Moreover, these density-fit scores are strongly dependent on local resolution, which may hinder the recognition of register shifts from the effects of tracing problems or variations of local resolution.</p>
    <p>Register-shift errors may also have an effect on backbone geometry when a number of side chains are forced into density volumes that are too small. It has been shown that these can in principle be detected using <italic toggle="yes">CaBLAM</italic> (Richardson <italic toggle="yes">et al.</italic>, 2018<xref rid="bb35" ref-type="bibr"> ▸</xref>). Moreover, the very source of register shift, which is often a backbone-tracing issue (for example a deletion or insertion), can be occasionally detected based on backbone-geometry problems (Lawson <italic toggle="yes">et al.</italic>, 2021<xref rid="bb26" ref-type="bibr"> ▸</xref>).</p>
    <p>Neverthess, to the best of our knowledge there is no tool available that has been developed specifically for the automated detection of register-shift errors in macromolecular models. Although available model-geometry and density-fit validation tools can in some cases help to detect these, there are no clear rules of thumb that would allow the selection of troubled regions that need to be carefully checked by a user. Furthermore, none of these tools can automatically suggest a possible fix to a plausible register-shift problem.</p>
    <p>Here, we present <italic toggle="yes">checkMySequence</italic>, a new tool for the automated detection of register-shift errors in cryo-EM models. The method is based on <italic toggle="yes">findMySequence</italic>, a protein sequence-identification tool for crystallography and cryo-EM (Chojnowski <italic toggle="yes">et al.</italic>, 2022<xref rid="bb11" ref-type="bibr"> ▸</xref>). The <italic toggle="yes">findMySequence</italic> program uses a neural network classifier to predict residue-type probabilities for a backbone-only protein model and a corresponding map. Based on the predicted probabilities, the program can either identify the most plausible sequence for a given model in a sequence database or assign model fragments to a specific target sequence. The <italic toggle="yes">checkMySequence</italic> algorithm uses tools implemented in <italic toggle="yes">findMySequence</italic> to assign input model fragments to a reference sequence. It identifies regions where the new sequence assignment challenges the sequence-assignment hypothesis in the input model. This approach provides a conceptually simple, fast and intuitive tool for the reliable detection of register shifts in cryo-EM models, including very large macromolecular complexes (for example complete ribosomes). If an issue is detected, the method suggests a more plausible sequence assignment to the user. We show that <italic toggle="yes">checkMySequence</italic> can reliably identify register-shift errors in models deposited in the Protein Data Bank (PDB; Berman <italic toggle="yes">et al.</italic>, 2000<xref rid="bb8" ref-type="bibr"> ▸</xref>) that have already been reported in the literature and a number of new, previously unidentified errors.</p>
  </sec>
  <sec id="sec2">
    <label>2.</label>
    <title>Model validation with a systematic sequence assignment</title>
    <p>The method requires the input of a cryo-EM map, a corresponding atomic model and sequences of all of the model chains. Initially, for each protein chain in the input model the method identifies a reference sequence. It uses a protocol implemented in the <italic toggle="yes">findMySequence</italic> program (Chojnowski <italic toggle="yes">et al.</italic>, 2022<xref rid="bb11" ref-type="bibr"> ▸</xref>) based on a neural network residue-type classifier and the <italic toggle="yes">HMMER</italic> (Eddy, 2011<xref rid="bb16" ref-type="bibr"> ▸</xref>) sequence-comparison suite (Fig. 1<xref rid="fig1" ref-type="fig"> ▸</xref>
<italic toggle="yes">a</italic>). Each chain for which a reference sequence can be identified is divided into continuous overlapping test fragments that are systematically assigned to the reference sequence. The program identifies the most plausible assignment of a test fragment to a reference sequence given residue-type probabilities estimated from a map and backbone coordinates. We assume here that the test fragments are continuous and ignore all modified residues in the model. To account for variations in the accuracy of residue-type probability estimates and different lengths of reference sequences, for each assignment we estimate a <italic toggle="yes">p</italic>-value, or a probability that it was observed by chance. Additionally, to compensate for lower local resolutions, the initial fragment length of 20 residues is increased to a maximum of 60 residues if the corresponding sequence-assignment <italic toggle="yes">p</italic>-value exceeds a threshold defined in Section 4.1<xref rid="sec4.1" ref-type="sec"/> (Fig. 1<xref rid="fig1" ref-type="fig"> ▸</xref>
<italic toggle="yes">b</italic>). Depending on the result of the initial reference-sequence identification and a test-fragment sequence-assignment procedure, the following alternative outcomes are possible.<list list-type="simple" id="l1"><list-item><p>(i) The reference sequence for a chain cannot be identified; the corresponding sequence is missing in the input, the chain is traced in a very low local resolution region or is mistraced.</p></list-item><list-item><p>(ii) The sequence assignment of a test fragment is unreliable (the <italic toggle="yes">p</italic>-value is above the threshold defined in Section 4.1<xref rid="sec4.1" ref-type="sec"/>); there is not sufficient evidence to confirm or reject the corresponding input model sequence.</p></list-item><list-item><p>(iii) The sequence assignment of a test fragment is confident (the <italic toggle="yes">p</italic>-value is below the threshold) and the assigned sequence agrees with the input model; the corresponding input model sequence assignment is confirmed.</p></list-item><list-item><p>(iv) The sequence assignment of a test fragment is confident (the <italic toggle="yes">p</italic>-value is below the threshold), but the assigned sequence does not agree with the input model; there is a plausible register error in the corresponding input model.</p></list-item></list>
</p>
  </sec>
  <sec sec-type="materials|methods" id="sec3">
    <label>3.</label>
    <title>Materials and methods</title>
    <sec id="sec3.1">
      <label>3.1.</label>
      <title>Protein model benchmark set</title>
      <p>Atomic model coordinates of macromolecular structures determined using cryo-EM were downloaded from the PDB as of 20 August 2021 together with the corresponding reconstructions and reference sequences. Only structures determined at a resolution of 4 Å or better, with a molecular weight below 500 kDa and with half-maps available for download in EMDB (Velankar <italic toggle="yes">et al.</italic>, 2016<xref rid="bb38" ref-type="bibr"> ▸</xref>) were considered. A total of 796 structures fulfilled these criteria. For each of the half-map pairs local resolution maps were calculated using <italic toggle="yes">RESMAP</italic> version 1.1.4 (Kucukelbir <italic toggle="yes">et al.</italic>, 2014<xref rid="bb24" ref-type="bibr"> ▸</xref>) with default parameters.</p>
    </sec>
    <sec id="sec3.2">
      <label>3.2.</label>
      <title>Protein-chain test-fragment selection</title>
      <p>Continuous protein-chain test fragments were selected by shifting a ‘focus window’ of fixed length in steps of five residues along all protein chains in a model. For the benchmarks we used test fragments of 20 and 40 residues. Only chains with at least 95% standard amino-acid residue content were considered. If multiple conformations of a residue were present in a model, only the first one was processed. The mean local resolution of the selected chain fragments was calculated for the grid points of a corresponding local resolution map within 2 Å of any atom in a fragment. A random coordinate shift was applied for benchmarks only to all model atoms independently, ignoring any stereochemical restraints.</p>
    </sec>
    <sec id="sec3.3">
      <label>3.3.</label>
      <title>Map preprocessing</title>
      <p>Before use, the input map resolution was truncated in reciprocal space to 2.5 Å to account for the absence of cryo-EM reconstructions determined at ultrahigh resolution in the residue-type classifier training set implemented in <italic toggle="yes">findMy­Sequence</italic>. Map blurring and sharpening were performed in reciprocal space and implemented in the <italic toggle="yes">checkMySequence</italic> code using tools from the <italic toggle="yes">cctbx</italic> library.</p>
    </sec>
    <sec id="sec3.4">
      <label>3.4.</label>
      <title>Implementation and availability</title>
      <p>The sequence-validation program <italic toggle="yes">checkMySequence</italic> was developed based on routines implemented in <italic toggle="yes">findMySequence</italic>. It was developed in Python 3 with extensive use of the <italic toggle="yes">PyTorch</italic> (Paszke <italic toggle="yes">et al.</italic>, 2019<xref rid="bb32" ref-type="bibr"> ▸</xref>), <italic toggle="yes">NumPy</italic> (Oliphant, 2006<xref rid="bb31" ref-type="bibr"> ▸</xref>), <italic toggle="yes">SciPy</italic> (Virtanen <italic toggle="yes">et al.</italic>, 2020<xref rid="bb39" ref-type="bibr"> ▸</xref>), <italic toggle="yes">cctbx</italic> (Grosse-Kunstleve <italic toggle="yes">et al.</italic>, 2002<xref rid="bb18" ref-type="bibr"> ▸</xref>) and <italic toggle="yes">CCP</italic>4 (Winn <italic toggle="yes">et al.</italic>, 2011<xref rid="bb40" ref-type="bibr"> ▸</xref>) libraries and utility programs. For making sequence database queries, we use the <italic toggle="yes">HMMER</italic> suite version 3.3.2. The program source code and installation instructions are freely available under a BSD-3 licence at <ext-link xlink:href="https://gitlab.com/gchojnowski/checkmysequence" ext-link-type="uri">https://gitlab.com/gchojnowski/checkmysequence</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="discussion|interpretation" id="sec4">
    <label>4.</label>
    <title>Results and discussion</title>
    <sec id="sec4.1">
      <label>4.1.</label>
      <title>Sequence-assignment validation: finding a better hypothesis</title>
      <p>Our working hypothesis is that the input model sequence is correct and agrees with an unknown, ground-truth reference model. If a result of the sequence-assignment procedure is conclusive, the hypothesis can be either confirmed or challenged by providing a model that explains the cryo-EM map features better. This approach, however, requires clear criteria for assessing the statistical significance of the sequence-assignment results.</p>
      <p>The sequence-assignment procedure used in this work has been calibrated to provide a <italic toggle="yes">p</italic>-value estimate: a probability that the result was obtained by chance. In the current setup, however, we have no means of validating the reliability of this in detail as the reference structures available in the PDB may, and do occasionally, contain sequence-register errors that can only be identified and corrected by detailed inspection by an experienced modeller. Indeed, in a recent group effort, the members of the Coronavirus Structural Task Force were able to identify multiple tracing and sequence-assignment errors in a relatively small, representative set of PDB-deposited <italic toggle="yes">Sarbecovirus</italic> protein models (Croll, Diederichs <italic toggle="yes">et al.</italic>, 2021<xref rid="bb14" ref-type="bibr"> ▸</xref>).</p>
      <p>To address the issue of benchmark set reliability, we decided to undertake a large-scale, nonparametric approach assuming that errors in deposited PDB models are scarce and will weakly affect the overall conclusions. We tested the agreement with reference models of sequences assigned to continuous protein-chain fragments of 20 amino acids systematically selected from 796 protein models from the benchmark set described in Section 3<xref rid="sec3" ref-type="sec"/>.</p>
      <p>For a total number of 166 713 protein-chain test fragments for which a reference sequence could be identified (see Section 2<xref rid="sec2" ref-type="sec"/> for details), the assigned sequence matched the corresponding model in 156 091 (94%) and differed in 10 622 (6%) of cases. Protein-chain fragments with assigned sequence matching the reference and different from the reference are well separated by the corresponding <italic toggle="yes">p</italic>-value (Fig. 2<xref rid="fig2" ref-type="fig"> ▸</xref>
<italic toggle="yes">a</italic>). Indeed, a one-sided 99.5% confidence interval for fragments with a sequence assignment that does not match the reference (dashed line in Fig. 2<xref rid="fig2" ref-type="fig"> ▸</xref>
<italic toggle="yes">a</italic>) corresponds to 13% of cases with matching sequences. The relatively large number of fragments assigned a correct sequence with a high <italic toggle="yes">p</italic>-value may be due to the presence of model stretches built into local resolution regions that are too low for reliable sequence assignment. Indeed, the distribution of correctly assigned sequences is clearly shifted towards better local resolutions compared with assignments with incorrect sequence (Fig. 2<xref rid="fig2" ref-type="fig"> ▸</xref>
<italic toggle="yes">b</italic>). These observations clearly show that the <italic toggle="yes">p</italic>-value is a reliable criterion of the validity of the sequence-assignment procedure. Moreover, as expected, if sequence-assignment errors are present in the benchmark set models then they are relatively rare.</p>
      <p>In this work, we treat as conclusive sequence assignments with a <italic toggle="yes">p</italic>-value outside the 99.5% one-sided confidence interval estimated for fragments with assigned sequence mismatch (Fig. 2<xref rid="fig2" ref-type="fig"> ▸</xref>
<italic toggle="yes">a</italic>). Although this choice of threshold is arbitrary, it corresponds to results that are very rare in our benchmark set and may indicate an outlier. We will show later that many sequence assignments outside this <italic toggle="yes">p</italic>-value interval are indeed due to plausible reference-structure errors.</p>
    </sec>
    <sec id="sec4.2">
      <label>4.2.</label>
      <title>Compensating for low local resolution</title>
      <p>In the previous section we noted that observed protein fragments with correctly assigned sequence and a high <italic toggle="yes">p</italic>-value may correspond to map regions with a local resolution that is too low for <italic toggle="yes">de novo</italic> tracing. To further investigate this issue, we plotted the sequence-assignment <italic toggle="yes">p</italic>-value as a function of the mean local resolution of the corresponding test fragments. The <italic toggle="yes">p</italic>-values are clearly higher for test fragments modelled into lower local resolution regions (Fig. 3<xref rid="fig3" ref-type="fig"> ▸</xref>
<italic toggle="yes">a</italic>), and half of the fragments exceed the threshold defined in the previous section at resolutions as low as 6 Å. At the same time, we observed that the <italic toggle="yes">p</italic>-values for sequence assignments that do not match the reference are independent of local resolution (Fig. 3<xref rid="fig3" ref-type="fig"> ▸</xref>
<italic toggle="yes">b</italic>). This clearly indicates that sequence misassignment is often related to intrinsic properties of a model (for example tracing errors) and not to low information content of a corresponding map region. We also observed that the <italic toggle="yes">p</italic>-value gap between correct and incorrect sequence assignments increases for longer fragments. This can be used to compensate for lower local resolution.</p>
    </sec>
    <sec id="sec4.3">
      <label>4.3.</label>
      <title>The effect of coordinate errors</title>
      <p>To test the validity of our earlier observations in the presence of model errors, we plotted the sequence-assignment <italic toggle="yes">p</italic>-values for protein-chain test fragments at various levels of randomization of atom coordinates. We observed that coordinate randomization increases the <italic toggle="yes">p</italic>-values for all fragments, regardless of whether their assigned sequence matches or does not match the reference model (Fig. 4<xref rid="fig4" ref-type="fig"> ▸</xref>). As a result, fewer fragments exceed the <italic toggle="yes">p</italic>-value threshold defined in the previous section (Fig. 2<xref rid="fig2" ref-type="fig"> ▸</xref>
<italic toggle="yes">a</italic>), which reduces the predictive power of the presented approach. Nevertheless, we observed that the negative effect of coordinate errors can be compensated with longer test fragments (Fig. 4<xref rid="fig4" ref-type="fig"> ▸</xref>
<italic toggle="yes">a</italic>).</p>
    </sec>
    <sec id="sec4.4">
      <label>4.4.</label>
      <title>The effect of map sharpening and blurring</title>
      <p>In earlier work, we observed that many deposited maps are oversharpened to a level that hinders their interpretation (Chojnowski <italic toggle="yes">et al.</italic>, 2021<xref rid="bb12" ref-type="bibr"> ▸</xref>). As maps are often sharpened or blurred by microscopists based on subjective criteria, for example to increase the interpretability of specific map regions (Nicholls <italic toggle="yes">et al.</italic>, 2018<xref rid="bb30" ref-type="bibr"> ▸</xref>), we decided to investigate the effect of excessive map processing on our sequence-assignment procedure.</p>
      <p>We observed that excessive input map sharpening and blurring have a similar influence on sequence-assignment <italic toggle="yes">p</italic>-values (not shown). However, map sharpening (Fig. 5<xref rid="fig5" ref-type="fig"> ▸</xref>) has more impact on fragments built into high local resolution regions. We attribute this to the neural network residue-type classifier used in this work, which was trained on an unstratified set of deposited maps. It reflects the experimentally observed distribution of local resolutions, where very high local resolution regions may be underrepresented. We observed that the negative effect of excessive map sharpening or blurring (data for blurred maps were omitted for clarity) can easily be compensated with a longer test-fragment length (Fig. 5<xref rid="fig5" ref-type="fig"> ▸</xref>
<italic toggle="yes">a</italic>). We did not observe any effect related to map blurring or sharpening for test fragments with an assignment sequence that did not match a reference model.</p>
    </sec>
    <sec id="sec4.5">
      <label>4.5.</label>
      <title>Performance of reference-sequence identification</title>
      <p>A crucial step in the described method is the identification of reference sequences for each chain in the input model. For this purpose, we use a procedure implemented in <italic toggle="yes">findMy­Sequence.</italic> The program uses a neural network classifier to produce residue-type probability profiles that are further used to query input sequence sets with tools from the <italic toggle="yes">HMMER</italic> suite. Sequence matches identified by <italic toggle="yes">HMMER</italic> are scored with an <italic toggle="yes">E</italic>-value: the number of expected hits in a comparable set containing only random sequences. The lower the <italic toggle="yes">E</italic>-value, the more reliable the corresponding match. Since this approach is inherently very sensitive to map and model quality, we investigated how coordinate errors and excessive map sharpening or blurring affects the performance of the reference-sequence identification procedure.</p>
      <p>Overall, of 3378 protein chains longer than ten residues in our benchmark set, <italic toggle="yes">checkMySequence</italic> correctly identified 3162 (94%). For the remaining 216 structures the program returned no results, which is reported to a user as a plausible error. Indeed, we observed that many of them were clearly shifted outside corresponding cryo-EM reconstructions (for example PDB/EMDB entries <ext-link xlink:href="https://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=6vx7" ext-link-type="uri">6vx7</ext-link>/<ext-link xlink:href="https://scripts.iucr.org/cgi-bin/cr.cgi?rm=emdb&amp;emdbId=EMD-21432" ext-link-type="uri">EMD-21432</ext-link>, <ext-link xlink:href="https://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=6vp8" ext-link-type="uri">6vp8</ext-link>/<ext-link xlink:href="https://scripts.iucr.org/cgi-bin/cr.cgi?rm=emdb&amp;emdbId=EMD-21250" ext-link-type="uri">EMD-21250</ext-link>, <ext-link xlink:href="https://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=6tqm" ext-link-type="uri">6tqm</ext-link>/<ext-link xlink:href="https://scripts.iucr.org/cgi-bin/cr.cgi?rm=emdb&amp;emdbId=EMD-10555" ext-link-type="uri">EMD-10555</ext-link> and <ext-link xlink:href="https://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=6xi8" ext-link-type="uri">6xi8</ext-link>/<ext-link xlink:href="https://scripts.iucr.org/cgi-bin/cr.cgi?rm=emdb&amp;emdbId=EMD-22191" ext-link-type="uri">EMD-22191</ext-link>).</p>
      <p>We observed that map processing increases <italic toggle="yes">HMMER</italic>
<italic toggle="yes">E</italic>-values, but the effect of sharpening (negative <italic toggle="yes">B</italic>-factor correction) is more prominent than blurring (Fig. 6<xref rid="fig6" ref-type="fig"> ▸</xref>
<italic toggle="yes">a</italic>). There are also a number of structures for which map blurring significantly improves the performance of the method (lower <italic toggle="yes">E</italic>-values). Moreover, the overall number of 3162 chains in the benchmark set for which the reference sequence could have been identified reduces to 3149 for blurred maps and to 2508 for sharpened maps. This is in line with an earlier observation that many deposited maps are heavily oversharpened (Chojnowski <italic toggle="yes">et al.</italic>, 2021<xref rid="bb12" ref-type="bibr"> ▸</xref>). Interestingly, we also observed that coordinate bias reduces the number of identified sequences less than excessive map sharpening (Fig. 6<xref rid="fig6" ref-type="fig"> ▸</xref>
<italic toggle="yes">b</italic>). The initial number of recognized chain sequences decreases to 3151, 3100 and 2797 for all-atom r.m.s.d.s of 0.1, 0.3 and 0.5 Å, respectively. Nevertheless, the identified sequences were always correct, regardless of map processing or model bias.</p>
    </sec>
    <sec id="sec4.6">
      <label>4.6.</label>
      <title>A register shift in an RNA-dependent RNA polymerase complex</title>
      <p>The RNA-dependent RNA polymerase (nsp12) is essential for replication of the SARS-CoV-2 viral genome. In a recent study, a cryo-EM structure of nsp12 with two accessory proteins, nsp7 and nsp8, was determined at a resolution of 2.5 Å (PDB entry <ext-link xlink:href="https://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=7bv2" ext-link-type="uri">7bv2</ext-link>/EMDB entry <ext-link xlink:href="https://scripts.iucr.org/cgi-bin/cr.cgi?rm=emdb&amp;emdbId=EMD-30210" ext-link-type="uri">EMD-30210</ext-link>), providing valuable structural details on the mechanism of action of the antiviral drug remdesivir (Yin <italic toggle="yes">et al.</italic>, 2020<xref rid="bb41" ref-type="bibr"> ▸</xref>). Due to its importance, the structure has been carefully analysed by the structural biology community.</p>
      <p>The original structure was shown to contain a number of potential problems that were quickly corrected in the updated PDB deposition (Croll, Williams <italic toggle="yes">et al.</italic>, 2021<xref rid="bb15" ref-type="bibr"> ▸</xref>). One of the problems was a register shift of an isolated and relatively short (15 amino acids) α-helical fragment at the nsp12 C-terminus (Fig. 7<xref rid="fig7" ref-type="fig"> ▸</xref>
<italic toggle="yes">a</italic>). A close inspection of the fragment shows, for example, that Thr912 in the original model is too small for the corresponding side-chain density, which can be better explained with Tyr921 after shifting the model register by nine residues. This could not have been detected by a density-fit measure as the issue did not result in prominent density outliers. Similarly, as the whole fragment is register shifted there are no backbone geometry issues at the flanks of the shifted stretch. Nevertheless, the issue can be easily spotted with <italic toggle="yes">checkMySequence</italic> as a clear sequence-assignment outlier (red bar in Fig. 7<xref rid="fig7" ref-type="fig"> ▸</xref>
<italic toggle="yes">c</italic>). Moreover, a new sequence assignment suggested in the text output of the method could have been used to correct the issue, as it agrees with the updated coordinates (Fig. 8<xref rid="fig8" ref-type="fig"> ▸</xref>).</p>
    </sec>
    <sec id="sec4.7">
      <label>4.7.</label>
      <title>Cytoplasmic domain of a transient receptor potential channel</title>
      <p>In the benchmark set, we identified a number of clear outliers where fragments were assigned sequences different from the reference model with low <italic toggle="yes">p</italic>-values. Particularly interesting was a cryo-EM structure of transient receptor potential cation channel subfamily C member 6 (TRPC6) determined at 3.8 Å resolution (PDB entry <ext-link xlink:href="https://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=6cv9" ext-link-type="uri">6cv9</ext-link>/EMDB entry <ext-link xlink:href="https://scripts.iucr.org/cgi-bin/cr.cgi?rm=emdb&amp;emdbId=EMD-7637" ext-link-type="uri">EMD-7637</ext-link>; Azumaya <italic toggle="yes">et al.</italic>, 2018<xref rid="bb3" ref-type="bibr"> ▸</xref>). A number of fragments from this model form a clear, very low <italic toggle="yes">p</italic>-value cluster with assigned sequences that differ from the reference (orange circles in Fig. 3<xref rid="fig3" ref-type="fig"> ▸</xref>
<italic toggle="yes">b</italic>).</p>
      <p>Despite the relatively low resolution, due to the lack of any closely homologous structure the original model was built <italic toggle="yes">de novo</italic> into the map using <italic toggle="yes">Coot</italic>, which was a very challenging task. The overall fold of the structure was later confirmed by a number of closely related human TRPC6 structures determined at better resolutions. Nevertheless, we noticed a possible register shift in a linker helical domain of the structure (Fig. 9<xref rid="fig9" ref-type="fig"> ▸</xref>
<italic toggle="yes">a</italic>). As rebuilding the structure <italic toggle="yes">de novo</italic> would be very difficult owing to the relatively low local resolution, we decided to use a corresponding <italic toggle="yes">AlphaFold</italic>2-predicted structure database (Varadi <italic toggle="yes">et al.</italic>, 2022<xref rid="bb37" ref-type="bibr"> ▸</xref>) to interpret the map (ID Q61143). The relevant region of the predicted model was fitted into the EM reconstruction using the ‘Jiggle-Fit this molecule with Fourier Filter’ tool and refined in real space with all-molecule self-restraints at a 5 Å distance cutoff using <italic toggle="yes">Coot</italic> version 0.9.2-pre (Casañal <italic toggle="yes">et al.</italic>, 2020<xref rid="bb9" ref-type="bibr"> ▸</xref>), and was additionally refined using <italic toggle="yes">phenix.real_space_refine</italic> version 1.18.2 (Afonine <italic toggle="yes">et al.</italic>, 2018<xref rid="bb1" ref-type="bibr"> ▸</xref>) with default parameters. Visual inspection of the new model showed a few clear signs of improvement in the match to the map in regions that resulted in a register shift in the original model [for example, the deletion in the left-hand end of the α-helix presented in Fig. 9<xref rid="fig9" ref-type="fig"> ▸</xref>(<italic toggle="yes">a</italic>), residues A/258 and A/259]. Nevertheless, we noticed no prominent signs of sequence-register improvement, for example for aromatic residues. The <italic toggle="yes">checkMySequence</italic> scores, however, improved significantly (Figs. 9<xref rid="fig9" ref-type="fig"> ▸</xref>
<italic toggle="yes">c</italic> and 9<xref rid="fig9" ref-type="fig"> ▸</xref>
<italic toggle="yes">d</italic>), which suggests that the new backbone model fits the corresponding map better and provides a better basis for a reliable sequence assignment. Moreover, the sequence register of the new model, which was shifted by eight residues relative to the deposited coordinates (Fig. 9<xref rid="fig9" ref-type="fig"> ▸</xref>
<italic toggle="yes">b</italic>), confirmed the <italic toggle="yes">checkMySequence</italic> suggestions. We also noted that the new model sequence register agrees with a closely related (94% sequence identity) human structure that has been determined recently at 2.8 Å resolution with much clearer side-chain densities in this region (PDB entry <ext-link xlink:href="https://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=6uz8" ext-link-type="uri">6uz8</ext-link>; Bai <italic toggle="yes">et al.</italic>, 2020<xref rid="bb5" ref-type="bibr"> ▸</xref>). These results show that <italic toggle="yes">checkMySequence</italic> can be used for the interpretation of maps and model validation at resolutions where visual map interpretation is very challenging.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec5">
    <label>5.</label>
    <title>Conclusions</title>
    <p>Sporadic errors are an intrinsic part of the macromolecular model-building process. Modelling in cryo-EM reconstructions seems to be particularly affected as target structures are usually large, map resolutions are heterogeneous and the pressure to release models quickly is strong. Although a number of model-validation tools have been developed to date, many of them specifically for cryo-EM map interpretation, register shifts remain one of the most difficult problems to identify and correct.</p>
    <p>Here, we have presented a new method, <italic toggle="yes">checkMySequence</italic>, for the fully automated identification of register-shift errors in protein models built into cryo-EM reconstructions. The approach relies on the systematic assignment of short protein model test fragments to the target sequence and works as a statistical test. If there is sufficient statistical evidence, the input model sequence can be challenged by providing a sequence that explains the features of a map better. Although the strength of the approach in principle depends on factors such as local map resolution, model quality and a level of map sharpening or blurring, we have shown that these factors can be successfully compensated by automated adjustment of the test-fragment length. This avoids the problem of bias related to user-provided parameters such as map resolution. The method also removes the need for the user to understand and interpret validation scores: the results clearly state whether or not the input model sequence assignment can be improved.</p>
    <p>A limitation of this approach is its use of relatively long test fragments, which are required to compensate for the low information content of cryo-EM maps. At lower local map resolutions, the test-fragment length can be increased to 60 amino acids from the default of 20. This means that the source of a sequence-register problem needs to be identified by a user within this range using interactive methods. It must be stressed, however, that if a plausible register shift is detected the method also suggests a new sequence assignment, which simplifies the error correction. The model errors can be conveniently rebuilt using tools available in the related method <italic toggle="yes">findMySequence</italic>. The requirement for long test fragments, however, may also result in the method missing short, local register-shift errors, where a tracing issue is promptly compensated (for example a missing residue compensated by an additional residue). Although the minimum length of a detectable register-shift stretch depends on the resolution, it should be generally longer than ten amino acids. Nevertheless, we show that the approach provides useful results at resolutions where a visual, residue-by-residue validation would be very challenging.</p>
    <p>Apart from register-shift errors, the program also checks the input model for sequence mismatches (single-residue differences between the model and target sequence) and problems with residue numbering (for example continuous residue numbering ignoring gaps in a model) (Fig. 8<xref rid="fig8" ref-type="fig"> ▸</xref>). Another advantage of the presented method is its performance, which makes it readily applicable to the analysis of very large models. For example, validation of a complete 70S ribosome structure at 3.0 Å resolution (PDB entry <ext-link xlink:href="https://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=5we4" ext-link-type="uri">5we4</ext-link>/EMDB entry <ext-link xlink:href="https://scripts.iucr.org/cgi-bin/cr.cgi?rm=emdb&amp;emdbId=EMD-8814" ext-link-type="uri">EMD-8814</ext-link>), with 58 protein chains and over 6400 protein residues, takes less than 3 min on a basic laptop. As we have shown previously (Chojnowski <italic toggle="yes">et al.</italic>, 2022<xref rid="bb11" ref-type="bibr"> ▸</xref>), this structure contains several register-shift errors of the kind which could be avoided in other cases in the future by the use of <italic toggle="yes">checkMySequence</italic>. This is particularly important as detailed and exhaustive residue-by-residue analysis of such large models is rarely possible. In this context, the transparent graphical visualization (lower panels in Figs. 7<xref rid="fig7" ref-type="fig"> ▸</xref> and 9<xref rid="fig9" ref-type="fig"> ▸</xref>) and clear text summary of the validation results in the command-line output of <italic toggle="yes">checkMySequence</italic> (Fig. 8<xref rid="fig8" ref-type="fig"> ▸</xref>) should be of particular interest to users.</p>
  </sec>
</body>
<back>
  <ack>
    <p>We would like to thank all of the microscopists who decided to deposit half-maps in EMDB. Although not strictly required, this was of great help while developing <italic toggle="yes">checkMySequence</italic>. Furthermore, we thank Daniel Rigden and Alice Bochel for critical reading of the manuscript and very helpful comments. We also thank Filomeno Sanchez Rodriguez for valuable discussions and help with software testing. Open access funding enabled and organized by Projekt DEAL.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="bb1">
      <mixed-citation publication-type="other">Afonine, P. V., Poon, B. K., Read, R. J., Sobolev, O. V., Terwilliger, T. C., Urzhumtsev, A. &amp; Adams, P. D. (2018). <italic toggle="yes">Acta Cryst.</italic> D<bold>74</bold>, 531–544.</mixed-citation>
    </ref>
    <ref id="bb2">
      <mixed-citation publication-type="other">Allegretti, M., Zimmerli, C. E., Rantos, V., Wilfling, F., Ronchi, P., Fung, H. K. H., Lee, C.-W., Hagen, W., Turoňová, B., Karius, K., Börmel, M., Zhang, X., Müller, C. W., Schwab, Y., Mahamid, J., Pfander, B., Kosinski, J. &amp; Beck, M. (2020). <italic toggle="yes">Nature</italic>, <bold>586</bold>, 796–800.</mixed-citation>
    </ref>
    <ref id="bb3">
      <mixed-citation publication-type="other">Azumaya, C. M., Sierra-Valdez, F., Cordero-Morales, J. F. &amp; Nakagawa, T. (2018). <italic toggle="yes">J. Biol. Chem.</italic>
<bold>293</bold>, 10381–10391.</mixed-citation>
    </ref>
    <ref id="bb4">
      <mixed-citation publication-type="other">Baek, M., DiMaio, F., Anishchenko, I., Dauparas, J., Ovchinnikov, S., Lee, G. R., Wang, J., Cong, Q., Kinch, L. N., Schaeffer, R. D., Millán, C., Park, H., Adams, C., Glassman, C. R., DeGiovanni, A., Pereira, J. H., Rodrigues, A. V., van Dijk, A. A., Ebrecht, A. C., Opperman, D. J., Sagmeister, T., Buhlheller, C., Pavkov-Keller, T., Rathina­swamy, M. K., Dalwadi, U., Yip, C. K., Burke, J. E., Garcia, K. C., Grishin, N. V., Adams, P. D., Read, R. J. &amp; Baker, D. (2021). <italic toggle="yes">Science</italic>, <bold>373</bold>, 871–876.</mixed-citation>
    </ref>
    <ref id="bb5">
      <mixed-citation publication-type="other">Bai, Y., Yu, X., Chen, H., Horne, D., White, R., Wu, X., Lee, P., Gu, Y., Ghimire-Rijal, S., Lin, D. C. H. &amp; Huang, X. (2020). <italic toggle="yes">eLife</italic>, <bold>9</bold>, e53311.</mixed-citation>
    </ref>
    <ref id="bb6">
      <mixed-citation publication-type="other">Barad, B. A., Echols, N., Wang, R. Y.-R., Cheng, Y., DiMaio, F., Adams, P. D. &amp; Fraser, J. S. (2015). <italic toggle="yes">Nat. Methods</italic>, <bold>12</bold>, 943–946.</mixed-citation>
    </ref>
    <ref id="bb7">
      <mixed-citation publication-type="other">Beckham, K. S. H., Ritter, C., Chojnowski, G., Ziemianowicz, D. S., Mullapudi, E., Rettel, M., Savitski, M. M., Mortensen, S. A., Kosinski, J. &amp; Wilmanns, M. (2021). <italic toggle="yes">Sci. Adv.</italic>
<bold>7</bold>, eabg9923.</mixed-citation>
    </ref>
    <ref id="bb8">
      <mixed-citation publication-type="other">Berman, H. M., Westbrook, J., Feng, Z., Gilliland, G., Bhat, T. N., Weissig, H., Shindyalov, I. N. &amp; Bourne, P. E. (2000). <italic toggle="yes">Nucleic Acids Res.</italic>
<bold>28</bold>, 235–242.</mixed-citation>
    </ref>
    <ref id="bb9">
      <mixed-citation publication-type="other">Casañal, A., Lohkamp, B. &amp; Emsley, P. (2020). <italic toggle="yes">Protein Sci.</italic>
<bold>29</bold>, 1055–1064.</mixed-citation>
    </ref>
    <ref id="bb10">
      <mixed-citation publication-type="other">Chen, V. B., Arendall, W. B., Headd, J. J., Keedy, D. A., Immormino, R. M., Kapral, G. J., Murray, L. W., Richardson, J. S. &amp; Richardson, D. C. (2010). <italic toggle="yes">Acta Cryst.</italic> D<bold>66</bold>, 12–21.</mixed-citation>
    </ref>
    <ref id="bb11">
      <mixed-citation publication-type="other">Chojnowski, G., Simpkin, A. J., Leonardo, D. A., Seifert-Davila, W., Vivas-Ruiz, D. E., Keegan, R. M. &amp; Rigden, D. J. (2022). <italic toggle="yes">IUCrJ</italic>, <bold>9</bold>, 86–97.</mixed-citation>
    </ref>
    <ref id="bb12">
      <mixed-citation publication-type="other">Chojnowski, G., Sobolev, E., Heuser, P. &amp; Lamzin, V. S. (2021). <italic toggle="yes">Acta Cryst.</italic> D<bold>77</bold>, 142–150.</mixed-citation>
    </ref>
    <ref id="bb13">
      <mixed-citation publication-type="other">Croll, T. I. (2018). <italic toggle="yes">Acta Cryst.</italic> D<bold>74</bold>, 519–530.</mixed-citation>
    </ref>
    <ref id="bb14">
      <mixed-citation publication-type="other">Croll, T. I., Diederichs, K., Fischer, F., Fyfe, C. D., Gao, Y., Horrell, S., Joseph, A. P., Kandler, L., Kippes, O., Kirsten, F., Müller, K., Nolte, K., Payne, A. M., Reeves, M., Richardson, J. S., Santoni, G., Stäb, S., Tronrud, D. E., von Soosten, L. C., Williams, C. J. &amp; Thorn, A. (2021). <italic toggle="yes">Nat. Struct. Mol. Biol.</italic>
<bold>28</bold>, 404–408.</mixed-citation>
    </ref>
    <ref id="bb15">
      <mixed-citation publication-type="other">Croll, T. I., Williams, C. J., Chen, V. B., Richardson, D. C. &amp; Richardson, J. S. (2021). <italic toggle="yes">Biophys. J.</italic>
<bold>120</bold>, 1085–1096.</mixed-citation>
    </ref>
    <ref id="bb16">
      <mixed-citation publication-type="other">Eddy, S. R. (2011). <italic toggle="yes">PLoS Comput. Biol.</italic>
<bold>7</bold>, e1002195.</mixed-citation>
    </ref>
    <ref id="bb17">
      <mixed-citation publication-type="other">Evans, R., O’Neill, M., Pritzel, A., Antropova, N., Senior, A., Green, T., Židek, A., Bates, R., Blackwell, S., Yim, J. &amp; Ronneberger, O., Bodenstein, S., Zielinski, M., Bridgland, A., Potapenko, A., Cowie, A., Tunyasuvunakool, K., Jain, R., Clancy, E., Kohli, P., Jumper, J. &amp; Hassabis, D. (2021). <italic toggle="yes">bioRxiv</italic>, 2021.10.04.463034.</mixed-citation>
    </ref>
    <ref id="bb18">
      <mixed-citation publication-type="other">Grosse-Kunstleve, R. W., Sauter, N. K., Moriarty, N. W. &amp; Adams, P. D. (2002). <italic toggle="yes">J. Appl. Cryst.</italic>
<bold>35</bold>, 126–136.</mixed-citation>
    </ref>
    <ref id="bb19">
      <mixed-citation publication-type="other">Hoh, S. W., Burnley, T. &amp; Cowtan, K. (2020). <italic toggle="yes">Acta Cryst.</italic> D<bold>76</bold>, 531–541.</mixed-citation>
    </ref>
    <ref id="bb20">
      <mixed-citation publication-type="other">Joosten, R. P., Long, F., Murshudov, G. N. &amp; Perrakis, A. (2014). <italic toggle="yes">IUCrJ</italic>, <bold>1</bold>, 213–220.</mixed-citation>
    </ref>
    <ref id="bb21">
      <mixed-citation publication-type="other">Joseph, A. P., Malhotra, S., Burnley, T., Wood, C., Clare, D. K., Winn, M. &amp; Topf, M. (2016). <italic toggle="yes">Methods</italic>, <bold>100</bold>, 42–49.</mixed-citation>
    </ref>
    <ref id="bb22">
      <mixed-citation publication-type="other">Jumper, J., Evans, R., Pritzel, A., Green, T., Figurnov, M., Ronneberger, O., Tunyasuvunakool, K., Bates, R., Žídek, A., Potapenko, A., Bridgland, A., Meyer, C., Kohl, S. A. A., Ballard, A. J., Cowie, A., Romera-Paredes, B., Nikolov, S., Jain, R., Adler, J., Back, T., Petersen, S., Reiman, D., Clancy, E., Zielinski, M., Steinegger, M., Pacholska, M., Berghammer, T., Bodenstein, S., Silver, D., Vinyals, O., Senior, A. W., Kavukcuoglu, K., Kohli, P. &amp; Hassabis, D. (2021). <italic toggle="yes">Nature</italic>, <bold>596</bold>, 583–589.</mixed-citation>
    </ref>
    <ref id="bb23">
      <mixed-citation publication-type="other">Kokic, G., Hillen, H. S., Tegunov, D., Dienemann, C., Seitz, F., Schmitzova, J., Farnung, L., Siewert, A., Höbartner, C. &amp; Cramer, P. (2021). <italic toggle="yes">Nat. Commun.</italic>
<bold>12</bold>, 279.</mixed-citation>
    </ref>
    <ref id="bb24">
      <mixed-citation publication-type="other">Kucukelbir, A., Sigworth, F. J. &amp; Tagare, H. D. (2014). <italic toggle="yes">Nat. Methods</italic>, <bold>11</bold>, 63–65.</mixed-citation>
    </ref>
    <ref id="bb25">
      <mixed-citation publication-type="other">Kühlbrandt, W. (2014). <italic toggle="yes">Science</italic>, <bold>343</bold>, 1443–1444.</mixed-citation>
    </ref>
    <ref id="bb26">
      <mixed-citation publication-type="other">Lawson, C. L., Kryshtafovych, A., Adams, P. D., Afonine, P. V., Baker, M. L., Barad, B. A., Bond, P., Burnley, T., Cao, R., Cheng, J., Chojnowski, G., Cowtan, K., Dill, K. A., DiMaio, F., Farrell, D. P., Fraser, J. S., Herzik, M. A. Jr, Hoh, S. W., Hou, J., Hung, L., Igaev, M., Joseph, A. P., Kihara, D., Kumar, D., Mittal, S., Monastyrskyy, B., Olek, M., Palmer, C. M., Patwardhan, A., Perez, A., Pfab, J., Pintilie, G. D., Richardson, J. S., Rosenthal, P. B., Sarkar, D., Schäfer, L. U., Schmid, M. F., Schröder, G. F., Shekhar, M., Si, D., Singharoy, A., Terashi, G., Terwilliger, T. C., Vaiana, A., Wang, L., Wang, Z., Wankowicz, S. A., Williams, C. J., Winn, M., Wu, T., Yu, X., Zhang, K., Berman, H. M. &amp; Chiu, W. (2021). <italic toggle="yes">Nat. Methods</italic>, <bold>18</bold>, 156–164.</mixed-citation>
    </ref>
    <ref id="bb27">
      <mixed-citation publication-type="other">Liebschner, D., Afonine, P. V., Moriarty, N. W., Poon, B. K., Chen, V. B. &amp; Adams, P. D. (2021). <italic toggle="yes">Acta Cryst.</italic> D<bold>77</bold>, 48–61.</mixed-citation>
    </ref>
    <ref id="bb28">
      <mixed-citation publication-type="other">Mirdita, M., Ovchinnikov, S. &amp; Steinegger, M. (2021). <italic toggle="yes">bioRxiv</italic>, 2021.08.15.456425.</mixed-citation>
    </ref>
    <ref id="bb29">
      <mixed-citation publication-type="other">Mosalaganti, S., Obarska-Kosinska, A., Siggel, M., Turonova, B., Zimmerli, C. E., Buczak, K., Schmidt, F. H., Margiotta, E., Mackmull, M.-T., Hagen, W., Hummer, G., Beck, M. &amp; Kosinski, J. (2021). <italic toggle="yes">bioRxiv</italic>, 2021.10.26.465776.</mixed-citation>
    </ref>
    <ref id="bb30">
      <mixed-citation publication-type="other">Nicholls, R. A., Tykac, M., Kovalevskiy, O. &amp; Murshudov, G. N. (2018). <italic toggle="yes">Acta Cryst.</italic> D<bold>74</bold>, 492–505.</mixed-citation>
    </ref>
    <ref id="bb31">
      <mixed-citation publication-type="other">Oliphant, T. E. (2006). <italic toggle="yes">A Guide to NumPy</italic>. USA: Trelgol Publishing.</mixed-citation>
    </ref>
    <ref id="bb32">
      <mixed-citation publication-type="other">Paszke, A., Gross, S., Massa, F., Lerer, A., Bradbury, J., Chanan, G., Killeen, T., Lin, Z., Gimelshein, N., Antiga, L., Desmaison, A., Köpf, A., Yang, E., DeVito, Z., Raison, M., Tejani, A., Chilamkurthy, S., Steiner, B., Fang, L., Bai, J. &amp; Chintala, S. (2019). <italic toggle="yes">arXiv</italic>:1912.01703.</mixed-citation>
    </ref>
    <ref id="bb33">
      <mixed-citation publication-type="other">Perrakis, A. &amp; Sixma, T. K. (2021). <italic toggle="yes">EMBO Rep.</italic>
<bold>22</bold>, e54046.</mixed-citation>
    </ref>
    <ref id="bb34">
      <mixed-citation publication-type="other">Pintilie, G., Zhang, K., Su, Z., Li, S., Schmid, M. F. &amp; Chiu, W. (2020). <italic toggle="yes">Nat. Methods</italic>, <bold>17</bold>, 328–334.</mixed-citation>
    </ref>
    <ref id="bb35">
      <mixed-citation publication-type="other">Richardson, J. S., Williams, C. J., Videau, L. L., Chen, V. B. &amp; Richardson, D. C. (2018). <italic toggle="yes">J. Struct. Biol.</italic>
<bold>204</bold>, 301–312.</mixed-citation>
    </ref>
    <ref id="bb36">
      <mixed-citation publication-type="other">Terwilliger, T. C., Adams, P. D., Afonine, P. V. &amp; Sobolev, O. V. (2018). <italic toggle="yes">Nat. Methods</italic>, <bold>15</bold>, 905–908.</mixed-citation>
    </ref>
    <ref id="bb37">
      <mixed-citation publication-type="other">Varadi, M., Anyango, S., Deshpande, M., Nair, S., Natassia, C., Yordanova, G., Yuan, D., Stroe, O., Wood, G., Laydon, A., Žídek, A., Green, T., Tunyasuvunakool, K., Petersen, S., Jumper, J., Clancy, E., Green, R., Vora, A., Lutfi, M., Figurnov, M., Cowie, A., Hobbs, N., Kohli, P., Kleywegt, G., Birney, E., Hassabis, D. &amp; Velankar, S. (2022). <italic toggle="yes">Nucleic Acids Res.</italic>
<bold>50</bold>, D439–D444.</mixed-citation>
    </ref>
    <ref id="bb38">
      <mixed-citation publication-type="other">Velankar, S., van Ginkel, G., Alhroub, Y., Battle, G. M., Berrisford, J. M., Conroy, M. J., Dana, J. M., Gore, S. P., Gutmanas, A., Haslam, P., Hendrickx, P., Lagerstedt, I., Mir, S., Fernandez Montecelo, M. A., Mukhopadhyay, A., Oldfield, T. J., Patwardhan, A., Sanz-García, E., Sen, S., Slowley, R. A., Wainwright, M. E., Deshpande, M. S., Iudin, A., Sahni, G., Salavert Torres, J., Hirshberg, M., Mak, L., Nadzirin, N., Armstrong, D. R., Clark, A. R., Smart, O. S., Korir, P. K. &amp; Kleywegt, G. J. (2016). <italic toggle="yes">Nucleic Acids Res.</italic>
<bold>44</bold>, D385–D395.</mixed-citation>
    </ref>
    <ref id="bb39">
      <mixed-citation publication-type="other">Virtanen, P., Gommers, R., Oliphant, T. E., Haberland, M., Reddy, T., Cournapeau, D., Burovski, E., Peterson, P., Weckesser, W., Bright, J., van der Walt, S. J., Brett, M., Wilson, J., Millman, K. J., Mayorov, N., Nelson, A. R. J., Jones, E., Kern, R., Larson, E., Carey, C. J., Polat, İ., Feng, Y., Moore, E. W., VanderPlas, J., Laxalde, D., Perktold, J., Cimrman, R., Henriksen, I., Quintero, E. A., Harris, C. R., Archibald, A. M., Ribeiro, A. H., Pedregosa, F., van Mulbregt, P., Vijaykumar, A., Bardelli, A. P., Rothberg, A., Hilboll, A., Kloeckner, A., Scopatz, A., Lee, A., Rokem, A., Woods, C. N., Fulton, C., Masson, C., Häggström, C., Fitzgerald, C., Nicholson, D. A., Hagen, D. R., Pasechnik, D. V., Olivetti, E., Martin, E., Wieser, E., Silva, F., Lenders, F., Wilhelm, F., Young, G., Price, G. A., Ingold, G., Allen, G. E., Lee, G. R., Audren, H., Probst, I., Dietrich, J. P., Silterra, J., Webber, J. T., Slavič, J., Nothman, J., Buchner, J., Kulick, J., Schönberger, J. L., de Miranda Cardoso, J. V., Reimer, J., Harrington, J., Rodríguez, J. L. C., Nunez-Iglesias, J., Kuczynski, J., Tritz, K., Thoma, M., Newville, M., Kümmerer, M., Bolingbroke, M., Tartre, M., Pak, M., Smith, N. J., Nowaczyk, N., Shebanov, N., Pavlyk, O., Brodtkorb, P. A., Lee, P., McGibbon, R. T., Feldbauer, R., Lewis, S., Tygier, S., Sievert, S., Vigna, S., Peterson, S., More, S., Pudlik, T., Oshima, T., Pingel, T. J., Robitaille, T. P., Spura, T., Jones, T. R., Cera, T., Leslie, T., Zito, T., Krauss, T., Upadhyay, U., Halchenko, Y. O. &amp; Vázquez-Baeza, Y. (2020). <italic toggle="yes">Nat. Methods</italic>, <bold>17</bold>, 261–272.</mixed-citation>
    </ref>
    <ref id="bb40">
      <mixed-citation publication-type="other">Winn, M. D., Ballard, C. C., Cowtan, K. D., Dodson, E. J., Emsley, P., Evans, P. R., Keegan, R. M., Krissinel, E. B., Leslie, A. G. W., McCoy, A., McNicholas, S. J., Murshudov, G. N., Pannu, N. S., Potterton, E. A., Powell, H. R., Read, R. J., Vagin, A. &amp; Wilson, K. S. (2011). <italic toggle="yes">Acta Cryst.</italic> D<bold>67</bold>, 235–242.</mixed-citation>
    </ref>
    <ref id="bb41">
      <mixed-citation publication-type="other">Yin, W., Mao, C., Luan, X., Shen, D.-D., Shen, Q., Su, H., Wang, X., Zhou, F., Zhao, W., Gao, M., Chang, S., Xie, Y.-C., Tian, G., Jiang, H.-W., Tao, S.-C., Shen, J., Jiang, Y., Jiang, H., Xu, Y., Zhang, S., Zhang, Y. &amp; Xu, H. E. (2020). <italic toggle="yes">Science</italic>, <bold>368</bold>, 1499–1504.</mixed-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig position="float" id="fig1">
    <label>Figure 1</label>
    <caption>
      <p>Flowchart of a model-sequence validation procedure. The dashed box in (<italic toggle="yes">a</italic>) encloses the initial steps of reference-sequence identification for each protein chain in the input model. If a reference sequence can be identified, the chain is divided into continuous test fragments that are systematically assigned to the reference sequence (<italic toggle="yes">b</italic>). The method reports possible issues (red boxes) if a reference sequence cannot be identified or if a sequence assigned to a test fragment with high confidence (<italic toggle="yes">p</italic>-value below the threshold) does not match the input model.</p>
    </caption>
    <graphic xlink:href="d-78-00806-fig1" position="float"/>
  </fig>
  <fig position="float" id="fig2">
    <label>Figure 2</label>
    <caption>
      <p>Comparison of sequence-assignment results for 166 713 protein-chain test fragments of 20 residues from the benchmark set. Distribution of (<italic toggle="yes">a</italic>) <italic toggle="yes">p</italic>-value and (<italic toggle="yes">b</italic>) mean local resolution of test fragments for which the assigned sequence matches and differs from the reference model. The dashed line in (<italic toggle="yes">a</italic>) corresponds to a 99.5% one-sided confidence interval estimated for fragments with an assigned sequence that differs from the reference.</p>
    </caption>
    <graphic xlink:href="d-78-00806-fig2" position="float"/>
  </fig>
  <fig position="float" id="fig3">
    <label>Figure 3</label>
    <caption>
      <p>Medians and 90% confidence intervals for the sequence-assignment <italic toggle="yes">p</italic>-value as a function of local resolution for protein-chain test fragments of 20 and 40 amino-acid residues (20aa and 40aa, respectively). (<italic toggle="yes">a</italic>) shows fragments with sequences matching the reference. Fragments for which the assigned and reference model sequences differ are presented in (<italic toggle="yes">b</italic>). The dashed line corresponds to a 99.5% one-sided confidence interval estimated for fragments of 20 amino acids with an assigned sequence that differs from the input model sequence. Orange circles depict an outlier that is discussed in the text (the cytoplasmic domain of a transient receptor potential channel; PDB entry <ext-link xlink:href="https://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=6cv9" ext-link-type="uri">6cv9</ext-link>). The ordinate axes show −log(<italic toggle="yes">p</italic>-value) for the test fragments; higher values correspond to lower <italic toggle="yes">p</italic>-values and more reliable sequence assignments.</p>
    </caption>
    <graphic xlink:href="d-78-00806-fig3" position="float"/>
  </fig>
  <fig position="float" id="fig4">
    <label>Figure 4</label>
    <caption>
      <p>Medians and 90% confidence intervals for the sequence-assignment <italic toggle="yes">p</italic>-value as a function of local resolution. Data are shown for protein-chain fragments of 20 and 40 amino-acid residues (20aa and 40aa, respectively) for models as deposited and in the presence of artificial coordinate bias. (<italic toggle="yes">a</italic>) shows fragments with sequences matching the reference. Fragments for which the reassigned and reference sequences differ are presented in (<italic toggle="yes">b</italic>). The dashed line corresponds to a 99.5% one-sided confidence interval estimated for fragments of 20 amino acids with an assigned sequence that differs from the corresponding input model sequence. The ordinate axes show −log(<italic toggle="yes">p</italic>-value) for the test fragments; higher values correspond to lower <italic toggle="yes">p</italic>-values and more reliable sequence assignments.</p>
    </caption>
    <graphic xlink:href="d-78-00806-fig4" position="float"/>
  </fig>
  <fig position="float" id="fig5">
    <label>Figure 5</label>
    <caption>
      <p>Median and 90% confidence intervals for the sequence-assignment <italic toggle="yes">p</italic>-value as a function of local resolution. Data are shown for protein-chain fragments of 20 and 40 amino acids (20aa and 40aa, respectively) and corresponding maps as deposited or sharpened by −100 Å<sup>2</sup>. (<italic toggle="yes">a</italic>) shows fragments with sequences matching the reference. Fragments for which assigned and reference-model sequences differ are presented in (<italic toggle="yes">b</italic>). The dashed line corresponds to a 99.5% one-sided confidence interval estimated for fragments of 20 amino acids with an assigned sequence that differs from the corresponding input model sequence. The ordinate axes show −log(<italic toggle="yes">p</italic>-value) for the test fragments; higher values correspond to lower <italic toggle="yes">p</italic>-values and more reliable sequence assignments.</p>
    </caption>
    <graphic xlink:href="d-78-00806-fig5" position="float"/>
  </fig>
  <fig position="float" id="fig6">
    <label>Figure 6</label>
    <caption>
      <p>Relative change in <italic toggle="yes">E</italic>-value estimates for reference sequences identified by <italic toggle="yes">checkMySequence</italic> using the <italic toggle="yes">HMMER</italic> suite. The effect of (<italic toggle="yes">a</italic>) map blurring or sharpening (<italic toggle="yes">B</italic>-factor correction of +100 and −100 Å<sup>2</sup>, respectively) and (<italic toggle="yes">b</italic>) model coordinate bias. <italic toggle="yes">E</italic>
<sub>ref</sub> refers to <italic toggle="yes">E</italic>-values obtained for reference models and maps, whereas <italic toggle="yes">E</italic>
<sub>mod</sub> was obtained for the same map–model pairs after applying coordinate bias or map sharpening/blurring.</p>
    </caption>
    <graphic xlink:href="d-78-00806-fig6" position="float"/>
  </fig>
  <fig position="float" id="fig7">
    <label>Figure 7</label>
    <caption>
      <p>Fragment of an RNA-dependent RNA polymerase model. (<italic toggle="yes">a</italic>) Originally deposited version (PDB entry <ext-link xlink:href="https://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=7bv2" ext-link-type="uri">7bv2</ext-link>/EMDB entry <ext-link xlink:href="https://scripts.iucr.org/cgi-bin/cr.cgi?rm=emdb&amp;emdbId=EMD-30210" ext-link-type="uri">EMD-30210</ext-link>, residues A/908–A/917) and (<italic toggle="yes">b</italic>) the model deposited by the authors after applying a register-shift error that was also suggested by <italic toggle="yes">checkMySequence</italic> (residues A/917–A/926). The bottom panels depict standard <italic toggle="yes">checkMySequence</italic> graphical output for the (<italic toggle="yes">c</italic>) originally deposited and (<italic toggle="yes">d</italic>) corrected models. Grey bars represent fragments for which the assigned sequence matches the model or has a <italic toggle="yes">p</italic>-value higher than the threshold (dashed line). The red bar in (<italic toggle="yes">c</italic>) represents a fragment with register error, part of which is shown in (<italic toggle="yes">a</italic>). The bar plots show −log(<italic toggle="yes">p</italic>-value) for the test fragments; higher bars correspond to lower <italic toggle="yes">p</italic>-values and more reliable sequence assignments (be they correct or erroneous).</p>
    </caption>
    <graphic xlink:href="d-78-00806-fig7" position="float"/>
  </fig>
  <fig position="float" id="fig8">
    <label>Figure 8</label>
    <caption>
      <p>Standard text output of <italic toggle="yes">checkMySequence</italic> for the originally deposited version of the RNA-dependent RNA polymerase model (PDB entry <ext-link xlink:href="https://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=7bv2" ext-link-type="uri">7bv2</ext-link>/EMDB entry <ext-link xlink:href="https://scripts.iucr.org/cgi-bin/cr.cgi?rm=emdb&amp;emdbId=EMD-30210" ext-link-type="uri">EMD-30210</ext-link>). The program prints possible issues with unidentified reference sequences, sequence mismatches and register errors.</p>
    </caption>
    <graphic xlink:href="d-78-00806-fig8" position="float"/>
  </fig>
  <fig position="float" id="fig9">
    <label>Figure 9</label>
    <caption>
      <p>Fragment of the mTRPC6 cytoplasmic domain at 3.8 Å resolution (<italic toggle="yes">a</italic>) deposited in the PDB (PDB entry <ext-link xlink:href="https://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=6cv9" ext-link-type="uri">6cv9</ext-link>/EMDB entry <ext-link xlink:href="https://scripts.iucr.org/cgi-bin/cr.cgi?rm=emdb&amp;emdbId=EMD-7637" ext-link-type="uri">EMD-7637</ext-link>, residues A/258–A/272) and the same fragment rebuilt using <italic toggle="yes">AlphaFold</italic>2 prediction (Q61143, residues A/264–A/280; the pLDDT for this region exceeds 90). The bottom panels depict the corresponding <italic toggle="yes">checkMySequence</italic> graphical outputs for the (<italic toggle="yes">c</italic>) originally deposited and (<italic toggle="yes">d</italic>) corrected models. Grey bars represent fragments for which the assigned sequence matches the model or has a <italic toggle="yes">p</italic>-value higher than the threshold (dashed line). The red bars in (<italic toggle="yes">c</italic>) represent fragments with plausible register errors, including the α-helix shown in (<italic toggle="yes">a</italic>). The bar plots show −log(<italic toggle="yes">p</italic>-value) for the test fragments; higher bars correspond to lower <italic toggle="yes">p</italic>-values and more reliable sequence assignments.</p>
    </caption>
    <graphic xlink:href="d-78-00806-fig9" position="float"/>
  </fig>
</floats-group>
