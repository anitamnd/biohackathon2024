<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10206090</article-id>
    <article-id pub-id-type="pmid">37166448</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad314</article-id>
    <article-id pub-id-type="publisher-id">btad314</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CscoreTool-M infers 3D sub-compartment probabilities within cell population</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9599-8525</contrib-id>
        <name>
          <surname>Zheng</surname>
          <given-names>Xiaobin</given-names>
        </name>
        <aff><institution>Department of Embryology, Carnegie Institution for Science</institution>, Baltimore, MD 21218, <country country="US">United States</country></aff>
        <xref rid="btad314-cor1" ref-type="corresp"/>
        <!--xzheng@carnegiescience.edu-->
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7467-8995</contrib-id>
        <name>
          <surname>Tran</surname>
          <given-names>Joseph R</given-names>
        </name>
        <aff><institution>Department of Embryology, Carnegie Institution for Science</institution>, Baltimore, MD 21218, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zheng</surname>
          <given-names>Yixian</given-names>
        </name>
        <aff><institution>Department of Embryology, Carnegie Institution for Science</institution>, Baltimore, MD 21218, <country country="US">United States</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Boeva</surname>
          <given-names>Valentina</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad314-cor1">Corresponding author. Department of Embryology, Carnegie Institution for Science, Baltimore, MD 21218, USA. E-mail: <email>xzheng@carnegiescience.edu</email> (X.Z.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-05-11">
      <day>11</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>5</issue>
    <elocation-id>btad314</elocation-id>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>7</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>07</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>04</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>23</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad314.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Computational inference of genome organization based on Hi-C sequencing has greatly aided the understanding of chromatin and nuclear organization in three dimensions (3D). However, existing computational methods fail to address the cell population heterogeneity. Here we describe a probabilistic-modeling-based method called CscoreTool-M that infers multiple 3D genome sub-compartments from Hi-C data.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>The compartment scores inferred using CscoreTool-M represents the probability of a genomic region locating in a specific sub-compartment. Compared to published methods, CscoreTool-M is more accurate in inferring sub-compartments corresponding to both active and repressed chromatin. The compartment scores calculated by CscoreTool-M also help to quantify the levels of heterogeneity in sub-compartment localization within cell populations. By comparing proliferating cells and terminally differentiated non-proliferating cells, we show that the proliferating cells have higher genome organization heterogeneity, which is likely caused by cells at different cell-cycle stages. By analyzing 10 sub-compartments, we found a sub-compartment containing chromatin potentially related to the early-G1 chromatin regions proximal to the nuclear lamina in HCT116 cells, suggesting the method can deconvolve cell cycle stage-specific genome organization among asynchronously dividing cells. Finally, we show that CscoreTool-M can identify sub-compartments that contain genes enriched in housekeeping or cell-type-specific functions.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p><ext-link xlink:href="https://github.com/scoutzxb/CscoreTool-M" ext-link-type="uri">https://github.com/scoutzxb/CscoreTool-M</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01GM106023</award-id>
        <award-id>R01GM110151</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="12"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>One important question in biology pertains to how DNA is packaged and organized in the small nuclear space of eukaryotes so that gene expression can be temporally and spatially regulated during organism development and homeostasis. The nucleus is a complicated structure with many functional subunits, such as the nuclear speckles, the nucleolus, and the nuclear lamina. These units have been recognized as organization hubs of the genome for specific functions. How these hubs are organized with respect to one another and to the 3D chromatin interactions remains, however, poorly understood. As a result, it is unclear how the different genomic units work together to regulate gene expression in the context of organism development and function.</p>
    <p>The genomic sequences associated with the nuclear lamina, speckles, and nucleoli have been mapped (<xref rid="btad314-B10" ref-type="bibr">Guelen et al. 2008</xref>; <xref rid="btad314-B19" ref-type="bibr">Németh et al. 2010</xref>; <xref rid="btad314-B8" ref-type="bibr">Chen et al. 2018</xref>). The genes in the nuclear lamina-associated chromatin domains (LADs) are largely silenced and the LADs are generally gene-poor with overall repressive epigenetic features. Nuclear speckles are enriched for transcribed genes that create a transcriptionally active environment. Thus, chromatin associated with the speckles show active epigenetic features. It remains unclear if the actively transcribed house-keeping genes and cell-type specific genes are organized into the same or different speckles and if the organization shows any cell type specificity. Nucleoli are involved in transcribing ribosomal RNAs and ribosome assembly. Although nucleoli are mostly found away from the nuclear periphery, the nucleolus-associated chromatin domains (NADs) largely overlap with LADs. In addition, lamins, the major structural component of the nuclear lamina, have been found to be associated with nucleolus (<xref rid="btad314-B15" ref-type="bibr">Martin et al. 2009</xref>; <xref rid="btad314-B25" ref-type="bibr">Sen Gupta 2017</xref>), but it is unclear whether this can fully explain the overlap observed between NADs and LADs. Moreover, how NADs and LADs are organized with respect to one another and to the rest of the genome is poorly understood.</p>
    <p>Many efforts have been devoted to understanding nuclear and genome organization. Among the numerous methods developed, the imaging approaches, such as fluorescence in situ hybridization to visualize DNA, RNA, and immunostaining to visualize proteins, allow simultaneous visualization of proteins, DNA, and RNA transcripts in individual cells. Whereas imaging approaches are important to understand the heterogeneity of nuclear and genome organization and transcriptional activity in cells, they are limited to regions of the nucleus where the probes are designed. Recent advances in barcoding and iterative hybridization approaches have enabled imaging of thousands of genomic loci in the same cell (<xref rid="btad314-B4" ref-type="bibr">Bintu et al. 2018</xref>; <xref rid="btad314-B27" ref-type="bibr">Takei et al. 2021</xref>), but the resolution is still limited.</p>
    <p>To overcome the limitations of imaging approaches, direct DNA sequencing has been used to study genomic regions associated with specific nuclear substructures, transcription factors, or epigenetic modifications. The <italic toggle="yes">Ch</italic>romatin <italic toggle="yes">I</italic>mmuno<italic toggle="yes">P</italic>recipitation followed by massive parallel <italic toggle="yes">seq</italic>uencing (ChIP-seq) (<xref rid="btad314-B16" ref-type="bibr">Mikkelsen et al. 2007</xref>) has been used extensively to understand epigenetic modification and transcription factor interaction with chromatin, but the method does not offer information on 3D chromatin organization or sub-nuclear structures. Several methods, including DNA adenine methylase identification (DamID) (<xref rid="btad314-B10" ref-type="bibr">Guelen et al. 2008</xref>), nucleolar sequencing (<xref rid="btad314-B19" ref-type="bibr">Németh et al. 2010</xref>), Ascorbate Peroxidase (APEX)-based map of LADs (<xref rid="btad314-B29" ref-type="bibr">Tran et al. 2021</xref>), Tyramide-Signal Amplification (TSA)-seq (<xref rid="btad314-B8" ref-type="bibr">Chen et al. 2018</xref>), and chromatin pull down based TSA-seq (cTSA-seq) (<xref rid="btad314-B30" ref-type="bibr">Tran et al. 2022</xref>) have been developed to map the genomic regions associated with nuclear lamina, nucleolar, and nuclear speckles. Finally, chromatin conformation capture based methods, including Hi-C (<xref rid="btad314-B13" ref-type="bibr">Lieberman-Aiden et al. 2009</xref>), were developed to identify interactions between different chromatin regions, which allowed the reconstruction of the 3D chromatin interaction and folding. However, more computational efforts are still needed to fill in the gaps between the DNA-DNA interaction profile and nuclear substructure-associated chromatin domains.</p>
    <p>The A/B compartment concept was introduced in the first Hi-C study. By applying principal component analysis to the distance-normalized Hi-C interaction profile, Lieberman-Aiden et al. discovered that the genome can be separated into the two large compartments, namely the A- and B-compartment (<xref rid="btad314-B13" ref-type="bibr">Lieberman-Aiden et al. 2009</xref>). Genomic regions in the A-compartment have a higher chance to interact within the A-compartment, while genomic regions in the B-compartment have a higher chance of interactions with one another. By analyzing epigenome, transcriptome, and LADs in A/B compartments, it became clear that B compartments contain LADs and additional heterochromatin regions, while the A compartments were enriched for active euchromatin. We developed a model-based method, CscoreTool, to provide A–B compartment inference at higher resolution, better accuracy, and lower computational cost (<xref rid="btad314-B34" ref-type="bibr">Zheng and Zheng 2018</xref>; <xref rid="btad314-B33" ref-type="bibr">Zheng et al. 2018</xref>). These compartment studies suggest that the 3D chromatin interactions mapped by Hi-C can be used to define local chromatin compartments that share high interactions within each compartment.</p>
    <p>To reveal more detailed 3D chromatin compartments, Rao et al. used high-resolution Hi-C and Gaussian Hidden Markov Model-based clustering method to generate six sub-compartments and their further analyses linked some of these sub-compartments to the LADs, NADs, and speckle-associated chromatin (<xref rid="btad314-B21" ref-type="bibr">Rao et al. 2014</xref>). Although the algorithm used by Rao et al. represents an important progress in identifying the sub-compartments of the genome, there are several limitations. For example, the method arbitrarily separates the genome into “even” and “odd” chromosomes and clusters them separately. The compartments inferred from the even and odd chromosomes may not match each other. In addition, the method does not take into consideration the heterogeneity of genome interactions in individual cells known to exist even within a given cell type. Another recent method, called SNIPER (<xref rid="btad314-B32" ref-type="bibr">Xiong and Ma 2019</xref>), used a neural network to “impute” low-depth dataset and inferred sub-compartments. However, this method is supervised and depends on Rao et al.’s results using the GM12878 dataset. Thus, SNIPER suffers the same limitations, and it could not be used to infer more than six sub-compartments or be applied to other organisms without a training dataset. Recently, Calder (<xref rid="btad314-B14" ref-type="bibr">Liu et al. 2021</xref>) and SCI (<xref rid="btad314-B2" ref-type="bibr">Ashoor et al. 2020</xref>) were developed as new unsupervised methods to infer sub-compartments from bulk Hi-C data, but these two methods still do not consider the heterogeneity with cell population.</p>
    <p>Here, we introduce CscoreTool-M, a model-based tool to infer multiple sub-compartments of the genome. CscoreTool-M extends the model used in CscoreTool to accommodate more sub-compartments. The compartment scores (Cscores) provided by this method are equal to the probability (or percentage) of cells within the population that a genomic region is in certain sub-compartments. We show that CscoreTool-M can reveal the heterogeneity of genomic sub-compartment relations within the cell population, and it offers a great opportunity to define finer sub-compartment organizations of the genome that are directly related to nuclear sub structures and their functions.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Modeling sub-compartments based on Hi-C dataset obtained from cell populations</title>
      <sec>
        <title>2.1.1. Modeling sub-compartments in population Hi-C data</title>
        <p>We assume that there are totally <italic toggle="yes">M</italic> sub-compartments in the nucleus, and the cell population can be heterogeneous, with each genomic region <italic toggle="yes">i</italic> located to sub-compartment <italic toggle="yes">k</italic> at a probability <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>; <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:math></inline-formula>; <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>.</p>
        <p>Like Rao et al. our model is based on <italic toggle="yes">trans</italic>-interactions (inter-chromosome interactions). Compared to <italic toggle="yes">cis</italic>-interactions (intra-chromosome interactions), <italic toggle="yes">trans</italic>-interactions are not affected by topological domains or other local constraints. Thus, the interaction frequencies are mainly determined by compartment structure.</p>
        <p>The model is based on three hypotheses:<disp-quote content-type="extract"><p>Hypothesis 1: For two different genomic loci, their nuclear sub-compartment locations in cells are independent.</p><p>Hypothesis 2: Two genomic loci located at different nuclear sub-compartments in one cell do not have 3D interaction in that cell.</p><p>Hypothesis 3: Two genomic loci located at the same sub-compartment in one cell have a constant probability of interaction.</p></disp-quote></p>
        <p>Since we only use trans-interactions in the analysis, local structures such as TADs would not violate our hypotheses. However, one potential violation of hypothesis 1 is the Rabl effect in the nucleus. The Rabl effect shows centromere-centromere or telomere-telomere interactions among different chromosomes (<xref rid="btad314-B11" ref-type="bibr">Imakaev et al. 2012</xref>; <xref rid="btad314-B18" ref-type="bibr">Nagano et al. 2017</xref>; <xref rid="btad314-B26" ref-type="bibr">Stevens et al. 2017</xref>). These interactions would violate hypothesis 1 and make the <italic toggle="yes">trans</italic>-interactions at the centromeres or telomeres correlated. To account for the Rabl effect, we added a modification in our model. Assume the Rabl effect can be modeled by a term <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, then based on hypothesis 1, the probability that two genomic loci <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic> are in the same compartment in a cell is:
</p>
        <disp-formula id="E1">
          <label>(1)</label>
          <mml:math id="M1" display="block" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>f</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>R</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mrow>
              <mml:msub>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>Besides the Rabl effect, these three hypotheses may still be violated under various other conditions, and we will discuss the conditions when they are violated and the consequences in Section 2.2.</p>
        <p>Based on hypothesis 2 and 3, the total number of interactions between two genomic loci should be in proportion to the probability that they are in the same genomic sub-compartment. Hi-C experiments are further affected by chromatin accessibility, genome mappability, ligation, and PCR efficiency. All these complication factors are summarized as a bias factor <italic toggle="yes">b<sub>i</sub></italic> for each genomic locus (<xref rid="btad314-B11" ref-type="bibr">Imakaev et al. 2012</xref>), and the total interacting fragments in the Hi-C library could be modeled as:
</p>
        <disp-formula id="E2">
          <label>(2)</label>
          <mml:math id="M2" display="block" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>F</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>B</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:msub>
              <mml:mrow>
                <mml:mi>B</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:msub>
              <mml:mrow>
                <mml:mi>f</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>B</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:msub>
              <mml:mrow>
                <mml:mi>B</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:msub>
              <mml:mrow>
                <mml:mi>R</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mrow>
              <mml:msub>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>We further let <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and the equation becomes:
</p>
        <disp-formula id="E3">
          <label>(3).</label>
          <mml:math id="M3" display="block" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>F</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>R</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mrow>
              <mml:msub>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>C</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>C</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>The observed Hi-C interaction reads between genomic loci <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic>, <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, can be modeled as a Poisson distribution with parameter <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, so we get the final likelihood function:
</p>
        <disp-formula id="E4">
          <label>(4)</label>
          <mml:math id="M4" display="block" overflow="scroll">
            <mml:mi>L</mml:mi>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:mfenced open="[" close="]" separators="|">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">ln</mml:mi>
                      </mml:mrow>
                      <mml:mo>⁡</mml:mo>
                      <mml:mrow>
                        <mml:mfenced open="(" close=")" separators="|">
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>R</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mi>j</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mo stretchy="false">∑</mml:mo>
                                <mml:mrow>
                                  <mml:mi>k</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>C</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>i</mml:mi>
                                    <mml:mi>k</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>C</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>j</mml:mi>
                                    <mml:mi>k</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mo>-</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>R</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mo stretchy="false">∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>C</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>C</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mfenced>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>We further model the Rabl effect by a simple two-parameter function:
</p>
        <disp-formula id="E5">
          <label>(5)</label>
          <mml:math id="M5" display="block" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>R</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mn>1</mml:mn>
            <mml:mo>+</mml:mo>
            <mml:mo>α</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>r</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:msub>
              <mml:mrow>
                <mml:mi>r</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>+</mml:mo>
            <mml:mo>β</mml:mo>
            <mml:mo>(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>r</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>+</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>r</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>)</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>r</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:msub>
              <mml:mrow>
                <mml:mi>r</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
          </mml:math>
        </disp-formula>
        <p>Here, <italic toggle="yes">r<sub>i</sub></italic> corresponds to the relative location of genomic locus <italic toggle="yes">i</italic> on the chromosome. It ranges from –0.5 (centromere) to 0.5 (telomere). <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula> is the second-order coefficient modeling how strong the Rabl effect is, while <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula> is the third-order coefficient modeling the skew (whether the centromere or telomere side has stronger interaction). This model is a simplified version of the third-order power series of of <italic toggle="yes">R<sub>ij</sub></italic> as a function of <italic toggle="yes">r<sub>i</sub></italic> (<italic toggle="yes">x</italic>) and <italic toggle="yes">r<sub>j</sub></italic> (<italic toggle="yes">y</italic>):
</p>
        <disp-formula id="E6">
          <mml:math id="M6" display="block" overflow="scroll">
            <mml:mi>f</mml:mi>
            <mml:mfenced open="(" close=")" separators="|">
              <mml:mrow>
                <mml:mi>x</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>y</mml:mi>
              </mml:mrow>
            </mml:mfenced>
            <mml:mo>=</mml:mo>
            <mml:mn>1</mml:mn>
            <mml:mo>+</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>a</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>10</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:mi>x</mml:mi>
            <mml:mo>+</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>a</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>01</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:mi>y</mml:mi>
            <mml:mo>+</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>a</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>20</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:msup>
              <mml:mrow>
                <mml:mi>x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mo>+</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>a</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>11</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:mi>x</mml:mi>
            <mml:mi>y</mml:mi>
            <mml:mo>+</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>a</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>02</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:msup>
              <mml:mrow>
                <mml:mi>y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mo>+</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>a</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>30</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:msup>
              <mml:mrow>
                <mml:mi>x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>3</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mo>+</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>a</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>21</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:msup>
              <mml:mrow>
                <mml:mi>x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mi>y</mml:mi>
            <mml:mo>+</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>a</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>12</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:mi>x</mml:mi>
            <mml:msup>
              <mml:mrow>
                <mml:mi>y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mo>+</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>a</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>03</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:msup>
              <mml:mrow>
                <mml:mi>y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>3</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mo>+</mml:mo>
            <mml:mo>⋯</mml:mo>
          </mml:math>
        </disp-formula>
        <p>We then removed all the items that had only <italic toggle="yes">x</italic> or <italic toggle="yes">y</italic> because those are not “interacting” items and the effects of these single-variable items can be reflected in the “bias factor”. This left only one second-order item: <italic toggle="yes">xy</italic>, and two third-order items: <italic toggle="yes">x<sup>2</sup>y</italic> and <italic toggle="yes">xy<sup>2</sup></italic>. The coefficients of <italic toggle="yes">x<sup>2</sup>y</italic> and <italic toggle="yes">xy<sup>2</sup></italic> are the same because the function should be symmetric. Finally, we got <xref rid="E5" ref-type="disp-formula">Equation (5)</xref> as a parametric form of the Rabl effect.</p>
        <p>We can infer <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula>, <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula>, and <italic toggle="yes">C<sub>ik</sub></italic> by maximizing the likelihood function in <xref rid="E4" ref-type="disp-formula">Equation (4)</xref> with constraints <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> for all <italic toggle="yes">i</italic> and <italic toggle="yes">k</italic>, and then <italic toggle="yes">B<sub>i</sub></italic> and <italic toggle="yes">P<sub>ik</sub></italic> can be solved by
and
</p>
        <disp-formula id="E7">
          <label>(6)</label>
          <mml:math id="M7" display="block" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>B</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>C</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <disp-formula id="E8">
          <label>(7).</label>
          <mml:math id="M8" display="block" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>P</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>k</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>C</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>k</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>/</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>B</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
          </mml:math>
        </disp-formula>
      </sec>
      <sec>
        <title>2.1.2. Optimization algorithm</title>
        <p>The original optimization problem is non-convex and difficult to solve. However, note that when <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula>, <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula>, and all the other <italic toggle="yes">C<sub>jk</sub></italic> are all fixed, the part of <xref rid="E4" ref-type="disp-formula">Equation (4)</xref>, i.e. relevant to <bold><italic toggle="yes">C</italic></bold><sub><italic toggle="yes">i</italic></sub> can be written as:
</p>
        <disp-formula id="E9">
          <label>(8)</label>
          <mml:math id="M9" display="block" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>L</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:mfenced open="[" close="]" separators="|">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">ln</mml:mi>
                      </mml:mrow>
                      <mml:mo>⁡</mml:mo>
                      <mml:mrow>
                        <mml:mfenced open="(" close=")" separators="|">
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mo stretchy="false">∑</mml:mo>
                                <mml:mrow>
                                  <mml:mi>k</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>C</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>i</mml:mi>
                                    <mml:mi>k</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>C</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>j</mml:mi>
                                    <mml:mi>k</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mo>-</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mo stretchy="false">∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>C</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>C</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mfenced>
              </mml:mrow>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">ln</mml:mi>
                  </mml:mrow>
                  <mml:mo>⁡</mml:mo>
                  <mml:mrow>
                    <mml:mfenced open="(" close=")" separators="|">
                      <mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mo stretchy="false">∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>C</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mi>k</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>C</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>j</mml:mi>
                                <mml:mi>k</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mfenced>
                  </mml:mrow>
                </mml:mrow>
              </mml:mrow>
            </mml:mrow>
            <mml:mo>-</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:mfenced open="(" close=")" separators="|">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>C</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mo stretchy="false">∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>R</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mi>j</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mi>C</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mfenced>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>We can get the gradient and Hessian:
</p>
        <disp-formula id="E10">
          <label>(9)</label>
          <mml:math id="M10" display="block" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>G</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>k</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mo>∂</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>L</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>/</mml:mo>
            <mml:mo>∂</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>C</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>k</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="true">[</mml:mo>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>C</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>/</mml:mo>
                <mml:mo stretchy="true">(</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mo stretchy="false">∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>m</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>C</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>m</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>C</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mi>m</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mrow>
                <mml:mo stretchy="true">)</mml:mo>
                <mml:mo>-</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mo stretchy="false">∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>R</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mi>C</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo stretchy="true">]</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <disp-formula id="E11">
          <label>(10)</label>
          <mml:math id="M11" display="block" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>H</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>k</mml:mi>
                <mml:mi>l</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mo>∂</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:msub>
              <mml:mrow>
                <mml:mi>L</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>/</mml:mo>
            <mml:mo>∂</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>C</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>k</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>∂</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>C</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>l</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mo>-</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="true">[</mml:mo>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>C</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
            </mml:mrow>
            <mml:msub>
              <mml:mrow>
                <mml:mi>C</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>j</mml:mi>
                <mml:mi>l</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>/</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mo stretchy="true">(</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mo stretchy="false">∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>m</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>C</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>m</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>C</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mi>m</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mrow>
                <mml:mo stretchy="true">)</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mo stretchy="true">]</mml:mo>
          </mml:math>
        </disp-formula>
        <p>Note that –<italic toggle="yes">H</italic> is a positive-definite matrix, which means that –<italic toggle="yes">L<sub>i</sub></italic> is a convex function of <bold><italic toggle="yes">C</italic></bold><sub><italic toggle="yes">i</italic></sub>. Since the constraints <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> are also convex, this is a convex optimization problem that can be solved by standard algorithms such as the interior point method. Specifically, we used the primal-dual interior point method with Newton search (<xref rid="btad314-B7" ref-type="bibr">Boyd and Vandenberghe 2004</xref>) to solve it. By fixing all the <bold><italic toggle="yes">C</italic></bold><sub><italic toggle="yes">j</italic></sub> on other chromosomes, all the <bold><italic toggle="yes">C</italic></bold><sub><italic toggle="yes">i</italic></sub> on one chromosome can be optimized in parallel.</p>
        <p>To optimize <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula> and <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula>, we have the gradients:
and the Hessian matrix:
</p>
        <disp-formula id="E12">
          <label>(11)</label>
          <mml:math id="M12" display="block" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>G</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>α</mml:mo>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mo>∂</mml:mo>
            <mml:mi>L</mml:mi>
            <mml:mo>/</mml:mo>
            <mml:mo>∂</mml:mo>
            <mml:mo>α</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:mo stretchy="true">{</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>/</mml:mo>
                <mml:mo>[</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>+</mml:mo>
                <mml:mo>α</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>+</mml:mo>
                <mml:mo>β</mml:mo>
                <mml:mo>(</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>+</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>)</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>]</mml:mo>
                <mml:mo>-</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mrow>
                  <mml:msub>
                    <mml:mo stretchy="false">∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>k</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>C</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>C</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mrow>
                <mml:mo stretchy="true">}</mml:mo>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <disp-formula id="E13">
          <label>(12)</label>
          <mml:math id="M13" display="block" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>G</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>β</mml:mo>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mo>∂</mml:mo>
            <mml:mi>L</mml:mi>
            <mml:mo>/</mml:mo>
            <mml:mo>∂</mml:mo>
            <mml:mo>β</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:mo stretchy="false">{</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>(</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>+</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>)</mml:mo>
                <mml:mo>/</mml:mo>
                <mml:mo>[</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>+</mml:mo>
                <mml:mo>α</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>+</mml:mo>
                <mml:mo>β</mml:mo>
                <mml:mo>(</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>+</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>)</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>]</mml:mo>
                <mml:mo>-</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mrow>
                  <mml:msub>
                    <mml:mo stretchy="false">∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>k</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>C</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>C</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mrow>
                <mml:mo stretchy="false">}</mml:mo>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <disp-formula id="E14">
          <label>(13)</label>
          <mml:math id="M14" display="block" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>H</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>α</mml:mo>
                <mml:mo>α</mml:mo>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mo>∂</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mi>L</mml:mi>
            <mml:mo>/</mml:mo>
            <mml:mo>∂</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mo>α</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mo>=</mml:mo>
            <mml:mo>-</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:mo stretchy="true">{</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msup>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>/</mml:mo>
              </mml:mrow>
            </mml:mrow>
            <mml:msup>
              <mml:mrow>
                <mml:mo>[</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>+</mml:mo>
                <mml:mo>α</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>+</mml:mo>
                <mml:mo>β</mml:mo>
                <mml:mo>(</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>+</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>)</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>]</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mo stretchy="true">}</mml:mo>
          </mml:math>
        </disp-formula>
        <disp-formula id="E15">
          <label>(14)</label>
          <mml:math id="M15" display="block" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>H</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>β</mml:mo>
                <mml:mo>β</mml:mo>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mo>∂</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mi>L</mml:mi>
            <mml:mo>/</mml:mo>
            <mml:mo>∂</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mo>β</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mo>=</mml:mo>
            <mml:mo>-</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:mo stretchy="true">{</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msup>
                  <mml:mrow>
                    <mml:mo>[</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>(</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>+</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>)</mml:mo>
                    <mml:mo>]</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>/</mml:mo>
              </mml:mrow>
            </mml:mrow>
            <mml:msup>
              <mml:mrow>
                <mml:mo>[</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>+</mml:mo>
                <mml:mo>α</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>+</mml:mo>
                <mml:mo>β</mml:mo>
                <mml:mo>(</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>+</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>)</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>]</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mo stretchy="true">}</mml:mo>
          </mml:math>
        </disp-formula>
        <disp-formula id="E16">
          <label>(15)</label>
          <mml:math id="M16" display="block" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>H</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>α</mml:mo>
                <mml:mo>β</mml:mo>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mo>∂</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mi>L</mml:mi>
            <mml:mo>/</mml:mo>
            <mml:mo>∂</mml:mo>
            <mml:mo>α</mml:mo>
            <mml:mo>∂</mml:mo>
            <mml:mo>β</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mo>-</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:mo stretchy="true">{</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msup>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>(</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>+</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>)</mml:mo>
                <mml:mo>/</mml:mo>
              </mml:mrow>
            </mml:mrow>
            <mml:msup>
              <mml:mrow>
                <mml:mo>[</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>+</mml:mo>
                <mml:mo>α</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>+</mml:mo>
                <mml:mo>β</mml:mo>
                <mml:mo>(</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>+</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>)</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>]</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mo stretchy="true">}</mml:mo>
          </mml:math>
        </disp-formula>
        <p>Since –<italic toggle="yes">H</italic> is a positive-definite matrix, –<italic toggle="yes">L</italic> is also a convex function for the vector (<inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula>, <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula>) when all the <bold><italic toggle="yes">C</italic></bold><sub><italic toggle="yes">i</italic></sub> are fixed, and the optimization problem can be solved by Newton method.</p>
        <p>Finally, the whole algorithm works by sequentially optimize <bold><italic toggle="yes">C</italic></bold><sub><italic toggle="yes">i</italic></sub> on each chromosome, and then optimize <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula> and <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula>. By iterating this procedure, each time the likelihood function will only increase so the algorithm will finally converge to a local maximum. But since the likelihood function is not overall convex, a global maximum is not guaranteed. When the number of sub-compartments <italic toggle="yes">M</italic> is large, the likelihood landscape is quite complicated, and the algorithm often converges to a local maximum. In this case, we use multiple random starting points and compare the final likelihood value to select the best one.</p>
      </sec>
      <sec>
        <title>2.1.3. Excluded regions and region groups</title>
        <p>The existing genome assemblies are not perfect, and the real genome may be different among cell lines. Some of the regions have been identified to have abnormal results in genome sequencing experiments and are “blacklisted” (<xref rid="btad314-B1" ref-type="bibr">Amemiya et al. 2019</xref>). We also excluded these blacklisted regions from our analysis. All blacklisted regions will have all their “<bold><italic toggle="yes">C</italic></bold><sub><italic toggle="yes">i</italic></sub>”s set to 0.</p>
        <p>Moreover, there are genome translocations which make <italic toggle="yes">trans</italic>-interactions <italic toggle="yes">cis</italic>, and resulted in much more interactions than expected because genomic regions in the same chromosome interact at much higher frequency. These regions will form a separate compartment in the result because of the high interaction frequency and are easy to identify from normal compartments. The users can also refer to other software or data sources for genomic translocations. When such a translocation compartment is identified, a “blacklisted region group” can be made, and in the algorithm, any pairs of regions within a blacklisted group would not be used in the analysis, which means in the <xref rid="E4" ref-type="disp-formula">Equation (4)</xref>, only those region pairs not within the same excluded group will be used.</p>
      </sec>
    </sec>
    <sec>
      <title>2.2 Additional conditions when the model hypotheses can be violated and the consequences</title>
      <p>We have introduced the three hypotheses for the model above. We outline them here and discuss them one by one.</p>
      <p>Hypothesis 1: For two different genomic loci <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic>, their nuclear sub-compartment locations in individual cells are independent.</p>
      <p>It is easy to imagine that if the two genomic loci are close to each other, like in the same topological-associated domains, the hypothesis will not be satisfied. Therefore, this hypothesis will not hold for all pairs of genomic loci. However, if we only consider <italic toggle="yes">trans</italic>-interactions, the locations of two genomic loci on different chromosomes should be mostly independent.</p>
      <p>One possibility we do need to consider is that if the cell population is structurally heterogeneous, i.e. it is a mixture of two or more different cell populations, which could be either different cell types or different cell states, then the independency hypothesis may be violated.</p>
      <p>Consider there are two different cell populations, then <xref rid="E3" ref-type="disp-formula">Equation (3)</xref> becomes
</p>
      <disp-formula id="E17">
        <label>(16).</label>
        <mml:math id="M17" display="block" overflow="scroll">
          <mml:msub>
            <mml:mrow>
              <mml:mi>F</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>i</mml:mi>
              <mml:mi>j</mml:mi>
            </mml:mrow>
          </mml:msub>
          <mml:mo>=</mml:mo>
          <mml:msub>
            <mml:mrow>
              <mml:mi>R</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>i</mml:mi>
              <mml:mi>j</mml:mi>
            </mml:mrow>
          </mml:msub>
          <mml:mrow>
            <mml:msub>
              <mml:mo stretchy="false">∑</mml:mo>
              <mml:mrow>
                <mml:mi>k</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>C</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>C</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>j</mml:mi>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
          </mml:mrow>
          <mml:mo>+</mml:mo>
          <mml:msub>
            <mml:mrow>
              <mml:mi>R</mml:mi>
              <mml:mi mathvariant="normal">'</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>i</mml:mi>
              <mml:mi>j</mml:mi>
            </mml:mrow>
          </mml:msub>
          <mml:mrow>
            <mml:msub>
              <mml:mo stretchy="false">∑</mml:mo>
              <mml:mrow>
                <mml:mi>k</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>C</mml:mi>
                  <mml:mi mathvariant="normal">'</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>C</mml:mi>
                  <mml:mi mathvariant="normal">'</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>j</mml:mi>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>In this case, the <xref rid="E3" ref-type="disp-formula">Equation (3)</xref> still maintains its form if the Rabl effects are similar. Only the interpretation of the <italic toggle="yes">C<sub>ik</sub></italic> values needs to be changed, which means Equations (6) and (7) may not hold. This means we will need a more careful interpretation of the Cscores when dealing with a mixed cell population. On the positive side, this means our method can identify structural heterogeneity in the cell population.</p>
      <p>Hypothesis 2: Genomic loci located at different nuclear sub-compartments in one cell do not have 3D interaction in that cell.</p>
      <p>In the model, the nuclear sub-compartments correspond to physical locations within the nucleus. Therefore, the frequency of interactions between genomic loci in different sub-compartments should be very low. Only when the two loci are located at the boundary of two neighboring sub-compartments, they should have a low chance of interacting with each other. However, when the interaction frequency is low compared to intra-compartment interactions, this will cause only minor effects.</p>
      <p>Hypothesis 3: Genomic loci located at the same sub-compartment in one cell have a constant probability of interaction.</p>
      <p>This hypothesis is the most likely to be violated since it is very likely DNA sequences in different nuclear sub-compartments will have different organization and structures, and thus different physical properties and within-compartment interaction frequencies. For example, highly active genomic regions likely have higher <italic toggle="yes">trans</italic>-interaction frequency than condensed heterochromatin. Therefore, our hypothesis has a limitation of over-simplification, and we need to consider the consequences when this hypothesis is violated. Assume for each sub-compartment <italic toggle="yes">k</italic>, the interaction frequency has a modifier <italic toggle="yes">S<sub>k</sub></italic>, then we have:
</p>
      <disp-formula id="E18">
        <label>(17)</label>
        <mml:math id="M18" display="block" overflow="scroll">
          <mml:msub>
            <mml:mrow>
              <mml:mi>F</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>i</mml:mi>
              <mml:mi>j</mml:mi>
            </mml:mrow>
          </mml:msub>
          <mml:mo>=</mml:mo>
          <mml:msub>
            <mml:mrow>
              <mml:mi>B</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>i</mml:mi>
            </mml:mrow>
          </mml:msub>
          <mml:msub>
            <mml:mrow>
              <mml:mi>B</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>j</mml:mi>
            </mml:mrow>
          </mml:msub>
          <mml:msub>
            <mml:mrow>
              <mml:mi>f</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>i</mml:mi>
              <mml:mi>j</mml:mi>
            </mml:mrow>
          </mml:msub>
          <mml:mo>=</mml:mo>
          <mml:msub>
            <mml:mrow>
              <mml:mi>B</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>i</mml:mi>
            </mml:mrow>
          </mml:msub>
          <mml:msub>
            <mml:mrow>
              <mml:mi>B</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>j</mml:mi>
            </mml:mrow>
          </mml:msub>
          <mml:msub>
            <mml:mrow>
              <mml:mi>R</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>i</mml:mi>
              <mml:mi>j</mml:mi>
            </mml:mrow>
          </mml:msub>
          <mml:mrow>
            <mml:msub>
              <mml:mo stretchy="false">∑</mml:mo>
              <mml:mrow>
                <mml:mi>k</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>S</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>k</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mi>P</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>j</mml:mi>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>Let <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msqrt><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:msqrt></mml:math></inline-formula>, then we still have <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. This means the <xref rid="E3" ref-type="disp-formula">Equation (3)</xref> still holds in its original form, only the interpretation of <italic toggle="yes">C<sub>ik</sub></italic> changes. When the interaction is stronger in one sub-compartment, it will cause globally higher <italic toggle="yes">C<sub>ik</sub></italic> values in that sub-compartment, while weaker interactions will cause lower <italic toggle="yes">C<sub>ik</sub></italic> values. This will skew the prediction of <italic toggle="yes">P<sub>ik</sub></italic> to globally higher/lower probability. The relative higher/lower probabilities of sub-compartment localization between regions should still hold.</p>
    </sec>
    <sec>
      <title>2.3 Simulated Hi-C data generation</title>
      <p>As discussed above, the likelihood function (<xref rid="E4" ref-type="disp-formula">Equation 4</xref>) is complicated and non-convex. Though we can try multiple random starting points, it is uncertain whether the algorithm is robust enough to converge close to the correct optimum values or other sub-optimal local minima. To test the robustness of the method, we performed the following simulation tests.</p>
      <p>The first simulation was performed according to our generative model with given model parameters. For each <italic toggle="yes">trans</italic> pair of genomic regions <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic>, the Rabl effect <italic toggle="yes">R<sub>ij</sub></italic> is first calculated using <xref rid="E5" ref-type="disp-formula">Equation (5)</xref>. Then the expected number of interactions between the two regions can be calculated with <xref rid="E2" ref-type="disp-formula">Equation (2)</xref>. Finally, the number of observed interactions is generated with Poisson distribution using the expected number of interactions as the parameter. If interactions exist, then the interactions will be output into the simulated Hi-C dataset. After iterating all the <italic toggle="yes">trans</italic> pairs, a full Hi-C dataset is simulated. Then CscoreTool-M is run on the simulated Hi-C dataset to infer compartment scores.</p>
      <p>For low-depth dataset simulation, a full Hi-C dataset is first simulated, then a low-depth dataset is generated by down-sampling the full dataset to the lower depth.</p>
      <p>For simulation using randomized model parameters, we started from the sub-compartment annotations by Rao et al.’s original Gaussian-HMM annotations. We randomly generated Cscores with different noise levels (NL): For each genomic window, the “annotated” compartment (A1, A2, B1, B2, B3, B4) would take a score of random number from uniform distribution U(1-NL, 1), the other compartments take scores of random numbers from U(0, NL). Note that we also take the B4 compartment into consideration here as it is within Rao’s annotation, so even though only a small number of genomic regions are annotated as B4, all genomic windows will have B4 scores. Then we normalized the Cscores and simulated inter-chromosomal Hi-C dataset to the same depth as the 0.01× GM12878 dataset (about 9M <italic toggle="yes">trans</italic> reads). We did the simulation for different noise levels from 0.05 to 0.5.</p>
      <p>For mixed dataset simulation, two Hi-C datasets are first simulated independently according to the two sets of parameters. Then the high-depth dataset between the two was down-sampled to match the depth of the lower one. Finally, the two Hi-C datasets were merged to become one mixed dataset.</p>
    </sec>
    <sec>
      <title>2.4. AIC calculation</title>
      <p>We use the AIC (Akaike Information Criterion) analysis for model selection. AIC is a method for model selection based on the likelihood value and number of parameters and lower AIC values indicate a better model. AIC is calculated with the equation:
</p>
      <disp-formula id="E19">
        <mml:math id="M19" display="block" overflow="scroll">
          <mml:mi mathvariant="normal">AIC</mml:mi>
          <mml:mo>=</mml:mo>
          <mml:mn>2</mml:mn>
          <mml:mi>k</mml:mi>
          <mml:mo>-</mml:mo>
          <mml:mn>2</mml:mn>
          <mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">ln</mml:mi>
            </mml:mrow>
            <mml:mo>⁡</mml:mo>
            <mml:mrow>
              <mml:mi>L</mml:mi>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>Here, <italic toggle="yes">k</italic> is the number of parameters calculated by <italic toggle="yes">k=nM </italic>+<italic toggle="yes"> </italic>2, where <italic toggle="yes">M</italic> is the number of sub-compartments, and <italic toggle="yes">n</italic> is the number of non-empty genomic windows. <italic toggle="yes">L</italic> is the estimated maximum value of the likelihood function.</p>
    </sec>
    <sec>
      <title>2.5. Lamin-B1 cTSA-seq and data processing</title>
      <p>cTSA-seq was performed and Illumina sequencing libraries were built as in (<xref rid="btad314-B30" ref-type="bibr">Tran et al. 2022</xref>). Both cTSA-seq reads and input reads were sequenced with Nextseq 500 Illumina sequencer. Reads were mapped to human genome hg19 using bowtie2 with default parameters. Then for each 100 kb (or 10 kb) genomic window, the number of reads falling into the window was counted, and a relative enrichment was calculated by dividing the number of cTSA-seq reads with the number of input reads. Lamin-B1 cTSA-seq result of GM12878 cell line is available in the GEO database (<ext-link xlink:href="https://www.ncbi.nlm.nih.gov/geo/" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/geo/</ext-link>) and can be accessed with accession number GSE224282.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Validation on simulated data</title>
      <p>To test whether CscoreTool-M can infer the correct sub-compartments, we first performed a simulation test using the GM12878 cell Hi-C data (<xref rid="btad314-B21" ref-type="bibr">Rao et al. 2014</xref>) as a template. The purpose of this simulation is to test whether the optimization algorithm can correctly estimate the original parameters when all the hypotheses fit. We first ran CscoreTool-M on the GM12878 cell Hi-C data to estimate compartment scores for five sub-compartments at 100 kb resolution using the <italic toggle="yes">trans</italic> interactions (Mod1 to Mod5 on <xref rid="btad314-F1" ref-type="fig">Fig. 1A</xref>). Then we simulated Hi-C <italic toggle="yes">trans</italic> interactions at the same depth as the original dataset (1× dataset) using the GM12878 compartment scores as model parameters. We next applied our algorithm on the simulated dataset to infer compartment scores (Sim1 to Sim5 on <xref rid="btad314-F1" ref-type="fig">Fig. 1A</xref>).</p>
      <fig position="float" id="btad314-F1">
        <label>Figure 1.</label>
        <caption>
          <p>Simulation test using GM12878 cell and IMR90 cell Hi-C datasets. (A) Genome browser view of compartment scores on simulated data (sim1-sim5) compared to the model values (mod1-mod5). Compartment scores on Y axes range from 0 to 1. (B) Contour plots showing the compartment scores calculated on full (1×), low (0.1×), and ultralow (0.01×) depth simulated datasets compared to the model values. R: Pearson correlation coefficient. All X and Y axes compartment score values range from 0 to 1. (C) Genome browser view of compartment scores on simulated mixed dataset compared to the model values. R: Pearson correlation coefficient. All Y axes range from 0 to 1.</p>
        </caption>
        <graphic xlink:href="btad314f1" position="float"/>
      </fig>
      <p>The chromosomal view of the inferred compartment scores shows high consistency with the model parameters (<xref rid="btad314-F1" ref-type="fig">Fig. 1A</xref>). To quantify the divergence between the inferred compartment scores and the model parameters, we calculated the genome-wide correlation coefficients and high correlations are observed for all sub-compartments (<xref rid="btad314-F1" ref-type="fig">Fig. 1B</xref>, left panels).</p>
      <p>To further test the performance of our method at lower read depth, we generated 0.1× and 0.01× datasets by randomly selecting 10% and 1% from the original dataset, respectively, and calculated the correlation coefficients. The correlations are weaker on low-depth datasets (<xref rid="btad314-F1" ref-type="fig">Fig. 1B</xref>, mid and right panels), but they are still higher than 0.9 even on the 0.01× dataset.</p>
      <p>We also performed simulation analysis on randomized model parameters using the sub-compartment annotations by Rao et al.’s original Gaussian-HMM as template and randomized to different noise levels. We simulated the Hi-C data, calculated the compartment scores for five compartments and calculated the correlation coefficient with the simulated compartment scores of A1, A2, B1, B2, and B3. We did the analyses for different noise levels from 0.05 to 0.5 and the correlation coefficients between each inferred compartment scores and its corresponding simulated scores are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>. We found that the correlation coefficients become lower when the noise is higher, but all the results are still highly consistent with the simulated scores.</p>
      <p>The theoretical analysis (see Section 2.2) suggested that CscoreTool-M can be used to deconvolve mixed cell population. To test this, we simulated two Hi-C datasets using model parameters for GM12878 (Mod1-1 to Mod1-5) and IMR90 Hi-C data (Mod2-1 to Mod2-5) (<xref rid="btad314-F1" ref-type="fig">Fig. 1C</xref>). We then mixed these two datasets and applied our algorithm to infer 10 sub-compartments (Sim1 to Sim10 on <xref rid="btad314-F1" ref-type="fig">Fig. 1C</xref>). We found five sub-compartments (Sim1 to Sim5) resembled the GM12878 model well (Mod1-1 to Mod1-5), while the other five compartments (Sim6 to Sim10) have a similar profile to the IMR90 model (Mod2-1 to Mod2-5). This result shows that our algorithm can infer cell-type specific sub-compartments in mixed cell types.</p>
    </sec>
    <sec>
      <title>3.2 Comparisons with the published multi-compartment analyses</title>
      <p>To further test the performance of our CscoreTool-M, we compared our results with the published multi-compartments inferred by <xref rid="btad314-B21" ref-type="bibr">Rao et al<italic toggle="yes">.</italic> (2014)</xref>. Rao et al. inferred 6 sub-compartments as A1–A2 and B1–B4 in GM12878 cells. A1 and A2 are both enriched for active chromatin features such as H3K4me3, H3K27Ac, H3K36me3 and DNAse I hypersensitivity. A1 has higher enrichment of active markers than A2 and A1 overlaps with nuclear speckle domains (<xref rid="btad314-B8" ref-type="bibr">Chen et al. 2018</xref>). B1 to B4 all contain repressed chromatin domains and are depleted of active epigenetic markers. B1 is enriched with H3K27me3 which is regulated by the Polycomb Repressive Complexes. B2 and B3 are both enriched for LADs (determined by the lamin-A/C ChIP-seq), with B2 further enriched of NADs while B3 is not. This suggested that B2 represents NADs while B3 represents LADs. B4 only covers a very small proportion of the genome on chr19. Thus, we excluded B4 and only compared our 5 sub-compartments inferred by CscoreTool-M with the five compartments inferred by Rao et al.</p>
      <p>We use the same notation as in Rao et al. (RaoA1, RaoA2, RaoB1, RaoB2, and RaoB3) for our five sub-compartments but add “C5” before the compartment names (C5A1, C5A2, C5B1, C5B2, and C5B3) to indicate our CscoreTool-M modeled five sub-compartments. <xref rid="btad314-F2" ref-type="fig">Figure 2A and B</xref> shows our five sub-compartment plots based on CscoreTool-M and color-coded bar-tracks for the compartments assigned by Rao et al. In general, our compartment scores show peaks at Rao’s assigned compartments, indicating that our compartment inference is largely consistent with the compartments indicated by Rao. It is noteworthy that there are also regions showing inconsistencies. <xref rid="btad314-F2" ref-type="fig">Figure 2A and B</xref> shows that two regions on chr10 and chr12 have C5B1 sub-compartment scores peaks, while Rao et al. predicted these regions to be in A1. To further investigate which sub-compartments these regions should be in, we looked at gene expression and epigenetics features along these regions. Our C5B1 peaks show a depletion of H3K27Ac and reduced gene expression, but enriched for H3K27me3, which are typical B1 features instead of A1.</p>
      <fig position="float" id="btad314-F2">
        <label>Figure 2.</label>
        <caption>
          <p>Comparisons of compartments modeled by CscoreTool-M against Rao’s sub compartments in GM12878 cells. (A,B) Genome browser view of chromosome 10 (A) and 12 (B) showing the compartment scores tracks by CscoreTool-M and compartments (indicated by different colored blocks) by Rao et al. Example regions in black rectangles showing discrepancies between CscoreTool-M and Rao et al. are expanded and shown at the right panels. All <italic toggle="yes">Y</italic> axes plot for compartment scores range from 0 to 1. (C) Enrichment of H3K27Ac and H3K27me3 peaks in regions agreed or disagreed inferred by CscoreTool-M or Rao et al. H3K27Ac and H3K27me3 data are from UCSC genome browser ENCODE tracks. (D) Genome-wide correlation coefficients between CsocreTool-M, Rao’s Gaussion-HMM, SNIER, SCI-inferred compartment scores and SON-TSA-seq, H3K27me3 ChIP-seq, Lamin-B1 cTSA-seq enrichment signals at 100-kb resolution. The best scores for each method are highlighted. (E) Genome-wide correlation coefficients between CsocreTool-M, Calder-inferred scores and SON-TSA-seq, H3K27me3 ChIP-seq, Lamin-B1 cTSA-seq enrichment signals at 10-kb resolution. The best scores for each method are highlighted.</p>
        </caption>
        <graphic xlink:href="btad314f2" position="float"/>
      </fig>
      <p>To further analyse whether the difference in A and B sub-compartment assignment by Rao and by our CscoreTool-M also happens on other chromosomes, we assigned the five compartments based on the highest compartment score at each genomic region across the genome and compared these to the compartments assigned by Rao et al. (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). While the overall correspondence in A and B sub-compartments is good, there are some clear differences. For example, we found that a total of 45.1M genomic regions are assigned as A1 by Rao but are assigned as C5B1 by CscoreTool-M (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). We further looked at the enrichment of H3K27Ac peaks and H3K27me3 peaks on these regions (<xref rid="btad314-F2" ref-type="fig">Fig. 2C</xref>) and found that the H3K27Ac enrichment (1.2) is just marginally higher than the global average (1.0), while much lower than the enrichment of H3K27Ac peaks on A1 regions assigned commonly by Rao and CscoreTool-M. In contrast, the H3K27me3 peaks showed much higher enrichment (2.02) than that found on A1 regions assigned commonly by Rao and CscoreTool-M (0.71), and also higher than the global average (1.0). We made a similar observation in regions assigned as A2 by Rao and C5B1 by CscoreTool-M. The C5B1 regions show lower H3K27Ac and higher H3K27me3 than the corresponding RaoA2 regions and also than global average (<xref rid="btad314-F2" ref-type="fig">Fig. 2C</xref>). These results show that the CscoreTool-M-assigned C5B1 regions have B1 features instead of A1/A2 features. Thus, the CscoreTool-M can better predict sub-compartments in these regions.</p>
      <p>To further compare the performance between CscoreTool-M and other published methods, including Rao’s original Gaussian HMM, SNIPER, SCI, and Calder, we used three independent protein-DNA-interaction datasets as benchmarks: SON TSA-seq (of K562 cells) for approximation of A1 (<xref rid="btad314-B8" ref-type="bibr">Chen et al. 2018</xref>), H3K27me3 ChIP-seq for B1 (<xref rid="btad314-B28" ref-type="bibr">Thurman et al. 2012</xref>), and lamin-B1 cTSA-seq for B3 (this study). For CscoreTool-M, we used the 5-compartment scores; while for Gaussian-HMM, SNIPER, Calder, and SCI, we used their compartment assignment, 1 for the assigned compartment, and 0 for the others. We calculated the correlation coefficients between the compartment scores generated from each of the sub-compartment analysis methods (CscoreTool-M, Gaussian-HMM, SNIPER, SCI, or Calder) and the enrichment scores generated from each protein-DNA interaction dataset (SON TSA-seq, H3K27me3 ChIP-seq, and Lamin-B1 cTSA-seq). We use these correlation coefficients as a fair comparison as none of Cscoretool-M, Gaussion-HMM, SNIPER, Calder, or SCI directly used this information based on protein-DNA interaction/colocalization datasets. Note that as most results previous are based on the hg19 genome, here the comparisons are also on hg19.</p>
      <p><xref rid="btad314-F2" ref-type="fig">Figure 2D</xref> lists the comparison results between CscoreTool-M and Rao’s Gaussian-HMM, SNIPER, and SCI. We found that in all three comparisons for A1, B1, and B3, the results of CscoreTool-M showed the best performance. The comparison against Calder was shown in <xref rid="btad314-F2" ref-type="fig">Fig. 2E</xref>. Since Calder provided 10 kb-resolution results, we also applied CscoreTool-M at 10 kb resolution for comparison. In these comparisons, CscoreTool-M also showed better performance than Calder. Taken together, these results show that CscoreTool-M can quantify the sub-compartment probabilities in cell population and the performances are confirmed by other independent measures; and that CscoreTool-M has the best performance in sub-compartment inference among published methods.</p>
      <p>We also tested the performance of our CscoreTool-M on low-depth Hi-C sequencing data by randomly selecting 0.1× and 0.01× of the reads from the Hi-C data for GM12878 cells to infer sub-compartments. We then calculated the correlation coefficient on the sub-compartments. We found all the correlation coefficients are higher than 0.9 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>), indicating that the CscoreTool-M is robust in inferring multiple genomic compartments using low-depth Hi-C datasets. Comparison between biological replicates of GM12878 Hi-C data also showed high correlation (all &gt; 0.97, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>), further supporting the robustness of the method.</p>
      <p>One important hyper-parameter of CscoreTool-M and other sub-compartment inference tools is the number of sub-compartments. We first compared 2- and 5-compartment results to see how this hyper-parameter can determine the sub-compartment results. We calculated the correlation coefficients between 2- and 5-compartment scores (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>). A1 has the highest correlation with A compartment score, followed by A2; B3 has the highest correlation with B compartment score, followed by B2. Interestingly, B1 has mildly positive correlation with A compartment score instead of B. It has been reported that the B1 sub-compartment is located farther away from the nuclear periphery than A2 (<xref rid="btad314-B23" ref-type="bibr">Robson et al. 2017</xref>), indicating that when only considering 2-compartments, it is correct to assign the B1 compartment as mostly A-like. However, with 5-sub-compartment analysis, it is possible to further separate the B1 sub-compartment from the A-compartment and correctly identify its polycomb-repressed features. This result shows that with more sub-compartments, it is possible to identify more detailed information of 3D genome organization.</p>
      <p>Since CscoreTool-M uses maximum-likelihood inference, it is natural to use the AIC (Akaike Information Criterion) for model selection. AIC is a method for model selection based on the likelihood value and number of parameters. The lower AIC values indicate a better model. We applied AIC to two datasets (0.1× and 0.01× data of GM12878) at 100 kb resolution. For lower-depth dataset (0.01×), the AIC reached a minimum at 6 compartments, indicating that 6 is the statistical optimal compartment number for this dataset (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6A</xref>), while for a higher-depth dataset (0.1×), the AIC values decrease as the number of compartments increase up to 15 compartments (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6B</xref>) indicating that more compartments continuously lead to better fitting of the GM12878 Hi-C data at this depth. In this case, the statistical optimal compartment number is at least 15. The users can perform a similar analysis to determine the statistically optimal number of sub-compartments. However, depending on the biological questions and when the sequencing depth is high, the analysis may not need to reach the optimal minimum. In all the bulk-Hi-C datasets we use below, the AIC analysis supports more than 15 sub-compartments, and we used 5, 6, or 10 just because they are enough to support our biological findings.</p>
    </sec>
    <sec>
      <title>3.3 Inferring LAD and NAD heterogeneity within a cell population</title>
      <p>One feature of CscoreTool-M is that it explicitly models and quantifies the heterogeneity within a cell population, which should aid the study of variations of genome organization. It is known that NADs often overlap with LADs, but the overlap only happens for some NADs. The NAD-only and the overlapping NAD/LAD chromatin regions tend to have different genomic features (<xref rid="btad314-B31" ref-type="bibr">Vertii et al. 2019</xref>; <xref rid="btad314-B3" ref-type="bibr">Bersaglieri et al. 2022</xref>). Since nucleoli are often not located at the nuclear periphery, the biological interpretation of the overlap between NADs and LADs remains unclear. The localization of lamins in nucleolus as reported by some studies (<xref rid="btad314-B15" ref-type="bibr">Martin et al. 2009</xref>; <xref rid="btad314-B25" ref-type="bibr">Sen Gupta 2017</xref>) can contribute to the NAD/LAD overlap. In addition, only a fraction of LADs may return to the nuclear lamina after mitosis, and the ones not returning to the nuclear lamina often relocate to peri-nucleolar regions (<xref rid="btad314-B12" ref-type="bibr">Kind et al. 2013</xref>). In this case, the overlapping LADs and NADs regions can come from heterogeneity within the cell population, with the same regions located at the nucleoli or nuclear periphery in different cells within the population.</p>
      <p>We applied CscoreTool-M to infer LADs and NADs based on the Hi-C dataset for the GM12878 cell population. One interesting feature we noticed is that our compartment scores show clear variations among Rao et al’s B2 chromatin regions. Examples are shown for chr18 and chr19 (<xref rid="btad314-F3" ref-type="fig">Fig. 3A and B</xref>), which are known to localize preferentially to the nuclear periphery and nuclear interior, respectively (<xref rid="btad314-B9" ref-type="bibr">Croft et al. 1999</xref>). On chr18, about half of the chromosome was assigned as B2 by Rao et al. (RaoB2), but based on Cscoretool-M these regions have similar C5B2 and C5B3 scores. Although RaoB2 and RaoB3 are suggested to represent NADs and LADs regions, respectively, our analyses indicate that the RaoB2 chromatin regions on chr18 exhibit cell-cell heterogeneity with about half of the cells having nucleolar localization and the other half localizing at the nuclear lamina. In contrast to chr18, CscoreTool-M found that the RaoB2 regions on chr19 have high C5B2 scores and low C5B3 scores, suggesting that these regions are NADs but not LADs. This correctly infers that the interiorly localized chr19 has limited LADs compared to that of chr18.</p>
      <fig position="float" id="btad314-F3">
        <label>Figure 3.</label>
        <caption>
          <p>Inferring NADs and LADs in GM12878 cells. Genome browser view of chromosome 18 (A) and 19 (B) showing the CscoreTool-M compartment score tracks and the corresponding compartments by inferred by Rao et al. Black rectangles indicate two examples of RaoB2 regions showing high C5B2 and C5B3 scores on chr18 (A) or two examples of RaoB2 regions with high C5B2 and low C5B3 scores on chr19 (B). All Y axes plotting compartment scores range from 0 to 1. (C) Genome-wide correlation coefficients between CscoreTool-M inferred 6-subcompartment scores and NAD-seq, Lamin-B1 DamID enrichment signals at 100-kb resolution.</p>
        </caption>
        <graphic xlink:href="btad314f3" position="float"/>
      </fig>
      <p>Since there is no NADs data on GM12878 or similar cell types, we tested the performance of CscoreTool-M to quantify the heterogeneity of LADs and NADs on mouse embryonic stem cells (mESC). We downloaded NAD-seq data from (<xref rid="btad314-B5" ref-type="bibr">Bizhanova et al. 2020</xref>), Lamin-B1 DamID data from (<xref rid="btad314-B20" ref-type="bibr">Peric-Hupkes et al. 2010</xref>), and calculated NAD-seq and Lamin-B1 DamID enrichment signals on 100 kb windows along the genome. We then applied CscoreTool-M to mESC Hi-C data (<xref rid="btad314-B6" ref-type="bibr">Bonev et al. 2017</xref>), and calculated the correlation coefficients with NAD-seq and Lamin-B1 DamID (<xref rid="btad314-F3" ref-type="fig">Fig. 3C</xref>). We found that with six sub-compartments, one of the sub-compartments, C6_6, has a very high correlation coefficient (0.88) with NAD-seq, and only 0.567 with LaminB1 DamID. In contrast, another sub-compartment, C6_5, has a high correlation coefficient (0.778) with LaminB1 DamID, while only 0.160 with NAD-seq. This result shows that CscoreTool-M can successfully identify separate sub-compartments that correspond to NADs and LADs, respectively. The high correlation coefficients against NAD-seq and Lamin-B1 DamID signals further confirm that the probabilities of locating in LADs or NADs inferred by CscoreTool-M are highly consistent with the results from independent measurements. Taken together, our method can infer the heterogeneity of NADs and LADs localization and quantify the different levels of heterogeneity among genomic regions within the cell population.</p>
    </sec>
    <sec>
      <title>3.4 Inferring the degree of compartment heterogeneity in different cell types</title>
      <p>Studies have revealed clear variations in 3D genome interactions in individual cells belonging to the same cell type. These variations can be purely stochastic or related to different cell states, such as different cell-cycle or differentiation stages. On the other hand, a given cell type, i.e. not proliferating and is terminally differentiated should exhibit relatively low heterogeneity in genome organization. Our CscoreTool-M should be able to infer the degree of 3D genome organizational heterogeneities among different cell types and within a population of cells belonging to the same cell type or lineage. To test this, we applied CscoreTool-M to analyse the Hi-C dataset for the isolated pure mature olfactory sensory neurons (OSN) (<xref rid="btad314-B17" ref-type="bibr">Monahan et al. 2019</xref>). The result of the 5-compartment analyses (<xref rid="btad314-F4" ref-type="fig">Fig. 4A</xref>) shows sharper sub-compartment boundaries and lower background scores than those of the five compartments inferred based on the Hi-C datasets for GM12878 and IMR90 cells (see <xref rid="btad314-F1" ref-type="fig">Fig. 1C</xref>).</p>
      <fig position="float" id="btad314-F4">
        <label>Figure 4.</label>
        <caption>
          <p>Comparisons of the level of compartment heterogeneity among different cell types. (A) Genome browser view of five compartments for olfactory sensory neurons (OSN) on chr1 inferred by CscoreTool-M. All <italic toggle="yes">Y</italic> axes plotting compartment scores range from 0 to 1. (B) Violin plot showing the information content calculated for each 100-kb window along the genome based on Hi-C datasets in four different cell types. (C) Violin plot showing the information content calculated for each 100-kb window along the genome based on single-cell Hi-C datasets in four cell-cycle stages of mESC compared to bulk.</p>
        </caption>
        <graphic xlink:href="btad314f4" position="float"/>
      </fig>
      <p>To further quantify the degree of heterogeneity, we calculated the information content (IC) of sub-compartment scores along the genome. IC is defined as <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mn>0.2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for 5 sub-compartments, is highest if the sub-compartment score is 1 for one sub-compartment and 0 for the remaining compartments (no heterogeneity), while lowest (0) if it is the same for all sub-compartments (no information). We found that IC for the olfactory neuron Hi-C dataset is generally higher than the GM12878 and IMR90 Hi-C datasets (<xref rid="btad314-F4" ref-type="fig">Fig. 4B</xref>), confirming our visual inspection of the genomic tracks. Since the olfactory sensory neurons were isolated from mice, we compared the information content of the mouse olfactory neuron Hi-C with a mouse ES cell (mESC) Hi-C dataset (<xref rid="btad314-B6" ref-type="bibr">Bonev et al. 2017</xref>). The olfactory neuron dataset still has significantly higher IC (<xref rid="btad314-F4" ref-type="fig">Fig. 4B</xref>). Thus, the difference is not due to the differences of cells derived from mice or humans.</p>
      <p>The above analysis suggests that cells that continue to proliferate may result in increased genome organization heterogeneity, and that cell cycle and the related chromatin conformation change is one major reason for heterogeneity. To test this hypothesis further directly, we applied CscoreTool-M to five cell-cycle-stage-sorted single-cell Hi-C datasets (<xref rid="btad314-B18" ref-type="bibr">Nagano et al. 2017</xref>) corresponding to G1, early S, mid S and late S/G2, respectively. We then applied 5-compartment analysis to these cell-cycle-resolved datasets and calculated the IC in all four cell cycle stages. We found that the IC values were higher than in the bulk mESC Hi-C data (<xref rid="btad314-F4" ref-type="fig">Fig. 4C</xref>). We also found that the IC values were lower in G1 than in early S, mid S, and late S/G2, consistent with the idea that the G1 phase is the most heterogeneous with rapid chromatin interaction changes from the mitotic to interphase conformation. These results show that CscoreTool-M can be used to infer and compare genomic organizational heterogeneity in different cell types, and that cell cycle is a major reason for sub-compartment heterogeneity.</p>
    </sec>
    <sec>
      <title>3.5 Inferring G1 genome organization in a population of asynchronously dividing cells</title>
      <p>In a given cell type, those cells that are proliferating can have different 3D genome interactions at different cell cycle stages, thereby contributing to the variation in chromatin organization among individual cells. Our simulation analysis suggests that the CscoreTool-M can deconvolve genomic organizational heterogeneity if we analyse a larger number of sub-compartments. We analyzed the Hi-C dataset obtained from the asynchronously dividing HCT116 cells (<xref rid="btad314-B22" ref-type="bibr">Rao et al. 2017</xref>) using 10 sub-compartments (<xref rid="btad314-F5" ref-type="fig">Fig. 5</xref>). Recently we have developed a <underline>c</underline>hromatin pull-down based <underline>T</underline>yramide-<underline>S</underline>ignal <underline>A</underline>mplification <underline>seq</underline>uencing (cTSA-seq) method to analyse LADs at different cell cycle stages using the human HCT116 cell line (<xref rid="btad314-B30" ref-type="bibr">Tran et al. 2022</xref>). We found that during early G1 the chromatin associated with the reforming NL are the sub-telomeric regions (<xref rid="btad314-F5" ref-type="fig">Fig. 5</xref>). Another study using a novel protein A-DamID approach described a similar, albeit weaker telomeric enrichment (<xref rid="btad314-B24" ref-type="bibr">van Schaik et al. 2020</xref>). Interestingly, one sub-compartment, HCT116 C10_7, predicted by CscoreTool-M is very similar to the early G1 LADs mapped by our cTSA-seq. The whole-genome comparison shows significant correlation between the compartment score of HCT116 C10_7 and the early G1 cTSA-seq LADs mapping (<italic toggle="yes">R</italic> = 0.42, <italic toggle="yes">P</italic> &lt; 10<sup>−16</sup>). This result shows that the C10_7 sub-compartment can capture the LADs pattern in the early G1 HCT116 cells.</p>
      <fig position="float" id="btad314-F5">
        <label>Figure 5.</label>
        <caption>
          <p>Inferring cell-cycle-related sub-compartments. Genome browser view of 10 compartments inferred by CscoreTool-M for HCT116 cells on chr1. Regions showing similarity between HCT116 C10_7 compartment and the early-G1-specific LADs determined by cTSA-seq using sorted early G1 HCT116 cells are highlighted in black boxes.</p>
        </caption>
        <graphic xlink:href="btad314f5" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.6 Inferring cell-type specific functional sub-compartments</title>
      <p>One interesting feature of the olfactory neuron is that the olfactory genes are clustered together in 3D (<xref rid="btad314-B17" ref-type="bibr">Monahan et al. 2019</xref>). To test whether our method can find this sub-compartment of olfactory genes, we applied the CscoreTool-M on the olfactory sensory neuron Hi-C dataset to model 10 sub-compartments. We found that one of the sub-compartments, OSN C10_1, overlapped well with the olfactory genes (<xref rid="btad314-F6" ref-type="fig">Fig. 6</xref>), indicating that our method can identify this functional gene cluster in one sub-compartment.</p>
      <fig position="float" id="btad314-F6">
        <label>Figure 6.</label>
        <caption>
          <p>Identification of function-related sub-compartments in OSN by 10 sub-compartment analyses. Genome browser view of 10-compartments for olfactory sensory neuron cells on chr11. The olfactory gene clusters are indicated with black bars on the top. Thickness of the bars indicate the number of olfactory genes.</p>
        </caption>
        <graphic xlink:href="btad314f6" position="float"/>
      </fig>
      <p>We reason that these functional gene clusters may also exist in other cell types. We first examined the GM12878 dataset. We performed 10-compartment analysis on the GM12878 dataset and found that the GM12878 C10_1 and C10_2 sub-compartments both have good correlations to the GM12878 C5A1 compartment but are enriched for genes with different functions based on the Gene Ontology (GO) analyses. The C10_1 sub-compartment is enriched for genes related to immune function, which may be functionally important as the GM12878 cells are derived from B-lymphocytes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7A</xref>). In contrast, the C10_2 sub-compartment is enriched for housekeeping genes with functions including translation and transcription (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7B</xref>). Interestingly, we found that the C10_2 sub-compartment for the olfactory sensory neurons is also enriched for housekeeping genes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7C</xref>). Finally, we applied CscoreTool-M to infer 10 sub-compartments in additional cell types with available Hi-C datasets to test if we can find 3D clustering of functionally related genes in individual genomic compartments. By analyzing mESCs, IMR90 fibroblasts, NHEK keratinocytes, and HCT116 colon cancer epithelial cells, we found a clear enrichment of housekeeping genes in two sub-compartments of mESC (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8A and B</xref>), one in IMR90 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8D</xref>) and one in HCT116 cells (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8E</xref>). GO analyses also revealed an enrichment of genes in the C10_3 compartment of mESC involved in embryonic development (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8C</xref>) and genes in the C10_2 compartment of NHEK cells involved in keratinocyte differentiation and skin development (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8F</xref>). Thus, CscoreTool-M can discover the 3D cluster of functionally related genes in different cell types.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusions</title>
    <p>In this study, we report CscoreTool-M, a model-based method to calculate sub-compartment scores from Hi-C data. The compartment scores calculated by Cscoretool-M for a given genomic region are directly proportional to the probability that the region is located at a specific sub-compartment. By comparing with other sub-compartment inference based on clustering method, we have shown that CscoreTool-M is better at inferring sub-compartments corresponding to both active and repressed chromatin. The compartment scores by CscoreTool-M also help quantify the levels of heterogeneity in sub-compartment localization within cell populations for different genomic regions. By comparing proliferating and terminally differentiated cells, we show that proliferating cells have higher genome organization heterogeneity, which is likely caused by different cell-cycle stages. By analyzing 10 sub-compartments, we found a sub-compartment potentially related to early-G1 LADs in HCT116 cells, suggesting the method can deconvolve sub-compartments from asynchronously dividing cell populations. Finally, we show that sub-compartments inferred by CscoreTool-M are often enriched in housekeeping or cell-type-specific functions.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad314_Supplementary_Data</label>
      <media xlink:href="btad314_supplementary_data.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> is available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the National Institutes of Health [R01GM106023 and R01GM110151 to Y.Z.].</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad314-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Amemiya</surname><given-names>HM</given-names></string-name>, <string-name><surname>Kundaje</surname><given-names>A</given-names></string-name>, <string-name><surname>Boyle</surname><given-names>AP</given-names></string-name></person-group><etal>et al</etal><article-title>The ENCODE blacklist: identification of problematic regions of the genome</article-title>. <source>Sci Rep</source><year>2019</year>;<volume>9</volume>:<fpage>9354</fpage>.<pub-id pub-id-type="pmid">31249361</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ashoor</surname><given-names>H</given-names></string-name>, <string-name><surname>Chen</surname><given-names>X</given-names></string-name>, <string-name><surname>Rosikiewicz</surname><given-names>W</given-names></string-name></person-group><etal>et al</etal><article-title>Graph embedding and unsupervised learning predict genomic sub-compartments from HiC chromatin interaction data</article-title>. <source>Nat Commun</source><year>2020</year>;<volume>11</volume>:<fpage>1173</fpage>.<pub-id pub-id-type="pmid">32127534</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bersaglieri</surname><given-names>C</given-names></string-name>, <string-name><surname>Kresoja-Rakic</surname><given-names>J</given-names></string-name>, <string-name><surname>Gupta</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Genome-wide maps of nucleolus interactions reveal distinct layers of repressive chromatin domains</article-title>. <source>Nat Commun</source><year>2022</year>;<volume>13</volume>:<fpage>1483</fpage>.<pub-id pub-id-type="pmid">35304483</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bintu</surname><given-names>B</given-names></string-name>, <string-name><surname>Mateo</surname><given-names>LJ</given-names></string-name>, <string-name><surname>Su</surname><given-names>J-H</given-names></string-name></person-group><etal>et al</etal><article-title>Super-resolution chromatin tracing reveals domains and cooperative interactions in single cells</article-title>. <source>Science</source><year>2018</year>;<volume>362</volume>:<fpage>eaau1783</fpage>.<pub-id pub-id-type="pmid">30361340</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bizhanova</surname><given-names>A</given-names></string-name>, <string-name><surname>Yan</surname><given-names>A</given-names></string-name>, <string-name><surname>Yu</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Distinct features of nucleolus-associated domains in mouse embryonic stem cells</article-title>. <source>Chromosoma</source><year>2020</year>;<volume>129</volume>:<fpage>121</fpage>–<lpage>39</lpage>.<pub-id pub-id-type="pmid">32219510</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonev</surname><given-names>B</given-names></string-name>, <string-name><surname>Mendelson Cohen</surname><given-names>N</given-names></string-name>, <string-name><surname>Szabo</surname><given-names>Q</given-names></string-name></person-group><etal>et al</etal><article-title>Multiscale 3D genome rewiring during mouse neural development</article-title>. <source>Cell</source><year>2017</year>;<volume>171</volume>:<fpage>557</fpage>–<lpage>72.e24</lpage>.<pub-id pub-id-type="pmid">29053968</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B7">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Boyd</surname><given-names>SP</given-names></string-name>, <string-name><surname>Vandenberghe</surname><given-names>L.</given-names></string-name></person-group><year>2004</year>. <source>Convex optimization</source>. <publisher-loc>Cambridge, UK; New York</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btad314-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>Y</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>Mapping 3D genome organization relative to nuclear compartments using TSA-seq as a cytological ruler</article-title>. <source>J Cell Biol</source><year>2018</year>;<volume>217</volume>:<fpage>4025</fpage>–<lpage>48</lpage>.<pub-id pub-id-type="pmid">30154186</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Croft</surname><given-names>JA</given-names></string-name>, <string-name><surname>Bridger</surname><given-names>JM</given-names></string-name>, <string-name><surname>Boyle</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Differences in the localization and morphology of chromosomes in the human nucleus</article-title>. <source>J Cell Biol</source><year>1999</year>;<volume>145</volume>:<fpage>1119</fpage>–<lpage>31</lpage>.<pub-id pub-id-type="pmid">10366586</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guelen</surname><given-names>L</given-names></string-name>, <string-name><surname>Pagie</surname><given-names>L</given-names></string-name>, <string-name><surname>Brasset</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal><article-title>Domain organization of human chromosomes revealed by mapping of nuclear lamina interactions</article-title>. <source>Nature</source><year>2008</year>;<volume>453</volume>:<fpage>948</fpage>–<lpage>51</lpage>.<pub-id pub-id-type="pmid">18463634</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Imakaev</surname><given-names>M</given-names></string-name>, <string-name><surname>Fudenberg</surname><given-names>G</given-names></string-name>, <string-name><surname>McCord</surname><given-names>RP</given-names></string-name></person-group><etal>et al</etal><article-title>Iterative correction of Hi-C data reveals hallmarks of chromosome organization</article-title>. <source>Nat Methods</source><year>2012</year>;<volume>9</volume>:<fpage>999</fpage>–<lpage>1003</lpage>.<pub-id pub-id-type="pmid">22941365</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kind</surname><given-names>J</given-names></string-name>, <string-name><surname>Pagie</surname><given-names>L</given-names></string-name>, <string-name><surname>Ortabozkoyun</surname><given-names>H</given-names></string-name></person-group><etal>et al</etal><article-title>Single-cell dynamics of genome-nuclear lamina interactions</article-title>. <source>Cell</source><year>2013</year>;<volume>153</volume>:<fpage>178</fpage>–<lpage>92</lpage>.<pub-id pub-id-type="pmid">23523135</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lieberman-Aiden</surname><given-names>E</given-names></string-name>, <string-name><surname>van Berkum</surname><given-names>NL</given-names></string-name>, <string-name><surname>Williams</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Comprehensive mapping of long range interactions reveals folding principles of the human genome</article-title>. <source>Science</source><year>2009</year>;<volume>326</volume>:<fpage>289</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">19815776</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>Y</given-names></string-name>, <string-name><surname>Nanni</surname><given-names>L</given-names></string-name>, <string-name><surname>Sungalee</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Systematic inference and comparison of multi-scale chromatin Sub-compartments connects spatial organization to cell phenotypes</article-title>. <source>Nat Commun</source><year>2021</year>;<volume>12</volume>:<fpage>2439</fpage>.<pub-id pub-id-type="pmid">33972523</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Martin</surname><given-names>C</given-names></string-name>, <string-name><surname>Chen</surname><given-names>S</given-names></string-name>, <string-name><surname>Maya-Mendoza</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Lamin B1 maintains the functional plasticity of nucleoli</article-title>. <source>J Cell Sci</source><year>2009</year>;<volume>122</volume>:<fpage>1551</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">19383719</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mikkelsen</surname><given-names>TS</given-names></string-name>, <string-name><surname>Ku</surname><given-names>M</given-names></string-name>, <string-name><surname>Jaffe</surname><given-names>DB</given-names></string-name></person-group><etal>et al</etal><article-title>Genome-wide maps of chromatin state in pluripotent and lineage-committed cells</article-title>. <source>Nature</source><year>2007</year>;<volume>448</volume>:<fpage>553</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">17603471</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Monahan</surname><given-names>K</given-names></string-name>, <string-name><surname>Horta</surname><given-names>A</given-names></string-name>, <string-name><surname>Lomvardas</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>LHX2- and LDB1-mediated trans interactions regulate olfactory receptor choice</article-title>. <source>Nature</source><year>2019</year>;<volume>565</volume>:<fpage>448</fpage>–<lpage>53</lpage>.<pub-id pub-id-type="pmid">30626972</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nagano</surname><given-names>T</given-names></string-name>, <string-name><surname>Lubling</surname><given-names>Y</given-names></string-name>, <string-name><surname>Várnai</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>Cell-cycle dynamics of chromosomal organization at single-cell resolution</article-title>. <source>Nature</source><year>2017</year>;<volume>547</volume>:<fpage>61</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">28682332</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Németh</surname><given-names>A</given-names></string-name>, <string-name><surname>Conesa</surname><given-names>A</given-names></string-name>, <string-name><surname>Santoyo-Lopez</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Initial genomics of the human nucleolus</article-title>. <source>PLoS Genet</source><year>2010</year>;<volume>6</volume>:<fpage>e1000889</fpage>.<pub-id pub-id-type="pmid">20361057</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Peric-Hupkes</surname><given-names>D</given-names></string-name>, <string-name><surname>Meuleman</surname><given-names>W</given-names></string-name>, <string-name><surname>Pagie</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Molecular maps of the reorganization of genome-nuclear lamina interactions during differentiation</article-title>. <source>Mol Cell</source><year>2010</year>;<volume>38</volume>:<fpage>603</fpage>–<lpage>13</lpage>.<pub-id pub-id-type="pmid">20513434</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rao</surname><given-names>SSP</given-names></string-name>, <string-name><surname>Huntley</surname><given-names>MH</given-names></string-name>, <string-name><surname>Durand</surname><given-names>NC</given-names></string-name></person-group><etal>et al</etal><article-title>A 3D map of the human genome at kilobase resolution reveals principles of chromatin looping</article-title>. <source>Cell</source><year>2014</year>;<volume>159</volume>:<fpage>1665</fpage>–<lpage>80</lpage>.<pub-id pub-id-type="pmid">25497547</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rao</surname><given-names>SSP</given-names></string-name>, <string-name><surname>Huang</surname><given-names>S-C</given-names></string-name>, <string-name><surname>Glenn St Hilaire</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>Cohesin loss eliminates all loop domains</article-title>. <source>Cell</source><year>2017</year>;<volume>171</volume>:<fpage>305</fpage>–<lpage>20.e24</lpage>.<pub-id pub-id-type="pmid">28985562</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robson</surname><given-names>MI</given-names></string-name>, <string-name><surname>de Las Heras</surname><given-names>JI</given-names></string-name>, <string-name><surname>Czapiewski</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Constrained release of lamina-associated enhancers and genes from the nuclear envelope during T-cell activation facilitates their association in chromosome compartments</article-title>. <source>Genome Res</source><year>2017</year>;<volume>27</volume>:<fpage>1126</fpage>–<lpage>38</lpage>.<pub-id pub-id-type="pmid">28424353</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sen Gupta</surname><given-names>A.</given-names></string-name></person-group><article-title>Lamin B2 modulates nucleolar morphology, dynamics, and function</article-title>. <source>Mol Cell Biol</source><year>2017</year>;<volume>37</volume>:<fpage>e00274-17</fpage>.</mixed-citation>
    </ref>
    <ref id="btad314-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stevens</surname><given-names>TJ</given-names></string-name>, <string-name><surname>Lando</surname><given-names>D</given-names></string-name>, <string-name><surname>Basu</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>3D structures of individual mammalian genomes studied by single-cell Hi-C</article-title>. <source>Nature</source><year>2017</year>;<volume>544</volume>:<fpage>59</fpage>–<lpage>64</lpage>.<pub-id pub-id-type="pmid">28289288</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Takei</surname><given-names>Y</given-names></string-name>, <string-name><surname>Yun</surname><given-names>J</given-names></string-name>, <string-name><surname>Zheng</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Integrated spatial genomics reveals global architecture of single nuclei</article-title>. <source>Nature</source><year>2021</year>;<volume>590</volume>:<fpage>344</fpage>–<lpage>50</lpage>.<pub-id pub-id-type="pmid">33505024</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Thurman</surname><given-names>RE</given-names></string-name>, <string-name><surname>Rynes</surname><given-names>E</given-names></string-name>, <string-name><surname>Humbert</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>The accessible chromatin landscape of the human genome</article-title>. <source>Nature</source><year>2012</year>;<volume>489</volume>:<fpage>75</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">22955617</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tran</surname><given-names>JR</given-names></string-name>, <string-name><surname>Paulson</surname><given-names>DI</given-names></string-name>, <string-name><surname>Moresco</surname><given-names>JJ</given-names></string-name></person-group><etal>et al</etal><article-title>An APEX2 proximity ligation method for mapping interactions with the nuclear lamina</article-title>. <source>J Cell Biol</source><year>2021</year>;<volume>220</volume>:<fpage>e202002129</fpage>.<pub-id pub-id-type="pmid">33306092</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tran</surname><given-names>JR</given-names></string-name>, <string-name><surname>Zheng</surname><given-names>X</given-names></string-name>, <string-name><surname>Adam</surname><given-names>SA</given-names></string-name></person-group><etal>et al</etal><article-title>High quality mapping of chromatin at or near the nuclear lamina from small numbers of cells reveals cell cycle and developmental changes of chromatin at the nuclear periphery</article-title>. <source>Nucleic Acids Res</source><year>2022</year>;<volume>50</volume>:<fpage>e117</fpage>.<pub-id pub-id-type="pmid">36130229</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van Schaik</surname><given-names>T</given-names></string-name>, <string-name><surname>Vos</surname><given-names>M</given-names></string-name>, <string-name><surname>Peric-Hupkes</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>Cell cycle dynamics of lamina-associated DNA</article-title>. <source>EMBO Rep</source><year>2020</year>;<volume>21</volume>:<fpage>e50636</fpage>.<pub-id pub-id-type="pmid">32893442</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vertii</surname><given-names>A</given-names></string-name>, <string-name><surname>Ou</surname><given-names>J</given-names></string-name>, <string-name><surname>Yu</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Two contrasting classes of nucleolus-associated domains in mouse fibroblast heterochromatin</article-title>. <source>Genome Res</source><year>2019</year>;<volume>29</volume>:<fpage>1235</fpage>–<lpage>49</lpage>.<pub-id pub-id-type="pmid">31201210</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xiong</surname><given-names>K</given-names></string-name>, <string-name><surname>Ma</surname><given-names>J.</given-names></string-name></person-group><article-title>Revealing Hi-C subcompartments by imputing inter-chromosomal chromatin interactions</article-title>. <source>Nat Commun</source><year>2019</year>;<volume>10</volume>:<fpage>5069</fpage>.<pub-id pub-id-type="pmid">31699985</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>X</given-names></string-name>, <string-name><surname>Hu</surname><given-names>J</given-names></string-name>, <string-name><surname>Yue</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Lamins organize the global three-dimensional genome from the nuclear periphery</article-title>. <source>Mol Cell</source><year>2018</year>;<volume>71</volume>:<fpage>802</fpage>–<lpage>15.e7</lpage>.<pub-id pub-id-type="pmid">30201095</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>X</given-names></string-name>, <string-name><surname>Zheng</surname><given-names>Y.</given-names></string-name></person-group><article-title>CscoreTool: fast Hi-C compartment analysis at high resolution</article-title>. <source>Bioinformatics</source><year>2018</year>;<volume>34</volume>:<fpage>1568</fpage>–<lpage>70</lpage>.<pub-id pub-id-type="pmid">29244056</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10206090</article-id>
    <article-id pub-id-type="pmid">37166448</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad314</article-id>
    <article-id pub-id-type="publisher-id">btad314</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CscoreTool-M infers 3D sub-compartment probabilities within cell population</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9599-8525</contrib-id>
        <name>
          <surname>Zheng</surname>
          <given-names>Xiaobin</given-names>
        </name>
        <aff><institution>Department of Embryology, Carnegie Institution for Science</institution>, Baltimore, MD 21218, <country country="US">United States</country></aff>
        <xref rid="btad314-cor1" ref-type="corresp"/>
        <!--xzheng@carnegiescience.edu-->
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7467-8995</contrib-id>
        <name>
          <surname>Tran</surname>
          <given-names>Joseph R</given-names>
        </name>
        <aff><institution>Department of Embryology, Carnegie Institution for Science</institution>, Baltimore, MD 21218, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zheng</surname>
          <given-names>Yixian</given-names>
        </name>
        <aff><institution>Department of Embryology, Carnegie Institution for Science</institution>, Baltimore, MD 21218, <country country="US">United States</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Boeva</surname>
          <given-names>Valentina</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad314-cor1">Corresponding author. Department of Embryology, Carnegie Institution for Science, Baltimore, MD 21218, USA. E-mail: <email>xzheng@carnegiescience.edu</email> (X.Z.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-05-11">
      <day>11</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>5</issue>
    <elocation-id>btad314</elocation-id>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>7</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>07</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>04</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>23</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad314.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Computational inference of genome organization based on Hi-C sequencing has greatly aided the understanding of chromatin and nuclear organization in three dimensions (3D). However, existing computational methods fail to address the cell population heterogeneity. Here we describe a probabilistic-modeling-based method called CscoreTool-M that infers multiple 3D genome sub-compartments from Hi-C data.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>The compartment scores inferred using CscoreTool-M represents the probability of a genomic region locating in a specific sub-compartment. Compared to published methods, CscoreTool-M is more accurate in inferring sub-compartments corresponding to both active and repressed chromatin. The compartment scores calculated by CscoreTool-M also help to quantify the levels of heterogeneity in sub-compartment localization within cell populations. By comparing proliferating cells and terminally differentiated non-proliferating cells, we show that the proliferating cells have higher genome organization heterogeneity, which is likely caused by cells at different cell-cycle stages. By analyzing 10 sub-compartments, we found a sub-compartment containing chromatin potentially related to the early-G1 chromatin regions proximal to the nuclear lamina in HCT116 cells, suggesting the method can deconvolve cell cycle stage-specific genome organization among asynchronously dividing cells. Finally, we show that CscoreTool-M can identify sub-compartments that contain genes enriched in housekeeping or cell-type-specific functions.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p><ext-link xlink:href="https://github.com/scoutzxb/CscoreTool-M" ext-link-type="uri">https://github.com/scoutzxb/CscoreTool-M</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01GM106023</award-id>
        <award-id>R01GM110151</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="12"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>One important question in biology pertains to how DNA is packaged and organized in the small nuclear space of eukaryotes so that gene expression can be temporally and spatially regulated during organism development and homeostasis. The nucleus is a complicated structure with many functional subunits, such as the nuclear speckles, the nucleolus, and the nuclear lamina. These units have been recognized as organization hubs of the genome for specific functions. How these hubs are organized with respect to one another and to the 3D chromatin interactions remains, however, poorly understood. As a result, it is unclear how the different genomic units work together to regulate gene expression in the context of organism development and function.</p>
    <p>The genomic sequences associated with the nuclear lamina, speckles, and nucleoli have been mapped (<xref rid="btad314-B10" ref-type="bibr">Guelen et al. 2008</xref>; <xref rid="btad314-B19" ref-type="bibr">Németh et al. 2010</xref>; <xref rid="btad314-B8" ref-type="bibr">Chen et al. 2018</xref>). The genes in the nuclear lamina-associated chromatin domains (LADs) are largely silenced and the LADs are generally gene-poor with overall repressive epigenetic features. Nuclear speckles are enriched for transcribed genes that create a transcriptionally active environment. Thus, chromatin associated with the speckles show active epigenetic features. It remains unclear if the actively transcribed house-keeping genes and cell-type specific genes are organized into the same or different speckles and if the organization shows any cell type specificity. Nucleoli are involved in transcribing ribosomal RNAs and ribosome assembly. Although nucleoli are mostly found away from the nuclear periphery, the nucleolus-associated chromatin domains (NADs) largely overlap with LADs. In addition, lamins, the major structural component of the nuclear lamina, have been found to be associated with nucleolus (<xref rid="btad314-B15" ref-type="bibr">Martin et al. 2009</xref>; <xref rid="btad314-B25" ref-type="bibr">Sen Gupta 2017</xref>), but it is unclear whether this can fully explain the overlap observed between NADs and LADs. Moreover, how NADs and LADs are organized with respect to one another and to the rest of the genome is poorly understood.</p>
    <p>Many efforts have been devoted to understanding nuclear and genome organization. Among the numerous methods developed, the imaging approaches, such as fluorescence in situ hybridization to visualize DNA, RNA, and immunostaining to visualize proteins, allow simultaneous visualization of proteins, DNA, and RNA transcripts in individual cells. Whereas imaging approaches are important to understand the heterogeneity of nuclear and genome organization and transcriptional activity in cells, they are limited to regions of the nucleus where the probes are designed. Recent advances in barcoding and iterative hybridization approaches have enabled imaging of thousands of genomic loci in the same cell (<xref rid="btad314-B4" ref-type="bibr">Bintu et al. 2018</xref>; <xref rid="btad314-B27" ref-type="bibr">Takei et al. 2021</xref>), but the resolution is still limited.</p>
    <p>To overcome the limitations of imaging approaches, direct DNA sequencing has been used to study genomic regions associated with specific nuclear substructures, transcription factors, or epigenetic modifications. The <italic toggle="yes">Ch</italic>romatin <italic toggle="yes">I</italic>mmuno<italic toggle="yes">P</italic>recipitation followed by massive parallel <italic toggle="yes">seq</italic>uencing (ChIP-seq) (<xref rid="btad314-B16" ref-type="bibr">Mikkelsen et al. 2007</xref>) has been used extensively to understand epigenetic modification and transcription factor interaction with chromatin, but the method does not offer information on 3D chromatin organization or sub-nuclear structures. Several methods, including DNA adenine methylase identification (DamID) (<xref rid="btad314-B10" ref-type="bibr">Guelen et al. 2008</xref>), nucleolar sequencing (<xref rid="btad314-B19" ref-type="bibr">Németh et al. 2010</xref>), Ascorbate Peroxidase (APEX)-based map of LADs (<xref rid="btad314-B29" ref-type="bibr">Tran et al. 2021</xref>), Tyramide-Signal Amplification (TSA)-seq (<xref rid="btad314-B8" ref-type="bibr">Chen et al. 2018</xref>), and chromatin pull down based TSA-seq (cTSA-seq) (<xref rid="btad314-B30" ref-type="bibr">Tran et al. 2022</xref>) have been developed to map the genomic regions associated with nuclear lamina, nucleolar, and nuclear speckles. Finally, chromatin conformation capture based methods, including Hi-C (<xref rid="btad314-B13" ref-type="bibr">Lieberman-Aiden et al. 2009</xref>), were developed to identify interactions between different chromatin regions, which allowed the reconstruction of the 3D chromatin interaction and folding. However, more computational efforts are still needed to fill in the gaps between the DNA-DNA interaction profile and nuclear substructure-associated chromatin domains.</p>
    <p>The A/B compartment concept was introduced in the first Hi-C study. By applying principal component analysis to the distance-normalized Hi-C interaction profile, Lieberman-Aiden et al. discovered that the genome can be separated into the two large compartments, namely the A- and B-compartment (<xref rid="btad314-B13" ref-type="bibr">Lieberman-Aiden et al. 2009</xref>). Genomic regions in the A-compartment have a higher chance to interact within the A-compartment, while genomic regions in the B-compartment have a higher chance of interactions with one another. By analyzing epigenome, transcriptome, and LADs in A/B compartments, it became clear that B compartments contain LADs and additional heterochromatin regions, while the A compartments were enriched for active euchromatin. We developed a model-based method, CscoreTool, to provide A–B compartment inference at higher resolution, better accuracy, and lower computational cost (<xref rid="btad314-B34" ref-type="bibr">Zheng and Zheng 2018</xref>; <xref rid="btad314-B33" ref-type="bibr">Zheng et al. 2018</xref>). These compartment studies suggest that the 3D chromatin interactions mapped by Hi-C can be used to define local chromatin compartments that share high interactions within each compartment.</p>
    <p>To reveal more detailed 3D chromatin compartments, Rao et al. used high-resolution Hi-C and Gaussian Hidden Markov Model-based clustering method to generate six sub-compartments and their further analyses linked some of these sub-compartments to the LADs, NADs, and speckle-associated chromatin (<xref rid="btad314-B21" ref-type="bibr">Rao et al. 2014</xref>). Although the algorithm used by Rao et al. represents an important progress in identifying the sub-compartments of the genome, there are several limitations. For example, the method arbitrarily separates the genome into “even” and “odd” chromosomes and clusters them separately. The compartments inferred from the even and odd chromosomes may not match each other. In addition, the method does not take into consideration the heterogeneity of genome interactions in individual cells known to exist even within a given cell type. Another recent method, called SNIPER (<xref rid="btad314-B32" ref-type="bibr">Xiong and Ma 2019</xref>), used a neural network to “impute” low-depth dataset and inferred sub-compartments. However, this method is supervised and depends on Rao et al.’s results using the GM12878 dataset. Thus, SNIPER suffers the same limitations, and it could not be used to infer more than six sub-compartments or be applied to other organisms without a training dataset. Recently, Calder (<xref rid="btad314-B14" ref-type="bibr">Liu et al. 2021</xref>) and SCI (<xref rid="btad314-B2" ref-type="bibr">Ashoor et al. 2020</xref>) were developed as new unsupervised methods to infer sub-compartments from bulk Hi-C data, but these two methods still do not consider the heterogeneity with cell population.</p>
    <p>Here, we introduce CscoreTool-M, a model-based tool to infer multiple sub-compartments of the genome. CscoreTool-M extends the model used in CscoreTool to accommodate more sub-compartments. The compartment scores (Cscores) provided by this method are equal to the probability (or percentage) of cells within the population that a genomic region is in certain sub-compartments. We show that CscoreTool-M can reveal the heterogeneity of genomic sub-compartment relations within the cell population, and it offers a great opportunity to define finer sub-compartment organizations of the genome that are directly related to nuclear sub structures and their functions.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Modeling sub-compartments based on Hi-C dataset obtained from cell populations</title>
      <sec>
        <title>2.1.1. Modeling sub-compartments in population Hi-C data</title>
        <p>We assume that there are totally <italic toggle="yes">M</italic> sub-compartments in the nucleus, and the cell population can be heterogeneous, with each genomic region <italic toggle="yes">i</italic> located to sub-compartment <italic toggle="yes">k</italic> at a probability <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>; <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:math></inline-formula>; <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>.</p>
        <p>Like Rao et al. our model is based on <italic toggle="yes">trans</italic>-interactions (inter-chromosome interactions). Compared to <italic toggle="yes">cis</italic>-interactions (intra-chromosome interactions), <italic toggle="yes">trans</italic>-interactions are not affected by topological domains or other local constraints. Thus, the interaction frequencies are mainly determined by compartment structure.</p>
        <p>The model is based on three hypotheses:<disp-quote content-type="extract"><p>Hypothesis 1: For two different genomic loci, their nuclear sub-compartment locations in cells are independent.</p><p>Hypothesis 2: Two genomic loci located at different nuclear sub-compartments in one cell do not have 3D interaction in that cell.</p><p>Hypothesis 3: Two genomic loci located at the same sub-compartment in one cell have a constant probability of interaction.</p></disp-quote></p>
        <p>Since we only use trans-interactions in the analysis, local structures such as TADs would not violate our hypotheses. However, one potential violation of hypothesis 1 is the Rabl effect in the nucleus. The Rabl effect shows centromere-centromere or telomere-telomere interactions among different chromosomes (<xref rid="btad314-B11" ref-type="bibr">Imakaev et al. 2012</xref>; <xref rid="btad314-B18" ref-type="bibr">Nagano et al. 2017</xref>; <xref rid="btad314-B26" ref-type="bibr">Stevens et al. 2017</xref>). These interactions would violate hypothesis 1 and make the <italic toggle="yes">trans</italic>-interactions at the centromeres or telomeres correlated. To account for the Rabl effect, we added a modification in our model. Assume the Rabl effect can be modeled by a term <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, then based on hypothesis 1, the probability that two genomic loci <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic> are in the same compartment in a cell is:
</p>
        <disp-formula id="E1">
          <label>(1)</label>
          <mml:math id="M1" display="block" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>f</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>R</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mrow>
              <mml:msub>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>Besides the Rabl effect, these three hypotheses may still be violated under various other conditions, and we will discuss the conditions when they are violated and the consequences in Section 2.2.</p>
        <p>Based on hypothesis 2 and 3, the total number of interactions between two genomic loci should be in proportion to the probability that they are in the same genomic sub-compartment. Hi-C experiments are further affected by chromatin accessibility, genome mappability, ligation, and PCR efficiency. All these complication factors are summarized as a bias factor <italic toggle="yes">b<sub>i</sub></italic> for each genomic locus (<xref rid="btad314-B11" ref-type="bibr">Imakaev et al. 2012</xref>), and the total interacting fragments in the Hi-C library could be modeled as:
</p>
        <disp-formula id="E2">
          <label>(2)</label>
          <mml:math id="M2" display="block" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>F</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>B</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:msub>
              <mml:mrow>
                <mml:mi>B</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:msub>
              <mml:mrow>
                <mml:mi>f</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>B</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:msub>
              <mml:mrow>
                <mml:mi>B</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:msub>
              <mml:mrow>
                <mml:mi>R</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mrow>
              <mml:msub>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>We further let <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and the equation becomes:
</p>
        <disp-formula id="E3">
          <label>(3).</label>
          <mml:math id="M3" display="block" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>F</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>R</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mrow>
              <mml:msub>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>C</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>C</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>The observed Hi-C interaction reads between genomic loci <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic>, <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, can be modeled as a Poisson distribution with parameter <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, so we get the final likelihood function:
</p>
        <disp-formula id="E4">
          <label>(4)</label>
          <mml:math id="M4" display="block" overflow="scroll">
            <mml:mi>L</mml:mi>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:mfenced open="[" close="]" separators="|">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">ln</mml:mi>
                      </mml:mrow>
                      <mml:mo>⁡</mml:mo>
                      <mml:mrow>
                        <mml:mfenced open="(" close=")" separators="|">
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>R</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mi>j</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mo stretchy="false">∑</mml:mo>
                                <mml:mrow>
                                  <mml:mi>k</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>C</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>i</mml:mi>
                                    <mml:mi>k</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>C</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>j</mml:mi>
                                    <mml:mi>k</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mo>-</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>R</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mo stretchy="false">∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>C</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>C</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mfenced>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>We further model the Rabl effect by a simple two-parameter function:
</p>
        <disp-formula id="E5">
          <label>(5)</label>
          <mml:math id="M5" display="block" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>R</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mn>1</mml:mn>
            <mml:mo>+</mml:mo>
            <mml:mo>α</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>r</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:msub>
              <mml:mrow>
                <mml:mi>r</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>+</mml:mo>
            <mml:mo>β</mml:mo>
            <mml:mo>(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>r</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>+</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>r</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>)</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>r</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:msub>
              <mml:mrow>
                <mml:mi>r</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
          </mml:math>
        </disp-formula>
        <p>Here, <italic toggle="yes">r<sub>i</sub></italic> corresponds to the relative location of genomic locus <italic toggle="yes">i</italic> on the chromosome. It ranges from –0.5 (centromere) to 0.5 (telomere). <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula> is the second-order coefficient modeling how strong the Rabl effect is, while <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula> is the third-order coefficient modeling the skew (whether the centromere or telomere side has stronger interaction). This model is a simplified version of the third-order power series of of <italic toggle="yes">R<sub>ij</sub></italic> as a function of <italic toggle="yes">r<sub>i</sub></italic> (<italic toggle="yes">x</italic>) and <italic toggle="yes">r<sub>j</sub></italic> (<italic toggle="yes">y</italic>):
</p>
        <disp-formula id="E6">
          <mml:math id="M6" display="block" overflow="scroll">
            <mml:mi>f</mml:mi>
            <mml:mfenced open="(" close=")" separators="|">
              <mml:mrow>
                <mml:mi>x</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>y</mml:mi>
              </mml:mrow>
            </mml:mfenced>
            <mml:mo>=</mml:mo>
            <mml:mn>1</mml:mn>
            <mml:mo>+</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>a</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>10</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:mi>x</mml:mi>
            <mml:mo>+</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>a</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>01</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:mi>y</mml:mi>
            <mml:mo>+</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>a</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>20</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:msup>
              <mml:mrow>
                <mml:mi>x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mo>+</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>a</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>11</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:mi>x</mml:mi>
            <mml:mi>y</mml:mi>
            <mml:mo>+</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>a</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>02</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:msup>
              <mml:mrow>
                <mml:mi>y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mo>+</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>a</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>30</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:msup>
              <mml:mrow>
                <mml:mi>x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>3</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mo>+</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>a</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>21</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:msup>
              <mml:mrow>
                <mml:mi>x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mi>y</mml:mi>
            <mml:mo>+</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>a</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>12</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:mi>x</mml:mi>
            <mml:msup>
              <mml:mrow>
                <mml:mi>y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mo>+</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>a</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>03</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:msup>
              <mml:mrow>
                <mml:mi>y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>3</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mo>+</mml:mo>
            <mml:mo>⋯</mml:mo>
          </mml:math>
        </disp-formula>
        <p>We then removed all the items that had only <italic toggle="yes">x</italic> or <italic toggle="yes">y</italic> because those are not “interacting” items and the effects of these single-variable items can be reflected in the “bias factor”. This left only one second-order item: <italic toggle="yes">xy</italic>, and two third-order items: <italic toggle="yes">x<sup>2</sup>y</italic> and <italic toggle="yes">xy<sup>2</sup></italic>. The coefficients of <italic toggle="yes">x<sup>2</sup>y</italic> and <italic toggle="yes">xy<sup>2</sup></italic> are the same because the function should be symmetric. Finally, we got <xref rid="E5" ref-type="disp-formula">Equation (5)</xref> as a parametric form of the Rabl effect.</p>
        <p>We can infer <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula>, <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula>, and <italic toggle="yes">C<sub>ik</sub></italic> by maximizing the likelihood function in <xref rid="E4" ref-type="disp-formula">Equation (4)</xref> with constraints <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> for all <italic toggle="yes">i</italic> and <italic toggle="yes">k</italic>, and then <italic toggle="yes">B<sub>i</sub></italic> and <italic toggle="yes">P<sub>ik</sub></italic> can be solved by
and
</p>
        <disp-formula id="E7">
          <label>(6)</label>
          <mml:math id="M7" display="block" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>B</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>C</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <disp-formula id="E8">
          <label>(7).</label>
          <mml:math id="M8" display="block" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>P</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>k</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>C</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>k</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>/</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>B</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
          </mml:math>
        </disp-formula>
      </sec>
      <sec>
        <title>2.1.2. Optimization algorithm</title>
        <p>The original optimization problem is non-convex and difficult to solve. However, note that when <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula>, <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula>, and all the other <italic toggle="yes">C<sub>jk</sub></italic> are all fixed, the part of <xref rid="E4" ref-type="disp-formula">Equation (4)</xref>, i.e. relevant to <bold><italic toggle="yes">C</italic></bold><sub><italic toggle="yes">i</italic></sub> can be written as:
</p>
        <disp-formula id="E9">
          <label>(8)</label>
          <mml:math id="M9" display="block" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>L</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:mfenced open="[" close="]" separators="|">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">ln</mml:mi>
                      </mml:mrow>
                      <mml:mo>⁡</mml:mo>
                      <mml:mrow>
                        <mml:mfenced open="(" close=")" separators="|">
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mo stretchy="false">∑</mml:mo>
                                <mml:mrow>
                                  <mml:mi>k</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>C</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>i</mml:mi>
                                    <mml:mi>k</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>C</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>j</mml:mi>
                                    <mml:mi>k</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mo>-</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mo stretchy="false">∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>C</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>C</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mfenced>
              </mml:mrow>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">ln</mml:mi>
                  </mml:mrow>
                  <mml:mo>⁡</mml:mo>
                  <mml:mrow>
                    <mml:mfenced open="(" close=")" separators="|">
                      <mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mo stretchy="false">∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>C</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mi>k</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>C</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>j</mml:mi>
                                <mml:mi>k</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mfenced>
                  </mml:mrow>
                </mml:mrow>
              </mml:mrow>
            </mml:mrow>
            <mml:mo>-</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:mfenced open="(" close=")" separators="|">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>C</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mo stretchy="false">∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>R</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mi>j</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mi>C</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mfenced>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>We can get the gradient and Hessian:
</p>
        <disp-formula id="E10">
          <label>(9)</label>
          <mml:math id="M10" display="block" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>G</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>k</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mo>∂</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>L</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>/</mml:mo>
            <mml:mo>∂</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>C</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>k</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="true">[</mml:mo>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>C</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>/</mml:mo>
                <mml:mo stretchy="true">(</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mo stretchy="false">∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>m</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>C</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>m</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>C</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mi>m</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mrow>
                <mml:mo stretchy="true">)</mml:mo>
                <mml:mo>-</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mo stretchy="false">∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>R</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mi>C</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo stretchy="true">]</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <disp-formula id="E11">
          <label>(10)</label>
          <mml:math id="M11" display="block" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>H</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>k</mml:mi>
                <mml:mi>l</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mo>∂</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:msub>
              <mml:mrow>
                <mml:mi>L</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>/</mml:mo>
            <mml:mo>∂</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>C</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>k</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>∂</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>C</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>l</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mo>-</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="true">[</mml:mo>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>C</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
            </mml:mrow>
            <mml:msub>
              <mml:mrow>
                <mml:mi>C</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>j</mml:mi>
                <mml:mi>l</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>/</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mo stretchy="true">(</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mo stretchy="false">∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>m</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>C</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>m</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>C</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mi>m</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mrow>
                <mml:mo stretchy="true">)</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mo stretchy="true">]</mml:mo>
          </mml:math>
        </disp-formula>
        <p>Note that –<italic toggle="yes">H</italic> is a positive-definite matrix, which means that –<italic toggle="yes">L<sub>i</sub></italic> is a convex function of <bold><italic toggle="yes">C</italic></bold><sub><italic toggle="yes">i</italic></sub>. Since the constraints <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> are also convex, this is a convex optimization problem that can be solved by standard algorithms such as the interior point method. Specifically, we used the primal-dual interior point method with Newton search (<xref rid="btad314-B7" ref-type="bibr">Boyd and Vandenberghe 2004</xref>) to solve it. By fixing all the <bold><italic toggle="yes">C</italic></bold><sub><italic toggle="yes">j</italic></sub> on other chromosomes, all the <bold><italic toggle="yes">C</italic></bold><sub><italic toggle="yes">i</italic></sub> on one chromosome can be optimized in parallel.</p>
        <p>To optimize <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula> and <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula>, we have the gradients:
and the Hessian matrix:
</p>
        <disp-formula id="E12">
          <label>(11)</label>
          <mml:math id="M12" display="block" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>G</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>α</mml:mo>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mo>∂</mml:mo>
            <mml:mi>L</mml:mi>
            <mml:mo>/</mml:mo>
            <mml:mo>∂</mml:mo>
            <mml:mo>α</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:mo stretchy="true">{</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>/</mml:mo>
                <mml:mo>[</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>+</mml:mo>
                <mml:mo>α</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>+</mml:mo>
                <mml:mo>β</mml:mo>
                <mml:mo>(</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>+</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>)</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>]</mml:mo>
                <mml:mo>-</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mrow>
                  <mml:msub>
                    <mml:mo stretchy="false">∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>k</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>C</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>C</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mrow>
                <mml:mo stretchy="true">}</mml:mo>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <disp-formula id="E13">
          <label>(12)</label>
          <mml:math id="M13" display="block" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>G</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>β</mml:mo>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mo>∂</mml:mo>
            <mml:mi>L</mml:mi>
            <mml:mo>/</mml:mo>
            <mml:mo>∂</mml:mo>
            <mml:mo>β</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:mo stretchy="false">{</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>(</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>+</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>)</mml:mo>
                <mml:mo>/</mml:mo>
                <mml:mo>[</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>+</mml:mo>
                <mml:mo>α</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>+</mml:mo>
                <mml:mo>β</mml:mo>
                <mml:mo>(</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>+</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>)</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>]</mml:mo>
                <mml:mo>-</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mrow>
                  <mml:msub>
                    <mml:mo stretchy="false">∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>k</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>C</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>C</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mrow>
                <mml:mo stretchy="false">}</mml:mo>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <disp-formula id="E14">
          <label>(13)</label>
          <mml:math id="M14" display="block" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>H</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>α</mml:mo>
                <mml:mo>α</mml:mo>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mo>∂</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mi>L</mml:mi>
            <mml:mo>/</mml:mo>
            <mml:mo>∂</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mo>α</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mo>=</mml:mo>
            <mml:mo>-</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:mo stretchy="true">{</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msup>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>/</mml:mo>
              </mml:mrow>
            </mml:mrow>
            <mml:msup>
              <mml:mrow>
                <mml:mo>[</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>+</mml:mo>
                <mml:mo>α</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>+</mml:mo>
                <mml:mo>β</mml:mo>
                <mml:mo>(</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>+</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>)</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>]</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mo stretchy="true">}</mml:mo>
          </mml:math>
        </disp-formula>
        <disp-formula id="E15">
          <label>(14)</label>
          <mml:math id="M15" display="block" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>H</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>β</mml:mo>
                <mml:mo>β</mml:mo>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mo>∂</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mi>L</mml:mi>
            <mml:mo>/</mml:mo>
            <mml:mo>∂</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mo>β</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mo>=</mml:mo>
            <mml:mo>-</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:mo stretchy="true">{</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msup>
                  <mml:mrow>
                    <mml:mo>[</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>(</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>+</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>)</mml:mo>
                    <mml:mo>]</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>/</mml:mo>
              </mml:mrow>
            </mml:mrow>
            <mml:msup>
              <mml:mrow>
                <mml:mo>[</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>+</mml:mo>
                <mml:mo>α</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>+</mml:mo>
                <mml:mo>β</mml:mo>
                <mml:mo>(</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>+</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>)</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>]</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mo stretchy="true">}</mml:mo>
          </mml:math>
        </disp-formula>
        <disp-formula id="E16">
          <label>(15)</label>
          <mml:math id="M16" display="block" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>H</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>α</mml:mo>
                <mml:mo>β</mml:mo>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mo>∂</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mi>L</mml:mi>
            <mml:mo>/</mml:mo>
            <mml:mo>∂</mml:mo>
            <mml:mo>α</mml:mo>
            <mml:mo>∂</mml:mo>
            <mml:mo>β</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mo>-</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:mo stretchy="true">{</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msup>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>(</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>+</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>)</mml:mo>
                <mml:mo>/</mml:mo>
              </mml:mrow>
            </mml:mrow>
            <mml:msup>
              <mml:mrow>
                <mml:mo>[</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>+</mml:mo>
                <mml:mo>α</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>+</mml:mo>
                <mml:mo>β</mml:mo>
                <mml:mo>(</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>+</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>)</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>]</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mo stretchy="true">}</mml:mo>
          </mml:math>
        </disp-formula>
        <p>Since –<italic toggle="yes">H</italic> is a positive-definite matrix, –<italic toggle="yes">L</italic> is also a convex function for the vector (<inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula>, <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula>) when all the <bold><italic toggle="yes">C</italic></bold><sub><italic toggle="yes">i</italic></sub> are fixed, and the optimization problem can be solved by Newton method.</p>
        <p>Finally, the whole algorithm works by sequentially optimize <bold><italic toggle="yes">C</italic></bold><sub><italic toggle="yes">i</italic></sub> on each chromosome, and then optimize <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula> and <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula>. By iterating this procedure, each time the likelihood function will only increase so the algorithm will finally converge to a local maximum. But since the likelihood function is not overall convex, a global maximum is not guaranteed. When the number of sub-compartments <italic toggle="yes">M</italic> is large, the likelihood landscape is quite complicated, and the algorithm often converges to a local maximum. In this case, we use multiple random starting points and compare the final likelihood value to select the best one.</p>
      </sec>
      <sec>
        <title>2.1.3. Excluded regions and region groups</title>
        <p>The existing genome assemblies are not perfect, and the real genome may be different among cell lines. Some of the regions have been identified to have abnormal results in genome sequencing experiments and are “blacklisted” (<xref rid="btad314-B1" ref-type="bibr">Amemiya et al. 2019</xref>). We also excluded these blacklisted regions from our analysis. All blacklisted regions will have all their “<bold><italic toggle="yes">C</italic></bold><sub><italic toggle="yes">i</italic></sub>”s set to 0.</p>
        <p>Moreover, there are genome translocations which make <italic toggle="yes">trans</italic>-interactions <italic toggle="yes">cis</italic>, and resulted in much more interactions than expected because genomic regions in the same chromosome interact at much higher frequency. These regions will form a separate compartment in the result because of the high interaction frequency and are easy to identify from normal compartments. The users can also refer to other software or data sources for genomic translocations. When such a translocation compartment is identified, a “blacklisted region group” can be made, and in the algorithm, any pairs of regions within a blacklisted group would not be used in the analysis, which means in the <xref rid="E4" ref-type="disp-formula">Equation (4)</xref>, only those region pairs not within the same excluded group will be used.</p>
      </sec>
    </sec>
    <sec>
      <title>2.2 Additional conditions when the model hypotheses can be violated and the consequences</title>
      <p>We have introduced the three hypotheses for the model above. We outline them here and discuss them one by one.</p>
      <p>Hypothesis 1: For two different genomic loci <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic>, their nuclear sub-compartment locations in individual cells are independent.</p>
      <p>It is easy to imagine that if the two genomic loci are close to each other, like in the same topological-associated domains, the hypothesis will not be satisfied. Therefore, this hypothesis will not hold for all pairs of genomic loci. However, if we only consider <italic toggle="yes">trans</italic>-interactions, the locations of two genomic loci on different chromosomes should be mostly independent.</p>
      <p>One possibility we do need to consider is that if the cell population is structurally heterogeneous, i.e. it is a mixture of two or more different cell populations, which could be either different cell types or different cell states, then the independency hypothesis may be violated.</p>
      <p>Consider there are two different cell populations, then <xref rid="E3" ref-type="disp-formula">Equation (3)</xref> becomes
</p>
      <disp-formula id="E17">
        <label>(16).</label>
        <mml:math id="M17" display="block" overflow="scroll">
          <mml:msub>
            <mml:mrow>
              <mml:mi>F</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>i</mml:mi>
              <mml:mi>j</mml:mi>
            </mml:mrow>
          </mml:msub>
          <mml:mo>=</mml:mo>
          <mml:msub>
            <mml:mrow>
              <mml:mi>R</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>i</mml:mi>
              <mml:mi>j</mml:mi>
            </mml:mrow>
          </mml:msub>
          <mml:mrow>
            <mml:msub>
              <mml:mo stretchy="false">∑</mml:mo>
              <mml:mrow>
                <mml:mi>k</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>C</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>C</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>j</mml:mi>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
          </mml:mrow>
          <mml:mo>+</mml:mo>
          <mml:msub>
            <mml:mrow>
              <mml:mi>R</mml:mi>
              <mml:mi mathvariant="normal">'</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>i</mml:mi>
              <mml:mi>j</mml:mi>
            </mml:mrow>
          </mml:msub>
          <mml:mrow>
            <mml:msub>
              <mml:mo stretchy="false">∑</mml:mo>
              <mml:mrow>
                <mml:mi>k</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>C</mml:mi>
                  <mml:mi mathvariant="normal">'</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>C</mml:mi>
                  <mml:mi mathvariant="normal">'</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>j</mml:mi>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>In this case, the <xref rid="E3" ref-type="disp-formula">Equation (3)</xref> still maintains its form if the Rabl effects are similar. Only the interpretation of the <italic toggle="yes">C<sub>ik</sub></italic> values needs to be changed, which means Equations (6) and (7) may not hold. This means we will need a more careful interpretation of the Cscores when dealing with a mixed cell population. On the positive side, this means our method can identify structural heterogeneity in the cell population.</p>
      <p>Hypothesis 2: Genomic loci located at different nuclear sub-compartments in one cell do not have 3D interaction in that cell.</p>
      <p>In the model, the nuclear sub-compartments correspond to physical locations within the nucleus. Therefore, the frequency of interactions between genomic loci in different sub-compartments should be very low. Only when the two loci are located at the boundary of two neighboring sub-compartments, they should have a low chance of interacting with each other. However, when the interaction frequency is low compared to intra-compartment interactions, this will cause only minor effects.</p>
      <p>Hypothesis 3: Genomic loci located at the same sub-compartment in one cell have a constant probability of interaction.</p>
      <p>This hypothesis is the most likely to be violated since it is very likely DNA sequences in different nuclear sub-compartments will have different organization and structures, and thus different physical properties and within-compartment interaction frequencies. For example, highly active genomic regions likely have higher <italic toggle="yes">trans</italic>-interaction frequency than condensed heterochromatin. Therefore, our hypothesis has a limitation of over-simplification, and we need to consider the consequences when this hypothesis is violated. Assume for each sub-compartment <italic toggle="yes">k</italic>, the interaction frequency has a modifier <italic toggle="yes">S<sub>k</sub></italic>, then we have:
</p>
      <disp-formula id="E18">
        <label>(17)</label>
        <mml:math id="M18" display="block" overflow="scroll">
          <mml:msub>
            <mml:mrow>
              <mml:mi>F</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>i</mml:mi>
              <mml:mi>j</mml:mi>
            </mml:mrow>
          </mml:msub>
          <mml:mo>=</mml:mo>
          <mml:msub>
            <mml:mrow>
              <mml:mi>B</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>i</mml:mi>
            </mml:mrow>
          </mml:msub>
          <mml:msub>
            <mml:mrow>
              <mml:mi>B</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>j</mml:mi>
            </mml:mrow>
          </mml:msub>
          <mml:msub>
            <mml:mrow>
              <mml:mi>f</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>i</mml:mi>
              <mml:mi>j</mml:mi>
            </mml:mrow>
          </mml:msub>
          <mml:mo>=</mml:mo>
          <mml:msub>
            <mml:mrow>
              <mml:mi>B</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>i</mml:mi>
            </mml:mrow>
          </mml:msub>
          <mml:msub>
            <mml:mrow>
              <mml:mi>B</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>j</mml:mi>
            </mml:mrow>
          </mml:msub>
          <mml:msub>
            <mml:mrow>
              <mml:mi>R</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>i</mml:mi>
              <mml:mi>j</mml:mi>
            </mml:mrow>
          </mml:msub>
          <mml:mrow>
            <mml:msub>
              <mml:mo stretchy="false">∑</mml:mo>
              <mml:mrow>
                <mml:mi>k</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>S</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>k</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mi>P</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>j</mml:mi>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>Let <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msqrt><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:msqrt></mml:math></inline-formula>, then we still have <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. This means the <xref rid="E3" ref-type="disp-formula">Equation (3)</xref> still holds in its original form, only the interpretation of <italic toggle="yes">C<sub>ik</sub></italic> changes. When the interaction is stronger in one sub-compartment, it will cause globally higher <italic toggle="yes">C<sub>ik</sub></italic> values in that sub-compartment, while weaker interactions will cause lower <italic toggle="yes">C<sub>ik</sub></italic> values. This will skew the prediction of <italic toggle="yes">P<sub>ik</sub></italic> to globally higher/lower probability. The relative higher/lower probabilities of sub-compartment localization between regions should still hold.</p>
    </sec>
    <sec>
      <title>2.3 Simulated Hi-C data generation</title>
      <p>As discussed above, the likelihood function (<xref rid="E4" ref-type="disp-formula">Equation 4</xref>) is complicated and non-convex. Though we can try multiple random starting points, it is uncertain whether the algorithm is robust enough to converge close to the correct optimum values or other sub-optimal local minima. To test the robustness of the method, we performed the following simulation tests.</p>
      <p>The first simulation was performed according to our generative model with given model parameters. For each <italic toggle="yes">trans</italic> pair of genomic regions <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic>, the Rabl effect <italic toggle="yes">R<sub>ij</sub></italic> is first calculated using <xref rid="E5" ref-type="disp-formula">Equation (5)</xref>. Then the expected number of interactions between the two regions can be calculated with <xref rid="E2" ref-type="disp-formula">Equation (2)</xref>. Finally, the number of observed interactions is generated with Poisson distribution using the expected number of interactions as the parameter. If interactions exist, then the interactions will be output into the simulated Hi-C dataset. After iterating all the <italic toggle="yes">trans</italic> pairs, a full Hi-C dataset is simulated. Then CscoreTool-M is run on the simulated Hi-C dataset to infer compartment scores.</p>
      <p>For low-depth dataset simulation, a full Hi-C dataset is first simulated, then a low-depth dataset is generated by down-sampling the full dataset to the lower depth.</p>
      <p>For simulation using randomized model parameters, we started from the sub-compartment annotations by Rao et al.’s original Gaussian-HMM annotations. We randomly generated Cscores with different noise levels (NL): For each genomic window, the “annotated” compartment (A1, A2, B1, B2, B3, B4) would take a score of random number from uniform distribution U(1-NL, 1), the other compartments take scores of random numbers from U(0, NL). Note that we also take the B4 compartment into consideration here as it is within Rao’s annotation, so even though only a small number of genomic regions are annotated as B4, all genomic windows will have B4 scores. Then we normalized the Cscores and simulated inter-chromosomal Hi-C dataset to the same depth as the 0.01× GM12878 dataset (about 9M <italic toggle="yes">trans</italic> reads). We did the simulation for different noise levels from 0.05 to 0.5.</p>
      <p>For mixed dataset simulation, two Hi-C datasets are first simulated independently according to the two sets of parameters. Then the high-depth dataset between the two was down-sampled to match the depth of the lower one. Finally, the two Hi-C datasets were merged to become one mixed dataset.</p>
    </sec>
    <sec>
      <title>2.4. AIC calculation</title>
      <p>We use the AIC (Akaike Information Criterion) analysis for model selection. AIC is a method for model selection based on the likelihood value and number of parameters and lower AIC values indicate a better model. AIC is calculated with the equation:
</p>
      <disp-formula id="E19">
        <mml:math id="M19" display="block" overflow="scroll">
          <mml:mi mathvariant="normal">AIC</mml:mi>
          <mml:mo>=</mml:mo>
          <mml:mn>2</mml:mn>
          <mml:mi>k</mml:mi>
          <mml:mo>-</mml:mo>
          <mml:mn>2</mml:mn>
          <mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">ln</mml:mi>
            </mml:mrow>
            <mml:mo>⁡</mml:mo>
            <mml:mrow>
              <mml:mi>L</mml:mi>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>Here, <italic toggle="yes">k</italic> is the number of parameters calculated by <italic toggle="yes">k=nM </italic>+<italic toggle="yes"> </italic>2, where <italic toggle="yes">M</italic> is the number of sub-compartments, and <italic toggle="yes">n</italic> is the number of non-empty genomic windows. <italic toggle="yes">L</italic> is the estimated maximum value of the likelihood function.</p>
    </sec>
    <sec>
      <title>2.5. Lamin-B1 cTSA-seq and data processing</title>
      <p>cTSA-seq was performed and Illumina sequencing libraries were built as in (<xref rid="btad314-B30" ref-type="bibr">Tran et al. 2022</xref>). Both cTSA-seq reads and input reads were sequenced with Nextseq 500 Illumina sequencer. Reads were mapped to human genome hg19 using bowtie2 with default parameters. Then for each 100 kb (or 10 kb) genomic window, the number of reads falling into the window was counted, and a relative enrichment was calculated by dividing the number of cTSA-seq reads with the number of input reads. Lamin-B1 cTSA-seq result of GM12878 cell line is available in the GEO database (<ext-link xlink:href="https://www.ncbi.nlm.nih.gov/geo/" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/geo/</ext-link>) and can be accessed with accession number GSE224282.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Validation on simulated data</title>
      <p>To test whether CscoreTool-M can infer the correct sub-compartments, we first performed a simulation test using the GM12878 cell Hi-C data (<xref rid="btad314-B21" ref-type="bibr">Rao et al. 2014</xref>) as a template. The purpose of this simulation is to test whether the optimization algorithm can correctly estimate the original parameters when all the hypotheses fit. We first ran CscoreTool-M on the GM12878 cell Hi-C data to estimate compartment scores for five sub-compartments at 100 kb resolution using the <italic toggle="yes">trans</italic> interactions (Mod1 to Mod5 on <xref rid="btad314-F1" ref-type="fig">Fig. 1A</xref>). Then we simulated Hi-C <italic toggle="yes">trans</italic> interactions at the same depth as the original dataset (1× dataset) using the GM12878 compartment scores as model parameters. We next applied our algorithm on the simulated dataset to infer compartment scores (Sim1 to Sim5 on <xref rid="btad314-F1" ref-type="fig">Fig. 1A</xref>).</p>
      <fig position="float" id="btad314-F1">
        <label>Figure 1.</label>
        <caption>
          <p>Simulation test using GM12878 cell and IMR90 cell Hi-C datasets. (A) Genome browser view of compartment scores on simulated data (sim1-sim5) compared to the model values (mod1-mod5). Compartment scores on Y axes range from 0 to 1. (B) Contour plots showing the compartment scores calculated on full (1×), low (0.1×), and ultralow (0.01×) depth simulated datasets compared to the model values. R: Pearson correlation coefficient. All X and Y axes compartment score values range from 0 to 1. (C) Genome browser view of compartment scores on simulated mixed dataset compared to the model values. R: Pearson correlation coefficient. All Y axes range from 0 to 1.</p>
        </caption>
        <graphic xlink:href="btad314f1" position="float"/>
      </fig>
      <p>The chromosomal view of the inferred compartment scores shows high consistency with the model parameters (<xref rid="btad314-F1" ref-type="fig">Fig. 1A</xref>). To quantify the divergence between the inferred compartment scores and the model parameters, we calculated the genome-wide correlation coefficients and high correlations are observed for all sub-compartments (<xref rid="btad314-F1" ref-type="fig">Fig. 1B</xref>, left panels).</p>
      <p>To further test the performance of our method at lower read depth, we generated 0.1× and 0.01× datasets by randomly selecting 10% and 1% from the original dataset, respectively, and calculated the correlation coefficients. The correlations are weaker on low-depth datasets (<xref rid="btad314-F1" ref-type="fig">Fig. 1B</xref>, mid and right panels), but they are still higher than 0.9 even on the 0.01× dataset.</p>
      <p>We also performed simulation analysis on randomized model parameters using the sub-compartment annotations by Rao et al.’s original Gaussian-HMM as template and randomized to different noise levels. We simulated the Hi-C data, calculated the compartment scores for five compartments and calculated the correlation coefficient with the simulated compartment scores of A1, A2, B1, B2, and B3. We did the analyses for different noise levels from 0.05 to 0.5 and the correlation coefficients between each inferred compartment scores and its corresponding simulated scores are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>. We found that the correlation coefficients become lower when the noise is higher, but all the results are still highly consistent with the simulated scores.</p>
      <p>The theoretical analysis (see Section 2.2) suggested that CscoreTool-M can be used to deconvolve mixed cell population. To test this, we simulated two Hi-C datasets using model parameters for GM12878 (Mod1-1 to Mod1-5) and IMR90 Hi-C data (Mod2-1 to Mod2-5) (<xref rid="btad314-F1" ref-type="fig">Fig. 1C</xref>). We then mixed these two datasets and applied our algorithm to infer 10 sub-compartments (Sim1 to Sim10 on <xref rid="btad314-F1" ref-type="fig">Fig. 1C</xref>). We found five sub-compartments (Sim1 to Sim5) resembled the GM12878 model well (Mod1-1 to Mod1-5), while the other five compartments (Sim6 to Sim10) have a similar profile to the IMR90 model (Mod2-1 to Mod2-5). This result shows that our algorithm can infer cell-type specific sub-compartments in mixed cell types.</p>
    </sec>
    <sec>
      <title>3.2 Comparisons with the published multi-compartment analyses</title>
      <p>To further test the performance of our CscoreTool-M, we compared our results with the published multi-compartments inferred by <xref rid="btad314-B21" ref-type="bibr">Rao et al<italic toggle="yes">.</italic> (2014)</xref>. Rao et al. inferred 6 sub-compartments as A1–A2 and B1–B4 in GM12878 cells. A1 and A2 are both enriched for active chromatin features such as H3K4me3, H3K27Ac, H3K36me3 and DNAse I hypersensitivity. A1 has higher enrichment of active markers than A2 and A1 overlaps with nuclear speckle domains (<xref rid="btad314-B8" ref-type="bibr">Chen et al. 2018</xref>). B1 to B4 all contain repressed chromatin domains and are depleted of active epigenetic markers. B1 is enriched with H3K27me3 which is regulated by the Polycomb Repressive Complexes. B2 and B3 are both enriched for LADs (determined by the lamin-A/C ChIP-seq), with B2 further enriched of NADs while B3 is not. This suggested that B2 represents NADs while B3 represents LADs. B4 only covers a very small proportion of the genome on chr19. Thus, we excluded B4 and only compared our 5 sub-compartments inferred by CscoreTool-M with the five compartments inferred by Rao et al.</p>
      <p>We use the same notation as in Rao et al. (RaoA1, RaoA2, RaoB1, RaoB2, and RaoB3) for our five sub-compartments but add “C5” before the compartment names (C5A1, C5A2, C5B1, C5B2, and C5B3) to indicate our CscoreTool-M modeled five sub-compartments. <xref rid="btad314-F2" ref-type="fig">Figure 2A and B</xref> shows our five sub-compartment plots based on CscoreTool-M and color-coded bar-tracks for the compartments assigned by Rao et al. In general, our compartment scores show peaks at Rao’s assigned compartments, indicating that our compartment inference is largely consistent with the compartments indicated by Rao. It is noteworthy that there are also regions showing inconsistencies. <xref rid="btad314-F2" ref-type="fig">Figure 2A and B</xref> shows that two regions on chr10 and chr12 have C5B1 sub-compartment scores peaks, while Rao et al. predicted these regions to be in A1. To further investigate which sub-compartments these regions should be in, we looked at gene expression and epigenetics features along these regions. Our C5B1 peaks show a depletion of H3K27Ac and reduced gene expression, but enriched for H3K27me3, which are typical B1 features instead of A1.</p>
      <fig position="float" id="btad314-F2">
        <label>Figure 2.</label>
        <caption>
          <p>Comparisons of compartments modeled by CscoreTool-M against Rao’s sub compartments in GM12878 cells. (A,B) Genome browser view of chromosome 10 (A) and 12 (B) showing the compartment scores tracks by CscoreTool-M and compartments (indicated by different colored blocks) by Rao et al. Example regions in black rectangles showing discrepancies between CscoreTool-M and Rao et al. are expanded and shown at the right panels. All <italic toggle="yes">Y</italic> axes plot for compartment scores range from 0 to 1. (C) Enrichment of H3K27Ac and H3K27me3 peaks in regions agreed or disagreed inferred by CscoreTool-M or Rao et al. H3K27Ac and H3K27me3 data are from UCSC genome browser ENCODE tracks. (D) Genome-wide correlation coefficients between CsocreTool-M, Rao’s Gaussion-HMM, SNIER, SCI-inferred compartment scores and SON-TSA-seq, H3K27me3 ChIP-seq, Lamin-B1 cTSA-seq enrichment signals at 100-kb resolution. The best scores for each method are highlighted. (E) Genome-wide correlation coefficients between CsocreTool-M, Calder-inferred scores and SON-TSA-seq, H3K27me3 ChIP-seq, Lamin-B1 cTSA-seq enrichment signals at 10-kb resolution. The best scores for each method are highlighted.</p>
        </caption>
        <graphic xlink:href="btad314f2" position="float"/>
      </fig>
      <p>To further analyse whether the difference in A and B sub-compartment assignment by Rao and by our CscoreTool-M also happens on other chromosomes, we assigned the five compartments based on the highest compartment score at each genomic region across the genome and compared these to the compartments assigned by Rao et al. (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). While the overall correspondence in A and B sub-compartments is good, there are some clear differences. For example, we found that a total of 45.1M genomic regions are assigned as A1 by Rao but are assigned as C5B1 by CscoreTool-M (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). We further looked at the enrichment of H3K27Ac peaks and H3K27me3 peaks on these regions (<xref rid="btad314-F2" ref-type="fig">Fig. 2C</xref>) and found that the H3K27Ac enrichment (1.2) is just marginally higher than the global average (1.0), while much lower than the enrichment of H3K27Ac peaks on A1 regions assigned commonly by Rao and CscoreTool-M. In contrast, the H3K27me3 peaks showed much higher enrichment (2.02) than that found on A1 regions assigned commonly by Rao and CscoreTool-M (0.71), and also higher than the global average (1.0). We made a similar observation in regions assigned as A2 by Rao and C5B1 by CscoreTool-M. The C5B1 regions show lower H3K27Ac and higher H3K27me3 than the corresponding RaoA2 regions and also than global average (<xref rid="btad314-F2" ref-type="fig">Fig. 2C</xref>). These results show that the CscoreTool-M-assigned C5B1 regions have B1 features instead of A1/A2 features. Thus, the CscoreTool-M can better predict sub-compartments in these regions.</p>
      <p>To further compare the performance between CscoreTool-M and other published methods, including Rao’s original Gaussian HMM, SNIPER, SCI, and Calder, we used three independent protein-DNA-interaction datasets as benchmarks: SON TSA-seq (of K562 cells) for approximation of A1 (<xref rid="btad314-B8" ref-type="bibr">Chen et al. 2018</xref>), H3K27me3 ChIP-seq for B1 (<xref rid="btad314-B28" ref-type="bibr">Thurman et al. 2012</xref>), and lamin-B1 cTSA-seq for B3 (this study). For CscoreTool-M, we used the 5-compartment scores; while for Gaussian-HMM, SNIPER, Calder, and SCI, we used their compartment assignment, 1 for the assigned compartment, and 0 for the others. We calculated the correlation coefficients between the compartment scores generated from each of the sub-compartment analysis methods (CscoreTool-M, Gaussian-HMM, SNIPER, SCI, or Calder) and the enrichment scores generated from each protein-DNA interaction dataset (SON TSA-seq, H3K27me3 ChIP-seq, and Lamin-B1 cTSA-seq). We use these correlation coefficients as a fair comparison as none of Cscoretool-M, Gaussion-HMM, SNIPER, Calder, or SCI directly used this information based on protein-DNA interaction/colocalization datasets. Note that as most results previous are based on the hg19 genome, here the comparisons are also on hg19.</p>
      <p><xref rid="btad314-F2" ref-type="fig">Figure 2D</xref> lists the comparison results between CscoreTool-M and Rao’s Gaussian-HMM, SNIPER, and SCI. We found that in all three comparisons for A1, B1, and B3, the results of CscoreTool-M showed the best performance. The comparison against Calder was shown in <xref rid="btad314-F2" ref-type="fig">Fig. 2E</xref>. Since Calder provided 10 kb-resolution results, we also applied CscoreTool-M at 10 kb resolution for comparison. In these comparisons, CscoreTool-M also showed better performance than Calder. Taken together, these results show that CscoreTool-M can quantify the sub-compartment probabilities in cell population and the performances are confirmed by other independent measures; and that CscoreTool-M has the best performance in sub-compartment inference among published methods.</p>
      <p>We also tested the performance of our CscoreTool-M on low-depth Hi-C sequencing data by randomly selecting 0.1× and 0.01× of the reads from the Hi-C data for GM12878 cells to infer sub-compartments. We then calculated the correlation coefficient on the sub-compartments. We found all the correlation coefficients are higher than 0.9 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>), indicating that the CscoreTool-M is robust in inferring multiple genomic compartments using low-depth Hi-C datasets. Comparison between biological replicates of GM12878 Hi-C data also showed high correlation (all &gt; 0.97, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>), further supporting the robustness of the method.</p>
      <p>One important hyper-parameter of CscoreTool-M and other sub-compartment inference tools is the number of sub-compartments. We first compared 2- and 5-compartment results to see how this hyper-parameter can determine the sub-compartment results. We calculated the correlation coefficients between 2- and 5-compartment scores (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>). A1 has the highest correlation with A compartment score, followed by A2; B3 has the highest correlation with B compartment score, followed by B2. Interestingly, B1 has mildly positive correlation with A compartment score instead of B. It has been reported that the B1 sub-compartment is located farther away from the nuclear periphery than A2 (<xref rid="btad314-B23" ref-type="bibr">Robson et al. 2017</xref>), indicating that when only considering 2-compartments, it is correct to assign the B1 compartment as mostly A-like. However, with 5-sub-compartment analysis, it is possible to further separate the B1 sub-compartment from the A-compartment and correctly identify its polycomb-repressed features. This result shows that with more sub-compartments, it is possible to identify more detailed information of 3D genome organization.</p>
      <p>Since CscoreTool-M uses maximum-likelihood inference, it is natural to use the AIC (Akaike Information Criterion) for model selection. AIC is a method for model selection based on the likelihood value and number of parameters. The lower AIC values indicate a better model. We applied AIC to two datasets (0.1× and 0.01× data of GM12878) at 100 kb resolution. For lower-depth dataset (0.01×), the AIC reached a minimum at 6 compartments, indicating that 6 is the statistical optimal compartment number for this dataset (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6A</xref>), while for a higher-depth dataset (0.1×), the AIC values decrease as the number of compartments increase up to 15 compartments (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6B</xref>) indicating that more compartments continuously lead to better fitting of the GM12878 Hi-C data at this depth. In this case, the statistical optimal compartment number is at least 15. The users can perform a similar analysis to determine the statistically optimal number of sub-compartments. However, depending on the biological questions and when the sequencing depth is high, the analysis may not need to reach the optimal minimum. In all the bulk-Hi-C datasets we use below, the AIC analysis supports more than 15 sub-compartments, and we used 5, 6, or 10 just because they are enough to support our biological findings.</p>
    </sec>
    <sec>
      <title>3.3 Inferring LAD and NAD heterogeneity within a cell population</title>
      <p>One feature of CscoreTool-M is that it explicitly models and quantifies the heterogeneity within a cell population, which should aid the study of variations of genome organization. It is known that NADs often overlap with LADs, but the overlap only happens for some NADs. The NAD-only and the overlapping NAD/LAD chromatin regions tend to have different genomic features (<xref rid="btad314-B31" ref-type="bibr">Vertii et al. 2019</xref>; <xref rid="btad314-B3" ref-type="bibr">Bersaglieri et al. 2022</xref>). Since nucleoli are often not located at the nuclear periphery, the biological interpretation of the overlap between NADs and LADs remains unclear. The localization of lamins in nucleolus as reported by some studies (<xref rid="btad314-B15" ref-type="bibr">Martin et al. 2009</xref>; <xref rid="btad314-B25" ref-type="bibr">Sen Gupta 2017</xref>) can contribute to the NAD/LAD overlap. In addition, only a fraction of LADs may return to the nuclear lamina after mitosis, and the ones not returning to the nuclear lamina often relocate to peri-nucleolar regions (<xref rid="btad314-B12" ref-type="bibr">Kind et al. 2013</xref>). In this case, the overlapping LADs and NADs regions can come from heterogeneity within the cell population, with the same regions located at the nucleoli or nuclear periphery in different cells within the population.</p>
      <p>We applied CscoreTool-M to infer LADs and NADs based on the Hi-C dataset for the GM12878 cell population. One interesting feature we noticed is that our compartment scores show clear variations among Rao et al’s B2 chromatin regions. Examples are shown for chr18 and chr19 (<xref rid="btad314-F3" ref-type="fig">Fig. 3A and B</xref>), which are known to localize preferentially to the nuclear periphery and nuclear interior, respectively (<xref rid="btad314-B9" ref-type="bibr">Croft et al. 1999</xref>). On chr18, about half of the chromosome was assigned as B2 by Rao et al. (RaoB2), but based on Cscoretool-M these regions have similar C5B2 and C5B3 scores. Although RaoB2 and RaoB3 are suggested to represent NADs and LADs regions, respectively, our analyses indicate that the RaoB2 chromatin regions on chr18 exhibit cell-cell heterogeneity with about half of the cells having nucleolar localization and the other half localizing at the nuclear lamina. In contrast to chr18, CscoreTool-M found that the RaoB2 regions on chr19 have high C5B2 scores and low C5B3 scores, suggesting that these regions are NADs but not LADs. This correctly infers that the interiorly localized chr19 has limited LADs compared to that of chr18.</p>
      <fig position="float" id="btad314-F3">
        <label>Figure 3.</label>
        <caption>
          <p>Inferring NADs and LADs in GM12878 cells. Genome browser view of chromosome 18 (A) and 19 (B) showing the CscoreTool-M compartment score tracks and the corresponding compartments by inferred by Rao et al. Black rectangles indicate two examples of RaoB2 regions showing high C5B2 and C5B3 scores on chr18 (A) or two examples of RaoB2 regions with high C5B2 and low C5B3 scores on chr19 (B). All Y axes plotting compartment scores range from 0 to 1. (C) Genome-wide correlation coefficients between CscoreTool-M inferred 6-subcompartment scores and NAD-seq, Lamin-B1 DamID enrichment signals at 100-kb resolution.</p>
        </caption>
        <graphic xlink:href="btad314f3" position="float"/>
      </fig>
      <p>Since there is no NADs data on GM12878 or similar cell types, we tested the performance of CscoreTool-M to quantify the heterogeneity of LADs and NADs on mouse embryonic stem cells (mESC). We downloaded NAD-seq data from (<xref rid="btad314-B5" ref-type="bibr">Bizhanova et al. 2020</xref>), Lamin-B1 DamID data from (<xref rid="btad314-B20" ref-type="bibr">Peric-Hupkes et al. 2010</xref>), and calculated NAD-seq and Lamin-B1 DamID enrichment signals on 100 kb windows along the genome. We then applied CscoreTool-M to mESC Hi-C data (<xref rid="btad314-B6" ref-type="bibr">Bonev et al. 2017</xref>), and calculated the correlation coefficients with NAD-seq and Lamin-B1 DamID (<xref rid="btad314-F3" ref-type="fig">Fig. 3C</xref>). We found that with six sub-compartments, one of the sub-compartments, C6_6, has a very high correlation coefficient (0.88) with NAD-seq, and only 0.567 with LaminB1 DamID. In contrast, another sub-compartment, C6_5, has a high correlation coefficient (0.778) with LaminB1 DamID, while only 0.160 with NAD-seq. This result shows that CscoreTool-M can successfully identify separate sub-compartments that correspond to NADs and LADs, respectively. The high correlation coefficients against NAD-seq and Lamin-B1 DamID signals further confirm that the probabilities of locating in LADs or NADs inferred by CscoreTool-M are highly consistent with the results from independent measurements. Taken together, our method can infer the heterogeneity of NADs and LADs localization and quantify the different levels of heterogeneity among genomic regions within the cell population.</p>
    </sec>
    <sec>
      <title>3.4 Inferring the degree of compartment heterogeneity in different cell types</title>
      <p>Studies have revealed clear variations in 3D genome interactions in individual cells belonging to the same cell type. These variations can be purely stochastic or related to different cell states, such as different cell-cycle or differentiation stages. On the other hand, a given cell type, i.e. not proliferating and is terminally differentiated should exhibit relatively low heterogeneity in genome organization. Our CscoreTool-M should be able to infer the degree of 3D genome organizational heterogeneities among different cell types and within a population of cells belonging to the same cell type or lineage. To test this, we applied CscoreTool-M to analyse the Hi-C dataset for the isolated pure mature olfactory sensory neurons (OSN) (<xref rid="btad314-B17" ref-type="bibr">Monahan et al. 2019</xref>). The result of the 5-compartment analyses (<xref rid="btad314-F4" ref-type="fig">Fig. 4A</xref>) shows sharper sub-compartment boundaries and lower background scores than those of the five compartments inferred based on the Hi-C datasets for GM12878 and IMR90 cells (see <xref rid="btad314-F1" ref-type="fig">Fig. 1C</xref>).</p>
      <fig position="float" id="btad314-F4">
        <label>Figure 4.</label>
        <caption>
          <p>Comparisons of the level of compartment heterogeneity among different cell types. (A) Genome browser view of five compartments for olfactory sensory neurons (OSN) on chr1 inferred by CscoreTool-M. All <italic toggle="yes">Y</italic> axes plotting compartment scores range from 0 to 1. (B) Violin plot showing the information content calculated for each 100-kb window along the genome based on Hi-C datasets in four different cell types. (C) Violin plot showing the information content calculated for each 100-kb window along the genome based on single-cell Hi-C datasets in four cell-cycle stages of mESC compared to bulk.</p>
        </caption>
        <graphic xlink:href="btad314f4" position="float"/>
      </fig>
      <p>To further quantify the degree of heterogeneity, we calculated the information content (IC) of sub-compartment scores along the genome. IC is defined as <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mn>0.2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for 5 sub-compartments, is highest if the sub-compartment score is 1 for one sub-compartment and 0 for the remaining compartments (no heterogeneity), while lowest (0) if it is the same for all sub-compartments (no information). We found that IC for the olfactory neuron Hi-C dataset is generally higher than the GM12878 and IMR90 Hi-C datasets (<xref rid="btad314-F4" ref-type="fig">Fig. 4B</xref>), confirming our visual inspection of the genomic tracks. Since the olfactory sensory neurons were isolated from mice, we compared the information content of the mouse olfactory neuron Hi-C with a mouse ES cell (mESC) Hi-C dataset (<xref rid="btad314-B6" ref-type="bibr">Bonev et al. 2017</xref>). The olfactory neuron dataset still has significantly higher IC (<xref rid="btad314-F4" ref-type="fig">Fig. 4B</xref>). Thus, the difference is not due to the differences of cells derived from mice or humans.</p>
      <p>The above analysis suggests that cells that continue to proliferate may result in increased genome organization heterogeneity, and that cell cycle and the related chromatin conformation change is one major reason for heterogeneity. To test this hypothesis further directly, we applied CscoreTool-M to five cell-cycle-stage-sorted single-cell Hi-C datasets (<xref rid="btad314-B18" ref-type="bibr">Nagano et al. 2017</xref>) corresponding to G1, early S, mid S and late S/G2, respectively. We then applied 5-compartment analysis to these cell-cycle-resolved datasets and calculated the IC in all four cell cycle stages. We found that the IC values were higher than in the bulk mESC Hi-C data (<xref rid="btad314-F4" ref-type="fig">Fig. 4C</xref>). We also found that the IC values were lower in G1 than in early S, mid S, and late S/G2, consistent with the idea that the G1 phase is the most heterogeneous with rapid chromatin interaction changes from the mitotic to interphase conformation. These results show that CscoreTool-M can be used to infer and compare genomic organizational heterogeneity in different cell types, and that cell cycle is a major reason for sub-compartment heterogeneity.</p>
    </sec>
    <sec>
      <title>3.5 Inferring G1 genome organization in a population of asynchronously dividing cells</title>
      <p>In a given cell type, those cells that are proliferating can have different 3D genome interactions at different cell cycle stages, thereby contributing to the variation in chromatin organization among individual cells. Our simulation analysis suggests that the CscoreTool-M can deconvolve genomic organizational heterogeneity if we analyse a larger number of sub-compartments. We analyzed the Hi-C dataset obtained from the asynchronously dividing HCT116 cells (<xref rid="btad314-B22" ref-type="bibr">Rao et al. 2017</xref>) using 10 sub-compartments (<xref rid="btad314-F5" ref-type="fig">Fig. 5</xref>). Recently we have developed a <underline>c</underline>hromatin pull-down based <underline>T</underline>yramide-<underline>S</underline>ignal <underline>A</underline>mplification <underline>seq</underline>uencing (cTSA-seq) method to analyse LADs at different cell cycle stages using the human HCT116 cell line (<xref rid="btad314-B30" ref-type="bibr">Tran et al. 2022</xref>). We found that during early G1 the chromatin associated with the reforming NL are the sub-telomeric regions (<xref rid="btad314-F5" ref-type="fig">Fig. 5</xref>). Another study using a novel protein A-DamID approach described a similar, albeit weaker telomeric enrichment (<xref rid="btad314-B24" ref-type="bibr">van Schaik et al. 2020</xref>). Interestingly, one sub-compartment, HCT116 C10_7, predicted by CscoreTool-M is very similar to the early G1 LADs mapped by our cTSA-seq. The whole-genome comparison shows significant correlation between the compartment score of HCT116 C10_7 and the early G1 cTSA-seq LADs mapping (<italic toggle="yes">R</italic> = 0.42, <italic toggle="yes">P</italic> &lt; 10<sup>−16</sup>). This result shows that the C10_7 sub-compartment can capture the LADs pattern in the early G1 HCT116 cells.</p>
      <fig position="float" id="btad314-F5">
        <label>Figure 5.</label>
        <caption>
          <p>Inferring cell-cycle-related sub-compartments. Genome browser view of 10 compartments inferred by CscoreTool-M for HCT116 cells on chr1. Regions showing similarity between HCT116 C10_7 compartment and the early-G1-specific LADs determined by cTSA-seq using sorted early G1 HCT116 cells are highlighted in black boxes.</p>
        </caption>
        <graphic xlink:href="btad314f5" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.6 Inferring cell-type specific functional sub-compartments</title>
      <p>One interesting feature of the olfactory neuron is that the olfactory genes are clustered together in 3D (<xref rid="btad314-B17" ref-type="bibr">Monahan et al. 2019</xref>). To test whether our method can find this sub-compartment of olfactory genes, we applied the CscoreTool-M on the olfactory sensory neuron Hi-C dataset to model 10 sub-compartments. We found that one of the sub-compartments, OSN C10_1, overlapped well with the olfactory genes (<xref rid="btad314-F6" ref-type="fig">Fig. 6</xref>), indicating that our method can identify this functional gene cluster in one sub-compartment.</p>
      <fig position="float" id="btad314-F6">
        <label>Figure 6.</label>
        <caption>
          <p>Identification of function-related sub-compartments in OSN by 10 sub-compartment analyses. Genome browser view of 10-compartments for olfactory sensory neuron cells on chr11. The olfactory gene clusters are indicated with black bars on the top. Thickness of the bars indicate the number of olfactory genes.</p>
        </caption>
        <graphic xlink:href="btad314f6" position="float"/>
      </fig>
      <p>We reason that these functional gene clusters may also exist in other cell types. We first examined the GM12878 dataset. We performed 10-compartment analysis on the GM12878 dataset and found that the GM12878 C10_1 and C10_2 sub-compartments both have good correlations to the GM12878 C5A1 compartment but are enriched for genes with different functions based on the Gene Ontology (GO) analyses. The C10_1 sub-compartment is enriched for genes related to immune function, which may be functionally important as the GM12878 cells are derived from B-lymphocytes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7A</xref>). In contrast, the C10_2 sub-compartment is enriched for housekeeping genes with functions including translation and transcription (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7B</xref>). Interestingly, we found that the C10_2 sub-compartment for the olfactory sensory neurons is also enriched for housekeeping genes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7C</xref>). Finally, we applied CscoreTool-M to infer 10 sub-compartments in additional cell types with available Hi-C datasets to test if we can find 3D clustering of functionally related genes in individual genomic compartments. By analyzing mESCs, IMR90 fibroblasts, NHEK keratinocytes, and HCT116 colon cancer epithelial cells, we found a clear enrichment of housekeeping genes in two sub-compartments of mESC (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8A and B</xref>), one in IMR90 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8D</xref>) and one in HCT116 cells (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8E</xref>). GO analyses also revealed an enrichment of genes in the C10_3 compartment of mESC involved in embryonic development (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8C</xref>) and genes in the C10_2 compartment of NHEK cells involved in keratinocyte differentiation and skin development (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8F</xref>). Thus, CscoreTool-M can discover the 3D cluster of functionally related genes in different cell types.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusions</title>
    <p>In this study, we report CscoreTool-M, a model-based method to calculate sub-compartment scores from Hi-C data. The compartment scores calculated by Cscoretool-M for a given genomic region are directly proportional to the probability that the region is located at a specific sub-compartment. By comparing with other sub-compartment inference based on clustering method, we have shown that CscoreTool-M is better at inferring sub-compartments corresponding to both active and repressed chromatin. The compartment scores by CscoreTool-M also help quantify the levels of heterogeneity in sub-compartment localization within cell populations for different genomic regions. By comparing proliferating and terminally differentiated cells, we show that proliferating cells have higher genome organization heterogeneity, which is likely caused by different cell-cycle stages. By analyzing 10 sub-compartments, we found a sub-compartment potentially related to early-G1 LADs in HCT116 cells, suggesting the method can deconvolve sub-compartments from asynchronously dividing cell populations. Finally, we show that sub-compartments inferred by CscoreTool-M are often enriched in housekeeping or cell-type-specific functions.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad314_Supplementary_Data</label>
      <media xlink:href="btad314_supplementary_data.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> is available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the National Institutes of Health [R01GM106023 and R01GM110151 to Y.Z.].</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad314-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Amemiya</surname><given-names>HM</given-names></string-name>, <string-name><surname>Kundaje</surname><given-names>A</given-names></string-name>, <string-name><surname>Boyle</surname><given-names>AP</given-names></string-name></person-group><etal>et al</etal><article-title>The ENCODE blacklist: identification of problematic regions of the genome</article-title>. <source>Sci Rep</source><year>2019</year>;<volume>9</volume>:<fpage>9354</fpage>.<pub-id pub-id-type="pmid">31249361</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ashoor</surname><given-names>H</given-names></string-name>, <string-name><surname>Chen</surname><given-names>X</given-names></string-name>, <string-name><surname>Rosikiewicz</surname><given-names>W</given-names></string-name></person-group><etal>et al</etal><article-title>Graph embedding and unsupervised learning predict genomic sub-compartments from HiC chromatin interaction data</article-title>. <source>Nat Commun</source><year>2020</year>;<volume>11</volume>:<fpage>1173</fpage>.<pub-id pub-id-type="pmid">32127534</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bersaglieri</surname><given-names>C</given-names></string-name>, <string-name><surname>Kresoja-Rakic</surname><given-names>J</given-names></string-name>, <string-name><surname>Gupta</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Genome-wide maps of nucleolus interactions reveal distinct layers of repressive chromatin domains</article-title>. <source>Nat Commun</source><year>2022</year>;<volume>13</volume>:<fpage>1483</fpage>.<pub-id pub-id-type="pmid">35304483</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bintu</surname><given-names>B</given-names></string-name>, <string-name><surname>Mateo</surname><given-names>LJ</given-names></string-name>, <string-name><surname>Su</surname><given-names>J-H</given-names></string-name></person-group><etal>et al</etal><article-title>Super-resolution chromatin tracing reveals domains and cooperative interactions in single cells</article-title>. <source>Science</source><year>2018</year>;<volume>362</volume>:<fpage>eaau1783</fpage>.<pub-id pub-id-type="pmid">30361340</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bizhanova</surname><given-names>A</given-names></string-name>, <string-name><surname>Yan</surname><given-names>A</given-names></string-name>, <string-name><surname>Yu</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Distinct features of nucleolus-associated domains in mouse embryonic stem cells</article-title>. <source>Chromosoma</source><year>2020</year>;<volume>129</volume>:<fpage>121</fpage>–<lpage>39</lpage>.<pub-id pub-id-type="pmid">32219510</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonev</surname><given-names>B</given-names></string-name>, <string-name><surname>Mendelson Cohen</surname><given-names>N</given-names></string-name>, <string-name><surname>Szabo</surname><given-names>Q</given-names></string-name></person-group><etal>et al</etal><article-title>Multiscale 3D genome rewiring during mouse neural development</article-title>. <source>Cell</source><year>2017</year>;<volume>171</volume>:<fpage>557</fpage>–<lpage>72.e24</lpage>.<pub-id pub-id-type="pmid">29053968</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B7">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Boyd</surname><given-names>SP</given-names></string-name>, <string-name><surname>Vandenberghe</surname><given-names>L.</given-names></string-name></person-group><year>2004</year>. <source>Convex optimization</source>. <publisher-loc>Cambridge, UK; New York</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btad314-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>Y</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>Mapping 3D genome organization relative to nuclear compartments using TSA-seq as a cytological ruler</article-title>. <source>J Cell Biol</source><year>2018</year>;<volume>217</volume>:<fpage>4025</fpage>–<lpage>48</lpage>.<pub-id pub-id-type="pmid">30154186</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Croft</surname><given-names>JA</given-names></string-name>, <string-name><surname>Bridger</surname><given-names>JM</given-names></string-name>, <string-name><surname>Boyle</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Differences in the localization and morphology of chromosomes in the human nucleus</article-title>. <source>J Cell Biol</source><year>1999</year>;<volume>145</volume>:<fpage>1119</fpage>–<lpage>31</lpage>.<pub-id pub-id-type="pmid">10366586</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guelen</surname><given-names>L</given-names></string-name>, <string-name><surname>Pagie</surname><given-names>L</given-names></string-name>, <string-name><surname>Brasset</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal><article-title>Domain organization of human chromosomes revealed by mapping of nuclear lamina interactions</article-title>. <source>Nature</source><year>2008</year>;<volume>453</volume>:<fpage>948</fpage>–<lpage>51</lpage>.<pub-id pub-id-type="pmid">18463634</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Imakaev</surname><given-names>M</given-names></string-name>, <string-name><surname>Fudenberg</surname><given-names>G</given-names></string-name>, <string-name><surname>McCord</surname><given-names>RP</given-names></string-name></person-group><etal>et al</etal><article-title>Iterative correction of Hi-C data reveals hallmarks of chromosome organization</article-title>. <source>Nat Methods</source><year>2012</year>;<volume>9</volume>:<fpage>999</fpage>–<lpage>1003</lpage>.<pub-id pub-id-type="pmid">22941365</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kind</surname><given-names>J</given-names></string-name>, <string-name><surname>Pagie</surname><given-names>L</given-names></string-name>, <string-name><surname>Ortabozkoyun</surname><given-names>H</given-names></string-name></person-group><etal>et al</etal><article-title>Single-cell dynamics of genome-nuclear lamina interactions</article-title>. <source>Cell</source><year>2013</year>;<volume>153</volume>:<fpage>178</fpage>–<lpage>92</lpage>.<pub-id pub-id-type="pmid">23523135</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lieberman-Aiden</surname><given-names>E</given-names></string-name>, <string-name><surname>van Berkum</surname><given-names>NL</given-names></string-name>, <string-name><surname>Williams</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Comprehensive mapping of long range interactions reveals folding principles of the human genome</article-title>. <source>Science</source><year>2009</year>;<volume>326</volume>:<fpage>289</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">19815776</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>Y</given-names></string-name>, <string-name><surname>Nanni</surname><given-names>L</given-names></string-name>, <string-name><surname>Sungalee</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Systematic inference and comparison of multi-scale chromatin Sub-compartments connects spatial organization to cell phenotypes</article-title>. <source>Nat Commun</source><year>2021</year>;<volume>12</volume>:<fpage>2439</fpage>.<pub-id pub-id-type="pmid">33972523</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Martin</surname><given-names>C</given-names></string-name>, <string-name><surname>Chen</surname><given-names>S</given-names></string-name>, <string-name><surname>Maya-Mendoza</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Lamin B1 maintains the functional plasticity of nucleoli</article-title>. <source>J Cell Sci</source><year>2009</year>;<volume>122</volume>:<fpage>1551</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">19383719</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mikkelsen</surname><given-names>TS</given-names></string-name>, <string-name><surname>Ku</surname><given-names>M</given-names></string-name>, <string-name><surname>Jaffe</surname><given-names>DB</given-names></string-name></person-group><etal>et al</etal><article-title>Genome-wide maps of chromatin state in pluripotent and lineage-committed cells</article-title>. <source>Nature</source><year>2007</year>;<volume>448</volume>:<fpage>553</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">17603471</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Monahan</surname><given-names>K</given-names></string-name>, <string-name><surname>Horta</surname><given-names>A</given-names></string-name>, <string-name><surname>Lomvardas</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>LHX2- and LDB1-mediated trans interactions regulate olfactory receptor choice</article-title>. <source>Nature</source><year>2019</year>;<volume>565</volume>:<fpage>448</fpage>–<lpage>53</lpage>.<pub-id pub-id-type="pmid">30626972</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nagano</surname><given-names>T</given-names></string-name>, <string-name><surname>Lubling</surname><given-names>Y</given-names></string-name>, <string-name><surname>Várnai</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>Cell-cycle dynamics of chromosomal organization at single-cell resolution</article-title>. <source>Nature</source><year>2017</year>;<volume>547</volume>:<fpage>61</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">28682332</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Németh</surname><given-names>A</given-names></string-name>, <string-name><surname>Conesa</surname><given-names>A</given-names></string-name>, <string-name><surname>Santoyo-Lopez</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Initial genomics of the human nucleolus</article-title>. <source>PLoS Genet</source><year>2010</year>;<volume>6</volume>:<fpage>e1000889</fpage>.<pub-id pub-id-type="pmid">20361057</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Peric-Hupkes</surname><given-names>D</given-names></string-name>, <string-name><surname>Meuleman</surname><given-names>W</given-names></string-name>, <string-name><surname>Pagie</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Molecular maps of the reorganization of genome-nuclear lamina interactions during differentiation</article-title>. <source>Mol Cell</source><year>2010</year>;<volume>38</volume>:<fpage>603</fpage>–<lpage>13</lpage>.<pub-id pub-id-type="pmid">20513434</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rao</surname><given-names>SSP</given-names></string-name>, <string-name><surname>Huntley</surname><given-names>MH</given-names></string-name>, <string-name><surname>Durand</surname><given-names>NC</given-names></string-name></person-group><etal>et al</etal><article-title>A 3D map of the human genome at kilobase resolution reveals principles of chromatin looping</article-title>. <source>Cell</source><year>2014</year>;<volume>159</volume>:<fpage>1665</fpage>–<lpage>80</lpage>.<pub-id pub-id-type="pmid">25497547</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rao</surname><given-names>SSP</given-names></string-name>, <string-name><surname>Huang</surname><given-names>S-C</given-names></string-name>, <string-name><surname>Glenn St Hilaire</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>Cohesin loss eliminates all loop domains</article-title>. <source>Cell</source><year>2017</year>;<volume>171</volume>:<fpage>305</fpage>–<lpage>20.e24</lpage>.<pub-id pub-id-type="pmid">28985562</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robson</surname><given-names>MI</given-names></string-name>, <string-name><surname>de Las Heras</surname><given-names>JI</given-names></string-name>, <string-name><surname>Czapiewski</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Constrained release of lamina-associated enhancers and genes from the nuclear envelope during T-cell activation facilitates their association in chromosome compartments</article-title>. <source>Genome Res</source><year>2017</year>;<volume>27</volume>:<fpage>1126</fpage>–<lpage>38</lpage>.<pub-id pub-id-type="pmid">28424353</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sen Gupta</surname><given-names>A.</given-names></string-name></person-group><article-title>Lamin B2 modulates nucleolar morphology, dynamics, and function</article-title>. <source>Mol Cell Biol</source><year>2017</year>;<volume>37</volume>:<fpage>e00274-17</fpage>.</mixed-citation>
    </ref>
    <ref id="btad314-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stevens</surname><given-names>TJ</given-names></string-name>, <string-name><surname>Lando</surname><given-names>D</given-names></string-name>, <string-name><surname>Basu</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>3D structures of individual mammalian genomes studied by single-cell Hi-C</article-title>. <source>Nature</source><year>2017</year>;<volume>544</volume>:<fpage>59</fpage>–<lpage>64</lpage>.<pub-id pub-id-type="pmid">28289288</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Takei</surname><given-names>Y</given-names></string-name>, <string-name><surname>Yun</surname><given-names>J</given-names></string-name>, <string-name><surname>Zheng</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Integrated spatial genomics reveals global architecture of single nuclei</article-title>. <source>Nature</source><year>2021</year>;<volume>590</volume>:<fpage>344</fpage>–<lpage>50</lpage>.<pub-id pub-id-type="pmid">33505024</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Thurman</surname><given-names>RE</given-names></string-name>, <string-name><surname>Rynes</surname><given-names>E</given-names></string-name>, <string-name><surname>Humbert</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>The accessible chromatin landscape of the human genome</article-title>. <source>Nature</source><year>2012</year>;<volume>489</volume>:<fpage>75</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">22955617</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tran</surname><given-names>JR</given-names></string-name>, <string-name><surname>Paulson</surname><given-names>DI</given-names></string-name>, <string-name><surname>Moresco</surname><given-names>JJ</given-names></string-name></person-group><etal>et al</etal><article-title>An APEX2 proximity ligation method for mapping interactions with the nuclear lamina</article-title>. <source>J Cell Biol</source><year>2021</year>;<volume>220</volume>:<fpage>e202002129</fpage>.<pub-id pub-id-type="pmid">33306092</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tran</surname><given-names>JR</given-names></string-name>, <string-name><surname>Zheng</surname><given-names>X</given-names></string-name>, <string-name><surname>Adam</surname><given-names>SA</given-names></string-name></person-group><etal>et al</etal><article-title>High quality mapping of chromatin at or near the nuclear lamina from small numbers of cells reveals cell cycle and developmental changes of chromatin at the nuclear periphery</article-title>. <source>Nucleic Acids Res</source><year>2022</year>;<volume>50</volume>:<fpage>e117</fpage>.<pub-id pub-id-type="pmid">36130229</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van Schaik</surname><given-names>T</given-names></string-name>, <string-name><surname>Vos</surname><given-names>M</given-names></string-name>, <string-name><surname>Peric-Hupkes</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>Cell cycle dynamics of lamina-associated DNA</article-title>. <source>EMBO Rep</source><year>2020</year>;<volume>21</volume>:<fpage>e50636</fpage>.<pub-id pub-id-type="pmid">32893442</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vertii</surname><given-names>A</given-names></string-name>, <string-name><surname>Ou</surname><given-names>J</given-names></string-name>, <string-name><surname>Yu</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Two contrasting classes of nucleolus-associated domains in mouse fibroblast heterochromatin</article-title>. <source>Genome Res</source><year>2019</year>;<volume>29</volume>:<fpage>1235</fpage>–<lpage>49</lpage>.<pub-id pub-id-type="pmid">31201210</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xiong</surname><given-names>K</given-names></string-name>, <string-name><surname>Ma</surname><given-names>J.</given-names></string-name></person-group><article-title>Revealing Hi-C subcompartments by imputing inter-chromosomal chromatin interactions</article-title>. <source>Nat Commun</source><year>2019</year>;<volume>10</volume>:<fpage>5069</fpage>.<pub-id pub-id-type="pmid">31699985</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>X</given-names></string-name>, <string-name><surname>Hu</surname><given-names>J</given-names></string-name>, <string-name><surname>Yue</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Lamins organize the global three-dimensional genome from the nuclear periphery</article-title>. <source>Mol Cell</source><year>2018</year>;<volume>71</volume>:<fpage>802</fpage>–<lpage>15.e7</lpage>.<pub-id pub-id-type="pmid">30201095</pub-id></mixed-citation>
    </ref>
    <ref id="btad314-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>X</given-names></string-name>, <string-name><surname>Zheng</surname><given-names>Y.</given-names></string-name></person-group><article-title>CscoreTool: fast Hi-C compartment analysis at high resolution</article-title>. <source>Bioinformatics</source><year>2018</year>;<volume>34</volume>:<fpage>1568</fpage>–<lpage>70</lpage>.<pub-id pub-id-type="pmid">29244056</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
