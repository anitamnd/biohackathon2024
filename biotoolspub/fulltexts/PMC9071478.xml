<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9071478</article-id>
    <article-id pub-id-type="pmid">34986249</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkab1275</article-id>
    <article-id pub-id-type="publisher-id">gkab1275</article-id>
    <article-categories>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00010</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>Narese/14</subject>
        <subject>Narese/9</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Methods Online</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>scMAGIC: accurately annotating single cells using two rounds of reference-based classification</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-5891-3860</contrib-id>
        <name>
          <surname>Zhang</surname>
          <given-names>Yu</given-names>
        </name>
        <aff><institution>State Key Laboratory of Genetic Engineering, Collaborative Innovation Center for Genetics and Development, Department of Computational Biology, School of Life Sciences, Fudan University</institution>, Shanghai 200438, <country country="TW">P.R. China</country></aff>
        <xref rid="FN1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Feng</given-names>
        </name>
        <aff><institution>State Key Laboratory of Genetic Engineering, Collaborative Innovation Center for Genetics and Development, Department of Computational Biology, School of Life Sciences, Fudan University</institution>, Shanghai 200438, <country country="TW">P.R. China</country></aff>
        <aff><institution>Department of Histoembryology, Genetics and Developmental Biology, Shanghai Key Laboratory of Reproductive Medicine, Key Laboratory of Cell Differentiation and Apoptosis of Chinese Ministry of Education, Shanghai Jiao Tong University School of Medicine</institution>, Shanghai 200025, <country country="CN">China</country></aff>
        <xref rid="FN1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Zekun</given-names>
        </name>
        <aff><institution>State Key Laboratory of Genetic Engineering, Collaborative Innovation Center for Genetics and Development, Department of Computational Biology, School of Life Sciences, Fudan University</institution>, Shanghai 200438, <country country="TW">P.R. China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wu</surname>
          <given-names>Siyi</given-names>
        </name>
        <aff><institution>State Key Laboratory of Genetic Engineering, Collaborative Innovation Center for Genetics and Development, Department of Computational Biology, School of Life Sciences, Fudan University</institution>, Shanghai 200438, <country country="TW">P.R. China</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Tian</surname>
          <given-names>Weidong</given-names>
        </name>
        <!--weidong.tian@fudan.edu.cn-->
        <aff><institution>State Key Laboratory of Genetic Engineering, Collaborative Innovation Center for Genetics and Development, Department of Computational Biology, School of Life Sciences, Fudan University</institution>, Shanghai 200438, <country country="TW">P.R. China</country></aff>
        <aff><institution>Qilu Children's Hospital of Shandong University</institution>, No 23976 Jingshi Road, Jinan, Shandong, <country country="CN">China</country></aff>
        <aff><institution>Children’s Hospital of Fudan University,</institution> Shanghai 201102, <country country="CN">China</country></aff>
        <xref rid="COR1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Tel: +86 21 3124 6723; Email: <email>weidong.tian@fudan.edu.cn</email></corresp>
      <fn id="FN1">
        <p>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <day>06</day>
      <month>5</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-01-05">
      <day>05</day>
      <month>1</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>1</month>
      <year>2022</year>
    </pub-date>
    <volume>50</volume>
    <issue>8</issue>
    <fpage>e43</fpage>
    <lpage>e43</lpage>
    <history>
      <date date-type="accepted">
        <day>14</day>
        <month>12</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>08</day>
        <month>11</month>
        <year>2021</year>
      </date>
      <date date-type="received">
        <day>20</day>
        <month>8</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press on behalf of Nucleic Acids Research.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="gkab1275.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Here, we introduce scMAGIC (<bold>S</bold>ingle <bold>C</bold>ell annotation using <bold>MA</bold>rker <bold>G</bold>enes <bold>I</bold>dentification and two rounds of reference-based <bold>C</bold>lassification [RBC]), a novel method that uses well-annotated single-cell RNA sequencing (scRNA-seq) data as the reference to assist in the classification of query scRNA-seq data. A key innovation in scMAGIC is the introduction of a second-round RBC in which those query cells whose cell identities are confidently validated in the first round are used as a new reference to again classify query cells, therefore eliminating the batch effects between the reference and the query data. scMAGIC significantly outperforms 13 competing RBC methods with their optimal parameter settings across 86 benchmark tests, especially when the cell types in the query dataset are not completely covered by the reference dataset and when there exist significant batch effects between the reference and the query datasets. Moreover, when no reference dataset is available, scMAGIC can annotate query cells with reasonably high accuracy by using an atlas dataset as the reference.</p>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Key Research and Development Program of China</institution>
            <institution-id institution-id-type="DOI">10.13039/501100012166</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2021YFC2301500</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Natural Science Foundation of China</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001809</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>32170667</award-id>
        <award-id>31871325</award-id>
        <award-id>32100516</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>SJTU</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004921</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Shanghai Sailing Program</institution>
          </institution-wrap>
        </funding-source>
        <award-id>21YF1422600</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="18"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>INTRODUCTION</title>
    <p>Single-cell RNA sequencing (scRNA-seq) technology has been widely used for investigating heterogeneity in tissues and tumors, leading to a better understanding on development and tumorigenesis (<xref rid="B1" ref-type="bibr">1</xref>,<xref rid="B2" ref-type="bibr">2</xref>). A critical step in scRNA-seq data analysis is the classification of single cells, which is typically done by first clustering cells according to their expression profiles and then annotating each cell cluster using known cell type-specific marker genes (<xref rid="B3" ref-type="bibr">3</xref>). However, in order to select appropriate marker gene sets, it is often unavoidable to conduct extensive literature review and manually test various combination of marker genes, which is not only time-consuming but also error-prone. It is therefore highly desirable to develop an automated method that can accurately classify single cells without manual selection of marker genes.</p>
    <p>There are now a wealth of scRNA-seq data produced from different tissues, such as brain (<xref rid="B4" ref-type="bibr">4</xref>), pancreas (<xref rid="B5" ref-type="bibr">5</xref>), peripheral blood mononuclear cells (PBMC) (<xref rid="B6" ref-type="bibr">6</xref>) etc. with many well annotated at the level of cell types. Recently, several large-scale scRNA-seq studies have constructed the atlas of single-cells, such as the Human Cell Landscape (HCL) (<xref rid="B7" ref-type="bibr">7</xref>) and the Mouse Cell Atlas (MCA) (<xref rid="B8" ref-type="bibr">8</xref>), providing the annotations for hundreds of cell types. A number of reference-based classification (RBC) methods have thus been developed to use the expression profiles of known cell types as the reference to assist in the classification of query cells (<xref rid="B9" ref-type="bibr">9–21</xref>). These RBC methods generally first identify the characteristic features for each reference cell type, such as the marker genes, and then use these features to assess the similarity of a query cell with each reference cell type, from which the most relevant one is selected to label the query cell. Depending on the way of similarity evaluation, these RBC methods can be classified into four categories: statistical-metric-based methods [e.g. SingleR (<xref rid="B9" ref-type="bibr">9</xref>), scmap (<xref rid="B10" ref-type="bibr">10</xref>) and SciBet (<xref rid="B11" ref-type="bibr">11</xref>)], tree-based methods [e.g. CHETAH (<xref rid="B12" ref-type="bibr">12</xref>) and scClassify (<xref rid="B13" ref-type="bibr">13</xref>)], machine-learning-based methods [e.g. scPred (<xref rid="B14" ref-type="bibr">14</xref>), SingleCellNet (<xref rid="B15" ref-type="bibr">15</xref>), scID (<xref rid="B16" ref-type="bibr">16</xref>), CaSTLe (<xref rid="B17" ref-type="bibr">17</xref>) and SVM<sub>rejection</sub> (<xref rid="B18" ref-type="bibr">18</xref>)] and semi-supervised-learning-based methods [e.g. Seurat v4 (<xref rid="B19" ref-type="bibr">19</xref>), scSemiCluster (<xref rid="B20" ref-type="bibr">20</xref>) and CALLR (<xref rid="B21" ref-type="bibr">21</xref>)]. The first three categories of methods directly compare the query expression profiles against the reference expression profiles and are therefore prone to be affected by the batch effects between the reference and the query datasets. The semi-supervised-learning-based methods are more resistant to the batch effects in that they essentially integrate the reference and query cells’ expression profiles into the same space before doing the classification, during which the batch effects are reduced. However, the batch effects may still affect the quality of the integration and consequently the performance of the classification. Besides the batch effects, the coverage of query cell types by the reference dataset may also affect the performance of these methods. In general, all RBC methods work well when the cell types in the query dataset are all covered by the reference dataset. However, when the query dataset includes cells whose cell types are not covered by the reference dataset, i.e. unclassifiable query cells, the cell type-specific features identified by these RBC methods may not be specific and discriminative enough to distinguish unclassifiable query cells from classifiable ones.</p>
    <p>Here, we present scMAGIC (<bold>S</bold>ingle <bold>C</bold>ell annotation using <bold>MA</bold>rker <bold>G</bold>enes <bold>I</bold>dentification and two rounds of reference-based <bold>C</bold>lassification), a novel RBC tool that provides solutions to the above mentioned challenges. The main idea of scMAGIC is to first identify a candidate reference cell type for a query cell by expression profile correlation and then validate its cell identity using the marker genes of the reference cell type. Different from other RBC methods, scMAGIC identifies the marker genes of a reference cell type based not only on the reference dataset but also on an additional atlas dataset that consists of the expression profiles of hundreds of cell types, ensuring that the marker genes are more biologically relevant to the reference cell type. In addition, scMAGIC introduces a second-round RBC in which those query cells whose cell identifies are confidently validated in the first-round RBC are used as the new reference to again classify query single cells, eliminating the batch effects between the reference and the query dataset and therefore significantly improving the classification results. We have designed three situations that users may encounter when conducting RBC and have prepared a total of 86 benchmark tests using real datasets for these situations. Compared with 13 recently developed RBC methods, scMAGIC consistently achieves superior performance in all three situations, and its advantage over other methods is particularly significant when the cell types in the query dataset are not completely covered by the reference dataset and when there exist significant batch effects in between the reference and query datasets. In addition, when no specific reference dataset is available, scMAGIC can still annotate query cells with reasonably high accuracy by using an atlas dataset as the reference. scMAGIC is implemented in R and is available at <ext-link xlink:href="https://github.com/TianLab-Bioinfo/scMAGIC" ext-link-type="uri">https://github.com/TianLab-Bioinfo/scMAGIC</ext-link>.</p>
  </sec>
  <sec sec-type="materials|methods" id="SEC2">
    <title>MATERIALS AND METHODS</title>
    <sec id="SEC2-1">
      <title>Input for scMAGIC</title>
      <p>Users need to provide two expression matrices: a query expression count matrix and a well-annotated reference expression count matrix constructed from scRNA-seq (Figure <xref rid="F1" ref-type="fig">1A</xref>). In addition to these two matrices, in default scMAGIC also reads the input of an atlas expression profile matrix constructed by aggregating the expression profiles of cells with identical cell types in Mouse Cell Atlas (MCA) or Human Cell Landscape (HCL) (Figure <xref rid="F1" ref-type="fig">1A</xref>). The row names in these matrices correspond to gene symbols, while the column names correspond to cell barcodes in the query and reference expression count matrices, and correspond to cell type labels in the atlas expression profile matrices. Note that when a reference expression count matrix is provided, users must also provide an annotation file listing the cell type label for each cell.</p>
      <fig position="float" id="F1">
        <label>Figure 1.</label>
        <caption>
          <p>The workflow of scMAGIC. For details about the algorithm design of scMAGIC, refer to the Materials and Methods section.</p>
        </caption>
        <graphic xlink:href="gkab1275fig1" position="float"/>
      </fig>
    </sec>
    <sec id="SEC2-2">
      <title>The algorithm design of scMAGIC</title>
      <p>scMAGIC conducts two rounds of reference-based classification (RBC), followed by a recapturing step, and the workflow of scMAGIC is depicted in Figure <xref rid="F1" ref-type="fig">1</xref>. There are three main modules in both rounds of RBC: identification of reference cell type-specific marker genes, identification and validation of candidate cell labels for query cells.</p>
      <sec id="SEC2-2-1">
        <title>The three modules in the first-round RBC</title>
        <p>We describe in detail these three modules in the first-round RBC (Figure <xref rid="F1" ref-type="fig">1B</xref>) as the following:</p>
        <sec id="SEC2-2-1-1">
          <title>Module 1: Identification of reference cell type-specific marker genes</title>
          <p>We first convert the reference expression count matrix into an expression profile matrix by aggregating the expression profiles of single cells with the same cell label. For each cell type, we identify the top 20% highly expressed genes and then use <italic toggle="yes">limma</italic> (<xref rid="B22" ref-type="bibr">22</xref>) to select from these genes those that are significantly up-regulated with respect to other reference cell types (fdr <italic toggle="yes">P</italic> value &gt; 0.05). Next, we use <italic toggle="yes">RUVSeq</italic> (<xref rid="B23" ref-type="bibr">23</xref>) to remove the batch effect between the reference and the atlas expression profile matrix and then use <italic toggle="yes">limma</italic> to further identify from the selected genes those that are significantly up-regulated with respect to the cell types in the atlas expression matrix (fdr <italic toggle="yes">P</italic> value &gt; 0.001). <italic toggle="yes">RUVSeq</italic> has been reported as an effective tool to adjust the technical effects across different bulk RNA-seq expression profiles (<xref rid="B24" ref-type="bibr">24</xref>). Here, the reference and the atlas expression profile matrix are both aggregated from cells with the same cell type labels and can be regarded as bulk expression profiles. We evaluate <italic toggle="yes">RUVSeq</italic>’s performance on removing the batch effect by combining one mouse tissue profile and two human tissue profiles with the corresponding MCA and HCL atlas expression profiles, respectively. We find that most reference cell types are merged together with their corresponding cell types in the atlas by using <italic toggle="yes">RUVSeq</italic>, as visualized in the UMAP plots (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref>), demonstrating its efficacy. Finally, the genes satisfying all above criteria are selected as the marker genes specific for the reference cell type.</p>
        </sec>
        <sec id="SEC2-2-1-2">
          <title>Module 2: Identification of candidate cell labels</title>
          <p>We first identify the top <italic toggle="yes">N</italic> (default is 2000) variable genes in the reference expression profile matrix using the function ‘FindVariableFeatures’ of <italic toggle="yes">Seurat</italic> (<xref rid="B25" ref-type="bibr">25</xref>). Then, for each query cell we calculate a similarity score to each reference cell type based on the correlation of the expression profiles of the variable genes, and select the most similar one as its candidate cell label. Here, Kendall’s tau coefficient is selected as the similarity metric because it is based on the relationships between pairs of genes, and is therefore more robust against the batch effects between the query and the reference expression matrix. It is computed by using ‘cor.fk’ in R (‘pcaPP’ package).</p>
        </sec>
        <sec id="SEC2-2-1-3">
          <title>Module 3: Verification of candidate cell labels</title>
          <p>We first group query cells according to their candidate cell labels. For each query cell in a group, we conduct a Wilcoxon rank sum test to inspect whether the expression values of the marker genes corresponding to the cell type of the group are significantly higher than the other genes and convert the <italic toggle="yes">P</italic>-value into a confidence score by negative log transformation. Then, we decompose the density distribution of the confidence scores into several Gaussian distributions using the package <italic toggle="yes">mclust</italic> (<xref rid="B26" ref-type="bibr">26</xref>) in R. The labels of all query cells belonging to the sub-distribution with the greatest confidence scores are considered to be validated. In addition, those cells with confidence scores less than a pre-defined threshold (default is 5) are considered as the negative controls for the cell label. The selected negative controls will be used in the second-round RBC to increase the specificity of the identified cell-specific marker genes in discriminating false positive predictions. In the end, we construct a local reference expression count matrix by using only those confidently validated query cells and will use it as the reference in the second-round RBC. Note that the original reference expression matrix will not be used in the second-round RBC. For each cell type label in the local reference expression matrix, we also construct a negative control expression matrix from the query single cells defined as its negative controls. When the atlas expression matrix is used as the reference, we require each local reference cell label have at least 10 validated query cells, to reduce false positive assignments.</p>
        </sec>
      </sec>
      <sec id="SEC2-2-2">
        <title>The differences of the three modules in the second-round RBC</title>
        <p>In the second-round of RBC, the original reference expression count matrix is replaced by the local reference expression count matrix produced from the first-round RBC. Below, we describe the differences of the three modules in the second-round of RBC (Figure <xref rid="F1" ref-type="fig">1C</xref>).</p>
        <sec id="SEC2-2-2-1">
          <title>The module 1 in the second-round RBC</title>
          <p>We use the local reference expression count matrix to identify genes that are up-regulated in a given local reference cell type using the function ‘Findmarkers’ (with fold change &gt; 1.5 and Bonferroni-corrected <italic toggle="yes">P</italic> values &lt; 0.05) in <italic toggle="yes">Seurat</italic>. We then use ‘Findmarkers’ to select from these genes those that are up-regulated with respect to cells in the negative control expression matrix specific for this cell type. Next, we obtain the local reference expression profile matrix by aggregating the expression profiles of cells with the same label and following the same way as in the first-round RBC to identify from the former selected genes those that are up-regulated with respect to the cell types in the atlas expression matrix. These genes are considered as the marker genes specific for the local reference cell type.</p>
        </sec>
        <sec id="SEC2-2-2-2">
          <title>The module 2 in the second-round RBC</title>
          <p>Because there are now no batch effects between the local reference and the query expression matrix, we use multinomial metric as the similarity metric. Multinomial metric describes the probability of observing an expression profile (a query cell) given another expression profile (a local reference cell type) based on multinomial distribution and is calculated using ‘dmultinom’ in R.</p>
        </sec>
        <sec id="SEC2-2-2-3">
          <title>The module 3 in the second-round RBC</title>
          <p>After decomposing the density distribution of confidence scores into several sub-distributions, we inspect the mean of each sub-distribution. If the mean is less than a pre-defined threshold (default is 5), we then label those query cells belonging to this sub-distribution as ‘unassigned’. Otherwise, we consider the query cells of the sub-distribution validated.</p>
        </sec>
      </sec>
      <sec id="SEC2-2-3">
        <title>Recapturing ‘unassigned’ cells by unsupervised clustering</title>
        <p>To recapture those query single cells that might be labelled incorrectly as ‘unassigned’, we conduct unsupervised clustering of query cells using the function ‘FindClusters’ in <italic toggle="yes">Seurat</italic> with 50 principal components (PCs) and the resolution set at 3. If majority of cells in a cluster are labeled with the same cell type and if the ‘unassigned’ cells account for &lt;20% of cells in this cluster, we recapture these ‘unassigned’ cells and label them with the cell type of this cluster (Figure <xref rid="F1" ref-type="fig">1D</xref>).</p>
      </sec>
    </sec>
    <sec id="SEC2-3">
      <title>Speeding up the computation by scMAGIC</title>
      <p>When there are &gt;5000 query cells, we do the followings to speed up the computation. We first cluster query cells using ‘FindClusters’ in <italic toggle="yes">Seurat</italic> with 50 PCs and the resolution of 3. Then, we apply <italic toggle="yes">k</italic>-means algorithm to divide each cluster into <italic toggle="yes">k</italic> sub-clusters, where <inline-formula><tex-math id="M0001" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$( {k = {\rm cell}\ {\rm num}\ {\rm in}\ {\rm the}\ {\rm cluster}/m} )$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M0001a" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$( {m = {\rm total}\ {\rm cell}\ {\rm num}/3000} )$\end{document}</tex-math></inline-formula>. Cells in each sub-cluster are then merged into one cell, and the query expression count matrix is constructed from the merged cells. After the application of scMAGIC, the cell labels of merged cells are transferred to their corresponding component cells.</p>
    </sec>
    <sec id="SEC2-4">
      <title>Data collections</title>
      <p>All datasets used in this study are downloaded from public databases and are as follows:</p>
      <list list-type="bullet">
        <list-item>
          <p>The mouse brain datasets include the primary visual cortex (PVC) dataset by Tasic <italic toggle="yes">et al.</italic> (<xref rid="B4" ref-type="bibr">4</xref>), the primary somatosensory cortex (S1) and the hippocampal CA1 region dataset by Zeisel <italic toggle="yes">et al.</italic> (<xref rid="B27" ref-type="bibr">27</xref>), the neocortex (including primary visual cortex (VISp) and the anterior lateral motor area (ALM)) dataset by Tasic <italic toggle="yes">et al.</italic> (<xref rid="B28" ref-type="bibr">28</xref>), the hypothalamic arcuate-median eminence complex (HArc-ME) dataset by Campbell <italic toggle="yes">et al.</italic> (<xref rid="B29" ref-type="bibr">29</xref>), the dentate gyrus of the hippocampus (DGH) dataset by Hochgerner <italic toggle="yes">et al.</italic> (<xref rid="B30" ref-type="bibr">30</xref>) and the ventricular-subventricular zone (V-SVZ) dataset by Mizark <italic toggle="yes">et al.</italic> (<xref rid="B31" ref-type="bibr">31</xref>), which can be downloaded from NCBI’s GEO database with the accession number GSE71585, GSE60361, GSE115746, GSE93374, GSE95315 and GSE109447, respectively.</p>
        </list-item>
        <list-item>
          <p>The mouse pancreas dataset is from the study by Baron <italic toggle="yes">et al.</italic> (<xref rid="B5" ref-type="bibr">5</xref>), and its accession number in GEO database is GSE84133.</p>
        </list-item>
        <list-item>
          <p>The mouse duodenum dataset is from the study by Haber <italic toggle="yes">et al.</italic> (<xref rid="B32" ref-type="bibr">32</xref>), and its accession number in GEO database is GSE92332.</p>
        </list-item>
        <list-item>
          <p>The human pancreas datasets consist of four datasets from the studies of Baron <italic toggle="yes">et al.</italic> (<xref rid="B5" ref-type="bibr">5</xref>), Muraro <italic toggle="yes">et al.</italic> (<xref rid="B33" ref-type="bibr">33</xref>), Xin <italic toggle="yes">et al.</italic> (<xref rid="B34" ref-type="bibr">34</xref>) and Segerstolpe <italic toggle="yes">et al.</italic> (<xref rid="B35" ref-type="bibr">35</xref>), and their accession numbers are GSE84133, GSE85241 and GSE81608 in NCBI’s GEO database, and E-MTAB-5061in EBI ArrayExpress database, respectively.</p>
        </list-item>
        <list-item>
          <p>The human PBMC datasets include three studies by Ding <italic toggle="yes">et al.</italic> (<xref rid="B6" ref-type="bibr">6</xref>), Butler <italic toggle="yes">et al.</italic> (<xref rid="B25" ref-type="bibr">25</xref>) and Zheng <italic toggle="yes">et al.</italic> (<xref rid="B36" ref-type="bibr">36</xref>) and can be downloaded from GEO database with the accession number GSE132044, package <italic toggle="yes">SeuratData</italic> and <ext-link xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets" ext-link-type="uri">https://support.10xgenomics.com/single-cell-gene-expression/datasets</ext-link>, respectively.</p>
        </list-item>
        <list-item>
          <p>The CellBench 10X dataset and the CellBench CEL-Seq2 dataset that are from the study by Tian <italic toggle="yes">et al.</italic> (<xref rid="B37" ref-type="bibr">37</xref>) and are both the mixture of five human lung cancer cell lines. In that study, the CellBench 10X dataset is obtained from GSM3618014, and the CellBench CEL-Seq2 dataset is obtained and concatenated from three datasets (GSM3618022, GSM3618023 and GSM3618024).</p>
        </list-item>
        <list-item>
          <p>The Tabula Muris dataset is from The Tabula Muris Consortium (<xref rid="B38" ref-type="bibr">38</xref>), and its accession number in GEO database is GSE109774.</p>
        </list-item>
        <list-item>
          <p>Both the MCA and the HCL atlas expression data are downloaded from NCBI’s GEO database with the accession number GSE108097 (<xref rid="B8" ref-type="bibr">8</xref>) and GSE134355 (<xref rid="B7" ref-type="bibr">7</xref>), respectively.</p>
        </list-item>
      </list>
      <p>The above datasets are selected to be either the reference or the query datasets. For details about the reference and the query datasets in the 86 benchmark tests corresponding to the three situations and the four exploratory studies, refer to <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>. The cell labels of the above datasets are standardized for the purpose of performance evaluations. For details about the standardization of the cell labels, refer to <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S2–68</xref>.</p>
    </sec>
    <sec id="SEC2-5">
      <title>Performance assessment</title>
      <p>We use the following four metrics—accuracy, balanced accuracy, labeled accuracy and labeled balanced accuracy to assess the performance of a method. Accuracy is defined as the proportion of query cells with correctly assigned labels and is calculated as:<disp-formula><tex-math id="M0002" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}{\rm Accuracy }= \frac{1}{n}\mathop \sum \limits_{i = 1}^n \ \mathbb{I}\left( {{{\hat{y}}_i} = {y_i}} \right)\end{equation*}$$\end{document}</tex-math></disp-formula>where <inline-formula><tex-math id="M0003" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$n$\end{document}</tex-math></inline-formula> is the number of query cells, <inline-formula><tex-math id="M0004" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\hat{y}_i}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M0005" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${y_i}$\end{document}</tex-math></inline-formula> are the predicted and the true cell type of <inline-formula><tex-math id="M0006" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$cel{l_i}$\end{document}</tex-math></inline-formula>, respectively. Note that the true cell types of query cells whose cell types are not covered by the reference are defined as ‘unassigned’. Balanced accuracy is defined as the accuracy averaged across query cell types and is calculated as:<disp-formula><tex-math id="M0007" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}{\rm Balanced}\ {\rm Accuracy }= \frac{1}{m}\mathop \sum \limits_{i = 1}^m \ {\rm Accurac}{y_i}\end{equation*}$$\end{document}</tex-math></disp-formula>where <inline-formula><tex-math id="M0008" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$m$\end{document}</tex-math></inline-formula> is the number of query cell types, <inline-formula><tex-math id="M0009" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Accurac{y_i}$\end{document}</tex-math></inline-formula> is the accuracy calculated for all single cells with the <italic toggle="yes">i</italic>th cell type. Note that ‘unassigned’ is also considered a cell type.</p>
      <p>Labeled accuracy and labeled balanced accuracy are calculated without unassigned cells.</p>
      <p>In real practice, users usually pay more attention to the identity of cell clusters than individual cells. Here, we apply the following approach to assign cell labels to cell clusters using an RBC method. For a given query dataset in a benchmark test, we conduct unsupervised clustering using the function ‘FindClusters’ in <italic toggle="yes">Seurat</italic> with 50 PCs and the resolution set at 3 to generate cell clusters. After applying an RBC method to annotate all query cells, we simply label each cell cluster with the cell label assigned to most cells by the method in the cluster. To assess the performance of different RBC methods at the cell cluster level, we introduce the cluster accuracy defined as the proportion of clusters with correctly assigned cell labels as follows:<disp-formula><tex-math id="M00010" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}{\rm Accurac}{y_{{\rm cluster}}} = \frac{1}{N}\mathop \sum \limits_{i = 1}^N \ \mathbb{I}\left( {{{\hat{c}}_i} = {c_i}} \right)\end{equation*}$$\end{document}</tex-math></disp-formula></p>
      <p>Where <inline-formula><tex-math id="M00011" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$N$\end{document}</tex-math></inline-formula> is the number of cell clusters in the query dataset, and <inline-formula><tex-math id="M00012" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\hat{c}_i}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M00013" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$c$\end{document}</tex-math></inline-formula> are the predicted and the true cell type of <inline-formula><tex-math id="M00014" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\rm cluste}{r_i}$\end{document}</tex-math></inline-formula>, respectively.</p>
    </sec>
    <sec id="SEC2-6">
      <title>The Classification Difficulty Index (CDI) to quantitatively measure the degree of difficulty for a reference-based classification task</title>
      <p>We reason that the degree of difficulty for a classification task depends on two factors: the batch effect between the reference and the query dataset and the proportion of classifiable query cells whose cell types are covered by the reference dataset in the query dataset. More significant batch effect corresponds to a more difficult classification task, and a higher proportion indicates an easier classification task. Because the batch effect can be measured by the F1 of average silhouette width (ASW) score (<xref rid="B39" ref-type="bibr">39</xref>), with a higher <inline-formula><tex-math id="M00015" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$F{1_{ASW}}$\end{document}</tex-math></inline-formula> indicating less significant batch effect, here we define a classification difficulty index (CDI) by incorporating the ASW score and the proportion of classifiable query cells as the following:<disp-formula><tex-math id="M00016" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}CDI = \sqrt[2]{{\frac{{{{\left( {1 - F{1_{ASW}}} \right)}^2} + {{\left( {1 - P} \right)}^2}}}{2}}},\end{equation*}$$\end{document}</tex-math></disp-formula>where</p>
      <p><inline-formula><tex-math id="M00017" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$F{1_{ASW}} = \frac{{2( {1 - AS{W_{batch\_norm}}} )( {AS{W_{celltype\_norm}}} )}}{{1 - AS{W_{batch\_norm}} + AS{W_{celltype\_norm}}}}$\end{document}</tex-math></inline-formula> (<xref rid="B39" ref-type="bibr">39</xref>) and <italic toggle="yes">P</italic> refers to the proportion of classifiable query cells.</p>
    </sec>
    <sec id="SEC2-7">
      <title>Competing methods and parameter tuning</title>
      <p>In the 86 benchmark datasets, scMAGIC is compared with 13 competing methods including sciBet (<xref rid="B11" ref-type="bibr">11</xref>), SingleR (<xref rid="B9" ref-type="bibr">9</xref>), scmap (<xref rid="B10" ref-type="bibr">10</xref>), CHETAH (<xref rid="B12" ref-type="bibr">12</xref>), scClassify (<xref rid="B13" ref-type="bibr">13</xref>), SingleCellNet (<xref rid="B15" ref-type="bibr">15</xref>), scPred (<xref rid="B14" ref-type="bibr">14</xref>), scID (<xref rid="B16" ref-type="bibr">16</xref>), CaSTLe (<xref rid="B17" ref-type="bibr">17</xref>) and SVM<sub>rejection</sub> (<xref rid="B18" ref-type="bibr">18</xref>)), Seurat v4 (<xref rid="B19" ref-type="bibr">19</xref>), scSemiCluster (<xref rid="B20" ref-type="bibr">20</xref>) and CALLR (<xref rid="B21" ref-type="bibr">21</xref>), which are downloaded from <ext-link xlink:href="https://github.com/PaulingLiu/scibet" ext-link-type="uri">https://github.com/PaulingLiu/scibet</ext-link>, <ext-link xlink:href="https://github.com/dviraran/SingleR" ext-link-type="uri">https://github.com/dviraran/SingleR</ext-link>, <ext-link xlink:href="https://github.com/hemberg-lab/scmap-shiny" ext-link-type="uri">https://github.com/hemberg-lab/scmap-shiny</ext-link>, <ext-link xlink:href="https://github.com/jdekanter/CHETAH" ext-link-type="uri">https://github.com/jdekanter/CHETAH</ext-link>, <ext-link xlink:href="https://github.com/SydneyBioX/scClassify_analysis" ext-link-type="uri">https://github.com/SydneyBioX/scClassify_analysis</ext-link>, <ext-link xlink:href="https://github.com/powellgenomicslab/scPred/" ext-link-type="uri">https://github.com/powellgenomicslab/scPred/</ext-link>, <ext-link xlink:href="https://github.com/pcahan1/singleCellNet/" ext-link-type="uri">https://github.com/pcahan1/singleCellNet/</ext-link>, <ext-link xlink:href="https://github.com/BatadaLab/scID" ext-link-type="uri">https://github.com/BatadaLab/scID</ext-link>, <ext-link xlink:href="https://github.com/yuvallb/CaSTLe" ext-link-type="uri">https://github.com/yuvallb/CaSTLe</ext-link>, <ext-link xlink:href="https://github.com/tabdelaal/scRNAseq_Benchmark" ext-link-type="uri">https://github.com/tabdelaal/scRNAseq_Benchmark</ext-link>, <ext-link xlink:href="https://satijalab.org/seurat/" ext-link-type="uri">https://satijalab.org/seurat/</ext-link>, <ext-link xlink:href="https://github.com/xuebaliang/scSemiCluster" ext-link-type="uri">https://github.com/xuebaliang/scSemiCluster</ext-link>, <ext-link xlink:href="https://github.com/MathSZhang/CALLR" ext-link-type="uri">https://github.com/MathSZhang/CALLR</ext-link>, respectively. SciBet, SingleR, scmap are statistical-metric-based methods, and use multinomial model, spearman coefficient and cosine similarity, respectively, as the similarity measure to determine the most relevant reference cell type for a query cell. CHETAH and scClassify are tree-based methods. CHETAH is based on a hierarchical classification tree, while scClassify is a multiscale classification framework based on the ensemble of hierarchical classification trees. SingleCellNet, scPred, scID, CaSTLe, SVM<sub>rejection</sub> are machine-learning-based methods and are based on random forest, support vector machine (SVM), linear discriminant analysis, eXtreme Gradient Boosting (XGBoost) and SVM (with a linear kernel), respectively. Seurat v4, scSemiCluster, CALLR are semi-supervised learning methods using anchor-based transfer learning, structural regularized domain adaptation, and the combination of unsupervised and supervised learning, respectively.</p>
      <p>The default parameter setting of each competing method may not represent their best performance. Thus, we conduct a rigorous search for the optimal combination of parameters for each competing method. To find a fair way to determine the optimal parameter setting for each method, we construct a representative set of benchmark tests by randomly selecting four benchmark tests from each of the first two situations and one benchmark test from the third situation. We then apply each method to these nine benchmark tests by using different combinations of parameters and select the combination with the greatest mean accuracy as the optimal parameter setting to be used in this study. For six methods (scClassify, CHETAH, scPred, scID, singleCellNet, SingleR), their mean accuracy increases by only &lt;0.02 using the optimal parameter settings. Of the remaining seven methods, four (sciBet, CALLR, scSemiCluster, Seurat v4) have slight increase around 0.02–0.05, and three (SVM<sub>rejection</sub>, scmap-cluster, scmap-cell, CaSTLe) have more significant increase, by using their respective optimal parameter settings.</p>
      <p>The optimal parameter settings selected for each of the 13 competing methods are the followings. For scClassify, we select the method ‘HOPACH’ to build the hierarchical tree, ‘KNN’ as the base classifier of ensemble model, the number of neighbors for KNN classifier to be 10, and the top number of selected features to be 50 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref>). For sciBet, we select the number of genes with the maximum entropy differences to be 600 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3</xref>). For scmap-cluster, we set the threshold of the similarity between a query cluster and a reference cell type to be 0.2 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4</xref>). For scmap-cell, we set the number of nearest neighbors to be 1 and the threshold of the similarity between a query cell and a reference cell type to be 0.4 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref>). For CHETAH, we use the method ‘complete’ for clustering reference profiles and select the number of the genes for producing a classification tree to be four fifths of the mean number of captured genes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S6</xref>). For scPred, we select 1000 highly variable genes and 50 PCs to train the model (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S7</xref>). For scID, we set the threshold (natural logarithm of fold change) to be 0.4 for extracting markers from the reference clusters (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S8</xref>). For CALLR, we set ‘μ’ (used to balance the effect of logistic regression term and the spectral clustering term) to be 0.9 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S9</xref>). For singleCellNet, we select 10 genes and 25 gene pairs per category to train the classification model and set the number of trees to be 1000 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S10</xref>). For scSemiCluster, we set the dimensions of two hidden layers to be 128 and 64, respectively (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S11</xref>). For SingleR, we use the method ‘de’ to extract genes and score each query cell by using the 80th percentile of correlation values calculated between the query cell and each of the reference cells (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S12</xref>). For CaSTLe, we set the number of highly variable genes, the maximum depth of tree, and the minimum sum of child weights to be 2000, 20 and 50, respectively (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S13</xref>). For Seurat V4, we set the number of PC spaces to be 50, and choose 8, 320, and 48 neighbors to find, filter, and score the anchor cells between the query and the reference datasets, respectively (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S14</xref>). For SVM<sub>rejection</sub>, we use 2000 highly variable genes to train the SVM model and set the threshold of possibility values as 0.1 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S15</xref>).</p>
      <p>In scMAGIC, there are two parameters available for tuning: the number of highly variable genes used to calculate the similarity between the profiles of a query cell and a reference cell type and the threshold of confidence score for selecting query cells, which are 2000 and 5, respectively, in default. We change the number of highly variable genes from 200 to 5000 and the threshold of confidence score from 1 to 15 and find that the performance of scMAGIC is stable when the former is around 600–3000 and the latter is around 3–8 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S16</xref>). Therefore, we choose to use the default setting in this study.</p>
      <p>In the exploratory tasks, we compare scMAGIC with scHCL and scMCA which are cell type identifier based on pearson correlation coefficients (<xref rid="B7" ref-type="bibr">7</xref>,<xref rid="B8" ref-type="bibr">8</xref>). In this study, scHCL and scMCA utilize HCL and MCA to classify query cells respectively and can be downloaded from <ext-link xlink:href="https://github.com/ggjlab/scHCL" ext-link-type="uri">https://github.com/ggjlab/scHCL</ext-link> and <ext-link xlink:href="https://github.com/ggjlab/scMCA" ext-link-type="uri">https://github.com/ggjlab/scMCA</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>RESULTS</title>
    <sec id="SEC3-1">
      <title>The workflow of scMAGIC</title>
      <p>scMAGIC conducts two rounds of reference-based classification (RBC), followed by a recapturing step, to annotate query cells with either a reference cell label, or an ‘unassigned’ label indicating that it does not belong to any cell type in the reference. The workflow of scMAGIC is shown in Figure <xref rid="F1" ref-type="fig">1</xref>. For details, please refer to the Materials and Methods section.</p>
      <p>There are three modules in the first-round RBC: identification of reference cell type-specific marker genes, identification and validation of the candidate cell label for query cells. In the first module, the marker genes of a reference cell type are identified by selecting from those highly expressed genes that are up-regulated in the reference cell type with respect to not only the other reference cell types but also the cell types in the atlas. In the second module, the candidate cell label for a query cell is determined by selecting the most similar reference cell type according to expression profile correlation. In the third module, a confidence score is first calculated for each query cell by running a statistical test using the marker genes corresponding to its candidate cell label; then, the candidate cell label of a query cell is validated based on the distribution of the confidence scores of all query cells with the same label, such that only highly confident query cells are validated. In addition, those query cells whose confidence scores are smaller than a pre-defined threshold are selected as the negative controls specific to the cell label. In the end of the first-round RBC, a local reference expression matrix is constructed from those query cells whose cell labels are validated, and a negative control expression matrix is also constructed for each local reference cell label from their negative control query cells (Figure <xref rid="F1" ref-type="fig">1B</xref>).</p>
      <p>In the second-round RBC, the original reference expression matrix is replaced by the local reference expression matrix, thereby eliminating the batch effects between the reference and the query dataset. The three modules in the second-round RBC are similar to those in the first-round except for the followings. In the first module, a negative control expression matrix specific to a local reference cell type is also included when identifying the reference cell type-specific marker genes. In the second module, a different similarity metric is employed. In the third module, relatively less stringent criterion is applied to validate the candidate cell labels. In the end, the unvalidated query cells are labeled with ‘unassigned’ (Figure <xref rid="F1" ref-type="fig">1C</xref>).</p>
      <p>In the recapturing step, query cells are divided into a large number of small clusters. If majority of cells in a cluster are assigned with the same cell label, then those ‘unassigned’ cells within the cluster are recaptured, and are also assigned with the label (Figure <xref rid="F1" ref-type="fig">1D</xref>). Finally, scMAGIC outputs the annotations for each query cells with either a cell label or an ‘unassigned’ label (Figure <xref rid="F1" ref-type="fig">1E</xref>).</p>
    </sec>
    <sec id="SEC3-2">
      <title>Evaluation of scMAGIC’s performance in three situations</title>
      <p>When conducting RBC, it is usually assumed that all cell types in the query dataset are covered by the reference dataset. However, in reality the query dataset may also include cell types that are not covered by the reference dataset. In addition, cross-species RBC is often encountered, in which the query and the reference dataset are produced from different organisms. These three situations bring different levels of challenges to the RBC task. Here, to evaluate scMAGIC’s performance, for these three situations we prepare a total of 86 paired reference-query datasets in which 66 are obtained from the benchmark study by Abdelaal <italic toggle="yes">et al.</italic> (<xref rid="B40" ref-type="bibr">40</xref>) and Zhao <italic toggle="yes">et al.</italic> (<xref rid="B41" ref-type="bibr">41</xref>). We compare scMAGIC with 13 recently published RBC methods, including three statistical-metrics-based (SingleR, Scmap and sciBet), two tree-based (CHETAH and scClassify), five machine-learning-based (scPred, SingleCellNet, scID, CaSTLe and SVM<sub>rejection</sub>) and three semi-supervised-learning-based (Seurat v4, scSemiCluster and CALLR) methods. Using nine benchmark datasets randomly selected from the three situations, we determine the optimal parameter setting for each method and run the method with the setting throughout the evaluations (for details, see Materials and Methods). We use the following metrics to measure the performance of a method: accuracy (the proportion of query cells with correctly assigned labels), balanced accuracy (the accuracy averaged across query cell types), labeled accuracy (the accuracy after removing ‘unassigned’ query cells) and labeled balanced accuracy (the accuracy averaged across cell type labels assigned by an RBC method after removing ‘unassigned’ query cells). Because users generally also pay attention to the identity of cell clusters (<xref rid="B42" ref-type="bibr">42</xref>), we also introduce a new metrics called cluster accuracy (the proportion of query clusters with correctly assigned labels) to evaluate the performances of these RBC methods on assigning cell type labels to cell clusters (for details, see Materials and Methods).</p>
      <sec id="SEC3-2-1">
        <title>The first situation: the cell types of the query dataset are covered by the reference dataset</title>
        <p>In this situation, we design three scenarios—cross-validation, cross-sample and cross-platform RBC, to mimic the situation in which there are no, little or significant batch effects between the reference and the query datasets, respectively. In the cross-validation scenario, we select 15 datasets to conduct five-fold cross-validation. In the cross-sample scenario, we select 8 pairs of datasets which are produced from the same tissue and platform but from different samples. In the second scenario, we select 33 pairs of datasets that are produced from the same tissue but using different sequencing platforms. For details about the selected datasets and the relationships of cell types between the reference and the query datasets in the third scenario, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S2–34</xref>, respectively.</p>
        <p>Most methods do well in the cross-validation scenario (Figure <xref rid="F2" ref-type="fig">2</xref>). The averaged accuracy and the averaged balanced accuracy by scMAGIC across the 15 benchmark tests are 0.95 and 0.91, respectively. The averaged accuracy by all competing methods except CALLR, CHETHA and scID is &gt;0.9. Six competing methods (Seurat v4, singleCellNet, sciBet, CaSTLe, scmap-cell and SVM<sub>rejection</sub>) perform comparably (averaged accuracy: 0.94–0.96, averaged balanced accuracy: 0.87–0.93) to scMAGIC (Figure <xref rid="F2" ref-type="fig">2</xref>). In the cross-sample scenario, scMAGIC achieves an averaged accuracy of 0.92 and an averaged balanced accuracy of 0.9 across the 8 benchmark tests, whereas the averaged accuracy and averaged balanced accuracy by the best competing methods are 0.91 (SVM<sub>rejection</sub>) and 0.9 (sciBet), respectively (Figure <xref rid="F2" ref-type="fig">2</xref>). In the cross-platform scenario, scMAGIC achieves an averaged accuracy of 0.88 and an averaged balanced accuracy of 0.87 across the 33 benchmark tests, whereas the averaged accuracy and averaged balanced accuracy by the best competing methods are 0.85 (Seurat v4) and 0.82 (Seurat v4 and sciBet), respectively (Figure <xref rid="F2" ref-type="fig">2</xref>). Overall, scMAGIC ranks the best among all methods, with an averaged accuracy and an averaged balanced accuracy of 0.9 and 0.89, respectively, across the 56 benchmark datasets in the three scenarios of the first situation (Figure <xref rid="F2" ref-type="fig">2</xref>). We also compare the 14 methods at the cluster level. scMAGIC achieves an averaged cluster accuracy of 0.9, while the averaged cluster accuracy by the best competing method is 0.86 (singleCellNet, sciBet, Seurat v4) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S17</xref>). Because the first situation is relatively easy, most methods do well, and the advantage of scMAGIC over the competing methods is not very significant despite that it ranks the best among all methods in this situation.</p>
        <fig position="float" id="F2">
          <label>Figure 2.</label>
          <caption>
            <p>The performance of scMAGIC and 13 competing methods in the first situation. In the cross-validation and cross-sample scenario, we use the first author and the tissue of the study to represent a benchmark test. In the cross-platform scenario, we use the platform of the reference dataset, the platform of the query dataset and the tissue of the two studies to represent a benchmark test. For details about the datasets used in these three scenarios, refer to <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>. The accuracy and the balanced accuracy of the 14 methods are shown in heatmaps. The boxplots of the accuracy and the balanced accuracy of the 14 methods are shown in the bottom respectively. The 14 methods are arranged from left to right according to their mean accuracy in decreasing order; MP, mouse pancreas; HP, human pancreas; MB, mouse brain; HPBMC, human peripheral blood mononuclear cells; iD, inDrops; CL, CEL-Seq2; SM, SMARTer; SM2, Smart-seq2; DR, Drop-seq; FC, Fluidigm C1; 10XV2, 10x Chromium (v2); 10XV3, 10x Chromium (v3); SW, Seq-Well.</p>
          </caption>
          <graphic xlink:href="gkab1275fig2" position="float"/>
        </fig>
      </sec>
      <sec id="SEC3-2-2">
        <title>The second situation: the query dataset includes cell types not covered by the reference dataset</title>
        <p>In this situation, we also design two scenarios to evaluate the impacts of batch effects on the classification performance. In the first scenario, the reference datasets are sequenced with high-depth by technologies such as SMARTer, Smart-seq2 or CEL-Seq2 (&gt;2500 genes captured per cell in average), while the reference datasets in the second scenario are sequenced with low-depth by technologies such as Microwell-Seq or Seq-Well (&lt;650 genes captured per cell in average). These two scenarios are therefore named as the high- and low-depth reference scenario, respectively, and the low-depth reference scenario apparently represents the scenario with more significant batch effects. The high- and low-depth reference scenarios include 15 and 11 benchmark tests, respectively, and in each benchmark test, the query dataset includes some cell types not covered by the reference dataset (for details, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S35–60</xref>).</p>
        <p>In the high-depth reference scenario, scMAGIC achieves an averaged accuracy and an averaged balanced accuracy of 0.89 and 0.87, respectively, across the 15 benchmark tests (Figure <xref rid="F3" ref-type="fig">3A</xref>). In the low-depth reference scenario, scMAGIC still achieves an excellent performance, with an averaged accuracy and an averaged balanced accuracy of 0.9 and 0.87, respectively, across the 11 benchmark tests (Figure <xref rid="F3" ref-type="fig">3A</xref>). In contrast, the competing methods’ performance is not only significantly worse but also significantly affected by the batch effects. In the high-depth reference scenario, the averaged accuracy and the averaged balanced accuracy by the best competing method are 0.83 (sciBet and scmap-cluster) and 0.75 (scSemiCluster), respectively (Figure <xref rid="F3" ref-type="fig">3A</xref>). In the low-depth reference scenario, these numbers drop to only 0.76 (scClassify) and 0.74 (Seurat), respectively, and the averaged accuracy of sciBet, scPred, scmap-cluster, singleCellNet, SingleR and scmap-cell even drop by &gt;0.2 (Figure <xref rid="F3" ref-type="fig">3A</xref>). We also inspect the labeled accuracy and the labeled balanced accuracy by removing query cells with ‘unassigned’ labels. The averaged labeled accuracy and the averaged labeled balanced accuracy of scMAGIC are 0.92 and 0.84 in the high-depth reference scenario, respectively, and 0.92 and 0.81 in the low-depth reference scenario, respectively, making it still superior to all competing methods except for singleCellNet that achieves a slightly higher averaged labeled balanced accuracy in the high-depth reference scenario (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S18A</xref>). As for the cluster accuracy, scMAGIC achieves an averaged cluster accuracy of 0.91 in both scenarios, whereas the best competing methods only achieve an averaged cluster accuracy of 0.82 (sciBet and singleCellNet) and 0.78 (scClassify) in the high- and low-depth reference scenario, respectively (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S19</xref>).</p>
        <fig position="float" id="F3">
          <label>Figure 3.</label>
          <caption>
            <p>The performance of scMAGIC and 13 competing methods in the second situation. Panel (<bold>A</bold>) is organized in the same way as Figure <xref rid="F2" ref-type="fig">2</xref> except that the two scenarios are the high-depth and the low-depth reference scenarios, respectively. Here, a benchmark test is represented by the platforms of the reference and the query dataset and the tissue of the two studies. For details about the datasets used in this situation, refer to <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>. Panels (<bold>B–F</bold>) show the heatmaps of the confusion matrix of scMAGIC, sciBet, scClassify, scPred and scSemiCluster, respectively, in the high-depth reference scenario, with the mouse datasets profiled by SMARTer and Drop-seq (Campbell) as the reference and query dataset respectively. In a confusion matrix, the row and column names correspond to the reference cell labels (including the ‘unassigned’ label) and the query cell labels, respectively, while the element represents the proportion of a specific type of query cells that are assigned with a specific reference cell label; HPBMC, human peripheral blood mononuclear cells; MB, mouse brain; OPC, oligodendrocyte precursor cell; VLMC, vascular and leptomeningeal cell. The abbreviations of the platforms are the same as in Figure <xref rid="F2" ref-type="fig">2</xref>.</p>
          </caption>
          <graphic xlink:href="gkab1275fig3" position="float"/>
        </fig>
        <p>Here, we select a benchmark test from the mouse brain in the first scenario as an example to illustrate the performance difference of scMAGIC from the competing methods. We select sciBet, scClassify, scPred and scSemiCluster as the representative method of the statistical-metric-based, the tree-based, the machine-learning-based and the semi-supervised-learning-based RBC methods, respectively, to compare with scMAGIC. The reference dataset (<xref rid="B4" ref-type="bibr">4</xref>) includes six cell types, while the query dataset (<xref rid="B29" ref-type="bibr">29</xref>) includes 11 cell types in which five are not covered by the reference (for details, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S47</xref>). Those query cells belonging to the six reference cell types are classifiable, while the remaining query cells are unclassifiable. scMAGIC identifies the cell types of the classifiable query cells with very high accuracy (0.99) and very high balanced accuracy (0.97), and also successfully recognizes 97% of unclassifiable query cells (some mural cells are recognized as endothelial cells) (Figure <xref rid="F3" ref-type="fig">3B</xref>). Both sciBet and scClassify also identify the cell types of the classifiable query cells with very high accuracy (0.99) and very high balanced accuracy (0.96–0.97), but their ability to recognize unclassifiable query cells is poor. sciBet wrongly assigns all unclassifiable query cells with some reference cell labels (Figure <xref rid="F3" ref-type="fig">3C</xref>), as it assumes that the cell types of the query dataset are all covered by the reference dataset. scClassify identifies only a small portion (19%) of unclassifiable cells (Figure <xref rid="F3" ref-type="fig">3D</xref>), probably because the hierarchical classification tree built by scClassify is based only on the cell types in the reference dataset, and may not be discriminative enough to recognize unclassifiable query cells. Although scPred recognizes 79% of unclassifiable query cells as ‘unassigned’, it wrongly labels many classifiable query cells (e.g. microglia and endothelial cells) as ‘unassigned’ (Figure <xref rid="F3" ref-type="fig">3E</xref>), probably because it overfits the reference dataset. scSemiCluster also assumes that the cell types in the query dataset are all covered by the reference dataset. Therefore, although it achieves a high accuracy (0.99) for classifiable query cells, it wrongly assigns all unclassifiable query cells with some reference cell types (Figure <xref rid="F3" ref-type="fig">3F</xref>).</p>
      </sec>
      <sec id="SEC3-2-3">
        <title>The third situation: cross-species reference-based classification</title>
        <p>In this situation, we collect four pairs of mouse and human datasets produced from the same tissues and use the mouse dataset as the reference dataset to annotate the human dataset. Note that for each pair of reference-query datasets, the cell types in the reference and the query datasets may not completely overlap with each other. On the other hand, because a large number of genes are lost during homologous gene conversion, there exist significant batch effects in between the reference and the query datasets. For details about the cell types in the reference and the query datasets, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S61–64</xref>.</p>
        <p>In the cross-species RBC, scMAGIC achieves an averaged accuracy and an averaged balanced accuracy of 0.92 and 0.78, respectively, across the four benchmark tests (Figure <xref rid="F4" ref-type="fig">4A</xref>). In contrast, the averaged accuracy and the averaged balanced accuracy by the best competing methods are only 0.78 (scClassify) and 0.65 (Seurat v4), respectively (Figure <xref rid="F4" ref-type="fig">4A</xref>). If we consider only query cells assigned with cell labels, the averaged labeled accuracy and the averaged labeled balanced accuracy by scMAGIC are 0.94 and 0.84, respectively, while they are only 0.81 (scClassify) and 0.66 (Seurat v4), respectively, by the best competing method (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S20A</xref>). The averaged cluster accuracy of scMAGIC is 0.9 which is &gt;0.83 (scClassify) by the best competing method (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S20B</xref>).</p>
        <fig position="float" id="F4">
          <label>Figure 4.</label>
          <caption>
            <p>The performance of scMAGIC and 13 competing methods in the third situation. Panel (<bold>A</bold>) shows the heatmaps (left) and the boxplots (right) of the accuracy and the balanced accuracy of the 14 methods. The 14 methods are arranged from top to bottom according to their mean accuracy in decreasing order. In each benchmark test, the reference and the query dataset are produced from the same tissue of mouse and human, respectively. The first authors of the reference and the query dataset and the tissue are used to represent a benchmark test. For details about the datasets used in this situation, refer to <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>. Here, panels (<bold>B–F</bold>) are organized in the same way as (B–F). In this benchmark test, the tissue is pancreas, while the first author of the reference and the query datasets are Baron and Muraro, respectively; ASC, activated stellate cell; QSC, quiescent stellate cell.</p>
          </caption>
          <graphic xlink:href="gkab1275fig4" position="float"/>
        </fig>
        <p>Here, we select the pair of mouse (<xref rid="B5" ref-type="bibr">5</xref>) and human (<xref rid="B33" ref-type="bibr">33</xref>) pancreas datasets to illustrate the performance difference of scMAGIC from the competing methods. We also select sciBet, scClassify, scPred and scSemiCluster to compare with scMAGIC. The reference and the query dataset have ten common cell types, while they both include cell types not covered by the other (for details, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S61</xref>). scMAGIC identifies the cell types of almost all classifiable query cells with high accuracy (0.94) except that it wrongly labels some quiescent stellate cells (QSC) as activated stellate cells (ASC). It also correctly recognizes two-thirds of unclassifiable query cells (Figure <xref rid="F4" ref-type="fig">4B</xref>). In comparison, the performance of the three competing methods is significantly worse. sciBet assigns correct cell labels to only about 40% of classifiable query cells and fails to recognize all unclassifiable query cells (Figure <xref rid="F4" ref-type="fig">4C</xref>). scClassify assigns 84% of classifiable query cells with a cell label, in which 91% are correct, yet recognizes only fewer than half of unclassifiable query cells (Figure <xref rid="F4" ref-type="fig">4D</xref>). Although scPred recognizes two thirds of unclassifiable query cells, it wrongly labels 50% of classifiable query cells as ‘unassigned’. However, the accuracy of those classifiable query cells assigned by scPred with cell labels is high (0.92) (Figure <xref rid="F4" ref-type="fig">4E</xref>). scSemiCluster only correctly classifies about 35% of classifiable query cells and fails to recognize any unclassifiable query cell (Figure <xref rid="F4" ref-type="fig">4F</xref>).</p>
      </sec>
      <sec id="SEC3-2-4">
        <title>Performance summary of all methods across the three situations</title>
        <p>In total, we have conducted 86 benchmark tests representing three situations to evaluate the 14 methods. Here, we summarize the benchmark results by recording the rank of each method in each of the 86 benchmark tests in terms of accuracy and then calculate the median of the ranks across the 86 tests for each method. The advantage of scMAGIC over the competing methods is very significant: scMAGIC achieves a median accuracy rank of 1, while the second-ranked (Seurat v4) and the third-ranked method (scSemiCluster) have a median rank of 4 and 5, respectively (Figure <xref rid="F5" ref-type="fig">5A</xref>). The benchmark tests in which scMAGIC is not ranked the top mostly belong to the first situation, and scMAGIC actually all performs comparably to the best method in these benchmark tests (Figure <xref rid="F5" ref-type="fig">5A</xref>). If we use the balanced accuracy to rank all the methods, scMAGIC still achieves a median rank of 1, while the median rank is 4 by the second-ranked methods (sciBet, Seurat v4), respectively (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S21A</xref>). The result based on the cluster accuracy is the same: the median rank by scMAGIC is still 1, in contrast to 4 by the second-ranked methods (sciBet, scSemiCluster and scClassify) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S21B</xref>).</p>
        <fig position="float" id="F5">
          <label>Figure 5.</label>
          <caption>
            <p>The performance summary of scMAGIC and 13 competing methods across the 86 benchmark tests. Panel (<bold>A</bold>) shows the rank scores and the median of ranks of each of the 14 methods based on their accuracy across the 86 benchmark tests in the left and the right plot, respectively. In the left plot, the height of the ridgelines represents the rank of a method in a benchmark test. The 14 methods are arranged from bottom to top according to their median of ranks in increasing order. (<bold>B</bold>) The left plot shows the accuracy of each of the 14 methods with respect to the ranks of classification difficulty index (CDI) of the 86 benchmark tests. A linear regression model is applied to fit the accuracy to CDI ranks for each method, and the fitted line is plotted. Here, all linear models are statistically significant (<italic toggle="yes">P</italic>-value &lt; 0.001). The 14 methods are arranged from top to bottom according to their mean accuracy in decreasing order. The right plot shows the converted <italic toggle="yes">Z</italic>-score of the slope of the fitted line for each of the 14 methods.</p>
          </caption>
          <graphic xlink:href="gkab1275fig5" position="float"/>
        </fig>
        <p>The 86 benchmark tests belong to three situations that roughly represent different difficulty degree of a classification task. To inspect more directly the performance of different methods in terms of the degree of classification difficulty, here we define a Classification Difficulty Index (CDI) by incorporating the batch effects between the reference and the query dataset measured by the F1 of the average silhouette width (ASW) score (<xref rid="B39" ref-type="bibr">39</xref>) and the proportion of classifiable query cells (for details, see Materials and Methods), with a greater CDI score corresponding to a more difficult classification task. We calculate the CDI score for each benchmark test and then rank the 86 tests by their CDI scores. The benchmark tests in the third situation and the low-depth reference scenario of the second situation have the highest CDI ranks, while those in the cross-validation scenario of the first situation have the lowest CDI ranks (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S22</xref>), which are consistent with our expectation on the classification difficulty of these three situations. For each method, we plot its accuracy with respect to the CDI ranks of the 86 tests and use a linear model to fit the accuracy to the CDI ranks (Figure <xref rid="F5" ref-type="fig">5B</xref>). The averaged accuracy of scMAGIC across the 86 tests is 0.9, in contrast to 0.84 by the best competing method (Seurat v4). In general, all methods’ accuracy decreases with the increase of CDI ranks, i.e., the increase of the degree of classification difficulty. However, scMAGIC’s accuracy decreases only slightly with the increase of CDI ranks, in contrast to much more significant decreases by the competing methods. To further illustrate this tendency, we calculate the slope of each method’s fitted line and convert it into a <italic toggle="yes">Z</italic>-score. The <italic toggle="yes">Z</italic>-score of scMAGIC is 2.32, while the <italic toggle="yes">Z</italic>-scores of the second (Seurat v4), the third (scClassify) and the fourth (scSemiCluster) method ranked by their mean accuracy are 0.85, 1.2, and 0.72, respectively (Figure <xref rid="F5" ref-type="fig">5B</xref>). This clearly showed that compared to the 13 competing methods, the performance of scMAGIC was much more stable with the increase of CDI ranks. Similar results were obtained by replacing the accuracy with the balanced accuracy or cluster accuracy (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S23</xref>).</p>
      </sec>
    </sec>
    <sec id="SEC3-3">
      <title>Investigation of the contribution of component algorithm designs on scMAGIC’s performance</title>
      <p>There are three special algorithm designs in scMAGIC. The first is the use of a second-round RBC. The second is the addition of an atlas expression matrix when identifying the reference cell type-specific marker genes. The third is the selection of query cells to construct the local expression matrix to be used in the second-round RBC.</p>
      <p>To investigate how the introduction of the second-round RBC contributes to scMAGIC’s performance, we compare scMAGIC with scMAGIC<sub>single-round</sub> that conducts only one round of RBC in four selected benchmark tests from the three situations. The introduction of the second-round RBC is critical to the performance of scMAGIC. When the batch effects are not significant, e.g. in the two benchmark tests selected from the cross-platform scenario of the first situation and the high-depth reference scenario of the second situation, the accuracy of scMAGIC decreases only slightly by using only one round of RBC. However, the accuracy of scMAGIC drops significantly by using only one round of RBC when there are significant batch effects: in the two benchmark tests selected from the low-depth reference scenario of the second situation and the third situation, the accuracy of scMAGIC is 0.98 and 0.85, respectively, but drops to only 0.33 and 0.34, respectively, by using only one round of RBC (Figure <xref rid="F6" ref-type="fig">6A</xref>). Nevertheless, adding more rounds of RBC does not further improve scMAGIC’s performance (Figure <xref rid="F6" ref-type="fig">6B</xref>).</p>
      <fig position="float" id="F6">
        <label>Figure 6.</label>
        <caption>
          <p>The analysis for scMAGIC’s algorithm designs. Panel (<bold>A</bold>) shows the bar plot of the accuracy of scMAGIC and scMAGIC<sub>single-round</sub> in four selected benchmark tests. Each benchmark test is represented by the first authors of the reference and the query dataset and the tissue of the query dataset, with the corresponding situation shown in parenthesis. In scMAGIC<sub>single-round</sub>, only one round of RBC is performed. Panel (<bold>B</bold>) is similar to (A) except that scMAGIC is compared with scMAGIC<sub>three-round</sub> in which three rounds of RBC are performed. Panel (<bold>C</bold>) is similar to (A) except that scMAGIC is compared with scMAGIC<sub>no-Atlas</sub> in which no atlas expression matrix is included. Panel (<bold>D</bold>) shows the relationship between the accuracy of scMAGIC and the accuracy of the confidently validated query cells in the first-round of RBC. Panel (<bold>E</bold>) shows the relationship between the accuracy of the confidently validated query cells and the increase in CDI ranks. Panel (<bold>F</bold>) shows the relationship between the proportion of the confidently validated query cells and the increase of CDI ranks.</p>
        </caption>
        <graphic xlink:href="gkab1275fig6" position="float"/>
      </fig>
      <p>To understand the importance of the inclusion of an atlas expression matrix, we modify scMAGIC to not use the atlas expression matrix (scMAGIC<sub>no-Atlas</sub>). When all query cell types are covered by the reference, e.g. in a dataset selected from the cross-platform scenario of the first situation, the accuracy of scMAGIC<sub>no-Atlas</sub> is nearly the same as scMAGIC’s (Figure <xref rid="F6" ref-type="fig">6C</xref>). However, in the other three benchmark tests in which the query datasets include some cell types not covered by the reference dataset, scMAGIC<sub>no-Atlas</sub> performs evidently worse than scMAGIC does (Figure <xref rid="F6" ref-type="fig">6C</xref>). Thus, in the presence of unclassifiable query cells, the inclusion of an atlas expression matrix helps to identify marker genes not only more specific to classifiable query cells but also more discriminative to unclassifiable query cells.</p>
      <p>The quality of confidently validated cells in the first-round RBC determines the quality of the constructed local reference expression matrix and consequently the classification accuracy in the second-round RBC. In fact, scMAGIC’s classification accuracy is strongly correlated with the accuracy of the confidently validated query cells in the first-round RBC (Figure <xref rid="F6" ref-type="fig">6D</xref>), further highlighting the necessity of utilizing strict criterion to validate and select the query cells. Because of the implementation of strict selection criterion, the accuracy of confidently validated query cells is above 0.9 in 84 of the 86 benchmark tests, with an mean accuracy of 0.97, and only slightly decreases with the increase in CDI ranks (Figure <xref rid="F6" ref-type="fig">6E</xref>), thereby ensuring the high accuracy of scMAGIC. However, the cost is that the proportion of confidently validated query cells drops significantly with the increase of CDI ranks: the proportion is around 0.7 in the benchmark tests with the lowest CDI ranks and reduces to around 0.25 in the benchmark tests with the highest CDI ranks (Figure <xref rid="F6" ref-type="fig">6F</xref>). But the advantage of scRNA-seq is that there are still enough number of query cells left even, making it possible to construct a high-quality local reference expression matrix and consequently producing high-quality predictions. The high quality of the local reference expression matrix constructed in the first-round RBC also explains why the addition of more rounds of RBC would not continue improving the performance of scMAGIC.</p>
    </sec>
    <sec id="SEC3-4">
      <title>scMAGIC can be used as an exploratory tool for single cell annotation</title>
      <p>In an exploratory scRNA-seq study, sometimes it may not be possible for users to find a specific reference dataset. In this case, an atlas expression matrix may be used as the reference to conduct an exploratory annotation of query cells. However, the atlas often includes hundreds of cell types while the query dataset typically includes only several or dozens of cell types. In addition, cells in the atlas are often sequenced at low-depth. These all may bring challenges to the RBC task. To evaluate the usefulness of scMAGIC as an exploratory annotation tool, here we apply scMAGIC to classify two mouse and two human query datasets by using MCA and HCL as the reference datasets, respectively. As MCA and HCL also provide their own annotation tools named scMCA (<xref rid="B8" ref-type="bibr">8</xref>) and scHCL (<xref rid="B7" ref-type="bibr">7</xref>), respectively, we compare scMAGIC with these two tools.</p>
      <p>The four query datasets are a mouse neocortex dataset (<xref rid="B28" ref-type="bibr">28</xref>), a mouse duodenum dataset (<xref rid="B32" ref-type="bibr">32</xref>), a human pancreas dataset (<xref rid="B5" ref-type="bibr">5</xref>) and a human PBMCs dataset (<xref rid="B6" ref-type="bibr">6</xref>). For details about the matching relationships between the cell labels in the query dataset and in the atlas, refer to <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S65–68</xref>. Across these four query datasets, scMAGIC consistently achieves reasonably high accuracy (accuracy: 0.88–0.98, balanced accuracy: 0.77–0.88) (Figure <xref rid="F7" ref-type="fig">7A</xref>). What’s more, the labeled accuracy and the labelled balanced accuracy by scMAGIC across the four query datasets are 0.92–0.98 and 0.85–0.96, respectively (Figure <xref rid="F7" ref-type="fig">7A</xref>). Such high labeled accuracy is especially compelling for an exploratory study in the initial round of cell type annotation. In comparison, the performance of scMCA and scHCL is significantly worse. For example, the labeled balanced accuracy of scMCA and scHCL is only 0.25–0.46, and scMAC does very poorly in the mouse duodenum dataset, with an accuracy and an labeled accuracy both around 0.1 (Figure <xref rid="F7" ref-type="fig">7A</xref>). There are two main reasons why scMCA and scHCL are significantly worse. One is because they both assume all cell types in the query dataset are covered by the atlas, which may not be true, e.g. in the two mouse datasets. Another is because they tend to assign more cell types than needed, leading to poor labeled balanced accuracy. For details about the performance of scMAC and scHCL in these four query datasets, refer to <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S24</xref>. Below, we provide more detailed illustrations about scMAGIC’s performance in these four query datasets.</p>
      <fig position="float" id="F7">
        <label>Figure 7.</label>
        <caption>
          <p>The performance of scMAGIC by using the atlas expression matrix as the reference. Panel (<bold>A</bold>) shows the bar plot of the accuracy, the balanced accuracy, the labeled accuracy and the labeled balanced accuracy of scMAGIC, scMCA and scHCL by using the atlas expression matrix as the reference to annotate four query datasets. For details about the query datasets, refer to <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>. Each benchmark test is represented by the tissue of a query dataset. Panels (<bold>B–E</bold>) show the heatmaps of the confusion matrices of scMAGIC by using MCA (B and C) or HCL (D and E) as the reference to annotate mouse neocortex (B), mouse duodenum (C), human pancreas (D) and human PBMC (E), respectively. Each confusion matrix is arranged in the same way as the confusion matrices in Figure <xref rid="F3" ref-type="fig">3B</xref>–<xref rid="F3" ref-type="fig">E</xref>. Note that peripheral vascular macrophage (PVM) and microglia are combined into one cell type by the authors, and oligodendrocyte and oligodendrocyte precursor cell (OPC) are also combined into one cell type in (B); VLMC, vascular and leptomeningeal cell; ASC, activated stellate cell; QSC, quiescent stellate cell.</p>
        </caption>
        <graphic xlink:href="gkab1275fig7" position="float"/>
      </fig>
      <p>The mouse neocortex dataset (<xref rid="B28" ref-type="bibr">28</xref>) consists of nine cell types (for details, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S65</xref>). Among these cell types, pericyte and vascular and leptomeningeal cell (VLMC) are not covered by the MCA, and are assigned by scMAGIC as ‘unassigned’. Astrocytes, endothelial cells, smooth muscle cells (SMC), peripheral vascular macrophages (PVM) and microglia are correctly assigned by scMAGIC with their corresponding labels. Most query cells of GABAergic neuron and glutamatergic neuron are assigned by scMAGIC with the label of ‘dopaminergic neuron’ (these are considered approximately matches because these two types of neurons and dopaminergic neuron all produce neurotransmitters (<xref rid="B43" ref-type="bibr">43</xref>)), while a small portion are assigned with the false label of ‘pyramidal neuron cell’. Most query cells of oligodendrocyte and OPC are not recognized by scMAGIC, while a portion of them are correctly assigned with the label of ‘OPC’ (Figure <xref rid="F7" ref-type="fig">7B</xref>).</p>
      <p>The mouse duodenum dataset (<xref rid="B32" ref-type="bibr">32</xref>) consists of eight cells types (for details, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S66</xref>). Three of the eight cell types are not included in MCA, and are all assigned by scMAGIC with the ‘unassigned’ labels. Five query cell types are assigned by scMAGIC with cell labels in MCA, in which two (Tuft and Paneth cell) are exact matches. We investigate the relationships between the other three pairs of cell types, and find evidence that they can be considered approximately matches (goblet cell and columnar epithelium (<xref rid="B44" ref-type="bibr">44</xref>), enterocyte and epithelium of small intestinal villi (<xref rid="B45" ref-type="bibr">45</xref>), and enteroendocrine cell and S cell (<xref rid="B46" ref-type="bibr">46</xref>)). However, about 15% of classifiable query cells are recognized as ‘unassigned’ by scMAGIC (Figure <xref rid="F7" ref-type="fig">7C</xref>).</p>
      <p>The cell types in the human pancreas (<xref rid="B5" ref-type="bibr">5</xref>) dataset are all classifiable, meaning they are either already included in HCL, or can be approximately matched to some cell labels in HCL (for details, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S67</xref>). In pancreas, acinar cell belongs to exocrine cell (<xref rid="B5" ref-type="bibr">5</xref>), alpha cell, beta cell, gamma cell, delta cell and epsilon cell belong to endocrine cell (<xref rid="B5" ref-type="bibr">5</xref>), and ASC and QSC belong to stromal cell (<xref rid="B47" ref-type="bibr">47</xref>). Therefore, it's correct that acinar cells in the query dataset are labeled by scMAGIC with either acinar cell or exocrine cell, and alpha cells are labeled with either alpha cell or endocrine cell. However, scMAGIC labels three classifiable query cell types (macrophage, mast cell and schwann cell) as ‘unassigned’ (Figure <xref rid="F7" ref-type="fig">7D</xref>).</p>
      <p>The human PBMCs dataset (<xref rid="B6" ref-type="bibr">6</xref>) includes six cell types that are all covered by HCL (for details, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S68</xref>). In this dataset, the balanced accuracy by scMAGIC is relatively low. This is because about 25% of Dendritic cell are wrongly labeled as Monocyte, while all NK cells are wrongly labeled (Figure <xref rid="F7" ref-type="fig">7E</xref>). However, all these other query cells are correctly labeled.</p>
    </sec>
    <sec id="SEC3-5">
      <title>Running time evaluation</title>
      <p>Here, we select the dataset of Hochgerner <italic toggle="yes">et al.</italic> (<xref rid="B30" ref-type="bibr">30</xref>) as the reference dataset and the dataset of Campbell <italic toggle="yes">et al.</italic> (<xref rid="B28" ref-type="bibr">28</xref>) as the query dataset, and randomly select a portion of query cells to do the classification. Then, we compare the runtimes of the RBC methods investigated in this study, and inspect how they scale when the number of query cells increases. scMAGIC finishes the classification of 20 000 query cells within 6 min, and its runtime does not increases much with the increase of cell numbers when the cell number is over 5000 because of its speed-up setting (for details, see Materials and Methods). There are over half of methods which cannot finish the classification of 20 000 query cells within 6 min, such as scmap-cell, CHETAH, scPred, scID, singleR, scSemiCluster, CaSTLe and CALLR. The runtimes of scmap-cell, singleR, scSemiCluster, CaSTLe and CALLR significantly increase with the increase of cell numbers (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S25A</xref>). We also compare the runtime of scMAGIC with that of scMCA and scHCL in the four query dataset investigated in the exploratory study. scMAGIC’s runtime is around 8–12 min, in contrast to 40–130 min by scMAC and scHCL (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S25B</xref>). Thus, scMAGIC is reasonably efficient, and is well suited for large-scale single cell data analysis.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>DISCUSSION</title>
    <p>An underlying assumption of current RBC methods is that the cell types in the query dataset are covered by the reference dataset. When this assumption holds true, i.e. in the first situation in this study, most RBC methods indeed do well. However, in the second and the third situations when the query datasets include unclassifiable query cells whose cell types are not covered by the reference, the performance of most RBC methods is significantly affected. For example, sciBet, a statistical-metrics-based, and scSemiCluster, a semi-supervised-learning-based method, wrongly assign all unclassifiable query cells with some reference cell labels. Another major factor affecting the performance of current RBC methods is the batch effects between the reference and the query datasets, which especially affect those RBC methods that compare query expression profiles directly with reference expression profiles, such as the statistics-based, the tree-based and the machine-learning based RBC methods. Although the semi-supervised-learning-based methods tackle this problem by integrating reference and query cells using different techniques, the significant batch effects may still affect the quality of the integration and consequently its performance. By taking these two factors into consideration, we develop an CDI metric to represent the degree of classification difficulty and find that the performance of all the 13 RBC methods investigated in this study drops evidently with the increase of CDI ranks of the 86 benchmark tests.</p>
    <p>scMAGIC, a novel two-rounds RBC method developed in this study, well addresses the above-mentioned challenges. In order to more effectively recognize unclassifiable query cells, scMAGIC adds an atlas expression matrix when identifying the reference cell type-specific marker genes, making the selected marker genes more specific to the reference cell types and consequently more selective to distinguish unclassifiable query cells. As for dealing with the batch effects, scMAGIC innovatively introduces a second-round RBC by replacing the original reference expression matrix with a local reference expression matrix constructed from query cells with verified cell labels and redoing the classification. As the local reference expression matrix belongs to the query expression matrix, there are now no batch effects in the second-round RBC. To some extent, scMAGIC can also be considered as a semi-supervised method because it uses the confidently validated query data to construct the local reference expression matrix to be used in the second-round of RBC. However, what makes it different from other semi-supervised-learning-based methods, such as Seurat v4 and scSemiCluster, is that in scMAGIC, the original reference expression matrix is not used anymore when predicting the cell labels of query cells in the second-round of RBC. In contrast, Seurat v4 and scSemiCluster use not only the query cells but also the reference data as the training set by integrating the reference and the query data into the same space. Although the integration process reduces the batch effects between the query and the reference data, the quality of the integration may still be affected by the batch effects, which will then affect the quality of the final annotations. In scMAGIC, the batch effects can only directly affect the quality of the confidently validated query cells. However, our strict selection criterion has ensured that the confidently validated query cells are of very high quality even for those tests with very high CDI ranks (the mean accuracy of the confidently validated query cells is 0.97 across the 86 tests), and consequently ensures the accuracy of the second-round RBC. Owing to these algorithm designs, scMAGIC consistently achieves excellent performance in the three situations evaluated in this study. It not only correctly assigns reference cell labels to classifiable query cells but also successfully recognizes unclassifiable query cells, and its performance is almost not affected by the batch effects between the reference and the query datasets.</p>
    <p>A number of large-scale scRNA-seq studies have constructed the atlas of single cells consisting of hundreds or even thousands of cell types. Theoretically, the atlas can be used as the reference when no specific reference dataset is available, making an RBC method a general-purpose tool for single cell annotation. However, on the one hand, the atlas is still incomplete and a query dataset may include some cell types not covered by the atlas, such as the mouse duodenum dataset (<xref rid="B32" ref-type="bibr">32</xref>). On the other hand, cells in the atlas are usually sequenced at low-depth, leading to significant batch effects between the atlas and the query datasets. These are the main reasons why scMCA and scHCL, the tools provided by MCA and HCL, do not work well in the four query datasets investigated in this study. In contrast, scMAGIC achieves reasonably high accuracy by using the atlas as the reference because of its algorithm designs. As such, scMAGIC is of great use not only as a highly accurate RBC method by using a specific reference dataset but also as a general-purpose tool for classifying query cells by using an atlas expression matrix as the reference.</p>
  </sec>
  <sec id="SEC5">
    <title>DATA AVALIBILITY</title>
    <p>All single cell gene expression datasets in this study were obtained from their public accessions. The detailed information including the accession codes and publication citations for all datasets can be seen in Materials and Methods.</p>
  </sec>
  <sec id="SEC6">
    <title>CODE AVALIBILITY</title>
    <p>scMAGIC can be used in R and its input and output are compatible with Seurat object. The source code is maintained at <ext-link xlink:href="https://github.com/TianLab-Bioinfo/scMAGIC" ext-link-type="uri">https://github.com/TianLab-Bioinfo/scMAGIC</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>gkab1275_Supplemental_Files</label>
      <media xlink:href="gkab1275_supplemental_files.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ACK1">
    <title>ACKNOWLEDGEMENTS</title>
    <p>We thank Tian YAO for helping with the installation of the competing methods. We also thank members of Tian Lab for discussions and helpful comments.</p>
  </ack>
  <sec id="SEC7">
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link xlink:href="https://academic.oup.com/nar/article-lookup/doi/10.1093/nar/gkab1275#supplementary-data" ext-link-type="uri">Supplementary Data</ext-link> are available at NAR Online.</p>
  </sec>
  <sec id="SEC8">
    <title>FUNDING</title>
    <p>National Key Research and Development Program of China [2021YFC2301500]; National Natural Science Foundation of China [32170667, 31871325, 32100516]; Startup Fund for Young Faculty at SJTU [21 × 010501077]; Shanghai Sailing Program [21YF1422600]. Funding for open access charge: National Natural Science Foundation of China [32170667, 31871325, 32100516]; Startup Fund for Young Faculty at SJTU [21X010501077]; Shanghai Sailing Program [21YF1422600].</p>
    <p><italic toggle="yes">Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <ref-list id="REF1">
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baslan</surname><given-names>T.</given-names></string-name>, <string-name><surname>Hicks</surname><given-names>J.</given-names></string-name></person-group><article-title>Unravelling biology and shifting paradigms in cancer with single-cell sequencing</article-title>. <source>Nat. Rev. Cancer</source>. <year>2017</year>; <volume>17</volume>:<fpage>557</fpage>–<lpage>569</lpage>.<pub-id pub-id-type="pmid">28835719</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Potter</surname><given-names>S.S.</given-names></string-name></person-group><article-title>Single-cell RNA sequencing for the study of development, physiology and disease</article-title>. <source>Nat. Rev. Nephrol.</source><year>2018</year>; <volume>14</volume>:<fpage>479</fpage>–<lpage>492</lpage>.<pub-id pub-id-type="pmid">29789704</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bacher</surname><given-names>R.</given-names></string-name>, <string-name><surname>Kendziorski</surname><given-names>C.</given-names></string-name></person-group><article-title>Design and computational analysis of single-cell RNA-sequencing experiments</article-title>. <source>Genome Biol.</source><year>2016</year>; <volume>17</volume>:<fpage>63</fpage>.<pub-id pub-id-type="pmid">27052890</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tasic</surname><given-names>B.</given-names></string-name>, <string-name><surname>Menon</surname><given-names>V.</given-names></string-name>, <string-name><surname>Nguyen</surname><given-names>T.N.</given-names></string-name>, <string-name><surname>Kim</surname><given-names>T.K.</given-names></string-name>, <string-name><surname>Jarsky</surname><given-names>T.</given-names></string-name>, <string-name><surname>Yao</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Levi</surname><given-names>B.</given-names></string-name>, <string-name><surname>Gray</surname><given-names>L.T.</given-names></string-name>, <string-name><surname>Sorensen</surname><given-names>S.A.</given-names></string-name>, <string-name><surname>Dolbeare</surname><given-names>T.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Adult mouse cortical cell taxonomy revealed by single cell transcriptomics</article-title>. <source>Nat. Neurosci.</source><year>2016</year>; <volume>19</volume>:<fpage>335</fpage>–<lpage>346</lpage>.<pub-id pub-id-type="pmid">26727548</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baron</surname><given-names>M.</given-names></string-name>, <string-name><surname>Veres</surname><given-names>A.</given-names></string-name>, <string-name><surname>Wolock</surname><given-names>S.L.</given-names></string-name>, <string-name><surname>Faust</surname><given-names>A.L.</given-names></string-name>, <string-name><surname>Gaujoux</surname><given-names>R.</given-names></string-name>, <string-name><surname>Vetere</surname><given-names>A.</given-names></string-name>, <string-name><surname>Ryu</surname><given-names>J.H.</given-names></string-name>, <string-name><surname>Wagner</surname><given-names>B.K.</given-names></string-name>, <string-name><surname>Shen-Orr</surname><given-names>S.S.</given-names></string-name>, <string-name><surname>Klein</surname><given-names>A.M.</given-names></string-name><etal>et al</etal>.</person-group><article-title>A single-cell transcriptomic map of the human and mouse pancreas reveals Inter- and Intra-cell population structure</article-title>. <source>Cell Syst.</source><year>2016</year>; <volume>3</volume>:<fpage>346</fpage>–<lpage>360</lpage>.<pub-id pub-id-type="pmid">27667365</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ding</surname><given-names>J.</given-names></string-name>, <string-name><surname>Adiconis</surname><given-names>X.</given-names></string-name>, <string-name><surname>Simmons</surname><given-names>S.K.</given-names></string-name>, <string-name><surname>Kowalczyk</surname><given-names>M.S.</given-names></string-name>, <string-name><surname>Hession</surname><given-names>C.C.</given-names></string-name>, <string-name><surname>Marjanovic</surname><given-names>N.D.</given-names></string-name>, <string-name><surname>Hughes</surname><given-names>T.K.</given-names></string-name>, <string-name><surname>Wadsworth</surname><given-names>M.H.</given-names></string-name>, <string-name><surname>Burks</surname><given-names>T.</given-names></string-name>, <string-name><surname>Nguyen</surname><given-names>L.T.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Author correction: systematic comparison of single-cell and single-nucleus RNA-sequencing methods</article-title>. <source>Nat. Biotechnol.</source><year>2020</year>; <volume>38</volume>:<fpage>756</fpage>.</mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Han</surname><given-names>X.</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Fei</surname><given-names>L.</given-names></string-name>, <string-name><surname>Sun</surname><given-names>H.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>R.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>H.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>J.</given-names></string-name>, <string-name><surname>Tang</surname><given-names>H.</given-names></string-name>, <string-name><surname>Ge</surname><given-names>W.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Construction of a human cell landscape at single-cell level</article-title>. <source>Nature</source>. <year>2020</year>; <volume>581</volume>:<fpage>303</fpage>–<lpage>309</lpage>.<pub-id pub-id-type="pmid">32214235</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Han</surname><given-names>X.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>R.</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Fei</surname><given-names>L.</given-names></string-name>, <string-name><surname>Sun</surname><given-names>H.</given-names></string-name>, <string-name><surname>Lai</surname><given-names>S.</given-names></string-name>, <string-name><surname>Saadatpour</surname><given-names>A.</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>H.</given-names></string-name>, <string-name><surname>Ye</surname><given-names>F.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Mapping the mouse cell atlas by microwell-seq</article-title>. <source>Cell</source>. <year>2018</year>; <volume>172</volume>:<fpage>1091</fpage>–<lpage>1107</lpage>.<pub-id pub-id-type="pmid">29474909</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aran</surname><given-names>D.</given-names></string-name>, <string-name><surname>Looney</surname><given-names>A.P.</given-names></string-name>, <string-name><surname>Liu</surname><given-names>L.</given-names></string-name>, <string-name><surname>Wu</surname><given-names>E.</given-names></string-name>, <string-name><surname>Fong</surname><given-names>V.</given-names></string-name>, <string-name><surname>Hsu</surname><given-names>A.</given-names></string-name>, <string-name><surname>Chak</surname><given-names>S.</given-names></string-name>, <string-name><surname>Naikawadi</surname><given-names>R.P.</given-names></string-name>, <string-name><surname>Wolters</surname><given-names>P.J.</given-names></string-name>, <string-name><surname>Abate</surname><given-names>A.R.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Reference-based analysis of lung single-cell sequencing reveals a transitional profibrotic macrophage</article-title>. <source>Nat. Immunol.</source><year>2019</year>; <volume>20</volume>:<fpage>163</fpage>–<lpage>172</lpage>.<pub-id pub-id-type="pmid">30643263</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiselev</surname><given-names>V.Y.</given-names></string-name>, <string-name><surname>Yiu</surname><given-names>A.</given-names></string-name>, <string-name><surname>Hemberg</surname><given-names>M.</given-names></string-name></person-group><article-title>scmap: projection of single-cell RNA-seq data across data sets</article-title>. <source>Nat. Methods</source>. <year>2018</year>; <volume>15</volume>:<fpage>359</fpage>–<lpage>362</lpage>.<pub-id pub-id-type="pmid">29608555</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>C.</given-names></string-name>, <string-name><surname>Liu</surname><given-names>B.</given-names></string-name>, <string-name><surname>Kang</surname><given-names>B.</given-names></string-name>, <string-name><surname>Liu</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Liu</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>C.</given-names></string-name>, <string-name><surname>Ren</surname><given-names>X.</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Z.</given-names></string-name></person-group><article-title>SciBet as a portable and fast single cell type identifier</article-title>. <source>Nat. Commun.</source><year>2020</year>; <volume>11</volume>:<fpage>1818</fpage>.<pub-id pub-id-type="pmid">32286268</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>de Kanter</surname><given-names>J.K.</given-names></string-name>, <string-name><surname>Lijnzaad</surname><given-names>P.</given-names></string-name>, <string-name><surname>Candelli</surname><given-names>T.</given-names></string-name>, <string-name><surname>Margaritis</surname><given-names>T.</given-names></string-name>, <string-name><surname>Holstege</surname><given-names>F.C.P.</given-names></string-name></person-group><article-title>CHETAH: a selective, hierarchical cell type identification method for single-cell RNA sequencing</article-title>. <source>Nucleic Acids Res.</source><year>2019</year>; <volume>47</volume>:<fpage>e95</fpage>.<pub-id pub-id-type="pmid">31226206</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Cao</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Kim</surname><given-names>H.J.</given-names></string-name>, <string-name><surname>Salim</surname><given-names>A.</given-names></string-name>, <string-name><surname>Speed</surname><given-names>T.P.</given-names></string-name>, <string-name><surname>Lin</surname><given-names>D.M.</given-names></string-name>, <string-name><surname>Yang</surname><given-names>P.</given-names></string-name>, <string-name><surname>Yang</surname><given-names>J.Y.H.</given-names></string-name></person-group><article-title>scClassify: sample size estimation and multiscale classification of cells using single and multiple reference</article-title>. <source>Mol. Syst. Biol.</source><year>2020</year>; <volume>16</volume>:<fpage>e9389</fpage>.<pub-id pub-id-type="pmid">32567229</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alquicira-Hernandez</surname><given-names>J.</given-names></string-name>, <string-name><surname>Sathe</surname><given-names>A.</given-names></string-name>, <string-name><surname>Ji</surname><given-names>H.P.</given-names></string-name>, <string-name><surname>Nguyen</surname><given-names>Q.</given-names></string-name>, <string-name><surname>Powell</surname><given-names>J.E.</given-names></string-name></person-group><article-title>scPred: accurate supervised method for cell-type classification from single-cell RNA-seq data</article-title>. <source>Genome Biol.</source><year>2019</year>; <volume>20</volume>:<fpage>264</fpage>.<pub-id pub-id-type="pmid">31829268</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tan</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Cahan</surname><given-names>P.</given-names></string-name></person-group><article-title>SingleCellNet: a computational tool to classify single cell RNA-Seq data across platforms and across species</article-title>. <source>Cell Syst.</source><year>2019</year>; <volume>9</volume>:<fpage>207</fpage>–<lpage>213</lpage>.<pub-id pub-id-type="pmid">31377170</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Boufea</surname><given-names>K.</given-names></string-name>, <string-name><surname>Seth</surname><given-names>S.</given-names></string-name>, <string-name><surname>Batada</surname><given-names>N.N.</given-names></string-name></person-group><article-title>scID uses discriminant analysis to identify transcriptionally equivalent cell types across single-cell RNA-Seq data with batch effect</article-title>. <source>Iscience</source>. <year>2020</year>; <volume>23</volume>:<fpage>100914</fpage>.<pub-id pub-id-type="pmid">32151972</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lieberman</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Rokach</surname><given-names>L.</given-names></string-name>, <string-name><surname>Shay</surname><given-names>T.</given-names></string-name></person-group><article-title>Correction: castle - Classification of single cells by transfer learning: harnessing the power of publicly available single cell RNA sequencing experiments to annotate new experiments</article-title>. <source>PLoS One</source>. <year>2018</year>; <volume>13</volume>:<fpage>e0208349</fpage>.<pub-id pub-id-type="pmid">30481223</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pedregosa</surname><given-names>F.</given-names></string-name>, <string-name><surname>Varoquaux</surname><given-names>G.</given-names></string-name>, <string-name><surname>Gramfort</surname><given-names>A.</given-names></string-name>, <string-name><surname>Michel</surname><given-names>V.</given-names></string-name>, <string-name><surname>Thirion</surname><given-names>B.</given-names></string-name>, <string-name><surname>Grisel</surname><given-names>O.</given-names></string-name>, <string-name><surname>Blondel</surname><given-names>M.</given-names></string-name>, <string-name><surname>Prettenhofer</surname><given-names>P.</given-names></string-name>, <string-name><surname>Weiss</surname><given-names>R.</given-names></string-name>, <string-name><surname>Dubourg</surname><given-names>V.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Scikit-learn: machine learning in python</article-title>. <source>J. Mach. Learn Res.</source><year>2011</year>; <volume>12</volume>:<fpage>2825</fpage>–<lpage>2830</lpage>.</mixed-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hao</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Hao</surname><given-names>S.</given-names></string-name>, <string-name><surname>Andersen-Nissen</surname><given-names>E.</given-names></string-name>, <string-name><surname>Mauck</surname><given-names>W.M.</given-names><suffix>3rd</suffix></string-name>, <string-name><surname>Zheng</surname><given-names>S.</given-names></string-name>, <string-name><surname>Butler</surname><given-names>A.</given-names></string-name>, <string-name><surname>Lee</surname><given-names>M.J.</given-names></string-name>, <string-name><surname>Wilk</surname><given-names>A.J.</given-names></string-name>, <string-name><surname>Darby</surname><given-names>C.</given-names></string-name>, <string-name><surname>Zager</surname><given-names>M.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Integrated analysis of multimodal single-cell data</article-title>. <source>Cell</source>. <year>2021</year>; <volume>184</volume>:<fpage>3573</fpage>–<lpage>3587</lpage>.<pub-id pub-id-type="pmid">34062119</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>L.</given-names></string-name>, <string-name><surname>He</surname><given-names>Q.</given-names></string-name>, <string-name><surname>Zhai</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Deng</surname><given-names>M.</given-names></string-name></person-group><article-title>Single-cell RNA-seq data semi-supervised clustering and annotation via structural regularized domain adaptation</article-title>. <source>Bioinformatics</source>. <year>2021</year>; <volume>37</volume>:<fpage>775</fpage>–<lpage>784</lpage>.<pub-id pub-id-type="pmid">33098418</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wei</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>S.</given-names></string-name></person-group><article-title>CALLR: a semi-supervised cell-type annotation method for single-cell RNA sequencing data</article-title>. <source>Bioinformatics</source>. <year>2021</year>; <volume>37</volume>:<fpage>i51</fpage>–<lpage>i58</lpage>.<pub-id pub-id-type="pmid">34252936</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Smyth</surname><given-names>G.K.</given-names></string-name></person-group><article-title>Linear models and empirical bayes methods for assessing differential expression in microarray experiments</article-title>. <source>Stat. Appl. Genet. Mol. Biol.</source><year>2004</year>; <volume>3</volume>:<fpage>Article3</fpage>.<pub-id pub-id-type="pmid">16646809</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Risso</surname><given-names>D.</given-names></string-name>, <string-name><surname>Ngai</surname><given-names>J.</given-names></string-name>, <string-name><surname>Speed</surname><given-names>T.P.</given-names></string-name>, <string-name><surname>Dudoit</surname><given-names>S.</given-names></string-name></person-group><article-title>Normalization of RNA-seq data using factor analysis of control genes or samples</article-title>. <source>Nat. Biotechnol.</source><year>2014</year>; <volume>32</volume>:<fpage>896</fpage>–<lpage>902</lpage>.<pub-id pub-id-type="pmid">25150836</pub-id></mixed-citation>
    </ref>
    <ref id="B24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abbas-Aghababazadeh</surname><given-names>F.</given-names></string-name>, <string-name><surname>Li</surname><given-names>Q.</given-names></string-name>, <string-name><surname>Fridley</surname><given-names>B.L.</given-names></string-name></person-group><article-title>Comparison of normalization approaches for gene expression studies completed with high-throughput sequencing</article-title>. <source>PLoS One</source>. <year>2018</year>; <volume>13</volume>:<fpage>e0206312</fpage>.<pub-id pub-id-type="pmid">30379879</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Butler</surname><given-names>A.</given-names></string-name>, <string-name><surname>Hoffman</surname><given-names>P.</given-names></string-name>, <string-name><surname>Smibert</surname><given-names>P.</given-names></string-name>, <string-name><surname>Papalexi</surname><given-names>E.</given-names></string-name>, <string-name><surname>Satija</surname><given-names>R.</given-names></string-name></person-group><article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>. <source>Nat. Biotechnol.</source><year>2018</year>; <volume>36</volume>:<fpage>411</fpage>–<lpage>420</lpage>.<pub-id pub-id-type="pmid">29608179</pub-id></mixed-citation>
    </ref>
    <ref id="B26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fraley</surname><given-names>C.</given-names></string-name>, <string-name><surname>Raftery</surname><given-names>A.E.</given-names></string-name></person-group><article-title>MCLUST: software for model-based cluster analysis</article-title>. <source>J. Classif</source>. <year>2014</year>; <volume>16</volume>:<fpage>297</fpage>–<lpage>306</lpage>.</mixed-citation>
    </ref>
    <ref id="B27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zeisel</surname><given-names>A.</given-names></string-name>, <string-name><surname>Munoz-Manchado</surname><given-names>A.B.</given-names></string-name>, <string-name><surname>Codeluppi</surname><given-names>S.</given-names></string-name>, <string-name><surname>Lonnerberg</surname><given-names>P.</given-names></string-name>, <string-name><surname>La Manno</surname><given-names>G.</given-names></string-name>, <string-name><surname>Jureus</surname><given-names>A.</given-names></string-name>, <string-name><surname>Marques</surname><given-names>S.</given-names></string-name>, <string-name><surname>Munguba</surname><given-names>H.</given-names></string-name>, <string-name><surname>He</surname><given-names>L.</given-names></string-name>, <string-name><surname>Betsholtz</surname><given-names>C.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Brain structure. Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq</article-title>. <source>Science</source>. <year>2015</year>; <volume>347</volume>:<fpage>1138</fpage>–<lpage>1142</lpage>.<pub-id pub-id-type="pmid">25700174</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tasic</surname><given-names>B.</given-names></string-name>, <string-name><surname>Yao</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Graybuck</surname><given-names>L.T.</given-names></string-name>, <string-name><surname>Smith</surname><given-names>K.A.</given-names></string-name>, <string-name><surname>Nguyen</surname><given-names>T.N.</given-names></string-name>, <string-name><surname>Bertagnolli</surname><given-names>D.</given-names></string-name>, <string-name><surname>Goldy</surname><given-names>J.</given-names></string-name>, <string-name><surname>Garren</surname><given-names>E.</given-names></string-name>, <string-name><surname>Economo</surname><given-names>M.N.</given-names></string-name>, <string-name><surname>Viswanathan</surname><given-names>S.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Shared and distinct transcriptomic cell types across neocortical areas</article-title>. <source>Nature</source>. <year>2018</year>; <volume>563</volume>:<fpage>72</fpage>–<lpage>78</lpage>.<pub-id pub-id-type="pmid">30382198</pub-id></mixed-citation>
    </ref>
    <ref id="B29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Campbell</surname><given-names>J.N.</given-names></string-name>, <string-name><surname>Macosko</surname><given-names>E.Z.</given-names></string-name>, <string-name><surname>Fenselau</surname><given-names>H.</given-names></string-name>, <string-name><surname>Pers</surname><given-names>T.H.</given-names></string-name>, <string-name><surname>Lyubetskaya</surname><given-names>A.</given-names></string-name>, <string-name><surname>Tenen</surname><given-names>D.</given-names></string-name>, <string-name><surname>Goldman</surname><given-names>M.</given-names></string-name>, <string-name><surname>Verstegen</surname><given-names>A.M.</given-names></string-name>, <string-name><surname>Resch</surname><given-names>J.M.</given-names></string-name>, <string-name><surname>McCarroll</surname><given-names>S.A.</given-names></string-name><etal>et al</etal>.</person-group><article-title>A molecular census of arcuate hypothalamus and median eminence cell types</article-title>. <source>Nat. Neurosci.</source><year>2017</year>; <volume>20</volume>:<fpage>484</fpage>–<lpage>496</lpage>.<pub-id pub-id-type="pmid">28166221</pub-id></mixed-citation>
    </ref>
    <ref id="B30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hochgerner</surname><given-names>H.</given-names></string-name>, <string-name><surname>Zeisel</surname><given-names>A.</given-names></string-name>, <string-name><surname>Lonnerberg</surname><given-names>P.</given-names></string-name>, <string-name><surname>Linnarsson</surname><given-names>S.</given-names></string-name></person-group><article-title>Conserved properties of dentate gyrus neurogenesis across postnatal development revealed by single-cell RNA sequencing</article-title>. <source>Nat. Neurosci.</source><year>2018</year>; <volume>21</volume>:<fpage>290</fpage>–<lpage>299</lpage>.<pub-id pub-id-type="pmid">29335606</pub-id></mixed-citation>
    </ref>
    <ref id="B31">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mizrak</surname><given-names>D.</given-names></string-name>, <string-name><surname>Levitin</surname><given-names>H.M.</given-names></string-name>, <string-name><surname>Delgado</surname><given-names>A.C.</given-names></string-name>, <string-name><surname>Crotet</surname><given-names>V.</given-names></string-name>, <string-name><surname>Yuan</surname><given-names>J.</given-names></string-name>, <string-name><surname>Chaker</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Silva-Vargas</surname><given-names>V.</given-names></string-name>, <string-name><surname>Sims</surname><given-names>P.A.</given-names></string-name>, <string-name><surname>Doetsch</surname><given-names>F.</given-names></string-name></person-group><article-title>Single-Cell analysis of regional differences in adult V-SVZ neural stem cell lineages</article-title>. <source>Cell Rep.</source><year>2019</year>; <volume>26</volume>:<fpage>394</fpage>–<lpage>406</lpage>.<pub-id pub-id-type="pmid">30625322</pub-id></mixed-citation>
    </ref>
    <ref id="B32">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Haber</surname><given-names>A.L.</given-names></string-name>, <string-name><surname>Biton</surname><given-names>M.</given-names></string-name>, <string-name><surname>Rogel</surname><given-names>N.</given-names></string-name>, <string-name><surname>Herbst</surname><given-names>R.H.</given-names></string-name>, <string-name><surname>Shekhar</surname><given-names>K.</given-names></string-name>, <string-name><surname>Smillie</surname><given-names>C.</given-names></string-name>, <string-name><surname>Burgin</surname><given-names>G.</given-names></string-name>, <string-name><surname>Delorey</surname><given-names>T.M.</given-names></string-name>, <string-name><surname>Howitt</surname><given-names>M.R.</given-names></string-name>, <string-name><surname>Katz</surname><given-names>Y.</given-names></string-name><etal>et al</etal>.</person-group><article-title>A single-cell survey of the small intestinal epithelium</article-title>. <source>Nature</source>. <year>2017</year>; <volume>551</volume>:<fpage>333</fpage>–<lpage>339</lpage>.<pub-id pub-id-type="pmid">29144463</pub-id></mixed-citation>
    </ref>
    <ref id="B33">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Muraro</surname><given-names>M.J.</given-names></string-name>, <string-name><surname>Dharmadhikari</surname><given-names>G.</given-names></string-name>, <string-name><surname>Grun</surname><given-names>D.</given-names></string-name>, <string-name><surname>Groen</surname><given-names>N.</given-names></string-name>, <string-name><surname>Dielen</surname><given-names>T.</given-names></string-name>, <string-name><surname>Jansen</surname><given-names>E.</given-names></string-name>, <string-name><surname>van Gurp</surname><given-names>L.</given-names></string-name>, <string-name><surname>Engelse</surname><given-names>M.A.</given-names></string-name>, <string-name><surname>Carlotti</surname><given-names>F.</given-names></string-name>, <string-name><surname>de Koning</surname><given-names>E.J.</given-names></string-name><etal>et al</etal>.</person-group><article-title>A single-cell transcriptome atlas of the human pancreas</article-title>. <source>Cell Syst.</source><year>2016</year>; <volume>3</volume>:<fpage>385</fpage>–<lpage>394</lpage>.<pub-id pub-id-type="pmid">27693023</pub-id></mixed-citation>
    </ref>
    <ref id="B34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xin</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Kim</surname><given-names>J.</given-names></string-name>, <string-name><surname>Okamoto</surname><given-names>H.</given-names></string-name>, <string-name><surname>Ni</surname><given-names>M.</given-names></string-name>, <string-name><surname>Wei</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Adler</surname><given-names>C.</given-names></string-name>, <string-name><surname>Murphy</surname><given-names>A.J.</given-names></string-name>, <string-name><surname>Yancopoulos</surname><given-names>G.D.</given-names></string-name>, <string-name><surname>Lin</surname><given-names>C.</given-names></string-name>, <string-name><surname>Gromada</surname><given-names>J.</given-names></string-name></person-group><article-title>RNA sequencing of single human islet cells reveals type 2 diabetes genes</article-title>. <source>Cell Metab.</source><year>2016</year>; <volume>24</volume>:<fpage>608</fpage>–<lpage>615</lpage>.<pub-id pub-id-type="pmid">27667665</pub-id></mixed-citation>
    </ref>
    <ref id="B35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Segerstolpe</surname><given-names>A.</given-names></string-name>, <string-name><surname>Palasantza</surname><given-names>A.</given-names></string-name>, <string-name><surname>Eliasson</surname><given-names>P.</given-names></string-name>, <string-name><surname>Andersson</surname><given-names>E.M.</given-names></string-name>, <string-name><surname>Andreasson</surname><given-names>A.C.</given-names></string-name>, <string-name><surname>Sun</surname><given-names>X.</given-names></string-name>, <string-name><surname>Picelli</surname><given-names>S.</given-names></string-name>, <string-name><surname>Sabirsh</surname><given-names>A.</given-names></string-name>, <string-name><surname>Clausen</surname><given-names>M.</given-names></string-name>, <string-name><surname>Bjursell</surname><given-names>M.K.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Single-Cell transcriptome profiling of human pancreatic islets in health and type 2 diabetes</article-title>. <source>Cell Metab.</source><year>2016</year>; <volume>24</volume>:<fpage>593</fpage>–<lpage>607</lpage>.<pub-id pub-id-type="pmid">27667667</pub-id></mixed-citation>
    </ref>
    <ref id="B36">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>G.X.</given-names></string-name>, <string-name><surname>Terry</surname><given-names>J.M.</given-names></string-name>, <string-name><surname>Belgrader</surname><given-names>P.</given-names></string-name>, <string-name><surname>Ryvkin</surname><given-names>P.</given-names></string-name>, <string-name><surname>Bent</surname><given-names>Z.W.</given-names></string-name>, <string-name><surname>Wilson</surname><given-names>R.</given-names></string-name>, <string-name><surname>Ziraldo</surname><given-names>S.B.</given-names></string-name>, <string-name><surname>Wheeler</surname><given-names>T.D.</given-names></string-name>, <string-name><surname>McDermott</surname><given-names>G.P.</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>J.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Massively parallel digital transcriptional profiling of single cells</article-title>. <source>Nat. Commun.</source><year>2017</year>; <volume>8</volume>:<fpage>14049</fpage>.<pub-id pub-id-type="pmid">28091601</pub-id></mixed-citation>
    </ref>
    <ref id="B37">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tian</surname><given-names>L.</given-names></string-name>, <string-name><surname>Dong</surname><given-names>X.</given-names></string-name>, <string-name><surname>Freytag</surname><given-names>S.</given-names></string-name>, <string-name><surname>Le Cao</surname><given-names>K.A.</given-names></string-name>, <string-name><surname>Su</surname><given-names>S.</given-names></string-name>, <string-name><surname>JalalAbadi</surname><given-names>A.</given-names></string-name>, <string-name><surname>Amann-Zalcenstein</surname><given-names>D.</given-names></string-name>, <string-name><surname>Weber</surname><given-names>T.S.</given-names></string-name>, <string-name><surname>Seidi</surname><given-names>A.</given-names></string-name>, <string-name><surname>Jabbari</surname><given-names>J.S.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Benchmarking single cell RNA-sequencing analysis pipelines using mixture control experiments</article-title>. <source>Nat. Methods</source>. <year>2019</year>; <volume>16</volume>:<fpage>479</fpage>–<lpage>487</lpage>.<pub-id pub-id-type="pmid">31133762</pub-id></mixed-citation>
    </ref>
    <ref id="B38">
      <label>38.</label>
      <mixed-citation publication-type="journal"><article-title>Single-cell transcriptomics of 20 mouse organs creates a tabula muris</article-title>. <source>Nature</source>. <year>2018</year>; <volume>562</volume>:<fpage>367</fpage>–<lpage>372</lpage>.<pub-id pub-id-type="pmid">30283141</pub-id></mixed-citation>
    </ref>
    <ref id="B39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tran</surname><given-names>H.T.N.</given-names></string-name>, <string-name><surname>Ang</surname><given-names>K.S.</given-names></string-name>, <string-name><surname>Chevrier</surname><given-names>M.</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>X.</given-names></string-name>, <string-name><surname>Lee</surname><given-names>N.Y.S.</given-names></string-name>, <string-name><surname>Goh</surname><given-names>M.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>J.</given-names></string-name></person-group><article-title>A benchmark of batch-effect correction methods for single-cell RNA sequencing data</article-title>. <source>Genome Biol.</source><year>2020</year>; <volume>21</volume>:<fpage>12</fpage>.<pub-id pub-id-type="pmid">31948481</pub-id></mixed-citation>
    </ref>
    <ref id="B40">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abdelaal</surname><given-names>T.</given-names></string-name>, <string-name><surname>Michielsen</surname><given-names>L.</given-names></string-name>, <string-name><surname>Cats</surname><given-names>D.</given-names></string-name>, <string-name><surname>Hoogduin</surname><given-names>D.</given-names></string-name>, <string-name><surname>Mei</surname><given-names>H.</given-names></string-name>, <string-name><surname>Reinders</surname><given-names>M.J.T.</given-names></string-name>, <string-name><surname>Mahfouz</surname><given-names>A.</given-names></string-name></person-group><article-title>A comparison of automatic cell identification methods for single-cell RNA sequencing data</article-title>. <source>Genome Biol.</source><year>2019</year>; <volume>20</volume>:<fpage>194</fpage>.<pub-id pub-id-type="pmid">31500660</pub-id></mixed-citation>
    </ref>
    <ref id="B41">
      <label>41.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhao</surname><given-names>X.</given-names></string-name>, <string-name><surname>Wu</surname><given-names>S.</given-names></string-name>, <string-name><surname>Fang</surname><given-names>N.</given-names></string-name>, <string-name><surname>Sun</surname><given-names>X.</given-names></string-name>, <string-name><surname>Fan</surname><given-names>J.</given-names></string-name></person-group><article-title>Evaluation of single-cell classifiers for single-cell RNA sequencing data sets</article-title>. <source>Brief. Bioinform.</source><year>2020</year>; <volume>21</volume>:<fpage>1581</fpage>–<lpage>1595</lpage>.<pub-id pub-id-type="pmid">31675098</pub-id></mixed-citation>
    </ref>
    <ref id="B42">
      <label>42.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Diaz-Mejia</surname><given-names>J.J.</given-names></string-name>, <string-name><surname>Meng</surname><given-names>E.C.</given-names></string-name>, <string-name><surname>Pico</surname><given-names>A.R.</given-names></string-name>, <string-name><surname>MacParland</surname><given-names>S.A.</given-names></string-name>, <string-name><surname>Ketela</surname><given-names>T.</given-names></string-name>, <string-name><surname>Pugh</surname><given-names>T.J.</given-names></string-name>, <string-name><surname>Bader</surname><given-names>G.D.</given-names></string-name>, <string-name><surname>Morris</surname><given-names>J.H.</given-names></string-name></person-group><article-title>Evaluation of methods to assign cell type labels to cell clusters from single-cell RNA-sequencing data</article-title>. <source>F1000Res</source>. <year>2019</year>; <volume>8</volume>:<fpage>296</fpage>.</mixed-citation>
    </ref>
    <ref id="B43">
      <label>43.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Romanov</surname><given-names>R.A.</given-names></string-name>, <string-name><surname>Zeisel</surname><given-names>A.</given-names></string-name>, <string-name><surname>Bakker</surname><given-names>J.</given-names></string-name>, <string-name><surname>Girach</surname><given-names>F.</given-names></string-name>, <string-name><surname>Hellysaz</surname><given-names>A.</given-names></string-name>, <string-name><surname>Tomer</surname><given-names>R.</given-names></string-name>, <string-name><surname>Alpar</surname><given-names>A.</given-names></string-name>, <string-name><surname>Mulder</surname><given-names>J.</given-names></string-name>, <string-name><surname>Clotman</surname><given-names>F.</given-names></string-name>, <string-name><surname>Keimpema</surname><given-names>E.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Molecular interrogation of hypothalamic organization reveals distinct dopamine neuronal subtypes</article-title>. <source>Nat. Neurosci.</source><year>2017</year>; <volume>20</volume>:<fpage>176</fpage>–<lpage>188</lpage>.<pub-id pub-id-type="pmid">27991900</pub-id></mixed-citation>
    </ref>
    <ref id="B44">
      <label>44.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schwartz</surname><given-names>M.Z.</given-names></string-name>, <string-name><surname>Choi</surname><given-names>R.S.</given-names></string-name>, <string-name><surname>Doolin</surname><given-names>E.</given-names></string-name>, <string-name><surname>Shockett</surname><given-names>E.</given-names></string-name></person-group><article-title>Studies of brush border enzymes, basement membrane components, and electrophysiology of tissue-engineered neointestine - Discussion</article-title>. <source>J. Pediatr. Surg.</source><year>1998</year>; <volume>33</volume>:<fpage>996</fpage>–<lpage>997</lpage>.</mixed-citation>
    </ref>
    <ref id="B45">
      <label>45.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gassler</surname><given-names>N.</given-names></string-name>, <string-name><surname>Newrzella</surname><given-names>D.</given-names></string-name>, <string-name><surname>Bohm</surname><given-names>C.</given-names></string-name>, <string-name><surname>Lyer</surname><given-names>S.</given-names></string-name>, <string-name><surname>Li</surname><given-names>L.</given-names></string-name>, <string-name><surname>Sorgenfrei</surname><given-names>O.</given-names></string-name>, <string-name><surname>van Laer</surname><given-names>L.</given-names></string-name>, <string-name><surname>Sido</surname><given-names>B.</given-names></string-name>, <string-name><surname>Mollenhauer</surname><given-names>J.</given-names></string-name>, <string-name><surname>Poustka</surname><given-names>A.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Molecular characterisation of non-absorptive and absorptive enterocytes in human small intestine</article-title>. <source>Gut</source>. <year>2006</year>; <volume>55</volume>:<fpage>1084</fpage>–<lpage>1089</lpage>.<pub-id pub-id-type="pmid">16556670</pub-id></mixed-citation>
    </ref>
    <ref id="B46">
      <label>46.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Afroze</surname><given-names>S.</given-names></string-name>, <string-name><surname>Meng</surname><given-names>F.</given-names></string-name>, <string-name><surname>Jensen</surname><given-names>K.</given-names></string-name>, <string-name><surname>McDaniel</surname><given-names>K.</given-names></string-name>, <string-name><surname>Rahal</surname><given-names>K.</given-names></string-name>, <string-name><surname>Onori</surname><given-names>P.</given-names></string-name>, <string-name><surname>Gaudio</surname><given-names>E.</given-names></string-name>, <string-name><surname>Alpini</surname><given-names>G.</given-names></string-name>, <string-name><surname>Glaser</surname><given-names>S.S.</given-names></string-name></person-group><article-title>The physiological roles of secretin and its receptor</article-title>. <source>Ann. Transl. Med.</source><year>2013</year>; <volume>1</volume>:<fpage>29</fpage>.<pub-id pub-id-type="pmid">25332973</pub-id></mixed-citation>
    </ref>
    <ref id="B47">
      <label>47.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Allam</surname><given-names>A.</given-names></string-name>, <string-name><surname>Thomsen</surname><given-names>A.R.</given-names></string-name>, <string-name><surname>Gothwal</surname><given-names>M.</given-names></string-name>, <string-name><surname>Saha</surname><given-names>D.</given-names></string-name>, <string-name><surname>Maurer</surname><given-names>J.</given-names></string-name>, <string-name><surname>Brunner</surname><given-names>T.B.</given-names></string-name></person-group><article-title>Pancreatic stellate cells in pancreatic cancer: in focus</article-title>. <source>Pancreatology</source>. <year>2017</year>; <volume>17</volume>:<fpage>514</fpage>–<lpage>522</lpage>.<pub-id pub-id-type="pmid">28601475</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
