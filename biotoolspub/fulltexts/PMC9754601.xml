<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle pcbi.1010753.r001?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9754601</article-id>
    <article-id pub-id-type="pmid">36469543</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010753</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-22-01465</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Mathematical and Statistical Techniques</subject>
          <subj-group>
            <subject>Cluster Analysis</subject>
            <subj-group>
              <subject>Consensus Clustering</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Mathematical and Statistical Techniques</subject>
          <subj-group>
            <subject>Cluster Analysis</subject>
            <subj-group>
              <subject>Spectral Clustering</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Data Visualization</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
              <subj-group>
                <subject>Clustering Algorithms</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
            <subj-group>
              <subject>Clustering Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Algebra</subject>
            <subj-group>
              <subject>Linear Algebra</subject>
              <subj-group>
                <subject>Eigenvalues</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Preprocessing</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Preprocessing</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Expression</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Secuer: Ultrafast, scalable and accurate clustering of single-cell RNA-seq data</article-title>
      <alt-title alt-title-type="running-head">Ultrafast clustering of single-cell RNA-seq data</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Wei</surname>
          <given-names>Nana</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nie</surname>
          <given-names>Yating</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9883-7962</contrib-id>
        <name>
          <surname>Liu</surname>
          <given-names>Lin</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1832-4404</contrib-id>
        <name>
          <surname>Zheng</surname>
          <given-names>Xiaoqi</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Wu</surname>
          <given-names>Hua-Jun</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Mathematics, Shanghai Normal University, Shanghai, China</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Institute of Natural Sciences, MOE-LSC, School of Mathematical Sciences, CMA-Shanghai, SJTU-Yale Joint Center for Biostatistics and Data Science, Shanghai Jiao Tong University and Shanghai Artificial Intelligence Laboratory, Shanghai, China</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Center for Single-Cell Omics, School of Public Health, Shanghai Jiao Tong University School of Medicine, Shanghai, China</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Center for Precision Medicine Multi-Omics Research, School of Basic Medical Sciences, Peking University Health Science Center and Peking University Cancer Hospital and Institute, Beijing, China</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Ioshikhes</surname>
          <given-names>Ilya</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>CANADA</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>linliu@sjtu.edu.cn</email> (LL); <email>xqzheng@shsmu.edu.cn</email> (XZ); <email>hjwu@pku.edu.cn</email> (HJW).</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <volume>18</volume>
    <issue>12</issue>
    <elocation-id>e1010753</elocation-id>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>11</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2022 Wei et al</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Wei et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1010753.pdf"/>
    <abstract>
      <p>Identifying cell clusters is a critical step for single-cell transcriptomics study. Despite the numerous clustering tools developed recently, the rapid growth of scRNA-seq volumes prompts for a more (computationally) efficient clustering method. Here, we introduce Secuer, a Scalable and Efficient speCtral clUstERing algorithm for scRNA-seq data. By employing an anchor-based bipartite graph representation algorithm, Secuer enjoys reduced runtime and memory usage over one order of magnitude for datasets with more than 1 million cells. Meanwhile, Secuer also achieves better or comparable accuracy than competing methods in small and moderate benchmark datasets. Furthermore, we showcase that Secuer can also serve as a building block for a new consensus clustering method, Secuer-consensus, which again improves the runtime and scalability of state-of-the-art consensus clustering methods while also maintaining the accuracy. Overall, Secuer is a versatile, accurate, and scalable clustering framework suitable for small to ultra-large single-cell clustering tasks.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Recently, single-cell RNA sequencing (scRNA-seq) has enabled profiling of thousands to millions of cells, spurring the development of efficient clustering algorithms for large or ultra-large datasets. In this work, we developed an ultrafast clustering method, Secuer, for small to ultra-large scRNA-seq data. Using simulation and real datasets, we demonstrated that Secuer yields high accuracy, while saving runtime and memory usage by orders of magnitude, and that it can be efficiently scaled up to ultra-large datasets. Additionally, with Secuer as a subroutine, we proposed Secuer-consensus, a consensus clustering algorithm. Our results show that Secuer-consensus performs better in terms of clustering accuracy and runtime.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution>National Key R&amp;D Program of China</institution>
        </funding-source>
        <award-id>2018YFA0900600</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1832-4404</contrib-id>
          <name>
            <surname>Zheng</surname>
            <given-names>Xiaoqi</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100012226</institution-id>
            <institution>Fundamental Research Funds for the Central Universities</institution>
          </institution-wrap>
        </funding-source>
        <award-id>PKU2022LCXQ027</award-id>
        <principal-award-recipient>
          <name>
            <surname>Wu</surname>
            <given-names>Hua-Jun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100012226</institution-id>
            <institution>Fundamental Research Funds for the Central Universities</institution>
          </institution-wrap>
        </funding-source>
        <award-id>BMU2021YJ064</award-id>
        <principal-award-recipient>
          <name>
            <surname>Wu</surname>
            <given-names>Hua-Jun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100012226</institution-id>
            <institution>Fundamental Research Funds for the Central Universities</institution>
          </institution-wrap>
        </funding-source>
        <award-id>WF220441912</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9883-7962</contrib-id>
          <name>
            <surname>Liu</surname>
            <given-names>Lin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award005">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>61572327</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1832-4404</contrib-id>
          <name>
            <surname>Zheng</surname>
            <given-names>Xiaoqi</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award006">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>61972257</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1832-4404</contrib-id>
          <name>
            <surname>Zheng</surname>
            <given-names>Xiaoqi</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award007">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>12090024</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9883-7962</contrib-id>
          <name>
            <surname>Liu</surname>
            <given-names>Lin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award008">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>12101397</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9883-7962</contrib-id>
          <name>
            <surname>Liu</surname>
            <given-names>Lin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award009">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>32270683</award-id>
        <principal-award-recipient>
          <name>
            <surname>Wu</surname>
            <given-names>Hua-Jun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award010">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100007219</institution-id>
            <institution>Natural Science Foundation of Shanghai</institution>
          </institution-wrap>
        </funding-source>
        <award-id>20JC1413800</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1832-4404</contrib-id>
          <name>
            <surname>Zheng</surname>
            <given-names>Xiaoqi</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award011">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100007219</institution-id>
            <institution>Natural Science Foundation of Shanghai</institution>
          </institution-wrap>
        </funding-source>
        <award-id>21ZR1431000</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9883-7962</contrib-id>
          <name>
            <surname>Liu</surname>
            <given-names>Lin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award012">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100007219</institution-id>
            <institution>Natural Science Foundation of Shanghai</institution>
          </institution-wrap>
        </funding-source>
        <award-id>21JC1402900</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9883-7962</contrib-id>
          <name>
            <surname>Liu</surname>
            <given-names>Lin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award013">
        <funding-source>
          <institution>Shanghai Municipal Science and Technology Major Project</institution>
        </funding-source>
        <award-id>2021SHZDZX0102</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9883-7962</contrib-id>
          <name>
            <surname>Liu</surname>
            <given-names>Lin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award014">
        <funding-source>
          <institution>Pujiang National Lab Grant</institution>
        </funding-source>
        <award-id>P22KN00524</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9883-7962</contrib-id>
          <name>
            <surname>Liu</surname>
            <given-names>Lin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This work was supported by National Key R&amp;D Program of China (2018YFA0900600 to X.Z.); the Fundamental Research Funds for the Central Universities (PKU2022LCXQ027 - Clinical Medicine Plus X - Young Scholars Project, Peking University and BMU2021YJ064 to H.J.W. and Shanghai Jiao Tong University Start-up Grant WF220441912 to L.L.); National Natural Science Foundation of China (61572327 and 61972257 to X.Z., 12090024 and 12101397 to L.L., 32270683 to H.J.W.); Natural Science Foundation of Shanghai (20JC1413800 to X.Z., 21ZR1431000 and 21JC1402900 to L.L.); Shanghai Municipal Science and Technology Major Project (2021SHZDZX0102 to L.L.); Pujiang National Lab Grant (P22KN00524 to L.L.). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="5"/>
      <table-count count="0"/>
      <page-count count="20"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2022-12-15</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The datasets in this study are all publicly available: Biase, Yan, Goolam, Deng, Pollen and Kolodziejczyk (<ext-link xlink:href="https://hemberg-lab.github.io/scRNA.seq.datasets/" ext-link-type="uri">https://hemberg-lab.github.io/scRNA.seq.datasets/</ext-link>), Worm neuron, 10X PBMC, CITE PBMC, and Mouse retain and Human kidney (<ext-link xlink:href="https://github.com/ttgump/scDCC/tree/master/data" ext-link-type="uri">https://github.com/ttgump/scDCC/tree/master/data</ext-link>), TAM FACS (<ext-link xlink:href="https://figshare.com/projects/Tabula_Muris_Senis/64982" ext-link-type="uri">https://figshare.com/projects/Tabula_Muris_Senis/64982</ext-link>), MCA (<ext-link xlink:href="https://figshare.com/articles/dataset/MCA_DGE_Data/5435866" ext-link-type="uri">https://figshare.com/articles/dataset/MCA_DGE_Data/5435866</ext-link>), and COVID19 (GSE158055, <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE158055" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE158055</ext-link>). Python implementation of Secuer is available on GitHub (<ext-link xlink:href="https://github.com/nanawei11/Secuer" ext-link-type="uri">https://github.com/nanawei11/Secuer</ext-link>).</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The datasets in this study are all publicly available: Biase, Yan, Goolam, Deng, Pollen and Kolodziejczyk (<ext-link xlink:href="https://hemberg-lab.github.io/scRNA.seq.datasets/" ext-link-type="uri">https://hemberg-lab.github.io/scRNA.seq.datasets/</ext-link>), Worm neuron, 10X PBMC, CITE PBMC, and Mouse retain and Human kidney (<ext-link xlink:href="https://github.com/ttgump/scDCC/tree/master/data" ext-link-type="uri">https://github.com/ttgump/scDCC/tree/master/data</ext-link>), TAM FACS (<ext-link xlink:href="https://figshare.com/projects/Tabula_Muris_Senis/64982" ext-link-type="uri">https://figshare.com/projects/Tabula_Muris_Senis/64982</ext-link>), MCA (<ext-link xlink:href="https://figshare.com/articles/dataset/MCA_DGE_Data/5435866" ext-link-type="uri">https://figshare.com/articles/dataset/MCA_DGE_Data/5435866</ext-link>), and COVID19 (GSE158055, <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE158055" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE158055</ext-link>). Python implementation of Secuer is available on GitHub (<ext-link xlink:href="https://github.com/nanawei11/Secuer" ext-link-type="uri">https://github.com/nanawei11/Secuer</ext-link>).</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic toggle="yes">PLOS Computational Biology</italic> Methods paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>In the past decade, single-cell RNA sequencing (scRNA-seq) has transformed our understanding of development and disease through profiling the whole transcriptome at the cellular level [<xref rid="pcbi.1010753.ref001" ref-type="bibr">1</xref>,<xref rid="pcbi.1010753.ref002" ref-type="bibr">2</xref>]. It has been widely used to unravel cell-to-cell heterogeneity and gain new biological insights, owing to its ability to identify and characterize cell types in complex tissues [<xref rid="pcbi.1010753.ref003" ref-type="bibr">3</xref>]. Unsupervised clustering approaches have played a central role in determining cell types. However, the scale of scRNA-seq experiments has been rapidly climbing in recent years, amounting to several datasets profiling over 1 million cells [<xref rid="pcbi.1010753.ref004" ref-type="bibr">4</xref>–<xref rid="pcbi.1010753.ref006" ref-type="bibr">6</xref>]. The increasing sample size renders many of the existing scRNA-seq clustering algorithms obsolete and prompts for developing a new generation of clustering algorithms that are efficient and scalable to large (500,000 ~ 5 million cells) or even ultra-large (&gt; 5 million cells) scRNA-seq datasets.</p>
    <p>Currently, two clustering algorithms, Louvain and Leiden, prevail in scRNA-seq analysis and have recently been implemented in numerous tools such as Seurat [<xref rid="pcbi.1010753.ref007" ref-type="bibr">7</xref>] and Scanpy [<xref rid="pcbi.1010753.ref008" ref-type="bibr">8</xref>]. Both algorithms aim to partition a graph into connected subgraphs by iteratively aggregating nodes: Louvain infers clusters by maximizing modularity [<xref rid="pcbi.1010753.ref009" ref-type="bibr">9</xref>], and Leiden is a variant of Louvain by using a local node-moving technique [<xref rid="pcbi.1010753.ref010" ref-type="bibr">10</xref>]. However, both algorithms are not well scaled to ultra-large datasets. For instance, for a dataset consisting of 10 million cells, Louvain and Leiden usually take 45 minutes and more than 1 hour for clustering, and both unreliably and unreasonably overestimate the number of clusters (as many as 1 million, see details in the Results section).</p>
    <p>To address this gap, we present Secuer, a superfast and scalable clustering algorithm for (ultra-)large scRNA-seq data analysis based on spectral clustering. Spectral clustering has been one of the most popular clustering techniques due to its ease of use and flexibility of handling data with complicated shape or distribution [<xref rid="pcbi.1010753.ref011" ref-type="bibr">11</xref>], but with the caveat of high computational cost. We tailor the conventional spectral clustering to large scRNA-seq data based on an idea of representative/landmark selection in U-SPEC [<xref rid="pcbi.1010753.ref012" ref-type="bibr">12</xref>–<xref rid="pcbi.1010753.ref014" ref-type="bibr">14</xref>], leveraging the following three key elements in Secuer: First, we pivot <italic toggle="yes">p</italic> anchors from all <italic toggle="yes">N</italic> cells (<italic toggle="yes">p</italic>≪<italic toggle="yes">N</italic>) and construct a weighted bipartite graph between cells and anchors by a modified approximate <italic toggle="yes">k</italic>-nearest neighbor (MAKNN) algorithm, which greatly accelerates the runtime of our method. Second, we determine the weights of the bipartite graph by a locally scaled Gaussian kernel function to capture the local geometry of the cell-to-anchor similarity network, which improves the accuracy of our method. Third, we design two optional approaches to automatically infer the number of clusters—<italic toggle="yes">K</italic>, which avoids manually choosing some <italic toggle="yes">K</italic> by users.</p>
    <p>We evaluate Secuer against three extensively used methods for scRNA-seq clustering including Louvain, Leiden, and k-means, using 31 simulated datasets with the number of cells ranging from 10,000 to 40 million. Secuer utilizes much shorter runtime than existing methods without deteriorating the clustering accuracy. In particular, Secuer is 5 times faster than k-means and 12 times faster than Louvain/Leiden for ultra-large datasets. Moreover, Secuer infers the number of clusters in the anchor space. The cluster number estimates by Secuer are still accurate when the sample size is larger than 5 million, in which case both Louvain and Leiden fail to produce any reasonable estimates. We then evaluate all the aforementioned methods in 15 real datasets with the number of cells ranging from 49 to 1.46 million (<xref rid="pcbi.1010753.s009" ref-type="supplementary-material">S1 Table</xref>), and find that Secuer yields more or comparably accurate clustering results than the other methods, and saves 90% of runtime in general.</p>
    <p>With Secuer as a subroutine, we also develop a consensus clustering method, Secuer-consensus, by aggregating multiple clustering results obtained by Secuer to further boost clustering accuracy and stability. Compared to the popular consensus clustering algorithm SC3 [<xref rid="pcbi.1010753.ref015" ref-type="bibr">15</xref>], Secuer-consensus attains better clustering accuracy on 14 benchmark datasets, is in general 100 times faster, and can work on large datasets in which SC3 even fails to produce any useful output. Compared to Specter [<xref rid="pcbi.1010753.ref016" ref-type="bibr">16</xref>], another consensus clustering method for large-scale scRNA-seq data published recently, Secuer-consensus shows superior performance in both accuracy and speed on large datasets. In summary, Secuer and Secuer-consensus are accurate and scalable algorithms that provide a general framework for efficient (consensus) clustering of small to ultra-large scRNA-seq datasets that are being produced by a growing array of single cell transcriptomic projects.</p>
  </sec>
  <sec sec-type="results" id="sec002">
    <title>Results</title>
    <sec id="sec003">
      <title>Overview of Secuer</title>
      <p>The workflow of Secuer is illustrated in <xref rid="pcbi.1010753.g001" ref-type="fig">Fig 1</xref>. To improve computational efficiency, Secuer starts by randomly sampling a subset of <italic toggle="yes">p</italic>′ (10,000 by default) cells from all <italic toggle="yes">N</italic> cells (<xref rid="pcbi.1010753.g001" ref-type="fig">Fig 1A and 1B</xref>). <italic toggle="yes">p</italic> anchors are then obtained, which are the centroids of the identified clusters by applying k-means to the above random subsample (<xref rid="pcbi.1010753.g001" ref-type="fig">Fig 1B</xref>). Next the <italic toggle="yes">k</italic>-nearest anchors of all cells are determined by the MAKNN algorithm (<xref rid="pcbi.1010753.g001" ref-type="fig">Fig 1C</xref>). Then, a weighted bipartite graph between anchors and cells is constructed, with similarities between anchors and cells quantified by a locally scaled Gaussian kernel that the bandwidth parameter of each cell is defined as the average distance between the cell and its <italic toggle="yes">k</italic> nearest neighbor anchors, to better capture the local geometry of the gene expression landscape (<xref rid="pcbi.1010753.g001" ref-type="fig">Fig 1D</xref>). Finally, we compute the first <italic toggle="yes">K</italic> eigenvectors of the graph Laplacian by transfer cuts (T-cut) algorithm [<xref rid="pcbi.1010753.ref017" ref-type="bibr">17</xref>] and obtain the final clustering results by off-the-shelf clustering algorithms such as k-means (by default) (<xref rid="pcbi.1010753.g001" ref-type="fig">Fig 1E</xref>). Secuer also automatically infers the number of clusters by either applying a community detection-based technique on the graph of the anchors (by default) (<xref rid="pcbi.1010753.g001" ref-type="fig">Fig 1F</xref>), or using the number of near-zero eigenvalues of the graph Laplacian (see <xref rid="sec009" ref-type="sec">Materials and Methods</xref>) [<xref rid="pcbi.1010753.ref011" ref-type="bibr">11</xref>].</p>
      <fig position="float" id="pcbi.1010753.g001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010753.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Overview of the Secuer algorithm.</title>
          <p>(A) Secuer takes the matrix in which rows are cells and columns are features as input. (B) Secuer obtains <italic toggle="yes">p</italic> anchors (red points) by using k-means on a random subset of <italic toggle="yes">p</italic>′ cells from all <italic toggle="yes">N</italic> cells (blue points). (C) The MAKNN algorithm step aims to find the <italic toggle="yes">k</italic> nearest anchors for each cell (green points). (D) A weighted bipartite graph is constructed, with nodes representing cells (donated as <italic toggle="yes">x</italic>) and anchors (donated as <italic toggle="yes">r</italic>) and weights computed by a locally scaled Gaussian kernel distance. (E) Secuer applies k-means to the eigenvectors of the graph Laplacian of the weighted bipartite graph to obtain the final clustering results. (F) Secuer estimates the number of clusters based on the graph of the anchors or based on the eigenvalues of the graph Laplacian of the weighted bipartite graph of cells and anchors.</p>
        </caption>
        <graphic xlink:href="pcbi.1010753.g001" position="float"/>
      </fig>
      <p>We observed that the locally scaled Gaussian kernel is better suited to model certain scRNA-seq data than the non-locally scaled Gaussian kernel used in U-SPEC [<xref rid="pcbi.1010753.ref012" ref-type="bibr">12</xref>] (<xref rid="pcbi.1010753.s001" ref-type="supplementary-material">S1 Fig</xref>). In addition, we studied how two important tuning parameters– <italic toggle="yes">p</italic> (the number of anchors) and <italic toggle="yes">k</italic> (the number of nearest neighbors in MAKNN)–affected the clustering results in Secuer, and found that <italic toggle="yes">p</italic> = 1000 and <italic toggle="yes">k</italic> = 7 produced superior results (<xref rid="pcbi.1010753.s002" ref-type="supplementary-material">S2 Fig</xref>), which are therefore recommended as the default values when implementing Secuer.</p>
    </sec>
    <sec id="sec004">
      <title>Secuer performance on simulated datasets</title>
      <p>Clustering ultra-large scRNA-seq datasets is computationally intensive in terms of both runtime and memory usage. We generated a series of scRNA-seq datasets with an increasing number of cells ranging from 10,000 to 40 million (see <xref rid="sec009" ref-type="sec">Materials and Methods</xref>) to test the performance of Secuer and three widely used clustering methods: k-means, Louvain and Leiden. The number of clusters is determined by the default parameters except for k-means. For the ease of comparison, the reference/ground-truth (see <xref rid="sec009" ref-type="sec">Materials and Methods</xref>) number of clusters are given to k-means as input. The clustering accuracy is measured by the Adjusted Rand Index (ARI) [<xref rid="pcbi.1010753.ref018" ref-type="bibr">18</xref>] and the Normalized Mutual Information (NMI) [<xref rid="pcbi.1010753.ref019" ref-type="bibr">19</xref>].</p>
      <p>First, we compared the runtimes of different methods. Secuer is the fastest on large and ultra-large datasets, in particular for ultra-large datasets, where Secuer is 5 times faster than k-means, and 12 times faster than Louvain/Leiden. Though k-means is faster for small datasets, the runtime only differs slightly from Secuer (below 10 seconds) (<xref rid="pcbi.1010753.g002" ref-type="fig">Fig 2A</xref>). In contrast, Louvain and Leiden are much slower than Secuer and k-means when applied to datasets over all scales, and fail to process the datasets of more than 10 million cells. Note the runtime of Louvain and Leiden does not monotonically increase with the sample size, possibly due to the much higher number of estimated clusters for larger datasets (<xref rid="pcbi.1010753.g002" ref-type="fig">Fig 2C</xref>). We then investigated the memory usage of different methods. We observed that Secuer and k-means consume the least amount of memory in all datasets. In comparison to Louvain and Leiden, Secuer only requires one-tenth of their memory usage when the sample size is over 1 million (<xref rid="pcbi.1010753.g002" ref-type="fig">Fig 2B</xref>). We also evaluated the clustering accuracy of all the methods and found that they all performed similarly when the sample sizes are less than 5 million. However, Louvain and Leiden performed poorly when there are more than 5 million cells, suggesting that they should not be applied directly to ultra-large datasets, even without concerning the computational cost (<xref rid="pcbi.1010753.s003" ref-type="supplementary-material">S3A Fig</xref>).</p>
      <fig position="float" id="pcbi.1010753.g002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010753.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>The performance of different methods on the simulated datasets.</title>
          <p>(A) The clustering runtime vs. the number of cells in the simulated datasets for all four methods. (B) The memory usage vs. the number of cells in the simulated datasets for all four methods. (C) The estimated number of clusters vs. the number of cells in the simulated datasets for three out of four methods: Secuer, Louvain and Leiden. k: thousand, M: million.</p>
        </caption>
        <graphic xlink:href="pcbi.1010753.g002" position="float"/>
      </fig>
      <p>Next, we investigated the accuracy of Secuer in inferring the number of clusters (<italic toggle="yes">K</italic>). We set the true <italic toggle="yes">K</italic> = 19 across all simulated datasets over different sample sizes (see <xref rid="sec009" ref-type="sec">Materials and Methods</xref>). <xref rid="pcbi.1010753.g002" ref-type="fig">Fig 2C</xref> displays the number of clusters identified by Secuer, Louvain and Leiden, with sample sizes varying from 10,000 to 40 million. The numbers of clusters estimated by Secuer only fluctuate mildly around 18 across different simulations. However, neither Louvain nor Leiden can infer <italic toggle="yes">K</italic> correctly in ultra-large datasets when the number of cells is over 5 million (<xref rid="pcbi.1010753.g002" ref-type="fig">Fig 2C</xref>). Notably, the estimated numbers of clusters by Louvain and Leiden are enormously upwardly biased, and such a bias cannot be easily fixed by simply lowering the resolution parameter to even 0.0001 (<xref rid="pcbi.1010753.s003" ref-type="supplementary-material">S3B Fig</xref>). This further suggests that Secuer should be favored over Louvain and Leiden when analyzing large to ultra-large datasets.</p>
      <p>Finally, we compared Secuer with the vanilla spectral clustering algorithms (VSC), especially in runtime. To this end, we divided the clustering procedure into three steps: constructing weighted bipartite graph, solving the eigen-problem, and the final clustering. We investigated the runtime of each step between Secuer and VSC. Secuer has significantly reduced runtime on the graph construction step in larger datasets and the eigen-solving step in datasets over all scales, due to the use of the T-cut algorithm on the anchor-based bipartite graph (<xref rid="pcbi.1010753.s003" ref-type="supplementary-material">S3C and S3D Fig</xref>, see <xref rid="sec009" ref-type="sec">Materials and Methods</xref>).</p>
    </sec>
    <sec id="sec005">
      <title>Secuer performance on large real datasets</title>
      <p>To evaluate the performance of our method on large real datasets, we collected three scRNA-seq datasets recently reported: COVID19 dataset profiling 1.46 million immune cells isolated from 196 patients; MCA dataset containing 325,486 cells from multiple major mouse organs; and Mouse brain dataset consisting of over 1 million cells from two E18 mice. For each dataset, we performed all clustering methods 10 times and reported the average runtimes and clustering accuracy.</p>
      <p>Secuer has the shortest runtime on all datasets (<xref rid="pcbi.1010753.g003" ref-type="fig">Fig 3A</xref>). In particular, for the COVID19 dataset with more than 1 million cells, the runtime of Secuer is &lt; 1 minute on average, which is 3 times faster than k-means, and 24 times faster than Louvain and Leiden. In the meanwhile, Secuer achieves competitive accuracy in general compared to other methods measured by both ARI (<xref rid="pcbi.1010753.g003" ref-type="fig">Fig 3B</xref>) and NMI (<xref rid="pcbi.1010753.s004" ref-type="supplementary-material">S4A Fig</xref>). An example of the clustering results by all methods are displayed in Uniform Manifold Approximation and Projection (UMAP) [<xref rid="pcbi.1010753.ref020" ref-type="bibr">20</xref>] visualization (<xref rid="pcbi.1010753.g003" ref-type="fig">Fig 3C–3I</xref>), in which the cell type labels are obtained from Xie et al. [<xref rid="pcbi.1010753.ref021" ref-type="bibr">21</xref>]. Under default parameters, Secuer exhibits more apparent cell type separations than Louvain and Leiden, both of which obtain 1.5 times more clusters showing ambiguous patterns, especially on the right region of the plot with a lot of small clusters overlaying with each other (<xref rid="pcbi.1010753.g003" ref-type="fig">Fig 3D–3F</xref>). The performance of Louvain and Leiden is improved when the number of clusters is tuned to be the same as that of Secuer. However, by doing this they fail to distinguish the Interneurons (cluster 1 in Secuer) and Neural stem/precursor cells (cluster 6 in Secuer) in the lower left corner of the plot (<xref rid="pcbi.1010753.g003" ref-type="fig">Fig 3G and 3H</xref>). Likewise, k-means also fail to distinguish the two clusters even though the original number of cell type labels is given (<xref rid="pcbi.1010753.g003" ref-type="fig">Fig 3I</xref>). Taken together, these findings demonstrate that Secuer is an efficient and accurate algorithm for clustering large scRNA-seq datasets.</p>
      <fig position="float" id="pcbi.1010753.g003">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010753.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>The performance of different methods on large real datasets.</title>
          <p>(A) The clustering time of different methods. (B) The ARI of different methods on three large datasets. (C-I) UMAP visualization of the Mouse brain dataset for the different methods. Reference (C) illustrates the ground-truth cell type labels obtained from the original study. Secuer (D), Louvain (E), and Leiden (F) display clustering results by using their default parameters. Adjusted Louvain (G) and adjusted Leiden (H) refer to the clustering results by setting the resolution parameter to 0.3. k-means (I) represents the clustering results given the ground-truth number of clusters in (C).</p>
        </caption>
        <graphic xlink:href="pcbi.1010753.g003" position="float"/>
      </fig>
    </sec>
    <sec id="sec006">
      <title>Secuer performance on well-annotated benchmark datasets</title>
      <p>To further investigate the performance of our method in small and moderate benchmark datasets, we applied the same analyses as above on six gold-standard and six-silver standard scRNA-seq datasets introduced by SC3 [<xref rid="pcbi.1010753.ref015" ref-type="bibr">15</xref>], scDCC [<xref rid="pcbi.1010753.ref022" ref-type="bibr">22</xref>], and MARS [<xref rid="pcbi.1010753.ref004" ref-type="bibr">4</xref>]. These datasets, with numbers of cells varying from 49 to 110,832, are widely used to benchmark the performance of new clustering methods because the cell type labels with high confidence are available.</p>
      <p>As expected, Secuer and k-means remain to have the shortest runtimes, which are at least 10 times faster than Louvain and Leiden across all 12 datasets (<xref rid="pcbi.1010753.g004" ref-type="fig">Fig 4A</xref>). In terms of accuracy, Secuer outperforms Louvain and Leiden on 7 out of 12 datasets (mean ARI difference &gt; 0.05), and is substantially better on 4 out of 12 (Goolam, Biase, Human kidney and Mouse retina, mean ARI difference &gt; 0.2) (<xref rid="pcbi.1010753.g004" ref-type="fig">Fig 4B and 4C</xref>). The distribution of ARI across all datasets demonstrates that Secuer is highly competitive even only in terms of clustering accuracy (<xref rid="pcbi.1010753.g004" ref-type="fig">Fig 4D</xref>). Likewise, similar trends are observed when measuring accuracy using NMI (<xref rid="pcbi.1010753.s004" ref-type="supplementary-material">S4B–S4D Fig</xref>). k-means sometimes achieves better accuracy than the other methods, but the clustering results are exceedingly inconsistent across different initializations. For instance, the range of ARI in different runs is 0.5 in the Biase dataset (<xref rid="pcbi.1010753.g004" ref-type="fig">Fig 4B</xref>). Furthermore, we found that k-means is sensitive to changes in the data preprocessing pipelines. In most cases, the mean NMIs of k-means with and without preprocessing step differ by a large margin, especially for Goolam and CITE PBMC datasets (mean NMI difference &gt; 0.5, <xref rid="pcbi.1010753.s005" ref-type="supplementary-material">S5 Fig</xref>). Using the Mouse retina dataset as an example, The UMAP visualization suggests that the clusters inferred by Secuer are more aligned with the given reference cell-type annotations (<xref rid="pcbi.1010753.g004" ref-type="fig">Fig 4E–4I</xref>), regarded as the ground truth. Notably, cluster 1 identified by Secuer is perfectly matched with the reference cluster 5, but none of the other approaches are capable of recovering this reference cluster. Finally, we examined the accuracy of the estimated number of clusters by different methods on all 12 datasets and discovered that Secuer outperformed Louvain and Leiden (<xref rid="pcbi.1010753.s006" ref-type="supplementary-material">S6 Fig</xref>). These results demonstrate that Secuer is also competitive in terms of clustering accuracy for small and moderate scRNA-seq datasets.</p>
      <fig position="float" id="pcbi.1010753.g004">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010753.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Performance of Secuer on twelve gold and silver standard datasets.</title>
          <p>(A) The clustering runtime of each method on all twelve datasets. (B-C) Accuracy of different methods, including k-means, Louvain, Leiden, and Secuer, on gold (B) and silver (C) standard datasets. (D) A boxplot showing the distribution of ARI of different methods on all datasets. (E-I) UMAP visualization of the ground-true cell type labels obtained from the original study, termed as reference (E) and clustering results from four different methods (F-I) on Mouse retina dataset.</p>
        </caption>
        <graphic xlink:href="pcbi.1010753.g004" position="float"/>
      </fig>
    </sec>
    <sec id="sec007">
      <title>Secuer-consensus performance on fourteen benchmark datasets</title>
      <p>Most of the unsupervised clustering algorithms may yield inconsistent results due to random initialization and different parameter settings. To resolve this common problem, consensus clustering aggregates multiple outputs generated by different clustering algorithms or by the same algorithm but with varied parameter settings, to produce consensus clusters that are expected to be more stable and accurate [<xref rid="pcbi.1010753.ref015" ref-type="bibr">15</xref>,<xref rid="pcbi.1010753.ref023" ref-type="bibr">23</xref>]. Just as in the case of usual clustering, consensus clustering method applicable to large-scale scRNA-seq data is also lacking. To bridge this gap, with Secuer as a subroutine, we developed Secuer-consensus, a highly efficient consensus clustering algorithm that ensembles multiple outputs of Secuer by fully taking advantage of its computational efficiency. The implementation of Secuer-consensus constitutes three steps (<xref rid="pcbi.1010753.g005" ref-type="fig">Fig 5A</xref>): First, Secuer is run for <italic toggle="yes">M</italic> times with different distance metrics, including Euclidean and cosine distances, and different numbers of clusters estimated by different parameter settings to generate multiple clustering outputs. Second, an unweighted bipartite graph is constructed from the multiple outputs. Third, k-means clustering is performed on the unweighted bipartite graph (see <xref rid="sec009" ref-type="sec">Materials and Methods</xref>).</p>
      <fig position="float" id="pcbi.1010753.g005">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010753.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Overview of the Secuer-consensus algorithm and the performance on fourteen scRNA-seq datasets.</title>
          <p>(A) Secuer-consensus takes a matrix as input, with genes as the columns and cells as the rows, executes Secuer <italic toggle="yes">M</italic> times to acquire multiple clustering outputs, and constructs an unweighted bipartite graph, with two sets of nodes respectively representing the clusters (denoted as <italic toggle="yes">C</italic>) and cells (denoted as <italic toggle="yes">x</italic>). Finally, k-means clustering is used to obtain a consensus grouping. (B) The clustering runtime for different methods. Secuer-C: short for Secuer-consensus. (C) The ARI for four methods on 14 benchmark datasets.</p>
        </caption>
        <graphic xlink:href="pcbi.1010753.g005" position="float"/>
      </fig>
      <p>We evaluated the performance of Secuer-consensus on 14 datasets, including 12 gold/silver standard datasets and 2 million scale datasets, by comparing it to the original Secuer and two consensus clustering methods SC3 and Specter. Specter requires the number of clusters as input, which is provided by our method. We first studied how many clustering outputs of Secuer (<italic toggle="yes">M</italic>) should be fed into Secuer-consensus and found that setting <italic toggle="yes">M</italic> between 5 and 10 has generally better performance (<xref rid="pcbi.1010753.s007" ref-type="supplementary-material">S7 Fig</xref>). Hence, we set <italic toggle="yes">M</italic> = 5 for all datasets hereafter. It can be found that Secuer-consensus achieved similar runtime as Specter that is over 100 times faster than SC3 in small and moderate datasets (<xref rid="pcbi.1010753.g005" ref-type="fig">Fig 5B</xref>). Despite suboptimal compared with Specter on gold and some silver standard datasets, the runtime difference between Secuer-consensus and Specter is less than 8 seconds on average. However, when sample size increases, Secuer-consensus shows superior speed than Specter. In the case of processing million scale single cell datasets, Secuer-consensus takes 86 seconds for Mouse dataset (<italic toggle="yes">N</italic> = 1,011,462) and 112 seconds for COVID19 dataset (<italic toggle="yes">N</italic> = 1,462,702), while Specter takes 15 minutes and 8.5 minutes, respectively. Furthermore, Secuer-consensus can be accelerated by using parallel computation: for example, the average runtime is decreased by 50% on datasets with more than 1 million cells using 3 cores (<xref rid="pcbi.1010753.s008" ref-type="supplementary-material">S8 Fig</xref>).</p>
      <p>Regarding accuracy, Secuer-consensus is approaching or superior to Specter and SC3, depending on the datasets. Specifically, Secuer-consensus surpasses SC3 on 9 out of 10 datasets (SC3 failed to process the four larger datasets in our settings) and Specter on 7 out of 14 (mean ARI difference &gt; 0.05), while substantially outperforms SC3 on four datasets (Biase, Goolam, Human kidney and CITE PBMC datasets, ARI difference &gt; 0.2) and Specter on two datasets (Goolam and Mouse datasets, ARI difference &gt; 0.2) (<xref rid="pcbi.1010753.g005" ref-type="fig">Fig 5C</xref>). These findings indicate that Secuer-consensus is an appealing option for consensus clustering small to large scRNA-seq datasets.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec008">
    <title>Discussion</title>
    <p>Identifying cell clusters is a critical step for scRNA-seq data analysis. Computationally efficient and scalable methods are urgently needed due to the rapidly expanding volume of scRNA-seq data. In this work, we presented Secuer, a computationally efficient, ultra-scalable and accurate method for unsupervised clustering of scRNA-seq data. Secuer is on average 10 times faster than Louvain and Leiden while exhibiting similar accuracy in 15 benchmark datasets, covering different sequencing technologies, with the number of cells ranging from 49 to 1.4 million. Secuer can efficiently scale to ultra-large scRNA-seq datasets of more than 10 million cells, when neither Louvain nor Leiden is even able to process the data. For instance, Secuer can cluster a scRNA-seq dataset of 10 million cells within 3 minutes, which is 6 times faster than k-means, one of the most efficient off-the-shelf clustering algorithms. In addition, Secuer can reliably estimate the number of clusters regardless of the number of cells in the data, whereas both Louvain and Leiden usually erroneously identify &gt; 0.9 million clusters for datasets with over 5 million cells.</p>
    <p>With Secuer as a subroutine, we also proposed a consensus clustering method, Secuer-consensus, by aggregating multiple Secuer runs with an array of different parameter settings. Secuer-consensus surpasses or approaches Secuer, SC3 and Specter in all 14 benchmark datasets. Notably, Secuer-consensus only takes less than 1% the runtime of SC3 for these datasets, and 15% the runtime of Specter on the million datasets. By parallelizing the computation, our method can further reduce runtime on large datasets. This allows Secuer-consensus to cluster cell types with improved stability and accuracy compared to the non-consensus-based methods, while being substantially more efficient than competitive consensus clustering methods.</p>
    <p>Overall, our new clustering framework strikes a good balance between accuracy, computational cost and scalability. It is an appealing choice for clustering large-scale scRNA-seq atlas, and can also be easily incorporated into any online scRNA-seq computational platforms for real-time analysis. The computational efficiency of Secuer also makes it a building block for scalable consensus clustering, demonstrated by the superior performance of Secuer-consensus than other competing methods. Secuer is also flexible enough to be adapted to a wide range of clustering algorithms beyond spectral clustering, such as Louvain or upcoming new approaches, to enhance their efficiency and scalability. As the rapid development of droplet-based single cell technologies, we expect our framework can eventually be applied to identify cell clusters in large-scale omics data other than scRNA-seq, such as scATAC-seq, CyTOF and image-based spatial data.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec009">
    <title>Materials and methods</title>
    <sec id="sec010">
      <title>Spectral clustering</title>
      <p>Spectral clustering is a popular clustering algorithm originated in spectral graph theory [<xref rid="pcbi.1010753.ref024" ref-type="bibr">24</xref>]. Given a graph <italic toggle="yes">G</italic> = {<italic toggle="yes">X</italic>, <italic toggle="yes">E</italic>, <italic toggle="yes">S</italic>}, where <italic toggle="yes">X</italic> = {<italic toggle="yes">x</italic><sub>1</sub>,…,<italic toggle="yes">x</italic><sub><italic toggle="yes">N</italic></sub>} is a set of <italic toggle="yes">N</italic> data points and each <italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub> is a <italic toggle="yes">d</italic>-dimensional vector, <italic toggle="yes">E</italic> is a set of edges and <italic toggle="yes">S</italic> = [<italic toggle="yes">S</italic><sub><italic toggle="yes">in</italic></sub>]<sub><italic toggle="yes">i</italic>,<italic toggle="yes">n</italic> = 1,2,…,<italic toggle="yes">N</italic></sub> is a weighted adjacency or similarity matrix, spectral clustering aims to divide the graph into connected subgraphs in which the within-group edge weights are maximized while the between-group edge weights are minimized. A typical spectral clustering algorithm constitutes the following main steps: 1) constructing an adjacency matrix <italic toggle="yes">S</italic> for data points based on certain distances (e.g., Euclidean, cosine); 2) computing the graph Laplacian matrix, i.e., <italic toggle="yes">L</italic> = <italic toggle="yes">D</italic>−<italic toggle="yes">S</italic>, where <italic toggle="yes">D</italic> is the degree matrix of the graph, a diagonal matrix with diagonal elements equal to the row sums of <italic toggle="yes">S</italic>; 3) calculating the eigenvectors corresponding to the <italic toggle="yes">K</italic> smallest eigenvalues of the (normalized) Laplacian and arranging them in a matrix <italic toggle="yes">V</italic> by columns; 4) clustering the row-normalized <italic toggle="yes">V</italic> into <italic toggle="yes">K</italic> groups using conventional clustering algorithms, such as k-means or hierarchical clustering. Spectral clustering has several variants by using different forms of the Laplacian matrix [<xref rid="pcbi.1010753.ref011" ref-type="bibr">11</xref>]. Among them, Normalized cut (Ncut) is the most widely adopted method [<xref rid="pcbi.1010753.ref025" ref-type="bibr">25</xref>].</p>
    </sec>
    <sec id="sec011">
      <title>Secuer</title>
      <p>Our method is comprised of four steps: 1) identifying anchors; 2) estimating the number of clusters; 3) applying the MAKNN algorithm to construct the bipartite graph between anchors and cells; 4) partitioning the bipartite graph partitioning. Among them, the step of identifying anchors to generate an adjacency matrix of cell-by-anchor to replace the original dense similarity matrix is key for drastically improving the clustering runtime and memory usage. Given a gene expression matrix <italic toggle="yes">X</italic>∈ℝ<sup><italic toggle="yes">N</italic>×<italic toggle="yes">d</italic></sup>, where <italic toggle="yes">N</italic> and <italic toggle="yes">d</italic> are, respectively, the number of cells and the number of genes. The vanilla spectral clustering requires: 1) <italic toggle="yes">O</italic>(<italic toggle="yes">N</italic><sup>2</sup><italic toggle="yes">d</italic>) time to build the adjacency matrix and 2) <italic toggle="yes">O</italic>(<italic toggle="yes">N</italic><sup>3</sup>) time to solve the eigen-problem [<xref rid="pcbi.1010753.ref013" ref-type="bibr">13</xref>]. In contrast, Secuer reduces the time complexity to <inline-formula id="pcbi.1010753.e001"><alternatives><graphic xlink:href="pcbi.1010753.e001.jpg" id="pcbi.1010753.e001g" position="anchor"/><mml:math id="M1" display="inline" overflow="scroll"><mml:mi>O</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula> in 1) by using the bipartite graph representation, and reduces the time complexity to <italic toggle="yes">O</italic>(<italic toggle="yes">NK</italic>(<italic toggle="yes">K</italic>+<italic toggle="yes">k</italic>)+<italic toggle="yes">p</italic><sup>3</sup>) in 2) by using transfer-cuts (T-cut) [<xref rid="pcbi.1010753.ref012" ref-type="bibr">12</xref>,<xref rid="pcbi.1010753.ref017" ref-type="bibr">17</xref>] on the weighted bipartite graph to solve the eigen-problem, where <italic toggle="yes">k</italic> is the number of neighboring anchors and <italic toggle="yes">K</italic> is the estimated number of cell clusters.</p>
    </sec>
    <sec id="sec012">
      <title>Identifying anchors</title>
      <p>Given the gene expression matrix <italic toggle="yes">X</italic> = {<italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub>}<sub><italic toggle="yes">i</italic> = 1,..,<italic toggle="yes">N</italic></sub>, where <italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub>∈ℝ<sup><italic toggle="yes">d</italic></sup> represents the expression profile of one single cell, we selected <italic toggle="yes">p</italic> (default by 1,000) anchors to bypass computing the original large and dense similarity matrix. The idea behind this step is to use a small set of landmark points to approximately represent the underlying geometry of the data. In detail, we first randomly selected <italic toggle="yes">p</italic>′ (default by 10<italic toggle="yes">p</italic>) candidate cells from all <italic toggle="yes">N</italic> cells such that <italic toggle="yes">p</italic>&lt;<italic toggle="yes">p</italic>′≪<italic toggle="yes">N</italic>, and then group candidate cells into <italic toggle="yes">p</italic> clusters by k-means clustering. The final anchors are the centroids of the <italic toggle="yes">p</italic> clusters, denoted as <italic toggle="yes">r</italic> = {<italic toggle="yes">r</italic><sub>1</sub>, <italic toggle="yes">r</italic><sub>2</sub>,…,<italic toggle="yes">r</italic><sub><italic toggle="yes">p</italic></sub>}. Note that, for datasets with cells less than 10,000, we applied k-means on the dataset directly to identify anchors.</p>
    </sec>
    <sec id="sec013">
      <title>Estimating the number of clusters</title>
      <p>The number of clusters is usually given <italic toggle="yes">a priori</italic> for vanilla spectral clustering algorithms. However, the true number of cell types is seldomly available in practice. In the current version of Secuer, we implemented two approaches for estimating the number of clusters. Inspired by community-detection algorithms that infer the number of clusters using a resolution parameter, we constructed a graph with only anchors as nodes and estimate the number of clusters by the community-detection-based approach used in Louvain algorithm, which is also used as the default option in Secuer.</p>
      <p>Another option is to use the bipartite graph between anchors and cells. It is proven that the number of near-zero eigenvalues of the graph Laplacian matrix equals the number of the connected components of the underlying graph [<xref rid="pcbi.1010753.ref011" ref-type="bibr">11</xref>]. Inspired by this fact, we designed an approach consisting of the following five steps: 1) sorting the eigenvalues of the bipartite graph Laplacian matrix in ascending order; 2) dividing all the eigenvalues into 100 equal-sized bins <inline-formula id="pcbi.1010753.e002"><alternatives><graphic xlink:href="pcbi.1010753.e002.jpg" id="pcbi.1010753.e002g" position="anchor"/><mml:math id="M2" display="inline" overflow="scroll"><mml:mi mathvariant="script">H</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>|</mml:mo><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:mn>1,2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>100</mml:mn><mml:mo>}</mml:mo></mml:math></alternatives></inline-formula> and count the number <italic toggle="yes">C</italic><sub><italic toggle="yes">u</italic></sub> of eigenvalues falling into each bin; 3) computing the gap values Δ between consecutive bin pairs with <italic toggle="yes">C</italic><sub><italic toggle="yes">u</italic></sub>&gt;0, denoted as <inline-formula id="pcbi.1010753.e003"><alternatives><graphic xlink:href="pcbi.1010753.e003.jpg" id="pcbi.1010753.e003g" position="anchor"/><mml:math id="M3" display="inline" overflow="scroll"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo></mml:math></alternatives></inline-formula>, and identify the <italic toggle="yes">α</italic>-th greatest values Δ<sub><italic toggle="yes">α</italic></sub> in Δ (with default value set as <italic toggle="yes">α</italic> = 4 by empirical experience from simulations and data analysis); 4) determining the bins with gap values greater than Δ<sub><italic toggle="yes">α</italic></sub> and obtain <inline-formula id="pcbi.1010753.e004"><alternatives><graphic xlink:href="pcbi.1010753.e004.jpg" id="pcbi.1010753.e004g" position="anchor"/><mml:math id="M4" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">argmax</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">u</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mspace width="0.25em"/><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>; 5) estimating the number of clusters by the number of eigenvalues falling into all bins with <italic toggle="yes">u</italic>≤<italic toggle="yes">u</italic>*.</p>
    </sec>
    <sec id="sec014">
      <title>The MAKNN algorithm</title>
      <p>Given <italic toggle="yes">p</italic> anchors, we aimed to construct an <italic toggle="yes">N</italic>×<italic toggle="yes">p</italic> similarity matrix <italic toggle="yes">S</italic> between all <italic toggle="yes">N</italic> cells and <italic toggle="yes">p</italic> anchors. However, this step can be computational expensive in terms of both runtime and memory usage for ultra-large datasets. To alleviate this problem, we used a modified approximate KNN algorithm to improve the computational efficiency. For large datasets, instead of building a large and dense adjacency matrix, the modified method aims to find <italic toggle="yes">k</italic> nearest anchors approximately for each cell to build a sparse adjacency matrix of cell-to-anchor. Taking a cell <italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub> as an example:</p>
      <list list-type="roman-lower">
        <list-item>
          <p>All <italic toggle="yes">p</italic> anchors are grouped into <italic toggle="yes">o</italic> clusters using k-means, denoted as <italic toggle="yes">ω</italic><sub>1</sub>, <italic toggle="yes">ω</italic><sub>2</sub>,…,<italic toggle="yes">ω</italic><sub><italic toggle="yes">o</italic></sub>.</p>
        </list-item>
        <list-item>
          <p>Cell <italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub> is then assigned to the closest cluster <inline-formula id="pcbi.1010753.e005"><alternatives><graphic xlink:href="pcbi.1010753.e005.jpg" id="pcbi.1010753.e005g" position="anchor"/><mml:math id="M5" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> based on the Euclidean distance between cell <italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub> and all cluster centers.</p>
        </list-item>
        <list-item>
          <p>Find the nearest anchor of cell <italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub> in <inline-formula id="pcbi.1010753.e006"><alternatives><graphic xlink:href="pcbi.1010753.e006.jpg" id="pcbi.1010753.e006g" position="anchor"/><mml:math id="M6" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> denoted as <italic toggle="yes">p</italic><sup>(<italic toggle="yes">i</italic>)</sup>.</p>
        </list-item>
        <list-item>
          <p>Apply KNN to <italic toggle="yes">p</italic> anchors to obtain the <italic toggle="yes">k</italic>′ (default as 10×<italic toggle="yes">k</italic>) nearest neighbors of each anchor such that <italic toggle="yes">k</italic>&lt;<italic toggle="yes">k</italic>′.</p>
        </list-item>
        <list-item>
          <p>Obtain the <italic toggle="yes">k</italic> nearest anchors of cell <italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub> based on the Euclidean distance between <italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub> and the <italic toggle="yes">k</italic>′ nearest anchors of <italic toggle="yes">p</italic><sup>(<italic toggle="yes">i</italic>)</sup>.</p>
        </list-item>
      </list>
      <p>In the above steps, we only need to calculate the <italic toggle="yes">k</italic>′ nearest neighbors of <italic toggle="yes">p</italic> anchors. Then the neighbors of the anchor closest to the cell <italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub> are treated as neighbors of that cell. Since <italic toggle="yes">k</italic>≪<italic toggle="yes">p</italic>≪<italic toggle="yes">N</italic>, the time complexity of this procedure is <inline-formula id="pcbi.1010753.e007"><alternatives><graphic xlink:href="pcbi.1010753.e007.jpg" id="pcbi.1010753.e007g" position="anchor"/><mml:math id="M7" display="inline" overflow="scroll"><mml:mi>O</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mfrac><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:mfrac><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mi>k</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mo>(</mml:mo><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mfrac><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:mfrac><mml:mi>d</mml:mi><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>, which is minimized when <italic toggle="yes">o</italic> is set to <inline-formula id="pcbi.1010753.e008"><alternatives><graphic xlink:href="pcbi.1010753.e008.jpg" id="pcbi.1010753.e008g" position="anchor"/><mml:math id="M8" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> by equating <italic toggle="yes">Nod</italic> and <inline-formula id="pcbi.1010753.e009"><alternatives><graphic xlink:href="pcbi.1010753.e009.jpg" id="pcbi.1010753.e009g" position="anchor"/><mml:math id="M9" display="inline" overflow="scroll"><mml:mi>N</mml:mi><mml:mfrac><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:mfrac><mml:mi>d</mml:mi></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1010753.e010"><alternatives><graphic xlink:href="pcbi.1010753.e010.jpg" id="pcbi.1010753.e010g" position="anchor"/><mml:math id="M10" display="inline" overflow="scroll"><mml:mfrac><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula> is the average size of <italic toggle="yes">o</italic> anchor clusters in step i) of the above algorithm and <italic toggle="yes">t</italic> is the number of iterations of k-means. The above reasoning renders the order of the runtime <inline-formula id="pcbi.1010753.e011"><alternatives><graphic xlink:href="pcbi.1010753.e011.jpg" id="pcbi.1010753.e011g" position="anchor"/><mml:math id="M11" display="inline" overflow="scroll"><mml:mi>O</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>.</p>
      <p>We next used a locally scaled Gaussian kernel to measure the distance between cells and anchors, and obtain an <italic toggle="yes">N</italic>×<italic toggle="yes">p</italic> adjacency matrix <italic toggle="yes">B</italic> with each row only keeping <italic toggle="yes">k</italic> nonzero elements as
<disp-formula id="pcbi.1010753.e012"><alternatives><graphic xlink:href="pcbi.1010753.e012.jpg" id="pcbi.1010753.e012g" position="anchor"/><mml:math id="M12" display="block" overflow="scroll"><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1,2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1,2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1010753.e013"><alternatives><graphic xlink:href="pcbi.1010753.e013.jpg" id="pcbi.1010753.e013g" position="anchor"/><mml:math id="M13" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives></disp-formula>
where <italic toggle="yes">N</italic><sub><italic toggle="yes">k</italic></sub>(<italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub>) represents the <italic toggle="yes">k</italic> nearest anchors of cell <italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub>, and <italic toggle="yes">σ</italic><sub><italic toggle="yes">i</italic></sub> is the average distance between cell <italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub> and its <italic toggle="yes">k</italic> nearest anchors.</p>
    </sec>
    <sec id="sec015">
      <title>Bipartite graph partitioning</title>
      <p>Putting all cells and anchors together, we constructed a bipartite graph <italic toggle="yes">G</italic><sub><italic toggle="yes">b</italic></sub> = {<italic toggle="yes">X</italic>,<italic toggle="yes">r</italic>,<italic toggle="yes">W</italic>}, where <italic toggle="yes">W</italic> is a (<italic toggle="yes">N</italic>+<italic toggle="yes">p</italic>)×(<italic toggle="yes">N</italic>+<italic toggle="yes">p</italic>) weighted adjacency matrix, denoted as:
<disp-formula id="pcbi.1010753.e014"><alternatives><graphic xlink:href="pcbi.1010753.e014.jpg" id="pcbi.1010753.e014g" position="anchor"/><mml:math id="M14" display="block" overflow="scroll"><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mi>B</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>Then spectral clustering is performed to partition the graph by solving the generalized eigen-problem:
<disp-formula id="pcbi.1010753.e015"><alternatives><graphic xlink:href="pcbi.1010753.e015.jpg" id="pcbi.1010753.e015g" position="anchor"/><mml:math id="M15" display="block" overflow="scroll"><mml:mrow><mml:mi>L</mml:mi><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mi>γ</mml:mi><mml:mi>D</mml:mi><mml:mi>v</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives><label>(1)</label></disp-formula>
where <italic toggle="yes">L</italic> = <italic toggle="yes">D</italic>−<italic toggle="yes">W</italic> is the Laplacian matrix, <inline-formula id="pcbi.1010753.e016"><alternatives><graphic xlink:href="pcbi.1010753.e016.jpg" id="pcbi.1010753.e016g" position="anchor"/><mml:math id="M16" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>O</mml:mi></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the degree matrix of the graph <italic toggle="yes">G</italic><sub><italic toggle="yes">b</italic></sub>.</p>
      <p>For large datasets in which the number of cells is far greater than the number of anchors, <italic toggle="yes">G</italic><sub><italic toggle="yes">b</italic></sub> is an unbalanced bipartite graph. We thus employed an efficient eigen-decomposition method T-cut [<xref rid="pcbi.1010753.ref017" ref-type="bibr">17</xref>], which turns the problem (1) into a computational eigenproblem:
<disp-formula id="pcbi.1010753.e017"><alternatives><graphic xlink:href="pcbi.1010753.e017.jpg" id="pcbi.1010753.e017g" position="anchor"/><mml:math id="M17" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mi>z</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives><label>(2)</label></disp-formula>
where <italic toggle="yes">L</italic><sub><italic toggle="yes">p</italic></sub> = <italic toggle="yes">D</italic><sub><italic toggle="yes">p</italic></sub>−<italic toggle="yes">W</italic><sub><italic toggle="yes">p</italic></sub>, <inline-formula id="pcbi.1010753.e018"><alternatives><graphic xlink:href="pcbi.1010753.e018.jpg" id="pcbi.1010753.e018g" position="anchor"/><mml:math id="M18" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi>B</mml:mi></mml:math></alternatives></inline-formula>. Note that <inline-formula id="pcbi.1010753.e019"><alternatives><graphic xlink:href="pcbi.1010753.e019.jpg" id="pcbi.1010753.e019g" position="anchor"/><mml:math id="M19" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>. Here <italic toggle="yes">L</italic><sub><italic toggle="yes">p</italic></sub> is the Laplacian matrix of the graph <italic toggle="yes">G</italic><sub><italic toggle="yes">p</italic></sub> = {<italic toggle="yes">r</italic>, <italic toggle="yes">W</italic><sub><italic toggle="yes">p</italic></sub>}, <inline-formula id="pcbi.1010753.e020"><alternatives><graphic xlink:href="pcbi.1010753.e020.jpg" id="pcbi.1010753.e020g" position="anchor"/><mml:math id="M20" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:munder><mml:mrow><mml:munder accentunder="false"><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1,1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>︸</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1010753.e021"><alternatives><graphic xlink:href="pcbi.1010753.e021.jpg" id="pcbi.1010753.e021g" position="anchor"/><mml:math id="M21" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:munder><mml:mrow><mml:munder accentunder="false"><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1,1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>︸</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>.</p>
      <p>Li et al. proved that the solution of the eigen-problem (1) on graph <italic toggle="yes">G</italic><sub><italic toggle="yes">b</italic></sub> and the solution of the eigen-problem (2) on bipartite graph <italic toggle="yes">G</italic><sub><italic toggle="yes">b</italic></sub> are equivalent [<xref rid="pcbi.1010753.ref017" ref-type="bibr">17</xref>]. Let <inline-formula id="pcbi.1010753.e022"><alternatives><graphic xlink:href="pcbi.1010753.e022.jpg" id="pcbi.1010753.e022g" position="anchor"/><mml:math id="M22" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> be the first <italic toggle="yes">K</italic> eigenpairs of (2), where 0 = <italic toggle="yes">λ</italic><sub>1</sub>&lt;<italic toggle="yes">λ</italic><sub>2</sub>&lt;⋯&lt;<italic toggle="yes">λ</italic><sub><italic toggle="yes">K</italic></sub>&lt;1, and <inline-formula id="pcbi.1010753.e023"><alternatives><graphic xlink:href="pcbi.1010753.e023.jpg" id="pcbi.1010753.e023g" position="anchor"/><mml:math id="M23" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> be the first <italic toggle="yes">K</italic> eigenpairs of (1), where 0≤<italic toggle="yes">γ</italic><sub><italic toggle="yes">e</italic></sub>&lt;1. According to Li et al., we have the following
<disp-formula id="pcbi.1010753.e024"><alternatives><graphic xlink:href="pcbi.1010753.e024.jpg" id="pcbi.1010753.e024g" position="anchor"/><mml:math id="M24" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1010753.e025"><alternatives><graphic xlink:href="pcbi.1010753.e025.jpg" id="pcbi.1010753.e025g" position="anchor"/><mml:math id="M25" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <inline-formula id="pcbi.1010753.e026"><alternatives><graphic xlink:href="pcbi.1010753.e026.jpg" id="pcbi.1010753.e026g" position="anchor"/><mml:math id="M26" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mi>P</mml:mi><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1010753.e027"><alternatives><graphic xlink:href="pcbi.1010753.e027.jpg" id="pcbi.1010753.e027g" position="anchor"/><mml:math id="M27" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi>B</mml:mi></mml:math></alternatives></inline-formula> is the associated transition probability matrix from cells to anchors.</p>
      <p>After normalizing the matrix <italic toggle="yes">T</italic> = [<italic toggle="yes">ξ</italic><sub>1</sub>,…,<italic toggle="yes">ξ</italic><sub><italic toggle="yes">K</italic></sub>]<sub><italic toggle="yes">N</italic>×<italic toggle="yes">K</italic></sub> to unit length, k-means is applied to the rows of normalized matrix to obtain the final clustering result. Note that k-means can be replaced by other clustering algorithms such as DBSCAN or hierarchical clustering. However, these methods are generally less efficient than k-means.</p>
    </sec>
    <sec id="sec016">
      <title>Secuer-consensus</title>
      <p>Taking advantage of the computational efficiency of Secuer, we proposed a consensus clustering method Secuer-consensus, which aggregates multiple clustering outputs from Secuer to boost the clustering stability and accuracy. The implementation is as follows. First, <italic toggle="yes">M</italic> different base clustering results are obtained from Secuer, by varying the selection of anchors, the number of clusters, and the distance metrics between anchors and cells (Euclidean or cosine). Denote all the clusters in <italic toggle="yes">M</italic> base clustering results as <inline-formula id="pcbi.1010753.e028"><alternatives><graphic xlink:href="pcbi.1010753.e028.jpg" id="pcbi.1010753.e028g" position="anchor"/><mml:math id="M28" display="inline" overflow="scroll"><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1010753.e029"><alternatives><graphic xlink:href="pcbi.1010753.e029.jpg" id="pcbi.1010753.e029g" position="anchor"/><mml:math id="M29" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <italic toggle="yes">K</italic><sub><italic toggle="yes">m</italic></sub> is the number of clusters in the <italic toggle="yes">m</italic>-th base clustering result and <inline-formula id="pcbi.1010753.e030"><alternatives><graphic xlink:href="pcbi.1010753.e030.jpg" id="pcbi.1010753.e030g" position="anchor"/><mml:math id="M30" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is the <italic toggle="yes">e</italic>-th clusters of <italic toggle="yes">m</italic>-th the base clustering result. Then, a bipartite graph <inline-formula id="pcbi.1010753.e031"><alternatives><graphic xlink:href="pcbi.1010753.e031.jpg" id="pcbi.1010753.e031g" position="anchor"/><mml:math id="M31" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover><mml:mo>}</mml:mo></mml:math></alternatives></inline-formula> is constructed, in which the nodes are the cells and clusters and <inline-formula id="pcbi.1010753.e032"><alternatives><graphic xlink:href="pcbi.1010753.e032.jpg" id="pcbi.1010753.e032g" position="anchor"/><mml:math id="M32" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is an (<italic toggle="yes">N</italic>+<italic toggle="yes">K</italic><sub><italic toggle="yes">C</italic></sub>)×(<italic toggle="yes">N</italic>+<italic toggle="yes">K</italic><sub><italic toggle="yes">C</italic></sub>) adjacency matrix indicating whether a cell belongs to a cluster. An edge only appears between a cell and the clusters to which the cell belongs and no edges between different cells or between different clusters are allowed. <inline-formula id="pcbi.1010753.e033"><alternatives><graphic xlink:href="pcbi.1010753.e033.jpg" id="pcbi.1010753.e033g" position="anchor"/><mml:math id="M33" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> can be written as:
<disp-formula id="pcbi.1010753.e034"><alternatives><graphic xlink:href="pcbi.1010753.e034.jpg" id="pcbi.1010753.e034g" position="anchor"/><mml:math id="M34" display="block" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mover accent="true"><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1010753.e035"><alternatives><graphic xlink:href="pcbi.1010753.e035.jpg" id="pcbi.1010753.e035g" position="anchor"/><mml:math id="M35" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mo>∙</mml:mo></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <inline-formula id="pcbi.1010753.e036"><alternatives><graphic xlink:href="pcbi.1010753.e036.jpg" id="pcbi.1010753.e036g" position="anchor"/><mml:math id="M36" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is an <italic toggle="yes">N</italic>×<italic toggle="yes">K</italic><sub><italic toggle="yes">C</italic></sub> matrix.</p>
      <p>Similar to the Bipartite graph partitioning section, we next solved the eigenvalue of graph Laplacian of <italic toggle="yes">G</italic><sub><italic toggle="yes">XC</italic></sub> by T-cut. That means solving the following eigenproblem:
<disp-formula id="pcbi.1010753.e037"><alternatives><graphic xlink:href="pcbi.1010753.e037.jpg" id="pcbi.1010753.e037g" position="anchor"/><mml:math id="M37" display="block" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives><label>(3)</label></disp-formula>
where <inline-formula id="pcbi.1010753.e038"><alternatives><graphic xlink:href="pcbi.1010753.e038.jpg" id="pcbi.1010753.e038g" position="anchor"/><mml:math id="M38" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is the Laplacian matrix, and <inline-formula id="pcbi.1010753.e039"><alternatives><graphic xlink:href="pcbi.1010753.e039.jpg" id="pcbi.1010753.e039g" position="anchor"/><mml:math id="M39" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>O</mml:mi></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the degree matrix of the bipartite graph <italic toggle="yes">G</italic><sub><italic toggle="yes">XC</italic></sub>.</p>
      <p>The eigen-problem in (3) is equivalent to solving the following problem,
<disp-formula id="pcbi.1010753.e040"><alternatives><graphic xlink:href="pcbi.1010753.e040.jpg" id="pcbi.1010753.e040g" position="anchor"/><mml:math id="M40" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>C</mml:mi></mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>C</mml:mi></mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives><label>(4)</label></disp-formula>
where <inline-formula id="pcbi.1010753.e041"><alternatives><graphic xlink:href="pcbi.1010753.e041.jpg" id="pcbi.1010753.e041g" position="anchor"/><mml:math id="M41" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is the Laplacian matrix of <inline-formula id="pcbi.1010753.e042"><alternatives><graphic xlink:href="pcbi.1010753.e042.jpg" id="pcbi.1010753.e042g" position="anchor"/><mml:math id="M42" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1010753.e043"><alternatives><graphic xlink:href="pcbi.1010753.e043.jpg" id="pcbi.1010753.e043g" position="anchor"/><mml:math id="M43" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mover accent="true"><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is the adjacency matrix and <inline-formula id="pcbi.1010753.e044"><alternatives><graphic xlink:href="pcbi.1010753.e044.jpg" id="pcbi.1010753.e044g" position="anchor"/><mml:math id="M44" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula> is the degree matrix.</p>
      <p>Let <inline-formula id="pcbi.1010753.e045"><alternatives><graphic xlink:href="pcbi.1010753.e045.jpg" id="pcbi.1010753.e045g" position="anchor"/><mml:math id="M45" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> be the first <italic toggle="yes">K</italic> eigenvalues and eigenvectors of (4), where <inline-formula id="pcbi.1010753.e046"><alternatives><graphic xlink:href="pcbi.1010753.e046.jpg" id="pcbi.1010753.e046g" position="anchor"/><mml:math id="M46" display="inline" overflow="scroll"><mml:mn>0</mml:mn><mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mo>⋯</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula>. Further let <inline-formula id="pcbi.1010753.e047"><alternatives><graphic xlink:href="pcbi.1010753.e047.jpg" id="pcbi.1010753.e047g" position="anchor"/><mml:math id="M47" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> be the first <italic toggle="yes">K</italic> eigenpairs of (3), where <inline-formula id="pcbi.1010753.e048"><alternatives><graphic xlink:href="pcbi.1010753.e048.jpg" id="pcbi.1010753.e048g" position="anchor"/><mml:math id="M48" display="inline" overflow="scroll"><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula>. Then we have:
<disp-formula id="pcbi.1010753.e049"><alternatives><graphic xlink:href="pcbi.1010753.e049.jpg" id="pcbi.1010753.e049g" position="anchor"/><mml:math id="M49" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1010753.e050"><alternatives><graphic xlink:href="pcbi.1010753.e050.jpg" id="pcbi.1010753.e050g" position="anchor"/><mml:math id="M50" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <inline-formula id="pcbi.1010753.e051"><alternatives><graphic xlink:href="pcbi.1010753.e051.jpg" id="pcbi.1010753.e051g" position="anchor"/><mml:math id="M51" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1010753.e052"><alternatives><graphic xlink:href="pcbi.1010753.e052.jpg" id="pcbi.1010753.e052g" position="anchor"/><mml:math id="M52" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mover accent="true"><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover><mml:mo>.</mml:mo></mml:math></alternatives></inline-formula></p>
      <p>Then k-means is applied to the rows of normalized matrix <inline-formula id="pcbi.1010753.e053"><alternatives><graphic xlink:href="pcbi.1010753.e053.jpg" id="pcbi.1010753.e053g" position="anchor"/><mml:math id="M53" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> to obtain the final clustering result.</p>
    </sec>
    <sec id="sec017">
      <title>Benchmark datasets</title>
      <p>Fifteen publicly available scRNA-seq datasets, including six gold-standard datasets, six-silver standard datasets and three ultra-large datasets, are used to evaluate the clustering accuracy of our method (see <xref rid="pcbi.1010753.s009" ref-type="supplementary-material">S1 Table</xref> for details) [<xref rid="pcbi.1010753.ref001" ref-type="bibr">1</xref>,<xref rid="pcbi.1010753.ref005" ref-type="bibr">5</xref>,<xref rid="pcbi.1010753.ref026" ref-type="bibr">26</xref>–<xref rid="pcbi.1010753.ref040" ref-type="bibr">40</xref>]. In six gold-standard datasets, cells are highly confident to be labeled as a specific cell type/stage according to their surface markers. In six silver standard datasets, the label of each cell is assigned by computational tools and manual annotation using <italic toggle="yes">prior</italic> knowledge by previous studies [<xref rid="pcbi.1010753.ref031" ref-type="bibr">31</xref>–<xref rid="pcbi.1010753.ref033" ref-type="bibr">33</xref>,<xref rid="pcbi.1010753.ref036" ref-type="bibr">36</xref>–<xref rid="pcbi.1010753.ref038" ref-type="bibr">38</xref>]. Although widely used to benchmark a newly proposed clustering method [<xref rid="pcbi.1010753.ref004" ref-type="bibr">4</xref>,<xref rid="pcbi.1010753.ref015" ref-type="bibr">15</xref>,<xref rid="pcbi.1010753.ref022" ref-type="bibr">22</xref>], these datasets are relatively small in size (containing from 49 to 110,832 cells per dataset), and thus insufficient to evaluate a method designed for much higher throughput considered in this paper. Thus, we also assessed our method using three large datasets [<xref rid="pcbi.1010753.ref005" ref-type="bibr">5</xref>,<xref rid="pcbi.1010753.ref041" ref-type="bibr">41</xref>], which consist of 1 million cells on average. The cell type labels in these datasets are collected from the original studies. In all the 15 datasets, the cell type labels are considered as ground-truth, also termed as “reference”, throughout this study.</p>
    </sec>
    <sec id="sec018">
      <title>Data preprocessing</title>
      <p>The preprocessing involves four steps: 1) gene/cell filtering; 2) normalization; 3) selection of highly variable genes; 4) dimension reduction by PCA. The parameters of the preprocessing pipeline are the same for all datasets except for the gene/cell filtering step, which instead follows the criterions in the original studies. For six small gold standard datasets, we adopted a preprocessing strategy of gene filtering similar to that for SC3 [<xref rid="pcbi.1010753.ref015" ref-type="bibr">15</xref>]: genes are removed by the ‘gene filter’ function in the Scanpy package [<xref rid="pcbi.1010753.ref008" ref-type="bibr">8</xref>] if they are expressed in less than 10% or more than 90% of the cells. For larger datasets including 10X PBMC, Worm neuron, Human kidney, CITE PBMC and Mouse retain datasets, we filtered cells with fewer than one gene and retained genes expressed in at least one cell using Scanpy. For mouse brain, we excluded cells with fewer than 200 genes and mitochondrial genes with a UMI greater than 5%. Genes expressed in less than 3 cells were also removed. For TAM FACS, we retained genes expressed in at least 3 cells and cells with no less than 250 expressed genes and 5000 counts. For MCA, cells with fewer than 100 genes and genes with less than 3 cells were excluded. After filtering, raw count matrix was normalized and log-transformed to detect highly variable genes (HVG). Finally, Principal Component Analysis (PCA) was performed on the selected HVGs, and the top 50 PCs were retained for clustering. For COVID19, we downloaded the processed data provided by the authors. Scripts for all the above preprocessing steps are available at <ext-link xlink:href="https://github.com/nanawei11/Secuer" ext-link-type="uri">https://github.com/nanawei11/Secuer</ext-link>.</p>
      <p>Note that two optional steps of data preprocessing, i.e., normalization and selection of HVGs, can potentially affect the clustering results [<xref rid="pcbi.1010753.ref042" ref-type="bibr">42</xref>,<xref rid="pcbi.1010753.ref043" ref-type="bibr">43</xref>]. Therefore, we compared the clustering accuracies of different methods both with and without these two steps (<xref rid="pcbi.1010753.s005" ref-type="supplementary-material">S5 Fig</xref>).</p>
    </sec>
    <sec id="sec019">
      <title>Distance metrics</title>
      <p>Denote <italic toggle="yes">x</italic><sub><italic toggle="yes">ig</italic></sub>, <italic toggle="yes">i</italic> = 1,…,<italic toggle="yes">N</italic>, <italic toggle="yes">g</italic> = 1,…, <italic toggle="yes">d</italic> as the gene expression level of the cell <italic toggle="yes">i</italic> in gene <italic toggle="yes">g</italic>. We used the following Euclidean and cosine distances as candidate distance metrics to build the bipartite graph between cells and anchors:
<disp-formula id="pcbi.1010753.e054"><alternatives><graphic xlink:href="pcbi.1010753.e054.jpg" id="pcbi.1010753.e054g" position="anchor"/><mml:math id="M54" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mi>u</mml:mi><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msubsup></mml:mstyle><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:msqrt><mml:mo>,</mml:mo></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1010753.e055"><alternatives><graphic xlink:href="pcbi.1010753.e055.jpg" id="pcbi.1010753.e055g" position="anchor"/><mml:math id="M55" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:msqrt><mml:msqrt><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math></alternatives></disp-formula></p>
    </sec>
    <sec id="sec020">
      <title>Clustering metrics</title>
      <p>We compared the clustering accuracy of different methods using the ARI [<xref rid="pcbi.1010753.ref014" ref-type="bibr">14</xref>] and NMI [<xref rid="pcbi.1010753.ref015" ref-type="bibr">15</xref>], which are widely used indices for evaluating the clustering performance when the reference or the true cluster labels are known. ARI is defined as
<disp-formula id="pcbi.1010753.e056"><alternatives><graphic xlink:href="pcbi.1010753.e056.jpg" id="pcbi.1010753.e056g" position="anchor"/><mml:math id="M56" display="block" overflow="scroll"><mml:mi>A</mml:mi><mml:mi>R</mml:mi><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>ς</mml:mi><mml:mo>,</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>ς</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>ς</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>ς</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>]</mml:mo><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>N</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>ς</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>ς</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>]</mml:mo><mml:mo>−</mml:mo><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>ς</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>ς</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>]</mml:mo><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>N</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math></alternatives></disp-formula>
where <italic toggle="yes">N</italic> is the total number of cells, and <italic toggle="yes">N</italic><sub><italic toggle="yes">ςτ</italic></sub> represents the number of cells that are shared by the predicted cluster ς and true label <italic toggle="yes">τ</italic>, <italic toggle="yes">N</italic><sub><italic toggle="yes">ς</italic></sub> and <italic toggle="yes">N</italic><sub><italic toggle="yes">τ</italic></sub> are the number of cells in the predicted cluster ς and true label <italic toggle="yes">τ</italic>, respectively. NMI is defined as
<disp-formula id="pcbi.1010753.e057"><alternatives><graphic xlink:href="pcbi.1010753.e057.jpg" id="pcbi.1010753.e057g" position="anchor"/><mml:math id="M57" display="block" overflow="scroll"><mml:mi>N</mml:mi><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>ς</mml:mi><mml:mo>,</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>ς</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>ς</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>ς</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>ς</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>ς</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>ς</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">τ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">τ</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math></alternatives></disp-formula>
where <inline-formula id="pcbi.1010753.e058"><alternatives><graphic xlink:href="pcbi.1010753.e058.jpg" id="pcbi.1010753.e058g" position="anchor"/><mml:math id="M58" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>ς</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>ς</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1010753.e059"><alternatives><graphic xlink:href="pcbi.1010753.e059.jpg" id="pcbi.1010753.e059g" position="anchor"/><mml:math id="M59" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>ς</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>ς</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1010753.e060"><alternatives><graphic xlink:href="pcbi.1010753.e060.jpg" id="pcbi.1010753.e060g" position="anchor"/><mml:math id="M60" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>. Higher ARI or NMI indicates better clustering result.</p>
    </sec>
  </sec>
  <sec id="sec021" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1010753.s001" position="float" content-type="local-data">
      <label>S1 Fig</label>
      <caption>
        <title>Clustering performance of Secuer and U-SPEC.</title>
        <p>(A) The differences between Secuer and U-SPEC. Here the number of clusters <italic toggle="yes">K</italic> in Secuer is estimated from data (i.e., data-adaptive) and in U-SPEC is user-specified (i.e., not data-adaptive). (B) ARI (left) and NMI (right) of Secuer and U-SPEC on 128 datasets from Mouse Cell Atlas, where Secuer used a locally scaled Gaussian kernel and U-SPEC used a non-locally scaled Gaussian kernel. The detailed information on these datasets is provided in <xref rid="pcbi.1010753.s010" ref-type="supplementary-material">S2 Table</xref>. Each point is the average over 10 runs and the dashed rectangles refer to the datasets with poor results (defined as those with ARI &lt; 0.1). P-values are computed from paired Wilcoxon test. (C) Barplots of ARI (left) and NMI (right) compare the performance of Secuer and U-SPEC in those datasets with poor results identified in (B). (D) ARI (left) and NMI (right) of Secuer-consensus (i.e., Secuer-C) and U-SENC. Here U-SENC is the consensus clustering method based on U-SPEC. (E) The UMAP of clustering results by Secuer (left) and U-SPEC (right) on the Adult bladder dataset. (F) Heatmap showing the eigenvectors of the bipartite graph Laplacian of Secuer and U-SPEC on the Adult bladder dataset, where rows represent cells and columns represent the eigenvectors corresponding to the top 3 largest eigenvalues. The ground-truth labels are plotted as Group.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010753.s001.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010753.s002" position="float" content-type="local-data">
      <label>S2 Fig</label>
      <caption>
        <title>The Secuer parameters benchmarked in six datasets.</title>
        <p>(A) The NMIs for six datasets are computed over different top numbers of principal components (pc) and different numbers of nearest neighbors in MAKNN. (B) The NMIs for six datasets are computed over different numbers of principal components and different numbers of anchors. Different panels represent different numbers of principal components.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010753.s002.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010753.s003" position="float" content-type="local-data">
      <label>S3 Fig</label>
      <caption>
        <title>Performance of Secuer and other methods on simulated datasets.</title>
        <p>(A) The NMI of different methods on simulated datasets with different sample sizes. The simulated datasets with an increasing number of cells ranging from 10,000 to 40 million are generated from Mouse brain datasets (see <xref rid="sec009" ref-type="sec">Materials and Methods</xref> for more details). (B) The number of clusters estimated by Louvain in five simulated datasets with sample sizes ranging from 5 million to 9 million under different resolutions (x-axis). (C) We divided the entire clustering procedure into three steps and showed the runtime of each step taken by Secuer and vanilla spectral clustering (VSC) on four datasets, including Worm neuron, Simulation data with 10,000 samples, Mouse retina and TAM FACS with the number of cells ranging from 4,217 to 110,823. (D) The NMI of two methods on the four datasets.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010753.s003.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010753.s004" position="float" content-type="local-data">
      <label>S4 Fig</label>
      <caption>
        <title>The performance of the different methods by NMI metrics on all 15 datasets.</title>
        <p>(A-C) The NMI of the different methods on the three large datasets (A), six gold standard datasets (B) and six silver standard datasets (C), where the COVID19-MT refers to the major cell types label, and COVID19-CT refers to the cell types label provided by author in COVID19 dataset. (D) The summary of NMI of the different methods on 15 datasets.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010753.s004.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010753.s005" position="float" content-type="local-data">
      <label>S5 Fig</label>
      <caption>
        <title>The influence of the data preprocessing steps on clustering accuracy.</title>
        <p>(A) Clustering performance with and without preprocessing, in which "ALL" refers to using all four preprocessing steps including normalization, logarithmic transformation, selection of high variable genes (HVG) and scaling (zero mean and equal variance), and ‘None’ refers to omitting all four steps. (B-E) Comparison of clustering accuracy between removing one of the steps and ‘ALL’, including removing normalization (B) logarithmic transformation (C), selection of high variable genes (D) and scaling (E).</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010753.s005.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010753.s006" position="float" content-type="local-data">
      <label>S6 Fig</label>
      <caption>
        <title>The accuracy of the number of clusters estimated by different methods on the twelve gold/silver standard datasets.</title>
        <p>(A-D) The Pearson correlation between the estimated number of clusters and the ground-truth (Reference) across different methods: Secuer: based on the community detection on the anchor graph (A), Secuer-eigen: based on the eigenvalues of bipartite graph Laplacian between cells and anchors (B) (see <xref rid="sec009" ref-type="sec">Materials and Methods</xref>), Louvain (C), and Leiden (D). The mean absolute error (MSE) for each method is shown in the top left corner of the plot.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010753.s006.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010753.s007" position="float" content-type="local-data">
      <label>S7 Fig</label>
      <caption>
        <title>The Secuer-consensus parameters benchmarked on twelve datasets.</title>
        <p>(A-C) Clustering accuracy quantified by ARI (A) and NMI (B) vs. the number of repetitions in consensus clustering (<italic toggle="yes">M</italic>) outputs of Secuer fed into Secuer-consensus (i.e., Secuer-C) over different datasets. (C) Runtime vs. <italic toggle="yes">M</italic> over different datasets.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010753.s007.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010753.s008" position="float" content-type="local-data">
      <label>S8 Fig</label>
      <caption>
        <title>The runtime of Secuer and Secuer-consensus using parallel computation.</title>
        <p>(A) Clustering time of Secuer (A) and Secuer-consensus (i.e., Secuer-C) (B) vs. the number of cores used in parallel computation on different datasets.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010753.s008.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010753.s009" position="float" content-type="local-data">
      <label>S1 Table</label>
      <caption>
        <title>Overview of scRNA-seq benchmark datasets in this study.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1010753.s009.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010753.s010" position="float" content-type="local-data">
      <label>S2 Table</label>
      <caption>
        <title>Overview of scRNA-seq benchmark datasets in <xref rid="pcbi.1010753.s001" ref-type="supplementary-material">S1 Fig</xref>.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1010753.s010.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We would like to thank Dr. Franziska Michor and her group at Harvard University and Dana-Farber Cancer Institute for helpful discussions and suggestions. We would like to thank Wu and Zheng labs for helpful discussions. We gratefully acknowledge the High-performance Computing Platform of Peking University for conducting the scRNA-seq data analyses.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1010753.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Kolodziejczyk</surname><given-names>AA</given-names></name>, <name><surname>Kim</surname><given-names>JK</given-names></name>, <name><surname>Svensson</surname><given-names>V</given-names></name>, <name><surname>Marioni</surname><given-names>JC</given-names></name>, <name><surname>Teichmann</surname><given-names>SA</given-names></name>. <article-title>The technology and biology of single-cell RNA sequencing</article-title>. <source>Mol Cell</source>. <year>2015</year>;<volume>58</volume>(<issue>4</issue>):<fpage>610</fpage>–<lpage>20</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.molcel.2015.04.005</pub-id><?supplied-pmid 26000846?><pub-id pub-id-type="pmid">26000846</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Ziegenhain</surname><given-names>C</given-names></name>, <name><surname>Vieth</surname><given-names>B</given-names></name>, <name><surname>Parekh</surname><given-names>S</given-names></name>, <name><surname>Reinius</surname><given-names>B</given-names></name>, <name><surname>Guillaumet-Adkins</surname><given-names>A</given-names></name>, <name><surname>Smets</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Comparative analysis of single-cell RNA sequencing methods</article-title>. <source>Mol cell</source>. <year>2017</year>;<volume>65</volume>(<issue>4</issue>):<fpage>631</fpage>–<lpage>43</lpage>. e4. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.molcel.2017.01.023</pub-id><?supplied-pmid 28212749?><pub-id pub-id-type="pmid">28212749</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>D</given-names></name>, <name><surname>Bodovitz</surname><given-names>S</given-names></name>. <article-title>Single cell analysis: the new frontier in ‘omics’</article-title>. <source>Trends Biotechnol</source>. <year>2010</year>;<volume>28</volume>(<issue>6</issue>):<fpage>281</fpage>–<lpage>90</lpage>.<pub-id pub-id-type="pmid">20434785</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Brbić</surname><given-names>M</given-names></name>, <name><surname>Zitnik</surname><given-names>M</given-names></name>, <name><surname>Wang</surname><given-names>S</given-names></name>, <name><surname>Pisco</surname><given-names>AO</given-names></name>, <name><surname>Altman</surname><given-names>RB</given-names></name>, <name><surname>Darmanis</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>MARS: discovering novel cell types across heterogeneous single-cell experiments</article-title>. <source>Nat Methods</source>. <year>2020</year>;<volume>17</volume>(<issue>12</issue>):<fpage>1200</fpage>–<lpage>6</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41592-020-00979-3</pub-id><?supplied-pmid 33077966?><pub-id pub-id-type="pmid">33077966</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Ren</surname><given-names>X</given-names></name>, <name><surname>Wen</surname><given-names>W</given-names></name>, <name><surname>Fan</surname><given-names>X</given-names></name>, <name><surname>Hou</surname><given-names>W</given-names></name>, <name><surname>Su</surname><given-names>B</given-names></name>, <name><surname>Cai</surname><given-names>P</given-names></name>, <etal>et al</etal>. <article-title>COVID-19 immune features revealed by a large-scale single-cell transcriptome atlas</article-title>. <source>Cell</source>. <year>2021</year>;<volume>184</volume>(<issue>7</issue>):<fpage>1895</fpage>–<lpage>913. e19</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2021.01.053</pub-id><?supplied-pmid 33657410?><pub-id pub-id-type="pmid">33657410</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Duò</surname><given-names>A</given-names></name>, <name><surname>Robinson</surname><given-names>MD</given-names></name>, <name><surname>Soneson</surname><given-names>C</given-names></name>. <article-title>A systematic performance evaluation of clustering methods for single-cell RNA-seq data</article-title>. <source>F1000Res</source>. <year>2018</year>;<fpage>7</fpage>.<pub-id pub-id-type="pmid">29527296</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Butler</surname><given-names>A</given-names></name>, <name><surname>Hoffman</surname><given-names>P</given-names></name>, <name><surname>Smibert</surname><given-names>P</given-names></name>, <name><surname>Papalexi</surname><given-names>E</given-names></name>, <name><surname>Satija</surname><given-names>R</given-names></name>. <article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>. <source>Nat Biotechnol</source>. <year>2018</year>;<volume>36</volume>(<issue>5</issue>):<fpage>411</fpage>–<lpage>20</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nbt.4096</pub-id><?supplied-pmid 29608179?><pub-id pub-id-type="pmid">29608179</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Wolf</surname><given-names>FA</given-names></name>, <name><surname>Angerer</surname><given-names>P</given-names></name>, <name><surname>Theis</surname><given-names>FJ</given-names></name>. <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>. <source>Genome Biol</source>. <year>2018</year>;<volume>19</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">29301551</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Blondel</surname><given-names>VD</given-names></name>, <name><surname>Guillaume</surname><given-names>J-L</given-names></name>, <name><surname>Lambiotte</surname><given-names>R</given-names></name>, <name><surname>Lefebvre</surname><given-names>E</given-names></name>. <article-title>Fast unfolding of communities in large networks</article-title>. <source>J Stat Mech</source><year>2008</year>;<volume>2008</volume>(<issue>10</issue>):<fpage>P10008</fpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Traag</surname><given-names>VA</given-names></name>, <name><surname>Waltman</surname><given-names>L</given-names></name>, <name><surname>van Eck</surname><given-names>NJ</given-names></name>. <article-title>From Louvain to Leiden: guaranteeing well-connected communities</article-title>. <source>Sci Rep.</source><year>2019</year>;<volume>9</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">30626917</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Von Luxburg</surname><given-names>U.</given-names></name><article-title>A tutorial on spectral clustering</article-title>. <source>Statistics and computing</source>. <year>2007</year>;<volume>17</volume>(<issue>4</issue>):<fpage>395</fpage>–<lpage>416</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Huang</surname><given-names>D</given-names></name>, <name><surname>Wang</surname><given-names>C-D</given-names></name>, <name><surname>Wu</surname><given-names>J-S</given-names></name>, <name><surname>Lai</surname><given-names>J-H</given-names></name>, <name><surname>Kwoh</surname><given-names>C-K</given-names></name>, <name><surname>Engineering</surname><given-names>D</given-names></name>. <article-title>Ultra-scalable spectral clustering and ensemble clustering</article-title>. <source>IEEE Trans Comput</source>. <year>2019</year>;<volume>32</volume>(<issue>6</issue>):<fpage>1212</fpage>–<lpage>26</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>X</given-names></name>, <name><surname>Cai</surname><given-names>D</given-names></name>, editors. L<article-title>arge scale spectral clustering with landmark-based representation</article-title>. <source>2011: Twenty-fifth AAAI conference on artificial intelligence</source>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Cai</surname><given-names>D</given-names></name>, <name><surname>Chen</surname><given-names>X</given-names></name>. <article-title>Large Scale Spectral Clustering Via Landmark-Based Sparse Representation</article-title>. <source>IEEE Transactions on Cybernetics</source>. <year>2015</year>;<volume>45</volume>(<issue>8</issue>):<fpage>1669</fpage>–<lpage>80</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/TCYB.2014.2358564</pub-id><?supplied-pmid 25265642?><pub-id pub-id-type="pmid">25265642</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Kiselev</surname><given-names>VY</given-names></name>, <name><surname>Kirschner</surname><given-names>K</given-names></name>, <name><surname>Schaub</surname><given-names>MT</given-names></name>, <name><surname>Andrews</surname><given-names>T</given-names></name>, <name><surname>Yiu</surname><given-names>A</given-names></name>, <name><surname>Chandra</surname><given-names>T</given-names></name>, <etal>et al</etal>. <article-title>SC3: consensus clustering of single-cell RNA-seq data</article-title>. <source>Nat methods</source>. <year>2017</year>;<volume>14</volume>(<issue>5</issue>):<fpage>483</fpage>–<lpage>6</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nmeth.4236</pub-id><?supplied-pmid 28346451?><pub-id pub-id-type="pmid">28346451</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Do</surname><given-names>VH</given-names></name>, <name><surname>Rojas Ringeling</surname><given-names>F</given-names></name>, <name><surname>Canzar</surname><given-names>S</given-names></name>. <article-title>Linear-time cluster ensembles of large-scale single-cell RNA-seq and multimodal data</article-title>. <source>Genome Res</source>. <year>2021</year>;<volume>31</volume>(<issue>4</issue>):<fpage>677</fpage>–<lpage>88</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1101/gr.267906.120</pub-id> .<?supplied-pmid 33627473?><pub-id pub-id-type="pmid">33627473</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>Z</given-names></name>, <name><surname>Wu</surname><given-names>X-M</given-names></name>, <name><surname>Chang</surname><given-names>S-F</given-names></name>, editors. <article-title>Segmentation using superpixels: A bipartite graph partitioning approach</article-title>. <source>2012: IEEE conference on computer vision and pattern recognition</source>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Hubert</surname><given-names>L</given-names></name>, <name><surname>Arabie</surname><given-names>P</given-names></name>. <article-title>Comparing partitions</article-title>. <source>J Classif</source>. <year>1985</year>;<volume>2</volume>(<issue>1</issue>):<fpage>193</fpage>–<lpage>218</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Strehl</surname><given-names>A</given-names></name>, <name><surname>Ghosh</surname><given-names>J</given-names></name>. <article-title>Cluster ensembles—a knowledge reuse framework for combining multiple partitions</article-title>. <source>J Mach Learn Res.</source><year>2003</year>;<volume>3</volume>(<issue>3/1/2003</issue>):<fpage>583</fpage>–<lpage>617</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1162/153244303321897735</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>McInnes</surname><given-names>L</given-names></name>, <name><surname>Healy</surname><given-names>J</given-names></name>, <name><surname>Melville</surname><given-names>J</given-names></name>. <article-title>Umap: Uniform manifold approximation and projection for dimension reduction</article-title>. <source>J arXiv preprint arXiv:03426</source>. <year>2018</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Xie</surname><given-names>K</given-names></name>, <name><surname>Huang</surname><given-names>Y</given-names></name>, <name><surname>Zeng</surname><given-names>F</given-names></name>, <name><surname>Liu</surname><given-names>Z</given-names></name>, <name><surname>Chen</surname><given-names>T</given-names></name>. <article-title>scAIDE: clustering of large-scale single-cell RNA-seq data reveals putative and rare cell types</article-title>. <source>NAR genom bioinform</source>. <year>2020</year>;<volume>2</volume>(<issue>4</issue>):<fpage>lqaa082</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nargab/lqaa082</pub-id><?supplied-pmid 33575628?><pub-id pub-id-type="pmid">33575628</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Tian</surname><given-names>T</given-names></name>, <name><surname>Zhang</surname><given-names>J</given-names></name>, <name><surname>Lin</surname><given-names>X</given-names></name>, <name><surname>Wei</surname><given-names>Z</given-names></name>, <name><surname>Hakonarson</surname><given-names>H</given-names></name>. <article-title>Model-based deep embedding for constrained clustering analysis of single cell RNA-seq data</article-title>. <source>Nat Commun</source>. <year>2021</year>;<volume>12</volume>(<issue>1</issue>):<fpage>1873</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-021-22008-3</pub-id><?supplied-pmid 33767149?><pub-id pub-id-type="pmid">33767149</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Huang</surname><given-names>D</given-names></name>, <name><surname>Wang</surname><given-names>CD</given-names></name>, <name><surname>Lai</surname><given-names>JH</given-names></name>, <name><surname>Kwoh</surname><given-names>CK</given-names></name>. <article-title>Toward Multidiversified Ensemble Clustering of High-Dimensional Data: From Subspaces to Metrics and Beyond</article-title>. <source>IEEE Transactions on Cybernetics</source>. <year>2022</year>;<volume>52</volume>(<issue>11</issue>):<fpage>12231</fpage>–<lpage>44</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/TCYB.2021.3049633</pub-id><?supplied-pmid 33961570?><pub-id pub-id-type="pmid">33961570</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Chung</surname><given-names>FR</given-names></name>, <name><surname>Graham</surname><given-names>FC</given-names></name>. <source>Spectral graph theory: American Mathematical Soc.</source>; <year>1997</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Shi</surname><given-names>J</given-names></name>, <name><surname>Malik</surname><given-names>J</given-names></name>. <article-title>Normalized cuts and image segmentation</article-title>. <source>IEEE Trans Pattern Anal Mach Intell</source>. <year>2000</year>;<volume>22</volume>(<issue>8</issue>):<fpage>888</fpage>–<lpage>905</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Biase</surname><given-names>FH</given-names></name>, <name><surname>Cao</surname><given-names>X</given-names></name>, <name><surname>Zhong</surname><given-names>S</given-names></name>. <article-title>Cell fate inclination within 2-cell and 4-cell mouse embryos revealed by single-cell RNA sequencing</article-title>. <source>Genome Res</source>. <year>2014</year>;<volume>24</volume>(<issue>11</issue>):<fpage>1787</fpage>–<lpage>96</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1101/gr.177725.114</pub-id><?supplied-pmid 25096407?><pub-id pub-id-type="pmid">25096407</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Deng</surname><given-names>Q</given-names></name>, <name><surname>Ramsköld</surname><given-names>D</given-names></name>, <name><surname>Reinius</surname><given-names>B</given-names></name>, <name><surname>Sandberg</surname><given-names>R</given-names></name>. <article-title>Single-cell RNA-seq reveals dynamic, random monoallelic gene expression in mammalian cells</article-title>. <source>Science</source>. <year>2014</year>;<volume>343</volume>(<issue>6167</issue>):<fpage>193</fpage>–<lpage>6</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.1245316</pub-id><?supplied-pmid 24408435?><pub-id pub-id-type="pmid">24408435</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Patel</surname><given-names>AP</given-names></name>, <name><surname>Tirosh</surname><given-names>I</given-names></name>, <name><surname>Trombetta</surname><given-names>JJ</given-names></name>, <name><surname>Shalek</surname><given-names>AK</given-names></name>, <name><surname>Gillespie</surname><given-names>SM</given-names></name>, <name><surname>Wakimoto</surname><given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Single-cell RNA-seq highlights intratumoral heterogeneity in primary glioblastoma</article-title>. <source>Science</source>. <year>2014</year>;<volume>344</volume>(<issue>6190</issue>):<fpage>1396</fpage>–<lpage>401</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.1254257</pub-id><?supplied-pmid 24925914?><pub-id pub-id-type="pmid">24925914</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Pollen</surname><given-names>AA</given-names></name>, <name><surname>Nowakowski</surname><given-names>TJ</given-names></name>, <name><surname>Shuga</surname><given-names>J</given-names></name>, <name><surname>Wang</surname><given-names>X</given-names></name>, <name><surname>Leyrat</surname><given-names>AA</given-names></name>, <name><surname>Lui</surname><given-names>JH</given-names></name>, <etal>et al</etal>. <article-title>Low-coverage single-cell mRNA sequencing reveals cellular heterogeneity and activated signaling pathways in developing cerebral cortex</article-title>. <source>Nat Biotechnol</source>. <year>2014</year>;<volume>32</volume>(<issue>10</issue>):<fpage>1053</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nbt.2967</pub-id><?supplied-pmid 25086649?><pub-id pub-id-type="pmid">25086649</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Goolam</surname><given-names>M</given-names></name>, <name><surname>Scialdone</surname><given-names>A</given-names></name>, <name><surname>Graham</surname><given-names>SJ</given-names></name>, <name><surname>Macaulay</surname><given-names>IC</given-names></name>, <name><surname>Jedrusik</surname><given-names>A</given-names></name>, <name><surname>Hupalowska</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Heterogeneity in Oct4 and Sox2 targets biases cell fate in 4-cell mouse embryos</article-title>. <source>Cell</source>. <year>2016</year>;<volume>165</volume>(<issue>1</issue>):<fpage>61</fpage>–<lpage>74</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2016.01.047</pub-id><?supplied-pmid 27015307?><pub-id pub-id-type="pmid">27015307</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Shekhar</surname><given-names>K</given-names></name>, <name><surname>Lapan</surname><given-names>SW</given-names></name>, <name><surname>Whitney</surname><given-names>IE</given-names></name>, <name><surname>Tran</surname><given-names>NM</given-names></name>, <name><surname>Macosko</surname><given-names>EZ</given-names></name>, <name><surname>Kowalczyk</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Comprehensive Classification of Retinal Bipolar Neurons by Single-Cell Transcriptomics</article-title>. <source>Cell</source>. <year>2016</year>;<volume>166</volume>(<issue>5</issue>):<fpage>1308</fpage>–<lpage>23.e30</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2016.07.054</pub-id> .<?supplied-pmid 27565351?><pub-id pub-id-type="pmid">27565351</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Cao</surname><given-names>J</given-names></name>, <name><surname>Packer</surname><given-names>JS</given-names></name>, <name><surname>Ramani</surname><given-names>V</given-names></name>, <name><surname>Cusanovich</surname><given-names>DA</given-names></name>, <name><surname>Huynh</surname><given-names>C</given-names></name>, <name><surname>Daza</surname><given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Comprehensive single-cell transcriptional profiling of a multicellular organism</article-title>. <source>Science</source>. <year>2017</year>;<volume>357</volume>(<issue>6352</issue>):<fpage>661</fpage>–<lpage>7</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.aam8940</pub-id><?supplied-pmid 28818938?><pub-id pub-id-type="pmid">28818938</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Zheng</surname><given-names>GXY</given-names></name>, <name><surname>Terry</surname><given-names>JM</given-names></name>, <name><surname>Belgrader</surname><given-names>P</given-names></name>, <name><surname>Ryvkin</surname><given-names>P</given-names></name>, <name><surname>Bent</surname><given-names>ZW</given-names></name>, <name><surname>Wilson</surname><given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Massively parallel digital transcriptional profiling of single cells</article-title>. <source>Nat Commun</source>. <year>2017</year>;<volume>8</volume>(<issue>1</issue>):<fpage>14049</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/ncomms14049</pub-id><?supplied-pmid 28091601?><pub-id pub-id-type="pmid">28091601</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Han</surname><given-names>X</given-names></name>, <name><surname>Wang</surname><given-names>R</given-names></name>, <name><surname>Zhou</surname><given-names>Y</given-names></name>, <name><surname>Fei</surname><given-names>L</given-names></name>, <name><surname>Sun</surname><given-names>H</given-names></name>, <name><surname>Lai</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Mapping the Mouse Cell Atlas by Microwell-Seq</article-title>. <source>Cell</source>. <year>2018</year>;<volume>172</volume>(<issue>5</issue>):<fpage>1091</fpage>–<lpage>107.e17</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2018.02.001</pub-id><?supplied-pmid 29474909?><pub-id pub-id-type="pmid">29474909</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Innes</surname><given-names>BT</given-names></name>, <name><surname>Bader</surname><given-names>GD</given-names></name>. <article-title>scClustViz–Single-cell RNAseq cluster assessment and visualization</article-title>. <source>F1000Res</source>. <year>2018</year>;<fpage>7</fpage>.<pub-id pub-id-type="pmid">29527296</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Young</surname><given-names>MD</given-names></name>, <name><surname>Mitchell</surname><given-names>TJ</given-names></name>, <name><surname>Braga</surname><given-names>FAV</given-names></name>, <name><surname>Tran</surname><given-names>MG</given-names></name>, <name><surname>Stewart</surname><given-names>BJ</given-names></name>, <name><surname>Ferdinand</surname><given-names>JR</given-names></name>, <etal>et al</etal>. <article-title>Single-cell transcriptomes from human kidneys reveal the cellular identity of renal tumors</article-title>. <source>Science</source>. <year>2018</year>;<volume>361</volume>(<issue>6402</issue>):<fpage>594</fpage>–<lpage>9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.aat1699</pub-id><?supplied-pmid 30093597?><pub-id pub-id-type="pmid">30093597</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Mimitou</surname><given-names>EP</given-names></name>, <name><surname>Cheng</surname><given-names>A</given-names></name>, <name><surname>Montalbano</surname><given-names>A</given-names></name>, <name><surname>Hao</surname><given-names>S</given-names></name>, <name><surname>Stoeckius</surname><given-names>M</given-names></name>, <name><surname>Legut</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Multiplexed detection of proteins, transcriptomes, clonotypes and CRISPR perturbations in single cells</article-title>. <source>Nat methods</source>. <year>2019</year>;<volume>16</volume>(<issue>5</issue>):<fpage>409</fpage>–<lpage>12</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41592-019-0392-0</pub-id><?supplied-pmid 31011186?><pub-id pub-id-type="pmid">31011186</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>MJ</given-names></name>, <name><surname>Pisco</surname><given-names>AO</given-names></name>, <name><surname>Darmanis</surname><given-names>S</given-names></name>, <name><surname>Zou</surname><given-names>J</given-names></name>. <article-title>Mouse aging cell atlas analysis reveals global and cell type-specific aging signatures</article-title>. <source>eLife</source>. <year>2021</year>;<volume>10</volume>:<fpage>e62293</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.7554/eLife.62293</pub-id><?supplied-pmid 33847263?><pub-id pub-id-type="pmid">33847263</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Fei</surname><given-names>L</given-names></name>, <name><surname>Chen</surname><given-names>H</given-names></name>, <name><surname>Ma</surname><given-names>L</given-names></name>, <name><surname>E</surname><given-names>W</given-names></name>, <name><surname>Wang</surname><given-names>R</given-names></name>, <name><surname>Fang</surname><given-names>X</given-names></name>, <etal>et al</etal>. <article-title>Systematic identification of cell-fate regulatory programs using a single-cell atlas of mouse development</article-title>. <source>Nature Genetics</source>. <year>2022</year>;<volume>54</volume>(<issue>7</issue>):<fpage>1051</fpage>–<lpage>61</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41588-022-01118-8</pub-id><?supplied-pmid 35817981?><pub-id pub-id-type="pmid">35817981</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>R</given-names></name>, <name><surname>Zhang</surname><given-names>P</given-names></name>, <name><surname>Wang</surname><given-names>J</given-names></name>, <name><surname>Ma</surname><given-names>L</given-names></name>, <name><surname>E</surname><given-names>W</given-names></name>, <name><surname>Suo</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Construction of a cross-species cell landscape at single-cell level</article-title>. <source>Nucleic Acids Research</source>. <year>2022</year>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkac633</pub-id><?supplied-pmid 35929025?><pub-id pub-id-type="pmid">35929025</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Consortium</surname><given-names>TM</given-names></name>. <article-title>A single cell transcriptomic atlas characterizes aging tissues in the mouse</article-title>. <source>Nature</source>. <year>2020</year>;<volume>583</volume>(<issue>7817</issue>):<fpage>590</fpage>.<pub-id pub-id-type="pmid">32669714</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Tian</surname><given-names>T</given-names></name>, <name><surname>Wan</surname><given-names>J</given-names></name>, <name><surname>Song</surname><given-names>Q</given-names></name>, <name><surname>Wei</surname><given-names>Z</given-names></name>. <article-title>Clustering single-cell RNA-seq data with a model-based deep learning approach</article-title>. <source>Nat Mach Intell</source>. <year>2019</year>;<volume>1</volume>(<issue>4</issue>):<fpage>191</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s42256-019-0037-0</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010753.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Germain</surname><given-names>P-L</given-names></name>, <name><surname>Sonrel</surname><given-names>A</given-names></name>, <name><surname>Robinson</surname><given-names>MD</given-names></name>. <article-title>pipeComp, a general framework for the evaluation of computational pipelines, reveals performant single cell RNA-seq preprocessing tools</article-title>. <source>Genome Biol</source>. <year>2020</year>;<volume>21</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>28</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13059-020-02136-7</pub-id><?supplied-pmid 32873325?><pub-id pub-id-type="pmid">32873325</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="aggregated-review-documents" id="pcbi.1010753.r001" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010753.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ioshikhes</surname>
          <given-names>Ilya</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fariselli</surname>
          <given-names>Piero</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Ioshikhes, Fariselli</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Ioshikhes, Fariselli</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010753" id="rel-obj001" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">28 Oct 2022</named-content>
    </p>
    <p>Dear Dr. Zheng,</p>
    <p>Thank you very much for submitting your manuscript "Secuer: ultrafast, scalable and accurate clustering of single-cell RNA-seq data" for consideration at PLOS Computational Biology. As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. The reviewers appreciated the attention to an important topic. Based on the reviews, we are likely to accept this manuscript for publication, providing that you modify the manuscript according to the review recommendations.</p>
    <p>Please prepare and submit your revised manuscript within 30 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to all review comments, and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Thank you again for your submission to our journal. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Piero Fariselli</p>
    <p>Academic Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Lucy Houghton</p>
    <p>Staff</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>A link appears below if there are any accompanying review attachments. If you believe any reviews to be missing, please contact <email>ploscompbiol@plos.org</email> immediately:</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: This paper presents a bipartite graph based clustering algorithm for single-cell RNA-seq clustering. This work is similar to the U-SPEC algorithm in [23]. Please provide more detailed and specific discussions about the similarity and dissimilarity between the proposed algorithm and the U-SPEC algorithm. Experimental comparison between the proposed algorithm and the U-SPEC algorithm is also suggested.</p>
    <p>In the experiments, the benchmark datasets and the baseline algorithms should be described with more details. An additional table of their statistics can help improve the clarity.</p>
    <p>In the reference [23], multiple U-SPEC clusterers are jointly modeled via an ensemble clustering strategy. Similarly, some ensemble clustering techniques, such as multidiversified ensemble clustering (MDEC) and enhanced ensemble clustering via fast propagation of cluster-wise similarities, can also be considered in the future extensions.</p>
    <p>Reviewer #2: The authors propose a sound and elegant clustering approach that shows notable (time and memory) efficiency for massive data while remaining accuracy-wise competitive with state-of-the-art alternatives. To this end, Secuer relies on simplistic yet highly effective principles: pivoting of anchors for scaling up efficiency, anchor neighborhood per observation, locally-scaled Gaussian kernel on the neighborhoods to better capture observation-to-anchor similarity, and automated estimation of the number of clusters.</p>
    <p>The manuscript is written with outmost clarity, simplicity, and rigor.</p>
    <p>The experiments are comprehensive and appropriate to assess the bold claims. Comparison against state-of-the-art approaches, as well sensitivity analysis on the parameters, is conducted across a large base of dataset, including diverse scRNA-seq datasets, complementary large real-world datasets, well-annotated benchmarks, and synthetic data.</p>
    <p>The software is provided as an open-source module in GitHub, ensuring the reproducibility of the acquired results.</p>
    <p>Some minor-moderate concerns:</p>
    <p>1) consider moderating a few claims:</p>
    <p>- "Secuer enjoys reduced runtime and memory usage by orders of magnitude" -&gt; over one order of magnitude for datasets with more than 1 million cells</p>
    <p>- "again greatly improves"</p>
    <p>2) it is not always clear what is the default estimator to approximate the number of clusters in Secuer,</p>
    <p>please clarify whether you opted to use the Louvain estimator on the anchors or the near-zero eigenvalue method. It is also not completely clear whether the later method was assessed.</p>
    <p>In addition, consider disclosing in the overview the selected community detection method, as well as adding reference [11] after "near-zero eigenvalues of the graph Laplacian (see Materials and Methods)".</p>
    <p>3) to fully attest the scalable nature of the proposed approach, consider further assessing whether Secuer can be parallelized/distributed and, if so, introducing high-level principles to this end</p>
    <p>4) the intuition for the locally-scaled Gaussian kernel is a simple one, please briefly provide it in the Overview instead of referencing "Materials and Methods"</p>
    <p>5) "The preprocessing involves four steps: 1) gene/cell filtering; 2) normalization; 3) selection of highly variable genes; 4) dimension reduction by PCA" -&gt; please ensure that the applied preprocessing parameters are available for all the tested datasets as they critically impact experiments</p>
    <p>6) minor notes on complexity majorants:</p>
    <p>- (2) -&gt; please introduce d and N right after or at the beginning ('Let d and N be...')</p>
    <p>- (1/2) -&gt; provide the intuition for the squared root of 'p' in the Materials and further disclose the meaning of 'o' parameter</p>
    <p>7) proof-check for minor language aspects:</p>
    <p>- method Secuer for -&gt; method, Secuer, for</p>
    <p>- Fig1F -&gt; Fig 1F</p>
    <p>- "It appears that" -&gt; consider instead referencing memory 'estimates' to avoid 'appears'</p>
    <p>- "divide the graph into disjoint subgraphs" -&gt; please validate the use of 'disjoint'</p>
    <p>8) few notes on the supplementary material</p>
    <p>- reformat S1</p>
    <p>- no information is provided on the simulated datasets in S3, please clarify the generation procedure</p>
    <p>- consider starting from a lower number of solutions in S7 to better assess the impact of consensus</p>
    <p>I hope these comments are useful and wish to see your work published in the near future,</p>
    <p>Kind regards</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: None</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>Figure Files:</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link xlink:href="https://pacev2.apexcovantage.com" ext-link-type="uri">https://pacev2.apexcovantage.com</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>.</p>
    <p>Data Requirements:</p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5" ext-link-type="uri">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>Reproducibility:</p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
    <p>References:</p>
    <p>Review your reference list to ensure that it is complete and correct. If you have cited papers that have been retracted, please include the rationale for doing so in the manuscript text, or remove these references and replace them with relevant current references. Any changes to the reference list should be mentioned in the rebuttal letter that accompanies your revised manuscript.</p>
    <p>
      <italic toggle="yes">If you need to cite a retracted article, indicate the article’s retracted status in the References list and also include a citation and full reference for the retraction notice.</italic>
    </p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pcbi.1010753.r002">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010753.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010753" id="rel-obj002" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">17 Nov 2022</named-content>
    </p>
    <supplementary-material id="pcbi.1010753.s011" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Response-Letter.docx</named-content></p>
      </caption>
      <media xlink:href="pcbi.1010753.s011.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="aggregated-review-documents" id="pcbi.1010753.r003" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010753.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ioshikhes</surname>
          <given-names>Ilya</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fariselli</surname>
          <given-names>Piero</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Ioshikhes, Fariselli</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Ioshikhes, Fariselli</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010753" id="rel-obj003" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">22 Nov 2022</named-content>
    </p>
    <p>Dear Dr. Zheng,</p>
    <p>We are pleased to inform you that your manuscript 'Secuer: ultrafast, scalable and accurate clustering of single-cell RNA-seq data' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Piero Fariselli</p>
    <p>Academic Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Lucy Houghton</p>
    <p>Staff</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: The authors have well addressed my concerns.</p>
    <p>Reviewer #2: Thank you for the undertaken care and effort on revising the manuscript in accordance with the few suggestions,</p>
    <p>The authors have successfully addressed my concerns</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: None</p>
    <p>Reviewer #2: None</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pcbi.1010753.r004" specific-use="acceptance-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010753.r004</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ioshikhes</surname>
          <given-names>Ilya</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fariselli</surname>
          <given-names>Piero</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Ioshikhes, Fariselli</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Ioshikhes, Fariselli</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010753" id="rel-obj004" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">30 Nov 2022</named-content>
    </p>
    <p>PCOMPBIOL-D-22-01465R1 </p>
    <p>Secuer: ultrafast, scalable and accurate clustering of single-cell RNA-seq data</p>
    <p>Dear Dr Zheng,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Zsofi Zombor</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link xlink:href="http://ploscompbiol.org" ext-link-type="uri">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
