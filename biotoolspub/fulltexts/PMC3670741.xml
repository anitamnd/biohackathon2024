<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Mol Biol Evol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Mol. Biol. Evol</journal-id>
    <journal-id journal-id-type="publisher-id">molbev</journal-id>
    <journal-id journal-id-type="hwp">molbiolevol</journal-id>
    <journal-title-group>
      <journal-title>Molecular Biology and Evolution</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0737-4038</issn>
    <issn pub-type="epub">1537-1719</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3670741</article-id>
    <article-id pub-id-type="doi">10.1093/molbev/mst024</article-id>
    <article-id pub-id-type="publisher-id">mst024</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methods</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Ultrafast Approximation for Phylogenetic Bootstrap</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Minh</surname>
          <given-names>Bui Quang</given-names>
        </name>
        <xref ref-type="corresp" rid="mst024-COR1">*</xref>
        <xref ref-type="aff" rid="mst024-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nguyen</surname>
          <given-names>Minh Anh Thi</given-names>
        </name>
        <xref ref-type="aff" rid="mst024-AFF2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>von Haeseler</surname>
          <given-names>Arndt</given-names>
        </name>
        <xref ref-type="corresp" rid="mst024-COR1">*</xref>
        <xref ref-type="aff" rid="mst024-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="mst024-AFF1"><sup>1</sup>Center for Integrative Bioinformatics Vienna, Max F. Perutz Laboratories, University of Vienna, Medical University of Vienna, Vienna, Austria</aff>
    <aff id="mst024-AFF2"><sup>2</sup>Groningen Bioinformatics Centre, University of Groningen, Groningen, The Netherlands</aff>
    <author-notes>
      <corresp id="mst024-COR1"><bold>*Corresponding authors:</bold> E-mail: <email>minh.bui@univie.ac.at</email>; <email>arndt.von.haeseler@univie.ac.at</email>.</corresp>
      <fn>
        <p><bold>Associate editor:</bold> Naruya Saitou</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>5</month>
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>2</month>
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>15</day>
      <month>2</month>
      <year>2013</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>30</volume>
    <issue>5</issue>
    <fpage>1188</fpage>
    <lpage>1195</lpage>
    <permissions>
      <copyright-statement>© The Author 2013. Published by Oxford University Press on behalf of the Society for Molecular Biology and Evolution.</copyright-statement>
      <copyright-year>2013</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">http://creativecommons.org/licenses/by-nc/3.0/</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Nonparametric bootstrap has been a widely used tool in phylogenetic analysis to assess the clade support of phylogenetic trees. However, with the rapidly growing amount of data, this task remains a computational bottleneck. Recently, approximation methods such as the RAxML rapid bootstrap (RBS) and the Shimodaira–Hasegawa-like approximate likelihood ratio test have been introduced to speed up the bootstrap. Here, we suggest an ultrafast bootstrap approximation approach (UFBoot) to compute the support of phylogenetic groups in maximum likelihood (ML) based trees. To achieve this, we combine the resampling estimated log-likelihood method with a simple but effective collection scheme of candidate trees. We also propose a stopping rule that assesses the convergence of branch support values to automatically determine when to stop collecting candidate trees. UFBoot achieves a median speed up of 3.1 (range: 0.66–33.3) to 10.2 (range: 1.32–41.4) compared with RAxML RBS for real DNA and amino acid alignments, respectively. Moreover, our extensive simulations show that UFBoot is robust against moderate model violations and the support values obtained appear to be relatively unbiased compared with the conservative standard bootstrap. This provides a more direct interpretation of the bootstrap support. We offer an efficient and easy-to-use software (available at <ext-link ext-link-type="uri" xlink:href="http://www.cibiv.at/software/iqtree">http://www.cibiv.at/software/iqtree</ext-link>) to perform the UFBoot analysis with ML tree inference.</p>
    </abstract>
    <kwd-group>
      <kwd>phylogenetic inference</kwd>
      <kwd>nonparametric bootstrap</kwd>
      <kwd>tree reconstruction</kwd>
      <kwd>maximum likelihood</kwd>
    </kwd-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>Introduction</title>
    <p>Since the groundbreaking work of <xref ref-type="bibr" rid="mst024-B10">Felsenstein (1985)</xref>, nonparametric bootstrapping (<xref ref-type="bibr" rid="mst024-B7">Efron 1979</xref>) has become one of the widely used tools to estimate the phylogenetic support of certain clades or splits in an inferred phylogenetic tree. Here, the sequence alignment sites are sampled with replacement resulting in a number of pseudoreplicates. For every replicate, one applies a method of interest such as maximum likelihood (ML; <xref ref-type="bibr" rid="mst024-B9">Felsenstein 1981</xref>) to reconstruct a bootstrap tree. One then either constructs a consensus tree from the bootstrap trees or places the support values onto the reconstructed ML tree.</p>
    <p>Because of the enormous computation time required for the standard bootstrap (SBS) with ML, several approaches have been published to approximate SBS. Resampling estimated log-likelihoods (RELL; <xref ref-type="bibr" rid="mst024-B20">Kishino et al. 1990</xref>; <xref ref-type="bibr" rid="mst024-B16">Hasegawa and Kishino 1994</xref>) was the first attempt to avoid a full ML inference per bootstrap replicate; it reuses the log-likelihood scores calculated for individual sites in the original alignment, given the tree. RELL was used to infer local bootstrap probabilities (LBP; <xref ref-type="bibr" rid="mst024-B1">Adachi and Hasegawa 1996</xref>) of every internal branch of the ML tree by comparing the three nearest neighbor interchange (NNI) tree topologies around the branch of interest. The approximate likelihood-ratio test (aLRT; <xref ref-type="bibr" rid="mst024-B2">Anisimova and Gascuel 2006</xref>) and its nonparametric variant (SH-aLRT; <xref ref-type="bibr" rid="mst024-B14">Guindon et al. 2010</xref>) differ slightly from the method used to calculate LBP by employing the SH test (<xref ref-type="bibr" rid="mst024-B34">Shimodaira and Hasegawa 1999</xref>) on these three NNI trees. Although RELL and SH-aLRT are very fast, it is currently unclear how they perform if the four subtrees incident to that branch are not fixed. The RAxML rapid bootstrap (RBS; <xref ref-type="bibr" rid="mst024-B35">Stamatakis 2006</xref>; <xref ref-type="bibr" rid="mst024-B36">Stamatakis et al. 2008</xref>) is a recent method to resemble SBS while performing 8–20 times faster on large data sets.</p>
    <p>It has been shown that the SBS probabilities typically underestimate the true probabilities of a clade to be correct (<xref ref-type="bibr" rid="mst024-B11">Felsenstein and Kishino 1993</xref>; <xref ref-type="bibr" rid="mst024-B17">Hillis and Bull 1993</xref>). SBS is therefore biased but conservative. <xref ref-type="bibr" rid="mst024-B8">Efron et al. (1996)</xref> proposed a method to correct for this bias which, however, requires considerably more computation. Other methods include quartet puzzling (<xref ref-type="bibr" rid="mst024-B37">Strimmer and von Haeseler 1996</xref>; <xref ref-type="bibr" rid="mst024-B33">Schmidt et al. 2002</xref>) and Bayesian Markov chain Monte Carlo (MCMC) analysis (<xref ref-type="bibr" rid="mst024-B50">Yang and Rannala 1997</xref>; <xref ref-type="bibr" rid="mst024-B18">Huelsenbeck and Ronquist 2001</xref>). Bayesian MCMC methods, however, tend to overestimate the true probabilities in case of model misspecification or polytomies (<xref ref-type="bibr" rid="mst024-B40">Suzuki et al. 2002</xref>; <xref ref-type="bibr" rid="mst024-B5">Douady et al. 2003</xref>; <xref ref-type="bibr" rid="mst024-B23">Lewis et al. 2005</xref>; <xref ref-type="bibr" rid="mst024-B3">Anisimova et al. 2011</xref>). Both quartet puzzling and Bayesian MCMC methods are very time consuming for large data sets.</p>
    <sec>
      <title>New Approaches</title>
      <p>Here, we present an ultrafast bootstrap approach (UFBoot) as an alternative to the other nonparametric bootstrap approaches. To this end, we utilize the RELL concept with an efficient way of sampling plausible trees using the important quartet puzzling (IQP) with NNI (IQPNNI) algorithm (<xref ref-type="bibr" rid="mst024-B42">Vinh and von Haeseler 2004</xref>; <xref ref-type="bibr" rid="mst024-B25">Minh et al. 2005</xref>). In short, IQPNNI samples the local maxima and their neighborhoods in the tree space defined by the NNI operations. Because the number of trees encountered during the IQPNNI search might be excessively large, we adaptively estimate a log-likelihood threshold <inline-formula><inline-graphic xlink:href="mst024i1.jpg"/></inline-formula> such that we only investigate the trees with the RELL bootstrapping if their log-likelihoods are higher than <inline-formula><inline-graphic xlink:href="mst024i2.jpg"/></inline-formula>. Taken together, UFBoot first generates a number of bootstrap alignments (typically 1,000) and initializes the corresponding bootstrap trees as null. UFBoot then performs the IQPNNI tree sampling on the original alignment. Whenever a new tree <inline-formula><inline-graphic xlink:href="mst024i3.jpg"/></inline-formula> whose log-likelihood exceeds <inline-formula><inline-graphic xlink:href="mst024i4.jpg"/></inline-formula> is found, UFBoot quickly computes the RELL score of <inline-formula><inline-graphic xlink:href="mst024i5.jpg"/></inline-formula> for each bootstrap alignment. If <inline-formula><inline-graphic xlink:href="mst024i6.jpg"/></inline-formula> has a higher RELL score than that of the current bootstrap tree, UFBoot updates the current bootstrap tree as <inline-formula><inline-graphic xlink:href="mst024i7.jpg"/></inline-formula> for the corresponding bootstrap alignment. That way, UFBoot gradually rectifies the set of bootstrap trees. UFBoot stops collecting candidate trees when the correlation coefficient <inline-formula><inline-graphic xlink:href="mst024i8.jpg"/></inline-formula> of the split occurrence frequencies computed from the first half of the analysis and from the full analysis is larger than 0.99 (more details in Materials and Methods). Finally, UFBoot computes a consensus tree from the set of bootstrap trees and also maps the split support values onto the ML tree reconstructed during the IQPNNI sampling.</p>
      <p>We provide an implementation of the whole framework in the IQ-TREE package (Nguyen L-T, Minh BQ, Schmidt HA, von Haeseler A, in preparation). In the following, we compare the performance of UFBoot against other bootstrap approaches in terms of accuracy (<xref ref-type="bibr" rid="mst024-B17">Hillis and Bull 1993</xref>) and computational time.</p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <sec>
      <title>Accuracy</title>
      <p>We used simulated data (<xref ref-type="table" rid="mst024-T1">table 1</xref>; Materials and Methods) to compare four different methods (SBS with RAxML, RBS with RAxML, SH-aLRT with PhyML, and UFBoot) with respect to their accuracy defined in <xref ref-type="bibr" rid="mst024-B17">Hillis and Bull (1993)</xref>. To this end, we plot the number of true splits (i.e., splits that occur in the true trees) having support of <inline-formula><inline-graphic xlink:href="mst024i9.jpg"/></inline-formula> divided by the number of all splits with support of <inline-formula><inline-graphic xlink:href="mst024i10.jpg"/></inline-formula> (<xref ref-type="disp-formula" rid="mst024-M2">eq. 2</xref>; <xref ref-type="fig" rid="mst024-F1">fig. 1</xref>). This ratio gives the estimated probability of a split to be true. Curves above the dashed diagonal line indicate that the inferred support values underestimate this probability, and thus the corresponding method exhibits a conservative behavior. In contrast, curves below the diagonal indicate that the method overestimates the true probabilities. Methods that generate curves around the diagonal are almost unbiased.
<fig id="mst024-F1" position="float"><label>F<sc>ig</sc>. 1.</label><caption><p>Accuracies of SBS, RBS with RAxML, SH-aLRT with PhyML, and UFBoot approximation from the Yule–Harding (left panel) and the PANDIT-based simulations (right panel).</p></caption><graphic xlink:href="mst024f1p"/></fig>
<table-wrap id="mst024-T1" position="float"><label>Table 1.</label><caption><p>Simulation Settings.</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">True Tree</th><th rowspan="1" colspan="1">Data Type</th><th rowspan="1" colspan="1">No. Sequences</th><th rowspan="1" colspan="1">No. Sites</th><th rowspan="1" colspan="1">No. Alignments</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Yule–Harding</td><td align="left" rowspan="1" colspan="1">DNA</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">500</td><td rowspan="1" colspan="1">200</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">200</td><td rowspan="1" colspan="1">1,000</td><td rowspan="1" colspan="1">200</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">500</td><td rowspan="1" colspan="1">1,000</td><td rowspan="1" colspan="1">200</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">Protein</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">300</td><td rowspan="1" colspan="1">200</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">200</td><td rowspan="1" colspan="1">500</td><td rowspan="1" colspan="1">200</td></tr><tr><td rowspan="1" colspan="1">PANDIT</td><td align="left" rowspan="1" colspan="1">DNA</td><td rowspan="1" colspan="1">4–403</td><td rowspan="1" colspan="1">24–6,891</td><td rowspan="1" colspan="1">6,222</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">Protein</td><td rowspan="1" colspan="1">4–545</td><td rowspan="1" colspan="1">12–2,297</td><td rowspan="1" colspan="1">6,182</td></tr></tbody></table></table-wrap></p>
      <p><xref ref-type="fig" rid="mst024-F1">Figure 1</xref> summarizes the results for the Yule–Harding and PANDIT-based simulations (see Materials and Methods for more details). Note that the curves look similar for the seven simulation settings (<xref ref-type="table" rid="mst024-T1">table 1</xref>) and are thus not shown. SBS (blue curves) is the most conservative approach by substantially underestimating the probabilities of splits being correct for both Yule–Harding and PANDIT-based simulations. For example, a split with SBS support of 80% has indeed a probability of 0.95 to be correct. This biased but conservative behavior of SBS corroborates previous studies (<xref ref-type="bibr" rid="mst024-B17">Hillis and Bull 1993</xref>; <xref ref-type="bibr" rid="mst024-B3">Anisimova et al. 2011</xref>), which led to the widely accepted interpretation of “trusting” splits with SBS supports <inline-formula><inline-graphic xlink:href="mst024i11.jpg"/></inline-formula>. RBS (<xref ref-type="fig" rid="mst024-F1">fig. 1</xref>, yellow curves) performs very similarly to SBS but with a tendency of being less conservative.</p>
      <p>SH-aLRT (<xref ref-type="fig" rid="mst024-F1">fig. 1</xref>, black curves) is generally as conservative as SBS and RBS in the Yule–Harding simulations but becomes apparently less conservative in the PANDIT-based simulations. Moreover, low SH-aLRT split supports (<inline-formula><inline-graphic xlink:href="mst024i12.jpg"/></inline-formula>) are not informative with respect to the true probabilities. For example, splits with SH-aLRT support of 20% are as correct as those with support of 50%.</p>
      <p>UFBoot (<xref ref-type="fig" rid="mst024-F1">fig. 1</xref>, red curves) appears to be almost unbiased compared with the other methods for both simulations (i.e., the split support values obtained closely reflect the probabilities of the split being correct). UFBoot is unbiased for support values higher than <inline-formula><inline-graphic xlink:href="mst024i13.jpg"/></inline-formula>. On the other side, UFBoot support values smaller than <inline-formula><inline-graphic xlink:href="mst024i14.jpg"/></inline-formula> slightly overestimate the true probability. Such unbiased behavior simplifies the interpretation of support values reported by UFBoot. For example, a split with support of <inline-formula><inline-graphic xlink:href="mst024i15.jpg"/></inline-formula> will have a probability of 0.95 to be correct.</p>
      <p>Moreover, we assessed the impact of model misspecification on the accuracies by repeating the analysis on the simulated DNA alignments using the simpler JC + <inline-formula><inline-graphic xlink:href="mst024i16.jpg"/></inline-formula> model (<xref ref-type="bibr" rid="mst024-B19">Jukes and Cantor 1969</xref>; <xref ref-type="bibr" rid="mst024-B49">Yang 1994</xref>) and the simplest JC model (<xref ref-type="bibr" rid="mst024-B19">Jukes and Cantor 1969</xref>) for phylogenetic inference. Note that we could not repeat the same analysis with RBS and SBS, because RAxML supports only the GTR + <inline-formula><inline-graphic xlink:href="mst024i17.jpg"/></inline-formula> model (<xref ref-type="bibr" rid="mst024-B22">Lanave et al. 1984</xref>; <xref ref-type="bibr" rid="mst024-B49">Yang 1994</xref>). Alternatively, we performed SBS with 100 replicates using IQ-TREE. <xref ref-type="fig" rid="mst024-F2">Figure 2</xref> shows that model violations have almost no influence on SBS estimates with IQ-TREE (green curves) in PANDIT-based simulations (Yule–Harding data not shown). Similarly, the accuracies of SH-aLRT and UFBoot do not change under moderate model violations (JC + <inline-formula><inline-graphic xlink:href="mst024i19.jpg"/></inline-formula>). However, the split support values are inflated under severe model violations (JC). This agrees with previous studies showing that accounting for the rate heterogeneity among sites is more important than varying substitution rates (<xref ref-type="bibr" rid="mst024-B39">Sullivan and Swofford 2001</xref>; <xref ref-type="bibr" rid="mst024-B27">Nguyen et al. 2012</xref>).
<fig id="mst024-F2" position="float"><label>F<sc>ig</sc>. 2.</label><caption><p>Impact of moderate (JC + <inline-formula><inline-graphic xlink:href="mst024i18.jpg"/></inline-formula>) and severe model violations (JC) on the accuracies of SBS, SH-aLRT, and UFBoot in the PANDIT-based simulations.</p></caption><graphic xlink:href="mst024f2p"/></fig></p>
    </sec>
    <sec>
      <title>Computational Time</title>
      <p>For more than 96% of the Yule–Harding and PANDIT-based simulations the UFBoot stopping rule (see Materials and Methods) suggested to stop after 100 IQPNNI iterations. The remaining runs finished after at most 800 iterations. Thus, <inline-formula><inline-graphic xlink:href="mst024i20.jpg"/></inline-formula> is a conservative upper bound for the number of iterations to achieve high accuracy.</p>
      <p>A more detailed picture emerges from the real PANDIT data. We compared the computational times of RBS and UFBoot on 308 large (<inline-formula><inline-graphic xlink:href="mst024i21.jpg"/></inline-formula> sequences) DNA- and AA-PANDIT alignments. For a fair comparison of computing times, we apply the bootstopping criterion (-N autoMRE) (<xref ref-type="bibr" rid="mst024-B29">Pattengale et al. 2010</xref>) in the RBS search to automatically determine the number of bootstrap replicates required. For eight AA-PANDIT alignments (PF01261, PF00149, PF01546, PF01547, PF01636, PF00496, PF00501, and PF07690) RAxML did not finish after more than 1 week of computation, the runs were then stopped by our computing system. These alignments were excluded from our analysis, leaving us with 300 alignments. The bootstopping criterion of RBS yielded an average of 528 bootstrap replicates. The number of bootstrap replicates varied between 250 and 1,000 (the default upper limit in RAxML), where 5 alignments needed 250 replicates and 1 alignment hit the upper limit.</p>
      <p>Our UFBoot stopping rule suggested on average 453 IQPNNI iterations for all alignments. We observed that for 80 (27%) alignments 100 iterations sufficed to obtain stable bootstrap estimates and for 69 (23%) alignments we hit the maximum of 1,000 iterations, indicating that the resulting split supports from these runs did not meet our convergence criterion. Among these 69 alignments 49, 15, and 5 alignments achieved a correlation coefficient <inline-formula><inline-graphic xlink:href="mst024i22.jpg"/></inline-formula> of at least 0.95, between 0.9 and 0.95, and less than 0.9, respectively. However, the five alignments with <inline-formula><inline-graphic xlink:href="mst024i23.jpg"/></inline-formula> comprise very divergent sequences and possibly nonalignable sequences. The percentages of alignment sites with low alignment confidence (<xref ref-type="bibr" rid="mst024-B45">Whelan et al. 2006</xref>) are ranging between 32% and 52%. Therefore, the nonconvergence in such cases is not surprising.</p>
      <p>Finally, we computed the distribution of the ratio between the computational times of RBS and UFBoot for the 300 alignments (<xref ref-type="fig" rid="mst024-F3">fig. 3</xref>). UFBoot was always faster than RBS except for 10 DNA alignments. The 69 alignments where UFBoot did not converge (discussed earlier) also caused the slowest UFBoot runs. UFBoot runs 3.1 times (median, range: 0.66–33.3) and 10.2 (median, range: 1.32–41.4) times faster than RBS for DNA and AA alignments, respectively. More impressive is the total computing time for the full PANDIT data analysis: UFBoot required 797 CPU core hours (1.1 month) on a computer cluster equipped with 2.2-GHz CPUs, whereas RBS needed 4,293 CPU hours (∼6 months).
<fig id="mst024-F3" position="float"><label>F<sc>ig</sc>. 3.</label><caption><p>Distributions of run-time ratios (log<sub>2</sub>-scale) between RBS and UFBoot for 300 DNA and AA PANDIT alignments. The percentages of alignments where UFBoot runs slower (left from the dashed line) or faster (right from the dashed line) than RBS are shown.</p></caption><graphic xlink:href="mst024f3p"/></fig></p>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>We have suggested a very fast bootstrap approximation, namely UFBoot, and compared the performance with a collection of widely used methods. Although SBS and RBS estimates of clade support are conservative (see also <xref ref-type="bibr" rid="mst024-B17">Hillis and Bull 1993</xref>; <xref ref-type="bibr" rid="mst024-B3">Anisimova et al. 2011</xref>), the clade support estimated by UFBoot appears less biased according to our large-scale simulations. This leads to a different and easy-to-understand interpretation of the support values. For example, a support of at least 95% should be used if one wants to control the false-positive rate of 5%. The fact that UFBoot is a hybrid of parametric sampling of the tree space and the nonparametric bootstrap sampling of the alignment may be one explanation for reduction of the bias of the bootstrap probabilities. Parametric methods (aLRT, Bayesian MCMC) are unbiased if the true substitution model is known (<xref ref-type="bibr" rid="mst024-B3">Anisimova et al. 2011</xref>). UFBoot inherits this property as shown in our simulations. Moreover, UFBoot partly overcomes model misspecifications by applying the nonparametric RELL correction (<xref ref-type="bibr" rid="mst024-B3">Anisimova et al. 2011</xref>). However, we have to acknowledge that a thorough theoretical explanation for our observation is missing.</p>
    <p>The interpretation of support values as unbiased has been used in Bayesian inference. However, Bayesian inference has been known to be sensitive even against mild model violations (<xref ref-type="bibr" rid="mst024-B40">Suzuki et al. 2002</xref>; <xref ref-type="bibr" rid="mst024-B3">Anisimova et al. 2011</xref>). In contrast, UFBoot appears robust against moderate model violations during phylogenetic inference (<xref ref-type="fig" rid="mst024-F2">fig. 2</xref>). However, caution is advised under severe model violations (i.e., wrongly assumed rate homogeneity among sites) then UFBoot (also SH-aLRT) tends to infer unduly high support values. Here, methods to detect model violations (<xref ref-type="bibr" rid="mst024-B13">Goldman 1993</xref>; <xref ref-type="bibr" rid="mst024-B44">Weiss and von Haeseler 2003</xref>; <xref ref-type="bibr" rid="mst024-B28">Nguyen et al. 2011</xref>) should be applied before the UFBoot analysis (or any other analysis). At present it is not clear, if the number of IQPNNI iterations necessary to achieve bootstrap support convergence may be helpful to detect such artifacts.</p>
    <p>Apart from oversimplified substitution models, other types of model violations such as polytomies and heterotachy (i.e., varying substitution rates among different tree branches and alignment sites) (<xref ref-type="bibr" rid="mst024-B24">Lopez et al. 2002</xref>) are known to cause systematic bias in the ML and Bayesian methods (<xref ref-type="bibr" rid="mst024-B21">Kolaczkowski and Thornton 2004</xref>; <xref ref-type="bibr" rid="mst024-B23">Lewis et al. 2005</xref>). For example, polytomies often lead to a tree space with a lot of local optima. This may hamper the underlying IQPNNI algorithm in exploring the tree space (<xref ref-type="bibr" rid="mst024-B47">Whelan and Money 2010</xref>; <xref ref-type="bibr" rid="mst024-B26">Money and Whelan 2012</xref>), which might in turn inflate UFBoot support values. It is necessary to investigate these and other factors (e.g., by looking at the support of conflicting splits) to understand further the mechanism of bias correction in UFBoot and under which conditions the correction might fail. Currently, these are still unclear to us. However, a more thorough analysis is beyond the scope of this study. Nevertheless, as our methodology works on any set of input candidate trees, it might be worthwhile to exploit UFBoot with other tree sampling strategies such as the genetic algorithm (<xref ref-type="bibr" rid="mst024-B51">Zwickl 2006</xref>) or the Bayesian MCMC (<xref ref-type="bibr" rid="mst024-B6">Drummond et al. 2012</xref>; <xref ref-type="bibr" rid="mst024-B32">Ronquist et al. 2012</xref>). We provide such an option in our implementation.</p>
    <p>SH-aLRT behaves very differently between the Yule–Harding and PANDIT-based simulations (<xref ref-type="fig" rid="mst024-F1">fig. 1</xref>), implying that there is no easy rule of thumb how to interpret SH-aLRT support values. This may be due to the fact that SH-aLRT computes the support value for every branch by only comparing the tree log-likelihood with the log-likelihoods of the two alternative NNI trees around the branch of interest (<xref ref-type="bibr" rid="mst024-B1">Adachi and Hasegawa 1996</xref>). That way, SH-aLRT ignores all other trees that may show higher log-likelihoods than the two NNI trees, which may result in an overconfidence of SH-aLRT support values. Nevertheless, SH-aLRT, being a very quick branch test method, is useful for extremely large data sets. In our implementation, we offer an option to report both SH-aLRT and UFBoot support values per branch so that users can directly compare them.</p>
    <p>Our built-in UFBoot stopping rule provides an intuitive statistic <inline-formula><inline-graphic xlink:href="mst024i24.jpg"/></inline-formula>, the correlation coefficient of the split support values inferred from the first half of the analysis and from the full analysis. <inline-formula><inline-graphic xlink:href="mst024i25.jpg"/></inline-formula> values close to 1.0 imply that an extended tree search will not substantially change the resulting support values and we can therefore stop. Similar ideas have been employed in the bootstopping criterion (<xref ref-type="bibr" rid="mst024-B29">Pattengale et al. 2010</xref>). The fact that the UFBoot stopping rule suggested only 100 iterations for most simulated data are not surprising because the tree space for simulated data typically contains only a few local maxima and is therefore easy to sample. The situation is different for real data where our convergence criterion was not always met. But these cases were also characterized by low phylogenetic information (<xref ref-type="bibr" rid="mst024-B26">Money and Whelan 2012</xref>). This reinforces the observation that one should assess the phylogenetic signals in the data with, for example, the likelihood mapping (<xref ref-type="bibr" rid="mst024-B38">Strimmer and von Haeseler 1997</xref>) and saturation plots (<xref ref-type="bibr" rid="mst024-B41">Van de Peer et al. 2002</xref>; <xref ref-type="bibr" rid="mst024-B48">Xia et al. 2003</xref>) before carrying out an expensive bootstrap analysis. If the data appear to be appropriate for phylogenetic reconstruction, then UFBoot is a time-saving option compared with the other bootstrap inference tool.</p>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusion</title>
    <p>We have presented the UFBoot approximation approach that 1) outperforms the RAxML RBS in terms of the computational time, 2) achieves almost unbiased support values like Bayesian methods, and 3) is relatively robust against moderate model violations. We provide an implementation of UFBoot within the IQ-TREE software package available from <ext-link ext-link-type="uri" xlink:href="http://www.cibiv.at/software/iqtree">http://www.cibiv.at/software/iqtree</ext-link>. IQ-TREE is a substantially improved reimplementation of the IQPNNI algorithm with additional features (Nguyen L-T, Minh BQ, Schmidt HA, von Haeseler A, in preparation). IQ-TREE allows users to reconstruct the ML tree (with support values), the bootstrap trees, and the consensus tree by UFBoot within one single run. Users can also perform UFBoot from a user-defined set of trees sampled by other methods (e.g., genetic algorithm or MCMC sampling).</p>
  </sec>
  <sec sec-type="materials|methods">
    <title>Materials and Methods</title>
    <sec>
      <title>ML Principle</title>
      <p>Let <inline-formula><inline-graphic xlink:href="mst024i26.jpg"/></inline-formula> denote a multiple sequence alignment with <inline-formula><inline-graphic xlink:href="mst024i27.jpg"/></inline-formula> sequences and <inline-formula><inline-graphic xlink:href="mst024i28.jpg"/></inline-formula> sites (columns), where sites in <inline-formula><inline-graphic xlink:href="mst024i29.jpg"/></inline-formula> are grouped into <inline-formula><inline-graphic xlink:href="mst024i30.jpg"/></inline-formula> site-patterns <inline-formula><inline-graphic xlink:href="mst024i31.jpg"/></inline-formula> of identical sites. Hence, we represent <inline-formula><inline-graphic xlink:href="mst024i32.jpg"/></inline-formula> by a vector of site-pattern frequencies <inline-formula><inline-graphic xlink:href="mst024i33.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="mst024i34.jpg"/></inline-formula> is the number of sites having site-pattern <inline-formula><inline-graphic xlink:href="mst024i35.jpg"/></inline-formula> (<inline-formula><inline-graphic xlink:href="mst024i36.jpg"/></inline-formula> &gt; 0 and <inline-formula><inline-graphic xlink:href="mst024i37.jpg"/></inline-formula>).</p>
      <p>Under the assumption of independence of the sites, the log-likelihood <inline-formula><inline-graphic xlink:href="mst024i38.jpg"/></inline-formula> of a tree <inline-formula><inline-graphic xlink:href="mst024i39.jpg"/></inline-formula> (with branch lengths) given <inline-formula><inline-graphic xlink:href="mst024i40.jpg"/></inline-formula> is computed by:
<disp-formula><graphic xlink:href="mst024um1"/></disp-formula>
where <inline-formula><inline-graphic xlink:href="mst024i41.jpg"/></inline-formula> is the log-likelihood of <inline-formula><inline-graphic xlink:href="mst024i42.jpg"/></inline-formula> at site-pattern <inline-formula><inline-graphic xlink:href="mst024i43.jpg"/></inline-formula>.</p>
      <p>Under the ML principle, the objective is to identify the most likely tree <inline-formula><inline-graphic xlink:href="mst024i44.jpg"/></inline-formula>. Note that the computation of <inline-formula><inline-graphic xlink:href="mst024i45.jpg"/></inline-formula> is implicitly based on a predefined substitution model, which we omit in this notation for the sake of simplicity.</p>
    </sec>
    <sec sec-type="methods">
      <title>RELL Method Revisited</title>
      <p>A bootstrap sample <inline-formula><inline-graphic xlink:href="mst024i46.jpg"/></inline-formula> of <inline-formula><inline-graphic xlink:href="mst024i47.jpg"/></inline-formula> is simply a resampled frequency vector <inline-formula><inline-graphic xlink:href="mst024i48.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="mst024i49.jpg"/></inline-formula> is the frequency of <inline-formula><inline-graphic xlink:href="mst024i50.jpg"/></inline-formula> in <inline-formula><inline-graphic xlink:href="mst024i51.jpg"/></inline-formula> (<inline-formula><inline-graphic xlink:href="mst024i52.jpg"/></inline-formula> ≥ 0 and <inline-formula><inline-graphic xlink:href="mst024i53.jpg"/></inline-formula>). To compute <inline-formula><inline-graphic xlink:href="mst024i54.jpg"/></inline-formula> for a given tree <inline-formula><inline-graphic xlink:href="mst024i55.jpg"/></inline-formula> under the SBS, one has to re-estimate the branch lengths and model parameters based on <inline-formula><inline-graphic xlink:href="mst024i56.jpg"/></inline-formula>. To save computation, RELL (<xref ref-type="bibr" rid="mst024-B20">Kishino et al. 1990</xref>) approximates <inline-formula><inline-graphic xlink:href="mst024i57.jpg"/></inline-formula> by using <inline-formula><inline-graphic xlink:href="mst024i58.jpg"/></inline-formula> (i.e., keeping branch lengths and model parameters fixed). Hence, the log-likelihood scores of individual sites remain the same, implying that calculating
<disp-formula id="mst024-M1"><label>(1)</label><graphic xlink:href="mst024m1"/></disp-formula>
for many bootstrap alignments on a fixed tree will be computationally inexpensive. In addition, one can quickly select an approximate ML tree for <inline-formula><inline-graphic xlink:href="mst024i59.jpg"/></inline-formula> from a collection <inline-formula><inline-graphic xlink:href="mst024i60.jpg"/></inline-formula> of candidate trees by computing <inline-formula><inline-graphic xlink:href="mst024i61.jpg"/></inline-formula> if <inline-formula><inline-graphic xlink:href="mst024i62.jpg"/></inline-formula> is known for all <inline-formula><inline-graphic xlink:href="mst024i63.jpg"/></inline-formula>.</p>
      <p>RELL was used to infer the LBP (<xref ref-type="bibr" rid="mst024-B1">Adachi and Hasegawa 1996</xref>) for every internal branch of a fixed tree <inline-formula><inline-graphic xlink:href="mst024i64.jpg"/></inline-formula> as follows: For each internal branch one computes <inline-formula><inline-graphic xlink:href="mst024i65.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="mst024i66.jpg"/></inline-formula> of the two NNI trees around this branch. Next, one generates <inline-formula><inline-graphic xlink:href="mst024i67.jpg"/></inline-formula> bootstrap alignments <inline-formula><inline-graphic xlink:href="mst024i68.jpg"/></inline-formula> and computes the three corresponding RELL scores <inline-formula><inline-graphic xlink:href="mst024i69.jpg"/></inline-formula> for each <inline-formula><inline-graphic xlink:href="mst024i70.jpg"/></inline-formula> according to <xref ref-type="disp-formula" rid="mst024-M1">equation (1)</xref>. The local support of the branch in question is the percentage of <inline-formula><inline-graphic xlink:href="mst024i71.jpg"/></inline-formula> where <inline-formula><inline-graphic xlink:href="mst024i72.jpg"/></inline-formula>
<inline-formula><inline-graphic xlink:href="mst024i72a.jpg"/></inline-formula> In other words, the LBP method considers the set <inline-formula><inline-graphic xlink:href="mst024i73.jpg"/></inline-formula> of exactly three candidate trees and may overlook other “good” tree topologies (<xref ref-type="bibr" rid="mst024-B1">Adachi and Hasegawa 1996</xref>, p. 49). For that reason, we pursue another approach described in the following sections.</p>
    </sec>
    <sec>
      <title>Tree Proposal</title>
      <p>The applicability of RELL crucially depends on the collection of candidate trees. The naive way of evaluating all tree topologies of <inline-formula><inline-graphic xlink:href="mst024i74.jpg"/></inline-formula> taxa (<xref ref-type="bibr" rid="mst024-B43">Waddell et al. 2002</xref>) only works for small <inline-formula><inline-graphic xlink:href="mst024i75.jpg"/></inline-formula>. Here, we exploit a strategy of sampling trees using the IQPNNI algorithm (<xref ref-type="bibr" rid="mst024-B42">Vinh and von Haeseler 2004</xref>; <xref ref-type="bibr" rid="mst024-B25">Minh et al. 2005</xref>). In principle, IQPNNI does a sampling of local maxima in the tree space defined by the NNI operations (<xref ref-type="fig" rid="mst024-F4">fig. 4</xref>). To this end, IQPNNI iteratively moves through the tree space in which the IQP operations help to escape local optimal regions and subsequently NNI moves toward the local optima within regions (<italic>T</italic><sub>1</sub>, <italic>T</italic><sub>2</sub>, and <italic>T</italic><sub>3</sub> in <xref ref-type="fig" rid="mst024-F4">fig. 4</xref>). To escape local optima the IQP step randomly deletes a fraction <inline-formula><inline-graphic xlink:href="mst024i78.jpg"/></inline-formula> of the leaves of the tree and re-inserts the leaves using the quartet puzzling method (<xref ref-type="bibr" rid="mst024-B37">Strimmer and von Haeseler 1996</xref>).
<fig id="mst024-F4" position="float"><label>F<sc>ig</sc>. 4.</label><caption><p>Schematic view of the tree space sampled by the IQPNNI algorithm. The solid curve reflects the log-likelihood surface on the tree space. The structure of tree space is defined by the NNI operations where each <inline-formula><inline-graphic xlink:href="mst024i76.jpg"/></inline-formula>-taxon tree has exactly <inline-formula><inline-graphic xlink:href="mst024i77.jpg"/></inline-formula> neighboring trees.</p></caption><graphic xlink:href="mst024f4p"/></fig></p>
      <p>The IQPNNI algorithm (<xref ref-type="fig" rid="mst024-F4">fig. 4</xref>) works as follows. IQPNNI starts with the BIONJ (<xref ref-type="bibr" rid="mst024-B12">Gascuel 1997</xref>) tree <inline-formula><inline-graphic xlink:href="mst024i79.jpg"/></inline-formula> and moves to <inline-formula><inline-graphic xlink:href="mst024i80.jpg"/></inline-formula> via a series of NNIs. Here <inline-formula><inline-graphic xlink:href="mst024i81.jpg"/></inline-formula> represents a local maximum of the tree space. This completes the first IQPNNI iteration. In the second IQPNNI iteration, IQPNNI applies the IQP operation to propose <inline-formula><inline-graphic xlink:href="mst024i82.jpg"/></inline-formula> from <inline-formula><inline-graphic xlink:href="mst024i83.jpg"/></inline-formula> and subsequently moves to <inline-formula><inline-graphic xlink:href="mst024i84.jpg"/></inline-formula> (via NNI), which locates another local maximum. As <inline-formula><inline-graphic xlink:href="mst024i85.jpg"/></inline-formula>, we keep <inline-formula><inline-graphic xlink:href="mst024i86.jpg"/></inline-formula> as the current best tree. In the third iteration, <inline-formula><inline-graphic xlink:href="mst024i87.jpg"/></inline-formula> is generated from <inline-formula><inline-graphic xlink:href="mst024i88.jpg"/></inline-formula> and then <inline-formula><inline-graphic xlink:href="mst024i89.jpg"/></inline-formula> reflects another local optimum. Now, as <inline-formula><inline-graphic xlink:href="mst024i90.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="mst024i91.jpg"/></inline-formula> becomes the new ML tree as it has a higher likelihood. In other words, the IQPNNI algorithm allows us to escape the local optimum <inline-formula><inline-graphic xlink:href="mst024i92.jpg"/></inline-formula>. Because this search is carried out for many iterations, IQPNNI samples many local optima and thus provides a rough picture of the tree space.</p>
      <p>As a by-product IQPNNI also samples the trees that are a few NNIs away from local optima. To get a collection <inline-formula><inline-graphic xlink:href="mst024i93.jpg"/></inline-formula> of candidate trees, we collect all distinct trees encountered during the IQPNNI search.</p>
    </sec>
    <sec>
      <title>Restricting the Number of Candidate Trees</title>
      <p>As we might encounter millions of distinct trees during the IQPNNI search and as we are interested in plausible trees (i.e., those in the vicinity of local optima), we introduce the parameter <inline-formula><inline-graphic xlink:href="mst024i94.jpg"/></inline-formula> to consider only trees in <inline-formula><inline-graphic xlink:href="mst024i95.jpg"/></inline-formula> exceeding a certain log-likelihood threshold. In other words, based on <inline-formula><inline-graphic xlink:href="mst024i96.jpg"/></inline-formula> we empirically determine a log-likelihood threshold <inline-formula><inline-graphic xlink:href="mst024i97.jpg"/></inline-formula> during the search such that a tree <inline-formula><inline-graphic xlink:href="mst024i98.jpg"/></inline-formula> will only be investigated with the RELL bootstrapping if <inline-formula><inline-graphic xlink:href="mst024i99.jpg"/></inline-formula>. This works as follows: Let <inline-formula><inline-graphic xlink:href="mst024i100.jpg"/></inline-formula> be the total number of IQPNNI iterations and <inline-formula><inline-graphic xlink:href="mst024i101.jpg"/></inline-formula> the current iteration. On average, we aim to collect <inline-formula><inline-graphic xlink:href="mst024i102.jpg"/></inline-formula> trees per iteration. Hence, we expect <inline-formula><inline-graphic xlink:href="mst024i103.jpg"/></inline-formula> trees after <inline-formula><inline-graphic xlink:href="mst024i104.jpg"/></inline-formula> iterations. If <inline-formula><inline-graphic xlink:href="mst024i105.jpg"/></inline-formula> after the <italic>q</italic>th iteration, we have collected fewer trees than we aimed for, so we set <inline-formula><inline-graphic xlink:href="mst024i106.jpg"/></inline-formula> to accept all subsequent trees. If however <inline-formula><inline-graphic xlink:href="mst024i107.jpg"/></inline-formula>, then the expected number of trees after <inline-formula><inline-graphic xlink:href="mst024i108.jpg"/></inline-formula> iterations might exceed <inline-formula><inline-graphic xlink:href="mst024i109.jpg"/></inline-formula>. To avoid this, we set <inline-formula><inline-graphic xlink:href="mst024i110.jpg"/></inline-formula> equal to the log-likelihood of the <inline-formula><inline-graphic xlink:href="mst024i111.jpg"/></inline-formula>-th best tree in <inline-formula><inline-graphic xlink:href="mst024i112.jpg"/></inline-formula>. In the subsequent iteration <inline-formula><inline-graphic xlink:href="mst024i113.jpg"/></inline-formula>, a tree <inline-formula><inline-graphic xlink:href="mst024i114.jpg"/></inline-formula> is assigned to <inline-formula><inline-graphic xlink:href="mst024i115.jpg"/></inline-formula> only if it is not yet in <inline-formula><inline-graphic xlink:href="mst024i116.jpg"/></inline-formula> and if <inline-formula><inline-graphic xlink:href="mst024i117.jpg"/></inline-formula>. At the end of iteration <inline-formula><inline-graphic xlink:href="mst024i118.jpg"/></inline-formula>, we update <inline-formula><inline-graphic xlink:href="mst024i119.jpg"/></inline-formula> as shown earlier. <inline-formula><inline-graphic xlink:href="mst024i120.jpg"/></inline-formula> will decrease or increase depending on the number of trees added to <inline-formula><inline-graphic xlink:href="mst024i121.jpg"/></inline-formula> during iteration <inline-formula><inline-graphic xlink:href="mst024i122.jpg"/></inline-formula>. We therefore adaptively adjust <inline-formula><inline-graphic xlink:href="mst024i123.jpg"/></inline-formula> based on the number of trees encountered during the search. Note that because we do not remove any trees from <inline-formula><inline-graphic xlink:href="mst024i124.jpg"/></inline-formula>, the size of <inline-formula><inline-graphic xlink:href="mst024i125.jpg"/></inline-formula> might slightly exceed <inline-formula><inline-graphic xlink:href="mst024i126.jpg"/></inline-formula> at the end.</p>
    </sec>
    <sec>
      <title>UFBoot Approximation</title>
      <p>The UFBoot works as follows:
<list list-type="order"><list-item><p>Initialization step: Initialize the collection of trees <inline-formula><inline-graphic xlink:href="mst024i127.jpg"/></inline-formula> and the log-likelihood cutoff <inline-formula><inline-graphic xlink:href="mst024i128.jpg"/></inline-formula>. Generate <inline-formula><inline-graphic xlink:href="mst024i129.jpg"/></inline-formula> (typically 1,000 or 10,000) bootstrap alignments <inline-formula><inline-graphic xlink:href="mst024i130.jpg"/></inline-formula>. For each <inline-formula><inline-graphic xlink:href="mst024i131.jpg"/></inline-formula> initialize the bootstrap tree <inline-formula><inline-graphic xlink:href="mst024i132.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="mst024i133.jpg"/></inline-formula>.</p></list-item><list-item><p>Exploration step: Perform the IQPNNI search with <inline-formula><inline-graphic xlink:href="mst024i134.jpg"/></inline-formula> (<xref ref-type="fig" rid="mst024-F4">fig. 4</xref>). Every time a new tree <inline-formula><inline-graphic xlink:href="mst024i135.jpg"/></inline-formula> with <inline-formula><inline-graphic xlink:href="mst024i136.jpg"/></inline-formula>
<inline-formula><inline-graphic xlink:href="mst024i136a.jpg"/></inline-formula> is encountered during the search:
<list list-type="alpha-lower"><list-item><p>Compute the approximate log-likelihood <inline-formula><inline-graphic xlink:href="mst024i137.jpg"/></inline-formula> for each bootstrap replicate <inline-formula><inline-graphic xlink:href="mst024i138.jpg"/></inline-formula> using RELL (<xref ref-type="disp-formula" rid="mst024-M1">eq. 1</xref>). If <inline-formula><inline-graphic xlink:href="mst024i139.jpg"/></inline-formula>, update <inline-formula><inline-graphic xlink:href="mst024i140.jpg"/></inline-formula>.</p></list-item><list-item><p>Update <inline-formula><inline-graphic xlink:href="mst024i141.jpg"/></inline-formula>.</p></list-item></list>
Re-estimate <inline-formula><inline-graphic xlink:href="mst024i142.jpg"/></inline-formula> as explained upon finishing an IQPNNI iteration.</p></list-item><list-item><p>Summarization step: Construct a consensus tree from the bootstrap trees <inline-formula><inline-graphic xlink:href="mst024i143.jpg"/></inline-formula> or map the support values onto the ML tree reconstruced by the IQPNNI search.</p></list-item></list>
</p>
      <p>The exploration step is the main step that simultaneously explores the tree space and updates the bootstrap trees. The computation of <inline-formula><inline-graphic xlink:href="mst024i144.jpg"/></inline-formula> represents the only additional computation compared to the original IQPNNI algorithm and has a time-complexity of <inline-formula><inline-graphic xlink:href="mst024i145.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="mst024i146.jpg"/></inline-formula> is the number of site-patterns in the input alignment. We implement the collection of distinct trees <inline-formula><inline-graphic xlink:href="mst024i147.jpg"/></inline-formula> as a hash table for computational efficiency, implying that we compute the approximate likelihoods for trees encountered during the search exactly once. Moreover, if the probability of revisiting a tree during the search is small (which often happens for large data), one can safely omit storing the trees in <inline-formula><inline-graphic xlink:href="mst024i148.jpg"/></inline-formula>, and thus substantially reducing the memory consumption. We provide both options in our implementation.</p>
    </sec>
    <sec>
      <title>UFBoot Stopping Rule</title>
      <p>In principle, the more IQPNNI iterations (<inline-formula><inline-graphic xlink:href="mst024i149.jpg"/></inline-formula>) are carried out during the exploration step, the more candidate trees (<inline-formula><inline-graphic xlink:href="mst024i150.jpg"/></inline-formula>) are considered and the better UFBoot performs. However, <inline-formula><inline-graphic xlink:href="mst024i151.jpg"/></inline-formula> should not be too large since our goal is to provide an UFBoot approximation method. <inline-formula><inline-graphic xlink:href="mst024i152.jpg"/></inline-formula> should also not be unrealistically small because we want to achieve high accuracy. Thus, we introduce a so-called “UFBoot stopping rule” that automatically assesses the convergence of the split support values and stops collecting candidate trees once convergence is achieved.</p>
      <p>To this end, we start with <inline-formula><inline-graphic xlink:href="mst024i153.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="mst024i154.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="mst024i155.jpg"/></inline-formula> is the number of sequences. That means, <inline-formula><inline-graphic xlink:href="mst024i156.jpg"/></inline-formula> is no more an independent parameter and we collect on average <inline-formula><inline-graphic xlink:href="mst024i157.jpg"/></inline-formula> trees per IQPNNI-iteration. This is motivated by the fact that each IQPNNI iteration generates <inline-formula><inline-graphic xlink:href="mst024i158.jpg"/></inline-formula> trees, and we will therefore consider a constant factor (&lt;1) of the number of trees encountered. During the exploration step, once <inline-formula><inline-graphic xlink:href="mst024i159.jpg"/></inline-formula> iterations have been completed, we compute the vector of split occurrence frequencies <inline-formula><inline-graphic xlink:href="mst024i160.jpg"/></inline-formula> for all splits in the current set of bootstrap trees <inline-formula><inline-graphic xlink:href="mst024i161.jpg"/></inline-formula>. At the end of the <inline-formula><inline-graphic xlink:href="mst024i162.jpg"/></inline-formula>-th iteration we compute <inline-formula><inline-graphic xlink:href="mst024i163.jpg"/></inline-formula> and the Pearson’s correlation coefficient <inline-formula><inline-graphic xlink:href="mst024i164.jpg"/></inline-formula> between the two vectors <inline-formula><inline-graphic xlink:href="mst024i165.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="mst024i166.jpg"/></inline-formula> For splits occurring in one split set but not the other, a corresponding zero entry is added into the other vector. If <inline-formula><inline-graphic xlink:href="mst024i167.jpg"/></inline-formula>, then more IQPNNI iterations do not substantially change the split support values. In such case, we stop and output the split support values in <inline-formula><inline-graphic xlink:href="mst024i168.jpg"/></inline-formula>. Otherwise, we continue the exploration step with 100 more iterations (i.e., we increase <inline-formula><inline-graphic xlink:href="mst024i169.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="mst024i170.jpg"/></inline-formula>). Therefore, we compute the bootstrap split support every 50 iterations and evaluate the convergence every 100 iterations. Finally, we provide an option to specify a maximum number of iterations <inline-formula><inline-graphic xlink:href="mst024i171.jpg"/></inline-formula> such that we will also stop once <inline-formula><inline-graphic xlink:href="mst024i172.jpg"/></inline-formula>. This ensures that the analysis will finish in case a <inline-formula><inline-graphic xlink:href="mst024i173.jpg"/></inline-formula> of 0.99 is unlikely to be reached.</p>
    </sec>
    <sec>
      <title>Performance Study with Yule–Harding Simulation</title>
      <p>We simulated data with varying number of sequences and sites (<xref ref-type="table" rid="mst024-T1">table 1</xref>) to assess the performance of UFBoot. For each setting, we used IQ-TREE (Nguyen L-T, Minh BQ, Schmidt HA, von Haeseler A, in preparation) to generate 200 random trees (true trees) under the Yule–Harding model (<xref ref-type="bibr" rid="mst024-B15">Harding 1971</xref>) where the branch lengths follow an exponential distribution with the mean of 0.1. Seq-Gen (<xref ref-type="bibr" rid="mst024-B31">Rambaut and Grassly 1997</xref>) was used to evolve the DNA or protein sequences along the tree under the GTR + <inline-formula><inline-graphic xlink:href="mst024i174.jpg"/></inline-formula> (<xref ref-type="bibr" rid="mst024-B22">Lanave et al. 1984</xref>; <xref ref-type="bibr" rid="mst024-B49">Yang 1994</xref>) and WAG + <inline-formula><inline-graphic xlink:href="mst024i175.jpg"/></inline-formula> (<xref ref-type="bibr" rid="mst024-B49">Yang 1994</xref>; <xref ref-type="bibr" rid="mst024-B46">Whelan and Goldman 2001</xref>) model, respectively. The GTR model parameters are: <inline-formula><inline-graphic xlink:href="mst024i176.jpg"/></inline-formula>
<inline-formula><inline-graphic xlink:href="mst024i76a.jpg"/></inline-formula>
<inline-formula><inline-graphic xlink:href="mst024i176b.jpg"/></inline-formula>. The <inline-formula><inline-graphic xlink:href="mst024i177.jpg"/></inline-formula> distribution parameter is <inline-formula><inline-graphic xlink:href="mst024i178.jpg"/></inline-formula>. In total, we simulated 600 DNA alignments and 400 amino acid alignments for five settings (<xref ref-type="table" rid="mst024-T1">table 1</xref>).</p>
      <p>For each simulated alignment, we then performed UFBoot with <inline-formula><inline-graphic xlink:href="mst024i179.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="mst024i180.jpg"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="mst024i181.jpg"/></inline-formula>. To compare the UFBoot results, we conducted SBS as implemented in RAxML-SSE3 7.3.0 with 100 replicates (<xref ref-type="bibr" rid="mst024-B35">Stamatakis 2006</xref>), RBS with 1,000 replicates (<xref ref-type="bibr" rid="mst024-B36">Stamatakis et al. 2008</xref>), and PhyML SH-aLRT (<xref ref-type="bibr" rid="mst024-B14">Guindon et al. 2010</xref>). For each bootstrap method, the inferred split support values were mapped onto the ML tree reconstructed by IQ-TREE.</p>
      <p>Finally, we collected the set <inline-formula><inline-graphic xlink:href="mst024i182.jpg"/></inline-formula> of unique splits occurring in the 1,000 ML trees reconstructed from the 1,000 alignments generated and classified them as true or false splits (i.e., splits that occur in the corresponding true tree or not). Each split <inline-formula><inline-graphic xlink:href="mst024i183.jpg"/></inline-formula> was associated with four support values: <inline-formula><inline-graphic xlink:href="mst024i184.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="mst024i185.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="mst024i186.jpg"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="mst024i187.jpg"/></inline-formula> rounded as integers between <inline-formula><inline-graphic xlink:href="mst024i188.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="mst024i189.jpg"/></inline-formula>. Then, we computed the fraction, <inline-formula><inline-graphic xlink:href="mst024i190.jpg"/></inline-formula>, of true splits with support value <inline-formula><inline-graphic xlink:href="mst024i191.jpg"/></inline-formula> against all splits with the same support value <inline-formula><inline-graphic xlink:href="mst024i192.jpg"/></inline-formula>, thus we computed:
<disp-formula id="mst024-M2"><label>(2)</label><graphic xlink:href="mst024m2"/></disp-formula>
Similarly, we computed <inline-formula><inline-graphic xlink:href="mst024i193.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="mst024i194.jpg"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="mst024i195.jpg"/></inline-formula>. This ratio is coined “accuracy” (<xref ref-type="bibr" rid="mst024-B17">Hillis and Bull 1993</xref>) and was used recently by <xref ref-type="bibr" rid="mst024-B3">Anisimova et al. (2011)</xref>.</p>
    </sec>
    <sec>
      <title>PANDIT-Based Simulation</title>
      <p>Moreover, we performed a large-scale simulation based on the PANDIT database (<xref ref-type="bibr" rid="mst024-B45">Whelan et al. 2006</xref>) to examine the performance of different bootstrap strategies on trees inferred from biological data. To this end, we retrieved 6,491 DNA and 6,617 protein alignments with at least four sequences from the PANDIT website. Following the recommendation of <xref ref-type="bibr" rid="mst024-B45">Whelan et al. (2006)</xref>, we removed all short alignments (<inline-formula><inline-graphic xlink:href="mst024i196.jpg"/></inline-formula> for DNA and <inline-formula><inline-graphic xlink:href="mst024i197.jpg"/></inline-formula> for protein alignments). For the remaining 6,222 DNA and 6,182 protein alignments, we selected the best-fit models with the Bayesian information criterion using ModelTest (<xref ref-type="bibr" rid="mst024-B30">Posada and Crandall 1998</xref>) and ProtTest (<xref ref-type="bibr" rid="mst024-B4">Darriba et al. 2011</xref>), respectively. We then reconstructed an ML tree for each alignment using IQ-TREE under the selected model. The reconstructed ML trees were treated as true trees to generate alignments. We again used Seq-Gen to simulate alignments with the same alignment lengths as the original PANDIT alignments and under the estimated model parameters. We then superimposed the gap positions from the original PANDIT alignments onto corresponding simulated alignments. The use of PANDIT trees and the introduction of gaps into the simulated alignments are to reflect as much reality as possible in the simulation.</p>
      <p>Finally, we compared the bootstrap strategies with respect to the accuracy as in the Yule–Harding simulations (<xref ref-type="disp-formula" rid="mst024-M2">eq. 2</xref>). Moreover, for 5,688 DNA alignments, where the selected best-fit models are more complex than JC + <inline-formula><inline-graphic xlink:href="mst024i198.jpg"/></inline-formula> (<xref ref-type="bibr" rid="mst024-B19">Jukes and Cantor 1969</xref>; <xref ref-type="bibr" rid="mst024-B49">Yang 1994</xref>), we assessed the impact of model misspecification on the accuracy (i.e., when the trees are reconstructed under JC + <inline-formula><inline-graphic xlink:href="mst024i199.jpg"/></inline-formula> and JC models representing moderate and severe model violations, respectively).</p>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>The authors thank Dirk Metzler for discussions, Tina Koestler for helpful comments on the manuscript, and Manuel Gil for proofreading. They also thank Lars Jermiin and two anonymous reviewers for their constructive comments on the manuscript. This work was supported by the <funding-source>Austrian Science Fund—FWF</funding-source> (I760) to B.Q.M. and A.v.H. and the <funding-source>EU EURATRANS consortium</funding-source> (<award-id>HEALTH-F4-2010-241504</award-id>) to M.A.T.N. The computational results presented have been achieved in part using the <funding-source>Vienna Scientific Cluster (VSC)</funding-source>.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="mst024-B1">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Adachi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hasegawa</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <source>MOLPHY version 2.3—programs for molecular phylogenetics based on maximum likelihood</source>
        <year>1996</year>
        <publisher-loc>Minato-ku (Tokyo)</publisher-loc>
        <publisher-name>Institute of Statistical Mathematics</publisher-name>
      </element-citation>
    </ref>
    <ref id="mst024-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anisimova</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gascuel</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Approximate likelihood-ratio test for branches: a fast, accurate, and powerful alternative</article-title>
        <source>Syst Biol.</source>
        <year>2006</year>
        <volume>55</volume>
        <fpage>539</fpage>
        <lpage>552</lpage>
        <pub-id pub-id-type="pmid">16785212</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anisimova</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gil</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dufayard</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Dessimoz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gascuel</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Survey of branch support methods demonstrates accuracy, power, and robustness of fast likelihood-based approximation schemes</article-title>
        <source>Syst Biol.</source>
        <year>2011</year>
        <volume>60</volume>
        <fpage>685</fpage>
        <lpage>699</lpage>
        <pub-id pub-id-type="pmid">21540409</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darriba</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Taboada</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Doallo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Posada</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>ProtTest 3: fast selection of best-fit models of protein evolution</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>1164</fpage>
        <lpage>1165</lpage>
        <pub-id pub-id-type="pmid">21335321</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Douady</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Delsuc</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Boucher</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Doolittle</surname>
            <given-names>WF</given-names>
          </name>
          <name>
            <surname>Douzery</surname>
            <given-names>EJP</given-names>
          </name>
        </person-group>
        <article-title>Comparison of Bayesian and maximum likelihood bootstrap measures of phylogenetic reliability</article-title>
        <source>Mol Biol Evol.</source>
        <year>2003</year>
        <volume>20</volume>
        <fpage>248</fpage>
        <lpage>254</lpage>
        <pub-id pub-id-type="pmid">12598692</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Drummond</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Suchard</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rambaut</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Bayesian phylogenetics with BEAUti and the BEAST 1.7</article-title>
        <source>Mol Biol Evol.</source>
        <year>2012</year>
        <volume>29</volume>
        <fpage>1969</fpage>
        <lpage>1973</lpage>
        <pub-id pub-id-type="pmid">22367748</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Bootstrap methods—another look at the kackknife</article-title>
        <source>Ann Stat.</source>
        <year>1979</year>
        <volume>7</volume>
        <fpage>1</fpage>
        <lpage>26</lpage>
      </element-citation>
    </ref>
    <ref id="mst024-B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Halloran</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Bootstrap confidence levels for phylogenetic trees</article-title>
        <source>Proc Natl Acad Sci U S A.</source>
        <year>1996</year>
        <volume>93</volume>
        <fpage>13429</fpage>
        <lpage>13434</lpage>
        <pub-id pub-id-type="pmid">8917608</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Felsenstein</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Evolutionary trees from DNA sequences—a maximum likelihood approach</article-title>
        <source>J Mol Evol.</source>
        <year>1981</year>
        <volume>17</volume>
        <fpage>368</fpage>
        <lpage>376</lpage>
        <pub-id pub-id-type="pmid">7288891</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Felsenstein</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Confidence limits on phylogenies—an approach using the bootstrap</article-title>
        <source>Evolution</source>
        <year>1985</year>
        <volume>39</volume>
        <fpage>783</fpage>
        <lpage>791</lpage>
      </element-citation>
    </ref>
    <ref id="mst024-B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Felsenstein</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kishino</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Is there something wrong with the bootstrap on phylogenies—a reply</article-title>
        <source>Syst Biol.</source>
        <year>1993</year>
        <volume>42</volume>
        <fpage>193</fpage>
        <lpage>200</lpage>
      </element-citation>
    </ref>
    <ref id="mst024-B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gascuel</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>BIONJ: an improved version of the NJ algorithm based on a simple model of sequence data</article-title>
        <source>Mol Biol Evol.</source>
        <year>1997</year>
        <volume>14</volume>
        <fpage>685</fpage>
        <lpage>695</lpage>
        <pub-id pub-id-type="pmid">9254330</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goldman</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Statistical tests of models of DNA substitution</article-title>
        <source>J Mol Evol.</source>
        <year>1993</year>
        <volume>36</volume>
        <fpage>182</fpage>
        <lpage>198</lpage>
        <pub-id pub-id-type="pmid">7679448</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guindon</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dufayard</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Lefort</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Anisimova</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hordijk</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Gascuel</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>New algorithms and methods to estimate maximum-likelihood phylogenies: assessing the performance of PhyML 3.0</article-title>
        <source>Syst Biol.</source>
        <year>2010</year>
        <volume>59</volume>
        <fpage>307</fpage>
        <lpage>321</lpage>
        <pub-id pub-id-type="pmid">20525638</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harding</surname>
            <given-names>EF</given-names>
          </name>
        </person-group>
        <article-title>The probabilities of rooted tree-shapes generated by random bifurcation</article-title>
        <source>Adv Appl Prob.</source>
        <year>1971</year>
        <volume>3</volume>
        <fpage>44</fpage>
        <lpage>77</lpage>
      </element-citation>
    </ref>
    <ref id="mst024-B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hasegawa</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kishino</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Accuracies of the simple methods for estimating the bootstrap probability of a maximum-likelihood tree</article-title>
        <source>Mol Biol Evol.</source>
        <year>1994</year>
        <volume>11</volume>
        <fpage>142</fpage>
        <lpage>145</lpage>
      </element-citation>
    </ref>
    <ref id="mst024-B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hillis</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Bull</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>An empirical-test of bootstrapping as a method for assessing confidence in phylogenetic analysis</article-title>
        <source>Syst Biol.</source>
        <year>1993</year>
        <volume>42</volume>
        <fpage>182</fpage>
        <lpage>192</lpage>
      </element-citation>
    </ref>
    <ref id="mst024-B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huelsenbeck</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Ronquist</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>MRBAYES: Bayesian inference of phylogenetic trees</article-title>
        <source>Bioinformatics</source>
        <year>2001</year>
        <volume>17</volume>
        <fpage>754</fpage>
        <lpage>755</lpage>
        <pub-id pub-id-type="pmid">11524383</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B19">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Jukes</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Cantor</surname>
            <given-names>CR</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Munro</surname>
            <given-names>HN</given-names>
          </name>
        </person-group>
        <article-title>Evolution of protein molecules</article-title>
        <source>Mammalian protein metabolism</source>
        <year>1969</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Academic Press</publisher-name>
        <fpage>21</fpage>
        <lpage>132</lpage>
      </element-citation>
    </ref>
    <ref id="mst024-B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kishino</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Miyata</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hasegawa</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Maximum-likelihood inference of protein phylogeny and the origin of chloroplasts</article-title>
        <source>J Mol Evol.</source>
        <year>1990</year>
        <volume>31</volume>
        <fpage>151</fpage>
        <lpage>160</lpage>
      </element-citation>
    </ref>
    <ref id="mst024-B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kolaczkowski</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Thornton</surname>
            <given-names>JW</given-names>
          </name>
        </person-group>
        <article-title>Performance of maximum parsimony and likelihood phylogenetics when evolution is heterogeneous</article-title>
        <source>Nature</source>
        <year>2004</year>
        <volume>431</volume>
        <fpage>980</fpage>
        <lpage>984</lpage>
        <pub-id pub-id-type="pmid">15496922</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lanave</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Preparata</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Saccone</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Serio</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>A new method for calculating evolutionary substitution rates</article-title>
        <source>J Mol Evol.</source>
        <year>1984</year>
        <volume>20</volume>
        <fpage>86</fpage>
        <lpage>93</lpage>
        <pub-id pub-id-type="pmid">6429346</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lewis</surname>
            <given-names>PO</given-names>
          </name>
          <name>
            <surname>Holder</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Holsinger</surname>
            <given-names>KE</given-names>
          </name>
        </person-group>
        <article-title>Polytomies and Bayesian phylogenetic inference</article-title>
        <source>Syst Biol.</source>
        <year>2005</year>
        <volume>54</volume>
        <fpage>241</fpage>
        <lpage>253</lpage>
        <pub-id pub-id-type="pmid">16012095</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lopez</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Casane</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Philippe</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Heterotachy, an important process of protein evolution</article-title>
        <source>Mol Biol Evol.</source>
        <year>2002</year>
        <volume>19</volume>
        <fpage>1</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="pmid">11752184</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Minh</surname>
            <given-names>BQ</given-names>
          </name>
          <name>
            <surname>Vinh</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>von Haeseler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>HA</given-names>
          </name>
        </person-group>
        <article-title>pIQPNNI: parallel reconstruction of large maximum likelihood phylogenies</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>3794</fpage>
        <lpage>3796</lpage>
        <pub-id pub-id-type="pmid">16046495</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Money</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Whelan</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Characterizing the phylogenetic tree-search problem</article-title>
        <source>Syst Biol.</source>
        <year>2012</year>
        <volume>61</volume>
        <fpage>228</fpage>
        <lpage>239</lpage>
        <pub-id pub-id-type="pmid">22076302</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>MAT</given-names>
          </name>
          <name>
            <surname>Gesell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>von Haeseler</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>ImOSM: intermittent evolution and robustness of phylogenetic methods</article-title>
        <source>Mol Biol Evol.</source>
        <year>2012</year>
        <volume>29</volume>
        <fpage>663</fpage>
        <lpage>673</lpage>
        <pub-id pub-id-type="pmid">21940641</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B28">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>MAT</given-names>
          </name>
          <name>
            <surname>Klaere</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>von Haeseler</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>MISFITS: evaluating the goodness of fit between a phylogenetic model and an alignment</article-title>
        <source>Mol Biol Evol.</source>
        <year>2011</year>
        <volume>28</volume>
        <fpage>143</fpage>
        <lpage>152</lpage>
        <pub-id pub-id-type="pmid">20643866</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B29">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pattengale</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Alipour</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bininda-Emonds</surname>
            <given-names>ORP</given-names>
          </name>
          <name>
            <surname>Moret</surname>
            <given-names>BME</given-names>
          </name>
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>How many bootstrap replicates are necessary?</article-title>
        <source>J Comput Biol.</source>
        <year>2010</year>
        <volume>17</volume>
        <fpage>337</fpage>
        <lpage>354</lpage>
        <pub-id pub-id-type="pmid">20377449</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B30">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Posada</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Crandall</surname>
            <given-names>KA</given-names>
          </name>
        </person-group>
        <article-title>MODELTEST: testing the model of DNA substitution</article-title>
        <source>Bioinformatics</source>
        <year>1998</year>
        <volume>14</volume>
        <fpage>817</fpage>
        <lpage>818</lpage>
        <pub-id pub-id-type="pmid">9918953</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B31">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rambaut</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Grassly</surname>
            <given-names>NC</given-names>
          </name>
        </person-group>
        <article-title>Seq-Gen: an application for the Monte Carlo simulation of DNA sequence evolution along phylogenetic trees</article-title>
        <source>Comput Appl Biosci.</source>
        <year>1997</year>
        <volume>13</volume>
        <fpage>235</fpage>
        <lpage>238</lpage>
        <pub-id pub-id-type="pmid">9183526</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B32">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ronquist</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Teslenko</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>van der Mark</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ayres</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Darling</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hohna</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Larget</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Suchard</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Huelsenbeck</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>MrBayes 3.2: efficient Bayesian phylogenetic inference and model choice across a large model space</article-title>
        <source>Syst Biol.</source>
        <year>2012</year>
        <volume>61</volume>
        <fpage>539</fpage>
        <lpage>542</lpage>
        <pub-id pub-id-type="pmid">22357727</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B33">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmidt</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Strimmer</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Vingron</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>von Haeseler</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>TREE-PUZZLE: maximum likelihood phylogenetic analysis using quartets and parallel computing</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <fpage>502</fpage>
        <lpage>504</lpage>
        <pub-id pub-id-type="pmid">11934758</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B34">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shimodaira</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Hasegawa</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Multiple comparisons of log-likelihoods with applications to phylogenetic inference</article-title>
        <source>Mol Biol Evol.</source>
        <year>1999</year>
        <volume>16</volume>
        <fpage>1114</fpage>
        <lpage>1116</lpage>
      </element-citation>
    </ref>
    <ref id="mst024-B35">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>RAxML-VI-HPC: maximum likelihood-based phylogenetic analyses with thousands of taxa and mixed models</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>2688</fpage>
        <lpage>2690</lpage>
        <pub-id pub-id-type="pmid">16928733</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B36">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hoover</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Rougemont</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A rapid bootstrap algorithm for the RAxML web servers</article-title>
        <source>Syst Biol.</source>
        <year>2008</year>
        <volume>57</volume>
        <fpage>758</fpage>
        <lpage>771</lpage>
        <pub-id pub-id-type="pmid">18853362</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B37">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Strimmer</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>von Haeseler</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Quartet puzzling: a quartet maximum-likelihood method for reconstructing tree topologies</article-title>
        <source>Mol Biol Evol.</source>
        <year>1996</year>
        <volume>13</volume>
        <fpage>964</fpage>
        <lpage>969</lpage>
      </element-citation>
    </ref>
    <ref id="mst024-B38">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Strimmer</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>von Haeseler</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Likelihood-mapping: a simple method to visualize phylogenetic content of a sequence alignment</article-title>
        <source>Proc Natl Acad Sci U S A.</source>
        <year>1997</year>
        <volume>94</volume>
        <fpage>6815</fpage>
        <lpage>6819</lpage>
        <pub-id pub-id-type="pmid">9192648</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B39">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sullivan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Swofford</surname>
            <given-names>DL</given-names>
          </name>
        </person-group>
        <article-title>Should we use model-based methods for phylogenetic inference when we know that assumptions about among-site rate variation and nucleotide substitution pattern are violated?</article-title>
        <source>Syst Biol.</source>
        <year>2001</year>
        <volume>50</volume>
        <fpage>723</fpage>
        <lpage>729</lpage>
        <pub-id pub-id-type="pmid">12116942</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B40">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Suzuki</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Glazko</surname>
            <given-names>GV</given-names>
          </name>
          <name>
            <surname>Nei</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Overcredibility of molecular phylogenies obtained by Bayesian phylogenetics</article-title>
        <source>Proc Natl Acad Sci U S A.</source>
        <year>2002</year>
        <volume>99</volume>
        <fpage>16138</fpage>
        <lpage>16143</lpage>
        <pub-id pub-id-type="pmid">12451182</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B41">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van de Peer</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Frickey</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Dealing with saturation at the amino acid level: a case study based on anciently duplicated zebrafish genes</article-title>
        <source>Gene</source>
        <year>2002</year>
        <volume>295</volume>
        <fpage>205</fpage>
        <lpage>211</lpage>
        <pub-id pub-id-type="pmid">12354655</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B42">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vinh</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>von Haeseler</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>IQPNNI: moving fast through tree space and stopping in time</article-title>
        <source>Mol Biol Evol.</source>
        <year>2004</year>
        <volume>21</volume>
        <fpage>1565</fpage>
        <lpage>1571</lpage>
        <pub-id pub-id-type="pmid">15163768</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B43">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Waddell</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Kishino</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ota</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Very fast algorithms for evaluating the stability of ML and Bayesian phylogenetic trees from sequence data</article-title>
        <source>Genome Inform.</source>
        <year>2002</year>
        <volume>13</volume>
        <fpage>82</fpage>
        <lpage>92</lpage>
        <pub-id pub-id-type="pmid">14571377</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B44">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weiss</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>von Haeseler</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Testing substitution models within a phylogenetic tree</article-title>
        <source>Mol Biol Evol.</source>
        <year>2003</year>
        <volume>20</volume>
        <fpage>572</fpage>
        <lpage>578</lpage>
        <pub-id pub-id-type="pmid">12679552</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B45">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Whelan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>de Bakker</surname>
            <given-names>PIW</given-names>
          </name>
          <name>
            <surname>Quevillon</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Rodriguez</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>PANDIT: an evolution-centric database of protein and associated nucleotide domains with inferred trees</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2006</year>
        <volume>34</volume>
        <fpage>D327</fpage>
        <lpage>D331</lpage>
        <pub-id pub-id-type="pmid">16381879</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B46">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Whelan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>A general empirical model of protein evolution derived from multiple protein families using a maximum-likelihood approach</article-title>
        <source>Mol Biol Evol.</source>
        <year>2001</year>
        <volume>18</volume>
        <fpage>691</fpage>
        <lpage>699</lpage>
        <pub-id pub-id-type="pmid">11319253</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B47">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Whelan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Money</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>The prevalence of multifurcations in tree-space and their implications for tree-search</article-title>
        <source>Mol Biol Evol.</source>
        <year>2010</year>
        <volume>27</volume>
        <fpage>2674</fpage>
        <lpage>2677</lpage>
        <pub-id pub-id-type="pmid">20584772</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B48">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xia</surname>
            <given-names>XH</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Salemi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>An index of substitution saturation and its application</article-title>
        <source>Mol Phylogenet Evol.</source>
        <year>2003</year>
        <volume>26</volume>
        <fpage>1</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="pmid">12470932</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B49">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Maximum likelihood phylogenetic estimation from DNA sequences with variable rates over sites: approximate methods</article-title>
        <source>J Mol Evol.</source>
        <year>1994</year>
        <volume>39</volume>
        <fpage>306</fpage>
        <lpage>314</lpage>
        <pub-id pub-id-type="pmid">7932792</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B50">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>ZH</given-names>
          </name>
          <name>
            <surname>Rannala</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Bayesian phylogenetic inference using DNA sequences: a Markov Chain Monte Carlo method</article-title>
        <source>Mol Biol Evol.</source>
        <year>1997</year>
        <volume>14</volume>
        <fpage>717</fpage>
        <lpage>724</lpage>
        <pub-id pub-id-type="pmid">9214744</pub-id>
      </element-citation>
    </ref>
    <ref id="mst024-B51">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Zwickl</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <source>Genetic algorithm approaches for the phylogenetic analysis of large biological sequence datasets under the maximum likelihood criterion</source>
        <year>2006</year>
        <publisher-loc>Austin (TX)</publisher-loc>
        <publisher-name>The University of Texas</publisher-name>
      </element-citation>
    </ref>
  </ref-list>
</back>
