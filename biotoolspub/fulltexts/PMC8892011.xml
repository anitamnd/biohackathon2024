<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.6.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art560.dtd?>
<?SourceDTD.Version 5.6.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin publisher?>
<?FILEmeta_XPRO101185 xml ?>
<?FILEmain xml ?>
<?FILEmain pdf ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<?FILEgr3 jpg ?>
<?FILEgr4 jpg ?>
<?FILEfx1 jpg ?>
<?FILEfx2 jpg ?>
<?FILEfx3 jpg ?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">STAR Protoc</journal-id>
    <journal-id journal-id-type="iso-abbrev">STAR Protoc</journal-id>
    <journal-title-group>
      <journal-title>STAR Protocols</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2666-1667</issn>
    <publisher>
      <publisher-name>Elsevier</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8892011</article-id>
    <article-id pub-id-type="pii">S2666-1667(22)00065-X</article-id>
    <article-id pub-id-type="doi">10.1016/j.xpro.2022.101185</article-id>
    <article-id pub-id-type="publisher-id">101185</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Protocol</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>FusionAI, a DNA-sequence-based deep learning protocol reduces the false positives of human fusion gene prediction</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="au1">
        <name>
          <surname>Kim</surname>
          <given-names>Pora</given-names>
        </name>
        <email>pora.kim@uth.tmc.edu</email>
        <xref rid="aff1" ref-type="aff">1</xref>
        <xref rid="fn1" ref-type="fn">5</xref>
        <xref rid="fn2" ref-type="fn">6</xref>
        <xref rid="fn3" ref-type="fn">7</xref>
        <xref rid="cor1" ref-type="corresp">∗</xref>
      </contrib>
      <contrib contrib-type="author" id="au2">
        <name>
          <surname>Tan</surname>
          <given-names>Hua</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
        <xref rid="fn1" ref-type="fn">5</xref>
      </contrib>
      <contrib contrib-type="author" id="au3">
        <name>
          <surname>Liu</surname>
          <given-names>Jiajia</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
        <xref rid="aff4" ref-type="aff">4</xref>
      </contrib>
      <contrib contrib-type="author" id="au4">
        <name>
          <surname>Kumar</surname>
          <given-names>Himansu</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au5">
        <name>
          <surname>Zhou</surname>
          <given-names>Xiaobo</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
        <xref rid="aff2" ref-type="aff">2</xref>
        <xref rid="aff3" ref-type="aff">3</xref>
      </contrib>
      <aff id="aff1"><label>1</label>School of Biomedical Informatics, The University of Texas Health Science Center at Houston, Houston, TX 77030, USA</aff>
      <aff id="aff2"><label>2</label>McGovern Medical School, The University of Texas Health Science Center at Houston, Houston, TX 77030, USA</aff>
      <aff id="aff3"><label>3</label>School of Dentistry, The University of Texas Health Science Center at Houston, Houston, TX 77030, USA</aff>
      <aff id="aff4"><label>4</label>College of Electronic and Information Engineering, Tongji University, Shanghai 201804, China</aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>∗</label>Corresponding author <email>pora.kim@uth.tmc.edu</email></corresp>
      <fn id="fn1">
        <label>5</label>
        <p id="ntpara0010">These authors contributed equally</p>
      </fn>
      <fn id="fn2">
        <label>6</label>
        <p id="ntpara0015">Technical contact</p>
      </fn>
      <fn id="fn3">
        <label>7</label>
        <p id="ntpara0020">Lead contact</p>
      </fn>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>2</month>
      <year>2022</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.-->
    <pub-date pub-type="collection">
      <day>18</day>
      <month>3</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>2</month>
      <year>2022</year>
    </pub-date>
    <volume>3</volume>
    <issue>1</issue>
    <elocation-id>101185</elocation-id>
    <permissions>
      <copyright-statement>© 2022 The Author(s)</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbyncndlicense">https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref>
        <license-p>This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).</license-p>
      </license>
    </permissions>
    <abstract id="abs0010">
      <title>Summary</title>
      <p>Even though there were many tool developments of fusion gene prediction from NGS data, too many false positives are still an issue. Wise use of the genomic features around the fusion gene breakpoints will be helpful to identify reliable fusion genes efficiently. For this aim, we developed FusionAI, a deep learning pipeline predicting human fusion gene breakpoints from DNA sequence. FusionAI is freely available via <ext-link ext-link-type="uri" xlink:href="https://compbio.uth.edu/FusionGDB2/FusionAI" id="intref0010">https://compbio.uth.edu/FusionGDB2/FusionAI</ext-link>.</p>
      <p>For complete details on the use and execution of this protocol, please refer to <xref rid="bib11" ref-type="bibr">Kim et al. (2021b)</xref>.</p>
    </abstract>
    <abstract abstract-type="graphical" id="abs0015">
      <title>Graphical abstract</title>
      <p><fig id="undfig1" position="anchor"><graphic xlink:href="fx1"/></fig>Fusion gene is one of the biomarkers of the cancer genome. Identifying the reliable fusion genes from RNA-seq data makes many false positives. Utilizing the genomic features around the genomic breakpoints can help select reliable fusion gene breakpoints. FusionAI were trained with 36K human fusion genes with an accuracy of 97.4% (<xref rid="bib11" ref-type="bibr">Kim et al., 2021b</xref>). The users can follow our protocol to make input data of FusionAI, run FusionAI, and create related genomic feature information around the fusion breakpoint area.</p>
    </abstract>
    <abstract abstract-type="author-highlights" id="abs0020">
      <title>Highlights</title>
      <p>
        <list list-type="simple" id="ulist0010">
          <list-item id="u0010">
            <label>•</label>
            <p id="p0010">FusionAI can predict the fusion breakpoints from the given DNA sequence</p>
          </list-item>
          <list-item id="u0015">
            <label>•</label>
            <p id="p0015">FusionAI can reduce the false positives of the predicted fusion genes by other tools</p>
          </list-item>
          <list-item id="u0020">
            <label>•</label>
            <p id="p0020">FusionAI can identify the genomic features related to the genomic breakage</p>
          </list-item>
          <list-item id="u0025">
            <label>•</label>
            <p id="p0025">FusionAI creates a landscape image of 44 human genomic features around the breakpoints</p>
          </list-item>
        </list>
      </p>
    </abstract>
    <abstract abstract-type="teaser" id="abs0025">
      <p>Even though there were many tool developments of fusion gene prediction from NGS data, too many false positives are still an issue. Wise use of the genomic features around the fusion gene breakpoints will be helpful to identify reliable fusion genes efficiently. For this aim, we developed FusionAI, a deep learning pipeline predicting human fusion gene breakpoints from DNA sequence. FusionAI is freely available via <ext-link ext-link-type="uri" xlink:href="https://compbio.uth.edu/FusionGDB2/FusionAI/" id="intref0015">https://compbio.uth.edu/FusionGDB2/FusionAI</ext-link>.</p>
    </abstract>
    <kwd-group id="kwrds0010">
      <title>Subject areas</title>
      <kwd>Bioinformatics</kwd>
      <kwd>Health Sciences</kwd>
      <kwd>Genomics</kwd>
      <kwd>Molecular Biology</kwd>
      <kwd>Computer sciences</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <title>Before you begin</title>
    <p id="p0035">Since the accelerated accumulation of the next-generation sequencing data, there were many tool developments for the prediction of fusion genes from the RNA-seq data such as STAR-Fusion (<xref rid="bib6" ref-type="bibr">Haas et al., 2019</xref>), Arriba (<xref rid="bib17" ref-type="bibr">Uhrig et al., 2021</xref>), SOAPfuse (<xref rid="bib7" ref-type="bibr">Jia et al., 2013</xref>), deFuse (<xref rid="bib12" ref-type="bibr">McPherson et al., 2011</xref>), and FusionScan (<xref rid="bib9" ref-type="bibr">Kim et al., 2019</xref>). The main difference between those tools comes from the ways of dealing with the RNA sequencing reads that were aligned far apart and repeat region mappings. However, too many false positives were the main problems in the prediction of fusion genes and the researchers regarded the fusion genes that were predicted in more than two prediction tools as reliable fusions. This selection approach can be helpful in reducing some false positives, but also not be helpful in terms of that all these tools are relying on the split RNA sequencing reads. Using other types of information like genomic sequence features around the breakpoint area can be a helpful and efficient way for better removal of the false positives. To help identify reliable fusion genes efficiently, we developed FusionAI, a deep learning pipeline predicting human fusion gene breakpoints from DNA sequences. For the given breakpoint of fusion genes, FusionAI provides the possibility of being used as the fusion gene breakpoints and landscapes of human genomic features around the fusion gene breakpoints. FusionAI is freely available via <ext-link ext-link-type="uri" xlink:href="https://compbio.uth.edu/FusionGDB2/FusionAI" id="intref0025">https://compbio.uth.edu/FusionGDB2/FusionAI</ext-link>.</p>
    <p id="p0040">The protocol below describes the specific steps for running FusionAI for the fusion genes predicted in K562 cell using STAR-Fusion (<xref rid="bib6" ref-type="bibr">Haas et al., 2019</xref>). By combining the output result of FusionAI to these predicted fusion genes, we can have more reliable fusion genes with reduced false positives from the fusion DNA sequence using the genomic features of the fusion gene breakpoints.</p>
    <sec id="sec1.1">
      <title>Software prerequisites and data requirements</title>
      <p id="p0045">Our model is installed and run under the Linux system. Before launching our program, preinstalled Python (&gt;= v.3.0), TensorFlow, and Keras modules are required. You should also prepare fusion gene information that was predicted using other existing tools for your cancer sample. The example of prerequisites and input data format can be found on our website: <ext-link ext-link-type="uri" xlink:href="https://compbio.uth.edu/FusionGDB2/FusionAI" id="intref0030">https://compbio.uth.edu/FusionGDB2/FusionAI</ext-link>. All the R packages required to visualize 44 human genome features in a 20 Kb DNA sequence are listed in the <xref rid="sec9" ref-type="sec">key resources table</xref> under the “R packages to draw feature landscape image” category. The R package “bedtoolsr” can only be installed using devtools::install_github ("PhanstielLab/bedtoolsr") and other R packages can be installed using install.packages() function.</p>
    </sec>
  </sec>
  <sec id="sec9">
    <title>Key resources table</title>
    <p id="p0325">
      <table-wrap position="float" id="undtbl1">
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th>REAGENT or RESOURCE</th>
              <th>SOURCE</th>
              <th>IDENTIFIER</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="3">
                <bold>Deposited data</bold>
              </td>
            </tr>
            <tr>
              <td colspan="3">
                <hr/>
              </td>
            </tr>
            <tr>
              <td>newdat_newmod_jj.h5</td>
              <td>FusionAI model in this paper.</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://compbio.uth.edu/FusionGDB2/FusionAI/newdat_newmod_jj.h5" id="intref0085">https://compbio.uth.edu/FusionGDB2/FusionAI/newdat_newmod_jj.h5</ext-link>
              </td>
            </tr>
            <tr>
              <td>gencode_hg19v19_.txt</td>
              <td>Gene structure information file with UCSC genome browser known gene format of GENCODE version 19.</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://compbio.uth.edu/FusionGDB2/FusionAI/%20gencode_hg19v19_.txt" id="intref0090">https://compbio.uth.edu/FusionGDB2/FusionAI/ gencode_hg19v19_.txt</ext-link>
              </td>
            </tr>
            <tr>
              <td>nib_files_hg19.tar.gz</td>
              <td>Nib files of all chromosomes of hg19, which were transformed from fasta files provided from the UCSC genome browser.</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://compbio.uth.edu/FusionGDB2/FusionAI/nib_files_hg19.tar.gz" id="intref0095">https://compbio.uth.edu/FusionGDB2/FusionAI/nib_files_hg19.tar.gz</ext-link>
              </td>
            </tr>
            <tr>
              <td>chromosome_size.txt</td>
              <td>This paper</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://compbio.uth.edu/FusionGDB2/FusionAI/chromosome_size.txt" id="intref0100">https://compbio.uth.edu/FusionGDB2/FusionAI/chromosome_size.txt</ext-link>
              </td>
            </tr>
            <tr>
              <td>features_info.txt</td>
              <td>This paper</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://compbio.uth.edu/FusionGDB2/FusionAI/features_info.txt" id="intref0105">https://compbio.uth.edu/FusionGDB2/FusionAI/features_info.txt</ext-link>
              </td>
            </tr>
            <tr>
              <td>feature.tar.gz</td>
              <td>This paper</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://compbio.uth.edu/FusionGDB2/FusionAI/feature.tar.gz" id="intref0110">https://compbio.uth.edu/FusionGDB2/FusionAI/feature.tar.gz</ext-link>
              </td>
            </tr>
            <tr>
              <td colspan="3">
                <hr/>
              </td>
            </tr>
            <tr>
              <td colspan="3">
                <bold>Software and algorithms</bold>
              </td>
            </tr>
            <tr>
              <td colspan="3">
                <hr/>
              </td>
            </tr>
            <tr>
              <td>Python (&gt;=3.0)</td>
              <td>Python Software Foundation, 2021: high-level programming language</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://www.python.org/downloads/" id="intref0115">https://www.python.org/downloads/</ext-link>
              </td>
            </tr>
            <tr>
              <td>nibFrag</td>
              <td>Converts portions of a .nib file back to fasta format.</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="http://hgdownload.soe.ucsc.edu/admin/jksrc.zip" id="intref0120">http://hgdownload.soe.ucsc.edu/admin/jksrc.zip</ext-link>
              </td>
            </tr>
            <tr>
              <td>Tensor flow</td>
              <td>TensorFlow is an end-to-end open source platform for machine learning.</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://anaconda.org/conda-forge/tensorflow" id="intref0125">https://anaconda.org/conda-forge/tensorflow</ext-link>
              </td>
            </tr>
            <tr>
              <td>keras</td>
              <td>A deep learning framework developed by François Chollet</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://github.com/keras-team/keras" id="intref0130">https://github.com/keras-team/keras</ext-link>
              </td>
            </tr>
            <tr>
              <td>pandas</td>
              <td>A community project for fast and easy data analysis and manipulation</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://pandas.pydata.org/about/" id="intref0135">https://pandas.pydata.org/about/</ext-link>
              </td>
            </tr>
            <tr>
              <td>numpy</td>
              <td>Community project, 2021: array processing for numbers, strings, records, and objects</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://numpy.org/" id="intref0140">https://numpy.org/</ext-link>
              </td>
            </tr>
            <tr>
              <td>argparse</td>
              <td>A python module that makes it easy to write user-friendly command-line interfaces</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://docs.python.org/3/library/argparse.html" id="intref0145">https://docs.python.org/3/library/argparse.html</ext-link>
              </td>
            </tr>
            <tr>
              <td>FusionAI_pred.py</td>
              <td>This paper</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://compbio.uth.edu/FusionGDB2/FusionAI/FusionAI_pred.py" id="intref0150">https://compbio.uth.edu/FusionGDB2/FusionAI/FusionAI_pred.py</ext-link>
              </td>
            </tr>
            <tr>
              <td>FusionAI_FIS.py</td>
              <td>This paper</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://compbio.uth.edu/FusionGDB2/FusionAI/FusionAI_FIS.py" id="intref0155">https://compbio.uth.edu/FusionGDB2/FusionAI/FusionAI_FIS.py</ext-link>
              </td>
            </tr>
            <tr>
              <td>pre_processing_for_FusionAI_from_tab_delim.py</td>
              <td>This paper</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://compbio.uth.edu/FusionGDB2/FusionAI/pre_processing_for_FusionAI_from_tab_delim.py" id="intref0160">https://compbio.uth.edu/FusionGDB2/FusionAI/pre_processing_for_FusionAI_from_tab_delim.py</ext-link>
              </td>
            </tr>
            <tr>
              <td>bedtools (&gt;=2.26.0)</td>
              <td>(<xref rid="bib15" ref-type="bibr">Quinlan and Hall, 2010</xref>): a powerful toolset for genome arithmetic</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://bedtools.readthedocs.io/en/latest/content/installation.html" id="intref0165">https://bedtools.readthedocs.io/en/latest/content/installation.html</ext-link>
              </td>
            </tr>
            <tr>
              <td>R (&gt;=3.5)</td>
              <td>(<xref rid="bib16" ref-type="bibr">Team, 2019</xref>): software environment for statistical computing and graphics</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://www.r-project.org/" id="intref0170">https://www.r-project.org/</ext-link>
              </td>
            </tr>
            <tr>
              <td>devtools (&gt;=1.13.6)</td>
              <td>(<xref rid="bib18" ref-type="bibr">Wickham et al., 2018</xref>): developing R Packages tool</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/devtools/index.html" id="intref0175">https://cran.r-project.org/web/packages/devtools/index.html</ext-link>
              </td>
            </tr>
            <tr>
              <td>bedtoolsr (2.30.0.1)</td>
              <td>(<xref rid="bib14" ref-type="bibr">Patwardhan et al., 2019</xref>): genomic data analysis and manipulation</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="http://phanstiel-lab.med.unc.edu/bedtoolsr-install.html" id="intref0180">http://phanstiel-lab.med.unc.edu/bedtoolsr-install.html</ext-link>
              </td>
            </tr>
            <tr>
              <td>optparse (&gt;=1.6.0)</td>
              <td>(<xref rid="bib5" ref-type="bibr">Davis, 2018</xref>): Command Line Option Parser</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/optparse/index.html" id="intref0185">https://cran.r-project.org/web/packages/optparse/index.html</ext-link>
              </td>
            </tr>
            <tr>
              <td>doParallel (1.0.16)</td>
              <td>(<xref rid="bib4" ref-type="bibr">Corporation and Weston, 2020</xref>): parallel backend</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/doParallel/index.html" id="intref0190">https://cran.r-project.org/web/packages/doParallel/index.html</ext-link>
              </td>
            </tr>
            <tr>
              <td>iterators (1.0.13)</td>
              <td>(<xref rid="bib1" ref-type="bibr">Analytics and Weston, 2020</xref>): a package to allow a programmer to traverse through all the elements of a vector, list, or other collection of data</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/iterators/index.html" id="intref0195">https://cran.r-project.org/web/packages/iterators/index.html</ext-link>
              </td>
            </tr>
            <tr>
              <td>magrittr (2.0.1)</td>
              <td>(<xref rid="bib3" ref-type="bibr">Bache and Wickham, 2020</xref>): A Forward-Pipe Operator for R</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/magrittr/index.html" id="intref0200">https://cran.r-project.org/web/packages/magrittr/index.html</ext-link>
              </td>
            </tr>
            <tr>
              <td>foreach (1.5.1)</td>
              <td>(<xref rid="bib13" ref-type="bibr">Microsoft and Weston, 2020</xref>): an idiom that allows for iterating over elements in a collection, without the use of an explicit loop counter.</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/foreach/index.html" id="intref0205">https://cran.r-project.org/web/packages/foreach/index.html</ext-link>
              </td>
            </tr>
            <tr>
              <td>ggplot2 (3.3.5)</td>
              <td>(<xref rid="bib20" ref-type="bibr">Wickham, 2016</xref>): Elegant Graphics for Data Analysis</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/ggplot2/index.html" id="intref0210">https://cran.r-project.org/web/packages/ggplot2/index.html</ext-link>
              </td>
            </tr>
            <tr>
              <td>gridExtra (2.3)</td>
              <td>(<xref rid="bib2" ref-type="bibr">Auguie, 2017</xref>): a package to arrange multiple grid-based plots on a page</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/gridExtra/index.html" id="intref0215">https://cran.r-project.org/web/packages/gridExtra/index.html</ext-link>
              </td>
            </tr>
            <tr>
              <td>scales (1.1.1)</td>
              <td>(<xref rid="bib19" ref-type="bibr">Wickham and Seidel, 2020</xref>): Graphical scales map data to aesthetics, and provide methods for automatically determining breaks and labels for axes and legends.</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/scales/index.html" id="intref0220">https://cran.r-project.org/web/packages/scales/index.html</ext-link>
              </td>
            </tr>
            <tr>
              <td>cowplot (1.1.1)</td>
              <td>(<xref rid="bib21" ref-type="bibr">Wilke, 2020</xref>): a set of themes, functions to align plots and arrange them into complex compound figures, and functions that make it easy to annotate plots and or mix plots with images.</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/cowplot/index.html" id="intref0225">https://cran.r-project.org/web/packages/cowplot/index.html</ext-link>
              </td>
            </tr>
            <tr>
              <td>ggpubr (&gt;=0.1.7)</td>
              <td>(<xref rid="bib8" ref-type="bibr">Kassambara, 2018</xref>): 'ggplot2′ Based Publication Ready Plots</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/ggpubr/index.html" id="intref0230">https://cran.r-project.org/web/packages/ggpubr/index.html</ext-link>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </p>
  </sec>
  <sec id="sec2">
    <title>Materials and equipment</title>
    <p id="p0050">The program in this protocol was written in the Ubuntu Linux system using Python language (&gt;=v.3.0). All experiments were carried out and evaluated under the Ubuntu system with the computational resources listed in <xref rid="tbl1" ref-type="table">Table 1</xref>.<disp-quote><p><inline-graphic xlink:href="fx2.gif"/><bold>CRITICAL:</bold> The implementation of the model is lightweight. However, the required memory usage in practice depends on the size of your own data.</p></disp-quote><disp-quote><p><bold><italic>Alternatives:</italic></bold> 1. Our model can work with fewer CPU cores and less RAM memory, although it may take a longer time for a large dataset. During running the example input for FusionAI, it used 17.6% of a CPU and 0.3% of the memory of the server with the computation capacity described in <xref rid="tbl1" ref-type="table">Table 1</xref>. 2. If the user does not need to draw the feature images, then no need to install the software and algorithms to draw the feature landscape images listed in the <xref rid="sec9" ref-type="sec">key resources table</xref>.</p></disp-quote><table-wrap position="float" id="tbl1"><label>Table 1</label><caption><p>Computation resources used in this study</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Operating system</th><th>Version</th></tr></thead><tbody><tr><td>CentOS Linux</td><td>7.9.2009</td></tr><tr><td>CPU information</td><td>Parameter</td></tr><tr><td>RAM Memory</td><td>93 GB</td></tr><tr><td>Thread(s) per core</td><td>2</td></tr><tr><td>Core(s) per socket</td><td>2</td></tr><tr><td>Model</td><td>85</td></tr><tr><td>Model name</td><td>Intel(R) Xeon(R) Gold 6254 CPU @ 3.10 GHz</td></tr><tr><td>CPU MHz:</td><td>2899.816</td></tr><tr><td>CPU(s)</td><td>36</td></tr></tbody></table></table-wrap></p>
  </sec>
  <sec id="sec3">
    <title>Step-by-step method details</title>
    <sec id="sec3.1">
      <title>Download our package and install the prerequisites</title>
      <p id="p0055">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx3.gif"/>
            <bold>Timing: &lt; 10 min</bold>
          </p>
        </disp-quote>
        <list list-type="simple" id="olist0010">
          <list-item id="o0010">
            <label>1.</label>
            <p id="p0060">Download the latest version of FusionAI into your preferred directory. The running will be executed inside of this directory (a, b, c, and d are required for running FusionAI. e, f and g are required to draw feature landscape images for the chosen fusion genes):<list list-type="simple" id="olist0015"><list-item id="o0015"><label>a.</label><p id="p0065">Download FusionAI_pred.py from <ext-link ext-link-type="uri" xlink:href="https://compbio.uth.edu/FusionGDB2/FusionAI/FusionAI_pred.py" id="intref0035">https://compbio.uth.edu/FusionGDB2/FusionAI/FusionAI_pred.py</ext-link></p></list-item><list-item id="o0020"><label>b.</label><p id="p0070">Download FusionAI model (newdat_newmod_jj.h5) from <ext-link ext-link-type="uri" xlink:href="https://compbio.uth.edu/FusionGDB2/FusionAI/newdat_newmod_jj.h5" id="intref0040">https://compbio.uth.edu/FusionGDB2/FusionAI/newdat_newmod_jj.h5</ext-link></p></list-item><list-item id="o0025"><label>c.</label><p id="p0075">Download preprocessing script (pre_processing_for_FusionAI_from_tab_delim.py) from <ext-link ext-link-type="uri" xlink:href="https://compbio.uth.edu/FusionGDB2/FusionAI/pre_processing_for_FusionAI_from_tab_delim.py" id="intref0045">https://compbio.uth.edu/FusionGDB2/FusionAI/pre_processing_for_FusionAI_from_tab_delim.py</ext-link></p></list-item><list-item id="o0030"><label>d.</label><p id="p0080">Download example fusion gene file (k562_starfusion.txt) <ext-link ext-link-type="uri" xlink:href="https://compbio.uth.edu/FusionGDB2/FusionAI/k562_starfusion.txt" id="intref0050">https://compbio.uth.edu/FusionGDB2/FusionAI/k562_starfusion.txt</ext-link></p></list-item><list-item id="o0035"><label>e.</label><p id="p0085">Download 44 human genomic feature information files (features.tar.gz, features_info.txt, and chromosome_size.txt) from <ext-link ext-link-type="uri" xlink:href="https://compbio.uth.edu/FusionGDB2/FusionAI/features.tar.gz" id="intref0055">https://compbio.uth.edu/FusionGDB2/FusionAI/features.tar.gz</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://compbio.uth.edu/FusionGDB2/FusionAI/features_info.txt" id="intref0060">https://compbio.uth.edu/FusionGDB2/FusionAI/features_info.txt</ext-link>, and <ext-link ext-link-type="uri" xlink:href="https://compbio.uth.edu/FusionGDB2/FusionAI/chromosome_size.txt" id="intref0065">https://compbio.uth.edu/FusionGDB2/FusionAI/chromosome_size.txt</ext-link></p></list-item><list-item id="o0040"><label>f.</label><p id="p0090">Download human gene structure file and nib files (gencode_hg19v19_.txt and nib_files_hg19.tar.gz) from <ext-link ext-link-type="uri" xlink:href="https://compbio.uth.edu/FusionGDB2/FusionAI/gencode_hg19v19_.txt" id="intref0070">https://compbio.uth.edu/FusionGDB2/FusionAI/gencode_hg19v19_.txt</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://compbio.uth.edu/FusionGDB2/FusionAI/nib_files_hg19.tar.gz" id="intref0075">https://compbio.uth.edu/FusionGDB2/FusionAI/nib_files_hg19.tar.gz</ext-link></p></list-item><list-item id="o0045"><label>g.</label><p id="p0095">Install R packages using the command install.packages(). Input the individual R package name into the parenthesis like install.packages(‘devtools’). These</p></list-item></list></p>
          </list-item>
        </list>
      </p>
    </sec>
    <sec id="sec3.2">
      <title>Prepare input data of 20 Kb DNA sequence of fusion genes</title>
      <p id="p0100">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx3.gif"/>
            <bold>Timing: &lt; 1 min</bold>
          </p>
        </disp-quote>
      </p>
      <p id="p0105">FusionAI takes the input data of fusion gene breakpoint information, which is given by other fusion gene prediction tools or known fusion gene information (k562_starfusion.txt and <xref rid="tbl2" ref-type="table">Table 2</xref>). The preprocessing script will make 20 Kb DNA sequences for individual fusion genes, which is the combined sequence of +/-5 Kb flanking sequence from the two breakpoints’ genomic position for individual fusion partner genes (<xref rid="fig1" ref-type="fig">Figure 1</xref> and <xref rid="tbl3" ref-type="table">Table 3</xref>).<list list-type="simple" id="olist0020"><list-item id="o0050"><label>2.</label><p id="p0110">Run preprocessing script to make a 20 Kb DNA sequence from the given fusion gene information. The fusion gene information should include the following information in tab-delimited format: Hgene, Hchr, Hbp, Hstrand, Tgene, Tchr, Tbp, Tstrand. The command is shown below. Here the $ INPUT_FILE is the output file after checking the junction position of the fusion breakpoints in step 2.</p></list-item></list><boxed-text id="dtbox1"><p id="p0115">&gt; python pre_processing_for_FusionAI_from_tab_delim.py [INPUT_FILE]</p><p id="p0120">&gt; python pre_processing_for_FusionAI_from_tab_delim.py k562_starfusion.txt</p></boxed-text><disp-quote><p><inline-graphic xlink:href="fx2.gif"/><bold>CRITICAL:</bold> The timing is based on the number of fusion genes of the input file.</p></disp-quote><table-wrap position="float" id="tbl2"><label>Table 2</label><caption><p>Fusion gene information example, which were predicted for K562 cell-line from STAR-fusion</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Hgene</th><th>Hchr</th><th>Hbp</th><th>Hstrand</th><th>Tgene</th><th>Tchr</th><th>Tbp</th><th>Tstrand</th></tr></thead><tbody><tr><td>BCR</td><td>chr22</td><td>23632600</td><td>+</td><td>ABL1</td><td>chr9</td><td>133729450</td><td>+</td></tr><tr><td>BAG6</td><td>chr6</td><td>31619433</td><td>-</td><td>SLC44A4</td><td>chr6</td><td>31833561</td><td>-</td></tr><tr><td>NUP214</td><td>chr9</td><td>134074402</td><td>+</td><td>XKR3</td><td>chr22</td><td>17288973</td><td>-</td></tr><tr><td>⁞</td><td>⁞</td><td>⁞</td><td/><td>⁞</td><td>⁞</td><td>⁞</td><td/></tr></tbody></table></table-wrap><fig id="fig1"><label>Figure 1</label><caption><p>Make input data of FusionAI</p></caption><graphic xlink:href="gr1"/></fig><table-wrap position="float" id="tbl3"><label>Table 3</label><caption><p>FusionAI input data example, which were made by running preprocessing script</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Hgene</th><th>Hchr</th><th>Hbp</th><th>Hstrand</th><th>Tgene</th><th>Tchr</th><th>Tbp</th><th>Tstrand</th><th>20 Kb fusion DNA sequence</th></tr></thead><tbody><tr><td>BCR</td><td>chr22</td><td>23632600</td><td>+</td><td>ABL1</td><td>chr9</td><td>133729450</td><td>+</td><td>TACCAGAGCGGCTGCCAAC…</td></tr><tr><td>BAG6</td><td>chr6</td><td>31619433</td><td>-</td><td>SLC44A4</td><td>chr6</td><td>31833561</td><td>-</td><td>CAGTGATGCTTCTGCCTCC…</td></tr><tr><td>NUP214</td><td>chr9</td><td>134074402</td><td>+</td><td>XKR3</td><td>chr22</td><td>17288973</td><td>-</td><td>GATAAAATTTTTTCACTAA…</td></tr><tr><td>⁞</td><td>⁞</td><td>⁞</td><td>⁞</td><td>⁞</td><td>⁞</td><td>⁞</td><td>⁞</td><td>⁞</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="sec3.3">
      <title>Run FusionAI</title>
      <p id="p0125">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx3.gif"/>
            <bold>Timing: &lt; 2 s (depending on your data)</bold>
          </p>
        </disp-quote>
      </p>
      <p id="p0130">FusionAI takes the 20 Kb DNA sequence of fusion genes from the previous step and outputs two probabilities as not being used and being used as the fusion gene breakpoints (<xref rid="fig2" ref-type="fig">Figure 2</xref>).<list list-type="simple" id="olist0025"><list-item id="o0055"><label>3.</label><p id="p0135">Run FusionAI prediction script to predict the fusion breakpoint tendency from the FusionAI model. Here the $ INPUT_FILE is the output file after making the 20 Kb DNA sequence in the previous step. $COLA and $COLB are the DNA sequences of 5′ and 3′ fusion partner genes that were created from the previous step. If the user wants to run for one specific fusion gene, then set $INDEX_OF_FUSION as row index of interested line in the input file.</p></list-item></list><boxed-text id="dtbox2"><p id="p0140">&gt; python FusionAI_pred.py [-h] -f [INPUT_FILE] -m [MODEL, default: newdat_newmod_jj.h5] -o [OUTPUT_FILE] -A [COLA] -B [COLB] -I [INDEX_OF_FUSION]</p><p id="p0145">&gt; python FusionAI_pred.py -f k562_starfusion.FusionAI.input -o k562_starfusion.FusionAI .output -m newdat_newmod_jj.h5</p></boxed-text><fig id="fig2"><label>Figure 2</label><caption><p>Diagram of fusion gene breakpoints classification by FusionAI</p></caption><graphic xlink:href="gr2"/></fig></p>
    </sec>
    <sec id="sec3.4">
      <title>Select high scored fusion genes (or interested fusion genes) from FusionAI output</title>
      <p id="p0150">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx3.gif"/>
            <bold>Timing: &lt; 5 s</bold>
          </p>
        </disp-quote>
      </p>
      <p id="p0155">From the output scores of FusionAI for the fusion candidates that were predicted from other tools, the users can select high scored or interested fusion genes. This can be done by the user in a text editor or another appropriate tool of choice. The users can stop the pipeline at this step if they do not need to do further analyses including feature importance analysis or drawing a landscape image of human genomic features in fusion genes, which take relatively long. With the output scores of FusionAI, still uses can reduce the false positives. For better understanding, <xref rid="tbl4" ref-type="table">Table 4</xref> shows the comparison results among different cutoff of FusionAI scores, other prediction tools, and experimentally validated fusion genes. <xref rid="tbl5" ref-type="table">Table 5</xref> shows the accuracy comparisons. When we used a higher threshold of FusionAI output scores, we could reduce the false positives efficiently.<list list-type="simple" id="olist0030"><list-item id="o0060"><label>4.</label><p id="p0160">Sort the FusionAI prediction output based on the FusionAI scores of individual fusion genes and select high-scored fusion genes. The users can choose the cutoff score, which should be larger than 0.5. <xref rid="tbl4" ref-type="table">Table 4</xref> below shows the examples that were chosen with different cutoffs like 0.5 or 0.95. Then, the selected fusion genes will be used for further analyses such as screening of the feature importance scores and landscaping the human genomic features across 20 Kb fusion DNA sequence in the following steps.</p></list-item></list><table-wrap position="float" id="tbl4"><label>Table 4</label><caption><p>Selection of common fusion genes between FusionAI and other tools based on the FusionAI score including validated fusion genes for the user’s information</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Hgene</th><th>Hchr</th><th>Hbp</th><th>Hstrand</th><th>Tgene</th><th>Tchr</th><th>Tbp</th><th>Tstrand</th><th>STAR-fusion</th><th>STAR-fusion &amp; FusionAI &gt;0.5</th><th>STAR-fusion &amp; FusionAI &gt;0.95</th><th>STAR-fusion &amp; arriba</th><th>Validated</th><th>FusionAI score</th></tr></thead><tbody><tr><td>BCR</td><td>chr22</td><td>23632600</td><td>+</td><td>ABL1</td><td>chr9</td><td>133729450</td><td>+</td><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td><td>0.9999999</td></tr><tr><td>IMMP2L</td><td>chr7</td><td>111127293</td><td>-</td><td>DOCK4</td><td>chr7</td><td>111409733</td><td>-</td><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td><td>0.9999999</td></tr><tr><td>BAG6</td><td>chr6</td><td>31619432</td><td>-</td><td>SLC44A4</td><td>chr6</td><td>31833561</td><td>-</td><td>X</td><td>X</td><td>X</td><td/><td>X</td><td>0.99999857</td></tr><tr><td>RP11-344E13.3</td><td>chr17</td><td>20771998</td><td>+</td><td>UBBP4</td><td>chr17</td><td>21730694</td><td>+</td><td>X</td><td>X</td><td>X</td><td>X</td><td/><td>0.9999932</td></tr><tr><td>BAG6</td><td>chr6</td><td>31619432</td><td>-</td><td>SLC44A4</td><td>chr6</td><td>31833378</td><td>-</td><td>X</td><td>X</td><td>X</td><td/><td>X</td><td>0.9999831</td></tr><tr><td>C10orf76</td><td>chr10</td><td>103799769</td><td>-</td><td>KCNIP2</td><td>chr10</td><td>103588956</td><td>-</td><td>X</td><td>X</td><td>X</td><td>X</td><td/><td>0.99743265</td></tr><tr><td>RP11-321F6.1</td><td>chr15</td><td>66874586</td><td>+</td><td>SMAD6</td><td>chr15</td><td>67004005</td><td>+</td><td>X</td><td>X</td><td>X</td><td/><td/><td>0.9900406</td></tr><tr><td>NUP214</td><td>chr9</td><td>134074402</td><td>+</td><td>XKR3</td><td>chr22</td><td>17288973</td><td>-</td><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td><td>0.95663476</td></tr><tr><td>RP11-96H19.1</td><td>chr12</td><td>46781755</td><td>+</td><td>RP11-446N19.1</td><td>chr12</td><td>47046172</td><td>+</td><td>X</td><td>X</td><td/><td/><td/><td>0.93317753</td></tr><tr><td>RP11-96H19.1</td><td>chr12</td><td>46781755</td><td>+</td><td>RP11-446N19.1</td><td>chr12</td><td>46965038</td><td>+</td><td>X</td><td>X</td><td/><td/><td/><td>0.9303843</td></tr><tr><td>RP5-964N17.1</td><td>chrX</td><td>113181480</td><td>-</td><td>LRCH2</td><td>chrX</td><td>114398346</td><td>-</td><td>X</td><td>X</td><td/><td/><td/><td>0.8816845</td></tr><tr><td>UPF3A</td><td>chr13</td><td>115070392</td><td>+</td><td>CDC16</td><td>chr13</td><td>115037658</td><td>+</td><td>X</td><td>X</td><td/><td>X</td><td>X</td><td>0.8794392</td></tr><tr><td>CTC-786C10.1</td><td>chr16</td><td>85205413</td><td>+</td><td>RP11-680G10.1</td><td>chr16</td><td>85391068</td><td>+</td><td>X</td><td>X</td><td/><td/><td/><td>0.8380846</td></tr><tr><td>C16orf87</td><td>chr16</td><td>46858297</td><td>-</td><td>ORC6</td><td>chr16</td><td>46729473</td><td>+</td><td>X</td><td>X</td><td/><td>X</td><td/><td>0.6423692</td></tr><tr><td>RP11-680G10.1</td><td>chr16</td><td>85391249</td><td>+</td><td>GSE1</td><td>chr16</td><td>85667519</td><td>+</td><td>X</td><td/><td/><td/><td/><td>0.30633911</td></tr><tr><td>C16orf87</td><td>chr16</td><td>46858297</td><td>-</td><td>ORC6</td><td>chr16</td><td>46727004</td><td>+</td><td>X</td><td/><td/><td>X</td><td/><td>0.13516404</td></tr><tr><td>RP11-680G10.1</td><td>chr16</td><td>85391249</td><td>+</td><td>GSE1</td><td>chr16</td><td>85682157</td><td>+</td><td>X</td><td/><td/><td/><td/><td>0.040422514</td></tr></tbody></table></table-wrap><table-wrap position="float" id="tbl5"><label>Table 5</label><caption><p>Accuracies across different comparisons of results for the users’ information</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>STAR-fusion</th><th>FusionAI &gt; 0.5</th><th>FusionAI &gt; 0.95</th><th>Arriba</th><th>Validated</th></tr></thead><tbody><tr><td>TP</td><td>6</td><td>6</td><td>5</td><td>4</td><td>6</td></tr><tr><td>FP</td><td>11</td><td>8</td><td>3</td><td>4</td><td>0</td></tr><tr><td>TN</td><td>0</td><td>3</td><td>8</td><td>9</td><td>11</td></tr><tr><td>FN</td><td>0</td><td>0</td><td>1</td><td>2</td><td>0</td></tr><tr><td>Precision</td><td>0.35</td><td>0.43</td><td>0.63</td><td>0.50</td><td>1.00</td></tr><tr><td>Recall</td><td>1.00</td><td>1.00</td><td>0.83</td><td>0.67</td><td>1.00</td></tr><tr><td>Accuracy</td><td>0.35</td><td>0.53</td><td>0.76</td><td>0.68</td><td>1.00</td></tr><tr><td>F-measure</td><td>0.52</td><td>0.60</td><td>0.71</td><td>0.57</td><td>1.00</td></tr><tr><td>MCC</td><td>NA</td><td>0.34</td><td>0.54</td><td>0.34</td><td>1.00</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="sec3.5">
      <title>Calculate the feature importance scores across 20 Kb DNA sequence</title>
      <p id="p0165">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx3.gif"/>
            <bold>Timing: &lt; 33 min</bold>
          </p>
        </disp-quote>
      </p>
      <p id="p0170">After selecting the reliable fusion gene candidates, the users can check the distribution of the feature importance scores of individual fusion genes across the 20 Kb fusion DNA sequence. To calculate the feature importance score (FIS), we masked 20 bp each time by setting all the 20 values to zero and measured the change of prediction outcome upon this masking. We slide this 20 bp window 20 nucleotides each time along the whole 20K input sequence and repeated the procedure to obtain the FIS for all the 20 bp segments. In this way, we got 20,000/20 = 1,000 FIS for each input sequence.<list list-type="simple" id="olist0035"><list-item id="o0065"><label>5.</label><p id="p0175">Run FusionAI feature importance score script to get the feature importance scores across the 20 Kb fusion DNA sequence. Here the $ INPUT_FILE is the output file after making 20 Kb DNA sequence in step 3. $COLA and $COLB are the DNA sequences of 5′ and 3′ fusion partner genes that were created from step 3. If the user wants to run for one specific fusion gene, then set $INDEX_OF_FUSION, the row indexes of interested lines in the input file. If the user can use multiple GPUs, then the user can control the number of GPUs using the parameter of NGPUS. However, the GPU is not necessary (<xref rid="fig3" ref-type="fig">Figure 3</xref>).<fig id="fig3"><label>Figure 3</label><caption><p>Calculate the feature importance scores across 20 Kb fusion DNA sequence</p></caption><graphic xlink:href="gr3"/></fig></p></list-item></list><boxed-text id="dtbox3"><p id="p0180">&gt; python FusionAI_FIS.py [-h] -f FILENAME [-m MODEL, default: newdat_newmod_jj.h5] [-o OUTPUT] [-A COLA] [-B COLB] [-I ROWI] [-N NGPUS]</p><p id="p0185">&gt; python FusionAI_FIS.py -f k562_starfusion.FusionAI.output -o k562_starfusion.FusionAI.output.FIS</p></boxed-text></p>
    </sec>
    <sec id="sec3.6">
      <title>Visualize 44 human genomic features across 20 Kb DNA sequence</title>
      <p id="p0190">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx3.gif"/>
            <bold>Timing: &lt; 1 h 10 min and &lt; 20 min for step 6 and 7, respectively</bold>
          </p>
        </disp-quote>
      </p>
      <p id="p0195">After getting reliable fusion gene candidates and feature importance scores, it is important to interpret the aspect of human genomic features. From our original work, we integrated 44 human genomic features across five important cellular mechanism categories such as integration site category of 6 viruses, 13 types of repeat category, 5 types of structural variant category, 15 different types of chromatin state category, and 5 gene expression regulatory category (<xref rid="bib10" ref-type="bibr">Kim et al., 2021a</xref>, <xref rid="bib11" ref-type="bibr">2021b</xref>). From this step, the users can create two figures on the landscape of the fusion gene breakpoint-related genomic features across the 20 Kb fusion DNA sequence. Each script will create separate figures of individual fusion genes that have the FIS values from the previous step. All figures will be created under the user defined directory. The first figure is the overlap between the 20 Kb fusion DNA sequence and 44 genomic features and the second figure is the overlap between the top 1% FIS regions and 44 genomic features (<xref rid="fig4" ref-type="fig">Figure 4</xref>).<list list-type="simple" id="olist0040"><list-item id="o0070"><label>6.</label><p id="p0200">Visualize 44 human genomic features across a 20 Kb DNA sequence. Run FusionAI genomic feature analysis script to make a landscape image of overlap between fusion breakpoints area (+/- 5 Kb) and 44 human genomic features.</p></list-item></list><boxed-text id="dtbox4"><p id="p0205">&gt; Rscript FusionAI_genomic_features.R -g [FUSION_GENE_FILE] -f [FEATURE_PATH] -s [CHROMOSOME_SIZE_FILE] -i [FEATURE_INFO_FILE] -o [OUTPUT_FILE_PATH]</p><p id="p0210">&gt; Rscript FusionAI_genomic_features.r -g K562_STARfusion.FusionAI.output.FIS -f ./features/ -s chromosome_size.txt -i features_info.txt -o ./K562/whole_features/</p></boxed-text><list list-type="simple" id="olist0045"><list-item id="o0075"><label>7.</label><p id="p0215">Visualize the overlaps between the top 1% FIS regions and 44 human genomic features across 20 Kb DNA sequence. Run FusionAI genomic feature analysis script to have the landscape of overlap between high-FIS regions of fusion genes and 44 human genomic features.</p></list-item></list><boxed-text id="dtbox5"><p id="p0220">&gt; Rscript FusionAI_genomic_features2.R -g [FUSION_GENE_FILE] -f [FEATURE_PATH] -s [CHROMOSOME_SIZE_FILE] -i [FEATURE_INFO_FILE] -o [OUTPUT_FILE_PATH]</p><p id="p0225">&gt; Rscript FusionAI_genomic_features2.r -g K562_STARfusion.FusionAI.output.FIS -f ./features/ -s chromosome_size.txt -i features_info.txt -o ./K562/top1pct_features/</p></boxed-text><fig id="fig4"><label>Figure 4</label><caption><p>Left - distribution of 44 human genomic features across 20 Kb fusion DNA sequence</p><p>Right - overlap between the top 1% FIS regions and 44 different types of human genomic features across 20 Kb fusion DNA sequence.</p></caption><graphic xlink:href="gr4"/></fig></p>
    </sec>
  </sec>
  <sec id="sec4">
    <title>Expected outcomes</title>
    <p id="p0230">The above command will generate the following results from your fusion gene candidates’ information: FusionAI output scores: FusionAI result will be saved in the current working directory with your preferred output file name. Feature importance scores: 1,000 feature importance scores of individual fusion genes that were resulted as the potential fusion breakpoints will be saved in the current working directory with your preferred output file name. Genomic feature landscape images: the distribution of 44 human genomic features across 20 Kb fusion DNA sequence will be saved in the current working directory with your preferred output file name.</p>
  </sec>
  <sec id="sec5">
    <title>Limitations</title>
    <p id="p0235">For prediction tasks, since our program provides an option of taking one fusion at a time, there is no problem running it on a CPU.</p>
  </sec>
  <sec id="sec6">
    <title>Troubleshooting</title>
    <sec id="sec6.1">
      <title>Problem 1</title>
      <p id="p0240">Installation of FusionAI fails due to uninstalled prerequisites (step 1).</p>
    </sec>
    <sec id="sec6.2">
      <title>Potential solution</title>
      <p id="p0245">Please install the required dependencies manually through the links we provided in the <xref rid="sec9" ref-type="sec">key resources table</xref>, and then try installing FusionAI again.</p>
    </sec>
    <sec id="sec6.3">
      <title>Problem 2</title>
      <p id="p0250">Installation of FusionAI fails due to using old version python (step 1).</p>
    </sec>
    <sec id="sec6.4">
      <title>Potential solution</title>
      <p id="p0255">Please install the recent version of python at least v 3.0, and then try installing FusionAI again.</p>
    </sec>
    <sec id="sec6.5">
      <title>Problem 3</title>
      <p id="p0260">The preprocessing script fails to read the fusion gene information (step 2).</p>
    </sec>
    <sec id="sec6.6">
      <title>Potential solution</title>
      <p id="p0265">Please make the fusion gene information following the format described in step 2.</p>
    </sec>
    <sec id="sec6.7">
      <title>Problem 4</title>
      <p id="p0270">FusionAI fails to read the input file or parse it correctly.</p>
    </sec>
    <sec id="sec6.8">
      <title>Potential solution</title>
      <p id="p0275">Currently, FusionAI can only parse the tab- and space-separated file. Please check the format of the input file and make sure each column was properly separated and each row has the same number of columns.</p>
    </sec>
    <sec id="sec6.9">
      <title>Problem 5</title>
      <p id="p0280">FusionAI fails at the one-hot encoding step.</p>
    </sec>
    <sec id="sec6.10">
      <title>Potential solution</title>
      <p id="p0285">Make Sure the input DNA sequences contain only five letters: A, C, G, T, and N.</p>
    </sec>
    <sec id="sec6.11">
      <title>Problem 6</title>
      <p id="p0290">Running FusionAI fails due to missing parameters (step 3).</p>
    </sec>
    <sec id="sec6.12">
      <title>Potential solution</title>
      <p id="p0295">Please provide the essential parameters to run FusionAI such as input and output file names, and then run FusionAI again.</p>
    </sec>
    <sec id="sec6.13">
      <title>Problem 7</title>
      <p id="p0300">Creating genomic feature landscape image fails due to not downloading human genomic feature information files (step 3).</p>
    </sec>
    <sec id="sec6.14">
      <title>Potential solution</title>
      <p id="p0305">Please download the human genomic feature information files from the link we provided in the <xref rid="sec9" ref-type="sec">key resources table</xref>, and then run the script again.</p>
    </sec>
  </sec>
  <sec id="sec7">
    <title>Resource availability</title>
    <sec id="sec7.1">
      <title>Lead contact</title>
      <p id="p0310">Further information and requests for resources and reagents should be directed to and will be fulfilled by the lead contact, Pora Kim (<ext-link ext-link-type="uri" xlink:href="mailto:pora.kim@uth.tmc.edu" id="intref0080">pora.kim@uth.tmc.edu</ext-link>).</p>
    </sec>
    <sec id="sec7.2">
      <title>Materials availability</title>
      <p id="p0315">This study did not generate new unique reagents.</p>
    </sec>
  </sec>
</body>
<back>
  <ref-list id="cebib0010">
    <title>References</title>
    <ref id="bib1">
      <element-citation publication-type="book" id="sref1">
        <person-group person-group-type="author">
          <name>
            <surname>Analytics</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Weston</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <part-title>Iterators: Provides Iterator Construct</part-title>
        <year>2020</year>
        <comment>R Package Version 1.0.13</comment>
      </element-citation>
    </ref>
    <ref id="bib2">
      <element-citation publication-type="book" id="sref2">
        <person-group person-group-type="author">
          <name>
            <surname>Auguie</surname>
            <given-names>B.</given-names>
          </name>
        </person-group>
        <part-title>gridExtra: Miscellaneous Functions for "Grid" Graphics</part-title>
        <year>2017</year>
        <comment>R package version 2.3</comment>
      </element-citation>
    </ref>
    <ref id="bib3">
      <element-citation publication-type="book" id="sref3">
        <person-group person-group-type="author">
          <name>
            <surname>Bache</surname>
            <given-names>S.M.</given-names>
          </name>
          <name>
            <surname>Wickham</surname>
            <given-names>H.</given-names>
          </name>
        </person-group>
        <part-title>Magrittr: A Forward-Pipe Operator for R</part-title>
        <year>2020</year>
        <comment>R Package Version 2.0.1</comment>
      </element-citation>
    </ref>
    <ref id="bib4">
      <element-citation publication-type="book" id="sref4">
        <person-group person-group-type="author">
          <name>
            <surname>Corporation</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Weston</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <part-title>doParallel: foreach parallel adaptor for the 'parallel' package</part-title>
        <year>2020</year>
        <comment>R package version 1.0.16</comment>
      </element-citation>
    </ref>
    <ref id="bib5">
      <element-citation publication-type="book" id="sref5">
        <person-group person-group-type="author">
          <name>
            <surname>Davis</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <part-title>Optparse: Command Line Option Parser</part-title>
        <year>2018</year>
        <comment>R Package version 1.6. 0</comment>
      </element-citation>
    </ref>
    <ref id="bib6">
      <element-citation publication-type="journal" id="sref6">
        <person-group person-group-type="author">
          <name>
            <surname>Haas</surname>
            <given-names>B.J.</given-names>
          </name>
          <name>
            <surname>Dobin</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Stransky</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Pochet</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Accuracy assessment of fusion transcript detection via read-mapping and de novo fusion transcript assembly-based methods</article-title>
        <source>Genome Biol.</source>
        <volume>20</volume>
        <year>2019</year>
        <fpage>213</fpage>
        <pub-id pub-id-type="pmid">31639029</pub-id>
      </element-citation>
    </ref>
    <ref id="bib7">
      <element-citation publication-type="journal" id="sref7">
        <person-group person-group-type="author">
          <name>
            <surname>Jia</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Qiu</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Q.</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Nickerson</surname>
            <given-names>M.L.</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SOAPfuse: an algorithm for identifying fusion transcripts from paired-end RNA-Seq data</article-title>
        <source>Genome Biol.</source>
        <volume>14</volume>
        <year>2013</year>
        <fpage>R12</fpage>
        <pub-id pub-id-type="pmid">23409703</pub-id>
      </element-citation>
    </ref>
    <ref id="bib8">
      <element-citation publication-type="book" id="sref8">
        <person-group person-group-type="author">
          <name>
            <surname>Kassambara</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <part-title>ggpubr: 'ggplot2' Based Publication Ready Plots</part-title>
        <year>2018</year>
        <comment>R package version 0.1.7</comment>
      </element-citation>
    </ref>
    <ref id="bib9">
      <element-citation publication-type="journal" id="sref9">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Jang</surname>
            <given-names>Y.E.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>FusionScan: accurate prediction of fusion genes from RNA-Seq data</article-title>
        <source>Genomics Inform.</source>
        <volume>17</volume>
        <year>2019</year>
        <fpage>e26</fpage>
        <pub-id pub-id-type="pmid">31610622</pub-id>
      </element-citation>
    </ref>
    <ref id="bib10">
      <element-citation publication-type="journal" id="sref10">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Jung</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X.</given-names>
          </name>
        </person-group>
        <article-title>FusionGDB 2.0: fusion gene annotation updates aided by deep learning</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>50</volume>
        <year>2021</year>
        <fpage>D1221</fpage>
        <lpage>D1230</lpage>
      </element-citation>
    </ref>
    <ref id="bib11">
      <element-citation publication-type="journal" id="sref11">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X.</given-names>
          </name>
        </person-group>
        <article-title>FusionAI: predicting fusion breakpoint from DNA sequence with deep learning</article-title>
        <source>iScience</source>
        <volume>24</volume>
        <year>2021</year>
        <fpage>103164</fpage>
        <pub-id pub-id-type="pmid">34646994</pub-id>
      </element-citation>
    </ref>
    <ref id="bib12">
      <element-citation publication-type="journal" id="sref12">
        <person-group person-group-type="author">
          <name>
            <surname>McPherson</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Hormozdiari</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Zayed</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Giuliany</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Ha</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>M.G.</given-names>
          </name>
          <name>
            <surname>Griffith</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Heravi Moussavi</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Senz</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Melnyk</surname>
            <given-names>N.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>deFuse: an algorithm for gene fusion discovery in tumor RNA-Seq data</article-title>
        <source>PLoS Comput. Biol.</source>
        <volume>7</volume>
        <year>2011</year>
        <fpage>e1001138</fpage>
        <pub-id pub-id-type="pmid">21625565</pub-id>
      </element-citation>
    </ref>
    <ref id="bib13">
      <element-citation publication-type="book" id="sref13">
        <person-group person-group-type="author">
          <name>
            <surname>Microsoft</surname>
          </name>
          <name>
            <surname>Weston</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <part-title>Foreach: Provides Foreach Looping Construct</part-title>
        <year>2020</year>
        <comment>R package version 1.5.1</comment>
      </element-citation>
    </ref>
    <ref id="bib14">
      <element-citation publication-type="journal" id="sref14">
        <person-group person-group-type="author">
          <name>
            <surname>Patwardhan</surname>
            <given-names>M.N.</given-names>
          </name>
          <name>
            <surname>Wenger</surname>
            <given-names>C.D.</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>E.S.</given-names>
          </name>
          <name>
            <surname>Phanstiel</surname>
            <given-names>D.H.</given-names>
          </name>
        </person-group>
        <article-title>Bedtoolsr: an R package for genomic data analysis and manipulation</article-title>
        <source>J. Open Source Softw.</source>
        <volume>4</volume>
        <year>2019</year>
        <fpage>1742</fpage>
        <pub-id pub-id-type="pmid">31903447</pub-id>
      </element-citation>
    </ref>
    <ref id="bib15">
      <element-citation publication-type="journal" id="sref15">
        <person-group person-group-type="author">
          <name>
            <surname>Quinlan</surname>
            <given-names>A.R.</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>I.M.</given-names>
          </name>
        </person-group>
        <article-title>BEDTools: a flexible suite of utilities for comparing genomic features</article-title>
        <source>Bioinformatics</source>
        <volume>26</volume>
        <year>2010</year>
        <fpage>841</fpage>
        <lpage>842</lpage>
        <pub-id pub-id-type="pmid">20110278</pub-id>
      </element-citation>
    </ref>
    <ref id="bib16">
      <element-citation publication-type="book" id="sref16">
        <person-group person-group-type="author">
          <name>
            <surname>Team</surname>
            <given-names>R.C.</given-names>
          </name>
        </person-group>
        <part-title>R: A Language and Environment for Statistical Computing</part-title>
        <year>2019</year>
        <publisher-name>R Foundation for Statistical Computing</publisher-name>
      </element-citation>
    </ref>
    <ref id="bib17">
      <element-citation publication-type="journal" id="sref17">
        <person-group person-group-type="author">
          <name>
            <surname>Uhrig</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Ellermann</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Walther</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Burkhardt</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Frohlich</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Hutter</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Toprak</surname>
            <given-names>U.H.</given-names>
          </name>
          <name>
            <surname>Neumann</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Stenzinger</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Scholl</surname>
            <given-names>C.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accurate and efficient detection of gene fusions from RNA sequencing data</article-title>
        <source>Genome Res.</source>
        <volume>31</volume>
        <year>2021</year>
        <fpage>448</fpage>
        <lpage>460</lpage>
        <pub-id pub-id-type="pmid">33441414</pub-id>
      </element-citation>
    </ref>
    <ref id="bib18">
      <element-citation publication-type="book" id="sref18">
        <person-group person-group-type="author">
          <name>
            <surname>Wickham</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Hester</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>W.</given-names>
          </name>
        </person-group>
        <part-title>Devtools: Tools to Make Developing R Packages Easier</part-title>
        <year>2018</year>
        <comment>R package version 1.1.3.6</comment>
      </element-citation>
    </ref>
    <ref id="bib19">
      <element-citation publication-type="book" id="sref19">
        <person-group person-group-type="author">
          <name>
            <surname>Wickham</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Seidel</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <part-title>Scales: Scale Functions for Visualization</part-title>
        <year>2020</year>
        <comment>R Package version 1.1.1</comment>
      </element-citation>
    </ref>
    <ref id="bib20">
      <element-citation publication-type="book" id="sref20">
        <person-group person-group-type="author">
          <name>
            <surname>Wickham</surname>
            <given-names>H.</given-names>
          </name>
        </person-group>
        <part-title>ggplot2: Elegant Graphics for Data Analysis</part-title>
        <year>2016</year>
        <publisher-name>Springer-Verlag</publisher-name>
      </element-citation>
    </ref>
    <ref id="bib21">
      <element-citation publication-type="book" id="sref21">
        <person-group person-group-type="author">
          <name>
            <surname>Wilke</surname>
            <given-names>C.O.</given-names>
          </name>
        </person-group>
        <part-title>Cowplot: Streamlined Plot Theme and Plot Annotations for 'ggplot2'</part-title>
        <year>2020</year>
        <comment>R Package version 1.1.1</comment>
      </element-citation>
    </ref>
  </ref-list>
  <sec sec-type="data-availability" id="da0010">
    <title>Data and code availability</title>
    <p id="p0030">Code is available at <ext-link ext-link-type="uri" xlink:href="https://compbio.uth.edu/FusionGDB2/FusionAI/" id="intref0020">https://compbio.uth.edu/FusionGDB2/FusionAI/</ext-link>.</p>
  </sec>
  <ack id="ack0010">
    <title>Acknowledgments</title>
    <p id="p0330">This work was partially supported by the <funding-source id="gs1"><institution-wrap><institution-id institution-id-type="doi">10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source> grants (R35GM138184) to P.K. The funders had no role in study design, data collection, analysis, decision to publish, or preparation of the manuscript. Funding for open access charge: Startup Fund to P.K. from the <funding-source id="gs2"><institution-wrap><institution-id institution-id-type="doi">10.13039/100012615</institution-id><institution>University of Texas Health Science Center at Houston</institution></institution-wrap></funding-source>.</p>
    <sec id="sec10">
      <title>Author contributions</title>
      <p id="p0335">Model data preparation, P.K.; model development, H.T. and P.K.; genomic feature data preparation, P.K. and J.L.; visualization of genomic features, P.K. and J.L.; test, H.K.; manuscript writing, P.K.; figures, P.K.; supervision, P.K. and X.Z.</p>
    </sec>
    <sec sec-type="COI-statement" id="sec11">
      <title>Declaration of interests</title>
      <p id="p0340">The authors declare no competing interests.</p>
    </sec>
  </ack>
</back>
