<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8545297</article-id>
    <article-id pub-id-type="pmid">33826687</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab231</article-id>
    <article-id pub-id-type="publisher-id">btab231</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Systems Biology</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>mzRAPP: a tool for reliability assessment of data pre-processing in non-targeted metabolomics</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4392-7706</contrib-id>
        <name>
          <surname>El Abiead</surname>
          <given-names>Yasin</given-names>
        </name>
        <xref rid="btab231-cor1" ref-type="corresp"/>
        <aff><institution>Department of Analytical Chemistry, University of Vienna</institution>, Vienna 1090, <country country="AT">Austria</country></aff>
        <!--yasin.el.abiead@univie.ac.at-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Milford</surname>
          <given-names>Maximilian</given-names>
        </name>
        <aff><institution>Department of Analytical Chemistry, University of Vienna</institution>, Vienna 1090, <country country="AT">Austria</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Salek</surname>
          <given-names>Reza M</given-names>
        </name>
        <aff><institution>International Agency for Research on Cancer, Section of Nutrition and Metabolism</institution>, Lyon 69008, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Koellensperger</surname>
          <given-names>Gunda</given-names>
        </name>
        <xref rid="btab231-cor1" ref-type="corresp"/>
        <aff><institution>Department of Analytical Chemistry, University of Vienna</institution>, Vienna 1090, <country country="AT">Austria</country></aff>
        <!--gunda.koellensperger@univie.ac.at-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Martelli</surname>
          <given-names>Pier Luigi</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btab231-cor1">To whom correspondence should be addressed. <email>yasin.el.abiead@univie.ac.at</email> or <email>gunda.koellensperger@univie.ac.at</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>15</day>
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-04-07">
      <day>07</day>
      <month>4</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>07</day>
      <month>4</month>
      <year>2021</year>
    </pub-date>
    <volume>37</volume>
    <issue>20</issue>
    <fpage>3678</fpage>
    <lpage>3680</lpage>
    <history>
      <date date-type="received">
        <day>09</day>
        <month>11</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>31</day>
        <month>3</month>
        <year>2021</year>
      </date>
      <date date-type="editorial-decision">
        <day>02</day>
        <month>4</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>06</day>
        <month>4</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab231.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Reliability assessment of automated pre-processing of liquid chromatography-high resolution mass spectrometry data presents a significant challenge. Here, we present a tool named mzRAPP, which generates and validates a benchmark from user-supplied information and later utilizes it for reliability assessment of data pre-processing. As a result, mzRAPP produces several performance metrics for different steps of the pre-processing workflow, supporting five of the most commonly used pre-processing tools.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>mzRAPP is implemented in R and can be downloaded from GitHub under GNU GPL v.3.0 licence. Extensive documentation, background and examples are available at (<ext-link xlink:href="https://github.com/YasinEl/mzRAPP" ext-link-type="uri">https://github.com/YasinEl/mzRAPP</ext-link>).</p>
      </sec>
      <sec id="s4">
        <title>
          <xref rid="sup1" ref-type="supplementary-material">Supplementary information</xref>
        </title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>MetClassNet</institution>
          </institution-wrap>
        </funding-source>
        <award-id>ANR-19-CE45-0021</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>To date, several different software solutions for data pre-processing have been proposed, and new ones are published continuously. However, reproducibility, comparability and reliability of results generated via such algorithms remain challenging and difficult to assess or compare. Difficulties in the evaluation are primarily due to complex parameter options used for pre-processing within various tools and the complexity of the analysis, which can potentially affect and vary the outcome (<xref rid="btab231-B4" ref-type="bibr">Li <italic toggle="yes">et al.</italic>, 2018</xref>). In metabolomics and particularly for non-targeted metabolomics, there are no ‘gold standard’ experimental datasets or a trusted set of methods to evaluate parameter choices and tools [e.g. Sanger sequencing for genomics (<xref rid="btab231-B9" ref-type="bibr">Sanger <italic toggle="yes">et al.</italic>, 1977</xref>)]. Moreover, differences in instrumentation, acquisition strategies or sample complexity might not draw a general conclusion from a potential gold standard dataset. While there are software packages for automatized non-targeted data pre-processing (NPP) parameter optimization and adaption [e.g. IPO (<xref rid="btab231-B5" ref-type="bibr">Libiseller et al., 2015</xref>), Autotuner (<xref rid="btab231-B7" ref-type="bibr">McLean <italic toggle="yes">et al.</italic>, 2020</xref>)], they are not meant to assess the general quality of NPP results (More details in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> S1). Hence there is a need for a strategy to assess the reliability of non-targeted data pre-processing (NPP) for LC-HRMS data on a routine case by case basis. This led us to develop the R package mzRAPP (Reliability Assessment for NPP), which enabled the extraction of well-defined NPP performance metrics from existing experimental datasets, by generating a benchmark (BM) subset to evaluate NPP-results (<xref rid="btab231-F1" ref-type="fig">Fig. 1</xref>). For benchmarking, mzRAPP relies on user-provided input, specific to the experimental chromatographic setup [approximated retention time (RT) boundaries for a subset of compounds with known molecular formulas] for the generation of a BM. This BM is then used as a reference point for deriving performance metrics for NPP conducted on the same raw data. The reliability of NPP performance metrics is ensured by considering a wide range of orthogonal information. Broad applicability in the interdisciplinary field of metabolomics is enabled via graphical user interface (GUI) and support of more than five high cited NPP tools.</p>
    <fig position="float" id="btab231-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Overview of the mzRAPP workflow. (<bold>a</bold>) The mzML files are analyzed and inspected via non-targeted data pre-processing (e.g. via XCMS, MZmine 2, MS-DIAL) and then used to generate and validate a BM using known IT ratios. The generated BM is then utilized to assess the performance of NPP peak picking, peak alignment and feature processing across NPP methods. Subsequently, different performance metrics can be derived as a result. (<bold>b</bold>) The mzRAPP output graphics include different sunburst quality evaluation plots. From left to right, sunburst plots describe the peak detection (true positive/false negative peaks) and abundance (IT ratio bias) quality before (inner donut) and after alignment (outer donut). The right sunburst plot visualizes errors that occurred during the alignment step. More details are provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> S2</p>
      </caption>
      <graphic xlink:href="btab231f1" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>2 Implementation and methods</title>
    <p>The mzRAPP-package has been developed with the R environment (version 4.0.3) and implemented as a shiny app for ease of use. It can be navigated in a two-step procedure, resulting in ten different NPP performance metrics. The first step is a module responsible for confirming the consistency of user-provided information (RT boundaries for different molecular formulas) with information extracted from the raw data in order to generate a sub-dataset-specific BM. This is achieved by comparing the enviPat-predicted isotopologue (IT) ratios (<xref rid="btab231-B6" ref-type="bibr">Loos <italic toggle="yes">et al.</italic>, 2015</xref>) to those extracted from mzML files using user-supplied boundaries (see GitHub for details). Next, the BM is used as a reference point leading to the generation of several NPP-performance metrics for the evaluation of chromatographic peak picking and alignment as well as the aligned features, respectively. The output metrics include measurements to judge the proportion of missed peaks, quality of reported peak abundances, nature of missed peaks and alignment error counts. Interactive plots providing an overview and context to all metrics can be inspected interactively within the shiny app. As a result, several different NPP algorithms across tools with different parameter choices, can be evaluated for an optimal outcome. Below are the main theme and underlying methods developed for the mzRAPP package and the description of important key functionalities.</p>
    <sec>
      <title>2.1 Main theme</title>
      <p>The BM construction relied on the integration of key functions from enviPat (the IT pattern prediction from molecular formulas), XCMS (<xref rid="btab231-B10" ref-type="bibr">Tautenhahn <italic toggle="yes">et al.</italic>, 2008</xref>), MSnbase (<xref rid="btab231-B3" ref-type="bibr">Gatto and Lilley, 2012</xref>) (efficient extraction and structuring of raw data) and MetaClean (<xref rid="btab231-B2" ref-type="bibr">Chetnik <italic toggle="yes">et al.</italic>, 2020</xref>) (extraction of different peak variables). Data table operations were conducted via functionalities from the data.table package. Parallel processing capability has been implemented in mzRAPP via future package (<xref rid="btab231-B1" ref-type="bibr">Bengtsson, 2020</xref>). GUI and plots are adopted via shiny and ggplot2/plotly, respectively.</p>
    </sec>
    <sec>
      <title>2.2 Key functions</title>
      <sec>
        <title>2.2.1 BM generation</title>
        <p>BM generation was facilitated via a cascade of three functions performing IT pattern prediction (<italic toggle="yes">get_mz_table</italic>), extraction of chromatogram information (<italic toggle="yes">get_ROIs</italic>) and ultimately peak extraction, consistency checks and filtering (<italic toggle="yes">find_bench_peaks</italic>). Each function returns a <italic toggle="yes">data.table</italic> object serving as argument for the subsequent proceeding functions. In doing so mzRAPP relies on functionalities from enviPat, XCMS (<italic toggle="yes">xcmsRaw</italic> and <italic toggle="yes">findmzROI</italic>) and MSnbase (<italic toggle="yes">readMSData</italic> and <italic toggle="yes">chromatogram</italic>) architectures. The generated BM can then be used for NPP reliability assessment as described below. More details are provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> S2.</p>
      </sec>
      <sec>
        <title>2.2.2 Assessing NPP reliability</title>
        <p>Since the BM can be edited by the user its data structure is checked via <italic toggle="yes">check_benchmark_input</italic> before being used for NPP assessment. The mzRAPP-package supports output formats from the five most common NPP tools, such as XCMS, MS-DIAL (<xref rid="btab231-B11" ref-type="bibr">Tsugawa <italic toggle="yes">et al.</italic>, 2015</xref>) and MZmine 2 (<xref rid="btab231-B8" ref-type="bibr">Pluskal <italic toggle="yes">et al.</italic>, 2010</xref>). The <italic toggle="yes">check_nonTargeted_input</italic> function checks the presence of all components necessary for subsequent matching procedures and generates a generic format output for downstream processing. Next mzRAPPs <italic toggle="yes">compare_peaks</italic> function performs a series of non-equivalent joins between the BM and supplied NPP output tables. The result is returned as a <italic toggle="yes">list</italic> object which serves as input for different downstream analysis and plotting functions [e.g. <italic toggle="yes">derive_performance_metrics</italic> (details are provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> S2) and <italic toggle="yes">plot_sunburst_peakQuality</italic>]. Elements of the list are themed around conducted joins or classifications, details of which can be viewed using function-help. Output metrics include measurements to judge the proportion of missed peaks, quality of peak abundances, nature of missed peaks and the alignment error counts. Empirical confidence intervals (alpha = 0.95) for all metrics are estimated by bootstrapping (as employed in the boot package) for the supplied molecules.</p>
      </sec>
      <sec>
        <title>2.2.3 Graphical user interface</title>
        <p>A comprehensive GUI was developed to help metabolomics scientists with different computational skill sets access mzRAPP software solutions for NPP evaluation. The <italic toggle="yes">callmzRAPP</italic> function allows users to generate BMs and assess NPP without requiring any command-line functions.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btab231_Supplementary_Data</label>
      <media xlink:href="btab231_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgement</title>
    <p>The authors would like to acknowledge Johannes Rainer for his advice.</p>
    <sec>
      <title>Funding</title>
      <p>R.S. would like to acknowledge support from ANR-19-CE45-0021 (MetClassNet) grant.</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: The authors declare no conflict of interest. Where authors are identified as personnel of the International Agency for Research on Cancer/World Health Organization, the authors alone are responsible for the views expressed in this article, and they do not necessarily represent the decisions, policy or views of the International Agency for Research on Cancer/World Health Organization.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btab231-B1">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Bengtsson</surname><given-names>H.</given-names></string-name></person-group> (<year>2020</year>) <italic toggle="yes">Unified Parallel and Distributed Processing in R for Everyone [R package future version 1.19.1]</italic>.</mixed-citation>
    </ref>
    <ref id="btab231-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chetnik</surname><given-names>K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>MetaClean: a machine learning-based classifier for reduced false positive peak detection in untargeted LC–MS metabolomics data</article-title>. <source>Metabolomics</source>, <volume>16</volume>, <fpage>117</fpage>.<pub-id pub-id-type="pmid">33085002</pub-id></mixed-citation>
    </ref>
    <ref id="btab231-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gatto</surname><given-names>L.</given-names></string-name>, <string-name><surname>Lilley</surname><given-names>K.S.</given-names></string-name></person-group> (<year>2012</year>) <article-title>Msnbase—an R/Bioconductor package for isobaric tagged mass spectrometry data visualization, processing and quantitation</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>288</fpage>–<lpage>289</lpage>.<pub-id pub-id-type="pmid">22113085</pub-id></mixed-citation>
    </ref>
    <ref id="btab231-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>Z.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Comprehensive evaluation of untargeted metabolomics data processing software in feature detection, quantification and discriminating marker selection</article-title>. <source>Anal. Chim. Acta</source>, <volume>1029</volume>, <fpage>50</fpage>–<lpage>57</lpage>.<pub-id pub-id-type="pmid">29907290</pub-id></mixed-citation>
    </ref>
    <ref id="btab231-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Libiseller</surname><given-names>G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>IPO: a tool for automated optimization of XCMS parameters</article-title>. <source>BMC Bioinformatics</source>, <volume>16</volume>, <fpage>118</fpage>.<pub-id pub-id-type="pmid">25888443</pub-id></mixed-citation>
    </ref>
    <ref id="btab231-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Loos</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Accelerated isotope fine structure calculation using pruned transition trees</article-title>. <source>Anal. Chem</source>., <volume>87</volume>, <fpage>5738</fpage>–<lpage>5744</lpage>.<pub-id pub-id-type="pmid">25929282</pub-id></mixed-citation>
    </ref>
    <ref id="btab231-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McLean</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>AutoTuner: high fidelity and robust parameter selection for metabolomics data processing</article-title>. <source>Anal. Chem</source>., <volume>92</volume>, <fpage>5724</fpage>–<lpage>5732</lpage>.<pub-id pub-id-type="pmid">32212641</pub-id></mixed-citation>
    </ref>
    <ref id="btab231-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pluskal</surname><given-names>T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) <article-title>MZmine 2: modular framework for processing, visualizing, and analyzing mass spectrometry-based molecular profile data</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>, <fpage>395</fpage>.<pub-id pub-id-type="pmid">20650010</pub-id></mixed-citation>
    </ref>
    <ref id="btab231-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sanger</surname><given-names>F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>1977</year>) <article-title>DNA sequencing with chain-terminating inhibitors</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>74</volume>, <fpage>5463</fpage>–<lpage>5467</lpage>.<pub-id pub-id-type="pmid">271968</pub-id></mixed-citation>
    </ref>
    <ref id="btab231-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tautenhahn</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2008</year>) <article-title>Highly sensitive feature detection for high resolution LC/MS</article-title>. <source>BMC Bioinformatics</source>, <volume>9</volume>, <fpage>504</fpage>.<pub-id pub-id-type="pmid">19040729</pub-id></mixed-citation>
    </ref>
    <ref id="btab231-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tsugawa</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>MS-DIAL: data-independent MS/MS deconvolution for comprehensive metabolome analysis</article-title>. <source>Nat. Methods</source>, <volume>12</volume>, <fpage>523</fpage>–<lpage>526</lpage>.<pub-id pub-id-type="pmid">25938372</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
