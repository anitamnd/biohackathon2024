<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8201703</article-id>
    <article-id pub-id-type="publisher-id">4221</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-021-04221-5</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Increased peak detection accuracy in over-dispersed ChIP-seq data with supervised segmentation models</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Liehrmann</surname>
          <given-names>Arnaud</given-names>
        </name>
        <address>
          <email>arnaud.liehrmann@universite-paris-saclay.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rigaill</surname>
          <given-names>Guillem</given-names>
        </name>
        <address>
          <email>guillem.rigaill@inrae.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hocking</surname>
          <given-names>Toby Dylan</given-names>
        </name>
        <address>
          <email>Toby.Hocking@nau.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label>Institut des Sciences des Plantes de Paris-Saclay (IPS2), Université Paris-Saclay, Université Evry, CNRS, INRAE, 91405 Orsay, France </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.4444.0</institution-id><institution-id institution-id-type="ISNI">0000 0001 2112 9282</institution-id><institution>Laboratoire de Mathématiques et Modélisation d’Evry (LAMME), </institution><institution>Université Paris-Saclay, Université Evry, CNRS, </institution></institution-wrap>91037 Evry, France </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.261120.6</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8040</institution-id><institution>School of Informatics, Computing, and Cyber Systems (SICCS), </institution><institution>Northern Arizona University, </institution></institution-wrap>86011 Flagstaff, AZ USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>6</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>6</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>323</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>1</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>5</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Histone modification constitutes a basic mechanism for the genetic regulation of gene expression. In early 2000s, a powerful technique has emerged that couples chromatin immunoprecipitation with high-throughput sequencing (ChIP-seq). This technique provides a direct survey of the DNA regions associated to these modifications. In order to realize the full potential of this technique, increasingly sophisticated statistical algorithms have been developed or adapted to analyze the massive amount of data it generates. Many of these algorithms were built around natural assumptions such as the Poisson distribution to model the noise in the count data. In this work we start from these natural assumptions and show that it is possible to improve upon them.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Our comparisons on seven reference datasets of histone modifications (H3K36me3 &amp; H3K4me3) suggest that natural assumptions are not always realistic under application conditions. We show that the unconstrained multiple changepoint detection model with alternative noise assumptions and supervised learning of the penalty parameter reduces the over-dispersion exhibited by count data. These models, implemented in the R package <italic>CROCS</italic> (<ext-link ext-link-type="uri" xlink:href="https://github.com/aLiehrmann/CROCS">https://github.com/aLiehrmann/CROCS</ext-link>), detect the peaks more accurately than algorithms which rely on natural assumptions.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">The segmentation models we propose can benefit researchers in the field of epigenetics by providing new high-quality peak prediction tracks for H3K36me3 and H3K4me3 histone modifications.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-021-04221-5.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>ChIP-seq</kwd>
      <kwd>Histone modifications</kwd>
      <kwd>Over-dispersion</kwd>
      <kwd>Peak calling</kwd>
      <kwd>Multiple changepoint detection</kwd>
      <kwd>Likelihood inference</kwd>
      <kwd>Supervised learning</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par8">Chromatin immunoprecipitation followed by high-throughput sequencing (ChIP-seq) is amongst the most widely used methods in molecular biology [<xref ref-type="bibr" rid="CR15">15</xref>]. This method aims to identify transcription factor binding sites [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR22">22</xref>] or post-translational histone modifications [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR25">25</xref>], referred to as histone marks, underlying regulatory elements. Consequently, this method is essential to deepen our understanding of transcriptional regulation. The ChIP-seq assay yields a set of DNA sequence reads which are aligned to a reference genome and then counted at each genomic position. This results in a series <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y = (y_1,\dots ,y_n)$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq1.gif"/></alternatives></inline-formula> of <italic>n</italic> non-negative integer count data <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(y_i \in {\mathbb {Z}}_+)$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq2.gif"/></alternatives></inline-formula>, hereafter called coverage profile, ordered along a chromosome. The binding sites or histone marks of interest appear as regions with high read density referred to as peaks in the coverage profile.</p>
    <p id="Par9">Since there is a biological interest in detecting these peaks, several methods, hereafter called peak callers (<italic>c</italic>), have been developed / adapted and used to filter out background noise and accurately identify the peak locations in the coverage profile. They take a coverage profile of length <italic>n</italic> and classify each base from it as a part of the background noise (0) or peak (1), i.e. <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c:Y\rightarrow \{0,1\}^n$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi>c</mml:mi><mml:mo>:</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq3.gif"/></alternatives></inline-formula>. Among these peak callers we can mention MACS [<xref ref-type="bibr" rid="CR26">26</xref>] and HMCan [<xref ref-type="bibr" rid="CR2">2</xref>], two heuristics which are computationally fast but typically accurate only for a specific pattern, i.e. respectively sharp and broad peaks [<xref ref-type="bibr" rid="CR7">7</xref>]. More recently, it has been proposed to solve the peak detection problem using either optimal constrained or unconstrained multiple changepoint detection methods [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. The constraints ensure that the segmentation model can be interpreted in terms of peaks and background noise which is a practitioner’s request. The unconstrained one doesn’t have an output segmentation with a straightforward interpretation in terms of peaks and needs to be followed by an ad-hoc post-processing rule to infer the start and end of peaks (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>). For each of these methods, there are one or more tuning parameters that need to be set before solving the peak detection problem and that may affect the results accuracy.</p>
    <p id="Par10">In a supervised learning approach, Hocking et al. [<xref ref-type="bibr" rid="CR7">7</xref>] introduced seven labeled histone mark datasets that are composed of samples from two different ChIP-seq experiments directed at histone modifications H3K36me3 and H3K36me3. In a recent study, after training different peak callers using these datasets, Hocking et al. [<xref ref-type="bibr" rid="CR12">12</xref>] compared them and showed that the constrained segmentation model with count data following a Poisson distribution outperforms standard bioinformatics heuristics and the unconstrained segmentation model on these datasets.</p>
    <sec id="Sec2">
      <title>Modeling question</title>
      <p id="Par11">From a modeling perspective the constrained segmentation model and the Poisson noise are certainly the most natural assumptions to detect peaks in coverage profiles. However, it is not clear that they are realistic:<list list-type="bullet"><list-item><p id="Par12">By looking at the shapes of the peaks in coverage profiles (see for instance in Fig. <xref rid="Fig1" ref-type="fig">1</xref>), we can see that the background noise and the top of the peaks are sometimes separated by one or more subtle changes. In contrast to the constrained segmentation model, the unconstrained one should be able to capture these subtle changes. One major issue is that the output segmentation of the unconstrained model does not have a straightforward interpretation in terms of peaks.</p></list-item><list-item><p id="Par13">Parametric models such as the negative binomial [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR17">17</xref>] or the Gaussian, following a proper transformation of the count data for the latter [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR13">13</xref>], are preferred over the Poisson one for the analysis of many high-througput sequencing datasets. Indeed, count data often exhibit more variability than the Poisson model expects which changes the interpretation of the model and makes it difficult to estimate its parameters. These alternative parametric models are well known to reduce this phenomenon, also called over-dispersion.</p></list-item></list>In this work we try to start from these natural assumptions and show that it is possible to improve upon them.</p>
    </sec>
    <sec id="Sec3">
      <title>Contribution</title>
      <p id="Par14">
        <list list-type="order">
          <list-item>
            <p id="Par15">We show that the distribution of counts from H3K36me3 and H3K4me3 datasets exhibits over-dispersion which invalidates the Poisson assumption. The two alternative noise models we propose (negative binomial with constant dispersion parameter &amp; Gaussian after Anscombe transformation) effectively reduce the over-dispersion on these datasets (see Fig. <xref rid="Fig4" ref-type="fig">4</xref>).</p>
          </list-item>
          <list-item>
            <p id="Par16">We propose a new and rather natural post-processing rule to predict the start and end of peaks in an estimated unconstrained segmentation (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Indeed, in the unconstrained segmentation we can observe several up (respectively down) changes and it is not obvious which one should be considered as the start or end of the peak. We show that this new post-processing rule improves the accuracy of the unconstrained segmentation model in both H3K36me3 and H3K4me3 datasets compared to the same model with previous rules described by Hocking et al. [<xref ref-type="bibr" rid="CR12">12</xref>] (see Fig. <xref rid="Fig5" ref-type="fig">5</xref>).</p>
          </list-item>
          <list-item>
            <p id="Par17">Hocking et al. [<xref ref-type="bibr" rid="CR11">11</xref>] described a procedure to extract all optimal constrained segmentations for a range of peaks. It is an essential internal step in the supervised approach for learning the penalty parameter of segmentation models. In this work we generalize this procedure so that it works with the unconstrained segmentation model and the post-processing rule mentioned in the previous point (see Algorithm 1).</p>
          </list-item>
          <list-item>
            <p id="Par18">We describe a method to learn jointly both the penalty and dispersion parameters of segmentation models with a negative binomial noise. We then compare the accuracy of unconstrained and contrained segmention models with different noise distributions on the labeled H3K36me3 and H3K4me3 datasets (see Fig. <xref rid="Fig6" ref-type="fig">6</xref>).</p>
          </list-item>
        </list>
      </p>
    </sec>
  </sec>
  <sec id="Sec4">
    <title>Methods</title>
    <sec id="Sec5">
      <title>Segmentation models for ChIP-seq data</title>
      <p id="Par19">
        <fig id="Fig1">
          <label>Fig. 1</label>
          <caption>
            <p>Examples of ChIP-seq coverage profiles from the histone mark H3K36me3 and H3K4me3 datasets. (<bold>Top</bold>) In blue
<inline-graphic xlink:href="12859_2021_4221_Figa_HTML.gif" id="d32e574"/>
, a piecewise constant function affected by three unconstrained abrupt changes shown in red
<inline-graphic xlink:href="12859_2021_4221_Figb_HTML.gif" id="d32e577"/>
. (<bold>Bottom</bold>) In blue
<inline-graphic xlink:href="12859_2021_4221_Figa_HTML.gif" id="d32e583"/>
, a piecewise constant function affected by two constrained abrupt changes shown in red
<inline-graphic xlink:href="12859_2021_4221_Figb_HTML.gif" id="d32e587"/></p>
          </caption>
          <graphic xlink:href="12859_2021_4221_Fig1_HTML" id="MO5"/>
        </fig>
      </p>
      <sec id="Sec6">
        <title>Unconstrained segmentation model</title>
        <p id="Par20">The observed data <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(y_1,\dots ,y_n)$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq4.gif"/></alternatives></inline-formula> are supposed to be a realization of an independent random process <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(Y_1,\dots ,Y_n)$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq5.gif"/></alternatives></inline-formula>. This process is drawn from a probability distribution <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {F}}$$\end{document}</tex-math><mml:math id="M12"><mml:mi mathvariant="script">F</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq6.gif"/></alternatives></inline-formula> which depends on two parameters: <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta$$\end{document}</tex-math><mml:math id="M14"><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq7.gif"/></alternatives></inline-formula> is assumed to be affected by <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K-1$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi>K</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq8.gif"/></alternatives></inline-formula> abrupt changes called changepoints and <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi$$\end{document}</tex-math><mml:math id="M18"><mml:mi>ϕ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq9.gif"/></alternatives></inline-formula> is constant. We denote <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _k$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mi>τ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq10.gif"/></alternatives></inline-formula> the location of the <italic>k</italic>th changepoint with <inline-formula id="IEq12"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=\{1,\dots ,K-1\}$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq12.gif"/></alternatives></inline-formula>. By convention we introduce the fixed indices <inline-formula id="IEq13"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _0=0$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq13.gif"/></alternatives></inline-formula> and <inline-formula id="IEq14"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _K=n$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq14.gif"/></alternatives></inline-formula>. The <italic>k</italic>th segment is formed by the observations <inline-formula id="IEq16"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(y_{\tau _{k-1}+1} ,\dots , y_{\tau _k})$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq16.gif"/></alternatives></inline-formula>. <inline-formula id="IEq17"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta _k$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mi>θ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq17.gif"/></alternatives></inline-formula> stands for the parameter of the <italic>k</italic>th segment (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Formally the unconstrained segmentation model [<xref ref-type="bibr" rid="CR5">5</xref>], can be written as follows:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \forall i\;|\quad \tau _{k-1}+1 \le i \le \tau _{k},\quad Y_{i} \sim {\mathcal {F}}(\theta _k, \phi ). \end{aligned}$$\end{document}</tex-math><mml:math id="M32" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mspace width="0.277778em"/><mml:mo stretchy="false">|</mml:mo><mml:mspace width="1em"/></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">F</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4221_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec7">
        <title>Constrained segmentation model</title>
        <p id="Par21">In order to have a segmentation model with a straightforward interpretation in terms of peaks, we add inequality constraints to the successive segment specific parameters <inline-formula id="IEq19"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\theta _{1},\dots ,\theta _{K})$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq19.gif"/></alternatives></inline-formula> so that non-decreasing changes in these parameters are always followed by non-increasing changes. Therefore, we formally assume the following constrained segmentation model [<xref ref-type="bibr" rid="CR8">8</xref>], hereafter called Up–Down:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \forall i\; |\quad \tau _{k-1}+1 \le i \le \tau _{k},\quad Y_{i} \sim {\mathcal {F}}(\theta _k, \phi )\quad \nonumber \\ {\text {subject to}} {\left\{ \begin{array}{ll} \theta _{k-1} \le \theta _{k} \quad \forall k \in \{2,4,\dots \} \\ \theta _{k-1} \ge \theta _{k} \quad \forall k \in \{3,5,\dots \} \end{array}\right. }. \end{aligned}$$\end{document}</tex-math><mml:math id="M36" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mspace width="0.277778em"/><mml:mo stretchy="false">|</mml:mo><mml:mspace width="1em"/></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">F</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="1em"/></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mrow><mml:mtext>subject to</mml:mtext></mml:mrow><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mspace width="1em"/><mml:mo>∀</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mspace width="1em"/><mml:mo>∀</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4221_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec8">
        <title>Probability distributions</title>
        <p id="Par22">In the case of the Poisson distribution we have <inline-formula id="IEq20"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {F}}(\theta _k, \phi ) = {\text {Pois}}(\Lambda _k, \phi =\emptyset )$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mi mathvariant="script">F</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>Pois</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="normal">Λ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">∅</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq20.gif"/></alternatives></inline-formula> where <inline-formula id="IEq21"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Lambda _k$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mi mathvariant="normal">Λ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq21.gif"/></alternatives></inline-formula> stands for the mean and the variance of the <italic>k</italic>th segment. In the case of the Gaussian distribution we have <inline-formula id="IEq23"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {F}}(\theta _k, \phi ) = {\mathcal {N}}(\mu _k,\sigma ^2)$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mi mathvariant="script">F</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq23.gif"/></alternatives></inline-formula> where <inline-formula id="IEq24"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _k$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mi>μ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq24.gif"/></alternatives></inline-formula> is the mean of the <italic>k</italic>th segment and <inline-formula id="IEq26"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma ^2$$\end{document}</tex-math><mml:math id="M46"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq26.gif"/></alternatives></inline-formula> is the variance assumed constant across the segments. Also in this case, the non-negative integer count data have been transformed in real values <inline-formula id="IEq27"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({\mathbb {Z}}_+ \rightarrow {\mathbb {R}}_+)$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi mathvariant="double-struck">R</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq27.gif"/></alternatives></inline-formula> through an Anscombe transformation <inline-formula id="IEq28"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\sqrt{Y+\frac{3}{8}})$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msqrt><mml:mrow><mml:mi>Y</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mn>8</mml:mn></mml:mfrac></mml:mrow></mml:msqrt><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq28.gif"/></alternatives></inline-formula> which is a useful variance-stabilizing transformation for count data following a Poisson distribution [<xref ref-type="bibr" rid="CR1">1</xref>]. In the case of the negative binomial distribution we have <inline-formula id="IEq29"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {F}}(\theta _k, \phi ) = {\text {NB}}(\mu _k,\phi )$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mi mathvariant="script">F</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>NB</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq29.gif"/></alternatives></inline-formula> where <inline-formula id="IEq30"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _k$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mi>μ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq30.gif"/></alternatives></inline-formula> is the the mean of the <italic>k</italic>th segment and <inline-formula id="IEq32"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi$$\end{document}</tex-math><mml:math id="M56"><mml:mi>ϕ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq32.gif"/></alternatives></inline-formula> is the dispersion parameter that needs to be learned on the data. In this parametrization <inline-formula id="IEq33"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma ^2_k$$\end{document}</tex-math><mml:math id="M58"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq33.gif"/></alternatives></inline-formula>, the variance of the <italic>k</italic>th segment, is <inline-formula id="IEq35"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _k + \phi ^{-1}\mu _k^2$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq35.gif"/></alternatives></inline-formula>.</p>
      </sec>
      <sec id="Sec9">
        <title>Optimization problems</title>
        <p id="Par23">In both unconstrained and constrained optimal multiple changepoint detection problems, the goal is to estimate the changepoint locations <inline-formula id="IEq36"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\tau _1,\dots ,\tau _{K-1})$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq36.gif"/></alternatives></inline-formula> and the parameters <inline-formula id="IEq37"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\theta _1,\dots ,\theta _{K})$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq37.gif"/></alternatives></inline-formula> both resulting from the segmentation. Runge et al. [<xref ref-type="bibr" rid="CR19">19</xref>] introduced <italic>gfpop</italic> (Graph-Constrained Functional Pruning Optimal Partitioning), an algorithm that solves both problems using penalized maximum likelihood inference. It implements several loss functions including the Gaussian, Poisson and negative binomial that allowed us to compare different noise models for the count data. The number of changepoints in a coverage profile being unknown, <italic>gfpop</italic> takes a non-negative penalty <inline-formula id="IEq38"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda \in {\mathbb {R}}_+$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="double-struck">R</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq38.gif"/></alternatives></inline-formula> parameter that controls the complexity of the output segmentation. Larger penalty <inline-formula id="IEq39"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M68"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq39.gif"/></alternatives></inline-formula> values result in models with fewer changepoints. The extreme penalty values are <inline-formula id="IEq40"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda = 0$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq40.gif"/></alternatives></inline-formula> which yields <inline-formula id="IEq41"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n-1$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq41.gif"/></alternatives></inline-formula> changepoints, and <inline-formula id="IEq42"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda = \infty$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq42.gif"/></alternatives></inline-formula> which yields 0 changepoint. The time complexity of <italic>gfpop</italic> is empirically <inline-formula id="IEq43"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {O}}(Vn\log (n))$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mi>n</mml:mi><mml:mo>log</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq43.gif"/></alternatives></inline-formula>. Intuitively, <italic>V</italic> stands for the number states you will need to encode your priors about the form of the output segmentation, e.g. with the Up–Down model at each time the signal can be a part of the background noise (Down) or a peak (Up). Consequently, the empirical time complexity of <italic>gfpop</italic> with the Up–Down model is <inline-formula id="IEq44"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {O}}(2n\log (n))$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>log</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq44.gif"/></alternatives></inline-formula> while with the unconstrained model it is <inline-formula id="IEq45"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {O}}(n\log (n))$$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>log</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq45.gif"/></alternatives></inline-formula>.
</p>
      </sec>
    </sec>
    <sec id="Sec10">
      <title>Rules for inferring the start and end of peaks with the unconstrained segmentation model</title>
      <p id="Par24">
        <fig id="Fig2">
          <label>Fig. 2</label>
          <caption>
            <p>(<bold>Top</bold>) Segmentation of a coverage profile containing one peak using the unconstrained model. The location of the changepoints on the chromosome are shown by red dotted lines
<inline-graphic xlink:href="12859_2021_4221_Figb_HTML.gif" id="d32e1711"/>
. The mean of the segments are shown in blue
<inline-graphic xlink:href="12859_2021_4221_Figa_HTML.gif" id="d32e1714"/>
. According to this segmentation there are two alternative starts and two alternative ends of the peak, i.e. four alternative variants of the same peak formed by the regions: [Start1:End1], [Start1:End2], [Start2:End1] and [Start2:End2]. (<bold>Bottom</bold>) Three different rules are proposed to interpret the segmentation as peaks. <italic>Thinnest peak</italic>: the resulting peak is defined by the region [Start2:End1]. <italic>Largest peak</italic>: the resulting peak is defined by the region [Start1:End2]. <italic>Max jump</italic>: the resulting peak is defined by the region [Start1:End1]</p>
          </caption>
          <graphic xlink:href="12859_2021_4221_Fig2_HTML" id="MO10"/>
        </fig>
      </p>
      <p id="Par25">As mentioned before, one of the main motivation of the Up–Down model is that it can be interpreted in terms of peaks which is a practitioner’s request. In the case of the unconstrained model, the output segmentation may results in successive non-decreasing changes (<inline-formula id="IEq46"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text {Up}}^*$$\end{document}</tex-math><mml:math id="M82"><mml:msup><mml:mrow><mml:mtext>Up</mml:mtext></mml:mrow><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq46.gif"/></alternatives></inline-formula>), e.g. in Fig. <xref rid="Fig2" ref-type="fig">2</xref>: <inline-formula id="IEq47"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text {Up}}^*=\{{\text {Start1}}, {\text {Start2}}\}$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:msup><mml:mrow><mml:mtext>Up</mml:mtext></mml:mrow><mml:mo>∗</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mtext>Start1</mml:mtext><mml:mo>,</mml:mo><mml:mtext>Start2</mml:mtext><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq47.gif"/></alternatives></inline-formula>, and successive non-increasing changes (<inline-formula id="IEq48"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text {Dw}}^*$$\end{document}</tex-math><mml:math id="M86"><mml:msup><mml:mrow><mml:mtext>Dw</mml:mtext></mml:mrow><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq48.gif"/></alternatives></inline-formula>), e.g. in Fig. <xref rid="Fig2" ref-type="fig">2</xref>: <inline-formula id="IEq49"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text {Dw}}^*=\{{\text {End1}}, {\text {End2}}\}$$\end{document}</tex-math><mml:math id="M88"><mml:mrow><mml:msup><mml:mrow><mml:mtext>Dw</mml:mtext></mml:mrow><mml:mo>∗</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mtext>End1</mml:mtext><mml:mo>,</mml:mo><mml:mtext>End2</mml:mtext><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq49.gif"/></alternatives></inline-formula>, in the signal. Thus, it is necessary to specify a post-processing rule to select the start and end of peaks among the returned changepoints in respectively each <inline-formula id="IEq50"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text {Up}}^*$$\end{document}</tex-math><mml:math id="M90"><mml:msup><mml:mrow><mml:mtext>Up</mml:mtext></mml:mrow><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq50.gif"/></alternatives></inline-formula> and <inline-formula id="IEq51"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text {Dw}}^*$$\end{document}</tex-math><mml:math id="M92"><mml:msup><mml:mrow><mml:mtext>Dw</mml:mtext></mml:mrow><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq51.gif"/></alternatives></inline-formula>. This results in <inline-formula id="IEq52"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|{\text {Up}}^*| \times |{\text {Dw}}^*|$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mtext>Up</mml:mtext></mml:mrow><mml:mo>∗</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>×</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mtext>Dw</mml:mtext></mml:mrow><mml:mo>∗</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq52.gif"/></alternatives></inline-formula> alternatives of the same peak. <italic>Rules.</italic> We propose three different rules to select the start and end of peaks (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>):<list list-type="bullet"><list-item><p id="Par26"><italic>thinnest peak</italic>: we select the last up change in <inline-formula id="IEq53"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text {Up}}^*$$\end{document}</tex-math><mml:math id="M96"><mml:msup><mml:mrow><mml:mtext>Up</mml:mtext></mml:mrow><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq53.gif"/></alternatives></inline-formula> and the first down change in <inline-formula id="IEq54"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text {Dw}}^*$$\end{document}</tex-math><mml:math id="M98"><mml:msup><mml:mrow><mml:mtext>Dw</mml:mtext></mml:mrow><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq54.gif"/></alternatives></inline-formula> ;</p></list-item><list-item><p id="Par27"><italic>largest peak rule</italic>: we select the first up change in <inline-formula id="IEq55"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text {Up}}^*$$\end{document}</tex-math><mml:math id="M100"><mml:msup><mml:mrow><mml:mtext>Up</mml:mtext></mml:mrow><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq55.gif"/></alternatives></inline-formula> and the last down change in <inline-formula id="IEq56"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text {Dw}}^*$$\end{document}</tex-math><mml:math id="M102"><mml:msup><mml:mrow><mml:mtext>Dw</mml:mtext></mml:mrow><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq56.gif"/></alternatives></inline-formula> ;</p></list-item><list-item><p id="Par28"><italic>max jump</italic>: we select the up and down change with the largest mean-difference in <inline-formula id="IEq57"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text {Up}}^*$$\end{document}</tex-math><mml:math id="M104"><mml:msup><mml:mrow><mml:mtext>Up</mml:mtext></mml:mrow><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq57.gif"/></alternatives></inline-formula> and <inline-formula id="IEq58"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text {Dw}}^*$$\end{document}</tex-math><mml:math id="M106"><mml:msup><mml:mrow><mml:mtext>Dw</mml:mtext></mml:mrow><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq58.gif"/></alternatives></inline-formula>.</p></list-item></list>Hocking et al. [<xref ref-type="bibr" rid="CR12">12</xref>] introduced similar rules to the <italic>thinnest peak</italic> and <italic>largest peak</italic>.</p>
    </sec>
    <sec id="Sec11">
      <title>Labeled data for supervised learning peak detection</title>
      <sec id="Sec12">
        <title>Tuning parameters</title>
        <p id="Par29">For each peak callers there are one or more tuning parameters that need to be set before solving the peak detection problem and that may greatly affect the result accuracy. For segmentation methods this parameter is the penalty <inline-formula id="IEq59"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M108"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq59.gif"/></alternatives></inline-formula> which controls the number of peaks in the resulting segmentation, while for heuristics, such as MACS or HMCan, they use a threshold parameter whose value allows to only consider the top <italic>p</italic> peaks given their significance. Moreover, if we want to model the over-dipersion phenomenon observed in the count data using a negative binomial probability distribution, this is done at the cost of another parameter <inline-formula id="IEq60"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\phi )$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq60.gif"/></alternatives></inline-formula> that we need to set as well. Its value may also affect the number of peaks in the resulting segmentation. In theory, if the correct noise model was known, it would be possible to use statistical arguments to choose the parameter to use. However, in practice the correct noise model is complex and unknown. There are many factors that influence the signal and noise patterns in real ChIP-seq data, e.g. experimental protocols, sequencing machines, alignment software. These factors results in poor accuracy for the detection of peaks [<xref ref-type="bibr" rid="CR7">7</xref>]. Therefore, we will consider the supervised peak detection problem in which the value of tuning parameters can be learned using manually determined labels that indicate a presence or absence of peaks.<fig id="Fig3"><label>Fig. 3</label><caption><p>(<bold>Top</bold>) Example of a ChIP-seq coverage profile annotated by an expert biologist. The labels represented by colored rectangles indicate the absence
<inline-graphic xlink:href="12859_2021_4221_Figc_HTML.gif" id="d32e2053"/>
or presence of a peak, here characterized by its start
<inline-graphic xlink:href="12859_2021_4221_Figd_HTML.gif" id="d32e2056"/>
and its end
<inline-graphic xlink:href="12859_2021_4221_Figa_HTML.gif" id="d32e2059"/>
. (<bold>Bottom</bold>) The model with 1 peak in its output segmentation has an associated error of 2 (<inline-formula id="IEq61"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2\times$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq61.gif"/></alternatives></inline-formula> False Negative
<inline-graphic xlink:href="12859_2021_4221_Fige_HTML.gif" id="d32e2079"/>
). The model with 3 peaks has an associated error of 1 (<inline-formula id="IEq62"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\times$$\end{document}</tex-math><mml:math id="M114"><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq62.gif"/></alternatives></inline-formula> False Positive
<inline-graphic xlink:href="12859_2021_4221_Figb_HTML.gif" id="d32e2095"/>
). The model with 2 peaks is a good model for which all the labels optimized on this coverage profile are correct
<inline-graphic xlink:href="12859_2021_4221_Figf_HTML.gif" id="d32e2098"/></p></caption><graphic xlink:href="12859_2021_4221_Fig3_HTML" id="MO17"/></fig></p>
      </sec>
      <sec id="Sec13">
        <title>Benchmark datasets</title>
        <p id="Par30">Introduced by Hocking et al. [<xref ref-type="bibr" rid="CR7">7</xref>], these seven labeled histone mark datasets are composed of samples from two different ChIP-seq experiments directed at modifications found on the histone 3 N-terminal tails. The first experiment is directed at histone H3 lysine 4 tri-methylation (H3K4me3), a modification localized in promoters. The second one is directed at histone H3 lysine 36 tri-methylation (H3K36me3), a modification localized in transcribed regions. Both these modifications are involved in the regulation of gene expression [<xref ref-type="bibr" rid="CR21">21</xref>]. The histone modifications H3K4me3 and H3K36me3 are respectively characterized by sharp and broad peak patterns in coverage profiles. Expert biologists, with visual inspection, have annotated some regions by indicating the presence or absence of peaks. Then, they grouped the labels to form 2752 distinct labeled coverage profiles. Standard used for labeling by the expert biologists is described in Supplementary Text 1 of Hocking et al. [<xref ref-type="bibr" rid="CR10">10</xref>].</p>
      </sec>
      <sec id="Sec14">
        <title>Definition of labeled coverage profiles and errors</title>
        <p id="Par31">In the context of supervised peak detection each labeled coverage profile of size <italic>n</italic>, denoted <inline-formula id="IEq63"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w\in {\mathbb {Z}}_+^n$$\end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:mi>w</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq63.gif"/></alternatives></inline-formula>, is a problem. Formally we have a set of <italic>M</italic> problems <inline-formula id="IEq64"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(w_1,\dots ,w_M)$$\end{document}</tex-math><mml:math id="M118"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq64.gif"/></alternatives></inline-formula> where <inline-formula id="IEq65"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M=2752$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>2752</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq65.gif"/></alternatives></inline-formula>. Each problem <inline-formula id="IEq66"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_m$$\end{document}</tex-math><mml:math id="M122"><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq66.gif"/></alternatives></inline-formula> is associated with a set of <italic>N</italic> labels <inline-formula id="IEq67"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_m = \{(s_1,e_1, h_1)\, \dots , (s_{N},e_{N}, h_{N})\}$$\end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq67.gif"/></alternatives></inline-formula> where <italic>s</italic> is the start genomic location of the label, <italic>e</italic> is the end genomic location of the label and <italic>h</italic> is the type of the label. There are four types of labels that allow some flexibility in the annotation (see Fig. <xref rid="Fig3" ref-type="fig">3</xref>):<list list-type="bullet"><list-item><p id="Par32"><italic>noPeaks</italic> label stands for a region that contains only background noise with no peak. If any peak is predicted in this region, the label counts as a false positive ;</p></list-item><list-item><p id="Par33"><italic>peaks</italic> label means there is at least one overlapping peak in that region. Hence, one or more peaks in that region is acceptable. If there is not at least one overlapping peak predicted in this region, it counts as a false negative ;</p></list-item><list-item><p id="Par34"><italic>peakStart</italic> and <italic>peakEnd</italic> labels stand for regions which should contain exactly one peak start or end. If more than one peak start / end is predicted in this region, the label counts as a false positive. Conversely, if less than one peak start / end is predicted in this region, the label counts as a false negative.</p></list-item></list>The set of labels <inline-formula id="IEq68"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_m$$\end{document}</tex-math><mml:math id="M126"><mml:msub><mml:mi>H</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq68.gif"/></alternatives></inline-formula> is used to quantify the error <inline-formula id="IEq69"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_m$$\end{document}</tex-math><mml:math id="M128"><mml:msub><mml:mi>E</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq69.gif"/></alternatives></inline-formula>, i.e. the total number of incorrectly predicted labels (false positive <inline-formula id="IEq70"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$+$$\end{document}</tex-math><mml:math id="M130"><mml:mo>+</mml:mo></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq70.gif"/></alternatives></inline-formula> false negative) in the coverage profile <inline-formula id="IEq71"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_m$$\end{document}</tex-math><mml:math id="M132"><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq71.gif"/></alternatives></inline-formula> given the set of peaks returned by a peak caller.</p>
      </sec>
    </sec>
    <sec id="Sec15">
      <title>Supervised algorithms for learning tuning parameters of negative binomial segmentation models</title>
      <sec id="Sec16">
        <title>Objective function</title>
        <p id="Par35">The error function for a given problem <inline-formula id="IEq72"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_m$$\end{document}</tex-math><mml:math id="M134"><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq72.gif"/></alternatives></inline-formula>, denoted <inline-formula id="IEq73"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_m:{\mathbb {R}}_+^2\rightarrow {\mathbb {Z_+}}$$\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq73.gif"/></alternatives></inline-formula>, is a mapping from the tuning parameters <inline-formula id="IEq74"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\phi , \lambda$$\end{document}</tex-math><mml:math id="M138"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>,</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq74.gif"/></alternatives></inline-formula>) of negative binomial segmentation models to the number of incorrectly predicted labels in the resulting optimal segmentation. With the supervised peak detection approach the goal is to provide predictions of <inline-formula id="IEq75"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi$$\end{document}</tex-math><mml:math id="M140"><mml:mi>ϕ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq75.gif"/></alternatives></inline-formula> and <inline-formula id="IEq76"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M142"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq76.gif"/></alternatives></inline-formula> that minimize <inline-formula id="IEq77"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_m(\phi ,\lambda )$$\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>,</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq77.gif"/></alternatives></inline-formula>. The exact computation of the 2-dimensional defined <inline-formula id="IEq78"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_m(\phi ,\lambda )$$\end{document}</tex-math><mml:math id="M146"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>,</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq78.gif"/></alternatives></inline-formula> is intractable with respect to <inline-formula id="IEq79"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi$$\end{document}</tex-math><mml:math id="M148"><mml:mi>ϕ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq79.gif"/></alternatives></inline-formula>. Thus, we computed it over 16 <inline-formula id="IEq80"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi$$\end{document}</tex-math><mml:math id="M150"><mml:mi>ϕ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq80.gif"/></alternatives></inline-formula> values evenly placed on the log scale between 1 and 10,000, <inline-formula id="IEq81"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Phi = (\phi _1=1,\dots ,\phi _{16}=10{,}000)$$\end{document}</tex-math><mml:math id="M152"><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mn>16</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq81.gif"/></alternatives></inline-formula>. Our results suggest that this grid of values is a good set of candidates to test in order to calibrate the dispersion parameter <inline-formula id="IEq82"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi$$\end{document}</tex-math><mml:math id="M154"><mml:mi>ϕ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq82.gif"/></alternatives></inline-formula> (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. 2). The exact computation of the error rate as a function of <inline-formula id="IEq83"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M156"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq83.gif"/></alternatives></inline-formula> (<inline-formula id="IEq84"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi$$\end{document}</tex-math><mml:math id="M158"><mml:mi>ϕ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq84.gif"/></alternatives></inline-formula> remains constant), a piecewise constant function, requires to retrieve all optimal segmentations up to 9 peaks. This way, on the advice of the biologists who annotated the benchmark datasets, we ensure that for each problem there is a segmentation with at least one false positive label and another with one false negative label. A procedure that retrieves one optimal segmentation for each targeted number of peaks <inline-formula id="IEq85"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P^*$$\end{document}</tex-math><mml:math id="M160"><mml:msup><mml:mi>P</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq85.gif"/></alternatives></inline-formula> has already been described by Hocking et al. [<xref ref-type="bibr" rid="CR11">11</xref>]. It can be used with the Up–Down model for which there is at most one optimal segmentation that results in <inline-formula id="IEq86"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P^*$$\end{document}</tex-math><mml:math id="M162"><mml:msup><mml:mi>P</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq86.gif"/></alternatives></inline-formula> peaks but not with the unconstrained model for which there can be several ones. Indeed, the constraints in the Up–Down model require it to add, if the associated cost is optimal, 2 changepoints that lead to the formation of a new peak. With the unconstrained model adding a changepoint can either refine an already existing peak or, in combination with another changepoint, form a new peak. More generally there is a need of an algorithm that takes as input any penalized changepoint detection solver <inline-formula id="IEq87"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}$$\end{document}</tex-math><mml:math id="M164"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq87.gif"/></alternatives></inline-formula> with a penalty <inline-formula id="IEq88"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M166"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq88.gif"/></alternatives></inline-formula> constant along the changepoints, optionally the dispersion parameter <inline-formula id="IEq89"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi$$\end{document}</tex-math><mml:math id="M168"><mml:mi>ϕ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq89.gif"/></alternatives></inline-formula>, and outputs all optimal segmentations between two peak bounds denoted <inline-formula id="IEq90"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\underline{P}}$$\end{document}</tex-math><mml:math id="M170"><mml:munder><mml:mi>P</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq90.gif"/></alternatives></inline-formula> and <inline-formula id="IEq91"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{P}}$$\end{document}</tex-math><mml:math id="M172"><mml:mover><mml:mi>P</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq91.gif"/></alternatives></inline-formula>. We present <italic>CROCS</italic> (Changepoints for a Range of ComplexitieS), an algorithm that meets this need.</p>
      </sec>
      <sec id="Sec600">
        <title>Discussion of pseudocode</title>
        <p><italic>CROCS</italic> (<italic>Algorithm</italic> 1).<bold>(i)</bold> The algorithm begins by calling <italic>SequentialSearch</italic> [described underneath] to search two penalty bounds <inline-formula id="IEq92"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{\lambda }$$\end{document}</tex-math><mml:math id="M174"><mml:mover><mml:mi>λ</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq92.gif"/></alternatives></inline-formula> (line 6) and <inline-formula id="IEq93"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\underline{\lambda }}$$\end{document}</tex-math><mml:math id="M176"><mml:munder><mml:mi>λ</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq93.gif"/></alternatives></inline-formula> (line 5) that result in a segmentation with respectively <inline-formula id="IEq94"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\underline{P}}-1$$\end{document}</tex-math><mml:math id="M178"><mml:mrow><mml:munder><mml:mi>P</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq94.gif"/></alternatives></inline-formula> (line 3) and <inline-formula id="IEq95"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{P}}+1$$\end{document}</tex-math><mml:math id="M180"><mml:mrow><mml:mover><mml:mi>P</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq95.gif"/></alternatives></inline-formula> (line 4) peaks. Indeed, using <italic>gfpop</italic> with the Up–Down model as solver <inline-formula id="IEq96"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}$$\end{document}</tex-math><mml:math id="M182"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq96.gif"/></alternatives></inline-formula>, the number peaks in the resulting optimal segmentations is a non-increasing function of <inline-formula id="IEq97"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M184"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq97.gif"/></alternatives></inline-formula>. This propriety guarantees that with the previous penalty bounds we can reach every optimal model from <inline-formula id="IEq98"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\underline{P}}$$\end{document}</tex-math><mml:math id="M186"><mml:munder><mml:mi>P</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq98.gif"/></alternatives></inline-formula> to <inline-formula id="IEq99"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{P}}$$\end{document}</tex-math><mml:math id="M188"><mml:mover><mml:mi>P</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq99.gif"/></alternatives></inline-formula> peaks. For unconstrained segmentation models, we suspect it also should be true in the vast majority of cases. <bold>(ii)</bold> Then, the algorithm calls <italic>CROPS</italic> [described underneath] (line 7) to retrieve all the optimal segmentations between these two penalty bounds. <bold>(iii)</bold> Finally, a simple post-processing step (not shown in the algorithm) allows to remove segmentations with <inline-formula id="IEq100"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P-1$$\end{document}</tex-math><mml:math id="M190"><mml:mrow><mml:mi>P</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq100.gif"/></alternatives></inline-formula> and <inline-formula id="IEq101"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P+1$$\end{document}</tex-math><mml:math id="M192"><mml:mrow><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq101.gif"/></alternatives></inline-formula> peaks. The time complexity of the <italic>CROCS</italic> algorithm is bounded by the time complexity of the <italic>CROPS</italic> procedure, i.e. <inline-formula id="IEq102"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {O}}({\mathcal {O}}({\mathcal {S}})(K_{{\underline{\lambda }}} - K_{\overline{\lambda }}))$$\end{document}</tex-math><mml:math id="M194"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">O</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:munder><mml:mi>λ</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mover><mml:mi>λ</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq102.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq103"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{\overline{\lambda }}$$\end{document}</tex-math><mml:math id="M196"><mml:msub><mml:mi>K</mml:mi><mml:mover><mml:mi>λ</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq103.gif"/></alternatives></inline-formula> and <inline-formula id="IEq104"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{{\underline{\lambda }}}$$\end{document}</tex-math><mml:math id="M198"><mml:msub><mml:mi>K</mml:mi><mml:munder><mml:mi>λ</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq104.gif"/></alternatives></inline-formula> are the number of segments in optimal segmentations associated to respectively <inline-formula id="IEq105"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{\lambda }$$\end{document}</tex-math><mml:math id="M200"><mml:mover><mml:mi>λ</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq105.gif"/></alternatives></inline-formula> and <inline-formula id="IEq106"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\underline{\lambda }}$$\end{document}</tex-math><mml:math id="M202"><mml:munder><mml:mi>λ</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq106.gif"/></alternatives></inline-formula>. <inline-formula id="IEq107"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {O}}({\mathcal {S}})$$\end{document}</tex-math><mml:math id="M204"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq107.gif"/></alternatives></inline-formula> is the time complexity of the solver <inline-formula id="IEq108"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}$$\end{document}</tex-math><mml:math id="M206"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq108.gif"/></alternatives></inline-formula>, e.g. empirically <inline-formula id="IEq109"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {O}}(2n\log (n))$$\end{document}</tex-math><mml:math id="M208"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>log</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq109.gif"/></alternatives></inline-formula> for <italic>gfpop</italic> with the Up–Down model.<list list-type="bullet"><list-item><p id="Par36"><italic>SequentialSearch</italic> is a procedure described by Hocking et al. [<xref ref-type="bibr" rid="CR11">11</xref>] that takes as input a problem <inline-formula id="IEq110"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_m$$\end{document}</tex-math><mml:math id="M210"><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq110.gif"/></alternatives></inline-formula>, a target number of peaks <inline-formula id="IEq111"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P^*$$\end{document}</tex-math><mml:math id="M212"><mml:msup><mml:mi>P</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq111.gif"/></alternatives></inline-formula> and outputs an optimal segmentation with <inline-formula id="IEq112"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P^*$$\end{document}</tex-math><mml:math id="M214"><mml:msup><mml:mi>P</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq112.gif"/></alternatives></inline-formula> peaks in addition to the penalty <inline-formula id="IEq113"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M216"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq113.gif"/></alternatives></inline-formula> for reaching it.</p></list-item><list-item><p id="Par37"><italic>CROPS</italic> is a procedure described by Haynes et al. [<xref ref-type="bibr" rid="CR6">6</xref>] that takes as input a problem <inline-formula id="IEq114"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_m$$\end{document}</tex-math><mml:math id="M218"><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq114.gif"/></alternatives></inline-formula>, as well as two penalty bounds <inline-formula id="IEq115"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\underline{\lambda }}$$\end{document}</tex-math><mml:math id="M220"><mml:munder><mml:mi>λ</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq115.gif"/></alternatives></inline-formula> &amp; <inline-formula id="IEq116"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{\lambda }$$\end{document}</tex-math><mml:math id="M222"><mml:mover><mml:mi>λ</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq116.gif"/></alternatives></inline-formula> and outputs all the optimal segmentations between these two bounds.</p></list-item></list>We slightly modified the original implementation of both <italic>SequentialSearch</italic> and <italic>CROPS</italic> in such way that they can work with any penalized changepoint detection solver <inline-formula id="IEq117"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}$$\end{document}</tex-math><mml:math id="M224"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq117.gif"/></alternatives></inline-formula> provided by the user.<graphic position="anchor" xlink:href="12859_2021_4221_Figg_HTML" id="MO18"/></p>
      </sec>
      <sec id="Sec17">
        <title>Learning jointly <inline-formula id="IEq118"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi$$\end{document}</tex-math><mml:math id="M226"><mml:mi>ϕ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq118.gif"/></alternatives></inline-formula> and <inline-formula id="IEq119"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M228"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq119.gif"/></alternatives></inline-formula></title>
        <p id="Par38">Once the error function <inline-formula id="IEq120"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_m(\phi \in \Phi ,\lambda )$$\end{document}</tex-math><mml:math id="M230"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>,</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq120.gif"/></alternatives></inline-formula> is computed for each problem of the training set, a natural way to learn the dispersion and penalty parameters is to select the pair of values <inline-formula id="IEq121"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\phi \in \Phi ,\lambda )$$\end{document}</tex-math><mml:math id="M232"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>,</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq121.gif"/></alternatives></inline-formula> that achieves the global minimum error. We denote these values <inline-formula id="IEq122"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi ^*$$\end{document}</tex-math><mml:math id="M234"><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq122.gif"/></alternatives></inline-formula> and <inline-formula id="IEq123"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda ^*$$\end{document}</tex-math><mml:math id="M236"><mml:msup><mml:mi>λ</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq123.gif"/></alternatives></inline-formula>. Recall that <inline-formula id="IEq124"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_m(\phi \in \Phi ,\lambda )$$\end{document}</tex-math><mml:math id="M238"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>,</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq124.gif"/></alternatives></inline-formula> is piecewise constant on <inline-formula id="IEq125"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M240"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq125.gif"/></alternatives></inline-formula>. The sum of <inline-formula id="IEq126"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_m(\phi \in \Phi ,\lambda )$$\end{document}</tex-math><mml:math id="M242"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>,</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq126.gif"/></alternatives></inline-formula> over all problems is still piecewise constant on <inline-formula id="IEq127"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M244"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq127.gif"/></alternatives></inline-formula>. Therefore, <inline-formula id="IEq128"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi ^*$$\end{document}</tex-math><mml:math id="M246"><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq128.gif"/></alternatives></inline-formula> and <inline-formula id="IEq129"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda ^*$$\end{document}</tex-math><mml:math id="M248"><mml:msup><mml:mi>λ</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq129.gif"/></alternatives></inline-formula> can be easily retrieved using a sequential search. We refined the previous learning method, hereafter called <italic>constant</italic>
<inline-formula id="IEq130"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M250"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq130.gif"/></alternatives></inline-formula>, by taking advantage of the piecewise constant propriety of <inline-formula id="IEq131"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_m(\phi \in \Phi ,\lambda )$$\end{document}</tex-math><mml:math id="M252"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>,</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq131.gif"/></alternatives></inline-formula>. Indeed, the minimum error is not reached for a unique penalty value <inline-formula id="IEq132"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda ^*$$\end{document}</tex-math><mml:math id="M254"><mml:msup><mml:mi>λ</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq132.gif"/></alternatives></inline-formula> but an interval denoted <inline-formula id="IEq133"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{\lambda ,m}$$\end{document}</tex-math><mml:math id="M256"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>λ</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq133.gif"/></alternatives></inline-formula>. After fixing <inline-formula id="IEq134"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi ^*$$\end{document}</tex-math><mml:math id="M258"><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq134.gif"/></alternatives></inline-formula>, we can use <inline-formula id="IEq135"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{\lambda ,m}$$\end{document}</tex-math><mml:math id="M260"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>λ</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq135.gif"/></alternatives></inline-formula> computed for each problem of the training set in order to learn a function that predicts problem-specific <inline-formula id="IEq136"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M262"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq136.gif"/></alternatives></inline-formula> values. This function is a solution of the interval regression problem described by Rigaill et al. [<xref ref-type="bibr" rid="CR16">16</xref>]. We denote this learning method <italic>linear</italic>
<inline-formula id="IEq137"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M264"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq137.gif"/></alternatives></inline-formula>.</p>
        <p id="Par39">In the case of segmentation models with a Poisson or a Gaussian noise, the only tuning parameter that we need to learn is <inline-formula id="IEq138"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M266"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq138.gif"/></alternatives></inline-formula>. Thus, the objective function becomes a 1-dimensional defined function denoted <inline-formula id="IEq139"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_m(\lambda )$$\end{document}</tex-math><mml:math id="M268"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq139.gif"/></alternatives></inline-formula>. The methods we used to learn <inline-formula id="IEq140"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M270"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq140.gif"/></alternatives></inline-formula> are similar than those presented above (see Hocking et al. [<xref ref-type="bibr" rid="CR12">12</xref>] for more details).</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec18">
    <title>Empirical results</title>
    <sec id="Sec19">
      <title>Cross-validation setup and evaluation metric</title>
      <p id="Par40">In the following section, for each model compared, a 10-fold or 4-fold<xref ref-type="fn" rid="Fn1">1</xref> cross-validation was performed on each of the seven datasets. Here, the results are shown by type of experiments (H3K36me3 &amp; H3K4me3). The metric we used to evaluate the performance of our models is the test accuracy which can be formally written <inline-formula id="IEq141"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1-\left( \sum _{m\in {\text { test set}}}E_m\ /\ \sum _{m\in {\text { test set}}} |H_m|\right)$$\end{document}</tex-math><mml:math id="M272"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mspace width="0.333333em"/><mml:mtext>test set</mml:mtext></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mi>E</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mspace width="4pt"/><mml:mo stretchy="false">/</mml:mo><mml:mspace width="4pt"/><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mspace width="0.333333em"/><mml:mtext>test set</mml:mtext></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq141.gif"/></alternatives></inline-formula>. One may be concerned about the size of the datasets used for supervised learning of the tuning parameters. We have shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. 1 that only a dozens of labels are enough to learn tuning parameters and associated segmentations close to the model-specific maximum accuracy. By increasing the number of labels in the learning set, the accuracy also becomes more consistent between test folds.</p>
    </sec>
    <sec id="Sec20">
      <title>Learning of tuning parameters</title>
      <p id="Par41">In previous section we have described two methods for learning the tuning parameters of segmentation models. Based on results shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. 3, for the rest of this section, the parameters of the models compared on H3K36me3 datasets are learned through the <italic>constant </italic><inline-formula id="IEq142"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M274"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq142.gif"/></alternatives></inline-formula> method. The parameters of the models compared on H3K4me3 datasets are them learned through the <italic>linear</italic>
<inline-formula id="IEq143"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M276"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq143.gif"/></alternatives></inline-formula> method.<fig id="Fig4"><label>Fig. 4</label><caption><p>The over-dispersion exhibited by count data under a Poisson noise model can be effectively reduced using a negative binomial or a Gaussian transformed noise model. The red
<inline-graphic xlink:href="12859_2021_4221_Figb_HTML.gif" id="d32e3656"/>
indicator line stands for the equality of the theoretical and empirical variances. (<bold>Left</bold>) Observations above this line stand for over-dispersed count data. Observations under this line stand for under-dispersed count data. (<bold>Right</bold>) A zoom on the <bold>Left</bold> distributions</p></caption><graphic xlink:href="12859_2021_4221_Fig4_HTML" id="MO20"/></fig></p>
    </sec>
    <sec id="Sec21">
      <title>The over-dispersion exhibited by count data under a Poisson noise model can be effectively reduced using a negative binomial or a Gaussian transformed noise model</title>
      <p id="Par42">Initially, we wanted to validate the presence of over-dispersion in count data following a Poisson distribution. In a second step, we wanted to confirm that alternative noise models such as the negative binomial or the Gaussian one, following an Anscombe transformation of the counts for the latter, could allow us to reduce this over-dispersion. A simple way to highlight the over-dispersion is to plot the <inline-formula id="IEq144"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\log _2{\text {-ratio}}$$\end{document}</tex-math><mml:math id="M278"><mml:mrow><mml:msub><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mtext>-ratio</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq144.gif"/></alternatives></inline-formula> of the empirical and theoretical variances of count data. If the <inline-formula id="IEq145"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\log _2{\text {-ratio}}$$\end{document}</tex-math><mml:math id="M280"><mml:mrow><mml:msub><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mtext>-ratio</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq145.gif"/></alternatives></inline-formula> is positive, the distribution of count data exhibits over-dispersion. If it is negative, the distribution of count data exhibits under-dispersion. If it is null, the dispersion of the count data does not show inconsistency with respect to the noise model. In Fig. <xref rid="Fig4" ref-type="fig">4</xref>, each observation corresponds to a segment from the segmentations selected during the cross-validation procedure for the 2752 coverage profiles. The segmentation were computed using <italic>CROCS</italic> with <italic>gfpop</italic> and the unconstrained model as solver. Then, We estimated the empirical and theoretical variances for each of the selected segments. In the case of the Poisson noise model, the estimated theoretical variance is formally written <inline-formula id="IEq146"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\sigma _k}^2 = \hat{\mu }$$\end{document}</tex-math><mml:math id="M282"><mml:mrow><mml:msup><mml:mover accent="true"><mml:msub><mml:mi>σ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq146.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq147"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\mu }$$\end{document}</tex-math><mml:math id="M284"><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq147.gif"/></alternatives></inline-formula> stands for the estimation of the mean of count data belonging to the same segment. For the negative binomial one it is formally written <inline-formula id="IEq148"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\sigma }^2 = \hat{\mu }+\phi ^{-1}\hat{\mu }^2$$\end{document}</tex-math><mml:math id="M286"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq148.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq149"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi$$\end{document}</tex-math><mml:math id="M288"><mml:mi>ϕ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq149.gif"/></alternatives></inline-formula> stands for the dispersion parameter learned during the cross-validation procedure. For the Gaussian one, the theoretical variance is assumed constant across the segments. We estimated it using the mean squared error computed over all segments. In Fig. <xref rid="Fig4" ref-type="fig">4</xref> we can see that in both H3K36me3 and H3K4me3 datasets the median of the <inline-formula id="IEq150"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\log _2{\text {-ratio}}$$\end{document}</tex-math><mml:math id="M290"><mml:mrow><mml:msub><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mtext>-ratio</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq150.gif"/></alternatives></inline-formula> is above 1 with the Poisson noise model. Hence, For most observations the empirical variance is at least two times larger than the theoretical variance. Therefore, count data under the Poisson noise model shows a clear over-dispersion phenomenon. In both H3K36me3 and H3K4me3 datasets, the median of the <inline-formula id="IEq151"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\log _2{\text {-ratio}}$$\end{document}</tex-math><mml:math id="M292"><mml:mrow><mml:msub><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mtext>-ratio</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq151.gif"/></alternatives></inline-formula> is slightly closest to 0 with the negative noise model than with Poisson noise one (from 1.19 to 0.70 in H3K36me3 and 1.69 to 1.39 in H3K4me3). Therefore, the negative noise model helps partially correct this over-dispersion. The reduction is even greater with the Gaussian transformed noise model (from 1.19 to 0.16 in H3K36me3 and 1.69 to 0.18 in H3K4me3).</p>
    </sec>
    <sec id="Sec22">
      <title>Max jump is the most accurate rule for inferring the peaks in segmentations obtained through the unconstrained model</title>
      <p id="Par43">Solving the peak detection problem with the unconstrained model requires to introduce a rule for selecting the changepoints corresponding to the start and end of the peaks in the output segmentation. We wanted to compare the peak detection accuracy of the new rule we propose (<italic>max jump</italic>) against the others (<italic>largest peak</italic> &amp; <italic>thinnest peak</italic>) which have an equivalence in Hocking et al. [<xref ref-type="bibr" rid="CR12">12</xref>]. In the user guide of how to create labels in ChIP-seq coverage profiles [<xref ref-type="bibr" rid="CR7">7</xref>], the authors strongly advise to label peaks which are obviously up with respect to the background noise. Hence, we expected that the <italic>max jump</italic> rule, which sets the start and end of the peaks on the change with the largest mean-difference, performs at least as well as the other two rules. In Fig. <xref rid="Fig5" ref-type="fig">5</xref>, we look at the mean of differences in accuracy between each model with either the <italic>largest peak</italic> or <italic>thinnest peak</italic> rule, denoted target models, against the same model with the <italic>max jump</italic> rule, denoted reference model. In agreement with our expectation, we observe that for the different models in both H3K36me3 &amp; H3K4me3 datasets, the mean accuracy of the <italic>max jump</italic> rule is greater than the mean accuracy of the <italic>largest peak</italic> rule (3.66–12.36% more accurate on average). Except for the unconstrained model with a Poisson noise in H3K4me3 (0.11% less accurate on average), the mean accuracy of the <italic>max jump</italic> rule is also greater than the mean accuracy of the <italic>thinnest peak</italic> (0.38–3.03% more accurate on average). In order to test if the mean accuracy of the target and the reference models are significantly different, we performed a paired t-test. The accuracy of each fold were previously pooled by type of experiments as it is suggested in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. After correcting the p-values of the paired t-test with the Benjamini &amp; Hochberg method, eight differences were still significant (adjusted p-value <inline-formula id="IEq152"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;0.05$$\end{document}</tex-math><mml:math id="M294"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq152.gif"/></alternatives></inline-formula>). As a result of these observations, for the next comparisons we will infer the peaks in the output segmentations obtained with the unconstrained model using the new <italic>max jump</italic> rule we propose.<fig id="Fig5"><label>Fig. 5</label><caption><p>Max jump is the most accurate rule for inferring the peaks in segmentations obtained through a unconstrained model. The mean of differences in accuracy and its 95% CI computed on the test folds pooled by types of experiment (H3K36me3 &amp; H3K4me3) are shown in red
<inline-graphic xlink:href="12859_2021_4221_Figb_HTML.gif" id="d32e3921"/>
. If the mean of differences in accuracy is negative (left side of the blue indicator line
<inline-graphic xlink:href="12859_2021_4221_Figa_HTML.gif" id="d32e3924"/>
), the <italic>max jump</italic> rule is better in average than the target rule. The results of the paired t-test used to assess the difference of mean accuracy are summarized in the following way: non significant (ns) means adjusted p-value <inline-formula id="IEq153"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt;0.05$$\end{document}</tex-math><mml:math id="M296"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq153.gif"/></alternatives></inline-formula>; * means adjusted p-value <inline-formula id="IEq154"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le 0.05$$\end{document}</tex-math><mml:math id="M298"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq154.gif"/></alternatives></inline-formula>; *** means adjusted p-value <inline-formula id="IEq155"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le 0.001$$\end{document}</tex-math><mml:math id="M300"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq155.gif"/></alternatives></inline-formula></p></caption><graphic xlink:href="12859_2021_4221_Fig5_HTML" id="MO23"/></fig></p>
    </sec>
    <sec id="Sec23">
      <title>The unconstrained model with a negative binomial or a Gaussian transformed noise is more accurate than previous state-of-the-art</title>
      <p id="Par44">
        <fig id="Fig6">
          <label>Fig. 6</label>
          <caption>
            <p>The unconstrained model with a negative binomial or a Gaussian transformed noise is more accurate than previous state-of-the-art. The mean of differences in accuracy and its 95% CI computed on the test folds pooled by types of experiment (H3K36me3 &amp; H3K4me3) are shown in red
<inline-graphic xlink:href="12859_2021_4221_Figb_HTML.gif" id="d32e3982"/>
. If the mean of differences in accuracy is negative (left side of the blue indicator line
<inline-graphic xlink:href="12859_2021_4221_Figa_HTML.gif" id="d32e3985"/>
), the Up–Down model with a Poisson noise is better in average than the target model. The results of the paired t-test used to assess the difference of mean accuracy are summarized in the following way: non significant (ns) means adjusted p-value <inline-formula id="IEq156"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt;0.05$$\end{document}</tex-math><mml:math id="M302"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq156.gif"/></alternatives></inline-formula>; * means adjusted p-value <inline-formula id="IEq157"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le 0.05$$\end{document}</tex-math><mml:math id="M304"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq157.gif"/></alternatives></inline-formula></p>
          </caption>
          <graphic xlink:href="12859_2021_4221_Fig6_HTML" id="MO26"/>
        </fig>
      </p>
      <p id="Par45">We wanted to compare the peak detection accuracy of the Up–Down model with a Poisson noise<xref ref-type="fn" rid="Fn2">2</xref> against other segmentation models such as the unconstrained or Up–Down model with either a negative binomial or a Gaussian transformed noise. HMCan, MACS and other heuristics have already been compared to the Up–Down model with a Poisson noise in Hocking et al. [<xref ref-type="bibr" rid="CR12">12</xref>]. We included them again as a baseline from the bioinformatics literature. Both of them use a threshold that affects their peak detection accuracy and whose learning is also described in the previous cited study. Because we saw in previous results that a negative binomial or Gaussian transformed noise effectively reduces the over-dispersion exhibited by count data under a Poisson noise, we expected that the unconstrained or Up–Down model with these alternative noises will improve the peak detection accuracy on the test set. In Fig. <xref rid="Fig6" ref-type="fig">6</xref> we look at the mean of differences in accuracy between the Up–Down model with a Poisson noise, denoted reference model, against other segmentation models and heuristics, denoted target models. In agreement with our expectation, we can see that the unconstrained model with a negative binomial noise has a mean accuracy greater than the reference model in both H3K36me3 and H3K4me3 datasets (respectively 2.0% and 0.86% more accurate on average). It has also a greater mean accuracy with a Gaussian transformed noise (respectively 2.15% and 1.77% more accurate on average). As described previously, in order to test if the mean accuracy of the target and the reference models are significantly different, we performed a paired t-test. After correcting the p-values, the unconstrained model with a Gaussian transformed noise was still significant (adjusted p-value <inline-formula id="IEq158"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;0.05$$\end{document}</tex-math><mml:math id="M306"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq158.gif"/></alternatives></inline-formula>). Note that the unconstrained model with a Poisson noise has a mean accuracy similar to reference model (the mean of differences in accuracy &lt; 0.5% in both datasets). Thus, the improvement in accuracy cannot be attributed solely to the unconstrained model with the <italic>max jump</italic> rule but also to the distribution chosen for the noise. In disagreement with our expectation, with the Up–Down model the use of alternative noise distributions does not improve significantly the accuracy compared to the Poisson one (mean of differences in accuracy &lt; 1% in H3K36me3 and &lt; 0.1% in H3K4me3).<fig id="Fig7"><label>Fig. 7</label><caption><p>The Up–down segmentation models are more robust than the heuristics from the bioinformatics literature HMCan and MACS. The mean of differences of the normalized information distance (NID) and its 95% CI are shown in red
<inline-graphic xlink:href="12859_2021_4221_Figb_HTML.gif" id="d32e4051"/>
. If the mean of differences in NID is negative (left side of the blue indicator line
<inline-graphic xlink:href="12859_2021_4221_Figa_HTML.gif" id="d32e4054"/>
), the target segmentation model is more robust in average than HMCan (H3K36me3) or MACS (H3K4me3). The results of the paired t-test used to assess the difference of mean of NID are summarized in the following way: non significant (ns) means adjusted p-value <inline-formula id="IEq159"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt;0.05$$\end{document}</tex-math><mml:math id="M308"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq159.gif"/></alternatives></inline-formula>; * means adjusted p-value <inline-formula id="IEq160"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le 0.05$$\end{document}</tex-math><mml:math id="M310"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq160.gif"/></alternatives></inline-formula>; ** means adjusted p-value <inline-formula id="IEq161"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le 0.01$$\end{document}</tex-math><mml:math id="M312"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq161.gif"/></alternatives></inline-formula></p></caption><graphic xlink:href="12859_2021_4221_Fig7_HTML" id="MO29"/></fig></p>
    </sec>
    <sec id="Sec24">
      <title>The Up–down segmentation models are more robust than the heuristics from the bioinformatics literature HMCan and MACS</title>
      <p id="Par46">In addition to comparing the peak detection accuracy, we wanted to assess the robustness of segmentation models against the heuristics HMCan and MACS. To assess the robustness of the segmentation models and heuristics we used the coverage profiles from biological replicates available in each of the seven labeled histone mark datasets. The value of tuning parameters for the segmentation models and heuristics are the same as those learned during the cross-validation procedure. As explained in the introduction, the peak calling problem can be seen as a binary classification problem. In this framework each base from the coverage profiles are classified as a part of the background noise (0) or peak (1). Hence, the robustness can be assessed by computing the distance between partitions of the coverage profiles from the biological replicates. The more the distance between these partitions is close to zero the more the segmentation model or the heuristic is robust. As a metric we used the normalized information distance, or NID, which has a range between 0 and 1 [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR23">23</xref>]. For each genomic chunk we computed the NID between all pairs of biological replicates. In Fig. <xref rid="Fig7" ref-type="fig">7</xref> we look a the mean of differences of NID between segmentation models and the heuristics HMCan or MACS. We can see that the mean of the NID of Up–Down models, independently of the noise model, is lower than with the heuristics HMcan and MACS in both H3K36me3 and H3K4me3 datasets (respectively from 0.09 to 0.12 and 0.02 to 0.03 less distant on average). After correcting the p-values of the paired t-test with the Benjamini &amp; Hochberg method, five differences were still significant (adjusted p-value <inline-formula id="IEq162"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;0.05$$\end{document}</tex-math><mml:math id="M314"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq162.gif"/></alternatives></inline-formula>). Regarding the unconstrained models, except for the negative binomial noise model in the H3K24me3 datasets (NID is lower by 0.09 in average &amp; paired t-test with adjusted p-value <inline-formula id="IEq163"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;0.01$$\end{document}</tex-math><mml:math id="M316"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq163.gif"/></alternatives></inline-formula>), there is no clear improvement in robustness compared to the heuristics HMCan or MACS. With the Poisson model, which do no reduce the over-dispersion, we conclude even the opposite in the H3K4me3 datasets (NID is longer by 0.05 in average, paired t-test with adjusted p-value <inline-formula id="IEq164"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;0.01$$\end{document}</tex-math><mml:math id="M318"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq164.gif"/></alternatives></inline-formula>).</p>
    </sec>
  </sec>
  <sec id="Sec25">
    <title>Discussion</title>
    <sec id="Sec26">
      <title>Modeling of over-dispersed ChIP-seq count data</title>
      <p id="Par47">We have seen in Fig. <xref rid="Fig4" ref-type="fig">4</xref> that count data under a Poisson noise model exhibit over-dispersion in H3K36me3 and H3K4me3 datasets. We have shown that this over-dispersion can be effectively reduced in these datasets using either a negative binomial or a Gaussian transformed noise model.</p>
      <p id="Par48">The use of a negative binomial noise model implies that we must be able to estimate a suitable value for the <inline-formula id="IEq165"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi$$\end{document}</tex-math><mml:math id="M320"><mml:mi>ϕ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq165.gif"/></alternatives></inline-formula> dispersion parameter. We have proposed to learn it jointly with the penalty of the segmentation model directly on the labeled coverage profiles. More precisely, a constant <inline-formula id="IEq166"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi$$\end{document}</tex-math><mml:math id="M322"><mml:mi>ϕ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq166.gif"/></alternatives></inline-formula> is selected because it minimizes the label errors of the training set. The negative binomial combined with the constant dispersion parameter allows the phenomenon of over-dispersion to be slightly reduced.</p>
      <p id="Par49">With the Gaussian noise model there are no additional parameters than the penalty of the segmentation model to set. This is an advantage compared to the negative binomial one. In this study, in order to satisfy the Gaussian proprieties, we transformed the count data with an Anscombe transformation which is highly appreciated for its variance stabilization properties. Gaussian transformed noise model allowed to reduce the over-dispersion even more efficiently than the negative binomial noise model on the H3K4me3 and H3K36me3 datasets, while being simpler to implement.</p>
    </sec>
    <sec id="Sec27">
      <title>Segmentation models for peak detection in ChIP-seq count data</title>
      <p id="Par50">The unconstrained model seems to capture more subtle changes in count data than the Up–Down one which have sometimes a poor fit to the signal (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>). One major issue of the unconstrained model is its output segmentation which doesn’t have a straightforward interpretation in terms of peaks compared to the Up–Down one. The introduction of the <italic>max jump</italic> rule (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>), which have shown to perform at least as well as rules proposed in Hocking et al. [<xref ref-type="bibr" rid="CR12">12</xref>] (<italic>thinnest peak</italic> &amp; <italic>largest peak</italic>), helps to correct this weakness (see Fig. <xref rid="Fig5" ref-type="fig">5</xref>).</p>
      <p id="Par51">In Fig. <xref rid="Fig6" ref-type="fig">6</xref> we have seen that when combining the unconstrained model with a negative binomial or a Gaussian transformed noise it is possible to improve upon the natural and current state-of-the-art on the peak detection accuracy, the Up–Down model with a Poisson noise, in both H3K36me and H3K4me3 datasets. We argue that this improvement is likely explained by the ability of the negative binomial and the Gaussian transformation to reduce the over-dispersion as illustrated in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. In summary, we believe that the better we model dispersion the better we improve the accuracy of the segmentation model. Figure <xref rid="Fig7" ref-type="fig">7</xref> have shown that the unconstrained segmentation model with noise models reducing over-dispersion are also at least as robust as MACS or HMCan heuristics. It is an important criterion showing the applicability of our proposed models.</p>
      <p id="Par52">Still in Fig. <xref rid="Fig6" ref-type="fig">6</xref>, we have seen that the Up–Down model with a negative binomial or a Gaussian transformed noise, which reduce the over-dispersion phenomenon, doesn’t improve the accuracy upon the Up–Down model with a Poisson noise. One hypothesis to explain these results is that the constraints, which lead to the reduction of the space of optimal reachable segmentations with the Up–Down model, also reduce the probability of adding biologically uninformative changepoints induced by the over-dispersion. Consequently, the Up–Down model has the advantage to be a model with good internal over-dipsersion resistance properties but is bounded by its poor adaptability to the signal. We argue the constraints also explain that the Up–Down model is more robust than the unconstrained model and the MACS and HMcan heuristics (see Fig. <xref rid="Fig7" ref-type="fig">7</xref>).</p>
      <p id="Par53">We have added several supplementary figures (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. 4–10) which illustrate typical results from the test folds for the MACS and HMCan heuristics as well as our proposed segmention models.</p>
    </sec>
    <sec id="Sec28">
      <title>Segmentation models applied to other types of ChIP-seq experiments</title>
      <p id="Par54">In this paper, the broad (H3K36me3) and sharp (H3K4me3) histone signals have been discussed. Previous studies already demonstrated the applicability of optimal changepoint algorithms to other types of experiment. For example, Fig. 7 in Hocking and Bourque [<xref ref-type="bibr" rid="CR9">9</xref>] showed that optimal changepoint algorithms on H3K9me3 and H3K27me3 data typically result in peaks with intermediate sizes (3.5–3.9 kb on average) compared with the relatively small H3K4me3 (1.0–1.7 kb) and relatively large H3K36me3 (35.8–48.0 kb). The peak calling of transcription factor binding sites such as MAX, SRF and NRSF was also previously tested (see Supplementary Fig. 3 in Hocking et al. [<xref ref-type="bibr" rid="CR7">7</xref>]). By reducing the over-dispersion in count data with the Gaussian transformed or the negative binomial noise models, we would expect similar improvements in accuracy for these other experiment types. Furthermore, we did not test our proposed models on mixed signal like Pol II. We leave the two last points for future research.</p>
    </sec>
  </sec>
  <sec id="Sec29">
    <title>Conclusion</title>
    <p id="Par55">We developed the <italic>CROCS</italic> algorithm that computes all optimal models between two peak bounds, given any segmentation algorithm with constant penalty <inline-formula id="IEq167"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M324"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq167.gif"/></alternatives></inline-formula> for each changepoint. This set of optimal segmentations is essential to compute the error rate function, which is in turn used in the supervised approach for learning the tuning parameters of the segmentation models. We proposed to solve the peak detection problem by using the unconstrained segmentation model that takes advantage of the <italic>max jump</italic> rule we introduced as well as the negative binomial or Gaussian transformed noise model. We have shown that this model improves upon the accuracy of the model built on natural assumptions (constrained segmentation (Up–Down) with Poisson noise model) in both H3K36me3 and H3K4me3 datasets. The unconstrained model with the negative binomial or Gaussian transformed noise model can be used to provide new high-quality peak prediction tracks for H3K36me3 and H3K4me3 histone modifications. These peak prediction tracks will be a more accurate reference for researchers in the field of epigenetics who want to analyze these data.</p>
    <sec id="Sec30">
      <title>Future work</title>
      <p id="Par56">Our results suggest that with both negative binomial and Gaussian transformed noise models the over-dispersion could be further reduced. Regarding the negative binomial noise model, one could think about predicting a local dispersion parameter for each coverage profile. Furthermore, the literature about Gaussian transformations is wide and a comparative study integrating segmentation models with different transformations for count data, e.g. the Box–Cox transformation, arcsin square root transformation or log-transformation, would also be an interesting avenue for future work. As described in Anscombe [<xref ref-type="bibr" rid="CR1">1</xref>] some of these well-known transformations have, in theory, better variance-stabilizing proprieties for over-dispersed count data than the one we used in this study <inline-formula id="IEq168"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\sqrt{Y+\frac{3}{8}})$$\end{document}</tex-math><mml:math id="M326"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msqrt><mml:mrow><mml:mi>Y</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mn>8</mml:mn></mml:mfrac></mml:mrow></mml:msqrt><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq168.gif"/></alternatives></inline-formula>. Still, they are highly dependent on the estimation of the dispersion parameter <inline-formula id="IEq169"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi$$\end{document}</tex-math><mml:math id="M328"><mml:mi>ϕ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4221_Article_IEq169.gif"/></alternatives></inline-formula> which in our case can be directly taken into account in the statistical model, i.e by using the negative binomial noise model implemented in <italic>gfpop</italic>.</p>
      <p id="Par57">In this paper we explored two different segmentation models, the unconstrained segmentation model and a constrained segmentation model where each non-decreasing change is followed by an non-increasing change in the mean (Up–Down). The <italic>gfpop</italic> method makes it possible to model changepoints even more precisely by constraining for example the minimum size of jumps or the minimum size of segments. It would be interesting in future work to test other constrained models or to model the auto-correlation [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR18">18</xref>] in the context of the peak detection problem in ChIP-seq data.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec31">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2021_4221_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold>. Supplementary materials for “Increased peak detection accuracy in over-dispersed ChIP-seq data with supervised segmentation models”. </p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>ChIP-seq</term>
        <def>
          <p id="Par4">Chromatin immunoprecipitation followed by high-throughput sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>Up–Down</term>
        <def>
          <p id="Par5">Constrained segmentation model where each non-decreasing change is followed by an non-increasing change in the mean</p>
        </def>
      </def-item>
      <def-item>
        <term>gfpop</term>
        <def>
          <p id="Par6">Graph-constrained functional pruning optimal partitioning</p>
        </def>
      </def-item>
      <def-item>
        <term>NID</term>
        <def>
          <p id="Par7">Normalized information distance</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn id="Fn1">
      <label>1</label>
      <p id="Par62">In order to satisfy the assumption about the independence between the training and test set in the cross-validation, we could not exceed 4-fold in two of the seven benchmark datasets (for more details see caption of Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table 1).</p>
    </fn>
    <fn id="Fn2">
      <label>2</label>
      <p id="Par63">Model built on natural assumptions to detect peaks in coverage profiles and actual state-of-the-art on H3K36me3 and H3K4me3 datasets.</p>
    </fn>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors contributions</title>
    <p>AL designed the study, wrote the code, performed the analyses, interpreted the results and wrote the manuscript. GR and TH supervised and designed the study, helped with the code, interpreted the results and provided manuscript feedback. The authors wish it to be known that, in their opinion, GR and TH should be regarded as joint last authors. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>AL and TH were funded by a Northern Arizona University startup grant. GR was supported by an ATIGE grant from Genopole. The IPS2 benefits from the support of the LabExSaclay Plant Sciences-SPS.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The labeled histone mark data are available here: <ext-link ext-link-type="uri" xlink:href="https://rcdata.nau.edu/genomic-ml/chip-seq-chunk-db/">https://rcdata.nau.edu/genomic-ml/chip-seq-chunk-db/</ext-link>. The scripts used to compute the models and analyse the results are available in the “aLiehrmann/chip_seq_segmentation_paper” <italic>GitHub</italic> repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/aLiehrmann/chip_seq_segmentation_paper">https://github.com/aLiehrmann/chip_seq_segmentation_paper</ext-link>. A reference implementation of the <italic>CROCS</italic> algorithm is available in the R package of the same name: <ext-link ext-link-type="uri" xlink:href="https://github.com/aLiehrmann/CROCS">https://github.com/aLiehrmann/CROCS</ext-link>. The package’s vignette describes the supervised learning procedure and the user can easily adapt the code to his own data.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar5">
      <title>Ethics approval and consent to participate</title>
      <p id="Par58">Not applicable.</p>
    </notes>
    <notes id="FPar7">
      <title>Consent for publication</title>
      <p id="Par59">Not applicable.</p>
    </notes>
    <notes id="FPar6" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par60">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anscombe</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>The transformation of poisson, binomial and negative-binomial data</article-title>
        <source>Biometrika</source>
        <year>1948</year>
        <volume>35</volume>
        <fpage>246</fpage>
        <lpage>254</lpage>
        <pub-id pub-id-type="doi">10.1093/biomet/35.3-4.246</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ashoor</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Herault</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kamoun</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Radvanyi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Bajic</surname>
            <given-names>VB</given-names>
          </name>
          <name>
            <surname>Barillot</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Boeva</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Hmcan: a method for detecting chromatin modifications in cancer samples using chip-seq data</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>2979</fpage>
        <lpage>2986</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt524</pub-id>
        <pub-id pub-id-type="pmid">24021381</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Chiquet J, Rigaill G, Sundqvist M. Aricode: efficient computations of standard clustering comparison measures (2020). <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=aricode">https://CRAN.R-project.org/package=aricode</ext-link></mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cho</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Fryzlewicz</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Multiple-change-point detection for high dimensional time series via sparsified binary segmentation</article-title>
        <source>J R Stat Soc Ser B (Statistical Methodology)</source>
        <year>2015</year>
        <volume>77</volume>
        <fpage>475</fpage>
        <lpage>507</lpage>
        <pub-id pub-id-type="doi">10.1111/rssb.12079</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cleynen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lebarbier</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Segmentation of the poisson and negative binomial rate models: a penalized estimator</article-title>
        <source>ESAIM Prob Stat</source>
        <year>2014</year>
        <volume>18</volume>
        <fpage>750</fpage>
        <lpage>769</lpage>
        <pub-id pub-id-type="doi">10.1051/ps/2014005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Haynes K, Eckley IA, Fearnhead P. Computationally efficient changepoint detection for a range of penalties (2017)</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hocking</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Goerner-Potvin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Morin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shao</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Pastinen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bourque</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Optimizing chip-seq peak detectors using visual labels and supervised machine learning</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <fpage>491</fpage>
        <lpage>499</lpage>
        <?supplied-pmid 27797775?>
        <pub-id pub-id-type="pmid">27797775</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hocking</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Rigaill</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Bourque</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Peakseg: constrained optimal segmentation and supervised penalty learning for peak detection in count data</article-title>
        <source>Proc Mach Learn Res</source>
        <year>2015</year>
        <volume>37</volume>
        <fpage>324</fpage>
        <lpage>332</lpage>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hocking</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Bourque</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Machine learning algorithms for simultaneous supervised detection of peaks inmultiple samples and cell types</article-title>
        <source>Pac Symp Biocomput</source>
        <year>2020</year>
        <volume>25</volume>
        <fpage>367</fpage>
        <lpage>378</lpage>
        <?supplied-pmid 31797611?>
        <pub-id pub-id-type="pmid">31797611</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Hocking TD, Rigaill G, Fearnhead P, Bourque G. A log-linear time algorithm for constrained changepoint detection. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1703.03352">arXiv:1703.03352</ext-link> (2017)</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Hocking TD, Rigaill G, Fearnhead P, Bourque G. Generalized functional pruning optimal partitioning (GFPOP) for constrained changepoint detection in genomic data. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1810.00117">arXiv:1810.00117</ext-link> (2018)</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hocking</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Rigaill</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Fearnhead</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bourque</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Constrained dynamic programming and supervised penalty learning algorithms for peak detection in genomic data</article-title>
        <source>J Mach Learn Res</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>1</fpage>
        <lpage>40</lpage>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Law CW, Chen Y, Shi W, Smyth GK. voom: precision weights unlock linear model analysis tools for rna-seq read counts. Genome Biol. 2014;15.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Love M, Huber W, Anders S. Moderated estimation of fold change and dispersion for rna-seq data with deseq2. Genome Biol. 2014;15.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marinov</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>A decade of chip-seq</article-title>
        <source>Brief Funct Genom</source>
        <year>2018</year>
        <volume>17</volume>
        <fpage>77</fpage>
        <lpage>79</lpage>
        <pub-id pub-id-type="doi">10.1093/bfgp/ely012</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rigaill</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hocking</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Vert</surname>
            <given-names>J-P</given-names>
          </name>
          <name>
            <surname>Bach</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Learning sparse penalties for change-point detection using max margin interval regression</article-title>
        <source>Proc Mach Learn Res</source>
        <year>2013</year>
        <volume>28</volume>
        <fpage>172</fpage>
        <lpage>180</lpage>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>edger: a bioconductor package for differential expression analysis of digital gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>139</fpage>
        <lpage>140</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Romano G, Rigaill G, Runge V, Fearnhead P. Detecting abrupt changes in the presence of local fluctuations and autocorrelated noise. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/2005.01379">arXiv:2005.01379</ext-link> (2020)</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Runge V, Hocking TD, Romano G, Afghah F, Fearnhead P, Rigaill G. gfpop: an R package for univariate graph-constrained change-point detection. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/2002.03646">arXiv:2002.03646</ext-link> (2020)</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Schmidt D, Wilson MD, Ballester B, Schwalie PC, Brown GD, Marshall A, Kutter C, Watt S, Martinez-Jimenez CP, Mackay S, Talianidis I, Flicek P, Odom DT. Five-vertebrate chip-seq reveals the evolutionary dynamics of transcription factor binding. Science. 2010;1036–1040.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sims</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Nishioka</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Reinberg</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Histone lysine methylation: a signature for chromatin function</article-title>
        <source>Trends Genet</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>629</fpage>
        <lpage>639</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tig.2003.09.007</pub-id>
        <pub-id pub-id-type="pmid">14585615</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Valouev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Sundquist</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Medina</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Anton</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Batzoglou</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Sidow</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide analysis of transcription factor binding sites based on chip-seq data</article-title>
        <source>Nat Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>829</fpage>
        <lpage>834</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1246</pub-id>
        <pub-id pub-id-type="pmid">19160518</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vinh</surname>
            <given-names>NX</given-names>
          </name>
          <name>
            <surname>Epps</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Information theoretic measures for clusterings comparison: variants, properties, normalization and correction for chance</article-title>
        <source>J Mach Learn Res</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>2837</fpage>
        <lpage>2854</lpage>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Young MD, Willson TA, Wakefield MJ, Trounson E, Hilton DJ, Blewitt ME, Oshlack A, Majewski IJ. Chip-seq analysis reveals distinct h3k27me3 profiles that correlate with transcriptional activity. Nucl Acids Res. 2011;7415–7427.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Xiang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Ming</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Kou</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Allelic reprogramming of the histone modification h3k4me3 in early mammalian development</article-title>
        <source>Nature</source>
        <year>2016</year>
        <volume>537</volume>
        <fpage>553</fpage>
        <lpage>557</lpage>
        <pub-id pub-id-type="doi">10.1038/nature19361</pub-id>
        <pub-id pub-id-type="pmid">27626382</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Zhang Y, Liu T, Meyer CA, Eeckhoute J, Johnson DS, Bernstein BE, Nusbaum C, Myers RM, Brown M, Li W, Liu XS. Model-based analysis of chip-seq (macs). Genome Biol. 2008;9.</mixed-citation>
    </ref>
  </ref-list>
</back>
