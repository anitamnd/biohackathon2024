<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2828112</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btq003</article-id>
    <article-id pub-id-type="publisher-id">btq003</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group>
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CD-HIT Suite: a web server for clustering and comparing biological sequences</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Huang</surname>
          <given-names>Ying</given-names>
        </name>
        <xref ref-type="author-notes" rid="FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Niu</surname>
          <given-names>Beifang</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gao</surname>
          <given-names>Ying</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fu</surname>
          <given-names>Limin</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Weizhong</given-names>
        </name>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff>California Institute for Telecommunications and Information Technology, University of California San Diego, La Jolla, CA, USA</aff>
    <author-notes>
      <corresp id="COR1">* To whom correspondence should be addressed.</corresp>
      <fn id="FN1">
        <p><sup>†</sup> Present address: Department of Medicine, University of California San Diego, La Jolla, CA, USA.</p>
      </fn>
      <fn>
        <p>Associate Editor: Burkhard Rost</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>1</day>
      <month>3</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>6</day>
      <month>1</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>6</day>
      <month>1</month>
      <year>2010</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>26</volume>
    <issue>5</issue>
    <fpage>680</fpage>
    <lpage>682</lpage>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>9</month>
        <year>2009</year>
      </date>
      <date date-type="rev-recd">
        <day>7</day>
        <month>12</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>2</day>
        <month>1</month>
        <year>2010</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2010. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2010</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">http://creativecommons.org/licenses/by-nc/2.5</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> CD-HIT is a widely used program for clustering and comparing large biological sequence datasets. In order to further assist the CD-HIT users, we significantly improved this program with more functions and better accuracy, scalability and flexibility. Most importantly, we developed a new web server, CD-HIT Suite, for clustering a user-uploaded sequence dataset or comparing it to another dataset at different identity levels. Users can now interactively explore the clusters within web browsers. We also provide downloadable clusters for several public databases (NCBI NR, Swissprot and PDB) at different identity levels.</p>
      <p><bold>Availability:</bold> Free access at <ext-link ext-link-type="uri" xlink:href="http://cd-hit.org">http://cd-hit.org</ext-link></p>
      <p>
        <bold>Contact:</bold>
        <email>liwz@sdsc.edu</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq003/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>The size of the biological sequence databases is rapidly growing due to large-scale genome projects and the emerging field of metagenomics (Yooseph <italic>et al.</italic>, <xref ref-type="bibr" rid="B8">2007</xref>). New sequencing technologies are now producing sequence data at a very high rate, and this has created a greater need for bioinformatics tools to effectively organize and analyze the data. Fortunately, biological sequences are related and may share homology, and thus clustering these sequences into groups and finding a representative or a consensus for each group are practical ways to solve the sequence analysis problems.</p>
    <p>Our previous works (Li and Godzik, <xref ref-type="bibr" rid="B2">2006</xref>; Li <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2001</xref>; Li <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2002</xref>) introduced CD-HIT based on short word filtering and a greedy incremental clustering algorithm to cluster and compare large biological sequence datasets. One advantage of CD-HIT is its ultrahigh speed and the ability to handle large datasets. Since its release, CD-HIT has been widely used by many groups in various fields, including UniRef (Suzek <italic>et al.</italic>, <xref ref-type="bibr" rid="B6">2007</xref>), SMART (Letunic <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">2009</xref>) and metagenome data analyses (Turnbaugh <italic>et al.</italic>, <xref ref-type="bibr" rid="B7">2009</xref>; Yooseph <italic>et al.</italic>, <xref ref-type="bibr" rid="B9">2008</xref>).</p>
    <p>In the last few years, we have been continuously improving this program with more functions and better accuracy, scalability and flexibility. We also implemented a new web server to allow users to cluster or compare sequences without installing and executing the command-line version of CD-HIT locally. The server provides interactive interface and additional visualization tools. It also provides precalculated and regularly updated sequence clusters for several widely used databases, including NCBI NR, Swissprot and PDB.</p>
  </sec>
  <sec id="SEC2">
    <title>2 METHODS AND IMPLEMENTATION</title>
    <p>The detailed algorithms and benchmark results for CD-HIT can be found from our previous works (Li and Godzik, <xref ref-type="bibr" rid="B2">2006</xref>; Li <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2001</xref>; Li <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2002</xref>). Here, we highlight the novel features and functions.</p>
    <sec id="SEC2.1">
      <title>2.1 Improved clustering algorithm</title>
      <p>The original CD-HIT uses a fast greedy incremental clustering process. Briefly, sequences are first sorted by decreasing length. The longest one becomes the representative of the first cluster. Then, each remaining sequence is compared with the existing representatives. If the identity with any representative is above a given threshold, it is grouped into that cluster without comparing it to other representatives. Otherwise, it becomes the representative of a new cluster. In the updated CD-HIT, we added a refined greedy incremental clustering process that produces more accurate clusters. In this process, a sequence is grouped into the most similar cluster instead of the first similar cluster. The refined process does not change the representative sequences.</p>
      <p>CD-HIT uses a short word filter to avoid unnecessary alignments. In short, the minimum number of identical short words (<italic>k</italic>-mers) shared by two sequences depends on their sequence identity and can be calculated analytically or statistically. Without an actual alignment, we can still determine that the identity of two sequences is below a given threshold by counting short words. A short word filter performs much better with a higher identity threshold. Clustering in the refined process is implemented with a dynamic short word filter. For each sequence to be clustered, the initial filter matches the user-defined identity threshold. But during the clustering procedure, if this sequence hits any cluster with better identity, the filter is reset to match this better identity to increase the performance of the filter. With the dynamic short word filter, although the refined clustering process needs to evaluate the similarities of a sequence and all the existing representatives, it only requires about 1.5–3× CPU time of the original process.</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Improved clustering control</title>
      <p>The original CD-HIT uses global sequence identities. The improved CD-HIT also works with local identities. Users can finely control the clustering behavior by including more criteria besides sequence identity cutoffs. We include alignment length, unaligned length and alignment coverage for both aligned sequences as new clustering parameters into the current CD-HIT. For example, users can make clusters of sequences of similar length by specifying that the alignments must cover both sequences at similar coverage.</p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 Clustering at low identity thresholds</title>
      <p>The performance of the native short word filter drops significantly with a lower identity threshold; therefore, the original CD-HIT does not provide protein clustering under 40% identity. However, clustering at low identities has been frequently requested by CD-HIT users. We implemented a script, called PSI-CD-HIT, to perform protein sequence clustering at a low identity threshold such as 30%. It uses the similar greedy incremental clustering strategy, but it uses BLAST to calculate the similarities. So users can also specify an expect-value cutoff. PSI-CD-HIT runs on a stand-alone computer or a LINUX cluster. It can cluster a PDB-sized dataset in ∼20 min.</p>
    </sec>
    <sec id="SEC2.4">
      <title>2.4 Hierarchical clustering</title>
      <p>In the hierarchical clustering process, the program first performs clustering on the original input dataset at a high identity threshold, and the representatives of each previous clustering step will be the input of the following clustering run at a lower identity threshold. The whole process iteratively joins the similar sequences into families and therefore produces a hierarchical structure. For protein sequences, the last step is performed with PSI-CD-HIT if the final identity threshold is &lt;40%. This strategy can maximize the computational efficiency and the quality of clustering. We have applied such strategy in a protein family analysis of a large metagenomic dataset with 17 million sequences (Li <italic>et al.</italic>, <xref ref-type="bibr" rid="B5">2008</xref>).</p>
    </sec>
    <sec id="SEC2.5">
      <title>2.5 Annotation enrichment of sequence cluster</title>
      <p>We provide an option for joint analysis of sequence clustering and annotation information. Users can place annotation terms (Gene Ontology, protein family, etc.) in the definition lines of input FASTA files. For each annotation term A and each cluster C, we use the following numbers:
<disp-quote><p>N<sub><italic>AC</italic></sub> = number of sequences with A in C;</p><p>    N<sub><italic>C</italic></sub> = number of sequences in C;</p><p>N<sub><italic>AI</italic></sub> = number of sequences with A in the input;</p><p>    N<sub><italic>I</italic></sub> = number of the input sequences.</p></disp-quote>
</p>
      <p>A <italic>P</italic>-value is calculated using the one-tailed Fisher's exact test to assess whether N<sub><italic>AC</italic></sub>/N<sub><italic>C</italic></sub> &gt; N<sub><italic>AI</italic></sub>/N<sub><italic>I</italic></sub> and annotation term A is enriched in cluster C. Such functionality is very useful to check the cluster quality at different identity levels and also for function assignment of proteins with unknown function.</p>
    </sec>
    <sec id="SEC2.6">
      <title>2.6 Web server</title>
      <p>All basic functions of CD-HIT are provided through tab-based interfaces in our web server. We provided CD-HIT (CD-HIT-EST) to cluster a protein (DNA/RNA) dataset. Users can upload a FASTA file and select a desired sequence identity level and other parameters. CD-HIT-2D (CD-HIT-EST-2D) can compare two databases uploaded by users. H-CD-HIT and H-CD-HIT-EST in our server performs hierarchical clustering up to three steps.</p>
      <p>After submitting a clustering or comparison job, a unique identifier will be assigned. A user can use the identifier to track the status of the job. After the job is finished, we provide the raw outputs generated by the command-line CD-HIT. Additionally, we provide tools to visualize the clustering results with cluster explorer and cluster distribution plots. Cluster explorer uses a tree structure to represent the clustering results <xref ref-type="fig" rid="F1">Figure 1</xref>a. Each cluster is represented by a clickable text object on the web page, and users can click on a representative sequence to retrieve information of the sequences belong to the cluster. This option is most useful for investigating the results from hierarchical clustering. In this situation, each sequence could be a representative sequence from the previous clustering step, and users can click it to explore the results from the previous clustering. Cluster distribution plots are scatter plots where the <italic>X</italic>-axis is the cluster size (number of sequences in a cluster), and then the <italic>Y</italic>-axis represents the number of clusters of at least this size and the number of corresponding sequences <xref ref-type="fig" rid="F1">Figure 1</xref>b. This tool is very useful to observe the global structure of a sequence database.
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Screenshots of CD-HIT Suite. (<bold>a</bold>) Cluster Explorer for investigating clusters. (<bold>b</bold>) A cluster distribution plot to explore the global structure of a whole dataset.</p></caption><graphic xlink:href="btq003f1"/></fig>
</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="SEC3">
    <title>3 CONCLUSION</title>
    <p>CD-HIT has been significantly improved from our previous work. CD-HIT Suite provides users with a friendly web interface to perform biological sequence clustering and comparison with additional visualization tools. It also provides precalculated clusters for several public sequence databases which are regularly updated.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We thank Mr Michael Chiu for his excellent editorial assistance.</p>
    <p><italic>Funding</italic>: <funding-source>National Institutes of Health</funding-source> (<award-id>1R01RR025030</award-id>) from National Center for Research Resources.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Letunic</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SMART 6: recent updates and new developments</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2009</year>
        <volume>37</volume>
        <fpage>D229</fpage>
        <lpage>D232</lpage>
        <pub-id pub-id-type="pmid">18978020</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Godzik</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Cd-hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>1658</fpage>
        <lpage>1659</lpage>
        <pub-id pub-id-type="pmid">16731699</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Clustering of highly homologous sequences to reduce the size of large protein databases</article-title>
        <source>Bioinformatics</source>
        <year>2001</year>
        <volume>17</volume>
        <fpage>282</fpage>
        <lpage>283</lpage>
        <pub-id pub-id-type="pmid">11294794</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tolerating some redundancy significantly speeds up clustering of large protein databases</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <fpage>77</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="pmid">11836214</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Probing metagenomics by rapid cluster analysis of very large datasets</article-title>
        <source>PLoS ONE</source>
        <year>2008</year>
        <volume>3</volume>
        <fpage>e3375</fpage>
        <pub-id pub-id-type="pmid">18846219</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Suzek</surname>
            <given-names>BE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>UniRef: comprehensive and non-redundant UniProt reference clusters</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>1282</fpage>
        <lpage>1288</lpage>
        <pub-id pub-id-type="pmid">17379688</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Turnbaugh</surname>
            <given-names>PJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A core gut microbiome in obese and lean twins</article-title>
        <source>Nature</source>
        <year>2009</year>
        <volume>457</volume>
        <fpage>480</fpage>
        <lpage>484</lpage>
        <pub-id pub-id-type="pmid">19043404</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yooseph</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Sorcerer II global ocean sampling expedition: expanding the universe of protein families</article-title>
        <source>PLoS Biol.</source>
        <year>2007</year>
        <volume>5</volume>
        <fpage>e16</fpage>
        <pub-id pub-id-type="pmid">17355171</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yooseph</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene identification and protein classification in microbial metametagenomic sequence data via incremental clustering</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>182</fpage>
        <pub-id pub-id-type="pmid">18402669</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2828112</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btq003</article-id>
    <article-id pub-id-type="publisher-id">btq003</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group>
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CD-HIT Suite: a web server for clustering and comparing biological sequences</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Huang</surname>
          <given-names>Ying</given-names>
        </name>
        <xref ref-type="author-notes" rid="FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Niu</surname>
          <given-names>Beifang</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gao</surname>
          <given-names>Ying</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fu</surname>
          <given-names>Limin</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Weizhong</given-names>
        </name>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff>California Institute for Telecommunications and Information Technology, University of California San Diego, La Jolla, CA, USA</aff>
    <author-notes>
      <corresp id="COR1">* To whom correspondence should be addressed.</corresp>
      <fn id="FN1">
        <p><sup>†</sup> Present address: Department of Medicine, University of California San Diego, La Jolla, CA, USA.</p>
      </fn>
      <fn>
        <p>Associate Editor: Burkhard Rost</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>1</day>
      <month>3</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>6</day>
      <month>1</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>6</day>
      <month>1</month>
      <year>2010</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>26</volume>
    <issue>5</issue>
    <fpage>680</fpage>
    <lpage>682</lpage>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>9</month>
        <year>2009</year>
      </date>
      <date date-type="rev-recd">
        <day>7</day>
        <month>12</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>2</day>
        <month>1</month>
        <year>2010</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2010. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2010</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">http://creativecommons.org/licenses/by-nc/2.5</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> CD-HIT is a widely used program for clustering and comparing large biological sequence datasets. In order to further assist the CD-HIT users, we significantly improved this program with more functions and better accuracy, scalability and flexibility. Most importantly, we developed a new web server, CD-HIT Suite, for clustering a user-uploaded sequence dataset or comparing it to another dataset at different identity levels. Users can now interactively explore the clusters within web browsers. We also provide downloadable clusters for several public databases (NCBI NR, Swissprot and PDB) at different identity levels.</p>
      <p><bold>Availability:</bold> Free access at <ext-link ext-link-type="uri" xlink:href="http://cd-hit.org">http://cd-hit.org</ext-link></p>
      <p>
        <bold>Contact:</bold>
        <email>liwz@sdsc.edu</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq003/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>The size of the biological sequence databases is rapidly growing due to large-scale genome projects and the emerging field of metagenomics (Yooseph <italic>et al.</italic>, <xref ref-type="bibr" rid="B8">2007</xref>). New sequencing technologies are now producing sequence data at a very high rate, and this has created a greater need for bioinformatics tools to effectively organize and analyze the data. Fortunately, biological sequences are related and may share homology, and thus clustering these sequences into groups and finding a representative or a consensus for each group are practical ways to solve the sequence analysis problems.</p>
    <p>Our previous works (Li and Godzik, <xref ref-type="bibr" rid="B2">2006</xref>; Li <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2001</xref>; Li <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2002</xref>) introduced CD-HIT based on short word filtering and a greedy incremental clustering algorithm to cluster and compare large biological sequence datasets. One advantage of CD-HIT is its ultrahigh speed and the ability to handle large datasets. Since its release, CD-HIT has been widely used by many groups in various fields, including UniRef (Suzek <italic>et al.</italic>, <xref ref-type="bibr" rid="B6">2007</xref>), SMART (Letunic <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">2009</xref>) and metagenome data analyses (Turnbaugh <italic>et al.</italic>, <xref ref-type="bibr" rid="B7">2009</xref>; Yooseph <italic>et al.</italic>, <xref ref-type="bibr" rid="B9">2008</xref>).</p>
    <p>In the last few years, we have been continuously improving this program with more functions and better accuracy, scalability and flexibility. We also implemented a new web server to allow users to cluster or compare sequences without installing and executing the command-line version of CD-HIT locally. The server provides interactive interface and additional visualization tools. It also provides precalculated and regularly updated sequence clusters for several widely used databases, including NCBI NR, Swissprot and PDB.</p>
  </sec>
  <sec id="SEC2">
    <title>2 METHODS AND IMPLEMENTATION</title>
    <p>The detailed algorithms and benchmark results for CD-HIT can be found from our previous works (Li and Godzik, <xref ref-type="bibr" rid="B2">2006</xref>; Li <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2001</xref>; Li <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2002</xref>). Here, we highlight the novel features and functions.</p>
    <sec id="SEC2.1">
      <title>2.1 Improved clustering algorithm</title>
      <p>The original CD-HIT uses a fast greedy incremental clustering process. Briefly, sequences are first sorted by decreasing length. The longest one becomes the representative of the first cluster. Then, each remaining sequence is compared with the existing representatives. If the identity with any representative is above a given threshold, it is grouped into that cluster without comparing it to other representatives. Otherwise, it becomes the representative of a new cluster. In the updated CD-HIT, we added a refined greedy incremental clustering process that produces more accurate clusters. In this process, a sequence is grouped into the most similar cluster instead of the first similar cluster. The refined process does not change the representative sequences.</p>
      <p>CD-HIT uses a short word filter to avoid unnecessary alignments. In short, the minimum number of identical short words (<italic>k</italic>-mers) shared by two sequences depends on their sequence identity and can be calculated analytically or statistically. Without an actual alignment, we can still determine that the identity of two sequences is below a given threshold by counting short words. A short word filter performs much better with a higher identity threshold. Clustering in the refined process is implemented with a dynamic short word filter. For each sequence to be clustered, the initial filter matches the user-defined identity threshold. But during the clustering procedure, if this sequence hits any cluster with better identity, the filter is reset to match this better identity to increase the performance of the filter. With the dynamic short word filter, although the refined clustering process needs to evaluate the similarities of a sequence and all the existing representatives, it only requires about 1.5–3× CPU time of the original process.</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Improved clustering control</title>
      <p>The original CD-HIT uses global sequence identities. The improved CD-HIT also works with local identities. Users can finely control the clustering behavior by including more criteria besides sequence identity cutoffs. We include alignment length, unaligned length and alignment coverage for both aligned sequences as new clustering parameters into the current CD-HIT. For example, users can make clusters of sequences of similar length by specifying that the alignments must cover both sequences at similar coverage.</p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 Clustering at low identity thresholds</title>
      <p>The performance of the native short word filter drops significantly with a lower identity threshold; therefore, the original CD-HIT does not provide protein clustering under 40% identity. However, clustering at low identities has been frequently requested by CD-HIT users. We implemented a script, called PSI-CD-HIT, to perform protein sequence clustering at a low identity threshold such as 30%. It uses the similar greedy incremental clustering strategy, but it uses BLAST to calculate the similarities. So users can also specify an expect-value cutoff. PSI-CD-HIT runs on a stand-alone computer or a LINUX cluster. It can cluster a PDB-sized dataset in ∼20 min.</p>
    </sec>
    <sec id="SEC2.4">
      <title>2.4 Hierarchical clustering</title>
      <p>In the hierarchical clustering process, the program first performs clustering on the original input dataset at a high identity threshold, and the representatives of each previous clustering step will be the input of the following clustering run at a lower identity threshold. The whole process iteratively joins the similar sequences into families and therefore produces a hierarchical structure. For protein sequences, the last step is performed with PSI-CD-HIT if the final identity threshold is &lt;40%. This strategy can maximize the computational efficiency and the quality of clustering. We have applied such strategy in a protein family analysis of a large metagenomic dataset with 17 million sequences (Li <italic>et al.</italic>, <xref ref-type="bibr" rid="B5">2008</xref>).</p>
    </sec>
    <sec id="SEC2.5">
      <title>2.5 Annotation enrichment of sequence cluster</title>
      <p>We provide an option for joint analysis of sequence clustering and annotation information. Users can place annotation terms (Gene Ontology, protein family, etc.) in the definition lines of input FASTA files. For each annotation term A and each cluster C, we use the following numbers:
<disp-quote><p>N<sub><italic>AC</italic></sub> = number of sequences with A in C;</p><p>    N<sub><italic>C</italic></sub> = number of sequences in C;</p><p>N<sub><italic>AI</italic></sub> = number of sequences with A in the input;</p><p>    N<sub><italic>I</italic></sub> = number of the input sequences.</p></disp-quote>
</p>
      <p>A <italic>P</italic>-value is calculated using the one-tailed Fisher's exact test to assess whether N<sub><italic>AC</italic></sub>/N<sub><italic>C</italic></sub> &gt; N<sub><italic>AI</italic></sub>/N<sub><italic>I</italic></sub> and annotation term A is enriched in cluster C. Such functionality is very useful to check the cluster quality at different identity levels and also for function assignment of proteins with unknown function.</p>
    </sec>
    <sec id="SEC2.6">
      <title>2.6 Web server</title>
      <p>All basic functions of CD-HIT are provided through tab-based interfaces in our web server. We provided CD-HIT (CD-HIT-EST) to cluster a protein (DNA/RNA) dataset. Users can upload a FASTA file and select a desired sequence identity level and other parameters. CD-HIT-2D (CD-HIT-EST-2D) can compare two databases uploaded by users. H-CD-HIT and H-CD-HIT-EST in our server performs hierarchical clustering up to three steps.</p>
      <p>After submitting a clustering or comparison job, a unique identifier will be assigned. A user can use the identifier to track the status of the job. After the job is finished, we provide the raw outputs generated by the command-line CD-HIT. Additionally, we provide tools to visualize the clustering results with cluster explorer and cluster distribution plots. Cluster explorer uses a tree structure to represent the clustering results <xref ref-type="fig" rid="F1">Figure 1</xref>a. Each cluster is represented by a clickable text object on the web page, and users can click on a representative sequence to retrieve information of the sequences belong to the cluster. This option is most useful for investigating the results from hierarchical clustering. In this situation, each sequence could be a representative sequence from the previous clustering step, and users can click it to explore the results from the previous clustering. Cluster distribution plots are scatter plots where the <italic>X</italic>-axis is the cluster size (number of sequences in a cluster), and then the <italic>Y</italic>-axis represents the number of clusters of at least this size and the number of corresponding sequences <xref ref-type="fig" rid="F1">Figure 1</xref>b. This tool is very useful to observe the global structure of a sequence database.
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Screenshots of CD-HIT Suite. (<bold>a</bold>) Cluster Explorer for investigating clusters. (<bold>b</bold>) A cluster distribution plot to explore the global structure of a whole dataset.</p></caption><graphic xlink:href="btq003f1"/></fig>
</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="SEC3">
    <title>3 CONCLUSION</title>
    <p>CD-HIT has been significantly improved from our previous work. CD-HIT Suite provides users with a friendly web interface to perform biological sequence clustering and comparison with additional visualization tools. It also provides precalculated clusters for several public sequence databases which are regularly updated.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We thank Mr Michael Chiu for his excellent editorial assistance.</p>
    <p><italic>Funding</italic>: <funding-source>National Institutes of Health</funding-source> (<award-id>1R01RR025030</award-id>) from National Center for Research Resources.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Letunic</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SMART 6: recent updates and new developments</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2009</year>
        <volume>37</volume>
        <fpage>D229</fpage>
        <lpage>D232</lpage>
        <pub-id pub-id-type="pmid">18978020</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Godzik</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Cd-hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>1658</fpage>
        <lpage>1659</lpage>
        <pub-id pub-id-type="pmid">16731699</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Clustering of highly homologous sequences to reduce the size of large protein databases</article-title>
        <source>Bioinformatics</source>
        <year>2001</year>
        <volume>17</volume>
        <fpage>282</fpage>
        <lpage>283</lpage>
        <pub-id pub-id-type="pmid">11294794</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tolerating some redundancy significantly speeds up clustering of large protein databases</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <fpage>77</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="pmid">11836214</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Probing metagenomics by rapid cluster analysis of very large datasets</article-title>
        <source>PLoS ONE</source>
        <year>2008</year>
        <volume>3</volume>
        <fpage>e3375</fpage>
        <pub-id pub-id-type="pmid">18846219</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Suzek</surname>
            <given-names>BE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>UniRef: comprehensive and non-redundant UniProt reference clusters</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>1282</fpage>
        <lpage>1288</lpage>
        <pub-id pub-id-type="pmid">17379688</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Turnbaugh</surname>
            <given-names>PJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A core gut microbiome in obese and lean twins</article-title>
        <source>Nature</source>
        <year>2009</year>
        <volume>457</volume>
        <fpage>480</fpage>
        <lpage>484</lpage>
        <pub-id pub-id-type="pmid">19043404</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yooseph</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Sorcerer II global ocean sampling expedition: expanding the universe of protein families</article-title>
        <source>PLoS Biol.</source>
        <year>2007</year>
        <volume>5</volume>
        <fpage>e16</fpage>
        <pub-id pub-id-type="pmid">17355171</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yooseph</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene identification and protein classification in microbial metametagenomic sequence data via incremental clustering</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>182</fpage>
        <pub-id pub-id-type="pmid">18402669</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
