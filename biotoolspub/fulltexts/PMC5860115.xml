<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5860115</article-id>
    <article-id pub-id-type="pmid">28369165</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btx166</article-id>
    <article-id pub-id-type="publisher-id">btx166</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genetics and Population Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>biMM: efficient estimation of genetic variances and covariances for cohorts with high-dimensional phenotype measurements</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Pirinen</surname>
          <given-names>Matti</given-names>
        </name>
        <xref ref-type="aff" rid="btx166-aff1">1</xref>
        <xref ref-type="aff" rid="btx166-aff2">2</xref>
        <xref ref-type="aff" rid="btx166-aff3">3</xref>
        <xref ref-type="corresp" rid="btx166-cor1"/>
        <!--<email>matti.pirinen@helsinki.fi</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Benner</surname>
          <given-names>Christian</given-names>
        </name>
        <xref ref-type="aff" rid="btx166-aff1">1</xref>
        <xref ref-type="aff" rid="btx166-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Marttinen</surname>
          <given-names>Pekka</given-names>
        </name>
        <xref ref-type="aff" rid="btx166-aff2">2</xref>
        <xref ref-type="aff" rid="btx166-aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Järvelin</surname>
          <given-names>Marjo-Riitta</given-names>
        </name>
        <xref ref-type="aff" rid="btx166-aff5">5</xref>
        <xref ref-type="aff" rid="btx166-aff6">6</xref>
        <xref ref-type="aff" rid="btx166-aff7">7</xref>
        <xref ref-type="aff" rid="btx166-aff8">8</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rivas</surname>
          <given-names>Manuel A</given-names>
        </name>
        <xref ref-type="aff" rid="btx166-aff9">9</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ripatti</surname>
          <given-names>Samuli</given-names>
        </name>
        <xref ref-type="aff" rid="btx166-aff1">1</xref>
        <xref ref-type="aff" rid="btx166-aff3">3</xref>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Stegle</surname>
          <given-names>Oliver</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btx166-aff1"><label>1</label>Institute for Molecular Medicine Finland (FIMM), University of Helsinki, Helsinki, Finland</aff>
    <aff id="btx166-aff2"><label>2</label>Helsinki Institute for Information Technology HIIT and Department of Mathematics and Statistics, University of Helsinki, Helsinki, Finland</aff>
    <aff id="btx166-aff3"><label>3</label>Department of Public Health, University of Helsinki, Helsinki, Finland</aff>
    <aff id="btx166-aff4"><label>4</label>Helsinki Institute for Information Technology HIIT and Department of Computer Science, Aalto University, Espoo, Finland</aff>
    <aff id="btx166-aff5"><label>5</label>Biocenter Oulu, University of Oulu, Oulu, Finland</aff>
    <aff id="btx166-aff6"><label>6</label>Department of Epidemiology and Biostatistics, MRC-PHE Centre for Environment and Health, School of Public Health, Imperial College London, London, UK</aff>
    <aff id="btx166-aff7"><label>7</label>Center for Life Course and Systems Epidemiology, Faculty of Medicine, University of Oulu, Oulu, Finland</aff>
    <aff id="btx166-aff8"><label>8</label>Unit of Primary Care, Oulu University Hospital, Oulu, Finland</aff>
    <aff id="btx166-aff9"><label>9</label>Department of Biomedical Data Science, Stanford University, Stanford, CA, USA</aff>
    <author-notes>
      <corresp id="btx166-cor1">To whom correspondence should be addressed. Email: <email>matti.pirinen@helsinki.fi</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>8</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-03-28">
      <day>28</day>
      <month>3</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>3</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>33</volume>
    <issue>15</issue>
    <fpage>2405</fpage>
    <lpage>2407</lpage>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>11</month>
        <year>2016</year>
      </date>
      <date date-type="rev-recd">
        <day>18</day>
        <month>2</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>3</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btx166.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="SA1">
        <title>Summary</title>
        <p>Genetic research utilizes a decomposition of trait variances and covariances into genetic and environmental parts. Our software package biMM is a computationally efficient implementation of a bivariate linear mixed model for settings where hundreds of traits have been measured on partially overlapping sets of individuals.</p>
      </sec>
      <sec id="SA2">
        <title>Availability and Implementation</title>
        <p>Implementation in R freely available at <ext-link ext-link-type="uri" xlink:href="http://www.iki.fi/mpirinen">www.iki.fi/mpirinen</ext-link>.</p>
      </sec>
      <sec id="SA3">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Academy of Finland</named-content>
          <named-content content-type="funder-identifier">10.13039/501100002341</named-content>
        </funding-source>
        <award-id>257654</award-id>
        <award-id>288509</award-id>
        <award-id>286607</award-id>
        <award-id>294015</award-id>
        <award-id>251217</award-id>
        <award-id>255847</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Finnish Foundation for Cardiovascular Research</named-content>
          <named-content content-type="funder-identifier">10.13039/501100005633</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">University of Oulu</named-content>
          <named-content content-type="funder-identifier">10.13039/501100006196</named-content>
        </funding-source>
        <award-id>65354</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Ministry of Health and Social Affairs</named-content>
          <named-content content-type="funder-identifier">10.13039/501100005348</named-content>
        </funding-source>
        <award-id>23/251/97</award-id>
        <award-id>160/97</award-id>
        <award-id>190/97</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Decomposing phenotypic variance and covariance into genetic and environmental parts is important for designing genetic studies and understanding relationships between traits and diseases. The two main approaches are linear mixed model (LMM) implementations, such as GCTA (<xref rid="btx166-B9" ref-type="bibr">Yang <italic>et al.</italic>, 2011</xref>), GEMMA (<xref rid="btx166-B11" ref-type="bibr">Zhou and Stephens, 2014</xref>) or BOLT-REML (<xref rid="btx166-B5" ref-type="bibr">Loh <italic>et al.</italic>, 2015</xref>) and LD-score regression, implemented in LDSC (<xref rid="btx166-B1" ref-type="bibr">Bulik-Sullivan <italic>et al.</italic>, 2015</xref>). LMM requires access to the individual-level genotype-phenotype data whereas LDSC only needs output from a genome-wide association study (GWAS) and variant correlations from a reference database, but consequently may be less precise than LMM (<xref rid="btx166-B1" ref-type="bibr">Bulik-Sullivan <italic>et al.</italic>, 2015</xref>).</p>
    <p>We consider settings where individual-level data are available, and hence use LMM. The bivariate LMM for <italic>n</italic> individuals is <inline-formula id="IE1"><mml:math id="IEQ1"><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE2"><mml:math id="IEQ2"><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mn>2</mml:mn><mml:mi>T</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> is 2<italic>n</italic>-vector of mean-centered phenotype values from which the covariates, such as age, sex and principal components of population structure have been regressed out, <inline-formula id="IE3"><mml:math id="IEQ3"><mml:mrow><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mo mathvariant="bold">Σ</mml:mo><mml:mi>G</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is 2<italic>n</italic>-vector of genetic random effects and <inline-formula id="IE4"><mml:math id="IEQ4"><mml:mrow><mml:mo>ε</mml:mo><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mo mathvariant="bold">Σ</mml:mo><mml:mo>ε</mml:mo></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is 2<italic>n</italic>-vector of environmental random effects. The <inline-formula id="IE5"><mml:math id="IEQ5"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> covariance structures are parameterized by six scalars: genetic variances <inline-formula id="IE6"><mml:math id="IEQ6"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE7"><mml:math id="IEQ7"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, genetic covariance <inline-formula id="IE8"><mml:math id="IEQ8"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, environmental variances <inline-formula id="IE9"><mml:math id="IEQ9"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mo>ε</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE10"><mml:math id="IEQ10"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mo>ε</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and environmental covariance <inline-formula id="IE11"><mml:math id="IEQ11"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mo>ε</mml:mo><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> as
<disp-formula id="E1"><mml:math id="EQ1"><mml:mrow><mml:msub><mml:mo>Σ</mml:mo><mml:mi>G</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mtable rowlines="solid" columnlines="solid"><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:msub><mml:mo>Σ</mml:mo><mml:mo>ε</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mtable rowlines="solid" columnlines="solid"><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mo>ε</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mo>ε</mml:mo><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mo>ε</mml:mo><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mo>ε</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
expressed as <italic>n </italic>×<italic> n</italic> block matrices. <inline-formula id="IE12"><mml:math id="IEQ12"><mml:mi mathvariant="bold-italic">I</mml:mi></mml:math></inline-formula> is the identity matrix and the element <italic>i</italic>, <italic>j</italic> of the genetic relationship matrix (GRM) <inline-formula id="IE13"><mml:math id="IEQ13"><mml:mi mathvariant="bold-italic">R</mml:mi></mml:math></inline-formula> is
<disp-formula id="E2"><mml:math id="EQ2"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">R</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mo>α</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>g<sub>ik</sub></italic> is the genotype of individual <italic>i</italic> at variant <italic>k</italic>, coded as 0, 1 or 2 copies of the minor allele and <inline-formula id="IE14"><mml:math id="IEQ14"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is the minor allele frequency (MAF). We use the standard scaling of allelic effects determined by <inline-formula id="IE15"><mml:math id="IEQ15"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
    <p>From this model, an estimate of <italic>V<sub>Gt</sub></italic> approximates additive genetic variance of each trait (<italic>t</italic> = 1, 2) explained by the variants included in the calculation of <inline-formula id="IE16"><mml:math id="IEQ16"><mml:mi mathvariant="bold-italic">R</mml:mi></mml:math></inline-formula> and is often used as a lower bound for the (narrow-sense) heritability (detailed assumptions in <xref rid="btx166-B10" ref-type="bibr">Yang <italic>et al.</italic>, 2015</xref>). An estimate of the genetic correlation <inline-formula id="IE17"><mml:math id="IEQ17"><mml:mrow><mml:msub><mml:mo>ρ</mml:mo><mml:mi>G</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula> measures (average) correlation of the allelic effects of the variants on the two traits. Similarly, we can estimate <inline-formula id="IE18"><mml:math id="IEQ18"><mml:mrow><mml:msub><mml:mo>ρ</mml:mo><mml:mo>ε</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mo>ε</mml:mo><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mo>ε</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mo>ε</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>, the correlation in the environmental components between the traits.</p>
    <p>The existing bivariate LMM implementations have not been designed for a case where hundreds of traits have been measured on 10 000s of individuals. Our software package biMM combines a fast likelihood computation (similar in speed to GEMMA) with an algorithm that optimizes the sample overlap between consecutive pairs of traits analyzed and therefore efficiently reuses the computationally expensive matrix decompositions. biMM allows user to control how much missing data are tolerated for a single analysis and automatically executes both phenotype imputation and matrix decompositions required to achieve that tolerance.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Reusing eigendecomposition</title>
      <p>Once an eigendecomposition of <inline-formula id="IE19"><mml:math id="IEQ19"><mml:mi mathvariant="bold-italic">R</mml:mi></mml:math></inline-formula> is available, our biMM algorithm drops the time complexity from cubic to quadratic for a trait pair and from cubic to linear for a single evaluation of the likelihood function (<xref ref-type="supplementary-material" rid="sup1">Supplementary Information</xref>). Similar time complexity is achieved by GEMMA, and efficient algorithms for multivariate LMM have recently been considered also by <xref rid="btx166-B3" ref-type="bibr">Furlotte and Eskin (2015)</xref> and <xref rid="btx166-B2" ref-type="bibr">Casale <italic>et al.</italic> (2015)</xref>. Our central observation is that a complete sample overlap between two trait pairs means that the same eigendecomposition can be used for both pairs. To fully utilize this observation, we need to keep the eigendecomposition in random access memory (RAM) across the trait pairs and we need to optimize the order of the trait pairs. To our knowledge, neither of these functionalities is available in existing software.</p>
    </sec>
    <sec>
      <title>2.2 Ordering pairs, imputing and dropping values</title>
      <p>We order the trait pairs in such a way that the consecutive pairs have a large sample overlap. biMM further allows imputing at most <italic>t<sub>i</sub></italic> missing values and/or dropping at most <italic>t<sub>d</sub></italic> non-missing values for a trait pair to make it match the available eigendecomposition (<xref ref-type="supplementary-material" rid="sup1">Supplementary Information</xref>). Only when this is not possible for any remaining pair does biMM a new eigendecomposition. Algorithmically, given user-specified <italic>t<sub>i</sub></italic> and <italic>t<sub>d</sub></italic>, biMM finds an ordering that results in a small number of total eigendecompositions. This is an instance of the shortest Hamiltonian path problem that we tackle by a greedy heuristic (<xref ref-type="supplementary-material" rid="sup1">Supplementary Information</xref>).</p>
    </sec>
    <sec>
      <title>2.3 Example analyses</title>
      <p>We consider data from the Northern Finland Birth Cohort 1966 (NFBC1966) (<xref rid="btx166-B6" ref-type="bibr">Rantakallio <italic>et al.</italic>, 1969</xref>) with 16 traits having sample sizes between 4736 and 5025 individuals (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>) and preprocessed by <xref rid="btx166-B8" ref-type="bibr">Tukiainen <italic>et al.</italic> (2014)</xref>. We analyzed all 120 pairs of traits using both the complete (<inline-formula id="IE20"><mml:math id="IEQ20"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) and an approximate versions (<inline-formula id="IE21"><mml:math id="IEQ21"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math></inline-formula>) of biMM and compared with GCTA 1.25.3, GEMMA 0.94.1 and BOLT-REML 2.2 with their default parameters. biMM ran in R-3.3.1 with Intel Math Kernel Library.</p>
      <p>To assess scaling to larger datasets, we consider 20 000 individuals simulated by HapGen2 (<xref rid="btx166-B7" ref-type="bibr">Su <italic>et al.</italic>, 2011</xref>) using chromosome 2 of the CEU panel from HapMap3 (<xref rid="btx166-B4" ref-type="bibr">International HapMap3 consortium., 2010</xref>) with phenotypes generated to have heritabilities between 0.2 and 0.8.</p>
      <p>In all examples we used a desktop computer with an Intel Quad-Core i7-3770 CPU @ 3.40 GHz and 16 Gb of RAM.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p><xref ref-type="fig" rid="btx166-F1">Figure 1</xref> shows that the complete and approximate versions of biMM are very similar across the 120 pairs of traits. <xref rid="btx166-T1" ref-type="table">Table 1</xref> shows that the approximate version is much faster than either the complete version or any other software package tested. Detailed results are in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figures S1–S4</xref>. In short, biMM and GEMMA gave essentially the same results and they were also similar to the results from GCTA and BOLT-REML.</p>
    <fig id="btx166-F1" orientation="portrait" position="float">
      <label>Fig. 1</label>
      <caption>
        <p>Comparing estimates for heritability (<italic>V<sub>G</sub></italic>) and genetic correlation (<italic>ρ<sub>G</sub></italic>) between an approximate (<inline-formula id="IE22"><mml:math id="IEQ22"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math></inline-formula>) and complete (<inline-formula id="IE23"><mml:math id="IEQ23"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) versions of biMM over 120 pairs of traits</p>
      </caption>
      <graphic xlink:href="btx166f1"/>
    </fig>
    <p>
      <table-wrap id="btx166-T1" orientation="portrait" position="float">
        <label>Table 1.</label>
        <caption>
          <p>Cumulative run time in hours over 120 trait pairs of <xref ref-type="fig" rid="btx166-F1">Figure 1</xref></p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1">biMM approx</th>
              <th rowspan="1" colspan="1">biMM compl</th>
              <th rowspan="1" colspan="1">GEMMA</th>
              <th rowspan="1" colspan="1">BOLT-REML</th>
              <th rowspan="1" colspan="1">GCTA</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Real (h)</td>
              <td rowspan="1" colspan="1">0.05</td>
              <td rowspan="1" colspan="1">0.49</td>
              <td rowspan="1" colspan="1">2.76</td>
              <td rowspan="1" colspan="1">19.20</td>
              <td rowspan="1" colspan="1">21.39</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CPU (h)</td>
              <td rowspan="1" colspan="1">0.07</td>
              <td rowspan="1" colspan="1">1.49</td>
              <td rowspan="1" colspan="1">2.76</td>
              <td rowspan="1" colspan="1">19.20</td>
              <td rowspan="1" colspan="1">21.39</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p>‘Real’ is wall clock time. ‘CPU’ is total CPU time over all cores used.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </p>
    <p>To assess scaling to larger datasets, we evaluated how much time each additional trait pair would require for a dataset of 20 000 individuals after the eigendecomposition is available and phenotype data are completely observed. The resulting times in CPU seconds are 1.6 for biMM, 75 for GEMMA and 2670 for BOLT-REML. GCTA was unable to run with 16 Gb of RAM. The difference between biMM and GEMMA in this example with no missing data is that biMM holds the eigendecomposition in RAM while GEMMA reads it from a file for each pair of traits. The eigendecomposition itself took 70 CPU minutes with biMM and 450 CPU minutes with GEMMA. Hence, with a desktop computer, an analysis of completely observed or imputed omics data for 500 traits (124 750 trait pairs) measured on 20 000 individuals would take less than 2.5 days with biMM, over 100 days with GEMMA (although with a multivariate analysis strategy GEMMA could finish in 14 days, <xref ref-type="supplementary-material" rid="sup1">Supplementary Information</xref>) and many years with BOLT-REML.</p>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>Our freely available biMM software package makes a bivariate linear mixed model analysis of high-dimensional phenotypes on cohorts of a few tens of thousands of individuals practical using a desktop computer. For even larger cohorts, where explicit matrix decompositions are impractical on current desktop computers, BOLT-REML may be the only available option to analyze a pair of traits, but it cannot utilize sharing of individuals across trait pairs to efficiently analyze tens of thousands of trait pairs.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="btx166_supplementary_information.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>This study made use of NFBC1966 data. We thank the late professor Paula Rantakallio (launch of NFBC1966), the participants in the 31yrs study and the NFBC project center.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the Academy of Finland [257654 and 288509 to M.P.; 286607 and 294015 to P.M.; 251217 and 255847 to S.R.]. S.R. was supported by EU FP7 projects ENGAGE (201413) and BioSHaRE (261433), the Finnish Foundation for Cardiovascular Research, Biocentrum Helsinki and the Sigrid Juselius Foundation. NFBC1966 received financial support from University of Oulu Grant no. 65354, Oulu University Hospital Grant no. 2/97, 8/97, Ministry of Health and Social Affairs Grant no. 23/251/97, 160/97, 190/97, National Institute for Health and Welfare, Helsinki Grant no. 54121, Regional Institute of Occupational Health, Oulu, Finland Grant no. 50621, 54231.</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="btx166-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bulik-Sullivan</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>An atlas of genetic correlations across human diseases and traits</article-title>. <source>Nat. Gen</source>., <volume>47</volume>, <fpage>1236</fpage>–<lpage>1241</lpage>.</mixed-citation>
    </ref>
    <ref id="btx166-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Casale</surname><given-names>F.P.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Efficient set tests for the genetic analysis of correlated traits</article-title>. <source>Nat. Methods</source>, <volume>12</volume>, <fpage>755</fpage>–<lpage>758</lpage>.<pub-id pub-id-type="pmid">26076425</pub-id></mixed-citation>
    </ref>
    <ref id="btx166-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Furlotte</surname><given-names>N.A.</given-names></name>, <name name-style="western"><surname>Eskin</surname><given-names>E.</given-names></name></person-group> (<year>2015</year>) 
<article-title>Efficient multiple-trait association and estimation of genetic correlation using the matrix-variate linear mixed model</article-title>. <source>Genetics</source>, <volume>200</volume>, <fpage>59</fpage>–<lpage>68</lpage>.<pub-id pub-id-type="pmid">25724382</pub-id></mixed-citation>
    </ref>
    <ref id="btx166-B4">
      <mixed-citation publication-type="journal"><collab>International HapMap3 consortium</collab>. (<year>2010</year>) 
<article-title>Integrating common and rare genetic variation in diverse human populations</article-title>. <source>Nature</source>, <volume>467</volume>, <fpage>52</fpage>–<lpage>58</lpage>.<pub-id pub-id-type="pmid">20811451</pub-id></mixed-citation>
    </ref>
    <ref id="btx166-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Loh</surname><given-names>P.R.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Contrasting genetic architectures of schizophrenia and other complex diseases using fast variance-components analysis</article-title>. <source>Nat. Gen</source>., <volume>47</volume>, <fpage>1385</fpage>–<lpage>1392</lpage>.</mixed-citation>
    </ref>
    <ref id="btx166-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rantakallio</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>1969</year>) 
<article-title>Groups at risk in low birth weight infants and perinatal mortality</article-title>. <source>Acta Paediatr. Scand</source>., <volume>193</volume>, <fpage>191.</fpage></mixed-citation>
    </ref>
    <ref id="btx166-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Su</surname><given-names>Z.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>HAPGEN2: simulation of multiple disease SNPs</article-title>. <source>Bioinformatics</source>, <volume>27</volume>, <fpage>2304</fpage>–<lpage>2305</lpage>.<pub-id pub-id-type="pmid">21653516</pub-id></mixed-citation>
    </ref>
    <ref id="btx166-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tukiainen</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Chromosome X-wide association study identifies loci for fasting insulin and height and evidence for incomplete dosage compensation</article-title>. <source>PLoS Genet</source>., <volume>10</volume>, <fpage>e1004127.</fpage><pub-id pub-id-type="pmid">24516404</pub-id></mixed-citation>
    </ref>
    <ref id="btx166-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>GCTA: a tool for Genome-wide Complex Trait Analysis</article-title>. <source>Am. J. Hum. Genet</source>., <volume>88</volume>, <fpage>76</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">21167468</pub-id></mixed-citation>
    </ref>
    <ref id="btx166-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Genetic variance estimation with imputed variants finds negligible missing heritability for human height and body mass index</article-title>. <source>Nat. Gen</source>., <volume>47</volume>, <fpage>1114</fpage>–<lpage>1120</lpage>.</mixed-citation>
    </ref>
    <ref id="btx166-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhou</surname><given-names>X.</given-names></name>, <name name-style="western"><surname>Stephens</surname><given-names>M.</given-names></name></person-group> (<year>2014</year>) 
<article-title>Efficient multivariate linear mixed model algorithms for genome-wide association studies</article-title>. <source>Nat. Methods</source>, <volume>11</volume>, <fpage>407</fpage>–<lpage>409</lpage>.<pub-id pub-id-type="pmid">24531419</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
