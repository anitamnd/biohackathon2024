<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7355304</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btaa467</article-id>
    <article-id pub-id-type="publisher-id">btaa467</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>General Computational Biology</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Artificial-cell-type aware cell-type classification in CITE-seq</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lian</surname>
          <given-names>Qiuyu</given-names>
        </name>
        <xref ref-type="aff" rid="btaa467-aff1">b1</xref>
        <xref ref-type="aff" rid="btaa467-aff2">b2</xref>
        <xref ref-type="author-notes" rid="btaa467-FM1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xin</surname>
          <given-names>Hongyi</given-names>
        </name>
        <xref ref-type="aff" rid="btaa467-aff2">b2</xref>
        <xref ref-type="aff" rid="btaa467-aff3">b3</xref>
        <xref ref-type="author-notes" rid="btaa467-FM1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Jianzhu</given-names>
        </name>
        <xref ref-type="aff" rid="btaa467-aff4">b4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Konnikova</surname>
          <given-names>Liza</given-names>
        </name>
        <xref ref-type="aff" rid="btaa467-aff2">b2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Wei</given-names>
        </name>
        <xref ref-type="aff" rid="btaa467-aff2">b2</xref>
        <xref ref-type="corresp" rid="btaa467-cor1"/>
        <!--<email>wec47@pitt.edu</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gu</surname>
          <given-names>Jin</given-names>
        </name>
        <xref ref-type="aff" rid="btaa467-aff1">b1</xref>
        <xref ref-type="corresp" rid="btaa467-cor1"/>
        <!--<email>jgu@tsinghua.edu.cn</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Kong</given-names>
        </name>
        <xref ref-type="aff" rid="btaa467-aff5">b5</xref>
        <xref ref-type="corresp" rid="btaa467-cor1"/>
        <!--<email>koc5@pitt.edu</email>-->
      </contrib>
    </contrib-group>
    <aff id="btaa467-aff1"><label>b1</label><institution>MOE Key Laboratory of Bioinformatics, BNRIST Bioinformatics Division, Department of Automation, Tsinghua University</institution>, Beijing 100084, <country country="CN">China</country></aff>
    <aff id="btaa467-aff2"><label>b2</label><institution>Department of Pediatrics, School of Medicine, University of Pittsburgh, UPMC Children’s Hospital of Pittsburgh</institution>, Pittsburgh, PA 15224, <country country="US">USA</country></aff>
    <aff id="btaa467-aff3"><label>b3</label><institution>University of Michigan-Shanghai Jiao Tong University Joint Institute, Shanghai Jiao Tong University</institution>, Shanghai 200240, <country country="CN">China</country></aff>
    <aff id="btaa467-aff4"><label>b4</label><institution>Department of Biochemistry and Computer Science, Purdue University</institution>, West Lafayette, IA 47907, <country country="US">USA</country></aff>
    <aff id="btaa467-aff5"><label>b5</label><institution>Department of Medicine, School of Medicine, University of Pittsburgh</institution>, Pittsburgh, PA 15213, <country country="US">USA</country></aff>
    <author-notes>
      <fn id="btaa467-FM1">
        <p>The authors wish it to be known that, in their opinion, Qiuyu Lian and Hongyi Xin should be regarded as Joint First Authors.</p>
      </fn>
      <corresp id="btaa467-cor1">To whom correspondence should be addressed. E-mail: <email>wec47@pitt.edu</email> or <email>jgu@tsinghua.edu.cn</email> or <email>koc5@pitt.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-07-13">
      <day>13</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>36</volume>
    <issue>Suppl 1</issue>
    <issue-title>ISMB 2020 Proceedings</issue-title>
    <fpage>i542</fpage>
    <lpage>i550</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2020. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btaa467.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Cellular Indexing of Transcriptomes and Epitopes by sequencing (CITE-seq), couples the measurement of surface marker proteins with simultaneous sequencing of mRNA at single cell level, which brings accurate cell surface phenotyping to single-cell transcriptomics. Unfortunately, multiplets in CITE-seq datasets create artificial cell types (ACT) and complicate the automation of cell surface phenotyping.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We propose CITE-sort, an artificial-cell-type aware surface marker clustering method for CITE-seq. CITE-sort is aware of and is robust to multiplet-induced ACT. We benchmarked CITE-sort with real and simulated CITE-seq datasets and compared CITE-sort against canonical clustering methods. We show that CITE-sort produces the best clustering performance across the board. CITE-sort not only accurately identifies real biological cell types (BCT) but also consistently and reliably separates multiplet-induced artificial-cell-type droplet clusters from real BCT droplet clusters. In addition, CITE-sort organizes its clustering process with a binary tree, which facilitates easy interpretation and verification of its clustering result and simplifies cell-type annotation with domain knowledge in CITE-seq.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p><ext-link ext-link-type="uri" xlink:href="http://github.com/QiuyuLian/CITE-sort">http://github.com/QiuyuLian/CITE-sort</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> is available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01HL137709</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Natural Science Foundation of China</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001809</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>61922047</award-id>
        <award-id>81890993</award-id>
        <award-id>61721003</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Accurate cell-type identification is critical to single-cell analysis (<xref rid="btaa467-B1" ref-type="bibr">Aevermann <italic>et al.</italic>, 2018</xref>; <xref rid="btaa467-B14" ref-type="bibr">Klein and Treutlein, 2019</xref>). Surface markers are the most reliable biomarkers for cell-type classification (<xref rid="btaa467-B9" ref-type="bibr">Cui <italic>et al.</italic>, 2019</xref>; <xref rid="btaa467-B28" ref-type="bibr">Spitzer and Nolan, 2016</xref>). Numerous studies in recent decades have used cell surface markers to isolate and characterize cellular populations with distinct biological functions and have discovered many novel cell types in the process (<xref rid="btaa467-B2" ref-type="bibr">Ahmed <italic>et al.</italic>, 2019</xref>; <xref rid="btaa467-B3" ref-type="bibr">Barcenilla <italic>et al.</italic>, 2019</xref>). Recent advancement in single-cell RNA sequencing (scRNA-seq) technologies enabled direct cell identity assessment through dissecting single-cell gene expression profiles. However, due to technical limitations, such as low efficiency in reverse transcription (<xref rid="btaa467-B12" ref-type="bibr">Kharchenko <italic>et al.</italic>, 2014</xref>; <xref rid="btaa467-B27" ref-type="bibr">Schwaber <italic>et al.</italic>, 2019</xref>), dropout events (sequencing fails to capture any transcript of active genes) (<xref rid="btaa467-B17" ref-type="bibr">Li and Li, 2018</xref>; <xref rid="btaa467-B20" ref-type="bibr">Macosko <italic>et al.</italic>, 2015</xref>) and low sampling rate (<xref rid="btaa467-B20" ref-type="bibr">Macosko <italic>et al.</italic>, 2015</xref>; <xref rid="btaa467-B29" ref-type="bibr">Stegle <italic>et al.</italic>, 2015</xref>), the RNA-derived cell identities may significantly deviate from the surface marker phenotyping result.</p>
    <p>The recent introduction of Cellular Indexing of Transcriptomes and Epitopes by sequencing (CITE-seq) (<xref rid="btaa467-B30" ref-type="bibr">Stoeckius <italic>et al.</italic>, 2017</xref>), which concurrently measures the abundance of both surface marker and messenger RNA (mRNA) in individual cells, enables simultaneous cell-type identification based on surface marker and RNA profiles. In a CITE-seq dataset, surface markers are specifically labeled by antibody-derived tags (ADTs), which are individually barcoded. ADTs act as pseudo-transcripts and could be sequenced together with mRNA. CITE-seq has gained popularity in a wide range of biological and clinical studies, such as resolving tumor heterogeneity (<xref rid="btaa467-B24" ref-type="bibr">Ortega <italic>et al.</italic>, 2017</xref>; <xref rid="btaa467-B36" ref-type="bibr">Wagner <italic>et al.</italic>, 2019</xref>) and dissecting cell populations in complex tissues or organs (<xref rid="btaa467-B8" ref-type="bibr">Cuevas-Diaz Duran <italic>et al.</italic>, 2017</xref>; <xref rid="btaa467-B9" ref-type="bibr">Cui <italic>et al.</italic>, 2019</xref>; <xref rid="btaa467-B14" ref-type="bibr">Klein and Treutlein, 2019</xref>; <xref rid="btaa467-B16" ref-type="bibr">Landhuis, 2018</xref>; <xref rid="btaa467-B26" ref-type="bibr">Schiller <italic>et al.</italic>, 2019</xref>).</p>
    <p><xref ref-type="fig" rid="btaa467-F1">Figure 1A and B</xref> shows an example of cell-type classification results of a peripheral blood mononuclear cells (PBMCs) CITE-seq dataset, using its RNA and surface marker (ADT) profiles separately. For RNA (<xref ref-type="fig" rid="btaa467-F1">Fig. 1A</xref>), cells are clustered into separate groups using <italic>scanpy</italic> (<xref rid="btaa467-B37" ref-type="bibr">Wolf <italic>et al.</italic>, 2018</xref>), based on the similarities in RNA profiles between cells; whereas for surface markers (<xref ref-type="fig" rid="btaa467-F1">Fig. 1B</xref>), cells are clustered using Gaussian mixture model (GMM). We use manually annotated cell types, which are hand curated with domain knowledge (<xref rid="btaa467-B21" ref-type="bibr">Maecker <italic>et al.</italic>, 2012</xref>), as truth. In both plots, cells are embedded in 2D planes, according to the tSNE transformation (<xref rid="btaa467-B34" ref-type="bibr">Van Der Maaten, 2014</xref>) of their RNA or ADT profiles, respectively. Different cell types are highlighted with distinct colors. By comparing the classification results of both modalities, we observe that classification based on RNA profiles struggles to separate biologically similar but functionally unique cell types, such as cytotoxic T cells and helper T cells, even though such cell types are distinctly separable in the surface marker space. A more detailed analysis between gene expressions and surface markers, such as the correlation analysis between them and RNA dropout analysis are provided in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1</xref>. While GMM achieves a greater fidelity in the surface marker (ADT) space, it is still imperfect. In <xref ref-type="fig" rid="btaa467-F1">Figure 1B</xref>, GMM misclassifies a portion of the CD4<sup>+</sup> T cells as some other cell types and fails to separate [iNK, mNK] and [C-mono, DC] cell types into distinct clusters.
</p>
    <fig id="btaa467-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>Clustering results of an example PBMC CITE-seq dataset. (<bold>A</bold>) Droplets are clustered and arranged according to their RNA expression profiles. (<bold>B</bold>) Droplets are clustered and arranged based on their surface marker (ADT) profiles. Ground truths in both plots are obtained through manual gating over the surface marker (ADT) space. ACT, artificial cell type; C-mono, classical monocyte; CD4+ T cell, helper T cell; CD8+ T cell, cytotoxic T cell; DC, dendritic cell; NC-mono, non-classical CD16<sup>+</sup> monocyte; iNK, intermediate CD16<sup>−</sup> NK cell; mNK, vast majority of NK cell</p>
      </caption>
      <graphic xlink:href="btaa467f1"/>
    </fig>
    <p>Automated cell-type classification with surface markers in CITE-seq is further complicated by hard-to-remove multiplets. Multiplets, where more than one cell is found per droplet, are technical artifacts induced during library preparation (<xref rid="btaa467-B20" ref-type="bibr">Macosko <italic>et al.</italic>, 2015</xref>; <xref rid="btaa467-B31" ref-type="bibr">Stoeckius <italic>et al.</italic>, 2018</xref>). In single-cell sequencing, ideally, a droplet is designed to capture just a single cell, which forms a singlet. In practice, it is impossible to avoid having two or more cells being encapsulated into a single droplet, which forms multiplets (see <xref ref-type="fig" rid="btaa467-F2">Fig. 2A</xref>). Handling multiplets becomes an even more pressing problem when investigators super-load the library prep equipment, in order to cut reagent cost, eliminate inter-sample batch effect or simply scale up samples in a single experiment. Multiplets confound cell-type identification (<xref rid="btaa467-B22" ref-type="bibr">McGinnis <italic>et al.</italic>, 2019</xref>; <xref rid="btaa467-B38" ref-type="bibr">Wolock <italic>et al.</italic>, 2019</xref>). <xref ref-type="fig" rid="btaa467-F2">Figure 2B</xref> shows an example of multiplets creating artificial cell types in a PBMC CITE-seq dataset. When a multiplet contains cells of different types, it generates droplets with biologically impossible surface marker profiles. For instance, in the above example (<xref ref-type="fig" rid="btaa467-F2">Fig. 2B</xref>), there exists a sizable CD3<sup>+</sup>CD19<sup>+</sup> droplet cluster which is rarely observed in PBMCs. Prior work has shown that such droplets are all multiplets and recommends subsequent removal of such droplets from downstream analysis (<xref rid="btaa467-B39" ref-type="bibr">Xin <italic>et al.</italic>, 2019</xref>). In this work, we call cell types that truly exist as <italic>biological cell types</italic> (BCT) and cell types created by CITE-seq multiplets as <italic>artificial cell types</italic> (ACT).
</p>
    <fig id="btaa467-F2" orientation="portrait" position="float">
      <label>Fig. 2.</label>
      <caption>
        <p>Demonstration of multiplets in CITE-seq and its impact on clustering methods. (<bold>A</bold>) An example CITE-seq assay, which contains both singlets and multiplets. (<bold>B</bold>) The example PBMC population displayed in the CD3: CD19 surface marker space. An ACT cluster in the pane is highlighted in the black box. (<bold>C</bold>) GMM and (<bold>D</bold>) k-means++ clustering results with four clusters. (<bold>E</bold>) Manual gating result, with the size of each cluster labeled in corners. The ACT cluster is much smaller in size than the three BCT clusters</p>
      </caption>
      <graphic xlink:href="btaa467f2"/>
    </fig>
    <p>Since it is impossible to avoid the occurrence of ‘multiplets’ due to experimental limitations, we proceed to assess the impact of the multiplets on conventional clustering algorithms. <xref ref-type="fig" rid="btaa467-F2">Figure 2C and D</xref> shows the results of two popular clustering algorithms, GMM and k-means++, for two surface markers, CD3 and CD19. With domain knowledge, the surface marker space should be divided into four quadrants with each quadrant containing a different cell type cluster, where top left are CD19<sup>+</sup> cells, bottom left are CD3<sup>−</sup>CD19<sup>−</sup> cells, bottom right are CD3<sup>+</sup> cells and the top right are the joint CD3<sup>+</sup>-and-CD19<sup>+</sup>-cell ACT multiplets (<xref ref-type="fig" rid="btaa467-F2">Fig. 2E</xref>). For this example, neither GMM nor k-means++ could isolate the top-right ACT cluster from the BCT clusters. This is due to the imbalance in cluster sizes between ACT and BCT clusters, where ACT clusters are significantly smaller than BCT clusters. The phenomenon where conventional clustering methods could fail when applied to datasets with mixing coefficient imbalances has been extensively studied and documented (<xref rid="btaa467-B15" ref-type="bibr">Krawczyk, 2016</xref>; <xref rid="btaa467-B18" ref-type="bibr">Lu <italic>et al.</italic>, 2019</xref>; <xref rid="btaa467-B23" ref-type="bibr">Naim and Gildea, 2012</xref>; <xref rid="btaa467-B40" ref-type="bibr">Xuan <italic>et al.</italic>, 2013</xref>).</p>
    <p>Interpreting the clustering result is equally important (<xref rid="btaa467-B13" ref-type="bibr">Kiselev <italic>et al.</italic>, 2019</xref>). Biologists have already established a mature pipeline to identify cell populations using a recursive selection process called gating, which is widely used in flow and mass cytometry analysis (<xref rid="btaa467-B21" ref-type="bibr">Maecker <italic>et al.</italic>, 2012</xref>; <xref rid="btaa467-B35" ref-type="bibr">Verschoor <italic>et al.</italic>, 2015</xref>). The gating process recursively selects a sequence of surface markers to stratify cells, until a homogeneous population emerges. The ordering of surface markers in gating is determined by domain knowledge. <xref ref-type="fig" rid="btaa467-F3">Figures 3</xref> illustrates an example gating strategy for PBMCs. For instance, to select the cytotoxic T cells, which are marked by high expressions in both CD3 and CD8 and low expressions in both CD4 and CD19, a biologist would first select the CD3<sup>+</sup>CD19<sup>−</sup> cell cluster in the CD3: CD19 scatter plot and then select the CD8<sup>+</sup>CD4<sup>−</sup> cell cluster in the CD4: CD8 scatter plot (<xref ref-type="fig" rid="btaa467-F3">Fig. 3B</xref>). Similar to how a gating strategy guides cell-type annotation in manual gating, a good clustering framework should provide a comprehensive interpretation for its internal mechanics and facilitate biologists to annotate resulting cell clusters according to domain knowledge. Ideally, the interpretation should match the format of a gating strategy, such as the one demonstrated in <xref ref-type="fig" rid="btaa467-F3">Figure 3A</xref>.
</p>
    <fig id="btaa467-F3" orientation="portrait" position="float">
      <label>Fig. 3.</label>
      <caption>
        <p>(<bold>A</bold>) An example gating strategy for PBMCs. (<bold>B</bold>) The gating process for the example PBMC dataset. NK cells, natural killer cells; DCs, dendritic cells</p>
      </caption>
      <graphic xlink:href="btaa467f3"/>
    </fig>
    <p>To address these challenges, we propose an interpretable, unsupervised single-cell clustering algorithm, named CITE-sort, to systematically identify both BCTs and ACTs based on a recursive GMM framework. In each iteration, CITE-sort selects a low-dimensional surface marker subspace, generally defined by one or two surface markers, and performs clustering with GMM. In this manner, CITE-sort collapses numerous highly imbalanced clusters in the original high-dimensional surface marker space into fewer yet more balanced hybrid clusters in lower dimensional subspaces, which improves clustering performance. CITE-sort partitions the whole dataset into subpopulations through recursive bi-partitioning and constructs a binary sort tree for visualization, verification and guided cell-type annotation. CITE-sort terminates when a subpopulation cannot be further divided, which creates a leaf node that is either an ACT or a BCT. The sort tree resembles a manual gating strategy and thus is comprehendible to biologists. The sort tree facilitates easy cell-type annotations and accurate ACT cluster identifications. We applied CITE-sort to both real and simulated CITE-seq datasets and found that CITE-sort is able to achieve superior clustering performance compared to other popular clustering methods. Especially, CITE-sort is the only method that constantly and robustly segregate ACT clusters from BCT clusters. In addition, the sort tree generated by CITE-sort is consistent with existing gating strategies and provide rich biological insights.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Overlapping, imbalanced clusters in CITE-seq</title>
      <p>CITE-seq uses a matrix to store the ADT counts of each surface marker in every droplet. While the ADT count of a surface marker does not quantify the absolute number of the marker proteins on a cell surface, it retains a strong correlation (<xref rid="btaa467-B30" ref-type="bibr">Stoeckius <italic>et al.</italic>, 2017</xref>). Droplets that exhibit relatively large ADT counts of a specific surface marker, suggest that the cell(s) in these droplets have relatively high expression(s) of that surface marker. When multiple cells collide into a single droplet, forming a multiplet in the process, the final ADT counts of the droplet can be perceived as the sum of ADT counts over its member cells.</p>
      <p>Similar to other surface marker quantification technologies, a CITE-seq dataset is pre-processed with the centered-log-ratio (CLR) normalization (<xref rid="btaa467-B30" ref-type="bibr">Stoeckius <italic>et al.</italic>, 2017</xref>), prior to clustering. The formula of the CLR normalization is shown below:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <p>In <xref ref-type="disp-formula" rid="E1">Equation (1)</xref>, <inline-formula id="IE1"><mml:math id="IM1"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the molecule count of marker (ADT) <inline-formula id="IE2"><mml:math id="IM2"><mml:mi>j</mml:mi></mml:math></inline-formula> in droplet <inline-formula id="IE3"><mml:math id="IM3"><mml:mi>i</mml:mi></mml:math></inline-formula> and <inline-formula id="IE4"><mml:math id="IM4"><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> is the geometric mean of <inline-formula id="IE5"><mml:math id="IM5"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> across all droplets. All surface marker (ADT) scatter plots in this paper are CLR normalized.</p>
      <p>CITE-seq datasets contain many imbalanced and overlapping clusters. Compared to BCT clusters, ACT clusters have much smaller population sizes. In a CITE-seq experiment, the multiplet rate is often controlled at a moderate level for quality assurance. Previous work has shown that the proportion of multiplets increases as the number of cells in library prep increases (<xref rid="btaa467-B20" ref-type="bibr">Macosko <italic>et al.</italic>, 2015</xref>; <xref rid="btaa467-B31" ref-type="bibr">Stoeckius <italic>et al.</italic>, 2018</xref>; <xref rid="btaa467-B39" ref-type="bibr">Xin <italic>et al.</italic>, 2019</xref>). Therefore, ACT droplets typically have non-negligible but still much smaller presences than BCT droplets, creating imbalance in cluster sizes.</p>
      <p>In the CLR normalized surface marker space, ACT clusters are often in close proximity to multiple BCT clusters, similar to the example in <xref ref-type="fig" rid="btaa467-F2">Figure 2B</xref>. Each ACT droplet contains multiple cells of different types. Since the ADT counts of an ACT droplet equals to the sum of the ADT counts of its member cells, also because the logarithm dampens small-scale changes in the ADT counts [such as <inline-formula id="IE6"><mml:math id="IM6"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mn>2</mml:mn><mml:mo>·</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo><mml:mo>≈</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>, with <inline-formula id="IE7"><mml:math id="IM7"><mml:mi>c</mml:mi><mml:mo>≫</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula>], when individual cells merge into an ACT droplet, in the surface marker space, after CLR, the ACT droplet is positioned as slightly exceeding the highest coordinate in each surface marker dimension, across all of its member cells (<xref rid="btaa467-B39" ref-type="bibr">Xin <italic>et al.</italic>, 2019</xref>). Mathematically, assuming <inline-formula id="IE8"><mml:math id="IM8"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the set of cells included in an ACT droplet <inline-formula id="IE9"><mml:math id="IM9"><mml:mi>D</mml:mi></mml:math></inline-formula>, then the CLR-transformed surface marker count vector <inline-formula id="IE10"><mml:math id="IM10"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of <inline-formula id="IE11"><mml:math id="IM11"><mml:mi>D</mml:mi></mml:math></inline-formula> approximately equals
<disp-formula id="E2"><mml:math id="M2"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mo>·</mml:mo></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mo>·</mml:mo></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>The produced ACT droplets, therefore, share similar ADT (CLR normalized) values to its member cells in many, but not all, surface marker dimensions. This creates the phenomenon where an ACT cluster is always close to some BCT clusters.</p>
      <p>Aside from ACT clusters, BCT clusters may also share extensive similarities and form groups of closely positioned clusters in the surface marker space. Biologically, many cell types in a tissue share extensive common sections in their lineages. As a result, many of them share similar distributions in many surface markers. For instance, helper T cells (CD4<sup>+</sup> T) and cytotoxic T cells (CD8<sup>+</sup> T) are both T cells. As such, they have very similar, if not identical, ADT value distributions in many surface markers. Likewise, both T cells and B cells are lymphoid cells and their surface marker expression profiles also share significant similarities, albeit to a lesser extent than the helper and cytotoxic T cells (as T and B cells are more distant in the cell lineage tree).</p>
      <p>Consequently, when observed in lower dimensions, especially when the most differentiating surface markers are excluded, BCT clusters often collapse with each other and merge into fewer clusters. <xref ref-type="fig" rid="btaa467-F4">Figure 4</xref> shows an example surface marker (ADT) distribution (CLR-transformed) of the previously introduced PBMC dataset. In this dataset, when viewed in 1D, many surface markers exhibit a mixture distribution of a few (mostly just two) Gaussian components. Also evident in <xref ref-type="fig" rid="btaa467-F4">Figure 4</xref>, these Gaussian components are seldom well separated. In many surface marker dimensions, components are close to each other and share small overlaps.
</p>
      <fig id="btaa467-F4" orientation="portrait" position="float">
        <label>Fig. 4.</label>
        <caption>
          <p>Distributions of CLR normalized ADT values of the example PBMC dataset on individual surface markers</p>
        </caption>
        <graphic xlink:href="btaa467f4"/>
      </fig>
      <p>Combined with the property that ACT clusters are close to BCT clusters, in a CITE-seq dataset, there are many closely positioned clusters in a very compact surface marker space. This increases the difficulty in separating them through clustering. Additionally, ACT clusters encompass much fewer cells than BCT clusters; and there could be many more ACT clusters than BCT clusters. According to <xref rid="btaa467-B39" ref-type="bibr">Xin <italic>et al.</italic> (2019)</xref>, with a total of <inline-formula id="IE12"><mml:math id="IM12"><mml:mi>k</mml:mi></mml:math></inline-formula> BCT clusters, there could be as many as <inline-formula id="IE13"><mml:math id="IM13"><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> ACT clusters.</p>
      <p>Altogether, a CITE-seq dataset is likely to share the following properties in the surface marker space: (i) it may contain a large number of clusters; (ii) clusters vary dramatically in size; and (iii) clusters are not well separated and may contain similar distributions in individual dimensions.</p>
    </sec>
    <sec>
      <title>2.2 Convergence of the EM algorithm on CITE-seq datasets</title>
      <p>The expectation-maximization (EM) algorithm for GMM struggles to converge to the global optima in CITE-seq datasets. Inherently, in GMM, the EM algorithm does not consistently converge when (i) the dataset has high dimensions; (ii) the cluster number is large; (iii) clusters overlap; and (iv) there exists significant imbalance in the mixing coefficients. Let <inline-formula id="IE14"><mml:math id="IM14"><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">*</mml:mi></mml:mrow></mml:math></inline-formula> denote the ground truth means of <inline-formula id="IE15"><mml:math id="IM15"><mml:mi>K</mml:mi></mml:math></inline-formula> Gaussian components in a <inline-formula id="IE16"><mml:math id="IM16"><mml:mi>d</mml:mi></mml:math></inline-formula>-dimensional Gaussian mixture dataset and let
<disp-formula id="E3"><mml:math id="M3"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced open="‖" close="‖" separators="|"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula id="IE17"><mml:math id="IM17"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula id="IE18"><mml:math id="IM18"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> denote the ground truth means of component <inline-formula id="IE19"><mml:math id="IM19"><mml:mi>i</mml:mi></mml:math></inline-formula> and <inline-formula id="IE20"><mml:math id="IM20"><mml:mi>j</mml:mi></mml:math></inline-formula>, denote the minimum distance between the means of any two components. <xref rid="btaa467-B41" ref-type="bibr">Zhao <italic>et al.</italic> (2020)</xref> provides a convergence guarantee of the EM algorithm to the global optima, as long as the following condition is true:
<disp-formula id="E4"><label>(2)</label><mml:math id="M4"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">min</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi mathvariant="normal">min</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:math></disp-formula></p>
      <p>In <xref ref-type="disp-formula" rid="E4">Equation (2)</xref>, <inline-formula id="IE21"><mml:math id="IM21"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is a universal constant. <xref ref-type="disp-formula" rid="E4">Equation (2)</xref> implies that it requires a greater distance between the means of components in a Gaussian mixture to provide the same convergence guarantee as the cardinality of dimensions and the number of clusters increase. Increasing dimensions or adding more components without increasing the distance between clusters will eventually undermine the convergence of the EM algorithm.</p>
      <p><xref rid="btaa467-B23" ref-type="bibr">Naim and Gildea (2012)</xref> and <xref rid="btaa467-B19" ref-type="bibr">Ma <italic>et al.</italic> (2000)</xref> have theoretically and empirically shown that having imbalanced mixing coefficients and overlaps between components also impedes the convergence of the EM algorithm. Specifically, <xref rid="btaa467-B23" ref-type="bibr">Naim and Gildea (2012)</xref> showed that in the presence of overlaps between clusters, the condition number associated with EM increases (the convergence rate decreases) as the imbalance in mixing coefficients increases; hence a slower convergence of the EM algorithm.</p>
      <p>CITE-seq datasets, unfortunately, often contain all four traits that hinder the convergence of the EM algorithm for GMM: there are many ACT clusters due to multiplets; ACT and BCT clusters often share overlaps; ACT clusters are much smaller in size than BCT clusters, which creates imbalance in mixing coefficients; and CITE-seq datasets usually have decent numbers of dimensions (often at the scale of 10 or more). As a result, the EM algorithm exhibits poor performance at fitting a GMM model on a CITE-seq dataset, as shown in <xref ref-type="fig" rid="btaa467-F2">Figure 2C and D</xref>.</p>
    </sec>
    <sec>
      <title>2.3 Overview of CITE-sort</title>
      <p>CITE-sort exploits a property of CITE-seq datasets where clusters of distinct cell types tend to collapse into fewer Gaussian components in lower dimensions. Therefore, when inspected in a lower dimensional subspace, the distribution can be fitted with much fewer components. Working with fewer components in a low-dimensional space improves the likelihood of the EM algorithm reaching to the global optima [recall <xref ref-type="disp-formula" rid="E4">Equation (2)]</xref>. For example, when viewed in 1D, the four Gaussian components in <xref ref-type="fig" rid="btaa467-F5">Figure 5C</xref> collapses into only two components, as <xref ref-type="fig" rid="btaa467-F5">Figure 5A</xref> shows. When directly applying the EM algorithm on all four components in the 2D space, the EM algorithm fails to converge to the global optima and is unable to separate the four clusters, as with the example in <xref ref-type="fig" rid="btaa467-F2">Figure 2C</xref>. However, by applying 1D GMM iteratively on CD3 (<xref ref-type="fig" rid="btaa467-F5">Fig. 5A</xref>) and then on CD19 (<xref ref-type="fig" rid="btaa467-F5">Fig. 5B and C</xref>) in a two-step fashion, the EM algorithm is able to reliably crop out all four clusters, as displayed in <xref ref-type="fig" rid="btaa467-F5">Figure 5</xref>. When clustering on CD3, the two Gaussian components have more balanced cluster sizes; hence leading to a more consistent convergence for the EM algorithm. When processing the CD3<sup>+</sup> component on CD19 (<xref ref-type="fig" rid="btaa467-F5">Fig. 5C</xref>), although there still exist non-trivial mixing coefficient imbalance between the CD3<sup>+</sup>CD19<sup>+</sup> component (an ACT cluster) and the CD3<sup>+</sup>CD19<sup>−</sup> component (a BCT cluster), compared to the original two-component, four-cluster scenario in <xref ref-type="fig" rid="btaa467-F5">Figure 5A</xref>, which harbors mixing coefficient imbalance between the CD3<sup>+</sup>CD19<sup>−</sup> ACT cluster and all three other BCT clusters, the imbalance is now restricted between just a single pair of components. Combined with having fewer clusters in the mixture and operating in lower dimensions, the EM algorithm is able to converge accurately and separate the CD3<sup>+</sup>CD19<sup>+</sup> and the CD3<sup>+</sup>CD19<sup>−</sup> cluster.
</p>
      <fig id="btaa467-F5" orientation="portrait" position="float">
        <label>Fig. 5.</label>
        <caption>
          <p>Demonstration of CITE-sort fitting GMM models in lower dimensions. (<bold>A</bold>) Fitting a GMM model in single dimensions. (<bold>B</bold>) and (<bold>C</bold>) Fit GMM models with CD19 on CD3− and CD3+ subpopulations from the previous step, respectively</p>
        </caption>
        <graphic xlink:href="btaa467f5"/>
      </fig>
      <p>Overall, CITE-sort clusters droplets by iteratively fitting GMM models in low dimensions. In each iteration, CITE-sort selects the lowest dimensional subspace where droplets can still be distributed into separate hybrid clusters. If there exist multiple qualifying surface marker subspaces with equal cardinalities, CITE-sort prioritizes the surface marker subspace whose GMM model returns the largest likelihood in describing the data distribution. CITE-sort repeats the low-dimensional clustering process on each child cluster, until no cluster can be further subdivided. In this manner, CITE-sort reduces the number of clusters, the cardinality of the dimension, and the degree of imbalance among clusters in each clustering step and maintains high quality clustering throughout the entire process.</p>
      <p>For simplicity, CITE-sort uses binary partition: in each iteration, CITE-sort picks the largest hybrid cluster as one part and merges all other components together as the other part. CITE-sort then repeats the low-dimensional clustering process on each part, until it can no longer be further divided. We call the binary tree emerged from the iterative bi-partitioning process <italic>the sort tree</italic> (sort for cell sorting).</p>
    </sec>
    <sec>
      <title>2.4 Clustering in low dimensions</title>
      <p>When clustering in low dimensions, clusters may not always perfectly stack on each other and form perfect Gaussian components as the example in <xref ref-type="fig" rid="btaa467-F6">Figure 6A</xref>. Sometimes, the density distribution of a surface marker cannot be decomposed into two perfectly disjoint Gaussian components. Rather, it requires multiple components, some of which overlap with each other. CITE-sort fits a GMM model by minimizing Bayesian information criteria (BIC) score. Components that share significant overlaps, such as the example distribution shown in <xref ref-type="fig" rid="btaa467-F6">Figure 6A</xref>, are merged subsequently. CITE-sort computes the Bhattacharyya distance (<xref rid="btaa467-B7" ref-type="bibr">Bouveyron <italic>et al.</italic>, 2019</xref>; <xref rid="btaa467-B11" ref-type="bibr">Hennig, 2010</xref>) to measure the degree of overlap between two components. Given a surface marker subspace <inline-formula id="IE22"><mml:math id="IM22"><mml:mi>S</mml:mi></mml:math></inline-formula> and two Gaussian components <inline-formula id="IE23"><mml:math id="IM23"><mml:mi>a</mml:mi></mml:math></inline-formula> and <inline-formula id="IE24"><mml:math id="IM24"><mml:mi>b</mml:mi></mml:math></inline-formula> in <inline-formula id="IE25"><mml:math id="IM25"><mml:mi>S</mml:mi></mml:math></inline-formula>, let <inline-formula id="IE26"><mml:math id="IM26"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula id="IE27"><mml:math id="IM27"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> denote the surface marker mean vectors of <inline-formula id="IE28"><mml:math id="IM28"><mml:mi>a</mml:mi></mml:math></inline-formula> and <inline-formula id="IE29"><mml:math id="IM29"><mml:mi>b</mml:mi></mml:math></inline-formula>, and <inline-formula id="IE30"><mml:math id="IM30"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula id="IE31"><mml:math id="IM31"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> denote the corresponding covariance matrices of <inline-formula id="IE32"><mml:math id="IM32"><mml:mi>a</mml:mi></mml:math></inline-formula> and <inline-formula id="IE33"><mml:math id="IM33"><mml:mi>b</mml:mi></mml:math></inline-formula>. The Bhattacharyya distance (<xref rid="btaa467-B7" ref-type="bibr">Bouveyron <italic>et al.</italic>, 2019</xref>; <xref rid="btaa467-B11" ref-type="bibr">Hennig, 2010</xref>) between <inline-formula id="IE34"><mml:math id="IM34"><mml:mi>a</mml:mi></mml:math></inline-formula> and <inline-formula id="IE35"><mml:math id="IM35"><mml:mi>b</mml:mi></mml:math></inline-formula> equals:
<disp-formula id="E5"><label>(3)</label><mml:math id="M5"><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">og</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msqrt><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math></disp-formula></p>
      <fig id="btaa467-F6" orientation="portrait" position="float">
        <label>Fig. 6.</label>
        <caption>
          <p>An example of merging Gaussian mixture components. (<bold>A</bold>) Illustration of the five original Gaussian components in a 1D GMM model. (<bold>B</bold>) Merging components into component complexes. (<bold>C</bold>) The final component complexes after merging. The dashed lines represent the density curves of the two merged component complexes <inline-formula id="IE36"><mml:math id="IM36"><mml:mi mathvariant="normal">β</mml:mi></mml:math></inline-formula> and <inline-formula id="IE37"><mml:math id="IM37"><mml:mi mathvariant="normal">γ</mml:mi></mml:math></inline-formula></p>
        </caption>
        <graphic xlink:href="btaa467f6"/>
      </fig>
      <p>If he Bhattacharyya distance between a pair of components falls below a parametrized threshold <inline-formula id="IE38"><mml:math id="IM38"><mml:mi mathvariant="normal">ε</mml:mi></mml:math></inline-formula>, then the two components are merged into a component complex. After merging, the same process is repeated on all pairs of component/component complexes, until no pairs of component/component complex can be merged. <xref ref-type="fig" rid="btaa467-F6">Figure 6B</xref> demonstrates the hierarchical merging process of combining Gaussian components of <xref ref-type="fig" rid="btaa467-F6">Figure 6A</xref>. There are five Gaussian components. Component pairs, [3, 4] and [1, 2], are first merged into a component complex <inline-formula id="IE39"><mml:math id="IM39"><mml:mi mathvariant="normal">α</mml:mi></mml:math></inline-formula> and <inline-formula id="IE40"><mml:math id="IM40"><mml:mi mathvariant="normal">γ</mml:mi></mml:math></inline-formula>, respectively. Then <inline-formula id="IE41"><mml:math id="IM41"><mml:mi mathvariant="normal">α</mml:mi></mml:math></inline-formula> is merged with component 5, becoming <inline-formula id="IE42"><mml:math id="IM42"><mml:mi mathvariant="normal">β</mml:mi></mml:math></inline-formula>. <inline-formula id="IE43"><mml:math id="IM43"><mml:mi mathvariant="normal">β</mml:mi></mml:math></inline-formula> and <inline-formula id="IE44"><mml:math id="IM44"><mml:mi mathvariant="normal">γ</mml:mi></mml:math></inline-formula> do not share sufficient overlap. Hence, they remain two separate component complexes. <xref ref-type="fig" rid="btaa467-F6">Figure 6C</xref> shows the final component complexes, <inline-formula id="IE45"><mml:math id="IM45"><mml:mi mathvariant="normal">β</mml:mi></mml:math></inline-formula> and <inline-formula id="IE46"><mml:math id="IM46"><mml:mi mathvariant="normal">γ</mml:mi></mml:math></inline-formula>, in the density histogram plot. CITE-sort sets <inline-formula id="IE47"><mml:math id="IM47"><mml:mo>ε</mml:mo></mml:math></inline-formula> to 0.1 by default.</p>
    </sec>
    <sec>
      <title>2.5 Constructing the sort tree</title>
      <p>As CITE-sort iteratively subdivides droplets into smaller subpopulations, CITE-sort records the surface marker(s) involved in each division in the sort tree. Each node in the sort tree represents a subpopulation. The root node represents the whole dataset. The label of each node denotes the surface markers employed in further subdividing the subpopulation. CITE-sort stops subdividing a node if (i) the population size falls below a parametrized minimum cluster threshold <inline-formula id="IE48"><mml:math id="IM48"><mml:mo>θ</mml:mo></mml:math></inline-formula>, or (ii) the subpopulation cannot be subdivided into more than one component/component complex in all subspaces.</p>
      <p>While CITE-sort prefers clustering in low dimensions, not all surface marker subspaces are qualified for subdivisions. Many surface subspaces have a single-component complex left after merging. Without more than one independent component/component complex, the subdivision process comes to a halt. To avoid terminating the iterative clustering process prematurely, CITE-sort skips surface marker subspaces with a single-component complex (or if there are no multiple components to begin with). When there exist multiple qualifying surface marker subspaces with equal cardinalities, CITE-sort computes the likelihood of the fitted GMM in describing the distribution of the data and selects the surface marker subspace with the largest likelihood for further division.</p>
      <p>The sort tree facilitates accurate annotations of cell types, justifiable verification of the clustering result, and accessible interpretation of the model. The sort tree displays three items at each node: the surface marker(s) chosen for clustering and bi-partition; the distribution of the current droplet subpopulation in the chosen surface marker subspace; and all component complexes derived from the subpopulation. The two subpopulations after bi-partition are highlighted separately with matching-color edges in the sort tree to emphasize their sorting trajectory. An example sort tree is provided in <xref ref-type="fig" rid="btaa467-F9">Figure 9A</xref> in Section 4.</p>
      <p>The sort tree lets end users to inspect the distribution in the surface marker subspace at each stage and assess the fidelity of the clustering decisions made by CITE-sort. The sort tree also enables users to follow the sorting trajectory of any terminal cell population and register surface markers where the population have high or low levels of expressions. End users can then compare the sorting trajectory of each terminal cell population with existing gating strategies and annotate cell types according to domain knowledge.</p>
    </sec>
    <sec>
      <title>2.6 Pseudo code</title>
      <p>Let <inline-formula id="IE49"><mml:math id="IM49"><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>=</mml:mo><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> denote a CLR-transformed ADT dataset. Let <italic>N</italic> denote the number of droplets and <inline-formula id="IE50"><mml:math id="IM50"><mml:mi mathvariant="script">F</mml:mi><mml:mo>=</mml:mo><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> denote the <italic>M</italic>-dimensional surface marker space of the dataset. CITE-sort takes <inline-formula id="IE51"><mml:math id="IM51"><mml:mi mathvariant="bold-italic">D</mml:mi></mml:math></inline-formula> as input and returns the root node of the binary sort tree <inline-graphic xlink:href="btaa467ilf1.jpg" mimetype="image"/>. Each node in <inline-formula id="IE53"><mml:math id="IM52"><mml:mi mathvariant="script">T</mml:mi></mml:math></inline-formula><inline-graphic xlink:href="btaa467ilf1.jpg" mimetype="image"/> stores the surface marker subspace selected for clustering, the current subpopulation of the node and pointers to children nodes (leaf nodes point to NULL). The pseudo code of CITE-sort is provided in <xref ref-type="boxed-text" rid="btaa467-BOX1">Algorithm 1</xref>.</p>
      <p>
        <boxed-text id="btaa467-BOX1" position="float" orientation="portrait">
          <sec>
            <title><bold>Algorithm 1</bold>. The pseudo code of CITE-sort.</title>
            <p><monospace><bold>ALGORITHM</bold></monospace>: <bold>CITE_SORT</bold>(<inline-formula id="IE54"><mml:math id="IM53"><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="normal">ε</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">θ</mml:mi></mml:math></inline-formula>)</p>
            <p><monospace><bold>INPUT</bold></monospace>: Dataset <inline-formula id="IE55"><mml:math id="IM54"><mml:mi mathvariant="bold-italic">D</mml:mi></mml:math></inline-formula>. Merging threshold <inline-formula id="IE56"><mml:math id="IM55"><mml:mo>ε</mml:mo></mml:math></inline-formula>, defaults to 0.1.</p>
            <p>    Upper bound of subspace cardinality <inline-formula id="IE57"><mml:math id="IM56"><mml:mi>t</mml:mi></mml:math></inline-formula>, defaults to 2.</p>
            <p>    Minimum cluster size <inline-formula id="IE58"><mml:math id="IM57"><mml:mo>θ</mml:mo></mml:math></inline-formula>, defaults to 10.</p>
            <p><monospace><bold>OUTPUT</bold></monospace>: A binary tree <inline-graphic xlink:href="btaa467ilf1.jpg" mimetype="image"/>.</p>
            <p> <inline-graphic xlink:href="btaa467ilf1.jpg" mimetype="image"/><inline-formula id="IE60"><mml:math id="IM58"><mml:mo>←</mml:mo></mml:math></inline-formula> new <bold>BTreeNode</bold></p>
            <p>
              <bold> </bold>
              <inline-graphic xlink:href="btaa467ilf1.jpg" mimetype="image"/>
              <inline-formula id="IE61">
                <mml:math id="IM59">
                  <mml:mo>.</mml:mo>
                  <mml:mi mathvariant="normal">subpupulation</mml:mi>
                  <mml:mo>←</mml:mo>
                  <mml:mi mathvariant="bold-italic">D</mml:mi>
                </mml:math>
              </inline-formula>
            </p>
            <p>
              <bold> </bold>
              <inline-graphic xlink:href="btaa467ilf1.jpg" mimetype="image"/>
              <inline-formula id="IE62">
                <mml:math id="IM60">
                  <mml:mo>.</mml:mo>
                  <mml:mi mathvariant="normal">left</mml:mi>
                  <mml:mo>_</mml:mo>
                  <mml:mi mathvariant="normal">child</mml:mi>
                  <mml:mo>,</mml:mo>
                </mml:math>
              </inline-formula>
              <inline-graphic xlink:href="btaa467ilf1.jpg" mimetype="image"/>
              <inline-formula id="IE62a">
                <mml:math id="IM61">
                  <mml:mo>.</mml:mo>
                  <mml:mi mathvariant="normal">right</mml:mi>
                  <mml:mo>_</mml:mo>
                  <mml:mi mathvariant="normal">child</mml:mi>
                  <mml:mo>←</mml:mo>
                  <mml:mi mathvariant="bold">NULL</mml:mi>
                </mml:math>
              </inline-formula>
            </p>
            <p> /*** STEP 0 Stop criteria I ***/</p>
            <p>
              <monospace>
                <bold> IF</bold>
              </monospace>
              <inline-formula id="IE63">
                <mml:math id="IM62">
                  <mml:mfenced open="|" close="|" separators="|">
                    <mml:mrow>
                      <mml:mi mathvariant="bold-italic">D</mml:mi>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mo>&lt;</mml:mo>
                  <mml:mi mathvariant="normal"> </mml:mi>
                  <mml:mo>θ</mml:mo>
                </mml:math>
              </inline-formula>
            </p>
            <p>  <bold>RETURN</bold><inline-graphic xlink:href="btaa467ilf1.jpg" mimetype="image"/></p>
            <p> /*** <bold>STEP 1 Generate subspace candidates</bold> ***/</p>
            <p>  <inline-formula id="IE65"><mml:math id="IM63"><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>←</mml:mo><mml:mo>[</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mo>]</mml:mo></mml:math></inline-formula></p>
            <p>  <bold>FOREACH</bold><inline-formula id="IE66"><mml:math id="IM64"><mml:mo>τ</mml:mo></mml:math></inline-formula><bold>IN</bold><inline-formula id="IE67"><mml:math id="IM65"><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>t</mml:mi></mml:math></inline-formula></p>
            <p>   FOREACH <inline-formula id="IE68"><mml:math id="IM66"><mml:mi>f</mml:mi><mml:mo>⊆</mml:mo><mml:mi mathvariant="script">F</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script"> </mml:mi><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo>τ</mml:mo></mml:math></inline-formula></p>
            <p>    <inline-formula id="IE69"><mml:math id="IM67"><mml:msub><mml:mrow><mml:mi mathvariant="italic">GMM</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo>←</mml:mo><mml:mo> </mml:mo></mml:math></inline-formula>Merge components in subspace <inline-formula id="IE70"><mml:math id="IM68"><mml:mi>f</mml:mi></mml:math></inline-formula> with threshold <inline-formula id="IE71"><mml:math id="IM69"><mml:mo>ε</mml:mo></mml:math></inline-formula>.</p>
            <p>    <monospace><bold>IF</bold></monospace><inline-formula id="IE72"><mml:math id="IM70"><mml:msub><mml:mrow><mml:mi mathvariant="italic">GMM</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mi>n</mml:mi><mml:mo>_</mml:mo><mml:mi mathvariant="italic">component</mml:mi><mml:mo>_</mml:mo><mml:mi mathvariant="italic">complex</mml:mi><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>&gt; 1</p>
            <p>     <inline-formula id="IE73"><mml:math id="IM71"><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mi mathvariant="italic">append</mml:mi><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula></p>
            <p>   <bold>ENDFOR</bold></p>
            <p><bold>   </bold> <monospace><bold>IF</bold></monospace><inline-formula id="IE74"><mml:math id="IM72"><mml:mi mathvariant="italic">length</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula></p>
            <p>    BREAK</p>
            <p>  ENDFOR</p>
            <p> /*** <bold>STEP 2 Stop criteria II</bold> ***/</p>
            <p> <monospace><bold>IF</bold></monospace><inline-formula id="IE75"><mml:math id="IM73"><mml:mi mathvariant="italic">length</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula></p>
            <p>  <bold>RETURN</bold><inline-graphic xlink:href="btaa467ilf1.jpg" mimetype="image"/></p>
            <p> /*** <bold>STEP 3 Score subspaces</bold> ***/</p>
            <p>
              <bold> </bold>
              <inline-formula id="IE77">
                <mml:math id="IM74">
                  <mml:mi>ℓ</mml:mi>
                  <mml:mfenced separators="|">
                    <mml:mrow>
                      <mml:mi mathvariant="normal">baseline</mml:mi>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mo>←</mml:mo>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="italic">log</mml:mi>
                    </mml:mrow>
                    <mml:mo>⁡</mml:mo>
                    <mml:mrow>
                      <mml:mi mathvariant="script">N</mml:mi>
                      <mml:mfenced separators="|">
                        <mml:mrow>
                          <mml:mi mathvariant="bold-italic">D</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="bold-italic">μ</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mo>Σ</mml:mo>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mrow>
                  </mml:mrow>
                </mml:math>
              </inline-formula>
            </p>
            <p> <inline-formula id="IE78"><mml:math id="IM75"><mml:mi>S</mml:mi><mml:mo>←</mml:mo><mml:mo>[</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mo>]</mml:mo></mml:math></inline-formula></p>
            <p>  <bold>FOREACH</bold><inline-formula id="IE79"><mml:math id="IM76"><mml:mi>f</mml:mi></mml:math></inline-formula><bold>IN</bold><inline-formula id="IE80"><mml:math id="IM77"><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></p>
            <p>  <bold>FOREACH</bold><inline-formula id="IE81"><mml:math id="IM78"><mml:mi>c</mml:mi></mml:math></inline-formula><monospace><bold>IN</bold></monospace><inline-formula id="IE82"><mml:math id="IM79"><mml:msub><mml:mrow><mml:mi mathvariant="italic">GMM</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mi mathvariant="italic">component</mml:mi><mml:mo>_</mml:mo><mml:mi mathvariant="italic">complex</mml:mi></mml:math></inline-formula></p>
            <p>   Bi-partition <inline-formula id="IE83"><mml:math id="IM80"><mml:msub><mml:mrow><mml:mi mathvariant="script">B</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula><inline-formula id="IE84"><mml:math id="IM81"><mml:mo>←</mml:mo><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub><mml:mo>∉</mml:mo><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula></p>
            <p>      <inline-formula id="IE85"><mml:math id="IM82"><mml:mi>ℓ</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">B</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>←</mml:mo><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0,1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>·</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE86"><mml:math id="IM83"><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula></p>
            <p>
              <italic>      </italic>
              <inline-formula id="IE87">
                <mml:math id="IM84">
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>S</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>f</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>←</mml:mo>
                  <mml:mi>ℓ</mml:mi>
                  <mml:mfenced separators="|">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi mathvariant="script">B</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>f</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>c</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mo>-</mml:mo>
                  <mml:mo> </mml:mo>
                  <mml:mi>ℓ</mml:mi>
                  <mml:mfenced separators="|">
                    <mml:mrow>
                      <mml:mi mathvariant="normal">baseline</mml:mi>
                    </mml:mrow>
                  </mml:mfenced>
                </mml:math>
              </inline-formula>
            </p>
            <p>   <inline-formula id="IE88"><mml:math id="IM85"><mml:mi>S</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="italic">append</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula></p>
            <p>  <bold>ENDFOR</bold></p>
            <p> <bold>ENDFOR</bold></p>
            <p> /*** <bold>STEP 4 Bi-partition and update mixing weights</bold> ***/</p>
            <p>
              <bold> </bold>
              <inline-formula id="IE89">
                <mml:math id="IM86">
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi mathvariant="script">B</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>f</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">*</mml:mi>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mo>,</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>c</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">*</mml:mi>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>←</mml:mo>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mi>arg</mml:mi>
                      <mml:mo> </mml:mo>
                    </mml:mrow>
                    <mml:mo>⁡</mml:mo>
                    <mml:mrow>
                      <mml:mi>max</mml:mi>
                      <mml:mo>⁡</mml:mo>
                      <mml:mo>(</mml:mo>
                      <mml:mi>S</mml:mi>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:math>
              </inline-formula>
            </p>
            <p> <inline-graphic xlink:href="btaa467ilf1.jpg" mimetype="image"/><inline-formula id="IE90"><mml:math id="IM87"><mml:mo>.</mml:mo><mml:mi mathvariant="italic">key</mml:mi><mml:mo>←</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula></p>
            <p> <inline-formula id="IE91"><mml:math id="IM88"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>←</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">B</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula></p>
            <p> /*** <bold>STEP 5 Recursion</bold> ***/</p>
            <p>
              <bold> </bold>
              <inline-graphic xlink:href="btaa467ilf1.jpg" mimetype="image"/>
              <inline-formula id="IE92">
                <mml:math id="IM89">
                  <mml:mo>.</mml:mo>
                  <mml:mi mathvariant="normal">left</mml:mi>
                  <mml:mo>_</mml:mo>
                  <mml:mi mathvariant="normal">child</mml:mi>
                  <mml:mo>←</mml:mo>
                  <mml:mi mathvariant="normal">CITE</mml:mi>
                  <mml:mo>_</mml:mo>
                  <mml:mi mathvariant="normal">SORT</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi mathvariant="bold-italic">D</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:mo>ε</mml:mo>
                  <mml:mo>,</mml:mo>
                  <mml:mi>t</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mo>θ</mml:mo>
                  <mml:mo>)</mml:mo>
                </mml:math>
              </inline-formula>
            </p>
            <p>
              <bold> </bold>
              <inline-graphic xlink:href="btaa467ilf1.jpg" mimetype="image"/>
              <inline-formula id="IE93">
                <mml:math id="IM90">
                  <mml:mo>.</mml:mo>
                  <mml:mi mathvariant="normal">right</mml:mi>
                  <mml:mo>_</mml:mo>
                  <mml:mi mathvariant="normal">child</mml:mi>
                  <mml:mo>←</mml:mo>
                  <mml:mi mathvariant="normal">CITE</mml:mi>
                  <mml:mo>_</mml:mo>
                  <mml:mi mathvariant="normal">SORT</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi mathvariant="bold-italic">D</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:mo>ε</mml:mo>
                  <mml:mo>,</mml:mo>
                  <mml:mi>t</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mo>θ</mml:mo>
                  <mml:mo>)</mml:mo>
                </mml:math>
              </inline-formula>
            </p>
            <p>
              <italic> </italic>
              <bold>RETURN</bold>
              <inline-graphic xlink:href="btaa467ilf1.jpg" mimetype="image"/>
            </p>
          </sec>
        </boxed-text>
      </p>
    </sec>
  </sec>
  <sec>
    <title>3 Datasets</title>
    <sec>
      <title>3.1 Real datasets</title>
      <p>We tested CITE-sort with three in-house PBMC CITE-seq dataset as well as five public CITE-seq datasets. For the three in house datasets, cells were drawn from two healthy donor described in a previous study (<xref rid="btaa467-B32" ref-type="bibr">Sun <italic>et al.</italic>, 2019</xref>). The cell assays were prepared using the 10× Genomics platform with Gel Bead Kit V2, and was subsequently sequenced on an Illumina HiSeq with a depth of 50K reads per cell. We measured 10 surface markers on every cell. They were: CD3, CD4, CD8, CD11c, CD14, CD16, CD19, CD56, CD127 and CD154. We performed downstream analysis with CellRanger-3.0. Public datasets include three PBMC datasets, one marginal zone B-cell tumor (MALT: mucosa-associated lymphoid tissue) dataset and one cord blood mononuclear cells (CBMCs) dataset (<xref rid="btaa467-B30" ref-type="bibr">Stoeckius <italic>et al.</italic>, 2017</xref>). Detailed information of all real datasets is summarized in <xref rid="btaa467-T1" ref-type="table">Table 1</xref>.
</p>
      <table-wrap id="btaa467-T1" orientation="portrait" position="float">
        <label>Table 1.</label>
        <caption>
          <p>Overview of CITE-seq datasets</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Dataset</th>
              <th rowspan="1" colspan="1">No. of droplets</th>
              <th rowspan="1" colspan="1">No. of ADTs</th>
              <th rowspan="1" colspan="1">Source</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">PBMC_1k</td>
              <td rowspan="1" colspan="1">713</td>
              <td rowspan="1" colspan="1">17</td>
              <td rowspan="1" colspan="1">10X Genomics</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">PBMC_1k_b</td>
              <td rowspan="1" colspan="1">1388</td>
              <td rowspan="1" colspan="1">10</td>
              <td rowspan="1" colspan="1">In house</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">PBMC_2k</td>
              <td rowspan="1" colspan="1">1966</td>
              <td rowspan="1" colspan="1">10</td>
              <td rowspan="1" colspan="1">In house</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">PBMC_5k</td>
              <td rowspan="1" colspan="1">5247</td>
              <td rowspan="1" colspan="1">32</td>
              <td rowspan="1" colspan="1">10X Genomics</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">PBMC_8k</td>
              <td rowspan="1" colspan="1">7865</td>
              <td rowspan="1" colspan="1">17</td>
              <td rowspan="1" colspan="1">10X Genomics</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MALT_8k</td>
              <td rowspan="1" colspan="1">8412</td>
              <td rowspan="1" colspan="1">17</td>
              <td rowspan="1" colspan="1">10X Genomics</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CBMC_8k</td>
              <td rowspan="1" colspan="1">8617</td>
              <td rowspan="1" colspan="1">13</td>
              <td rowspan="1" colspan="1">GSE100866</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">PBMC_16k (with cell hashing)</td>
              <td rowspan="1" colspan="1">15 839</td>
              <td rowspan="1" colspan="1">10</td>
              <td rowspan="1" colspan="1">In house</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>We focus our evaluation of CITE-sort with the PBMC_16k dataset. For the PBMC_16k dataset, in addition to CITE-seq, we also performed cell hashing (<xref rid="btaa467-B31" ref-type="bibr">Stoeckius <italic>et al.</italic>, 2018</xref>) with four hashtags. Cell hashing enables technicians to increase the population of cells in a single scRNA-seq run, and it facilitates analytical identification of a significant fraction of multiplets. Previous work has demonstrated analytical classification of putative homogeneous droplet populations into ATCs and BTCs with cell hashing (<xref rid="btaa467-B39" ref-type="bibr">Xin <italic>et al.</italic>, 2019</xref>). In a cell-hashed scRNA-seq dataset, droplets are categorized into either multi-sample multiplets (MSM) or single-sample droplets (SSDs). Prior work (<xref rid="btaa467-B39" ref-type="bibr">Xin <italic>et al.</italic>, 2019</xref>) has established that ACT clusters have MSM percentages approaching and exceeding <inline-formula id="IE95"><mml:math id="IM91"><mml:mn>1</mml:mn><mml:mo> </mml:mo><mml:mo>-</mml:mo><mml:mo> </mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>H</mml:mi></mml:math></inline-formula>, where <inline-formula id="IE96"><mml:math id="IM92"><mml:mi>H</mml:mi></mml:math></inline-formula> is the number of hashtags used in cell hashing (assuming even cell distributions among samples in cell hashing). For the PBMC_16k dataset, we used <inline-formula id="IE97"><mml:math id="IM93"><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:math></inline-formula> hashtags. If a putative homogeneous droplet cluster in PBMC_16k has an MSM ratio approaching or exceeding 75%, then it is highly likely to be an ACT cluster. We used GMM-Demux (<xref rid="btaa467-B39" ref-type="bibr">Xin <italic>et al.</italic>, 2019</xref>) to classify droplets into MSMs and SSDs.</p>
      <p>It is important to establish the evaluation of CITE-sort with cell-hashed CITE-seq datasets. The MSM ratio of a cluster serves as an important signature of whether the cluster is an ACT or BCT. The ratios of MSMs in suspicious ACT clusters can be used to validate the efficacy of CITE-sort in separating ACT clusters from BCT clusters: high MSM content in suspicious ACT clusters and low MSM content in BCT clusters suggest that CITE-sort achieves high precision in isolating ACT clusters from BCT clusters; while the opposite indicates that the suspect ACT clusters have absorbed excessive BCT droplets because of poor clustering performance. Given that PBMC_16k is the only available cell-hashed CITE-seq dataset, we focus the evaluation of CITE-sort over the PBMC_16k dataset.</p>
    </sec>
    <sec>
      <title>3.2 Simulation datasets</title>
      <p>We generated a number of CITE-seq simulation datasets according to the droplet formation model described in <xref rid="btaa467-B39" ref-type="bibr">Xin <italic>et al.</italic> (2019)</xref>. Specifically, we assumed that cells were randomly distributed into a finite number of droplets. We prepared synthetic cells by sampling droplets from the in-house PBMC dataset. All synthetic cells are hand curated into one of the five BCT through manual gating, which is summarized in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>. Synthetic cells are randomly distributed to droplets. If a droplet is assigned with a single cell, then the raw ADT (yet to be CLR normalized) profile of the droplet equals to the raw ADT counts of its member cell. Otherwise, if a droplet is assigned with multiple cells, the raw ADT profile of the droplet equals to the sum of raw ADT counts over all member cells. Empty droplets are removed after simulation.</p>
      <p>Droplets are labeled according to their member cell(s). ACT droplets that have different cell type compositions are assigned different labels. With <inline-formula id="IE98"><mml:math id="IM94"><mml:mi>M</mml:mi></mml:math></inline-formula> biological cell types in a simulation, there could be as many as <inline-formula id="IE99"><mml:math id="IM95"><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> distinct droplet labels, including M BCT labels and up to <inline-formula id="IE100"><mml:math id="IM96"><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mi mathvariant="normal">M</mml:mi><mml:mo> </mml:mo><mml:mo>-</mml:mo><mml:mo> </mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> ACT labels. The droplet labels from simulation are used as the ground truth.</p>
      <p>We performed two sets of simulations. In the first set, we controlled the percentage of ACT droplets at 5% and gradually increased the number of BCT in each simulation, from 2 to 5. In the second set, we fixed the number of BCT at 4 but gradually increased the ACT droplet percentage, from 5% to 25% with a 5% increase per step.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Results</title>
    <sec>
      <title>4.1 Accuracy evaluation on simulated datasets</title>
      <p>We compared CITE-sort against six other clustering methods: k-means++, k-means++ with PCA, k-means++ with tSNE, GMM, GMM with PCA and GMM with tSNE. For both PCA- and tSNE-based clustering, we reduced the dimensions of each dataset to three. For k-means++, we used the elbow method with inertia (<xref rid="btaa467-B5" ref-type="bibr">Bholowalia and Kumar, 2014</xref>) to select the number of clusters <inline-formula id="IE101"><mml:math id="IM97"><mml:mi>K</mml:mi></mml:math></inline-formula>; for GMM, we used the Dirichlet process to infer <inline-formula id="IE102"><mml:math id="IM98"><mml:mi>K</mml:mi></mml:math></inline-formula> from the data (<xref rid="btaa467-B6" ref-type="bibr">Blei and Jordan, 2006</xref>; <xref rid="btaa467-B10" ref-type="bibr">Görür and Rasmussen, 2010</xref>).</p>
      <p>We benchmark CITE-sort against the other six clustering methods on both sets of simulation datasets. We compare the clustering outcome of each clustering method based on both the Adjusted Rand Index (ARI) score and the Adjusted Mutual Information (AMI) score against the ground truth. As shown in <xref ref-type="fig" rid="btaa467-F7">Figure 7</xref>, CITE-sort has the best performance across the board in both experimental settings. Especially, when measured in AMI score, CITE-sort always leads other methods by at least 0.1 on average. Previous work (<xref rid="btaa467-B25" ref-type="bibr">Romano <italic>et al.</italic>, 2016</xref>) has shown that AMI creates more accurate measurements than ARI, under scenarios where the cluster sizes are highly unequal in ground truth. Therefore, maintaining a commanding lead in AMI scores under low ACT droplet percentages proves that CITE-sort outperforms other clustering methods when clusters contain significant mixing coefficient imbalances. k-means++, GMM and their variants, on the other hand, have much inferior AMI scores under low ACT droplet percentages.
</p>
      <fig id="btaa467-F7" orientation="portrait" position="float">
        <label>Fig. 7.</label>
        <caption>
          <p>Performances of CITE-sort compared against six other common clustering methods under (<bold>A</bold>) variable number of cell types (fixing ACT droplet percentage at 5%) and (<bold>B</bold>) variable ACT droplet percentages (fixing the number of biological cell types at 4)</p>
        </caption>
        <graphic xlink:href="btaa467f7"/>
      </fig>
      <p>The clustering results of each simulation dataset is presented in <xref ref-type="fig" rid="btaa467-F8">Figure 8</xref>. Comparing to the other six clustering methods, CITE-sort produces clustering results that are most consistent with the ground truth. The reason that the clustering accuracy of GMM and k-means++ increases when more cell types are added to the simulation under a fixed ACT percentage threshold (5%) is that ACT droplets are distributed into a rapidly increasing number of ACT clusters (the number of ACT clusters grows exponentially as more cell types are added). With much more diluted ACT clusters, the influence of ACT clusters in disrupting the separation of BCT clusters decreases. Hence GMM and k-means++ register better performances. Eventually, as ACT clusters become increasingly sparse, we estimate that the performances of GMM and k-means++ will climb to the same level as CITE-sort. Nevertheless, to reduce the ACT percentage, technicians will have to drastically limit the number of cells loaded in a cell assay, which significantly limits the applicability of GMM and k-means++ in real datasets.
</p>
      <fig id="btaa467-F8" orientation="portrait" position="float">
        <label>Fig. 8.</label>
        <caption>
          <p>Clustering results of CITE-sort, k-means++ and GMM with regard to eight simulation datasets. Different colors denote distinct clusters</p>
        </caption>
        <graphic xlink:href="btaa467f8"/>
      </fig>
    </sec>
    <sec>
      <title>4.2 Constructing sort trees in real datasets</title>
      <p><xref ref-type="fig" rid="btaa467-F9">Figure 9A</xref> demonstrates the sort tree of the PBMC_16k dataset. In this dataset, clustering is performed in either 1D or 2D surface marker subspaces in each step. Depending on the dimension of the surface marker subspace, each inner node is visualized with either a histogram or a 2D scatter plot. In each plot, we use red and blue to highlight the two parts after bi-partition and assigned colors to edges in the sort tree correspondingly. Each leaf node is annotated according to a standard PBMC gating strategy (<xref rid="btaa467-B21" ref-type="bibr">Maecker <italic>et al.</italic>, 2012</xref>). We labeled leaf nodes that cannot be explained by the standard gating strategy as suspect ACT clusters. Leaf nodes are supplemented with its population percentages and MSM percentages. As mentioned in Section 3.1, according to GMM-Demux, droplet clusters with MSM percentages approaching and exceeding 75% (<inline-formula id="IE103"><mml:math id="IM99"><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:math></inline-formula> in this dataset) are ACT droplet clusters. We observe that most suspect ACT clusters have high MSM percentages. Overall, we find an estimated 19.3% of all droplets that are ACT droplets.
</p>
      <fig id="btaa467-F9" orientation="portrait" position="float">
        <label>Fig. 9.</label>
        <caption>
          <p>(<bold>A</bold>) The single-cell sort tree of PBMC_16K. Each node represents a subpopulation. The title of each inner node represents the surface markers subspace for subdivision. Red and blue colors represent the two parts in bi-partition. Edges are colored accordingly. Leaf nodes are hand curated and are annotated with domain knowledge. Cell types that should not exist are labeled as suspect ACT clusters. Suspect ACT clusters are characterized by their population percentages in the overall dataset (denoted by ‘prop’) and their MSM percentages (denoted by ‘MSM’). (<bold>B</bold>) CITE-sort clustering result. (<bold>C</bold>) Manual clustering result. (<bold>D</bold>) GMM clustering result. All clustering results are projected over the tSNE-transformed 2D surface marker pane. iNK, intermediate CD16<sup>−</sup> NK cells; mNK, vast majority of NK cells; C-mono, classical monocytes; NC-mono, non-classical CD16<sup>+</sup> monocytes; DC, dendritic cell; mDC, myeloid dendritic cell; DNT, double negative T cells</p>
        </caption>
        <graphic xlink:href="btaa467f9"/>
      </fig>
      <p>The sort tree of PBMC_16k is highly consistent with existing gating strategies (see <xref ref-type="fig" rid="btaa467-F3">Fig. 3</xref>). Compared to manual gating (<xref ref-type="fig" rid="btaa467-F3">Fig. 3</xref>), CITE-sort achieves greater clustering resolutions. In particular, CITE-sort subdivides NK cells into majority NK cell and intermediate NK cell subtypes; monocytes into classical monocytes and non-classical monocytes; and DCs into CD4<sup>+</sup> DCs, CD8<sup>+</sup> DCs and myeloid DCs. CITE-sort also splits double negative (CD4<sup>−</sup>CD8<sup>−</sup>) T cells from other T cells. Such resolution is hard to guarantee in manual gating. The resemblance between the sort tree and common gating strategies validates the clustering logic of CITE-sort. GMM and k-means++, on the other hand, lacks interpretability and thus renders their clustering results more difficult to verify.</p>
      <p><xref ref-type="fig" rid="btaa467-F9">Figure 9B</xref> presents the CITE-sort clustering result of PBMC_16k in a 2D tSNE plot. Compared to GMM (<xref ref-type="fig" rid="btaa467-F9">Fig. 9D</xref>), CITE-sort clustering is more consistent with human-supervised manual clustering (<xref ref-type="fig" rid="btaa467-F9">Fig. 9C</xref>). Further comparison shows that major cell types in PBMC have highly consistent scopes in both CITE-sort (<xref ref-type="fig" rid="btaa467-F9">Fig. 9B</xref>) and manual gating (<xref ref-type="fig" rid="btaa467-F9">Fig. 9C</xref>) clustering results, showcasing the accuracy of CITE-sort in cell sorting.</p>
      <p><xref ref-type="fig" rid="btaa467-F10">Figure 10</xref> illustrates the effectiveness of CITE-sort in segregating ACT clusters. In <xref ref-type="fig" rid="btaa467-F10">Figure 10B</xref>, we combine all hand-curated ACT clusters into a single ACT class. We use GMM-Demux to classify droplets into MSMs and SSDs (<xref ref-type="fig" rid="btaa467-F10">Fig. 10A</xref>). Comparing <xref ref-type="fig" rid="btaa467-F10">Figure 10A and B</xref>, we observe that the combined ACT super-cluster accurately outlines major MSM-rich regions. As previously discussed, high MSM concentrations in suspect ACT clusters and low concentration of MSMs in BCT clusters prove the accuracy of CITE-sort in segregating ACT clusters from BCT clusters.
</p>
      <fig id="btaa467-F10" orientation="portrait" position="float">
        <label>Fig. 10.</label>
        <caption>
          <p>tSNE visualization of (<bold>A</bold>) MSMs identified through cell hashing, (<bold>B</bold>) suspect ACT clusters identified by CITE-sort and (<bold>C</bold>) doublets identified by scrublet. The x and y axis are the first and second dimensions, respectively, given by tSNE. Percentages of ACTs/doublets identified by CITE-sort/scrublet are presented in the top right corner</p>
        </caption>
        <graphic xlink:href="btaa467f10"/>
      </fig>
      <p>We also compared the ACT annotation over CITE-sort against an RNA-based doublet identification method, scrublet (<xref rid="btaa467-B38" ref-type="bibr">Wolock <italic>et al.</italic>, 2019</xref>). The classification result of scrublet is shown in <xref ref-type="fig" rid="btaa467-F9">Figure 9C</xref>. Scrublet identifies doublets by analyzing the RNA expression profile of a scRNA-seq experiment. It simulates artificial doublets from the dataset and checks if a droplet has an expression profile that matches the expression profile of any simulated doublet. Comparing to <xref ref-type="fig" rid="btaa467-F9">Figure 9B</xref>, <xref ref-type="fig" rid="btaa467-F9">Figure 9C</xref> only highlights a fraction of the multiplets (19.3% versus 6.4%) and completely misses a few doublet clusters (highlighted in circles). Since it leaves a large number of ACTs unidentified, it denies the possibility of clustering droplets after removing all ACTs. Removing all MSMs is also insufficient. Not all droplets in ACT clusters are MSMs while not all droplets in BCT clusters are SSDs. Removing MSMs does not completely erase ACT clusters. Other doublet removal tools, such as GMM-Demux requires pre-preparation of droplets into clusters and can only checks if an entire cluster is an ACT cluster. Overall, CITE-sort is the only ACT-aware CITE-seq clustering method.</p>
      <p>In addition to PBMC_16k, we also tested CITE-sort on the other seven CITE-seq datasets. We benchmarked CITE-sort against GMM and its variants. Detailed description of each method and results are provided in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Method</xref> S1. Unfortunately, without cell hashing, we are unable to benchmark the accuracy of ACT classifications by CITE-sort. Instead, we measure the likelihood of the final model in describing the distributions of the datasets. CITE-sort achieves the highest likelihood in all datasets and terminates in comparable time against other methods.</p>
    </sec>
  </sec>
  <sec>
    <title>5 Discussion</title>
    <p>CITE-sort is the first ACT-aware surface marker clustering method for CITE-seq datasets. CITE-sort specifically targets datasets where clusters in high-dimensional space collapse into fewer, more balanced clusters in low-dimensional subspaces. CITE-sort is not a universal clustering method. While it is possible to construct datasets where CITE-sort produces inferior clustering results than GMM; or CITE-sort has to scan through a large number of low-dimensional subspaces before finding a qualifying candidate, in real CITE-seq datasets, most cell types collapse into very few Gaussian components when viewed in any single or dual surface marker subspaces. In fact, popular manual gating tools, such as FlowJo (<xref rid="btaa467-B33" ref-type="bibr">Tree Star, Inc., 2020</xref>) and Kaluza (<xref rid="btaa467-B4" ref-type="bibr">Beckman Coulter, 2020</xref>) are built upon this observation where cells are always grouped into few Gaussian clusters when viewed in low dimensions (usually in 2D). Given these characteristics of CITE-seq datasets, CITE-sort is able to scale to higher dimensional surface marker spaces, even as the number of surface markers grows up to 100 and beyond in future CITE-seq datasets.</p>
  </sec>
  <sec>
    <title>6 Conclusion</title>
    <p>In this article, we introduced CITE-sort, an interpretable clustering framework for CITE-seq datasets, which groups droplets into clusters in an unsupervised manner. CITE-sort is robust to ACT that stem from multiplets. CITE-sort is the first clustering method for CITE-seq that is aware of ACT. CITE-sort generates biologically meaningful interpretations to its clustering results. We applied CITE-sort on both real and simulated CITE-seq datasets and show that CITE-sort not only outperforms canonical clustering methods in accuracy, but also generates a single cell sort tree, which helps in annotating cell types, validating clustering results and identifying artificial-type droplet clusters.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by National Institutes of Health [R01HL137709 to W.C. and K.C.]; and National Natural Science Foundation of China [61922047, 81890993 and 61721003].</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btaa467_Supplementary_Data</label>
      <media xlink:href="btaa467_supplementary_data.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btaa467-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Aevermann</surname><given-names>B.D.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Cell type discovery using single-cell transcriptomics: implications for ontological representation</article-title>. <source>Human Mol. Genet</source>., <volume>27</volume>, <fpage>R40</fpage>–<lpage>R47</lpage>.<pub-id pub-id-type="pmid">29590361</pub-id></mixed-citation>
    </ref>
    <ref id="btaa467-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ahmed</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>A public BCR present in a unique dual-receptor-expressing lymphocyte from type 1 diabetes patients encodes a potent T cell autoantigen</article-title>. <source>Cell</source>, <volume>177</volume>, <fpage>1583</fpage>–<lpage>1599</lpage>.<fpage>e1516</fpage>.<pub-id pub-id-type="pmid">31150624</pub-id></mixed-citation>
    </ref>
    <ref id="btaa467-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Barcenilla</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Mass cytometry identifies distinct subsets of regulatory T cells and natural killer cells associated with high risk for type 1 diabetes</article-title>. <source>Front. Immunol</source>., <volume>10</volume>, <fpage>982</fpage>.<pub-id pub-id-type="pmid">31130961</pub-id></mixed-citation>
    </ref>
    <ref id="btaa467-B4">
      <mixed-citation publication-type="other">Beckman Coulter. (<year>2020</year>) <italic>Kaluza</italic>
<ext-link ext-link-type="uri" xlink:href="http://www.beckmancoulter.com">http://www.beckmancoulter.com</ext-link> (10 January 2020, date last accessed).</mixed-citation>
    </ref>
    <ref id="btaa467-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bholowalia</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Kumar</surname><given-names>A.</given-names></name></person-group> (<year>2014</year>) 
<article-title>EBK-means: a clustering technique based on elbow method and k-means in WSN</article-title>. <source>Int. J. Comput. Appl</source>., <volume>105</volume>, <fpage>17</fpage>–<lpage>24</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa467-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Blei</surname><given-names>D.M.</given-names></name>, <name name-style="western"><surname>Jordan</surname><given-names>M.I.</given-names></name></person-group> (<year>2006</year>) 
<article-title>Variational inference for Dirichlet process mixtures</article-title>. <source>Bayesian Anal</source>., <volume>1</volume>, <fpage>121</fpage>–<lpage>143</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa467-B7">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Bouveyron</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) <source>Model-Based Clustering and Classification for Data Science: With Applications in R</source>. 
<publisher-name>Cambridge University Press, Cambridge</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btaa467-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cuevas-Diaz Duran</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Single-cell RNA-sequencing of the brain</article-title>. <source>Clin. Transl. Med</source>., <volume>6</volume>, <fpage>20</fpage>.<pub-id pub-id-type="pmid">28597408</pub-id></mixed-citation>
    </ref>
    <ref id="btaa467-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cui</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Single-cell transcriptome analysis maps the developmental track of the human heart</article-title>. <source>Cell Rep</source>., <volume>26</volume>, <fpage>1934</fpage>–<lpage>1950.e1935</lpage>.<pub-id pub-id-type="pmid">30759401</pub-id></mixed-citation>
    </ref>
    <ref id="btaa467-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Görür</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Rasmussen</surname><given-names>C.E.</given-names></name></person-group> (<year>2010</year>) 
<article-title>Dirichlet process Gaussian mixture models: choice of the base distribution</article-title>. <source>J. Comput. Sci. Technol</source>., <volume>25</volume>, <fpage>653</fpage>–<lpage>664</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa467-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hennig</surname><given-names>C.</given-names></name></person-group> (<year>2010</year>) 
<article-title>Methods for merging Gaussian mixture components</article-title>. <source>Adv. Data Anal. Classif</source>., <volume>4</volume>, <fpage>3</fpage>–<lpage>34</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa467-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kharchenko</surname><given-names>P.V.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Bayesian approach to single-cell differential expression analysis</article-title>. <source>Nat. Methods</source>, <volume>11</volume>, <fpage>740</fpage>–<lpage>742</lpage>.<pub-id pub-id-type="pmid">24836921</pub-id></mixed-citation>
    </ref>
    <ref id="btaa467-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kiselev</surname><given-names>V.Y.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Challenges in unsupervised clustering of single-cell RNA-seq data</article-title>. <source>Nat. Rev. Genet</source>., <volume>20</volume>, <fpage>273</fpage>–<lpage>282</lpage>.<pub-id pub-id-type="pmid">30617341</pub-id></mixed-citation>
    </ref>
    <ref id="btaa467-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Klein</surname><given-names>A.M.</given-names></name>, <name name-style="western"><surname>Treutlein</surname><given-names>B.</given-names></name></person-group> (<year>2019</year>) 
<article-title>Single cell analyses of development in the modern era</article-title>. <source>Development</source>, <volume>146</volume>, <fpage>dev181396</fpage>.<pub-id pub-id-type="pmid">31249004</pub-id></mixed-citation>
    </ref>
    <ref id="btaa467-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Krawczyk</surname><given-names>B.</given-names></name></person-group> (<year>2016</year>) 
<article-title>Learning from imbalanced data: open challenges and future directions</article-title>. <source>Progr. Artif. Intell</source>., <volume>5</volume>, <fpage>221</fpage>–<lpage>232</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa467-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Landhuis</surname><given-names>E.</given-names></name></person-group> (<year>2018</year>) 
<article-title>Single-cell approaches to immune profiling</article-title>. <source>Nature</source>, <volume>557</volume>, <fpage>595</fpage>–<lpage>597</lpage>.<pub-id pub-id-type="pmid">29789748</pub-id></mixed-citation>
    </ref>
    <ref id="btaa467-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>W.V.</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>J.J.</given-names></name></person-group> (<year>2018</year>) 
<article-title>An accurate and robust imputation method scImpute for single-cell RNA-seq data</article-title>. <source>Nat. Commun</source>., <volume>9</volume>, <fpage>1</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">29317637</pub-id></mixed-citation>
    </ref>
    <ref id="btaa467-B18">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Lu</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) Bayes imbalance impact index: a measure of class imbalanced dataset for classification problem. <italic>IEEE Trans. Neural Netw. Learn. Syst.,</italic> 1, 1–13.</mixed-citation>
    </ref>
    <ref id="btaa467-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ma</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2000</year>) 
<article-title>Asymptotic convergence rate of the EM algorithm for Gaussian mixtures</article-title>. <source>Neural Comput</source>., <volume>12</volume>, <fpage>2881</fpage>–<lpage>2907</lpage>.<pub-id pub-id-type="pmid">11112259</pub-id></mixed-citation>
    </ref>
    <ref id="btaa467-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Macosko</surname><given-names>E.Z.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title>. <source>Cell</source>, <volume>161</volume>, <fpage>1202</fpage>–<lpage>1214</lpage>.<pub-id pub-id-type="pmid">26000488</pub-id></mixed-citation>
    </ref>
    <ref id="btaa467-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Maecker</surname><given-names>H.T.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Standardizing immunophenotyping for the human immunology project</article-title>. <source>Nat. Rev. Immunol</source>., <volume>12</volume>, <fpage>191</fpage>–<lpage>200</lpage>.<pub-id pub-id-type="pmid">22343568</pub-id></mixed-citation>
    </ref>
    <ref id="btaa467-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>McGinnis</surname><given-names>C.S.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>DoubletFinder: doublet detection in single-cell RNA sequencing data using artificial nearest neighbors</article-title>. <source>Cell Syst</source>., <volume>8</volume>, <fpage>329</fpage>–<lpage>337.e324</lpage>.<pub-id pub-id-type="pmid">30954475</pub-id></mixed-citation>
    </ref>
    <ref id="btaa467-B23">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Naim</surname><given-names>I.</given-names></name>, <name name-style="western"><surname>Gildea</surname><given-names>D.</given-names></name></person-group> (<year>2012</year>) Convergence of the EM algorithm for Gaussian mixtures with unbalanced mixing coefficients. In: <italic>Proceedings of the 29th International Conference on Machine Learning (ICML-12)</italic>, pp. <fpage>1655</fpage>–<lpage>1662</lpage>. Edinburgh, Scotland.</mixed-citation>
    </ref>
    <ref id="btaa467-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ortega</surname><given-names>M.A.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Using single-cell multiple omics approaches to resolve tumor heterogeneity</article-title>. <source>Clin. Transl. Med</source>., <volume>6</volume>, <fpage>46</fpage>.<pub-id pub-id-type="pmid">29285690</pub-id></mixed-citation>
    </ref>
    <ref id="btaa467-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Romano</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Adjusting for chance clustering comparison measures</article-title>. <source>J. Mach. Learn. Res</source>., <volume>17</volume>, <fpage>4635</fpage>–<lpage>4666</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa467-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schiller</surname><given-names>H.B.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>The Human Lung Cell Atlas: a high-resolution reference map of the human lung in health and disease</article-title>. <source>Am. J. Respir. Cell Mol. Biol</source>., <volume>61</volume>, <fpage>31</fpage>–<lpage>41</lpage>.<pub-id pub-id-type="pmid">30995076</pub-id></mixed-citation>
    </ref>
    <ref id="btaa467-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schwaber</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Shedding light: the importance of reverse transcription efficiency standards in data interpretation</article-title>. <source>Biomol. Detect. Quantif</source>., <volume>17</volume>, <fpage>100077</fpage>.<pub-id pub-id-type="pmid">30805297</pub-id></mixed-citation>
    </ref>
    <ref id="btaa467-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Spitzer</surname><given-names>M.H.</given-names></name>, <name name-style="western"><surname>Nolan</surname><given-names>G.P.</given-names></name></person-group> (<year>2016</year>) 
<article-title>Mass cytometry: single cells, many features</article-title>. <source>Cell</source>, <volume>165</volume>, <fpage>780</fpage>–<lpage>791</lpage>.<pub-id pub-id-type="pmid">27153492</pub-id></mixed-citation>
    </ref>
    <ref id="btaa467-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Stegle</surname><given-names>O.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Computational and analytical challenges in single-cell transcriptomics</article-title>. <source>Nat. Rev. Genet</source>., <volume>16</volume>, <fpage>133</fpage>–<lpage>145</lpage>.<pub-id pub-id-type="pmid">25628217</pub-id></mixed-citation>
    </ref>
    <ref id="btaa467-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Stoeckius</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Simultaneous epitope and transcriptome measurement in single cells</article-title>. <source>Nat. Methods</source>, <volume>14</volume>, <fpage>865</fpage>–<lpage>868</lpage>.<pub-id pub-id-type="pmid">28759029</pub-id></mixed-citation>
    </ref>
    <ref id="btaa467-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Stoeckius</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Cell hashing with barcoded antibodies enables multiplexing and doublet detection for single cell genomics</article-title>. <source>Genome Biol</source>., <volume>19</volume>, <fpage>224</fpage>.<pub-id pub-id-type="pmid">30567574</pub-id></mixed-citation>
    </ref>
    <ref id="btaa467-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sun</surname><given-names>Z.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>A Bayesian mixture model for clustering droplet-based single-cell transcriptomic data from population studies</article-title>. <source>Nat. Commun</source>., <volume>10</volume>, <fpage>1649</fpage>.<pub-id pub-id-type="pmid">30967541</pub-id></mixed-citation>
    </ref>
    <ref id="btaa467-B33">
      <mixed-citation publication-type="other">Tree Star, Inc. (<year>2020</year>) <italic>FlowJo</italic>
<ext-link ext-link-type="uri" xlink:href="http://www.flowjo.com/vX/en/ws.boolean.html">http://www.flowjo.com/vX/en/ws.boolean.html</ext-link> (5 January 2020, date last accessed).</mixed-citation>
    </ref>
    <ref id="btaa467-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Van Der Maaten</surname><given-names>L.</given-names></name></person-group> (<year>2014</year>) 
<article-title>Accelerating t-SNE using tree-based algorithms</article-title>. <source>J. Mach. Learn. Res</source>., <volume>15</volume>, <fpage>3221</fpage>–<lpage>3245</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa467-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Verschoor</surname><given-names>C.P.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>An introduction to automated flow cytometry gating tools and their implementation</article-title>. <source>Front. Immunol</source>., <volume>6</volume>, <fpage>380</fpage>.<pub-id pub-id-type="pmid">26284066</pub-id></mixed-citation>
    </ref>
    <ref id="btaa467-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wagner</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>A single-cell atlas of the tumor and immune ecosystem of human breast cancer</article-title>. <source>Cell</source>, <volume>177</volume>, <fpage>1330</fpage>–<lpage>1345.e1318</lpage>.<pub-id pub-id-type="pmid">30982598</pub-id></mixed-citation>
    </ref>
    <ref id="btaa467-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wolf</surname><given-names>F.A.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>. <source>Genome Biol</source>., <volume>19</volume>, <fpage>15</fpage>.<pub-id pub-id-type="pmid">29409532</pub-id></mixed-citation>
    </ref>
    <ref id="btaa467-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wolock</surname><given-names>S.L.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Scrublet: computational identification of cell doublets in single-cell transcriptomic data</article-title>. <source>Cell Syst</source>., <volume>8</volume>, <fpage>281</fpage>–<lpage>291.e289</lpage>.<pub-id pub-id-type="pmid">30954476</pub-id></mixed-citation>
    </ref>
    <ref id="btaa467-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Xin</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) Sample demultiplexing, multiplet detection, experiment planning and novel cell type verification in single cell sequencing. <italic>bioRxiv</italic>, <volume>2019</volume>, <fpage>828483</fpage>. doi:<pub-id pub-id-type="doi">10.1101/828483</pub-id>.</mixed-citation>
    </ref>
    <ref id="btaa467-B40">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Xuan</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) Exploring of clustering algorithm on class-imbalanced data. In: <italic>2013 8th International Conference on Computer Science &amp; Education</italic>, pp. <fpage>89</fpage>–<lpage>93</lpage>. IEEE. Colombo, Sri Lanka.</mixed-citation>
    </ref>
    <ref id="btaa467-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhao</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2020</year>) 
<article-title>Statistical convergence of the EM algorithm on Gaussian mixture models</article-title>. <source>Electron. J. Statist</source>., <volume>14</volume>, <fpage>632</fpage>–<lpage>660</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
