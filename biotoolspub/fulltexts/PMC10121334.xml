<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10121334</article-id>
    <article-id pub-id-type="pmid">37067484</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad188</article-id>
    <article-id pub-id-type="publisher-id">btad188</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Primerdiffer: a python command-line module for large-scale primer design in haplotype genotyping</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ren</surname>
          <given-names>Xiaoliang</given-names>
        </name>
        <aff><institution>Laboratory of Marine Organism Taxonomy and Phylogeny, Qingdao Key Laboratory of Marine Biodiversity and Conservation, Institute of Oceanology, Chinese Academy of Sciences</institution>, Qingdao 266071, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shao</surname>
          <given-names>Yanwen</given-names>
        </name>
        <aff><institution>Department of Infectious Diseases and Public Health, Jockey Club College of Veterinary Medicine and Life Sciences, City University of Hong Kong</institution>, Hong Kong, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Yiwen</given-names>
        </name>
        <aff><institution>Department of Infectious Diseases and Public Health, Jockey Club College of Veterinary Medicine and Life Sciences, City University of Hong Kong</institution>, Hong Kong, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ni</surname>
          <given-names>Ying</given-names>
        </name>
        <aff><institution>Department of Biomedical Sciences and Tung Biomedical Sciences Centre, City University of Hong Kong</institution>, Hong Kong, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bi</surname>
          <given-names>Yu</given-names>
        </name>
        <aff><institution>Department of Infectious Diseases and Public Health, Jockey Club College of Veterinary Medicine and Life Sciences, City University of Hong Kong</institution>, Hong Kong, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1563-1844</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Runsheng</given-names>
        </name>
        <aff><institution>Department of Infectious Diseases and Public Health, Jockey Club College of Veterinary Medicine and Life Sciences, City University of Hong Kong</institution>, Hong Kong, <country country="CN">China</country></aff>
        <aff><institution>Southern Marine Science and Engineering Guangdong Laboratory (Guangzhou)</institution>, Guangzhou, <country country="CN">China</country></aff>
        <xref rid="btad188-cor1" ref-type="corresp"/>
        <!--runsheng.li@cityu.edu.hk-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Alkan</surname>
          <given-names>Can</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad188-cor1">Corresponding author. Department of Infectious Diseases and Public Health, Jockey Club College of Veterinary Medicine and Life Sciences, City University of Hong Kong, Hong Kong, China. E-mail: <email>runsheng.li@cityu.edu.hk</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-04-17">
      <day>17</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>4</issue>
    <elocation-id>btad188</elocation-id>
    <history>
      <date date-type="received">
        <day>09</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>24</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>08</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>21</day>
        <month>4</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad188.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Primer design is a routine practice for modern molecular biology labs. Bioinformatics tools like primer3 and primer-blast have standardized the primer design for a specific region. However, large-scale primer design, especially for genome-wide screening, is still a labor-intensive job for most wet-lab researchers using these pipelines.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we present the primerdiffer pipeline, which can be used to batch design <underline>primer</underline>s that <underline>differ</underline>entiate haplotypes on a large scale with precise false priming checking. This command-line interface (CLI) pipeline includes greedy primer search, local and global <italic toggle="yes">in silico</italic> PCR-based false priming checking, and automated best primer selection. The local CLI application provides flexibility to design primers with the user’s own genome sequences and specific parameters. Some species-specific primers designed to genotype the hybrid introgression strains from <italic toggle="yes">Caenorhabditis briggsae</italic> and <italic toggle="yes">Caenorhabditis nigoni</italic> have been validated using single-worm PCR. This pipeline provides the first CLI-based large-scale primer design tool to differentiate haplotypes in any targeted region.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The open-source python modules are available at github (<ext-link xlink:href="https://github.com/runsheng/primerdiffer" ext-link-type="uri">https://github.com/runsheng/primerdiffer</ext-link>, <ext-link xlink:href="https://github.com/runsheng/primervcf" ext-link-type="uri">https://github.com/runsheng/primervcf</ext-link>) and Python package index (<ext-link xlink:href="https://pypi.org/project/primerdiffer/" ext-link-type="uri">https://pypi.org/project/primerdiffer/</ext-link>, <ext-link xlink:href="https://pypi.org/project/primervcf/" ext-link-type="uri">https://pypi.org/project/primervcf/</ext-link>).</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Hong Kong Branch of Southern Marine Science and Engineering Guangdong Laboratory</institution>
          </institution-wrap>
        </funding-source>
        <award-id>Guangzhou</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>PCR is still the dominating method to determine if a certain sequence is presented in a sample or not. Bioinformatics tools like primer3 (<xref rid="btad188-B6" ref-type="bibr">Untergasser et al. 2012</xref>) and primer-blast (<xref rid="btad188-B7" ref-type="bibr">Ye et al. 2012</xref>) have standardized the primer design for a specific region. However, large-scale primer design, especially for genome-wide screening, is still a labor-intensive job for most wet-lab researchers using these pipelines. Some web applications have been developed to design large-scale primers for real-time quantitative PCR (<xref rid="btad188-B1" ref-type="bibr">Arvidsson et al. 2008</xref>; <xref rid="btad188-B3" ref-type="bibr">Jeon et al. 2019</xref>) or pre-curated short sequences (<xref rid="btad188-B8" ref-type="bibr">You et al. 2008</xref>; <xref rid="btad188-B5" ref-type="bibr">Ramirez-Gonzalez et al. 2015</xref>). Still, none are suitable to design primers for chromosomal scale genotyping.</p>
    <p>For evolutionary biologists working on intra- or inter-species hybridization, a routine task could be genotyping the chromosomal crossover between haplotypes. For this purpose, the haplotype-specific primers for given syntenic regions would be needed to get the introgression boundaries. However, most of the web-based tools are specialized for model species and lack the feasibility for user-specific genomes. A command-line interface (CLI)-based pipeline would be more suitable for intermediate users who need more flexibility on target sequences.</p>
    <p>Here, we present the primerdiffer pipeline, which is used to batch design <underline>primers</underline> to <underline>differ</underline>entiate haplotypes with precise false priming checking. We employed a greedy primer design method to walk alongside the genome with given intervals or indels. Each primer is validated by <italic toggle="yes">in silico</italic> PCR to ensure specificity.</p>
  </sec>
  <sec>
    <title>2 Implementation and design</title>
    <p>The primerdiffer pipeline is used to design haplotype-specific primers, which can only amplify one haplotype but not the others. These primers can thus detect if a given fragment from a specific haplotype is presented in your sample.</p>
    <p>The full pipeline is divided into two parts, the primerdiffer module and the primervcf module, used to design primers for genotyping haplotypes with different similarities. The pipeline is invoked using a CLI written in python and requires a Unix-based operating system. The Python-abstracted API from the Primer3-py module is used to design primers by calling Primer3 libraries (<xref rid="btad188-B6" ref-type="bibr">Untergasser et al. 2012</xref>). The default parameters in the Primer3 library are inherited for the primer design. And the users can override the default cutoffs by providing additional lines in a user-defined config file. In addition, the primerdiffer module requires a local blast (<xref rid="btad188-B2" ref-type="bibr">Boratyn et al. 2012</xref>) for primer specificity check. The primervcf module is built on top of the primerdiffer module.</p>
  </sec>
  <sec>
    <title>3 Usage</title>
    <sec>
      <title>3.1 Design primers for inter-species haplotype genotyping</title>
      <p>The inter-species haplotypes have low sequence similarity, and a greedy method can be used to pick primers. Generally, the genome assembly for each haplotype would be available. The primerdiffer module takes two reference genome files (genome1 and genome2) in FASTA format as input. Positional information for genome1 can be provided to define the region used to search genome1 unique primers. We built an <italic toggle="yes">in silico</italic> PCR function based on blast (<xref rid="btad188-B7" ref-type="bibr">Ye et al. 2012</xref>) to check if the primer can only amplify one unique region in genome1 and no regions in genome2.</p>
      <p>By default, the given region would be divided into 5-kb intervals, and the pipeline would try to pick one primer for each interval (<xref rid="btad188-F1" ref-type="fig">Fig. 1</xref>). For each given region, the primerdiffer pipeline will try to use the top five primers generated by the Primer3 library. Each primer would be checked by <italic toggle="yes">in silico</italic> PCR against genome1 and genome2 with a maximum product size of 2 kb. If one primer can pass the specificity check, then the primer will be the output for this region. The full output would be a series of primers that only amplify genome1 but not genome2. The primer targeting position, forward/reverse primer, and product size will be written to a file.</p>
      <fig position="float" id="btad188-F1">
        <label>Figure 1</label>
        <caption>
          <p>Implementation of the primerdiffer pipeline</p>
        </caption>
        <graphic xlink:href="btad188f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 Design primers for intra-species haplotype genotyping</title>
      <p>The intra-species haplotypes have high sequence similarity and can be represented by variations. And genome2 will not be available for specificity check. The deletions (≥10 bp by default) are extracted from the VCF files using the PyVCF (<ext-link xlink:href="https://pypi.org/project/PyVCF3/" ext-link-type="uri">https://pypi.org/project/PyVCF3/</ext-link>) module. By forcing the overlapping of the forward or reverse primer with the deletion region, the haplotype-specific primers can be generated.</p>
      <p>Due to the repetitive nature of sequences near most deletions, both local and global primer specificity checks will be applied. The global specificity check is similar to the primerdiffer module, wherein the only primers retained are the ones that amplify a unique region in genome1. For the local specificity check, both the original sequence from genome1 and the modified sequence by removing the deleted nucleotides representing the other haplotype are used as references. The Striped Smith–Waterman (SSW) alignment (<xref rid="btad188-B9" ref-type="bibr">Zhao et al. 2013</xref>) is used to check if the primer overlaps with the new junction sequences (<xref rid="btad188-F1" ref-type="fig">Fig. 1</xref>). We have modified the python wrapper for SSW alignment and maintained a minimal functional python module in PyPI (<ext-link xlink:href="https://pypi.org/project/pyssw/" ext-link-type="uri">https://pypi.org/project/pyssw/</ext-link>) for easier installation.</p>
    </sec>
    <sec>
      <title>3.3 Additional tools</title>
      <p>The primerdeign.py script can also be used as a general-purpose primer design CLI tool by adjusting the config file. The ispcr.py script can be used as a CLI tool for <italic toggle="yes">in silico</italic> PCR with given primers and references. The fq2vcf.py script can generate the VCF file by mapping NGS reads to the reference with the bwa-mem (<xref rid="btad188-B4" ref-type="bibr">Li 2013</xref>).</p>
    </sec>
    <sec>
      <title>3.4 Example results</title>
      <p>Four pairs of species-specific primers designed to genotype <italic toggle="yes">Caenorhabditis briggsae</italic> or <italic toggle="yes">Caenorhabditis nigoni</italic> X chromosome are picked and validated using single-worm PCR (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). All eight primers showed specific amplification for their targets.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad188_Supplementary_Data</label>
      <media xlink:href="btad188_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> is available at <italic toggle="yes">Bioinformatics</italic> online.</p>
    <p>Conflict of interest: None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the Hong Kong Branch of Southern Marine Science and Engineering Guangdong Laboratory (Guangzhou) (SMSEGL20SC02), Early career scheme (project number 9048204) from the Hong Kong Research Grant Council, Hong Kong Health and Medical Research Fund (project number 9211280), and new Research Initiatives support from City University of Hong Kong (project number 9610497) to R.L.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad188-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Arvidsson</surname><given-names>S</given-names></string-name>, <string-name><surname>Kwasniewski</surname><given-names>M</given-names></string-name>, <string-name><surname>Riaño-Pachón</surname><given-names>DM</given-names></string-name></person-group><etal>et al</etal><article-title>QuantPrime—a flexible tool for reliable high-throughput primer design for quantitative PCR</article-title>. <source>BMC Bioinformatics</source><year>2008</year>;<volume>9</volume>:<fpage>465</fpage>.<pub-id pub-id-type="pmid">18976492</pub-id></mixed-citation>
    </ref>
    <ref id="btad188-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Boratyn</surname><given-names>GM</given-names></string-name>, <string-name><surname>Schäffer</surname><given-names>AA</given-names></string-name>, <string-name><surname>Agarwala</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Domain enhanced lookup time accelerated BLAST</article-title>. <source>Biol Direct</source><year>2012</year>;<volume>7</volume>:<fpage>12</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">22510480</pub-id></mixed-citation>
    </ref>
    <ref id="btad188-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jeon</surname><given-names>H</given-names></string-name>, <string-name><surname>Bae</surname><given-names>J</given-names></string-name>, <string-name><surname>Hwang</surname><given-names>S-H</given-names></string-name></person-group><etal>et al</etal><article-title>MRPrimerW2: an enhanced tool for rapid design of valid high-quality primers with multiple search modes for qPCR experiments</article-title>. <source>Nucleic Acids Res</source><year>2019</year>;<volume>47</volume>:<fpage>W614</fpage>–<lpage>W622</lpage>.<pub-id pub-id-type="pmid">31045205</pub-id></mixed-citation>
    </ref>
    <ref id="btad188-B4">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>H.</given-names></string-name></person-group> Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM, 2013. <ext-link xlink:href="https://github.com/lh3/bwa" ext-link-type="uri">https://github.com/lh3/bwa</ext-link>.</mixed-citation>
    </ref>
    <ref id="btad188-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ramirez-Gonzalez</surname><given-names>RH</given-names></string-name>, <string-name><surname>Uauy</surname><given-names>C</given-names></string-name>, <string-name><surname>Caccamo</surname><given-names>M.</given-names></string-name></person-group><article-title>PolyMarker: a fast polyploid primer design pipeline</article-title>. <source>Bioinformatics</source><year>2015</year>;<volume>31</volume>:<fpage>2038</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">25649618</pub-id></mixed-citation>
    </ref>
    <ref id="btad188-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Untergasser</surname><given-names>A</given-names></string-name>, <string-name><surname>Cutcutache</surname><given-names>I</given-names></string-name>, <string-name><surname>Koressaar</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>Primer3—new capabilities and interfaces</article-title>. <source>Nucleic Acids Res</source><year>2012</year>;<volume>40</volume>:<fpage>e115</fpage>.<pub-id pub-id-type="pmid">22730293</pub-id></mixed-citation>
    </ref>
    <ref id="btad188-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ye</surname><given-names>C</given-names></string-name>, <string-name><surname>Ma</surname><given-names>ZS</given-names></string-name>, <string-name><surname>Cannon</surname><given-names>CH</given-names></string-name></person-group><etal>et al</etal><article-title>Primer-BLAST: a tool to design target-specific primers for polymerase chain reaction</article-title>. <source>BMC Bioinformatics</source><year>2012</year>;<volume>13</volume>:<fpage>1</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">22214541</pub-id></mixed-citation>
    </ref>
    <ref id="btad188-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>You</surname><given-names>FM</given-names></string-name>, <string-name><surname>Huo</surname><given-names>N</given-names></string-name>, <string-name><surname>Gu</surname><given-names>YQ</given-names></string-name></person-group><etal>et al</etal><article-title>BatchPrimer3: a high throughput web application for PCR and sequencing primer design</article-title>. <source>BMC Bioinformatics</source><year>2008</year>;<volume>9</volume>:<fpage>253</fpage>.<pub-id pub-id-type="pmid">18510760</pub-id></mixed-citation>
    </ref>
    <ref id="btad188-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhao</surname><given-names>M</given-names></string-name>, <string-name><surname>Lee</surname><given-names>W-P</given-names></string-name>, <string-name><surname>Garrison</surname><given-names>EP</given-names></string-name></person-group><etal>et al</etal><article-title>SSW library: an SIMD Smith-Waterman C/C++ library for use in genomic applications</article-title>. <source>PLoS One</source><year>2013</year>;<volume>8</volume>:<fpage>e82138</fpage>.<pub-id pub-id-type="pmid">24324759</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
