<?properties open_access?>
<?subarticle pcbi.1007800.r001?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput. Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">ploscomp</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7162552</article-id>
    <article-id pub-id-type="pmid">32251445</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007800</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-19-00993</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Proteins</subject>
            <subj-group>
              <subject>DNA-binding proteins</subject>
              <subj-group>
                <subject>Transcription Factors</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Expression</subject>
            <subj-group>
              <subject>Gene Regulation</subject>
              <subj-group>
                <subject>Transcription Factors</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Proteins</subject>
            <subj-group>
              <subject>Regulatory Proteins</subject>
              <subj-group>
                <subject>Transcription Factors</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Expression</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Transcriptome Analysis</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Transcriptome Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene expression</subject>
            <subj-group>
              <subject>DNA transcription</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Enzymology</subject>
            <subj-group>
              <subject>Enzyme Chemistry</subject>
              <subj-group>
                <subject>Biochemical Cofactors</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Cognitive Science</subject>
            <subj-group>
              <subject>Cognition</subject>
              <subj-group>
                <subject>Memory</subject>
                <subj-group>
                  <subject>Memory Recall</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Learning and Memory</subject>
            <subj-group>
              <subject>Memory</subject>
              <subj-group>
                <subject>Memory Recall</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Motif Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MAGIC: A tool for predicting transcription factors and cofactors driving gene sets using ENCODE data</article-title>
      <alt-title alt-title-type="running-head">MAGIC: predicting transcription factors and cofactors driving gene sets</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8502-1406</contrib-id>
        <name>
          <surname>Roopra</surname>
          <given-names>Avtar</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="corresp" rid="cor001">*</xref>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <addr-line>Dept. of Neuroscience, 5507 WIMR, University of Wisconsin-Madison, Madison, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Ioshikhes</surname>
          <given-names>Ilya</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Ottawa, CANADA</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The author has declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>asroopra@wisc.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>6</day>
      <month>4</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2020</year>
    </pub-date>
    <volume>16</volume>
    <issue>4</issue>
    <elocation-id>e1007800</elocation-id>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>6</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>3</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 Avtar Roopra</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Avtar Roopra</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1007800.pdf"/>
    <abstract>
      <p>Transcriptomic profiling is an immensely powerful hypothesis generating tool. However, accurately predicting the transcription factors (TFs) and cofactors that drive transcriptomic differences between samples is challenging. A number of algorithms draw on ChIP-seq tracks to define TFs and cofactors behind gene changes. These approaches assign TFs and cofactors to genes via a binary designation of ‘target’, or ‘non-target’ followed by Fisher Exact Tests to assess enrichment of TFs and cofactors. ENCODE archives 2314 ChIP-seq tracks of 684 TFs and cofactors assayed across a 117 human cell lines under a multitude of growth and maintenance conditions. The algorithm presented herein, <bold>M</bold>ining <bold>A</bold>lgorithm for <bold>G</bold>enet<bold>I</bold>c <bold>C</bold>ontrollers (MAGIC), uses ENCODE ChIP-seq data to look for statistical enrichment of TFs and cofactors in gene bodies and flanking regions in gene lists without an <italic>a priori</italic> binary classification of genes as targets or non-targets. When compared to other TF mining resources, MAGIC displayed favourable performance in predicting TFs and cofactors that drive gene changes in 4 settings: 1) A cell line expressing or lacking single TF, 2) Breast tumors divided along PAM50 designations 3) Whole brain samples from WT mice or mice lacking a single TF in a particular neuronal subtype 4) Single cell RNAseq analysis of neurons divided by Immediate Early Gene expression levels. In summary, MAGIC is a standalone application that produces meaningful predictions of TFs and cofactors in transcriptomic experiments.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Key to the control of gene expression is the level of transcript in the cell. This level is controlled large part by Transcription factors (TFs) and cofactors. TFs are DNA binding proteins that recognize specific sequence elements to control levels of gene activity. TFs recruit cofactors that do not themselves bind DNA but are brought to promoters via TFs to either enhance or repress gene expression. TFs and cofactors are thus key regulators of transcript levels. It is now routine to obtain the expression levels of every gene transcript in the genome i.e. whole transcriptome data. Understanding how the transcriptome is controlled is challenging. Herein, a method is described that predicts which Factors organize and control sets of genes. The algorithm is termed <bold>M</bold>ining <bold>A</bold>lgorithm for <bold>G</bold>enet<bold>I</bold>c <bold>C</bold>ontrollers (MAGIC). MAGIC uses data derived from ChIPseq tracks archived at ENCODE to decipher which Factors are most likely to preferentially bind lists of genes that are altered from one biological state to another. MAGIC circumvents the principal confounds of current methods to identify Factors and will aid in the discovery of organizing principles behind large scale gene changes seen in physiology and disease.</p>
    </abstract>
    <funding-group>
      <funding-statement>The author received no specific funding for this work.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="4"/>
      <table-count count="0"/>
      <page-count count="20"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2020-04-16</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>Expression data files are available from the GEO database (GSE84175 for CTCF WT and KO data) or TCGA (<ext-link ext-link-type="uri" xlink:href="https://www.cbioportal.org/study/summary?id=brca_tcga">https://www.cbioportal.org/study/summary?id=brca_tcga</ext-link>).</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>Expression data files are available from the GEO database (GSE84175 for CTCF WT and KO data) or TCGA (<ext-link ext-link-type="uri" xlink:href="https://www.cbioportal.org/study/summary?id=brca_tcga">https://www.cbioportal.org/study/summary?id=brca_tcga</ext-link>).</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic>PLOS Computational Biology</italic> Methods paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Key to the control of gene expression is the level of transcript in the cell. This level is controlled large part by Transcription factors (TFs) and cofactors. TFs are DNA binding proteins that recognize specific sequence elements (motifs) associated with gene promoters and enhancers. TFs recruit cofactors that do not themselves bind DNA but are brought to promoters via TFs to either enhance or repress gene expression. TFs and cofactors (hereon termed ‘Factors’) are thus key regulators of transcript levels[<xref rid="pcbi.1007800.ref001" ref-type="bibr">1</xref>].</p>
    <p>It is now routine to obtain the levels of every gene transcript in the genome. The datasets can contain tens of thousands of expression values per sample and the number of samples can be in the thousands such as breast cancer transcriptomes archived at The Cancer Genome Atlas (TCGA)[<xref rid="pcbi.1007800.ref002" ref-type="bibr">2</xref>]. When comparing transcriptomes from two or more conditions such as normal to cancerous tissue, thousands of mRNA levels can change. The changes reflect both alterations in tissue heterogeneity and alterations in transcriptional regulator function. We posit that in many cases, the majority of cellular transcriptome changes are driven by alterations in the function of a few Factors that coordinate gene programs. Identifying those driving Factors is a fundamental problem and therapeutic opportunity.</p>
    <p>Current algorithms for discerning Factors behind transcriptomic changes fall into two categories. The first looks for motifs that are over-represented in the upstream regions of a set of genes[<xref rid="pcbi.1007800.ref003" ref-type="bibr">3</xref>–<xref rid="pcbi.1007800.ref005" ref-type="bibr">5</xref>]. This approach often fails because with very few exceptions, transcription factor motifs are small and often have redundant bases.Thus, searches will yield a high false positive rate; most predicted sites will not be functional. Moreover, in many genes, TFs act in concert such that the presence of a single motif element is uninformative[<xref rid="pcbi.1007800.ref006" ref-type="bibr">6</xref>]. Motif searching also precludes any prediction of cofactors because cofactors do not bind DNA directly[<xref rid="pcbi.1007800.ref007" ref-type="bibr">7</xref>]. This is especially problematic for translational research where uncovering drugable targets is a major goal, and cofactors are often enzymes that can make excellent drug targets. A second approach relies on assigning genes to Factors by analysis of ChIP-seq tracks. Genes are ranked by ChIP signal and then an arbitrary number of ‘top’ genes are taken as targets to form a gene set for a Factor. Fisher Exact Tests (FET) or Gene Set Enrichment Analysis-like (GSEA) analyses[<xref rid="pcbi.1007800.ref008" ref-type="bibr">8</xref>] can then be performed between differentially expressed genes and Factor sets. Examples of such algorithms are BART[<xref rid="pcbi.1007800.ref009" ref-type="bibr">9</xref>], VIPER[<xref rid="pcbi.1007800.ref010" ref-type="bibr">10</xref>], TFEA.ChIP[<xref rid="pcbi.1007800.ref011" ref-type="bibr">11</xref>], ENRICHR[<xref rid="pcbi.1007800.ref012" ref-type="bibr">12</xref>] and CHEA3[<xref rid="pcbi.1007800.ref013" ref-type="bibr">13</xref>].</p>
    <p>ChIP-seq based approaches allow for assignment of cofactors. However, many Factors have highly non-gaussian ChIP signal distributions; the distributions can have large numbers of sites with very low but detectable signals. This thwarts unbiased attempts to define genes as ‘targets’ or ‘non-targets’[<xref rid="pcbi.1007800.ref014" ref-type="bibr">14</xref>]. Herein, a method is described that assigns Factors to gene lists using ENCODE ChIP-seq data without first defining genes as ‘targets’ or ‘non-targets’. The algorithm is termed <bold>M</bold>ining <bold>A</bold>lgorithm for <bold>G</bold>enet<bold>I</bold>c <bold>C</bold>ontrollers (MAGIC). MAGIC circumvents the principal confounds of current methods to identify Factors, namely: 1) the use of TF motif searches 2) inability to identify cofactors due the absence of any binding site motifs 3) assignment of Factors to genes based on hard cutoffs of ChIP-seq signals. MAGIC accepts an input set of genes and compares ChIP signals for the set with the population of ChIP signals for each Factor in ENCODE. When compared to CHEA3, TFEA.CHIP and ENRICHR, MAGIC performs favourably in predicting transcription factors and cofactors enriched in lists of differentially expressed genes.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Methods</title>
    <sec id="sec003">
      <title>MCF7 RNA profiling</title>
      <p>MCF7 cells harboring a REST shRNA knockdown and controls were generated as described and the dataset derived from Nimblegen Arrays is described in Meyer et al[<xref rid="pcbi.1007800.ref015" ref-type="bibr">15</xref>]. Probes were considered as expressed in the experiment if they were called as ‘present’ in all 3 samples of either controls or knockdown cells. If a probe was present in only one condition, the values in the other condition were accepted regardless of the present/absent call. Student t tests were performed for each probe and one probe was assigned per gene symbol by taking the probe with the largest T statistic between conditions. Genes up-regulated more than 3 Standard Deviations from the log of the mean fold change (average shREST value/average shCon value) and having a Benjamini Hochberg[<xref rid="pcbi.1007800.ref016" ref-type="bibr">16</xref>] corrected t-test p value&lt;0.05 were used for Factor analysis. The background list consisted of all symbols found to be present in all controls or all knockdowns or both (<xref ref-type="supplementary-material" rid="pcbi.1007800.s002">S1 Table</xref>).</p>
    </sec>
    <sec id="sec004">
      <title>TCGA profiling</title>
      <p>Breast cancer RNAseq data (data_RNA_Seq_v2_expression_median.txt) was downloaded from cBioPortal (latest datafreeze as of 6July2017). PAM50[<xref rid="pcbi.1007800.ref017" ref-type="bibr">17</xref>] designations were used to parse tumors into Luminal-A or Basal subtypes. A gene with an RPKM ≥1 in at least 50% of either basal or Luminal-A samples was considered for further analysis. Fold changes, statistics and gene lists were then generated as above (<xref ref-type="supplementary-material" rid="pcbi.1007800.s003">S2 Table</xref>).</p>
    </sec>
    <sec id="sec005">
      <title>Sams et al profiling</title>
      <p>RNAseq data associated with Sams et al[<xref rid="pcbi.1007800.ref018" ref-type="bibr">18</xref>] (GSE84175) was downloaded from GEO. A gene with an RPKM ≥1 in all controls or all CTCF KO cells was considered for further analysis and fold changes, statistics and gene lists were then generated as above for REST knock-down cells. 17,015 genes were expressed by this criterion with 432 genes down-regulated at least 1.5 fold with a corrected t-test p value &lt; 0.25 (<xref ref-type="supplementary-material" rid="pcbi.1007800.s004">S3 Table</xref>).</p>
    </sec>
    <sec id="sec006">
      <title>Jaeger et al profiling</title>
      <p>Supplemental file 41467_2018_5418_MOESM6_ESM.xlsx from Jaeger et al [<xref rid="pcbi.1007800.ref019" ref-type="bibr">19</xref>] was used to generate gene lists for Factor analysis. All genes with a positive test statistic and adjusted p-value&lt;0.05 (842 genes) were accepted as up-regulated genes from the DG_Reactive_HC tab. All 5306 detected genes were used as a background list (<xref ref-type="supplementary-material" rid="pcbi.1007800.s005">S4 Table</xref>).</p>
    </sec>
    <sec id="sec007">
      <title>MAGIC</title>
      <p>MAGIC aims to determine whether genes in a query list are associated with higher ChIP values than expected by chance for a given transcription factor or cofactor based on ChIP-seq tracks archived at ENCODE. MAGIC was written in Python 3.7 and packaged into a stand-alone executable using Pyinstaller 3.6.</p>
    </sec>
    <sec id="sec008">
      <title>Generation of MAGIC matrices</title>
      <p>MAGIC utilizes MAGIC matrix files (*.mtx files) to determine Factors behind gene lists. MAGIC matrices were generated as follows: All human genes were assigned a gene domain encompassing one of the following: 1) gene body (promoter to the end of the last exon) plus 1Kb flanking sequence either side of the gene body, 2) gene body plus 5Kb flanking sequence either side of the gene body, 3) 1Kb upstream of the promoter and 300bp downstream. NarrowPeak files for all Factors were downloaded from: <ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/matrix/?searchTerm=chip-seq&amp;type=Experiment&amp;target.investigated_as=transcription+factor&amp;files.file_type=bed+narrowPeak&amp;award.project=ENCODE">https://www.encodeproject.org/matrix/?searchTerm=chip-seq&amp;type=Experiment&amp;target.investigated_as=transcription+factor&amp;files.file_type=bed+narrowPeak&amp;award.project=ENCODE</ext-link></p>
      <p>A custom Python script was used to extract the highest ChIP-seq peak value (signalValue) within the gene domain for each ChIP-seq track. Thus each Factor and gene were assigned a single signalValue. Matrices were generated that either include Chip-Seq tracks for Factors that were engineered (for example by CRISPR or stable transfection) in which case they have “_with_engineered_factors” in the name, or do not include engineered factors. Five matrices are therefore currently available to the user:</p>
      <p>1Kb_gene.mtx</p>
      <p>1Kb_gene_with_engineered_factors.mtx</p>
      <p>1Kb_promoter.mtx</p>
      <p>1Kb_promoter_with_engineered_factors.mtx</p>
      <p>5Kb_gene.mtx</p>
      <p>5Kb_gene_with_engineered_factors.mtx</p>
      <p>Matrices with engineered factors are derived from 2312 ChIP-seq tracks covering 684 Factors in 588 cell lines or conditions. Matrices without engineered Factors derive from 1923 ChIP-seq tracks covering 392 Factors in 207 cell lines or conditions. All Matrices encompass 27,941 genes.</p>
    </sec>
    <sec id="sec009">
      <title>Defining enriched factors in a gene set</title>
      <p>At least two lists are entered into MAGIC. The first is a background list containing all genes of relevance to the experiment (for example, all genes present or expressed in an experiment). Subsequent lists contains genes of interest–the query lists (e.g. differentially expressed genes). Query lists are subsets of the background list and both lists are filtered by MAGIC for genes present in the designated MAGIC matrix.</p>
      <p>For each Factor in the Matrix, MAGIC orders the N genes in the accepted background list by ChIP signal (lowest to highest). It then generates a normalized cumulative distribution function (CDF) such that:
<disp-formula id="pcbi.1007800.e001"><alternatives><graphic xlink:href="pcbi.1007800.e001.jpg" id="pcbi.1007800.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mi>B</mml:mi><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>Where B(c) is the fraction of genes in the background list (N genes) with ChIP signal less than or equal to c. B are the ordered ChIP signals. <inline-formula id="pcbi.1007800.e002"><alternatives><graphic xlink:href="pcbi.1007800.e002.jpg" id="pcbi.1007800.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is an indicator function that is equal to 1 if B<sub>i</sub> ≤ c else equal to 0. An empirical distribution function, Q(c) is generated by accumulating the ordered X query genes (Q) (where Q is a subset of B and <inline-formula id="pcbi.1007800.e003"><alternatives><graphic xlink:href="pcbi.1007800.e003.jpg" id="pcbi.1007800.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> = 1 if Q<sub>i</sub> less than or equal to c else equal to 0):
<disp-formula id="pcbi.1007800.e004"><alternatives><graphic xlink:href="pcbi.1007800.e004.jpg" id="pcbi.1007800.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mi>Q</mml:mi><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>The maximal difference between the two cumulatives is then calculated thus:
<disp-formula id="pcbi.1007800.e005"><alternatives><graphic xlink:href="pcbi.1007800.e005.jpg" id="pcbi.1007800.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mi>Q</mml:mi><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:math></alternatives></disp-formula></p>
      <p>A Kolmogorov-Smirnov test is performed on N, X and D<sub>sup</sub> to determine the probabilty of this difference or larger occuring by chance. The argument of D<sub>sup</sub> (arg<sub>Dsup</sub>) is also noted; this is used to define that subset of the query list that is targeted by the Factor. If there are fewer than five genes with chip values greater than arg<sub>Dsup</sub>, the Factor is triaged and not considered further.</p>
      <p>A Score for each Factor is calculated to incorporate the Benjamini-Hochberg corrected Kolmogorov-Smirnov p value, as well as a measure of how the highest ChIP values in the query list compare to the highest values in the background list. Thus, for each Factor, the mean of the top n chip signals in the query list of length X, is compared to the mean of the top n ChIPs in the population to produce a ratio such that:
<disp-formula id="pcbi.1007800.e006"><alternatives><graphic xlink:href="pcbi.1007800.e006.jpg" id="pcbi.1007800.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn><mml:mi>X</mml:mi></mml:math></alternatives></disp-formula>
and
<disp-formula id="pcbi.1007800.e007"><alternatives><graphic xlink:href="pcbi.1007800.e007.jpg" id="pcbi.1007800.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></alternatives></disp-formula></p>
      <p>Where <italic>μ<sub>q</sub></italic> is the mean for the top n signals for Q and μ<sub>b</sub> is the mean of the top n signals for B.</p>
      <p>A Score, S, is assigned to each Factor thus:
<disp-formula id="pcbi.1007800.e008"><alternatives><graphic xlink:href="pcbi.1007800.e008.jpg" id="pcbi.1007800.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>×</mml:mo><mml:mi>r</mml:mi></mml:math></alternatives></disp-formula></p>
      <p>Where P<sub>corr</sub> is the Benjamini-Hochberg corrected Kolmogorov-Smirnov p value. Factors are then sorted by Score.</p>
      <sec id="sec010">
        <title>Implementation of MAGIC</title>
        <p>A tab delimited text file is requested by MAGIC (lists file). The first column contains a list of all genes expressed in the experiment (background list). Any number of other columns are then added containing query lists. For example, a query list may be all genes that go up under some criterion and another may be all genes that go down. The first row is the header and must have unique names for each column. MAGIC then requests which Matrix to use.</p>
        <p>MAGIC analyzes each query list and generates a series of output files and sub-directories in the directory containing the original lists file. An ‘Accepted_Lists.txt’ file is generated which is the original input file filtered for genes in the Matrix. A Platform_Matrix.txt file is the matrix file filtered for genes in the the background list. A series of directories are generated named after each query list in the lists file. Each directory contains sub-directories and files for the stand-alone analysis of that query list. A Query_List_Details.xls file contains statistical information for all non-triaged Factors. All Factors associated with P<sub>corr</sub> &lt; 10% are highlighted in bold red. Data reported in Query_List_Details.xls are:</p>
        <p>Factor Name of Factor</p>
        <p>Description The ENCODE cell line, tissue or experiment description</p>
        <p>Critical ChIP: arg<sub>Dsup</sub> i.e. ChIP value at D<sub>sup</sub> (This value is used to determine target genes in the list)</p>
        <p>Obs Tail Mean: Average of the 95<sup>th</sup> percentile ChIP values (n values) in the query list.</p>
        <p>Exp Tail Mean: Average of the top n ChIP values in the backgound.</p>
        <p>Tail Enrichment: Ratio of the Obs and Exp Tail Means (r)</p>
        <p>Raw P: Kolmogorov-Smirnov p value</p>
        <p>Corrected P: Benjamini Hochberg corrected p value (P<sub>corr</sub>)</p>
        <p>Score: Score (-log(P<sub>corr</sub>)x r)</p>
        <p>Where ENCODE contains multiple Chip-seq tracks for a Factor, the best scoring is also reported in a Summary.xls file with the same layout as above–each Factor appears once in this file. A query_list_summary.pdf contains a bar graph of Factors and Scores with P<sub>corr</sub> &lt;10%.</p>
        <p>Query_list_Drivers.gmx is a tab delimited file in the GMX format utilized by GSEA[<xref rid="pcbi.1007800.ref008" ref-type="bibr">8</xref>]. The first column contains the background list of genes. The second contains the query list. Subsequent columns contain all target genes of each Factor. Target genes are defined as those genes in the query list whose ChIP signal is greater than the Critical ChIP (arg<sub>Dsup</sub>) i.e. the ChIP at which there is the maximal difference between the population and query cumulative.</p>
        <p>A sub-directory called ‘CDFs’ contains graphical displays of the analysis for all non-triaged Factors. The naming format is ‘rank (i<italic>nteger</italic>)’_’factor (<italic>string</italic>)’.pdf (e.g. 1_NRSF.pdf; rank = 1, factor = NRSF) (<xref ref-type="supplementary-material" rid="pcbi.1007800.s001">S1 Fig</xref>) where ranking is determined by Score. Two cumulative functions are displayed: the black curve is the fractional cumulative of all genes in the background list against ChIP values, red is the same for query genes. A blue vertical line denotes the ChIP value at D<sub>sup</sub> i.e. arg<sub>Dsup</sub>. Red ticks along the x-axis represent each gene in the query list and black ticks are all genes in the background. Red ticks with circles (‘lollipops’) are the n = 0.05X best chiped genes. Black lollipops are genes in the background list with the n highest ChIP values.</p>
        <p>A second sub-directory called ‘Auxiliary_Files’ is populated with data behind the summary files. The ‘query_list_raw_results.CSV’ file contains the same columns as the Query_list_Summary.xls file but has raw data for all factors including those that were triaged and not considered for further statistical analysis. It also contains the Kolmogorov-Smirnov D statistic for each factor. D statistics with a negative sign denote D values for triaged factors; the negative sign is used by the algorithm for triage sorting.</p>
        <p>Query_list_Sub_Matrix.txt is the MAGIC Matrix filtered for genes in the query list.</p>
        <p>Triaged_Factors.txt is a list of factors that were not considered (triaged).</p>
        <p>Triaged_Genes.txt contains all genes in the query that were not in the MAGIC Matrix and therefore eliminated from analysis.</p>
        <p>A sub-directory named ‘Target_Data’ contains comma separated text files for each Factor with P<sub>corr</sub> &lt; 10%. Each file contains a list of target genes for that Factor and associated MAGIC Matrix ChIP value.</p>
      </sec>
    </sec>
    <sec id="sec011">
      <title>Obtaining MAGIC</title>
      <p>MAGIC can be downloaded from: <ext-link ext-link-type="uri" xlink:href="https://go.wisc.edu/magic"><bold>https://go.wisc.edu/magic</bold></ext-link></p>
      <p>The Python script and information on how to access required Matrix files is available at:</p>
      <p>
        <ext-link ext-link-type="uri" xlink:href="https://github.com/asroopra/MAGIC">https://github.com/asroopra/MAGIC</ext-link>
      </p>
    </sec>
    <sec id="sec012">
      <title>Defining cofactors and associated TFs of manipulated factors for ROC, PR and rank analysis</title>
      <p>To generate a list of potential cofactors and transcription factors that may interact physically or functionally with a manipulated Factor (hereon called Potential Interactors, PIs), the file 9606.protein.links.detailed.v11.0.txt was downloaded from the STRING protein interaction database (<ext-link ext-link-type="uri" xlink:href="http://string-db.org/">http://string-db.org/</ext-link>)[<xref rid="pcbi.1007800.ref020" ref-type="bibr">20</xref>]. Proteins with a Combined Score of greater than 300 (representing the 75<sup>th</sup> percentile of scores) were taken as PIs.</p>
    </sec>
    <sec id="sec013">
      <title>Precision Recall (PR) and Receiver Operator Characteristics (ROC) analysis</title>
      <p>Outputs from MAGIC, CHEA3, TFEA and Enrichr were ordered by Score (for MAGIC) or Fisher’s Exact Test p value and ranks were scaled between 1/n and 1 for each algorithm and library as in Keenan et al[<xref rid="pcbi.1007800.ref013" ref-type="bibr">13</xref>]. This produced vectors of positive and negative calls for each test (Calls Vectors). The positive class was defined as the manipulated Factor and all PIs as defined above. ROC and PR curves and statistics were generated by importing roc_curve and precision_recall_curve from sklearn.metrics in Python3.7. No balancing of imbalanced datasets was performed and so PR analysis was prioritized over ROC analysis.</p>
    </sec>
    <sec id="sec014">
      <title>Rank analysis</title>
      <p>To determine how well the algorithms prioritized the manipulated Factor and PIs, scaled ranks of the positive calls in the Calls Vectors were cumulated to give D(r). A lack of enrichment of TFs and associated cofactors for either high or low ranks would produce a uniform distribution (which equates to r). Thus D(r)-r is plotted for each dataset: the greater the Area Under the Curve (AUC), the better the identification of TFs and cofactors. Contiguous runs of positive calls (a block of positive calls) are assigned the rank of the first element in the block. Differences between the distributions were assessed using Kolmogorov-Smirnov tests.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec015">
    <title>Results</title>
    <p>The purpose of MAGIC is to identify those transcription factors and cofactors responsible for patterns of gene expression changes after a manipulation or between conditions. For all analyses, the 1Kb_gene.mtx matrix was used. MAGIC was tested on four transcriptome datasets: <bold>1) <italic>MCF7(shCon_vs_shREST)</italic></bold>. This dataset consists of MCF7 breast cancer cells stably expressing shRNA against the transcription factor REST or a control sham shRNA. REST is a transcriptional repressor and tumor suppressor whose loss drives tumor growth of MCF7 cells in mouse xenograft model of breast cancer[<xref rid="pcbi.1007800.ref015" ref-type="bibr">15</xref>, <xref rid="pcbi.1007800.ref021" ref-type="bibr">21</xref>, <xref rid="pcbi.1007800.ref022" ref-type="bibr">22</xref>]. This simple system consists of a clonal cell line lacking a single factor. 119 genes out of 15,446 expressed genes were identified as up-regulated by more than 3 standard deviations than the log mean fold change and an associated False Discovery Rate (FDR)&lt;5% (<xref ref-type="supplementary-material" rid="pcbi.1007800.s002">S1 Table</xref>). <bold>2) <italic>TCGA(Lum_vs_Basal)</italic></bold>. 233 Luminal-A and 79 Basal-like tumors were identified in The Cancer Genome Atlas (TCGA) Nature 2012 provisional breast cancer dataset [<xref rid="pcbi.1007800.ref023" ref-type="bibr">23</xref>]. Luminal-A tumors are a subset of breast cancers defined by their robust expression of estrogen receptor alpha (ERα) and associated pioneer factors. They also express the progesterone and her2 receptors. Basal-like tumors are estrogen, progesterone and her2 receptor negative. This is a complex dataset with over 300 samples and heterogeneous tissue. 203 genes out of 17,814 expressed genes were up-regulated in Lum-A over Basal tumors using the same criterion as for MCF7(shCon_vs_shREST) (<xref ref-type="supplementary-material" rid="pcbi.1007800.s003">S2 Table</xref>). <bold>3) <italic>Brain(WT_vs_CTCFko)</italic></bold>. MAGIC utilizes ChIP-seq data derived from immortalized or transformed human cancer cell lines and the above two examples utilize either an immortalized cell line or cancer tissue. To test whether MAGIC could be used on data derived from non-cancerous, highly heterogeneous, rodent samples, we turned to non-malignant mouse brain tissue. CTCF is a TF that organizes long distance interactions in the genome[<xref rid="pcbi.1007800.ref024" ref-type="bibr">24</xref>]. Sams <italic>et al</italic> demonstrated that elimination of CTCF in excitatory neurons (while sparing its expression in other neuron subtypes, astocytes and glia) results in defects in learning, memory and neuronal plasticity[<xref rid="pcbi.1007800.ref018" ref-type="bibr">18</xref>]. 432 genes were down-regulated upon CTCF loss out of 17,015 expressed genes (<xref ref-type="supplementary-material" rid="pcbi.1007800.s004">S3 Table</xref>). 4) <bold><italic>DGC(Quiet_vs_Reactive)</italic></bold>. Single cell transcriptome profiling allows the discerning of responses of individual cells to stimuli. Jaeger <italic>et al</italic> performed single cell profiling on mouse dentate granule cells in response to a novel location stimulus [<xref rid="pcbi.1007800.ref019" ref-type="bibr">19</xref>]. Cells were sorted on Fos expression, an Immediate Early Gene (IEG) that is expressed in response to neuronal firing[<xref rid="pcbi.1007800.ref025" ref-type="bibr">25</xref>]. 843 genes were up-regulated in Reactive Dentate Granule cells out of 5305 expressed genes (<xref ref-type="supplementary-material" rid="pcbi.1007800.s005">S4 Table</xref>).</p>
    <sec id="sec016">
      <title>Identification of manipulated factors</title>
      <p>Arguably, the most impactful output of any Factor discovery tool is the best ranked, or ‘top’ Factor predicted to target a list of input genes. The above datasets were subjected to Factor analysis using MAGIC, TFEA.ChIP[<xref rid="pcbi.1007800.ref011" ref-type="bibr">11</xref>], Enrichr[<xref rid="pcbi.1007800.ref012" ref-type="bibr">12</xref>] and CHEA3 [<xref rid="pcbi.1007800.ref013" ref-type="bibr">13</xref>]. Integer ranks were calculated for the manipulated Factor in each experiment (‘top’ Factor has rank = 1). Reciprocals were calculated so that unity represents the best rank and zero the poorest. <xref ref-type="fig" rid="pcbi.1007800.g001">Fig 1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007800.s006">S5</xref>–<xref ref-type="supplementary-material" rid="pcbi.1007800.s009">S8</xref> Tables shows that MAGIC was able to call the manipulated Factor in each experiment as the top ranked Factor for 3 of the datasets i.e. REST in MCF7(shCon_vs_shREST) (<xref ref-type="supplementary-material" rid="pcbi.1007800.s006">S5 Table</xref>), ESR1 in TCGA(Lum_vs_Basal) (<xref ref-type="supplementary-material" rid="pcbi.1007800.s006">S5 Table</xref>), and CTCF in Brain(WT_vs_CTCFko) (<xref ref-type="supplementary-material" rid="pcbi.1007800.s008">S7 Table</xref>). MAGIC called FOS as 2<sup>nd</sup> rank in the fourth dataset, DGC(Quiet_vs_Reactive) (<xref ref-type="supplementary-material" rid="pcbi.1007800.s009">S8 Table</xref>), having called FOSL2 as top rank. Thus MAGIC was able to identify the manipulated Factor as well as, or better than CHEA3 using any of its libraries, TFEA or Enrichr.</p>
      <fig id="pcbi.1007800.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007800.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Comparing ranks of manipulated factors predicted by MAGIC, CHEA3, TFEA and Enrichr.</title>
          <p>MCF7(shCon_vs_shREST), TCGA(Lum_vs_Basal), Brain(WT_vs_CTCFko) and DGC(Quiet_vs_Reactive) datasets were analyzed by MAGIC, CHEA3 (using all available libraries: ARCHS4 co-expression, ENCODE ChIP-Seq, Enrichr Queries, GTEx co-expression, Literature mining, ReMAP ChIP-seq, Mean Rank and Top Rank), TFEA and Enrichr. The reciprocal integer ranks for REST, ESR1, CTCF and FOS (the Factors manipulated in MCF7(shCon_vs_shREST), TCGA(Lum_vs_Basal), Brain(WT_vs_CTCFko) and DGC(Quiet_vs_Reactive)) are plotted. The top rank = 1, second rank = 0.5 etc. ND = Not Determined; Factor not present in library.</p>
        </caption>
        <graphic xlink:href="pcbi.1007800.g001"/>
      </fig>
    </sec>
    <sec id="sec017">
      <title>Identification of cofactors and Potential Interacting TFs</title>
      <p>Transcription factors work by recruiting cofactors via protein-protein interactions and often work in unison with other TFs[<xref rid="pcbi.1007800.ref026" ref-type="bibr">26</xref>]. Thus it would be useful if an algorithm designed to identify TFs behind gene lists could also highlight associated cofactors and TFs (i.e. Potential Interactors—PIs). Ideally those cofactors would appear near the top of the list of putative Factors. To assess how well MAGIC compares to the other algorithms in identifying PIs associated with DEG lists, a cohort of PIs was identified for the above 4 manipulated TFs. Annotated protein-protein interactions were downloaded from the STRING database (<ext-link ext-link-type="uri" xlink:href="https://string-db.org/">https://string-db.org</ext-link>)[<xref rid="pcbi.1007800.ref020" ref-type="bibr">20</xref>] and used to identify proteins associated with either REST, ESR1, CTCF or FOS with a STRING Combined Score of greater than 300 (representing the 75<sup>th</sup> percentile of scores) [<xref rid="pcbi.1007800.ref027" ref-type="bibr">27</xref>]. Fractional ranks for the manipulated Factor and PIs were then cumulated (to give D(r)). A lack of enrichment of TFs and associated cofactors for either high or low ranks would produce a uniform p-value distribution (which equates to r). Thus D(r)-r was plotted for each dataset: the greater the Area Under the Curve (AUC), the better the identification of TFs and cofactors. This approach is borrowed and modified from Keenan <italic>et al</italic> in their excellent publication describing CHEA3[<xref rid="pcbi.1007800.ref013" ref-type="bibr">13</xref>]. <xref ref-type="fig" rid="pcbi.1007800.g002">Fig 2A and 2B</xref> shows that MAGIC manifests the largest AUC for REST and its PIs in MCF7(shCon_vs_shREST), ESR1 and associated PIs in TCGA(Lum_vs_Basal), CTCF and PIs in Brain(WT_vs_CTCFko) and for FOS in DGC(Quiet_vs_Reactive). In an attempt to integrate the rank results for the manipulated Factor in <xref ref-type="fig" rid="pcbi.1007800.g001">Fig 1</xref> and recollection of PIs in <xref ref-type="fig" rid="pcbi.1007800.g002">Fig 2</xref>, the AUC for D(r)-r functions was multiplied by the fractional rank values of the manipulated Factors in order to weight the AUCs according to priority the algorithms placed on the manipulated Factor. Using this ‘weighted AUC’ metric, MAGIC manifested a robust ability to call the manipulated Factor along with its PIs (<xref ref-type="fig" rid="pcbi.1007800.g002">Fig 2C and 2D</xref>)</p>
      <fig id="pcbi.1007800.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007800.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Manipulated transcription factors and associated cofactors are preferentially ranked by MAGIC compared to CHEA3, TFEA and Enrichr.</title>
          <p>(A) Emperical cumulatives were generated of factional ranks (1/Integer ranks) for manipulated factors and associated cofactors for the 4 datasets using all algorithms and libraries as in <xref ref-type="fig" rid="pcbi.1007800.g001">Fig 1</xref>. The difference between the cumulative of all scaled fractional ranks and a uniform distribution for the manipulated factor and associated cofactors is plotted against the fractional rank. Kolmogorov-smirnov tests of each distribution against a uniform distribution yields p&lt;10<sup>−10</sup> for all tests. (B) Area Under Curve (AUC) for D(r)-r x r curves in panel A. (C) The D(r)-r curves in panel A were scaled for the rank of the manipulated actor. For each algorithm, D(r)-r was multiplied by the fractional rank of the manipulated factor (F<sub>R</sub>). (D) AUCs for curves in panel C.</p>
        </caption>
        <graphic xlink:href="pcbi.1007800.g002"/>
      </fig>
    </sec>
    <sec id="sec018">
      <title>Precision Recall and Receiver Operator Characteristics</title>
      <p>Using the manipulated Factors (REST, ESR1, CTCF and FOS) and their PIs as defined above, Precision Recall (PR) and Receiver Operator Characteristics (ROC) curves were generated for the 4 datasets, algorithms and libraries to assess how well MAGIC compares in classifying Factors behind input gene lists. The datasets are unbalanced in that the positive class (consisting of the manipulated Factor and PIs) is smaller than the negative class. Therefore the PR curve was prioritized in assessing algorithm performance. <xref ref-type="fig" rid="pcbi.1007800.g003">Fig 3A–3C</xref> show that MAGIC manifests superior precision for the MCF7(shCon_vs_shREST), TCGA(Lum_vs_Basal), and Brain(WT_vs_CTCFko) datasets with PR AUCs of 84%, 83% and 91% respectively. For the DGC(Quiet_vs_Reactive) dataset, MAGIC exhibited an AUC = 72%, 2<sup>nd</sup> to TFEA at AUC = 77%. When normalizing the PR AUC for ranking of the manipulated Factor as in <xref ref-type="fig" rid="pcbi.1007800.g002">Fig 2C</xref>, MAGIC exhibited superior performance across all 4 datasets (<xref ref-type="fig" rid="pcbi.1007800.g003">Fig 3D</xref>). For completeness, ROC curves were generated for all algorithms across the four data sets (<xref ref-type="fig" rid="pcbi.1007800.g003">Fig 3B</xref>). ROC analysis showed that MAGIC performed solidly across all four datasets and was bested by only one algorithm in one dataset (CHEA3_Mean_Rank in DGC(Quiet_vs_Reactive)).</p>
      <fig id="pcbi.1007800.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007800.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>MAGIC demonstrates skill at calling manipulated factors as assessed by Precision Recall and Receiver Operator Characteristics.</title>
          <p>(A) Precision Recall curves for the four datasets and all algorithms and libraries. (B) Receiver Operator Characteristic curves for the four datasets and all algorithms and libraries. As in panel A, data was not balanced prior to graphing. (C) ROC versus PR AUCs for all algorithms and libraries. (D) PR AUCs were scaled for fractional rank of the manipulated factor by multiplying PR UAC by F<sub>R</sub>.</p>
        </caption>
        <graphic xlink:href="pcbi.1007800.g003"/>
      </fig>
    </sec>
    <sec id="sec019">
      <title>The Requirement for a valid background gene list</title>
      <p>To test how MAGIC might be sensitive to the background list of genes, MAGIC was tested on the 4 datasets in the absence and presence of a bespoke background list. The background lists for MCF7(shCon_vs_shREST), Brain(WT_vs_CTCFko) and DGC(Quiet_vs_Reactive) were generated by accepting all genes in the dataset that had detectable signal in all samples of either control or experimental condition. For TCGA(Lum_vs_Basal) which has 312 samples, this was modified to allow genes that were detectable in at least 50% of samples in either condition. The results using these background lists were compared to results obtained using all genes in the matrix (i.e. ‘minus background’). MAGIC was first assessed for its ability to call manipulated Factors and PIs as in <xref ref-type="fig" rid="pcbi.1007800.g002">Fig 2</xref> using D(r)-r plots. <xref ref-type="fig" rid="pcbi.1007800.g004">Fig 4A</xref> shows that the D(r)-r AUC is significantly reduced in the absence of a background list for all four datasets indicating a reduced ability to call Factors. Precision was also reduced in the absence of a background list as judged by PR AUC and precision at 80% recall (<xref ref-type="fig" rid="pcbi.1007800.g004">Fig 4B</xref>). ROC parameters were also diminished in the absence of a background list. Thus ROC AUC as well as the True Positive Rate measured at 20% False Discovery Rate was reduced in the absence of a background list (<xref ref-type="fig" rid="pcbi.1007800.g004">Fig 4C</xref>).</p>
      <fig id="pcbi.1007800.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007800.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>MAGIC requires a valid background gene list for optimal performance.</title>
          <p>(A) D(r)-r curves for the 4 datasets generated for MAGIC outputs in the presence or absence of a background list. Kolmogorov-smirnov statistics for the 2 curves: MCF7(shCon_vs_shREST); D = 0.10, p = 8.6x10<sup>-5</sup>. TCGA(Lum_vs_Basal); D = 0.15, p = 4.6x10<sup>-11</sup>. Brain(WT_vs_CTCFko); D = 0.26, p = 1.1x10<sup>-16</sup>. DGC(Quiet_vs_Reactive); D = 0.11, p = 3.9x10<sup>-9</sup>. (B) Precision Recall curves for MAGIC outputs in the presence or absence of a background list: MCF7(shCon_vs_shREST); 0.84 vs 0.78, TCGA(Lum_vs_Basal); 0.83 vs 0.81, Brain(WT_vs_CTCFko); 0.91 vs 0.71, DGC(Quiet_vs_Reactive); 0.72 vs 0.67. Black vertical line denotes 80% Recall (C) Receiver Operator Characteristics curves for MAGIC outputs in the presence or absence of a background list (unbalanced). (D) Emperical cumulative distribution for False Discovery Rates associated with MAGIC outputs in the presence or absence of a background list. For all datasets, Kolmogorov-smirnov p &lt;10<sup>−4</sup>. (E) The integer ranks for the top 50 Factors called by MAGIC in the presence of a background list were compared to their ranks in the absence of a background list.</p>
        </caption>
        <graphic xlink:href="pcbi.1007800.g004"/>
      </fig>
      <p>To test the effect of background list on p values associated with Factors and PIs in MAGIC outputs, emperical cumulatives were generated of <italic>-log(FDR)</italic> values (Benjamini Hochberg corrected p values) for the four datasets. <xref ref-type="fig" rid="pcbi.1007800.g004">Fig 4D</xref> shows that there are significantly more low FDR calls in the absence of a background list demonstrating that lack of a background list inflates statistical significances associated with MAGIC outputs. Finally, the effect of background list was tested on ranking of Factors. The integer ranks for the 50 top ranked Factors for each dataset in the presence of appropriate background lists was compared to their ranks in the absence of a background list. <xref ref-type="fig" rid="pcbi.1007800.g004">Fig 4E</xref> shows that Factor order is impacted by the absence or presence of the background.</p>
      <p>In summary, using four disparate datasets, MAGIC performed at least as well as CHEA3, TFEA and Enrichr according to ranking of the manipulated Factor, calling of potential interactors, PR characteristics and ROC analysis.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec020">
    <title>Discussion</title>
    <p>MAGIC is a standalone application for predicting transcription factors and cofactors that drive gene expression changes in transcriptomic experiments. Data presented herein shows that MAGIC compares favourably with three other algorithms: CHEA3, TFEA and Enrichr. A number of approaches have been used historically to tackle the difficult problem of determining which Factors drive sets of genes. One approach—exemplified by oPossum[<xref rid="pcbi.1007800.ref005" ref-type="bibr">5</xref>]—relies on searching for short transcription factor binding motifs in promoter proximal sequences. Using hypergeometric tests provides a likelihood of enrichment for the factor. This approach is limited due to the small size of binding sites for most factors; a random 6bp sequence will be found approximately 750,000 times in the human genome. This approach also cannot predict cofactors as cofactors do not bind DNA directly.</p>
    <p>A more sophisticated approach relies on comparing query lists of genes with gene lists attributed to Factors based on ChIP-seq experiments. This approach is the basis for CHEA3, TFEA and Enrichr. ChIP-seq based allocation of genes to Factors ensures that only actual binding events are considered but even here, genes can be falsely attributed to Factors because many sites where Factors are ChIPed are not functional[<xref rid="pcbi.1007800.ref003" ref-type="bibr">3</xref>]. Thus many genes will show some low level of binding/chip signal. For example, extracting all REST ChIP-seq tracks from wgEncodeRegTfbsClusteredV2.bed from the UCSC genome browser (<ext-link ext-link-type="uri" xlink:href="http://hgdownload.soe.ucsc.edu/goldenPath/hg19/encodeDCC/wgEncodeRegTfbsClustered/">http://hgdownload.soe.ucsc.edu/goldenPath/hg19/encodeDCC/wgEncodeRegTfbsClustered/</ext-link>) showed 27,386 binding sites across the human genome with 17,971 genes showing a detectable signal within 5Kb of the promoter. This thwarts unbiased attempts to define genes as ‘targets’ or ‘non-targets’. These caveats not withstanding, ChIP-seq based allocation of genes to Factors and Fisher Exact Tests give good performance in real world tests[<xref rid="pcbi.1007800.ref009" ref-type="bibr">9</xref>, <xref rid="pcbi.1007800.ref011" ref-type="bibr">11</xref>–<xref rid="pcbi.1007800.ref013" ref-type="bibr">13</xref>]. MAGIC attempts to overcome the problem of assigning genes to Factors by utilizing complete ChIP-seq profiles without parsing Factors into ‘bound’ and ‘not bound’ classes.</p>
    <p>CHEA3, TFEA (using the ‘Association analysis’ option) and Enrichr use Fisher Exact Tests (FET) to assess associations between input gene lists and Factor targets[<xref rid="pcbi.1007800.ref011" ref-type="bibr">11</xref>–<xref rid="pcbi.1007800.ref013" ref-type="bibr">13</xref>]. The rank order of Factors driving gene lists is therefore not altered by the size of the universal set of all genes (the background gene list) in the analysis; FET p values scale with background gene list size. In contrast, MAGIC output is sensitive to the background gene list. For each Factor in the chosen matrix, MAGIC performs a Kolmogorov-Smirnov test on cumulatives of all ChIP-seq signals in the background list of genes and the input list. The Score combines the corrected p value from this test and a measure of how skewed the chip signals are towards high values in the query versus background lists (see <xref ref-type="sec" rid="sec002">Methods</xref>). It follows then, that the output (p values, Scores and ranks) are sensitive to the background lists (<xref ref-type="fig" rid="pcbi.1007800.g004">Fig 4</xref>). Unlike FET p values that scale with background list sizes and do not change rank order, MAGIC p values have a complicated relationship with background gene content. The shape of the background cumulative will change depending on the set of genes in it, and so the maximal distance between it and the input cumulative (i.e. the Kolmogorov-Smirnov D statistic) will either increase or decrease depending on the argument of D.</p>
    <p>Testing MAGIC on cells transfected with REST shRNA highlights the ability of the algorithm to not only identify transcription factors but also their associated cofactors. MAGIC called REST as the highest scoring factor but also called SIN3A, HDAC2, CoREST, G9a and CtBP2, which are well-characterized REST cofactors[<xref rid="pcbi.1007800.ref028" ref-type="bibr">28</xref>–<xref rid="pcbi.1007800.ref031" ref-type="bibr">31</xref>]. EZH2 and SUZ12 were also called as factors that preferentially bind up-regulated genes. Though there are reports of REST interacting with Polycomb[<xref rid="pcbi.1007800.ref032" ref-type="bibr">32</xref>], it is likely that Polycomb targets many of the same genes as REST but does so independently[<xref rid="pcbi.1007800.ref033" ref-type="bibr">33</xref>]. Interestingly the second highest scoring Factor was SP2 that has no reported association with REST (<xref ref-type="supplementary-material" rid="pcbi.1007800.s010">S9 Table</xref>). Current work in the lab is focussed on testing the hypothesis that REST and SP2 do interact–perhaps in a similar manner to REST and SP3[<xref rid="pcbi.1007800.ref034" ref-type="bibr">34</xref>].</p>
    <p>Using gene lists derived from over 300 breast tumor transcriptomes (<xref ref-type="supplementary-material" rid="pcbi.1007800.s011">S10 Table</xref>), MAGIC correctly called ERα (encoded by the ESR1 gene) as the principal TF in ER positive (Luminal-A) versus negative (Basal-like) tumors. ERα binds chromatin with pioneer factors and MAGIC sucessfully called GATA3, FOXA1 and FOXA2[<xref rid="pcbi.1007800.ref035" ref-type="bibr">35</xref>]. P300 and EZH2 are ERα cofactors and were called by MAGIC[<xref rid="pcbi.1007800.ref036" ref-type="bibr">36</xref>, <xref rid="pcbi.1007800.ref037" ref-type="bibr">37</xref>].</p>
    <p>ENCODE hosts ChIP-seq tracks derived from transformed or immortal cell lines and human embryonic stem cells. A particular concern was that generating a matrix from homogenous cell lines may preclude MAGIC’s use in analysis of transcriptome data derived from in vivo samples that are not immortalized and likely heterogeneous. However, testing of MAGIC on CTCF knock-out mouse brains demonstrates that gene lists derived from control and experimental whole brain extract are handled appropriately (<xref ref-type="supplementary-material" rid="pcbi.1007800.s012">S11 Table</xref>). In GSE84175, CTCF was deleted in a subset of post-mitotic cells (eliminated from excitatory neurons but retained in all other neuronal subtypes)[<xref rid="pcbi.1007800.ref018" ref-type="bibr">18</xref>, <xref rid="pcbi.1007800.ref038" ref-type="bibr">38</xref>]. MAGIC correctly called CTCF as the principle factor in the experiment. The CTCF binding partner RAD21 was also called and would reflect its role as part of the cohesin complex[<xref rid="pcbi.1007800.ref039" ref-type="bibr">39</xref>, <xref rid="pcbi.1007800.ref040" ref-type="bibr">40</xref>]. Interestingly, ZNF143 was also in the top 5 hits. This is in keeping with the recent findings of Mourad and Cuvier[<xref rid="pcbi.1007800.ref038" ref-type="bibr">38</xref>] showing that CTCF and ZNF143 coordinate chromatin border domain formation. Thus, MAGIC was able to call CTCF as well as a known associated proteins when provided transcriptome data from a highly heterogeneous tissue where only a small subset of cells were altered in the experiment.</p>
    <p>Single cell RNA-seq on hippocampal dentate granule cells from mice subjected to novel environments shows differences in transcriptomes between sparsley firing neurons in the dentate gyrus versus quiet cells[<xref rid="pcbi.1007800.ref019" ref-type="bibr">19</xref>]. When profiles are sorted based on FOS expression, MAGIC was able to call FOS as the second most likely driver of gene changes, placing the highly homologous protein FOSL2 as top rank[<xref rid="pcbi.1007800.ref041" ref-type="bibr">41</xref>]. This prediction was superior to any of the other algorithms.</p>
    <p>All analyses in this manuscript utilized the 1Kb_gene.mtx matrix. Nearly identical results were obtained with the 5Kb_gene.mtx. Future work will focus on the relative performances of the matrices provided. It should be noted that none of the matrices incorporate information from distal enhancers which are clearly key to fully understanding gene regulation[<xref rid="pcbi.1007800.ref042" ref-type="bibr">42</xref>]. Current efforts are underway to incorporate long distance information into the MAGIC algorithm. A prototype of the MAGIC approach was recently used to identify EZH2 as a principle driver of gene changes in epilepsy[<xref rid="pcbi.1007800.ref043" ref-type="bibr">43</xref>]. The approach was validated by biochemical analysis of mouse brains that showed an almost order of magnitude increase in levels of this protein over a 10 day window after seizure induction and robust repression of target genes. This prototypical approach aggregated all ChIP-seq tracks for a Factor into one meta-track and so lost all information on cell type and experimental conditions. Also, a Mann-Whitney test was incorporated instead of the more sensitive Kolmogorov-smirnov test. Nevertheless, it provided an extremely powerful prediction of EZH2 induction. MAGIC concurs with the prototypical algorithm.</p>
    <p>MAGIC was tested against CHEA3, TFEA and Enrichr on 4 datasets where it performed well. However, the general performance level of MAGIC against the leading algorithms will only be truly revealed with significantly increased numbers of tests. In conclusion, MAGIC was able to call principle transcription factors and cofactors that target gene lists with a performance comparable to or better than current leading brand algorithms.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec021">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pcbi.1007800.s001">
      <label>S1 Fig</label>
      <caption>
        <title>Example of a CDF graphic produced by MAGIC.</title>
        <p>Two cumulative functions are displayed: the black curve is the fractional cumulative of all genes in the background list against ChIP values, red is the same for query genes. A blue vertical line denotes the ChIP value at D<sub>sup</sub> i.e. arg<sub>Dsup</sub>. Red ticks along the x-axis represent each gene in the query list and black ticks are all genes in the background. Red ticks with circles (‘lollipops’) are the n (n = 0.05X) best chiped genes. Black lollipops are genes in the background list with the n highest ChIP values.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pcbi.1007800.s001.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007800.s002">
      <label>S1 Table</label>
      <caption>
        <title>Background and input list for MCF7(shCon_vs_shREST).</title>
        <p>The first column contains 15445 genes in the background list. Second column contains 118 genes induced as described in Methods and Results.</p>
        <p>(TXT)</p>
      </caption>
      <media xlink:href="pcbi.1007800.s002.txt">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007800.s003">
      <label>S2 Table</label>
      <caption>
        <title>Background and input list for TCGA(Lum_vs_Basal).</title>
        <p>The first column contains 17815 genes in the background list. Second column contains 203 genes induced as described in Methods and Results.</p>
        <p>(TXT)</p>
      </caption>
      <media xlink:href="pcbi.1007800.s003.txt">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007800.s004">
      <label>S3 Table</label>
      <caption>
        <title>Background and input list for Brain(WT_vs_CTCFko).</title>
        <p>The first column contains 15509 genes in the background list. Second column contains 203 genes down-regulated as described in Methods and Results.</p>
        <p>(TXT)</p>
      </caption>
      <media xlink:href="pcbi.1007800.s004.txt">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007800.s005">
      <label>S4 Table</label>
      <caption>
        <title>Background and input list for DGC(Quiet_vs_Reactive).</title>
        <p>The first column contains 5305 genes in the background list. Second column contains 842 genes induced as described in Methods and Results.</p>
        <p>(TXT)</p>
      </caption>
      <media xlink:href="pcbi.1007800.s005.txt">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007800.s006">
      <label>S5 Table</label>
      <caption>
        <title>REST interactors and rank-ordered algorithm outputs for MCF7(shCon_vs_shREST).</title>
        <p>The first column contains proteins associated with REST extracted from the STRING database with a Combined Score&gt;300. Subsequent columns contain ordered lists of Factors predicted to target the input list by the varous algorithms and associated libraries. If the same Factor appears multiple times, it is because there are multiple entries (e.g. ChIP-seq tracks in different cell lines) for that factor in the libraries mined by the algorithm.</p>
        <p>(TXT)</p>
      </caption>
      <media xlink:href="pcbi.1007800.s006.txt">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007800.s007">
      <label>S6 Table</label>
      <caption>
        <title>Estrogen Receptor alpha (ESR1) interactors and rank-ordered algorithm outputs for TCGA(Lum_vs_Basal).</title>
        <p>The first column contains proteins associated with ESR1 extracted from the STRING database with a Combined Score&gt;300. Subsequent columns contain ordered lists of Factors predicted to target the input list by the varous algorithms and associated libraries.</p>
        <p>(TXT)</p>
      </caption>
      <media xlink:href="pcbi.1007800.s007.txt">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007800.s008">
      <label>S7 Table</label>
      <caption>
        <title>CTCF interactors and rank-ordered algorithm outputs for Brain(WT_vs_CTCFko).</title>
        <p>The first column contains proteins associated with CTCF extracted from the STRING database with a Combined Score&gt;300. Subsequent columns contain ordered lists of Factors predicted to target the input list by the varous algorithms and associated libraries.</p>
        <p>(TXT)</p>
      </caption>
      <media xlink:href="pcbi.1007800.s008.txt">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007800.s009">
      <label>S8 Table</label>
      <caption>
        <title>FOS interactors and rank-ordered algorithm outputs for DGC(Quiet_vs_Reactive).</title>
        <p>The first column contains proteins associated with FOS extracted from the STRING database with a Combined Score&gt;300. Subsequent columns contain ordered lists of Factors predicted to target the input list by the varous algorithms and associated libraries.</p>
        <p>(TXT)</p>
      </caption>
      <media xlink:href="pcbi.1007800.s009.txt">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007800.s010">
      <label>S9 Table</label>
      <caption>
        <title>MAGIC Summary output for MCF7(shCon_vs_shREST).</title>
        <p>The analysis statistics for the best scoring example of each Factor in the MAGIC matrix for MCF7(shCon_vs_shREST) are provided in the summary file.</p>
        <p>(TXT)</p>
      </caption>
      <media xlink:href="pcbi.1007800.s010.txt">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007800.s011">
      <label>S10 Table</label>
      <caption>
        <title>MAGIC Summary output for TCGA(Lum_vs_Basal).</title>
        <p>The analysis statistics for the best scoring example of each Factor in the MAGIC matrix for TCGA(Lum_vs_Basal) are provided in the summary file.</p>
        <p>(TXT)</p>
      </caption>
      <media xlink:href="pcbi.1007800.s011.txt">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007800.s012">
      <label>S11 Table</label>
      <caption>
        <title>MAGIC Summary output for Brain(WT_vs_CTCFko).</title>
        <p>The analysis statistics for the best scoring example of each Factor in the MAGIC matrix for Brain(WT_vs_CTCFko) are provided in the summary file.</p>
        <p>(TXT)</p>
      </caption>
      <media xlink:href="pcbi.1007800.s012.txt">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007800.s013">
      <label>S12 Table</label>
      <caption>
        <title>MAGIC Summary output for DGC(Quiet_vs_Reactive).</title>
        <p>The analysis statistics for the best scoring example of each Factor in the MAGIC matrix for DGC(Quiet_vs_Reactive) are provided in the summary file.</p>
        <p>(TXT)</p>
      </caption>
      <media xlink:href="pcbi.1007800.s013.txt">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>I would like to thank Ray Dingledine and Steve Goldstein for critical insights into the statistics behind MAGIC. I thank John Svaren for helpful edits of the manuscript. I am grateful to Caroline Alexander for editing, aiding, encouraging and cojoling the submission of this manuscript. I would like to thank Queen because ‘It’s a Kind of Magic’.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1007800.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Lambert</surname><given-names>SA</given-names></name>, <name><surname>Jolma</surname><given-names>A</given-names></name>, <name><surname>Campitelli</surname><given-names>LF</given-names></name>, <name><surname>Das</surname><given-names>PK</given-names></name>, <name><surname>Yin</surname><given-names>Y</given-names></name>, <name><surname>Albu</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>The Human Transcription Factors</article-title>. <source>Cell</source>. <year>2018</year>;<volume>172</volume>(<issue>4</issue>):<fpage>650</fpage>–<lpage>65</lpage>. Epub 2018/02/10. <pub-id pub-id-type="doi">10.1016/j.cell.2018.01.029</pub-id> .<?supplied-pmid 29425488?><pub-id pub-id-type="pmid">29425488</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><collab>Cancer Genome Atlas Research N</collab>, <name><surname>Weinstein</surname><given-names>JN</given-names></name>, <name><surname>Collisson</surname><given-names>EA</given-names></name>, <name><surname>Mills</surname><given-names>GB</given-names></name>, <name><surname>Shaw</surname><given-names>KR</given-names></name>, <name><surname>Ozenberger</surname><given-names>BA</given-names></name>, <etal>et al</etal><article-title>The Cancer Genome Atlas Pan-Cancer analysis project</article-title>. <source>Nat Genet</source>. <year>2013</year>;<volume>45</volume>(<issue>10</issue>):<fpage>1113</fpage>–<lpage>20</lpage>. Epub 2013/09/28. <pub-id pub-id-type="doi">10.1038/ng.2764</pub-id><?supplied-pmid 24071849?><pub-id pub-id-type="pmid">24071849</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Cusanovich</surname><given-names>DA</given-names></name>, <name><surname>Pavlovic</surname><given-names>B</given-names></name>, <name><surname>Pritchard</surname><given-names>JK</given-names></name>, <name><surname>Gilad</surname><given-names>Y</given-names></name>. <article-title>The functional consequences of variation in transcription factor binding</article-title>. <source>PLoS Genet</source>. <year>2014</year>;<volume>10</volume>(<issue>3</issue>):<fpage>e1004226</fpage> Epub 2014/03/08. <pub-id pub-id-type="doi">10.1371/journal.pgen.1004226</pub-id>
<?supplied-pmid 24603674?><pub-id pub-id-type="pmid">24603674</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Jolma</surname><given-names>A</given-names></name>, <name><surname>Yan</surname><given-names>J</given-names></name>, <name><surname>Whitington</surname><given-names>T</given-names></name>, <name><surname>Toivonen</surname><given-names>J</given-names></name>, <name><surname>Nitta</surname><given-names>KR</given-names></name>, <name><surname>Rastas</surname><given-names>P</given-names></name>, <etal>et al</etal><article-title>DNA-binding specificities of human transcription factors</article-title>. <source>Cell</source>. <year>2013</year>;<volume>152</volume>(<issue>1–2</issue>):<fpage>327</fpage>–<lpage>39</lpage>. Epub 2013/01/22. <pub-id pub-id-type="doi">10.1016/j.cell.2012.12.009</pub-id> .<?supplied-pmid 23332764?><pub-id pub-id-type="pmid">23332764</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Kwon</surname><given-names>AT</given-names></name>, <name><surname>Arenillas</surname><given-names>DJ</given-names></name>, <name><surname>Worsley Hunt</surname><given-names>R</given-names></name>, <name><surname>Wasserman</surname><given-names>WW</given-names></name>. <article-title>oPOSSUM-3: advanced analysis of regulatory motif over-representation across genes or ChIP-Seq datasets</article-title>. <source>G3 (Bethesda)</source>. <year>2012</year>;<volume>2</volume>(<issue>9</issue>):<fpage>987</fpage>–<lpage>1002</lpage>. Epub 2012/09/14. <pub-id pub-id-type="doi">10.1534/g3.112.003202</pub-id><?supplied-pmid 22973536?><pub-id pub-id-type="pmid">22973536</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Spitz</surname><given-names>F</given-names></name>, <name><surname>Furlong</surname><given-names>EE</given-names></name>. <article-title>Transcription factors: from enhancer binding to developmental control</article-title>. <source>Nat Rev Genet</source>. <year>2012</year>;<volume>13</volume>(<issue>9</issue>):<fpage>613</fpage>–<lpage>26</lpage>. Epub 2012/08/08. <pub-id pub-id-type="doi">10.1038/nrg3207</pub-id> .<?supplied-pmid 22868264?><pub-id pub-id-type="pmid">22868264</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Lee</surname><given-names>TI</given-names></name>, <name><surname>Young</surname><given-names>RA</given-names></name>. <article-title>Transcriptional regulation and its misregulation in disease</article-title>. <source>Cell</source>. <year>2013</year>;<volume>152</volume>(<issue>6</issue>):<fpage>1237</fpage>–<lpage>51</lpage>. Epub 2013/03/19. <pub-id pub-id-type="doi">10.1016/j.cell.2013.02.014</pub-id><?supplied-pmid 23498934?><pub-id pub-id-type="pmid">23498934</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Subramanian</surname><given-names>A</given-names></name>, <name><surname>Tamayo</surname><given-names>P</given-names></name>, <name><surname>Mootha</surname><given-names>VK</given-names></name>, <name><surname>Mukherjee</surname><given-names>S</given-names></name>, <name><surname>Ebert</surname><given-names>BL</given-names></name>, <name><surname>Gillette</surname><given-names>MA</given-names></name>, <etal>et al</etal><article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2005</year>;<volume>102</volume>(<issue>43</issue>):<fpage>15545</fpage>–<lpage>50</lpage>. Epub 2005/10/04. <pub-id pub-id-type="doi">10.1073/pnas.0506580102</pub-id><?supplied-pmid 16199517?><pub-id pub-id-type="pmid">16199517</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>Z</given-names></name>, <name><surname>Civelek</surname><given-names>M</given-names></name>, <name><surname>Miller</surname><given-names>CL</given-names></name>, <name><surname>Sheffield</surname><given-names>NC</given-names></name>, <name><surname>Guertin</surname><given-names>MJ</given-names></name>, <name><surname>Zang</surname><given-names>C</given-names></name>. <article-title>BART: a transcription factor prediction tool with query gene sets or epigenomic profiles</article-title>. <source>Bioinformatics</source>. <year>2018</year>;<volume>34</volume>(<issue>16</issue>):<fpage>2867</fpage>–<lpage>9</lpage>. Epub 2018/04/03. <pub-id pub-id-type="doi">10.1093/bioinformatics/bty194</pub-id><?supplied-pmid 29608647?><pub-id pub-id-type="pmid">29608647</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Alvarez</surname><given-names>MJ</given-names></name>, <name><surname>Shen</surname><given-names>Y</given-names></name>, <name><surname>Giorgi</surname><given-names>FM</given-names></name>, <name><surname>Lachmann</surname><given-names>A</given-names></name>, <name><surname>Ding</surname><given-names>BB</given-names></name>, <name><surname>Ye</surname><given-names>BH</given-names></name>, <etal>et al</etal><article-title>Functional characterization of somatic mutations in cancer using network-based inference of protein activity</article-title>. <source>Nat Genet</source>. <year>2016</year>;<volume>48</volume>(<issue>8</issue>):<fpage>838</fpage>–<lpage>47</lpage>. Epub 2016/06/21. <pub-id pub-id-type="doi">10.1038/ng.3593</pub-id><?supplied-pmid 27322546?><pub-id pub-id-type="pmid">27322546</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Puente-Santamaria</surname><given-names>L</given-names></name>, <name><surname>Wasserman</surname><given-names>WW</given-names></name>, <name><surname>Del Peso</surname><given-names>L</given-names></name>. <article-title>TFEA.ChIP: A tool kit for transcription factor binding site enrichment analysis capitalizing on ChIP-seq datasets</article-title>. <source>Bioinformatics</source>. <year>2019</year> Epub 2019/07/28. <pub-id pub-id-type="doi">10.1093/bioinformatics/btz573</pub-id> .<?supplied-pmid 31347689?><pub-id pub-id-type="pmid">31347689</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>EY</given-names></name>, <name><surname>Tan</surname><given-names>CM</given-names></name>, <name><surname>Kou</surname><given-names>Y</given-names></name>, <name><surname>Duan</surname><given-names>Q</given-names></name>, <name><surname>Wang</surname><given-names>Z</given-names></name>, <name><surname>Meirelles</surname><given-names>GV</given-names></name>, <etal>et al</etal><article-title>Enrichr: interactive and collaborative HTML5 gene list enrichment analysis tool</article-title>. <source>BMC Bioinformatics</source>. <year>2013</year>;<volume>14</volume>:<fpage>128</fpage> Epub 2013/04/17. <pub-id pub-id-type="doi">10.1186/1471-2105-14-128</pub-id>
<?supplied-pmid 23586463?><pub-id pub-id-type="pmid">23586463</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Keenan</surname><given-names>AB</given-names></name>, <name><surname>Torre</surname><given-names>D</given-names></name>, <name><surname>Lachmann</surname><given-names>A</given-names></name>, <name><surname>Leong</surname><given-names>AK</given-names></name>, <name><surname>Wojciechowicz</surname><given-names>ML</given-names></name>, <name><surname>Utti</surname><given-names>V</given-names></name>, <etal>et al</etal><article-title>ChEA3: transcription factor enrichment analysis by orthogonal omics integration</article-title>. <source>Nucleic Acids Res</source>. <year>2019</year>;<volume>47</volume>(<issue>W1</issue>):<fpage>W212</fpage>–<lpage>W24</lpage>. Epub 2019/05/23. <pub-id pub-id-type="doi">10.1093/nar/gkz446</pub-id><?supplied-pmid 31114921?><pub-id pub-id-type="pmid">31114921</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Biggin</surname><given-names>MD</given-names></name>. <article-title>Animal transcription networks as highly connected, quantitative continua</article-title>. <source>Dev Cell</source>. <year>2011</year>;<volume>21</volume>(<issue>4</issue>):<fpage>611</fpage>–<lpage>26</lpage>. Epub 2011/10/22. <pub-id pub-id-type="doi">10.1016/j.devcel.2011.09.008</pub-id> .<?supplied-pmid 22014521?><pub-id pub-id-type="pmid">22014521</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Meyer</surname><given-names>K</given-names></name>, <name><surname>Albaugh</surname><given-names>B</given-names></name>, <name><surname>Schoenike</surname><given-names>B</given-names></name>, <name><surname>Roopra</surname><given-names>A</given-names></name>. <article-title>Type 1 Insulin-Like Growth Factor Receptor/Insulin Receptor Substrate 1 Signaling Confers Pathogenic Activity on Breast Tumor Cells Lacking REST</article-title>. <source>Mol Cell Biol</source>. <year>2015</year>;<volume>35</volume>(<issue>17</issue>):<fpage>2991</fpage>–<lpage>3004</lpage>. Epub 2015/06/24. <pub-id pub-id-type="doi">10.1128/MCB.01149-14</pub-id><?supplied-pmid 26100015?><pub-id pub-id-type="pmid">26100015</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Benjamini</surname><given-names>Y</given-names></name>, <name><surname>Hochberg</surname><given-names>Y</given-names></name>. <article-title>Controlling the False Discovery Rate—a Practical and Powerful Approach to Multiple Testing</article-title>. <source>J R Stat Soc B</source>. <year>1995</year>;<volume>57</volume>(<issue>1</issue>):<fpage>289</fpage>–<lpage>300</lpage>. WOS:A1995QE45300017.</mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Nielsen</surname><given-names>TO</given-names></name>, <name><surname>Parker</surname><given-names>JS</given-names></name>, <name><surname>Leung</surname><given-names>S</given-names></name>, <name><surname>Voduc</surname><given-names>D</given-names></name>, <name><surname>Ebbert</surname><given-names>M</given-names></name>, <name><surname>Vickery</surname><given-names>T</given-names></name>, <etal>et al</etal><article-title>A comparison of PAM50 intrinsic subtyping with immunohistochemistry and clinical prognostic factors in tamoxifen-treated estrogen receptor-positive breast cancer</article-title>. <source>Clin Cancer Res</source>. <year>2010</year>;<volume>16</volume>(<issue>21</issue>):<fpage>5222</fpage>–<lpage>32</lpage>. Epub 2010/09/15. <pub-id pub-id-type="doi">10.1158/1078-0432.CCR-10-1282</pub-id><?supplied-pmid 20837693?><pub-id pub-id-type="pmid">20837693</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Sams</surname><given-names>DS</given-names></name>, <name><surname>Nardone</surname><given-names>S</given-names></name>, <name><surname>Getselter</surname><given-names>D</given-names></name>, <name><surname>Raz</surname><given-names>D</given-names></name>, <name><surname>Tal</surname><given-names>M</given-names></name>, <name><surname>Rayi</surname><given-names>PR</given-names></name>, <etal>et al</etal><article-title>Neuronal CTCF Is Necessary for Basal and Experience-Dependent Gene Regulation, Memory Formation, and Genomic Structure of BDNF and Arc</article-title>. <source>Cell Rep</source>. <year>2016</year>;<volume>17</volume>(<issue>9</issue>):<fpage>2418</fpage>–<lpage>30</lpage>. Epub 2016/11/24. <pub-id pub-id-type="doi">10.1016/j.celrep.2016.11.004</pub-id> .<?supplied-pmid 27880914?><pub-id pub-id-type="pmid">27880914</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Jaeger</surname><given-names>BN</given-names></name>, <name><surname>Linker</surname><given-names>SB</given-names></name>, <name><surname>Parylak</surname><given-names>SL</given-names></name>, <name><surname>Barron</surname><given-names>JJ</given-names></name>, <name><surname>Gallina</surname><given-names>IS</given-names></name>, <name><surname>Saavedra</surname><given-names>CD</given-names></name>, <etal>et al</etal><article-title>A novel environment-evoked transcriptional signature predicts reactivity in single dentate granule neurons</article-title>. <source>Nat Commun</source>. <year>2018</year>;<volume>9</volume>(<issue>1</issue>):<fpage>3084</fpage> Epub 2018/08/08. <pub-id pub-id-type="doi">10.1038/s41467-018-05418-8</pub-id>
<?supplied-pmid 30082781?><pub-id pub-id-type="pmid">30082781</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Szklarczyk</surname><given-names>D</given-names></name>, <name><surname>Morris</surname><given-names>JH</given-names></name>, <name><surname>Cook</surname><given-names>H</given-names></name>, <name><surname>Kuhn</surname><given-names>M</given-names></name>, <name><surname>Wyder</surname><given-names>S</given-names></name>, <name><surname>Simonovic</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>The STRING database in 2017: quality-controlled protein-protein association networks, made broadly accessible</article-title>. <source>Nucleic Acids Res</source>. <year>2017</year>;<volume>45</volume>(<issue>D1</issue>):<fpage>D362</fpage>–<lpage>D8</lpage>. Epub 2016/12/08. <pub-id pub-id-type="doi">10.1093/nar/gkw937</pub-id><?supplied-pmid 27924014?><pub-id pub-id-type="pmid">27924014</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Gunsalus</surname><given-names>KT</given-names></name>, <name><surname>Wagoner</surname><given-names>MP</given-names></name>, <name><surname>Meyer</surname><given-names>K</given-names></name>, <name><surname>Potter</surname><given-names>WB</given-names></name>, <name><surname>Schoenike</surname><given-names>B</given-names></name>, <name><surname>Kim</surname><given-names>S</given-names></name>, <etal>et al</etal><article-title>Induction of the RNA regulator LIN28A is required for the growth and pathogenesis of RESTless breast tumors</article-title>. <source>Cancer Res</source>. <year>2012</year>;<volume>72</volume>(<issue>13</issue>):<fpage>3207</fpage>–<lpage>16</lpage>. Epub 2012/04/26. <pub-id pub-id-type="doi">10.1158/0008-5472.CAN-11-1639</pub-id><?supplied-pmid 22532168?><pub-id pub-id-type="pmid">22532168</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Wagoner</surname><given-names>MP</given-names></name>, <name><surname>Gunsalus</surname><given-names>KT</given-names></name>, <name><surname>Schoenike</surname><given-names>B</given-names></name>, <name><surname>Richardson</surname><given-names>AL</given-names></name>, <name><surname>Friedl</surname><given-names>A</given-names></name>, <name><surname>Roopra</surname><given-names>A</given-names></name>. <article-title>The transcription factor REST is lost in aggressive breast cancer</article-title>. <source>PLoS Genet</source>. <year>2010</year>;<volume>6</volume>(<issue>6</issue>):<fpage>e1000979</fpage> Epub 2010/06/16. <pub-id pub-id-type="doi">10.1371/journal.pgen.1000979</pub-id>
<?supplied-pmid 20548947?><pub-id pub-id-type="pmid">20548947</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><collab>The Cancer Genome Atlas N</collab>, <name><surname>Koboldt</surname><given-names>DC</given-names></name>, <name><surname>Fulton</surname><given-names>RS</given-names></name>, <name><surname>McLellan</surname><given-names>MD</given-names></name>, <name><surname>Schmidt</surname><given-names>H</given-names></name>, <name><surname>Kalicki-Veizer</surname><given-names>J</given-names></name>, <etal>et al</etal><article-title>Comprehensive molecular portraits of human breast tumours</article-title>. <source>Nature</source>. <year>2012</year>;<volume>490</volume>:<fpage>61</fpage><pub-id pub-id-type="doi">10.1038/nature11412</pub-id><ext-link ext-link-type="uri" xlink:href="https://www.nature.com/articles/nature11412#supplementary-information">https://www.nature.com/articles/nature11412#supplementary-information</ext-link>. <?supplied-pmid 23000897?><pub-id pub-id-type="pmid">23000897</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Ghirlando</surname><given-names>R</given-names></name>, <name><surname>Felsenfeld</surname><given-names>G</given-names></name>. <article-title>CTCF: making the right connections</article-title>. <source>Genes Dev</source>. <year>2016</year>;<volume>30</volume>(<issue>8</issue>):<fpage>881</fpage>–<lpage>91</lpage>. Epub 2016/04/17. <pub-id pub-id-type="doi">10.1101/gad.277863.116</pub-id><?supplied-pmid 27083996?><pub-id pub-id-type="pmid">27083996</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Benito</surname><given-names>E</given-names></name>, <name><surname>Barco</surname><given-names>A</given-names></name>. <article-title>The neuronal activity-driven transcriptome</article-title>. <source>Mol Neurobiol</source>. <year>2015</year>;<volume>51</volume>(<issue>3</issue>):<fpage>1071</fpage>–<lpage>88</lpage>. Epub 2014/06/18. <pub-id pub-id-type="doi">10.1007/s12035-014-8772-z</pub-id> .<?supplied-pmid 24935719?><pub-id pub-id-type="pmid">24935719</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Reiter</surname><given-names>F</given-names></name>, <name><surname>Wienerroither</surname><given-names>S</given-names></name>, <name><surname>Stark</surname><given-names>A</given-names></name>. <article-title>Combinatorial function of transcription factors and cofactors</article-title>. <source>Curr Opin Genet Dev</source>. <year>2017</year>;<volume>43</volume>:<fpage>73</fpage>–<lpage>81</lpage>. Epub 2017/01/23. <pub-id pub-id-type="doi">10.1016/j.gde.2016.12.007</pub-id> .<?supplied-pmid 28110180?><pub-id pub-id-type="pmid">28110180</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>von Mering</surname><given-names>C</given-names></name>, <name><surname>Jensen</surname><given-names>LJ</given-names></name>, <name><surname>Snel</surname><given-names>B</given-names></name>, <name><surname>Hooper</surname><given-names>SD</given-names></name>, <name><surname>Krupp</surname><given-names>M</given-names></name>, <name><surname>Foglierini</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>STRING: known and predicted protein-protein associations, integrated and transferred across organisms</article-title>. <source>Nucleic Acids Res</source>. <year>2005</year>;<volume>33</volume>(Database issue):<fpage>D433</fpage>–<lpage>7</lpage>. Epub 2004/12/21. <pub-id pub-id-type="doi">10.1093/nar/gki005</pub-id><?supplied-pmid 15608232?><pub-id pub-id-type="pmid">15608232</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Andres</surname><given-names>ME</given-names></name>, <name><surname>Burger</surname><given-names>C</given-names></name>, <name><surname>Peral-Rubio</surname><given-names>MJ</given-names></name>, <name><surname>Battaglioli</surname><given-names>E</given-names></name>, <name><surname>Anderson</surname><given-names>ME</given-names></name>, <name><surname>Grimes</surname><given-names>J</given-names></name>, <etal>et al</etal><article-title>CoREST: a functional corepressor required for regulation of neural-specific gene expression</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>1999</year>;<volume>96</volume>(<issue>17</issue>):<fpage>9873</fpage>–<lpage>8</lpage>. Epub 1999/08/18. <pub-id pub-id-type="doi">10.1073/pnas.96.17.9873</pub-id><?supplied-pmid 10449787?><pub-id pub-id-type="pmid">10449787</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Garriga-Canut</surname><given-names>M</given-names></name>, <name><surname>Schoenike</surname><given-names>B</given-names></name>, <name><surname>Qazi</surname><given-names>R</given-names></name>, <name><surname>Bergendahl</surname><given-names>K</given-names></name>, <name><surname>Daley</surname><given-names>TJ</given-names></name>, <name><surname>Pfender</surname><given-names>RM</given-names></name>, <etal>et al</etal><article-title>2-Deoxy-D-glucose reduces epilepsy progression by NRSF-CtBP-dependent metabolic regulation of chromatin structure</article-title>. <source>Nat Neurosci</source>. <year>2006</year>;<volume>9</volume>(<issue>11</issue>):<fpage>1382</fpage>–<lpage>7</lpage>. Epub 2006/10/17. <pub-id pub-id-type="doi">10.1038/nn1791</pub-id> .<?supplied-pmid 17041593?><pub-id pub-id-type="pmid">17041593</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Huang</surname><given-names>Y</given-names></name>, <name><surname>Myers</surname><given-names>SJ</given-names></name>, <name><surname>Dingledine</surname><given-names>R</given-names></name>. <article-title>Transcriptional repression by REST: recruitment of Sin3A and histone deacetylase to neuronal genes</article-title>. <source>Nat Neurosci</source>. <year>1999</year>;<volume>2</volume>(<issue>10</issue>):<fpage>867</fpage>–<lpage>72</lpage>. Epub 1999/09/24. <pub-id pub-id-type="doi">10.1038/13165</pub-id> .<?supplied-pmid 10491605?><pub-id pub-id-type="pmid">10491605</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Roopra</surname><given-names>A</given-names></name>, <name><surname>Sharling</surname><given-names>L</given-names></name>, <name><surname>Wood</surname><given-names>IC</given-names></name>, <name><surname>Briggs</surname><given-names>T</given-names></name>, <name><surname>Bachfischer</surname><given-names>U</given-names></name>, <name><surname>Paquette</surname><given-names>AJ</given-names></name>, <etal>et al</etal><article-title>Transcriptional repression by neuron-restrictive silencer factor is mediated via the Sin3-histone deacetylase complex</article-title>. <source>Mol Cell Biol</source>. <year>2000</year>;<volume>20</volume>(<issue>6</issue>):<fpage>2147</fpage>–<lpage>57</lpage>. Epub 2000/02/25. <pub-id pub-id-type="doi">10.1128/mcb.20.6.2147-2157.2000</pub-id><?supplied-pmid 10688661?><pub-id pub-id-type="pmid">10688661</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Dietrich</surname><given-names>N</given-names></name>, <name><surname>Lerdrup</surname><given-names>M</given-names></name>, <name><surname>Landt</surname><given-names>E</given-names></name>, <name><surname>Agrawal-Singh</surname><given-names>S</given-names></name>, <name><surname>Bak</surname><given-names>M</given-names></name>, <name><surname>Tommerup</surname><given-names>N</given-names></name>, <etal>et al</etal><article-title>REST-mediated recruitment of polycomb repressor complexes in mammalian cells</article-title>. <source>PLoS Genet</source>. <year>2012</year>;<volume>8</volume>(<issue>3</issue>):<fpage>e1002494</fpage> Epub 2012/03/08. <pub-id pub-id-type="doi">10.1371/journal.pgen.1002494</pub-id>
<?supplied-pmid 22396653?><pub-id pub-id-type="pmid">22396653</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>McGann</surname><given-names>JC</given-names></name>, <name><surname>Oyer</surname><given-names>JA</given-names></name>, <name><surname>Garg</surname><given-names>S</given-names></name>, <name><surname>Yao</surname><given-names>H</given-names></name>, <name><surname>Liu</surname><given-names>J</given-names></name>, <name><surname>Feng</surname><given-names>X</given-names></name>, <etal>et al</etal><article-title>Polycomb- and REST-associated histone deacetylases are independent pathways toward a mature neuronal phenotype</article-title>. <source>Elife</source>. <year>2014</year>;<volume>3</volume>:<fpage>e04235</fpage> Epub 2014/09/25. <pub-id pub-id-type="doi">10.7554/eLife.04235</pub-id>
<?supplied-pmid 25250711?><pub-id pub-id-type="pmid">25250711</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Formisano</surname><given-names>L</given-names></name>, <name><surname>Guida</surname><given-names>N</given-names></name>, <name><surname>Valsecchi</surname><given-names>V</given-names></name>, <name><surname>Cantile</surname><given-names>M</given-names></name>, <name><surname>Cuomo</surname><given-names>O</given-names></name>, <name><surname>Vinciguerra</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>Sp3/REST/HDAC1/HDAC2 Complex Represses and Sp1/HIF-1/p300 Complex Activates ncx1 Gene Transcription, in Brain Ischemia and in Ischemic Brain Preconditioning, by Epigenetic Mechanism</article-title>. <source>J Neurosci</source>. <year>2015</year>;<volume>35</volume>(<issue>19</issue>):<fpage>7332</fpage>–<lpage>48</lpage>. Epub 2015/05/15. <pub-id pub-id-type="doi">10.1523/JNEUROSCI.2174-14.2015</pub-id><?supplied-pmid 25972164?><pub-id pub-id-type="pmid">25972164</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Zaret</surname><given-names>KS</given-names></name>, <name><surname>Carroll</surname><given-names>JS</given-names></name>. <article-title>Pioneer transcription factors: establishing competence for gene expression</article-title>. <source>Genes Dev</source>. <year>2011</year>;<volume>25</volume>(<issue>21</issue>):<fpage>2227</fpage>–<lpage>41</lpage>. Epub 2011/11/08. <pub-id pub-id-type="doi">10.1101/gad.176826.111</pub-id><?supplied-pmid 22056668?><pub-id pub-id-type="pmid">22056668</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Shang</surname><given-names>Y</given-names></name>, <name><surname>Hu</surname><given-names>X</given-names></name>, <name><surname>DiRenzo</surname><given-names>J</given-names></name>, <name><surname>Lazar</surname><given-names>MA</given-names></name>, <name><surname>Brown</surname><given-names>M</given-names></name>. <article-title>Cofactor dynamics and sufficiency in estrogen receptor-regulated transcription</article-title>. <source>Cell</source>. <year>2000</year>;<volume>103</volume>(<issue>6</issue>):<fpage>843</fpage>–<lpage>52</lpage>. Epub 2001/01/04. <pub-id pub-id-type="doi">10.1016/s0092-8674(00)00188-4</pub-id> .<?supplied-pmid 11136970?><pub-id pub-id-type="pmid">11136970</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Hwang</surname><given-names>C</given-names></name>, <name><surname>Giri</surname><given-names>VN</given-names></name>, <name><surname>Wilkinson</surname><given-names>JC</given-names></name>, <name><surname>Wright</surname><given-names>CW</given-names></name>, <name><surname>Wilkinson</surname><given-names>AS</given-names></name>, <name><surname>Cooney</surname><given-names>KA</given-names></name>, <etal>et al</etal><article-title>EZH2 regulates the transcription of estrogen-responsive genes through association with REA, an estrogen receptor corepressor</article-title>. <source>Breast Cancer Res Treat</source>. <year>2008</year>;<volume>107</volume>(<issue>2</issue>):<fpage>235</fpage>–<lpage>42</lpage>. Epub 2007/04/25. <pub-id pub-id-type="doi">10.1007/s10549-007-9542-7</pub-id> .<?supplied-pmid 17453341?><pub-id pub-id-type="pmid">17453341</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Mourad</surname><given-names>R</given-names></name>, <name><surname>Cuvier</surname><given-names>O</given-names></name>. <article-title>Computational Identification of Genomic Features That Influence 3D Chromatin Domain Formation</article-title>. <source>PLoS Comput Biol</source>. <year>2016</year>;<volume>12</volume>(<issue>5</issue>):<fpage>e1004908</fpage> Epub 2016/05/21. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004908</pub-id>
<?supplied-pmid 27203237?><pub-id pub-id-type="pmid">27203237</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Hou</surname><given-names>C</given-names></name>, <name><surname>Dale</surname><given-names>R</given-names></name>, <name><surname>Dean</surname><given-names>A</given-names></name>. <article-title>Cell type specificity of chromatin organization mediated by CTCF and cohesin</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2010</year>;<volume>107</volume>(<issue>8</issue>):<fpage>3651</fpage>–<lpage>6</lpage>. Epub 2010/02/06. <pub-id pub-id-type="doi">10.1073/pnas.0912087107</pub-id><?supplied-pmid 20133600?><pub-id pub-id-type="pmid">20133600</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Tang</surname><given-names>Z</given-names></name>, <name><surname>Luo</surname><given-names>OJ</given-names></name>, <name><surname>Li</surname><given-names>X</given-names></name>, <name><surname>Zheng</surname><given-names>M</given-names></name>, <name><surname>Zhu</surname><given-names>JJ</given-names></name>, <name><surname>Szalaj</surname><given-names>P</given-names></name>, <etal>et al</etal><article-title>CTCF-Mediated Human 3D Genome Architecture Reveals Chromatin Topology for Transcription</article-title>. <source>Cell</source>. <year>2015</year>;<volume>163</volume>(<issue>7</issue>):<fpage>1611</fpage>–<lpage>27</lpage>. Epub 2015/12/22. <pub-id pub-id-type="doi">10.1016/j.cell.2015.11.024</pub-id><?supplied-pmid 26686651?><pub-id pub-id-type="pmid">26686651</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Mahner</surname><given-names>S</given-names></name>, <name><surname>Baasch</surname><given-names>C</given-names></name>, <name><surname>Schwarz</surname><given-names>J</given-names></name>, <name><surname>Hein</surname><given-names>S</given-names></name>, <name><surname>Wolber</surname><given-names>L</given-names></name>, <name><surname>Janicke</surname><given-names>F</given-names></name>, <etal>et al</etal><article-title>C-Fos expression is a molecular predictor of progression and survival in epithelial ovarian carcinoma</article-title>. <source>Br J Cancer</source>. <year>2008</year>;<volume>99</volume>(<issue>8</issue>):<fpage>1269</fpage>–<lpage>75</lpage>. Epub 2008/10/16. <pub-id pub-id-type="doi">10.1038/sj.bjc.6604650</pub-id><?supplied-pmid 18854825?><pub-id pub-id-type="pmid">18854825</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Schoenfelder</surname><given-names>S</given-names></name>, <name><surname>Fraser</surname><given-names>P</given-names></name>. <article-title>Long-range enhancer-promoter contacts in gene expression control</article-title>. <source>Nat Rev Genet</source>. <year>2019</year>;<volume>20</volume>(<issue>8</issue>):<fpage>437</fpage>–<lpage>55</lpage>. Epub 2019/05/16. <pub-id pub-id-type="doi">10.1038/s41576-019-0128-0</pub-id> .<?supplied-pmid 31086298?><pub-id pub-id-type="pmid">31086298</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007800.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Khan</surname><given-names>N</given-names></name>, <name><surname>Schoenike</surname><given-names>B</given-names></name>, <name><surname>Basu</surname><given-names>T</given-names></name>, <name><surname>Grabenstatter</surname><given-names>H</given-names></name>, <name><surname>Rodriguez</surname><given-names>G</given-names></name>, <name><surname>Sindic</surname><given-names>C</given-names></name>, <etal>et al</etal><article-title>A systems approach identifies Enhancer of Zeste Homolog 2 (EZH2) as a protective factor in epilepsy</article-title>. <source>PLoS One</source>. <year>2019</year>;<volume>14</volume>(<issue>12</issue>):<fpage>e0226733</fpage> Epub 2020/01/01. <pub-id pub-id-type="doi">10.1371/journal.pone.0226733</pub-id>
<?supplied-pmid 31891591?><pub-id pub-id-type="pmid">31891591</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="pcbi.1007800.r001" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007800.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lengauer</surname>
          <given-names>Thomas</given-names>
        </name>
        <role>Methods Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ioshikhes</surname>
          <given-names>Ilya</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Lengauer, Ioshikhes</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Lengauer, Ioshikhes</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj001" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007800" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">1 Aug 2019</named-content>
    </p>
    <p>Dear Dr Roopra,</p>
    <p>Thank you very much for submitting your manuscript 'MAGICTRICKS: A tool for predicting transcription factors and cofactors binding sites in gene sets using ENCODE data' for review by PLOS Computational Biology. Your manuscript has been fully evaluated by the PLOS Computational Biology editorial team and in this case also by independent peer reviewers. The reviewers appreciated the attention to an important problem, but raised some substantial concerns about the manuscript as it currently stands. While your manuscript cannot be accepted in its present form, we are willing to consider a revised version in which the issues raised by the reviewers have been adequately addressed. We cannot, of course, promise publication at that time.</p>
    <p>Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>Your revisions should address the specific points made by each reviewer. Please return the revised version within the next 60 days. If you anticipate any delay in its return, we ask that you let us know the expected resubmission date by email at <email>ploscompbiol@plos.org</email>. Revised manuscripts received beyond 60 days may require evaluation and peer review similar to that applied to newly submitted manuscripts.</p>
    <p>In addition, when you are ready to resubmit, please be prepared to provide the following:</p>
    <p>(1) A detailed list of your responses to the review comments and the changes you have made in the manuscript. We require a file of this nature before your manuscript is passed back to the editors.</p>
    <p>(2) A copy of your manuscript with the changes highlighted (encouraged). We encourage authors, if possible to show clearly where changes have been made to their manuscript e.g. by highlighting text.</p>
    <p>(3) A striking still image to accompany your article (optional). If the image is judged to be suitable by the editors, it may be featured on our website and might be chosen as the issue image for that month. These square, high-quality images should be accompanied by a short caption. Please note as well that there should be no copyright restrictions on the use of the image, so that it can be published under the Open-Access license and be subject only to appropriate attribution.</p>
    <p>Before you resubmit your manuscript, please consult our Submission Checklist to ensure your manuscript is formatted correctly for PLOS Computational Biology: <ext-link ext-link-type="uri" xlink:href="http://www.ploscompbiol.org/static/checklist.action">http://www.ploscompbiol.org/static/checklist.action</ext-link>. Some key points to remember are:</p>
    <p>- Figures uploaded separately as TIFF or EPS files (if you wish, your figures may remain in your main manuscript file in addition).</p>
    <p>- Supporting Information uploaded as separate files, titled Dataset, Figure, Table, Text, Protocol, Audio, or Video.</p>
    <p>- Funding information in the 'Financial Disclosure' box in the online system.</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com">https://pacev2.apexcovantage.com</ext-link> PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>.</p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/submission-guidelines#loc-materials-and-methods">here</ext-link>. </p>
    <p>We are sorry that we cannot be more positive about your manuscript at this stage, but if you have any concerns or questions, please do not hesitate to contact us.</p>
    <p>Sincerely,</p>
    <p>Ilya Ioshikhes</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Thomas Lengauer</p>
    <p>Methods Editor</p>
    <p>PLOS Computational Biology</p>
    <p>A link appears below if there are any accompanying review attachments. If you believe any reviews to be missing, please contact <email>ploscompbiol@plos.org</email> immediately:</p>
    <p>[LINK]</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: Minor:</p>
    <p>1) Instead of ‘level’ use another term like ‘quantity’</p>
    <p>2) I think part of your discussion about tissues heterogeneity should be put in the introduction.</p>
    <p>Major (for me I think it is a Major revision but I will register this review only as minor revision because the validation of your algorithm can be done independently and later by other researchers)</p>
    <p>1) Need validation of your algorithm: To be sure that your algorithm is interesting for life science research the validation of the prediction of the algorithm need to be done using 'wet lab' experiments. 'Cherry picking' online references is okay for 'discussion' but it not a validation of your algorithm.</p>
    <p>Introduction</p>
    <p>"We posit that in many cases, the majority of those changes are driven by alterations in the function of a few Factors that coordinate programmatic gene changes on a genome wide scale."</p>
    <p>-&gt; By opposition to clonal cell line, cancerous tissue is a mix of hundred different cell types. I think the observed change in gene transcript quantity is principally related to the change in cell quantity inside the sample. Please discuss this aspect of cell diversity in tissues analyzed and how this affects the observed changes in gene level quantity. e.g. : A disease tissues should have a drastic increase in the quantity of immune cells, Cancer tissues can show a significant change in the quantity of blood vessels...</p>
    <p>Methods</p>
    <p>-&gt; Explain RNA extraction protocol. Trizol is an old technique, why not using Qiagen RNeasy columns?</p>
    <p>"Probes were then collapsed to a single gene value ..."</p>
    <p>-&gt; 1 Gene with 1 value assigned to it is not what happen in reality. You need to talk about the problem of alternate splicing and multiple transcripts expressed per gene. Can the Transcription Factors have an influence on the complexity of RNA expression inside a single gene? Does the probes have been designed to target multiple transcripts per gene?</p>
    <p>"any genes changed more than 3 Standard Deviations from the mean fold change..."</p>
    <p>-&gt; please explain more your methods to compute fold change of each gene. Which standard deviation are you using, is it the Standard Deviation between Probes from the same gene or between factors?</p>
    <p>"Sams et al profiling..."</p>
    <p>-&gt; What is the meaning of ‘Sams et al profiling’ ?.</p>
    <p>-&gt; Explain RNAseq protocol</p>
    <p>"were assigned a gene domain that was defined as 5Kb either side of the gene body.."</p>
    <p>-&gt; Explain why you choose 5Kb, why not 1KB? reference needed. Else can you add an option to your algorithm to scan for gene domain with a shorter or larger window and then report the most significant with some sort of ‘weight’ based on distance? (e.g.: More it is close of the RNA start and more it is significant)</p>
    <p>" = -log (corr) × "</p>
    <p>-&gt; Can you please explain the scientific validity of this type of scoring (multiplication of transformed significance by ratio)? Do you assume that the log of significance (corrected pvalue) and the ratio of means will follow a similar distribution?, if not I think this scoring can induce a bias in the detection of more significance (lowest pValue) or to the opposite to the detection of bigger ratio, all this will dependent of the shape of the corresponding distribution of ‘Pcorr’ and ‘r’. Will it be possible to adapt your algorithm and add an option to rank the genes by ‘r’ using a fixed corr (e.g.: p&lt; 0.01? or even p&lt; 0.1?)</p>
    <p>Results</p>
    <p>-&gt; Please define "FDR", is it the False Detecting Rate? how do you compute it? is it the same as corr? If it is False Detecting Rate can you use ‘%’, (e.g. FDR 5% instead of FDR 0.05)</p>
    <p>-&gt; ‘biologically meaningful’ can not be done by ‘cherry-picking’ online references or pathways because you will report only the reference that are validating your results and not the ones that go against. Your predicted results need to be validated by ‘wet lab’ experiments, what type of ‘wet lab’ experiments did you do to validate your informatics results?</p>
    <p>Discussion</p>
    <p>-&gt; How does your algorithm react when more than 1 gene share the 5Kb window? Do you have some way to reduce the significance in function of the number of genes that share this TF (e.g.: if using a 5Kb windows you found 4 genes that share the same TF, only 1 gene is of interest I think the significance of this TF should be reduced because you don’t know which gene this TF is affecting)</p>
    <p>-&gt; I think you should put the discussion about tissues heterogeneity in the Introduction. Putting in the discussion make believe the reader that it is a limitation of your algorithm but it is in fact a limitation of the experiment and not of your algorithm. Every type of algorithm will be impaired if a list of gene from tissue with cell heterogeneity is used. The problem comes from the list used not from your algorithm. Gene expression from tissues with cell heterogeneity can be corrected by in-silico gene expression deconvolution prior to feeding to your algorithm (c.f. Dachet 2015, after analysis of correlation profile of gene expression they can be separated multiple list of genes could be fed to your algorithm, each list of genes represent 1 cell type).</p>
    <p>Reviewer #2: The manuscript by Avtar Roopra presents a useful tool MAGICTRICKS which identifies enriched transcription factors (TFs) whose signals are enriched in genes (5'UTR-5kb to 3'UTR+5kb) in a query gene list (e.g. differentially expressed genes) compared to a master gene list (e.g., expressed genes). The tool identifies these enriched TFs using a 1-tailed Kolmogorov-Smirnov (KS) test of the max ChIP signals (from ENCODE) within genes (as detailed above) of the query gene list compared to the master gene list. A score is calculated using -log of the Benjamini-Hochberg corrected KS p-value x mean of the top 5th percentile query list ChIP values over mean of top (same number as query list) master list ChIP values. The resulting tool performs well against two other TF enrichment tools Enrichr and oPOSSUM-3 based on analysis of three datasets where TFs are knocked out or missing. However, there are a number of recently developed TF enrichment tools including BART, TFEA.ChIP, VIPER, DoRothEA v2 and ChEA3. In fact, in the recent ChEA3 manuscript (<ext-link ext-link-type="uri" xlink:href="https://academic.oup.com/nar/article/47/W1/W212/5494769">https://academic.oup.com/nar/article/47/W1/W212/5494769</ext-link>), the authors compare ChEA3 to these TF enrichment tools and MAGICTRICKS (which they call MAGICACT and reference the bioRxiv version of this submitted manuscript). They claim superior performance against all the TF enrichment tools including MAGICTRICKS. Given that the standard in the field is show some kind of advantage against existing top tools and to demonstrate this advantage by not just listing top genes (as is done in this manuscript) but compute performance metrics including precision, recall, AUC, etc (as is done in the ChEA3 manuscript), the following are the major and minor comments/suggested changes.</p>
    <p>Major comments:</p>
    <p>1. The author(s) should compare MAGICTRICKS to BART, TFEA.ChIP, VIPER, DoRothEA v2 and ChEA3 using performance metrics including precision, recall, AUC, etc and demonstrate some advantage. The perturbed TF datasets used in the ChEA3 manuscript allowed these calculations. These should be presented as main figures in the manuscript.</p>
    <p>2. ChIP signals for each gene are defined by taking the max within the gene locus. Max is notoriously un-robust. A robust max (95th percentile of the ChIP signal within the gene locus) should also be implemented and available to users.</p>
    <p>Minor comments:</p>
    <p>1. This reviewer would not use a z-score cutoff of 1.65 for tools like oPossum. Something more like a z-score cutoff of 2 or higher should be used when comparing oPossum and MAGICTRICKS.</p>
    <p>2. "Kolmogorov" is misspelled on p. 3 of the manuscript.</p>
    <p>3. In Fig. 2 legend, "REST" should be replaced by "GATA3, ESR1 and FOXA1".</p>
    <p>4. Under Fig. 2, a sentence mistakenly has "...yielded TFs with oPossum at z &lt; 1.65..." which should be "...yielded TFs with oPossum at z &gt; 1.65...".</p>
    <p>5. Fig. 3A has "Down in" twice in the text highlighting the CTCF-KO down-regulated gene cluster in the heat map. In Fig. 3 legend, B) should be a "summary output for down-regulated genes" not "up-regulated" as written.</p>
    <p>Reviewer #3: This manuscript describes MAGICTRICKS, a software tool for predicting factors responsible for the co-regulation of sets of genes. The tool relies on binding profiles from ChIP-seq experiments but, unlike other methods based on experimental data, it does not classify genes as targets and non-targets. Instead, each gene-factor pair is assigned a normalized ChIP-value and the program compares the distribution of values in the list of co-regulated genes and across all genes in the internal database. This is a major innovation that avoids the arbitrary classification of genes into two mutually exclusive categories.</p>
    <p>Major comments:</p>
    <p>1. As indicated by the author, a major limitation of the tool is that the current input matrix only considers peaks within 5Kb of the gene body. Firstly, aparently this distance was chosen arbitrarily. Second, and more important, many transcriptional regulators preferentially bind distant enhancers and thus most of theirs targets won’t be represented in the matrix. A potential solution to assign distant peaks to specific genes, is using the experimental evidences recorded in databases such as GeneHancer.</p>
    <p>2. A second limitation is the relatively small set of Factors and Regulators included in MAGICTRICKS. The author could consider using ReMap instead of just data from the ENCODE project.</p>
    <p>3. The selection of the highest ChIPseq value from a given factor across cell lines supposedly maximizes the likelihood that the site is universal, i.e. present in other cell types not represented in the original datasets. This hypothesis should be supported by references or data. In addition, this approach will blur tissue-specific or treatment-specific responses. Would not it be better to keep each experiment as an independent column in the internal matrix?</p>
    <p>4. The examples used to illustrate the performance of MAGICTRICKS, although convincing, are just individual cases and thus do not provide compelling evidence for the general performance of the method. The use of complete collections of well-defined transcriptional signatures or gene sets, such as those in the GSEA MSigDB, will probably be more appropriate.</p>
    <p>5. The Score for each transcription factor integrates the statistical significance of the KS test and a parameter (r) that tries to represents the size effect. Although we agree it is important to include both factors, the value of r is based on few extreme data points and, as such, it is not a indicators of the overall difference between master and query lists CDFs. We suggest the use of another parameters to represent the size effect (difference between both distributions) such as Ds-Di or the difference between the c value required to reach 0.5 of the CDF.</p>
    <p>6. The tool is implemented for two specific operating systems. A cross-platform tool would be more widely accepted.</p>
    <p>Minor comments:</p>
    <p>1. The programming language used for the implementation is not stated.</p>
    <p>2. Supplementary file 9 is not referenced in the manuscript.</p>
    <p>3. There is a typo in the paragraph before the last in the Results section. It should say “supplemental file 12-Enrich tab” instead of “supplemental file 1-Enrich tab”</p>
    <p>4. In the analysis of the CTCF knock-out experiment the conversion of mouse to human IDs is not explained.</p>
    <p>5. The captions for figures 3B and 3C contradict the main text.</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Computational Biology</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: Yes: Fabien DACHET</p>
    <p>Reviewer #2: Yes: Stefan Bekiranov</p>
    <p>Reviewer #3: Yes: Luis del Peso</p>
  </body>
</sub-article>
<sub-article id="pcbi.1007800.r002" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007800.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article id="rel-obj002" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007800" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">28 Jan 2020</named-content>
    </p>
    <supplementary-material content-type="local-data" id="pcbi.1007800.s014">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Response_to_Reviewers.docx</named-content></p>
      </caption>
      <media xlink:href="pcbi.1007800.s014.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pcbi.1007800.r003" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007800.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lengauer</surname>
          <given-names>Thomas</given-names>
        </name>
        <role>Methods Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ioshikhes</surname>
          <given-names>Ilya</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Lengauer, Ioshikhes</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Lengauer, Ioshikhes</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj003" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007800" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">25 Feb 2020</named-content>
    </p>
    <p>Dear Dr. Roopra,</p>
    <p>Thank you very much for submitting your manuscript "MAGIC: A tool for predicting transcription factors and cofactors driving gene sets using ENCODE data." for consideration at PLOS Computational Biology. As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. The reviewers appreciated the attention to an important topic. Based on the reviews, we are likely to accept this manuscript for publication, providing that you modify the manuscript according to the review recommendations.</p>
    <p>Please prepare and submit your revised manuscript within 30 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. </p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to all review comments, and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Thank you again for your submission to our journal. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Ilya Ioshikhes</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Thomas Lengauer</p>
    <p>Methods Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>A link appears below if there are any accompanying review attachments. If you believe any reviews to be missing, please contact <email>ploscompbiol@plos.org</email> immediately:</p>
    <p>[LINK]</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: The revised manuscript has been greatly improved, it is now clearer and addressed all my concerns. The new corrected algorithm accepts more parametrisations and I expect the authors will continue its development. I hope the authors will release updates that will allow to switch the TFs&amp;factors analysis from genes to transcripts and splicing pattern identification using an adequate background file.</p>
    <p>Reviewer #2: Dr. Roopra has addressed all my comments/suggestions in this revised manuscript.</p>
    <p>There are just a few remaining minor issues that need to be addressed:</p>
    <p>1. In addition to being made available from a University of Wisconsin website, MAGIC should be made available on GitHub, which serves as a more permanent site.</p>
    <p>2. In the Methods section under the Precision Recall... subsection, "FET" should be defined as "Fisher's Exact Test" and there should be a period after "...each test (Calls Vectors)".</p>
    <p>3. In the Methods section under the Rank Analysis subsection, D(r) is more clearly defined in the Results section as cumulative of fractional ranks for the manipulated Factor and PIs. I would use this definition in the methods section as well.</p>
    <p>4. In the Methods section under the Rank Analysis subsection, the sentence "Blocks of positive calls in the Calls Vector were all assigned the rank of the first element of the block." is unclear. How are "blocks" defined? I was under the impression that every positive call was ranked.</p>
    <p>5. In the Methods section under MCF7 RNA..., the last sentence is missing a period after "...(S1 Table)".</p>
    <p>6. In the Methods section under Implementation of MAGIC in the second paragraph, "...each query list and generate a series..." should be "...each query list and generates a series...".</p>
    <p>7. In the Results section in the Identification of Cofactors...subsection, "...either high or low ranks would produce a uniform distribution (which equates to r)" should be "...either high or low ranks would produce a uniform p-value distribution (which equates to r)" for clarity (unless something else was meant). it's known that a null model or random data with no enrichment will produce a uniform p-value distribution.</p>
    <p>8. In the Discussion section, "...depending on the set of genes in it and so the maximal..." should be "...depending on the set of genes in it, and so the maximal...".</p>
    <p>Best,</p>
    <p>Stefan Bekiranov</p>
    <p>Reviewer #3: The author have addressed most of our concerns and the current version of the method is clearly improved as compared to the original one. However, some concerns regarding the manuscript still remain, as detailed below.</p>
    <p>Major comments:</p>
    <p>1. The number of cases used to illustrate the performance of MAGIC have been slightly increased but, given the limited number of datasets and the arbitrary criteria for their selection, they still do not provide compelling evidence for the general performance of the method. At least the author should clearly acknowledge this important limitation when drawing conclusions. Particularly, when comparing MAGICTRICKS with the rest of tools included in the manuscript as reference.</p>
    <p>2. The criteria to select genes of interest should be the same across the experiments used for validation. Even if the experiments weren't homogeneously process from reads to diferential expression. The author should provide a robust reason to not follow the same criteria when selecting genes for testing. Additionally, the author stated "Genes up-regulated more than 3 Standard Deviations from the mean fold change....". Since Fold Change doesn't follow a simmetric distribution, this apporach only serves to select up-regulated genes. Did the author meant the log-fold change?</p>
    <p>3. The manuscript indicates that the tool is implemented for two specific operating systems, yet the address <ext-link ext-link-type="uri" xlink:href="https://go.wisc.edu/MAGIC">https://go.wisc.edu/MAGIC</ext-link>. only contains stand-alone for MacOS. More importantly, since the tool is written in python, the author could provide the source code so it can be used in any platform.</p>
    <p>4. page 19 states that "plasticity[18]. 432 genes were down-regulated upon CTCF loss out of 17,015 expressed genes (S3 Table).". However, according to the results reported on GEO, there are 321 genes with log2(FC)&lt;0 and adjusted p-value &lt;0.05. If the author has analized the RNA-seq following a different pipeline that the one reported on GEO, it should be stated.</p>
    <p>5. On page 23 the author states "Nevertheless, it provided an extremely powerful prediction of EZH2 induction which was missed by CHEA3 and TFEA but was confirmed</p>
    <p>by Enrichr.". However, we analyzed the dataset provided as supplementary information in reference 43 (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0226733#sec033">https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0226733#sec033</ext-link>) and found that TFEA identifies EZH2 (along with SUZ12 and JARID2) as the top candidate for this dataset. Moreover, five of the top ten datasets represent EZH2 ChIPseqs. In the case of ChEA3 (literature library), the top candidate is MTF2 (also known as Polycomb-Like 2) that mediates binding of PRC2 to DNA. The author should correct their conclusion regarding the performance of TFEA and ChEA3 or provide a compelling argument to explain the indicated discrepancies.</p>
    <p>Minor comments:</p>
    <p>1. It's possible to ask ReMap's authors for the MACS2 outputs of their ChIP collection. The current ENCODE dump has a wide range of TF covered, but you might want to consider ReMap for a future update.</p>
    <p>2. Methods. Page 15. "An emperical distribution function...", should say "empirical".</p>
    <p>3. Figure legends page 24, spelling of "reciprical"</p>
    <p>3. Last line pag 16 says "ChIP value at dsup", for consistency "dsup" should by capitalized as "Dsup"</p>
    <p>4. figure 1, please indicate the meaning of "ND".</p>
    <p>5. Quality of figures 2 and 3 is poor.</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Computational Biology</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: None</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: Yes: Fabien DACHET</p>
    <p>Reviewer #2: Yes: Stefan Bekiranov</p>
    <p>Reviewer #3: No</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/" xlink:type="simple">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email xlink:type="simple">figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link ext-link-type="uri" xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, PLOS recommends that you deposit laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see <underline><ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plospathogens/s/submission-guidelines" xlink:type="simple">http://journals.plos.org/ploscompbiol/s/submission-guidelines#loc-materials-and-methods</ext-link></underline></p>
  </body>
</sub-article>
<sub-article id="pcbi.1007800.r004" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007800.r004</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 1</article-title>
    </title-group>
    <related-article id="rel-obj004" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007800" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">2 Mar 2020</named-content>
    </p>
    <supplementary-material content-type="local-data" id="pcbi.1007800.s015">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Response_to_Reviewers_II.docx</named-content></p>
      </caption>
      <media xlink:href="pcbi.1007800.s015.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pcbi.1007800.r005" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007800.r005</article-id>
    <title-group>
      <article-title>Decision Letter 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lengauer</surname>
          <given-names>Thomas</given-names>
        </name>
        <role>Methods Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ioshikhes</surname>
          <given-names>Ilya</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Lengauer, Ioshikhes</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Lengauer, Ioshikhes</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj005" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007800" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">19 Mar 2020</named-content>
    </p>
    <p>Dear Dr. Roopra,</p>
    <p>We are pleased to inform you that your manuscript 'MAGIC: A tool for predicting transcription factors and cofactors driving gene sets using ENCODE data.' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please add on that occasion a link in the manuscript to the GitHub page where the Python script and information on how to access the other relevant files are deposited, as per the Reviewer 2 request.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Ilya Ioshikhes</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Thomas Lengauer</p>
    <p>Methods Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #2: Dr. Roopra has addressed all my remaining minor comments/suggestions.</p>
    <p>The only thing that remains is adding a link in the manuscript to the GitHub page where the Python script and information on how to access the other relevant files are deposited.</p>
    <p>Best,</p>
    <p>Stefan Bekiranov</p>
    <p>Reviewer #3: The author have has addressed all our comments/suggestions in the R2 version of the manuscript.</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Computational Biology</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #2: Yes: Stefan Bekiranov</p>
    <p>Reviewer #3: No</p>
  </body>
</sub-article>
<sub-article id="pcbi.1007800.r006" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007800.r006</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lengauer</surname>
          <given-names>Thomas</given-names>
        </name>
        <role>Methods Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ioshikhes</surname>
          <given-names>Ilya</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Lengauer, Ioshikhes</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Lengauer, Ioshikhes</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj006" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007800" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">30 Mar 2020</named-content>
    </p>
    <p>PCOMPBIOL-D-19-00993R2 </p>
    <p>MAGIC: A tool for predicting transcription factors and cofactors driving gene sets using ENCODE data.</p>
    <p>Dear Dr Roopra,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Laura Mallard</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link ext-link-type="uri" xlink:href="http://ploscompbiol.org">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
