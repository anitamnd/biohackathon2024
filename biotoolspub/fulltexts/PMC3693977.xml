<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Algorithms Mol Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Algorithms Mol Biol</journal-id>
    <journal-title-group>
      <journal-title>Algorithms for Molecular Biology : AMB</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1748-7188</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3693977</article-id>
    <article-id pub-id-type="publisher-id">1748-7188-8-7</article-id>
    <article-id pub-id-type="pmid">23497437</article-id>
    <article-id pub-id-type="doi">10.1186/1748-7188-8-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Ultrametric networks: a new tool for phylogenetic analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="A1">
        <name>
          <surname>Apostolico</surname>
          <given-names>Alberto</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>axa@cc.gatech.edu</email>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="A2">
        <name>
          <surname>Comin</surname>
          <given-names>Matteo</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>comin@dei.unipd.it</email>
      </contrib>
      <contrib contrib-type="author" id="A3">
        <name>
          <surname>Dress</surname>
          <given-names>Andres</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>andreas@picb.ac.cn</email>
      </contrib>
      <contrib contrib-type="author" id="A4">
        <name>
          <surname>Parida</surname>
          <given-names>Laxmi</given-names>
        </name>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>parida@us.ibm.com</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>College of Computing, Georgia Institute of Technology, 801 Atlantic Drive, Atlanta, GA 30332, USA</aff>
    <aff id="I2"><label>2</label>Department of Information Engineering, University of Padova, Via Gradenigo 6/A, 35131 Padova, Italy</aff>
    <aff id="I3"><label>3</label>CAS‐MPG Partner Institute and Key Lab for Computational Biology, Shanghai Institutes for Biological Sciences, Chinese Academy of Sciences, and infinity, Bielefeld, Germany</aff>
    <aff id="I4"><label>4</label>IBM T. J. Watson Research Center, Yorktown Heights, NY 10598, USA</aff>
    <pub-date pub-type="collection">
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>3</month>
      <year>2013</year>
    </pub-date>
    <volume>8</volume>
    <fpage>7</fpage>
    <lpage>7</lpage>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>10</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>2</month>
        <year>2013</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2013 Apostolico et al.; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2013</copyright-year>
      <copyright-holder>Apostolico et al.; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.almob.org/content/8/1/7"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>The large majority of optimization problems related to the inference of distance‐based trees used in phylogenetic analysis and classification is known to be intractable. One noted exception is found within the realm of ultrametric distances. The introduction of ultrametric trees in phylogeny was inspired by a model of evolution driven by the postulate of a molecular clock, now dismissed, whereby phylogeny could be represented by a weighted tree in which the sum of the weights of the edges separating any given leaf from the root is the same for all leaves. Both, molecular clocks and rooted ultrametric trees, fell out of fashion as credible representations of evolutionary change. At the same time, ultrametric dendrograms have shown good potential for purposes of classification in so far as they have proven to provide good approximations for additive trees. Most of these approximations are still intractable, but the problem of finding the nearest ultrametric distance matrix to a given distance matrix with respect to the <italic>L</italic><sub><italic>∞</italic></sub> distance has been long known to be solvable in polynomial time, the solution being incarnated in any minimum spanning tree for the weighted graph subtending to the matrix.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>This paper expands this <italic>subdominant ultrametric</italic> perspective by studying ultrametric <italic>networks</italic>, consisting of the collection of <italic>all</italic> edges involved in some minimum spanning tree. It is shown that, for a graph with <italic>n</italic> vertices, the construction of such a network can be carried out by a simple algorithm in optimal time <italic>O</italic>(<italic>n</italic><sup>2</sup>) which is faster by a factor of <italic>n</italic> than the direct adaptation of the classical <italic>O</italic>(<italic>n</italic><sup>3</sup>) paradigm by Warshall for computing the transitive closure of a graph. This algorithm, called UltraNet, will be shown to be easily adapted to compute relaxed networks and to support the introduction of artificial points to reduce the maximum distance between vertices in a pair. Finally, a few experiments will be discussed to demonstrate the applicability of subdominant ultrametric networks.</p>
      </sec>
      <sec>
        <title>Availability</title>
        <p>
          <ext-link ext-link-type="uri" xlink:href="http://www.dei.unipd.it/~ciompin/main/Ultranet/Ultranet.html">http://www.dei.unipd.it/~ciompin/main/Ultranet/Ultranet.html</ext-link>
        </p>
      </sec>
    </abstract>
    <kwd-group>
      <kwd>Phylogenetic network</kwd>
      <kwd>Ultrametric distance</kwd>
      <kwd>STR data analysis</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>As is well known, most optimization problems related to the inference of distance‐based trees used in phylogenetic analysis and classification are intractable (see [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>] for a pertinent discussion). One notable exception is found within the realm of ultrametric distances (cf. [<xref ref-type="bibr" rid="B3">3</xref>]). The introduction of such distances in phylogeny was inspired by a model of evolution, now largely abandoned, driven by the postulate of a molecular clock whereby the amount of phylogenetic change observable between any two extant species is directly related to the amount of time that elapsed since their last common ancestor roamed this planet, implying that phylogenetic distances could simply be represented by a weighted tree in which the sum of the weights of the edges separating any given leaf from the root is the same for all leaves.</p>
    <p>Both molecular clocks and rooted ultrametric trees fell out of fashion as credible representations of evolutionary change. At the same time, a rooted dated tree is still the “object of desire” in taxonomy and Tree‐of‐Life research, and ultrametric dendrograms have shown good potential for purposes of classification in so far as they have proven to provide good approximations for additive trees. While finding the “best” such approximation is, in most cases, still intractable, the problem of finding an ultrametric distance matrix that is closest to a given distance matrix with respect to the <italic>L</italic><sub><italic>∞</italic></sub> distance has long been known to be solvable in polynomial time, its solution being incarnated in any minimum spanning tree for the weighted graph subtending to the matrix.</p>
    <p>Applications of minimum spanning trees in connection with problems of population classification and genetics are as old as any other of their numerous applications. An application to taxonomic problems related to species interrelationship dates back to [<xref ref-type="bibr" rid="B4">4</xref>]. And as early as 1964, Edwards and Cavalli Sforza [<xref ref-type="bibr" rid="B5">5</xref>] used MSTs to approximate evolutionary trees reconstructed from gene frequencies in blood groups from fifteen contemporary human populations.</p>
    <p>Most approximation problems arising in this context fall within the framework of the following</p>
    <p><bold>Closest Metric Problem:</bold><italic>Given a set</italic><inline-formula><mml:math id="M1" name="1748-7188-8-7-i1" overflow="scroll"><mml:mi mathvariant="script">M</mml:mi></mml:math></inline-formula><italic>of metrics C defined on a set V, an</italic> |<italic>V</italic>|×|<italic>V</italic>|−<italic>m</italic><italic>a</italic><italic>t</italic><italic>r</italic><italic>i</italic><italic>x</italic><italic>M</italic>, <italic>and a distance function</italic><inline-formula><mml:math id="M2" name="1748-7188-8-7-i2" overflow="scroll"><mml:mi>D</mml:mi><mml:mo>:</mml:mo><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mo>″</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>→</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula><italic>defined on the set</italic><inline-formula><mml:math id="M3" name="1748-7188-8-7-i3" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>V</mml:mi><mml:mo>|</mml:mo><mml:mo>×</mml:mo><mml:mo>|</mml:mo><mml:mi>V</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula><italic>of all</italic> |<italic>V</italic>|×|<italic>V</italic>|−<italic>m</italic><italic>a</italic><italic>t</italic><italic>r</italic><italic>i</italic><italic>c</italic><italic>e</italic><italic>s</italic>, <italic>find a metric</italic><inline-formula><mml:math id="M4" name="1748-7188-8-7-i4" overflow="scroll"><mml:mi>C</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">M</mml:mi></mml:math></inline-formula><italic>with minimum distance to M relative to D</italic>.</p>
    <p>The basic facts are summarized in Table <xref ref-type="table" rid="T1">1</xref>.</p>
    <table-wrap position="float" id="T1">
      <label>Table 1</label>
      <caption>
        <p>Basic facts for the closest metric problem</p>
      </caption>
      <table frame="hsides" rules="groups" border="1">
        <colgroup>
          <col align="left"/>
          <col align="center"/>
          <col align="center"/>
          <col align="center"/>
        </colgroup>
        <thead valign="top">
          <tr>
            <th align="left">
              <bold>
                <italic>C </italic>
              </bold>
              <bold>∖ </bold>
              <bold>
                <italic>D</italic>
              </bold>
              <sub>
                <bold>
                  <italic>M</italic>
                </bold>
              </sub>
            </th>
            <th align="center">
              <bold>
                <italic>L</italic>
              </bold>
              <sub>
                <bold>
                  <italic>1</italic>
                </bold>
              </sub>
            </th>
            <th align="center">
              <bold>
                <italic>L</italic>
              </bold>
              <sub>
                <bold>
                  <italic>2</italic>
                </bold>
              </sub>
            </th>
            <th align="center">
              <bold>
                <italic>L</italic>
              </bold>
              <sub>
                <bold>
                  <italic>∞</italic>
                </bold>
              </sub>
            </th>
          </tr>
        </thead>
        <tbody valign="top">
          <tr>
            <td align="left" valign="bottom">Additive<hr/></td>
            <td align="center" valign="bottom">NP‐Hard<sup>+</sup><hr/></td>
            <td align="center" valign="bottom">NP‐Hard<hr/></td>
            <td align="center" valign="bottom">NP‐Hard<sup>*</sup><hr/></td>
          </tr>
          <tr>
            <td align="left">Ultrametric</td>
            <td align="center">NP‐Hard<sup>+</sup></td>
            <td align="center">NP‐Hard</td>
            <td align="center">P<sup>§</sup></td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <p><sup>+</sup>no approximation is known;</p>
        <p><sup>*</sup>a 3‐approximation exists, due to Agarwal et al. [<xref ref-type="bibr" rid="B1">1</xref>];</p>
        <p><sup>§</sup>due to Gower and Ross [<xref ref-type="bibr" rid="B3">3</xref>] (see also ([<xref ref-type="bibr" rid="B6">6</xref>], p.158), ([<xref ref-type="bibr" rid="B7">7</xref>], p.134), [<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B8">8</xref>]).</p>
      </table-wrap-foot>
    </table-wrap>
    <p>Subdominant ultrametrics have been traditionally applied to many problems of physics and optimization theory [<xref ref-type="bibr" rid="B9">9</xref>]‐[<xref ref-type="bibr" rid="B12">12</xref>]. More recently, implications of this theory in the analysis of financial markets, stock exchange, and evolutionary biology have attracted new interest in the topic.</p>
    <p>Phylogenetic networks are increasingly featured in modeling of molecular evolution, as evidence of reticulate events such as hybridization, horizontal gene transfer and recombination becomes more prominent. Traditionally, the use of binary data and, in particular, the notion of splits gave rise to a number of alternative models. In the literature, several definitions of networks have been proposed to model parallel events. Popular examples are consensus networks [<xref ref-type="bibr" rid="B13">13</xref>], reticulate networks, recombination networks, median networks [<xref ref-type="bibr" rid="B14">14</xref>], Neighbour Nets [<xref ref-type="bibr" rid="B15">15</xref>], QNets [<xref ref-type="bibr" rid="B16">16</xref>] etc. In order to control the degree of connectivity of a network, each model optimizes an objective function; examples are Bayesian methods, maximum likelihood methods, and maximum parsimony [<xref ref-type="bibr" rid="B17">17</xref>,<xref ref-type="bibr" rid="B18">18</xref>], calculated that the number of equally parsimonious trees for a data set of just 56 haplotypes exceeded one billion. This estimate was computed through resort of the notion of Minimum Spanning Network. In a different context, they proposed a counting procedure based on the Prim’s algorithm that is analogous to the work presented in this paper.</p>
    <p>Anther popular framework is the statistical parsimony analysis [<xref ref-type="bibr" rid="B19">19</xref>]. Hart and Sunday [<xref ref-type="bibr" rid="B20">20</xref>] found empirically that subnetworks, as implemented in the TCS program [<xref ref-type="bibr" rid="B21">21</xref>], coincided significantly with taxonomy names. The TCS program calculates the maximum number of mutational steps constituting a parsimonious connection between two haplotypes with the probability of 95%. Although Hart and Sunday’s [<xref ref-type="bibr" rid="B20">20</xref>] results suggest that statistical parsimony analysis could be used in practice to differentiate species, this methodology is not mathematically well‐founded.</p>
    <p>In this paper, we extend the approach based on the construction of subdominant ultrametric trees by studying ultrametric <italic>networks</italic>, consisting of the collection of all edges involved in some minimum spanning tree. This can be viewed as a network of kinship between the extant sequences that embodies the <italic>least‐resistant paths</italic> in terms of <italic>bottlenecks</italic>, where a bottleneck is simply the worst possible transition between two intermediate states. We show that, for a graph with <italic>n</italic> vertices, the construction of such a network can be carried out by a simple algorithm in optimal time <italic>O</italic>(<italic>n</italic><sup>2</sup>), which is faster by a factor of <italic>n</italic> than the more straightforward <italic>O</italic>(<italic>n</italic><sup>3</sup>) closure performed by the classical Floyd‐Warshall paradigm. We show that our algorithm can easily be adapted to compute relaxed networks and to support the introduction of artificial points when it is desirable to reduce maximum distance between vertices. Finally, we discuss a few experiments demonstrating the applicability of this method.</p>
  </sec>
  <sec>
    <title>The ultrametric network</title>
    <p>We study the following, rather abstract, conceptual frame work: We start with a finite set <italic>V</italic> representing the sequences and an arbitrary weighting</p>
    <p>
      <disp-formula>
        <mml:math id="M5" name="1748-7188-8-7-i5" overflow="scroll">
          <mml:mrow>
            <mml:mi>W</mml:mi>
            <mml:mo>:</mml:mo>
            <mml:mfenced open="(" close=")">
              <mml:mfrac linethickness="0.0pt">
                <mml:mrow>
                  <mml:mi>V</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
              </mml:mfrac>
            </mml:mfenced>
            <mml:mo>→</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi mathvariant="double-struck">R</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>&gt;</mml:mo>
                <mml:mn>0</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:mo>:</mml:mo>
            <mml:mo>{</mml:mo>
            <mml:mi>v</mml:mi>
            <mml:mo>,</mml:mo>
            <mml:mi>u</mml:mi>
            <mml:mo>}</mml:mo>
            <mml:mo>→</mml:mo>
            <mml:mi>W</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mi>v</mml:mi>
            <mml:mo>,</mml:mo>
            <mml:mi>u</mml:mi>
            <mml:mo>)</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </p>
    <p>that associates a positive weight <italic>W</italic>(<italic>v</italic>,<italic>u</italic>) to every 2‐subset <inline-formula><mml:math id="M6" name="1748-7188-8-7-i6" overflow="scroll"><mml:mo>{</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi><mml:mo>}</mml:mo><mml:mo>∈</mml:mo><mml:mfenced open="(" close=")"><mml:mfrac linethickness="0.0pt"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mfenced></mml:math></inline-formula> of <italic>V</italic> that we imagine to be deduced, in one way or the other, from the given sequences, and to represent, for every <inline-formula><mml:math id="M7" name="1748-7188-8-7-i7" overflow="scroll"><mml:mo>{</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi><mml:mo>}</mml:mo><mml:mo>∈</mml:mo><mml:mfenced open="(" close=")"><mml:mfrac linethickness="0.0pt"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mfenced></mml:math></inline-formula>, the observed <italic>degree of dissimilarity</italic> between <italic>u</italic> and <italic>v</italic>.</p>
    <p>It is well known (cf. [<xref ref-type="bibr" rid="B3">3</xref>]) and easy to see (cf. [<xref ref-type="bibr" rid="B8">8</xref>] for a review) that there exists a unique largest <italic>ultrametric</italic> defined on <italic>V</italic> and denoted by, say, <italic>W</italic><sup>∗</sup> that is <italic>dominated</italic> by <italic>W</italic>, i.e., the (necessarily unique and symmetric) largest map from <italic>V</italic>×<italic>V</italic> into <inline-formula><mml:math id="M8" name="1748-7188-8-7-i8" overflow="scroll"><mml:mi mathvariant="double-struck">R</mml:mi></mml:math></inline-formula> for which </p>
    <p>(i) <italic>W</italic><sup>∗</sup>(<italic>v</italic>,<italic>v</italic>)=0 and <italic>W</italic><sup>∗</sup>(<italic>v</italic>,<italic>u</italic>)≤ max(<italic>W</italic><sup>∗</sup>(<italic>v</italic>,<italic>w</italic>),<italic>W</italic><sup>∗</sup>(<italic>u</italic>,<italic>w</italic>)) holds for all <italic>u</italic>,<italic>v</italic>,<italic>w</italic> in <italic>V</italic>, and</p>
    <p>(ii) <italic>W</italic><sup>∗</sup>(<italic>v</italic>,<italic>u</italic>)≤<italic>W</italic>(<italic>v</italic>,<italic>u</italic>) for all <italic>u</italic>,<italic>v</italic>∈<italic>V</italic>.</p>
    <p>Actually, as the supremum</p>
    <p>
      <disp-formula>
        <mml:math id="M9" name="1748-7188-8-7-i9" overflow="scroll">
          <mml:mrow>
            <mml:mo>sup</mml:mo>
            <mml:mi mathvariant="script">D</mml:mi>
            <mml:mo>:</mml:mo>
            <mml:mi>V</mml:mi>
            <mml:mo>×</mml:mo>
            <mml:mi>V</mml:mi>
            <mml:mo>→</mml:mo>
            <mml:mi mathvariant="double-struck">R</mml:mi>
            <mml:mo>:</mml:mo>
            <mml:mo>(</mml:mo>
            <mml:mi>u</mml:mi>
            <mml:mo>,</mml:mo>
            <mml:mi>v</mml:mi>
            <mml:mo>)</mml:mo>
            <mml:mo>↦</mml:mo>
            <mml:mo>sup</mml:mo>
            <mml:mo>(</mml:mo>
            <mml:mi>D</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mi>u</mml:mi>
            <mml:mo>,</mml:mo>
            <mml:mi>v</mml:mi>
            <mml:mo>)</mml:mo>
            <mml:mo>:</mml:mo>
            <mml:mi>D</mml:mi>
            <mml:mo>∈</mml:mo>
            <mml:mi mathvariant="script">D</mml:mi>
            <mml:mo>)</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </p>
    <p>of any collection <inline-formula><mml:math id="M10" name="1748-7188-8-7-i10" overflow="scroll"><mml:mi mathvariant="script">D</mml:mi></mml:math></inline-formula> of ultrametrics defined on <italic>V</italic> that is bounded from above, is an ultrametric, too, and <italic>W</italic><sup>∗</sup> is just the supremum of the set,</p>
    <p>
      <disp-formula>
        <mml:math id="M11" name="1748-7188-8-7-i11" overflow="scroll">
          <mml:mi mathvariant="script">D</mml:mi>
          <mml:mo>(</mml:mo>
          <mml:mi>W</mml:mi>
          <mml:mo>)</mml:mo>
          <mml:mo>:</mml:mo>
          <mml:mo>=</mml:mo>
          <mml:mo>{</mml:mo>
          <mml:mi>D</mml:mi>
          <mml:mspace width="0.3em"/>
          <mml:mo>:</mml:mo>
          <mml:mspace width="0.3em"/>
          <mml:mi>D</mml:mi>
          <mml:mspace width="0.3em"/>
          <mml:mtext>is an ultrametric on</mml:mtext>
          <mml:mtext mathvariant="italic">V</mml:mtext>
          <mml:mtext>that is bounded from above by</mml:mtext>
          <mml:mtext mathvariant="italic">W</mml:mtext>
          <mml:mo>}</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
    </p>
    <p><italic>W</italic><sup>∗</sup> must indeed be an ultrametric, called the <italic>subdominant ultrametric</italic> for <italic>W</italic>.</p>
    <p>In this paper, we will study the <italic>ultrametric network</italic><italic>G</italic>(<italic>V</italic>|<italic>W</italic>) associated with <italic>W</italic>, i.e. the graph <italic>G</italic>(<italic>V</italic>|<italic>W</italic>):=(<italic>V</italic>, <italic>E</italic>(<italic>V</italic>|<italic>W</italic>)) with vertex set <italic>V</italic> and edge set <inline-formula><mml:math id="M12" name="1748-7188-8-7-i12" overflow="scroll"><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mi>V</mml:mi><mml:mo>|</mml:mo><mml:mi>W</mml:mi><mml:mo>)</mml:mo><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mfenced open="{" close="}"><mml:mrow><mml:mo>{</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>}</mml:mo><mml:mo>∈</mml:mo><mml:mfenced open="(" close=")"><mml:mfrac linethickness="0.0pt"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>:</mml:mo><mml:mi>W</mml:mi><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:math></inline-formula>.</p>
    <p>It is easy to see that <italic>E</italic>(<italic>V</italic>|<italic>W</italic>) is actually the union of the edge sets of all minimum spanning trees with vertex set <italic>V</italic> relative to <italic>W</italic>, considered as a weighting of the complete graph <italic>G</italic>(<italic>V</italic>)=(<italic>V</italic>,<italic>E</italic>(<italic>V</italic>)) with vertex set <italic>V</italic> and edge set <inline-formula><mml:math id="M13" name="1748-7188-8-7-i13" overflow="scroll"><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mi>V</mml:mi><mml:mo>)</mml:mo><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mfenced open="(" close=")"><mml:mfrac linethickness="0.0pt"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mfenced></mml:math></inline-formula>.</p>
    <p>Indeed, continuing with the notations and assumptions introduced above, <italic>W</italic><sup>∗</sup> can be constructed as follows: Put |<italic>e</italic>|:=<italic>W</italic>(<italic>u</italic>,<italic>v</italic>) for every <italic>e</italic>={<italic>u</italic>,<italic>v</italic>}∈<italic>E</italic>(<italic>V</italic>) and, given any path <italic>P</italic>=<italic>v</italic><sub>0</sub><italic>v</italic><sub>1</sub>...<italic>v</italic><sub><italic>k</italic></sub> in <italic>G</italic>(<italic>V</italic>), define the <italic>support</italic><italic>supp</italic>(<italic>P</italic>) of <italic>P</italic> by</p>
    <p>
      <disp-formula>
        <mml:math id="M14" name="1748-7188-8-7-i14" overflow="scroll">
          <mml:mrow>
            <mml:mtext mathvariant="italic">supp</mml:mtext>
            <mml:mo>(</mml:mo>
            <mml:mi>P</mml:mi>
            <mml:mo>)</mml:mo>
            <mml:mo>:</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mfenced open="{" close="}">
              <mml:mrow>
                <mml:mo>{</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>v</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>v</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>}</mml:mo>
                <mml:mo>:</mml:mo>
                <mml:mi>i</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mn>2</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mo>…</mml:mo>
                <mml:mo>,</mml:mo>
                <mml:mi>k</mml:mi>
              </mml:mrow>
            </mml:mfenced>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </p>
    <p>and the <italic>bottleneck</italic><italic>B</italic>(<italic>P</italic>)=<italic>B</italic>(<italic>P</italic>|<italic>W</italic>) of <italic>P</italic> (with respect to <italic>W</italic>) by</p>
    <p>
      <disp-formula>
        <mml:math id="M15" name="1748-7188-8-7-i15" overflow="scroll">
          <mml:mrow>
            <mml:mi>B</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mi>P</mml:mi>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mi>B</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>v</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>0</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:msub>
              <mml:mrow>
                <mml:mi>v</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:mi>...</mml:mi>
            <mml:msub>
              <mml:mrow>
                <mml:mi>v</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>k</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>)</mml:mo>
            <mml:mo>:</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:munder>
              <mml:mrow>
                <mml:mo>max</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mi>...k</mml:mi>
              </mml:mrow>
            </mml:munder>
            <mml:mo>{</mml:mo>
            <mml:mo>|</mml:mo>
            <mml:mi>e</mml:mi>
            <mml:mo>|</mml:mo>
            <mml:mo>:</mml:mo>
            <mml:mi>e</mml:mi>
            <mml:mo>∈</mml:mo>
            <mml:mtext mathvariant="italic">supp</mml:mtext>
            <mml:mo>(</mml:mo>
            <mml:mi>P</mml:mi>
            <mml:mo>)</mml:mo>
            <mml:mo>}</mml:mo>
            <mml:mi>.</mml:mi>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </p>
    <p>Then, given any two vertices <italic>u</italic>,<italic>v</italic>∈<italic>V</italic>, <italic>W</italic><sup>∗</sup>(<italic>u</italic>,<italic>v</italic>) coincides with the <italic>least‐resistance</italic> bottleneck between <italic>v</italic> and <italic>u</italic>, i.e., we have</p>
    <p>
      <disp-formula>
        <mml:math id="M16" name="1748-7188-8-7-i16" overflow="scroll">
          <mml:mrow>
            <mml:msup>
              <mml:mrow>
                <mml:mi>W</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>∗</mml:mo>
              </mml:mrow>
            </mml:msup>
            <mml:mo>(</mml:mo>
            <mml:mi>u</mml:mi>
            <mml:mo>,</mml:mo>
            <mml:mi>v</mml:mi>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:munder>
              <mml:mrow>
                <mml:mo>min</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext>all paths</mml:mtext>
                <mml:mtext mathvariant="italic">P</mml:mtext>
                <mml:mtext>in</mml:mtext>
                <mml:mspace width="1em"/>
                <mml:mi>G</mml:mi>
                <mml:mo>(</mml:mo>
                <mml:mi>V</mml:mi>
                <mml:mo>)</mml:mo>
                <mml:mtext>from</mml:mtext>
                <mml:mi>u</mml:mi>
                <mml:mtext>to</mml:mtext>
                <mml:mi>v</mml:mi>
              </mml:mrow>
            </mml:munder>
            <mml:mi>B</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mi>P</mml:mi>
            <mml:mo>)</mml:mo>
            <mml:mi>.</mml:mi>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </p>
    <p>Any path for which this minimum is attained represents a <italic>minimum‐bottleneck</italic> path (for <italic>u</italic> and <italic>v</italic>). Clearly, <italic>W</italic><sup>∗</sup>(<italic>u</italic>,<italic>v</italic>) is the lowest weight possible for the highest weight in any path leading from <italic>u</italic> to <italic>v</italic>. It can be computed by a straightforward adaptation of the Floyd‐Warshall algorithm in <italic>O</italic>(|<italic>V</italic>|<sup>3</sup>) time.</p>
    <p>Remarkably, <italic>E</italic>⊆<italic>E</italic>(<italic>V</italic>|<italic>W</italic>) holds for every subset <italic>E</italic> of <italic>E</italic>(<italic>V</italic>) for which the graph (<italic>V</italic>,<italic>E</italic>) is connected and minimizes the sum <inline-formula><mml:math id="M17" name="1748-7188-8-7-i17" overflow="scroll"><mml:mo>|</mml:mo><mml:mi>E</mml:mi><mml:mo>|</mml:mo><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>∈</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:munder><mml:mo>|</mml:mo><mml:mi>e</mml:mi><mml:mo>|</mml:mo></mml:math></inline-formula>, that is, for the edge set of any <italic>minimum spanning tree</italic><italic>T</italic>=(<italic>X</italic>,<italic>E</italic>) for <italic>W</italic>. This follows from a result generally credited to [<xref ref-type="bibr" rid="B3">3</xref>], that we formalize as follows:</p>
    <sec>
      <title>Theorem 1</title>
      <p><italic>With V and W as above, the edge set of every minimum spanning tree for W is contained in</italic><italic>E</italic>(<italic>V</italic>|<italic>W</italic>) <italic>while, conversely, there exists, for any edge</italic><italic>e</italic>∈<italic>E</italic>(<italic>V</italic>|<italic>W</italic>), <italic>a minimum spanning tree for</italic><italic>W</italic><italic>whose edge set contains</italic><italic>e</italic>. <italic>In particular, the network</italic><italic>G</italic>(<italic>V</italic>|<italic>W</italic>) <italic>is always connected.</italic></p>
    </sec>
    <sec>
      <title>Proof</title>
      <p>Indeed, given any such subset <italic>E</italic>⊆<italic>E</italic>(<italic>V</italic>) and any edge <italic>e</italic>={<italic>u</italic>,<italic>v</italic>}∈<italic>E</italic>, we may denote by <italic>Π</italic>(<italic>e</italic>)=<italic>Π</italic><sub><italic>E</italic></sub>(<italic>e</italic>) the bi‐partition of <italic>V</italic> given by the (vertex sets of the) two connected components of the graph (<italic>V</italic>,<italic>E</italic>−{<italic>e</italic>}), and by <italic>A</italic>(<italic>w</italic>)=<italic>A</italic><sub><italic>E</italic></sub>(<italic>w</italic>), for any <italic>w</italic>∈<italic>V</italic>, the unique component <italic>A</italic>(<italic>w</italic>)∈<italic>Π</italic>(<italic>e</italic>) with <italic>w</italic>∈<italic>A</italic>(<italic>e</italic>). Clearly, we have <italic>Π</italic>(<italic>e</italic>)={<italic>A</italic>(<italic>u</italic>),<italic>A</italic>(<italic>v</italic>)} for every edge <italic>e</italic>={<italic>u</italic>,<italic>v</italic>}∈<italic>E</italic>.</p>
      <p>Now, assume that there exists some <italic>e</italic>={<italic>u</italic>,<italic>v</italic>}∈<italic>E</italic> with <italic>e</italic>∉<italic>E</italic>(<italic>V</italic>|<italic>W</italic>). Then, we could find some <italic>P</italic>=<italic>v</italic><sub>0</sub><italic>v</italic><sub>1</sub>...<italic>v</italic><sub><italic>k</italic>−1</sub><italic>v</italic><sub><italic>k</italic></sub> from <italic>v</italic><sub>0</sub>:=<italic>u</italic> to <italic>v</italic><sub><italic>k</italic></sub>:=<italic>v</italic> in <italic>G</italic>(<italic>V</italic>) with <italic>B</italic>(<italic>P</italic>)&lt;|<italic>e</italic>|. Furthermore, as <italic>A</italic>(<italic>v</italic><sub>0</sub>)=<italic>A</italic>(<italic>u</italic>)≠<italic>A</italic>(<italic>v</italic>)=<italic>A</italic>(<italic>v</italic><sub><italic>k</italic></sub>) must hold, there must be some <inline-formula><mml:math id="M18" name="1748-7188-8-7-i18" overflow="scroll"><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>}</mml:mo></mml:math></inline-formula> with <italic>A</italic>(<italic>v</italic><sub><italic>i</italic>−1</sub>)≠<italic>A</italic>(<italic>v</italic><sub><italic>i</italic></sub>), eg the smallest <italic>i</italic> in <inline-formula><mml:math id="M19" name="1748-7188-8-7-i19" overflow="scroll"><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>}</mml:mo></mml:math></inline-formula> with <italic>A</italic>(<italic>u</italic>)≠<italic>A</italic>(<italic>v</italic><sub><italic>i</italic></sub>). Consequently, exchanging the edge <italic>e</italic> with the edge <italic>e</italic><sub><italic>i</italic></sub>:={<italic>v</italic><sub><italic>i</italic>−1</sub>,<italic>v</italic><sub><italic>i</italic></sub>} in <italic>E</italic> would also give rise to a spanning tree for <italic>G</italic>(<italic>V</italic>), and we would have |<italic>E</italic><sup>′</sup>|=|<italic>E</italic>|+|<italic>e</italic><sub><italic>i</italic></sub>|−|<italic>e</italic>|&lt;|<italic>E</italic>| in view of |<italic>e</italic><sub><italic>i</italic></sub>|≤<italic>B</italic>(<italic>P</italic>)&lt;|<italic>e</italic>|, thus contradicting our choice of <italic>E</italic>. So, <italic>E</italic>⊆<italic>E</italic>(<italic>V</italic>|<italic>W</italic>) must hold, as claimed.</p>
      <p>To establish the converse, assume that <italic>e</italic>={<italic>u</italic>,<italic>v</italic>}∈<italic>E</italic>(<italic>V</italic>|<italic>W</italic>) is not contained in any minimum spanning tree. Then, given any such tree, let <italic>P</italic>=<italic>v</italic><sub>0</sub><italic>v</italic><sub>1</sub>...<italic>v</italic><sub><italic>k</italic>−1</sub><italic>v</italic><sub><italic>k</italic></sub> denote the unique path from <italic>v</italic><sub>0</sub>:=<italic>u</italic> to <italic>v</italic><sub><italic>k</italic></sub>:=<italic>v</italic> in that tree. Then, exchanging any edge <italic>e</italic><sup>′</sup> in the support of <italic>P</italic> with the edge <italic>e</italic> will produce a spanning tree for <italic>G</italic>(<italic>V</italic>) of larger weight, implying that |<italic>e</italic><sup>′</sup>|&lt;|<italic>e</italic>| must hold for every such edge <italic>e</italic><sup>′</sup> implying that also <italic>B</italic>(<italic>P</italic>)&lt;|<italic>e</italic>| must hold. This, however, would clearly contradict our assumption <italic>e</italic>∈<italic>E</italic>(<italic>V</italic>|<italic>W</italic>). □</p>
    </sec>
  </sec>
  <sec>
    <title>Optimal computation of the ultrametric network</title>
    <p>Clearly, given <italic>V</italic> and <italic>W</italic> as above, the ultrametric network can be produced in time <italic>O</italic>(|<italic>V</italic>|<sup>3</sup>) by a straightforward adaptation of the Floyd‐Warshall all‐pairs shortest‐path algorithm [<xref ref-type="bibr" rid="B22">22</xref>]. In view of Theorem 1, this network could be produced in time <italic>O</italic>(|<italic>V</italic>|<sup>3</sup>) also by first computing one MST by, say, Prim’s algorithm, and then computing <italic>W</italic><sup>∗</sup> using the paths in this tree. We present here an algorithm to compute the entire network in time <italic>O</italic>(|<italic>V</italic>|<sup>2</sup>). This is optimal since any algorithm must produce <italic>Θ</italic>(|<italic>V</italic>|<sup>2</sup>) values at the outset.</p>
    <p>The main idea is that the computation can be cast within a control structure that is strongly reminiscent of Prim’s MST ‐ or Dijkstra’s single‐source shortest‐path algorithm (refer to, e.g., [<xref ref-type="bibr" rid="B22">22</xref>]): starting with an arbitrary vertex <italic>r</italic>, a subset <inline-formula><mml:math id="M20" name="1748-7188-8-7-i20" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> of <italic>V</italic> is progressively expanded by annexing, at each step, the one vertex <italic>u</italic> in <inline-formula><mml:math id="M21" name="1748-7188-8-7-i21" overflow="scroll"><mml:mi>V</mml:mi><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> that is connected to <inline-formula><mml:math id="M22" name="1748-7188-8-7-i22" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> by an edge (<italic>v</italic>,<italic>u</italic>) that minimizes cost. As is well known, in Prim’s MST the cost to be minimized is the weight of the partial tree over the vertices in <inline-formula><mml:math id="M23" name="1748-7188-8-7-i23" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula>, whence the edge to be chosen is one of minimum weight. In Dijkstra’s algorithm, the cost to be minimized is the sum of weights on the arcs connecting <italic>u</italic> to <italic>r</italic>, whence the edge to be chosen is the one minimizing this sum. Note that in both cases there can be more than one vertex that minimizes the cost, however they will all produce the same global minimum. One important point of our algorithm is that (see Theorem 1) choosing (<italic>v</italic>,<italic>u</italic>) as in Prim’s MST computes the ultrametric distance not only between <italic>u</italic> and <italic>r</italic> but between <italic>u</italic> and any other vertex in <inline-formula><mml:math id="M24" name="1748-7188-8-7-i24" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula>. Moreover, it can be seen that the pairwise ultrametric distances between any pair of vertices in <inline-formula><mml:math id="M25" name="1748-7188-8-7-i25" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> are not affected by the introduction of <italic>u</italic> in this set. This last circumstance yields the speedup from <italic>O</italic>(|<italic>V</italic>|<sup>3</sup>) to <italic>O</italic>(|<italic>V</italic>|<sup>2</sup>).</p>
    <p>The algorithm starts with the original weights <italic>W</italic>(<italic>u</italic>,<italic>v</italic>), computes the ultrametric <italic>W</italic><sup>∗</sup> and identifies the subset of edges that form the ultrametric network <italic>Ē</italic>. In the following pseudo‐code, <italic>d</italic>(<italic>u</italic>,<italic>v</italic>) is initialized to <italic>∞</italic> and then used to store consecutively refined estimates of the value of <italic>W</italic><sup>∗</sup>(<italic>u</italic>,<italic>v</italic>), for any pair <italic>u</italic> and <italic>v</italic> of vertices. It will be seen that at the end <italic>d</italic>(<italic>u</italic>,<italic>v</italic>)=<italic>W</italic><sup>∗</sup>(<italic>u</italic>,<italic>v</italic>)<disp-formula><graphic xlink:href="1748-7188-8-7-i26.gif"/></disp-formula></p>
    <sec>
      <title>Lemma 1</title>
      <p><italic>At each iteration, d coincides with</italic><inline-formula><mml:math id="M26" name="1748-7188-8-7-i27" overflow="scroll"><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>W</mml:mi><mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>, <italic>the subdominant ultrametric of the restriction</italic><inline-formula><mml:math id="M27" name="1748-7188-8-7-i28" overflow="scroll"><mml:mi>W</mml:mi><mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:msub></mml:math></inline-formula><italic>of W to</italic><inline-formula><mml:math id="M28" name="1748-7188-8-7-i29" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula>, <italic>where the edge</italic> {<italic>v</italic><sup>′</sup>,<italic>v</italic><sup>″</sup>}∈<italic>Ē</italic><italic>if and only if:</italic></p>
      <p>• <italic>d</italic>(<italic>v</italic><sup>′</sup>,<italic>v</italic><sup>″</sup>)=<italic>W</italic>(<italic>v</italic><sup>′</sup>,<italic>v</italic><sup>″</sup>) and <italic>d</italic>(<italic>v</italic><sup>′</sup>,<italic>v</italic><sup>″</sup>)≤<italic>m</italic><italic>a</italic><italic>x</italic>(<italic>W</italic>(<italic>v</italic><sup>′</sup>,<italic>u</italic>),<italic>W</italic>(<italic>v</italic><sup>″</sup>,<italic>u</italic>)) holds for any two vertices <italic>v</italic><sup>′</sup>,<italic>v</italic><sup>″</sup> in <inline-formula><mml:math id="M29" name="1748-7188-8-7-i30" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> and all <italic>u</italic>∈<italic>Q</italic>,</p>
      <p>• <inline-formula><mml:math id="M30" name="1748-7188-8-7-i31" overflow="scroll"><mml:mtext mathvariant="italic">key</mml:mtext><mml:mo>[</mml:mo><mml:mi>u</mml:mi><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mi>W</mml:mi><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">prec</mml:mtext><mml:mo>[</mml:mo><mml:mi>u</mml:mi><mml:mo>]</mml:mo><mml:mo>,</mml:mo><mml:mi>u</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>min</mml:mo><mml:mo>(</mml:mo><mml:mi>W</mml:mi><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo><mml:mo>:</mml:mo><mml:mi>v</mml:mi><mml:mo>∈</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:math></inline-formula> holds for every <inline-formula><mml:math id="M31" name="1748-7188-8-7-i32" overflow="scroll"><mml:mi>u</mml:mi><mml:mo>∈</mml:mo><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mi>V</mml:mi><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula>.</p>
      <p>The proof follows easily from observing that <inline-formula><mml:math id="M32" name="1748-7188-8-7-i33" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> contains, at each recursive step, a connected subgraph that is part of a MST for V. Figure <xref ref-type="fig" rid="F1">1</xref> shows the generic step of the algorithm. It is easy to check that the set <italic>Ē</italic> contains all edges of the ultrametric network. We now prove that the algorithm is also optimal.</p>
      <fig id="F1" position="float">
        <label>Figure 1</label>
        <caption>
          <p>Illustrating the construction of the ultrametric network.</p>
        </caption>
        <graphic xlink:href="1748-7188-8-7-1"/>
      </fig>
    </sec>
    <sec>
      <title>Lemma 2</title>
      <p><italic>The algorithm constructs the subdominant ultrametric and its associated ultrametric network in optimal time</italic><italic>O</italic>(|<italic>V</italic>|<sup>2</sup>).</p>
    </sec>
    <sec>
      <title>Proof</title>
      <p>All the initialization steps, inclusive of the insertion of (|<italic>V</italic>|−1) initial values in the queue <italic>Q</italic> take time <italic>O</italic>(|<italic>V</italic>|<sup>2</sup>). Following this, each of the (|<italic>V</italic>|−1) iterations of the <italic>while</italic> loop contains two cascaded <italic>for</italic> cycles of <italic>O</italic>(|<italic>V</italic>|) elementary steps each. The first <italic>for</italic> computes the ultrametric network for the vertices in <inline-formula><mml:math id="M33" name="1748-7188-8-7-i34" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula>, whereas the second one updates the queue <italic>Q</italic>, which stores all vertices <inline-formula><mml:math id="M34" name="1748-7188-8-7-i35" overflow="scroll"><mml:mi>v</mml:mi><mml:mo>∉</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> according to the index <italic>k</italic><italic>e</italic><italic>y</italic>[<italic>v</italic>]. All the operations in each <italic>for</italic> take trivially constant time, except for the queue updates. If the queue is implemented as a Fibonacci heap, we can extract the minimum element in amortized <italic>O</italic>(log|<italic>V</italic>|) and update the queue in amortized <italic>O</italic>(1), when <italic>k</italic><italic>e</italic><italic>y</italic>[<italic>v</italic>] is decreased. There are (|<italic>V</italic>|−1)<italic>extractmin</italic> (at the beginning of every iteration of the <italic>while</italic>), which thus charge <italic>O</italic>(|<italic>V</italic>| log|<italic>V</italic>|) overall. There are <italic>O</italic>(|<italic>V</italic>|<sup>2</sup>) constant‐time updates throughout all the executions of the second <italic>for</italic> loop. Hence the total cost of the algorithm is <italic>O</italic>(|<italic>V</italic>|<sup>2</sup>). The subdominant ultrametric requires <italic>Θ</italic>(|<italic>V</italic>|<sup>2</sup>) entries, and an ultrametric network contains at most |<italic>V</italic>|<sup>2</sup> edges, so that <italic>O</italic>(|<italic>V</italic>|<sup>2</sup>) time is optimal. □</p>
    </sec>
  </sec>
  <sec>
    <title>Ultrametric network relaxations</title>
    <p>The algorithm of the preceding section lends itself naturally to variants that accommodate some tolerance in the ultrametric distance and relax the notion of ultrametric network. We outline here these two variants, respectively leading to <italic>Δ</italic>‐ultrametric networks and to the introduction of new artificial vertices.</p>
    <sec>
      <title><italic>Δ</italic>‐Ultrametric extension</title>
      <p>We define the <italic>Δ</italic><italic>‐ultrametric network</italic> in which edges are inserted if their weights do not deviate more that a given threshold <italic>Δ</italic> from the corresponding ultrametric distance.</p>
      <p>Formally the <italic>Δ</italic><italic>‐ultrametric network</italic> consists of the graph <italic>G</italic><sub><italic>Δ</italic></sub>(<italic>V</italic>|<italic>W</italic>)=(<italic>V</italic>, <italic>E</italic><sub><italic>Δ</italic></sub>(<italic>V</italic>|<italic>W</italic>)) with vertex set <italic>V</italic> and edge set <inline-formula><mml:math id="M35" name="1748-7188-8-7-i36" overflow="scroll"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>V</mml:mi><mml:mo>|</mml:mo><mml:mi>W</mml:mi><mml:mo>)</mml:mo><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mstyle mathsize="1.19em"><mml:mfenced open="{"><mml:mrow/></mml:mfenced></mml:mstyle><mml:mo>{</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>}</mml:mo><mml:mo>∈</mml:mo><mml:mfenced open="(" close=")"><mml:mfrac linethickness="0.0pt"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>:</mml:mo><mml:mi>W</mml:mi><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo><mml:mo>≤</mml:mo><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mstyle mathsize="1.19em"><mml:mfenced open="}"><mml:mrow/></mml:mfenced></mml:mstyle></mml:math></inline-formula>, where <italic>W</italic><sup>∗</sup>(<italic>u</italic>,<italic>v</italic>) is the standard ultrametric distance. Intuitively, the <italic>Δ</italic>‐ultrametric network is thus a relaxation of the ultrametric network, resulting in increased connectivity. More precisely the graph <italic>G</italic><sub><italic>Δ</italic></sub>(<italic>V</italic>|<italic>W</italic>) coincides with the map min(<italic>W</italic>,<italic>W</italic><sup>∗</sup>+<italic>Δ</italic>).</p>
      <p>The <italic>Δ</italic>‐ultrametric network can be computed as a postprocessing by adding all such edges <italic>E</italic><sub><italic>Δ</italic></sub>(<italic>V</italic>|<italic>W</italic>) to the <italic>exact</italic> ultrametric network. In summary at first we run the algorithm on the original weights <italic>W</italic>(<italic>u</italic>,<italic>v</italic>) to compute <italic>W</italic><sup>∗</sup>. Then, we apply the postprocess that includes all edges (<italic>u</italic>,<italic>v</italic>) with weight <italic>W</italic>(<italic>u</italic>,<italic>v</italic>) that deviates at most <italic>Δ</italic> from the corresponding ultrametric value <italic>W</italic><sup>∗</sup>(<italic>u</italic>,<italic>v</italic>). Similarly to the main algorithm, this postprocess takes optimal <italic>O</italic>(|<italic>V</italic>|<sup>2</sup>) time. Other alternatives relaxations can be explored, like the subdominant <italic>Δ</italic>‐ultrametrics for which analogous results can be established. The subdominant <italic>Δ</italic>‐ultrametrics relaxation will be addressed in a future paper.</p>
    </sec>
    <sec>
      <title>Artificial vertices</title>
      <p>In applications such as phylogeny on biological data of extant species/individuals, the topology must account for missing data points. In other words, there is a need to reduce the distance between a pair of vertices by introducing a new artificial vertex in the network.</p>
      <p>In the phylogeny construction problem, the given data points are the terminals and the artificial vertices correspond to missing (or ancestral) data points. The traditional Steiner tree problem [<xref ref-type="bibr" rid="B23">23</xref>] involves the minimization of the sum of the lengths of all edges used after introducing artificial vertices, as opposed to the sum of the pairwise distances of all the terminals. For different metrics the Steiner tree problem is known to be NP‐Hard [<xref ref-type="bibr" rid="B24">24</xref>]. Thus in our context, given the graph induced by the ultrametric <italic>W</italic><sup>∗</sup>, the problem of introducing new artificial vertices that minimize the sum of the weights of all edges is still NP‐Hard.</p>
      <p>In our case the input graph <italic>G</italic> is not just any graph, but it can be characterized as follow. Suppose we are given a (big) metric space <inline-formula><mml:math id="M36" name="1748-7188-8-7-i37" overflow="scroll"><mml:mi mathvariant="script">R</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> (could be the metric space consisting of the vertex set <italic>R</italic> of a connected weighted graph <italic>G</italic> with the “induced" metric, i.e., the largest metric <italic>D</italic> on <italic>V</italic> with <italic>D</italic>(<italic>u</italic>,<italic>v</italic>)≤<italic>w</italic>(<italic>u</italic>,<italic>v</italic>) for all edges <italic>u</italic>,<italic>v</italic> in <italic>G</italic>), and a finite subset <italic>R</italic> of <italic>V</italic>.</p>
      <p>The solution to the Steiner tree problem is to find a connected graph <inline-formula><mml:math id="M37" name="1748-7188-8-7-i38" overflow="scroll"><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="script">R</mml:mi><mml:mo>|</mml:mo><mml:mi>V</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> with a vertex set containing <italic>R</italic> and contained in <italic>V</italic> and edge set <inline-formula><mml:math id="M38" name="1748-7188-8-7-i39" overflow="scroll"><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="script">R</mml:mi><mml:mo>|</mml:mo><mml:mi>V</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> such that <inline-formula><mml:math id="M39" name="1748-7188-8-7-i40" overflow="scroll"><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>}</mml:mo><mml:mo>∈</mml:mo><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="script">R</mml:mi><mml:mo>|</mml:mo><mml:mi>V</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:mi>D</mml:mi><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> is minimized. In case you just have a metric <italic>D</italic> on <italic>V</italic>, in our case <italic>W</italic><sup>∗</sup>, the most natural choice for (<italic>V</italic>,<italic>D</italic>) is the tight span</p>
      <p>
        <disp-formula>
          <mml:math id="M40" name="1748-7188-8-7-i41" overflow="scroll">
            <mml:mrow>
              <mml:mi>T</mml:mi>
              <mml:mo>(</mml:mo>
              <mml:mi>D</mml:mi>
              <mml:mo>)</mml:mo>
              <mml:mo>:</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mo>{</mml:mo>
              <mml:mi>f</mml:mi>
              <mml:mo>∈</mml:mo>
              <mml:msup>
                <mml:mrow>
                  <mml:mi>R</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>V</mml:mi>
                </mml:mrow>
              </mml:msup>
              <mml:mo>:</mml:mo>
              <mml:mi>f</mml:mi>
              <mml:mo>(</mml:mo>
              <mml:mi>v</mml:mi>
              <mml:mo>)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mo>sup</mml:mo>
              <mml:mo>(</mml:mo>
              <mml:mi>D</mml:mi>
              <mml:mo>(</mml:mo>
              <mml:mi>u</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>v</mml:mi>
              <mml:mo>)</mml:mo>
              <mml:mo>−</mml:mo>
              <mml:mi>f</mml:mi>
              <mml:mo>(</mml:mo>
              <mml:mi>u</mml:mi>
              <mml:mo>)</mml:mo>
              <mml:mo>)</mml:mo>
              <mml:mo>:</mml:mo>
              <mml:mi>u</mml:mi>
              <mml:mo>∈</mml:mo>
              <mml:mi>V</mml:mi>
              <mml:mo>}</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>of (<italic>V</italic>,<italic>D</italic>). It is natural in this case as any Steiner tree for <italic>V</italic> can be mapped into <italic>T</italic>(<italic>D</italic>) by a non‐expanding map that preserves the distances between the points in <italic>V</italic>[<xref ref-type="bibr" rid="B25">25</xref>]. We don’t know how to efficiently search for the best Steiner tree within <italic>T</italic>(<italic>D</italic>), also known as the optimal realization, without an exhaustive enumeration [<xref ref-type="bibr" rid="B26">26</xref>,<xref ref-type="bibr" rid="B27">27</xref>]. Instead starting from a given graph <inline-formula><mml:math id="M41" name="1748-7188-8-7-i42" overflow="scroll"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula> over <italic>R</italic> we look at the “neighborhood" of this seed in <italic>T</italic>(<italic>D</italic>). The input graph <inline-formula><mml:math id="M42" name="1748-7188-8-7-i43" overflow="scroll"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula> over <italic>R</italic> is the ultrametric network computed in the previous section and we are interested in the “neighborhood" of this network such that the sum of all edges is smaller and that the pairwise distances in <italic>R</italic> are preserved.</p>
      <p>For every edge {<italic>y</italic>,<italic>w</italic>} in <inline-formula><mml:math id="M43" name="1748-7188-8-7-i44" overflow="scroll"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula> we search in its neighborhood by looking at the vertices directly connected to <italic>y</italic> and <italic>w</italic>. If there is some vertex <italic>u</italic> that is connected to <italic>y</italic> and <italic>w</italic> we explore the possibility to insert a new node <italic>x</italic> as the median of <italic>y</italic>, <italic>w</italic> and <italic>u</italic>. Clearly if we add the artificial vertex <italic>x</italic> and replace the edges that create a cycle (<italic>u</italic>,<italic>w</italic>), (<italic>u</italic>,<italic>y</italic>) and (<italic>w</italic>,<italic>y</italic>), with the edges (<italic>u</italic>,<italic>x</italic>), (<italic>w</italic>,<italic>x</italic>) and (<italic>y</italic>,<italic>x</italic>) (see Figure <xref ref-type="fig" rid="F2">2</xref>) this new configuration does not increase the contributions of the distances involving the three nodes.</p>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p>The creation of a new artificial vertex.</p>
        </caption>
        <graphic xlink:href="1748-7188-8-7-2"/>
      </fig>
      <p>To control the number of artificial vertices, the new vertex <italic>x</italic> is created only if the sum of pairwise distances of the triangle among <italic>u</italic>, <italic>w</italic> and <italic>y</italic> exceeds the threshold <italic>Δ</italic>. Note that if two triangles share an edge we need to select where to insert the new artificial vertex. A canonical order can be established by ranking all candidate triangles by the sum of pairwise distances. This ensures that, at least generically, the introduction of new artificial vertices is unique and does not depend on the input order.</p>
    </sec>
  </sec>
  <sec>
    <title>Experimental results</title>
    <p>To conclude our presentation, we report two examples of inference of Human Y‐chromosome phylogeny from Short Tandem Repeats. This can be based on the study of Human migration and the associated relationships among different populations. In typical experiments, we are interested in constructing a network from the STRs information of various individuals and in comparing the results with known paths of migrations. An interesting example of such a phylogeny reconstruction can be found in [<xref ref-type="bibr" rid="B28">28</xref>], which discusses the significance of STRs data as markers for human evolution, but also highlights the difficulties that the analysis of this data derives from the lack of an appropriate methodology.</p>
    <p>Using the same data of [<xref ref-type="bibr" rid="B28">28</xref>,<xref ref-type="bibr" rid="B29">29</xref>], we study migration histories within two different scenarios. In the first experiment, we analyze a very broad spectrum of populations: Africans, Europeans, Asians and Australians. In the second, we concentrate on Native Americans spanning North America (Navajo, Zuni, Sioux), Central America (Maya), and South America (Ticuna, Wichi, Toba, Chorote, Tehuelche, Susque, Humahuaqueño).</p>
    <p>For both experiments the data available include a number of different STRs, specifically, 12 in the first experiment and 7 in second. The first step is to establish for all STRs a weighting scheme reflecting the different mutation rates. To this end, we use the three weights 1,2 and 4, and assign to each STR a weight proportional to its mutation rate.</p>
    <p>Figure <xref ref-type="fig" rid="F3">3</xref> shows the ultrametric network computed from the first dataset. The labels associated with each node are reported in the figure’s caption, and new nodes are tagged with the letter “N”. The pairwise distances between nodes are reported as attributes of the edges. In Figure <xref ref-type="fig" rid="F3">3</xref>, the populations are grouped by continent; the nodes filled with gray represent Caucasoid, the ones filled with blue represent Africans, bold nodes are Asians and the remaining ones are from Australia.</p>
    <fig id="F3" position="float">
      <label>Figure 3</label>
      <caption>
        <p><bold>Ultrametric network of 54 individuals from different populations all over the world.</bold><italic>Δ</italic>=0 and <italic>Δ</italic>=0. The labels represent: H = Han, G = German, T = Turk, J = Japanese, Ov = Ovambo, W = Western Pygmy, A = Australian Aboriginal, P = Papuan, B = San (Bushman), and M= Mongolian. A Rough classification is: J+H+M=East Asian, G+T= Caucasoid, A+P=Australian, B+W+Ov= Africans. Nodes filled with gray represent Caucasoid, the ones filled with blue represent Africans, bold nodes are Asians, and the remaining ones are from Australia.</p>
      </caption>
      <graphic xlink:href="1748-7188-8-7-3"/>
    </fig>
    <p>We can observe that, in general, all different continents are well separated, and that most of the individuals belonging to the same population are clustered together: Japanese, Han, Turkish, Australian, and so on. Moreover, the known paths of migration support the view that Han are close relatives of Africans and that Japanese evolved from Central Asian populations. Also, Germans appear to be related to Northern Africans and Turks, the latter are also connected with Han, thus supporting the idea that Turks are partially Asians. The only population slightly misplaced are Papuans probably because the STRs examined do not resolve for this population, a problem already observed in [<xref ref-type="bibr" rid="B28">28</xref>]. Figure <xref ref-type="fig" rid="F4">4</xref> shows the ultrametric network of Native Americans, using the same data as in [<xref ref-type="bibr" rid="B29">29</xref>]. This experiment is a particularly difficult test, due to the high level of homoplasy and the small number of STRs available. Nevertheless the network still exposes the structural diversity between North American Natives (blue), Central (gray) and South Americans (white).</p>
    <fig id="F4" position="float">
      <label>Figure 4</label>
      <caption>
        <p><bold>Ultrametric network of 41 new world natives.</bold> A rough classification is: North America (Navajo, Zuni, Sioux) in blue, Central (Maya) in grey, South (Ticuna, Wichi, Toba, Chorote, Tehuelche), (Susque, Humahuaquen) in white.</p>
      </caption>
      <graphic xlink:href="1748-7188-8-7-4"/>
    </fig>
    <p>As discussed, the connectivity of the inferred network can be fine‐tuned by setting the two control parameters <italic>Δ</italic> and <italic>Δ</italic>. The first one is used to filter out the feeblest edges: with <italic>Δ</italic>=0, all links are selected. The value assigned to the second parameter sets the tolerance within which edges are included in the <italic>Δ</italic>‐ultrametric network. Thus, large values of <italic>Δ</italic> reduce the number of artificial points introduced, large values of <italic>Δ</italic> increase the connectivity of the network. Space limitation prevents a thorough analysis of these variants. As an illustration, Figure <xref ref-type="fig" rid="F5">5</xref> displays the networks obtained in correspondence with a few different settings.</p>
    <fig id="F5" position="float">
      <label>Figure 5</label>
      <caption>
        <p><bold>Ultrametric network of 54 individuals from different populations all over the world (same as in Figure </bold><xref ref-type="fig" rid="F3">3</xref>) <bold>for a few values of parameters </bold><bold><italic>Δ</italic></bold><bold> and </bold><bold><italic>Δ</italic></bold><bold>.</bold></p>
      </caption>
      <graphic xlink:href="1748-7188-8-7-5"/>
    </fig>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p>In conclusion, this paper expands the <italic>subdominant ultrametric</italic> perspective by studying ultrametric <italic>networks</italic>. We shown that, for a graph with <italic>n</italic> vertices, the construction of such a network can be carried out by a simple algorithm in optimal time <italic>O</italic>(<italic>n</italic><sup>2</sup>). This algorithm can be easily adapted to compute relaxed networks, such as <italic>Δ</italic>‐ultrametric networks and to support the introduction of artificial points to reduce the maximum distance between vertices in a pair. Finally, we discussed a few experiments to demonstrate the applicability of subdominant ultrametric networks.</p>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec>
    <title>Authors’ contributions</title>
    <p>All authors contributed equally to this work. All authors read and approved the final manuscript.</p>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>Enrico Guariento implemented and tested the software Ultranet. M. Comin was partially supported by the Ateneo Project <italic>CPDA110239</italic>.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Agarwala</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Bafna</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Farach</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Narayanan</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Paterson</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Thorup</surname>
          <given-names>M</given-names>
        </name>
        <article-title>On the approximability of numerical taxonomy: Fitting distances by tree metrics</article-title>
        <source>Proceedings of the 7th Annual ACM‐SIAM Symposium on Discrete Algorithms</source>
        <year>1996</year>
        <volume>28</volume>
        <issue>3</issue>
        <fpage>1073</fpage>
        <lpage>1085</lpage>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Farach</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Kannan</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Warnow</surname>
          <given-names>T</given-names>
        </name>
        <article-title>A Robust model for finding optimal evolutionary trees</article-title>
        <source>Algorithmica, special issue on Computational Biology</source>
        <year>1996</year>
        <volume>13</volume>
        <fpage>155</fpage>
        <lpage>179</lpage>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Gower</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Ross</surname>
          <given-names>G</given-names>
        </name>
        <article-title>Minimum spanning trees and single linkage cluster analysis</article-title>
        <source>Appl Stat</source>
        <year>1969</year>
        <volume>18</volume>
        <fpage>54</fpage>
        <lpage>64</lpage>
        <pub-id pub-id-type="doi">10.2307/2346439</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Florek</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Lukaszewickz</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Perkal</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Steinhaus</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Zubrzycki</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Sur la Liaison et la Division des Points d’un Ensemble Fini</article-title>
        <source>Colloq Matematicum</source>
        <year>1951</year>
        <volume>2</volume>
        <fpage>282</fpage>
        <lpage>285</lpage>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Edwards</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Sforza</surname>
          <given-names>LC</given-names>
        </name>
        <article-title>Reconstruction of evolutionary trees</article-title>
        <source>Phenetic Phylogenet Classif</source>
        <year>1964</year>
        <volume>6</volume>
        <fpage>67</fpage>
        <lpage>76</lpage>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Gromov</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Hyperbolic groups, essays in group theory, MSRI series vol. 8, S.Gersten, ed., Springer‐Verlag (1988). trees and single linkage cluster analysis</article-title>
        <source>Appl Stat</source>
        <year>1969</year>
        <volume>18</volume>
        <fpage>54</fpage>
        <lpage>64</lpage>
        <pub-id pub-id-type="doi">10.2307/2346439</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="book">
        <name>
          <surname>Bowditch</surname>
          <given-names>B</given-names>
        </name>
        <article-title>Notes on Gromov’s hyperbolicity criterion for path metric spaces</article-title>
        <source>E. Ghys et al.: E. Ghys et al., Proceedings of Group Theory from a Geometric Viewpoint, World Scientific</source>
        <year>1991</year>
        <publisher-name>Singapore</publisher-name>
        <fpage>64</fpage>
        <lpage>167</lpage>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Dress</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Huber</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Moulton</surname>
          <given-names>V</given-names>
        </name>
        <article-title>Some uses of the Farris Transform in Mathematics and Phylogenetics – A Review</article-title>
        <source>Ann Combinatorics, Special Volume Biomathematics</source>
        <year>2007</year>
        <volume>11</volume>
        <fpage>1</fpage>
        <lpage>37</lpage>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bayod</surname>
          <given-names>JM</given-names>
        </name>
        <name>
          <surname>Martinez‐Maurica</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Subdominant ultrametrics</article-title>
        <source>Proc Am Math Soc</source>
        <year>1990</year>
        <volume>109</volume>
        <issue>3</issue>
        <fpage>829</fpage>
        <lpage>834</lpage>
        <pub-id pub-id-type="doi">10.1090/S0002-9939-1990-1015676-1</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Parisi</surname>
          <given-names>G</given-names>
        </name>
        <article-title>Spin glasses and fragile glasses: Static, dynamics and complexity</article-title>
        <source>PNAS</source>
        <year>2006</year>
        <volume>103</volume>
        <issue>21</issue>
        <fpage>7948</fpage>
        <lpage>7955</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0601120103</pub-id>
        <?supplied-pmid 16690744?>
        <pub-id pub-id-type="pmid">16690744</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rammal</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Toulouse</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Virasoso</surname>
          <given-names>MA</given-names>
        </name>
        <article-title>Ultrametricity for Physicists</article-title>
        <source>Rev Mod Phys</source>
        <year>1986</year>
        <volume>58</volume>
        <fpage>765</fpage>
        <lpage>788</lpage>
        <pub-id pub-id-type="doi">10.1103/RevModPhys.58.765</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Soete</surname>
          <given-names>GD</given-names>
        </name>
        <article-title>Ultrametric tree representations of incomplete dissimilarity data</article-title>
        <source>J Classif</source>
        <year>1984</year>
        <volume>1</volume>
        <fpage>235</fpage>
        <lpage>242</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01890124</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="other">
        <name>
          <surname>Huson</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Nettles</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Warnow</surname>
          <given-names>T</given-names>
        </name>
        <article-title>Obtaining accurate topology estimates of evolutionary trees from very short sequences</article-title>
        <source>Proc RECOMB</source>
        <year>1999</year>
        <fpage>198</fpage>
        <lpage>207</lpage>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bandelt</surname>
          <given-names>HJ</given-names>
        </name>
        <name>
          <surname>Forster</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Rühl</surname>
          <given-names>A</given-names>
        </name>
        <article-title>Median‐joining networks for inferring intraspecific phylogenies</article-title>
        <source>Mol Biol Evol</source>
        <year>1999</year>
        <volume>16</volume>
        <fpage>37</fpage>
        <lpage>48</lpage>
        <pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a026036</pub-id>
        <?supplied-pmid 10331250?>
        <pub-id pub-id-type="pmid">10331250</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bryant</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Moulton</surname>
          <given-names>V</given-names>
        </name>
        <article-title>Neighbor‐Net: An agglomerative method for the construction of phylogenetic networks</article-title>
        <source>Mol Biol Evol</source>
        <year>2004</year>
        <volume>21</volume>
        <fpage>255</fpage>
        <lpage>265</lpage>
        <?supplied-pmid 14660700?>
        <pub-id pub-id-type="pmid">14660700</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Grünewald</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Forslund</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Dress</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Moulton</surname>
          <given-names>V</given-names>
        </name>
        <article-title>QNet: an agglomerative method for the construction of phylogenetic networks from weighted quartets</article-title>
        <source>Mol Biol Evol</source>
        <year>2007</year>
        <volume>24</volume>
        <fpage>532</fpage>
        <lpage>538</lpage>
        <?supplied-pmid 17119010?>
        <pub-id pub-id-type="pmid">17119010</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Saitou</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Imanishi</surname>
          <given-names>T</given-names>
        </name>
        <article-title>Relative effciencies of the fitch‐margoliash, maximum parsimony, maximum likelihood, minimum evolution, and neighbor‐joining methods of phylogenetic tree construction in obtaining the correct tree</article-title>
        <source>Mol Biol Evol</source>
        <year>1989</year>
        <volume>6</volume>
        <fpage>514</fpage>
        <lpage>525</lpage>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Excoffier</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Smouse</surname>
          <given-names>P</given-names>
        </name>
        <article-title>Using allele frequencies and geographic subdivision to reconstruct gene genealogies within a species: Molecular variance parsimony</article-title>
        <source>Genetics</source>
        <year>1994</year>
        <volume>136</volume>
        <fpage>343</fpage>
        <lpage>359</lpage>
        <?supplied-pmid 8138170?>
        <pub-id pub-id-type="pmid">8138170</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Templeton</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Crandall</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Sing</surname>
          <given-names>C</given-names>
        </name>
        <article-title>A cladistic analysis of phenotypic associations with haplotypes inferred from restriction endonuclease mapping and DNA sequence data. III. Cladogram estimation</article-title>
        <source>Genetics</source>
        <year>1992</year>
        <volume>132</volume>
        <fpage>619</fpage>
        <lpage>633</lpage>
        <?supplied-pmid 1385266?>
        <pub-id pub-id-type="pmid">1385266</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hart</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Sunday</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Things fall apart: biological species form unconnected parsimony networks</article-title>
        <source>Biol Lett</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>509</fpage>
        <lpage>512</lpage>
        <pub-id pub-id-type="doi">10.1098/rsbl.2007.0307</pub-id>
        <?supplied-pmid 17650475?>
        <pub-id pub-id-type="pmid">17650475</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Clement</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Posada</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Crandall</surname>
          <given-names>K</given-names>
        </name>
        <article-title>TCS: a computer program to estimate gene genealogies</article-title>
        <source>Mol Ecol</source>
        <year>2000</year>
        <volume>9</volume>
        <fpage>1657</fpage>
        <lpage>1659</lpage>
        <pub-id pub-id-type="doi">10.1046/j.1365-294x.2000.01020.x</pub-id>
        <?supplied-pmid 11050560?>
        <pub-id pub-id-type="pmid">11050560</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="book">
        <name>
          <surname>Cormen</surname>
          <given-names>TH</given-names>
        </name>
        <name>
          <surname>Leiserson</surname>
          <given-names>CE</given-names>
        </name>
        <name>
          <surname>Rivest</surname>
          <given-names>RL</given-names>
        </name>
        <name>
          <surname>Stein</surname>
          <given-names>C</given-names>
        </name>
        <source>Introduction to Algorithms</source>
        <year>2001</year>
        <publisher-name>Cambridge: MIT Press</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="book">
        <name>
          <surname>Hwang</surname>
          <given-names>FK</given-names>
        </name>
        <name>
          <surname>Richards</surname>
          <given-names>DS</given-names>
        </name>
        <name>
          <surname>Winter</surname>
          <given-names>P</given-names>
        </name>
        <source>The Steiner Tree Problem, Volume Annals of Discrete Mathematics</source>
        <year>1992</year>
        <publisher-name>Amderdam: Elsevier Science Publishes</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="book">
        <name>
          <surname>Bern</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Eppstein</surname>
          <given-names>D</given-names>
        </name>
        <article-title>Hardness of approximations algorithms for geometric problems</article-title>
        <source>Approximation algorithms for NP‐Hardness Problems edited by D. S. Hochbaum</source>
        <year>1997</year>
        <publisher-name>Boston, MA: PWS Publishing Company</publisher-name>
        <fpage>296</fpage>
        <lpage>345</lpage>
        <?supplied-pmid 23702545?>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="other">
        <name>
          <surname>Dress</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Huber</surname>
          <given-names>KT</given-names>
        </name>
        <name>
          <surname>Moulton</surname>
          <given-names>V</given-names>
        </name>
        <article-title>Metric spaces in pure and applied mathematics</article-title>
        <source>Documenta Mathematica (Proceedings Quadratic Forms LSU)</source>
        <year>2001</year>
        <fpage>121</fpage>
        <lpage>139</lpage>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Dress</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Huber</surname>
          <given-names>KT</given-names>
        </name>
        <name>
          <surname>Koolen</surname>
          <given-names>JH</given-names>
        </name>
        <name>
          <surname>Moultonm</surname>
          <given-names>V</given-names>
        </name>
        <article-title>Block realizations of finite metrics and the tight‐span construction I: The embedding theorem</article-title>
        <source>Discrete Appl Math</source>
        <year>2008</year>
        <volume>21</volume>
        <issue>12</issue>
        <fpage>1306</fpage>
        <lpage>1309</lpage>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Dress</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Wu</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Xu</surname>
          <given-names>X</given-names>
        </name>
        <article-title>A note on single‐linkage equivalence</article-title>
        <source>Appl Math Lett</source>
        <year>2010</year>
        <volume>23</volume>
        <fpage>432</fpage>
        <lpage>435</lpage>
        <pub-id pub-id-type="doi">10.1016/j.aml.2009.11.012</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Forster</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Rohl</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Lunnemann</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Brinkmann</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Zerjal</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Tyler‐Smith</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Brinkmann</surname>
          <given-names>B</given-names>
        </name>
        <article-title>A short tandem repeat‐based phylogeny for the human Y chromosome</article-title>
        <source>Am J Hum Genet</source>
        <year>2000</year>
        <volume>67</volume>
        <fpage>182</fpage>
        <lpage>196</lpage>
        <pub-id pub-id-type="doi">10.1086/302953</pub-id>
        <?supplied-pmid 10827105?>
        <pub-id pub-id-type="pmid">10827105</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bianchi</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Catanesi</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Bailliet</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Martinez‐Marignac</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Bravi</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Vidal‐Rioja</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Herrera</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Lopez‐Camelo</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Characterization of ancestral and derived Y‐chromosome haplotypes of new world native populations</article-title>
        <source>Am J Hum Genet</source>
        <year>1998</year>
        <volume>63</volume>
        <issue>6</issue>
        <fpage>1862</fpage>
        <lpage>1871</lpage>
        <pub-id pub-id-type="doi">10.1086/302141</pub-id>
        <?supplied-pmid 9837838?>
        <pub-id pub-id-type="pmid">9837838</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
