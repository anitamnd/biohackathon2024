<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with OASIS Tables with MathML3 v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archive-oasis-article1-mathml3.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats-oasis2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Mol Ecol Resour</journal-id>
    <journal-id journal-id-type="iso-abbrev">Mol Ecol Resour</journal-id>
    <journal-id journal-id-type="doi">10.1111/(ISSN)1755-0998</journal-id>
    <journal-id journal-id-type="publisher-id">MEN</journal-id>
    <journal-title-group>
      <journal-title>Molecular Ecology Resources</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1755-098X</issn>
    <issn pub-type="epub">1755-0998</issn>
    <publisher>
      <publisher-name>John Wiley and Sons Inc.</publisher-name>
      <publisher-loc>Hoboken</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8518384</article-id>
    <article-id pub-id-type="pmid">34062051</article-id>
    <article-id pub-id-type="doi">10.1111/1755-0998.13438</article-id>
    <article-id pub-id-type="publisher-id">MEN13438</article-id>
    <article-categories>
      <subj-group subj-group-type="overline">
        <subject>Resource Article</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>RESOURCE ARTICLES</subject>
        <subj-group subj-group-type="heading">
          <subject>Computer Programs</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>quickLD: An efficient software for linkage disequilibrium analyses</article-title>
      <alt-title alt-title-type="left-running-head">THEODORIS et al.</alt-title>
    </title-group>
    <contrib-group>
      <contrib id="men13438-cr-0001" contrib-type="author">
        <name>
          <surname>Theodoris</surname>
          <given-names>Charalampos</given-names>
        </name>
        <xref rid="men13438-aff-0001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib id="men13438-cr-0002" contrib-type="author">
        <name>
          <surname>Low</surname>
          <given-names>Tze Meng</given-names>
        </name>
        <xref rid="men13438-aff-0002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib id="men13438-cr-0003" contrib-type="author">
        <name>
          <surname>Pavlidis</surname>
          <given-names>Pavlos</given-names>
        </name>
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-8359-7257</contrib-id>
        <xref rid="men13438-aff-0003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib id="men13438-cr-0004" contrib-type="author" corresp="yes">
        <name>
          <surname>Alachiotis</surname>
          <given-names>Nikolaos</given-names>
        </name>
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8162-3792</contrib-id>
        <xref rid="men13438-aff-0004" ref-type="aff">
          <sup>4</sup>
        </xref>
        <address>
          <email>n.alachiotis@utwente.nl</email>
        </address>
      </contrib>
    </contrib-group>
    <aff id="men13438-aff-0001">
      <label>
        <sup>1</sup>
      </label>
      <institution>Technical University of Crete</institution>
      <city>Chania</city>
      <country country="GR">Greece</country>
    </aff>
    <aff id="men13438-aff-0002">
      <label>
        <sup>2</sup>
      </label>
      <institution>Carnegie Mellon University</institution>
      <city>Pittsburgh</city>
      <country country="US">USA</country>
    </aff>
    <aff id="men13438-aff-0003">
      <label>
        <sup>3</sup>
      </label>
      <institution>Foundation for Research and Technology‐Hellas</institution>
      <city>Heraklion</city>
      <country country="GR">Greece</country>
    </aff>
    <aff id="men13438-aff-0004">
      <label>
        <sup>4</sup>
      </label>
      <institution>University of Twente</institution>
      <city>Enschede</city>
      <country country="NL">The Netherlands</country>
    </aff>
    <author-notes>
      <corresp id="correspondenceTo"><label>*</label><bold>Correspondence</bold><break/>
Nikolaos Alachiotis, University of Twente, Enschede, The Netherlands.<break/>
Email: <email>n.alachiotis@utwente.nl</email>
<break/>
</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>6</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <volume>21</volume>
    <issue seq="300">7</issue>
    <issue-id pub-id-type="doi">10.1111/men.v21.7</issue-id>
    <fpage>2580</fpage>
    <lpage>2587</lpage>
    <history>
      <date date-type="rev-recd">
        <day>14</day>
        <month>5</month>
        <year>2021</year>
      </date>
      <date date-type="received">
        <day>16</day>
        <month>2</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>5</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <!--Copyright &#x000a9; 2021 John Wiley & Sons Ltd-->
      <copyright-statement content-type="article-copyright">© 2021 The Authors. <italic toggle="yes">Molecular Ecology Resources</italic> published by John Wiley &amp; Sons Ltd.</copyright-statement>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an open access article under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link> License, which permits use, distribution and reproduction in any medium, provided the original work is properly cited and is not used for commercial purposes.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="file:MEN-21-2580.pdf"/>
    <abstract id="men13438-abs-0001">
      <title>Abstract</title>
      <p>Software tools for linkage disequilibrium (LD) analyses are designed to calculate LD among all genetic variants in a single region. Since compute and memory requirements grow quadratically with the distance between variants, using these tools for long‐range LD calculations leads to long execution times and increased allocation of memory resources. Furthermore, widely used tools do not fully utilize the computational resources of modern processors and/or graphics processing cards, limiting future large‐scale analyses on thousands of samples. We present quickLD, a stand‐alone and open‐source software that computes several LD‐related statistics, including the commonly used <italic toggle="yes">r</italic>
<sup>2</sup>. quickLD calculates pairwise LD between genetic variants in a single region or in arbitrarily distant regions with negligible memory requirements. Moreover, quickLD achieves up to 95% and 97% of the theoretical peak performance of a CPU and a GPU, respectively, enabling 21.5× faster processing than current state‐of‐the‐art software on a multicore processor and 49.5× faster processing when the aggregate processing power of a multicore CPU and a GPU is harnessed. quickLD can also be used in studies of selection, recombination, genetic drift, inbreeding and gene flow. The software is available at <ext-link xlink:href="https://github.com/pephco/quickLD" ext-link-type="uri">https://github.com/pephco/quickLD</ext-link>.</p>
    </abstract>
    <kwd-group>
      <kwd id="men13438-kwd-0001">computer program</kwd>
      <kwd id="men13438-kwd-0002">high‐performance software</kwd>
      <kwd id="men13438-kwd-0003">linkage disequilibrium</kwd>
    </kwd-group>
    <counts>
      <fig-count count="6"/>
      <table-count count="2"/>
      <page-count count="0"/>
      <word-count count="4498"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>source-schema-version-number</meta-name>
        <meta-value>2.0</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>cover-date</meta-name>
        <meta-value>October 2021</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>details-of-publishers-convertor</meta-name>
        <meta-value>Converter:WILEY_ML3GV2_TO_JATSPMC version:6.0.8 mode:remove_FC converted:15.10.2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <p content-type="self-citation">
      <mixed-citation publication-type="journal" id="men13438-cit-1001"><string-name><surname>Theodoris</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Low</surname>, <given-names>T. M.</given-names></string-name>, <string-name><surname>Pavlidis</surname>, <given-names>P.</given-names></string-name>, &amp; <string-name><surname>Alachiotis</surname>, <given-names>N.</given-names></string-name>
<article-title>quickLD: An efficient software for linkage disequilibrium analyses</article-title>. <source>Mol Ecol Resour</source>. <year>2021</year>;<volume>21</volume>:<fpage>2580</fpage>–<lpage>2587</lpage>. <pub-id pub-id-type="doi">10.1111/1755-0998.13438</pub-id>
<pub-id pub-id-type="pmid">34062051</pub-id></mixed-citation>
    </p>
  </notes>
</front>
<body id="men13438-body-0001">
  <sec id="men13438-sec-0001">
    <label>1</label>
    <title>INTRODUCTION</title>
    <p>Linkage disequilibrium (LD) is the nonrandom association between alleles at different genetic variants (Slatkin, <xref rid="men13438-bib-0012" ref-type="bibr">2008</xref>). It is widely employed in evolutionary biology and human genomics to provide insights into the genome structure of populations and the action of recent and strong positive selection (selective sweeps). Due to recombination, LD is mostly expected at nearby genetic variants (Koch et al., <xref rid="men13438-bib-0007" ref-type="bibr">2013</xref>). Using large‐scale sequencing data, however, recent studies revealed that long‐range LD is prevalent in the human genome (Park, <xref rid="men13438-bib-0010" ref-type="bibr">2019</xref>), which can provide insights into evolutionary forces at work, such as population admixture, epistatic selection and genetic drift. Yet, limited efforts have been reported on assessing LD patterns between variants separated by a large genetic distance (Koch et al., <xref rid="men13438-bib-0007" ref-type="bibr">2013</xref>; Park, <xref rid="men13438-bib-0010" ref-type="bibr">2019</xref>).</p>
    <p>State‐of‐the‐art software tools for linkage analyses, such as PLINK (Chang et al., <xref rid="men13438-bib-0005" ref-type="bibr">2015</xref>) and PopGenome (Pfeifer et al., <xref rid="men13438-bib-0011" ref-type="bibr">2014</xref>), compute LD‐related summary statistics for all pairs of single nucleotide polymorphisms (SNPs) in one genomic region. This limitation restricts their applicability for long‐range LD studies, leading to prohibitively long execution times and the need for enormous memory resources when large genomic regions are analysed. Furthermore, these tools do not fully exploit the processing power of multicore CPUs or accelerators, for example GPUs. To this end, we build upon prior work (Alachiotis et al., <xref rid="men13438-bib-0002" ref-type="bibr">2016</xref>; Binder et al., <xref rid="men13438-bib-0004" ref-type="bibr">2019</xref>; Theodoris et al., <xref rid="men13438-bib-0013" ref-type="bibr">2020</xref>) to present quickLD, a stand‐alone software to efficiently compute a variety of LD statistics, such as D, D′ (Lewontin, <xref rid="men13438-bib-0008" ref-type="bibr">1964</xref>), and the commonly used <italic toggle="yes">r</italic>
<sup>2</sup> (VanLiere &amp; Rosenberg, <xref rid="men13438-bib-0016" ref-type="bibr">2008</xref>), for all SNP pairs in a single region or between arbitrarily distant genomic regions. Thus, in addition to long‐range LD, quickLD can also be used to study factors that affect linkage disequilibrium in populations, such as selection, recombination, genetic drift, inbreeding and gene flow. This work extends our previous work (Theodoris et al., <xref rid="men13438-bib-0013" ref-type="bibr">2020</xref>) by combining both CPUs and GPUs into a unified high‐performance framework, computing more LD‐related statistics than the prior framework and providing additional capabilities such as the automated generation of heatmaps.</p>
    <p>quickLD implements a sequence of data‐transformation steps that allow the computation of LD between distant genomic regions with minimal memory requirements, irrespective of their genetic distance. Furthermore, quickLD computes LD as a matrix–matrix multiplication, allowing the exploitation of high‐performance CPU/GPU implementations from dense linear algebra (DLA). To assess performance, we used various data sets with up to 100,000 sequences and up to 20,000 SNPs and compared processing times with PLINK (second‐generation) (Chang et al., <xref rid="men13438-bib-0005" ref-type="bibr">2015</xref>), which, to the best of our knowledge, is the current state‐of‐the‐art software for large‐scale genome association studies. We observed between 3.2× and 12.2× faster execution than PLINK1.9 with one CPU core and between 6.1× and 21.5× faster execution with four CPU cores on a personal laptop. For the same runs, the GPU‐accelerated version of quickLD run up to 49.5× faster than PLINK1.9. Both the CPU implementation and the GPU‐accelerated version achieve more than 95% of the processor's theoretical peak performance thanks to leveraging lessons learnt from high‐performance dense linear algebra to design efficient LD kernels for CPUs and GPUs.</p>
  </sec>
  <sec sec-type="materials-and-methods" id="men13438-sec-0002">
    <label>2</label>
    <title>MATERIALS AND METHODS</title>
    <sec id="men13438-sec-0003">
      <label>2.1</label>
      <title>Implementation</title>
      <p>quickLD is an open‐source C code for Linux environments. The CPU implementation is based on the de facto algorithm for high‐performance matrix–matrix multiplication on multicore CPU systems and utilizes the BLAS‐Like Instantiation Software (BLIS) (Van Zee &amp; Van De Geijn, <xref rid="men13438-bib-0015" ref-type="bibr">2015</xref>) for high‐performance DLA. The accelerated version extends the work in BLIS to computing LD on the GPU (Binder et al., <xref rid="men13438-bib-0004" ref-type="bibr">2019</xref>).</p>
    </sec>
    <sec id="men13438-sec-0004">
      <label>2.2</label>
      <title>Input/output</title>
      <p>A quickLD command specifies a list of variant call format (VCF) input files (compressed files are also supported) and a list of genomic region pairs to be combined (regions in different VCF files can be paired as well). Optionally, a list of samples to be included in the analysis can be provided, as well as the number of CPU cores and/or GPUs to be deployed. By default, quickLD calculates <italic toggle="yes">r</italic>
<sup>2</sup>, applying a cut‐off threshold of <mml:math id="jats-math-1"><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mtext>th</mml:mtext><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math> to reduce the output report size; the threshold value can be defined by the user. quickLD handles missing data using a probabilistic genotype imputation method that operates on a per SNP basis. A random seed can be used to estimate how much scatter this method introduces; the random seed can be defined by the user. Optional parameters can be used to schedule large‐scale calculations on personal computers with limited processing and memory resources. quickLD generates a report per region pair (PLINK format) that comprises all pairwise LD scores for all possible pairs of SNPs. The tool can also graphically display the results in the form of a heatmap.</p>
    </sec>
    <sec id="men13438-sec-0005">
      <label>2.3</label>
      <title>Computational workflow</title>
      <p>quickLD separates data accessing from processing to improve performance and reduce the overhead of accessing large input files. A large VCF file is initially split into smaller VCF files that can be easily managed and processed on personal computers. Thereafter, a number of genomic region pairs are loaded from the input list, based on the amount of available memory in the system. Each pair of regions corresponds to a processing task, and all loaded tasks are processed in parallel using a scheduling algorithm that distributes tasks to the CPU cores and/or GPUs. When all the loaded tasks have been completed, the process continues by loading the next set of genomic region pairs (tasks), using the previously allocated memory. The above steps are repeated until all the region pairs have been processed, with every new set of tasks using the same memory space. This allows large‐scale analyses to be conducted on off‐the‐shelf workstations since the memory requirements do not increase with the number of genomic regions pairs.</p>
    </sec>
    <sec id="men13438-sec-0006">
      <label>2.4</label>
      <title>Casting LD as a matrix–matrix multiplication</title>
      <p>The key idea behind quickLD is that LD can be computed as a matrix–matrix multiplication with only ones and zeros. This formulation of the LD computation allows us to leverage decades worth of knowledge in the high‐performance dense linear algebra domain to develop efficient LD implementations. This section provides a succinct summary of the underlying idea that was previously described for CPUs (Alachiotis et al., <xref rid="men13438-bib-0002" ref-type="bibr">2016</xref>) and GPUs (Binder et al., <xref rid="men13438-bib-0004" ref-type="bibr">2019</xref>).</p>
      <p>Each SNP is represented by a vector of ones and zeros. Multiple SNPs in a genomic region can then be described as a <italic toggle="yes">N</italic>
<sub>seq</sub> × <italic toggle="yes">k</italic> matrix, <italic toggle="yes">G</italic>, where <italic toggle="yes">N</italic>
<sub>seq</sub> is the sample size and <italic toggle="yes">k</italic> is the number of SNPs. Each row in the matrix represents the alleles of a sample while each column represents a single SNP. Exploiting the fact that values in the genomic matrix <italic toggle="yes">G</italic> consist of only ones and zeros, we can reduce the storage of <italic toggle="yes">G</italic> by using a single bit to represent an allele. This means that each SNP is represented by a group of <italic toggle="yes">N</italic>
<sub>int</sub> unsigned integers (64‐bit long each), with <italic toggle="yes">N</italic>
<sub>int</sub> defined as follows:
<disp-formula id="men13438-disp-0001"><label>(1)</label><mml:math id="jats-math-2" display="block"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mtext>int</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="⌉" open="⌈"><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mtext>seq</mml:mtext></mml:msub><mml:mn>64</mml:mn></mml:mfrac></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
      <p>An example of matrix <italic toggle="yes">G</italic> is illustrated in Figure <xref rid="men13438-fig-0001" ref-type="fig">1</xref>. We refer to <italic toggle="yes">G</italic> as the genomic matrix. In our formulation of <italic toggle="yes">G</italic>, we ensure that the allocated memory per SNP is a multiple of 64 bits by adding extra zeros to the end of each SNP, referred to as ‘padding’ in Figure <xref rid="men13438-fig-0001" ref-type="fig">1</xref>. Different genomic regions are differentiated via subscripts (e.g. <italic toggle="yes">G</italic>
<sub>1</sub> and <italic toggle="yes">G</italic>
<sub>2</sub>).</p>
      <fig position="float" fig-type="FIGURE" id="men13438-fig-0001">
        <label>FIGURE 1</label>
        <caption>
          <p>Example of the genomic matrix <italic toggle="yes">G</italic>. Each row represents a sample while each column describes a SNP. The allocated memory per SNP is a multiple of 64 bits. This is achieved through padding by adding extra zeros to the end of each SNP. Adapted from (Alachiotis &amp; Weisz, <xref rid="men13438-bib-0003" ref-type="bibr">2016</xref>)</p>
        </caption>
        <graphic xlink:href="MEN-21-2580-g006" position="anchor" id="jats-graphic-1"/>
      </fig>
      <p>The desired haplotype frequency matrix, <italic toggle="yes">H<sub>i</sub>
</italic>
<sub>,</sub>
<italic toggle="yes"><sub>j</sub></italic>, that is used to compute LD can be computed from the genomic matrices <italic toggle="yes">G<sub>i</sub>
</italic> and <italic toggle="yes">G<sub>j</sub>
</italic> as follows:
<disp-formula id="men13438-disp-0002"><label>(2)</label><mml:math id="jats-math-3" display="block"><mml:mrow><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mtext>seq</mml:mtext></mml:msub><mml:msubsup><mml:mi>G</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>G</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
      <p>Equation 2 computes the haplotype frequencies and stores them in matrix <italic toggle="yes">H</italic>. The above formulation of <italic toggle="yes">H</italic> is a specific form of the general matrix multiplication (GEMM) operation (<italic toggle="yes">C</italic> = <italic toggle="yes">αAB</italic> + <italic toggle="yes">βC</italic>) in the level 3 basic linear algebra subprograms (BLAS3), a widely used set of dense linear algebra routines. Here, <italic toggle="yes">α</italic> = 1/<italic toggle="yes">N</italic>
<sub>seq</sub> and <italic toggle="yes">β</italic> = 0. Using our formulation of the genomic matrix, one can substitute the dot product by counting the total number of ones (set bits) remaining after a pairwise logical AND (&amp;) operation is performed. This counting of set bits can be performed using the intrinsic POPCNT operation. Thus, the haplotype frequencies can be computed as follows:
<disp-formula id="men13438-disp-0003"><label>(3)</label><mml:math id="jats-math-4" display="block"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mtext>seq</mml:mtext></mml:msub></mml:mfrac><mml:mtext>POPCNT</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&amp;</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
      <p>Thereafter, we can compute matrix <italic toggle="yes">D</italic> that contains LD values by subtracting the product of the allele frequencies from <italic toggle="yes">H</italic> as shown in Equation <xref rid="men13438-disp-0004" ref-type="disp-formula">4</xref>:
<disp-formula id="men13438-disp-0004"><label>(4)</label><mml:math id="jats-math-5" display="block"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mi>H</mml:mi><mml:mo>‐</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mi>P</mml:mi><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></disp-formula>where <italic toggle="yes">P<sub>i</sub>
</italic> and <italic toggle="yes">Pj</italic> are vectors of per SNP alleles frequencies that are derived from the genomic matrices <italic toggle="yes">G<sub>i</sub>
</italic> and <italic toggle="yes">G<sub>j</sub>
</italic>, respectively.</p>
    </sec>
  </sec>
  <sec id="men13438-sec-0007">
    <label>3</label>
    <title>RESULTS AND DISCUSSION</title>
    <sec id="men13438-sec-0008">
      <label>3.1</label>
      <title>Experimental setup</title>
      <p>We employed a personal laptop with an Intel Core i5‐8300H processor with 4 cores running at 2.3 GHz (8GB of main memory) and an Nvidia GTX 1050‐M GPU with 640 Cuda cores running at 1.3 Ghz (4GB of main memory). To evaluate performance, we compare quickLD with PLINK 1.9 (Chang et al., <xref rid="men13438-bib-0005" ref-type="bibr">2015</xref>), the most widely used software for linkage analyses, to the best of our knowledge. We report performance in terms of execution times and throughput. Note that we do not provide a comparison of memory consumption between quickLD and PLINK1.9 because such a comparison would not be fair since these tools handle memory in a fundamentally different way: quickLD allocates the necessary amount of memory given the data to be processed and the degree of parallelism requested by the user. PLINK1.9 follows a system‐driven memory allocation approach that attempts to allocate half of the available memory of the system, and if this is not possible, then less memory is allocated, irrespective of the input data size. More information about the PLINK memory allocation scheme can be found at: <ext-link xlink:href="https://www.cog-genomics.org/plink/2.0/other" ext-link-type="uri">https://www.cog‐genomics.org/plink/2.0/other</ext-link>.</p>
    </sec>
    <sec id="men13438-sec-0009">
      <label>3.2</label>
      <title>Sequential execution</title>
      <p>quickLD and PLINK differ in the way they calculate pairwise LD scores. While PLINK processes one region (one input file) and computes a diagonal matrix with pairwise LD scores, quickLD switches between different variants of matrix–matrix multiplication for efficiency purposes, depending on whether LD is computed between two different regions or within a single region. When computing with multiple regions, quickLD casts the computation as a general matrix–matrix multiplication (gemm). For single‐region LD computations, quickLD switches to a symmetric rank‐k update (syrk) routine where only the upper (or lower) half of the matrix is computed. The observation here is that the output matrix is symmetric when computing LD on the same region. Switching to a different variant allows quickLD to avoid redundantly computing the same LD scores.</p>
      <p>We measured performance in terms of throughput for an increasing number of samples (Table <xref rid="men13438-tbl-0001" ref-type="table">1</xref>) and number of SNPs (Table <xref rid="men13438-tbl-0002" ref-type="table">2</xref>). We distinguish between processing one region and a region pair. As can be observed in the tables, quickLD is between 3.2× and 11.7× faster than PLINK1.9 when the sample sizes increase from 2500 sequences to 100,000 sequences and between 8.4× and 12.2× faster when the region size increases from 1000 SNPs to 10,000 SNPs. When quickLD deploys a GPU accelerator, it becomes between 7.1× and 51× faster than PLINK1.9 (which executes on the CPU) as the number of samples increases, and between 15.4× and 66.9× faster when the number of SNPs increases.</p>
      <table-wrap position="float" id="men13438-tbl-0001" content-type="TABLE">
        <label>TABLE 1</label>
        <caption>
          <p>Performance comparison (throughput and speedup) between quickLD (C denotes CPU execution; G denotes GPU execution) and PLINK for increasing number of samples when one region and a pair of regions are processed. The region size is 5000 SNPs. Processing one region entails the calculation of 12.5 × 10<sup>6</sup> LD scores, while processing a region pair leads to the calculation of 25 × 10<sup>6</sup> LD scores</p>
        </caption>
        <table frame="hsides" rules="groups">
          <col style="border-right:solid 1px #000000" span="1"/>
          <col style="border-right:solid 1px #000000" span="1"/>
          <col style="border-right:solid 1px #000000" span="1"/>
          <col style="border-right:solid 1px #000000" span="1"/>
          <col style="border-right:solid 1px #000000" span="1"/>
          <col style="border-right:solid 1px #000000" span="1"/>
          <col style="border-right:solid 1px #000000" span="1"/>
          <col style="border-right:solid 1px #000000" span="1"/>
          <thead valign="bottom">
            <tr style="border-bottom:solid 1px #000000">
              <th align="left" rowspan="3" valign="bottom" colspan="1">Samples (×10<sup>3</sup>)</th>
              <th align="left" colspan="5" style="border-bottom:solid 1px #000000" valign="bottom" rowspan="1">Single region</th>
              <th align="left" colspan="2" style="border-bottom:solid 1px #000000" valign="bottom" rowspan="1">Pair of regions</th>
            </tr>
            <tr style="border-bottom:solid 1px #000000">
              <th align="left" colspan="3" style="border-bottom:solid 1px #000000" valign="bottom" rowspan="1">Throughput (LD × 10<sup>6</sup>/s)</th>
              <th align="left" colspan="2" style="border-bottom:solid 1px #000000" valign="bottom" rowspan="1">Speedup (×) over PLINK 1.9</th>
              <th align="left" colspan="2" style="border-bottom:solid 1px #000000" valign="bottom" rowspan="1">Throughput (LD × 10<sup>6</sup>/s)</th>
            </tr>
            <tr style="border-bottom:solid 1px #000000">
              <th align="left" valign="bottom" rowspan="1" colspan="1">quickLD_C</th>
              <th align="left" valign="bottom" rowspan="1" colspan="1">quickLD_G</th>
              <th align="left" valign="bottom" rowspan="1" colspan="1">PLINK</th>
              <th align="left" valign="bottom" rowspan="1" colspan="1">quickLD_C</th>
              <th align="left" valign="bottom" rowspan="1" colspan="1">quickLD_G</th>
              <th align="left" valign="bottom" rowspan="1" colspan="1">quickLD_C</th>
              <th align="left" valign="bottom" rowspan="1" colspan="1">quickLD_G</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">2.5</td>
              <td align="char" char="." rowspan="1" colspan="1">16.53</td>
              <td align="char" char="." rowspan="1" colspan="1">36.55</td>
              <td align="char" char="." rowspan="1" colspan="1">5.14</td>
              <td align="char" char="." rowspan="1" colspan="1">3.21</td>
              <td align="char" char="." rowspan="1" colspan="1">7.11</td>
              <td align="char" char="." rowspan="1" colspan="1">36.76</td>
              <td align="char" char="." rowspan="1" colspan="1">73.10</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">10</td>
              <td align="char" char="." rowspan="1" colspan="1">11.44</td>
              <td align="char" char="." rowspan="1" colspan="1">27.96</td>
              <td align="char" char="." rowspan="1" colspan="1">1.36</td>
              <td align="char" char="." rowspan="1" colspan="1">8.44</td>
              <td align="char" char="." rowspan="1" colspan="1">20.63</td>
              <td align="char" char="." rowspan="1" colspan="1">14.34</td>
              <td align="char" char="." rowspan="1" colspan="1">55.93</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">20</td>
              <td align="char" char="." rowspan="1" colspan="1">6.60</td>
              <td align="char" char="." rowspan="1" colspan="1">21.48</td>
              <td align="char" char="." rowspan="1" colspan="1">0.69</td>
              <td align="char" char="." rowspan="1" colspan="1">9.61</td>
              <td align="char" char="." rowspan="1" colspan="1">31.25</td>
              <td align="char" char="." rowspan="1" colspan="1">10.35</td>
              <td align="char" char="." rowspan="1" colspan="1">42.96</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">30</td>
              <td align="char" char="." rowspan="1" colspan="1">4.87</td>
              <td align="char" char="." rowspan="1" colspan="1">17.58</td>
              <td align="char" char="." rowspan="1" colspan="1">0.46</td>
              <td align="char" char="." rowspan="1" colspan="1">10.48</td>
              <td align="char" char="." rowspan="1" colspan="1">37.88</td>
              <td align="char" char="." rowspan="1" colspan="1">5.53</td>
              <td align="char" char="." rowspan="1" colspan="1">35.16</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">40</td>
              <td align="char" char="." rowspan="1" colspan="1">3.79</td>
              <td align="char" char="." rowspan="1" colspan="1">14.76</td>
              <td align="char" char="." rowspan="1" colspan="1">0.35</td>
              <td align="char" char="." rowspan="1" colspan="1">10.75</td>
              <td align="char" char="." rowspan="1" colspan="1">41.88</td>
              <td align="char" char="." rowspan="1" colspan="1">4.23</td>
              <td align="char" char="." rowspan="1" colspan="1">29.52</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">50</td>
              <td align="char" char="." rowspan="1" colspan="1">3.06</td>
              <td align="char" char="." rowspan="1" colspan="1">13.51</td>
              <td align="char" char="." rowspan="1" colspan="1">0.28</td>
              <td align="char" char="." rowspan="1" colspan="1">10.87</td>
              <td align="char" char="." rowspan="1" colspan="1">48.00</td>
              <td align="char" char="." rowspan="1" colspan="1">3.39</td>
              <td align="char" char="." rowspan="1" colspan="1">27.03</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">60</td>
              <td align="char" char="." rowspan="1" colspan="1">2.60</td>
              <td align="char" char="." rowspan="1" colspan="1">11.19</td>
              <td align="char" char="." rowspan="1" colspan="1">0.23</td>
              <td align="char" char="." rowspan="1" colspan="1">11.11</td>
              <td align="char" char="." rowspan="1" colspan="1">47.79</td>
              <td align="char" char="." rowspan="1" colspan="1">2.86</td>
              <td align="char" char="." rowspan="1" colspan="1">22.38</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">70</td>
              <td align="char" char="." rowspan="1" colspan="1">2.26</td>
              <td align="char" char="." rowspan="1" colspan="1">8.80</td>
              <td align="char" char="." rowspan="1" colspan="1">0.20</td>
              <td align="char" char="." rowspan="1" colspan="1">11.43</td>
              <td align="char" char="." rowspan="1" colspan="1">44.48</td>
              <td align="char" char="." rowspan="1" colspan="1">2.46</td>
              <td align="char" char="." rowspan="1" colspan="1">17.59</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">80</td>
              <td align="char" char="." rowspan="1" colspan="1">1.98</td>
              <td align="char" char="." rowspan="1" colspan="1">8.08</td>
              <td align="char" char="." rowspan="1" colspan="1">0.17</td>
              <td align="char" char="." rowspan="1" colspan="1">11.56</td>
              <td align="char" char="." rowspan="1" colspan="1">47.22</td>
              <td align="char" char="." rowspan="1" colspan="1">2.17</td>
              <td align="char" char="." rowspan="1" colspan="1">16.16</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">90</td>
              <td align="char" char="." rowspan="1" colspan="1">1.75</td>
              <td align="char" char="." rowspan="1" colspan="1">7.49</td>
              <td align="char" char="." rowspan="1" colspan="1">0.15</td>
              <td align="char" char="." rowspan="1" colspan="1">11.57</td>
              <td align="char" char="." rowspan="1" colspan="1">49.44</td>
              <td align="char" char="." rowspan="1" colspan="1">1.92</td>
              <td align="char" char="." rowspan="1" colspan="1">14.99</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">100</td>
              <td align="char" char="." rowspan="1" colspan="1">1.61</td>
              <td align="char" char="." rowspan="1" colspan="1">7.01</td>
              <td align="char" char="." rowspan="1" colspan="1">0.14</td>
              <td align="char" char="." rowspan="1" colspan="1">11.69</td>
              <td align="char" char="." rowspan="1" colspan="1">51.06</td>
              <td align="char" char="." rowspan="1" colspan="1">1.74</td>
              <td align="char" char="." rowspan="1" colspan="1">14.03</td>
            </tr>
          </tbody>
        </table>
        <permissions>
          <copyright-holder>John Wiley &amp; Sons, Ltd</copyright-holder>
        </permissions>
      </table-wrap>
      <table-wrap position="float" id="men13438-tbl-0002" content-type="TABLE">
        <label>TABLE 2</label>
        <caption>
          <p>Performance comparison (throughput and speedup) between quickLD (_C denotes CPU execution, _G denotes GPU execution) and PLINK for increasingly larger regions in terms of SNPs size when a single SNP region and a pair of regions are processed. The sample size is 100,000 sequences</p>
        </caption>
        <table frame="hsides" rules="groups">
          <col style="border-right:solid 1px #000000" span="1"/>
          <col style="border-right:solid 1px #000000" span="1"/>
          <col style="border-right:solid 1px #000000" span="1"/>
          <col style="border-right:solid 1px #000000" span="1"/>
          <col style="border-right:solid 1px #000000" span="1"/>
          <col style="border-right:solid 1px #000000" span="1"/>
          <col style="border-right:solid 1px #000000" span="1"/>
          <col style="border-right:solid 1px #000000" span="1"/>
          <col style="border-right:solid 1px #000000" span="1"/>
          <col style="border-right:solid 1px #000000" span="1"/>
          <thead valign="bottom">
            <tr style="border-bottom:solid 1px #000000">
              <th align="left" rowspan="3" valign="bottom" colspan="1">SNPs (×10<sup>3</sup>)</th>
              <th align="left" colspan="6" style="border-bottom:solid 1px #000000" valign="bottom" rowspan="1">Single region</th>
              <th align="left" colspan="3" style="border-bottom:solid 1px #000000" valign="bottom" rowspan="1">Pair of regions</th>
            </tr>
            <tr style="border-bottom:solid 1px #000000">
              <th align="left" rowspan="2" valign="bottom" colspan="1">LD scores (×10<sup>6</sup>)</th>
              <th align="left" colspan="3" style="border-bottom:solid 1px #000000" valign="bottom" rowspan="1">Throughput (LD × 10<sup>6</sup>/s)</th>
              <th align="left" colspan="2" style="border-bottom:solid 1px #000000" valign="bottom" rowspan="1">Speedup (×) over PLINK</th>
              <th align="left" rowspan="2" valign="bottom" colspan="1">LD scores (×10<sup>3</sup>)</th>
              <th align="left" colspan="2" style="border-bottom:solid 1px #000000" valign="bottom" rowspan="1">Throughput (LD × 10<sup>6</sup>/s)</th>
            </tr>
            <tr style="border-bottom:solid 1px #000000">
              <th align="left" valign="bottom" rowspan="1" colspan="1">quickLD_C</th>
              <th align="left" valign="bottom" rowspan="1" colspan="1">quickLD_G</th>
              <th align="left" valign="bottom" rowspan="1" colspan="1">PLINK</th>
              <th align="left" valign="bottom" rowspan="1" colspan="1">quickLD_C</th>
              <th align="left" valign="bottom" rowspan="1" colspan="1">quickLD_G</th>
              <th align="left" valign="bottom" rowspan="1" colspan="1">quickLD_C</th>
              <th align="left" valign="bottom" rowspan="1" colspan="1">quickLD_G</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">1</td>
              <td align="char" char="." rowspan="1" colspan="1">0.50</td>
              <td align="char" char="." rowspan="1" colspan="1">1.14</td>
              <td align="char" char="." rowspan="1" colspan="1">2.07</td>
              <td align="char" char="." rowspan="1" colspan="1">0.14</td>
              <td align="char" char="." rowspan="1" colspan="1">8.45</td>
              <td align="char" char="." rowspan="1" colspan="1">15.35</td>
              <td align="char" char="." rowspan="1" colspan="1">1.00</td>
              <td align="char" char="." rowspan="1" colspan="1">1.43</td>
              <td align="char" char="." rowspan="1" colspan="1">4.15</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">2</td>
              <td align="char" char="." rowspan="1" colspan="1">2.00</td>
              <td align="char" char="." rowspan="1" colspan="1">1.39</td>
              <td align="char" char="." rowspan="1" colspan="1">3.68</td>
              <td align="char" char="." rowspan="1" colspan="1">0.14</td>
              <td align="char" char="." rowspan="1" colspan="1">9.97</td>
              <td align="char" char="." rowspan="1" colspan="1">26.29</td>
              <td align="char" char="." rowspan="1" colspan="1">4.00</td>
              <td align="char" char="." rowspan="1" colspan="1">1.60</td>
              <td align="char" char="." rowspan="1" colspan="1">7.35</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">3</td>
              <td align="char" char="." rowspan="1" colspan="1">4.50</td>
              <td align="char" char="." rowspan="1" colspan="1">1.51</td>
              <td align="char" char="." rowspan="1" colspan="1">4.96</td>
              <td align="char" char="." rowspan="1" colspan="1">0.14</td>
              <td align="char" char="." rowspan="1" colspan="1">11.04</td>
              <td align="char" char="." rowspan="1" colspan="1">36.27</td>
              <td align="char" char="." rowspan="1" colspan="1">9.00</td>
              <td align="char" char="." rowspan="1" colspan="1">1.67</td>
              <td align="char" char="." rowspan="1" colspan="1">9.92</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">4</td>
              <td align="char" char="." rowspan="1" colspan="1">8.00</td>
              <td align="char" char="." rowspan="1" colspan="1">1.56</td>
              <td align="char" char="." rowspan="1" colspan="1">6.32</td>
              <td align="char" char="." rowspan="1" colspan="1">0.14</td>
              <td align="char" char="." rowspan="1" colspan="1">11.13</td>
              <td align="char" char="." rowspan="1" colspan="1">44.98</td>
              <td align="char" char="." rowspan="1" colspan="1">16.00</td>
              <td align="char" char="." rowspan="1" colspan="1">1.70</td>
              <td align="char" char="." rowspan="1" colspan="1">12.64</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">5</td>
              <td align="char" char="." rowspan="1" colspan="1">12.50</td>
              <td align="char" char="." rowspan="1" colspan="1">1.59</td>
              <td align="char" char="." rowspan="1" colspan="1">7.12</td>
              <td align="char" char="." rowspan="1" colspan="1">0.14</td>
              <td align="char" char="." rowspan="1" colspan="1">11.59</td>
              <td align="char" char="." rowspan="1" colspan="1">51.71</td>
              <td align="char" char="." rowspan="1" colspan="1">25.00</td>
              <td align="char" char="." rowspan="1" colspan="1">1.73</td>
              <td align="char" char="." rowspan="1" colspan="1">14.24</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">6</td>
              <td align="char" char="." rowspan="1" colspan="1">18.00</td>
              <td align="char" char="." rowspan="1" colspan="1">1.62</td>
              <td align="char" char="." rowspan="1" colspan="1">7.95</td>
              <td align="char" char="." rowspan="1" colspan="1">0.14</td>
              <td align="char" char="." rowspan="1" colspan="1">11.57</td>
              <td align="char" char="." rowspan="1" colspan="1">56.81</td>
              <td align="char" char="." rowspan="1" colspan="1">36.00</td>
              <td align="char" char="." rowspan="1" colspan="1">1.75</td>
              <td align="char" char="." rowspan="1" colspan="1">15.89</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">7</td>
              <td align="char" char="." rowspan="1" colspan="1">24.50</td>
              <td align="char" char="." rowspan="1" colspan="1">1.64</td>
              <td align="char" char="." rowspan="1" colspan="1">8.44</td>
              <td align="char" char="." rowspan="1" colspan="1">0.14</td>
              <td align="char" char="." rowspan="1" colspan="1">11.86</td>
              <td align="char" char="." rowspan="1" colspan="1">60.91</td>
              <td align="char" char="." rowspan="1" colspan="1">49.00</td>
              <td align="char" char="." rowspan="1" colspan="1">1.76</td>
              <td align="char" char="." rowspan="1" colspan="1">16.88</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">8</td>
              <td align="char" char="." rowspan="1" colspan="1">32.00</td>
              <td align="char" char="." rowspan="1" colspan="1">1.67</td>
              <td align="char" char="." rowspan="1" colspan="1">8.97</td>
              <td align="char" char="." rowspan="1" colspan="1">0.14</td>
              <td align="char" char="." rowspan="1" colspan="1">12.01</td>
              <td align="char" char="." rowspan="1" colspan="1">64.52</td>
              <td align="char" char="." rowspan="1" colspan="1">64.00</td>
              <td align="char" char="." rowspan="1" colspan="1">1.77</td>
              <td align="char" char="." rowspan="1" colspan="1">17.95</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">9</td>
              <td align="char" char="." rowspan="1" colspan="1">40.50</td>
              <td align="char" char="." rowspan="1" colspan="1">1.68</td>
              <td align="char" char="." rowspan="1" colspan="1">8.60</td>
              <td align="char" char="." rowspan="1" colspan="1">0.14</td>
              <td align="char" char="." rowspan="1" colspan="1">12.05</td>
              <td align="char" char="." rowspan="1" colspan="1">61.55</td>
              <td align="char" char="." rowspan="1" colspan="1">81.00</td>
              <td align="char" char="." rowspan="1" colspan="1">1.77</td>
              <td align="char" char="." rowspan="1" colspan="1">17.19</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">10</td>
              <td align="char" char="." rowspan="1" colspan="1">50.00</td>
              <td align="char" char="." rowspan="1" colspan="1">1.69</td>
              <td align="char" char="." rowspan="1" colspan="1">9.25</td>
              <td align="char" char="." rowspan="1" colspan="1">0.14</td>
              <td align="char" char="." rowspan="1" colspan="1">12.19</td>
              <td align="char" char="." rowspan="1" colspan="1">66.91</td>
              <td align="char" char="." rowspan="1" colspan="1">100.00</td>
              <td align="char" char="." rowspan="1" colspan="1">1.77</td>
              <td align="char" char="." rowspan="1" colspan="1">18.51</td>
            </tr>
          </tbody>
        </table>
        <permissions>
          <copyright-holder>John Wiley &amp; Sons, Ltd</copyright-holder>
        </permissions>
      </table-wrap>
      <p>Figure <xref rid="men13438-fig-0002" ref-type="fig">2</xref> illustrates quickLD and PLINK1.9 execution times when the sample size increases up to 100,000 sequences (Figure <xref rid="men13438-fig-0002" ref-type="fig">2A</xref>), and when the number of SNPs increases up to 10 k for fixed sample sizes of 2,5 k (Figure <xref rid="men13438-fig-0002" ref-type="fig">2B</xref>), 10 k (Figure <xref rid="men13438-fig-0002" ref-type="fig">2C</xref>) and 100 k (Figure <xref rid="men13438-fig-0002" ref-type="fig">2D</xref>). Expectedly, execution times increase linearly with the number of samples and quadratically with the number of SNPs.</p>
      <fig position="float" fig-type="FIGURE" id="men13438-fig-0002">
        <label>FIGURE 2</label>
        <caption>
          <p>Execution times for increasing number of samples (top left) and increasing numbers of SNPs when the sample size is 2500 sequences (top right), 10,000 sequences and 100,000 sequences (bottom row)</p>
        </caption>
        <graphic xlink:href="MEN-21-2580-g004" position="anchor" id="jats-graphic-3"/>
      </fig>
    </sec>
    <sec id="men13438-sec-0010">
      <label>3.3</label>
      <title>Parallel execution</title>
      <p>To assess performance of the parallel execution of quickLD over PLINK1.9, we compare execution times and report speedups when data sets with 10,000 and 100,000 sequences, with an increasing number of SNPs (up to 10,000), are processed. The results illustrated in Figure <xref rid="men13438-fig-0003" ref-type="fig">3</xref> show speedups up to 21.4× for the parallel guickLD CPU execution and up to 49.5× when the GPU is deployed. When the aggregate CPU/GPU performance is used by quickLD, overall throughput performance improves by up to 35%.</p>
      <fig position="float" fig-type="FIGURE" id="men13438-fig-0003">
        <label>FIGURE 3</label>
        <caption>
          <p>Parallel performance comparison between quickLD and PLINK1.9 in terms of execution times for 10,000 samples (top left) and 100,000 samples (top right), as well as respective speedups (bottom row). ‘HETER’ refers to heterogeneous execution using both the CPU and the GPU. Note the logarithmic scale for the execution times</p>
        </caption>
        <graphic xlink:href="MEN-21-2580-g005" position="anchor" id="jats-graphic-5"/>
      </fig>
      <p>An important aspect of the parallel quickLD performance is the way it scales with the number of CPU cores. To assess this, we analysed 1000 arbitrarily sized, in terms of SNP size, region pairs, deploying up to 20 CPU cores/threads. For these runs, we employed a 20‐core Intel Xeon E5‐2660v3 processor running at 2.6 GHz (32 GB of main memory). The SNP size varied between 1000 and 10,000 SNPs. As can be observed in Figure <xref rid="men13438-fig-0004" ref-type="fig">4</xref>, quickLD speedups are nearly linear for up to 16 cores, achieving 16.8× faster execution when deploying all 20 CPU cores.</p>
      <fig position="float" fig-type="FIGURE" id="men13438-fig-0004">
        <label>FIGURE 4</label>
        <caption>
          <p>quickLD speedups for up to 20 CPU cores/threads when processing 1000 tasks (arbitrarily sized regions between 1000 and 10,000 SNPs) with 10,000 sequences (left) and 100,000 sequences (right)</p>
        </caption>
        <graphic xlink:href="MEN-21-2580-g002" position="anchor" id="jats-graphic-7"/>
      </fig>
    </sec>
    <sec id="men13438-sec-0011">
      <label>3.4</label>
      <title>Application on real data</title>
      <sec id="men13438-sec-0012">
        <label>3.4.1</label>
        <title>Human Chromosome 22</title>
        <p>Using a data set from the 1000 Genomes Project (<xref rid="men13438-bib-0001" ref-type="bibr">1000</xref> Genomes Project Consortium et al., <xref rid="men13438-bib-0001" ref-type="bibr">2015</xref>) (downloaded from <ext-link xlink:href="http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/release/20130502/" ext-link-type="uri">http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/release/20130502/</ext-link>), we tested the performance of quickLD against PLINK 1.9 in an arbitrarily chosen region of chromosome 22. There are 106,730 SNPs in the chosen region (bp positions from 16050075 to 20128290). The report threshold was set to 0.8, which reduced the report file size to 30 MB and allowed for a more accurate comparison of processing times. Using 4 CPU threads, PLINK 1.9 required 429 s, whereas quickLD, also using 4 CPU threads, finished in 69.72 s. When quickLD employed a GPU in addition to the 4 CPU threads, the execution time was reduced to 51.76 s. Note that in this case, 1 CPU thread is exclusively used for controlling the GPU, thus leaving 3 CPU threads available for processing.</p>
        <p>quickLD took 69.72, 91 and 51.76 s using 4 CPU threads, 1 GPU thread and the entire system (3 CPU threads, since one thread is dedicated to control the GPU, and the GPU), respectively. quickLD is effectively up to 8.3× faster than PLINK 1.9, using the entire system (heterogeneous CPU/GPU execution). Figure <xref rid="men13438-fig-0005" ref-type="fig">5</xref> illustrates a heatmap of a subregion of this data set, using the visualization capabilities of quickLD.</p>
        <fig position="float" fig-type="FIGURE" id="men13438-fig-0005">
          <label>FIGURE 5</label>
          <caption>
            <p>A quickLD‐generated heatmap of all pairwise LD scores for 10,000 SNPs in the region 16,050,075 bp–17,050,075 bp of human chromosome 22 (2504 samples, human genome assembly GRCh37). The depicted region contains LD scores in the range of 0.2 to 1</p>
          </caption>
          <graphic xlink:href="MEN-21-2580-g003" position="anchor" id="jats-graphic-9"/>
        </fig>
      </sec>
      <sec id="men13438-sec-0013">
        <label>3.4.2</label>
        <title>SARS‐CoV‐2 Genomes</title>
        <p>We employed 39,941 high‐coverage SARS‐CoV‐2 genomes from the GISAID database (<ext-link xlink:href="https://www.gisaid.org/" ext-link-type="uri">https://www.gisaid.org/</ext-link>). We used sequences with length equal or larger than 29,000 base pairs and trimmed ambiguous states (N) from the beginning and the end. We also excluded sequences that contained more than eight Ns and used the experimental MAFFT version (Katoh &amp; Standley, <xref rid="men13438-bib-0006" ref-type="bibr">2013</xref>) for closely related viral genomes for multiple sequence alignment (FASTA format). The resulting data set, after applying the aforementioned filters to discard sequences, comprised 22,554 genomes. The snp‐sites (Page et al., <xref rid="men13438-bib-0009" ref-type="bibr">2016</xref>) software was used for converting the FASTA file to a VCF file, and we invoked the tool's built‐in option to discard columns that did not contain A, C, G, T, exclusively. The resulting data set comprised 5730 variants. PLINK 1.9 executed in 12.8 s, while quickLD ran in 0.870, 0.630 and 0.475 s using 4 CPU threads, the GPU and the entire system (3 CPU threads and the GPU), respectively. The maximum speedup of quickLD over PLINK 1.9 was 26.8×, which was observed when the aggregate system performance of the multicore CPU and the GPU accelerator was exploited. Figure <xref rid="men13438-fig-0006" ref-type="fig">6</xref> illustrates the quickLD‐generated heatmap of the LD scores.</p>
        <fig position="float" fig-type="FIGURE" id="men13438-fig-0006">
          <label>FIGURE 6</label>
          <caption>
            <p>A quickLD‐generated heatmap of all pairwise LD scores for 5730 variants obtained from the analysis of 22,554 SARS‐CoV‐2 whole genomes. The depicted region contains LD scores in the range of 0.8 to 1</p>
          </caption>
          <graphic xlink:href="MEN-21-2580-g001" position="anchor" id="jats-graphic-11"/>
        </fig>
      </sec>
    </sec>
  </sec>
  <sec id="men13438-sec-0015">
    <title>AUTHOR CONTRIBUTIONS</title>
    <p>C.T. and N.A. designed the software; C.T. implemented the software; T.M.L. implemented the CPU/GPU kernels; P.P. tested the tool and analysed the real data; C.T., T.M.L. and N.A. wrote the manuscript.</p>
  </sec>
</body>
<back>
  <ack id="men13438-sec-0014">
    <title>ACKNOWLEDGEMENTS</title>
    <p>We would like to thank the anonymous reviewers and the editor for their comments that helped us to improve the clarity of this manuscript.</p>
  </ack>
  <sec sec-type="data-availability" id="men13438-sec-0017">
    <title>DATA AVAILABILITY STATEMENT</title>
    <p>The source code of quickLD, run scripts, execution instructions and user manual are available through the quickLD GitHub repository: [<ext-link xlink:href="https://github.com/pephco/quickLD" ext-link-type="uri" specific-use="software is-supplemented-by">https://github.com/pephco/quickLD</ext-link>]. The first release of quickLD is archived at: [<ext-link xlink:href="https://doi.org/10.6084/m9.figshare.14431268" ext-link-type="uri" specific-use="dataset is-supplemented-by">https://doi.org/10.6084/m9.figshare.14431268</ext-link>] (Theodoris et al., <xref rid="men13438-bib-0014" ref-type="bibr">2021</xref>).</p>
  </sec>
  <ref-list content-type="cited-references" id="men13438-bibl-0001">
    <title>REFERENCES</title>
    <ref id="men13438-bib-0001">
      <mixed-citation publication-type="journal" id="men13438-cit-0001"><collab collab-type="authors">1000 Genomes Project Consortium</collab>
, <string-name><surname>Auton</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Brooks</surname>, <given-names>L. D.</given-names></string-name>, <string-name><surname>Durbin</surname>, <given-names>R. M.</given-names></string-name>, <string-name><surname>Garrison</surname>, <given-names>E. P.</given-names></string-name>, <string-name><surname>Kang</surname>, <given-names>H. M.</given-names></string-name>, <string-name><surname>Korbel</surname>, <given-names>J. O.</given-names></string-name>, <string-name><surname>Marchini</surname>, <given-names>J. L.</given-names></string-name>, <string-name><surname>McCarthy</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>McVean</surname>, <given-names>G. A.</given-names></string-name>, &amp; <string-name><surname>Abecasis</surname>, <given-names>G. R.</given-names></string-name> (<year>2015</year>). <article-title>A global reference for human genetic variation</article-title>. <source>Nature</source>, <volume>526</volume>(<issue>7571</issue>), <fpage>68</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">26432245</pub-id></mixed-citation>
    </ref>
    <ref id="men13438-bib-0002">
      <mixed-citation publication-type="book" id="men13438-cit-0002"><string-name><surname>Alachiotis</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Popovici</surname>, <given-names>T.</given-names></string-name>, &amp; <string-name><surname>Low</surname>, <given-names>T. M.</given-names></string-name> (<year>2016</year>). <part-title>Efficient computation of linkage disequilibria as dense linear algebra operations</part-title>. In <source>2016 IEEE International Parallel and Distributed Processing Symposium Workshops (IPDPSW)</source> (pp. <fpage>418</fpage>–<lpage>427</lpage>). <publisher-name>IEEE</publisher-name>.</mixed-citation>
    </ref>
    <ref id="men13438-bib-0003">
      <mixed-citation publication-type="book" id="men13438-cit-0003"><string-name><surname>Alachiotis</surname>, <given-names>N.</given-names></string-name>, &amp; <string-name><surname>Weisz</surname>, <given-names>G.</given-names></string-name> (<year>2016</year>). <part-title>High performance linkage disequilibrium: FPGAs hold the key</part-title>. In <source>Proceedings of 2016 ACM/SIGDA International Symposium on Field‐Programmable Gate Arrays</source> (pp. <fpage>118</fpage>–<lpage>127</lpage>).</mixed-citation>
    </ref>
    <ref id="men13438-bib-0004">
      <mixed-citation publication-type="book" id="men13438-cit-0004"><string-name><surname>Binder</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Low</surname>, <given-names>T. M.</given-names></string-name>, &amp; <string-name><surname>Popovici</surname>, <given-names>D. T.</given-names></string-name> (<year>2019</year>). <part-title>A portable GPU framework for SNP comparisons</part-title>. In <source>2019 IEEE International Parallel and Distributed Processing Symposium Workshops (IPDPSW)</source> (pp. <fpage>199</fpage>–<lpage>208</lpage>). <publisher-name>IEEE</publisher-name>.</mixed-citation>
    </ref>
    <ref id="men13438-bib-0005">
      <mixed-citation publication-type="journal" id="men13438-cit-0005"><string-name><surname>Chang</surname>, <given-names>C. C.</given-names></string-name>, <string-name><surname>Chow</surname>, <given-names>C. C.</given-names></string-name>, <string-name><surname>Tellier</surname>, <given-names>L. C. A. M.</given-names></string-name>, <string-name><surname>Vattikuti</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Purcell</surname>, <given-names>S. M.</given-names></string-name>, &amp; <string-name><surname>Lee</surname>, <given-names>J. J.</given-names></string-name> (<year>2015</year>). <article-title>Second‐generation PLINK: Rising to the challenge of larger and richer datasets</article-title>. <source>Gigascience</source>, <volume>4</volume>(<issue>1</issue>), <elocation-id>s13742–015</elocation-id>.</mixed-citation>
    </ref>
    <ref id="men13438-bib-0006">
      <mixed-citation publication-type="journal" id="men13438-cit-0006"><string-name><surname>Katoh</surname>, <given-names>K.</given-names></string-name>, &amp; <string-name><surname>Standley</surname>, <given-names>D. M.</given-names></string-name> (<year>2013</year>). <article-title>MAFFT multiple sequence alignment software version 7: Improvements in performance and usability</article-title>. <source>Molecular Biology and Evolution</source>, <volume>30</volume>(<issue>4</issue>), <fpage>772</fpage>–<lpage>780</lpage>.<pub-id pub-id-type="pmid">23329690</pub-id></mixed-citation>
    </ref>
    <ref id="men13438-bib-0007">
      <mixed-citation publication-type="journal" id="men13438-cit-0007"><string-name><surname>Koch</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Ristroph</surname>, <given-names>M.</given-names></string-name>, &amp; <string-name><surname>Kirkpatrick</surname>, <given-names>M.</given-names></string-name> (<year>2013</year>). <article-title>Long range linkage disequilibrium across the human genome</article-title>. <source>PLoS One</source>, <volume>8</volume>(<issue>12</issue>), <elocation-id>e80754</elocation-id>.–<pub-id pub-id-type="doi">10.1371/journal.pone.0080754</pub-id>
<pub-id pub-id-type="pmid">24349013</pub-id></mixed-citation>
    </ref>
    <ref id="men13438-bib-0008">
      <mixed-citation publication-type="journal" id="men13438-cit-0008"><string-name><surname>Lewontin</surname>, <given-names>R. C.</given-names></string-name> (<year>1964</year>). <article-title>The interaction of selection and linkage. I. General considerations; heterotic models</article-title>. <source>Genetics</source>, <volume>49</volume>(<issue>1</issue>), <fpage>49</fpage>–<lpage>67</lpage>. <pub-id pub-id-type="doi">10.1093/genetics/49.1.49</pub-id>
<pub-id pub-id-type="pmid">17248194</pub-id></mixed-citation>
    </ref>
    <ref id="men13438-bib-0009">
      <mixed-citation publication-type="journal" id="men13438-cit-0009"><string-name><surname>Page</surname>, <given-names>A. J.</given-names></string-name>, <string-name><surname>Taylor</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Delaney</surname>, <given-names>A. J.</given-names></string-name>, <string-name><surname>Soares</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Seemann</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Keane</surname>, <given-names>J. A.</given-names></string-name>, &amp; <string-name><surname>Harris</surname>, <given-names>S. R.</given-names></string-name> (<year>2016</year>). <article-title>SNP‐sites: rapid efficient extraction of SNPs from multi‐FASTA alignments</article-title>. <source>Microbial Genomics</source>, <volume>2</volume>(<issue>4</issue>), <fpage>e000056</fpage>. <pub-id pub-id-type="doi">10.1099/mgen.0.000056</pub-id>
<pub-id pub-id-type="pmid">28348851</pub-id></mixed-citation>
    </ref>
    <ref id="men13438-bib-0010">
      <mixed-citation publication-type="journal" id="men13438-cit-0010"><string-name><surname>Park</surname>, <given-names>L.</given-names></string-name> (<year>2019</year>). <article-title>Population‐specific long‐range linkage disequilibrium in the human genome and its influence on identifying common disease variants</article-title>. <source>Scientific Reports</source>, <volume>9</volume>(<issue>1</issue>), <fpage>1</fpage>–<lpage>13</lpage>. <pub-id pub-id-type="doi">10.1038/s41598-019-47832-y</pub-id>
<pub-id pub-id-type="pmid">30626917</pub-id></mixed-citation>
    </ref>
    <ref id="men13438-bib-0011">
      <mixed-citation publication-type="journal" id="men13438-cit-0011"><string-name><surname>Pfeifer</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Wittelsbürger</surname>, <given-names>U.</given-names></string-name>, <string-name><surname>Ramos‐Onsins</surname>, <given-names>S. E.</given-names></string-name>, &amp; <string-name><surname>Lercher</surname>, <given-names>M. J.</given-names></string-name> (<year>2014</year>). <article-title>PopGenome: An efficient Swiss army knife for population genomic analyses in R</article-title>. <source>Molecular Biology and Evolution</source>, <volume>31</volume>(<issue>7</issue>), <fpage>1929</fpage>–<lpage>1936</lpage>.<pub-id pub-id-type="pmid">24739305</pub-id></mixed-citation>
    </ref>
    <ref id="men13438-bib-0012">
      <mixed-citation publication-type="journal" id="men13438-cit-0012"><string-name><surname>Slatkin</surname>, <given-names>M.</given-names></string-name> (<year>2008</year>). <article-title>Linkage disequilibrium—Understanding the evolutionary past and mapping the medical future</article-title>. <source>Nature Reviews Genetics</source>, <volume>9</volume>(<issue>6</issue>), <fpage>477</fpage>–<lpage>485</lpage>. <pub-id pub-id-type="doi">10.1038/nrg2361</pub-id>
</mixed-citation>
    </ref>
    <ref id="men13438-bib-0013">
      <mixed-citation publication-type="book" id="men13438-cit-0013"><string-name><surname>Theodoris</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Alachiotis</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Low</surname>, <given-names>T. M.</given-names></string-name>, &amp; <string-name><surname>Pavlidis</surname>, <given-names>P.</given-names></string-name> (<year>2020</year>). <part-title>qLd: High‐performance computation of linkage disequilibrium on cpu and gpu</part-title>. In <source>2020 IEEE 20th International Conference on Bioinformatics and Bioengineering (BIBE)</source> (pp. <fpage>65</fpage>–<lpage>72</lpage>). <publisher-name>IEEE</publisher-name>.</mixed-citation>
    </ref>
    <ref id="men13438-bib-0014">
      <mixed-citation publication-type="book" id="men13438-cit-0014"><string-name><surname>Theodoris</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Low</surname>, <given-names>T. M.</given-names></string-name>, <string-name><surname>Pavlidis</surname>, <given-names>P.</given-names></string-name>, &amp; <string-name><surname>Alachiotis</surname>, <given-names>N.</given-names></string-name> (<year>2021</year>). <source>quickLD: An efficient software for linkage disequilibrium analyses</source>. figshare, Software. <pub-id pub-id-type="doi">10.6084/m9.figshare.14431268</pub-id>
</mixed-citation>
    </ref>
    <ref id="men13438-bib-0015">
      <mixed-citation publication-type="journal" id="men13438-cit-0015"><string-name><surname>Van Zee</surname>, <given-names>F. G.</given-names></string-name>, &amp; <string-name><surname>Van De Geijn</surname>, <given-names>R. A.</given-names></string-name> (<year>2015</year>). <article-title>BLIS: A framework for rapidly instantiating BLAS functionality</article-title>. <source>ACM Transactions on Mathematical Software (TOMS)</source>, <volume>41</volume>(<issue>3</issue>), <fpage>1</fpage>–<lpage>33</lpage>.</mixed-citation>
    </ref>
    <ref id="men13438-bib-0016">
      <mixed-citation publication-type="journal" id="men13438-cit-0016"><string-name><surname>VanLiere</surname>, <given-names>J. M.</given-names></string-name>, &amp; <string-name><surname>Rosenberg</surname>, <given-names>N. A.</given-names></string-name> (<year>2008</year>). <article-title>Mathematical properties of the r2 measure of linkage disequilibrium</article-title>. <source>Theoretical Population Biology</source>, <volume>74</volume>(<issue>1</issue>), <fpage>130</fpage>–<lpage>137</lpage>.<pub-id pub-id-type="pmid">18572214</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
