<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">1885839</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-8-S1-S10</article-id>
    <article-id pub-id-type="pmid">17430554</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-8-S1-S10</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Significance analysis of microarray transcript levels in time series experiments</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" contrib-type="author">
        <name>
          <surname>Di Camillo</surname>
          <given-names>Barbara</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>dicamill@dei.unipd.it</email>
      </contrib>
      <contrib id="A2" contrib-type="author">
        <name>
          <surname>Toffolo</surname>
          <given-names>Gianna</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>toffolo@dei.unipd.it</email>
      </contrib>
      <contrib id="A3" contrib-type="author">
        <name>
          <surname>Nair</surname>
          <given-names>Sreekumaran K</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>nair@mayo.edu</email>
      </contrib>
      <contrib id="A4" contrib-type="author">
        <name>
          <surname>Greenlund</surname>
          <given-names>Laura J</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>greenlund.laura@mayo.edu</email>
      </contrib>
      <contrib id="A5" corresp="yes" contrib-type="author">
        <name>
          <surname>Cobelli</surname>
          <given-names>Claudio</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>cobelli@dei.unipd.it</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Information Engineering Department, University of Padova, 35131 Padova, Italy</aff>
    <aff id="I2"><label>2</label>Endocrinology Division, Mayo Clinic, Rochester, Minnesota 55905, USA</aff>
    <pub-date pub-type="collection">
      <year>2007</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>3</month>
      <year>2007</year>
    </pub-date>
    <volume>8</volume>
    <issue>Suppl 1</issue>
    <supplement>
      <named-content content-type="supplement-title">Italian Society of Bioinformatics (BITS): Annual Meeting 2006</named-content>
      <named-content content-type="supplement-editor">Rita Casadio, Manuela Helmer-Citterich, Graziano Pesole</named-content>
    </supplement>
    <fpage>S10</fpage>
    <lpage>S10</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/8/S1/S10"/>
    <permissions>
      <copyright-statement>Copyright © 2007 Di Camillo et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2007</copyright-year>
      <copyright-holder>Di Camillo et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an open access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Di Camillo
               Barbara
               
               dicamill@dei.unipd.it
            </dc:author><dc:title>
            Significance analysis of microarray transcript levels in time series experiments
         </dc:title><dc:date>2007</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 8(Suppl 1): S10-. (2007)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2007)8:Suppl 1&#x0003c;S10&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Microarray time series studies are essential to understand the dynamics of molecular events. In order to limit the analysis to those genes that change expression over time, a first necessary step is to select differentially expressed transcripts. A variety of methods have been proposed to this purpose; however, these methods are seldom applicable in practice since they require a large number of replicates, often available only for a limited number of samples. In this data-poor context, we evaluate the performance of three selection methods, using synthetic data, over a range of experimental conditions. Application to real data is also discussed.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>Three methods are considered, to assess differentially expressed genes in data-poor conditions. Method 1 uses a threshold on individual samples based on a model of the experimental error. Method 2 calculates the area of the region bounded by the time series expression profiles, and considers the gene differentially expressed if the area exceeds a threshold based on a model of the experimental error. These two methods are compared to Method 3, recently proposed in the literature, which exploits splines fit to compare time series profiles. Application of the three methods to synthetic data indicates that Method 2 outperforms the other two both in Precision and Recall when short time series are analyzed, while Method 3 outperforms the other two for long time series.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>These results help to address the choice of the algorithm to be used in data-poor time series expression study, depending on the length of the time series.</p>
      </sec>
    </abstract>
    <conference>
      <conf-date>28–29 April 2006</conf-date>
      <conf-name>Italian Society of Bioinformatics (BITS): Annual Meeting 2006</conf-name>
      <conf-loc>Bologna, Italy</conf-loc>
    </conference>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>A crucial issue in genomic studies is the elucidation of how genes change expression and interact as a consequence of external/internal stimuli such as an illness, drug administration, hormone stimuli, etc. Microarray technology makes it possible to monitor simultaneously a large number of gene transcripts through a series of different experimental conditions. In particular, microarray time series studies are essential to understand the dynamics of biological events at the molecular level.</p>
    <p>A first necessary step in order to limit the analysis to those genes that change expression over time is to select differentially expressed transcripts. Selection methods proposed in the literature usually deal with the comparison of static (e.g. no treatment vs treatment) rather than dynamic conditions, and are based on statistical tests [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>]. These methods test the significance of the differential expression gene by gene. At least two replicates for each of the conditions to be tested are necessary, but a higher number is required to have reliable results. In time series experiments, in which gene expression is monitored over time, it is necessary to test differential expression at different sampling times. ANOVA or ANOVA based procedures [<xref ref-type="bibr" rid="B3">3</xref>] have been proposed to this purpose. However, since in time series experiments replicates are often available only for a limited number of samples, ANOVA tests are seldom applicable. For this reason, differentially expressed genes in time series experiments are often selected using an empirical constant fold change threshold [<xref ref-type="bibr" rid="B4">4</xref>]. This is far from ideal, since it is based on an arbitrary choice (e.g. FC = 3), which does not take into account the characteristics of the measurement error.</p>
    <p>When the number of the replicates is not sufficient to apply traditional statistical tests, alternative methods need to be applied. Two methods based on a fit of the time series were recently proposed in the literature [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B6">6</xref>]. These methods fit the time series expression profiles using respectively polynomials and splines. Comparison between time series is based respectively on model parameters and goodness of fit. Both methods are really general and do not require any replicates; however, it is not clear the role of the number of available samples on their performance.</p>
    <p>Here we propose Methods 1 and 2 able to select differentially expressed gene profiles in data-poor conditions, based on a model of the experimental error. Their performance is investigated in comparison to method [<xref ref-type="bibr" rid="B6">6</xref>] (Method 3 in the following), based on splines fit, using synthetic time series of different length. Finally, a case study on insulin treated muscle cells is presented to better appreciate the implementation aspects of Methods 1 and 2.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Selection strategy</title>
      <p>Let's call x<sup>T</sup>(t<sub>k</sub>) and x<sup>C</sup>(t<sub>k</sub>) the log-expression measurements in treated (T) and control (C) cultures, available for a generic gene X at time sample t<sub>k </sub>(k = 1, ..., M, with M number of time samples). Log expression measurement are used, as in [<xref ref-type="bibr" rid="B7">7</xref>], because the signal is considered proportional to the log of the measurements, the error is considered log-additive, and the large range of expression intensities makes the log-expression practical.</p>
      <p>The rationale adopted to label a gene X as differentially expressed in condition T vs C is described in details for methods 1 and 2 and is briefly reviewed for Method 3, since we refer to [<xref ref-type="bibr" rid="B6">6</xref>] for further details.</p>
      <sec>
        <title>Method 1</title>
        <p>The deviation of expression of gene X in T and C is calculated for each sample t<sub>k </sub>as:</p>
        <p>d(t<sub>k</sub>) = x<sup>T</sup>(t<sub>k</sub>) - x<sup>C</sup>(t<sub>k</sub>)     (1)</p>
        <p>The gene is considered differentially expressed in T vs C if |d(t<sub>k</sub>)| exceeds a threshold <italic>θ</italic><sub>d </sub>in at least one sampling time t<sub>k </sub>(k = 1, ..., M):</p>
        <p>|d(t<sub>k</sub>)| &gt;<italic>θ</italic><sub>d </sub>    (2)</p>
        <p>where <italic>θ</italic><sub>d </sub>is determined in correspondence to a significance level <italic>α</italic>, based on the null hypothesis distribution of d(t<sub>k</sub>). This distribution is modeled from d(t<sub>k</sub>) values calculated by Equation 1, with x<sup>T</sup>(t<sub>k</sub>) and x<sup>C</sup>(t<sub>k</sub>) measured on experimental replicates (see below), which provide a situation where genes are not differentially expressed, so that the null hypothesis is verified. Therefore, replicates of at least one time sample are necessary, to apply Method 1.</p>
      </sec>
      <sec>
        <title>Method 2</title>
        <p>The area A bounded by the two expression profiles T and C (Figure <xref ref-type="fig" rid="F1">1</xref>) is calculated for each gene X as the sum of the contributions of partial areas from consecutive pairs of samples:</p>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-8-S1-S10-i1" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:mtext>A</mml:mtext>
                  <mml:mo>=</mml:mo>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mtext>k</mml:mtext>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>M</mml:mtext>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:munderover>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mtext>A</mml:mtext>
                        <mml:mtext>k</mml:mtext>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mstyle>
                  <mml:mtext>     </mml:mtext>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mn>3</mml:mn>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqqGbbqqcqGH9aqpdaaeWbqaaiabbgeabnaaBaaaleaacqqGRbWAaeqaaaqaaiabbUgaRjabg2da9iabigdaXaqaaiabb2eanjabgkHiTiabigdaXaqdcqGHris5aOGaaCzcaiaaxMaadaqadaqaaiabiodaZaGaayjkaiaawMcaaaaa@3DA0@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>Each contribution A<sub>k </sub>is calculated from the deviation of expression in T and C (Equation 1), as:</p>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1471-2105-8-S1-S10-i2" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:mtable columnalign="left">
                    <mml:mtr columnalign="left">
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mtext>IF  sign</mml:mtext>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mtext>d</mml:mtext>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:msub>
                            <mml:mtext>t</mml:mtext>
                            <mml:mrow>
                              <mml:mtext>k</mml:mtext>
                              <mml:mo>+</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo>=</mml:mo>
                          <mml:mtext>sign</mml:mtext>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mtext>d</mml:mtext>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:msub>
                            <mml:mtext>t</mml:mtext>
                            <mml:mtext>k</mml:mtext>
                          </mml:msub>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr columnalign="left">
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mtext>THEN  A</mml:mtext>
                            </mml:mrow>
                            <mml:mtext>k</mml:mtext>
                          </mml:msub>
                          <mml:mo>=</mml:mo>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mtext>d</mml:mtext>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:msub>
                                <mml:mtext>t</mml:mtext>
                                <mml:mrow>
                                  <mml:mtext>k</mml:mtext>
                                  <mml:mo>+</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo stretchy="false">)</mml:mo>
                              <mml:mo>+</mml:mo>
                              <mml:mtext>d</mml:mtext>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:msub>
                                <mml:mtext>t</mml:mtext>
                                <mml:mtext>k</mml:mtext>
                              </mml:msub>
                              <mml:mo stretchy="false">)</mml:mo>
                              <mml:mo stretchy="false">)</mml:mo>
                              <mml:mo>⋅</mml:mo>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:msub>
                                <mml:mtext>t</mml:mtext>
                                <mml:mrow>
                                  <mml:mtext>k</mml:mtext>
                                  <mml:mo>+</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>−</mml:mo>
                              <mml:msub>
                                <mml:mtext>t</mml:mtext>
                                <mml:mtext>k</mml:mtext>
                              </mml:msub>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mfrac>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr columnalign="left">
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mtext>ELSE  A</mml:mtext>
                            </mml:mrow>
                            <mml:mtext>k</mml:mtext>
                          </mml:msub>
                          <mml:mo>=</mml:mo>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mo>(</mml:mo>
                                <mml:mrow>
                                  <mml:mtext>d</mml:mtext>
                                  <mml:mo stretchy="false">(</mml:mo>
                                  <mml:msub>
                                    <mml:mtext>t</mml:mtext>
                                    <mml:mrow>
                                      <mml:mtext>k</mml:mtext>
                                      <mml:mo>+</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mo stretchy="false">)</mml:mo>
                                  <mml:mo>⋅</mml:mo>
                                  <mml:mfrac>
                                    <mml:mrow>
                                      <mml:mtext>d</mml:mtext>
                                      <mml:mo stretchy="false">(</mml:mo>
                                      <mml:msub>
                                        <mml:mtext>t</mml:mtext>
                                        <mml:mrow>
                                          <mml:mtext>k</mml:mtext>
                                          <mml:mo>+</mml:mo>
                                          <mml:mn>1</mml:mn>
                                        </mml:mrow>
                                      </mml:msub>
                                      <mml:mo stretchy="false">)</mml:mo>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mtext>d</mml:mtext>
                                      <mml:mo stretchy="false">(</mml:mo>
                                      <mml:msub>
                                        <mml:mtext>t</mml:mtext>
                                        <mml:mrow>
                                          <mml:mtext>k</mml:mtext>
                                          <mml:mo>+</mml:mo>
                                          <mml:mn>1</mml:mn>
                                        </mml:mrow>
                                      </mml:msub>
                                      <mml:mo stretchy="false">)</mml:mo>
                                      <mml:mo>+</mml:mo>
                                      <mml:mtext>d</mml:mtext>
                                      <mml:mo stretchy="false">(</mml:mo>
                                      <mml:msub>
                                        <mml:mtext>t</mml:mtext>
                                        <mml:mtext>k</mml:mtext>
                                      </mml:msub>
                                      <mml:mo stretchy="false">)</mml:mo>
                                    </mml:mrow>
                                  </mml:mfrac>
                                  <mml:mo>+</mml:mo>
                                  <mml:mtext>d</mml:mtext>
                                  <mml:mo stretchy="false">(</mml:mo>
                                  <mml:msub>
                                    <mml:mtext>t</mml:mtext>
                                    <mml:mtext>k</mml:mtext>
                                  </mml:msub>
                                  <mml:mo stretchy="false">)</mml:mo>
                                  <mml:mo>⋅</mml:mo>
                                  <mml:mfrac>
                                    <mml:mrow>
                                      <mml:mtext>d</mml:mtext>
                                      <mml:mo stretchy="false">(</mml:mo>
                                      <mml:msub>
                                        <mml:mtext>t</mml:mtext>
                                        <mml:mtext>k</mml:mtext>
                                      </mml:msub>
                                      <mml:mo stretchy="false">)</mml:mo>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mtext>d</mml:mtext>
                                      <mml:mo stretchy="false">(</mml:mo>
                                      <mml:msub>
                                        <mml:mtext>t</mml:mtext>
                                        <mml:mrow>
                                          <mml:mtext>k</mml:mtext>
                                          <mml:mo>+</mml:mo>
                                          <mml:mn>1</mml:mn>
                                        </mml:mrow>
                                      </mml:msub>
                                      <mml:mo stretchy="false">)</mml:mo>
                                      <mml:mo>+</mml:mo>
                                      <mml:mtext>d</mml:mtext>
                                      <mml:mo stretchy="false">(</mml:mo>
                                      <mml:msub>
                                        <mml:mtext>t</mml:mtext>
                                        <mml:mtext>k</mml:mtext>
                                      </mml:msub>
                                      <mml:mo stretchy="false">)</mml:mo>
                                    </mml:mrow>
                                  </mml:mfrac>
                                </mml:mrow>
                                <mml:mo>)</mml:mo>
                              </mml:mrow>
                              <mml:mo>⋅</mml:mo>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:msub>
                                <mml:mtext>t</mml:mtext>
                                <mml:mrow>
                                  <mml:mtext>k</mml:mtext>
                                  <mml:mo>+</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>−</mml:mo>
                              <mml:msub>
                                <mml:mtext>t</mml:mtext>
                                <mml:mtext>k</mml:mtext>
                              </mml:msub>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mfrac>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                  <mml:mtext>     </mml:mtext>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mn>4</mml:mn>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaafaqaaeWabaaabaGaeeysaKKaeeOrayKaeeiiaaIaeeiiaaIaee4CamNaeeyAaKMaee4zaCMaeeOBa4MaeiikaGIaeeizaqMaeiikaGIaeeiDaq3aaSbaaSqaaiabbUgaRjabgUcaRiabigdaXaqabaGccqGGPaqkcqGGPaqkcqGH9aqpcqqGZbWCcqqGPbqAcqqGNbWzcqqGUbGBcqGGOaakcqqGKbazcqGGOaakcqqG0baDdaWgaaWcbaGaee4AaSgabeaakiabcMcaPiabcMcaPaqaaiabbsfaujabbIeaijabbweafjabb6eaojabbccaGiabbccaGiabbgeabnaaBaaaleaacqqGRbWAaeqaaOGaeyypa0ZaaSaaaeaacqGGOaakcqqGKbazcqGGOaakcqqG0baDdaWgaaWcbaGaee4AaSMaey4kaSIaeGymaedabeaakiabcMcaPiabgUcaRiabbsgaKjabcIcaOiabbsha0naaBaaaleaacqqGRbWAaeqaaOGaeiykaKIaeiykaKIaeyyXICTaeiikaGIaeeiDaq3aaSbaaSqaaiabbUgaRjabgUcaRiabigdaXaqabaGccqGHsislcqqG0baDdaWgaaWcbaGaee4AaSgabeaakiabcMcaPaqaaiabikdaYaaaaeaacqqGfbqrcqqGmbatcqqGtbWucqqGfbqrcqqGGaaicqqGGaaicqqGbbqqdaWgaaWcbaGaee4AaSgabeaakiabg2da9maalaaabaWaaeWaaeaacqqGKbazcqGGOaakcqqG0baDdaWgaaWcbaGaee4AaSMaey4kaSIaeGymaedabeaakiabcMcaPiabgwSixpaalaaabaGaeeizaqMaeiikaGIaeeiDaq3aaSbaaSqaaiabbUgaRjabgUcaRiabigdaXaqabaGccqGGPaqkaeaacqqGKbazcqGGOaakcqqG0baDdaWgaaWcbaGaee4AaSMaey4kaSIaeGymaedabeaakiabcMcaPiabgUcaRiabbsgaKjabcIcaOiabbsha0naaBaaaleaacqqGRbWAaeqaaOGaeiykaKcaaiabgUcaRiabbsgaKjabcIcaOiabbsha0naaBaaaleaacqqGRbWAaeqaaOGaeiykaKIaeyyXIC9aaSaaaeaacqqGKbazcqGGOaakcqqG0baDdaWgaaWcbaGaee4AaSgabeaakiabcMcaPaqaaiabbsgaKjabcIcaOiabbsha0naaBaaaleaacqqGRbWAcqGHRaWkcqaIXaqmaeqaaOGaeiykaKIaey4kaSIaeeizaqMaeiikaGIaeeiDaq3aaSbaaSqaaiabbUgaRbqabaGccqGGPaqkaaaacaGLOaGaayzkaaGaeyyXICTaeiikaGIaeeiDaq3aaSbaaSqaaiabbUgaRjabgUcaRiabigdaXaqabaGccqGHsislcqqG0baDdaWgaaWcbaGaee4AaSgabeaakiabcMcaPaqaaiabikdaYaaaaaGaaCzcaiaaxMaadaqadaqaaiabisda0aGaayjkaiaawMcaaaaa@D0EE@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>The gene X is considered differentially expressed in T vs C if the following inequality holds:</p>
        <p>A &gt;<italic>θ</italic><sub>A </sub>    (5)</p>
        <p>where <italic>θ</italic><sub>A </sub>is a threshold to be determined, in correspondence to a significance level <italic>α</italic>, based on the null hypothesis distribution of A, i.e. the distribution of A derived from experimental replicates (see below for its calculation).</p>
      </sec>
      <sec>
        <title>Method 3</title>
        <p>For each gene X, the expression profiles C and T are fitted using natural cubic splines. The null hypothesis is that both C and T time series share the same fit, the alternative hypothesis is that the fits are not equal. As a first step of the method, the same spline function is fitted simultaneously to the two profiles C and T and the sum of squares residuals SS<sup>0 </sup>is calculated; then two different spline functions are fitted separately to time series C and T and the sum of squares residuals SS<sup>1 </sup>is computed. To assess differentially expressed genes, the goodness of model fit under the null hypothesis is compared to that under the alternative hypothesis, by calculating a statistic F as:</p>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1471-2105-8-S1-S10-i3" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:mtext>F</mml:mtext>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mtext>SS</mml:mtext>
                        </mml:mrow>
                        <mml:mn>0</mml:mn>
                      </mml:msup>
                      <mml:mo>−</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mtext>SS</mml:mtext>
                        </mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:msup>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mtext>SS</mml:mtext>
                        </mml:mrow>
                        <mml:mn>0</mml:mn>
                      </mml:msup>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mtext>     </mml:mtext>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mn>6</mml:mn>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqqGgbGrcqGH9aqpdaWcaaqaaiabbofatjabbofatnaaCaaaleqabaGaeGimaadaaOGaeyOeI0Iaee4uamLaee4uam1aaWbaaSqabeaacqaIXaqmaaaakeaacqqGtbWucqqGtbWudaahaaWcbeqaaiabicdaWaaaaaGccaWLjaGaaCzcamaabmaabaGaeGOnaydacaGLOaGaayzkaaaaaa@3E08@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>Gene X is considered differentially expressed if the following inequality holds:</p>
        <p>F &gt;<italic>θ</italic><sub>F </sub>    (7)</p>
        <p>where <italic>θ</italic><sub>F </sub>is a threshold to be determined, in correspondence to a significance level <italic>α</italic>, based on the null hypothesis distribution of F.</p>
      </sec>
    </sec>
    <sec>
      <title>Null hypothesis distribution model</title>
      <p>Both Methods 1 and 2 are based on a threshold derived from the null hypothesis distribution of d(t<sub>k</sub>) and A, respectively, obtained using available replicates. We denote as "available replicates" replicates available for a subset of time samples (therefore we assume replicates available for at least one time sample).</p>
      <p>Let's suppose two experimental replicates are available for a generic time t<sub>k </sub>and a generic experimental condition (T or C). By assuming a log-additive error model as in [<xref ref-type="bibr" rid="B7">7</xref>], the log-expression measurement of each gene X in replicates a and b, can be expressed as:</p>
      <p>
        <inline-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1471-2105-8-S1-S10-i4" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mrow>
                <mml:mrow>
                  <mml:mo>{</mml:mo>
                  <mml:mrow>
                    <mml:mtable>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mtext>x</mml:mtext>
                              <mml:mtext>a</mml:mtext>
                            </mml:msub>
                            <mml:mo>=</mml:mo>
                            <mml:mi>μ</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:msub>
                              <mml:mi>ε</mml:mi>
                              <mml:mtext>a</mml:mtext>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mtext>x</mml:mtext>
                              <mml:mtext>b</mml:mtext>
                            </mml:msub>
                            <mml:mo>=</mml:mo>
                            <mml:mi>μ</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:msub>
                              <mml:mi>ε</mml:mi>
                              <mml:mtext>b</mml:mtext>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                  </mml:mrow>
                </mml:mrow>
                <mml:mtext>     </mml:mtext>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mn>8</mml:mn>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:mrow>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaGabeqaauaabeqaceaaaeaacqqG4baEdaWgaaWcbaGaeeyyaegabeaakiabg2da9GGaciab=X7aTjabgUcaRiab=v7aLnaaBaaaleaacqqGHbqyaeqaaaGcbaGaeeiEaG3aaSbaaSqaaiabbkgaIbqabaGccqGH9aqpcqWF8oqBcqGHRaWkcqWF1oqzdaWgaaWcbaGaeeOyaigabeaaaaaakiaawUhaaiaaxMaacaWLjaWaaeWaaeaacqaI4aaoaiaawIcacaGLPaaaaaa@450F@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </inline-formula>
      </p>
      <p>where <italic>μ </italic>represents the actual gene expression (unknown) and <italic>ε</italic><sub>a</sub>, <italic>ε</italic><sub>b </sub>are two realizations of the error variable <italic>ε</italic>, monitoring both technical and biological variability. The indices for condition and time t<sub>k </sub>are omitted here because we refer to pair of replicates available for a generic time sample t<sub>k</sub>.</p>
      <sec>
        <title>Null hypothesis distribution of variable d</title>
        <p>To quantify the deviation of expression d(t<sub>k</sub>) under the null hypothesis, Equation 1 is applied to available replicates as:</p>
        <p>d<sup>H0 </sup>= x<sub>a </sub>- x<sub>b </sub>= <italic>ε</italic><sub>a </sub>- <italic>ε</italic><sub>b </sub>    (9)</p>
        <p>Different distribution models (t-Student distribution, bi-exponential distribution, and mixture models of N Gaussians, N = 1, ..., 6) are used to fit the set of d<sup>H0 </sup>values obtained by applying Equation 9 to all genes and available replicates. The best model is selected based on the goodness of fit and the parameters precision, and is used as the null hypothesis distribution of d(t<sub>k</sub>) to determine <italic>θ</italic><sub>d </sub>to be used in Equation 2.</p>
        <p>To determine the threshold in correspondence to a significance level <italic>α</italic>, Method 1 uses a model to fit the observed statistics rather than using quantiles. The reason for this choice is that the lack of a sufficient number of observations from available replicates renders the determination of appropriate thresholds difficult when low significance levels are chosen, as often the case in microarray studies. If a sufficient number of replicates is available to guarantee a good threshold setting at the desired significance level <italic>α</italic>, it may be preferable to use quantiles.</p>
      </sec>
      <sec>
        <title>Null hypothesis distribution of variable A</title>
        <p>At least two replicates for each time sample would be necessary to derive A distribution under the null hypothesis from the data. Since we address selection of differentially expressed genes in data-poor condition, i.e. a sufficient number of replicates is not available, a Monte Carlo procedure is used to derive the null distribution of A. First, d<sup>H0 </sup>distribution is derived from d(t<sub>k</sub>) values obtained from available replicates as described above. Then, B profiles of length M are sampled from d<sup>H0 </sup>(here we used B = 10<sup>4</sup>) under the hypothesis that the error at different time samples is independent and identically distributed. Subsequently, B values of A<sup>H0 </sup>are calculated from these profiles. Finally, different distribution models (Gamma, Log-normal, Weibull) are used to fit the entire set of A<sup>H0 </sup>values and the best model is chosen based on goodness of fit and parameter precision. This model is used as the null hypothesis distribution of A to determine <italic>θ</italic><sub>A </sub>to be used in Equation 5.</p>
        <p>As for Method 1, a model is fitted to the observed statistics rather than using quantiles to determine the threshold in correspondence to a significance level <italic>α</italic>.</p>
      </sec>
      <sec>
        <title>Null hypothesis distribution of variable F</title>
        <p>The null distribution of F is obtained using bootstrap. See [<xref ref-type="bibr" rid="B6">6</xref>] for details.</p>
      </sec>
    </sec>
    <sec>
      <title>Intensity dependency of error</title>
      <p>In Affymetrix chips it is well known that d<sup>H0 </sup>has an intensity dependent distribution [<xref ref-type="bibr" rid="B8">8</xref>]. In particular, analysis of technical replicates of Affymetrix Human chip has shown that the standardized variable s<sup>H0 </sup>(obtained dividing d<sup>H0 </sup>by its standard deviation):</p>
      <p>
        <inline-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="1471-2105-8-S1-S10-i5" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mrow>
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mtext>s</mml:mtext>
                          <mml:mrow>
                            <mml:mtext>H</mml:mtext>
                            <mml:mn>0</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>=</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mtext>d</mml:mtext>
                              <mml:mrow>
                                <mml:mtext>H</mml:mtext>
                                <mml:mn>0</mml:mn>
                              </mml:mrow>
                            </mml:msup>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mtext>SD</mml:mtext>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext>dH0</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mover accent="true">
                              <mml:mtext>x</mml:mtext>
                              <mml:mo>¯</mml:mo>
                            </mml:mover>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:mfrac>
                        <mml:mo>=</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mtext>x</mml:mtext>
                              <mml:mtext>a</mml:mtext>
                            </mml:msub>
                            <mml:mo>−</mml:mo>
                            <mml:msub>
                              <mml:mtext>x</mml:mtext>
                              <mml:mtext>b</mml:mtext>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mtext>SD</mml:mtext>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext>dH</mml:mtext>
                                <mml:mn>0</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mover accent="true">
                              <mml:mtext>x</mml:mtext>
                              <mml:mo>¯</mml:mo>
                            </mml:mover>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:mfrac>
                        <mml:mo>;</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mover accent="true">
                          <mml:mtext>x</mml:mtext>
                          <mml:mo>¯</mml:mo>
                        </mml:mover>
                        <mml:mo>=</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mtext>x</mml:mtext>
                              <mml:mtext>a</mml:mtext>
                            </mml:msub>
                            <mml:mo>+</mml:mo>
                            <mml:msub>
                              <mml:mtext>x</mml:mtext>
                              <mml:mtext>b</mml:mtext>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mfrac>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
                <mml:mtext>     </mml:mtext>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:mrow>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaafaqabeqacaaabaGaee4Cam3aaWbaaSqabeaacqqGibascqaIWaamaaGccqGH9aqpdaWcaaqaaiabbsgaKnaaCaaaleqabaGaeeisaGKaeGimaadaaaGcbaGaee4uamLaeeiraq0aaSbaaSqaaiabbsgaKjabbIeaijabbcdaWaqabaGccqGGOaakcuqG4baEgaqeaiabcMcaPaaacqGH9aqpdaWcaaqaaiabbIha4naaBaaaleaacqqGHbqyaeqaaOGaeyOeI0IaeeiEaG3aaSbaaSqaaiabbkgaIbqabaaakeaacqqGtbWucqqGebardaWgaaWcbaGaeeizaqMaeeisaGKaeGimaadabeaakiabcIcaOiqbbIha4zaaraGaeiykaKcaaiabcUda7aqaaiqbbIha4zaaraGaeyypa0ZaaSaaaeaacqqG4baEdaWgaaWcbaGaeeyyaegabeaakiabgUcaRiabbIha4naaBaaaleaacqqGIbGyaeqaaaGcbaGaeGOmaidaaaaacaWLjaGaaCzcamaabmaabaGaeGymaeJaeGimaadacaGLOaGaayzkaaaaaa@5F0B@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </inline-formula>
      </p>
      <p>has an intensity independent distribution [<xref ref-type="bibr" rid="B8">8</xref>]. Therefore, in case of data showing intensity dependency of the variable d<sup>H0</sup>, it is convenient to model s<sup>H0 </sup>distribution, as indicated in the <xref ref-type="supplementary-material" rid="S1">Additional File 1</xref>, to derive the threshold <italic>θ</italic><sub>d </sub>to be used in Equation 2. Consistently, the values of d(t<sub>k</sub>) observed from the data are standardized before applying Equation 2, if Method 1 is used:</p>
      <p>
        <inline-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="1471-2105-8-S1-S10-i6" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mrow>
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mtext>s</mml:mtext>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mtext>t</mml:mtext>
                          <mml:mtext>k</mml:mtext>
                        </mml:msub>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>=</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mtext>d</mml:mtext>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:msub>
                              <mml:mtext>t</mml:mtext>
                              <mml:mtext>k</mml:mtext>
                            </mml:msub>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mtext>SD</mml:mtext>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext>dH</mml:mtext>
                                <mml:mn>0</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mover accent="true">
                              <mml:mtext>x</mml:mtext>
                              <mml:mo>¯</mml:mo>
                            </mml:mover>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:msub>
                              <mml:mtext>t</mml:mtext>
                              <mml:mtext>k</mml:mtext>
                            </mml:msub>
                            <mml:mo stretchy="false">)</mml:mo>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:mfrac>
                        <mml:mo>;</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mover accent="true">
                          <mml:mtext>x</mml:mtext>
                          <mml:mo>¯</mml:mo>
                        </mml:mover>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mtext>t</mml:mtext>
                          <mml:mtext>k</mml:mtext>
                        </mml:msub>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mtext>x</mml:mtext>
                      <mml:mtext>T</mml:mtext>
                    </mml:msup>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msub>
                      <mml:mtext>t</mml:mtext>
                      <mml:mtext>k</mml:mtext>
                    </mml:msub>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>+</mml:mo>
                    <mml:msup>
                      <mml:mtext>x</mml:mtext>
                      <mml:mtext>C</mml:mtext>
                    </mml:msup>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msub>
                      <mml:mtext>t</mml:mtext>
                      <mml:mtext>k</mml:mtext>
                    </mml:msub>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:mfrac>
                <mml:mtext>     </mml:mtext>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mn>11</mml:mn>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:mrow>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaafaqabeqacaaabaGaee4CamNaeiikaGIaeeiDaq3aaSbaaSqaaiabbUgaRbqabaGccqGGPaqkcqGH9aqpdaWcaaqaaiabbsgaKjabcIcaOiabbsha0naaBaaaleaacqqGRbWAaeqaaOGaeiykaKcabaGaee4uamLaeeiraq0aaSbaaSqaaiabbsgaKjabbIeaijabicdaWaqabaGccqGGOaakcuqG4baEgaqeaiabcIcaOiabbsha0naaBaaaleaacqqGRbWAaeqaaOGaeiykaKIaeiykaKcaaiabcUda7aqaaiqbbIha4zaaraGaeiikaGIaeeiDaq3aaSbaaSqaaiabbUgaRbqabaGccqGGPaqkaaGaeyypa0ZaaSaaaeaacqqG4baEdaahaaWcbeqaaiabbsfaubaakiabcIcaOiabbsha0naaBaaaleaacqqGRbWAaeqaaOGaeiykaKIaey4kaSIaeeiEaG3aaWbaaSqabeaacqqGdbWqaaGccqGGOaakcqqG0baDdaWgaaWcbaGaee4AaSgabeaakiabcMcaPaqaaiabikdaYaaacaWLjaGaaCzcamaabmaabaGaeGymaeJaeGymaedacaGLOaGaayzkaaaaaa@6586@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </inline-formula>
      </p>
      <p>Analogously, if Method 2 is used on data showing intensity dependency of the variable d<sup>H0</sup>, A<sup>H0 </sup>and <italic>θ</italic><sub>A </sub>are derived using s<sup>H0 </sup>and the values of A observed from the data (Equation 4) are calculated using s(t<sub>k</sub>) instead of d(t<sub>k</sub>).</p>
    </sec>
    <sec>
      <title>Threshold setting</title>
      <p>Once the null hypothesis distribution of d, A and F are obtained, thresholds <italic>θ</italic><sub>d</sub>, <italic>θ</italic><sub>A </sub>and <italic>θ</italic><sub>F </sub>are determined in correspondence to a significance level <italic>α</italic>. Rather than fixing it a priori, <italic>α </italic>can be optimized based on a variety of criteria aiming to control the family wise error rate (FWER) [<xref ref-type="bibr" rid="B9">9</xref>], or the false discovery rate (FDR) [<xref ref-type="bibr" rid="B10">10</xref>,<xref ref-type="bibr" rid="B11">11</xref>] or a compromise between false positive and false negative classification [<xref ref-type="bibr" rid="B12">12</xref>]. As an example, let's focus on a criterion based on the control of FDR, defined as the expected proportion of false positive classification (FP) among the number S<sub><italic>α </italic></sub>of genes selected as differentially expressed, using significance level <italic>α</italic>:</p>
      <p>
        <inline-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" name="1471-2105-8-S1-S10-i7" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mrow>
                <mml:mtext>FDR</mml:mtext>
                <mml:mo>=</mml:mo>
                <mml:mtext>E</mml:mtext>
                <mml:mrow>
                  <mml:mo>[</mml:mo>
                  <mml:mrow>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mtext>FP</mml:mtext>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mtext>S</mml:mtext>
                          <mml:mi>α</mml:mi>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mrow>
                  <mml:mo>]</mml:mo>
                </mml:mrow>
                <mml:mtext>     </mml:mtext>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mn>12</mml:mn>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:mrow>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqqGgbGrcqqGebarcqqGsbGucqGH9aqpcqqGfbqrdaWadaqaamaalaaabaGaeeOrayKaeeiuaafabaGaee4uam1aaSbaaSqaaGGaciab=f7aHbqabaaaaaGccaGLBbGaayzxaaGaaCzcaiaaxMaadaqadaqaaiabigdaXiabikdaYaGaayjkaiaawMcaaaaa@3E04@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </inline-formula>
      </p>
      <p>In case of numerous sets as for microarrays, FDR is well approximated by</p>
      <p>
        <inline-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" name="1471-2105-8-S1-S10-i8" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mrow>
                <mml:mtext>FDR</mml:mtext>
                <mml:mo>≈</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mtext>E</mml:mtext>
                    <mml:mo stretchy="false">[</mml:mo>
                    <mml:mi>F</mml:mi>
                    <mml:mi>P</mml:mi>
                    <mml:mo stretchy="false">]</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>S</mml:mi>
                      <mml:mi>α</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mtext>     </mml:mtext>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mn>13</mml:mn>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:mrow>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqqGgbGrcqqGebarcqqGsbGucqGHijYUdaWcaaqaaiabbweafjabcUfaBjabdAeagjabdcfaqjabc2faDbqaaiabdofatnaaBaaaleaaiiGacqWFXoqyaeqaaaaakiaaxMaacaWLjaWaaeWaaeaacqaIXaqmcqaIZaWmaiaawIcacaGLPaaaaaa@3F45@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </inline-formula>
      </p>
      <p>Calculating FDR requires the estimate of the expected number of false positives, obtained as the product of <italic>α </italic>by the number N<sub>0 </sub>of non differentially expressed genes:</p>
      <p>E [FP] = N<sub>0 </sub>· <italic>α </italic>    (14)</p>
      <p>N<sub>0 </sub>is unknown and is estimated using the bootstrap procedure described in [<xref ref-type="bibr" rid="B13">13</xref>].</p>
      <p>FDR is calculated for a range of significance levels <italic>α </italic>and the significance level that guarantees the desired FDR is then used to select differentially expressed genes.</p>
      <p>Since Method 1 applies M tests (corresponding to individual time points) for each gene, the significance level <italic>α </italic>for Method 1 is corrected by applying Šidák correction [<xref ref-type="bibr" rid="B14">14</xref>] in order to account for multiple testing.</p>
    </sec>
    <sec>
      <title>Simulation</title>
      <p>Three different experimental conditions with a number of time samples M = 10, 30, 50 were simulated. 100 synthetic data sets were generated for each experimental condition, each consisting of 2000 profiles: 300 simulated as differentially expressed and the remaining as random noise. In both cases, the deviation of expression in T vs C was generated at each sampling time t<sub>k </sub>as standardized deviation:</p>
      <p>s(t<sub>k</sub>) ~ N(<italic>μ</italic><sub>k</sub>, <italic>σ</italic><sup>2</sup>) ∀k = 1, ..., M     (15)</p>
      <p>where <italic>σ</italic><sup>2 </sup>was set equal to 1 and <italic>μ</italic><sub>k </sub>= 0 (k = 1, ..., M) for not differentially expressed genes; while, for differentially expressed genes, plausible profiles were obtained by modeling <italic>μ</italic><sub>k </sub>as dependent on <italic>μ</italic><sub>k-1 </sub>according to a first order Markov model (see <xref ref-type="supplementary-material" rid="S1">Additional File 1</xref> for details), with the only constraint of being greater than 1 (or lower than -1) for at least one time samples.</p>
      <p>Samples k = 1 were generated twice for each gene, so as to provide replicates useful to apply Method 1 and 2. These replicates were included also in the analysis for method 3. Simulated data were used to test the performance of the methods in different experimental conditions. After the null hypothesis distributions of variables d(t<sub>k</sub>), A and F are modeled as described above, a significance level <italic>α </italic>had to be fixed to determine the confidence thresholds <italic>θ</italic><sub>d</sub>, <italic>θ</italic><sub>A </sub>and <italic>θ</italic><sub>F </sub>to be used in Equations 2, 5 and 7 respectively. We compared the performance of the three methods across the entire range of significance level <italic>α </italic>by using Precision (true positives divided by the number of selected genes) vs Recall (true positives divided by the number of differentially expressed genes), and curves of observed false positives divided by the number of selected genes (observed FDR) vs number of selected genes. Moreover, we compared the average results obtained with the 3 methods by setting <italic>α </italic>in correspondence to a desired FDR of 0.05, in terms of number of selected genes and observed false positives divided by the number of selected genes. All measurements were averaged across the 100 simulations.</p>
    </sec>
    <sec>
      <title>Insulin case study</title>
      <p>To better appreciate some characteristics of Methods 1 and 2 related to the experimental error modeling, the analysis of the null hypothesis distribution of the variables d(t<sub>k</sub>) and A (Equation 1 and 4) was applied to a real case study on rat muscle cells treated with insulin. The study was performed in vitro, on muscle L6 rat cell line. Cells were treated with insulin at time 0+, just after the collection of a first baseline sample at time 0; eight samples were harvested every hour during eight hours insulin stimulation. A control experiment was also performed in order to be able to distinguish between insulin effect and biological processes of different nature, which take place in the culture simultaneously to insulin induced processes (Figure <xref ref-type="fig" rid="F1">1</xref>). A total of twenty Affymetrix chips RG_U34A (monitoring 8.799 transcripts) were hybridized using four replicates of the basal sample, eight samples collected from the control culture, and eight samples collected from the treated culture. Standard Affymetrix MAS 5 software [<xref ref-type="bibr" rid="B15">15</xref>] was used for data pre-processing.</p>
    </sec>
  </sec>
  <sec>
    <title>Results</title>
    <sec>
      <title>Simulation</title>
      <p>An example of simulated data with M = 10 is shown in Figure <xref ref-type="fig" rid="F2">2</xref>, as clusters obtained by using Self Organizing Maps [<xref ref-type="bibr" rid="B16">16</xref>] and Pearson Correlation as similarity measure on one of the simulated data-set (M = 10). The average profile is shown for each cluster, together with standard deviation bars; the number of genes for each cluster is also reported. A variety of profiles are represented, such as genes differentially expressed in one or few peaks apparently uncorrelated (1<sup>st </sup>row panels), profiles that show characteristic bumps and waves of different length (2<sup>nd </sup>and 3<sup>rd </sup>row panels) or consistent trends along the time series, accompanied by few (3<sup>rd </sup>row panels) or numerous (4<sup>th </sup>row panels) time samples with average absolute value greater than the error standard deviation <italic>σ </italic>(Equation 15).</p>
      <p>Results obtained by applying Methods 1, 2 and 3 to 100 simulated data sets are shown as average Precision at different ranges of Recall intensities in Figure <xref ref-type="fig" rid="F3">3</xref>, left panels. Average and standard deviations across the 100 simulations are reported. Method 2 slightly outperforms Method 1 for Precision higher than 0.6, since it provides higher values of both Precision and Recall in all the different sampling conditions. For values of Precision lower than 0.6, the two curves are almost superimposable. Both methods 1 and 2 work better than Method 3 for short time series (M = 10, M = 30), while for long time series (M = 50) the performance of the Methods 2 and 3 is similar, with Method 3 slightly superior to Methods 2. The areas under the curves (AUC) are also reported in Figure <xref ref-type="fig" rid="F3">3</xref> (left panels). To better appreciate the ability of the three Methods to select differentially expressed genes at low FDR, Figure <xref ref-type="fig" rid="F3">3</xref> (right panels) shows the number of observed false positives divided by the number of selected genes (observed FDR) for different numbers of selected genes in the range 0–300: Method 2 provides number of false positives divided by the number of selected genes always lower than that obtained with Method 1; Method 3 is slightly superior to Method 2 for M = 50, but inferior to both Methods 1 and 2 for M = 10 and M = 30. The performance of the three Methods with respect to each other is not affected by the number of differentially expressed genes (results not shown).</p>
      <p>Table <xref ref-type="table" rid="T1">1</xref> shows the average number of selected genes and the proportion of false positives among the number of selected genes obtained by setting the confidence threshold according to an expected FDR of 0.05 estimated as described in section Methods (Equations 13, 14). Results confirm the ability of Method 2 to select more genes than the other two methods at a desired FDR, for M = 10 and M = 30. Moreover, the observed proportion of false positives among the number of selected genes is close to the estimated 0.05 for Method 2, while for Method 1 it is higher than the expected for M = 30 and M = 50. The performance of Method 3 is poor for short time series with M = 10, with an observed proportion of false positives among the number of selected genes much higher than 0.05 and a low number of selected genes (equal to 8). Method 3 outperforms Method 2 for M = 50, both in terms of number of selected genes and proportion of false positives on number of selected genes, thus confirming results shown in Figure <xref ref-type="fig" rid="F3">3</xref> (right panels).</p>
    </sec>
    <sec>
      <title>Insulin case study</title>
      <sec>
        <title>Error</title>
        <p>In this section we present the estimate of the null hypothesis distribution of variable d(t<sub>k</sub>) (Equation 1) and variable A (Equation 4). Figure <xref ref-type="fig" rid="F4">4</xref> shows the values of d<sup>H0 </sup>(upper, left panel) (obtained by applying Equation 9 to the four available replicates) and its standardized value s<sup>H0 </sup>(lower, left panel) plotted vs the average intensity of gene expression values (details on standardization step are given in <xref ref-type="supplementary-material" rid="S1">Additional File 1</xref>). Figure <xref ref-type="fig" rid="F4">4</xref> (right panels) shows the average variance of d<sup>H0 </sup>and s<sup>H0 </sup>vs the intensity range of gene expression discretized in intervals of constant size. Results confirm that while d<sup>H0 </sup>has an intensity-dependent distribution, s<sup>H0 </sup>has not [<xref ref-type="bibr" rid="B8">8</xref>] (results were insensitive to the bin size used to discretize the range of average intensity values). The entire set of s<sup>H0 </sup>values was fitted using different distribution models (see <xref ref-type="supplementary-material" rid="S1">Additional File 1</xref> for details). The Gaussian mixture model with N = 2 was chosen as the best model. Model parameters and their precision are shown in Table <xref ref-type="table" rid="T2">2</xref>. Monte Carlo procedure was then used to derive the null distribution of A: B profiles of length M = 8 were sampled from s<sup>H0 </sup>distribution and B = 10000 values of A<sup>H0 </sup>were calculated from these profiles. Three different distribution models (Gamma, Log-normal, Weibull) were used to fit the entire set of A<sup>H0 </sup>values. The best fit for A<sup>H0 </sup>was obtained with Gamma distribution (Figure <xref ref-type="fig" rid="F5">5</xref> and Table <xref ref-type="table" rid="T3">3</xref>).</p>
      </sec>
      <sec>
        <title>Gene Selection</title>
        <p>We applied the three Methods to the data, adopting the false discovery rate as criterion for threshold setting. Table <xref ref-type="table" rid="T4">4</xref> shows the number of probe-sets selected by each of the three methods for FDR equal to 0.001, 0.005, 0.01, 0.05 respectively. Results confirm those obtained by using simulation, i.e. the ability of Method 2 to select a higher number of differentially expressed genes at controlled FDR for short time series. Since focus here is methodology, biological results are not discussed further; confirmation studies and biological interpretation will be presented in a different article.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Discussion</title>
    <p>In this work we evaluated the performance of two selection methods here proposed to be applied in time series studies in data-poor conditions, i.e. when the number of available replicates does not make possible or practical the use of standard statistical methods. We also tested the two methods in comparison with a third method from the literature.</p>
    <p>Method 1 compares samples time by time using a statistically based fold change threshold derived from a null hypothesis distribution of variable d(t<sub>k</sub>). To this purpose, replicates of at least one time sample are necessary. Since the threshold is derived based on the experimental variability, Method 1 accounts for the error characteristics, e.g. its intensity dependence; therefore, for example using Affymetrix chips, genes expressed at high intensities are not penalized with respect to genes at low intensities, which show a higher variability (Figure <xref ref-type="fig" rid="F4">4</xref>). Although Method 1 improves upon the use of a constant empirical fold change threshold, it considers time samples independently to each other, which is not a realistic assumption in time series studies. Method 2 calculates the area of the region bounded by the time series expression profiles to be compared and considers the gene differentially expressed if this area exceeds a threshold based on a model of the experimental error; therefore, besides accounting for the error distribution, it considers the entire expression profile and not single time samples. Also this method needs replicates for at least one time sample in order to derive the null hypothesis distribution. Both Methods 1 and 2 assumes as working hypothesis that the error at different time points is independent and identically distributed. This hypothesis, on our experience, is usually verified on real data (data not shown). However, for some experimental settings there may be a dependency of the error on time. In this latter case, it would be more appropriate to perform replicates at different time samples, covering the duration of the experiment, and use Method 1 with time dependent threshold settings. Methods 1 and 2 can be applied to compare time series from 2 different experimental conditions or a time series vs its baseline (e.g. time 0), by defining the deviation of expression of gene × for each sample t<sub>k </sub>(Equation 1) as the deviation between treated at time t<sub>k </sub>and the baseline. Moreover, if the sampling grid is different for the two time series, Method 2 can be easily generalized by generating A<sup>H0 </sup>distribution from B time series with appropriate sampling grid.</p>
    <p>Method 3 [<xref ref-type="bibr" rid="B6">6</xref>] uses natural cubic splines to fit time series expression data using a null hypothesis and an alternative hypothesis model, and performs a statistical test on the sum of squares residuals obtained using the two models to assess differential expression. It therefore, besides considering the entire expression profiles, implicitly considers time dependencies. Moreover, it does not need any experimental replicate, which makes it practical for a wide range of time series microarray experiments.</p>
    <p>We tested the performance of the three methods using synthetic data to assess their validity over a range of experimental conditions, specifically the length of the analyzed time series. In the simulation, we used a Markov model to generate plausible data, accounting for the dependencies of time samples and not biased toward one of the methods. Taking for example <italic>μ</italic><sub><italic>k </italic></sub>equal to an arbitrary constant for a random subset of time samples t<sub>k </sub>(k = 1, ..., M) in Equation 12, would not have accounted for time dependencies, and would have generated non realistic oscillation in the profiles, thus penalizing Method 3 which is based on a model fit, with respect to the other methods, in particular Method 1, which applies a threshold on each time sample. Moreover, simulated profiles (Figure <xref ref-type="fig" rid="F2">2</xref>) represent a variety of possible situations in time series expression, such as profiles characterized by one or few peaks, waves of different length or consistent trends along the time series.</p>
    <p>Results on simulated data showed that Method 2 outperforms Method 1 independently from the length of the time series being analyzed, probably because, as Method 1 is based on single sample comparisons, it is particularly sensitive to random fluctuations due to the noise, thus resulting in a larger number of false positives. Method 2 constitutes an improvement with respect to Method 1 since the entire expression profile is considered simultaneously and this allows better distinguishing between consistent differences in expression profiles and random oscillations, thus resulting in a lower false negative rate. Method 3, as Method 2, considers the entire expression profile, but performs better than Method 2, only for long time series (M = 50).</p>
    <p>Looking at the ability of the methods to classify profiles with particular characteristics, we observed that Method 1 works better than Method 2 to detect differentially expressed genes that show just one or two peaks as differentially expressed. On the opposite, Method 2 works better than Method 1 in detecting profiles characterized by waves of length greater than three samples, so as profiles that show a characteristic increasing/decreasing trend. Method 3, as Method 2, is better in detecting bumps and consistent trends in the profiles, than in detecting isolated peaks. However, it needs long time series (M = 50) to perform better than Method 2, probably because the fit are more reliable when performed on long time series; Method 3 was in fact proposed by the authors on real case studies with more than 40 samples. These results are certainly of interest to address the choice of the algorithm to be used in data-poor time series expression studies, depending on the availability of replicates and on the length of the time series.</p>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>Microarray time series studies are essential to understand the dynamics of biological molecular events. In order to limit the analysis to those genes that change expression over time, it is necessary to select differentially expressed transcripts. Due to the high cost of microarrays, experiments are often performed without replication; therefore, traditional statistical methods can't be applied. Here we evaluate the performance of two selection methods applicable in data poor conditions, based on: a statistically based threshold on individual samples; a statistically based threshold to be applied on the area of the region bounded by the time series expression profiles to be compared.</p>
    <p>Application on a real data set on insulin regulation on muscle cells, obtained using Affymetrix chips, revealed as the error analysis performed using Methods 1 and 2 may be useful to detect error characteristics such as intensity dependencies and to properly address these feature by standardization.</p>
    <p>We evaluated Methods 1 and 2 performance using simulated data with a different number of available samples and compared these performance with those obtained using Method 3, based on a splines fit of time series profiles. The results outlines that the two error based Methods 1 and 2 work better than Method 3 with short time series experiments, while Method 3 works better than Methods 1 and 2 with long time series experiments. These results might help to optimize the choice of the algorithm to be used in different experimental conditions.</p>
    <p>A preliminary version of Method 2, implemented in R, is available at [<xref ref-type="bibr" rid="B17">17</xref>].</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>BDC conceived the study and performed data analysis under the guidance and supervision of GT. SKN was responsible for the overall coordination of microarray experiments realization. LJG performed microarray experiments. CC was responsible for the overall project coordination. All authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p>The .pdf document contains a detailed description of the procedure used to standardize the variable d<sup>H0 </sup>so as to account for the error intensity dependent distribution, and a detailed description of the procedure used to simulate the data, based on a first order Markov Model.</p>
      </caption>
      <media xlink:href="1471-2105-8-S1-S10-S1.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>This study was supported by Ministero dell'Università e della Ricerca Scientificae Tecnologica (PRIN 2003 Italy), and by National Institute of Health, grant ROIDK41973.</p>
      <p>This article has been published as part of <italic>BMC Bioinformatics</italic> Volume 8, Supplement 1, 2007: Italian Society of Bioinformatics (BITS): Annual Meeting 2006. The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/8?issue=S1"/>.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cui</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Churchill</surname>
            <given-names>GA</given-names>
          </name>
        </person-group>
        <article-title>Statistical tests for differential expression in cDNA microarray experiments</article-title>
        <source>Genome Biol</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>210</fpage>
        <pub-id pub-id-type="pmid">12702200</pub-id>
        <pub-id pub-id-type="doi">10.1186/gb-2003-4-4-210</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tusher</surname>
            <given-names>GT</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Significane Analysis of Microarrays Applied to the Ionizing Radiation Response</article-title>
        <source>PNAS</source>
        <year>2001</year>
        <volume>98</volume>
        <fpage>5116</fpage>
        <lpage>5121</lpage>
        <pub-id pub-id-type="pmid">11309499</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.091062498</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Park</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yi</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>SY</given-names>
          </name>
          <name>
            <surname>Yoo</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Ahn</surname>
            <given-names>JI</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>YS</given-names>
          </name>
        </person-group>
        <article-title>Statistical tests for identifying differentially expressed genes in time-course microarray experiments</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>694</fpage>
        <lpage>703</lpage>
        <pub-id pub-id-type="pmid">12691981</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btg068</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gentile</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Latonen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Laiho</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Cell cycle arrest and apoptosis provoked by UV radiation-induced DNA damage are transcriptionally highly divergent responses</article-title>
        <source>Nucleic Acids Res</source>
        <year>2003</year>
        <volume>31</volume>
        <fpage>4779</fpage>
        <lpage>4790</lpage>
        <pub-id pub-id-type="pmid">12907719</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gkg675</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>XL</given-names>
          </name>
          <name>
            <surname>Olson</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>LP</given-names>
          </name>
        </person-group>
        <article-title>A regression-based method to identify differentially expressed genes in microarray time course studies and its application in an inducible Huntington's disease transgenic model</article-title>
        <source>Human Molecular Genetics</source>
        <year>2002</year>
        <volume>11</volume>
        <fpage>1977</fpage>
        <lpage>1985</lpage>
        <pub-id pub-id-type="pmid">12165559</pub-id>
        <pub-id pub-id-type="doi">10.1093/hmg/11.17.1977</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Xiao</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Leek</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Tompkins</surname>
            <given-names>RG</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>RW</given-names>
          </name>
        </person-group>
        <article-title>Significance analysis of time course microarray experiments</article-title>
        <source>PNAS</source>
        <year>2005</year>
        <volume>102</volume>
        <fpage>12837</fpage>
        <lpage>12842</lpage>
        <pub-id pub-id-type="pmid">16141318</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.0504609102</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Hobbs</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Collin</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Beazer-Barclay</surname>
            <given-names>YD</given-names>
          </name>
          <name>
            <surname>Antonellis</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Scherf</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>Exploration, Normalization, and Summaries of High Density Oligonucleotide Array Probe Level Data</article-title>
        <source>Biostatistics</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>249</fpage>
        <lpage>264</lpage>
        <pub-id pub-id-type="pmid">12925520</pub-id>
        <pub-id pub-id-type="doi">10.1093/biostatistics/4.2.249</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Stolovitzky</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>U</given-names>
          </name>
        </person-group>
        <article-title>Quantitative Noise Analysis for gene expression microarray experiment</article-title>
        <source>PNAS</source>
        <year>2002</year>
        <volume>99</volume>
        <fpage>14031</fpage>
        <lpage>14036</lpage>
        <pub-id pub-id-type="pmid">12388780</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.222164199</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shaffer</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Boldrick</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Multiple hypothesis testing in microarry experiments</article-title>
        <source>Technical Report Tech Report # 110, UC Berkeley Division of Biostatistics, Working Paper Series</source>
        <year>2002</year>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the False Discovery Rate: a Practical and Powerful Approach to multiple testing</article-title>
        <source>J R Statist SocB</source>
        <year>1995</year>
        <volume>57</volume>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Statistical significance for genomewide studies</article-title>
        <source>PNAS</source>
        <year>2003</year>
        <volume>100</volume>
        <fpage>9440</fpage>
        <lpage>9445</lpage>
        <pub-id pub-id-type="pmid">12883005</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.1530509100</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Di Camillo</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Sanchez-Cabo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Toffolo</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Nair</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Trajanoski</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Cobelli</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>A quantization method based on threshold optimization for microarray short time series</article-title>
        <source>BMC Bioinformatics</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>S11</fpage>
        <pub-id pub-id-type="pmid">16351737</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-6-S4-S11</pub-id>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>A direct approach to false discovery rates</article-title>
        <source>J R Stat Soc</source>
        <year>2002</year>
        <volume>3</volume>
        <fpage>479</fpage>
        <lpage>498</lpage>
        <pub-id pub-id-type="doi">10.1111/1467-9868.00346</pub-id>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Šidák</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Rectangular confidence regions for the means of multivariate normal distributions</article-title>
        <source>J Amer Statist Assoc</source>
        <year>1967</year>
        <volume>62</volume>
        <fpage>626</fpage>
        <lpage>633</lpage>
        <pub-id pub-id-type="doi">10.2307/2283989</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="other">
        <article-title>Affymetrix, Santa Clara, CA. Statistical Algorithm Description Document</article-title>
        <source>Affymetrix – NetAffx Analysis Center</source>
        <year>2002</year>
        <ext-link ext-link-type="uri" xlink:href="http://www.affymetrix.com/analysis/index.affx"/>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Kohonen</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <source>Self-Organizing Maps</source>
        <year>1995</year>
        <publisher-name>Springer</publisher-name>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="other">
        <ext-link ext-link-type="uri" xlink:href="http://www.dei.unipd.it\~dicamill\software\SEL.TS.AREA"/>
      </citation>
    </ref>
  </ref-list>
  <sec sec-type="display-objects">
    <title>Figures and Tables</title>
    <fig position="float" id="F1">
      <label>Figure 1</label>
      <caption>
        <p><bold>Experiment outline</bold>. The case study provides a typical example of experimental design in time series gene expression studies. Samples are collected from an insulin treated and a control culture. The expression level measured in treated and control culture for a single probe-set (corresponding to "Early growth response 1" gene) is shown in the lower part of the Figure. The area A bounded by the two expression profiles T and C is coloured in gray.</p>
      </caption>
      <graphic xlink:href="1471-2105-8-S1-S10-1"/>
    </fig>
    <fig position="float" id="F2">
      <label>Figure 2</label>
      <caption>
        <p><bold>Simulated data</bold>. Standardized deviation s(t<sub>k</sub>) (k = 1, ..., M) between treated and control gene expression for 300 simulated differentially expressed profiles of a simulated data set (number of time samples M = 10) is shown as clusters obtained by using Self Organizing Maps and Pearson Correlation as similarity measure. For each cluster the average profile ± standard deviation and the number of genes are shown. The two horizontal lines correspond to the ± <italic>σ </italic>= ± 1 (Equation 15).</p>
      </caption>
      <graphic xlink:href="1471-2105-8-S1-S10-2"/>
    </fig>
    <fig position="float" id="F3">
      <label>Figure 3</label>
      <caption>
        <p><bold>Methods performance for simulated data</bold>. Average Precision at different Recall intensities (left panels) and number of false positives divided by the number of selected genes for different number of selected genes (right panels) obtained on 100 simulated data sets, using methods 1, 2 and 3 on time series of 10 (upper left panel), 30 (upper right panel), and 50 (lower left panel) samples. AUCs are also reported for Precision vs Recall curves.</p>
      </caption>
      <graphic xlink:href="1471-2105-8-S1-S10-3"/>
    </fig>
    <fig position="float" id="F4">
      <label>Figure 4</label>
      <caption>
        <p><bold>Intensity dependency of the error</bold>. Left panels: deviation of expression in Treated vs Control profiles calculated from pair of replicated measurements as a function of expression before (upper panel) and after standardization (lower panel). Right panels: average variance of d<sup>H0 </sup>(upper panel) and s<sup>H0 </sup>(lower panel) at different intensities. Dots represent mean variance of d<sup>H0 </sup>(s<sup>H0</sup>) calculated in intervals of constant size (equal to 0.1).</p>
      </caption>
      <graphic xlink:href="1471-2105-8-S1-S10-4"/>
    </fig>
    <fig position="float" id="F5">
      <label>Figure 5</label>
      <caption>
        <p><bold>Fit of A<sup>H0 </sup>distribution</bold>. A<sup>H0 </sup>distributions (in black) fitted with a Gamma (upper panel) a Log-normal (central panel) and a Weibull distribution (lower panel).</p>
      </caption>
      <graphic xlink:href="1471-2105-8-S1-S10-5"/>
    </fig>
    <table-wrap position="float" id="T1">
      <label>Table 1</label>
      <caption>
        <p>Results on simulated data for threshold setting based on desired FDR = 0.05.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <td/>
            <td align="left" colspan="2">
              <bold>Method 1</bold>
            </td>
            <td align="left" colspan="2">
              <bold>Method 2</bold>
            </td>
            <td align="left" colspan="2">
              <bold>Method 3</bold>
            </td>
          </tr>
          <tr>
            <td/>
            <td colspan="6">
              <hr/>
            </td>
          </tr>
          <tr>
            <td/>
            <td align="left"># selected genes</td>
            <td align="left"># FP/# sel.genes</td>
            <td align="left"># selected genes</td>
            <td align="left"># FP/# sel.genes</td>
            <td align="left"># selected genes</td>
            <td align="left"># FP/# sel.genes</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">
              <bold>M = 10</bold>
            </td>
            <td align="left"><bold>73 </bold><break/>(17)</td>
            <td align="left"><bold>0.045 </bold><break/>(0.027)</td>
            <td align="left"><bold>100 </bold><break/>(8)</td>
            <td align="left"><bold>0.040 </bold><break/>(0.014)</td>
            <td align="left"><bold>8 </bold><break/>(10)</td>
            <td align="left"><bold>0.304 </bold><break/>(0.334)</td>
          </tr>
          <tr>
            <td align="left">
              <bold>M = 30</bold>
            </td>
            <td align="left"><bold>91 </bold><break/>(21)</td>
            <td align="left"><bold>0.078 </bold><break/>(0.045)</td>
            <td align="left"><bold>120 </bold><break/>(13)</td>
            <td align="left"><bold>0.059 </bold><break/>(0.028)</td>
            <td align="left"><bold>83 </bold><break/>(10)</td>
            <td align="left"><bold>0.098 </bold><break/>(0.046)</td>
          </tr>
          <tr>
            <td align="left">
              <bold>M = 50</bold>
            </td>
            <td align="left"><bold>96 </bold><break/>(16)</td>
            <td align="left"><bold>0.068 </bold><break/>(0.024)</td>
            <td align="left"><bold>126 </bold><break/>(12)</td>
            <td align="left"><bold>0.058 </bold><break/>(0.021)</td>
            <td align="left"><bold>130 </bold><break/>(12)</td>
            <td align="left"><bold>0.053 </bold><break/>(0.027)</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <p>All measurements were averaged across the 100 simulations; standard deviations are reported in parenthesis. Number of selected genes and number of false positives divided by the number of selected genes, obtained by applying the 3 methods on simulated data (setting <italic>α </italic>in correspondence to a desired FDR of 0.05).</p>
      </table-wrap-foot>
    </table-wrap>
    <table-wrap position="float" id="T2">
      <label>Table 2</label>
      <caption>
        <p>s<sup>H0 </sup>distribution parameters. Parameters of the sum of two Gaussian mixture model for the distribution of s<sup>H0</sup>.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <td align="left">
              <bold>Parameter</bold>
            </td>
            <td align="left">
              <bold>Estimate</bold>
            </td>
            <td align="left">
              <bold>Precision</bold>
            </td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">
              <bold>a1</bold>
            </td>
            <td align="left">0.64</td>
            <td align="left">0.03</td>
          </tr>
          <tr>
            <td align="left">
              <bold>m1</bold>
            </td>
            <td align="left">-0.07</td>
            <td align="left">0.01</td>
          </tr>
          <tr>
            <td align="left">
              <bold>m2</bold>
            </td>
            <td align="left">0.12</td>
            <td align="left">0.03</td>
          </tr>
          <tr>
            <td align="left">
              <bold>sd1</bold>
            </td>
            <td align="left">0.69</td>
            <td align="left">0.02</td>
          </tr>
          <tr>
            <td align="left">
              <bold>sd2</bold>
            </td>
            <td align="left">1.39</td>
            <td align="left">0.03</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <table-wrap position="float" id="T3">
      <label>Table 3</label>
      <caption>
        <p>A<sup>H0 </sup>distribution parameters. Parameters of the Gamma distribution of A<sup>H0</sup>.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <td align="left">
              <bold>Parameter</bold>
            </td>
            <td align="left">
              <bold>Estimate</bold>
            </td>
            <td align="left">
              <bold>Precision</bold>
            </td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">
              <bold>shape</bold>
            </td>
            <td align="left">8.9</td>
            <td align="left">0.1</td>
          </tr>
          <tr>
            <td align="left">
              <bold>rate</bold>
            </td>
            <td align="left">1.91</td>
            <td align="left">0.03</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <table-wrap position="float" id="T4">
      <label>Table 4</label>
      <caption>
        <p>Number of selected genes on real data for different threshold settings.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <td align="left">
              <bold>FDR</bold>
            </td>
            <td align="left">
              <bold># selected genes </bold>
              <break/>
              <bold>Method 1</bold>
            </td>
            <td align="left">
              <bold># selected genes </bold>
              <break/>
              <bold>Method 2</bold>
            </td>
            <td align="left">
              <bold># selected genes </bold>
              <break/>
              <bold>Method 3</bold>
            </td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">
              <bold>0.001</bold>
            </td>
            <td align="left">216</td>
            <td align="left">50</td>
            <td align="left">6</td>
          </tr>
          <tr>
            <td align="left">
              <bold>0.005</bold>
            </td>
            <td align="left">279</td>
            <td align="left">87</td>
            <td align="left">14</td>
          </tr>
          <tr>
            <td align="left">
              <bold>0.01</bold>
            </td>
            <td align="left">320</td>
            <td align="left">100</td>
            <td align="left">15</td>
          </tr>
          <tr>
            <td align="left">
              <bold>0.05</bold>
            </td>
            <td align="left">451</td>
            <td align="left">156</td>
            <td align="left">46</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <p>Number of genes selected applying the 3 methods on real data (by setting <italic>α </italic>in correspondence to a desired FDR of 0.001, 0.005, 0.01, 0.05).</p>
      </table-wrap-foot>
    </table-wrap>
  </sec>
</back>
