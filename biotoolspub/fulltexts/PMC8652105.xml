<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8652105</article-id>
    <article-id pub-id-type="pmid">34601583</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab687</article-id>
    <article-id pub-id-type="publisher-id">btab687</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CNN-PepPred: an open-source tool to create convolutional NN models for the discovery of patterns in peptide sets—application to peptide–MHC class II binding prediction</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6138-0612</contrib-id>
        <name>
          <surname>Junet</surname>
          <given-names>Valentin</given-names>
        </name>
        <aff><institution>Anaxomics Biotech SL</institution>, Barcelona 08008, <country country="ES">Spain</country></aff>
        <aff><institution>Institute of Biotechnology and Biomedicine, Universitat Autònoma de Barcelona</institution>, Barcelona 08193, <country country="ES">Spain</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9235-6730</contrib-id>
        <name>
          <surname>Daura</surname>
          <given-names>Xavier</given-names>
        </name>
        <xref rid="btab687-cor1" ref-type="corresp"/>
        <aff><institution>Institute of Biotechnology and Biomedicine, Universitat Autònoma de Barcelona</institution>, Barcelona 08193, <country country="ES">Spain</country></aff>
        <aff><institution>Catalan Institution for Research and Advanced Studies (ICREA)</institution>, Barcelona 08010, <country country="ES">Spain</country></aff>
        <aff><institution>Biomedical Research Networking Center in Bioengineering, Biomaterials and Nanomedicine (CIBER-BBN)</institution>, Madrid 28029, <country country="ES">Spain</country></aff>
        <!--xavier.daura@uab.cat-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Marschall</surname>
          <given-names>Tobias</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btab687-cor1">To whom correspondence should be addressed. <email>xavier.daura@uab.cat</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>12</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-10-02">
      <day>02</day>
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>02</day>
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <volume>37</volume>
    <issue>23</issue>
    <fpage>4567</fpage>
    <lpage>4568</lpage>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>5</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>02</day>
        <month>8</month>
        <year>2021</year>
      </date>
      <date date-type="editorial-decision">
        <day>24</day>
        <month>9</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>9</month>
        <year>2021</year>
      </date>
      <date date-type="corrected-typeset">
        <day>13</day>
        <month>10</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab687.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>The ability to unveil binding patterns in peptide sets has important applications in several biomedical areas, including the development of vaccines. We present an open-source tool, CNN-PepPred, that uses convolutional neural networks to discover such patterns, along with its application to peptide–HLA class II binding prediction. The tool can be used locally on different operating systems, with CPUs or GPUs, to train, evaluate, apply and visualize models.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>CNN-PepPred is freely available as a Python tool with a detailed User’s Guide at <ext-link xlink:href="https://github.com/ComputBiol-IBB/CNN-PepPred" ext-link-type="uri">https://github.com/ComputBiol-IBB/CNN-PepPred</ext-link>. The site includes the peptide sets used in this study, extracted from IEDB (<ext-link xlink:href="http://www.iedb.org" ext-link-type="uri">www.iedb.org</ext-link>).</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Union’s Horizon 2020 research and innovation programme</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Marie Skłodowska-Curie</institution>
          </institution-wrap>
        </funding-source>
        <award-id>765158</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Spanish Ministry for Science, Innovation and Universities</institution>
          </institution-wrap>
        </funding-source>
        <award-id>PID2019-111364RB-I00</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The prediction of antigenic determinants—epitopes—of specific proteins or full proteomes is a key aspect of immunoinformatics, with a wide-range of applications from the study of autoimmunity to the development of cancer immunotherapies and therapeutic as well as prophylactic vaccines. For MHC epitopes in particular, experiments coupling natural-ligand elution to mass spectrometry identification (<xref rid="btab687-B3" ref-type="bibr">Caron <italic toggle="yes">et al.</italic>, 2015</xref>) have led in recent years to an explosion in the amount of data available on MHC peptide recognition, enabling data-driven approaches to <italic toggle="yes">in silico</italic> epitope prediction (<xref rid="btab687-B12" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2010</xref>).</p>
    <p>The state-of-the-art in the prediction of peptide–MHC class II binding is arguably represented by the NetMHCII family of algorithms (<xref rid="btab687-B2" ref-type="bibr">Andreatta <italic toggle="yes">et al.</italic>, 2015</xref>). Their core is a neural-network-based algorithm called NNAlign (<xref rid="btab687-B8" ref-type="bibr">Nielsen and Lund, 2009</xref>). NetMHCII features an allele-specific algorithm, while NetMHCIIpan deploys a universal network for the prediction of binding to any MHC class II allele with known protein sequence (<xref rid="btab687-B6" ref-type="bibr">Jensen <italic toggle="yes">et al.</italic>, 2018</xref>). The functionality of both tools is constrained to the application of pre-trained models. NNAlign (<xref rid="btab687-B7" ref-type="bibr">Nielsen and Andreatta, 2017</xref>), on the other hand, offers the possibility of training new models. These tools, however, are only available as on-line platforms or executables and there exists, to our knowledge, no reference providing information on the implementation details of the neural network behind them, in a manner that would make it reproducible. Recently, these algorithms have taken a new research direction to include multiple-allele datasets (MA) (<xref rid="btab687-B1" ref-type="bibr">Alvarez <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btab687-B10" ref-type="bibr">Reynisson <italic toggle="yes">et al.</italic>, 2020</xref>). Other groups have also developed their own methods to include MA data (<xref rid="btab687-B4" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btab687-B9" ref-type="bibr">Racle <italic toggle="yes">et al.</italic>, 2019</xref>), but are also only available for application purposes in the form of a platform or an executable. While all these tools are being successfully used in multiple applications and are amenable to non-expert use, we believe that the lack of clear implementation details and open code for the core predictive algorithm hinder their use by bioinformatics researchers who need a tool that can be fully integrated in larger codes and possibly modified to fit particular needs in different areas of peptide recognition.</p>
    <p>It is indeed to satisfy our own needs in this field that we developed CNN-PepPred, a new tool for the discovery of patterns in peptide sets. The tool was developed to conveniently fit general purpose needs such as the training of models, their application to new data, their evaluation by cross-validation and gaining visual insight on the training process. The software is accompanied by a detailed User’s Guide and has been tested on Linux and Windows, using CPUs and GPUs. In the following section, we provide a concise description of CNN-PepPred. We refer the reader to the User’s Guide for a detailed description.</p>
  </sec>
  <sec>
    <title>2 Description</title>
    <p>CNN-PepPred is based on Convolutional Neural Networks (CNN) and written in Python. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1B</xref> (<xref rid="sup1" ref-type="supplementary-material">Supplementary Information</xref>) illustrates the architecture of the CNN, implemented with the open-source libraries Keras (<ext-link xlink:href="http://github.com/fchollet/keras" ext-link-type="uri">github.com/fchollet/keras</ext-link>) and TensorFlow (<ext-link xlink:href="http://tensorflow.org" ext-link-type="uri">tensorflow.org</ext-link>). The peptides are first encoded using the blosum62 similarity matrix (<xref rid="btab687-B5" ref-type="bibr">Henikoff and Henikoff, 1992</xref>). In the schema, this corresponds to filling the input table with the blosum62 similarity between the residue (row) and the amino acid type (column). To deal with the different lengths in the peptide sets, the symbol ‘-’ representing the absence of further residues was introduced and added at the end of all peptides in the training set so that their lengths match. The convolutional layer applies different filters (only one is illustrated in the schema) to all overlapping <italic toggle="yes">l</italic>-mers in the peptide, where <italic toggle="yes">l</italic> is a user defined parameter, typically <italic toggle="yes">l </italic>=<italic toggle="yes"> </italic>9 in applications related to MHC class II. The ReLu activation layer sets all negative outputs to zero. The MaxPool layer will select the highest outputs and the dense layer will connect the results to generate the output, i.e. the predicted binding score. The final model is an equally weighted ensemble of CNNs, resulting from different numbers of filters in the convolutional layer times the number of initial configurations.</p>
    <p>Both NNAlign and CNN-PepPred use a blosum encoding. The main difference between the two methods is that while NNAlign uses a two-step procedure that identifies a core <italic toggle="yes">l</italic>-mer within a peptide and then applies a network weight configuration to the core (and flanking regions) to generate the output, CNN-PepPred uses convolution to slide through all possible overlapping <italic toggle="yes">l</italic>-mers and subsequent layers to activate them and generate the output. In other words, CNN-PepPred does not select a core binder but makes full use of all overlapping <italic toggle="yes">l</italic>-mers within the peptide, and what may be considered the core binder is the overlapping <italic toggle="yes">l</italic>-mer that is most activated during the feed-forward pass.</p>
    <p>The tool contains many functionalities that can be conveniently called by filling a simple template. Users can train their own models, evaluate them through cross-validation, save them and apply them to new data (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1A</xref>). It is also possible to visualize the binding motif of a trained model with <italic toggle="yes">Logomaker</italic> (<xref rid="btab687-B11" ref-type="bibr">Tareen and Kinney, 2020</xref>). For more insight on the feed-forward pass on a selected peptide set, the user can also print all layers and corresponding outputs of the trained model. In addition, advanced users may incorporate the CNNPepPred class, providing all the functionality, to other Python developments.</p>
    <p>When applied to HLA class II binding, using 51 alleles with data curated by the IEDB (<ext-link xlink:href="http://www.iedb.org" ext-link-type="uri">www.iedb.org</ext-link>), our tool showed significant improvement over NNAlign-2.1 (<xref rid="btab687-B7" ref-type="bibr">Nielsen and Andreatta, 2017</xref>) in predictive performance (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Information</xref>). We used the T-cell epitope benchmark dataset from <xref rid="btab687-B6" ref-type="bibr">Jensen <italic toggle="yes">et al.</italic> (2018)</xref> as an independent evaluation set for the models trained with the data retrieved from IEDB. CNN-PepPred was found to perform better on average than NetMHCIIpan-3.2 (<xref rid="btab687-B6" ref-type="bibr">Jensen <italic toggle="yes">et al.</italic>, 2018</xref>), although the results were overall similar as shown in Appendix D of the User’s guide. Appendix C contains also a cross-validation comparison with the data from NetMHCII-2.3 and NetMHCIIpan-3.2, giving overall similar results. Note that the latter two tools cannot be used themselves to train new models.</p>
    <p>In <xref rid="sup1" ref-type="supplementary-material">Supplementary Appendices SB.2 and SC.2</xref>, we compared computation times for CNN-PepPred, NNAlign and NetMHCIIpan, showing that, for the specific CPU and GPU used, CNN-PepPred compares well to NNAlign for training and clearly outperforms NetMHCIIpan for prediction, NNAlign being the faster prediction tool.</p>
    <p>The github repository contains two main Python scripts, one with the CNNPepPred class and one that uses this class following a template filled by the user. The class was written so that it could be also used independently from the template. The User’s Guide contains a full description of the class, its parameters, the template, the model, the visualization, the IEDB data and the benchmarking.</p>
    <p>The core training algorithm of CNN-PepPred consists only of a few Keras lines of code. It can, therefore, be also used independently from the tool, as a starting point for further analysis and/or generalizations that could fit other types of peptide sets. Thanks to the ease of use of libraries like Keras and TensorFlow, the implementation does not require the developer to fully implement specific feed-forward/back-propagation passes that would fit one type of data. The CNN-PepPred code is provided under an open-source license.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btab687_Supplementary_Data</label>
      <media xlink:href="btab687_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgement</title>
    <p>The authors thank Judith Farrés and José M Mas from Anaxomics Biotech SL for their support and helpful discussions.</p>
    <sec>
      <title>Funding</title>
      <p>This project received funding from the European Union’s Horizon 2020 research and innovation programme under the Marie Skłodowska-Curie [765158] (COSMIC; <ext-link xlink:href="http://www.cosmic-h2020.eu" ext-link-type="uri">www.cosmic-h2020.eu</ext-link>) and from the Spanish Ministry for Science, Innovation and Universities [PID2019-111364RB-I00].</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btab687-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alvarez</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>NNAlign_MA; MHC peptidome deconvolution for accurate MHC binding motif characterization and improved T-cell epitope predictions</article-title>. <source>Mol. Cell. Proteom</source>., <volume>18</volume>, <fpage>2459</fpage>–<lpage>2477</lpage>.</mixed-citation>
    </ref>
    <ref id="btab687-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Andreatta</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Accurate pan-specific prediction of peptide–MHC class II binding affinity with improved binding core identification</article-title>. <source>Immunogenetics</source>, <volume>67</volume>, <fpage>641</fpage>–<lpage>650</lpage>.<pub-id pub-id-type="pmid">26416257</pub-id></mixed-citation>
    </ref>
    <ref id="btab687-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Caron</surname><given-names>E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Analysis of major histocompatibility complex (MHC) immunopeptidomes using mass spectrometry</article-title>. <source>Mol. Cell. Proteom</source>., <volume>14</volume>, <fpage>3105</fpage>–<lpage>3117</lpage>.</mixed-citation>
    </ref>
    <ref id="btab687-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Predicting HLA class II antigen presentation through integrated deep learning</article-title>. <source>Nat. Biotechnol</source>, <volume>37</volume>, <fpage>1332</fpage>–<lpage>1343</lpage>.<pub-id pub-id-type="pmid">31611695</pub-id></mixed-citation>
    </ref>
    <ref id="btab687-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Henikoff</surname><given-names>S.</given-names></string-name>, <string-name><surname>Henikoff</surname><given-names>J.G.</given-names></string-name></person-group> (<year>1992</year>) <article-title>Amino acid substitution matrices from protein blocks</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>89</volume>, <fpage>10915</fpage>–<lpage>10919</lpage>.<pub-id pub-id-type="pmid">1438297</pub-id></mixed-citation>
    </ref>
    <ref id="btab687-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jensen</surname><given-names>K.K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Improved methods for predicting peptide binding affinity to MHC class II molecules</article-title>. <source>Immunology</source>, <volume>154</volume>, <fpage>394</fpage>–<lpage>406</lpage>.<pub-id pub-id-type="pmid">29315598</pub-id></mixed-citation>
    </ref>
    <ref id="btab687-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nielsen</surname><given-names>M.</given-names></string-name>, <string-name><surname>Andreatta</surname><given-names>M.</given-names></string-name></person-group> (<year>2017</year>) <article-title>NNAlign: a platform to construct and evaluate artificial neural network models of receptor-ligand interactions</article-title>. <source>Nucleic Acids Res</source>., <volume>45</volume>, <fpage>W344</fpage>–<lpage>W349</lpage>.<pub-id pub-id-type="pmid">28407117</pub-id></mixed-citation>
    </ref>
    <ref id="btab687-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nielsen</surname><given-names>M.</given-names></string-name>, <string-name><surname>Lund</surname><given-names>O.</given-names></string-name></person-group> (<year>2009</year>) <article-title>NN-align. An artificial neural network-based alignment algorithm for MHC class II peptide binding prediction</article-title>. <source>BMC Bioinformatics</source>, <volume>10</volume>, <fpage>296</fpage>.<pub-id pub-id-type="pmid">19765293</pub-id></mixed-citation>
    </ref>
    <ref id="btab687-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Racle</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Robust prediction of HLA class II epitopes by deep motif deconvolution of immunopeptidomes</article-title>. <source>Nat. Biotechnol</source>., <volume>37</volume>, <fpage>1283</fpage>–<lpage>1286</lpage>.<pub-id pub-id-type="pmid">31611696</pub-id></mixed-citation>
    </ref>
    <ref id="btab687-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Reynisson</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>NetMHCpan-4.1 and NetMHCIIpan-4.0: improved predictions of MHC antigen presentation by concurrent motif deconvolution and integration of MS MHC eluted ligand data</article-title>. <source>Nucleic Acids Res</source>., <volume>48</volume>, <fpage>W449</fpage>–<lpage>W454</lpage>.<pub-id pub-id-type="pmid">32406916</pub-id></mixed-citation>
    </ref>
    <ref id="btab687-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tareen</surname><given-names>A.</given-names></string-name>, <string-name><surname>Kinney</surname><given-names>J.B.</given-names></string-name></person-group> (<year>2020</year>) <article-title>Logomaker: beautiful sequence logos in Python</article-title>. <source>Bioinformatics</source>, <volume>36</volume>, <fpage>2272</fpage>–<lpage>2274</lpage>.<pub-id pub-id-type="pmid">31821414</pub-id></mixed-citation>
    </ref>
    <ref id="btab687-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) <article-title>Peptide binding predictions for HLA DR, DP and DQ molecules</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>, <fpage>568</fpage>.<pub-id pub-id-type="pmid">21092157</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
