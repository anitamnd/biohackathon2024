<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">1764210</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-7-530</article-id>
    <article-id pub-id-type="pmid">17166258</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-7-530</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MathDAMP: a package for differential analysis of metabolite profiles</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" contrib-type="author">
        <name>
          <surname>Baran</surname>
          <given-names>Richard</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>richard.baran@gmail.com</email>
      </contrib>
      <contrib id="A2" contrib-type="author">
        <name>
          <surname>Kochi</surname>
          <given-names>Hayataro</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>haya@sfc.keio.ac.jp</email>
      </contrib>
      <contrib id="A3" contrib-type="author">
        <name>
          <surname>Saito</surname>
          <given-names>Natsumi</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>natsumi@ttck.keio.ac.jp</email>
      </contrib>
      <contrib id="A4" contrib-type="author">
        <name>
          <surname>Suematsu</surname>
          <given-names>Makoto</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>msuem@sc.itc.keio.ac.jp</email>
      </contrib>
      <contrib id="A5" contrib-type="author">
        <name>
          <surname>Soga</surname>
          <given-names>Tomoyoshi</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>soga@sfc.keio.ac.jp</email>
      </contrib>
      <contrib id="A6" contrib-type="author">
        <name>
          <surname>Nishioka</surname>
          <given-names>Takaaki</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>takaaki@sfc.keio.ac.jp</email>
      </contrib>
      <contrib id="A7" corresp="yes" contrib-type="author">
        <name>
          <surname>Robert</surname>
          <given-names>Martin</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>mrobert@ttck.keio.ac.jp</email>
      </contrib>
      <contrib id="A8" contrib-type="author">
        <name>
          <surname>Tomita</surname>
          <given-names>Masaru</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>mt@sfc.keio.ac.jp</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Institute for Advanced Biosciences, Keio University, Tsuruoka, Yamagata 997-0017, Japan</aff>
    <aff id="I2"><label>2</label>Department of Biochemistry and Integrative Medical Biology, School of Medicine, Keio University, Shinanomachi, Shinjuku-ku, Tokyo 160-8582, Japan</aff>
    <aff id="I3"><label>3</label>Present address: Institute of Chemistry, Slovak Academy of Sciences, Dúbravská cesta 9, 845 38 Bratislava, Slovakia</aff>
    <pub-date pub-type="collection">
      <year>2006</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>12</month>
      <year>2006</year>
    </pub-date>
    <volume>7</volume>
    <fpage>530</fpage>
    <lpage>530</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/7/530"/>
    <history>
      <date date-type="received">
        <day>2</day>
        <month>6</month>
        <year>2006</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>12</month>
        <year>2006</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2006 Baran et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2006</copyright-year>
      <copyright-holder>Baran et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Baran
               Richard
               
               
               richard.baran@gmail.com
            </dc:author><dc:title>
            MathDAMP: a package for differential analysis of metabolite profiles
         </dc:title><dc:date>2006</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 7(1): 530-. (2006)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2006)7:1&#x0003c;530&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>With the advent of metabolomics as a powerful tool for both functional and biomarker discovery, the identification of specific differences between complex metabolite profiles is becoming a major challenge in the data analysis pipeline. The task remains difficult, given the datasets' size, complexity, and common shifts in migration (elution/retention) times between samples analyzed by hyphenated mass spectrometry methods.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We present a Mathematica (Wolfram Research, Inc.) package MathDAMP (Mathematica package for Differential Analysis of Metabolite Profiles), which highlights differences between raw datasets acquired by hyphenated mass spectrometry methods by applying arithmetic operations to all corresponding signal intensities on a datapoint-by-datapoint basis. Peak identification and integration is thus bypassed and the results are displayed graphically.</p>
        <p>To facilitate direct comparisons, the raw datasets are automatically preprocessed and normalized in terms of both migration times and signal intensities. A combination of dynamic programming and global optimization is used for the alignment of the datasets along the migration time dimension.</p>
        <p>The processed datasets and the results of direct comparisons between them are visualized using density plots (axes represent migration time and m/z values while peaks appear as color-coded spots) providing an intuitive overall view. Various forms of comparisons and statistical tests can be applied to highlight subtle differences. Overlaid electropherograms (chromatograms) corresponding to the vicinities of the candidate differences from any result may be generated in a descending order of significance for visual confirmation. Additionally, a standard library table (a list of m/z values and migration times for known compounds) may be aligned and overlaid on the plots to allow easier identification of metabolites.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>Our tool facilitates the visualization and identification of differences between complex metabolite profiles according to various criteria in an automated fashion and is useful for data-driven discovery of biomarkers and functional genomics.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>The identification of specific differences between metabolite profiles plays a prominent role in metabolomic data analysis and can be useful for the discovery of biomarkers or the characterization of specific biological activities. Hyphenated mass spectrometry methods (GC-MS, LC-MS, CE-MS, etc.) are among the most common analytical tools for metabolomics. Most produce large datasets that are not easily interpretable using the software provided by most instrument manufacturers. The common data analysis workflow, starting from raw data, usually includes the detection of peaks, their integration, matching of corresponding peaks across datasets and subsequent multivariate analysis [<xref ref-type="bibr" rid="B1">1</xref>]. Several tools enabling automation of the procedure are available [<xref ref-type="bibr" rid="B2">2</xref>-<xref ref-type="bibr" rid="B7">7</xref>], but the overall task still proves challenging given the datasets' size, complexity, common shifts in migration times between datasets, and the need to identify metabolites. In addition, some of these tools either provide only partial solutions (generation of integrated peak lists) or were developed for a specific type of analysis (e.g. GC-MS) and some alignment algorithms may not be very robust when migration time differences are large and the composition of samples is highly variable. Moreover, automated peak picking and integration remains an important challenge that is complicated by the wide range of peak intensities, sometimes poor separation of compounds and the resulting distorted peak shapes, leading to multiple incorrect assignments of differences. While visual exploration of the raw data has been used to complement automated data analysis [<xref ref-type="bibr" rid="B8">8</xref>], this often comes at the expense of convenience and versatility. Direct chromatogram comparisons bypass peak picking and integration to select areas of interest from raw data or to locate differences between metabolite profiles [<xref ref-type="bibr" rid="B9">9</xref>]. To apply direct chromatogram comparisons as a complement or an alternative to the multivariate analysis of integrated peak lists, automation of the processing of raw data along with suitable visualization and metabolite identification methods are desirable. With MathDAMP, we provide a complete series of such tools, capable of providing an overall view of the differences between metabolite profiles according to different criteria. The functionality of the package is demonstrated with CE-MS data, which is particularly challenging due to the more significant migration time shifts, but the tools can be used for other types of hyphenated mass spectrometry methods as well.</p>
  </sec>
  <sec>
    <title>Implementation</title>
    <p>Differences between metabolite profiles in MathDAMP are highlighted by applying arithmetic operations to all corresponding signal intensities from whole raw datasets on a datapoint-by-datapoint basis. To facilitate this, the datasets are processed into rectangular matrices and normalized in terms of both migration time and signal intensities. The results are visualized on density plots (also referred to as color maps or heat maps) providing a global view of the differences between samples. The main features of the package are briefly outlined below. A detailed description of the implementation and usage is part of the online documentation [<xref ref-type="bibr" rid="B10">10</xref>].</p>
    <sec>
      <title>Preprocessing</title>
      <p>Raw datasets are binned along the m/z dimension to a specified resolution upon loading. Baselines may be subtracted by fitting the individual electropherograms to any user specified function (first order polynomial by default) by robust nonlinear regression as described by Ruckstuhl <italic>et al</italic>. [<xref ref-type="bibr" rid="B11">11</xref>]. However, the regression is performed in a global fashion in our implementation. Following baseline subtraction, noise may be removed from individual electropherograms by leveling to 0 all signal intensities falling within a threshold. By default, the threshold is calculated for every electropherogram as a specific multiple (5) of a standard deviation of signal intensities from a specified region of the electropherogram where no signals are expected (1 – 3 min). The datasets may be smoothed by applying predefined or user specified smoothing filters to all electropherograms in the dataset. Additionally, the datasets may be cropped along both the m/z and migration time dimensions.</p>
    </sec>
    <sec>
      <title>Normalization</title>
      <p>Sample datasets are normalized to a reference dataset (e.g. one of the sample datasets) on a pairwise basis. For the purpose of the dataset alignment along the migration time dimension, a representative set of peaks is picked from all datasets using a modified Douglas-Peucker algorithm as described by Wallace <italic>et al</italic>. [<xref ref-type="bibr" rid="B12">12</xref>]. Raw migration times are used for all calculations. Using this approach, individual electropherograms are segmented into parts determined by strategic points. Initially, only the endpoints of an electropherogram are set to be the strategic points. Additional strategic points are assigned recursively to a datapoint in the electropherogram with the biggest orthogonal distance from a line connecting two neighboring strategic points. This distance must be above a specified threshold to avoid picking noise-related peaks. Vertical distance instead of an orthogonal distance is used in our implementation for the assignment of new strategic points. Strategic points with two neighboring strategic points having a smaller signal intensity are selected as peaks. The corresponding migration times may then be calculated as centroids from datapoints falling within a specified vicinity (time range) of the selected strategic points. The alignment of datasets along the migration time dimension is achieved by dynamic time warping (DTW) with an explicitly specified time shift (warping) function as described previously [<xref ref-type="bibr" rid="B13">13</xref>]. Any mathematical function can be specified as the time shift function. Optimal parameters for the time shift function are calculated for all sample datasets by combining dynamic programming (DP) and global optimization methods. The parameters of the time shift function are optimized to achieve the lowest sum of DP scores from all corresponding electropherograms. The DP scores are calculated by setting the partial scores to the distance between the two peaks of a subproblem (or a gap penalty value). The optimized time shift function is then used to rescale the timescale on the sample dataset (Figure <xref ref-type="fig" rid="F1">1</xref>). Signal intensities are adjusted to compensate for the compression or expansion of the peaks during time warping and thus conserve their areas. All electropherograms in the aligned sample datasets are interpolated and timepoints identical to those in the reference dataset are selected.</p>
      <fig position="float" id="F1">
        <label>Figure 1</label>
        <caption>
          <p><bold>Peak picking and migration time alignment</bold>. (a) Visualization of the position of peaks picked from cation datasets acquired by CE-TOFMS. The data originates from a previous analysis of mouse liver extracts after treatment with acetaminophen [13]. (b) The peak sets were aligned to the peak set from Sample 1 using the alignment procedure described in the main text. The function derived by Reijenga <italic>et al</italic>. [14] for the normalization of migration times in CE was used as the time shift function.</p>
        </caption>
        <graphic xlink:href="1471-2105-7-530-1"/>
      </fig>
      <p>A standard library table (a list of m/z values and migration times for known compounds) may be aligned to the reference dataset using the same procedure. The aligned standard library table can later be used to annotate the plots or for the automatic localization of the peaks of the internal standard as described below.</p>
      <p>Signal intensities in the sample datasets may be normalized according to a specified list of normalization coefficients (e.g. originating from the sample weights). Additionally, the signal intensities may be normalized according to the peaks of the internal standard. These peaks are then integrated in all datasets after alignment. The location of the peak of the internal standard in the reference dataset may be either specified explicitly or it may be extrapolated from the aligned standard library table. In the latter case, the user specifies only the name of the compound to serve as the internal standard.</p>
    </sec>
    <sec>
      <title>Result datasets</title>
      <p>Following dataset normalization, various forms of direct comparisons may be performed to find differences between two or multiple datasets. Arithmetic operations or statistical tests are then applied to all corresponding signal intensities. The resulting dataset(s) has the same structure and dimensions as the compared datasets. Any processed, normalized, or result dataset can be easily exported as text or in binary format using Mathematica's built-in data export functionality.</p>
      <p>To compare two datasets, the simplest way to highlight differences between them is to subtract the corresponding signal intensities (absolute difference). Alternately, dividing this difference by the larger of the two signal intensities provides a measure of the relative difference. Multiplying the corresponding signal intensities of the absolute and relative difference results highlights differences significant in both absolute and relative terms (absolute × relative difference). </p>
      <p>Outlier signals within a group of datasets may be located by calculating <italic>z</italic>-scores or by quartile analysis. A specified number of outliers may be removed from a set of corresponding signal intensities prior to <italic>z</italic>-score calculation. This limits the disproportionate influence of eventual outliers on the mean and standard deviation of the set which may lead to undesirably low <italic>z</italic>-score values. The result for the quartile-based analysis, an alternative to <italic>z</italic>-scores, is calculated as a difference between a specific signal intensity value and the third quartile (if it is smaller than the value) or the first quartile (if it is greater than the value) of the corresponding set, divided by the interquartile range. The result is set to 0 if the value lies between the first and the third quartile.</p>
      <p>To compare two groups of replicate datasets, averaged datasets for both groups are calculated after normalization and these are used to generate the absolute, relative, and absolute × relative difference results. Additionally, <italic>t</italic>-scores are calculated for all groups of corresponding signal intensities. The resulting dataset may be used to directly identify the differences or to filter the absolute × relative result to remove statistically less significant differences (Figure <xref ref-type="fig" rid="F2">2</xref>).</p>
      <fig position="float" id="F2">
        <label>Figure 2</label>
        <caption>
          <p><bold>Comparison of two groups of replicate datasets</bold>. Visualization of an absolute × relative difference result between the averages of two groups of replicate cation datasets (n = 4). The result was further filtered as described in the main text with a <italic>t</italic>-score threshold of 3.71 (corresponding <italic>p </italic>= 0.01 when comparing two groups of four replicate values). The initial <italic>t</italic>-score dataset was smoothed by applying a moving average filter (window size 9) prior to filtering the absolute × relative result. Red color indicates signals with higher levels in Set 2, blue color indicates signals with lower levels in Set 2. The underlying datasets originate from previous work [13].</p>
        </caption>
        <graphic xlink:href="1471-2105-7-530-2"/>
      </fig>
      <p>An F ratio (one-way ANOVA) is used to find differences between multiple groups of replicated datasets. The F ratio, <italic>t</italic>-score, <italic>z</italic>-score, and quartile-based result datasets may be smoothed to suppress signals resulting from individual coinciding noise-related signal intensities. Details and template notebooks for the differential analysis approaches described above are part of the online documentation [<xref ref-type="bibr" rid="B10">10</xref>]. Additionally, any custom function to process corresponding signal intensities from datasets under comparison may be defined to highlight any difference or any pattern of interest.</p>
    </sec>
    <sec>
      <title>Visualization</title>
      <p>The sample datasets and the results of differential analyses are visualized using density plots. The axes represent the migration time and m/z values. Peaks appear as color-coded spots characteristic of the signal intensity (Figure <xref ref-type="fig" rid="F2">2</xref>). Multiple datasets may also be interlaced into each other so that electropherograms corresponding to the same m/z value appear next to each other on density plot (parallel plot) allowing to simultaneously explore the whole profiles. For any of the different types of results, plots displaying overlaid electropherograms for time ranges adjacent to the candidate differences can be generated in a descending order of significance to facilitate visual inspection and identification of false positives (Figure <xref ref-type="fig" rid="F3">3</xref>). The aligned standard library table may be used to place annotation labels directly on the density plots and electropherograms to allow easier identification of metabolites (Figure <xref ref-type="fig" rid="F2">2</xref>, <xref ref-type="fig" rid="F3">3</xref>).</p>
      <fig position="float" id="F3">
        <label>Figure 3</label>
        <caption>
          <p><bold>Visualization of candidate differences as extracted ion electropherograms</bold>. Overlaid electropherograms from aligned and normalized datasets corresponding to the vicinities of the 20 most significant differences in the dataset shown in Figure 2. The underlying datasets originate from previous work [13].</p>
        </caption>
        <graphic xlink:href="1471-2105-7-530-3"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>Results and discussion</title>
    <sec>
      <title>Preprocessing</title>
      <p>The binning of raw datasets along the m/z dimension facilitates their processing into a rectangular matrix format. For datasets with high resolution along the m/z dimension (such as those originating from TOF instruments), binning provides a significant decrease in size and resolution suitable for visual inspection. Choosing a wider bin size may, however, lead to an undesirable dilution of weak signals in noise. This can be overcome by first performing the baseline subtraction and noise removal on datasets binned using a narrow binning window. The resulting datasets may then be binned to a resolution suitable for visual inspection.</p>
    </sec>
    <sec>
      <title>Normalization</title>
      <p>A representative set of peaks is picked from the datasets for the purpose of migration time alignment. We modified the peak picking algorithm described above to use the maximum vertical distance from the line connecting two neighboring strategic points as a criteria for a new strategic point. This was done to avoid the necessity to normalize the migration time scale and the signal intensity scale prior to peak picking. However, by using the vertical distance, many datapoints within a peak fulfill the criteria of being above the vertical distance threshold. Excessive strategic point selection is suppressed by specifying a minimum distance between neighboring strategic points. The minimum distance is, by default, set to a quarter of a typical peak width so that the excluded time window in the vicinity of strategic points corresponding to the peak top and to the peak base partially or almost completely overlap.</p>
      <p>Results of the migration time normalization/alignment are shown in Figure <xref ref-type="fig" rid="F1">1</xref>. As can be seen, the migration time shifts are significant between the original samples and the trend toward larger shifts with increasing migration time is apparent (Figure <xref ref-type="fig" rid="F1">1a</xref>). The quality of the overall alignment procedure can be seen in Figure <xref ref-type="fig" rid="F1">1b</xref>. The quality of the alignment is rather uniform over time. Isolated symbols do not correspond to misaligned peaks but rather to peaks higher than the peak picking threshold present only in certain datasets.</p>
      <p>The alignment procedure described above proved robust to the presence of a large number of non-corresponding peaks between two aligned datasets. A small number of corresponding peaks picked from the datasets proved sufficient to find the optimal parameters of the time shift function. Given the robustness of the alignment procedure, missing peaks or erroneous peak picking do not significantly affect the quality of the alignment.</p>
      <p>An iterative two-step alignment procedure proved beneficial for datasets with significant time shifts between corresponding peaks. To achieve a good alignment, a small gap penalty value is desirable to limit the number of non-corresponding peaks that are close enough in corresponding electropherograms to fall within the gap penalty and thus affect the alignment. However, when a small gap penalty is used for the alignment of datasets with large time shifts, the optimization procedure may not find the region of convergence to the global optimum. Therefore, a bigger gap penalty value is used first to generate an approximate alignment. The second alignment is then performed with a smaller gap penalty value starting with the parameters of the time shift function obtained from the primary approximate alignment. The DTW implementation of MathDAMP employs explicit time shift function specification. Generic time shift functions (such as polynomials or splines) may be specified for dataset alignment. Alternately, time shift functions incorporating a priori knowledge about the expected time shifts, as for example migration time normalization function for CE [<xref ref-type="bibr" rid="B14">14</xref>], may be used. Using explicit time shift functions provides the ability to control the flexibility or the rigidity of time warping. This may prove beneficial for some applications as improvement of alignment results of unconstrained DTW [<xref ref-type="bibr" rid="B15">15</xref>], by introducing rigid slope constraints, was reported [<xref ref-type="bibr" rid="B16">16</xref>]. Additionally, other existing alignment algorithms [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B17">17</xref>-<xref ref-type="bibr" rid="B20">20</xref>], that could also be implemented in MathDAMP, may hold advantages for specific applications.</p>
      <p>As described above, the method to identify differences in profiles is not based on integrated peak lists and thus avoids common quantitative errors introduced by this task. It is important to realize that the described peak picking is used only for the purpose of alignment which as we described is very robust to possible peak picking errors.</p>
    </sec>
    <sec>
      <title>Data visualization</title>
      <p>The density plot visualizations provide an overall intuitive view of the differences between samples (Figure <xref ref-type="fig" rid="F2">2</xref>). Peaks appear as colored spots of intensity corresponding to the magnitude of the differences between samples/groups. As described above, multiple alternative approaches for highlighting a difference of interest are available. Since different approaches may possess different strengths and weaknesses, evaluating them in parallel decreases the chance of missing an important difference.</p>
      <p>The proper alignment of the datasets is a necessary prerequisite to obtain clear results. Misaligned peaks can lead to ambiguous signals on the density plots (e.g. appearing as doublets of opposite polarity red-blue) but these fortunately can be ruled out as false positives by visually exploring the overlaid electropherograms of the top candidate differences (Figure <xref ref-type="fig" rid="F3">3</xref>). The confirmation plots are thus an essential and easy way to identify false-positive signals since at this point there are no simple means to automate this process. Specific sources of ambiguous signals and possible ways to suppress their occurrence, as well as potential strengths and weaknesses of alternative approaches, for different kinds of differential analysis, are described in more detail in the respective example notebooks which are part of the online documentation [<xref ref-type="bibr" rid="B10">10</xref>].</p>
      <p>The ability of MathDAMP to identify specific differences in complex metabolite profiles has been successfully demonstrated, leading to the discovery of a biomarker for liver oxidative stress [<xref ref-type="bibr" rid="B13">13</xref>] as well as facilitating enzyme activity detection and discovery in known and non-characterized proteins using non-targeted CE-MS analysis of complex substrate cocktails [<xref ref-type="bibr" rid="B21">21</xref>]. Overall, the MathDAMP tools can be seen as complementary to other methods that make use of integrated peak lists to find differences in profiles using downstream multivariate analysis. While both approaches may have limitations, MathDAMP can considerably simplify differential analysis of metabolite profiles that are very similar and is very robust to widely varying migration times and irregular peak shape.</p>
    </sec>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>The MathDAMP package is capable of highlighting differences between complex metabolite profiles according to various criteria in an automated fashion. Since the whole (preprocessed and normalized) raw datasets are compared, the possibility of loss of information (e.g. due to common but unavoidable mistakes in peak picking or peak identification) is limited. MathDAMP differs from most other existing tools by combining very robust migration time normalization with a point-by-point approach to the identification of differences in profiles, facilitates the identification of metabolites, and provides multiple different ways in which data and differences in profiles can be visualized and analyzed. Moreover, the open architecture of the MathDAMP modules allows user to adjust multiple options to fit particular purposes or type of analytical method and offers extensive customizability for any user willing to manipulate the Mathematica code and potentially quickly implement any desirable new features. The current release does not provide quantification of compounds per se, something that is planned for future development. However, it is especially well-suited to highlight subtle differences between complex metabolite profiles.</p>
  </sec>
  <sec>
    <title>Availability and requirements</title>
    <p>• <bold>Project name: </bold>MathDAMP</p>
    <p>• <bold>Project home page: </bold><ext-link ext-link-type="uri" xlink:href="http://mathdamp.iab.keio.ac.jp/"/></p>
    <p>• <bold>Operating system(s): </bold>Platform independent</p>
    <p>• <bold>Programming language: </bold>Mathematica</p>
    <p>• <bold>Other requirements: </bold>Mathematica 4.2 or higher</p>
    <p>• <bold>License: </bold>free</p>
  </sec>
  <sec>
    <title>Abbreviations</title>
    <p>CE – capillary electrophoresis</p>
    <p>DP – dynamic programming</p>
    <p>GC – gas chromatography</p>
    <p>LC – liquid chromatography</p>
    <p>MS – mass spectrometry</p>
    <p>TOFMS – time-of-flight mass spectrometry</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>MR conceived the approach of visualizing direct comparisons between raw metabolite profiles to highlight specific differences. RB, HK, TS, TN, MR, and MT suggested desired features and algorithmic approaches. RB carried out the implementation. HK, NS, MS, TS, and MR provided experimental data and supported the evaluation of the package. The online documentation and the manuscript were written by RB and MR with inputs from all co-authors.</p>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>The authors would like to thank Tsuyoshi Iwasaki, Gabor Bereczki, Masahiro Sugimoto, and Yuji Kakazu of the Institute for Advanced Biosciences and Takamasa Ishikawa and Yuki Ueno of Human Metabolome Technologies, Inc. for technical help and support. This work was supported in parts by grants from the Ministry of Education, Culture, Sports, Science and Technology (MEXT) including Leading Project for Biosimulation and the 21st Century COE Program entitled "Understanding and Control of Life's Function via Systems Biology" as well as research funds from Tsuruoka City and the Yamagata Prefectural Government.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goodacre</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vaidyanathan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dunn</surname>
            <given-names>WB</given-names>
          </name>
          <name>
            <surname>Harrigan</surname>
            <given-names>GG</given-names>
          </name>
          <name>
            <surname>Kell</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Metabolomics by numbers: acquiring and understanding global metabolite data</article-title>
        <source>Trends Biotechnol</source>
        <year>2004</year>
        <volume>22</volume>
        <fpage>245</fpage>
        <lpage>252</lpage>
        <pub-id pub-id-type="pmid">15109811</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.tibtech.2004.03.007</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Duran</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sumner</surname>
            <given-names>LW</given-names>
          </name>
        </person-group>
        <article-title>Metabolomics spectral formatting, alignment and conversion tools (MSFACTs)</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>2283</fpage>
        <lpage>2293</lpage>
        <pub-id pub-id-type="pmid">14630657</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btg315</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tikunov</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lommen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>de Vos</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Verhoeven</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Bino</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Bovy</surname>
            <given-names>AG</given-names>
          </name>
        </person-group>
        <article-title>A Novel Approach for Nontargeted Data Analysis for Metabolomics. Large-Scale Profiling of Tomato Fruit Volatiles</article-title>
        <source>Plant Physiol</source>
        <year>2005</year>
        <volume>139</volume>
        <fpage>1125</fpage>
        <lpage>1137</lpage>
        <pub-id pub-id-type="pmid">16286451</pub-id>
        <pub-id pub-id-type="doi">10.1104/pp.105.068130</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katajamaa</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Miettinen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Oresic</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>MZmine: toolbox for processing and visualization of mass spectrometry based molecular profile data</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>634</fpage>
        <lpage>636</lpage>
        <pub-id pub-id-type="pmid">16403790</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btk039</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Want</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>O'Maille</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Abagyan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Siuzdak</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>XCMS: processing mass spectrometry data for metabolite profiling using nonlinear peak alignment, matching, and identification</article-title>
        <source>Anal Chem</source>
        <year>2006</year>
        <volume>78</volume>
        <fpage>779</fpage>
        <lpage>787</lpage>
        <pub-id pub-id-type="pmid">16448051</pub-id>
        <pub-id pub-id-type="doi">10.1021/ac051437y</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Broeckling</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Reddy</surname>
            <given-names>IR</given-names>
          </name>
          <name>
            <surname>Duran</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Sumner</surname>
            <given-names>LW</given-names>
          </name>
        </person-group>
        <article-title>MET-IDEA: data extraction tool for mass spectrometry-based metabolomics</article-title>
        <source>Anal Chem</source>
        <year>2006</year>
        <volume>78</volume>
        <fpage>4334</fpage>
        <lpage>41</lpage>
        <pub-id pub-id-type="pmid">16808440</pub-id>
        <pub-id pub-id-type="doi">10.1021/ac0521596</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nordstrom</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>O'Maille</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Qin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Siuzdak</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Nonlinear data alignment for UPLC-MS and HPLC-MS based metabolomics: quantitative analysis of endogenous and exogenous metabolites in human serum</article-title>
        <source>Anal Chem</source>
        <year>2006</year>
        <volume>78</volume>
        <fpage>3289</fpage>
        <lpage>3295</lpage>
        <pub-id pub-id-type="pmid">16689529</pub-id>
        <pub-id pub-id-type="doi">10.1021/ac060245f</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katz</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Dumlao</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hau</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A new technique (COMSPARI) to facilitate the identification of minor compounds in complex mixtures by GC/MS and LC/MS: tools for the visualisation of matched datasets</article-title>
        <source>J Am Soc Mass Spectrom</source>
        <year>2004</year>
        <volume>15</volume>
        <fpage>580</fpage>
        <lpage>584</lpage>
        <pub-id pub-id-type="pmid">15047062</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.jasms.2003.12.011</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shellie</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Welthagen</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Zrostlikova</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Spranger</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ristow</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fiehn</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Zimmermann</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Statistical methods for comparing comprehensive two-dimensional gas chromatography – time-of-flight mass spectrometry results: metabolomic analysis of mouse tissue extracts</article-title>
        <source>J Chromatogr A</source>
        <year>2005</year>
        <volume>1086</volume>
        <fpage>83</fpage>
        <lpage>90</lpage>
        <pub-id pub-id-type="pmid">16130658</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.chroma.2005.05.088</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="other">
        <article-title>MathDAMP</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://mathdamp.iab.keio.ac.jp/"/>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruckstuhl</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Jacobson</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Field</surname>
            <given-names>RW</given-names>
          </name>
          <name>
            <surname>Dodd</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Baseline subtraction using robust local regression estimation</article-title>
        <source>J Quant Spectrosc Radiat Transfer</source>
        <year>2001</year>
        <volume>68</volume>
        <fpage>179</fpage>
        <lpage>193</lpage>
        <pub-id pub-id-type="doi">10.1016/S0022-4073(00)00021-2</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wallace</surname>
            <given-names>WE</given-names>
          </name>
          <name>
            <surname>Kearsley</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Guttman</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <article-title>An Operator-Independent Approach to Mass Spectral Peak Identification and Integration</article-title>
        <source>Anal Chem</source>
        <year>2004</year>
        <volume>76</volume>
        <fpage>2446</fpage>
        <lpage>2452</lpage>
        <pub-id pub-id-type="pmid">15117182</pub-id>
        <pub-id pub-id-type="doi">10.1021/ac0354701</pub-id>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soga</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Baran</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Suematsu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ueno</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ikeda</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sakurakawa</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kakazu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ishikawa</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Robert</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nishioka</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tomita</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Differential metabolomics reveals ophthalmic acid as an oxidative stress biomarker indicating hepatic glutathione consumption</article-title>
        <source>J Biol Chem</source>
        <year>2006</year>
        <volume>281</volume>
        <fpage>16768</fpage>
        <lpage>16776</lpage>
        <pub-id pub-id-type="pmid">16608839</pub-id>
        <pub-id pub-id-type="doi">10.1074/jbc.M601876200</pub-id>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reijenga</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Martens</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Giuliani</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chiari</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Pherogram normalization in capillary electrophoresis and micellar electrokinetic chromatography analyses in cases of sample matrix-induced migration time shifts</article-title>
        <source>J Chromatogr B Analyt Technol Biomed Life Sci</source>
        <year>2002</year>
        <volume>770</volume>
        <fpage>45</fpage>
        <lpage>51</lpage>
        <pub-id pub-id-type="pmid">12013243</pub-id>
        <pub-id pub-id-type="doi">10.1016/S0378-4347(01)00527-8</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bylund</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Danielsson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Malmquist</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Markides</surname>
            <given-names>KE</given-names>
          </name>
        </person-group>
        <article-title>Chromatographic alignment by warping and dynamic programming as a pre-processing tool for PARAFAC modelling of liquid chromatography-mass spectrometry data</article-title>
        <source>J Chromatogr A</source>
        <year>2002</year>
        <volume>961</volume>
        <fpage>237</fpage>
        <lpage>244</lpage>
        <pub-id pub-id-type="pmid">12184621</pub-id>
        <pub-id pub-id-type="doi">10.1016/S0021-9673(02)00588-5</pub-id>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tomasi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Andersson</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Correlation optimized warping and dynamic time warping as preprocessing methods for chromatographic data</article-title>
        <source>J Chemom</source>
        <year>2004</year>
        <volume>18</volume>
        <fpage>231</fpage>
        <lpage>241</lpage>
        <pub-id pub-id-type="doi">10.1002/cem.859</pub-id>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nielsen</surname>
            <given-names>NPV</given-names>
          </name>
          <name>
            <surname>Carstensen</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Smedsgaard</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Aligning of single and multiple wavelength chromatographic profiles for chemometric data analysis using correlation optimised warping</article-title>
        <source>J Chromatogr A</source>
        <year>1998</year>
        <volume>805</volume>
        <fpage>17</fpage>
        <lpage>35</lpage>
        <pub-id pub-id-type="doi">10.1016/S0021-9673(98)00021-1</pub-id>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eilers</surname>
            <given-names>PH</given-names>
          </name>
        </person-group>
        <article-title>Parametric time warping</article-title>
        <source>Anal Chem</source>
        <year>2004</year>
        <volume>76</volume>
        <fpage>404</fpage>
        <lpage>411</lpage>
        <pub-id pub-id-type="pmid">14719890</pub-id>
        <pub-id pub-id-type="doi">10.1021/ac034800e</pub-id>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pierce</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Wood</surname>
            <given-names>LF</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>BW</given-names>
          </name>
          <name>
            <surname>Synovec</surname>
            <given-names>RE</given-names>
          </name>
        </person-group>
        <article-title>A comprehensive two-dimensional retention time alignment algorithm to enhance chemometric analysis of comprehensive two-dimensional separation data</article-title>
        <source>Anal Chem</source>
        <year>2005</year>
        <volume>77</volume>
        <fpage>7735</fpage>
        <lpage>7743</lpage>
        <pub-id pub-id-type="pmid">16316183</pub-id>
        <pub-id pub-id-type="doi">10.1021/ac0511142</pub-id>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prince</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Marcotte</surname>
            <given-names>EM</given-names>
          </name>
        </person-group>
        <article-title>Chromatographic Alignment of ESI-LC-MS Proteomics Data Sets by Ordered Bijective Interpolated Warping</article-title>
        <source>Anal Chem</source>
        <year>2006</year>
        <volume>78</volume>
        <fpage>6140</fpage>
        <lpage>6152</lpage>
        <pub-id pub-id-type="pmid">16944896</pub-id>
        <pub-id pub-id-type="doi">10.1021/ac0605344</pub-id>
      </citation>
    </ref>
    <ref id="B21">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saito</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Robert</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kitamura</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Baran</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Soga</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mori</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Nishioka</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tomita</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Metabolomics approach for enzyme discovery</article-title>
        <source>J Proteome Res</source>
        <year>2006</year>
        <volume>5</volume>
        <fpage>1979</fpage>
        <lpage>1987</lpage>
        <pub-id pub-id-type="pmid">16889420</pub-id>
        <pub-id pub-id-type="doi">10.1021/pr0600576</pub-id>
      </citation>
    </ref>
  </ref-list>
</back>
