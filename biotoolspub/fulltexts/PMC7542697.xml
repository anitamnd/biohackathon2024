<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7542697</article-id>
    <article-id pub-id-type="publisher-id">3741</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-020-03741-w</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Brain antibody sequence evaluation (BASE): an easy-to-use software for complete data analysis in single cell immunoglobulin cloning</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8132-3527</contrib-id>
        <name>
          <surname>Reincke</surname>
          <given-names>S. Momsen</given-names>
        </name>
        <address>
          <email>momsen.reincke@dzne.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Prüss</surname>
          <given-names>Harald</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kreye</surname>
          <given-names>Jakob</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label>German Center for Neurodegenerative Diseases (DZNE) Berlin, Berlin, Germany </aff>
      <aff id="Aff2"><label>2</label>Helmholtz Innovation Lab BaoBab (Brain antibody-omics and B-cell Lab), Berlin, Germany </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.484013.a</institution-id><institution>Berlin Institute of Health (BIH), </institution></institution-wrap>10178 Berlin, Germany </aff>
      <aff id="Aff4"><label>4</label>Charité – Universitätsmedizin Berlin, corporate member of Freie Universität Berlin, Humboldt-Universität zu Berlin, and Berlin Institute of Health, Department of Neurology and Experimental Neurology, Berlin, Germany </aff>
      <aff id="Aff5"><label>5</label>Charité - Universitätsmedizin Berlin, corporate member of Freie Universität Berlin, Humboldt-Universität zu Berlin, and Berlin Institute of Health, Department of Pediatric Neurology, Berlin, Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>10</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>10</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>446</elocation-id>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>11</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>7</day>
        <month>9</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Repertoire analysis of patient-derived recombinant monoclonal antibodies is an important tool to study the role of B cells in autoimmune diseases of the human brain and beyond. Current protocols for generation of patient-derived recombinant monoclonal antibody libraries are time-consuming and contain repetitive steps, some of which can be assisted with the help of software automation.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We developed BASE, an easy-to-use software for complete data analysis in single cell immunoglobulin cloning. BASE consists of two modules: aBASE for immunological annotations and cloning primer lookup, and cBASE for plasmid sequence identity confirmation before expression. Comparing automated BASE analysis with manual analysis we confirmed the validity of BASE output: identity between manual and automated aBASE analysis was 100% for all outputs, except for immunoglobulin isotype determination. In this case, aBASE yielded correct results in 96% of cases, whereas 4% of cases required manual confirmation. cBASE automatically concluded expression recommendations in 89.8% of cases, 91.8% of which were identical to manually derived results and none of them were false-positive.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">BASE offers an easy-to-use software solution suitable for complete Ig sequence data analysis and tracking during recombinant mAb cloning from single cells. Plasmid sequence identity confirmation by cBASE offers functionality not provided by existing software solutions in the field and will help to reduce time-consuming steps of the monoclonal antibody generation workflow. BASE can be installed locally or accessed online at Code Ocean.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Single cell</kwd>
      <kwd>B cell</kwd>
      <kwd>Antibody</kwd>
      <kwd>Immunoglobulin</kwd>
      <kwd>Sequence analysis</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par11">Repertoire analysis of patient-derived recombinant monoclonal antibodies (mAb) has become a state-of-the-art approach to investigate B cell (patho-)physiology and assess the role of (auto-)antibodies in disease progression in a variety of autoimmune and infectious diseases [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. Full repertoire data provide information about genetic composition for each single cell immunoglobulin (Ig), allowing identification of expanded Ig clones and providing insights into restrictions or enrichments of Ig gene usage in B cell populations [<xref ref-type="bibr" rid="CR3">3</xref>]. Moreover, recombinant expression approaches can generate libraries of purified mAbs which can be directly used in functional assays and further downstream applications.</p>
    <p id="Par12">In neuroscience, applying these approaches to cerebrospinal fluid (CSF)-derived cells has opened a rapidly developing field: Studying central nervous system mAb repertoires (brain antibody-omics) enables insights into the physiological or pathogenic role of (auto-)antibodies in health and disease. First CSF cell studies showed direct pathogenic effects of single autoimmune encephalitis patient-derived mAbs in vitro and in vivo [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR7">7</xref>], and also indicate local enrichment of disease-specific antibody-producing cells. Besides studying disease mechanisms, each CSF-derived mAb can potentially be used for the development of novel diagnostic or therapeutic applications [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>], strongly promoting further investigations of mAb repertoires in a broader spectrum of neuropsychiatric diseases. As CSF cell samples are challenging to obtain and typically have lower cell counts than samples from other body compartments, recombinant CSF cell cloning is naturally limited. Thus, protocols require optimization to increase successful expression rates from derived single cells in comparison to bulk approaches from blood samples.</p>
    <p id="Par13">Existing solutions for antibody sequence data analysis allow high-throughput processing in a database environment and are typically designed to work with next generation sequencing (NGS) [<xref ref-type="bibr" rid="CR10">10</xref>–<xref ref-type="bibr" rid="CR13">13</xref>]. These tools are designed to perform clonality analysis of bulk datasets. With the exception of sciReptor [<xref ref-type="bibr" rid="CR13">13</xref>], they are not designed to handle single-cell data, therefore Ig heavy and light chain pairing is not preserved, and expression of all cloned antibodies is not possible.</p>
    <p id="Par14">In CSF mAb studies, clonality analysis is less meaningful due to the low number of available cells compared to blood. We and others therefore focus on the identification and characterization of single mAbs with reactivity against a given auto-antigen. To this end, we identified three requirements for a software-assisted automated cloning pipeline, which are not yet fulfilled by available software solutions: (I) easy-to-access data in a human readable format; (II) data processing and cloning recommendations for all analyzed sequences in order to facilitate and optimize cloning efficiency from limited cell numbers, and (III) automated sequence data comparison from cloned plasmid genes to cDNA-derived sequences.</p>
    <p id="Par15">To address these requirements, we developed BASE (Brain Antibody Sequence Evaluation), an easy-to-use software solution suitable for complete Ig sequence data analysis and tracking during recombinant mAb cloning from single cells.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Design priorities and user workflow</title>
      <p id="Par16">BASE is designed to be easy to use, work with human readable formats whenever possible, be cross-platform, have minimal dependencies and make use of a modular design. It is designed around a core library (libBASE). The user interface is provided by two scripts, corresponding to the two relevant use cases in monoclonal antibody generation (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). From amplified single cell cDNA, Ig sequences are obtained through Sanger sequencing, from which primary analysis and recommendations are provided for specific gene cloning using the aBASE (analyze-BASE) interface. Ig variable parts are then cloned into Ig expression vectors using a PCR-based approach. This cloning step can introduce nucleotide differences into the expression plasmid in comparison to the amplified single cell cDNA. Before recombinant expression of the mAb, cBASE (compare-BASE) therefore confirms the identity of expression vector plasmid sequence and amplified cDNA, followed by the evaluation of suitability for expression. Sequence analysis algorithms for cBASE were designed to have a high positive predictive value for expression recommendation, i.e. to only recommend expression of a plasmid if it is 100% identical with the corresponding amplified cDNA.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Monoclonal antibody generation workflow with BASE assistance. A: Overview of the experimental procedure (top row), corresponding raw sequencing files (middle) and BASE modules (bottom). Ig = immunoglobulin</p></caption><graphic xlink:href="12859_2020_3741_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Description of the core module libBASE</title>
      <p id="Par17">Single-cell Sanger sequencing data are loaded on a per-file basis and checked for sufficient quality for downstream analysis by excluding sequencing reads with Phread quality lower than 12 and sequencing read smaller than 50 nucleotides. IgBLAST [<xref ref-type="bibr" rid="CR14">14</xref>] is used for alignment of single-cell sequence data with human Ig germline database sequences. Best matching immunoglobulin V, D, and J genes used as well as gene functionality, somatic hypermutation (SHM) count and full amino acid sequence and length of complementarity-determining region 3 (CDR3) are extracted. Furthermore, the Ig isotype is determined using BLAST [<xref ref-type="bibr" rid="CR15">15</xref>] to identify the best matching human constant Ig sequence [<xref ref-type="bibr" rid="CR13">13</xref>]. If this is inconclusive, typically due to either short sequence reads or low sequencing quality, the Ig isotype is determined using a heuristic customized to our primers. Suitable cloning primers for subsequent expression cloning are identified in a customizable table.</p>
    </sec>
    <sec id="Sec5">
      <title>Description of the aBASE user interface</title>
      <p id="Par18">All relevant data acquired during mAb generation is stored in an .xlsx table (Microsoft Excel Open XML Spreadsheet), in which each line represents one single cell with a unique mAb identifier. The .xlsx file can be opened with Microsoft Excel and the free alternatives OpenOffice and LibreOffice. This format allows the connection of sequence data derived information with any single cell metadata from other sources (e.g. cell population assignment from FACS analysis), which can simply be added in any customized extent and order. aBASE takes this .xlsx file as an input and initiates a standardized analysis algorithm for each sequence file using the core module libBASE. An output file is then automatically generated which combines the input information with the acquired data complemented by individual recommendations for specific gene. Recommendations are provided in separate columns and include suitable as the suitable gene-specific cloning primers and the presence of additional restriction sites (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). These recommendations are based on previously published protocols [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. Moreover, aBASE feedbacks the reliability of its analysis results in a comment column, suggesting in some cases a manual re-inspection of the data or re-sequencing of the sample, typically related to low sequencing quality.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Workflow and implementation of aBASE: After quality control, PCR-amplicon sequencing files are parsed, blasted against germline VDJ-genes using IgBLAST, and blasted against constant gene parts using BLAST. Output is used to generate cloning recommendations and written to a human-readable database. FACS = fluorescence activated cell sorting. CDR = complementarity determining region. SHM = somatic hypermutations. Ig = immunoglobulin</p></caption><graphic xlink:href="12859_2020_3741_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>Description of the cBASE user interface</title>
      <p id="Par19">After Ig genes have been cloned into the respective expression vectors containing the constant Ig domain, plasmids are sequenced using a primer annealing upstream of the start codon. cBASE aligns and compares the plasmid Ig sequence with the amplified cDNA-derived Ig sequence by displaying nucleotide differences, assigns their relevance for amino acid changes and evaluates possible influences of primer binding interactions. Only plasmids with 100% amino acid sequence identity with the respective amplified cDNA are supposed to be released for expression. Results of this analysis are presented in a color encoded format, allowing rapid differentiation of plasmid genes suitable for mAb expression (green), clones of which further bacterial colonies need to be analyzed for suitability (red) and genes where manual sequence inspection is recommended (brown). The latter typically occurs when sequence quality is low and automated nucleotide assignment may contain errors (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). Additionally, the total SHM count in the variable immunoglobulin V-gene is separately displayed for the amplified cDNA and plasmid Ig sequence read, allowing an easy correction of aBASE-derived SHM numbers as some may falsely be accounted from primer binding interactions in the beginning of the amplified cDNA sequence read.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Workflow and implementation of cBASE: After quality control, PCR-amplicon and plasmid sequencing files are parsed, and then blasted against germline VDJ-genes using IgBLAST. Ig gene variable regions are compared nucleotide by nucleotide and antibody expression is recommended if no amino acid changing mutations are detected</p><p>CDR = complementarity determining region. Ig = immunoglobulin.</p></caption><graphic xlink:href="12859_2020_3741_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>Code dependencies and availability</title>
      <p id="Par20">BASE is written in python and can be used as a local or web access software. Local use requires installation of IgBLAST and BLAST. The source code is published under GNU General Public License (GPL-v3) and available under <ext-link ext-link-type="uri" xlink:href="https://github.com/automatedSequencing/BASE">https://github.com/automatedSequencing/BASE</ext-link>. The web access version is available under <ext-link ext-link-type="uri" xlink:href="https://codeocean.com/capsule/3514767/">https://codeocean.com/capsule/3514767/</ext-link>. The web access version provides a fully-functional and executable code capsule accompanying this article and reproduces all results presented here. Additionally, it can be cloned, modified and used with custom input [<xref ref-type="bibr" rid="CR16">16</xref>].</p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Results</title>
    <p id="Par21">To evaluate the validity of our automated analysis using the two BASE software interfaces, we performed automated BASE analysis from a recently acquired mAb sequence data set, which previously had been analyzed manually, and compared the results. As differences could potentially be attributed to software bugs or errors in previous manual inspection, divergent data were re-inspected manually. The data set is derived from a CSF cell sample processed using mAb repertoire cloning in our laboratory (sample ID #AI ENC 113, (Kreye J, et al.: Encephalitis patient derived monoclonal GABAA receptor antibodies cause catatonia and epileptic seizures, in preparation)) including a total of 181 amplified cDNA Ig sequence reads for aBASE validation and a total of 176 plasmid Ig sequence reads for cBASE validation.</p>
    <sec id="Sec9">
      <title>Validation of primary Ig sequence evaluation using aBASE</title>
      <p id="Par22">Comparison of the results of the analysis performed by aBASE and the manual analysis expectedly showed no relevant differences in the parameters belonging to pre-processing analysis (quality value and length of the sequence read) and the data extracted from IgBLAST (best matching germline Ig genes, gene functionality, SHM, CDR3 sequence and length) (Table <xref rid="Tab1" ref-type="table">1</xref>). The only differences resulted from manual typing inaccuracies and were not counted as automated sequencing analysis mistakes. Ig isotype identification is performed from Ig heavy chain sequences only and is commonly hindered by low quality at the initial part of the sequence read and annealing of multiple primers, therefore being the most delicate part of Ig gene analysis. aBASE correctly identified the Ig isotype in 92 out of 96 cases (95.8%, Table <xref rid="Tab1" ref-type="table">1</xref>) without requiring any further user action. In 2 cases the automated analysis yielded the correct Ig isotype but flagged it as “low-confidence” and recommended manual sequence inspection. In the remaining 2 cases (2.1%), Ig isotype could not be determined automatically. Correct cloning recommendations were derived in all cases.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Validation of aBASE. Number of correctly identified parameters using automated aBASE evaluation compared to the results of manual analysis</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Parameter analyzed</th><th>Total number of chains analyzed</th><th>Correctly analyzed chains</th><th>Comments</th></tr></thead><tbody><tr><td><italic>VDJ</italic></td><td>181</td><td>100,00%</td><td/></tr><tr><td><italic>Ig Isotype</italic></td><td>96</td><td>97,92%</td><td>2 chains were correctly analyzed by aBASE as IgM Isotype, but results flagged as low-confidence</td></tr><tr><td><italic>Ig Functionality</italic></td><td>181</td><td>100,00%</td><td/></tr><tr><td><italic>Cloning recommendation</italic></td><td>181</td><td>100,00%</td><td/></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec10">
      <title>Validation of plasmid versus amplified cDNA Ig sequence comparison using cBASE</title>
      <p id="Par23">Automated cBASE analysis concluded recommendations for expression suitability in 158 out of 176 cases without requiring user interaction (89.8%, Table <xref rid="Tab2" ref-type="table">2</xref>). Manual re-evaluation was required in 18 cases (10.2%), associated with low sequence read quality (e.g. yielding putative frameshifts), which naturally limits automated analysis. In 145 out of 158 cases (91.8%; Table <xref rid="Tab2" ref-type="table">2</xref>), cBASE algorithm derived conclusions were considered correct which occurred if cBASE either a) correctly concluded no relevant differences between plasmid and amplified cDNA or b) correctly identified relevant differences and dismissed the plasmid as not suitable for expression. Of the 13 cases in which automated analysis came to different conclusions than manual evaluation, there were no false-positives, i.e. cBASE never advised to use a plasmid for expression that did not fulfill requirements for expression suitability in manual inspection. Instead, in all 13 differing cases, the software evaluation was technically correct as there were relevant nucleotide differences in the sequencing results. However, those differences were likely not reflecting changes in the DNA sequence, but rather related to poor sequence quality in parts of the amplified cDNA Ig sequence. Nonetheless, manual assessment suggested functional genes which were chosen for expression, thus those cBASE recommendations were considered false-negative. Overall, BASE expression recommendations in this study had a positive predictive value of 100% and a negative predictive value of 76.4%.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Validation of cBASE. 176 expression plasmids were compared with the corresponding amplified cDNA sequences. An expression recommendation by cBASE was considered false-negative if the software recommended against using the plasmid, although upon manual inspection the differences between plasmid and amplified were negligible (and most likely due to sequencing quality artifacts)</p></caption><table frame="hsides" rules="groups"><thead><tr><th>cBASE analysis results</th><th># of chains</th><th>Comments</th></tr></thead><tbody><tr><td><italic>correct expression recommendation</italic></td><td>145/176</td><td/></tr><tr><td><italic>false-negative expression recommendation</italic></td><td>13/176</td><td>mostly related to circumscibed low sequencing quality either in the plasmid or in the amplified cDNA Ig sequence</td></tr><tr><td><italic>no automatic recommendation</italic></td><td>18/176</td><td>mostly related to general low sequencing quality either in the plasmid or in the amplified cDNA Ig sequence</td></tr><tr><td><italic>false-positive recommendation</italic></td><td>0/176</td><td/></tr></tbody></table></table-wrap></p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Discussion</title>
    <p id="Par24">With BASE we have established an easy-to-use software solution to facilitate mAb sequence analysis and cloning in the process of monoclonal antibody generation. It can be installed locally or used online through Code Ocean [<xref ref-type="bibr" rid="CR16">16</xref>]. Automated sequence analysis using aBASE or plasmid expression recommendations using cBASE save time (about 3–5 min per sequence), have low error rates, and the requirement for user re-analysis is limited to cases with poor sequence quality.</p>
    <p id="Par25">We validated aBASE and cBASE in a dataset which previously had been analyzed manually. The comparison of the results was generally favorable. We identified only a few minor differences in comparison to independent manual evaluation, which upon re-inspection were caused by typing errors during the initial human evaluation, further highlighting the benefits of automated sequence analysis by reducing human error. Moreover, our comparison indicates that cBASE expression recommendations have a positive predictive value of 100%, however, are limited in negative prediction (NPV of 76.4%). Our detailed re-analysis revealed that this occurs mostly when cDNA amplicon Sanger sequence has low quality. Therefore, cBASE performance may be modulated by introducing Sanger sequence quality thresholds for mAbs before Ig gene cloning. Higher quality threshold reduces the overall antibody yield and therefore may not be feasible if source cells are limited, as in the case of CSF-derived mAb cloning. If so, we suggest a manual re-inspection of Ig plasmid sequences whenever cBASE yields a negative expression recommendation and cDNA amplicon Sanger sequence is of low quality.</p>
    <p id="Par26">BASE is optimized towards requirements from recombinant mAb cloning from CSF cells, but can likewise be used with human B cells including antibody-secreting cells from any source, therefore enabling a much wider use in antibody-omics. Single cell-based approaches are most useful whenever sample access is difficult and cell count is limited (e.g. tumor cells, biopsy material, any body fluid other than blood). The workflow has been established from isolated single cells in a 96 well format, but under the same set up can similarly process nearly unlimited amounts of data points in one file, from any source of B cell population in any plate format. Also, multiple plates or specimens can be tracked and analyzed in one file without any further changes. Moreover, the BASE platform could easily be adapted to perform non-human Ig sequence evaluation with few adaptations in linking to databases for germline Ig genes and primers.</p>
    <p id="Par27">Planned future developments include implementation of additional modules to automatically import and link further data from the mAb generation process other than sequence information into the same host file, such as flow cytometry single cell sort data, ELISA and microscopy data.</p>
  </sec>
  <sec id="Sec12">
    <title>Conclusions</title>
    <p id="Par28">The role of brain-targeting autoantibodies in neurological and psychiatric autoimmune and degenerative diseases is increasingly recognized, generating the need for more automated approaches in recombinant mAbs production. BASE already resolves a bottleneck in today’s mostly non-automated workflow of antibody generation, but the full potential of BASE will be unfolded with upcoming advancements in the high-throughput sequencing as part of mAb generation pipelines.</p>
  </sec>
  <sec id="Sec13">
    <title>Availability and requirements</title>
    <p id="Par29">Project name: BASE. Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/automatedSequencing/BASE">https://github.com/automatedSequencing/BASE</ext-link>. Operating system(s): Linux and Windows. Programming language: Python. Other requirements: Biopython, openpyxl, IgBLAST and BLAST. License: GNU General Public License (GPL-v3). Any restrictions to use by non-academics: no restrictions other than specified in license (GPL-v3).</p>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>CDR</term>
        <def>
          <p id="Par4">Complementarity determining region.</p>
        </def>
      </def-item>
      <def-item>
        <term>CSF</term>
        <def>
          <p id="Par5">Cerebrospinal fluid.</p>
        </def>
      </def-item>
      <def-item>
        <term>Ig</term>
        <def>
          <p id="Par6">Immunoglobulin.</p>
        </def>
      </def-item>
      <def-item>
        <term>mAb</term>
        <def>
          <p id="Par7">Monoclonal antibody.</p>
        </def>
      </def-item>
      <def-item>
        <term>NGS</term>
        <def>
          <p id="Par8">Next-generation sequencing.</p>
        </def>
      </def-item>
      <def-item>
        <term>PCR</term>
        <def>
          <p id="Par9">Polymerase chain reaction.</p>
        </def>
      </def-item>
      <def-item>
        <term>SHM</term>
        <def>
          <p id="Par10">Somatic hypermutation</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <p>The authors would like to acknowledge the preceding work of Jordan Willis, who wrote pyigblast (<ext-link ext-link-type="uri" xlink:href="https://github.com/andrejbranch/pyigblast">https://github.com/andrejbranch/pyigblast</ext-link>) on which a part of BASE is based.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>SMR implemented BASE and drafted the manuscript. HP conceived the project and edited the manuscript. JK conceived the project, drafted the manuscript and provided feedback on BASE functionality. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>The authors declare no additional funding. Open Access funding enabled and organized by Projekt DEAL.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The source code is available on <ext-link ext-link-type="uri" xlink:href="https://github.com/automatedSequencing/BASE">https://github.com/automatedSequencing/BASE</ext-link>, and all the results of this manuscript including the original sequencing files are reproduced in a capsule under <ext-link ext-link-type="uri" xlink:href="https://codeocean.com/capsule/3514767/">https://codeocean.com/capsule/3514767/</ext-link>.</p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p id="Par30">Not applicable.</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p id="Par31">Not applicable.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par32">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wardemann</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Predominant autoantibody production by early human B cell precursors</article-title>
        <source>Science</source>
        <year>2003</year>
        <volume>301</volume>
        <issue>5638</issue>
        <fpage>1374</fpage>
        <lpage>1377</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1086907</pub-id>
        <pub-id pub-id-type="pmid">12920303</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scheid</surname>
            <given-names>JF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Broad diversity of neutralizing antibodies isolated from memory B cells in HIV-infected individuals</article-title>
        <source>Nature</source>
        <year>2009</year>
        <volume>458</volume>
        <issue>7238</issue>
        <fpage>636</fpage>
        <lpage>640</lpage>
        <pub-id pub-id-type="doi">10.1038/nature07930</pub-id>
        <pub-id pub-id-type="pmid">19287373</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schickel</surname>
            <given-names>JN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Self-reactive VH4-34-expressing IgG B cells recognize commensal bacteria</article-title>
        <source>J Exp Med</source>
        <year>2017</year>
        <volume>214</volume>
        <issue>7</issue>
        <fpage>1991</fpage>
        <lpage>2003</lpage>
        <pub-id pub-id-type="doi">10.1084/jem.20160201</pub-id>
        <pub-id pub-id-type="pmid">28500047</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bennett</surname>
            <given-names>JL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Intrathecal pathogenic anti-aquaporin-4 antibodies in early neuromyelitis optica</article-title>
        <source>Ann Neurol</source>
        <year>2009</year>
        <volume>66</volume>
        <issue>5</issue>
        <fpage>617</fpage>
        <lpage>629</lpage>
        <pub-id pub-id-type="doi">10.1002/ana.21802</pub-id>
        <pub-id pub-id-type="pmid">19938104</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kreye</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Human cerebrospinal fluid monoclonal N-methyl-D-aspartate receptor autoantibodies are sufficient for encephalitis pathogenesis</article-title>
        <source>Brain</source>
        <year>2016</year>
        <volume>139</volume>
        <issue>Pt 10</issue>
        <fpage>2641</fpage>
        <lpage>2652</lpage>
        <pub-id pub-id-type="doi">10.1093/brain/aww208</pub-id>
        <pub-id pub-id-type="pmid">27543972</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Malviya</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>NMDAR encephalitis: passive transfer from man to mouse by a recombinant antibody</article-title>
        <source>Ann Clin Transl Neurol</source>
        <year>2017</year>
        <volume>4</volume>
        <issue>11</issue>
        <fpage>768</fpage>
        <lpage>783</lpage>
        <pub-id pub-id-type="doi">10.1002/acn3.444</pub-id>
        <pub-id pub-id-type="pmid">29159189</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jurek</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Human gestational NMDAR autoantibodies impair neonatal murine brain function</article-title>
        <source>Ann Neurol</source>
        <year>2019</year>
        <volume>86</volume>
        <issue>5</issue>
        <fpage>656</fpage>
        <lpage>670</lpage>
        <pub-id pub-id-type="doi">10.1002/ana.25552</pub-id>
        <pub-id pub-id-type="pmid">31325344</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ly</surname>
            <given-names>LT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Affinities of human NMDA receptor autoantibodies: implications for disease mechanisms and clinical diagnostics</article-title>
        <source>J Neurol</source>
        <year>2018</year>
        <volume>265</volume>
        <issue>11</issue>
        <fpage>2625</fpage>
        <lpage>2632</lpage>
        <pub-id pub-id-type="doi">10.1007/s00415-018-9042-1</pub-id>
        <pub-id pub-id-type="pmid">30187160</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tradtrantip</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Anti-Aquaporin-4 monoclonal antibody blocker therapy for neuromyelitis optica</article-title>
        <source>Ann Neurol</source>
        <year>2012</year>
        <volume>71</volume>
        <issue>3</issue>
        <fpage>314</fpage>
        <lpage>322</lpage>
        <pub-id pub-id-type="doi">10.1002/ana.22657</pub-id>
        <pub-id pub-id-type="pmid">22271321</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moorhouse</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ImmunoGlobulin galaxy (IGGalaxy) for simple determination and quantitation of immunoglobulin heavy chain rearrangements from NGS</article-title>
        <source>BMC Immunol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>59</fpage>
        <pub-id pub-id-type="doi">10.1186/s12865-014-0059-7</pub-id>
        <pub-id pub-id-type="pmid">25495099</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vander Heiden</surname>
            <given-names>JA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>pRESTO: a toolkit for processing high-throughput sequencing raw reads of lymphocyte receptor repertoires</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>13</issue>
        <fpage>1930</fpage>
        <lpage>1932</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu138</pub-id>
        <pub-id pub-id-type="pmid">24618469</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gupta</surname>
            <given-names>NT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Change-O: a toolkit for analyzing large-scale B cell immunoglobulin repertoire sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>20</issue>
        <fpage>3356</fpage>
        <lpage>3358</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv359</pub-id>
        <pub-id pub-id-type="pmid">26069265</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Imkeller</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>sciReptor: analysis of single-cell level immunoglobulin repertoires</article-title>
        <source>BMC Bioinformatics</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>67</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-016-0920-1</pub-id>
        <pub-id pub-id-type="pmid">26847109</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ye</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>IgBLAST: an immunoglobulin variable domain sequence analysis tool</article-title>
        <source>Nucleic Acids Res</source>
        <year>2013</year>
        <volume>41</volume>
        <issue>Web Server issue</issue>
        <fpage>W34</fpage>
        <lpage>W40</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt382</pub-id>
        <pub-id pub-id-type="pmid">23671333</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Basic local alignment search tool</article-title>
        <source>J Mol Biol</source>
        <year>1990</year>
        <volume>215</volume>
        <issue>3</issue>
        <fpage>403</fpage>
        <lpage>410</lpage>
        <pub-id pub-id-type="doi">10.1016/S0022-2836(05)80360-2</pub-id>
        <pub-id pub-id-type="pmid">2231712</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Brain Antibody Sequence Evaluation (BASE). <ext-link ext-link-type="uri" xlink:href="https://codeocean.com/capsule/9813295/tree/v1">https://codeocean.com/capsule/9813295/tree/v1</ext-link>. 10.24433/CO.3514767.v1.</mixed-citation>
    </ref>
  </ref-list>
</back>
