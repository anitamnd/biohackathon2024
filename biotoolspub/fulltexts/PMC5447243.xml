<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5447243</article-id>
    <article-id pub-id-type="pmid">28158396</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btx049</article-id>
    <article-id pub-id-type="publisher-id">btx049</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>FIT: statistical modeling tool for transcriptome dynamics under fluctuating field conditions</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Iwayama</surname>
          <given-names>Koji</given-names>
        </name>
        <xref ref-type="aff" rid="btx049-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Aisaka</surname>
          <given-names>Yuri</given-names>
        </name>
        <xref ref-type="aff" rid="btx049-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kutsuna</surname>
          <given-names>Natsumaro</given-names>
        </name>
        <xref ref-type="aff" rid="btx049-aff2">2</xref>
        <xref ref-type="aff" rid="btx049-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nagano</surname>
          <given-names>Atsushi J</given-names>
        </name>
        <xref ref-type="aff" rid="btx049-aff4">4</xref>
        <xref ref-type="aff" rid="btx049-aff5">5</xref>
        <xref ref-type="aff" rid="btx049-aff6">6</xref>
        <xref ref-type="corresp" rid="btx049-cor1"/>
        <!--<email>anagano@agr.ryukoku.ac.jp</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Bar-Joseph</surname>
          <given-names>Ziv</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btx049-aff1"><label>1</label>Research Institute for Food and Agriculture, Ryukoku University, Otsu, Shiga, Japan</aff>
    <aff id="btx049-aff2"><label>2</label>LPixel Inc, Hongo, Bunkyo-ku, Tokyo, Japan</aff>
    <aff id="btx049-aff3"><label>3</label>Department of Integrated Biosciences, Graduate School of Frontier Sciences, The University of Tokyo, Kashiwa-shi, Chiba, Japan</aff>
    <aff id="btx049-aff4"><label>4</label>Department of Plant Life Science, Faculty of Agriculture, Ryukoku University, Otsu, Shiga, Japan</aff>
    <aff id="btx049-aff5"><label>5</label>Center for Ecological Research, Kyoto University, Otsu, Shiga, Japan</aff>
    <aff id="btx049-aff6"><label>6</label>JST PRESTO, Kawaguchi, Saitama, Japan</aff>
    <author-notes>
      <corresp id="btx049-cor1">To whom correspondence should be addressed. Email: <email>anagano@agr.ryukoku.ac.jp</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>6</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-01-31">
      <day>31</day>
      <month>1</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>31</day>
      <month>1</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>33</volume>
    <issue>11</issue>
    <fpage>1672</fpage>
    <lpage>1680</lpage>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>8</month>
        <year>2016</year>
      </date>
      <date date-type="rev-recd">
        <day>13</day>
        <month>1</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>1</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="cc-by">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btx049.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="SA1">
        <title>Motivation</title>
        <p>Considerable attention has been given to the quantification of environmental effects on organisms. In natural conditions, environmental factors are continuously changing in a complex manner. To reveal the effects of such environmental variations on organisms, transcriptome data in field environments have been collected and analyzed. Nagano <italic>et al.</italic> proposed a model that describes the relationship between transcriptomic variation and environmental conditions and demonstrated the capability to predict transcriptome variation in rice plants. However, the computational cost of parameter optimization has prevented its wide application.</p>
      </sec>
      <sec id="SA2">
        <title>Results</title>
        <p>We propose a new statistical model and efficient parameter optimization based on the previous study. We developed and released FIT, an R package that offers functions for parameter optimization and transcriptome prediction. The proposed method achieves comparable or better prediction performance within a shorter computational time than the previous method. The package will facilitate the study of the environmental effects on transcriptomic variation in field conditions.</p>
      </sec>
      <sec id="SA3">
        <title>Availability and Implementation</title>
        <p>Freely available from CRAN (<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/FIT/">https://cran.r-project.org/web/packages/FIT/</ext-link>).</p>
      </sec>
      <sec id="SA4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">KAKENHI</named-content>
        </funding-source>
        <award-id>JP16H06171, JP16H01473</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Variation in environmental factors affects various aspects of organisms. The comprehensive quantification of environmental effects on organisms is an emerging problem. For example, gene-environment interactions have been studied to explain the heritability of complex diseases that could not be explained by conventional genome-wide association studies (<xref rid="btx049-B23" ref-type="bibr">Thomas, 2010</xref>). In addition, concerns about organisms’ adaptation and response to changes in environmental conditions has been growing because of climate change (<xref rid="btx049-B1" ref-type="bibr">Ahuja <italic>et al.</italic>, 2010</xref>; <xref rid="btx049-B7" ref-type="bibr">Hoffmann and Sgrò, 2011</xref>; <xref rid="btx049-B16" ref-type="bibr">Nicotra <italic>et al.</italic>, 2010</xref>; <xref rid="btx049-B28" ref-type="bibr">Weston <italic>et al.</italic>, 2008</xref>; <xref rid="btx049-B29" ref-type="bibr">Xu, 2016</xref>).</p>
    <p>There is a trade-off between precise control of and minimal intervention to the environment (<xref rid="btx049-B9" ref-type="bibr">Jones, 2013</xref>). Any results obtained in the field more accurately reflect a plant’s environmental response in natural conditions. However, these results are difficult to interpret, because environmental factors are continuously changing in a complex manner and exhibit diurnal oscillations, seasonal changes, and long-term trends. On the other hand, experiments conducted in controlled conditions provide results that are more precise but not necessarily reflective of the plant’s behavior in natural conditions. For example, photosynthetic responses to fluctuating, environments like natural conditions differ from those to controlled, constant environmental conditions (<xref rid="btx049-B30" ref-type="bibr">Yamori, 2016</xref>). At the molecular level, traits observed in laboratory conditions are not always consistent with those observed in natural conditions (<xref rid="btx049-B12" ref-type="bibr">Malmberg <italic>et al.</italic>, 2005</xref>; <xref rid="btx049-B13" ref-type="bibr">Mishra <italic>et al.</italic>, 2012</xref>; <xref rid="btx049-B27" ref-type="bibr">Weinig <italic>et al.</italic>, 2002</xref>). Further, even if similar physiological plasticity is observed, the molecular responses of plants to drought stress can vary between the controlled conditions of greenhouses and the uncontrolled conditions of the field (<xref rid="btx049-B11" ref-type="bibr">Lovell <italic>et al.</italic>, 2016</xref>).</p>
    <p>To reveal the effects of such fluctuating environments, transcriptome data in field environments have been collected (<xref rid="btx049-B2" ref-type="bibr">Alvarez <italic>et al.</italic>, 2015</xref>). In particular, the transcriptomic variation of plants in fields has been studied (<xref rid="btx049-B6" ref-type="bibr">Hayes <italic>et al.</italic>, 2010</xref>; <xref rid="btx049-B8" ref-type="bibr">Izawa <italic>et al.</italic>, 2011</xref>; <xref rid="btx049-B14" ref-type="bibr">Nagano <italic>et al.</italic>, 2012</xref>; <xref rid="btx049-B19" ref-type="bibr">Plessis <italic>et al.</italic>, 2015</xref>; <xref rid="btx049-B22" ref-type="bibr">Sato <italic>et al.</italic>, 2011</xref>; <xref rid="btx049-B20" ref-type="bibr">Richards <italic>et al.</italic>, 2012</xref>). To bridge the gap between natural and laboratory conditions, <xref rid="btx049-B14" ref-type="bibr">Nagano <italic>et al.</italic> (2012)</xref> proposed a model to relate the transcriptomic variation of plants in a field to environmental conditions and applied it to large-scale transcriptome data of samples collected in a field. They demonstrated that the model can precisely predict transcriptome variations using meteorological data. However, the vast computational cost required to optimize parameters and select the best model has restricted the use of the model.</p>
    <p>To accelerate transcriptomic studies in fields, we propose a new statistical model based on that proposed by <xref rid="btx049-B14" ref-type="bibr">Nagano <italic>et al.</italic> (2012)</xref>. The previous model contains some distinct functions representing diurnal changes in sensitivity and the characteristics of responses to environmental stimuli. The new model reduces the computational cost by unifying these functions. We also propose a cluster-based approach for optimizing parameters, in which we reuse the optimization result of one gene for other genes in the same cluster. This approach significantly reduces the cost of searching for the optimum parameter value. Both the previous and new models are intended for application to microarray data; however, the use of RNA-Seq (<xref rid="btx049-B26" ref-type="bibr">Wang <italic>et al.</italic>, 2009</xref>) technology is rapidly increasing. To apply our model to RNA-Seq data, we incorporated precision weights for normalized log-counts into the model as the voom method (<xref rid="btx049-B10" ref-type="bibr">Law <italic>et al.</italic>, 2014</xref>). In addition, we developed and released FIT, an R package that provides efficient parameter optimization, model selection, and transcriptome prediction of unsequenced samples. This is the first tool to integrate the transcriptome data from field samples and meteorological data by modeling their relation.</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <sec>
      <title>2.1 Previous model</title>
      <p>Before explaining our new model, we briefly review the previous plant transcriptome model (<xref rid="btx049-B14" ref-type="bibr">Nagano <italic>et al.</italic>, 2012</xref>). Let <italic>N</italic> be the number of samples and <inline-formula id="IE1"><mml:math id="MM1"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> be an <italic>N</italic>-element vector, where each element is the <inline-formula id="IE2"><mml:math id="MM2"><mml:mrow><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mtext>log</mml:mtext><mml:mo>⁡</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>-transformed value of the normalized expressions for gene <italic>i</italic> in each sample. In the model, <inline-formula id="IE3"><mml:math id="MM3"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is described as
<disp-formula id="E1"><label>(1)</label><mml:math id="MM4"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">ε</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE4"><mml:math id="MM5"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE5"><mml:math id="MM6"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> are an <inline-formula id="IE6"><mml:math id="MM7"><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:math></inline-formula> design matrix and regression coefficients, respectively. The independently and identically distributed noise <inline-formula id="IE7"><mml:math id="MM8"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">ε</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is drawn from a Gaussian distribution. The design matrix <inline-formula id="IE8"><mml:math id="MM9"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is constructed as
<disp-formula id="E2"><label>(2)</label><mml:math id="MM10"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn mathvariant="bold">1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">d</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">d</mml:mi><mml:mo>○</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">d</mml:mi><mml:mo>○</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
Here, <bold>1</bold> is a vector in which all elements are 1 and <inline-formula id="IE10"><mml:math id="MM11"><mml:mrow><mml:mi mathvariant="bold-italic">d</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE11"><mml:math id="MM12"><mml:mi mathvariant="bold-italic">n</mml:mi></mml:math></inline-formula> are values designating the plant’s age, circadian clock, response to environmental stimuli, and genotype, respectively. The element-wise products <inline-formula id="IE12"><mml:math id="MM13"><mml:mrow><mml:mi mathvariant="bold-italic">d</mml:mi><mml:mo>○</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE13"><mml:math id="MM14"><mml:mrow><mml:mi mathvariant="bold-italic">d</mml:mi><mml:mo>○</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> are the interactions between the age and the clock and the age and the environmental response, respectively. The plant’s age <inline-formula id="IE14"><mml:math id="MM15"><mml:mi mathvariant="bold-italic">d</mml:mi></mml:math></inline-formula> is a vector of the numbers of days after transplanting scaled to have a range 1 and a mean 0. In the previous study, the authors used two rice cultivars (Nipponbare and Norin 8) as samples. If the genotype of sample <italic>j</italic> is Norin 8, the <italic>j</italic>-th element of the genotype <inline-formula id="IE15"><mml:math id="MM16"><mml:mi mathvariant="bold-italic">n</mml:mi></mml:math></inline-formula> is set to 1; otherwise, to 0.</p>
      <p>Whereas <inline-formula id="IE16"><mml:math id="MM17"><mml:mi mathvariant="bold-italic">d</mml:mi></mml:math></inline-formula> and <inline-formula id="IE17"><mml:math id="MM18"><mml:mi mathvariant="bold-italic">n</mml:mi></mml:math></inline-formula> are independent of the genes, the circadian clock and the response to environmental stimuli are gene specific. Hence, we place a superscript (<italic>i</italic>), e.g. <inline-formula id="IE18"><mml:math id="MM19"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE19"><mml:math id="MM20"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. The circadian clock on gene <italic>i</italic> in sample <italic>j</italic> is described by a cosine curve with a <inline-formula id="IE20"><mml:math id="MM21"><mml:mrow><mml:mn>24</mml:mn><mml:mo> </mml:mo><mml:mtext>h</mml:mtext></mml:mrow></mml:math></inline-formula> period and the gene specific phase <inline-formula id="IE21"><mml:math id="MM22"><mml:mrow><mml:msup><mml:mo>φ</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. It is defined as
<disp-formula id="E3"><label>(3)</label><mml:math id="MM23"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo> </mml:mo><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>π</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mo>φ</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mn>24</mml:mn></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>t<sub>j</sub></italic> is the time when sample <italic>j</italic> was obtained.</p>
      <p>The response to environmental stimuli of gene <italic>i</italic> in sample <italic>j</italic> takes the form
<disp-formula id="E4"><label>(4)</label><mml:math id="MM24"><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mo>θ</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mi>a</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>g</italic>(<italic>T</italic>) is a gate aperture used to explain time-of-day-specific responses to an environmental stimulus, <inline-formula id="IE22"><mml:math id="MM25"><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is the time period during which gene <italic>i</italic> was affected by an environmental stimulus, <italic>w<sub>T</sub></italic> is the value of a meteorological parameter at time <italic>T</italic>, <inline-formula id="IE23"><mml:math id="MM26"><mml:mrow><mml:msup><mml:mo>θ</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is the response threshold to the stimulus, and <italic>f</italic>(<italic>x</italic>) determines the response to the environmental stimulus. <inline-formula id="IE24"><mml:math id="MM27"><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is scaled by factors <inline-formula id="IE25"><mml:math id="MM28"><mml:mrow><mml:msup><mml:mi>a</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE26"><mml:math id="MM29"><mml:mrow><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> as the plant’s age. For <italic>f</italic>(<italic>x</italic>), two types of response model are considered: dose-dependent (dd) and dose-independent (di). In the dd model, the response function is defined as
<disp-formula id="E5"><label>(5)</label><mml:math id="MM30"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
Similarly, the function in the di model is defined as
<disp-formula id="E6"><label>(6)</label><mml:math id="MM31"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>x</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>otherwise</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>
These two response model types assume that a plant responds to an environmental stimulus over the threshold. Two other types can also be considered, that is, a plant responds to a stimulus under the threshold, such as
<disp-formula id="E7"><label>(7)</label><mml:math id="MM32"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>otherwise</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
      <p>There are three types of gate function <italic>g</italic>(<italic>T</italic>). The first model is a no-gate model, which takes 1 for any <italic>T</italic>. In the second model, the gate function is defined as
<disp-formula id="E8"><label>(8)</label><mml:math id="MM33"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mo> </mml:mo><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo> </mml:mo><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>π</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mo>ψ</mml:mo></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mn>24</mml:mn></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
The third model assumes that the gate fully opens for a specific duration and completely closes at other times, i.e.,
<disp-formula id="E9"><label>(9)</label><mml:math id="MM34"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mtext>rect</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>o</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:mi>T</mml:mi><mml:mo>&lt;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>o</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>l</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>otherwise</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>
Here, <inline-formula id="IE27"><mml:math id="MM35"><mml:mrow><mml:msup><mml:mi>o</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is the opening time of the gate and <inline-formula id="IE28"><mml:math id="MM36"><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is the opening length.</p>
      <p>Parameters are optimized to maximize the likelihood by using the Nelder–Mead algorithm (<xref rid="btx049-B15" ref-type="bibr">Nelder and Mead, 1965</xref>). Because the likelihood function has multiple local maxima, a grid search is performed before the optimization. Regression coefficients <inline-formula id="IE29"><mml:math id="MM37"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and the phase of the circadian clock <inline-formula id="IE30"><mml:math id="MM38"><mml:mrow><mml:msup><mml:mo>φ</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> are optimized using the nonlinear least-squares method and the likelihood is calculated on each grid point of the remaining parameters. The optimization by the Nelder–Mead algorithm starts from the parameter values of the grid point with the largest likelihood. The response function to environmental stimuli with the largest likelihood is selected from four response model types (<inline-formula id="IE31"><mml:math id="MM39"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE32"><mml:math id="MM40"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>). Because different gate function types have different degrees of freedom, the optimum gate function type is selected by performing likelihood-ratio tests. It can be considered that some variables in <xref ref-type="disp-formula" rid="E1">Equation (1)</xref> may contribute to neither the explanation nor the prediction for the expression patterns of many genes. Thus, a parameter reduction process that repeats parameter optimizations and likelihood-ratio tests is performed to obtain the simplest models.</p>
    </sec>
    <sec>
      <title>2.2 New model</title>
      <p>Although the previous model achieved a detailed description of transcriptome fluctuations in complex environments, the parameter optimization for all genes is computationally expensive. The computational cost of the optimization is due mainly to the existence of different model types, i.e., different types of response models and gate functions, and variable selection. We need to optimize and compare each model repeatedly. Therefore, to reduce computational cost, we unified the different model types.</p>
      <p>To unify the <italic>dd</italic> and <italic>di</italic> responses to environmental stimuli, we redefined the response model, when a plant responds to an environmental stimulus over the threshold, as
<disp-formula id="E10"><label>(10)</label><mml:math id="MM41"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>tanh</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mo>γ</mml:mo><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msqrt><mml:mrow><mml:mo> </mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mo>γ</mml:mo><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msqrt><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
As <italic>γ<sub>f</sub></italic> approaches minus infinity, this function approaches the <italic>dd</italic> response function. Conversely, this function approaches the <italic>di</italic> response function in the limit of <inline-formula id="IE33"><mml:math id="MM42"><mml:mrow><mml:msub><mml:mo>γ</mml:mo><mml:mi>f</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:mo>∞</mml:mo></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="btx049-F1">Fig. 1(a)</xref>). Here, <inline-formula id="IE34"><mml:math id="MM43"><mml:mrow><mml:msqrt><mml:mrow><mml:mo> </mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mo>γ</mml:mo><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula> ensures that the outputs of this function have almost constant scales regardless of the value of <italic>γ<sub>f</sub></italic>. When a plant responds to a stimulus under the threshold, the dd and di responses are unified as
<disp-formula id="E11"><label>(11)</label><mml:math id="MM44"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>tanh</mml:mi><mml:mo> </mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mo>γ</mml:mo><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msqrt><mml:mrow><mml:mo> </mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mo>γ</mml:mo><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msqrt><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <fig id="btx049-F1" orientation="portrait" position="float">
        <label>Fig. 1</label>
        <caption>
          <p>Response functions (<bold>a</bold>) and gate functions (<bold>b</bold>) for various parameter values</p>
        </caption>
        <graphic xlink:href="btx049f1"/>
      </fig>
      <p>We also defined the new gate function as
<disp-formula id="E12"><mml:math id="MM45"><mml:mrow><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>tanh</mml:mi><mml:mo> </mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mo>γ</mml:mo><mml:mi>g</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mo>θ</mml:mo><mml:mi>g</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="E13"><label>(12)</label><mml:math id="MM46"><mml:mrow><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>h</mml:mi><mml:mo> </mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>π</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mo>ψ</mml:mo></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mn>24</mml:mn></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>γ<sub>g</sub></italic> controls the shape of the gate as <italic>γ<sub>f</sub></italic> in <xref ref-type="disp-formula" rid="E10">Equations (10)</xref> and <xref ref-type="disp-formula" rid="E11">(11)</xref>, and <italic>θ<sub>g</sub></italic> determines the opening length. When the value of <italic>θ<sub>g</sub></italic> is smaller than –1, this function corresponds to the no-gate model in the limit <inline-formula id="IE35"><mml:math id="MM47"><mml:mrow><mml:msub><mml:mo>γ</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:mo>∞</mml:mo></mml:mrow></mml:math></inline-formula>. The gate function in <xref ref-type="disp-formula" rid="E8">Equation (8)</xref> is approximated by this function with a smaller value of <italic>γ<sub>g</sub></italic> and that in <xref ref-type="disp-formula" rid="E9">Equation (9)</xref> is approximated with a larger value of <italic>γ<sub>g</sub></italic> [<xref ref-type="fig" rid="btx049-F1">Fig. 1(b)</xref>].</p>
      <p>To eliminate the need to optimize the phase of the circadian clock <inline-formula id="IE36"><mml:math id="MM48"><mml:mrow><mml:msup><mml:mo>ϕ</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> by the nonlinear least-squares method, we represent the circadian clock by the weighted sum of sine and cosine curves instead of one cosine curve (<xref ref-type="disp-formula" rid="E3">Equation 3</xref>). The weights of these sine and cosine curves are selected by linear regression together with other regression coefficients. Let <inline-formula id="IE37"><mml:math id="MM49"><mml:mrow><mml:msubsup><mml:mo>β</mml:mo><mml:mrow><mml:mo> </mml:mo><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE38"><mml:math id="MM50"><mml:mrow><mml:msubsup><mml:mo>β</mml:mo><mml:mrow><mml:mo> </mml:mo><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> be the regression coefficients of the sine and cosine components of the clock. Using these coefficients, the clock phase is obtained by
<disp-formula id="E14"><label>(13)</label><mml:math id="MM51"><mml:mrow><mml:msup><mml:mo>φ</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>arg</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:msubsup><mml:mo>β</mml:mo><mml:mrow><mml:mo> </mml:mo><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:msubsup><mml:mo>β</mml:mo><mml:mrow><mml:mo> </mml:mo><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="true">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
Similarly, the interactions between the plant’s age and the circadian clock are also represented as the weighted sum of the interactions between the age and cosine and sine curves, and its phase is obtained by these regression coefficients.</p>
      <p>As in the previous model, the parameters of the new model are optimized through two steps: the determination of the initial value by a grid search, and nonlinear optimization by the Nelder–Mead algorithm. In the first step, we optimize the parameters related to environmental responses, which are <inline-formula id="IE39"><mml:math id="MM52"><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mo>θ</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <italic>γ<sub>f</sub></italic>, <italic>γ<sub>g</sub></italic>, and <italic>θ<sub>g</sub></italic>, and the response function (<inline-formula id="IE40"><mml:math id="MM53"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> or <inline-formula id="IE41"><mml:math id="MM54"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) by a grid search. The remaining parameter <inline-formula id="IE42"><mml:math id="MM55"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is optimized by linear regression for each setting and the setting that achieves the lowest mean squared error is searched. In the second step, parameters other than <inline-formula id="IE43"><mml:math id="MM56"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> are optimized by the Nelder–Mead algorithm. After the optimization of the environmental response parameters, we select variables simultaneously with the optimization of the regression coefficients <inline-formula id="IE44"><mml:math id="MM57"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> using an L1 regularization instead of repeating log-likelihood tests. To select sine and cosine curves representing the circadian clock (and the interaction between the age and the circadian clock) into or out of a model together, we used group lasso (<xref rid="btx049-B31" ref-type="bibr">Yuan and Lin, 2006</xref>) rather than lasso (<xref rid="btx049-B24" ref-type="bibr">Tibshirani, 1996</xref>). By using group lasso, sparse (i.e. a small number of non-zero) coefficients can be obtained. Let <inline-formula id="IE45"><mml:math id="MM58"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> be the predicted value of the expression of gene <italic>i</italic> in sample <italic>j</italic>. The cost function to be minimized is defined as
<disp-formula id="E15"><mml:math id="MM59"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="E16"><label>(14)</label><mml:math id="MM60"><mml:mrow><mml:mo>+</mml:mo><mml:mo>λ</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mo>ζ</mml:mo><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mo>β</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mo>ζ</mml:mo><mml:mi>c</mml:mi></mml:msub><mml:msqrt><mml:mrow><mml:msubsup><mml:mo>β</mml:mo><mml:mrow><mml:mo> </mml:mo><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mo>β</mml:mo><mml:mrow><mml:mo> </mml:mo><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt><mml:mo>+</mml:mo><mml:msub><mml:mo>ζ</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msqrt><mml:mrow><mml:msubsup><mml:mo>β</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo> </mml:mo><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mo>β</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo> </mml:mo><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
Here, <inline-formula id="IE46"><mml:math id="MM61"><mml:mrow><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> is the index set of the regression coefficients of the plant’s age, the response to environmental stimuli, the interaction between the age and the response, and the genotype. In this equation, the first term is the sum of the squared residuals and the second term is the regularization term. With a larger value of <italic>λ</italic>, we obtain fewer non-zero coefficients. To achieve consistent variable selection, we use adaptive weights <italic>ζ<sub>j</sub></italic> for penalizing different covariates as in the adaptive lasso (<xref rid="btx049-B33" ref-type="bibr">Zou, 2006</xref>) or the adaptive group lasso (<xref rid="btx049-B25" ref-type="bibr">Wang and Leng, 2008</xref>). Let <inline-formula id="IE47"><mml:math id="MM62"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> denote the coefficients obtained by ordinary least squares regression. The adaptive weights are defined as <inline-formula id="IE48"><mml:math id="MM63"><mml:mrow><mml:msub><mml:mo>ζ</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>}</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE49"><mml:math id="MM64"><mml:mrow><mml:msub><mml:mo>ζ</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>7</mml:mn><mml:mo>/</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>r</mml:mi><mml:mo>}</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mo>ζ</mml:mo><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE50"><mml:math id="MM65"><mml:mrow><mml:msub><mml:mo>ζ</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo> </mml:mo><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo> </mml:mo><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Because the responses to environmental stimuli contain seven parameters, the adaptive weights for the response and the interaction between the response and the age are multiplied by seven.</p>
      <p>The optimum value of <italic>λ</italic> is selected by cross validation (CV) for each gene. We chose the largest value of <italic>λ</italic> for which the CV error was smaller than the sum of the minimum CV error and the standard error of CV errors. Because CV incurs high computational costs, we used the approximation of leave-one-out CV errors (<xref rid="btx049-B17" ref-type="bibr">Obuchi and Kabashima, 2016</xref>). A leave-one-out CV error and its standard error is approximated by the mean and the standard deviation of
<disp-formula id="E17"><label>(15)</label><mml:math id="MM66"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mo>χ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
over all samples <italic>j</italic>. Here, <inline-formula id="IE51"><mml:math id="MM67"><mml:mrow><mml:msup><mml:mo>χ</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is the matrix given by
<disp-formula id="E18"><mml:math id="MM68"><mml:mrow><mml:msup><mml:mo>χ</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula><disp-formula id="E19"><mml:math id="MM69"><mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>·</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>·</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>·</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>·</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE52"><mml:math id="MM70"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE53"><mml:math id="MM71"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>·</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> denote the submatrix of <inline-formula id="IE54"><mml:math id="MM72"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> corresponding to the set of covariates with non-zero regression coefficients, and its <italic>j</italic>-th row. Although this approximation is based on the assumption that the numbers of samples and covariates are sufficiently large, we confirmed that it is sufficiently accurate even for our model, which contains only several covariates.</p>
    </sec>
    <sec>
      <title>2.3 Cluster-based optimization for computational time reduction</title>
      <p>For further computational reduction, we omit the grid search (which is the most time-consuming step in the optimization) for almost all genes. Similar models would be optimum for genes exhibiting similar expression patterns. Hence, it is expected that the optimum model for one representative gene of a cluster can be used as the initial value of the Nelder–Mead optimization for genes, the expression pattern of which is similar to the pattern of the representative gene of the cluster.</p>
      <p>Before optimization, we perform clustering of expression patterns using the affinity-propagation method (<xref rid="btx049-B4" ref-type="bibr">Frey and Dueck, 2007</xref>), which automatically provides an appropriate number of clusters and their exemplars. For each cluster, we optimize the parameter values for the exemplar of the cluster using the procedure mentioned above, and use the optimized value as the initial value for the Nelder–Mead method for other genes in the cluster.</p>
    </sec>
    <sec>
      <title>2.4 Application to RNA-seq data</title>
      <p>Recently, RNA-Seq (<xref rid="btx049-B26" ref-type="bibr">Wang <italic>et al.</italic>, 2009</xref>) has become a widely used technology to quantify transcriptomes. While we employed the lognormal distribution for microarray data, RNA-Seq data are discrete in nature and modeled by a negative binomial distribution (<xref rid="btx049-B21" ref-type="bibr">Robinson <italic>et al.</italic>, 2010</xref>). We associated a precision weight with each individual normalized observation as in the voom method (<xref rid="btx049-B10" ref-type="bibr">Law <italic>et al.</italic>, 2014</xref>), which allows us to apply methods developed for microarray data to RNA-Seq data. Precision weights are estimated based on the mean-variance relationship of the data according to the following procedure. The log-count per million (log-cpm) value for each read count is defined as
<disp-formula id="E20"><label>(16)</label><mml:math id="MM73"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mtext>log</mml:mtext><mml:mo>⁡</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mn>0.5</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1.0</mml:mn></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mn>6</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE55"><mml:math id="MM74"><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> denotes the read count of gene <italic>i</italic> for RNA sample <italic>j</italic> and <inline-formula id="IE56"><mml:math id="MM75"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>∑</mml:mo><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is the total number of reads for sample <italic>j</italic>. For each gene, a model is fitted to the log-cpm value <inline-formula id="IE57"><mml:math id="MM76"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and its residual standard deviation <inline-formula id="IE58"><mml:math id="MM77"><mml:mrow><mml:msup><mml:mo>σ</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is obtained. In this study, we smoothed the time series of the log-cpm values and calculated residual standard deviations. Let <inline-formula id="IE59"><mml:math id="MM78"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> denote the average log-count value defined as
<disp-formula id="E21"><label>(17)</label><mml:math id="MM79"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mtext>log</mml:mtext><mml:mo>⁡</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mtext>log</mml:mtext><mml:mo>⁡</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mn>6</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
Here, <inline-formula id="IE60"><mml:math id="MM80"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE61"><mml:math id="MM81"><mml:mrow><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> are the average log-cpm value and the geometric mean of the total number of reads plus one, respectively. Similarly, each smoothed log-cpm value of gene <italic>g</italic> for sample <italic>i</italic> is converted to the smoothed log-count <inline-formula id="IE62"><mml:math id="MM82"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>. Fitting the LOWESS curve (<xref rid="btx049-B3" ref-type="bibr">Cleveland, 1979</xref>) to square-root standard deviations <inline-formula id="IE63"><mml:math id="MM83"><mml:mrow><mml:msqrt><mml:mrow><mml:msup><mml:mo>σ</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula> as a function of mean log-counts <inline-formula id="IE64"><mml:math id="MM84"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, a piecewise linear function <inline-formula id="IE65"><mml:math id="MM85"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is yielded. Then, the predicted square-root standard deviation of <inline-formula id="IE66"><mml:math id="MM86"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is <inline-formula id="IE67"><mml:math id="MM87"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and the voom precision weight is defined as
<disp-formula id="E22"><label>(18)</label><mml:math id="MM88"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
Precision weights are incorporated into the model by replacing the first term in <xref ref-type="disp-formula" rid="E16">Equation (14)</xref> with the weighted sum of squared residuals.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Datasets</title>
    <sec>
      <title>3.1 Meteorological data</title>
      <p>We used meteorological data measured every <inline-formula id="IE68"><mml:math id="MM89"><mml:mrow><mml:mn>60</mml:mn><mml:mo> </mml:mo><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:math></inline-formula> at a meteorological station (Tsukuba (Tateno), <inline-formula id="IE69"><mml:math id="MM90"><mml:mrow><mml:mrow><mml:mn>36</mml:mn><mml:mo>°</mml:mo></mml:mrow><mml:mrow><mml:mn>03</mml:mn></mml:mrow><mml:mo>′</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mrow><mml:mn>140</mml:mn><mml:mo>°</mml:mo></mml:mrow><mml:mrow><mml:mn>08</mml:mn></mml:mrow><mml:mo>′</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> attitude <inline-formula id="IE70"><mml:math id="MM91"><mml:mrow><mml:mn>25.2</mml:mn><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:math></inline-formula>) of the Japan Meteorological Agency. The data consists of wind intensity = (<inline-formula id="IE71"><mml:math id="MM92"><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mo>/</mml:mo><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:math></inline-formula>), air temperature (<inline-formula id="IE72"><mml:math id="MM93"><mml:mrow><mml:mo>°</mml:mo><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:math></inline-formula>), relative humidity (%), atmospheric pressure (<inline-formula id="IE73"><mml:math id="MM94"><mml:mrow><mml:mtext>hPa</mml:mtext></mml:mrow></mml:math></inline-formula>), precipitation (<inline-formula id="IE74"><mml:math id="MM95"><mml:mrow><mml:mtext>mm</mml:mtext></mml:mrow></mml:math></inline-formula>), and global radiation (<inline-formula id="IE75"><mml:math id="MM96"><mml:mrow><mml:msup><mml:mrow><mml:mtext>kJm</mml:mtext></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>).</p>
    </sec>
    <sec>
      <title>3.2 Synthetic gene expression data</title>
      <p>In order to confirm that correct models can be selected by the proposed method, we synthetically generated RNA-Seq data assuming the following situation. Rice plants were transplanted into a paddy field on June 1. Samples were collected every week from June 12 to September 18, 2008 for <inline-formula id="IE76"><mml:math id="MM97"><mml:mrow><mml:mn>24</mml:mn><mml:mo> </mml:mo><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:math></inline-formula>. In order to verify influence of sampling design on model selection and parameter optimization, five types of sampling were considered: one sample at each time at intervals of <inline-formula id="IE77"><mml:math id="MM98"><mml:mrow><mml:mn>2</mml:mn><mml:mo> </mml:mo><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:math></inline-formula>, two samples at each time at intervals of <inline-formula id="IE78"><mml:math id="MM99"><mml:mrow><mml:mn>4</mml:mn><mml:mo> </mml:mo><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:math></inline-formula>, three samples at each time at intervals of <inline-formula id="IE79"><mml:math id="MM100"><mml:mrow><mml:mn>6</mml:mn><mml:mo> </mml:mo><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:math></inline-formula>, four samples at each time at intervals of <inline-formula id="IE80"><mml:math id="MM101"><mml:mrow><mml:mn>8</mml:mn><mml:mo> </mml:mo><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:math></inline-formula>, and six samples at each time at intervals of <inline-formula id="IE81"><mml:math id="MM102"><mml:mrow><mml:mn>12</mml:mn><mml:mo> </mml:mo><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:math></inline-formula>. The total number of samples for each type was 180. For evaluation of the predictive capability, we also computed gene expressions of samples assumed to be collected every week from June 12 to September 18, 2009 for <inline-formula id="IE82"><mml:math id="MM103"><mml:mrow><mml:mn>24</mml:mn><mml:mo> </mml:mo><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:math></inline-formula> at intervals of <inline-formula id="IE83"><mml:math id="MM104"><mml:mrow><mml:mn>2</mml:mn><mml:mo> </mml:mo><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:math></inline-formula>.</p>
      <p>The read count of gene <italic>i</italic> for RNA sample <italic>j</italic> was generated from a negative binomial distribution:
<disp-formula id="E23"><label>(19)</label><mml:math id="MM105"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>Γ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mo>ϕ</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>!</mml:mo><mml:mo>Γ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mo>ϕ</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mo>μ</mml:mo><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo>ϕ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msubsup><mml:mo>μ</mml:mo><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo>ϕ</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mo>ϕ</mml:mo><mml:mi>i</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE84"><mml:math id="MM106"><mml:mrow><mml:msubsup><mml:mo>μ</mml:mo><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE85"><mml:math id="MM107"><mml:mrow><mml:msub><mml:mo>ϕ</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are the mean and the dispersion parameter, respectively. The mean values varied according to the circadian clock, the response to environmental stimuli, and the plant’s age at the times of sampling, according to the 31 model equations shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>. In these equations, the logarithm of the average expression value for each gene <italic>α<sub>j</sub></italic> followed a normal distribution with an average of 5 and a standard deviation of 1.</p>
      <p>To decide dispersion parameters, we estimated the mean-dispersion trend from the Pickrell real RNA-Seq data set (<xref rid="btx049-B18" ref-type="bibr">Pickrell <italic>et al.</italic>, 2010</xref>), which is available from the tweeDESeqCountData R package (<ext-link ext-link-type="uri" xlink:href="http://www.creal.ca">http://www.creal.ca</ext-link>t/jrgonzalez/software.htm), using the method implemented in the edgeR package (<xref rid="btx049-B32" ref-type="bibr">Zhou <italic>et al.</italic>, 2014</xref>). From the estimated trend, we decided the value of the dispersion parameter corresponding to the average expression value for each gene <italic>α<sub>j</sub></italic>. Because we use the log-count per million values for analysis, 9969 constantly expressed genes (<inline-formula id="IE86"><mml:math id="MM108"><mml:mrow><mml:msubsup><mml:mo>μ</mml:mo><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mo>α</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>∀</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula>) were also considered in order to suppress the influence of the variation of the total read counts. The dispersion parameters of these constantly expressed genes were also decided according to the estimated mean-dispersion trend.</p>
    </sec>
    <sec>
      <title>3.3 Real gene expression data</title>
      <p>We also analyzed the same data as <xref rid="btx049-B14" ref-type="bibr">Nagano <italic>et al.</italic> (2012)</xref>, which consisted of microarray data from 461 samples of mature leaves of rice plants in a paddy field at Tsukuba collected in 2008, and 108 samples collected in 2009. We used data from the samples collected in 2008 for model selection and parameter fitting, and those from 2009 for evaluation of the model’s predictive capability. The samples collected in 2008 can be categorized into six groups: <inline-formula id="IE87"><mml:math id="MM109"><mml:mrow><mml:mn>24</mml:mn><mml:mo> </mml:mo><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:math></inline-formula> of samples collected at intervals of <inline-formula id="IE88"><mml:math id="MM110"><mml:mrow><mml:mn>2</mml:mn><mml:mo> </mml:mo><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:math></inline-formula> starting at 7:00 am on August 12, 2008 (8 samples at each time × 13 time points <inline-formula id="IE89"><mml:math id="MM111"><mml:mrow><mml:mo>=</mml:mo><mml:mn>104</mml:mn></mml:mrow></mml:math></inline-formula> samples); <inline-formula id="IE90"><mml:math id="MM112"><mml:mrow><mml:mn>48</mml:mn><mml:mo> </mml:mo><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:math></inline-formula> of samples collected at intervals of <inline-formula id="IE91"><mml:math id="MM113"><mml:mrow><mml:mn>2</mml:mn><mml:mo> </mml:mo><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:math></inline-formula> starting at 10:00 am on June 5, June 19, July 3, July 17, August 7, August 14, August 21, August 28, and September 11, 2008 (225 samples); samples collected at noon every other week from June 3 to September 23, 2008 (three samples at each time × 17 time points <inline-formula id="IE92"><mml:math id="MM114"><mml:mrow><mml:mo>=</mml:mo><mml:mn>51</mml:mn></mml:mrow></mml:math></inline-formula> samples); samples collected at 12:00 am every other week from June 4 to September 24, 2008 (2 samples at each time × 17 time points <inline-formula id="IE93"><mml:math id="MM115"><mml:mrow><mml:mo>=</mml:mo><mml:mn>34</mml:mn></mml:mrow></mml:math></inline-formula> samples); samples collected from 5:00 pm to 8:00 pm at intervals of <inline-formula id="IE94"><mml:math id="MM116"><mml:mrow><mml:mn>10</mml:mn><mml:mo> </mml:mo><mml:mtext>min</mml:mtext></mml:mrow></mml:math></inline-formula> on August 7, 2008 (19 samples); samples collected from 3:50 am to 6:00 am at intervals of <inline-formula id="IE95"><mml:math id="MM117"><mml:mrow><mml:mn>10</mml:mn><mml:mo> </mml:mo><mml:mtext>min</mml:mtext></mml:mrow></mml:math></inline-formula> on August 8, 2008 (two samples at each time × 14 time points <inline-formula id="IE96"><mml:math id="MM118"><mml:mrow><mml:mo>=</mml:mo><mml:mn>28</mml:mn></mml:mrow></mml:math></inline-formula> samples). The samples collected in 2009 can be categorized into six groups: <inline-formula id="IE97"><mml:math id="MM119"><mml:mrow><mml:mn>48</mml:mn><mml:mo> </mml:mo><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:math></inline-formula> of samples collected at intervals of <inline-formula id="IE98"><mml:math id="MM120"><mml:mrow><mml:mn>6</mml:mn><mml:mo> </mml:mo><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:math></inline-formula> starting at noon on August 10, 2009 (two samples at each time × 9 time points <inline-formula id="IE99"><mml:math id="MM121"><mml:mrow><mml:mo>=</mml:mo><mml:mn>18</mml:mn></mml:mrow></mml:math></inline-formula> samples); <inline-formula id="IE100"><mml:math id="MM122"><mml:mrow><mml:mn>24</mml:mn><mml:mo> </mml:mo><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:math></inline-formula> of samples collected at intervals of <inline-formula id="IE101"><mml:math id="MM123"><mml:mrow><mml:mn>2</mml:mn><mml:mo> </mml:mo><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:math></inline-formula> starting at 7:00 am on August 24, 2009 (6 samples at each time × 13 time points <inline-formula id="IE102"><mml:math id="MM124"><mml:mrow><mml:mo>=</mml:mo><mml:mn>78</mml:mn></mml:mrow></mml:math></inline-formula> samples); two samples collected at noon on August 31, 2009; two samples collected at 6:00 pm on August 31, 2009; four samples collected at 11:00 am on October 8, 2009; four samples collected at 11:00 am on October 9, 2009. This information is also summarized in <xref ref-type="supplementary-material" rid="sup1">Supplementary Tables S2 and S3</xref>. We extracted 17 616 genes having <italic>log</italic><sub>2</sub>-transformed signals larger than 5 in 80% of the samples from 2008.</p>
      <p>To validate the proposed model’s applicability to RNA-Seq data, we generated pseudo RNA-Seq data from the same microarray data. The pseudo RNA-Seq data of sample <italic>j</italic> were sampled from the multinomial distribution:
<disp-formula id="E24"><label>(20)</label><mml:math id="MM125"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>!</mml:mo></mml:mrow><mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>∏</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mi>J</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
Here, <inline-formula id="IE103"><mml:math id="MM126"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mn>8</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> is the total number of reads.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Results</title>
    <sec>
      <title>4.1 Synthetic gene expression data</title>
      <p>We used synthetic RNA-Seq data collected in 2008 for parameter optimization and model selection; we used synthetic RNA-Seq data collected in 2009 to evaluate the prediction capabilities of the optimized model. Mean squared errors (MSE) and correlation coefficients between the predicted and synthetic gene expressions are plotted in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figures S1 and S2</xref>. These figures indicate that sampling at intervals of <inline-formula id="IE104"><mml:math id="MM127"><mml:mrow><mml:mn>4</mml:mn><mml:mo> </mml:mo><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:math></inline-formula> provides better predictive performance than sampling at longer intervals. It can be considered that sampling at <inline-formula id="IE105"><mml:math id="MM128"><mml:mrow><mml:mn>4</mml:mn><mml:mo> </mml:mo><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:math></inline-formula> effectively captures diurnal variation of gene expression patterns. Although the predictive performance of sampling at <inline-formula id="IE106"><mml:math id="MM129"><mml:mrow><mml:mn>2</mml:mn><mml:mo> </mml:mo><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:math></inline-formula> intervals was comparable to that of sampling at <inline-formula id="IE107"><mml:math id="MM130"><mml:mrow><mml:mn>4</mml:mn><mml:mo> </mml:mo><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:math></inline-formula> intervals, longer intervals are preferable in terms of sampling labor. Hence, only results of sampling at <inline-formula id="IE108"><mml:math id="MM131"><mml:mrow><mml:mn>4</mml:mn><mml:mo> </mml:mo><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:math></inline-formula> intervals are shown below.</p>
      <p>The selected models for variably expressed genes are summarized in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S4</xref>. This results indicate that the correct models were selected for 29 out of 31 genes. It is important to note that absolute values of coefficients do not always correspond to those of the true models in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>, because of the normalization and nonlinear transformation of inputs. Further, the constant model, where all coefficients are zero, was correctly selected for 8441 out of 9969 constantly expressed genes. These results indicate that the variable selection through L1 regularization worked well.</p>
      <p>We also confirmed that the optimized parameter values were consistent with those of the true models for variably expressed genes. The polar plot of the optimized coefficients of circadian clocks <inline-formula id="IE109"><mml:math id="MM132"><mml:mrow><mml:msubsup><mml:mo>β</mml:mo><mml:mrow><mml:mo> </mml:mo><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:msubsup><mml:mo>β</mml:mo><mml:mrow><mml:mo> </mml:mo><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S3</xref>. The phases of circadian clocks <inline-formula id="IE110"><mml:math id="MM133"><mml:mrow><mml:msup><mml:mo>φ</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>arg</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mo>β</mml:mo><mml:mrow><mml:mo> </mml:mo><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:msubsup><mml:mo>β</mml:mo><mml:mrow><mml:mo> </mml:mo><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> clearly correspond to those of the true models. The optimized memory time periods were sharply distributed around the values, which were very close to the true values (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S4</xref>). To confirm whether the optimized parameter values of responses to environmental stimuli were consistent with those of the true models, we computed the responses as follows:
<disp-formula id="E25"><mml:math id="MM134"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mo>β</mml:mo><mml:mi>r</mml:mi></mml:msub><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>tanh</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:msup><mml:mo>ρ</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo> </mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:msubsup><mml:mo>γ</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="true">)</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mo>θ</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="true">)</mml:mo><mml:mo stretchy="true">)</mml:mo><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="E26"><label>(21)</label><mml:math id="MM135"><mml:mrow><mml:mo>×</mml:mo><mml:msqrt><mml:mrow><mml:mo> </mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msubsup><mml:mo>γ</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msqrt><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
Here, <italic>T</italic> denotes temperature, and <inline-formula id="IE111"><mml:math id="MM136"><mml:mrow><mml:msup><mml:mo>ρ</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> indicates the type of response, that is, <inline-formula id="IE112"><mml:math id="MM137"><mml:mrow><mml:msup><mml:mo>ρ</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> if a plant responds to temperatures over the threshold <inline-formula id="IE113"><mml:math id="MM138"><mml:mrow><mml:msup><mml:mo>θ</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, otherwise, <inline-formula id="IE114"><mml:math id="MM139"><mml:mrow><mml:msup><mml:mo>ρ</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. The optimized responses of variably expressed genes are plotted in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S5</xref>. The optimized models of dose-independent genes tend to exhibit step function-like responses compared to those of dose-dependent genes. Although some dose-independent genes with positive (negative) coefficients of responses respond to temperatures over (under) the threshold contrary to the true models, they can match the response functions by adding (subtracting) certain constant values.</p>
    </sec>
    <sec>
      <title>4.2 Real gene expression data</title>
      <p>We optimized the parameters of the model using the microarray data of samples collected in 2008 by normal optimization, in which we performed both the grid search and the nonlinear optimization for all genes, and cluster-based optimization (section 2.3). We also applied cluster-based optimization to pseudo RNA-Seq data generated from the same microarray data. We performed all optimizations on an Amazon EC2 m3.medium instance (one Intel Xeon E5-2670 v2 processor, <inline-formula id="IE115"><mml:math id="MM140"><mml:mrow><mml:mn>3.75</mml:mn><mml:mo> </mml:mo><mml:mtext>GiB</mml:mtext></mml:mrow></mml:math></inline-formula> memory). The normal optimization took <inline-formula id="IE116"><mml:math id="MM141"><mml:mrow><mml:mn>81.4</mml:mn><mml:mo> </mml:mo><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:math></inline-formula> per gene on average. If we performed the normal optimization using a single m3.medium instance, we could optimize parameters for 17 616 genes within 17 days. The affinity-propagation method yielded 500 clusters and their exemplars. After normal optimization for these exemplars, we performed nonlinear optimization for other genes using the Nelder–Mead method. The nonlinear optimization took <inline-formula id="IE117"><mml:math id="MM142"><mml:mrow><mml:mn>22.3</mml:mn><mml:mo> </mml:mo><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:math></inline-formula> per gene. We could optimize parameters for 17 616 genes within 5 days by using a single instance. In the previous study (<xref rid="btx049-B14" ref-type="bibr">Nagano <italic>et al.</italic>, 2012</xref>), the parameter optimization took about 30 days using a high-performance cluster computer. Even after taking into consideration advances in computer technology, the new model improved computational efficiency.</p>
      <p>The fitness of the new model was compared to that of the previous model by coefficients of determination <italic>R</italic><sup>2</sup>, defined as
<disp-formula id="E27"><label>(22)</label><mml:math id="MM143"><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
for microarray data and
<disp-formula id="E28"><label>(23)</label><mml:math id="MM144"><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
for pseudo RNA-Seq data. Here, <inline-formula id="IE118"><mml:math id="MM145"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE119"><mml:math id="MM146"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> are the predictions of models for microarray and pseudo RNA-Seq data, and <inline-formula id="IE120"><mml:math id="MM147"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE121"><mml:math id="MM148"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> denote the average <italic>log</italic><sub>2</sub>-transformed signals and pseudo log-rpm values, respectively. <xref ref-type="fig" rid="btx049-F2">Figure 2</xref> shows the <italic>R</italic><sup>2</sup> values. The <italic>R</italic><sup>2</sup> values of three different optimizations were comparable to those of the previous model.</p>
      <fig id="btx049-F2" orientation="portrait" position="float">
        <label>Fig. 2</label>
        <caption>
          <p>Comparison of coefficients of determination (<italic>R</italic><sup>2</sup>). Distributions of <italic>R</italic><sup>2</sup> from the previous model are compared to those of the new model with normal optimization (<bold>a:</bold> "normal"), cluster-based optimization (<bold>b:</bold> "cluster"), and cluster-based optimization with pseudo RNA-Seq data (<bold>c:</bold> "RNA-Seq"). (d) Boxplot of <italic>R</italic><sup>2</sup> values</p>
        </caption>
        <graphic xlink:href="btx049f2"/>
      </fig>
      <p>To assess the new model’s capability to predict gene expression, we predicted the microarray data or pseudo RNA-Seq data of samples collected in 2009. We compared gene-wise mean squared errors across samples. The mean squared errors of the new model with normal optimization, cluster-based optimization, and cluster-based optimization using pseudo RNA-Seq data were smaller than those of the previous model for 12 125, 12 209 and 9305 out of 17 616 genes, respectively. Hence, the new model yields better predictions than the previous model, regardless of whether the parameters are optimized by the normal or the cluster-based methods and whether the data are measured using a microarray or RNA-Seq. We also calculated gene-wise correlation across samples and sample-wise correlation across genes between prediction and observation. The gene-wise correlation is illustrated in <xref ref-type="fig" rid="btx049-F3">Figure 3</xref>. The distributions of the correlation coefficients of the new model were comparable to that of the previous model, regardless of the methods of measurement and parameter optimization. Further, the sample-wise correlations of all three tests were higher than 0.9 for most samples and improved in comparison to those of the previous model (<xref ref-type="fig" rid="btx049-F4">Fig. 4</xref>).</p>
      <fig id="btx049-F3" orientation="portrait" position="float">
        <label>Fig. 3</label>
        <caption>
          <p>Comparison of gene-wise correlation across samples. Each panel is illustrated as in Fig. 2. The null model, in which the expression is the constant, was selected for some genes in the previous study. Because correlation coefficients for such genes cannot be defined, the total number of genes contained in the plots of the previous study (dashed) is smaller than that of the new model (solid)</p>
        </caption>
        <graphic xlink:href="btx049f3"/>
      </fig>
      <fig id="btx049-F4" orientation="portrait" position="float">
        <label>Fig. 4</label>
        <caption>
          <p>Comparison of sample-wise correlation across genes. Each panel is illustrated as in Figure 2</p>
        </caption>
        <graphic xlink:href="btx049f4"/>
      </fig>
      <p>Next, we compared the models selected by the normal optimization to those obtained in the previous study (<xref rid="btx049-B14" ref-type="bibr">Nagano <italic>et al.</italic>, 2012</xref>). <xref rid="btx049-T1" ref-type="table">Table 1</xref> shows the numbers of genes for which each environmental factor was selected in the previous study and the normal optimization of the new model. Each row and column shows the number of genes for which the corresponding environmental factor was selected in the previous study and the normal optimization of the new model, respectively. The bottom row represents the model without the environmental effects. In the normal optimization, if the weight for the environmental effects is zero, the gene is counted as "new none." The bold-faced numbers in the diagonal cells of the table indicate the numbers of genes for which the same environmental factor was selected in the previous study and the normal optimization of the new model. The same environmental factor was selected in both models for 4523 (sum of the first six diagonal cells) out of 7496 genes, for which the selected models contain the response to any environmental factors in both the previous and new studies. Meanwhile, in the previous study, the model without the environmental effects was selected for 10 120 genes (sum of the bottom row); it was selected by the normal optimization of the new model for only 5714 genes (sum of the rightmost column). The previous model tends to select the model without the environmental effects about twice as frequently as the new model. This difference is probably due to differences in the model selection, i.e., likelihood ratio tests and group lasso.
<table-wrap id="btx049-T1" orientation="portrait" position="float"><label>Table 1</label><caption><p>Comparison of selected models</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col valign="top" align="left" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="center" span="1"/></colgroup><thead><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">New wind</th><th rowspan="1" colspan="1">New temperature</th><th rowspan="1" colspan="1">New humidity</th><th rowspan="1" colspan="1">New atmosphere</th><th rowspan="1" colspan="1">New radiation</th><th rowspan="1" colspan="1">New precipitation</th><th rowspan="1" colspan="1">New none</th></tr></thead><tbody><tr><td rowspan="1" colspan="1">Previous wind</td><td rowspan="1" colspan="1"><bold>56</bold></td><td rowspan="1" colspan="1">20</td><td rowspan="1" colspan="1">8</td><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">7</td><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">113</td></tr><tr><td rowspan="1" colspan="1">Previous temperature</td><td rowspan="1" colspan="1">36</td><td rowspan="1" colspan="1"><bold>3762</bold></td><td rowspan="1" colspan="1">99</td><td rowspan="1" colspan="1">68</td><td rowspan="1" colspan="1">92</td><td rowspan="1" colspan="1">15</td><td rowspan="1" colspan="1">877</td></tr><tr><td rowspan="1" colspan="1">Previous humidity</td><td rowspan="1" colspan="1">10</td><td rowspan="1" colspan="1">49</td><td rowspan="1" colspan="1"><bold>340</bold></td><td rowspan="1" colspan="1">7</td><td rowspan="1" colspan="1">27</td><td rowspan="1" colspan="1">14</td><td rowspan="1" colspan="1">237</td></tr><tr><td rowspan="1" colspan="1">Previous atmosphere</td><td rowspan="1" colspan="1">6</td><td rowspan="1" colspan="1">18</td><td rowspan="1" colspan="1">6</td><td rowspan="1" colspan="1"><bold>38</bold></td><td rowspan="1" colspan="1">7</td><td rowspan="1" colspan="1">6</td><td rowspan="1" colspan="1">78</td></tr><tr><td rowspan="1" colspan="1">Previous radiation</td><td rowspan="1" colspan="1">26</td><td rowspan="1" colspan="1">238</td><td rowspan="1" colspan="1">91</td><td rowspan="1" colspan="1">49</td><td rowspan="1" colspan="1"><bold>309</bold></td><td rowspan="1" colspan="1">20</td><td rowspan="1" colspan="1">647</td></tr><tr><td rowspan="1" colspan="1">Previous precipitation</td><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">8</td><td rowspan="1" colspan="1">13</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">10</td><td rowspan="1" colspan="1"><bold>18</bold></td><td rowspan="1" colspan="1">55</td></tr><tr><td rowspan="1" colspan="1">Previous none</td><td rowspan="1" colspan="1">233</td><td rowspan="1" colspan="1">4434</td><td rowspan="1" colspan="1">641</td><td rowspan="1" colspan="1">343</td><td rowspan="1" colspan="1">643</td><td rowspan="1" colspan="1">119</td><td rowspan="1" colspan="1"><bold>3707</bold></td></tr></tbody></table></table-wrap></p>
      <p>We investigated the associations between gene annotations and time-of-day characteristics of expressions to assess the consistency between model parameters and biological knowledge. For each gene ontology term with which more than 10 genes are annotated, we compared the distribution of clock phases <inline-formula id="IE122"><mml:math id="MM149"><mml:mo>φ</mml:mo></mml:math></inline-formula> of genes annotated with the term to its background distribution, which is that of genes not annotated with the term. The left-hand panel in <xref ref-type="fig" rid="btx049-F5">Figure 5</xref> indicates that the distribution of <inline-formula id="IE123"><mml:math id="MM150"><mml:mo>φ</mml:mo></mml:math></inline-formula> of genes annotated with protein serine/threonine kinase activity (GO:0004674) was significantly different from its background distribution (<inline-formula id="IE124"><mml:math id="MM151"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>2.07</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, Watson–Wheeler test, Bonferroni correction). The values of <inline-formula id="IE125"><mml:math id="MM152"><mml:mo>φ</mml:mo></mml:math></inline-formula> of many genes annotated with the term were distributed from before to after midnight. Because there were only four genes annotated with flavonoid biosynthetic process (GO:0009813), we did not perform the statistical test. However, the distribution of <inline-formula id="IE126"><mml:math id="MM153"><mml:mo>φ</mml:mo></mml:math></inline-formula> of those genes was clearly concentrated in the early morning (right-hand panel in <xref ref-type="fig" rid="btx049-F5">Fig. 5</xref>). These results are consistent with those of the previous study and a laboratory study of <italic>Arabidopsis</italic> in which the genes implicated in phenylpropanoid biosynthesis showed expressional peaks before subjective dawn (<xref rid="btx049-B5" ref-type="bibr">Harmer <italic>et al.</italic>, 2000</xref>). <xref ref-type="fig" rid="btx049-F6">Figure 6</xref> shows the distributions of <inline-formula id="IE127"><mml:math id="MM154"><mml:mo>φ</mml:mo></mml:math></inline-formula> of genes annotated with rRNA processing (GO:0006364), small ribosomal subunit (GO:0015935), ribosome (GO:0005840), large ribosomal subunit (GO:0015934), and aminoacyl-tRNA ligase activity (GO:0004812). Although the distribution of genes annotated with rRNA processing (GO:0006364) was not significantly different from its background distribution (<italic>P</italic> = 0.0659; Watson–Wheeler test, Bonferroni correction), the values of <inline-formula id="IE128"><mml:math id="MM155"><mml:mo>φ</mml:mo></mml:math></inline-formula> seem to concentrate in the afternoon. Other distributions (GO:0015935, GO:0005840, GO:0015934, and GO:0004812) were significantly different from their background distributions (<inline-formula id="IE129"><mml:math id="MM156"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>5.21</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>1.01</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>46</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <italic>P</italic> =  0.0168, and <inline-formula id="IE130"><mml:math id="MM157"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>6.22</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, respectively) and the peaks of the distributions were shifted from afternoon to evening in the same order as their biological order in rRNA processing. These results are also consistent with the previous results, which implies that the entrained circadian clock in the field controls the order of the acceleration of translation during the same time period.</p>
      <fig id="btx049-F5" orientation="portrait" position="float">
        <label>Fig. 5</label>
        <caption>
          <p>Distributions of clock phases <inline-formula id="IE131"><mml:math id="MM158"><mml:mo>φ</mml:mo></mml:math></inline-formula> of genes annotated with protein serine/threonine kinase activity (GO:0004674) and flavonoid biosynthetic process (GO:0009813). Fractions of genes annotated with the term and not annotated with the term are shown in red and gray, respectively</p>
        </caption>
        <graphic xlink:href="btx049f5"/>
      </fig>
      <fig id="btx049-F6" orientation="portrait" position="float">
        <label>Fig. 6</label>
        <caption>
          <p>Distributions of clock phases <inline-formula id="IE132"><mml:math id="MM159"><mml:mo>φ</mml:mo></mml:math></inline-formula> of genes annotated with GO:0006364 (rRNA processing), GO:0015935 (small ribosomal subunit), GO:0005840 (ribosome), GO:0015934 (large ribosomal subunit), and GO:0004812 (aminoacyl-tRNA ligase activity), shown as in Figure 5</p>
        </caption>
        <graphic xlink:href="btx049f6"/>
      </fig>
      <p>We can also use model parameters to form a hypothesis about biological processes occurring in a field. The associations between gene annotations and regression coefficients were also investigated. Before the investigation, we divided the regression coefficients for each gene by the standard deviation of the observed expression of the gene to normalize coefficients. The absolute values of the normalized coefficients of genotype <inline-formula id="IE133"><mml:math id="MM160"><mml:mrow><mml:msubsup><mml:mo>β</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> for genes annotated with photosynthesis (GO:0015979), thylakoid (GO:0009579), and photosysthetic membrane (GO:0034357) were significantly larger than the background distributions of those values (<inline-formula id="IE134"><mml:math id="MM161"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>3.04</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>5.93</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE135"><mml:math id="MM162"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>1.51</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, respectively, Wilcoxon rank sum test, Bonferroni correction). This result implies that the difference in genotype affects photosynthesis. Further, the absolute values of normalized coefficients of the response for genes, for which temperature was selected as an environmental factor, indicated a significant association with phosphorus metabolic process (GO:0006793) (<inline-formula id="IE136"><mml:math id="MM163"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>6.93</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, Wilcoxon rank sum test, Bonferroni correction). This association suggests that phosphorum metabolism may be affected by fluctuations in temperature.</p>
    </sec>
  </sec>
  <sec>
    <title>5 Conclusion</title>
    <p>In this paper, we proposed a new gene expression model for organisms in a field, based on a previous model (<xref rid="btx049-B14" ref-type="bibr">Nagano <italic>et al.</italic>, 2012</xref>). The new model vastly reduces the computational time required for parameter optimization and model selection by unifying various types of gate functions and response functions, and introducing group lasso (<xref rid="btx049-B31" ref-type="bibr">Yuan and Lin, 2006</xref>). By applying the model to synthetically generated RNA-Seq data, we confirmed that the optimized model was consistent with the true gene expression dynamics for most genes. Further, to assess the capability of the new model, we applied it to the same ric plant data that were used in the previous study. The new model offered a comparable or slightly better prediction for most genes.</p>
    <p>The model parameters were consistent with those of the previous study and the biological knowledge. This consistency indicates the model’s capability to provide biological insights. In fact, the investigation of model parameters found associations between genotypes and photosynthesis and between the response to temperature and phosphorum metabolism, which were not discovered in molecular biological studies. We can form a hypothesis based on such associations; it will be validated by further experimental studies.</p>
    <p>Whereas the previous model was targeted only for microarray data, the new model is applicable to RNA-Seq data. The results of applying the new model to synthetic RNA-Seq data assuming known true models and pseudo RNA-Seq data generated from real microarray data indicated that the model may be useful for the analysis of RNA-Seq data. However, it should be noted that, in this study, the applicability was verified with only simulated data rather than real data. Further verification of performance with real data is required.</p>
    <p>In this study, we focused on the time variation of gene expression and analyzed transcriptome data sampled over time. However, the proposed model is applicable to data collected by other sampling strategies, such as multiple treatments at a single time point, only by preparing meteorological data of sufficient length. Further, although we applied the model to the transcriptome data of rice plants in this study, it is applicable to those of other organisms.</p>
    <p>The developed package (FIT) offers efficient parameter optimization and model selection. While the parameter optimization and model selection processes for all genes in the previous study required 30 days when a high-performance cluster computer was used, our new package does not incur such a high computational cost. Because the model describes the expression of each gene independently, the parameter optimization and model selection processes can be easily performed in parallel by dividing genes into several groups and performing these processes for each group. For example, it is expected that the parameter optimization and model selection processes can be completed by 10 Amazon EC2 m3.medium instances in half a day. This package will accelerate field transcriptomic studies.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by Precursory Research for Embryonic Science and Technology (PRESTO), Japan Science and Technology Agency (JST) to A.J.N.; Core Research for Evolutional Science and Technology (CREST), JST to A.J.N.; Accelerated Innovation Research Initiative Turning Top Science and Ideas into High-Impact Values (ACCEL), JST to A.J.N.; and KAKENHI [JP16H06171, JP16H01473 to A.J.N.].</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="btx049_supp.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="btx049-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ahuja</surname><given-names>I.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>Plant molecular stress responses face climate change</article-title>. <source>Trends Plant Sci</source>., <volume>15</volume>, <fpage>664</fpage>–<lpage>674</lpage>.<pub-id pub-id-type="pmid">20846898</pub-id></mixed-citation>
    </ref>
    <ref id="btx049-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Alvarez</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Ten years of transcriptomics in wild populations: what have we learned about their ecology and evolution?</article-title><source>Mol. Ecol</source>., <volume>24</volume>, <fpage>710</fpage>–<lpage>725</lpage>.<pub-id pub-id-type="pmid">25604587</pub-id></mixed-citation>
    </ref>
    <ref id="btx049-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cleveland</surname><given-names>W.S.</given-names></name></person-group> (<year>1979</year>) 
<article-title>Robust locally weighted regression and smoothing scatterplots</article-title>. <source>J. Am. Stat. Assoc</source>., <volume>74</volume>, <fpage>829</fpage>–<lpage>836</lpage>.</mixed-citation>
    </ref>
    <ref id="btx049-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Frey</surname><given-names>B.J.</given-names></name>, <name name-style="western"><surname>Dueck</surname><given-names>D.</given-names></name></person-group> (<year>2007</year>) 
<article-title>Clustering by passing messages between data points</article-title>. <source>Science</source>, <volume>315</volume>, <fpage>972</fpage>–<lpage>976</lpage>.<pub-id pub-id-type="pmid">17218491</pub-id></mixed-citation>
    </ref>
    <ref id="btx049-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Harmer</surname><given-names>S.L.</given-names></name></person-group><etal>et al</etal> (<year>2000</year>) 
<article-title>Orchestrated transcription of key pathways in Arabidopsis by the circadian clock</article-title>. <source>Science</source>, <volume>290</volume>, <fpage>2110</fpage>–<lpage>2113</lpage>.<pub-id pub-id-type="pmid">11118138</pub-id></mixed-citation>
    </ref>
    <ref id="btx049-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hayes</surname><given-names>K.R.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>Maize global transcriptomics reveals pervasive leaf diurnal rhythms but rhythms in developing ears are largely limited to the core oscillator</article-title>. <source>PLoS One</source>, <volume>5</volume>, <fpage>e12887.</fpage><pub-id pub-id-type="pmid">20886102</pub-id></mixed-citation>
    </ref>
    <ref id="btx049-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hoffmann</surname><given-names>A.A.</given-names></name>, <name name-style="western"><surname>Sgrò</surname><given-names>C.M.</given-names></name></person-group> (<year>2011</year>) 
<article-title>Climate change and evolutionary adaptation</article-title>. <source>Nature</source>, <volume>470</volume>, <fpage>479</fpage>–<lpage>485</lpage>.<pub-id pub-id-type="pmid">21350480</pub-id></mixed-citation>
    </ref>
    <ref id="btx049-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Izawa</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Os-gigantea confers robust diurnal rhythms on the global transcriptome of rice in the field</article-title>. <source>Plant Cell</source>, <volume>23</volume>, <fpage>1741</fpage>–<lpage>1755</lpage>.<pub-id pub-id-type="pmid">21571948</pub-id></mixed-citation>
    </ref>
    <ref id="btx049-B9">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Jones</surname><given-names>H.G.</given-names></name></person-group> (<year>2013</year>). <source>Plants and Microclimate: A Quantitative Approach to Environmental Plant Physiology</source>. 
<publisher-name>Cambridge University Press</publisher-name>, 
<publisher-loc>Cambridge</publisher-loc> .</mixed-citation>
    </ref>
    <ref id="btx049-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Law</surname><given-names>C.W.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>voom: Precision weights unlock linear model analysis tools for RNA-seq read counts</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>R29.</fpage><pub-id pub-id-type="pmid">24485249</pub-id></mixed-citation>
    </ref>
    <ref id="btx049-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lovell</surname><given-names>J.T.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Promises and challenges of eco-physiological genomics in the field: tests of drought responses in switchgrass</article-title>. <source>Plant Physiol</source>., <volume>172</volume>, <fpage>734</fpage>–<lpage>748</lpage>.<pub-id pub-id-type="pmid">27246097</pub-id></mixed-citation>
    </ref>
    <ref id="btx049-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Malmberg</surname><given-names>R.L.</given-names></name></person-group><etal>et al</etal> (<year>2005</year>) 
<article-title>Epistasis for fitness-related quantitative traits in Arabidopsis thaliana grown in the field and in the greenhouse</article-title>. <source>Genetics</source>, <volume>171</volume>, <fpage>2013</fpage>–<lpage>2027</lpage>.<pub-id pub-id-type="pmid">16157670</pub-id></mixed-citation>
    </ref>
    <ref id="btx049-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mishra</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Arabidopsis plants grown in the field and climate chambers significantly differ in leaf morphology and photosystem components</article-title>. <source>BMC Plant Biol</source>., <volume>12</volume>, <fpage>6.</fpage><pub-id pub-id-type="pmid">22236032</pub-id></mixed-citation>
    </ref>
    <ref id="btx049-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nagano</surname><given-names>A.J.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Deciphering and prediction of transcriptome dynamics under fluctuating field conditions</article-title>. <source>Cell</source>, <volume>151</volume>, <fpage>1358</fpage>–<lpage>1369</lpage>.<pub-id pub-id-type="pmid">23217716</pub-id></mixed-citation>
    </ref>
    <ref id="btx049-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nelder</surname><given-names>J.A.</given-names></name>, <name name-style="western"><surname>Mead</surname><given-names>R.</given-names></name></person-group> (<year>1965</year>) 
<article-title>A simplex method for function minimization</article-title>. <source>Comput. J</source>., <volume>7</volume>, <fpage>308</fpage>–<lpage>313</lpage>.</mixed-citation>
    </ref>
    <ref id="btx049-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nicotra</surname><given-names>A.B.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>Plant phenotypic plasticity in a changing climate</article-title>. <source>Trends Plant Sci</source>., <volume>15</volume>, <fpage>684</fpage>–<lpage>692</lpage>.<pub-id pub-id-type="pmid">20970368</pub-id></mixed-citation>
    </ref>
    <ref id="btx049-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Obuchi</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Kabashima</surname><given-names>Y.</given-names></name></person-group> (<year>2016</year>) 
<article-title>Cross validation in lasso and its acceleration</article-title>. <source>J. Stat. Mech.: Theor Exp</source>., <volume>2016</volume>, <fpage>053304.</fpage></mixed-citation>
    </ref>
    <ref id="btx049-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pickrell</surname><given-names>J.K.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>Understanding mechanisms underlying human gene expression variation with RNA sequencing</article-title>. <source>Nature</source>, <volume>464</volume>, <fpage>768</fpage>–<lpage>772</lpage>.<pub-id pub-id-type="pmid">20220758</pub-id></mixed-citation>
    </ref>
    <ref id="btx049-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Plessis</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Multiple abiotic stimuli are integrated in the regulation of rice gene expression under field conditions</article-title>. <source>eLife</source>, <volume>4</volume>, <fpage>e08411.</fpage><pub-id pub-id-type="pmid">26609814</pub-id></mixed-citation>
    </ref>
    <ref id="btx049-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Richards</surname><given-names>C.L.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Genome-wide patterns of Arabidopsis gene expression in nature</article-title>. <source>PLoS Genet</source>., <volume>8</volume>, <fpage>e1002662.</fpage><pub-id pub-id-type="pmid">22532807</pub-id></mixed-citation>
    </ref>
    <ref id="btx049-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Robinson</surname><given-names>M.D.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>. <source>Bioinformatics</source>, <volume>26</volume>, <fpage>139</fpage>–<lpage>140</lpage>.<pub-id pub-id-type="pmid">19910308</pub-id></mixed-citation>
    </ref>
    <ref id="btx049-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sato</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Field transcriptome revealed critical developmental and physiological transitions involved in the expression of growth potential in japonica rice</article-title>. <source>BMC Plant Biol</source>., <volume>11</volume>, <fpage>10</fpage>.<pub-id pub-id-type="pmid">21226959</pub-id></mixed-citation>
    </ref>
    <ref id="btx049-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Thomas</surname><given-names>D.</given-names></name></person-group> (<year>2010</year>) 
<article-title>Gene-environment–wide association studies: emerging approaches</article-title>. <source>Nature Rev. Genet</source>., <volume>11</volume>, <fpage>259</fpage>–<lpage>272</lpage>.<pub-id pub-id-type="pmid">20212493</pub-id></mixed-citation>
    </ref>
    <ref id="btx049-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tibshirani</surname><given-names>R.</given-names></name></person-group> (<year>1996</year>) 
<article-title>Regression shrinkage and selection via the lasso</article-title>. <source>J. Roy. Stat. Soc. Ser. B Methodological</source>, <volume>58</volume>, <fpage>267</fpage>–<lpage>288</lpage>.</mixed-citation>
    </ref>
    <ref id="btx049-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Leng</surname><given-names>C.</given-names></name></person-group> (<year>2008</year>) 
<article-title>A note on adaptive group lasso</article-title>. <source>Comput. Stat. Data Anal</source>., <volume>52</volume>, <fpage>5277</fpage>–<lpage>5286</lpage>.</mixed-citation>
    </ref>
    <ref id="btx049-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>Z.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title>. <source>Nature Reviews Genetics</source>, <volume>10</volume>, <fpage>57</fpage>–<lpage>63</lpage>.</mixed-citation>
    </ref>
    <ref id="btx049-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Weinig</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2002</year>) 
<article-title>Novel loci control variation in reproductive timing in Arabidopsis thaliana in natural environments</article-title>. <source>Genetics</source>, <volume>162</volume>, <fpage>1875</fpage>–<lpage>1884</lpage>.<pub-id pub-id-type="pmid">12524356</pub-id></mixed-citation>
    </ref>
    <ref id="btx049-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Weston</surname><given-names>D.J.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>Connecting genes, coexpression modules, and molecular signatures to environmental stress phenotypes in plants</article-title>. <source>BMC Syst. Biol</source>., <volume>2</volume>, <fpage>16.</fpage><pub-id pub-id-type="pmid">18248680</pub-id></mixed-citation>
    </ref>
    <ref id="btx049-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Xu</surname><given-names>Y.</given-names></name></person-group> (<year>2016</year>) 
<article-title>Envirotyping for deciphering environmental impacts on crop plants</article-title>. <source>Theor. Appl. Genet</source>., <volume>129</volume>, <fpage>653</fpage>–<lpage>673</lpage>.<pub-id pub-id-type="pmid">26932121</pub-id></mixed-citation>
    </ref>
    <ref id="btx049-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yamori</surname><given-names>W.</given-names></name></person-group> (<year>2016</year>) 
<article-title>Photosynthetic response to fluctuating environments and photoprotective strategies under abiotic stress</article-title>. <source>J. Plant Res</source>., <volume>129</volume>, <fpage>379</fpage>–<lpage>395</lpage>.<pub-id pub-id-type="pmid">27023791</pub-id></mixed-citation>
    </ref>
    <ref id="btx049-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yuan</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Lin</surname><given-names>Y.</given-names></name></person-group> (<year>2006</year>) 
<article-title>Model selection and estimation in regression with grouped variables</article-title>. <source>J.Roy. Stat. Soc.: Ser. B (Statistical Methodology)</source>, <volume>68</volume>, <fpage>49</fpage>–<lpage>67</lpage>.</mixed-citation>
    </ref>
    <ref id="btx049-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhou</surname><given-names>X.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Robustly detecting differential expression in RNA sequencing data using observation weights</article-title>. <source>Nucl. Acids Res</source>., <volume>42</volume>, <fpage>e91.</fpage><pub-id pub-id-type="pmid">24753412</pub-id></mixed-citation>
    </ref>
    <ref id="btx049-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zou</surname><given-names>H.</given-names></name></person-group> (<year>2006</year>) 
<article-title>The adaptive Lasso and its oracle properties</article-title>. <source>J. Am. Stat. Assoc</source>., <volume>101</volume>, <fpage>1418</fpage>–<lpage>1429</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
