<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8555268</article-id>
    <article-id pub-id-type="publisher-id">4441</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-021-04441-9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>adabmDCA: adaptive Boltzmann machine learning for biological sequences</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3937-3763</contrib-id>
        <name>
          <surname>Muntoni</surname>
          <given-names>Anna Paola</given-names>
        </name>
        <address>
          <email>anna.muntoni@polito.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pagnani</surname>
          <given-names>Andrea</given-names>
        </name>
        <address>
          <email>andrea.pagnani@polito.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Weigt</surname>
          <given-names>Martin</given-names>
        </name>
        <address>
          <email>martin.weigt@upmc.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zamponi</surname>
          <given-names>Francesco</given-names>
        </name>
        <address>
          <email>francesco.zamponi@ens.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.428948.b</institution-id><institution-id institution-id-type="ISNI">0000 0004 1784 6598</institution-id><institution>Statistical Inference and Biological Modeling Group, </institution><institution>Italian Institute for Genomic Medicine, </institution></institution-wrap>Candiolo, Italy </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.4800.c</institution-id><institution-id institution-id-type="ISNI">0000 0004 1937 0343</institution-id><institution>Department of Applied Science and Technology, </institution><institution>Politecnico di Torino, </institution></institution-wrap>Turin, Italy </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.470222.1</institution-id><institution-id institution-id-type="ISNI">0000 0004 7471 9712</institution-id><institution>Sezione di Torino, </institution><institution>Istituto Nazionale Fisica Nucleare, </institution></institution-wrap>Turin, Italy </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.462844.8</institution-id><institution-id institution-id-type="ISNI">0000 0001 2308 1657</institution-id><institution>Institut de Biologie Paris Seine, Biologie Computationnelle et Quantitative LCQB, CNRS, </institution><institution>Sorbonne Université, </institution></institution-wrap>Paris, France </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.462608.e</institution-id><institution-id institution-id-type="ISNI">0000 0004 0384 7821</institution-id><institution>Laboratoire de Physique de l’Ecole Normale Supérieure, ENS, CNRS, </institution><institution>Université PSL, Sorbonne Université, Université de Paris, </institution></institution-wrap>Paris, France </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>528</elocation-id>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>8</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>10</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Boltzmann machines are energy-based models that have been shown to provide an accurate statistical description of domains of evolutionary-related protein and RNA families. They are parametrized in terms of local biases accounting for residue conservation, and pairwise terms to model epistatic coevolution between residues. From the model parameters, it is possible to extract an accurate prediction of the three-dimensional contact map of the target domain. More recently, the accuracy of these models has been also assessed in terms of their ability in predicting mutational effects and generating <italic>in silico</italic> functional sequences.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Our adaptive implementation of Boltzmann machine learning, adabmDCA, can be generally applied to both protein and RNA families and accomplishes several learning set-ups, depending on the complexity of the input data and on the user requirements. The code is fully available at <ext-link ext-link-type="uri" xlink:href="https://github.com/anna-pa-m/adabmDCA">https://github.com/anna-pa-m/adabmDCA</ext-link>. As an example, we have performed the learning of three Boltzmann machines modeling the Kunitz and Beta-lactamase2 protein domains and TPP-riboswitch RNA domain.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">The models learned by adabmDCA are comparable to those obtained by state-of-the-art techniques for this task, in terms of the quality of the inferred contact map as well as of the synthetically generated sequences. In addition, the code implements both equilibrium and out-of-equilibrium learning, which allows for an accurate and lossless training when the equilibrium one is prohibitive in terms of computational time, and allows for pruning irrelevant parameters using an information-based criterion.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Boltzmann machine learning</kwd>
      <kwd>Protein modelling</kwd>
      <kwd>RNA modelling</kwd>
      <kwd>Statistical inference</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000893</institution-id>
            <institution>Simons Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>#454955</award-id>
        <principal-award-recipient>
          <name>
            <surname>Zamponi</surname>
            <given-names>Francesco</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100010661</institution-id>
            <institution>Horizon 2020 Framework Programme</institution>
          </institution-wrap>
        </funding-source>
        <award-id>734439 InferNet</award-id>
        <principal-award-recipient>
          <name>
            <surname>Weigt</surname>
            <given-names>Martin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <sec id="Sec2">
      <title>Protein and RNA sequence modelling</title>
      <p id="Par9">In recent years, the number of available protein and RNA sequences has shown an impressive growth thanks to the development of high-throughput sequencing techniques. As a consequence, databases like Pfam [<xref ref-type="bibr" rid="CR1">1</xref>] and Rfam [<xref ref-type="bibr" rid="CR2">2</xref>], where such biological sequences are annotated and classified according to evolutionary relationships, play a dominant role in modeling this enormous amount of data.</p>
      <p id="Par10">In spite of this constant increase of sequence data, the tertiary structure of the corresponding domains is nowadays not experimentally accessible for the majority of the known protein and RNA sequences. To compensate for this experimental gap, <italic>in silico</italic> protein and RNA domains modeling has shown an incredible predictive power in determining their structure [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>]. An interesting way to achieve this goal is to perform data-driven modeling to reproduce some relevant statistical properties of the data (observables).</p>
      <p id="Par11">The so-called Direct Coupling Analysis (DCA) [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>] turns out to be particularly successful in using available homologous sequence data to infer structural determinants of the underlying protein or RNA domains [<xref ref-type="bibr" rid="CR7">7</xref>]. In a nutshell, the DCA inference strategy provides a simple and informative interpretation of the inferred set of model parameters in terms of remarkably accurate contact map prediction. Among the different DCA implementations, Boltzmann machine learning [<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR11">11</xref>] turns out to be one of the most efficient in terms of: (1) the accuracy of structural predictions in its direct use, or as input of more complex deep learning supervised strategies [<xref ref-type="bibr" rid="CR12">12</xref>–<xref ref-type="bibr" rid="CR15">15</xref>]; (2) the effectiveness to generate artificially-designed sequences that fold similarly to their natural counterparts [<xref ref-type="bibr" rid="CR16">16</xref>]; (3) the ability to predict mutational effects [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>]. However, the quality of the Boltzmann machine deeply depends on the quality of the learning, which is intrinsically linked to the way the model observables are computed within the training, usually employing a Monte Carlo Markov Chain (MCMC).</p>
      <p id="Par12">Here, we present adabmDCA, an adaptive Boltzmann machine learning computational strategy that, taking as input a multiple sequence alignment of a target protein or RNA domain, infers efficiently an accurate statistical model of the sequence data with the twofold aim of (1) providing an accurate contact map prediction of the target domain, and (2) generating artificial sequences that are statistically close to indistinguishable (and thus <italic>bona fide</italic> biologically functional) from the natural. The code implements the so-called Boltzmann machine learning algorithm [<xref ref-type="bibr" rid="CR19">19</xref>] by performing a gradient ascent of the <italic>a posteriori</italic> probability of the model given the input data. At variance with other implementations, adabmDCA copes with both protein and RNA data, and encompasses the ability of pruning redundant parameters (as described in [<xref ref-type="bibr" rid="CR11">11</xref>]). Finally, it provides a standard <italic>equilibrium</italic> learning and also a <italic>non-equilibrium</italic> learning, based on the contrastive divergence technique [<xref ref-type="bibr" rid="CR20">20</xref>], which is more suitable for structured data.</p>
    </sec>
    <sec id="Sec3">
      <title>An introduction to Boltzmann learning of biological models</title>
      <p id="Par13">The input of Boltzmann learning is a multiple sequence alignment (MSA) of a protein or a RNA family. The MSA contains <italic>M</italic> aligned sequences of length <italic>L</italic> of the same domain family, characterized by a certain structure and/or function. The key idea behind DCA is that evolutionarily related sequences show, together with a strong conservation signal on key residues (for instance in presence of active sites), large correlations among pairs of residues due to (mostly) structural constraints. If a random mutation affects the residue present on a certain site <italic>i</italic>, a compensatory mutation may be needed to appear in sites <italic>j</italic> in contact with residue <italic>i</italic> in order to preserve the overall structure of the domain. However, correlations alone provide poor results in terms of contact prediction (due to the presence of spurious correlations among sites not in direct contact), and therefore more sophisticated techniques such as DCA have been used to reliably extract the underlying coevolutionary signal.</p>
      <p id="Par14">In the following, we assume that each natural sequence <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{s}=(s_1,\ldots ,s_L)$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq1.gif"/></alternatives></inline-formula> belonging to a protein or RNA family is an independent and identically distributed (i.i.d.) sample of an unknown distribution (correlations due to phylogeny will be addressed through a standard re-weighting scheme explained below). Each residue <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_{i}$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq2.gif"/></alternatives></inline-formula> takes value from an alphabet of <italic>q</italic> symbols representing all possible amino-acids or nucleic acids plus a ‘-’ gap symbol (<inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q = 21$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>21</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq3.gif"/></alternatives></inline-formula> in the case of protein sequences or <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q = 5$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq4.gif"/></alternatives></inline-formula> for RNA). Given a MSA, we aim at finding a probability measure over sequences of length <italic>L</italic> that is able to accurately reproduce a set of chosen observables computed from the data. In particular, Boltzmann learning aims at reproducing all (or a subset of) the one-site and two-site empirical frequency counts. By applying the maximum entropy principle  [<xref ref-type="bibr" rid="CR21">21</xref>], the least-constrained distribution that characterizes our data is a Boltzmann distribution:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} P\left( \varvec{s}\right| \mathbf {J}, \mathbf {h}) = \frac{1}{Z\left( \mathbf {J}, \mathbf {h} \right) } \exp \left( \sum _{i} h_i\left( s_i\right) + \sum _{i&lt;j} J_{i,j}\left( s_{i}, s_{j}\right) \right) \,, \end{aligned}$$\end{document}</tex-math><mml:math id="M10" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close="|" open="("><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow></mml:mfenced><mml:mrow><mml:mi mathvariant="bold">J</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">h</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>Z</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="bold">J</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">h</mml:mi></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfenced></mml:mfenced><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <italic>Z</italic> is the normalization factor (the so called partition function in statistical-physics terminology) ensuring the proper normalization of the distribution, and <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {J}$$\end{document}</tex-math><mml:math id="M12"><mml:mi mathvariant="bold">J</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq5.gif"/></alternatives></inline-formula> and <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {h}$$\end{document}</tex-math><mml:math id="M14"><mml:mi mathvariant="bold">h</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq6.gif"/></alternatives></inline-formula> are the set of Lagrange multipliers assuring the fit of the moments, or, from a statistical physics point-of-view, the coupling matrices and the fields associated with the Potts model in Eq. <xref rid="Equ1" ref-type="">1</xref>. This probability quantifies the likelihood that a candidate sequence <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {s}$$\end{document}</tex-math><mml:math id="M16"><mml:mi mathvariant="bold">s</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq7.gif"/></alternatives></inline-formula> belongs to the protein/RNA family characterized by the set of parameters <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {J},\mathbf {h}$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mi mathvariant="bold">J</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">h</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq8.gif"/></alternatives></inline-formula>. However, DCA aims at solving the related <italic>inverse</italic> problem: given a family’s MSA, how to determine the set of unknown parameters?</p>
      <p id="Par15">From a Bayesian perspective, the inverse problem can be mapped into the problem of finding the set of couplings <inline-formula id="IEq9"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {J}$$\end{document}</tex-math><mml:math id="M20"><mml:mi mathvariant="bold">J</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq9.gif"/></alternatives></inline-formula> and fields <inline-formula id="IEq10"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {h}$$\end{document}</tex-math><mml:math id="M22"><mml:mi mathvariant="bold">h</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq10.gif"/></alternatives></inline-formula> which maximize the posterior probability of the unknown parameters given the set of observed configurations of natural sequences<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} P\left( \mathbf {J},\mathbf {h}|\left\{ \varvec{s}^{\mu }:\mu =1,\ldots ,M\right\} \right) =\frac{P\left( \left\{ \varvec{s}^{\mu }\right\} |\mathbf {J},\mathbf {h}\right) P\left( \mathbf {J},\mathbf {h}\right) }{P\left( \left\{ \varvec{s}^{\mu }\right\} \right) }, \end{aligned}$$\end{document}</tex-math><mml:math id="M24" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold">J</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">h</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mfenced close="}" open="{"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msup><mml:mo>:</mml:mo><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mfenced></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mfenced close="}" open="{"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msup></mml:mfenced><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">J</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">h</mml:mi></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="bold">J</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">h</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mfenced close="}" open="{"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msup></mml:mfenced></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq11"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left( \left\{ \varvec{s}^{\mu }\right\} \right)$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mfenced close="}" open="{"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msup></mml:mfenced></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq11.gif"/></alternatives></inline-formula> is the evidence (since it is independent of the unknown parameters, it will be neglected in the following), <inline-formula id="IEq12"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left( \left\{ \varvec{s}^{\mu }\right\} |\mathbf {J},\mathbf {h}\right)$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mfenced close="}" open="{"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msup></mml:mfenced><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">J</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">h</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq12.gif"/></alternatives></inline-formula> is the likelihood function, which describes how probable it is to randomly draw the sequences in the MSA from the distribution parametrized by <inline-formula id="IEq13"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( \mathbf {J},\mathbf {h}\right)$$\end{document}</tex-math><mml:math id="M30"><mml:mfenced close=")" open="("><mml:mi mathvariant="bold">J</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">h</mml:mi></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq13.gif"/></alternatives></inline-formula>; and <inline-formula id="IEq14"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left( \mathbf {J}, \mathbf {h} \right)$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="bold">J</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">h</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq14.gif"/></alternatives></inline-formula> is the prior probability distribution over the space of parameters. Recalling that sequences are i.i.d., the likelihood factorizes over sequences:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} P\left( \left\{ \varvec{s}^{\mu }\right\} |\mathbf {J},\mathbf {h}\right)= &amp; {} \prod _{\mu =1}^{M}P\left( \varvec{s}^{\mu }|\mathbf {J},\mathbf {h}\right) \end{aligned}$$\end{document}</tex-math><mml:math id="M34" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mfenced close="}" open="{"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msup></mml:mfenced><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">J</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">h</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">J</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">h</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}= &amp; {} Z^{-M}\left( \mathbf {J},\mathbf {h}\right) \prod _{\mu }e^{\sum _{i=1}^{L}h_{i}\left( s_{i}^{\mu }\right) +\sum _{i&lt;j}J_{ij}\left( s_{i}^{\mu },s_{j}^{\mu }\right) }\,. \end{aligned}$$\end{document}</tex-math><mml:math id="M36" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msup><mml:mi>Z</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msup><mml:mfenced close=")" open="("><mml:mi mathvariant="bold">J</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">h</mml:mi></mml:mfenced><mml:munder><mml:mo>∏</mml:mo><mml:mi>μ</mml:mi></mml:munder><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:msubsup><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msubsup></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msubsup></mml:mfenced></mml:mrow></mml:msup><mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>The prior <inline-formula id="IEq15"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left( \mathbf {J},\mathbf {h}\right)$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="bold">J</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">h</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq15.gif"/></alternatives></inline-formula> provides additional information on the unknown parameters and it is exploited to avoid over-fitting. Indeed, very often a fully connected model (i.e. a model for which all couplings <inline-formula id="IEq16"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {J}$$\end{document}</tex-math><mml:math id="M40"><mml:mi mathvariant="bold">J</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq16.gif"/></alternatives></inline-formula> are in principle different from 0) produces an over-parametrization of the unknown distribution as signaled by a large amount of noisy and negligible coupling parameters [<xref ref-type="bibr" rid="CR11">11</xref>]. A practical way to control this behavior is to impose a sparsity prior over the coupling matrices: the two most used priors are the so called <inline-formula id="IEq17"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell _{1}$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq17.gif"/></alternatives></inline-formula> and <inline-formula id="IEq18"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell _{2}$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq18.gif"/></alternatives></inline-formula> regularizations, which force the inferred couplings to minimize the associated <inline-formula id="IEq19"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell _{1}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq19.gif"/></alternatives></inline-formula> and <inline-formula id="IEq20"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell _{2}$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq20.gif"/></alternatives></inline-formula> norms multiplied by a tunable parameter <inline-formula id="IEq21"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M50"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq21.gif"/></alternatives></inline-formula> that sets the regularization strength. A complementary approach consists in setting <italic>a priori</italic> a probable topology suggested by the mutual information between all pairs of residues [<xref ref-type="bibr" rid="CR22">22</xref>]. Here, as discussed in the following section, we will follow an information-based decimation protocol originally proposed in [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
      <p id="Par16">To set the stage, we first start by discussing the case, in which no prior information is considered. The maximization of the posterior distribution then turns out to be equivalent to the maximization of the likelihood function, or, equivalently, to the log-likelihood:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \mathcal {L}\left( \left\{ \varvec{s}^{\mu }\right\} |\mathbf {J},\mathbf {h}\right) =\frac{1}{M}\sum _{\mu }\left[ \sum _{i=1}^{L}h_{i}\left( s_{i}^{\mu }\right) +\sum _{i&lt;j}J_{ij}\left( s_{i}^{\mu },s_{j}^{\mu }\right) \right] -\log Z\left( \mathbf {J},\mathbf {h}\right) \,. \end{aligned}$$\end{document}</tex-math><mml:math id="M52" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mfenced close=")" open="("><mml:mfenced close="}" open="{"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msup></mml:mfenced><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">J</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">h</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>M</mml:mi></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mi>μ</mml:mi></mml:munder><mml:mfenced close="]" open="["><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msubsup></mml:mfenced><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msubsup></mml:mfenced></mml:mfenced><mml:mo>-</mml:mo><mml:mo>log</mml:mo><mml:mi>Z</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="bold">J</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">h</mml:mi></mml:mfenced><mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>It is easy to prove that the log-likelihood is a globally convex function of the unknown parameters, hence a simple gradient ascent strategy is in principle able to find the optimal set of parameters. More precisely, starting from any initial guess for the parameters <inline-formula id="IEq22"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{ \mathbf {J}^{t=0},\mathbf {h}^{t=0}\right\}$$\end{document}</tex-math><mml:math id="M54"><mml:mfenced close="}" open="{"><mml:msup><mml:mrow><mml:mi mathvariant="bold">J</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msup></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq22.gif"/></alternatives></inline-formula>, one can set up the following update scheme:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} h_{i}^{t+1}\left( a\right)\leftarrow &amp; {} h_{i}^{t}\left( a\right) + \eta _{h} \frac{\partial \mathcal {L}\left( \{\varvec{s}^{\mu }\} | \mathbf {J}^{t}, \mathbf {h}^{t}\right) }{\partial h_{i}\left( a\right) } \ , \end{aligned}$$\end{document}</tex-math><mml:math id="M56" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced><mml:mo stretchy="false">←</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi mathvariant="script">L</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msup><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">J</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup></mml:mfenced></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced></mml:mrow></mml:mfrac><mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} J_{ij}^{t+1}\left( a,b\right)\leftarrow &amp; {} J_{ij}^{t}\left( a,b\right) + \eta _{J} \frac{\partial \mathcal {L}\left( \{\varvec{s}^{\mu }\} | \mathbf {J}^{t}, \mathbf {h}^{t}\right) }{\partial J_{ij}\left( a,b\right) } \ , \end{aligned}$$\end{document}</tex-math><mml:math id="M58" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>J</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced><mml:mo stretchy="false">←</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msubsup><mml:mi>J</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi mathvariant="script">L</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msup><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">J</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup></mml:mfenced></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:mrow></mml:mfrac><mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>until a fixed point is reached. Here, <inline-formula id="IEq23"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta _{h}$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mi>η</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq23.gif"/></alternatives></inline-formula> and <inline-formula id="IEq24"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta _{J}$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mi>η</mml:mi><mml:mi>J</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq24.gif"/></alternatives></inline-formula> are the learning rates associated with the fields <inline-formula id="IEq25"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {h}$$\end{document}</tex-math><mml:math id="M64"><mml:mi mathvariant="bold">h</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq25.gif"/></alternatives></inline-formula> and the coupling parameters <inline-formula id="IEq26"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {J}$$\end{document}</tex-math><mml:math id="M66"><mml:mi mathvariant="bold">J</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq26.gif"/></alternatives></inline-formula> respectively. A simple computation shows that the gradient terms involve averages of simple observables over the Boltzmann measure Eq. <xref rid="Equ1" ref-type="">1</xref> with parameters at iteration time <italic>t</italic>:<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{\partial \mathcal {L}\left( \{\varvec{s}^{\mu }\} | \mathbf {J}^{t}, \mathbf {h}^{t}\right) }{\partial h_{i}\left( a\right) }= &amp; {} f_{i}\left( a\right) - p_{i}^{\left( t\right) }\left( a\right) \ , \end{aligned}$$\end{document}</tex-math><mml:math id="M68" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi mathvariant="script">L</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msup><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">J</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup></mml:mfenced></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced><mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{\partial \mathcal {L}\left( \{\varvec{s}^{\mu }\} | \mathbf {J}^{t}, \mathbf {h}^{t}\right) }{\partial J_{ij}\left( a,b\right) }= &amp; {} f_{ij}\left( a,b\right) - p^{\left( t\right) }_{ij}\left( a,b\right) . \end{aligned}$$\end{document}</tex-math><mml:math id="M70" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi mathvariant="script">L</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msup><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">J</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup></mml:mfenced></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>The stationary point is reached when the left hand sides of the equations are zero, i.e. when the single and double residue empirical frequency counts (i.e. the terms <inline-formula id="IEq27"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_i(a)$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq27.gif"/></alternatives></inline-formula> and <inline-formula id="IEq28"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{ij}(a,b)$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq28.gif"/></alternatives></inline-formula> resp.) match the one- and two-site marginals <inline-formula id="IEq29"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_i(a)$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq29.gif"/></alternatives></inline-formula> and <inline-formula id="IEq30"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{ij}(b)$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq30.gif"/></alternatives></inline-formula> of the model <italic>P</italic>. A formal definition of these quantities will be given in the next sections. Unfortunately, in spite of the relatively simple structure of the model, we are not able to exactly compute the marginal probability distributions. A practical way to overcome this limitation is to estimate them at each step <italic>t</italic> of the iteration by using a MCMC algorithm as explained in the following section.</p>
    </sec>
  </sec>
  <sec id="Sec4">
    <title>Implementation</title>
    <sec id="Sec5">
      <title>Input data and pre-processing</title>
      <p id="Par17">adabmDCA takes as input a MSA in FASTA format of the target protein or RNA family. To reduce the effect of phylogenetic correlations, we re-weight the statistical significance of each sequence, penalizing highly similar sequences in the MSA, as originally presented in [<xref ref-type="bibr" rid="CR23">23</xref>]. In practice, with each of the <italic>M</italic> sequences of the MSA we associate a statistical weight <inline-formula id="IEq31"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w^\mu$$\end{document}</tex-math><mml:math id="M80"><mml:msup><mml:mi>w</mml:mi><mml:mi>μ</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq31.gif"/></alternatives></inline-formula> (<inline-formula id="IEq32"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu \in 1,\ldots ,M$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∈</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq32.gif"/></alternatives></inline-formula>) equal to the inverse number of sequences having at least 80% of identical residues with sequence <inline-formula id="IEq33"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu$$\end{document}</tex-math><mml:math id="M84"><mml:mi>μ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq33.gif"/></alternatives></inline-formula> (including sequence <inline-formula id="IEq34"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu$$\end{document}</tex-math><mml:math id="M86"><mml:mi>μ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq34.gif"/></alternatives></inline-formula> itself).</p>
      <p id="Par18">To deal with unobserved (pairs of) symbols in one (or two) column(s) of the MSA, we add a small pseudo-count <inline-formula id="IEq35"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M88"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq35.gif"/></alternatives></inline-formula> to the empirical frequency counts. This prevents the emergence of infinitely large parameters (in absolute value) associated with vanishing empirical frequencies. Finally, the one- and two-site frequencies are given by:<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} f_{i}\left( a\right)= &amp; {} \left( 1-\alpha \right) f^{\mathrm{data}}_{i}\left( a\right) + \frac{\alpha }{q} \ , \end{aligned}$$\end{document}</tex-math><mml:math id="M90" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>α</mml:mi></mml:mfenced><mml:msubsup><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">data</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:mi>α</mml:mi><mml:mi>q</mml:mi></mml:mfrac><mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} f_{ij}\left( a,b\right)= &amp; {} \left( 1-\alpha \right) f^{\mathrm{data}}_{ij}\left( a,b\right) + \frac{\alpha }{q^{2}}\,, \end{aligned}$$\end{document}</tex-math><mml:math id="M92" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>α</mml:mi></mml:mfenced><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mi mathvariant="normal">data</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:mi>α</mml:mi><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq36"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f^{\mathrm{data}}_{i}$$\end{document}</tex-math><mml:math id="M94"><mml:msubsup><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">data</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq36.gif"/></alternatives></inline-formula> and <inline-formula id="IEq37"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f^{\mathrm{data}}_{ij}$$\end{document}</tex-math><mml:math id="M96"><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mi mathvariant="normal">data</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq37.gif"/></alternatives></inline-formula> are computed from the MSA as:<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} f^{\mathrm{data}}_{i}\left( a\right)= &amp; {} \frac{1}{M_{\rm eff}}\sum _{\mu } w^{\mu } \delta _{s_{i}^{\mu },a} \ , \end{aligned}$$\end{document}</tex-math><mml:math id="M98" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">data</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>M</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mi>μ</mml:mi></mml:munder><mml:msup><mml:mi>w</mml:mi><mml:mi>μ</mml:mi></mml:msup><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} f^{\mathrm{data}}_{ij}\left( a,b\right)= &amp; {} \frac{1}{M_{\rm eff}} \sum _{\mu } w^{\mu } \delta _{s_{i}^{\mu },a} \delta _{s_{j}^{\mu },b}\,, \end{aligned}$$\end{document}</tex-math><mml:math id="M100" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mi mathvariant="normal">data</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>M</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mi>μ</mml:mi></mml:munder><mml:msup><mml:mi>w</mml:mi><mml:mi>μ</mml:mi></mml:msup><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula>with <inline-formula id="IEq38"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_{\rm eff} = \sum _\mu w^\mu$$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>μ</mml:mi></mml:msub><mml:msup><mml:mi>w</mml:mi><mml:mi>μ</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq38.gif"/></alternatives></inline-formula> being the effective number of weighted sequences.</p>
    </sec>
    <sec id="Sec6">
      <title>Initialization</title>
      <p id="Par19">In adabmDCA, it is possible to initialize the set of parameters in three ways: (1) all couplings and fields can be initially set to zero, (2) they can take value from a given set of parameters (from an input file), or (3) they describe a profile model, i.e. an independent-site Potts model where the first empirical moments are perfectly matched by means of the fields<disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} h_{i}^{\mathrm{prof}}\left( a\right) = \log \left[ f_{i}\left( a\right) \right] + {\mathrm{const}}, \end{aligned}$$\end{document}</tex-math><mml:math id="M104" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi mathvariant="normal">prof</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mfenced close="]" open="["><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced></mml:mfenced><mml:mo>+</mml:mo><mml:mi mathvariant="normal">const</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula>but all couplings are set to zero. Empirically, it turns out that choice (3) is the one that shows the fastest convergence of the algorithm. We also allow for the other two types of initializations as they can be convenient in some cases.</p>
    </sec>
    <sec id="Sec7">
      <title>Adaptive Monte Carlo Markov Chain</title>
      <p id="Par20">The Boltzmann learning algorithm consists of a series of training epochs. At each epoch <italic>t</italic>, we estimate numerically the marginal probability distributions of the model <inline-formula id="IEq39"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p^{(t)}_i(a)$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq39.gif"/></alternatives></inline-formula> and <inline-formula id="IEq40"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p^{(t)}_{ij}(a,b)$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq40.gif"/></alternatives></inline-formula> using a MCMC strategy. More precisely, we use <inline-formula id="IEq41"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{s}$$\end{document}</tex-math><mml:math id="M110"><mml:msub><mml:mi>N</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq41.gif"/></alternatives></inline-formula> independent Markov chains, each of which samples <inline-formula id="IEq42"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{c}$$\end{document}</tex-math><mml:math id="M112"><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq42.gif"/></alternatives></inline-formula> configurations. The results presented in this work are obtained using a Metropolis-Hasting [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR25">25</xref>] update scheme, but the code also allows one to opt for a Gibbs sampling strategy [<xref ref-type="bibr" rid="CR26">26</xref>]. At the end of each epoch <italic>t</italic>, we update the model parameters according to Eq. <xref rid="Equ9" ref-type="">9</xref> by estimating the <inline-formula id="IEq43"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p^{(t)}_i(a), p^{(t)}_{ij}(a,b)$$\end{document}</tex-math><mml:math id="M114"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq43.gif"/></alternatives></inline-formula> according to the following relation:<disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} p_{i}^{\left( t\right) }\left( a\right)&amp;= \frac{1}{N_{s}N_{c} }\sum _{\mu =1}^{N_{s}N_{c}} \delta _{s_{i}^{\mu }\left( t\right) , a} \ , \end{aligned}$$\end{document}</tex-math><mml:math id="M116" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ16"><label>16</label><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} p_{ij}^{\left( t\right) }\left( a,b\right)&amp;= \frac{1}{N_{s}N_{c}} \sum _{\mu =1}^{N_{s}N_{c}} \delta _{s_{i}^{\mu }\left( t\right) ,a}\delta _{s_{j}^{\mu }\left( t\right) ,b}\,. \end{aligned}$$\end{document}</tex-math><mml:math id="M118" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula>adabmDCA allows one to use either <italic>persistent</italic> chains, i.e. chains initialized only at the first epoch, or <italic>transient</italic> chains where each independent chain is initialized at each epoch. We consider two types of chain initialization: (1) by extracting sequences uniformly at random, (2) by randomly picking natural sequences from the MSA, proportionally to their weights <inline-formula id="IEq44"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{w}$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq44.gif"/></alternatives></inline-formula>.</p>
      <p id="Par21">By default, adabmDCA uses <italic>transient</italic> chains initialized to uniformly extracted random sequences, but different options can be set. In particular, we found that the <italic>persistent</italic> option seems to reduce the equilibration time as one may expect that an equilibrium configuration extracted from the model at time <inline-formula id="IEq45"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t-1$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq45.gif"/></alternatives></inline-formula> is a good candidate starting point for the same chain at time <italic>t</italic> provided that the value of the parameters at time <italic>t</italic> is not too different from that at <inline-formula id="IEq46"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t-1$$\end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq46.gif"/></alternatives></inline-formula>.</p>
      <p id="Par22">In order to achieve accurate learning, it is of utmost importance to accurately estimate the gradient of the log-likelihood. From a computational point of view, the bottleneck is the accurate estimation of the one- and two-site marginals <inline-formula id="IEq47"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_i(a)$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq47.gif"/></alternatives></inline-formula> and <inline-formula id="IEq48"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{ij}(a,b)$$\end{document}</tex-math><mml:math id="M128"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq48.gif"/></alternatives></inline-formula>. Two main conditions dictate the quality of MCMC sampling: (1) an accurate assessment of the stationary (i.e. equilibrium) regime of the chain, and, (2) a fair estimate of the mixing time.<xref ref-type="fn" rid="Fn1">1</xref> To prevent the occurrence of a poor sampling, adabmDCA allows for monitoring and adjusting both the equilibration and sampling times of the Markov Chain, <italic>T</italic><sub>eq</sub> and <italic>T</italic><sub>wait</sub>, respectively (in Monte Carlo sweeps units, one sweep being equal to <italic>L</italic> Monte Carlo steps).</p>
      <p id="Par23">Let <inline-formula id="IEq51"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{s}^{i}_{n}$$\end{document}</tex-math><mml:math id="M130"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq51.gif"/></alternatives></inline-formula> be the configuration sampled by chain <italic>i</italic> after <inline-formula id="IEq52"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{\rm eq} + n T_{\rm wait}$$\end{document}</tex-math><mml:math id="M132"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">eq</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">wait</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq52.gif"/></alternatives></inline-formula> steps. We define three type of sequence identities or <italic>overlaps</italic>, i.e.<disp-formula id="Equ17"><label>17</label><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} O\left( \varvec{s}^{i}_{n}, \varvec{s}^{k}_{n}\right) := \sum _{j=1}^{L}\delta _{s^{i}_{n}\left( j\right) , s^{k}_{n}\left( j\right) } , \end{aligned}$$\end{document}</tex-math><mml:math id="M134" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>O</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mfenced><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>j</mml:mi></mml:mfenced><mml:mo>,</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>j</mml:mi></mml:mfenced></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ17.gif" position="anchor"/></alternatives></disp-formula>aimed at quantifying how similar two target configurations are:<list list-type="bullet"><list-item><p id="Par24">The <italic>external</italic> overlap between configurations sampled by two different chains at the same sampling time <italic>n</italic><disp-formula id="Equ29"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} Q^{\rm ext}\left( i,k,n\right) = O\left( \varvec{s}^{i}_{n}, \varvec{s}^{k}_{n}\right) \, {\mathrm {for}}\, i\ne k. \end{aligned}$$\end{document}</tex-math><mml:math id="M136" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>Q</mml:mi><mml:mi mathvariant="normal">ext</mml:mi></mml:msup><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mfenced><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">for</mml:mi><mml:mspace width="0.166667em"/><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>k</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ29.gif" position="anchor"/></alternatives></disp-formula></p></list-item><list-item><p id="Par25">A <italic>first-time internal</italic> overlap measuring the similarity between two consecutively sampled configurations on the same chain: <disp-formula id="Equ30"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} Q^{\rm int1}\left( i,n,n+1\right) = O\left( \varvec{s}^{i}_{n}, \varvec{s}^{i}_{n+1}\right). \end{aligned}$$\end{document}</tex-math><mml:math id="M138" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi mathvariant="normal">int</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ30.gif" position="anchor"/></alternatives></disp-formula></p></list-item><list-item><p id="Par26">A <italic>second-time internal</italic> overlap measuring the distance between configuration sampled at time <italic>n</italic> and <inline-formula id="IEq53"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n+2$$\end{document}</tex-math><mml:math id="M140"><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq53.gif"/></alternatives></inline-formula> on the same chain: <disp-formula id="Equ31"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} Q^{\rm int2}\left( i,n,n+2\right) = O\left( \varvec{s}^{i}_{n},\varvec{s}^{i}_{n+2}\right). \end{aligned}$$\end{document}</tex-math><mml:math id="M142" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi mathvariant="normal">int</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mfenced><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ31.gif" position="anchor"/></alternatives></disp-formula></p></list-item></list>At each iteration, we compute the expectation value <inline-formula id="IEq54"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _{\alpha }$$\end{document}</tex-math><mml:math id="M144"><mml:msub><mml:mi>μ</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq54.gif"/></alternatives></inline-formula> and the standard error <inline-formula id="IEq55"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _{\alpha }$$\end{document}</tex-math><mml:math id="M146"><mml:msub><mml:mi>σ</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq55.gif"/></alternatives></inline-formula> (where the averages are computed with respect to different chains and over <italic>n</italic>) of <inline-formula id="IEq56"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q^{\alpha }$$\end{document}</tex-math><mml:math id="M148"><mml:msup><mml:mi>Q</mml:mi><mml:mi>α</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq56.gif"/></alternatives></inline-formula> for all three types of overlap <inline-formula id="IEq57"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha \in \{{\mathrm{int1~int2~ext}}\}$$\end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:mi>α</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mi mathvariant="normal">int</mml:mi><mml:mn>1</mml:mn><mml:mspace width="3.33333pt"/><mml:mi mathvariant="normal">int</mml:mi><mml:mn>2</mml:mn><mml:mspace width="3.33333pt"/><mml:mi mathvariant="normal">ext</mml:mi></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq57.gif"/></alternatives></inline-formula>. We note that, if <italic>T</italic><sub>eq</sub> and <italic>T</italic><sub>wait</sub> were large enough, then subsequent samples of the same chain should have the same statistics of samples coming from distinct chains, and <inline-formula id="IEq60"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _{\rm ext} = \mu _{\rm int1} = \mu _{\rm int2}$$\end{document}</tex-math><mml:math id="M152"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">ext</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">int</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">int</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq60.gif"/></alternatives></inline-formula> within statistical errors. Therefore, we update <italic>T</italic><sub>wait</sub> as follows:<list list-type="bullet"><list-item><p id="Par27">If <inline-formula id="IEq62"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|\mu _{\rm ext} - \mu _{\rm int2}| &gt; 5 \sqrt{\sigma ^{2}_{\rm ext} + \sigma ^{2}_{\rm int2}}$$\end{document}</tex-math><mml:math id="M154"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">ext</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">int</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>5</mml:mn></mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">ext</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">int</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq62.gif"/></alternatives></inline-formula> we say that our Monte Carlo chains are not sufficiently de-correlated and therefore we increase <italic>T</italic><sub>wait</sub>.</p></list-item><list-item><p id="Par28">Conversely, if <inline-formula id="IEq64"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|\mu _{\rm ext} - \mu _{\rm int1}| &lt; 5 \sqrt{\sigma ^{2}_{\rm ext} + \sigma ^{2}_{\rm int1}}$$\end{document}</tex-math><mml:math id="M156"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">ext</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">int</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>5</mml:mn></mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">ext</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">int</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq64.gif"/></alternatives></inline-formula> the chains sufficiently de-correlate every <italic>T</italic><sub>wait</sub> steps and, as a consequence, we can reduce <italic>T</italic><sub>wait</sub>.</p></list-item></list>This allows the chains to be slightly correlated at time <italic>T</italic><sub>wait</sub> but ensures a good de-correlation at time 2<italic>T</italic><sub>wait</sub>, hence guaranteeing that the de-correlation time is in between <italic>T</italic><sub>wait</sub> and 2<italic>T</italic><sub>wait</sub>. To increase <italic>T</italic><sub>wait</sub>, we double it, while to reduce <italic>T</italic><sub>wait</sub>, adabmDCA computes the average between the current value of the waiting time and the value of <italic>T</italic><sub>wait</sub> before the last increasing step. This guarantees to keep the waiting time bounded in the correct interval of values within the learning process. Then, whatever the outcome of this test, we set <italic>T</italic><sub>eq</sub> = 2<italic>T</italic><sub>wait</sub> assuming that 2<italic>T</italic><sub>wait</sub> steps suffice to get equilibrated samples starting from the first configuration of the chain. Note that when the starting sample is picked uniformly at random, this criterion does not guarantee a perfect equilibration because the equilibration time might be in some cases larger than the de-correlation time, although this is expected to happen rarely; conversely, for persistent chains, this condition guarantees equilibration by construction, because in that case the chains do not need to be re-equilibrated at each iteration.</p>
      <p id="Par29">When <italic>T</italic><sub>wait</sub> and <italic>T</italic><sub>eq</sub> are such that <inline-formula id="IEq78"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _{ext} \sim \mu _{int2}$$\end{document}</tex-math><mml:math id="M158"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ext</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq78.gif"/></alternatives></inline-formula>, adabmDCA achieves a well-equilibrated sampling and the Boltzmann machine is guaranteed to converge to a Potts model, which not only precisely fits the one- and two-site frequencies, but benefits of several additional properties elaborated in the Results section. However, depending on the properties of the data, several issues can arise: if the true energy landscape is sufficiently rugged, Monte Carlo chains may partially visit the feasible configurations returning a sampling that strongly depend on the initialization of the chains. Similarly, if the model parameters are abruptly adjusted, the dynamic may mimic a low-temperature regime of a well-behaved landscape ending up to the same sampling issue of the rugged energy landscape. In both cases, the dynamics becomes non-ergodic, and therefore the computation of the gradient may be inaccurate. For this reason a smooth update of the parameters is encouraged and, in cases when this is not sufficient, we found that, using persistent chains with fixed (but large) sampling time, adabmDCA performs equally well. In this scenario, even though the machine performs the sampling using slightly correlated chains, the quality of the inferred model is often not affected. We show an example in the Results section.</p>
    </sec>
    <sec id="Sec8">
      <title>Convergence criterion and quality control</title>
      <p id="Par30">Given the global convexity of the problem as a function of the parameters, the convergence of the algorithm can be safely assessed when the gradients are numerically close to zero. A convenient proxy for convergence is given by the difference between the empirical and the model two-site connected correlations (or co-variances):<disp-formula id="Equ18"><label>18</label><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} c_{ij}^{\rm model} \left( a,b\right)&amp;= p_{ij} \left( a,b\right) - p_{i}\left( a\right) p_{j}\left( b\right), \end{aligned}$$\end{document}</tex-math><mml:math id="M160" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mi mathvariant="normal">model</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>b</mml:mi></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ18.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ19"><label>19</label><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} c_{ij}^{\rm emp} \left( a,b\right)&amp;= f_{ij} \left( a,b\right) - f_{i}\left( a\right) f_{j}\left( b\right). \end{aligned}$$\end{document}</tex-math><mml:math id="M162" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mi mathvariant="normal">emp</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced><mml:msub><mml:mi>f</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>b</mml:mi></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ19.gif" position="anchor"/></alternatives></disp-formula>The learning halts when the tolerance <inline-formula id="IEq79"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varepsilon _{c} = \arg \max _{i,j,a,b} | \, c_{ij}^{\rm model}\left( a,b\right) - c_{ij}^{\rm emp}\left( a,b\right) \, |$$\end{document}</tex-math><mml:math id="M164"><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>arg</mml:mo><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mi mathvariant="normal">model</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mi mathvariant="normal">emp</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced><mml:mspace width="0.166667em"/><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq79.gif"/></alternatives></inline-formula> is <inline-formula id="IEq80"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim 10^{-2}$$\end{document}</tex-math><mml:math id="M166"><mml:mrow><mml:mo>∼</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq80.gif"/></alternatives></inline-formula>. Although this quantity is not explicitly fitted during learning, it is a function of the one- and two-site frequencies in Eqs. <xref rid="Equ8" ref-type="">8</xref>, <xref rid="Equ9" ref-type="">9</xref> and vanishes at convergence. Empirically, it provides a good metric for estimating the quality of the inferred model. At each iteration, we also measure the Pearson correlation coefficient between the empirical and model covariances defined in Eqs. <xref rid="Equ18" ref-type="">18</xref>, <xref rid="Equ19" ref-type="">19</xref>, which measures a degree of correlation between the two quantities independently of the value of <inline-formula id="IEq81"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varepsilon _{c}$$\end{document}</tex-math><mml:math id="M168"><mml:msub><mml:mi>ε</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq81.gif"/></alternatives></inline-formula>, i.e. of the spread of the scatter plot of the connected covariance. Moreover, we display the fitting error of the one- and two-site statistics computed as <inline-formula id="IEq82"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varepsilon _{f} = \sum _{i,a} \frac{| f_{i}\left( a\right) - p_{i} \left( a\right) |}{Lq}$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="italic">Lq</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq82.gif"/></alternatives></inline-formula>, <inline-formula id="IEq83"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varepsilon _{s} = \sum _{i,j,a,b} \frac{| f_{ij} \left( a, b \right) - p_{ij} \left( a,b \right) |}{L^2q^2}$$\end{document}</tex-math><mml:math id="M172"><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq83.gif"/></alternatives></inline-formula> ; these metrics indeed help in monitoring the training of the Boltzmann machine.</p>
      <p id="Par31">Another interesting observable that can be used to assess the generative power of the Boltzmann machine, is the three-site connected correlation<disp-formula id="Equ32"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\begin{matrix} c_{ijk}(a,b,c)&amp;:=f_{ijk}(a,b,c)-f_{ij}(a,b)f_k(c)-f_{ik}(a,c)f_j(b)\\ &amp;-f_{jk}(b,c)f_i(a)+2f_i(a)f_j(b)f_k(c) \ , \end{matrix}} \end{aligned}$$\end{document}</tex-math><mml:math id="M174" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ32.gif" position="anchor"/></alternatives></disp-formula>which is not fitted during the training but, as shown in [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>], provides an interesting measure of the generative capability of the model. adabmDCA does not compute all possible third order connected correlations because this would be computationally heavy. However, it is possible to specify a subset of indices <inline-formula id="IEq84"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( i,j,k\right)$$\end{document}</tex-math><mml:math id="M176"><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq84.gif"/></alternatives></inline-formula> and <inline-formula id="IEq85"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( a,b,c\right)$$\end{document}</tex-math><mml:math id="M178"><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq85.gif"/></alternatives></inline-formula> whose corresponding measures are computed during the iterations.</p>
    </sec>
    <sec id="Sec9">
      <title>Gauge fixing</title>
      <p id="Par32">The number of unknown parameters <inline-formula id="IEq86"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{p} = \frac{L\left( L-1\right) }{2}q^{2}+Lq$$\end{document}</tex-math><mml:math id="M180"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq86.gif"/></alternatives></inline-formula> exceeds the number of independent Eqs. <xref rid="Equ8" ref-type="">8</xref>, <xref rid="Equ9" ref-type="">9</xref> (when setting the partial derivatives to zero), due to the normalization constraint on the one-site and two-site statistics, <inline-formula id="IEq87"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum _{a}f_{i}\left( a\right) = 1$$\end{document}</tex-math><mml:math id="M182"><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>a</mml:mi></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq87.gif"/></alternatives></inline-formula>, <inline-formula id="IEq88"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum _{a,b} f_{ij}\left( a,b\right) = 1$$\end{document}</tex-math><mml:math id="M184"><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq88.gif"/></alternatives></inline-formula> and the marginalization condition over the two-site statistics, <inline-formula id="IEq89"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum _{a}f_{ij}\left( a,b\right) = f_{i}\left( b\right)$$\end{document}</tex-math><mml:math id="M186"><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>a</mml:mi></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>b</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq89.gif"/></alternatives></inline-formula>. As a consequence, any <italic>gauge</italic> transformation of the type<disp-formula id="Equ20"><label>20</label><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} J_{ij}\left( a,b\right)\rightarrow &amp; J_{ij}\left( a,b\right) + K_{ij}\left( a\right) + K_{ji}\left( b\right) \end{aligned}$$\end{document}</tex-math><mml:math id="M188" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced><mml:mo stretchy="false">→</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">ji</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>b</mml:mi></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ20.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ21"><label>21</label><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} h_{i}\left( a\right)\rightarrow &amp; h_{i}\left( a\right) + g_{i} - \sum _{j\ne i}\left[ K_{ij}\left( a\right) + K_{ji}\left( a\right) \right] \end{aligned}$$\end{document}</tex-math><mml:math id="M190" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced><mml:mo stretchy="false">→</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mfenced close="]" open="["><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">ji</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ21.gif" position="anchor"/></alternatives></disp-formula>for arbitrary <inline-formula id="IEq90"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_{i}$$\end{document}</tex-math><mml:math id="M192"><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq90.gif"/></alternatives></inline-formula> and <inline-formula id="IEq91"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{i,j}\left( a\right)$$\end{document}</tex-math><mml:math id="M194"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq91.gif"/></alternatives></inline-formula>, would keep unchanged the Boltzmann distribution in Eq. <xref rid="Equ1" ref-type="">1</xref>. Among the infinite number of possible <italic>gauge</italic> transformations, the one of most interest is the so-called <italic>zero-sum</italic> gauge because the couplings obtained by this re-parametrization minimize the Frobenius norms associated with the coupling matrices. This transformation is applied at the end of the Boltzmann machine learning to facilitate the computation of the DCA scores.</p>
      <p id="Par33">Alternatively, one may fix the <italic>gauge</italic> at the beginning of the learning, by fixing a redundant subset of the parameters to an arbitrary constant and then update the remaining parameters within the learning. To select the redundant subset, for each couple <inline-formula id="IEq92"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( i,j\right)$$\end{document}</tex-math><mml:math id="M196"><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq92.gif"/></alternatives></inline-formula>, we seek the <inline-formula id="IEq93"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2q-1$$\end{document}</tex-math><mml:math id="M198"><mml:mrow><mml:mn>2</mml:mn><mml:mi>q</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq93.gif"/></alternatives></inline-formula> pairs of colors that give the weakest empirical connected correlations, computed as in Eq. <xref rid="Equ19" ref-type="">19</xref>, and we set to zero the couplings associated with these variables. These couplings are fixed to zero also during learning.</p>
    </sec>
    <sec id="Sec10">
      <title>Pruning the parameters</title>
      <p id="Par34">Although the gauge fixing removes the degree of variability of the inferred parameters, due to the finite sample size of the MSA, the trained model might still be over-fitted. Indeed, sequence lengths <italic>L</italic> in typical MSA range in the interval <inline-formula id="IEq94"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim 100 - 500$$\end{document}</tex-math><mml:math id="M200"><mml:mrow><mml:mo>∼</mml:mo><mml:mn>100</mml:mn><mml:mo>-</mml:mo><mml:mn>500</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq94.gif"/></alternatives></inline-formula>. As a consequence, the number of learned parameters is <inline-formula id="IEq95"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim 10^{7}-10^{9}$$\end{document}</tex-math><mml:math id="M202"><mml:mrow><mml:mo>∼</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>7</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>9</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq95.gif"/></alternatives></inline-formula>, which likely exceeds the useful information encoded in the data. A widely used strategy to limit over-fitting is to impose an <inline-formula id="IEq96"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell _{1}$$\end{document}</tex-math><mml:math id="M204"><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq96.gif"/></alternatives></inline-formula> or <inline-formula id="IEq97"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell _{2}$$\end{document}</tex-math><mml:math id="M206"><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq97.gif"/></alternatives></inline-formula> regularization, i.e. a prior, either to both the set of parameters or to the couplings only. In these cases, the update Eqs. <xref rid="Equ8" ref-type="">8</xref>–<xref rid="Equ9" ref-type="">9</xref> are replaced by the gradient of the log-posterior:<disp-formula id="Equ22"><label>22</label><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{\partial \mathrm {log}P \left( \mathbf {J}^{t}, \mathbf {h}^{t} | \{\varvec{s}^{\mu }\} \right) }{\partial h_{i}\left( a\right) }= &amp; {} f_{i}\left( a\right) - p_{i}\left( a\right) -\lambda _{1} \mathrm{sign} \left[ h_{i}\left( a\right) \right] \ , \end{aligned}$$\end{document}</tex-math><mml:math id="M208" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi mathvariant="normal">log</mml:mi><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msup><mml:mrow><mml:mi mathvariant="bold">J</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi mathvariant="normal">sign</mml:mi><mml:mfenced close="]" open="["><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced></mml:mfenced><mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ22.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ23"><label>23</label><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{\partial \mathrm {log} P \left( \mathbf {J}^{t}, \mathbf {h}^{t} | \{\varvec{s}^{\mu }\} \right) }{\partial J_{ij}\left( a,b\right) }= &amp; {} f_{i,j}\left( a,b\right) - p_{i,j}\left( a,b\right) - \lambda _{1} \mathrm{sign} \left[ J_{i,j}\left( a,b\right) \right] , \end{aligned}$$\end{document}</tex-math><mml:math id="M210" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi mathvariant="normal">log</mml:mi><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msup><mml:mrow><mml:mi mathvariant="bold">J</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi mathvariant="normal">sign</mml:mi><mml:mfenced close="]" open="["><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ23.gif" position="anchor"/></alternatives></disp-formula>and<disp-formula id="Equ24"><label>24</label><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{\partial \mathrm {log} P \left( \mathbf {J}^{t}, \mathbf {h}^{t} | \{\varvec{s}^{\mu }\} \right) }{\partial h_{i}\left( a\right) }&amp;= f_{i}\left( a\right) - p_{i}\left( a\right) -\lambda _{2} h_{i}\left( a\right) \ , \end{aligned}$$\end{document}</tex-math><mml:math id="M212" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi mathvariant="normal">log</mml:mi><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msup><mml:mrow><mml:mi mathvariant="bold">J</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced></mml:mrow></mml:mfrac></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced><mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ24.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ25"><label>25</label><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{\partial \mathrm {log} P \left( \mathbf {J}^{t}, \mathbf {h}^{t} | \{\varvec{s}^{\mu }\} \right) }{\partial J_{ij}\left( a,b\right) }&amp;= f_{i,j}\left( a,b\right) - p_{i,j}\left( a,b\right) - \lambda _{2} J_{i,j}\left( a,b\right) \ , \end{aligned}$$\end{document}</tex-math><mml:math id="M214" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi mathvariant="normal">log</mml:mi><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msup><mml:mrow><mml:mi mathvariant="bold">J</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:mrow></mml:mfrac></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced><mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ25.gif" position="anchor"/></alternatives></disp-formula>for the <inline-formula id="IEq98"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell _{1}$$\end{document}</tex-math><mml:math id="M216"><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq98.gif"/></alternatives></inline-formula> and <inline-formula id="IEq99"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell _{2}$$\end{document}</tex-math><mml:math id="M218"><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq99.gif"/></alternatives></inline-formula> priors respectively.</p>
      <p id="Par35">The main drawback of these procedures is that the regularization is applied indistinctly to all parameters (relevant and irrelevant). Alternatively, one may <italic>a priori</italic> specifically prune (viz. set to zero) a subset of the parameters observing that even though large spurious correlations may arise from non topologically connected sites, weak correlations are typically associated with small coupling strengths. As explained in [<xref ref-type="bibr" rid="CR22">22</xref>], one can first determine a starting topology and then run the learning procedure on it. To this end, adabmDCA provides two distinct strategies. Indeed, the user can:<list list-type="bullet"><list-item><p id="Par36">provide as input a given topology (i.e. a set of predefined pairs of residues that will not be set to 0); adabmDCA then automatically eliminates all absent parameters before the learning;</p></list-item><list-item><p id="Par37">iteratively remove negligible couplings up to a target sparsity as explained in [<xref ref-type="bibr" rid="CR11">11</xref>]. To determine whether a coupling matrix (or element) is negligible, we compute the symmetric Kullback-Leibler divergence between the model at the current time-step and the same model without that coupling matrix (or element). The latter is used to score the parameters and set to zero those with the smallest score. The parameter is set to zero <italic>element-wise</italic> if we remove negligible couplings drawn on different matrices or <italic>block-wise</italic> if we remove an entire <inline-formula id="IEq100"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {J}_{ij}$$\end{document}</tex-math><mml:math id="M220"><mml:msub><mml:mi mathvariant="bold">J</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq100.gif"/></alternatives></inline-formula> matrix. We refer to [<xref ref-type="bibr" rid="CR11">11</xref>] for details of the element-wise decimation.</p></list-item></list></p>
    </sec>
    <sec id="Sec11">
      <title>Adaptive learning rate</title>
      <p id="Par38">The learning rates <inline-formula id="IEq101"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta _{J}$$\end{document}</tex-math><mml:math id="M222"><mml:msub><mml:mi>η</mml:mi><mml:mi>J</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq101.gif"/></alternatives></inline-formula> and <inline-formula id="IEq102"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta _{h}$$\end{document}</tex-math><mml:math id="M224"><mml:msub><mml:mi>η</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq102.gif"/></alternatives></inline-formula> associated with the update of the fields and couplings, respectively, are set by default to a small and constant value, typically 0.05 for proteins and 0.01 for RNA families. Alternatively, several adaptive learning rates can be used to train the Boltzmann machine: <italic>adagrad</italic> [<xref ref-type="bibr" rid="CR27">27</xref>], <italic>search-then-converge</italic> [<xref ref-type="bibr" rid="CR28">28</xref>], a modified <italic>quasi-Newton</italic> method [<xref ref-type="bibr" rid="CR29">29</xref>–<xref ref-type="bibr" rid="CR31">31</xref>] and <italic>FIRE</italic> [<xref ref-type="bibr" rid="CR32">32</xref>]. Although using an adaptive learning rate allows for a fast training of the parameters (as indicated by a rapid increasing of the Pearson correlation coefficient between the data and model covariances already in the first few iterations), the possibly large learning rates push the value of the parameters to large (absolute) values preventing a good equilibration of the machine within the training, and often resulting in over-fitting.</p>
    </sec>
    <sec id="Sec12">
      <title>Schematic workflow</title>
      <p id="Par39">To clarify the main adabmDCA road-map we plot in Fig.  <xref rid="Fig1" ref-type="fig">1</xref> a schematic representation of the features performed by the algorithm (as well as the most important input flags):<list list-type="bullet"><list-item><p id="Par40"><italic>Reading the natural sequences.</italic> The algorithm first reads a FASTA file containing the multiple sequence alignment of protein or RNA sequences.</p></list-item><list-item><p id="Par41"><italic>Re-weighting of the sequences.</italic> adabmDCA either takes as input a file storing the statistical weights of the sequences or it applies the re-weighting scheme explained in Section <xref rid="Sec5" ref-type="sec">2.1</xref>.</p></list-item><list-item><p id="Par42"><italic>Computation of the observables.</italic> Once the weights are computed, it is possible to evaluate and store the one-site and two-site frequencies appearing in the log-likelihood (or log-posterior) as in Eqs. <xref rid="Equ12" ref-type="">12</xref>–<xref rid="Equ13" ref-type="">13</xref>. The pseudo-count <inline-formula id="IEq103"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M226"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq103.gif"/></alternatives></inline-formula> can be arbitrarily set or, by default, it takes the value of <inline-formula id="IEq104"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_{eff}^{-1}$$\end{document}</tex-math><mml:math id="M228"><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">eff</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq104.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par43"><italic>Initialization of the machine.</italic> By default, the machine assumes a fully connected model and the parameters are set to zero. Alternatively, a profile model can be chosen using a pre-defined flag or the machine can read an input set of parameters from a file. The gauge-fixing procedure, as explained in Sect. <xref rid="Sec9" ref-type="sec">2.5</xref> can be performed using a specific flag. Furthermore, in cases where the topology is known, adabmDCA can read from files the (possibly non-zero) couplings and the fields of the machine and set permanently to zero the remaining part.</p></list-item><list-item><p id="Par44"><italic>Update of the parameters until convergence.</italic> At each epoch, adabmDCA performs a MCMC sampling as described in Sect. <xref rid="Sec7" ref-type="sec">2.3</xref> to estimate the model statistics. All possible flags used to set up the MCMC sampling are shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. By default, the equilibration and sampling times are adaptively tuned as described in Sect. <xref rid="Sec7" ref-type="sec">2.3</xref>. Then, the parameters are updated accordingly to the gradient as in Eqs. <xref rid="Equ6" ref-type="">6</xref>–<xref rid="Equ7" ref-type="">7</xref> (or as in Eqs. <xref rid="Equ22" ref-type="">22</xref>–<xref rid="Equ23" ref-type="">23</xref> or <xref rid="Equ24" ref-type="">24</xref>–<xref rid="Equ25" ref-type="">25</xref>) depending on the presence (or absence) of the regularization terms. The learning rate is by default constant during the training but, if required by the user, several adaptive learning strategies are implemented (see Sect. <xref rid="Sec11" ref-type="sec">2.7</xref>).</p></list-item><list-item><p id="Par45"><italic>Decimation.</italic> If required and if convergence is reached, adabmDCA performs a component-wise or block-wise pruning of the coupling matrices according to an information-based criterium (see Sect. <xref rid="Sec10" ref-type="sec">2.6</xref>). Then, the algorithm alternates the convergence step to the pruning step of the Boltzmann machine until a converged model having the required density is sought.</p></list-item><list-item><p id="Par46"><italic>Output of the results.</italic> The algorithm performs a final sampling of the converged Boltzmann machine and prints in several files the couplings and fields of the model as well as the Frobenius norms, i.e. the Direct Coupling scores, associated with the <inline-formula id="IEq105"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {J}_{ij}$$\end{document}</tex-math><mml:math id="M230"><mml:msub><mml:mi mathvariant="bold">J</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq105.gif"/></alternatives></inline-formula> matrices. If required by the user adabmDCA outputs the sampled configurations in FASTA format.</p></list-item></list><fig id="Fig1"><label>Fig. 1</label><caption><p>Workflow of adabmDCA. We show a schematic road-map of the main adabmDCA workflow specifying the input flags associated with the possible tasks that can be executed by the algorithm. Lower case flags are usually followed by an argument whereas upper case flags appear alone</p></caption><graphic xlink:href="12859_2021_4441_Fig1_HTML" id="MO30"/></fig></p>
      <p id="Par47">In the following, we report few examples to launch adabmDCA in some interesting cases, useful to reproduce the results of the following section:<list list-type="bullet"><list-item><p id="Par48"><italic>Learning at equilibrium.</italic> Let us train a Boltzmann machine for the sequences contained in file.fasta at equilibrium, starting from a profile model and requiring a tolerance of <inline-formula id="IEq106"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^{-2}$$\end{document}</tex-math><mml:math id="M232"><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq106.gif"/></alternatives></inline-formula> for the two-site connected correlations, using our machine. The command line will read: <disp-formula id="Equ26"><label>26</label><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \texttt {./adabmDCA -f file.fasta -I -c 1e-2} \end{aligned}$$\end{document}</tex-math><mml:math id="M234" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>.</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">adabmDCA</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="monospace">f</mml:mi><mml:mi mathvariant="monospace">file</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="monospace">fasta</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="monospace">I</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="monospace">c</mml:mi><mml:mn mathvariant="monospace">1</mml:mn><mml:mi mathvariant="monospace">e</mml:mi><mml:mo>-</mml:mo><mml:mn mathvariant="monospace">2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ26.gif" position="anchor"/></alternatives></disp-formula></p></list-item><list-item><p id="Par49"><italic>Learning out-of-equilibrium.</italic> To use persistent chains and avoid the tuning of the MCMC characteristic times, we will add: <disp-formula id="Equ27"><label>27</label><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \texttt {./adabmDCA -f file.fasta -I -c 1e-2 -L -P} \end{aligned}$$\end{document}</tex-math><mml:math id="M236" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>.</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">adabmDCA</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="monospace">f</mml:mi><mml:mi mathvariant="monospace">file</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="monospace">fasta</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="monospace">I</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="monospace">c</mml:mi><mml:mn mathvariant="monospace">1</mml:mn><mml:mi mathvariant="monospace">e</mml:mi><mml:mo>-</mml:mo><mml:mn mathvariant="monospace">2</mml:mn><mml:mo>-</mml:mo><mml:mi mathvariant="monospace">L</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="monospace">P</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ27.gif" position="anchor"/></alternatives></disp-formula></p></list-item><list-item><p id="Par50"><italic>Sampling.</italic> Let us sample a given model stored in the file p.dat using <inline-formula id="IEq107"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{eq} = 500$$\end{document}</tex-math><mml:math id="M238"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">eq</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>500</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq107.gif"/></alternatives></inline-formula> and <inline-formula id="IEq108"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{wait} = 250$$\end{document}</tex-math><mml:math id="M240"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">wait</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>250</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq108.gif"/></alternatives></inline-formula>. The command line reads: <disp-formula id="Equ28"><label>28</label><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} &amp;\texttt {./adabmDCA -f file.fasta -p p.dat }\\ &amp;\quad \texttt {-i 0-e 500 -t 250 -L -S} \end{aligned}$$\end{document}</tex-math><mml:math id="M242" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>.</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">adabmDCA</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="monospace">f</mml:mi><mml:mi mathvariant="monospace">file</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="monospace">fasta</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="monospace">p</mml:mi><mml:mi mathvariant="monospace">p</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="monospace">dat</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mn mathvariant="monospace">0</mml:mn><mml:mo>-</mml:mo><mml:mi mathvariant="monospace">e</mml:mi><mml:mn mathvariant="monospace">500</mml:mn><mml:mo>-</mml:mo><mml:mi mathvariant="monospace">t</mml:mi><mml:mn mathvariant="monospace">250</mml:mn><mml:mo>-</mml:mo><mml:mi mathvariant="monospace">L</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="monospace">S</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4441_Article_Equ28.gif" position="anchor"/></alternatives></disp-formula></p></list-item></list></p>
    </sec>
  </sec>
  <sec id="Sec13">
    <title>Results</title>
    <p id="Par51">We now discuss some examples of model learning via adabmDCA on protein and RNA families.</p>
    <sec id="Sec14">
      <title>Learning at equilibrium: PF00014 and RF00059</title>
      <p id="Par52">In this section we show the results obtained for: (1) the Kunitz domain (PF00014 family from the Pfam database), (2) the TPP riboswitch (RF00059 from the Rfam database). The PF00014 MSA is initially pre-processed to remove from the MSA all proteins with more than six consecutive gaps. This prevents a learning bias towards very gapped configurations. Eventually, the total number of considered sequences is <italic>M</italic> = 13600 for PF00014 and <italic>M</italic> = 12593 for RF00059, which correspond to a re-weighted effective number of sequences of <inline-formula id="IEq111"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_{\rm eff} = 4364$$\end{document}</tex-math><mml:math id="M244"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>4364</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq111.gif"/></alternatives></inline-formula> and <inline-formula id="IEq112"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_{\rm eff} = 4920$$\end{document}</tex-math><mml:math id="M246"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>4920</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq112.gif"/></alternatives></inline-formula> for PF00014 and RF00059 respectively.</p>
      <p id="Par53">The Boltzmann machines are trained at equilibrium, i.e. the waiting and equilibrium times are updated at each iteration according to the test introduced in Sect. <xref rid="Sec7" ref-type="sec">2.3</xref>. The behavior of the average of the three overlaps <inline-formula id="IEq113"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_{\alpha }$$\end{document}</tex-math><mml:math id="M248"><mml:msub><mml:mi>q</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq113.gif"/></alternatives></inline-formula> for <inline-formula id="IEq114"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = \{\mathrm{int1,~int2,~ext}\}$$\end{document}</tex-math><mml:math id="M250"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mi mathvariant="normal">int</mml:mi><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="3.33333pt"/><mml:mi mathvariant="normal">int</mml:mi><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mspace width="3.33333pt"/><mml:mi mathvariant="normal">ext</mml:mi></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq114.gif"/></alternatives></inline-formula> is shown in Figs. <xref rid="Fig2" ref-type="fig">2</xref>a and <xref rid="Fig3" ref-type="fig">3</xref>a (left axis) together with the trend of the waiting time <italic>T</italic><sub>wait</sub> (right axis). One can see that the distribution of the mean for the three quantities show statistically compatible values. Interestingly, starting from the beginning of the training, their average value is very close to the mean overlap among all pairs of natural sequences used within the learning, shown as <inline-formula id="IEq116"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_{MSA}$$\end{document}</tex-math><mml:math id="M252"><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="italic">MSA</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq116.gif"/></alternatives></inline-formula> in the plot. The waiting time is typically increased at the beginning of the training and it seems to stabilize at the final iterations.</p>
      <p id="Par54">The quality of the Boltzmann machine is monitored during the learning as shown in Figs. <xref rid="Fig2" ref-type="fig">2</xref>b and <xref rid="Fig3" ref-type="fig">3</xref>b where we display the Pearson correlation coefficient between the model and the empirical connected two-site frequencies as computed in Eqs. <xref rid="Equ19" ref-type="">19</xref> (left axis) as a blue line together with the mean error achieved in fitting the one-site and (connected or non-connected) two-site frequencies (right axis). At the final iteration we get a very accurate model as signaled by the high value of the Pearson correlation coefficient and the small values of the fitting errors, which are perfectly retrieved if one samples the final models using a very long Monte Carlo Markov Chain (black squared point), i.e. by imposing <italic>T</italic><sub>eq</sub> = 5000 and <italic>T</italic><sub>wait</sub> = 2500. The generative power of the Boltzmann machines is corroborated by comparing the Principal Component Analysis (PCA) of the generated sequences with the natural sequences as shown in Figs. <xref rid="Fig2" ref-type="fig">2</xref>, <xref rid="Fig3" ref-type="fig">3</xref>c, d respectively. The sampled configurations in panel (d) are projected onto the first two principal components of the natural sequences in panel (c). As suggested by the spatial localization of the sequences and their distribution, our converged models are able to generate sequences that lie in the same non-trivial sub-space spanned by the natural sequences.</p>
      <p id="Par55">Finally, we compare the predicted contact maps of the Kunitz domain and of the TPP riboswitch with the following state-of-the-art DCA-based algorithms: plmDCA [<xref ref-type="bibr" rid="CR33">33</xref>] and Mi3-GPU [<xref ref-type="bibr" rid="CR31">31</xref>] for PF00014 and bl-dca [<xref ref-type="bibr" rid="CR34">34</xref>] for RF00059, one pseudo-likelihood method and two Boltzmann machine-based methods to infer Potts models for protein and RNA sequences respectively.</p>
      <p id="Par56">In all cases, coupling parameters are first converted to zero-sum gauge before computing the average product corrected Frobenius norms [<xref ref-type="bibr" rid="CR33">33</xref>]. For PF00014, we consider as ground-truth the atomic distances retrieved by Pfam-interactions [<xref ref-type="bibr" rid="CR35">35</xref>], a method which computes the minimum distance, for all possible pair of sites, among all available crystal structures in the Protein Data Bank (PDB). For RF00059 we perform an analogous analysis among the TPP riboswitch known structures downloaded from the Protein Data Bank. In Figs. <xref rid="Fig2" ref-type="fig">2</xref>, <xref rid="Fig3" ref-type="fig">3</xref>e we plot the positive predictive value of the prediction of the non-trivial contacts, i.e. those residue pairs (<italic>i</italic>, <italic>j</italic>) having <inline-formula id="IEq119"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|i-j| &gt; 4$$\end{document}</tex-math><mml:math id="M254"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq119.gif"/></alternatives></inline-formula>, for the three methods, and in Figs. <xref rid="Fig2" ref-type="fig">2</xref>, <xref rid="Fig3" ref-type="fig">3</xref>f we overlap our ground-truth (in gray) and the most probable contact according to the three-methods, i.e. the pairs with whom we associate a score larger than 0.20. For Mi3-GPU we consider the model obtained applying an <inline-formula id="IEq120"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell _{2}$$\end{document}</tex-math><mml:math id="M256"><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq120.gif"/></alternatives></inline-formula> regularization with strength parameter <inline-formula id="IEq121"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda = 0.02$$\end{document}</tex-math><mml:math id="M258"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.02</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq121.gif"/></alternatives></inline-formula>; the machine obtained for the <inline-formula id="IEq122"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell _{1}$$\end{document}</tex-math><mml:math id="M260"><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq122.gif"/></alternatives></inline-formula> regularization gives a dramatically worse results in terms of contact predictions (not shown). Panel (e) suggests that the three considered methods achieve comparable performances, as it is equivalently represented in panel (f).<fig id="Fig2"><label>Fig. 2</label><caption><p>Learning of PF00014 at equilibrium We show in <bold>a</bold> the evolution over the iterations of the three overlaps used to monitor the quality of the sampling together with the waiting time <italic>T</italic><sub>wait</sub>. <bold>b</bold> We plot, for all iterations, the fitting errors (red, orange and brown markers) associated with the one-site, two-site (connected and non-connected) frequencies computed as defined by <inline-formula id="IEq124"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varepsilon _{f}$$\end{document}</tex-math><mml:math id="M262"><mml:msub><mml:mi>ε</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq124.gif"/></alternatives></inline-formula>, <inline-formula id="IEq125"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varepsilon _{s}$$\end{document}</tex-math><mml:math id="M264"><mml:msub><mml:mi>ε</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq125.gif"/></alternatives></inline-formula> and <inline-formula id="IEq126"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varepsilon _{c}$$\end{document}</tex-math><mml:math id="M266"><mml:msub><mml:mi>ε</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq126.gif"/></alternatives></inline-formula> in Sect. <xref rid="Sec8" ref-type="sec">2.4</xref>. Using a blue marker we show the Pearson correlation coefficient between the two-site connected frequencies of the natural sequences and of the configurations generated during training. <bold>c</bold> We plot the projections of the natural sequences into the space of the first two principal components (PC1, PC2) of the covariance matrix associated with the natural sequences while in <bold>d</bold> we project the configurations obtained by the re-sampling of the converged model into PC1 and PC2 associated with the natural sequences. <bold>e</bold> Depicts the behavior of the positive predictive value (PPV) versus the number of non-trivial contact predictions, i.e. those associated with site indices <inline-formula id="IEq127"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|i-j|&gt;4$$\end{document}</tex-math><mml:math id="M268"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq127.gif"/></alternatives></inline-formula>, for adabmDCA, plmDCA [<xref ref-type="bibr" rid="CR33">33</xref>] and Mi3-GPU [<xref ref-type="bibr" rid="CR31">31</xref>]. <bold>f</bold> We instead plot the contact maps used for the comparison in <bold>e</bold>: gray blocks are associated with the ground-truth obtained by Pfam-interactions [<xref ref-type="bibr" rid="CR35">35</xref>], while the colored markers indicate whether the Frobenius norms computed using the parameters retrieved by the three methods are larger than 0.20</p></caption><graphic xlink:href="12859_2021_4441_Fig2_HTML" id="MO34"/></fig><fig id="Fig3"><label>Fig. 3</label><caption><p>Learning of RF00059 at equilibrium. <bold>a</bold> The evolution over the iterations of <inline-formula id="IEq128"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_{ext}$$\end{document}</tex-math><mml:math id="M270"><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="italic">ext</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq128.gif"/></alternatives></inline-formula>, <inline-formula id="IEq129"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_{int1}$$\end{document}</tex-math><mml:math id="M272"><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq129.gif"/></alternatives></inline-formula> and <inline-formula id="IEq130"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_{int2}$$\end{document}</tex-math><mml:math id="M274"><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq130.gif"/></alternatives></inline-formula> used to tune the waiting time <inline-formula id="IEq131"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{wait}$$\end{document}</tex-math><mml:math id="M276"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">wait</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq131.gif"/></alternatives></inline-formula>. <bold>b</bold> We plot the fitting errors (red, orange and brown markers) <inline-formula id="IEq132"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varepsilon _{c}$$\end{document}</tex-math><mml:math id="M278"><mml:msub><mml:mi>ε</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq132.gif"/></alternatives></inline-formula>, <inline-formula id="IEq133"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varepsilon _{f}$$\end{document}</tex-math><mml:math id="M280"><mml:msub><mml:mi>ε</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq133.gif"/></alternatives></inline-formula> and <inline-formula id="IEq134"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varepsilon _{s}$$\end{document}</tex-math><mml:math id="M282"><mml:msub><mml:mi>ε</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq134.gif"/></alternatives></inline-formula>, and the Pearson correlation coefficient between the two-site connected statistics of the natural sequences and of the configurations sampled during training (blue markers). <bold>c</bold> Depicts the projections of the natural sequences into the space of the first two principal components (PC1, PC2) of the covariance matrix associated with the natural sequences; in <bold>d</bold> we show the projection the re-sampled configurations, obtained from the converged model, into PC1 and PC2 associated with the natural sequences. <bold>e</bold> We show the behavior of the PPV versus the number of non-trivial contact predictions, i.e. those associated with site indices <inline-formula id="IEq135"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|i-j|&gt;4$$\end{document}</tex-math><mml:math id="M284"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq135.gif"/></alternatives></inline-formula>, for adabmDCA, plmDCA [<xref ref-type="bibr" rid="CR33">33</xref>] and bl-dca [<xref ref-type="bibr" rid="CR34">34</xref>]. <bold>f</bold> Displays the contact maps used as ground truth (gray markers) for the TPP riboswitch and those obtained by the DCA scores larger than 0.20 associated with the three compared methods</p></caption><graphic xlink:href="12859_2021_4441_Fig3_HTML" id="MO35"/></fig></p>
    </sec>
    <sec id="Sec15">
      <title>Learning out-of-equilibrium: PF13354</title>
      <p id="Par57">In this section we show the results obtained for the Beta-lactamase2 domain. The multiple sequence alignment used within the training is constructed as follows. Using the Hidden Markov Model associated with the PF13354 family, we scanned the NCBI [<xref ref-type="bibr" rid="CR36">36</xref>] database to obtain aligned sequences compatible with the model. We then keep sequences that have less than 20% of gaps and concurrently those having less than 80% redundancy (as a consequence <inline-formula id="IEq136"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_{\rm eff} \sim M$$\end{document}</tex-math><mml:math id="M286"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq136.gif"/></alternatives></inline-formula> in this case). We also removed the sequence of the TEM-1 protein, and all sequences very similar to it. This last step was necessary to study deep mutational scanning data in [<xref ref-type="bibr" rid="CR11">11</xref>] and we use here the same alignment for sake of simplicity. Training a Boltzmann machine using well-equilibrated Monte Carlo chains is barely practical as the waiting time necessary to produce uncorrelated samples is huge and constantly increasing over the iterations (not shown). To solve this issue, we resort to a <italic>persistent</italic> sampling strategy, i.e. at each new iteration the Monte Carlo chains are initialized at the last configurations of the previous iteration, of <inline-formula id="IEq137"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^{3}$$\end{document}</tex-math><mml:math id="M288"><mml:msup><mml:mn>10</mml:mn><mml:mn>3</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq137.gif"/></alternatives></inline-formula> chains, each one sampling 10 configurations, with fixed waiting time <inline-formula id="IEq138"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{\rm wait} = 25$$\end{document}</tex-math><mml:math id="M290"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">wait</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq138.gif"/></alternatives></inline-formula> and equilibrium time <inline-formula id="IEq139"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{\rm eq} = 50$$\end{document}</tex-math><mml:math id="M292"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">eq</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq139.gif"/></alternatives></inline-formula> sweeps. In Fig. <xref rid="Fig4" ref-type="fig">4</xref>a we display the overlap between independent chains <inline-formula id="IEq140"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_{ext}$$\end{document}</tex-math><mml:math id="M294"><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="italic">ext</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq140.gif"/></alternatives></inline-formula>, which is similar to that of the MSA of the natural sequences <inline-formula id="IEq141"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_{MSA}$$\end{document}</tex-math><mml:math id="M296"><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="italic">MSA</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq141.gif"/></alternatives></inline-formula>, while <inline-formula id="IEq142"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_{int1}$$\end{document}</tex-math><mml:math id="M298"><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq142.gif"/></alternatives></inline-formula> and <inline-formula id="IEq143"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_{int2}$$\end{document}</tex-math><mml:math id="M300"><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq143.gif"/></alternatives></inline-formula> grow over the iterations suggesting that the samples are highly correlated. The fitting quality of the model is measured by using the Pearson correlation coefficient (blue markers) and the fitting errors over the one-site and two-site statistics (red, orange and brown markers) as shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>b; these measures are compatible to those obtained by a learning at equilibrium. To check the quality of the learning out-of-equilibrium, we re-sample the converged model and test the generative properties of the learned machine. The Pearson correlation coefficient and the fitting errors of the converged model are retrieved only if the configurations obtained by the re-sampling step are sufficiently de-correlated: indeed, to obtain the performances shown using black markers in Fig. <xref rid="Fig4" ref-type="fig">4</xref>b one has to set <inline-formula id="IEq144"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{\rm wait} \sim 10^{5}$$\end{document}</tex-math><mml:math id="M302"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">wait</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq144.gif"/></alternatives></inline-formula> which is the value of the waiting time that guarantees <inline-formula id="IEq145"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_{int1} \sim q_{int2}$$\end{document}</tex-math><mml:math id="M304"><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq145.gif"/></alternatives></inline-formula>. The remarkable results of the Beta-lactamase2 model are confirmed by the PCA analysis in Fig. <xref rid="Fig4" ref-type="fig">4</xref>c, d and by the contact prediction depicted in panels (e) and (f). In this case, adabmDCA achieves a reconstruction similar to that of plmDCA and outperforms Mi3-GPU where the adaptive strategy to sample statistically independent equilibrium configurations fails to produce a result due to the too large auto-correlation time estimated.</p>
      <p id="Par58">This result suggests that although we are not able to achieve an equilibrium sampling due to the large auto-correlation time, yet the resulting model retains the generative properties of an equilibrium-trained Boltzmann machine. Not only this result is important from a practical point of view, as this allows for a significant reduction of the computational time of the overall process, but it also opens new research directions in the field of out-of-equilibrium learning. We mention that if the procedure is performed using randomly initialized chains, instead of persistent chains, the quality of the converged model is achieved only setting a waiting time similar to that used in the training, as if the model had kept memory of the learning set-up. A similar behavior has been observed and discussed more systematically in [<xref ref-type="bibr" rid="CR37">37</xref>] in the context of learning Restricted Boltzmann machines.<fig id="Fig4"><label>Fig. 4</label><caption><p>Learning of PF13354 out-of-equilibrium. <bold>a</bold> We show the three overlaps <inline-formula id="IEq146"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_{ext}$$\end{document}</tex-math><mml:math id="M306"><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="italic">ext</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq146.gif"/></alternatives></inline-formula>, <inline-formula id="IEq147"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_{int1}$$\end{document}</tex-math><mml:math id="M308"><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq147.gif"/></alternatives></inline-formula> and <inline-formula id="IEq148"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_{int2}$$\end{document}</tex-math><mml:math id="M310"><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq148.gif"/></alternatives></inline-formula> of the sampled configurations used to estimate the model statistics as a function of the iterations (left axis) and the waiting time <italic>T</italic><sub>wait</sub> between two consecutive samples (right axis). At difference with the learning at equilibrium, <italic>T</italic><sub>wait</sub> is here kept constant during the training and the configurations are correlated as suggested by the differences between the distributions of <inline-formula id="IEq151"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_{int1}$$\end{document}</tex-math><mml:math id="M312"><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq151.gif"/></alternatives></inline-formula>, <inline-formula id="IEq152"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_{int2}$$\end{document}</tex-math><mml:math id="M314"><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq152.gif"/></alternatives></inline-formula> and <inline-formula id="IEq153"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_{ext}$$\end{document}</tex-math><mml:math id="M316"><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="italic">ext</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq153.gif"/></alternatives></inline-formula>. <bold>b</bold> The plot of the quality metrics used to estimate the goodness of the training: in blue we show the Pearson correlation coefficient between the two-site connected frequencies of the natural sequences and of the evolving model as a function of the iterations (blue markers, left axis) and the fitting errors (red, orange and brown markers, right axis) computed as <inline-formula id="IEq154"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varepsilon _{c}$$\end{document}</tex-math><mml:math id="M318"><mml:msub><mml:mi>ε</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq154.gif"/></alternatives></inline-formula> for the two-site connected statistics and as <inline-formula id="IEq155"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varepsilon _{f,s}$$\end{document}</tex-math><mml:math id="M320"><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4441_Article_IEq155.gif"/></alternatives></inline-formula> for the one-site and two-site non-connected statistics. <bold>c</bold>, <bold>d</bold> We show the projections of the natural sequences and of the re-sampled sequences into the first two principal components of the natural sequences while in <bold>e</bold> we plot the positive predictive value curve associated with the contact map prediction (shown in <bold>f</bold>) for the Beta-lactamase2 domain</p></caption><graphic xlink:href="12859_2021_4441_Fig4_HTML" id="MO36"/></fig></p>
    </sec>
    <sec id="Sec16">
      <title>Running time</title>
      <p id="Par59">We discuss in this section the computation time of adabmDCA. The running time needed by adabmDCA is often larger than the ones shown by the other methods used here for comparison: our machine spent 22, 53, and 98 hours for learning a model for PF00014, RF00059, and PF13354, respectively, against one hour and the 75 hours required by Mi3-GPU for PF00014 and PF13354 (employing two TITAN RTX GPUs) and the two hours needed by bl-dca for RF00059. We stress that the current implementation exploits a single thread and its running times are compatible with those achieved by the Boltzmann machine in [<xref ref-type="bibr" rid="CR10">10</xref>]. Moreover, the out-of-equilibrium learning allows for the training of an accurate machine, out-performing Mi3-GPU and spending a running time which is only slightly larger than that needed by Mi3-GPU, a highly optimized algorithm.</p>
      <p id="Par60">Fortunately, a multi-threads implementation of adabmDCA can be certainly attained by running in parallel the MCMC sampling, i.e. each thread could perform the simulations of a certain fraction of the MC chains, independently of the other threads. This direction will be considered in the future development of the algorithm.</p>
    </sec>
  </sec>
  <sec id="Sec17">
    <title>Conclusions</title>
    <p id="Par61">We developed a C/C++ implementation of Boltzmann machine learning for modeling RNA and protein sequence families, called adabmDCA. Together with a set of learning options that allows for a user-friendly control of the training strategy (including parameters initialization, regularization and decimation), it encompasses the possibility of adapting the Monte Carlo Markov Chain sampling ensuring an equilibrium training. In hard learning regimes, when the de-correlation time of the Monte Carlo chains appears to be large, the learning at equilibrium is intractable. In these cases, in adabmDCA it is possible to select a slightly out-of-equilibrium sampling whose behavior does not affect the quality of the learned model, as suggested by the results on the Beta-lactamase2 domain. Here, the performances of adabmDCA resemble those of plmDCA in predicting non-trivial physical contacts and outperforms other Boltzmann machine-like implementations. This promising achievement encourages new research perspectives in the field of non-equilibrium learning.</p>
  </sec>
  <sec id="Sec18">
    <title>Availability and Requirements</title>
    <p id="Par62">Project name: adabmDCA</p>
    <p id="Par63">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/anna-pa-m/adabmDCA">https://github.com/anna-pa-m/adabmDCA</ext-link></p>
    <p id="Par64">Operating systems: Linux, Mac OS and Windows</p>
    <p id="Par65">Programming languages: C/C++</p>
    <p id="Par66">Licence: MIT Licence</p>
    <p id="Par67">Any restriction to use by non-academics: No.</p>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>DCA:</term>
        <def>
          <p id="Par4">Direct coupling analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>PCA:</term>
        <def>
          <p id="Par5">Principal components analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>MSA:</term>
        <def>
          <p id="Par6">Multiple sequence alignment</p>
        </def>
      </def-item>
      <def-item>
        <term>PPV:</term>
        <def>
          <p id="Par7">Positive predictive value</p>
        </def>
      </def-item>
      <def-item>
        <term>MCMC:</term>
        <def>
          <p id="Par8">Monte Carlo Markov Chain</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn id="Fn1">
      <label>1</label>
      <p id="Par71">adabmDCA estimates the mixing time of the MCMC through the auto-correlation time of the sampled configurations</p>
    </fn>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Beatriz Seoane and Aurélien Decelle for interesting discussions on out-of-equilibrium learning strategies and for sharing the results of Ref. [<xref ref-type="bibr" rid="CR37">37</xref>] prior to publication.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author's contributions</title>
    <p>APM, AP, MW and FZ designed the research; APM and FZ implemented the code; APM, AP and FZ analyzed the data and wrote the paper. All authors have read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by a grant from the Simons Foundation (#454955, Francesco Zamponi), and from the EU H2020 research and innovation program MSCA-RISE-2016 (Grant 734439 InferNet). The funders have played no role in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The multiple sequence alignments analysed during the current study are available in the GitHub repository <ext-link ext-link-type="uri" xlink:href="https://github.com/anna-pa-m/adabmDCA">https://github.com/anna-pa-m/adabmDCA</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar2">
      <title>Ethics approval and consent to participate</title>
      <p id="Par68">Not applicable.</p>
    </notes>
    <notes id="FPar3">
      <title>Consent for publication</title>
      <p id="Par69">Not applicable.</p>
    </notes>
    <notes id="FPar4" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par70">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mistry</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chuguransky</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Qureshi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Salazar</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Sonnhammer</surname>
            <given-names>ELL</given-names>
          </name>
          <name>
            <surname>Tosatto</surname>
            <given-names>SCE</given-names>
          </name>
          <name>
            <surname>Paladin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Raj</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Finn</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Bateman</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Pfam: The protein families database in 2021</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2021</year>
        <volume>49</volume>
        <fpage>412</fpage>
        <lpage>419</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkaa913</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kalvari</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Nawrocki</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Ontiveros-Palacios</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Argasinska</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lamkiewicz</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Marz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Griffiths-Jones</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Toffano-Nioche</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gautheret</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Weinberg</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Rivas</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Finn</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bateman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Petrov</surname>
            <given-names>AI</given-names>
          </name>
        </person-group>
        <article-title>Rfam 14: expanded coverage of metagenomic viral and microRNA families</article-title>
        <source>Chem Rev</source>
        <year>2021</year>
        <volume>49</volume>
        <fpage>192</fpage>
        <lpage>200</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkaa1047</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Jumper J, Evans R, Pritzel A, Green T, Figurnov M, Ronneberger O, Tunyasuvunakool K, Bates R, Žídek A, Potapenko A, et al. Highly accurate protein structure prediction with alphafold. Nature. 2021;1–11. 10.1038/s41586-021-03819-2.</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Baek M, DiMaio F, Anishchenko I, Dauparas J, Ovchinnikov S, Lee GR, Wang J, Cong Q, Kinch LN, Schaeffer RD, Millán C, Park H, Adams C, Glassman CR, DeGiovanni A, Pereira JH, Rodrigues AV, van Dijk AA, Ebrecht AC, Opperman DJ, Sagmeister T, Buhlheller C, Pavkov-Keller T, Rathinaswamy MK, Dalwadi U, Yip CK, Burke JE, Garcia KC, Grishin NV, Adams PD, Read RJ, Baker D (2021) Accurate prediction of protein structures and interactions using a three-track neural network. Science eabj8754. 10.1126/science.abj8754</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weigt</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Szurmant</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Hoch</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Hwa</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Identification of direct residue contacts in protein–protein interaction by message passing</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2009</year>
        <volume>106</volume>
        <issue>1</issue>
        <fpage>67</fpage>
        <lpage>72</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0805923106</pub-id>
        <?supplied-pmid 19116270?>
        <pub-id pub-id-type="pmid">19116270</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morcos</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Pagnani</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lunt</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bertolino</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Marks</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Sander</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zecchina</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Onuchic</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Hwa</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Weigt</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Direct-coupling analysis of residue coevolution captures native contacts across many protein families</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2011</year>
        <volume>108</volume>
        <issue>49</issue>
        <fpage>1293</fpage>
        <lpage>1301</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1111471108</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cocco</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Feinauer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Figliuzzi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Monasson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Weigt</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Inverse statistical physics of protein sequences: a key issues review</article-title>
        <source>Rep Prog Phys.</source>
        <year>2018</year>
        <volume>81</volume>
        <issue>3</issue>
        <fpage>032601</fpage>
        <pub-id pub-id-type="doi">10.1088/1361-6633/aa9965</pub-id>
        <?supplied-pmid 29120346?>
        <pub-id pub-id-type="pmid">29120346</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sutto</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Marsili</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Valencia</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gervasio</surname>
            <given-names>FL</given-names>
          </name>
        </person-group>
        <article-title>From residue coevolution to protein conformational ensembles and functional dynamics</article-title>
        <source>Proc Nat Acad Sci.</source>
        <year>2015</year>
        <volume>112</volume>
        <issue>44</issue>
        <fpage>13567</fpage>
        <lpage>13572</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1508584112</pub-id>
        <?supplied-pmid 26487681?>
        <pub-id pub-id-type="pmid">26487681</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haldane</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Flynn</surname>
            <given-names>WF</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Vijayan</surname>
            <given-names>RSK</given-names>
          </name>
          <name>
            <surname>Levy</surname>
            <given-names>RM</given-names>
          </name>
        </person-group>
        <article-title>Structural propensities of kinase family proteins from a potts model of residue co-variation</article-title>
        <source>Protein Sci.</source>
        <year>2016</year>
        <volume>25</volume>
        <issue>8</issue>
        <fpage>1378</fpage>
        <lpage>1384</lpage>
        <pub-id pub-id-type="doi">10.1002/pro.2954</pub-id>
        <?supplied-pmid 27241634?>
        <pub-id pub-id-type="pmid">27241634</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Figliuzzi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Barrat-Charlaix</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Weigt</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>How pairwise coevolutionary models capture the collective residue variability in proteins?</article-title>
        <source>Mol Biol Evol.</source>
        <year>2018</year>
        <volume>35</volume>
        <issue>4</issue>
        <fpage>1018</fpage>
        <lpage>1027</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msy007</pub-id>
        <?supplied-pmid 29351669?>
        <pub-id pub-id-type="pmid">29351669</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barrat-Charlaix</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Muntoni</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Shimagaki</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Weigt</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zamponi</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Sparse generative modeling via parameter reduction of Boltzmann machines: application to protein-sequence families</article-title>
        <source>Phys Rev E</source>
        <year>2021</year>
        <volume>104</volume>
        <issue>2</issue>
        <fpage>024407</fpage>
        <pub-id pub-id-type="doi">10.1103/PhysRevE.104.024407</pub-id>
        <?supplied-pmid 34525554?>
        <pub-id pub-id-type="pmid">34525554</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Distance-based protein folding powered by deep learning</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2019</year>
        <volume>116</volume>
        <issue>34</issue>
        <fpage>16856</fpage>
        <lpage>16865</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1821309116</pub-id>
        <?supplied-pmid 31399549?>
        <pub-id pub-id-type="pmid">31399549</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Greener</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Kandathil</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>DT</given-names>
          </name>
        </person-group>
        <article-title>Deep learning extends de novo protein modelling coverage of genomes using iteratively predicted structural constraints</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-11994-0</pub-id>
        <pub-id pub-id-type="pmid">30602773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Senior</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Evans</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Jumper</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kirkpatrick</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sifre</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Qin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Žídek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nelson</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Bridgland</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improved protein structure prediction using potentials from deep learning</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>577</volume>
        <issue>7792</issue>
        <fpage>706</fpage>
        <lpage>710</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1923-7</pub-id>
        <?supplied-pmid 31942072?>
        <pub-id pub-id-type="pmid">31942072</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Anishchenko</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Ovchinnikov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Improved protein structure prediction using predicted interresidue orientations</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2020</year>
        <volume>117</volume>
        <issue>3</issue>
        <fpage>1496</fpage>
        <lpage>1503</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1914677117</pub-id>
        <?supplied-pmid 31896580?>
        <pub-id pub-id-type="pmid">31896580</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Russ</surname>
            <given-names>WP</given-names>
          </name>
          <name>
            <surname>Figliuzzi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stocker</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Barrat-Charlaix</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Socolich</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kast</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hilvert</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Monasson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cocco</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Weigt</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ranganathan</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>An evolution-based model for designing chorismate mutase enzymes</article-title>
        <source>Science</source>
        <year>2020</year>
        <volume>369</volume>
        <issue>6502</issue>
        <fpage>440</fpage>
        <lpage>445</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aba3304</pub-id>
        <?supplied-pmid 32703877?>
        <pub-id pub-id-type="pmid">32703877</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Figliuzzi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jacquier</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Schug</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tenaillon</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Weigt</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Coevolutionary landscape inference and the context-dependence of mutations in beta-lactamase tem-1</article-title>
        <source>Mol Biol Evol</source>
        <year>2016</year>
        <volume>33</volume>
        <issue>1</issue>
        <fpage>268</fpage>
        <lpage>280</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msv211</pub-id>
        <?supplied-pmid 26446903?>
        <pub-id pub-id-type="pmid">26446903</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hopf</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Ingraham</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Poelwijk</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Schärfe</surname>
            <given-names>CP</given-names>
          </name>
          <name>
            <surname>Springer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sander</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Marks</surname>
            <given-names>DS</given-names>
          </name>
        </person-group>
        <article-title>Mutation effects predicted from sequence co-variation</article-title>
        <source>Nat Biotechnol</source>
        <year>2017</year>
        <volume>35</volume>
        <issue>2</issue>
        <fpage>128</fpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3769</pub-id>
        <?supplied-pmid 28092658?>
        <pub-id pub-id-type="pmid">28092658</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ackley</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Hinton</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Sejnowski</surname>
            <given-names>TJ</given-names>
          </name>
        </person-group>
        <article-title>A learning algorithm for Boltzmann machines</article-title>
        <source>Cogn Sci</source>
        <year>1985</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>147</fpage>
        <lpage>169</lpage>
        <pub-id pub-id-type="doi">10.1016/S0364-0213(85)80012-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hinton</surname>
            <given-names>GE</given-names>
          </name>
        </person-group>
        <article-title>Training products of experts by minimizing contrastive divergence</article-title>
        <source>Neural Comput</source>
        <year>2002</year>
        <volume>14</volume>
        <issue>8</issue>
        <fpage>1771</fpage>
        <lpage>1800</lpage>
        <pub-id pub-id-type="doi">10.1162/089976602760128018</pub-id>
        <?supplied-pmid 12180402?>
        <pub-id pub-id-type="pmid">12180402</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jaynes</surname>
            <given-names>ET</given-names>
          </name>
        </person-group>
        <article-title>Information theory and statistical mechanics</article-title>
        <source>Phys Rev</source>
        <year>1957</year>
        <volume>106</volume>
        <issue>4</issue>
        <fpage>620</fpage>
        <lpage>630</lpage>
        <pub-id pub-id-type="doi">10.1103/PhysRev.106.620</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gao</surname>
            <given-names>C-Y</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>H-J</given-names>
          </name>
          <name>
            <surname>Aurell</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Correlation-compressed direct-coupling analysis</article-title>
        <source>Phys Rev E.</source>
        <year>2018</year>
        <volume>98</volume>
        <issue>3</issue>
        <fpage>032407</fpage>
        <pub-id pub-id-type="doi">10.1103/PhysRevE.98.032407</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morcos</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Pagnani</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lunt</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bertolino</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Marks</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Sander</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zecchina</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Onuchic</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Hwa</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Weigt</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Direct-coupling analysis of residue coevolution captures native contacts across many protein families</article-title>
        <source>Proc Nat Acad Sci.</source>
        <year>2011</year>
        <volume>108</volume>
        <issue>49</issue>
        <fpage>1293</fpage>
        <lpage>1301</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1111471108</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Metropolis</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Rosenbluth</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Rosenbluth</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Teller</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Teller</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Equation of state calculations by fast computing machines</article-title>
        <source>J Chem Phys</source>
        <year>1953</year>
        <volume>21</volume>
        <issue>6</issue>
        <fpage>1087</fpage>
        <lpage>1092</lpage>
        <pub-id pub-id-type="doi">10.1063/1.1699114</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hastings</surname>
            <given-names>WK</given-names>
          </name>
        </person-group>
        <article-title>Monte carlo sampling methods using markov chains and their applications</article-title>
        <source>Biometrika</source>
        <year>1970</year>
        <volume>57</volume>
        <issue>1</issue>
        <fpage>97</fpage>
        <lpage>109</lpage>
        <pub-id pub-id-type="doi">10.1093/biomet/57.1.97</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Geman</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Geman</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Stochastic relaxation, Gibbs distributions, and the Bayesian restoration of images</article-title>
        <source>IEEE Trans Pattern Anal Mach Intell</source>
        <year>1984</year>
        <volume>6</volume>
        <issue>6</issue>
        <fpage>721</fpage>
        <lpage>741</lpage>
        <pub-id pub-id-type="doi">10.1109/tpami.1984.4767596</pub-id>
        <?supplied-pmid 22499653?>
        <pub-id pub-id-type="pmid">22499653</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Duchi J, Hazan E, Singer Y. Adaptive subgradient methods for online learning and stochastic optimization. In: COLT 2010 - the 23rd conference on learning theory, 2010;pp 257–269</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Darken C, Moody J. Note on learning rate schedules for stochastic optimization. In: Proceedings of the 3rd International Conference on Neural Information Processing Systems. NIPS’90, pp. 832–838. Morgan Kaufmann Publishers Inc. 1990.</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Ferguson AL, Mann JK, Omarjee S, Ndung’u T, Walker BD, Chakraborty AK. Translating HIV sequences into quantitative fitness landscapes predicts viral vulnerabilities for rational immunogen design. Immunity. 2013;38(3):606–17. 10.1016/j.immuni.2012.11.022.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Haldane A, Flynn WF, He P, Vijayan RSK, Levy RM. Structural propensities of kinase family proteins from a potts model of residue co-variation. Protein Science. 2016;1378–1384. 10.1002/pro.2954.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haldane</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Levy</surname>
            <given-names>RM</given-names>
          </name>
        </person-group>
        <article-title>Mi3-GPU: MCMC-based inverse ising inference on GPUs for protein covariation analysis</article-title>
        <source>Comput Phys Commun</source>
        <year>2021</year>
        <volume>260</volume>
        <fpage>107312</fpage>
        <pub-id pub-id-type="doi">10.1016/j.cpc.2020.107312</pub-id>
        <?supplied-pmid 33716309?>
        <pub-id pub-id-type="pmid">33716309</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bitzek</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Koskinen</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gähler</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Moseler</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gumbsch</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Structural relaxation made simple</article-title>
        <source>Phys Rev Lett</source>
        <year>2006</year>
        <volume>97</volume>
        <issue>17</issue>
        <fpage>170201</fpage>
        <pub-id pub-id-type="doi">10.1103/PhysRevLett.97.170201</pub-id>
        <?supplied-pmid 17155444?>
        <pub-id pub-id-type="pmid">17155444</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ekeberg</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lövkvist</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Weigt</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Aurell</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Improved contact prediction in proteins: using pseudolikelihoods to infer Potts models</article-title>
        <source>Phys Rev E</source>
        <year>2013</year>
        <volume>87</volume>
        <issue>1</issue>
        <fpage>012707</fpage>
        <pub-id pub-id-type="doi">10.1103/PhysRevE.87.012707</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Cuturello F, Tiana G, Bussi G. Assessing the accuracy of direct-coupling analysis for RNA contact prediction. RNA. 2020;074179–119. 10.1261/rna.074179.119.</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <mixed-citation publication-type="other">Sarti E, Pagnani A. Infernet-h2020/pfam\_interactions: Initial Release. 10.5281/zenodo.4080947</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">
        <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/">https://www.ncbi.nlm.nih.gov/</ext-link>
      </mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Decelle A, Furtlehner C, Seoane B. Equilibrium and non-equilibrium regimes in the learning of restricted Boltzmann machines. 2021. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/2105.13889">arXiv:2105.13889</ext-link></mixed-citation>
    </ref>
  </ref-list>
</back>
