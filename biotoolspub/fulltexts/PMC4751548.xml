<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">G3 (Bethesda)</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genetics</journal-id>
    <journal-id journal-id-type="hwp">G3: Genes, Genomes, Genetics</journal-id>
    <journal-id journal-id-type="pmc">G3: Genes, Genomes, Genetics</journal-id>
    <journal-id journal-id-type="publisher-id">G3: Genes, Genomes, Genetics</journal-id>
    <journal-title-group>
      <journal-title>G3: Genes|Genomes|Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2160-1836</issn>
    <publisher>
      <publisher-name>Genetics Society of America</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4751548</article-id>
    <article-id pub-id-type="pmid">26684930</article-id>
    <article-id pub-id-type="publisher-id">GGG_023739</article-id>
    <article-id pub-id-type="doi">10.1534/g3.115.023739</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Investigations</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>argyle: An R Package for Analysis of Illumina Genotyping Arrays</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Morgan</surname>
          <given-names>Andrew P.</given-names>
        </name>
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1942-4543</contrib-id>
        <xref ref-type="corresp" rid="cor1">
          <sup>1</sup>
        </xref>
      </contrib>
      <aff id="aff1">Department of Genetics, University of North Carolina, Chapel Hill, North Carolina 27599-7264</aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1">
        <label>1</label>
        <italic>Author e-mail:</italic>
        <email>apm@email.unc.edu</email>
      </corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>12</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2016</year>
    </pub-date>
    <volume>6</volume>
    <issue>2</issue>
    <fpage>281</fpage>
    <lpage>286</lpage>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>10</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>12</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2016 Morgan</copyright-statement>
      <copyright-year>2016</copyright-year>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:title="pdf" xlink:type="simple" xlink:href="281.pdf"/>
    <abstract>
      <p>Genotyping microarrays are an important and widely-used tool in genetics. I present argyle, an R package for analysis of genotyping array data tailored to Illumina arrays. The goal of the argyle package is to provide simple, expressive tools for nonexpert users to perform quality checks and exploratory analyses of genotyping data. To these ends, the package consists of a suite of quality-control functions, normalization procedures, and utilities for visually and statistically summarizing such data. Format-conversion tools allow interoperability with popular software packages for analysis of genetic data including PLINK, R/qtl and DOQTL. Detailed vignettes demonstrating common use cases are included as supporting information. argyle bridges the gap between the low-level tasks of quality control and high-level tasks of genetic analysis. It is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/andrewparkermorgan/argyle">https://github.com/andrewparkermorgan/argyle</ext-link> and has been submitted to Bioconductor.</p>
    </abstract>
    <kwd-group>
      <kwd>SNP microarrays</kwd>
      <kwd>genotyping</kwd>
      <kwd>software</kwd>
    </kwd-group>
    <counts>
      <fig-count count="8"/>
      <table-count count="0"/>
      <equation-count count="0"/>
      <ref-count count="21"/>
      <page-count count="6"/>
    </counts>
  </article-meta>
</front>
<body>
  <p>High-throughput genotyping of tens of thousands of single nucleotide polymorphisms (SNPs) using microarrays is common practice in both laboratory and population genetics. Genotypes at a dense panel of biallelic markers with a low rate of missing data are a valuable resource for breeding, marker-assisted selection, genetic mapping, and analyses of population structure. The Illumina Infinium system is one popular and cost-effective (approximately $100/sample) platform. Custom Illumina arrays are available for many organisms of research, agricultural, or ecological interest including mouse (<xref rid="bib12" ref-type="bibr">Morgan <italic>et al.</italic> 2015</xref>, this issue), dog, cat (<xref rid="bib20" ref-type="bibr">Willet and Haase 2014</xref>), chicken, cow, pig, horse, sheep (<xref rid="bib11" ref-type="bibr">Kijas <italic>et al.</italic> 2009</xref>), salmon (<xref rid="bib10" ref-type="bibr">Johnston <italic>et al.</italic> 2013</xref>), and cotton (<xref rid="bib9" ref-type="bibr">Hulse-Kemp <italic>et al.</italic> 2015</xref>).</p>
  <p>Infinium arrays consist of many thousands of short invariant oligonucleotide probes conjugated to silica beads. Sample DNA is hybridized to the probes and a single-base, hybridization-dependent extension reaction is performed at the target SNP. Alternate alleles (herein denoted A and B) are labeled with different fluorophores (<xref rid="bib17" ref-type="bibr">Steemers <italic>et al.</italic> 2006</xref>). Raw fluorescence intensity from the two color channels is processed into a discrete genotype call at each SNP, and both the total intensity from both channels, and the relative intensity in one channel <italic>vs.</italic> the other, are informative for copy number.</p>
  <p>Many tools, both open-source and proprietary, already exist for postprocessing of raw hybridization intensity data. R packages include beadarray (<xref rid="bib5" ref-type="bibr">Dunning <italic>et al.</italic> 2007</xref>), lumi (<xref rid="bib4" ref-type="bibr">Du <italic>et al.</italic> 2008</xref>), and crlmm (<xref rid="bib15" ref-type="bibr">Ritchie <italic>et al.</italic> 2009</xref>) among others. Illumina’s proprietary BeadStudio software is widely used by commercial laboratories and core facilities. BeadStudio applies a six-step “affine normalization” (<xref rid="bib13" ref-type="bibr">Peiffer 2006</xref>), which pools data across many probes and many arrays. Intensities from the two color channels (herein denoted <italic>x</italic> and <italic>y</italic>) are transformed to lie in the standard coordinate plane, with homozygous genotypes near the <italic>x</italic> and <italic>y</italic> axes, heterozygous genotypes approximately on the <inline-formula><mml:math id="me2"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:math></inline-formula> diagonal, and <inline-formula><mml:math id="me3"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>y</mml:mi><mml:mo>≈</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Biallelic genotypes are then called by clustering in this space.</p>
  <p>Fewer tools exist for downstream quality control, exploratory analysis and interpretation of genotype calls jointly with underlying hybridization intensity data. To fill this gap, I present argyle, a package for the R statistical computing environment. The purpose of argyle is to provide simple and flexible tools for programmatic access to data from SNP arrays, with an emphasis on visualization. Although some functionality is tailored to Illumina arrays, many of the features are general enough to accommodate any dataset that can be expressed as a matrix of genotypes at biallelic markers. The main text of this paper outlines the key features of argyle; detailed code vignettes are provided as supplementary material.</p>
  <sec sec-type="methods" id="s1">
    <title>Methods</title>
    <p>The design of argyle is inspired by the PLINK software [<ext-link ext-link-type="uri" xlink:href="https://www.cog-genomics.org/plink2/">https://www.cog-genomics.org/plink2/</ext-link>; <xref rid="bib14" ref-type="bibr">Purcell <italic>et al.</italic> (2007)</xref>]. A PLINK fileset has three parts: a genotype matrix, a marker map, and a “pedigree” (sample and family metadata) file. Likewise, the central data structure in argyle (the genotypes object) stores a matrix of genotype calls, and hybridization-intensity data when available, in parallel with a marker map and sample metadata. A genotypes object is therefore a self-contained and largely self-describing representation of a genotyping dataset. Installation of the package is described in Supporting Information, <ext-link ext-link-type="uri" xlink:href="http://www.g3journal.org/lookup/suppl/doi:10.1534/g3.115.023739/-/DC1/FileS1.pdf">File S1</ext-link>, and the genotypes object is described in further detail in <ext-link ext-link-type="uri" xlink:href="http://www.g3journal.org/lookup/suppl/doi:10.1534/g3.115.023739/-/DC1/FileS2.pdf">File S2</ext-link>.</p>
    <p>This package explicitly favors <italic>simplicity</italic> and <italic>readability</italic> of code over raw efficiency. It is appropriate for the “medium-sized” data—tens of thousands of markers and hundreds of individuals—regularly encountered in experimental contexts. Users with larger datasets such as those routinely collected in human genetics—millions of markers and thousands of individuals—that do not fit comfortably in memory should explore more sophisticated R packages (such as the GenABEL suite: <ext-link ext-link-type="uri" xlink:href="http://www.genabel.org/">http://www.genabel.org/</ext-link>).</p>
    <sec id="s2">
      <title>Data availability</title>
      <p>Source code for argyle and example datasets used to generate the figures in this manuscript are available on GitHub: <ext-link ext-link-type="uri" xlink:href="https://github.com/andrewparkermorgan/argyle">https://github.com/andrewparkermorgan/argyle</ext-link>.</p>
    </sec>
  </sec>
  <sec id="s3">
    <title>Quality Control</title>
    <p>Removal of poorly-performing markers and poor-quality samples is an important precursor to genetic analysis. Failed arrays are characterized by aberrant intensity distributions, excess of missing and heterozygous calls, or both. A summary plot (<xref ref-type="fig" rid="fig1">Figure 1</xref>) facilitates the identification of low-quality samples. Concordance between biological sex and sex inferred from calls on the sex chromosomes is also useful for identifying contaminated or swapped samples. Failed arrays can be flagged and removed using global or subgroup-specific thresholds. See <ext-link ext-link-type="uri" xlink:href="http://www.g3journal.org/lookup/suppl/doi:10.1534/g3.115.023739/-/DC1/FileS3.pdf">File S3</ext-link> for a worked example.</p>
    <fig id="fig1" fig-type="figure" position="float">
      <label>Figure 1</label>
      <caption>
        <p>Quality-control summary plot. Distribution of genotype calls is shown in upper panel, and a contour plot of intensity distributions across samples is shown in lower panel. Samples failing quality thresholds are marked with an open dot in the upper panel.</p>
      </caption>
      <graphic xlink:href="281f1"/>
    </fig>
    <p>In addition to global summaries, argyle provides easy access to hybridization intensity data from individual probes. Inspection of “cluster plots” for individual probes is useful for confirming the accuracy of genotype calls and diagnosing poorly-performing markers (<xref ref-type="fig" rid="fig2">Figure 2</xref>). A dotplot (<xref ref-type="fig" rid="fig3">Figure 3</xref>) permits direct inspection of genotype calls at multiple markers over small genomic regions.</p>
    <fig id="fig2" fig-type="figure" position="float">
      <label>Figure 2</label>
      <caption>
        <p>Cluster plots for individual markers. Each point represents a single sample; points are colored according to genotype call, expressed as number of copies of the nonreference allele. The marker on the left performs as expected: the three canonical clusters are present in the expected locations. The marker on the right may be genotyped incorrectly: the homozygous reference cluster (red) is missing, and the nominally heterozygous samples (blue) fall into two clusters. This marker merits further inspection. For example, one nominally heterozygous cluster may correspond to homozygosity for the reference allele or, the marker may be detecting paralogous variation at off-target loci.</p>
      </caption>
      <graphic xlink:href="281f2"/>
    </fig>
    <fig id="fig3" fig-type="figure" position="float">
      <label>Figure 3</label>
      <caption>
        <p>Dotplot representation of genotypes among nine wild-caught mice on proximal chromosome 19 (from <xref rid="bib21" ref-type="bibr">Yang <italic>et al.</italic> 2011</xref>). Genotype calls are coded as counts of the reference allele, and points are colored according to genotype call. Blank spaces indicate missing calls. Markers are plotted with constant spacing in the main panel; gray lines indicate physical position along the chromosome in megabases (Mbp).</p>
      </caption>
      <graphic xlink:href="281f3"/>
    </fig>
  </sec>
  <sec id="s4">
    <title>Array Normalization</title>
    <p>Illumina BeadStudio uses an “affine normalization” algorithm to perform within- and between-array adjustments to <italic>x</italic>- and <italic>y</italic>-hybridization intensities before calling genotypes. However, further normalization is helpful for analyses of sample contamination and copy number. Two standard metrics are the <inline-formula><mml:math id="me4"><mml:mrow><mml:msub><mml:mrow><mml:mi>log</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mi>R</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> ratio (LRR), which captures total hybridization intensity (<italic>R</italic>) relative to a reference level (<inline-formula><mml:math id="me5"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>); and B-allele frequency (BAF), which captures the relative signal from the A and B alleles (<xref rid="bib13" ref-type="bibr">Peiffer 2006</xref>). For an uncontaminated euploid sample, the expected value of LRR is 0, and the expected value of BAF is 0.5 at heterozygous markers.</p>
    <p>The argyle package implements the thresholded quantile normalization (tQN) approach described in <xref rid="bib16" ref-type="bibr">Staaf <italic>et al.</italic> (2008)</xref> and <xref rid="bib3" ref-type="bibr">Didion <italic>et al.</italic> (2014)</xref>. Briefly, tQN performs within-array quantile normalization of the <italic>x</italic> channel against the <italic>y</italic> channel to account for dye biases specific to the Infinium chemistry, but places an upper bound on the difference between normalized and unnormalized intensity values. LRR and BAF are then computed using known cluster positions computed from a set of reference samples. The tQN procedure may optionally be preceded by preliminary between-array quantile normalization using routines implemented in the preprocessCore package (<xref rid="bib1" ref-type="bibr">Bolstad <italic>et al.</italic> 2003</xref>). A joint plot of BAF and LRR (<xref ref-type="fig" rid="fig4">Figure 4</xref>) is valuable for assessing heterozygosity, ploidy, sample purity, and sex-chromosome karyotype.</p>
    <fig id="fig4" fig-type="figure" position="float">
      <label>Figure 4</label>
      <caption>
        <p>Joint plot of B-allele frequency (BAF, upper panel) and log2 intensity ratio (LRR, lower panel) for an outbred male mouse. The autosomes are almost entirely heterozygous, while the X chromosome is hemizygous: no points appear near BAF = 0.5 on the X chromosome and its LRR is decreased relative to the autosomes. Red traces are a local smoothing of underlying points.</p>
      </caption>
      <graphic xlink:href="281f4"/>
    </fig>
    <p>Copy-number inference from Illumina arrays is a well-studied problem for which good solutions already exist—for instance, the standalone software PennCNV (<xref rid="bib19" ref-type="bibr">Wang <italic>et al.</italic> 2007</xref>), or the R package genoCN (<xref rid="bib18" ref-type="bibr">Sun <italic>et al.</italic> 2009</xref>). Most of these packages take BAF and LRR values as input and so are easily integrated downstream of argyle.</p>
    <p>Systematic batch effects on intensity distributions are possible when analyzing samples processed that were not processed concurrently. The reliability of discrete genotype calls may be unchanged between batches, but downstream analyses that make use of hybridization intensities [<italic>e.g.</italic>, copy-number analyses, or hidden Markov models (HMM) for haplotype inference in multiparental populations (<xref rid="bib7" ref-type="bibr">Fu <italic>et al.</italic> 2012</xref>; <xref rid="bib8" ref-type="bibr">Gatti <italic>et al.</italic> 2014</xref>)] may benefit from a further batch correction. One possibility, given <italic>k</italic> nonoverlapping batches, is quantile normalization of batches <inline-formula><mml:math id="me6"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> against the <italic>k</italic>th batch. Although between-batch normalization is not yet implemented in argyle, it is slated for inclusion in future releases.</p>
  </sec>
  <sec id="s5">
    <title>Genetics Tools</title>
    <p>Utilities are provided for efficient calculation of allele frequencies, heterozygosity and missingness by sample and by marker. When genotypes of both parents and offspring are available, pedigree relationships can be confirmed via checks for Mendelian inconsistencies. Separate datasets can be concatenated or merged using functions that ensure consistency of allele encoding and detect strand swaps [<italic>e.g.</italic>, an (A/G) <italic>vs.</italic> a (T/C) SNP].</p>
    <p>To facilitate analysis of genotypes from experimental crosses, argyle provides functions for recoding alleles with respect to parental lines. A general-purpose HMM allows for reconstruction of haplotype mosaics, given a panel of reference samples and a genetic map—although users are cautioned that more sophisticated implementations are available for some special cases (<xref rid="bib2" ref-type="bibr">Broman <italic>et al.</italic> 2003</xref>; <xref rid="bib7" ref-type="bibr">Fu <italic>et al.</italic> 2012</xref>; <xref rid="bib8" ref-type="bibr">Gatti <italic>et al.</italic> 2014</xref>). Mature tools for genetic mapping in the R environment already exist (<italic>e.g.</italic>, R/qtl; <xref rid="bib2" ref-type="bibr">Broman <italic>et al.</italic> 2003</xref>). Genotypes processed with argyle can be readily converted to R/qtl format to create a unified pipeline for quantitative-trait locus (QTL) mapping. One- and two-locus “mosaic plots” allow joint visualization of allele frequencies and phenotype at candidate QTL (<xref ref-type="fig" rid="fig5">Figure 5</xref>). A worked example is provided in <ext-link ext-link-type="uri" xlink:href="http://www.g3journal.org/lookup/suppl/doi:10.1534/g3.115.023739/-/DC1/FileS4.pdf">File S4</ext-link>.</p>
    <fig id="fig5" fig-type="figure" position="float">
      <label>Figure 5</label>
      <caption>
        <p>(A) One-way mosaic plot. Width of each bar is proportional to the frequency of the corresponding genotype; fill colors indicate phenotype, here case or control status. (B) Two-way mosaic plot. Area of each block is proportional to two-locus genotype frequency, and fill colors indicate phenotype mean for each two-locus genotype.</p>
      </caption>
      <graphic xlink:href="281f5"/>
    </fig>
    <p>Genome-wide patterns of relatedness can be explored using built-in functions for efficient kinship estimation (<xref ref-type="fig" rid="fig6">Figure 6</xref>) and principal components analysis (<xref ref-type="fig" rid="fig7">Figure 7</xref>). See <ext-link ext-link-type="uri" xlink:href="http://www.g3journal.org/lookup/suppl/doi:10.1534/g3.115.023739/-/DC1/FileS5.pdf">File S5</ext-link> for more detailed demonstration of functions useful for population-genetic analysis.</p>
    <fig id="fig6" fig-type="figure" position="float">
      <label>Figure 6</label>
      <caption>
        <p>Heatmap representation of matrix of pairwise genetic distances between 28 wild-caught mice from three different subspecies using data from the Mouse Diversity Array (<xref rid="bib21" ref-type="bibr">Yang <italic>et al.</italic> 2011</xref>). Genetic distance is defined here as the proportion of alleles shared identical by state between two individuals. The matrix is hierarchically clustered to that more closely-related samples are adjacent to each other. The heatmap is useful for visualizing population structure; here it reveals obvious genetic differentiation between mouse subspecies.</p>
      </caption>
      <graphic xlink:href="281f6"/>
    </fig>
    <fig id="fig7" fig-type="figure" position="float">
      <label>Figure 7</label>
      <caption>
        <p>Projection of the same 28 samples from <xref ref-type="fig" rid="fig6">Figure 6</xref> onto the top two principal components (PCs) of the genotypes matrix. The block structure of the kinship matrix corresponds to the three clusters revealed by principal component analysis (PCA), which in turn correspond to three distinct subspecies.</p>
      </caption>
      <graphic xlink:href="281f7"/>
    </fig>
  </sec>
  <sec id="s6">
    <title>Data Export</title>
    <p>The argyle package provides functions to convert genotypes objects to other formats either within the R session (for R/qtl and DOQTL) or on disk. Currently argyle supports export to either PLINK binary format (*.fam/*.bim/*.bed) or Stanford HGDP format. PLINK provides command-line utilities to convert its file format to many others, including VCF, LINKAGE (*.map/*.ped), Haploview, STRUCTURE, and fastPHASE. In addition, since genotypes objects are regular R matrices, users can adapt them to bespoke input formats required by other tools for genetic analysis.</p>
  </sec>
  <sec id="s7">
    <title>Performance</title>
    <p>argyle and its dependencies are compatible with R (<inline-formula><mml:math id="me7"><mml:mrow><mml:mo>≥</mml:mo><mml:mn>2.14</mml:mn></mml:mrow></mml:math></inline-formula>) on Windows or Mac OS X. The performance of argyle benefits from optimized code in several existing R packages including data.table and Rcpp (<xref rid="bib6" ref-type="bibr">Eddelbuettel 2013</xref>). Reading a dataset of realistic size – 96 samples <inline-formula><mml:math id="me8"><mml:mo>×</mml:mo></mml:math></inline-formula> <inline-formula><mml:math id="me9"><mml:mrow><mml:mi mathvariant="normal">77</mml:mi><mml:mi mathvariant="italic">,</mml:mi><mml:mi mathvariant="normal">808</mml:mi></mml:mrow></mml:math></inline-formula> markers (164 Mb ZIP-compressed on disk)—from Illumina BeadStudio output into an R session takes about 30 sec. The full dataset, including hybridization intensities and sample and marker metadata, occupies 202.4 Mb; without hybridization intensities, the size drops to 77.9 Mb. Memory usage scales approximately linearly with either the number of samples or the number of markers (<xref ref-type="fig" rid="fig8">Figure 8A</xref>). The most computationally-intensive component of argyle is the tQN procedure, and is implemented in C++. Its running time is compared to the quantile normalization routine from the preprocessCore package in <xref ref-type="fig" rid="fig8">Figure 8B</xref>. These resource requirements are well within the range of a typical laptop or desktop computer.</p>
    <fig id="fig8" fig-type="figure" position="float">
      <label>Figure 8</label>
      <caption>
        <p>(A) Memory requirements for genotypes objects (estimated via R’s object.size() with varying numbers of markers and samples, with and without hybridization intensities. (B) Running time per sample of the thresholded quantile normalization (tQN) procedure, with either initial quantile normalization or postpolishing, compared to quantile normalization alone.</p>
      </caption>
      <graphic xlink:href="281f8"/>
    </fig>
    <p>R’s internal limit of <inline-formula><mml:math id="me10"><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mn>31</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> entries for any matrix or vector places an upper bound on the dimensions of a genotypes object. For arrays with between <inline-formula><mml:math id="me11"><mml:mrow><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="me12"><mml:mrow><mml:mn>150</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:math></inline-formula> markers, this translates to a limit of between <inline-formula><mml:math id="me13"><mml:mrow><mml:mn>14</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="me14"><mml:mrow><mml:mn>21</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:math></inline-formula> samples.</p>
    <p>Tests were performed in R 3.1.2 (64-bit) on a MacBook Air, with a single 1.7 Ghz Intel Core i7 processor, and 8 Gb RAM.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supporting Information</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_6_2_281__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_g3.115.023739_FileS1.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_g3.115.023739_FileS2.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_g3.115.023739_FileS3.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_g3.115.023739_FileS4.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_g3.115.023739_FileS5.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>The author thanks John Didion for advice on design and quality-control methods; John Didion, Dan Gatti, Marty Ferris, and Sofia Grize for valuable feedback on early versions of this software; and Robert Corty, Will Valdar, and Fernando Pardo-Manuel de Villena for helpful comments on this manuscript. This work was supported in part by NIH grants F30MH103925 (APM), U19AI100625 (FPMV), U42OD010924 (Terry Magnuson), and the UNC Bioinformatics and Computational Biology Training Grant (T32GM067553).</p>
    <p><italic>Note added in proof:</italic> See <xref rid="bib12" ref-type="bibr">Morgan <italic>et al</italic>. 2015</xref> (pp. 263–279) in this issue, for a related work.</p>
  </ack>
  <fn-group>
    <fn id="fn1" fn-type="supplementary-material">
      <p>Supporting information is available online at <ext-link ext-link-type="uri" xlink:href="http://www.g3journal.org/lookup/suppl/doi:10.1534/g3.115.023739/-/DC1">www.g3journal.org/lookup/suppl/doi:10.1534/g3.115.023739/-/DC1</ext-link></p>
    </fn>
    <fn id="fn2">
      <p>Communicating editor: D. W. Threadgill</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>Literature Cited</title>
    <ref id="bib1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bolstad</surname><given-names>B.</given-names></name><name><surname>Irizarry</surname><given-names>R.</given-names></name><name><surname>Astrand</surname><given-names>M.</given-names></name><name><surname>Speed</surname><given-names>T.</given-names></name></person-group>, <year>2003</year> <article-title>A comparison of normalization methods for high density oligonucleotide array data based on variance and bias.</article-title><source>Bioinformatics</source><volume>19</volume>: <fpage>185</fpage>–<lpage>193</lpage>.<pub-id pub-id-type="pmid">12538238</pub-id></mixed-citation>
    </ref>
    <ref id="bib2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Broman</surname><given-names>K. W.</given-names></name><name><surname>Wu</surname><given-names>H.</given-names></name><name><surname>Sen</surname><given-names>S.</given-names></name><name><surname>Churchill</surname><given-names>G. A.</given-names></name></person-group>, <year>2003</year> <article-title>R/qtl: QTL mapping in experimental crosses.</article-title><source>Bioinformatics</source><volume>19</volume>: <fpage>889</fpage>–<lpage>890</lpage>.<pub-id pub-id-type="pmid">12724300</pub-id></mixed-citation>
    </ref>
    <ref id="bib3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Didion</surname><given-names>J. P.</given-names></name><name><surname>Buus</surname><given-names>R. J.</given-names></name><name><surname>Naghashfar</surname><given-names>Z.</given-names></name><name><surname>Threadgill</surname><given-names>D. W.</given-names></name><name><surname>Morse</surname><given-names>H. C.</given-names></name><etal/></person-group>, <year>2014</year> <article-title>SNP array profiling of mouse cell lines identifies their strains of origin and reveals cross-contamination and widespread aneuploidy.</article-title><source>BMC Genomics</source><volume>15</volume>: <fpage>847</fpage>.<pub-id pub-id-type="pmid">25277546</pub-id></mixed-citation>
    </ref>
    <ref id="bib4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Du</surname><given-names>P.</given-names></name><name><surname>Kibbe</surname><given-names>W. A.</given-names></name><name><surname>Lin</surname><given-names>S. M.</given-names></name></person-group>, <year>2008</year> <article-title>lumi: a pipeline for processing illumina microarray.</article-title><source>Bioinformatics</source><volume>24</volume>: <fpage>1547</fpage>–<lpage>1548</lpage>.<pub-id pub-id-type="pmid">18467348</pub-id></mixed-citation>
    </ref>
    <ref id="bib5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dunning</surname><given-names>M. J.</given-names></name><name><surname>Smith</surname><given-names>M. L.</given-names></name><name><surname>Ritchie</surname><given-names>M. E.</given-names></name><name><surname>Tavare</surname><given-names>S.</given-names></name></person-group>, <year>2007</year> <article-title>beadarray: R classes and methods for illumina bead-based data.</article-title><source>Bioinformatics</source><volume>23</volume>: <fpage>2183</fpage>–<lpage>2184</lpage>.<pub-id pub-id-type="pmid">17586828</pub-id></mixed-citation>
    </ref>
    <ref id="bib6">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Eddelbuettel</surname><given-names>D.</given-names></name></person-group>, <year>2013</year> <source>Seamless R and C++ Integration with Rcpp</source>, <publisher-name>Springer, New York</publisher-name>.</mixed-citation>
    </ref>
    <ref id="bib7">
      <mixed-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Fu</surname><given-names>C.-P.</given-names></name><name><surname>Welsh</surname><given-names>C. E.</given-names></name><name><surname>de Villena</surname><given-names>F. P.-M.</given-names></name><name><surname>McMillan</surname><given-names>L.</given-names></name></person-group>, <year>2012</year> Inferring ancestry in admixed populations using microarray probe intensities, pp. 105–112 in <italic>Proceedings of the ACM Conference on Bioinformatics</italic>, <italic>Computational Biology and Biomedicine - BCB ′12</italic>, <publisher-name>Association for Computing Machinery (ACM</publisher-name>). <comment>New York, NY</comment>.</mixed-citation>
    </ref>
    <ref id="bib8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gatti</surname><given-names>D. M.</given-names></name><name><surname>Svenson</surname><given-names>K. L.</given-names></name><name><surname>Shabalin</surname><given-names>A.</given-names></name><name><surname>Wu</surname><given-names>L.-Y.</given-names></name><name><surname>Valdar</surname><given-names>W.</given-names></name><etal/></person-group>, <year>2014</year> <article-title>Quantitative trait locus mapping methods for diversity outbred mice.</article-title><source>G3 (Bethesda)</source><volume>4</volume>: <fpage>1623</fpage>–<lpage>1633</lpage>.<pub-id pub-id-type="pmid">25237114</pub-id></mixed-citation>
    </ref>
    <ref id="bib9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hulse-Kemp</surname><given-names>A. M.</given-names></name><name><surname>Lemm</surname><given-names>J.</given-names></name><name><surname>Plieske</surname><given-names>J.</given-names></name><name><surname>Ashrafi</surname><given-names>H.</given-names></name><name><surname>Buyyarapu</surname><given-names>R.</given-names></name><etal/></person-group>, <year>2015</year> <article-title>Development of a 63k SNP array for cotton and high-density mapping of intraspecific and interspecific populations of gossypium spp.</article-title><source>G3 (Bethesda)</source><volume>5</volume>: <fpage>1187</fpage>–<lpage>1209</lpage>.<pub-id pub-id-type="pmid">25908569</pub-id></mixed-citation>
    </ref>
    <ref id="bib10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnston</surname><given-names>S. E.</given-names></name><name><surname>Lindqvist</surname><given-names>M.</given-names></name><name><surname>Niemelä</surname><given-names>E.</given-names></name><name><surname>Orell</surname><given-names>P.</given-names></name><name><surname>Erkinaro</surname><given-names>J.</given-names></name><etal/></person-group>, <year>2013</year> <article-title>Fish scales and SNP chips: SNP genotyping and allele frequency estimation in individual and pooled DNA from historical samples of atlantic salmon (salmo salar).</article-title><source>BMC Genomics</source><volume>14</volume>: <fpage>439</fpage>.<pub-id pub-id-type="pmid">23819691</pub-id></mixed-citation>
    </ref>
    <ref id="bib11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kijas</surname><given-names>J. W.</given-names></name><name><surname>Townley</surname><given-names>D.</given-names></name><name><surname>Dalrymple</surname><given-names>B. P.</given-names></name><name><surname>Heaton</surname><given-names>M. P.</given-names></name><name><surname>Maddox</surname><given-names>J. F.</given-names></name><etal/></person-group>, <year>2009</year> <article-title>A genome wide survey of SNP variation reveals the genetic structure of sheep breeds.</article-title><source>PLoS One</source><volume>4</volume>: <fpage>e4668</fpage>.<pub-id pub-id-type="pmid">19270757</pub-id></mixed-citation>
    </ref>
    <ref id="bib12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morgan</surname><given-names>A.P.</given-names></name><name><surname>Fu</surname><given-names>C.-P.</given-names></name><name><surname>Kao</surname><given-names>C.-Y.</given-names></name><name><surname>Welsh</surname><given-names>C. E.</given-names></name><name><surname>Didion</surname><given-names>J.P.</given-names></name><etal/></person-group>, <year>2015</year> <article-title>The mouse universal genotyping array: from substrains to subspecies.</article-title><source>G3 (Bethesda)</source><volume>6</volume>: <fpage>263</fpage>–<lpage>279</lpage>.<pub-id pub-id-type="pmid">26684931</pub-id></mixed-citation>
    </ref>
    <ref id="bib13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peiffer</surname><given-names>D. A.</given-names></name></person-group>, <year>2006</year> <article-title>High-resolution genomic profiling of chromosomal aberrations using infinium whole-genome genotyping.</article-title><source>Genome Res.</source><volume>16</volume>: <fpage>1136</fpage>–<lpage>1148</lpage>.<pub-id pub-id-type="pmid">16899659</pub-id></mixed-citation>
    </ref>
    <ref id="bib14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Purcell</surname><given-names>S.</given-names></name><name><surname>Neale</surname><given-names>B.</given-names></name><name><surname>Todd-Brown</surname><given-names>K.</given-names></name><name><surname>Thomas</surname><given-names>L.</given-names></name><name><surname>Ferreira</surname><given-names>M. A.</given-names></name><etal/></person-group>, <year>2007</year> <article-title>PLINK: A tool set for whole-genome association and population-based linkage analyses.</article-title><source>Am. J. Hum. Genet.</source><volume>81</volume>: <fpage>559</fpage>–<lpage>575</lpage>.<pub-id pub-id-type="pmid">17701901</pub-id></mixed-citation>
    </ref>
    <ref id="bib15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ritchie</surname><given-names>M. E.</given-names></name><name><surname>Carvalho</surname><given-names>B. S.</given-names></name><name><surname>Hetrick</surname><given-names>K. N.</given-names></name><name><surname>Tavare</surname><given-names>S.</given-names></name><name><surname>Irizarry</surname><given-names>R. A.</given-names></name></person-group>, <year>2009</year> <article-title>R/bioconductor software for Illumina’s Infinium whole-genome genotyping BeadChips.</article-title><source>Bioinformatics</source><volume>25</volume>: <fpage>2621</fpage>–<lpage>2623</lpage>.<pub-id pub-id-type="pmid">19661241</pub-id></mixed-citation>
    </ref>
    <ref id="bib16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Staaf</surname><given-names>J.</given-names></name><name><surname>Vallon-Christersson</surname><given-names>J.</given-names></name><name><surname>Lindgren</surname><given-names>D.</given-names></name><name><surname>Juliusson</surname><given-names>G.</given-names></name><name><surname>Rosenquist</surname><given-names>R.</given-names></name><etal/></person-group>, <year>2008</year> <article-title>Normalization of Illumina Infinium whole-genome SNP data improves copy number estimates and allelic intensity ratios.</article-title><source>BMC Bioinformatics</source><volume>9</volume>: <fpage>409</fpage>.<pub-id pub-id-type="pmid">18831757</pub-id></mixed-citation>
    </ref>
    <ref id="bib17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steemers</surname><given-names>F. J.</given-names></name><name><surname>Chang</surname><given-names>W.</given-names></name><name><surname>Lee</surname><given-names>G.</given-names></name><name><surname>Barker</surname><given-names>D. L.</given-names></name><name><surname>Shen</surname><given-names>R.</given-names></name><etal/></person-group>, <year>2006</year> <article-title>Whole-genome genotyping with the single-base extension assay.</article-title><source>Nat. Methods</source><volume>3</volume>: <fpage>31</fpage>–<lpage>33</lpage>.<pub-id pub-id-type="pmid">16369550</pub-id></mixed-citation>
    </ref>
    <ref id="bib18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname><given-names>W.</given-names></name><name><surname>Wright</surname><given-names>F. A.</given-names></name><name><surname>Tang</surname><given-names>Z.</given-names></name><name><surname>Nordgard</surname><given-names>S. H.</given-names></name><name><surname>Loo</surname><given-names>P. V.</given-names></name><etal/></person-group>, <year>2009</year> <article-title>Integrated study of copy number states and genotype calls using high-density SNP arrays.</article-title><source>Nucleic Acids Res.</source><volume>37</volume>: <fpage>5365</fpage>–<lpage>5377</lpage>.<pub-id pub-id-type="pmid">19581427</pub-id></mixed-citation>
    </ref>
    <ref id="bib19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>K.</given-names></name><name><surname>Li</surname><given-names>M.</given-names></name><name><surname>Hadley</surname><given-names>D.</given-names></name><name><surname>Liu</surname><given-names>R.</given-names></name><name><surname>Glessner</surname><given-names>J.</given-names></name><etal/></person-group>, <year>2007</year> <article-title>PennCNV: an integrated hidden markov model designed for high-resolution copy number variation detection in whole-genome SNP genotyping data.</article-title><source>Genome Res.</source><volume>17</volume>: <fpage>1665</fpage>–<lpage>1674</lpage>.<pub-id pub-id-type="pmid">17921354</pub-id></mixed-citation>
    </ref>
    <ref id="bib20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Willet</surname><given-names>C. E.</given-names></name><name><surname>Haase</surname><given-names>B.</given-names></name></person-group>, <year>2014</year> <article-title>An updated felCat5 SNP manifest for the illumina feline 63k SNP genotyping array.</article-title><source>Anim. Genet.</source><volume>45</volume>: <fpage>614</fpage>–<lpage>615</lpage>.<pub-id pub-id-type="pmid">24804964</pub-id></mixed-citation>
    </ref>
    <ref id="bib21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>H.</given-names></name><name><surname>Wang</surname><given-names>J. R.</given-names></name><name><surname>Didion</surname><given-names>J. P.</given-names></name><name><surname>Buus</surname><given-names>R. J.</given-names></name><name><surname>Bell</surname><given-names>T. A.</given-names></name><etal/></person-group>, <year>2011</year> <article-title>Subspecific origin and haplotype diversity in the laboratory mouse.</article-title><source>Nat. Genet.</source><volume>43</volume>: <fpage>648</fpage>–<lpage>655</lpage>.<pub-id pub-id-type="pmid">21623374</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
