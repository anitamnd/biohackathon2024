<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9883684</article-id>
    <article-id pub-id-type="pmid">31504158</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btz664</article-id>
    <article-id pub-id-type="publisher-id">btz664</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>miComplete: weighted quality evaluation of assembled microbial genomes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-0819-3359</contrib-id>
        <name>
          <surname>Hugoson</surname>
          <given-names>Eric</given-names>
        </name>
        <aff><institution>Department of Medical Biochemistry and Microbiology, Science for Life Laboratories, Uppsala University</institution>, Uppsala SE-751 23, <country country="SE">Sweden</country></aff>
        <aff><institution>Department of Microbial Population Biology, Max Planck Institute for Evolutionary Biology</institution>, Plön D-24306, <country country="DE">Germany</country></aff>
        <xref rid="btz664-cor1" ref-type="corresp"/>
        <!--hugoson@evolbio.mpg.de-->
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-0098-1692</contrib-id>
        <name>
          <surname>Lam</surname>
          <given-names>Wai Tin</given-names>
        </name>
        <aff><institution>Department of Microbial Population Biology, Max Planck Institute for Evolutionary Biology</institution>, Plön D-24306, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-8354-2398</contrib-id>
        <name>
          <surname>Guy</surname>
          <given-names>Lionel</given-names>
        </name>
        <aff><institution>Department of Medical Biochemistry and Microbiology, Science for Life Laboratories, Uppsala University</institution>, Uppsala SE-751 23, <country country="SE">Sweden</country></aff>
        <xref rid="btz664-cor1" ref-type="corresp"/>
        <!--lionel.guy@imbim.uu.se-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Hancock</surname>
          <given-names>John</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btz664-cor1">To whom correspondence should be addressed. <email>hugoson@evolbio.mpg.de</email> or <email>lionel.guy@imbim.uu.se</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>2</month>
      <year>2020</year>
    </pub-date>
    <pub-date iso-8601-date="2019-08-22" pub-type="epub">
      <day>22</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <volume>36</volume>
    <issue>3</issue>
    <fpage>936</fpage>
    <lpage>937</lpage>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>4</month>
        <year>2019</year>
      </date>
      <date date-type="rev-recd">
        <day>23</day>
        <month>7</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>8</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bioinformatics_36_3_936.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Metagenomics and single-cell genomics have revolutionized the study of microorganisms, increasing our knowledge of microbial genomic diversity by orders of magnitude. A major issue pertaining to metagenome-assembled genomes (MAGs) and single-cell amplified genomes (SAGs) is to estimate their completeness and redundancy. Most approaches rely on counting conserved gene markers. In miComplete, we introduce a weighting strategy, where we normalize the presence/absence of markers by their median distance to the next marker in a set of complete reference genomes. This approach alleviates biases introduced by the presence/absence of shorter DNA pieces containing many markers, e.g. ribosomal protein operons.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>miComplete is written in Python 3 and released under GPLv3. Source code and documentation are available at <ext-link xlink:href="https://bitbucket.org/evolegiolab/micomplete" ext-link-type="uri">https://bitbucket.org/evolegiolab/micomplete</ext-link>.</p>
      </sec>
      <sec id="s3">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Swedish Research Council</institution>
            <institution-id institution-id-type="doi">10.13039/501100004359</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2017-03709</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution>Carl Tryggers Foundation</institution>
        </funding-source>
        <award-id>CTS 15:184</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The developments of high-throughput sequencing have led to an ever-increasing affordability and availability of large-scale sequencing projects. Vast amounts of metagenomic data is generated, leading to the publication of thousands of metagenome-assembled genomes (MAGs) from uncultured microorganisms (e.g. <xref rid="btz664-B7" ref-type="bibr">Parks <italic toggle="yes">et al.</italic>, 2017</xref>). Genomes from uncultured microorganisms may also be obtained by sorting cells on a flow cytometer, amplifying and sequencing their DNA. The resulting single-cell amplified genomes (SAGs) have also contributed to widely increase our knowledge of microbial diversity (e.g. <xref rid="btz664-B8" ref-type="bibr">Rinke <italic toggle="yes">et al.</italic>, 2013</xref>).</p>
    <p>Assessing the quality of MAGs and SAGs has become paramount. Metagenomic data is difficult to correctly assemble and bin into MAGs, with most MAGs missing contigs and/or being contaminated with foreign contigs. As for SAGs, their completeness varies widely, with virtually no SAG being 100% complete. Most methods estimate level of completeness and contamination (or redundancy) of SAGs and MAGs by identifying single copy, conserved marker genes. The fraction of identified markers corresponds to genome completeness, while additional copies represent either contamination or redundancy (<xref rid="btz664-B8" ref-type="bibr">Rinke <italic toggle="yes">et al.</italic>, 2013</xref>). This approach is implemented e.g. in CheckM (<xref rid="btz664-B6" ref-type="bibr">Parks <italic toggle="yes">et al.</italic>, 2015</xref>) and BUSCO (<xref rid="btz664-B10" ref-type="bibr">Simão <italic toggle="yes">et al.</italic>, 2015</xref>).</p>
    <p>So far, all markers are considered as equally contributing to completeness or redundancy. However, markers are not uniformly distributed around prokaryotic chromosomes, and a certain amount of linkage is conserved even across long evolutionary distances (e.g. <xref rid="btz664-B9" ref-type="bibr">Rogozin <italic toggle="yes">et al.</italic>, 2002</xref>; <xref rid="btz664-B4" ref-type="bibr">Lathe <italic toggle="yes">et al</italic>., 2000</xref>). This is especially important since commonly used marker sets often include ribosomal protein genes, which are organized in conserved operons: thus, the presence or absence of ribosomal protein genes (or of other markers generally close to others) should contribute to completeness and redundancy less than that of other non-clustered genes.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>In miComplete, we implement a method to reduce potential bias introduced by the presence or absence of genetically linked markers. The selected set of markers is first identified in a set of representative, complete, closed chromosomes. For each marker in each genome, half the distance to the next marker upstream and downstream is recorded, and the sum of the two is normalized to the genome size. The median over all genomes is then used as weight when calculating the completeness or redundancy for query genomes. In a set of 105 highly conserved bacterial markers, the weights, inferred from a set of 1 175 genomes representative of all bacteria (see below), ranged over three orders of magnitude, from 1.02e-5 (Ribosomal protein L22) to 3.17e-2 (RecR). The distribution of weights for this particular set is shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref>. The square root of the sum over the weights’ standard deviations is used as a measure of the uncertainty attached to a particular set of weights.</p>
  </sec>
  <sec>
    <title>3 Implementation</title>
    <p>miComplete is written in Python 3, and relies, among others, on Numpy and Biopython (<xref rid="btz664-B1" ref-type="bibr">Cock <italic toggle="yes">et al.</italic>, 2009</xref>). To identify completeness and redundancy, miComplete aligns a set of Hidden Markov Models (HMM) derived from single copy markers to the genomes of interest. First, prodigal (<xref rid="btz664-B3" ref-type="bibr">Hyatt <italic toggle="yes">et al.</italic>, 2010</xref>) is used to identify protein-coding genes in unannotated genomes. Second, HMMER3 (<xref rid="btz664-B5" ref-type="bibr">Mistry <italic toggle="yes">et al.</italic>, 2013</xref>) identifies hits to the set of HMM among the annotated genomes, employing both a simple e-value cutoff for initial matching as well as a combination of bias- and best single domain score to evaluate the quality of matches. HMM sets can be either provided by the user or selected from the (currently) two prebuilt sets, one for bacteria and one for archaea, derived from previous work (<xref rid="btz664-B2" ref-type="bibr">Guy, 2017</xref>; <xref rid="btz664-B8" ref-type="bibr">Rinke <italic toggle="yes">et al.</italic>, 2013</xref>). Completeness is the fraction of markers identified and redundancy the fraction of additional copies of markers.</p>
    <p>miComplete calculates the weights of a marker set in a set of complete genomes, using then these weights to infer weighted completeness and redundancy in a query set of MAGs or SAGs. Alternatively, the user may use the precalculated weights associated with the inbuilt marker sets. Results are output in a tabulated list format, including the estimated weighted completeness and redundancy and a list of assembly statistics (genome length, GC-content, N- and L50, etc.). The estimated error attached to the weights and other metadata are also part of the output.</p>
  </sec>
  <sec>
    <title>4 Benchmarking</title>
    <p>To estimate the effectiveness of the new weighted approach, we simulated a set of MAGs from complete genomes into contigs, with varying completeness and redundancy. To obtain realistic contig lengths, a distribution of contig lengths was built from 2631 draft MAGs (<xref rid="btz664-B11" ref-type="bibr">Tully <italic toggle="yes">et al.</italic>, 2018</xref>) recovered from the Tara Oceans dataset (<xref rid="btz664-B12" ref-type="bibr">Karsenti <italic toggle="yes">et al.</italic>, 2011</xref>). The resulting distribution was used to randomly sample contig lengths to split a genome into. Contigs were then randomly removed to meet desired completeness level. To simulate redundancy, all other contigs were pooled and randomly added to each artificial MAG up to the desired level. The code used to calculate the contig length distribution and to simulate MAGs is freely available from <ext-link xlink:href="https://bitbucket.org/EricHugo/randmag" ext-link-type="uri">https://bitbucket.org/EricHugo/randmag</ext-link>.</p>
    <p>Levels of completeness were simulated (0.1–0.9, increment 0.1) using this method, along with levels of redundancy (1.05–1.2, increment 0.05). For each increment, 10 000 MAGs were simulated from 1175 complete, representative genomes. These genomes were chosen with phyloSkeleton (<xref rid="btz664-B2" ref-type="bibr">Guy, 2017</xref>) to select one genome from each genus across all bacteria containing at least one complete genome (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). Results from miComplete and CheckM were then compared, employing the same set of markers on the same artificial MAGs. CheckM was run with the resource-intensive default settings for a subset of 1000 MAGs (<xref rid="btz664-F1" ref-type="fig">Fig. 1</xref>).
</p>
    <fig position="float" id="btz664-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Ridgeplots of errors in estimating (<bold>A</bold>) completeness and (<bold>B</bold>) redundancy with CheckM, using a fixed marker set (orange) or default settings (purple) and miComplete (blue). Each stapled plot represents the distribution of error (difference between observed and expected value) for increments of simulated completeness (<bold>A</bold>) or redundancy (<bold>B</bold>)</p>
      </caption>
      <graphic xlink:href="bioinformatics_36_3_936_f1" position="float"/>
    </fig>
    <p>Across all levels of completeness tested, the weighting strategy of miComplete yields an observed median completeness closer to the expected value than without weighting, when using the same set of markers (<xref rid="btz664-F1" ref-type="fig">Fig. 1A</xref>). The distribution of estimated completeness also showed a lower variance with the weighting strategy than without. Redundancy estimations showed a similarly reduced variance with the weighting strategy, although the median is similarly close to the expected value for both strategies, only slightly favouring the weighted approach (<xref rid="btz664-F1" ref-type="fig">Fig. 1B</xref>). Running the largest dataset of the estimations (1.2 redundancy) from the set above required an average of 9.81 s per simulated MAG for CheckM (fixed marker set) and 2.72 s for miComplete, on the same node using 12 threads for execution. It should be noted that CheckM contains a very large range of other features, among others automatically selecting markers, explaining its higher runtime and its generally better results with default settings.</p>
    <p>In summary, miComplete allows a rapid and robust quality evaluation of MAGs and SAGs. Through weighting markers according to their conserved genetic linkage yields completeness and redundancy estimations that are less biased and have narrower distributions.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btz664_Supplementary_Data</label>
      <media xlink:href="bioinformatics_36_3_936_s2.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors thank Joran Martijn for his help with early developments of miComplete.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the Swedish Research Council [2017-03709 to L.G.]; and the Carl Tryggers Foundation [CTS 15:184 to L.G.].</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btz664-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cock</surname>
 <given-names>P.J.A.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2009</year>) 
<article-title>Biopython: freely available Python tools for computational molecular biology and bioinformatics</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>1422</fpage>–<lpage>1423</lpage>.<pub-id pub-id-type="pmid">19304878</pub-id></mixed-citation>
    </ref>
    <ref id="btz664-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guy</surname>
 <given-names>L.</given-names></string-name></person-group> (<year>2017</year>) 
<article-title>phyloSkeleton: taxon selection, data retrieval and marker identification for phylogenomics</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>1230</fpage>–<lpage>1232</lpage>.<pub-id pub-id-type="pmid">28057682</pub-id></mixed-citation>
    </ref>
    <ref id="btz664-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hyatt</surname>
 <given-names>D.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2010</year>) 
<article-title>Prodigal: prokaryotic gene recognition and translation initiation site identification</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>, <fpage>119.</fpage><pub-id pub-id-type="pmid">20211023</pub-id></mixed-citation>
    </ref>
    <ref id="btz664-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Karsenti</surname>
 <given-names>E.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2011</year>) 
<article-title>A holistic approach to marine eco-systems biology</article-title>. <source>PLOS Biol</source>., <volume>9</volume>, <fpage>e1001177</fpage>.<pub-id pub-id-type="pmid">22028628</pub-id></mixed-citation>
    </ref>
    <ref id="btz664-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lathe</surname>
 <given-names>W.C.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2000</year>) 
<article-title>Gene context conservation of a higher order than operons</article-title>. <source>Trends Biochem. Sci</source>., <volume>25</volume>, <fpage>474</fpage>–<lpage>479</lpage>.<pub-id pub-id-type="pmid">11050428</pub-id></mixed-citation>
    </ref>
    <ref id="btz664-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mistry</surname>
 <given-names>J.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2013</year>) 
<article-title>Challenges in homology search: hMMER3 and convergent evolution of coiled-coil regions</article-title>. <source>Nucleic Acids Res</source>., <volume>41</volume>, <fpage>e121.</fpage><pub-id pub-id-type="pmid">23598997</pub-id></mixed-citation>
    </ref>
    <ref id="btz664-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Parks</surname>
 <given-names>D.H.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2015</year>) 
<article-title>CheckM: assessing the quality of microbial genomes recovered from isolates, single cells, and metagenomes</article-title>. <source>Genome Res</source>., <volume>25</volume>, <fpage>1043</fpage>–<lpage>1055</lpage>.<pub-id pub-id-type="pmid">25977477</pub-id></mixed-citation>
    </ref>
    <ref id="btz664-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Parks</surname>
 <given-names>D.H.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2017</year>) 
<article-title>Recovery of nearly 8, 000 metagenome-assembled genomes substantially expands the tree of life</article-title>. <source>Nat. Microbiol</source>., <volume>2</volume>, <fpage>1533.</fpage><pub-id pub-id-type="pmid">28894102</pub-id></mixed-citation>
    </ref>
    <ref id="btz664-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rinke</surname>
 <given-names>C.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2013</year>) 
<article-title>Insights into the phylogeny and coding potential of microbial dark matter</article-title>. <source>Nature</source>, <volume>499</volume>, <fpage>431</fpage>–<lpage>437</lpage>.<pub-id pub-id-type="pmid">23851394</pub-id></mixed-citation>
    </ref>
    <ref id="btz664-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rogozin</surname>
 <given-names>I.B.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2002</year>) 
<article-title>Connected gene neighborhoods in prokaryotic genomes</article-title>. <source>Nucleic Acids Res</source>., <volume>30</volume>, <fpage>2212</fpage>–<lpage>2223</lpage>.<pub-id pub-id-type="pmid">12000841</pub-id></mixed-citation>
    </ref>
    <ref id="btz664-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Simão</surname>
 <given-names>F.A.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2015</year>) 
<article-title>BUSCO: assessing genome assembly and annotation completeness with single-copy orthologs</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>3210</fpage>–<lpage>3212</lpage>.<pub-id pub-id-type="pmid">26059717</pub-id></mixed-citation>
    </ref>
    <ref id="btz664-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tully</surname>
 <given-names>B.J.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2018</year>) 
<article-title>The reconstruction of 2, 631 draft metagenome-assembled genomes from the global oceans</article-title>. <source>Sci. Data</source>, <volume>5</volume>, <fpage>170203.</fpage><pub-id pub-id-type="pmid">29337314</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
