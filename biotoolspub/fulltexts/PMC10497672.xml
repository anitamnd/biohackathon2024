<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Int J Comput Assist Radiol Surg</journal-id>
    <journal-id journal-id-type="iso-abbrev">Int J Comput Assist Radiol Surg</journal-id>
    <journal-title-group>
      <journal-title>International Journal of Computer Assisted Radiology and Surgery</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1861-6410</issn>
    <issn pub-type="epub">1861-6429</issn>
    <publisher>
      <publisher-name>Springer International Publishing</publisher-name>
      <publisher-loc>Cham</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10497672</article-id>
    <article-id pub-id-type="pmid">37004646</article-id>
    <article-id pub-id-type="publisher-id">2881</article-id>
    <article-id pub-id-type="doi">10.1007/s11548-023-02881-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SlicerCBM: automatic framework for biomechanical analysis of the brain</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5994-061X</contrib-id>
        <name>
          <surname>Safdar</surname>
          <given-names>Saima</given-names>
        </name>
        <address>
          <email>saima.safdar@research.uwa.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zwick</surname>
          <given-names>Benjamin F.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yu</surname>
          <given-names>Yue</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bourantas</surname>
          <given-names>George C.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Joldes</surname>
          <given-names>Grand R.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Warfield</surname>
          <given-names>Simon K.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hyde</surname>
          <given-names>Damon E.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Frisken</surname>
          <given-names>Sarah</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kapur</surname>
          <given-names>Tina</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kikinis</surname>
          <given-names>Ron</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Golby</surname>
          <given-names>Alexandra</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nabavi</surname>
          <given-names>Arya</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wittek</surname>
          <given-names>Adam</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Miller</surname>
          <given-names>Karol</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.1012.2</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 7910</institution-id><institution>Intelligent Systems for Medicine Laboratory, </institution><institution>The University of Western Australia, </institution></institution-wrap>35 Stirling Highway, Perth, WA Australia </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.2515.3</institution-id><institution-id institution-id-type="ISNI">0000 0004 0378 8438</institution-id><institution>Computational Radiology Laboratory, </institution><institution>Boston Children’s Hospital, </institution></institution-wrap>Boston, MA USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.62560.37</institution-id><institution-id institution-id-type="ISNI">0000 0004 0378 8294</institution-id><institution>Brigham and Women’s Hospital, </institution></institution-wrap>Boston, MA USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.38142.3c</institution-id><institution-id institution-id-type="ISNI">000000041936754X</institution-id><institution>Harvard Medical School, </institution></institution-wrap>Boston, MA USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.413651.4</institution-id><institution-id institution-id-type="ISNI">0000 0000 9739 0850</institution-id><institution>Department of Neurosurgery, </institution><institution>KRH Klinikum Nordstadt, </institution></institution-wrap>Hannover, Germany </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="GRID">grid.11047.33</institution-id><institution-id institution-id-type="ISNI">0000 0004 0576 5395</institution-id><institution>Department of Agriculture, </institution><institution>University of Patras Nea Ktiria, </institution></institution-wrap>30200 Campus Mesologhi, Greece </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>1</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <year>2023</year>
    </pub-date>
    <volume>18</volume>
    <issue>10</issue>
    <fpage>1925</fpage>
    <lpage>1940</lpage>
    <history>
      <date date-type="received">
        <day>29</day>
        <month>9</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>3</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Purpose</title>
        <p id="Par1">Brain shift that occurs during neurosurgery disturbs the brain’s anatomy. Prediction of the brain shift is essential for accurate localisation of the surgical target. Biomechanical models have been envisaged as a possible tool for such predictions. In this study, we created a framework to automate the workflow for predicting intra-operative brain deformations.</p>
      </sec>
      <sec>
        <title>Methods</title>
        <p id="Par2">We created our framework by uniquely combining our meshless total Lagrangian explicit dynamics (MTLED) algorithm for computing soft tissue deformations, open-source software libraries and built-in functions within 3D Slicer, an open-source software package widely used for medical research. Our framework generates the biomechanical brain model from the pre-operative MRI, computes brain deformation using MTLED and outputs results in the form of predicted warped intra-operative MRI.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par3">Our framework is used to solve three different neurosurgical brain shift scenarios: craniotomy, tumour resection and electrode placement. We evaluated our framework using nine patients. The average time to construct a patient-specific brain biomechanical model was 3 min, and that to compute deformations ranged from 13 to 23 min. We performed a qualitative evaluation by comparing our predicted intra-operative MRI with the actual intra-operative MRI. For quantitative evaluation, we computed Hausdorff distances between predicted and actual intra-operative ventricle surfaces. For patients with craniotomy and tumour resection, approximately 95% of the nodes on the ventricle surfaces are within two times the original in-plane resolution of the actual surface determined from the intra-operative MRI.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par4">Our framework provides a broader application of existing solution methods not only in research but also in clinics. We successfully demonstrated the application of our framework by predicting intra-operative deformations in nine patients undergoing neurosurgical procedures.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Brain deformation</kwd>
      <kwd>Biomechanics</kwd>
      <kwd>Brain shift</kwd>
      <kwd>Framework</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Institute of Health NIH</institution>
        </funding-source>
        <award-id>R01EB027134</award-id>
        <principal-award-recipient>
          <name>
            <surname>Frisken</surname>
            <given-names>Sarah</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000070</institution-id>
            <institution>National Institute of Biomedical Imaging and Bioengineering</institution>
          </institution-wrap>
        </funding-source>
        <award-id>P41EB028741</award-id>
        <principal-award-recipient>
          <name>
            <surname>Kapur</surname>
            <given-names>Tina</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Health and Medical Research Council</institution>
        </funding-source>
        <award-id>APP1144519</award-id>
        <award-id>APP1162030</award-id>
        <principal-award-recipient>
          <name>
            <surname>Miller</surname>
            <given-names>Karol</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>University of Western Australia</institution>
        </funding-source>
      </award-group>
      <open-access>
        <p>Open Access funding enabled and organized by CAUL and its Member Institutions</p>
      </open-access>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© CARS 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par5">During neurosurgery, the brain undergoes significant deformation known as brain shift, making it challenging to precisely locate the surgical target, such as a tumour or epileptic seizure onset zone. Intra-operative magnetic resonance images (MRIs) can provide the location of the surgical target during neurosurgery. However, the cost of intra-operative magnetic resonance imaging scanners is high (over $10 million) [<xref ref-type="bibr" rid="CR1">1</xref>] and brain MRI acquisition takes a long time (about 45 to 60 min) [<xref ref-type="bibr" rid="CR2">2</xref>], which interferes with the surgical operation. Furthermore, intra-operative MRI cannot be acquired for patients with electrodes implanted within the brain in epilepsy surgery.</p>
    <p id="Par6">Brain shift, which refers to the significant deformation of the brain during neurosurgery, can be analysed in purely mechanical terms using established methods of continuum mechanics [<xref ref-type="bibr" rid="CR3">3</xref>]. To solve the equations of continuum solid mechanics, suites of computational biomechanics finite element and meshless algorithms [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>] exist to predict organ deformation, including brain deformations. An example is a suite of meshless total Lagrangian explicit dynamics (MTLED) algorithms based on the total Lagrangian formulation of nonlinear solid mechanics and explicit time domain integration [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR7">7</xref>] developed by our research group (Intelligent Systems for Medicine Lab). The MTLED algorithm has been extensively evaluated in previous studies for computing soft tissue deformations [<xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR9">9</xref>]. However, it is very sophisticated and requires specialised knowledge of computational biomechanics and numerical methods to set up a simulation. MTLED uses a cloud of points to discretise the problem domain. It is comparatively easy to generate a biomechanical model with a cloud of points rather than a high-quality finite element mesh but defining boundary conditions and loading and assigning material properties to intra-cranial constituents are still required.</p>
    <p id="Par7">In this study, we created a framework to automate the workflow for generating a patient-specific brain biomechanical model and computing the intra-operative deformations using the MTLED algorithm. We implemented our framework as an extension, SlicerCBM (Computational Biophysics for Medicine in 3D Slicer), for the 3D Slicer medical imaging platform [<xref ref-type="bibr" rid="CR10">10</xref>]. SlicerCBM is freely available from our GitHub repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/SlicerCBM/SlicerCBM">https://github.com/SlicerCBM/SlicerCBM</ext-link>). The framework computes brain deformations for three different neurosurgical brain shift scenarios: craniotomy-induced brain shift (due to opening of the skull), tumour resection-induced brain shift (due to removal of the tumour) and electrode placement-induced brain shift (due to placement of electrocorticography electrodes on the brain surface after craniotomy in epilepsy surgery). We evaluate our framework for predicting brain deformations for nine patients (Table <xref rid="Tab1" ref-type="table">1</xref>) undergoing three different neurosurgical brain shift scenarios. The data for this study were obtained from the databases of the Surgical Planning Laboratory (SPL) at Brigham and Women’s Hospital, Computational Radiology Laboratory (CRL) at Boston Children’s Hospital and Montreal Neurological Institute’s Brain Images of Tumours for Evaluation [<xref ref-type="bibr" rid="CR11">11</xref>].<table-wrap id="Tab1"><label>Table 1</label><caption><p>Pre-operative (pre-op), intra-operative (intra-op) and post-operative (post-op) patient data analysed in this study</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Case</th><th align="left">Application</th><th align="left">3D image data type</th><th align="left">Slice thickness (mm)</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">Craniotomy</td><td align="left">Pre-op MRI and intra-op MRI</td><td char="." align="char">2.5</td></tr><tr><td align="left">2</td><td align="left">Craniotomy</td><td align="left">Pre-op MRI and intra-op MRI</td><td char="." align="char">2.5</td></tr><tr><td align="left">3</td><td align="left">Craniotomy</td><td align="left">Pre-op MRI and intra-op MRI</td><td char="." align="char">2.5</td></tr><tr><td align="left">4</td><td align="left">Tumour resection</td><td align="left">Pre-op MRI and intra-op MRI</td><td char="." align="char">2.2</td></tr><tr><td align="left">5</td><td align="left">Tumour resection</td><td align="left">Pre-op MRI and post-op MRI</td><td char="." align="char">4.0</td></tr><tr><td align="left">6</td><td align="left">Tumour resection</td><td align="left">Pre-op MRI and post-op MRI</td><td char="." align="char">2.0</td></tr><tr><td align="left">7</td><td align="left">Tumour resection</td><td align="left">Pre-op MRI and post-op MRI</td><td char="." align="char">2.0</td></tr><tr><td align="left">8</td><td align="left">Electrode placement</td><td align="left">Pre-op MRI and post-op CT with electrodes implanted</td><td char="." align="char">0.7</td></tr><tr><td align="left">9</td><td align="left">Electrode placement</td><td align="left">Pre-op MRI and post-op CT with electrodes implanted</td><td char="." align="char">1.0</td></tr></tbody></table></table-wrap></p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <p id="Par8">Figure <xref rid="Fig1" ref-type="fig">1</xref> describes the workflow of our framework for craniotomy-induced and electrode placement-induced brain shift, whereas Fig. <xref rid="Fig2" ref-type="fig">2</xref> describes the workflow for tumour resection-induced brain shift. The developed framework modules corresponding to each component of the framework are discussed in Sects. "<xref rid="Sec4" ref-type="sec">Patient</xref>-<xref rid="Sec4" ref-type="sec">specific biomechanical model generation</xref>" to "<xref rid="Sec10" ref-type="sec">Image warping </xref>".<fig id="Fig1"><label>Fig. 1</label><caption><p>Workflow of our framework for generating and solving a patient-specific model of craniotomy and electrode placement-induced brain shift scenarios, <bold>a</bold> craniotomy and electrode placement-induced brain shift, <bold>b</bold> patient-specific computational grid generation, <bold>c</bold> model solution using meshless total Lagrangian explicit dynamic (MTLED) algorithm and <bold>d</bold> image warping</p></caption><graphic xlink:href="11548_2023_2881_Fig1_HTML" id="MO1"/></fig><fig id="Fig2"><label>Fig. 2</label><caption><p>Workflow of our framework for generating and solving a patient-specific model of tumour resection-induced brain shift scenarios, <bold>a</bold> tumour resection-induced brain shift, <bold>b</bold> patient-specific computational grid generation, <bold>c</bold> patient-specific computational grid generation (with tumour cavity), <bold>d</bold> model solution using meshless total Lagrangian explicit dynamic (MTLED) algorithm and <bold>e</bold> image warping</p></caption><graphic xlink:href="11548_2023_2881_Fig2_HTML" id="MO2"/></fig></p>
    <sec id="Sec3">
      <title>Image pre-processing</title>
      <p id="Par9">We used the rigid registration algorithm [<xref ref-type="bibr" rid="CR12">12</xref>] in the “GeneralRegistration” module of 3D Slicer to obtain the pre-operative brain anatomy in the intra-operative brain orientation. We automatically extracted the brain parenchyma (known as skull stripping) from the high-quality rigidly registered pre-operative MRI using the watershed algorithm of FreeSurfer (<ext-link ext-link-type="uri" xlink:href="http://surfer.nmr.mgh.harvard.ed">http://surfer.nmr.mgh.harvard.ed</ext-link>), an open-source software suite for analysing medical resonance images (MRIs) [<xref ref-type="bibr" rid="CR13">13</xref>]. Following skull stripping, the cropped pre-operative MRI contains only the brain tissues, tumour and ventricles. To segment the tumours, we used the “GrowfromSeeds” feature of 3D Slicer’s built-in module “SegmentEditor”, which utilises the “FastGrowCut” algorithm to generate a tumour mask [<xref ref-type="bibr" rid="CR10">10</xref>]. Generation of this tumour mask is automatic but may require corrections by an analyst. We used the tumour mask to locate the nodes and integration cells that represent a tumour within the brain (see Sect. "<xref rid="Sec5" ref-type="sec">Computational grid generator</xref>").</p>
    </sec>
    <sec id="Sec4">
      <title>Patient-specific biomechanical model generation</title>
      <sec id="Sec5">
        <title>Computational grid generator</title>
        <p id="Par10">To discretise the problem domain, which is the brain parenchyma extracted from the pre-operative MRI, we used a cloud of points. We developed a patient-specific tetrahedral integration grid using our "ComputationalGridGenerator" module, which takes the cropped pre-operative MRI as input and automatically generates the integration grid (Figs. <xref rid="Fig2" ref-type="fig">2</xref> and <xref rid="Fig3" ref-type="fig">3</xref>).<fig id="Fig3"><label>Fig. 3</label><caption><p>Workflow for automatic patient-specific brain integration grid generation within our 3D Slicer module <bold>a</bold> pre-operative MRI after skull stripping, <bold>b</bold> brain mask generation using threshold, <bold>c</bold> brain surface model generation using marching cubes algorithm, <bold>d</bold> brain surface model triangulation (yellow) using Voronoi clustering algorithm (yellow line around brain surface model (green) represents the brain triangulation) and <bold>e</bold> 3D tetrahedral integration grid (yellow) generation using 3D Delaunay algorithm</p></caption><graphic xlink:href="11548_2023_2881_Fig3_HTML" id="MO3"/></fig></p>
        <p id="Par11">The procedure implemented in our "ComputationalGridGenerator" module involves the following steps: first, it takes the pre-operative MRI after skull stripping and generates a brain mask using Kittler-Illingworth [<xref ref-type="bibr" rid="CR14">14</xref>] thresholding algorithm. Next, it generates a brain surface model using the marching cubes algorithm [<xref ref-type="bibr" rid="CR15">15</xref>]. Then, it generates a uniformly triangulated brain surface using the Voronoi clustering algorithm [<xref ref-type="bibr" rid="CR16">16</xref>] of PyACVD (<ext-link ext-link-type="uri" xlink:href="https://github.com/pyvista/pyacvd">https://github.com/pyvista/pyacvd</ext-link>). Finally, it generates a tetrahedral grid using the 3D Delaunay algorithm of Gmsh [<xref ref-type="bibr" rid="CR17">17</xref>]. To smooth the brain surface, we used the Laplacian filter [<xref ref-type="bibr" rid="CR18">18</xref>] (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). It is crucial to understand that the tetrahedral integration cells are not finite elements and do not have to adhere to the strict quality requirements of a finite element mesh. Table <xref rid="Tab2" ref-type="table">2</xref> lists the number of nodes, integration cells and integration points generated using our “ComputationalGridGenerator” module for all nine patients.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Summary of computational grids generated with respect to the patient-specific brain</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Case</th><th align="left">No. of nodes</th><th align="left">No. of integration cells</th><th align="left">No. of integration points</th></tr></thead><tbody><tr><td align="left">1</td><td char="," align="char">33,273</td><td char="," align="char">141,935</td><td char="," align="char">567,740</td></tr><tr><td align="left">2</td><td char="," align="char">40,767</td><td char="," align="char">169,026</td><td char="," align="char">676,104</td></tr><tr><td align="left">3</td><td char="," align="char">49,195</td><td char="," align="char">210,196</td><td char="," align="char">840,784</td></tr><tr><td align="left">4</td><td char="," align="char">22,507</td><td char="," align="char">119,170</td><td char="," align="char">119,170</td></tr><tr><td align="left">5</td><td char="," align="char">24,675</td><td char="," align="char">129,486</td><td char="," align="char">129,486</td></tr><tr><td align="left">6</td><td char="," align="char">26,189</td><td char="," align="char">136,825</td><td char="," align="char">136,825</td></tr><tr><td align="left">7</td><td char="," align="char">23,961</td><td char="," align="char">126,417</td><td char="," align="char">126,417</td></tr><tr><td align="left">8</td><td char="," align="char">33,363</td><td char="," align="char">136,477</td><td char="," align="char">545,908</td></tr><tr><td align="left">9</td><td char="," align="char">21,788</td><td char="," align="char">55,470</td><td char="," align="char">221,880</td></tr></tbody></table></table-wrap></p>
        <p id="Par12">To predict the tumour resection-induced brain shift, a computational grid of the brain with a tumour cavity is required. This grid is used to apply traction forces at the boundary of the tumour cavity, as described in our previous study [<xref ref-type="bibr" rid="CR9">9</xref>]. To automate the construction of a brain computational grid with a tumour cavity, we developed the "TumourResectionAndBrainRemodelling" module (shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>). This module takes the brain computational grid and the tumour mask as inputs, and identifies the nodes within the tumour mask to generate a brain computational grid with a tumour cavity. The coordinates of these identified nodes are saved and used to construct the new brain computational grid with the tumour cavity.<fig id="Fig4"><label>Fig. 4</label><caption><p>Procedure for generating a brain computational grid with tumour cavity as implemented in our module “TumourResectionAndBrainRemodelling”</p></caption><graphic xlink:href="11548_2023_2881_Fig4_HTML" id="MO4"/></fig></p>
      </sec>
      <sec id="Sec6">
        <title>Brain–skull contact interface</title>
        <p id="Par13">To account for the difference in stiffness between the skull and brain tissues, a frictionless sliding contact interface is defined between the rigid skull surface and the deformable brain model in neurosurgical brain shift scenarios. This approach prevents brain nodes from penetrating the skull while allowing the brain to slide along the inner surface of the skull [<xref ref-type="bibr" rid="CR19">19</xref>].</p>
        <p id="Par14">To define the contacts automatically, we developed our module “SkullGenerator” to construct a skull surface model using the triangulated brain surface model generated in Sect. "<xref rid="Sec5" ref-type="sec">Computational grid generator</xref>"; and to extract the brain surface nodes in contact with the skull surface model.</p>
      </sec>
      <sec id="Sec7">
        <title>Loading</title>
        <p id="Par15">In craniotomy-induced and electrode placement-induced brain shift, loading is defined as prescribed displacements on the exposed part of the brain due to neurosurgical procedures. In tumour resection-induced brain shift, loading is defined as gravity forces. To define the load, information about the deformation of the exposed brain surface can be obtained using cameras or the pointing tool of a neurosurgical station [<xref ref-type="bibr" rid="CR20">20</xref>]. In this study, we acquire such information using sparse intra-operative MRI. To define the prescribed loading, selection of the exposed surface area of the brain is an essential step. Our automated procedure for selecting brain surface nodes exposed due to craniotomy is implemented in the modules “CranGenerator” and “NodeSelector”, which streamlines the process of identifying loaded nodes. It comprises the following steps (Fig. <xref rid="Fig5" ref-type="fig">5</xref>): (1) auto-thresholding is used to select the patient’s head in pre-/intra-operative MRIs to create a pre-/intra-operative head mask, (2) wrap solidify effect is used to shrink wrap [<xref ref-type="bibr" rid="CR10">10</xref>] and remove any gaps in pre-/intra-operative head masks generated in step 1, (3) Gaussian smoothing (3 mm) is used to smooth the created head masks, and Island filter [<xref ref-type="bibr" rid="CR10">10</xref>] is used to remove small islands (1000 voxels), (4) logical operator (subtract) is used to create a craniotomy region mask, (5) marching cubes algorithm [<xref ref-type="bibr" rid="CR15">15</xref>] is used to generate the craniotomy surface model, and (6) brain surface cells exposed due to craniotomy are selected using the craniotomy surface model from step 5, and finally, the brain surface nodes are selected.<fig id="Fig5"><label>Fig. 5</label><caption><p>Procedure for automatically creating a craniotomy region and selecting brain surface nodes exposed due to craniotomy</p></caption><graphic xlink:href="11548_2023_2881_Fig5_HTML" id="MO5"/></fig></p>
        <p id="Par16">To compute the prescribed displacements for the selected brain surface nodes, we use a procedure that involves several steps. Firstly, we extract sparse pre-operative and intra-operative MRI information, which we then use to compute the B-Spline transform using a rigid registration algorithm [<xref ref-type="bibr" rid="CR12">12</xref>]. Secondly, we apply the B-Spline transform to the selected brain surface nodes that are exposed due to craniotomy, resulting in the position of the brain surface nodes in an intra-operative (deformed) brain configuration. Finally, we compute the prescribed displacements by calculating the difference between the coordinates of the brain surface nodes in the deformed brain configuration and those in the undeformed configuration. This procedure enables us to accurately determine the necessary displacement values for the nodes on the brain surface, which is crucial for simulating the deformation of the brain during neurosurgery.</p>
        <p id="Par17">For electrode placement-induced brain shift, we extracted the electrode locations (coordinates) from the computed tomography (CT) image using our electrode extraction procedure implemented as “ElectrodesToMarkups” module. The steps involved in our electrode extraction procedure are: (1) creating a binary label volume from binary CT image using PolySeg software library, (2) splitting the binary label volume into segments corresponding to each electrode using the “SplitIsland” filter and (3) adding a point (3D space) at the centroid of each segmented electrode using “SegmentStatistics” [<xref ref-type="bibr" rid="CR10">10</xref>]. After extracting electrode locations from the CT image, prescribed displacements are computed using our automated procedure, which comprises the following steps (Fig. <xref rid="Fig6" ref-type="fig">6</xref>): (1) projection of electrodes on the undeformed brain surface extracted from pre-operative MRI, (2) creating the electrode sheet model (representing the silastic substrate of the electrocorticography electrode grid placed on the brain surface in epilepsy surgery) using the projected electrodes, (3) selecting brain surface nodes (known as loaded nodes) under the electrode sheet model and (4) computing prescribed displacements.<fig id="Fig6"><label>Fig. 6</label><caption><p>Procedure for selecting brain surface nodes under electrode sheet and computing the prescribed displacements</p></caption><graphic xlink:href="11548_2023_2881_Fig6_HTML" id="MO6"/></fig></p>
        <p id="Par18">In step 1, we projected the extracted electrodes onto the surface of the brain extracted from the pre-operative MRI using our “MarkUpsToDistance” module. This module determines the points corresponding to the location of electrodes (referred to as projected electrodes) in the undeformed (pre-operative) brain configuration. The module uses the “ImplicitPolyDataDistance” method of the Visualization Toolkit (VTK) [<xref ref-type="bibr" rid="CR21">21</xref>] to compute the distance for each of the electrodes identified in the post-operative CT to its corresponding nearest triangle on the undeformed brain surface. We created projected electrode locations at the centroids of the identified nearest triangles on the undeformed brain surface (extracted from pre-operative MRI). In step 2, we used these projected electrode locations to create an electrode sheet model by means of the PolyData algorithm [<xref ref-type="bibr" rid="CR22">22</xref>], implemented in our “SheetFromPoints” module. We uniformly triangulated the electrode surface sheet model using the PyACVD software library (<ext-link ext-link-type="uri" xlink:href="https://github.com/pyvista/pyacvd">https://github.com/pyvista/pyacvd</ext-link>) implemented in our module “SurfaceTriangulation”. In step 3, we used the vertices of each triangle of the electrode sheet model to select the corresponding brain surface cells (triangles) in the undeformed brain surface model using our “NodeSelector” module. We used the selected brain surface cells to select the corresponding nodes (vertices) of these selected brain surface cells. We applied prescribed displacements on the selected nodes of the selected triangles. In step 4, to compute prescribed displacements, the original and projected electrode coordinates were used as an input to the “ScatteredTransform” [<xref ref-type="bibr" rid="CR23">23</xref>] module to compute a B-Spline transform. We applied the computed B-Spline transform to the undeformed brain surface nodes located under the electrode sheet to determine the position of the corresponding nodes in the deformed (due to electrode implantation) brain geometry. We computed the prescribed displacements as the difference between the coordinates of the corresponding brain surface nodes in undeformed and deformed brain geometry. The prescribed displacements were applied using a smooth (3-4-5 polynomial) loading curve [<xref ref-type="bibr" rid="CR24">24</xref>].</p>
        <p id="Par19">In tumour resection-induced brain shift scenarios, we consider the load as a gravity force and calculate the internal forces acting at the interface nodes between the tumour and nearby healthy brain tissues. Once the tumour is removed from the biomechanical model, the reaction forces are applied in the opposite direction to the interface nodes. This approach allows us to simulate the deformation of the brain tissue caused by the tumour and its subsequent removal during surgery.</p>
      </sec>
      <sec id="Sec8">
        <title>Assignment of material properties using fuzzy tissue classification</title>
        <p id="Par20">In patient-specific computational biomechanics modelling, the material properties are typically assigned using image segmentation [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>], where each image voxel is assigned to a specific brain tissue class using semi-automatic procedures. However, this process is time-consuming and clinically incompatible [<xref ref-type="bibr" rid="CR25">25</xref>]. We used fuzzy tissue classification [<xref ref-type="bibr" rid="CR27">27</xref>] to automatically assign material properties of intra-cranial constituents to integration points within the problem domain. To assign material properties to brain tissues, we used our “FuzzyClassification” module that takes a brain mask (see generated brain mask in Sect. "<xref rid="Sec5" ref-type="sec">Computational grid generator</xref>"), pre-operative MRI and tumour mask (if present) as inputs and produces fuzzy classified brain tissue classes, which are used by our “MaterialPropertiesAssignment” module to automatically assign material properties to integration points corresponding to brain constituents.</p>
        <p id="Par21">For all nine case studies, we used a mass density of 1000 kg/m<sup>3</sup> for all tissue types. Craniotomy and electrode placement-induced brain shift simulations correspond to a subclass of problems known as “displacement–zero traction” problems, where the load is defined by prescribing the displacement on the boundary, and we do not know anything about the deformation field within the analysed continuum. Problems of this type depend very weakly on the material properties and material model. Therefore, we used a neo-Hookean constitutive model, with initial Young’s modulus <italic>E</italic>, and initial Poisson’s ratio <italic>ν</italic>, listed in Table <xref rid="Tab3" ref-type="table">3</xref> [<xref ref-type="bibr" rid="CR26">26</xref>].<table-wrap id="Tab3"><label>Table 3</label><caption><p>Neo-Hookean material model parameters for each tissue type in the biomechanical brain model used for computing craniotomy and electrode placement-induced brain shift</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Tissue type</th><th align="left"><italic>ρ</italic> (kg/m3)</th><th align="left"><italic>E</italic> (Pa)</th><th align="left"><italic>ν</italic></th></tr></thead><tbody><tr><td align="left">Parenchyma</td><td align="left">1000</td><td char="." align="char">3000</td><td char="." align="char">0.49</td></tr><tr><td align="left">Tumour</td><td align="left">1000</td><td char="." align="char">9000</td><td char="." align="char">0.49</td></tr><tr><td align="left">Ventricle</td><td align="left">1000</td><td char="." align="char">10</td><td char="." align="char">0.1</td></tr></tbody></table></table-wrap></p>
        <p id="Par22">Poisson’s ratio is a mechanical property that describes the compressibility of a material. A low Poisson’s ratio suggests strong compressibility, whereas a high Poisson’s ratio of 0.5 indicates that the material is fully incompressible. We consider the parenchyma of the brain to be a nearly incompressible structure [<xref ref-type="bibr" rid="CR28">28</xref>]. In the tumour resection-induced brain shift, since the load is due to gravity and traction forces, the computed deformations depend on the tissue “stiffness” as determined by the material properties and material model. Therefore, an Ogden constitutive model is used, with shear modulus <italic>µ</italic>, initial Poisson’s ratio <italic>ν</italic> and material parameter <italic>α</italic>, listed in Table <xref rid="Tab4" ref-type="table">4</xref> [<xref ref-type="bibr" rid="CR29">29</xref>], because it adequately accounts for the brain tissue material properties under both tension and compression. The shear modulus for the tumour was assigned a value three times larger than that of healthy brain tissue [<xref ref-type="bibr" rid="CR28">28</xref>].<table-wrap id="Tab4"><label>Table 4</label><caption><p>Ogden material model parameters for different tissue types (CSF, parenchyma, tumour) in the biomechanical brain model used for computing brain shift due to tumour resection. Note that for α = 2 the Ogden model is similar to the neo-Hookean model</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Tissue type</th><th align="left"><italic>µ</italic> (Pa)</th><th align="left"><italic>ν</italic></th><th align="left"><italic>α</italic></th></tr></thead><tbody><tr><td align="left">Parenchyma</td><td align="left">842</td><td char="." align="char">0.49</td><td align="left">− 4.7</td></tr><tr><td align="left">Tumour</td><td align="left">2526</td><td char="." align="char">0.49</td><td align="left">− 4.7</td></tr><tr><td align="left">CSF (case 4)</td><td align="left">4.54</td><td char="." align="char">0.1</td><td align="left">2</td></tr><tr><td align="left">CSF (cases 5, 6, 7)</td><td align="left">4.54</td><td char="." align="char">0.49</td><td align="left">2</td></tr></tbody></table></table-wrap></p>
      </sec>
    </sec>
    <sec id="Sec9">
      <title>Model solution</title>
      <p id="Par23">To compute brain deformations using MTLED, we developed the “MTLEDSolver” module that uses the meshless total Lagrangian explicit dynamics (MTLED) algorithms [<xref ref-type="bibr" rid="CR5">5</xref>]. The module predicts intra-operative deformations and generates a solution in the form of a deformed brain biomechanical model. The MTLED solution algorithm is described in detail in our previous studies [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR7">7</xref>]. MTLED solves the weak form of the elasticity equations and can be used with different shape functions, including moving least squares (MLS) [<xref ref-type="bibr" rid="CR5">5</xref>], modified moving least squares (MMLS) [<xref ref-type="bibr" rid="CR7">7</xref>] and interpolating modified moving least squares (IMMLS) [<xref ref-type="bibr" rid="CR30">30</xref>]. The methodology for computing brain deformations has been extensively validated in our previous studies [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR31">31</xref>]. We use IMMLS shape functions [<xref ref-type="bibr" rid="CR30">30</xref>] as they accurately enforce the essential boundary conditions and provide robust computations for large deformations and strains.</p>
    </sec>
    <sec id="Sec10">
      <title>Image warping</title>
      <p id="Par24">To perform image warping, we extracted undeformed and predicted deformed brain model nodal coordinates and used the “ScatteredTransform” module [<xref ref-type="bibr" rid="CR23">23</xref>] to compute a B-Spline transform which is used to warp the pre-operative MRI to obtain the predicted intra-operative MRI.</p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Results</title>
    <p id="Par25">In this section, we apply our framework to solve three neurosurgical brain shift scenarios: craniotomy, tumour resection and electrode placement-induced brain shift.</p>
    <sec id="Sec12">
      <title>Methods for evaluating predicted intra-operative deformations by our framework</title>
      <p id="Par26">We evaluated our framework qualitatively and quantitatively by analysing the predicted intra-operative MRI and the actual intra-operative MRI of nine patients. For qualitative evaluation, we visually compared the predicted brain contour with the actual intra-operative brain contour. For quantitative evaluation, following [<xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR32">32</xref>], we use the Hausdorff distance (HD) to objectively measure the differences between the ventricle surfaces of the brain predicted by our framework using the MTLED algorithm and the ventricle surfaces obtained by segmentation of the actual intra-operative MRI.</p>
      <p id="Par27">The purpose of this study is to create a framework for automating the workflow for predicting intra-operative brain deformations rather than to conduct evaluation of the framework performance using patient cohort sufficiently large for comprehensive statistical analysis. We have made our open-source framework freely available through GitHub, which opens avenues for other research groups to use the framework and conduct its independent evaluation. In this study, we demonstrate the application of the framework by predicting intra-operative deformations in nine patients undergoing neurosurgical procedures. Given this relatively small cohort size, we conduct only rudimentary statistical analysis of the results by reporting the average and standard deviation of the percentage of successfully registered points/nodes (i.e. the nodes for which the registration error is lower than twice the in-plane resolution of the intra-operative image).</p>
    </sec>
    <sec id="Sec13">
      <title>Craniotomy-induced brain shift</title>
      <sec id="Sec14">
        <title>Qualitative evaluation</title>
        <p id="Par28">The pre-operative MRI was warped to obtain the predicted intra-operative MRI using the B-Spline transformation described in Sect. "<xref rid="Sec10" ref-type="sec">Image warping</xref>" such that it corresponds to the actual intra-operative anatomy of the brain. We visually compared the brain contour predicted by our framework (from a warped pre-operative MRI) with the actual intra-operative MRI. The ventricle contours predicted by our automated framework (Fig. <xref rid="Fig7" ref-type="fig">7</xref>) for case studies 1, 2 and 3 are very close to the actual intra-operative ventricle contours.<fig id="Fig7"><label>Fig. 7</label><caption><p>Intra-operative MRI overlaid with contours (red) of the deformed ventricle and brain extracted from the predicted intra-operative MRI which is obtained by warping the pre-operative MRI with the computed transform. Comparison of the brain contours (red) from the predicted intra-operative MRI along with the brain contours (green) extracted from the pre-operative MRI. Predicted red ventricle contours and intra-operative ventricle contours in yellow</p></caption><graphic xlink:href="11548_2023_2881_Fig7_HTML" id="MO7"/></fig></p>
      </sec>
      <sec id="Sec15">
        <title>Quantitative evaluation</title>
        <p id="Par29">We used the 95th, 75th, 50th and 25th percentile HD to measure the similarities between the actual ventricle surfaces (obtained from segmentation of actual pre-/post-operative MRIs) and the predicted ventricle surfaces (obtained from the segmentation of the predicted MRIs, see Table <xref rid="Tab5" ref-type="table">5</xref>). The image resolution limits the precision of neurosurgical image guidance. Therefore, registration is considered successful if the 95% HD is lower than twice the actual in-plane resolution of the intra-operative MRI (2.5 mm, 1 mm and 2.5 mm for case studies 1, 2 and 3, respectively). For case studies 1, 2 and 3, about 96%, 98% and 99% of the nodes on the ventricle surfaces, respectively, were successfully registered (Fig. <xref rid="Fig8" ref-type="fig">8</xref>). The results obtained using our automated framework are very close to those reported in our previous studies [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR26">26</xref>] (see Table <xref rid="Tab5" ref-type="table">5</xref>). The mean 95th percentile Hausdorff distance between the ventricle surfaces for the three craniotomy-induced brain shift case studies is 1.9 mm with a standard deviation (SD) of 0.464 mm. This means that the overall agreement between the ventricles is reasonably good, with most of the points falling within one standard deviation of the mean.<table-wrap id="Tab5"><label>Table 5</label><caption><p>Quantitative evaluation for craniotomy-induced brain shift. 95th, 75th, 50th and 25th percentile (millimetres) of HD between the predicted and actual ventricle surfaces. The 95% HD was utilised as the measure of registration error. The results are compared to finite element and MTLED results from our previous studies [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR26">26</xref>]</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Case</th><th align="left">H95 (mm)</th><th align="left">H75 (mm)</th><th align="left">H50 (mm)</th><th align="left">H25 (mm)</th></tr></thead><tbody><tr><td align="left">1</td><td char="." align="char">1.7</td><td align="left">0.9</td><td align="left">0.5</td><td align="left">0.2</td></tr><tr><td align="left">1 [<xref ref-type="bibr" rid="CR32">32</xref>]</td><td char="." align="char">1.3</td><td align="left">0.6</td><td align="left">0.4</td><td align="left">0.3</td></tr><tr><td align="left">2</td><td char="." align="char">1.5</td><td align="left">0.9</td><td align="left">0.5</td><td align="left">0.2</td></tr><tr><td align="left">2 [<xref ref-type="bibr" rid="CR32">32</xref>]</td><td char="." align="char">2.8</td><td align="left">1.2</td><td align="left">0.8</td><td align="left">0.4</td></tr><tr><td align="left">2 [<xref ref-type="bibr" rid="CR10">10</xref>]</td><td char="." align="char">1.4</td><td align="left">N/A</td><td align="left">N/A</td><td align="left">N/A</td></tr><tr><td align="left">3</td><td char="." align="char">2.5</td><td align="left">0.6</td><td align="left">0.3</td><td align="left">0.2</td></tr><tr><td align="left">3 [<xref ref-type="bibr" rid="CR32">32</xref>]</td><td char="." align="char">1.9</td><td align="left">1.1</td><td align="left">0.6</td><td align="left">0.4</td></tr></tbody></table></table-wrap><fig id="Fig8"><label>Fig. 8</label><caption><p>Hausdorff distance between predicted and actual intra-operative ventricles at different percentiles. The in-plane resolution of the intra-operative image for all patients is indicated by the red line. <bold>a</bold> For patient 1, the acceptable registration error is 2.5 mm, which corresponds to 96-percentile HD, <bold>b</bold> for patient 2, the acceptable registration error is 1 mm, which corresponds to 98-percentile HD, and <bold>c</bold> for patient 3, the acceptable registration error is 2.5 mm, corresponds to 99-percentile HD</p></caption><graphic xlink:href="11548_2023_2881_Fig8_HTML" id="MO8"/></fig></p>
      </sec>
    </sec>
    <sec id="Sec16">
      <title>Tumour resection-induced brain shift</title>
      <sec id="Sec17">
        <title>Qualitative evaluation</title>
        <p id="Par30">For case study 4, the predicted intra-operative brain contour extracted from the predicted intra-operative MRIs was compared to the actual intra-operative MRI brain contour (Fig. <xref rid="Fig9" ref-type="fig">9</xref>). Likewise, we qualitatively evaluated our framework’s predicted contours of the brain parenchyma extracted from predicted post-operative MRIs for case studies 5, 6 and 7 to the actual brain contours extracted from the actual post-operative MRI (Fig. <xref rid="Fig9" ref-type="fig">9</xref>). The predicted maximum displacement observed in case studies 4, 5, 6 and 7, was 11 mm, 7 mm, 7.2 mm and 6.5 mm, respectively.<fig id="Fig9"><label>Fig. 9</label><caption><p>Intra-operative (case 4) and post-operative (cases 5, 6 and 7) MRIs overlaid with brain and tumour contours. The yellow in the tumour region denotes the pre-operative tumour cavity, whereas the green denotes the true intra-operative tumour cavity in case 4 and the post-operative tumour cavity in cases 5, 6 and 7. For the brain contours, yellow denotes pre-operative brain contour, green represents intra-operative brain contour for case 4 and post-operative brain contour for cases 5, 6 and 7, and red denotes predicted brain contour</p></caption><graphic xlink:href="11548_2023_2881_Fig9_HTML" id="MO9"/></fig></p>
      </sec>
      <sec id="Sec18">
        <title>Quantitative evaluation</title>
        <p id="Par31">We used the 95th, 75th, 50th and 25th percentile HD to measure the similarities between the actual ventricle and the predicted ventricle surfaces (Table <xref rid="Tab6" ref-type="table">6</xref>). Registration is considered successful if the 95% HD is lower than twice the actual in-plane resolution of the intra-operative MRI (2.4 mm, 2 mm, 4 mm and 2 mm for case studies 4, 5, 6 and 7, respectively). For case study 4, about 77% of the nodes on the ventricle surfaces were successfully registered. For case studies 5, 6 and 7, about 92%, 99% and 89% of the nodes on the ventricle surfaces, respectively, were successfully registered (Fig. <xref rid="Fig10" ref-type="fig">10</xref>). The mean 95th percentile Hausdorff distance between the ventricle surfaces for the four tumour resection-induced brain shift case studies is 3.1 mm (SD = 0.842 mm). This shows that the overall agreement between the ventricles is reasonably good, with most points falling within one standard deviation of the mean. However, the slightly higher values of mean HD indicate that the tumour resection-induced brain shift is more difficult to compensate for than craniotomy-induced brain shift.<table-wrap id="Tab6"><label>Table 6</label><caption><p>Quantitative evaluation for tumour resection-induced brain shift. 95th, 75th, 50th and 25th percentile (millimetres) of HD between the predicted and actual ventricle surfaces</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Case</th><th align="left">H95 (mm)</th><th align="left">H75 (mm)</th><th align="left">H50 (mm)</th><th align="left">H25 (mm)</th></tr></thead><tbody><tr><td align="left">4</td><td char="." align="char">4.10</td><td char="." align="char">2.29</td><td char="." align="char">1.27</td><td char="." align="char">0.58</td></tr><tr><td align="left">5</td><td char="." align="char">2.67</td><td char="." align="char">1.15</td><td char="." align="char">0.62</td><td char="." align="char">0.27</td></tr><tr><td align="left">6</td><td char="." align="char">2.34</td><td char="." align="char">1.26</td><td char="." align="char">0.68</td><td char="." align="char">0.33</td></tr><tr><td align="left">7</td><td char="." align="char">3.44</td><td char="." align="char">1.01</td><td char="." align="char">0.54</td><td char="." align="char">0.25</td></tr></tbody></table></table-wrap><fig id="Fig10"><label>Fig. 10</label><caption><p>Hausdorff distance between predicted and actual intra-operative ventricles at different percentiles. The in-plane resolution of the intra-operative image for all patients is indicated by the red line. <bold>a</bold> For patient 4, the acceptable registration error is 2.4 mm, corresponding to 78-percentile HD, <bold>b</bold> for patient 5, the acceptable registration error is 2 mm, corresponding to 92-percentile HD, <bold>c</bold> for patient 6, the acceptable registration error is 4 mm, corresponding to 99-percentile HD, and <bold>d</bold> for patient 7, the acceptable registration error is 2 mm, corresponding to 89-percentile HD</p></caption><graphic xlink:href="11548_2023_2881_Fig10_HTML" id="MO10"/></fig></p>
      </sec>
    </sec>
    <sec id="Sec19">
      <title>Electrode placement-induced brain shift</title>
      <p id="Par32">The predicted maximum displacement in case studies 8 and 9 was 11.7 mm and 21.5 mm, respectively. Using the deformation field predicted by our framework, we warped the pre-operative MRI to obtain the corresponding brain configuration with electrodes implanted. We used the “Scattered Transform” module [<xref ref-type="bibr" rid="CR23">23</xref>] to obtain the transform for image warping. Figure <xref rid="Fig11" ref-type="fig">11</xref> shows the computed deformation field of case 8 (Fig. <xref rid="Fig11" ref-type="fig">11</xref>a) and case 9 (Fig. <xref rid="Fig11" ref-type="fig">11</xref>b). Figure <xref rid="Fig11" ref-type="fig">11</xref> shows the transforms used to warp the pre-operative MRI of case 8 (Fig. <xref rid="Fig12" ref-type="fig">12</xref>a) and case 9 (Fig. <xref rid="Fig12" ref-type="fig">12</xref>b). The results of the registration are shown in Fig. <xref rid="Fig13" ref-type="fig">13</xref>a for case 8 and in Fig. <xref rid="Fig13" ref-type="fig">13</xref>b for case 9.<fig id="Fig11"><label>Fig. 11</label><caption><p>Visualisation of deformation field computed using our automated framework for cases 8 and 9</p></caption><graphic xlink:href="11548_2023_2881_Fig11_HTML" id="MO11"/></fig><fig id="Fig12"><label>Fig. 12</label><caption><p>Visualisation of pre-operative image transformation for cases 8 and 9 using deformation field from Fig. <xref rid="Fig10" ref-type="fig">10</xref>a and b, respectively, and predicted deformed brain model surface (red line) overlaid with predicted image</p></caption><graphic xlink:href="11548_2023_2881_Fig12_HTML" id="MO12"/></fig><fig id="Fig13"><label>Fig. 13</label><caption><p>Visualisation of predicted intra-operative MRIs for case 8 and case 9 registered on CT with implanted intra-cranial electrodes along with predicted deformed brain model surface (red line)</p></caption><graphic xlink:href="11548_2023_2881_Fig13_HTML" id="MO13"/></fig></p>
    </sec>
    <sec id="Sec20">
      <title>Computational efficiency</title>
      <p id="Par33">The simulations were performed on an HP Pro-Book laptop with an Intel Core i7 (2.7 GHz) processor and 8 GB physical memory. The time required to automatically generate a patient-specific brain biomechanical model using our framework was less than 3 min for each case. However, in tumour resection, there is an additional step of the construction of a brain model with a tumour cavity, which takes approximately 20 min. The solution to the biomechanical models ranged from 13 to 23 min.</p>
    </sec>
  </sec>
  <sec id="Sec21">
    <title>Discussion and conclusion</title>
    <p id="Par34">We developed a framework to automatically generate a brain biomechanical model and compute intra-operative brain deformations. Our framework, SlicerCBM, is implemented as an extension in 3D Slicer, freely open-source software, and contains modules that can be used in combination to solve three neurosurgical brain shift scenarios: craniotomy, tumour resection and electrode placement-induced brain shift. The main modules of the framework are “ComputationalGridGenerator” to generate a patient-specific computational grid, “CranGenerator” to create a craniotomy model, “SurfaceTriangulation” to generate a uniformly triangulated surface (craniotomy and electrode sheet), “ElectrodeToMarkups” to extract the original electrode locations from CT, “MarkUpsToDistance” to create the projected electrode locations on the undeformed brain surface, “SheetFromPoints” to generate an electrode sheet model, “NodeSelector” to select the exposed brain surface due to a neurosurgical procedure, “DisplacementLoading” to compute loading, “SkullGenerator” to define the boundary conditions, “FuzzyClassification” and “MaterialPropertiesAssignment” to assign material properties to intra-cranial constituents and “MTLEDSolver” to compute brain deformations. These modules uniquely combine various algorithms working behind 3D Slicer modules and open-source software libraries. The “MTLEDSolver” module integrates our MTLED algorithm to provide an interface to this robust and efficient solution algorithm.</p>
    <p id="Par35">We evaluated the accuracy of our framework by performing nine simulations belonging to three neurosurgical brain shift scenarios. For craniotomy and tumour resection, the actual ventricle contours (yellow) and the ventricle contours predicted by our framework (red) show good similarity (Figs. <xref rid="Fig7" ref-type="fig">7</xref> and <xref rid="Fig9" ref-type="fig">9</xref>). The 95% HD for ventricles surfaces for all case studies is less than two times the original in-plane resolution of the intra-operative MRI, which confirms successful registration. The 95% HD of the ventricle surfaces between the predicted and actual intra-operative MRIs for case study 2, between the results produced by our automated framework and the results obtained in our previous studies [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR26">26</xref>], is less than 0.1 mm. The results obtained using our automated framework are very close to those reported in our previous studies [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR26">26</xref>].</p>
    <p id="Par36">Our framework needs further verification against large cohort patient studies. Furthermore, the quantitative evaluation of displacements for electrode placement-induced brain shift was not possible due to the lack of intra-operative MRI data, as MRIs with electrodes implanted within the brain cannot be obtained for patient safety reasons. Our framework has significant potential for clinical applications. Qualitative and quantitative comparisons of ventricle surfaces in predicted and intra-operative MRIs for craniotomy and tumour resection-induced brain shift, and qualitative comparisons of brain contours for electrode placement-induced brain shift, lead us to conclude that the results are accurate enough to be useful in clinical applications because the accuracy of the results that we obtained for all case studies is within the limits typically required in image-guided surgery [<xref ref-type="bibr" rid="CR33">33</xref>].</p>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <p>This work was supported in part by the National Health and Medical Research Council (NHMRC) Project Grants APP1144519 and APP1162030, Australian Research Council (ARC) Discovery Project Grants DP230100949 and DP160100714, National Institutes of Health (NIH) Grants R01EB027134, P41EB028741, R01EB032387, P41EB015902 (NAC), P41EB028741 (AT-NCIGT) and R01CA235589 (LNQ), and National Cancer Data Ecosystem, Task Order No. 413 HHSN26110071 under Contract No. HHSN261201500003I. The first author is a recipient of the University Post-graduate Award (UPA) at The University of Western Australia.</p>
  </ack>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Open Access funding enabled and organized by CAUL and its Member Institutions.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>The software developed as part of this study is bundled as the SlicerCBM extension for 3D Slicer and is freely available from our GitHub repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/SlicerCBM/SlicerCBM">https://github.com/SlicerCBM/SlicerCBM</ext-link>).</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1" notes-type="COI-statement">
      <title>Conflict of interest</title>
      <p id="Par37">All the authors declare that they have no conflict of interest.</p>
    </notes>
    <notes id="FPar2">
      <title>Informed consent</title>
      <p id="Par38">There was no informed consent required for the work reported in this manuscript.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shah</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Leonard</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Inder</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Geske</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Haydon</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Omodon</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Evans</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Morales</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Dacey</surname>
            <given-names>RG</given-names>
          </name>
        </person-group>
        <article-title>Intraoperative magnetic resonance imaging to reduce the rate of early reoperation for lesion resection in pediatric neurosurgery</article-title>
        <source>J Neurosurg Pediatr</source>
        <year>2012</year>
        <volume>9</volume>
        <issue>3</issue>
        <fpage>259</fpage>
        <lpage>264</lpage>
        <pub-id pub-id-type="doi">10.3171/2011.12.PEDS11227</pub-id>
        <?supplied-pmid 22380953?>
        <pub-id pub-id-type="pmid">22380953</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Giordano</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Samii</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>McLean</surname>
            <given-names>ACL</given-names>
          </name>
          <name>
            <surname>Bertalanffy</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Fahlbusch</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Samii</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Di Rocco</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Intraoperative magnetic resonance imaging in pediatric neurosurgery: safety and utility</article-title>
        <source>J Neurosurg Pediatr</source>
        <year>2017</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>77</fpage>
        <lpage>84</lpage>
        <pub-id pub-id-type="doi">10.3171/2016.8.PEDS15708</pub-id>
        <?supplied-pmid 27791707?>
        <pub-id pub-id-type="pmid">27791707</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miller</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wittek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Joldes</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Biomechanics of the brain for computer-integrated surgery</article-title>
        <source>Acta Bioeng Biomech</source>
        <year>2010</year>
        <volume>12</volume>
        <issue>2</issue>
        <fpage>25</fpage>
        <lpage>37</lpage>
        <?supplied-pmid 20882939?>
        <pub-id pub-id-type="pmid">20882939</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Joldes</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Wittek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Suite of finite element algorithms for accurate computation of soft tissue deformation for surgical simulation</article-title>
        <source>Med Image Anal</source>
        <year>2009</year>
        <volume>13</volume>
        <issue>6</issue>
        <fpage>912</fpage>
        <lpage>919</lpage>
        <pub-id pub-id-type="doi">10.1016/j.media.2008.12.001</pub-id>
        <?supplied-pmid 19152791?>
        <pub-id pub-id-type="pmid">19152791</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Horton</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wittek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Joldes</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>A meshless Total Lagrangian explicit dynamics algorithm for surgical simulation</article-title>
        <source>Int J Numer Methods Biomed Eng</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>8</issue>
        <fpage>977</fpage>
        <lpage>998</lpage>
        <pub-id pub-id-type="doi">10.1002/cnm.1374</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>GY</given-names>
          </name>
          <name>
            <surname>Wittek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Joldes</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>A three-dimensional nonlinear meshfree algorithm for simulating mechanical responses of soft tissue</article-title>
        <source>Eng Anal Bound Elem</source>
        <year>2014</year>
        <volume>42</volume>
        <fpage>60</fpage>
        <lpage>66</lpage>
        <pub-id pub-id-type="doi">10.1016/j.enganabound.2013.08.014</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Joldes</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Bourantas</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Zwick</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Chowdhury</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wittek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Agrawal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mountris</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hyde</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Warfield</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Suite of meshless algorithms for accurate computation of soft tissue deformation for surgical simulation</article-title>
        <source>Med Image Anal</source>
        <year>2019</year>
        <volume>56</volume>
        <fpage>152</fpage>
        <lpage>171</lpage>
        <pub-id pub-id-type="doi">10.1016/j.media.2019.06.004</pub-id>
        <?supplied-pmid 31229760?>
        <pub-id pub-id-type="pmid">31229760</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miller</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Horton</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Joldes</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Wittek</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Beyond finite elements: a comprehensive, patient-specific neurosurgical simulation utilizing a meshless method</article-title>
        <source>J Biomech</source>
        <year>2012</year>
        <volume>45</volume>
        <issue>15</issue>
        <fpage>2698</fpage>
        <lpage>2701</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jbiomech.2012.07.031</pub-id>
        <?supplied-pmid 22935689?>
        <pub-id pub-id-type="pmid">22935689</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Bourantas</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Zwick</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Joldes</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Kapur</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Frisken</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kikinis</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Nabavi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Golby</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wittek</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Computer simulation of tumour resection-induced brain deformation by a meshless approach</article-title>
        <source>Int J Numer Methods Biomed Eng</source>
        <year>2022</year>
        <volume>38</volume>
        <issue>1</issue>
        <fpage>e3539</fpage>
        <pub-id pub-id-type="doi">10.1002/cnm.3539</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fedorov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Beichel</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kalpathy-Cramer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Finet</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fillion-Robin</surname>
            <given-names>J-C</given-names>
          </name>
          <name>
            <surname>Pujol</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bauer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jennings</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Fennessy</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Sonka</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>3D slicer as an image computing platform for the quantitative imaging network</article-title>
        <source>Magn Reson Imaging</source>
        <year>2012</year>
        <volume>30</volume>
        <issue>9</issue>
        <fpage>1323</fpage>
        <lpage>1341</lpage>
        <pub-id pub-id-type="doi">10.1016/j.mri.2012.05.001</pub-id>
        <?supplied-pmid 22770690?>
        <pub-id pub-id-type="pmid">22770690</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mercier</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Del Maestro</surname>
            <given-names>RF</given-names>
          </name>
          <name>
            <surname>Petrecca</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Araujo</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Haegelen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Collins</surname>
            <given-names>DL</given-names>
          </name>
        </person-group>
        <article-title>Online database of clinical MR and ultrasound images of brain tumors</article-title>
        <source>Med Phys</source>
        <year>2012</year>
        <volume>39</volume>
        <fpage>3253</fpage>
        <lpage>3261</lpage>
        <pub-id pub-id-type="doi">10.1118/1.4709600</pub-id>
        <?supplied-pmid 22755708?>
        <pub-id pub-id-type="pmid">22755708</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mattes</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Haynor</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Vesselle</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lewellen</surname>
            <given-names>TK</given-names>
          </name>
          <name>
            <surname>Eubank</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>PET-CT image registration in the chest using free-form deformations</article-title>
        <source>IEEE Trans Med Imaging</source>
        <year>2003</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>120</fpage>
        <lpage>128</lpage>
        <pub-id pub-id-type="doi">10.1109/TMI.2003.809072</pub-id>
        <?supplied-pmid 12703765?>
        <pub-id pub-id-type="pmid">12703765</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ségonne</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Dale</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Busa</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Glessner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Salat</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hahn</surname>
            <given-names>HK</given-names>
          </name>
          <name>
            <surname>Fischl</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>A hybrid approach to the skull stripping problem in MRI</article-title>
        <source>Neuroimage</source>
        <year>2004</year>
        <volume>22</volume>
        <issue>3</issue>
        <fpage>1060</fpage>
        <lpage>1075</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2004.03.032</pub-id>
        <?supplied-pmid 15219578?>
        <pub-id pub-id-type="pmid">15219578</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kittler</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Illingworth</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Minimum error thresholding</article-title>
        <source>Pattern Recogn</source>
        <year>1986</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>41</fpage>
        <lpage>47</lpage>
        <pub-id pub-id-type="doi">10.1016/0031-3203(86)90030-0</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lorensen</surname>
            <given-names>WE</given-names>
          </name>
          <name>
            <surname>Cline</surname>
            <given-names>HE</given-names>
          </name>
        </person-group>
        <article-title>Marching cubes: a high resolution 3D surface construction algorithm</article-title>
        <source>ACM Siggraph Comput Graph</source>
        <year>1987</year>
        <volume>21</volume>
        <issue>4</issue>
        <fpage>163</fpage>
        <lpage>169</lpage>
        <pub-id pub-id-type="doi">10.1145/37402.37422</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Valette</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chassery</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Prost</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Generic remeshing of 3D triangular meshes with metric-dependent discrete Voronoi diagrams</article-title>
        <source>IEEE Trans Visual Comput Graph</source>
        <year>2008</year>
        <volume>14</volume>
        <issue>2</issue>
        <fpage>369</fpage>
        <lpage>381</lpage>
        <pub-id pub-id-type="doi">10.1109/TVCG.2007.70430</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Geuzaine</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Remacle</surname>
            <given-names>JF</given-names>
          </name>
        </person-group>
        <article-title>Gmsh: a 3-D finite element mesh generator with built-in pre-and post-processing facilities</article-title>
        <source>Int J Numer Meth Eng</source>
        <year>2009</year>
        <volume>79</volume>
        <issue>11</issue>
        <fpage>1309</fpage>
        <lpage>1331</lpage>
        <pub-id pub-id-type="doi">10.1002/nme.2579</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Sorkine O, Cohen-Or D, Lipman Y, Alexa M, Rössl C, Seidel HP (Eds) (2004) Laplacian surface editing. In: Proceedings of the 2004 Eurographics/ACM SIGGRAPH symposium on Geometry processing</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Joldes GR, Wittek A, Miller K, Morriss L (Eds) (2008) Realistic and efficient brain-skull interaction model for brain shift computation. Computational Biomechanics for Medicine III Workshop, MICCAI</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miga</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Clements</surname>
            <given-names>LW</given-names>
          </name>
          <name>
            <surname>Pheiffer</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Simpson</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>Clinical evaluation of a model-updated image-guidance approach to brain shift compensation: experience in 16 cases</article-title>
        <source>Int J Comput Assist Radiol Surg</source>
        <year>2016</year>
        <volume>11</volume>
        <issue>8</issue>
        <fpage>1467</fpage>
        <lpage>1474</lpage>
        <pub-id pub-id-type="doi">10.1007/s11548-015-1295-x</pub-id>
        <?supplied-pmid 26476637?>
        <pub-id pub-id-type="pmid">26476637</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Schroeder</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Lorensen</surname>
            <given-names>WE</given-names>
          </name>
        </person-group>
        <source>The visualization toolkit an object-oriented approach to 3D graphics</source>
        <year>1998</year>
        <publisher-name>Prentice-Hall Inc</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sullivan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kaszynski</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>PyVista: 3D plotting and mesh analysis through a streamlined interface for the Visualization Toolkit (VTK)</article-title>
        <source>J Open Source Softw</source>
        <year>2019</year>
        <volume>4</volume>
        <issue>37</issue>
        <fpage>1450</fpage>
        <pub-id pub-id-type="doi">10.21105/joss.01450</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Joldes</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Wittek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Stable time step estimates for mesh-free particle methods</article-title>
        <source>Int J Numer Meth Eng</source>
        <year>2012</year>
        <volume>91</volume>
        <issue>4</issue>
        <fpage>450</fpage>
        <lpage>456</lpage>
        <pub-id pub-id-type="doi">10.1002/nme.4290</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Waldron</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Kinzel</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Agrawal</surname>
            <given-names>SK</given-names>
          </name>
        </person-group>
        <source>Kinematics, dynamics, and design of machinery</source>
        <year>2016</year>
        <publisher-name>Wiley</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Drakopoulos</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Tsolakis</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Angelopoulos</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yao</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kavazidi</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Foroglou</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Fedorov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Frisken</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kikinis</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Adaptive physics-based non-rigid registration for immersive image-guided neuronavigation systems</article-title>
        <source>Front Digit Health</source>
        <year>2021</year>
        <volume>2</volume>
        <fpage>613608</fpage>
        <pub-id pub-id-type="doi">10.3389/fdgth.2020.613608</pub-id>
        <?supplied-pmid 34713074?>
        <pub-id pub-id-type="pmid">34713074</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wittek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Joldes</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Couton</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Warfield</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Patient-specific non-linear finite element modelling for predicting soft organ deformation in real-time; application to non-rigid neuroimage registration</article-title>
        <source>Prog Biophys Mol Biol</source>
        <year>2010</year>
        <volume>103</volume>
        <issue>2–3</issue>
        <fpage>292</fpage>
        <lpage>303</lpage>
        <pub-id pub-id-type="doi">10.1016/j.pbiomolbio.2010.09.001</pub-id>
        <?supplied-pmid 20868706?>
        <pub-id pub-id-type="pmid">20868706</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>JY</given-names>
          </name>
          <name>
            <surname>Joldes</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Wittek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Patient-specific computational biomechanics of the brain without segmentation and meshing</article-title>
        <source>Int J Numer Methods Biomed Eng</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>2</issue>
        <fpage>293</fpage>
        <lpage>308</lpage>
        <pub-id pub-id-type="doi">10.1002/cnm.2507</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miller</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Joldes</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Bourantas</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Warfield</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Hyde</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Kikinis</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wittek</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Biomechanical modeling and computer simulation of the brain during neurosurgery</article-title>
        <source>Int J Numer Methods Biomed Eng</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>10</issue>
        <fpage>e3250</fpage>
        <pub-id pub-id-type="doi">10.1002/cnm.3250</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miller</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Chinzei</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Mechanical properties of brain tissue in tension</article-title>
        <source>J Biomech</source>
        <year>2002</year>
        <volume>35</volume>
        <issue>4</issue>
        <fpage>483</fpage>
        <lpage>490</lpage>
        <pub-id pub-id-type="doi">10.1016/S0021-9290(01)00234-2</pub-id>
        <?supplied-pmid 11934417?>
        <pub-id pub-id-type="pmid">11934417</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bourantas</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Zwick</surname>
            <given-names>BF</given-names>
          </name>
          <name>
            <surname>Joldes</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Wittek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Simple and robust element-free Galerkin method with almost interpolating shape functions for finite deformation elasticity</article-title>
        <source>Appl Math Model</source>
        <year>2021</year>
        <volume>96</volume>
        <fpage>284</fpage>
        <lpage>303</lpage>
        <pub-id pub-id-type="doi">10.1016/j.apm.2021.03.007</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garlapati</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Roy</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Joldes</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Wittek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mostayed</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Doyle</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Warfield</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Kikinis</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Knuckey</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bunt</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>More accurate neuronavigation data provided by biomechanical modeling instead of rigid registration</article-title>
        <source>J Neurosurg</source>
        <year>2014</year>
        <volume>120</volume>
        <issue>6</issue>
        <fpage>1477</fpage>
        <lpage>1483</lpage>
        <pub-id pub-id-type="doi">10.3171/2013.12.JNS131165</pub-id>
        <?supplied-pmid 24460486?>
        <pub-id pub-id-type="pmid">24460486</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oguro</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tuncali</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Elhawary</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Morrison</surname>
            <given-names>PR</given-names>
          </name>
          <name>
            <surname>Hata</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Silverman</surname>
            <given-names>SG</given-names>
          </name>
        </person-group>
        <article-title>Image registration of pre-procedural MRI and intra-procedural CT images to aid CT-guided percutaneous cryoablation of renal tumors</article-title>
        <source>Int J Comput Assist Radiol Surg</source>
        <year>2011</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>111</fpage>
        <lpage>117</lpage>
        <pub-id pub-id-type="doi">10.1007/s11548-010-0485-9</pub-id>
        <?supplied-pmid 20499194?>
        <pub-id pub-id-type="pmid">20499194</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Warfield</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Haker</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Talos</surname>
            <given-names>I-F</given-names>
          </name>
          <name>
            <surname>Kemper</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Weisenfeld</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Mewes</surname>
            <given-names>AUJ</given-names>
          </name>
          <name>
            <surname>Goldberg-Zimring</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Zou</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Westin</surname>
            <given-names>C-F</given-names>
          </name>
          <name>
            <surname>Wells</surname>
            <given-names>WM</given-names>
          </name>
        </person-group>
        <article-title>Capturing intraoperative deformations: research experience at Brigham and Women’s Hospital</article-title>
        <source>Med Image Anal</source>
        <year>2005</year>
        <volume>9</volume>
        <issue>2</issue>
        <fpage>145</fpage>
        <lpage>162</lpage>
        <pub-id pub-id-type="doi">10.1016/j.media.2004.11.005</pub-id>
        <?supplied-pmid 15721230?>
        <pub-id pub-id-type="pmid">15721230</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
