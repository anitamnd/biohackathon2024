<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3669295</article-id>
    <article-id pub-id-type="pmid">23741504</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-13-07738</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0065632</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis Tools</subject>
              <subj-group>
                <subject>Sequence Assembly Tools</subject>
              </subj-group>
            </subj-group>
            <subj-group>
              <subject>Genome Sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Genomics</subject>
          <subj-group>
            <subject>Genome Analysis Tools</subject>
            <subj-group>
              <subject>Sequence Assembly Tools</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Genome Sequencing</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Computer Science</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SOAP3-dp: Fast, Accurate and Sensitive GPU-Based Short Read Aligner</article-title>
      <alt-title alt-title-type="running-head">SOAP3-dp Short Read Aligner</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Luo</surname>
          <given-names>Ruibang</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Wong</surname>
          <given-names>Thomas</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Zhu</surname>
          <given-names>Jianqiao</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff5">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Liu</surname>
          <given-names>Chi-Man</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Xiaoqian</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wu</surname>
          <given-names>Edward</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lee</surname>
          <given-names>Lap-Kei</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lin</surname>
          <given-names>Haoxiang</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Wenjuan</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cheung</surname>
          <given-names>David W.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ting</surname>
          <given-names>Hing-Fung</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yiu</surname>
          <given-names>Siu-Ming</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Peng</surname>
          <given-names>Shaoliang</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yu</surname>
          <given-names>Chang</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Yingrui</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Ruiqiang</given-names>
        </name>
        <xref ref-type="aff" rid="aff4">
          <sup>4</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lam</surname>
          <given-names>Tak-Wah</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>HKU-BGI Bioinformatics Algorithms and Core Technology Research Laboratory &amp; Department of Computer Science, University of Hong Kong, Hong Kong, China</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>School of Computer Science, National University of Defense Technology, Changsha, Hunan, China</addr-line>
    </aff>
    <aff id="aff3">
      <label>3</label>
      <addr-line>BGI-Shenzhen, Shenzhen, Guangdong, China</addr-line>
    </aff>
    <aff id="aff4">
      <label>4</label>
      <addr-line>Peking-Tsinghua Center for Life Sciences, Biodynamic Optical Imaging Center and School of Life Sciences, Peking University, Beijing, China</addr-line>
    </aff>
    <aff id="aff5">
      <label>5</label>
      <addr-line>Department of Computer Sciences, University of Wisconsin-Madison, Madison, Wisconsin, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Leung</surname>
          <given-names>Frederick C. C.</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Hong Kong, China</addr-line>
    </aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>liyr@genomics.cn</email> (YL); <email>lirq@pku.edu.cn</email> (RL); <email>twlam@cs.hku.hk</email> (TL)</corresp>
      <fn fn-type="COI-statement">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con">
        <p>Wrote the paper: TL R. Luo TW. Contributed equally to this work: R. Luo TW JZ CL. Led the project and contributed the main ideas: TL. Co-managed the project: R. Li YL DC HT SY XZ. Wrote the program: JZ TW CL R. Luo EW LL SP. Designed the analysis: R. Luo TW. Conducted the simulation analysis: R. Luo TW. Conducted the real data analysis: R. Luo HL WZ. Assisted in deploying the program: XZ CY SP.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>31</day>
      <month>5</month>
      <year>2013</year>
    </pub-date>
    <volume>8</volume>
    <issue>5</issue>
    <elocation-id>e65632</elocation-id>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>2</month>
        <year>2013</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>4</month>
        <year>2013</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2013 Luo et al</copyright-statement>
      <copyright-year>2013</copyright-year>
      <copyright-holder>Luo et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>To tackle the exponentially increasing throughput of Next-Generation Sequencing (NGS), most of the existing short-read aligners can be configured to favor speed in trade of accuracy and sensitivity. SOAP3-dp, through leveraging the computational power of both CPU and GPU with optimized algorithms, delivers high speed and sensitivity simultaneously. Compared with widely adopted aligners including BWA, Bowtie2, SeqAlto, CUSHAW2, GEM and GPU-based aligners BarraCUDA and CUSHAW, SOAP3-dp was found to be two to tens of times faster, while maintaining the highest sensitivity and lowest false discovery rate (FDR) on Illumina reads with different lengths. Transcending its predecessor SOAP3, which does not allow gapped alignment, SOAP3-dp by default tolerates alignment similarity as low as 60%. Real data evaluation using human genome demonstrates SOAP3-dp's power to enable more authentic variants and longer Indels to be discovered. Fosmid sequencing shows a 9.1% FDR on newly discovered deletions. SOAP3-dp natively supports BAM file format and provides the same scoring scheme as BWA, which enables it to be integrated into existing analysis pipelines. SOAP3-dp has been deployed on Amazon-EC2, NIH-Biowulf and Tianhe-1A.</p>
    </abstract>
    <funding-group>
      <funding-statement>TL was partially supported by RGC General Research Fund 10612042. R. Luo was partially supported by Hong Kong ITF Grant GHP/011/12. Both R. Luo and TL are partially supported by the GRF Grant HKU-713512E. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <page-count count="11"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>With the rapid advancement of Next-Generation Sequencing technologies, modern sequencers like Illumina HiSeq 2500 can sequence a human genome into 600 million pairs of reads of 100 bp in length (total 120 Gigabases) in merely 27 hours. The cost is also decreasing fast. By 2013 year's end, sequencing a human genome is projected to cost less than $1,000. Bioinformatics research using sequencing data often starts with aligning the data onto a reference genome, followed by various downstream analyses. Alignment is computationally intensive; the 1000 genomes pilot paper <xref rid="pone.0065632-The1" ref-type="bibr">[1]</xref> published in 2010 reported that a 1192-processor cluster was used to align the reads using MAQ <xref rid="pone.0065632-Li1" ref-type="bibr">[2]</xref>. This kind of computing resources is not available to most laboratories, let alone clinical settings. Although considerable advances have been made on new aligners, alignment still remains a bottleneck in bioinformatics analyses. Thus, ultra-fast alignment tools without relying on extensive computing resources are needed.</p>
    <p>There are quite a few software tools for aligning short reads onto a reference genome. The more popular ones include MAQ, Bowtie <xref rid="pone.0065632-Langmead1" ref-type="bibr">[3]</xref>, BWA <xref rid="pone.0065632-Li2" ref-type="bibr">[4]</xref> and SOAP2 <xref rid="pone.0065632-Li3" ref-type="bibr">[5]</xref>. The faster ones <xref rid="pone.0065632-Langmead1" ref-type="bibr">[3]</xref>–<xref rid="pone.0065632-Li3" ref-type="bibr">[5]</xref> index the reference genome using the Burrows-Wheeler Transform (BWT), which is efficient for aligning short reads with limited mismatches, but inefficient for alignment with gaps. These tools (running on a quad-core processor) take tens of hours to align 120 Gigabases with limited (or even none for Bowtie and SOAP2) gapped alignment found. Alignment gaps can result from insertions and deletions (Indels), which are thought to comprise over 20% of genetic variations <xref rid="pone.0065632-Li4" ref-type="bibr">[6]</xref> and contribute to human traits <xref rid="pone.0065632-Mullaney1" ref-type="bibr">[7]</xref>. Hence, a successor is expected to be faster and more sensitive to gaps.</p>
    <p>SeqAlto <xref rid="pone.0065632-Mu1" ref-type="bibr">[8]</xref>, CUSHAW2 <xref rid="pone.0065632-Liu1" ref-type="bibr">[9]</xref>, and GEM <xref rid="pone.0065632-MarcoSola1" ref-type="bibr">[10]</xref> were published recently. SeqAlto is a hash-based aligner that improves an earlier hash-based aligner SNAP <xref rid="pone.0065632-Zaharia1" ref-type="bibr">[11]</xref> (reported to have relatively poor sensitivity for real reads and provide no mapping quality <xref rid="pone.0065632-Mu1" ref-type="bibr">[8]</xref>) using additional global and local alignments. SeqAlto is slower than SNAP, yet SeqAlto is still faster than the BWT-based aligners except Bowtie2. CUSHAW2 <xref rid="pone.0065632-Liu1" ref-type="bibr">[9]</xref> uses the seed-and-extend approach and maximal-exact-match seeds to enable gapped alignment of long reads. GEM mapper leverages string matching with filtration to search the alignment space more efficiently <xref rid="pone.0065632-MarcoSola1" ref-type="bibr">[10]</xref>. GEM is faster than comparable state-of-the-art aligners. Yet it does not provide PHRED <xref rid="pone.0065632-Ewing1" ref-type="bibr">[12]</xref> compliant mapping quality score; this saves some tedious computation, but prohibiting it from integrating into existing analysis pipelines.</p>
    <p>Nowadays, general-purpose computing on graphics processing units (GPUs) is becoming popular. A GPU is a piece of low-cost hardware providing massive parallelism but with limited memory and restricted usage. A number of GPU-based bioinformatics tools have emerged last year <xref rid="pone.0065632-Nvidia1" ref-type="bibr">[13]</xref>. CUSHAW <xref rid="pone.0065632-Liu2" ref-type="bibr">[14]</xref> is the first to introduce a complete alignment pipeline utilizing GPU power for paired-end short reads (note that CUSHAW2, mentioned above, is CPU-based). BarraCUDA <xref rid="pone.0065632-Klus1" ref-type="bibr">[15]</xref> implements BWA to align reads in parallel on a GPU; limited by the branch and bound trie algorithm that requires extensive decisions making, BarraCUDA works sub-optimally on GPU and gains a 4-time boost than a single-thread BWA. SOAP3 <xref rid="pone.0065632-Liu3" ref-type="bibr">[16]</xref> successfully exploits the massive parallelism of a GPU with tailor-made GPU-BWT and read-characteristics sensitive load balancing to effectively align short reads. Albeit not supporting gapped alignment, which makes it unsuitable for production, it is to date the most competitive aligner for ungapped alignment.</p>
  </sec>
  <sec id="s2">
    <title>Results</title>
    <p>Here we present a GPU-based alignment software SOAP3-dp that allows multiple mismatches and gaps, which is well suited for production environments (real data alignments) than the predecessor SOAP3. A simple approach to extend mismatch alignment to gapped alignment is to first identify candidate regions by exact or mismatch alignment of short substrings (seeds) in the reads, then use dynamic programming to perform a detailed alignment of the read to the regions. Such an approach has been widely used (e.g., Bowtie2). The bottleneck occurs as substring alignment often results in a large number of candidates, especially when mismatches are allowed. As a result, reads with too many candidates are often ignored due to time constraint. On the other hand, the parallelism of GPU apparently would allow many candidates to be verified in parallel; yet dynamic programming is memory consuming, and the limited-memory of GPU becomes a prohibiting factor to fully utilize the parallelism. SOAP3-dp gives a pragmatic realization of this approach (<xref ref-type="fig" rid="pone-0065632-g001">Figure 1</xref>, <xref ref-type="sec" rid="s4">Methods</xref>). By exploiting compressed indexing and memory-optimizing dynamic programming on a GPU, SOAP3-dp can efficiently tackle a large number of candidates in parallel, and thus can examine gapped alignments extensively and achieve a drastic improvement in both speed and sensitivity over other tools.</p>
    <fig id="pone-0065632-g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0065632.g001</object-id>
      <label>Figure 1</label>
      <caption>
        <title>Alignment workflow.</title>
        <p>For each read (paired-end specifically, single-end is only with step 1 and step 3), the alignment would be decided in at most three steps. In step 1, SOAP3-dp aligns both ends of a read-pair to the reference genome by using GPU version 2way-BWT algorithm (<xref ref-type="sec" rid="s4">Methods</xref>). Pairs with only one end aligned proceed to step 2 for a GPU accelerated dynamic programming (<xref ref-type="sec" rid="s4">Methods</xref>) alignment at candidate regions inferred from the aligned end. Pairs with both ends unaligned in step 1 and those ends failed in step 2 proceed to step 3 to perform a more comprehensive alignment across the whole genome until all seed hits (substrings from the read) are examined or until a sufficient number of alignments are examined.</p>
      </caption>
      <graphic xlink:href="pone.0065632.g001"/>
    </fig>
    <p>See the <xref ref-type="sec" rid="s4">Methods</xref> about the design of the dynamic programming which attempts to minimize the memory usage for each candidate so as to let a GPU to handle hundreds of candidates in parallel while using limited shared memory. We also show the details of SOAP3-dp's intricate engineering solution to finding the optimal way to align different reads using either the CPU or the GPU.</p>
    <sec id="s2a">
      <title>Experiments &amp; Performance</title>
      <p>We compared SOAP3-dp to other short-read alignment software in terms of the speed, sensitivity and accuracy. We used both real and simulated Illumina data. Furthermore, we tested out SOAP3-dp's alignment quality for variant calling using real data. In particular, 41-fold of 100 bp (PE100) and 77-fold of 150 bp (PE150) Illumina paired-end reads of YH <xref rid="pone.0065632-Wang1" ref-type="bibr">[17]</xref> samples have been generated (Table S1 in <xref ref-type="supplementary-material" rid="pone.0065632.s003">File S1</xref>) for the testing for variant calling.</p>
    </sec>
    <sec id="s2b">
      <title>Alignment Performance</title>
      <p>We first used real data to test SOAP3-dp with BWA (BWA-SW <xref rid="pone.0065632-Li5" ref-type="bibr">[18]</xref> for SE reads), Bowtie2, SeqAlto, CUSHAW2, GEM, BarraCUDA, and CUSHAW. The aim was to compare the time and alignment rate when each runs in the default setting. Next, to assess the accuracy and sensitivity, we used simulated reads whose correct alignments were known. We then considered more detailed comparison with the software running in different settings. We also attempted to compare SOAP3-dp against its predecessor SOAP3.</p>
      <p>In our experiments, we assume that input reads are plain text instead of in gzip-compressed format. This is because GEM (to the date of paper submission) does not accept gzip-compressed FASTQ file. All other software can handle compressed input, which is getting common nowadays. Regarding output format, we require all software to use SAM format, which is mandatory for downstream analysis software including GATK <xref rid="pone.0065632-McKenna1" ref-type="bibr">[19]</xref> and SAMTOOLS <xref rid="pone.0065632-Li6" ref-type="bibr">[20]</xref>. All software except GEM can output directly in SAM format; GEM first outputs in a simple format and then takes an extra step to convert to SAM format. To test GEM's efficiency when using a simple format, we include a comparison to SOAP3-dp also using a simple format (see the Remark section).</p>
    </sec>
    <sec id="s2c">
      <title>Real data</title>
      <p>We used three real datasets for benchmarking of alignment performance: (1) a lane (122.43M reads) from PE100, and (2) a lane (374.87M reads) from PE150, and (3) SRR211279 (25.23M 100 bp paired-end reads generated by Illumina GAIIx) from the Washington University Genome Sequencing Center. We tested SOAP3-dp and seven other aligners (CPU-based: BWA, Bowite2, SeqAlto, CUSHAW2, GEM; GPU-based: Barracuda, and CUSHAW; see Supplementary Note for receipts), all using 4 CPU threads and one GPU device (for GPU aligner). As shown in <xref ref-type="table" rid="pone-0065632-t001">Table 1</xref>, SOAP3-dp is much faster than all others (Tables S2–S10 in <xref ref-type="supplementary-material" rid="pone.0065632.s003">File S1</xref> for more details). It is at least 3.5 times faster than GEM, and 7 to 15 times faster than the other six. SOAP3-dp also gave better alignment rate consistently. SeqAlto comes closest, aligning 0.48% to 3.6% less reads than SOAP3-dp, and the others are in the range of 2% to 8% less than SOAP3-dp. Notice that except SOAP3-dp, aligners usually have an obvious drop in alignment rate for longer reads (dataset 2). The two GPU-based aligners, Barracuda and CUSHAW, are relatively primitive in optimizing GPU's utilization and overheads, and their performance was dominated by new CPU-based aligners like GEM and Bowtie2. For SOAP3, its alignment rate, as expected, is much poorer than SOAP3-dp and the others (due to lack of gapped alignment); furthermore, SOAP3 is slower than SOAP3-dp for 100 bp reads. We did not include Barracuda, CUSHAW and SOAP3 for further experiments.</p>
      <table-wrap id="pone-0065632-t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0065632.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Benchmarking using real reads.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0065632-t001-1" xlink:href="pone.0065632.t001"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td colspan="12" align="left" rowspan="1">GPU</td>
                <td colspan="15" align="left" rowspan="1">CPU</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Dataset</td>
                <td align="left" rowspan="1" colspan="1">Volume (Gbp)</td>
                <td colspan="3" align="left" rowspan="1">SOAP3-dp (Full SA)</td>
                <td colspan="3" align="left" rowspan="1">SOAP3</td>
                <td colspan="3" align="left" rowspan="1">BarraCUDA</td>
                <td colspan="3" align="left" rowspan="1">CUSHAW</td>
                <td colspan="3" align="left" rowspan="1">BWA</td>
                <td colspan="3" align="left" rowspan="1">Bowtie2</td>
                <td colspan="3" align="left" rowspan="1">SeqAlto</td>
                <td colspan="3" align="left" rowspan="1">GEM</td>
                <td colspan="3" align="left" rowspan="1">CUSHAW2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">%</td>
                <td align="left" rowspan="1" colspan="1">Time (s)</td>
                <td align="left" rowspan="1" colspan="1">Mem.</td>
                <td align="left" rowspan="1" colspan="1">%</td>
                <td align="left" rowspan="1" colspan="1">Time (fold)</td>
                <td align="left" rowspan="1" colspan="1">Mem.</td>
                <td align="left" rowspan="1" colspan="1">%</td>
                <td align="left" rowspan="1" colspan="1">Time (fold)</td>
                <td align="left" rowspan="1" colspan="1">Mem.</td>
                <td align="left" rowspan="1" colspan="1">%</td>
                <td align="left" rowspan="1" colspan="1">Time (fold)</td>
                <td align="left" rowspan="1" colspan="1">Mem.</td>
                <td align="left" rowspan="1" colspan="1">%</td>
                <td align="left" rowspan="1" colspan="1">Time (fold)</td>
                <td align="left" rowspan="1" colspan="1">Mem.</td>
                <td align="left" rowspan="1" colspan="1">%</td>
                <td align="left" rowspan="1" colspan="1">Time (fold)</td>
                <td align="left" rowspan="1" colspan="1">Mem.</td>
                <td align="left" rowspan="1" colspan="1">%</td>
                <td align="left" rowspan="1" colspan="1">Time (fold)</td>
                <td align="left" rowspan="1" colspan="1">Mem.</td>
                <td align="left" rowspan="1" colspan="1">%</td>
                <td align="left" rowspan="1" colspan="1">Time (fold)</td>
                <td align="left" rowspan="1" colspan="1">Mem.</td>
                <td align="left" rowspan="1" colspan="1">%</td>
                <td align="left" rowspan="1" colspan="1">Time (fold)</td>
                <td align="left" rowspan="1" colspan="1">Mem.</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">realYHPE100</td>
                <td align="left" rowspan="1" colspan="1">12.24</td>
                <td align="left" rowspan="1" colspan="1">98.12%</td>
                <td align="left" rowspan="1" colspan="1">1,079</td>
                <td align="left" rowspan="1" colspan="1">19</td>
                <td align="left" rowspan="1" colspan="1">−10.60%</td>
                <td align="left" rowspan="1" colspan="1">2.63</td>
                <td align="left" rowspan="1" colspan="1">21.1</td>
                <td align="left" rowspan="1" colspan="1">−6.39%</td>
                <td align="left" rowspan="1" colspan="1">14.03</td>
                <td align="left" rowspan="1" colspan="1">4.1</td>
                <td align="left" rowspan="1" colspan="1">−3.13%</td>
                <td align="left" rowspan="1" colspan="1">46.79</td>
                <td align="left" rowspan="1" colspan="1">2.7</td>
                <td align="left" rowspan="1" colspan="1">−4.14%</td>
                <td align="left" rowspan="1" colspan="1">16.03</td>
                <td align="left" rowspan="1" colspan="1">4.9</td>
                <td align="left" rowspan="1" colspan="1">−3.87%</td>
                <td align="left" rowspan="1" colspan="1">12.04</td>
                <td align="left" rowspan="1" colspan="1">3.5</td>
                <td align="left" rowspan="1" colspan="1">−0.48%</td>
                <td align="left" rowspan="1" colspan="1">14.25</td>
                <td align="left" rowspan="1" colspan="1">7.2</td>
                <td align="left" rowspan="1" colspan="1">−2.86%</td>
                <td align="left" rowspan="1" colspan="1">3.54</td>
                <td align="left" rowspan="1" colspan="1">4.5</td>
                <td align="left" rowspan="1" colspan="1">−1.39%</td>
                <td align="left" rowspan="1" colspan="1">12.09</td>
                <td align="left" rowspan="1" colspan="1">3.6</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">realYHPE150</td>
                <td align="left" rowspan="1" colspan="1">56.23</td>
                <td align="left" rowspan="1" colspan="1">97.16%</td>
                <td align="left" rowspan="1" colspan="1">6,835</td>
                <td align="left" rowspan="1" colspan="1">19.6</td>
                <td align="left" rowspan="1" colspan="1">−28.33%</td>
                <td align="left" rowspan="1" colspan="1">0.64</td>
                <td align="left" rowspan="1" colspan="1">22.7</td>
                <td align="left" rowspan="1" colspan="1">−10.99%</td>
                <td align="left" rowspan="1" colspan="1">7.22</td>
                <td align="left" rowspan="1" colspan="1">4.3</td>
                <td align="left" rowspan="1" colspan="1">−10.11%</td>
                <td align="left" rowspan="1" colspan="1">24.57</td>
                <td align="left" rowspan="1" colspan="1">3.1</td>
                <td align="left" rowspan="1" colspan="1">−8.05%</td>
                <td align="left" rowspan="1" colspan="1">15.26</td>
                <td align="left" rowspan="1" colspan="1">5.0</td>
                <td align="left" rowspan="1" colspan="1">−7.45%</td>
                <td align="left" rowspan="1" colspan="1">7.82</td>
                <td align="left" rowspan="1" colspan="1">3.5</td>
                <td align="left" rowspan="1" colspan="1">−3.65%</td>
                <td align="left" rowspan="1" colspan="1">17.69</td>
                <td align="left" rowspan="1" colspan="1">7.2</td>
                <td align="left" rowspan="1" colspan="1">−5.85%</td>
                <td align="left" rowspan="1" colspan="1">3.76</td>
                <td align="left" rowspan="1" colspan="1">5</td>
                <td align="left" rowspan="1" colspan="1">−6.47%</td>
                <td align="left" rowspan="1" colspan="1">8.04</td>
                <td align="left" rowspan="1" colspan="1">3.6</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SRR211279</td>
                <td align="left" rowspan="1" colspan="1">5.07</td>
                <td align="left" rowspan="1" colspan="1">97.21%</td>
                <td align="left" rowspan="1" colspan="1">439</td>
                <td align="left" rowspan="1" colspan="1">18.4</td>
                <td align="left" rowspan="1" colspan="1">−6.83%</td>
                <td align="left" rowspan="1" colspan="1">1.05</td>
                <td align="left" rowspan="1" colspan="1">20.8</td>
                <td align="left" rowspan="1" colspan="1">−5.08%</td>
                <td align="left" rowspan="1" colspan="1">13.42</td>
                <td align="left" rowspan="1" colspan="1">4.1</td>
                <td align="left" rowspan="1" colspan="1">−2.22%</td>
                <td align="left" rowspan="1" colspan="1">54.22</td>
                <td align="left" rowspan="1" colspan="1">2.1</td>
                <td align="left" rowspan="1" colspan="1">−2.81%</td>
                <td align="left" rowspan="1" colspan="1">16.27</td>
                <td align="left" rowspan="1" colspan="1">4.9</td>
                <td align="left" rowspan="1" colspan="1">−0.69%</td>
                <td align="left" rowspan="1" colspan="1">12.00</td>
                <td align="left" rowspan="1" colspan="1">3.5</td>
                <td align="left" rowspan="1" colspan="1">−0.48%</td>
                <td align="left" rowspan="1" colspan="1">17.29</td>
                <td align="left" rowspan="1" colspan="1">7.2</td>
                <td align="left" rowspan="1" colspan="1">−2.44%</td>
                <td align="left" rowspan="1" colspan="1">4.11</td>
                <td align="left" rowspan="1" colspan="1">4.6</td>
                <td align="left" rowspan="1" colspan="1">−2.14%</td>
                <td align="left" rowspan="1" colspan="1">12.03</td>
                <td align="left" rowspan="1" colspan="1">3.6</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt101">
            <p>The percentage of reads aligned and time consumption of aligners other than SOAP3-dp are recorded as the difference or ratio based on SOAP3-dp's figures. The ‘%’ column represents ‘Properly paired’ for PE reads. ‘Mem.’ represents the peak memory consumption in gigabytes during alignment.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="s2d">
      <title>Simulated data</title>
      <p>To assess the accuracy and sensitivity of SOAP3-dp, we used the short read simulator Mason <xref rid="pone.0065632-Doring1" ref-type="bibr">[21]</xref> to obtain 5 sets of 6M Illumina-style paired-end (PE) reads with 500 bp insert size from GRCh37 major build, with length ranging from 50–250 bp.</p>
      <p>Notably, Bowtie2, SeqAlto and GEM were designed with switches to favor speed at the expense of accuracy and sensitivity. We applied “very-fast”, “sensitive”, and “very-sensitive” switches to Bowtie2, “fast (-f)” to SeqAlto and “fast adaptive (–fast-mapping)”, “fastest (–fast-mapping = 0)” to GEM. For SOAP3-dp, we tested three versions whose indices are based on 1/4 sampled, 1/2 sampled and full suffix array (SA), respectively. Different sized SAs still deliver identical alignment results, but a smaller one consumes less memory at the expense of slightly longer alignment time. All parameters of SOAP3-dp and SOAP3 remained as default (for a 100 bp read, one gap up to 68 bp, to 23 one-bp gaps) while parameters for other aligners were set to favor different read types and lengths as suggested by previous studies. Detailed command lines and descriptions of critical parameters were summarized as receipts in the Supplementary Note. In total, 16 sets of programs and parameters were compared.</p>
      <p>In all datasets of simulated reads, SOAP3-dp gives consistent advantage. It is faster and simultaneously has higher sensitivity and lower FDR over all other tools (<xref ref-type="table" rid="pone-0065632-t002">Table 2</xref> for 100 bp PE, Tables S11–S14 in <xref ref-type="supplementary-material" rid="pone.0065632.s003">File S1</xref> for all other simulated datasets, <xref ref-type="fig" rid="pone-0065632-g002">Figure 2</xref>). For 100 bp reads, SOAP3-dp with full SA takes 132 seconds to align 6M read pairs, and it is 2.26 to 12.63 times faster than the others (others using the fastest switches). SOAP3-dp's sensitivity is 99.96%, which is 0.13–0.85% higher than the others (others using the sensitive switches), and SOAP3-dp's FDR is 0.34%, which is lower than the others by 0.13–0.85%. Apparently the simulated data is easier to align than the real data due to recombination hotspots with intensified variants in real genome <xref rid="pone.0065632-Li4" ref-type="bibr">[6]</xref>. SOAP3-dp consumes more memory (9.3, 11.9, 17.2 GB for 1/4, 1/2 and full SA in average, respectively) than other software; Bowtie2 has the least (3.5 GB). Nevertheless, workstations and servers nowadays are equipped with at least 16 GB or even 32 GB of memory; SOAP3-dp is designed to take advantage of the available memory to achieve speed.</p>
      <fig id="pone-0065632-g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0065632.g002</object-id>
        <label>Figure 2</label>
        <caption>
          <title>Speed and sensitivity of alignment using simulated paired-end reads.</title>
          <p>We recorded the number of correct and incorrect alignments stratified by reported mapping quality for each dataset. We then calculated the cumulative number of correct and incorrect alignments from high to low mapping quality. We considered an alignment correct only if the leftmost position was within 50 bp of the position assigned by the simulator on the same strand according to the previous study of Bowtie2 to avoid soft-clipping artifacts.</p>
        </caption>
        <graphic xlink:href="pone.0065632.g002"/>
      </fig>
      <table-wrap id="pone-0065632-t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0065632.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Comparison on 16 sets of programs and parameters using 100 bp paired-end simulated reads.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0065632-t002-2" xlink:href="pone.0065632.t002"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td colspan="3" align="left" rowspan="1"/>
                <td colspan="6" align="left" rowspan="1">GPU</td>
                <td colspan="10" align="left" rowspan="1">CPU</td>
              </tr>
              <tr>
                <td colspan="3" align="left" rowspan="1">6M 100 bp Paired-end reads, 1.2 Gbp bases. 500 bp insert size, 25 bp standard deviation.</td>
                <td align="left" rowspan="1" colspan="1">SOAP3-dp<xref ref-type="table-fn" rid="nt102">1</xref> (1/4 SA)</td>
                <td align="left" rowspan="1" colspan="1">SOAP3-dp<xref ref-type="table-fn" rid="nt102">1</xref> (1/2 SA)</td>
                <td align="left" rowspan="1" colspan="1">SOAP3-dp<xref ref-type="table-fn" rid="nt102">1</xref> (Full SA)</td>
                <td align="left" rowspan="1" colspan="1">SOAP3-dp<xref ref-type="table-fn" rid="nt102">1</xref> (Full SA, Binary)</td>
                <td align="left" rowspan="1" colspan="1">SOAP3-dp<xref ref-type="table-fn" rid="nt102">1</xref> (Full SA, Succinct)</td>
                <td align="left" rowspan="1" colspan="1">SOAP3</td>
                <td align="left" rowspan="1" colspan="1">Bowtie2 (Sensititve)</td>
                <td align="left" rowspan="1" colspan="1">Bowtie2 (Very-Sensititve)</td>
                <td align="left" rowspan="1" colspan="1">Bowtie2 (Very-fast)</td>
                <td align="left" rowspan="1" colspan="1">BWA<xref ref-type="table-fn" rid="nt103">2</xref>
</td>
                <td align="left" rowspan="1" colspan="1">SeqAlto</td>
                <td align="left" rowspan="1" colspan="1">SeqAlto (Fast alignement)</td>
                <td align="left" rowspan="1" colspan="1">CUSHAW2</td>
                <td align="left" rowspan="1" colspan="1">GEM<xref ref-type="table-fn" rid="nt104">3</xref>
</td>
                <td align="left" rowspan="1" colspan="1">GEM<xref ref-type="table-fn" rid="nt104">3</xref> (Fast Mapping: adaptive)</td>
                <td align="left" rowspan="1" colspan="1">GEM<xref ref-type="table-fn" rid="nt104">3</xref> (Fast Mapping: 0)</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Configuration</td>
                <td colspan="2" align="left" rowspan="1">CPU (thread: core i7-3930k)</td>
                <td align="left" rowspan="1" colspan="1">4</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">4</td>
                <td align="left" rowspan="1" colspan="1">4</td>
                <td align="left" rowspan="1" colspan="1">4</td>
                <td align="left" rowspan="1" colspan="1">4</td>
                <td align="left" rowspan="1" colspan="1">4</td>
                <td align="left" rowspan="1" colspan="1">4</td>
                <td align="left" rowspan="1" colspan="1">4</td>
                <td align="left" rowspan="1" colspan="1">4</td>
                <td align="left" rowspan="1" colspan="1">4</td>
                <td align="left" rowspan="1" colspan="1">4</td>
                <td align="left" rowspan="1" colspan="1">4</td>
                <td align="left" rowspan="1" colspan="1">4</td>
                <td align="left" rowspan="1" colspan="1">4</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td colspan="2" align="left" rowspan="1">GPU (device: GTX680)</td>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Computational</td>
                <td align="left" rowspan="1" colspan="1">Total Elapsed</td>
                <td align="left" rowspan="1" colspan="1">sec.</td>
                <td align="left" rowspan="1" colspan="1">132</td>
                <td align="left" rowspan="1" colspan="1">137</td>
                <td align="left" rowspan="1" colspan="1">162</td>
                <td align="left" rowspan="1" colspan="1">111</td>
                <td align="left" rowspan="1" colspan="1">112</td>
                <td align="left" rowspan="1" colspan="1">132</td>
                <td align="left" rowspan="1" colspan="1">966</td>
                <td align="left" rowspan="1" colspan="1">1974</td>
                <td align="left" rowspan="1" colspan="1">672</td>
                <td align="left" rowspan="1" colspan="1">1154</td>
                <td align="left" rowspan="1" colspan="1">495</td>
                <td align="left" rowspan="1" colspan="1">379</td>
                <td align="left" rowspan="1" colspan="1">1303</td>
                <td align="left" rowspan="1" colspan="1">416</td>
                <td align="left" rowspan="1" colspan="1">446</td>
                <td align="left" rowspan="1" colspan="1">298</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Resources</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Fold</td>
                <td align="left" rowspan="1" colspan="1">-</td>
                <td align="left" rowspan="1" colspan="1">1.04</td>
                <td align="left" rowspan="1" colspan="1">1.23</td>
                <td align="left" rowspan="1" colspan="1">0.84</td>
                <td align="left" rowspan="1" colspan="1">0.85</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">7.32</td>
                <td align="left" rowspan="1" colspan="1">14.95</td>
                <td align="left" rowspan="1" colspan="1">5.09</td>
                <td align="left" rowspan="1" colspan="1">8.74</td>
                <td align="left" rowspan="1" colspan="1">3.75</td>
                <td align="left" rowspan="1" colspan="1">2.87</td>
                <td align="left" rowspan="1" colspan="1">9.87</td>
                <td align="left" rowspan="1" colspan="1">3.15</td>
                <td align="left" rowspan="1" colspan="1">3.38</td>
                <td align="left" rowspan="1" colspan="1">2.26</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Loading Index<xref ref-type="table-fn" rid="nt105">4</xref>
</td>
                <td align="left" rowspan="1" colspan="1">sec.</td>
                <td align="left" rowspan="1" colspan="1">32</td>
                <td align="left" rowspan="1" colspan="1">46</td>
                <td align="left" rowspan="1" colspan="1">74</td>
                <td align="left" rowspan="1" colspan="1">74</td>
                <td align="left" rowspan="1" colspan="1">74</td>
                <td align="left" rowspan="1" colspan="1">74</td>
                <td align="left" rowspan="1" colspan="1">38</td>
                <td align="left" rowspan="1" colspan="1">38</td>
                <td align="left" rowspan="1" colspan="1">38</td>
                <td align="left" rowspan="1" colspan="1">53+1+1</td>
                <td align="left" rowspan="1" colspan="1">96</td>
                <td align="left" rowspan="1" colspan="1">96</td>
                <td align="left" rowspan="1" colspan="1">40</td>
                <td align="left" rowspan="1" colspan="1">40+1</td>
                <td align="left" rowspan="1" colspan="1">40+1</td>
                <td align="left" rowspan="1" colspan="1">40+1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Alignment<xref ref-type="table-fn" rid="nt106">5</xref>
</td>
                <td align="left" rowspan="1" colspan="1">sec.</td>
                <td align="left" rowspan="1" colspan="1">100</td>
                <td align="left" rowspan="1" colspan="1">91</td>
                <td align="left" rowspan="1" colspan="1">88</td>
                <td align="left" rowspan="1" colspan="1">37</td>
                <td align="left" rowspan="1" colspan="1">38</td>
                <td align="left" rowspan="1" colspan="1">58</td>
                <td align="left" rowspan="1" colspan="1">928</td>
                <td align="left" rowspan="1" colspan="1">1936</td>
                <td align="left" rowspan="1" colspan="1">634</td>
                <td align="left" rowspan="1" colspan="1">370+369+360</td>
                <td align="left" rowspan="1" colspan="1">399</td>
                <td align="left" rowspan="1" colspan="1">283</td>
                <td align="left" rowspan="1" colspan="1">1263</td>
                <td align="left" rowspan="1" colspan="1">199+176</td>
                <td align="left" rowspan="1" colspan="1">238+167</td>
                <td align="left" rowspan="1" colspan="1">90+167</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Fold</td>
                <td align="left" rowspan="1" colspan="1">-</td>
                <td align="left" rowspan="1" colspan="1">0.91</td>
                <td align="left" rowspan="1" colspan="1">0.88</td>
                <td align="left" rowspan="1" colspan="1">0.37</td>
                <td align="left" rowspan="1" colspan="1">0.38</td>
                <td align="left" rowspan="1" colspan="1">0.58</td>
                <td align="left" rowspan="1" colspan="1">9.28</td>
                <td align="left" rowspan="1" colspan="1">19.36</td>
                <td align="left" rowspan="1" colspan="1">6.34</td>
                <td align="left" rowspan="1" colspan="1">10.99</td>
                <td align="left" rowspan="1" colspan="1">3.99</td>
                <td align="left" rowspan="1" colspan="1">2.83</td>
                <td align="left" rowspan="1" colspan="1">12.63</td>
                <td align="left" rowspan="1" colspan="1">3.75</td>
                <td align="left" rowspan="1" colspan="1">4.05</td>
                <td align="left" rowspan="1" colspan="1">2.57</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Avg. Memory</td>
                <td align="left" rowspan="1" colspan="1">GB</td>
                <td align="left" rowspan="1" colspan="1">9.3</td>
                <td align="left" rowspan="1" colspan="1">11.9</td>
                <td align="left" rowspan="1" colspan="1">17.2</td>
                <td align="left" rowspan="1" colspan="1">17.2</td>
                <td align="left" rowspan="1" colspan="1">17.2</td>
                <td align="left" rowspan="1" colspan="1">17.3</td>
                <td align="left" rowspan="1" colspan="1">3.3</td>
                <td align="left" rowspan="1" colspan="1">3.3</td>
                <td align="left" rowspan="1" colspan="1">3.3</td>
                <td align="left" rowspan="1" colspan="1">3.5</td>
                <td align="left" rowspan="1" colspan="1">7</td>
                <td align="left" rowspan="1" colspan="1">6.9</td>
                <td align="left" rowspan="1" colspan="1">3.6</td>
                <td align="left" rowspan="1" colspan="1">4.3</td>
                <td align="left" rowspan="1" colspan="1">4.3</td>
                <td align="left" rowspan="1" colspan="1">4.3</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Peak Memory</td>
                <td align="left" rowspan="1" colspan="1">GB</td>
                <td align="left" rowspan="1" colspan="1">9.7</td>
                <td align="left" rowspan="1" colspan="1">12.5</td>
                <td align="left" rowspan="1" colspan="1">18.1</td>
                <td align="left" rowspan="1" colspan="1">18.1</td>
                <td align="left" rowspan="1" colspan="1">18.1</td>
                <td align="left" rowspan="1" colspan="1">19.2</td>
                <td align="left" rowspan="1" colspan="1">3.5</td>
                <td align="left" rowspan="1" colspan="1">3.5</td>
                <td align="left" rowspan="1" colspan="1">3.5</td>
                <td align="left" rowspan="1" colspan="1">4.8</td>
                <td align="left" rowspan="1" colspan="1">7.2</td>
                <td align="left" rowspan="1" colspan="1">7.2</td>
                <td align="left" rowspan="1" colspan="1">3.6</td>
                <td align="left" rowspan="1" colspan="1">4.3</td>
                <td align="left" rowspan="1" colspan="1">4.3</td>
                <td align="left" rowspan="1" colspan="1">4.3</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Alignment</td>
                <td align="left" rowspan="1" colspan="1">Aligned</td>
                <td align="left" rowspan="1" colspan="1">#</td>
                <td align="left" rowspan="1" colspan="1">11,999,827</td>
                <td align="left" rowspan="1" colspan="1">11,870,740</td>
                <td align="left" rowspan="1" colspan="1">11,999,763</td>
                <td align="left" rowspan="1" colspan="1">11,999,936</td>
                <td align="left" rowspan="1" colspan="1">11,998,226</td>
                <td align="left" rowspan="1" colspan="1">11,998,804</td>
                <td align="left" rowspan="1" colspan="1">12,000,000</td>
                <td align="left" rowspan="1" colspan="1">11,995,872</td>
                <td align="left" rowspan="1" colspan="1">11,999,975</td>
                <td align="left" rowspan="1" colspan="1">11,999,763</td>
                <td align="left" rowspan="1" colspan="1">11,999,484</td>
                <td align="left" rowspan="1" colspan="1">11,995,422</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Metrics</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Diff.</td>
                <td align="left" rowspan="1" colspan="1">-</td>
                <td align="left" rowspan="1" colspan="1">−129,087</td>
                <td align="left" rowspan="1" colspan="1">−64</td>
                <td align="left" rowspan="1" colspan="1">109</td>
                <td align="left" rowspan="1" colspan="1">−1,601</td>
                <td align="left" rowspan="1" colspan="1">−1,023</td>
                <td align="left" rowspan="1" colspan="1">173</td>
                <td align="left" rowspan="1" colspan="1">−3,955</td>
                <td align="left" rowspan="1" colspan="1">148</td>
                <td align="left" rowspan="1" colspan="1">−64</td>
                <td align="left" rowspan="1" colspan="1">−343</td>
                <td align="left" rowspan="1" colspan="1">−4,405</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Properly Paired</td>
                <td align="left" rowspan="1" colspan="1">#</td>
                <td align="left" rowspan="1" colspan="1">11,999,460</td>
                <td align="left" rowspan="1" colspan="1">11,742,902</td>
                <td align="left" rowspan="1" colspan="1">11,998,912</td>
                <td align="left" rowspan="1" colspan="1">11,999,344</td>
                <td align="left" rowspan="1" colspan="1">11,996,528</td>
                <td align="left" rowspan="1" colspan="1">11,997,254</td>
                <td align="left" rowspan="1" colspan="1">11,999,976</td>
                <td align="left" rowspan="1" colspan="1">11,995,410</td>
                <td align="left" rowspan="1" colspan="1">11,977,218</td>
                <td align="left" rowspan="1" colspan="1">11,998,994</td>
                <td align="left" rowspan="1" colspan="1">11,997,702</td>
                <td align="left" rowspan="1" colspan="1">11,991,992</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Diff.</td>
                <td align="left" rowspan="1" colspan="1">-</td>
                <td align="left" rowspan="1" colspan="1">−256,558</td>
                <td align="left" rowspan="1" colspan="1">−548</td>
                <td align="left" rowspan="1" colspan="1">−116</td>
                <td align="left" rowspan="1" colspan="1">−2,932</td>
                <td align="left" rowspan="1" colspan="1">−2,206</td>
                <td align="left" rowspan="1" colspan="1">516</td>
                <td align="left" rowspan="1" colspan="1">−4,050</td>
                <td align="left" rowspan="1" colspan="1">−22,242</td>
                <td align="left" rowspan="1" colspan="1">−466</td>
                <td align="left" rowspan="1" colspan="1">−1,758</td>
                <td align="left" rowspan="1" colspan="1">−7,468</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Incorrectly Aligned</td>
                <td align="left" rowspan="1" colspan="1">#</td>
                <td align="left" rowspan="1" colspan="1">40,561</td>
                <td align="left" rowspan="1" colspan="1">138,655</td>
                <td align="left" rowspan="1" colspan="1">143,012</td>
                <td align="left" rowspan="1" colspan="1">141,373</td>
                <td align="left" rowspan="1" colspan="1">147,764</td>
                <td align="left" rowspan="1" colspan="1">85,297</td>
                <td align="left" rowspan="1" colspan="1">95,672</td>
                <td align="left" rowspan="1" colspan="1">99,243</td>
                <td align="left" rowspan="1" colspan="1">99,243</td>
                <td align="left" rowspan="1" colspan="1">56,514</td>
                <td align="left" rowspan="1" colspan="1">61,642</td>
                <td align="left" rowspan="1" colspan="1">61,887</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Diff.</td>
                <td align="left" rowspan="1" colspan="1">-</td>
                <td align="left" rowspan="1" colspan="1">98,094</td>
                <td align="left" rowspan="1" colspan="1">102,451</td>
                <td align="left" rowspan="1" colspan="1">100,812</td>
                <td align="left" rowspan="1" colspan="1">107,203</td>
                <td align="left" rowspan="1" colspan="1">44,736</td>
                <td align="left" rowspan="1" colspan="1">55,111</td>
                <td align="left" rowspan="1" colspan="1">58,682</td>
                <td align="left" rowspan="1" colspan="1">150,036</td>
                <td align="left" rowspan="1" colspan="1">15,953</td>
                <td align="left" rowspan="1" colspan="1">21,081</td>
                <td align="left" rowspan="1" colspan="1">21,326</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Sensitivity<xref ref-type="table-fn" rid="nt107">6</xref>
</td>
                <td align="left" rowspan="1" colspan="1">%</td>
                <td align="left" rowspan="1" colspan="1">99.66%</td>
                <td align="left" rowspan="1" colspan="1">97.77%</td>
                <td align="left" rowspan="1" colspan="1">98.81%</td>
                <td align="left" rowspan="1" colspan="1">98.82%</td>
                <td align="left" rowspan="1" colspan="1">98.75%</td>
                <td align="left" rowspan="1" colspan="1">99.28%</td>
                <td align="left" rowspan="1" colspan="1">99.20%</td>
                <td align="left" rowspan="1" colspan="1">99.14%</td>
                <td align="left" rowspan="1" colspan="1">99.17%</td>
                <td align="left" rowspan="1" colspan="1">99.53%</td>
                <td align="left" rowspan="1" colspan="1">99.48%</td>
                <td align="left" rowspan="1" colspan="1">99.45%</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Diff.</td>
                <td align="left" rowspan="1" colspan="1">-</td>
                <td align="left" rowspan="1" colspan="1">−1.89%</td>
                <td align="left" rowspan="1" colspan="1">−0.85%</td>
                <td align="left" rowspan="1" colspan="1">−0.84%</td>
                <td align="left" rowspan="1" colspan="1">−0.91%</td>
                <td align="left" rowspan="1" colspan="1">−0.38%</td>
                <td align="left" rowspan="1" colspan="1">−0.46%</td>
                <td align="left" rowspan="1" colspan="1">−0.52%</td>
                <td align="left" rowspan="1" colspan="1">−0.49%</td>
                <td align="left" rowspan="1" colspan="1">−0.13%</td>
                <td align="left" rowspan="1" colspan="1">−0.18%</td>
                <td align="left" rowspan="1" colspan="1">−0.21%</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">FDR<xref ref-type="table-fn" rid="nt108">7</xref>
</td>
                <td align="left" rowspan="1" colspan="1">%</td>
                <td align="left" rowspan="1" colspan="1">0.34%</td>
                <td align="left" rowspan="1" colspan="1">1.17%</td>
                <td align="left" rowspan="1" colspan="1">1.19%</td>
                <td align="left" rowspan="1" colspan="1">1.18%</td>
                <td align="left" rowspan="1" colspan="1">1.23%</td>
                <td align="left" rowspan="1" colspan="1">0.71%</td>
                <td align="left" rowspan="1" colspan="1">0.80%</td>
                <td align="left" rowspan="1" colspan="1">0.83%</td>
                <td align="left" rowspan="1" colspan="1">0.83%</td>
                <td align="left" rowspan="1" colspan="1">0.47%</td>
                <td align="left" rowspan="1" colspan="1">0.51%</td>
                <td align="left" rowspan="1" colspan="1">0.52%</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Diff.</td>
                <td align="left" rowspan="1" colspan="1">-</td>
                <td align="left" rowspan="1" colspan="1">0.83%</td>
                <td align="left" rowspan="1" colspan="1">0.85%</td>
                <td align="left" rowspan="1" colspan="1">0.84%</td>
                <td align="left" rowspan="1" colspan="1">0.89%</td>
                <td align="left" rowspan="1" colspan="1">0.37%</td>
                <td align="left" rowspan="1" colspan="1">0.46%</td>
                <td align="left" rowspan="1" colspan="1">0.49%</td>
                <td align="left" rowspan="1" colspan="1">0.49%</td>
                <td align="left" rowspan="1" colspan="1">0.13%</td>
                <td align="left" rowspan="1" colspan="1">0.18%</td>
                <td align="left" rowspan="1" colspan="1">0.18%</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt102">
            <label>1</label>
            <p>Alignment results by the three entries of SOAP3-dp (1/4 SA, 1/2 SA, Full SA) are identical.</p>
          </fn>
          <fn id="nt103">
            <label>2</label>
            <p>The time consumption of BWA is calculated as “align left reads”+“align right reads”+“sampe”. The index loading times of “align right reads” and “sampe” modules are 1 second due to the reason that, index files were cached during “align left reads”. However, datasets larger than the host memory will flush the cache during alignment.</p>
          </fn>
          <fn id="nt104">
            <label>3</label>
            <p>The alignment time consumption of GEM is calculated as “alignment”+“convert to SAM format”. The conversion module was run with 4 threads in consistent with the alignment module.</p>
          </fn>
          <fn id="nt105">
            <label>4</label>
            <p>SOAP3-dp, SOAP3, SeqAlto and GEM aligners explicitly provide index loading time consumption. The index loading time for Bowtie2, CUSHAW2 and BWA are calculated by the total size of index, divided by 100 MB/s, which is the average network file system speed of the testing environment. The index loading time maybe underestimated while the time processing the index was not calculated.</p>
          </fn>
          <fn id="nt106">
            <label>5</label>
            <p>The alignment times were explicitly provided by the aligners (include results processing and input/output time) or calculated by total elapsed time minus estimated index loading time.</p>
          </fn>
          <fn id="nt107">
            <label>6</label>
            <p>Sensitivity is calculated as “Correctly aligned reads”/“All simulated reads”. The higher the better.</p>
          </fn>
          <fn id="nt108">
            <label>7</label>
            <p>FDR is calculated as “Incorrectly aligned reads”/“All aligned reads”. The lower the better.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Mapping quality score is mandatory for most of the popular downstream analysis tools such as GATK and SAMTOOLS. SOAP3-dp uses the same scoring scheme as BWA so as to make its alignment results compatible to the expectations of existing analysis tools. As shown in <xref ref-type="fig" rid="pone-0065632-g003">Figure 3</xref> and Figure S1 in <xref ref-type="supplementary-material" rid="pone.0065632.s003">File S1</xref>, BWA, Bowtie2, SeqAlto, BarraCUDA, CUSHAW2 and SOAP3-dp provide mapping quality scores that can differentiate different alignments properly, while GEM's scores are too rough, and too many incorrectly aligned reads are given high quality scores, which makes it unsuitable for downstream analysis.</p>
      <fig id="pone-0065632-g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0065632.g003</object-id>
        <label>Figure 3</label>
        <caption>
          <title>The accumulated number of incorrectly aligned reads categorized at different mapping quality scores by the five aligners.</title>
        </caption>
        <graphic xlink:href="pone.0065632.g003"/>
      </fig>
    </sec>
    <sec id="s2e">
      <title>Remarks</title>
      <p>Note that GEM can output in a simple format to save time. When compared to SOAP3-dp in its own simple format, GEM and SOAP3-dp can both save about half of their running time; for the 6M simulated paired-end data of length 100 bp, the alignment time of GEM and SOAP3-dp is reduced to 90 seconds and 38 seconds, respectively. Downstream programs for variants calling, if redesigned to utilize these specific formats, could save time.</p>
      <p>The simulated dataset is relatively small (6M read pairs), thus when using a large SA, the index loading time of SOAP3-dp dominated the total elapsed time. Considering only the alignment time (time consumption after index loading, including input of raw reads and output of alignment results), SOAP3-dp using the full and 1/2 SA is 12 and 9 seconds faster than 1/4 SA, thus for large real datasets, 1/2 and full SAs are suggested if memory permits.</p>
      <p>Different generations of GPU device differ in speed. We compared the performance of SOAP3-dp between the latest GPU “GTX680” and a previous generation “Tesla C2070” using simulated datasets. The alignment time extended about 10% for each dataset (<xref ref-type="fig" rid="pone-0065632-g004">Figure 4</xref>) using “Tesla C2070”. Furthermore, a large real set of 150 bp paired-end reads was used. The alignment using the “GTX680” consumed 6,835 seconds, which is 4,658 seconds (1.68 times) faster than “Tesla C2070”.</p>
      <fig id="pone-0065632-g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0065632.g004</object-id>
        <label>Figure 4</label>
        <caption>
          <title>Alignment time consumption of using GPU card “GTX680” and previous generation GPU card “Tesla C2070” respectively.</title>
        </caption>
        <graphic xlink:href="pone.0065632.g004"/>
      </fig>
    </sec>
    <sec id="s2f">
      <title>Variant Calling Performance</title>
      <p>Next, we considered SOAP3-dp's alignment quality for variant calling. The full sets of both PE100 and PE150 were aligned using SOAP3-dp. We used the widely adopted BWA as benchmark. With the alignment results, variants were called using GATK's UnifiedGenotyper <xref rid="pone.0065632-DePristo1" ref-type="bibr">[22]</xref> and filtered by VariantRecalibrators, with and without GATK's local realignment (see <xref ref-type="sec" rid="s4">Methods</xref>). Before we detail the results on variant detection, it is worth mentioning that BWA, even running in a slower mode to allow a longer gap (one gap up to 50 bp, without “-m” parameter to allow hit entries higher than 2 million due to out of memory error), still cannot catch up the sensitivity of SOAP3-dp in default setting (for a 100 bp read, one gap up to 68 bp, to 23 one-bp gaps, <xref ref-type="table" rid="pone-0065632-t003">Table 3</xref>).</p>
      <table-wrap id="pone-0065632-t003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0065632.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title>Summary of alignment and variation calling using SOAP3-dp and BWA with different parameters and datasets.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0065632-t003-3" xlink:href="pone.0065632.t003"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td colspan="2" align="left" rowspan="1">Running time</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td colspan="6" align="left" rowspan="1">SNP</td>
                <td colspan="2" align="left" rowspan="1">Indels</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Program/Type</td>
                <td colspan="2" align="left" rowspan="1">(h)</td>
                <td align="left" rowspan="1" colspan="1">Reads aligned</td>
                <td align="left" rowspan="1" colspan="1">Properly Paired</td>
                <td colspan="3" align="left" rowspan="1">w/o</td>
                <td colspan="3" align="left" rowspan="1">w/</td>
                <td align="left" rowspan="1" colspan="1">w/o</td>
                <td align="left" rowspan="1" colspan="1">w/</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Aln.</td>
                <td align="left" rowspan="1" colspan="1">GATK</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Total</td>
                <td align="left" rowspan="1" colspan="1">dbSNP</td>
                <td align="left" rowspan="1" colspan="1">Homozygous</td>
                <td align="left" rowspan="1" colspan="1">Total</td>
                <td align="left" rowspan="1" colspan="1">dbSNP</td>
                <td align="left" rowspan="1" colspan="1">Homozygous</td>
                <td align="left" rowspan="1" colspan="1">Total</td>
                <td align="left" rowspan="1" colspan="1">Total</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">BWA (Default, PE100)</td>
                <td align="left" rowspan="1" colspan="1">99</td>
                <td align="left" rowspan="1" colspan="1">32</td>
                <td align="left" rowspan="1" colspan="1">93.30%</td>
                <td align="left" rowspan="1" colspan="1">92.10%</td>
                <td align="left" rowspan="1" colspan="1">3,996,730</td>
                <td align="left" rowspan="1" colspan="1">3,926,590</td>
                <td align="left" rowspan="1" colspan="1">1,620,269</td>
                <td align="left" rowspan="1" colspan="1">3,922,841</td>
                <td align="left" rowspan="1" colspan="1">3,876,262</td>
                <td align="left" rowspan="1" colspan="1">1,609,899</td>
                <td align="left" rowspan="1" colspan="1">370,231</td>
                <td align="left" rowspan="1" colspan="1">383,347</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">BWA (-o 1 -e 50 -L, PE100)</td>
                <td align="left" rowspan="1" colspan="1">3,363</td>
                <td align="left" rowspan="1" colspan="1">36</td>
                <td align="left" rowspan="1" colspan="1">96.74%</td>
                <td align="left" rowspan="1" colspan="1">94.80%</td>
                <td align="left" rowspan="1" colspan="1">4,040,813</td>
                <td align="left" rowspan="1" colspan="1">3,955,380</td>
                <td align="left" rowspan="1" colspan="1">1,609,729</td>
                <td align="left" rowspan="1" colspan="1">3,946,627</td>
                <td align="left" rowspan="1" colspan="1">3,896,737</td>
                <td align="left" rowspan="1" colspan="1">1,601,049</td>
                <td align="left" rowspan="1" colspan="1">385,216</td>
                <td align="left" rowspan="1" colspan="1">417,832</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SOAP3-dp (Default, PE100)</td>
                <td align="left" rowspan="1" colspan="1">6</td>
                <td align="left" rowspan="1" colspan="1">35</td>
                <td align="left" rowspan="1" colspan="1">98.03%</td>
                <td align="left" rowspan="1" colspan="1">96.98%</td>
                <td align="left" rowspan="1" colspan="1">4,120,165</td>
                <td align="left" rowspan="1" colspan="1">4,028,414</td>
                <td align="left" rowspan="1" colspan="1">1,615,376</td>
                <td align="left" rowspan="1" colspan="1">4,015,725</td>
                <td align="left" rowspan="1" colspan="1">3,956,371</td>
                <td align="left" rowspan="1" colspan="1">1,604,106</td>
                <td align="left" rowspan="1" colspan="1">407,533</td>
                <td align="left" rowspan="1" colspan="1">406,845</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">BWA (Default, PE150)</td>
                <td align="left" rowspan="1" colspan="1">266</td>
                <td align="left" rowspan="1" colspan="1">46</td>
                <td align="left" rowspan="1" colspan="1">90.30%</td>
                <td align="left" rowspan="1" colspan="1">89.17%</td>
                <td align="left" rowspan="1" colspan="1">3,963,085</td>
                <td align="left" rowspan="1" colspan="1">3,897,866</td>
                <td align="left" rowspan="1" colspan="1">1,621,742</td>
                <td align="left" rowspan="1" colspan="1">3,911,386</td>
                <td align="left" rowspan="1" colspan="1">3,862,977</td>
                <td align="left" rowspan="1" colspan="1">1,616,767</td>
                <td align="left" rowspan="1" colspan="1">350,201</td>
                <td align="left" rowspan="1" colspan="1">384,684</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SOAP3-dp (Default, PE150)</td>
                <td align="left" rowspan="1" colspan="1">14</td>
                <td align="left" rowspan="1" colspan="1">92</td>
                <td align="left" rowspan="1" colspan="1">97.66%</td>
                <td align="left" rowspan="1" colspan="1">96.54%</td>
                <td align="left" rowspan="1" colspan="1">4,139,625</td>
                <td align="left" rowspan="1" colspan="1">4,055,314</td>
                <td align="left" rowspan="1" colspan="1">1,612,213</td>
                <td align="left" rowspan="1" colspan="1">4,067,552</td>
                <td align="left" rowspan="1" colspan="1">4,002,750</td>
                <td align="left" rowspan="1" colspan="1">1,612,351</td>
                <td align="left" rowspan="1" colspan="1">409,925</td>
                <td align="left" rowspan="1" colspan="1">422,427</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt109">
            <p>PE100 and PE150 represent the 100 bp and 150 bp paired-end reads of YH sample. ‘w/’ and ‘w/o’ indicates whether the alignments were processed with and without GATK's local realignment respectively. ‘dbSNP’ is the number of detected SNPs found in dbSNP v135. The running times were rounded to hour.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>SOAP3-dp's better sensitivity is due to its ability of extensive gapped alignment; the extra reads aligned are crucial for variant detection (in particular, Indels). SOAP3-dp allowed 2.4% and 4.0% more SNPs than BWA, and 6.1% and 9.8% more Indels for the two datasets PE100 and PE150, respectively. Intuitively, longer reads are more favorable for variant detection; this is indeed reflected in SOAP3-dp's performance, but not for BWA (<xref ref-type="table" rid="pone-0065632-t003">Table 3</xref>). We further checked the SNPs detected against dbSNP v135 (an archive of SNPs validated by previous studies); SOAP3-dp has notably 2.1% and 3.6% more SNPs found in dbSNP, confirming a higher sensitivity.</p>
      <p>SOAP3-dp allowed more Indels to be detected than BWA, especially more Indels longer than 20 bp (<xref ref-type="fig" rid="pone-0065632-g005">Figures 5a, 5b</xref>, Figure S2 in <xref ref-type="supplementary-material" rid="pone.0065632.s003">File S1</xref>). To validate the novel Indels detected, we randomly selected 50 deletions that SOAP3-dp exclusively detected and are not yet archived in dbSNP v135, and verified them using Fosmid sequencing (see <xref ref-type="sec" rid="s4">Methods</xref>). The Fosmids were sequenced, assembled and then aligned to the reference genome. The 50 deletions were covered by 460 Fosmid sequences. The findings are as follows: 6 deletions were inconclusive due to insufficient coverage of Fosmid sequences, 40 deletions were validated, and 4 rejected, revealing a FDR of 9.1% (Table S15 in <xref ref-type="supplementary-material" rid="pone.0065632.s003">File S1</xref>, Data S2). SOAP3-dp's ability to allow long gaps without speed penalty provides an unprecedented opportunity to come up with a more comprehensive Indel identification in large-scale genome studies.</p>
      <fig id="pone-0065632-g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0065632.g005</object-id>
        <label>Figure 5</label>
        <caption>
          <title>The length distribution of Indels identified by SOAP3-dp and BWA respectively using full set of 100 bp paired-end YH sample reads.</title>
          <p><bold>a.</bold> Indels smaller than or equal to 20 bp, <bold>b.</bold> larger than 20 bp.</p>
        </caption>
        <graphic xlink:href="pone.0065632.g005"/>
      </fig>
      <p>With SOAP3-dp's ability to authentically align more reads, more multi-nucleotide polymorphisms (MNP) among the whole genome were identified (Figure S3 in <xref ref-type="supplementary-material" rid="pone.0065632.s003">File S1</xref>). Notably, GATK's local realignment can eliminate inauthentic alignments and rescue true variants. For SOAP3-dp, the number of MNP increased by 4.1% after realignment; yet for BWA, the number decreased by 6.3% (Table S17 in <xref ref-type="supplementary-material" rid="pone.0065632.s003">File S1</xref>), indicating that SOAP3-dp initially provided much more reliable alignments and led to more accurate variant calling.</p>
    </sec>
  </sec>
  <sec id="s3">
    <title>Discussion</title>
    <p>SOAP3-dp has been successfully deployed on Amazon EC2, NIH BioWulf and Tianhe-1A computing-cloud. On Amazon EC2, users can access SOAP3-dp's program and a testing dataset by mounting EBS snapshot “snap-154f1c54” named “SOAP3-dp” while creating a GPU instance (Supplementary Note). To test out SOAP3-dp's performance on Amazon EC2, we selected 10 Illumina PE datasets from 1000 genomes project, comprising 131.44 Gbp of raw reads (43.8-fold). The 10 datasets were distributed to the two available Tesla M2050 GPU cards (see <xref ref-type="sec" rid="s4">Methods</xref> and Supplementary Note. Notably, Tesla M2050 is slower than the GTX680 and Tesla C2070 we have used for real and simulated data evaluation) with one copy of the index shared in host memory. Using default parameters and BAM output, the alignment finished in 3.8 hours, yielding a total cost of $7.98, or $0.061 per Gbp reads aligned.</p>
    <p>For users' convenience, SOAP3-dp separates the output of reads into three categories: 1) alignments involve gaps and extensive mismatches; 2) few mismatches only and 3) improperly paired or unaligned (file suffix “dpout”, “gout”, and “unpair” respectively). The separate file scheme fits well with the production environments, where files could be sorted separately in parallel and then merged together, which saves time than sorting a single SAM file. The files could also be concatenated by SAMTOOLS easily.</p>
    <p>SOAP3-dp does not enforce a maximum read length. However, read length longer than 500 bp is not recommended while the current version of SOAP3-dp is tailor-made for Illumina reads. A version for longer 454 reads and Ion Torrent reads without performance degradation is our next task.</p>
    <p>Overall, SOAP3-dp is an efficient alignment tool that targets the future of genome analysis where reads are longer and the volume is larger. SOAP3-dp is much faster than existing tools while retaining the ability to align more reads correctly. To be flexible, SOAP3-dp outputs both SAM and BAM formats that are compatible with most downstream analysis tools. SOAP3-dp is a free and open-source alignment tool available at <ext-link ext-link-type="uri" xlink:href="http://www.cs.hku.hk/2bwt-tools/soap3-dp/">http://www.cs.hku.hk/2bwt-tools/soap3-dp/</ext-link>.</p>
  </sec>
  <sec sec-type="methods" id="s4">
    <title>Methods</title>
    <sec id="s4a">
      <title>Implementation details of SOAP3-dp</title>
      <p>To align a paired-end read, SOAP3-dp proceeds in three steps (<xref ref-type="fig" rid="pone-0065632-g001">Figure 1</xref>). In step 1, SOAP3-dp uses GPU-accelerated 2way-BWT <xref rid="pone.0065632-Liu3" ref-type="bibr">[16]</xref> to align those reads without gap opening on to the reference using a 3-level stratified alignment pipeline design. In step 2, for those reads with one end mapped but another end unmapped, a candidate region flanking the mapped end is aligned to the unmapped end using GPU-accelerated dynamic programming algorithm. In step 3, for those reads with both ends unmapped as well as reads still unmapped in step 2, seeds (substrings of a read) are extracted at regular intervals along the read and its reverse complement. SOAP3 module aligns these seeds back to the reference genome and enumerates candidate regions to be aligned to the whole read using dynamic programming.</p>
      <p>To better illustrate SOAP3-dp's detailed workflow and parameters, we have prepared two sets of slides, which should be read together with the text.</p>
      <p>
        <ext-link ext-link-type="uri" xlink:href="http://bio8.cs.hku.hk/dataset/Workflow.ppsx">http://bio8.cs.hku.hk/dataset/Workflow.ppsx</ext-link>
      </p>
      <list list-type="order">
        <list-item>
          <p>SOAP3-dp workflow for paired-end alignment</p>
        </list-item>
        <list-item>
          <p>SOAP3-dp workflow for single-end alignment</p>
        </list-item>
      </list>
      <p>
        <ext-link ext-link-type="uri" xlink:href="http://bio8.cs.hku.hk/dataset/Parameters.ppsx">http://bio8.cs.hku.hk/dataset/Parameters.ppsx</ext-link>
      </p>
      <p>1. Optimization of parallel access to the GPU global memory.</p>
      <p>SOAP3 makes use of the 2way-BWT indexing technique <xref rid="pone.0065632-Lam1" ref-type="bibr">[23]</xref> and involves random access to the indexing data structures in the main memory. The original design of 2way-BWT <xref rid="pone.0065632-Li3" ref-type="bibr">[5]</xref> was based on two-level sampling. The design works well for CPU but not in the highly parallel environment of GPU. The data structures are too large and must be placed into the global memory of GPU, causing serious memory contention among the processors inside the GPU. For this purpose, in SOAP3, the index is redesigned to use one-level sampling instead, which greatly reduces the number of memory accesses by half (for details, one may refer to our previous study <xref rid="pone.0065632-Liu4" ref-type="bibr">[24]</xref>).</p>
      <p>Apart from reducing the number of global memory accesses, we also optimize the time of individual access to the global memory. This is achieved by <italic>coalescing</italic> simultaneous global memory accesses. To illustrate the idea of coalescing, we first need to explain how the GPU handles threads. GPU threads are grouped into units called <italic>warps</italic> for execution on a streaming multiprocessor (SM). The typical size of a warp is 32 threads. At some point, all threads in the same SM access the global memory. Since the threads are working with different data, it is likely that they access different memory locations at the same time. The GPU architecture is designed in a way that, these memory accesses would be much faster if 1) the memory locations accessed are close to each other (e.g. within a 128-byte segment), and 2) no two threads access the same memory location. A group of memory accesses is considered to be <italic>coalesced</italic> if they satisfy the above properties.</p>
      <p>In SOAP3-dp, we try to coalesce as many memory accesses as possible. The global memory of GPU device holds two large data structures – the 2way-BWT index, and the set of reads. To enable coalesced access. the set of reads is partitioned into groups of 32 (equals the warp size). For each group, the reads are arranged as follows. Let <italic>w<sub>i,j</sub></italic> denote the <italic>j</italic>-th word of the <italic>i</italic>-th read in the group (1&lt; = <italic>i</italic>&lt; = 32). Instead of storing the reads in the most natural way, i.e. <italic>w<sub>1,1</sub>, w<sub>1,2</sub>, …, w<sub>1,m</sub>, w<sub>2,1</sub>, w<sub>2,2</sub>, …, w<sub>2,m</sub>, w<sub>3,1</sub>, …</italic> (where <italic>m</italic> is the number of words occupied by each read), we rearrange them into: <italic>w<sub>1,1</sub>, w<sub>2,1</sub>, …, w<sub>32,1</sub>, w<sub>1,2</sub>, w<sub>2,2</sub>, w<sub>3,2</sub>, …, w<sub>32,2</sub>, w<sub>1,3</sub>, …</italic>. When the threads simultaneously access, say, the first words (more precisely, 4 bytes) of the reads, the memory locations accessed are <italic>w<sub>1,1</sub>, w<sub>2,1</sub>, …, w<sub>32,1</sub></italic>, 32 words forming a contiguous 128-byte segment. These coalesced accesses could be done in a single memory transaction with only one time of memory address interpretation, achieving excellent memory throughput.</p>
      <p>Memory accesses to the BWT index are highly unpredictable, thus coalescing them is difficult. Nevertheless, the BWT index is designed as all the BWT information for matching a base was grouped together in a memory chunk (64 bytes), which could be assessed using one memory transaction.</p>
      <p>2. Divergence control and 3-level stratified alignment pipeline.</p>
      <p>GPU works in a single-instruction multiple-thread (SIMT) mode. Processors in the same SM must execute the same instruction at one time. When mismatches are allowed, a read can have more than one branch during alignment. Too many diverging branches however would lower the efficiency of GPU drastically, because most processors (with few branches) may become idle and wait for a few others. For this purpose, we derive a suffix array (SA) ranges count based parameter, which can be determined at runtime, whether a read would generate too many branches, and reads are classified into different levels of complexity according to this parameter. The basic idea is that reads of different levels should be aligned separately. In SOAP3-dp's implementation, we have designed three levels of complexity. For the “all best” output parameter, which outputs all alignment results equally the best, if 2 mismatches are allowed, the SA ranges count dividing the three levels are 4 and 32 respectively (it means that, during alignment, a read with SA ranges count exceeding a threshold after extending a base, will be stopped and scheduled for next level, thresholds for other mismatch allowances and output parameters are included in the “definition.h” file in the source code). In particular, we let the GPU handle the first two levels, and use the CPU to take care of the most complicated reads (which account for a small percentage only). Furthermore, to fully utilize both GPU and CPU processing power, SOAP3 overlaps the alignment of complicated reads from the previous batch in CPU with the alignment of the next batch in GPU (as shown in the Figure S4 in <xref ref-type="supplementary-material" rid="pone.0065632.s003">File S1</xref>).</p>
      <p>3. GPU-accelerated dynamic programming.</p>
      <p>To perform dynamic programming for aligning a read with a candidate region in genome, Smith-Waterman algorithm is applied. However, a straightforward implementation of the algorithm does not fit well under the GPU environment due to the large number of memory accesses. For this purpose, another implementation is suggested so that the number of memory accesses can be reduced by half. In the following, the straightforward implementation is first described, and then it is shown how to be modified in order to decrease the number of memory accesses. Similar implementations have also been applied in ClustalW <xref rid="pone.0065632-Larkin1" ref-type="bibr">[25]</xref> and CUDASW++ before <xref rid="pone.0065632-Liu5" ref-type="bibr">[26]</xref>.</p>
      <p>Given a candidate region <italic>T</italic> (of length <italic>m</italic>) <italic>and</italic> a read <italic>R</italic> (of length <italic>n</italic>), the aim is to find a sub-region <italic>T′</italic> inside <italic>T</italic> such that the alignment score between <italic>R</italic> and <italic>T′</italic> is maximum.</p>
      <p>Let <italic>M</italic>(<italic>i</italic>,<italic>j</italic>) be the maximum alignment score between all suffixes of <italic>T</italic>[1…<italic>i</italic>] and <italic>R</italic>[1…<italic>j</italic>]. The resulting score would be: <inline-formula><inline-graphic xlink:href="pone.0065632.e001.jpg"/></inline-formula>.</p>
      <p>Let <italic>S<sub>MA</sub></italic>, be the score for match, and let <italic>S<sub>MI</sub></italic>, <italic>S<sub>GO</sub></italic>, <italic>S<sub>GE</sub></italic> be the penalty scores for mismatch, gap opening and gap extension. It is also needed to define <italic>I</italic>(<italic>i</italic>,<italic>j</italic>) as the maximum alignment score all suffixes of <italic>T</italic>[…<italic>i</italic>] and <italic>R</italic>[1…<italic>j</italic>] under the condition that <italic>R</italic>[<italic>j</italic>] is aligned to a space, and <italic>D</italic>(<italic>i</italic>,<italic>j</italic>) as the maximum alignment score between all suffixes of <italic>T</italic>[1…<italic>i</italic>] and <italic>R</italic>[1…<italic>j</italic>] under the condition that <italic>T</italic>[<italic>i</italic>] is aligned to a space.</p>
      <p>The recursive formulas are as follows:<disp-formula id="pone.0065632.e002"><graphic xlink:href="pone.0065632.e002.jpg" position="anchor" orientation="portrait"/></disp-formula>where <inline-formula><inline-graphic xlink:href="pone.0065632.e003.jpg"/></inline-formula> if <italic>x</italic> = <italic>y</italic>, or <inline-formula><inline-graphic xlink:href="pone.0065632.e004.jpg"/></inline-formula> if <italic>x</italic>≠<italic>y</italic>.</p>
      <p>And the base cases are:<disp-formula id="pone.0065632.e005"><graphic xlink:href="pone.0065632.e005.jpg" position="anchor" orientation="portrait"/></disp-formula>A straightforward approach of the implementation is as follows:</p>
      <p>Smith-Waterman algorithm: Compute <italic>I</italic>, <italic>D</italic> and <italic>M</italic>
</p>
      <p>1: Initialize tables <italic>I</italic>, <italic>D</italic> and <italic>M</italic> according to the base cases.</p>
      <p>2: For <inline-formula><inline-graphic xlink:href="pone.0065632.e006.jpg"/></inline-formula>
</p>
      <p>3:  For <inline-formula><inline-graphic xlink:href="pone.0065632.e007.jpg"/></inline-formula>
</p>
      <p>4:   <inline-formula><inline-graphic xlink:href="pone.0065632.e008.jpg"/></inline-formula>
</p>
      <p>5:   <inline-formula><inline-graphic xlink:href="pone.0065632.e009.jpg"/></inline-formula>
</p>
      <p>6:   <inline-formula><inline-graphic xlink:href="pone.0065632.e010.jpg"/></inline-formula>
</p>
      <p>7:  End for</p>
      <p>8: End for</p>
      <p>To implement this straightforward approach on GPU, tables <italic>I</italic>, <italic>D</italic> and <italic>M</italic> are created inside the GPU's global memory. The fact that the access of GPU's global memory is much slower than its arithmetic operation affects the efficiency of the algorithm. In every loop, there are 7 table-reading and 3 table-writing operations.</p>
      <p>It is realized that backtracking could be done with only tables <italic>D</italic> and <italic>M</italic>, thus the table <italic>I</italic> can be eliminated. For this purpose, another approach is suggested as follows, which requires only 2 table-reading and 2 table-writing operations in each loop.</p>
      <p>Improved implementation of Smith-Waterman algorithm for GPU:</p>
      <p>Compute <italic>D</italic> and <italic>M</italic>
</p>
      <p>1: Declare register variables: <italic>M<sup>u</sup></italic>, <italic>M<sup>d</sup></italic>, <inline-formula><inline-graphic xlink:href="pone.0065632.e011.jpg"/></inline-formula>
</p>
      <p> (note: <italic>M<sup>u</sup></italic> refers to <italic>M</italic>(<italic>i</italic>−1, <italic>j</italic>−1) and <italic>M<sup>d</sup></italic> refers to <italic>M</italic>(<italic>i</italic>−1, <italic>j</italic>))</p>
      <p>2: Initialize tables <italic>D</italic> and <italic>M</italic> according to the base cases.</p>
      <p>3: For <inline-formula><inline-graphic xlink:href="pone.0065632.e012.jpg"/></inline-formula>
</p>
      <p>4:  <inline-formula><inline-graphic xlink:href="pone.0065632.e013.jpg"/></inline-formula>
</p>
      <p>5:  For <inline-formula><inline-graphic xlink:href="pone.0065632.e014.jpg"/></inline-formula>
</p>
      <p>6:   <inline-formula><inline-graphic xlink:href="pone.0065632.e015.jpg"/></inline-formula>
</p>
      <p>7:   <inline-formula><inline-graphic xlink:href="pone.0065632.e016.jpg"/></inline-formula>
</p>
      <p>8:   <inline-formula><inline-graphic xlink:href="pone.0065632.e017.jpg"/></inline-formula>
</p>
      <p>9:   <inline-formula><inline-graphic xlink:href="pone.0065632.e018.jpg"/></inline-formula>
</p>
      <p>10:   <inline-formula><inline-graphic xlink:href="pone.0065632.e019.jpg"/></inline-formula>
</p>
      <p>11:   <inline-formula><inline-graphic xlink:href="pone.0065632.e020.jpg"/></inline-formula>
</p>
      <p>12:   <inline-formula><inline-graphic xlink:href="pone.0065632.e021.jpg"/></inline-formula>
</p>
      <p>13:  End for</p>
      <p>14: End for</p>
      <p>4. Effort Limit for Dynamic Programming.</p>
      <p>Reads with seeds that match an exceedingly large amount of places on the genome can spur an excessively large number of dynamic programming problems. For example, a poly-A homopolymer could match over ten thousand loci in the genome. SOAP3-dp avoids executing an excessive number of dynamic programming problems by adopting a ceiling on the number of candidate regions in step 2 and step 3. Candidate regions are scored with number of supporting seeds and sorted descendingly. If the ceiling is set to 30, for example, SOAP3-dp will only perform dynamic programming alignment in the best 30 candidate regions. The ceiling is set in the configuration file, but values higher than the default may strongly affect the performance with limited accuracy improvement.</p>
      <p>5. Paired-end alignment.</p>
      <p>SOAP3-dp supports alignment of paired-end reads in which both ends of a single DNA fragment are sequenced. The user sets expected minimum and maximum fragment lengths using –v and –u parameters, as well as orientations of the ends in configuration file (typically, Illumina uses Forward-Reverse while SOLiD uses Forward-Forward). A paired-end alignment that matches these expectations is called “properly paired” and an alignment that violates these expectations is “unpaired”. If a pair fails to be aligned as properly paired, SOAP3-dp attempts to align each end individually. This is similar to both BWA's and Bowtie2's behavior. When a read pair fails to be aligned properly but both ends could be aligned individually, SOAP3-dp reports these alignments.</p>
      <p>In contrast to BWA and SOAP2, which rely on a mapped end to determine a candidate region for further dynamic programming alignment, SOAP3-dp could align those reads with both ends unmapped. This allows read pairs from large period of variation hotspots to be aligned.</p>
      <p>6. Scoring functions.</p>
      <p>Details discussed in Supplementary Note.</p>
    </sec>
    <sec id="s4b">
      <title>Simulation of single-end and paired-end reads</title>
      <p>Mason 0.1 <xref rid="pone.0065632-Doring1" ref-type="bibr">[21]</xref> was used to simulate reads using the GRCh37 major build human reference genome, including 22 pairs of autosomes, 2 sex chromosomes and a mitochondrial chromosome. For the paired Illumina-style datasets with read length ranging from 50 bp to 250 bp, Mason was run in ‘Illumina’ read mode with options -N 6000000 –source-no-N -mp -sq -ll 500 -le 25 -rn 2 -hn 2 –haplotype-snp-rate 0.001 –haplotype-indel-rate 0.0001 –haplotype-no-N -n 100 -pi 0 -pd 0 –no-N'. Each PE set was simulated to contain exactly 12 million reads (6M pairs), which is about 2 times the default batch size of SOAP3-dp.</p>
      <p>All simulated datasets are available at <ext-link ext-link-type="uri" xlink:href="http://bio8.cs.hku.hk/dataset/">http://bio8.cs.hku.hk/dataset/</ext-link>.</p>
    </sec>
    <sec id="s4c">
      <title>Simulation comparison between tools</title>
      <p>Executable files for SOAP3-dp v2.3, Bowtie2 v2.0.0-beta4, BWA 0.6.2, SeqAlto basic 0.5-r123, BarraCUDA_r232, CUSHAW-1.0.40, CUSHAW2-v2.1.9, SOAP3_version146 and GEM-core_i3-20121106-022124 were obtained via standard build procedures with default arguments. We indexed the reference genome with each tool's default indexing parameters. SeqAlto uses 22 bp seed length and sub-sampled mode. “Running time” was measured from initial call of the aligner to the completion of SAM-format output. ‘Reads aligned’ was measured as the number of reads for which the tool found at least one alignment regardless of mapping score. ‘Properly paired’ was measured as the number of read-pairs aligned with proper read orientation and insert-size range (mean insert-size ±3*standard deviation). ‘Peak memory’ and ‘Average memory’ usage was measured by tracking the Linux's <italic>proc</italic> file-system with respective <italic>process id</italic>.</p>
      <p>For BWA and BarraCUDA, separate calls of the software modules were required for aligning each end and for processing intermediate alignment results into a final SAM file. ‘Running time’ was measured for separate modules while ‘Peak memory’ and ‘Average memory’ were measured across all modules. For GEM, to be consistent with other tools, a conversion is necessary after alignment to obtain SAM format results with mapping quality. Time consumptions were measured separately and then summed for comparison to other tools. All tools or components were run with 4 threads (except for the alignment module of BarraCUDA, where the CPU thread is constantly 1). Parameters were listed in Supplementary Note as receipts.</p>
      <p>The experiments used a single computing node running CentOS v6.3 with an Intel i7-3930k 3.2 Ghz quad-core processor, an Nvidia GTX 680 GPU card with 4 GB non-ECC (Error-correcting code) graphic memory and 64 GB non-ECC memory.</p>
      <p>Scripts and command lines to evaluate the authenticity of aligned reads and generate the ROC curves are available at <ext-link ext-link-type="uri" xlink:href="http://bio8.cs.hku.hk/dataset/">http://bio8.cs.hku.hk/dataset/</ext-link>.</p>
    </sec>
    <sec id="s4d">
      <title>YH data production</title>
      <p>Genomic DNA was isolated using standard molecular biology techniques. For each short insert library, 5 µg of DNA was fragmented, end-repaired, A-tailed and ligated to Illumina paired-end adapters. The ligated fragments of 100 bp paired-end reads (PE100) were size-selected at 170 bp and 500 bp on agarose gels, while PE150 were size-selected at 240 bp. All libraries are amplified by LM-PCR to yield the corresponding short insert libraries. PE100 were sequenced using TruSeq v2 while PE150 were sequenced using TruSeq v3 reagent on the Illumina sequencing platform.</p>
    </sec>
    <sec id="s4e">
      <title>Real data comparison</title>
      <p>The 100 bp and 150 bp paired-end Illumina HiSeq 2000 reads of YH sample were sequenced and deposited to EBI with study accession number ERP001652. The data are also available at <ext-link ext-link-type="uri" xlink:href="http://yh.genomics.org.cn">http://yh.genomics.org.cn</ext-link>.</p>
      <p>SOAP3-dp uses default parameters. BWA uses both default parameters and “-o 1 –e 50”, which allows at most a gap not longer than 50 bp (-m option to elevate the 2M hits limit for each read was not applied due to out of memory error, the option allows more reads to be aligned but consumes much more memory and longer alignment time). The latter option allows more reads to be aligned and more indel signals to be discovered, but would enormously decrease the running speed. Alignments were post-processed by following procedures: 1) local realignment by GATK v2.1, 2) duplication removal by Picard v1.74, 3) base quality score recalibration, 4) variants calling by UnifiedGenotyper and 5) variants quality score recalibration by GATK v1.6. Step 1 is optional according to the experiment while steps 2 to 5 are mandatory. Parameters and known variant sets were set according to the GATK's Best Practice v4 on GATK's website.</p>
      <p>SOAP3-dp used a single node with a quad-core Intel Xeon E5570 2.93 Ghz CPU and a GPU while BWA used 10 nodes with the same CPU. To imitate the real production environment, we used Nvidia Tesla C2070 GPU device with 6 G graphic memory and with ECC enabled to perform full YH dataset alignment.</p>
    </sec>
    <sec id="s4f">
      <title>Fosmid sequencing</title>
      <p>Fosmid libraries (averagely 40 kbp in size) were constructed according to Kim et al. <xref rid="pone.0065632-Kim1" ref-type="bibr">[27]</xref>. In total, ∼100 k Fosmid clones were created and every 30 Fosmids were pooled together sharing a barcode for Illumina HiSeq 2000 sequencing. For each pool, one 200 bp and one 500 bp insert size libraries were constructed and sequenced at 20× respectively. If a library had problem of abnormal base content bias or a relatively high base error rate reported by base-calling software, we took it as a non-qualified library and performed sequencing again. Each pool was assembled with SOAPdenovo <xref rid="pone.0065632-Li7" ref-type="bibr">[28]</xref> using 63-mer and other parameters as default. Sequences solved by SOAPdenovo's repeat solving module were remembered and soft-masked in final sequences in order not to obscure the following alignment. The assembled sequences were aligned to the human reference genome using BWASW with default parameters. Most of the Fosmid clones could be assembled to full length. For fragmented Fosmid clone sequences, we further assembled the fragments according to the in-pool linkage information during alignment. We require over 90% of a Fosmid clone sequence to be linearly aligned to only one location in the reference genome. Finally, 460 Fosmid clones were found covering the 50 randomly selected SOAP3-dp specific deletion calls that are not yet archived in dbSNP v135. We define “a Fosmid sequence supporting a deletion” as over 80% of the deleted bases in reference genome cannot be covered by the aligned Fosmid sequence (excluding soft-masked bases), and the identity of the 200 bp alignments flanking the deletion should exceed 90%. While a Fosmid clone can only come from a haploid, we require a heterozygous deletion has at least a Fosmid supporting the deletion, while a homozygous deletion should only have Fosmids supporting the deletion. Heterozygous deletions with lower than 5 spanning Fosmids and without a Fosmid supporting the deletion will be classified as “not clear”. Homozygous deletions without a spanning Fosmid will also be classified as “not clear” (Table S15, <xref ref-type="supplementary-material" rid="pone.0065632.s002">Data S2</xref>).</p>
      <p>The assembled Fosmid sequences are available as <xref ref-type="supplementary-material" rid="pone.0065632.s001">Data S1</xref> in BAM file format. Raw reads are available upon request.</p>
    </sec>
    <sec id="s4g">
      <title>Experiment on Amazon EC2</title>
      <p>The experiment used a single GPU Quadruple Extra Large Instance (cg1.4xlarge, $2.1 per hour) rented from the Amazon Elastic Compute Cloud (EC2) service (<ext-link ext-link-type="uri" xlink:href="http://aws.amazon.com/ec2">http://aws.amazon.com/ec2</ext-link>). The instance has 2 quad-core Intel Xeon X5570 at 2.93 GHz with hyper-threading, 2 Nvidia Tesla M2050 GPU cards with 3 GB ECC graphic-memory per card, 22 gigabytes of physical memory and runs Amazon Linux AMI v2012.09 operating system. Alignments were distributed onto the two GPU cards with two SOAP3-dp processes sharing the same copy of index in host memory. Each process occupies at most 7 threads. 10 sets of Illumina HiSeq 2000 reads generated in 1000 genomes project (Supplementary Note) were downloaded from the Amazon Simple Storage Service (S3). Additional tests have been carried out by NIH biowulf laboratory (<ext-link ext-link-type="uri" xlink:href="http://biowulf.nih.gov/apps/bioinf-gpu.html">http://biowulf.nih.gov/apps/bioinf-gpu.html</ext-link>) and Tianhe-1A super-computing center (<ext-link ext-link-type="uri" xlink:href="http://en.wikipedia.org/wiki/Tianhe-I">http://en.wikipedia.org/wiki/Tianhe-I</ext-link>). While these clouds host CPU and GPU computing nodes and centralized storage system, the ultra-fast SOAP3-dp could be easily integrated into existing pipelines.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="s5">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0065632.s001">
      <label>Data S1</label>
      <caption>
        <p>
          <bold>Assembled Fosmids sequences in BAM file.</bold>
        </p>
        <p>(BAM)</p>
      </caption>
      <media xlink:href="pone.0065632.s001.bam">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0065632.s002">
      <label>Data S2</label>
      <caption>
        <p><bold>Supplementary Table S16.</bold> Table S16.xls.</p>
        <p>(XLS)</p>
      </caption>
      <media xlink:href="pone.0065632.s002.xls">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0065632.s003">
      <label>File S1</label>
      <caption>
        <p>
          <bold>Supplementary Tables, Figures, Notes and Receipts.</bold>
        </p>
        <p>(DOC)</p>
      </caption>
      <media xlink:href="pone.0065632.s003.doc">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank the four anonymous reviewers for their professional and constructive suggestions.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0065632-The1">
      <label>1</label>
      <mixed-citation publication-type="journal"><collab>The 1000 Genomes Project Consortium</collab> (<year>2010</year>) <article-title>A map of human genome variation from population-scale sequencing</article-title>. <source>Nature</source>
<volume>467</volume>: <fpage>1061</fpage>–<lpage>1073</lpage>.<pub-id pub-id-type="pmid">20981092</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0065632-Li1">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Ruan</surname><given-names>J</given-names></name>, <name><surname>Durbin</surname><given-names>R</given-names></name> (<year>2008</year>) <article-title>Mapping short DNA sequencing reads and calling variants using mapping quality scores</article-title>. <source>Genome Res</source>
<volume>18</volume>: <fpage>1851</fpage>–<lpage>1858</lpage>.<pub-id pub-id-type="pmid">18714091</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0065632-Langmead1">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Langmead</surname><given-names>B</given-names></name>, <name><surname>Trapnell</surname><given-names>C</given-names></name>, <name><surname>Pop</surname><given-names>M</given-names></name>, <name><surname>Salzberg</surname><given-names>SL</given-names></name> (<year>2009</year>) <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>. <source>Genome biology</source>
<volume>10</volume>: <fpage>R25</fpage>.<pub-id pub-id-type="pmid">19261174</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0065632-Li2">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Durbin</surname><given-names>R</given-names></name> (<year>2009</year>) <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source>
<volume>25</volume>: <fpage>1754</fpage>–<lpage>1760</lpage>.<pub-id pub-id-type="pmid">19451168</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0065632-Li3">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>R</given-names></name>, <name><surname>Yu</surname><given-names>C</given-names></name>, <name><surname>Li</surname><given-names>Y</given-names></name>, <name><surname>Lam</surname><given-names>TW</given-names></name>, <name><surname>Yiu</surname><given-names>SM</given-names></name>, <etal>et al</etal> (<year>2009</year>) <article-title>SOAP2: an improved ultrafast tool for short read alignment</article-title>. <source>Bioinformatics</source>
<volume>25</volume>: <fpage>1966</fpage>–<lpage>1967</lpage>.<pub-id pub-id-type="pmid">19497933</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0065632-Li4">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>Y</given-names></name>, <name><surname>Zheng</surname><given-names>H</given-names></name>, <name><surname>Luo</surname><given-names>R</given-names></name>, <name><surname>Wu</surname><given-names>H</given-names></name>, <name><surname>Zhu</surname><given-names>H</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Structural variation in two human genomes mapped at single-nucleotide resolution by whole genome de novo assembly</article-title>. <source>Nat Biotechnol</source>
<volume>29</volume>: <fpage>723</fpage>–<lpage>730</lpage>.<pub-id pub-id-type="pmid">21785424</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0065632-Mullaney1">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Mullaney</surname><given-names>JM</given-names></name>, <name><surname>Mills</surname><given-names>RE</given-names></name>, <name><surname>Pittard</surname><given-names>WS</given-names></name>, <name><surname>Devine</surname><given-names>SE</given-names></name> (<year>2010</year>) <article-title>Small insertions and deletions (INDELs) in human genomes</article-title>. <source>Hum Mol Genet</source>
<volume>19</volume>: <fpage>R131</fpage>–<lpage>136</lpage>.<pub-id pub-id-type="pmid">20858594</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0065632-Mu1">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Mu</surname><given-names>JC</given-names></name>, <name><surname>Jiang</surname><given-names>H</given-names></name>, <name><surname>Kiani</surname><given-names>A</given-names></name>, <name><surname>Mohiyuddin</surname><given-names>M</given-names></name>, <name><surname>Bani Asadi</surname><given-names>N</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>Fast and accurate read alignment for resequencing</article-title>. <source>Bioinformatics</source>
<volume>28</volume>: <fpage>2366</fpage>–<lpage>2373</lpage>.<pub-id pub-id-type="pmid">22811546</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0065632-Liu1">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>Y</given-names></name>, <name><surname>Schmidt</surname><given-names>B</given-names></name> (<year>2012</year>) <article-title>Long read alignment based on maximal exact match seeds</article-title>. <source>Bioinformatics</source>
<volume>28</volume>: <fpage>i318</fpage>–<lpage>i324</lpage>.<pub-id pub-id-type="pmid">22962447</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0065632-MarcoSola1">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Marco-Sola</surname><given-names>S</given-names></name>, <name><surname>Sammeth</surname><given-names>M</given-names></name>, <name><surname>Guigo</surname><given-names>R</given-names></name>, <name><surname>Ribeca</surname><given-names>P</given-names></name> (<year>2012</year>) <article-title>The GEM mapper: fast, accurate and versatile alignment by filtration</article-title>. <source>Nat Methods</source>
<volume>9</volume>: <fpage>1185</fpage>–<lpage>1188</lpage>.<pub-id pub-id-type="pmid">23103880</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0065632-Zaharia1">
      <label>11</label>
      <mixed-citation publication-type="other">Zaharia M, Bolosky WJ, Curtis K, Fox A, Patterson D, <etal>et al</etal>.. (2011) Faster and More Accurate Sequence Alignment with SNAP. arXiv 1111.5572v1.</mixed-citation>
    </ref>
    <ref id="pone.0065632-Ewing1">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Ewing</surname><given-names>B</given-names></name>, <name><surname>Green</surname><given-names>P</given-names></name> (<year>1998</year>) <article-title>Base-calling of automated sequencer traces using phred. II. Error probabilities</article-title>. <source>Genome Res</source>
<volume>8</volume>: <fpage>186</fpage>–<lpage>194</lpage>.<pub-id pub-id-type="pmid">9521922</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0065632-Nvidia1">
      <label>13</label>
      <mixed-citation publication-type="other">Nvidia (2012) Bioinformatics and Life Sciences.</mixed-citation>
    </ref>
    <ref id="pone.0065632-Liu2">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>Y</given-names></name>, <name><surname>Schmidt</surname><given-names>B</given-names></name>, <name><surname>Maskell</surname><given-names>DL</given-names></name> (<year>2012</year>) <article-title>CUSHAW: a CUDA compatible short read aligner to large genomes based on the Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source>
<volume>28</volume>: <fpage>1830</fpage>–<lpage>1837</lpage>.<pub-id pub-id-type="pmid">22576173</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0065632-Klus1">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Klus</surname><given-names>P</given-names></name>, <name><surname>Lam</surname><given-names>S</given-names></name>, <name><surname>Lyberg</surname><given-names>D</given-names></name>, <name><surname>Cheung</surname><given-names>MS</given-names></name>, <name><surname>Pullan</surname><given-names>G</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>BarraCUDA - a fast short read sequence aligner using graphics processing units</article-title>. <source>BMC Res Notes</source>
<volume>5</volume>: <fpage>27</fpage>.<pub-id pub-id-type="pmid">22244497</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0065632-Liu3">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>CM</given-names></name>, <name><surname>Wong</surname><given-names>T</given-names></name>, <name><surname>Wu</surname><given-names>E</given-names></name>, <name><surname>Luo</surname><given-names>R</given-names></name>, <name><surname>Yiu</surname><given-names>SM</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>SOAP3: ultra-fast GPU-based parallel alignment tool for short reads</article-title>. <source>Bioinformatics</source>
<volume>28</volume>: <fpage>878</fpage>–<lpage>879</lpage>.<pub-id pub-id-type="pmid">22285832</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0065632-Wang1">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>J</given-names></name>, <name><surname>Wang</surname><given-names>W</given-names></name>, <name><surname>Li</surname><given-names>R</given-names></name>, <name><surname>Li</surname><given-names>Y</given-names></name>, <name><surname>Tian</surname><given-names>G</given-names></name>, <etal>et al</etal> (<year>2008</year>) <article-title>The diploid genome sequence of an Asian individual</article-title>. <source>Nature</source>
<volume>456</volume>: <fpage>60</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">18987735</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0065632-Li5">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Durbin</surname><given-names>R</given-names></name> (<year>2010</year>) <article-title>Fast and accurate long-read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source>
<volume>26</volume>: <fpage>589</fpage>–<lpage>595</lpage>.<pub-id pub-id-type="pmid">20080505</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0065632-McKenna1">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>McKenna</surname><given-names>A</given-names></name>, <name><surname>Hanna</surname><given-names>M</given-names></name>, <name><surname>Banks</surname><given-names>E</given-names></name>, <name><surname>Sivachenko</surname><given-names>A</given-names></name>, <name><surname>Cibulskis</surname><given-names>K</given-names></name>, <etal>et al</etal> (<year>2010</year>) <article-title>The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>. <source>Genome Res</source>
<volume>20</volume>: <fpage>1297</fpage>–<lpage>1303</lpage>.<pub-id pub-id-type="pmid">20644199</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0065632-Li6">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Handsaker</surname><given-names>B</given-names></name>, <name><surname>Wysoker</surname><given-names>A</given-names></name>, <name><surname>Fennell</surname><given-names>T</given-names></name>, <name><surname>Ruan</surname><given-names>J</given-names></name>, <etal>et al</etal> (<year>2009</year>) <article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source>
<volume>25</volume>: <fpage>2078</fpage>–<lpage>2079</lpage>.<pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0065632-Doring1">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Doring</surname><given-names>A</given-names></name>, <name><surname>Weese</surname><given-names>D</given-names></name>, <name><surname>Rausch</surname><given-names>T</given-names></name>, <name><surname>Reinert</surname><given-names>K</given-names></name> (<year>2008</year>) <article-title>SeqAn an efficient, generic C++ library for sequence analysis</article-title>. <source>BMC Bioinformatics</source>
<volume>9</volume>: <fpage>11</fpage>.<pub-id pub-id-type="pmid">18184432</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0065632-DePristo1">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>DePristo</surname><given-names>MA</given-names></name>, <name><surname>Banks</surname><given-names>E</given-names></name>, <name><surname>Poplin</surname><given-names>R</given-names></name>, <name><surname>Garimella</surname><given-names>KV</given-names></name>, <name><surname>Maguire</surname><given-names>JR</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>. <source>Nat Genet</source>
<volume>43</volume>: <fpage>491</fpage>–<lpage>498</lpage>.<pub-id pub-id-type="pmid">21478889</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0065632-Lam1">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Lam</surname><given-names>TW</given-names></name>, <name><surname>Li</surname><given-names>R</given-names></name>, <name><surname>Tam</surname><given-names>A</given-names></name>, <name><surname>Wong</surname><given-names>S</given-names></name>, <name><surname>Wu</surname><given-names>E</given-names></name>, <etal>et al</etal><article-title>High throughput short read alignment via bi-directional BWT; 2009. </article-title>. <source>IEEE</source><fpage>31</fpage>–<lpage>36</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0065632-Liu4">
      <label>24</label>
      <mixed-citation publication-type="other">Liu C, Lam T, Wong T, Wu E, Yiu S, <etal>et al</etal>.. (2011) SOAP3: GPU-based compressed indexing and ultra-fast parallel alignment of short reads. The 3rd Workshop on Massive Data Algorithmics (MASSIVE 2011). Paris, France.</mixed-citation>
    </ref>
    <ref id="pone.0065632-Larkin1">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Larkin</surname><given-names>MA</given-names></name>, <name><surname>Blackshields</surname><given-names>G</given-names></name>, <name><surname>Brown</surname><given-names>NP</given-names></name>, <name><surname>Chenna</surname><given-names>R</given-names></name>, <name><surname>McGettigan</surname><given-names>PA</given-names></name>, <etal>et al</etal> (<year>2007</year>) <article-title>Clustal W and Clustal X version 2.0</article-title>. <source>Bioinformatics</source>
<volume>23</volume>: <fpage>2947</fpage>–<lpage>2948</lpage>.<pub-id pub-id-type="pmid">17846036</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0065632-Liu5">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>Y</given-names></name>, <name><surname>Maskell</surname><given-names>DL</given-names></name>, <name><surname>Schmidt</surname><given-names>B</given-names></name> (<year>2009</year>) <article-title>CUDASW++: optimizing Smith-Waterman sequence database searches for CUDA-enabled graphics processing units</article-title>. <source>BMC Res Notes</source>
<volume>2</volume>: <fpage>73</fpage>.<pub-id pub-id-type="pmid">19416548</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0065632-Kim1">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Kim</surname><given-names>UJ</given-names></name>, <name><surname>Shizuya</surname><given-names>H</given-names></name>, <name><surname>de Jong</surname><given-names>PJ</given-names></name>, <name><surname>Birren</surname><given-names>B</given-names></name>, <name><surname>Simon</surname><given-names>MI</given-names></name> (<year>1992</year>) <article-title>Stable propagation of cosmid sized human DNA inserts in an F factor based vector</article-title>. <source>Nucleic Acids Res</source>
<volume>20</volume>: <fpage>1083</fpage>–<lpage>1085</lpage>.<pub-id pub-id-type="pmid">1549470</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0065632-Li7">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>R</given-names></name>, <name><surname>Zhu</surname><given-names>H</given-names></name>, <name><surname>Ruan</surname><given-names>J</given-names></name>, <name><surname>Qian</surname><given-names>W</given-names></name>, <name><surname>Fang</surname><given-names>X</given-names></name>, <etal>et al</etal> (<year>2010</year>) <article-title>De novo assembly of human genomes with massively parallel short read sequencing</article-title>. <source>Genome Res</source>
<volume>20</volume>: <fpage>265</fpage>–<lpage>272</lpage>.<pub-id pub-id-type="pmid">20019144</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
