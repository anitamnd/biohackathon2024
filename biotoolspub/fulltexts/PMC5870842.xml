<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5870842</article-id>
    <article-id pub-id-type="pmid">28541377</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btx337</article-id>
    <article-id pub-id-type="publisher-id">btx337</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ASAP: a web-based platform for the analysis and interactive visualization of single-cell RNA-seq data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Gardeux</surname>
          <given-names>Vincent</given-names>
        </name>
        <xref ref-type="aff" rid="btx337-aff1">1</xref>
        <xref ref-type="aff" rid="btx337-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>David</surname>
          <given-names>Fabrice P A</given-names>
        </name>
        <xref ref-type="aff" rid="btx337-aff2">2</xref>
        <xref ref-type="aff" rid="btx337-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shajkofci</surname>
          <given-names>Adrian</given-names>
        </name>
        <xref ref-type="aff" rid="btx337-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schwalie</surname>
          <given-names>Petra C</given-names>
        </name>
        <xref ref-type="aff" rid="btx337-aff1">1</xref>
        <xref ref-type="aff" rid="btx337-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Deplancke</surname>
          <given-names>Bart</given-names>
        </name>
        <xref ref-type="aff" rid="btx337-aff1">1</xref>
        <xref ref-type="aff" rid="btx337-aff2">2</xref>
        <xref ref-type="corresp" rid="btx337-cor1"/>
        <!--<email>bart.deplancke@epfl.ch</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Stegle</surname>
          <given-names>Oliver</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btx337-aff1"><label>1</label>Institute of Bioengineering, School of Life Sciences, École Polytechnique Fédérale de Lausanne (EPFL), Lausanne, Switzerland</aff>
    <aff id="btx337-aff2"><label>2</label>Swiss Institute of Bioinformatics, Lausanne, Switzerland</aff>
    <aff id="btx337-aff3"><label>3</label>Bioinformatics and Biostatistics Core Facility, EPFL, Lausanne, Switzerland</aff>
    <author-notes>
      <corresp id="btx337-cor1">To whom correspondence should be addressed. Email: <email>bart.deplancke@epfl.ch</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>10</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-05-24">
      <day>24</day>
      <month>5</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>5</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>33</volume>
    <issue>19</issue>
    <fpage>3123</fpage>
    <lpage>3125</lpage>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>12</month>
        <year>2016</year>
      </date>
      <date date-type="rev-recd">
        <day>30</day>
        <month>3</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>5</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by-nc/4.0/" license-type="cc-by-nc">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btx337.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="SA1">
        <title>Motivation</title>
        <p>Single-cell RNA-sequencing (scRNA-seq) allows whole transcriptome profiling of thousands of individual cells, enabling the molecular exploration of tissues at the cellular level. Such analytical capacity is of great interest to many research groups in the world, yet these groups often lack the expertise to handle complex scRNA-seq datasets.</p>
      </sec>
      <sec id="SA2">
        <title>Results</title>
        <p>We developed a fully integrated, web-based platform aimed at the complete analysis of scRNA-seq data post genome alignment: from the parsing, filtering and normalization of the input count data files, to the visual representation of the data, identification of cell clusters, differentially expressed genes (including cluster-specific marker genes), and functional gene set enrichment. This Automated Single-cell Analysis Pipeline (ASAP) combines a wide range of commonly used algorithms with sophisticated visualization tools. Compared with existing scRNA-seq analysis platforms, researchers (including those lacking computational expertise) are able to interact with the data in a straightforward fashion and in real time. Furthermore, given the overlap between scRNA-seq and bulk RNA-seq analysis workflows, ASAP should conceptually be broadly applicable to any RNA-seq dataset. As a validation, we demonstrate how we can use ASAP to simply reproduce the results from a single-cell study of 91 mouse cells involving five distinct cell types.</p>
      </sec>
      <sec id="SA3">
        <title>Availability and implementation</title>
        <p>The tool is freely available at asap.epfl.ch and R/Python scripts are available at github.com/DeplanckeLab/ASAP.</p>
      </sec>
      <sec id="SA4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Swiss National Science Foundation</named-content>
          <named-content content-type="funder-identifier">10.13039/501100001711</named-content>
        </funding-source>
        <award-id>#31003A_162735</award-id>
        <award-id>#IZLIZ3_156815</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">EPFL</named-content>
          <named-content content-type="funder-identifier">10.13039/501100001703</named-content>
        </funding-source>
        <award-id>LT001032/2013</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Several bioinformatic platforms have been developed that aim to lower the entry point to ‘-omic’ type of analyses (<xref rid="btx337-B1" ref-type="bibr">Afgan <italic>et al.</italic>, 2016</xref>; <xref rid="btx337-B12" ref-type="bibr">Reich <italic>et al.</italic>, 2006</xref>). The latter include pipelines dedicated to single-cell analyses such as SINCERA (<xref rid="btx337-B7" ref-type="bibr">Guo <italic>et al.</italic>, 2015</xref>), SEURAT (<xref rid="btx337-B13" ref-type="bibr">Satija <italic>et al.</italic>, 2015</xref>), MAST (<xref rid="btx337-B6" ref-type="bibr">Finak <italic>et al.</italic>, 2015</xref>), PAGODA (<xref rid="btx337-B5" ref-type="bibr">Fan <italic>et al.</italic>, 2016</xref>) or SC3 (<xref rid="btx337-B9" ref-type="bibr">Kiselev <italic>et al.</italic>, 2016</xref>). However, these pipelines are embedded in R which makes them still computationally complex. For example, SC3 has preprocessing abilities using the scater package (<xref rid="btx337-B10" ref-type="bibr">McCarthy <italic>et al.</italic>, 2017</xref>) but has an interactive component that focuses mainly on the clustering part. Indeed, most of the other available pipelines lack an interactive visualization component as well as integration of a broad range of available single-cell data processing algorithms. In response, several valuable platforms have recently been developed that integrate graphics components. These include SCell (<xref rid="btx337-B3" ref-type="bibr">Diaz <italic>et al.</italic>, 2016</xref>), Sincell (<xref rid="btx337-B8" ref-type="bibr">Julia <italic>et al.</italic>, 2015</xref>), Fastproject (<xref rid="btx337-B2" ref-type="bibr">DeTomaso and Yosef, 2016</xref>), or START (<xref rid="btx337-B11" ref-type="bibr">Nelson <italic>et al.</italic>, 2016</xref>). These tools are embedded in stand-alone applications and cover more comprehensively the whole RNA-seq analysis pipeline, yet, they still lack key features. For example, FastProject performs filtering and visualization but no further analysis. SCell implements RUVg normalization only, and visualization is limited to PCA. Moreover, SCell lacks marker gene identification (based on differential gene expression analysis) or functional gene set enrichment capacities. Finally, these pipelines require local installation of the software, which can be time-consuming or even daunting.</p>
    <p>To alleviate these constraints, we developed ASAP, a fully integrated, web-based pipeline aimed at the complete analysis of scRNA-seq data post genome alignment. Our choice of rendering ASAP completely web-based was motivated by the fact that fewer users are inclined to install and update manually their tools, which is no longer required with web 2.0 software.</p>
    <p>ASAP allows the user to easily select and compare common, as well as single-cell specific algorithms, and provides an interactive visualization of the results. ASAP supports users in the data interpretation process by its fast speed, running the whole analysis pipeline in minutes, and by providing on-the-go visualization, clustering, differential gene expression analysis, and enrichment functionality. ASAP, to our knowledge, is currently the only tool that combines in-depth analysis features and sophisticated visualization for single-cell data in one unique platform.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>ASAP is a web-based application written in Ruby on Rails. The core structure is completely independent from any currently hosted web application (which are mostly coded in R/Shiny). This effectively makes the platform autonomous and allows the implementation of any tool independent of its source language. Currently, the server runs codes in R, Python and Java, and this process is invisible for the user, who only requires a web browser without prior installation of any development tool. The current list of methods that is included in ASAP is shown in <xref ref-type="fig" rid="btx337-F1">Figure 1</xref> and detailed in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>. Current and past versions are visible in the ‘Help’ page of the website (ASAP is versioned according to tool versions).
</p>
    <fig id="btx337-F1" orientation="portrait" position="float">
      <label>Fig. 1</label>
      <caption>
        <p>ASAP pipeline. The figure depicts the complete pipeline, including tools, that is implemented in ASAP. The user starts by uploading a count matrix (or a normalized matrix) of gene expression after which either the default pipeline or different filtering algorithms can be selected. After the normalization step, the user can apply different dimensionality reduction methods to visualize the data in 2D or 3D. The user can interactively select samples, or run clustering algorithms to perform differential gene expression analysis. Finally, the selected gene list can be analyzed for enrichment in biological modules or pathways such as the Gene Ontology or KEGG. All tools are referenced in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref></p>
      </caption>
      <graphic xlink:href="btx337f1"/>
    </fig>
    <p>The current implementation of ASAP relies on the <italic>delayed::job</italic> framework which automatically creates and queues jobs when the user asks to run a particular method. This allows the application to be perfectly scalable to any IT architecture and prevents major slowdown of the website. Of course, the job execution time scales with the number of users and the host’s computational power. But this will be mainly dependent on the available cores/RAM on the server that hosts ASAP. ASAP has also full compatibility with the last versions of Chrome, Mozilla and Safari. The uploaded user data is protected by an anonymous registration system which keeps the user data private. A sandbox also allows any user to analyze the example project or upload his own data without prior registration. However, the data is destroyed when the user’s session ends.</p>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>As a proof-of-concept, we re-analyzed data from (<xref rid="btx337-B4" ref-type="bibr">Dueck <italic>et al.</italic>, 2015</xref>), in which scRNA-seq was used to study gene expression variation across five mouse cell types, involving 91 cells. We demonstrate that ASAP is capable of replicating the main findings of this study in minutes in straightforward fashion (Supplementary Figs S1–S14). We also made these data available as a demo study on the ASAP front page, which is available without registration. It is important to note that, despite the fact that ASAP is primarily dedicated to single-cell analysis, most of the tools can be employed for bulk RNA-seq analysis as well, which makes the pipeline more versatile and universal. ASAP will be further developed as we commit to adding more functionalities and species handling on a continuous basis. We also plan to add an automatic report generation functionality, aiming to summarize the employed methods together with figures, version, citation and parameters. The database for functional enrichment analysis will remain automatically updated through a CRON job, and more databases will be added to cover links to oncogenes, drugs, as well as additional species.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work has been supported by funds from the Swiss National Science Foundation (#31003A_162735 and #IZLIZ3_156815) and by Institutional support from the EPFL and Human Frontier Science Program LT001032/2013 (to PCS).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Tables</label>
      <media xlink:href="supplement_tables_btx337.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup2">
      <label>Supplementary Figures</label>
      <media xlink:href="supplement_figures_btx337.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="btx337-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Afgan</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>The Galaxy platform for accessible, reproducible and collaborative biomedical analyses: 2016 update</article-title>. <source>Nucleic Acids Res</source>., <volume>44</volume>, <fpage>W3</fpage>–<lpage>W10</lpage>.<pub-id pub-id-type="pmid">27137889</pub-id></mixed-citation>
    </ref>
    <ref id="btx337-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>DeTomaso</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Yosef</surname><given-names>N.</given-names></name></person-group> (<year>2016</year>) 
<article-title>FastProject: a tool for low-dimensional analysis of single-cell RNA-Seq data</article-title>. <source>BMC Bioinformatics</source>, <volume>17</volume>,</mixed-citation>
    </ref>
    <ref id="btx337-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Diaz</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>SCell: integrated analysis of single-cell RNA-seq data</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>2219</fpage>–<lpage>2220</lpage>.<pub-id pub-id-type="pmid">27153637</pub-id></mixed-citation>
    </ref>
    <ref id="btx337-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dueck</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Deep sequencing reveals cell-type-specific patterns of single-cell transcriptome variation</article-title>. <source>Genome Biol</source>., <volume>16</volume>, <fpage>122</fpage>.<pub-id pub-id-type="pmid">26056000</pub-id></mixed-citation>
    </ref>
    <ref id="btx337-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fan</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Characterizing transcriptional heterogeneity through pathway and gene set overdispersion analysis</article-title>. <source>Nat. Methods</source>, <volume>13</volume>, <fpage>241</fpage>–<lpage>244</lpage>.<pub-id pub-id-type="pmid">26780092</pub-id></mixed-citation>
    </ref>
    <ref id="btx337-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Finak</surname><given-names>G.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>MAST: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data</article-title>. <source>Genome Biol</source>., <volume>16</volume>, <fpage>278</fpage>.<pub-id pub-id-type="pmid">26653891</pub-id></mixed-citation>
    </ref>
    <ref id="btx337-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Guo</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>SINCERA: a pipeline for single-cell RNA-Seq profiling analysis</article-title>. <source>PLoS Comput. Biol</source>., <volume>11</volume>, <fpage>e1004575</fpage>.<pub-id pub-id-type="pmid">26600239</pub-id></mixed-citation>
    </ref>
    <ref id="btx337-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Julia</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Sincell: an R/Bioconductor package for statistical assessment of cell-state hierarchies from single-cell RNA-seq</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>3377</fpage>–<lpage>3379</lpage>.<pub-id pub-id-type="pmid">26099263</pub-id></mixed-citation>
    </ref>
    <ref id="btx337-B9">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Kiselev</surname><given-names>V.Y.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) SC3 – consensus clustering of single-cell RNA-Seq data. <italic>bioRXiv</italic>.</mixed-citation>
    </ref>
    <ref id="btx337-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>McCarthy</surname><given-names>D.J.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Scater: pre-processing, quality control, normalization and visualization of single-cell RNA-seq data in R</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>1179</fpage>–<lpage>1186</lpage>.<pub-id pub-id-type="pmid">28088763</pub-id></mixed-citation>
    </ref>
    <ref id="btx337-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nelson</surname><given-names>J.W.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>The START App: a web-based RNAseq analysis and visualization resource</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>447</fpage>–<lpage>449</lpage>.</mixed-citation>
    </ref>
    <ref id="btx337-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Reich</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2006</year>) 
<article-title>GenePattern 2.0</article-title>. <source>Nat. Genet</source>., <volume>38</volume>, <fpage>500</fpage>–<lpage>501</lpage>.<pub-id pub-id-type="pmid">16642009</pub-id></mixed-citation>
    </ref>
    <ref id="btx337-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Satija</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Spatial reconstruction of single-cell gene expression data</article-title>. <source>Nat. Biotechnol</source>., <volume>33</volume>, <fpage>495</fpage>–<lpage>502</lpage>.<pub-id pub-id-type="pmid">25867923</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
