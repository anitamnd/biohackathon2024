<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinform Adv</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinform Adv</journal-id>
    <journal-id journal-id-type="publisher-id">bioadv</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics Advances</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2635-0041</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10783948</article-id>
    <article-id pub-id-type="doi">10.1093/bioadv/vbad188</article-id>
    <article-id pub-id-type="publisher-id">vbad188</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Application Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genetics and Population Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PaintorPipe: a pipeline for genetic variant fine-mapping using functional annotations</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Gerber</surname>
          <given-names>Zoé</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="https://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="lead">Formal analysis</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="equal">Methodology</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Project administration" vocab-term-identifier="https://credit.niso.org/contributor-roles/project-administration" degree-contribution="lead">Project administration</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Software" vocab-term-identifier="https://credit.niso.org/contributor-roles/software" degree-contribution="lead">Software</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization" degree-contribution="lead">Visualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="supporting">Writing - review &amp; editing</role>
        <aff><institution>IRSD, Université de Toulouse, INSERM, INRAE, ENVT, Université Toulouse III - Paul Sabatier (UPS)</institution>, 31024 Toulouse, <country country="FR">France</country></aff>
        <aff><institution>Bordeaux Bioinformatics Master, Université de Bordeaux</institution>, 33405 Talence, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fisun</surname>
          <given-names>Michel</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="supporting">Methodology</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Software" vocab-term-identifier="https://credit.niso.org/contributor-roles/software" degree-contribution="supporting">Software</role>
        <aff><institution>Department of Computational Biology, Pasteur Institute, Université Paris Cité</institution>, 75015 Paris, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7554-6783</contrib-id>
        <name>
          <surname>Aschard</surname>
          <given-names>Hugues</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/conceptualization" degree-contribution="equal">Conceptualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Funding acquisition" vocab-term-identifier="https://credit.niso.org/contributor-roles/funding-acquisition" degree-contribution="supporting">Funding acquisition</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="equal">Methodology</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="supporting">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="supporting">Writing - review &amp; editing</role>
        <aff><institution>Department of Computational Biology, Pasteur Institute, Université Paris Cité</institution>, 75015 Paris, <country country="FR">France</country></aff>
        <aff><institution>Program in Genetic Epidemiology and Statistical Genetics, Harvard T.H. Chan School of Public Health</institution>, Boston, MA 02115, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0599-1267</contrib-id>
        <name>
          <surname>Djebali</surname>
          <given-names>Sarah</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/conceptualization" degree-contribution="equal">Conceptualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Funding acquisition" vocab-term-identifier="https://credit.niso.org/contributor-roles/funding-acquisition" degree-contribution="lead">Funding acquisition</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="equal">Methodology</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Project administration" vocab-term-identifier="https://credit.niso.org/contributor-roles/project-administration" degree-contribution="supporting">Project administration</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Software" vocab-term-identifier="https://credit.niso.org/contributor-roles/software" degree-contribution="supporting">Software</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="https://credit.niso.org/contributor-roles/supervision" degree-contribution="lead">Supervision</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="lead">Writing - review &amp; editing</role>
        <aff><institution>IRSD, Université de Toulouse, INSERM, INRAE, ENVT, Université Toulouse III - Paul Sabatier (UPS)</institution>, 31024 Toulouse, <country country="FR">France</country></aff>
        <xref rid="vbad188-cor1" ref-type="corresp"/>
        <!--sarah.djebali@inserm.fr-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Mulder</surname>
          <given-names>Nicola</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="vbad188-cor1">Corresponding author. IRSD, Université de Toulouse, INSERM, INRAE, ENVT, Université Toulouse III – Paul Sabatier (UPS), U1220 – Bat B – CHU Purpan Place du Docteur Baylac – CS 60039, 31024 Toulouse Cedex 3, France. E-mail: <email>sarah.djebali@inserm.fr</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-12-21">
      <day>21</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>21</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <volume>4</volume>
    <issue>1</issue>
    <elocation-id>vbad188</elocation-id>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>07</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>11</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>11</day>
        <month>1</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="vbad188.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Genome-wide association studies (GWAS) have identified thousands of genetic variants associated with common diseases. These results include a mix of causal and non-causal variants related through strong linkage disequilibrium (LD, i.e. highly correlated). Fine-mapping methods have been developed to decipher the causal from non-causal variants using GWAS results and LD information, assigning to each variant a probability of being causal. In this field, the <monospace>PAINTOR</monospace> program has become a standard, one of its advantages being its ability to take into account functional annotations. This approach requires many pre- and post-processing steps. Here, we developed a <monospace>Nextflow</monospace> pipeline called <monospace>PaintorPipe</monospace> that wraps all these steps and the fine-mapping itself together. <monospace>PaintorPipe</monospace> uses three independent sources of information: GWAS summary statistics, LD information and functional annotations, to rank the variants according to their susceptibility to be involved in the disease development. The <monospace>PAINTOR</monospace> framework is used to calculate the posterior probability of each variant (single nucleotide polymorphism) to be causal (a.k.a. Bayesian fine-mapping). The resulting credible sets of variants are annotated with their biological functions and visualized using <monospace>CANVIS</monospace>. This pipeline requires minimal input from users (a GWAS summary statistics file and a set of functional annotation files) and is designed to be modular and customizable, allowing for an easy integration of diverse functional annotations.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p><monospace>PaintorPipe</monospace> is implemented in the <monospace>Nextflow</monospace> pipeline specific language, can be run locally or on a slurm cluster and handles containerization using <monospace>Singularity</monospace>. <monospace>PaintorPipe</monospace> is freely available on GitHub (<ext-link xlink:href="https://github.com/sdjebali/PaintorPipe" ext-link-type="uri">https://github.com/sdjebali/PaintorPipe</ext-link>).</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>INSERM</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001677</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="5"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Most common human diseases, such as diabetes, obesity, cardiovascular disease/stroke, cancer, neuropsychiatric, auto-immunity, and inflammatory diseases, are multifactorial, depending on numerous environmental and genetic factors. The genetic component is typically highly polygenic, likely involving hundreds to thousands of causal variants spread across the entire genome. The identification of genetic variants, mostly single nucleotide polymorphisms (SNPs), associated with those common polygenic diseases heavily relies on genome-wide association studies (GWAS). The GWAS consists in a massively parallel univariate testing of millions of variants using a standard linear additive model. This approach has proven quite efficient, identifying thousands of associations, but also has some limitations. In particular, the extent of linkage disequilibrium (LD, i.e. correlation) across variants in the human genome implies that numerous non-causal variants can capture signal through their correlation with causal ones. Deciphering the causal variants from non-causal ones found associated because of LD, has proven extremely difficult.</p>
    <p>To address this challenge, <italic toggle="yes">in silico</italic> fine-mapping methods have been developed (<xref rid="vbad188-B9" ref-type="bibr">Schaid <italic toggle="yes">et al.</italic> 2018</xref>) to prioritize genetic variants more likely to be causal. Most fine-mapping methods are built on a Bayesian framework which jointly model the effects of multiple SNPs on a trait and use LD information to assign a probability of causality to each variant (posterior probability, PP). <monospace>PAINTOR</monospace> (<xref rid="vbad188-B6" ref-type="bibr">Kichaev <italic toggle="yes">et al.</italic> 2014</xref>) is one of such Bayesian fine-mapping methods. It is a popular approach that has been used for the prioritization of variants in hundreds of fine-mapping studies. One advantage of <monospace>PAINTOR</monospace> is its ability to incorporate functional annotations. It builds on the assumption that causal variants might act through similar biological pathways, so that enrichment for a given annotation might be leveraged to improve the accuracy of fine-mapping results. However, running <monospace>PAINTOR</monospace> requires several pre- and post-processing steps, making it time-consuming and cumbersome.</p>
    <p>In this paper, we describe the <monospace>Nextflow</monospace> (<xref rid="vbad188-B3" ref-type="bibr">Di Tommaso <italic toggle="yes">et al.</italic> 2017</xref>) pipeline called <monospace>PaintorPipe</monospace>, that aims at overcoming this issue for fast and efficient fine-mapping analyses. <monospace>PaintorPipe</monospace> performs all the pre- and post-processing steps required for a fine-mapping, apply <monospace>PAINTOR</monospace>, and produce a summary results using existing tools directly from the <monospace>PAINTOR</monospace> output.</p>
  </sec>
  <sec>
    <title>2 Workflow</title>
    <p>The <monospace>PaintorPipe</monospace> workflow is divided into three main parts: Pre-processing, Fine-mapping, and Post-Processing (<xref rid="vbad188-F1" ref-type="fig">Fig. 1</xref>), that are described below.</p>
    <fig position="float" id="vbad188-F1">
      <label>Figure 1.</label>
      <caption>
        <p>The <monospace>PaintorPipe</monospace> Workflow. The <monospace>PaintorPipe</monospace> workflow consists of three main parts, indicated on the left of the figure: pre-processing, fine-mapping, and post-processing. Each part is itself divided into modules represented as large horizontal boxes. The pre-processing part is made of three modules: <italic toggle="yes">Split GWAS into loci</italic>, <italic toggle="yes">Calculate LD</italic>, and <italic toggle="yes">Integrate annotation</italic>; the fine-mapping part is made of a single <monospace>PAINTOR</monospace> module; and the post-processing part is made of two modules, <italic toggle="yes">Interpret results</italic>, and <italic toggle="yes">Visualise</italic> that uses the <monospace>CANVIS</monospace> tool. In practice, each module is composed of several <monospace>Nextflow</monospace> processes, but for clarity purposes, only the module name is indicated on the figure. The required input files, including the GWAS file and the functional annotation files, are represented as small green boxes, while the intermediate files, that are used by other steps of the pipeline and that can optionally be saved, are represented as small yellow boxes. Finally, the output files are represented as small red boxes.</p>
      </caption>
      <graphic xlink:href="vbad188f1" position="float"/>
    </fig>
    <sec>
      <title>2.1 Pre-processing</title>
      <p>The pre-processing part aims at preparing input files for running <monospace>PAINTOR</monospace> and involves three modules: Split GWAS into loci, Calculate LD, and Integrate annotations.</p>
      <sec>
        <title>2.1.1 Split GWAS into loci</title>
        <p>The GWAS dataset is first divided into loci. The SNPs are first split into chromosomes, and ordered by ascending <italic toggle="yes">P</italic>-value. The loci are then generated per chromosome, starting from the smallest <italic toggle="yes">P</italic>-value SNP and iteratively until no SNP with a <italic toggle="yes">P</italic>-value lower than <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="italic">pval</mml:mi><mml:mo>_</mml:mo><mml:mi mathvariant="italic">lead</mml:mi></mml:mrow></mml:math></inline-formula> (5e−8 by default) is found. More precisely the smallest <italic toggle="yes">P</italic>-value SNP is selected and grouped with all other SNPs with <italic toggle="yes">P</italic>-values lower than <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="italic">pval</mml:mi><mml:mo>_</mml:mo><mml:mi mathvariant="italic">nonlead</mml:mi></mml:mrow></mml:math></inline-formula> (1 by default) and located less than a distance away from it (500 kilobases by default). This process is repeated with the second smallest <italic toggle="yes">P</italic>-value SNP, and if the newly formed locus overlaps with the first one, they are merged together. This is done iteratively and when a new locus is formed, its position on the genome is compared to the ones of all previously made loci and in case of overlap they are merged together. Therefore the final loci are completely disjoint on the genome, i.e. do not share any SNPs. The resulting loci are provided as SNP files in which each SNP is associated to multiple pieces of information including a <italic toggle="yes">z-score</italic>, computed by dividing the SNP effect size by the SNP effect size standard error.</p>
      </sec>
      <sec>
        <title>2.1.2 Calculate LD</title>
        <p>Each resulting locus file is subsequently passed on to the <italic toggle="yes">Calculate LD</italic> module that produces a linkage disequilibrium (LD) matrix for each locus, by computing the Pearson correlation coefficient between each pair of SNPs of the locus. In addition to the locus SNPs, this module takes as input a map file and variant VCF files that are automatically downloaded from the 1000 Genomes Project website (<ext-link xlink:href="https://www.internationalgenome.org/" ext-link-type="uri">https://www.internationalgenome.org/</ext-link>, <xref rid="vbad188-B4" ref-type="bibr">Finucane <italic toggle="yes">et al.</italic> 2015</xref>).</p>
      </sec>
      <sec>
        <title>2.1.3 Integrate annotations</title>
        <p>Since the majority of disease associated variants are found in non-coding regions of the genome (<xref rid="vbad188-B2" ref-type="bibr">Claringbould and Zaugg 2021</xref>), a functional annotation of these variants is crucial. Variants located in regulatory regions, such as enhancers or promoters, can influence gene expression and increase the risk of developing the disease (<xref rid="vbad188-B2" ref-type="bibr">Claringbould and Zaugg 2021</xref>).</p>
        <p>Therefore, functional annotations, which provide information on the biological functions of different genomic regions, can help prioritize disease-causing variants by increasing their weight. In addition, functional annotations can also be used <italic toggle="yes">a posteriori</italic>, to better understand the mechanisms underlying diseases, which can lead to the development of new treatments or more effective preventive strategies. An example of possible disease-causing mechanism is shown in <xref rid="vbad188-F2" ref-type="fig">Fig. 2</xref>.</p>
        <fig position="float" id="vbad188-F2">
          <label>Figure 2.</label>
          <caption>
            <p>Illustration of the effect of genetic variants located in gene enhancers. (Top) Each enhancer can be linked to multiple genes, and conversely each gene can be linked to multiple enhancers. (Bottom) Here, an SNP variant located in an enhancer disrupts the activity of a distant gene, leading to increased disease risk.</p>
          </caption>
          <graphic xlink:href="vbad188f2" position="float"/>
        </fig>
        <p>Within <monospace>PaintorPipe</monospace>, the <italic toggle="yes">Integrate annotation</italic> module only requires a single input file that provides the short names and the file paths on the system, of the different annotations. This process then computes the overlap between each SNP and each annotation, leading to an annotation matrix for each locus with SNPs in rows and annotations in columns. These matrices are made of 0 and 1 values, depending on whether the SNP is included in the given annotation. To achieve optimal results with the <monospace>PAINTOR</monospace> framework and as stated by its authors, it is recommended to use a maximum of five annotations.</p>
      </sec>
    </sec>
    <sec>
      <title>2.2 Fine-mapping</title>
      <p>The PP of causality of each variant is calculated by <monospace>PAINTOR</monospace> using the outputs of the pre-processing modules (i.e. the loci, the LD matrices and the annotation matrices). Note that the running time for this module can be computationally expensive (several hours), especially for datasets with a large number of variants (millions). For each locus, <monospace>PAINTOR</monospace> identifies credible sets of SNPs that have a high probability of being causal and are likely to contain the causal variants. Once the fine-mapping analysis is performed, <monospace>PaintorPipe</monospace> retrieves results from each locus and annotates them for a better interpretation. This is the Post-processing part described below.</p>
    </sec>
    <sec>
      <title>2.3 Post-processing</title>
      <p>The post-processing part produces plots and tables for an easier interpretation of the fine-mapping results. Several computations are performed, including the number and percentage of all (or each locus) SNPs reaching 50%, 80%, and 95% of the cumulative sum of all (or each locus) SNP PPs. Finally, thanks to the <monospace>CANVIS</monospace> tool, each credible set of SNPs within a locus is graphically represented, together with the LD structure of the locus (<xref rid="vbad188-F3" ref-type="fig">Fig. 3</xref>).</p>
      <fig position="float" id="vbad188-F3">
        <label>Figure 3.</label>
        <caption>
          <p>Example of a <monospace>CANVIS</monospace> visualization produced by <monospace>PaintorPipe</monospace> on a specific locus. The plot is made of three parts (from top to bottom): (i) a dotplot showing for each SNP of the locus, its genomic position on the <italic toggle="yes">x</italic> axis and its posterior probability to be causal (PP) on the <italic toggle="yes">y</italic> axis, with the credible set highlighted in red. The non-causal SNPs (not significant) are plotted in blue, and the different types of annotations used in this run are indicated by horizontal bars below the plot; (ii) a dotplot representing for each SNP of the locus, its genomic position on the x axis and its −log10(<italic toggle="yes">P</italic> value) on the <italic toggle="yes">y</italic> axis. The most probable causal variant is represented by a black diamond, and the color gradient represents the linkage disequilibrium (correlation) between this variant and the other SNPs of the locus; (iii) a heatmap corresponding to the linkage disequilibrium (SNP pair correlation) of the locus. Here, <monospace>PaintorPipe</monospace> version 1.2 was run with the following parameters <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mi mathvariant="italic">chromosome</mml:mi><mml:mo>_</mml:mo><mml:mi mathvariant="italic">header</mml:mi><mml:mo> </mml:mo><mml:mi mathvariant="italic">Chr</mml:mi><mml:mo> </mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="italic">pvalue</mml:mi><mml:mo>_</mml:mo><mml:mi mathvariant="italic">nonlead</mml:mi><mml:mo> </mml:mo><mml:mn>0.01</mml:mn><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="italic">snp</mml:mi><mml:mo> </mml:mo><mml:mn>100000</mml:mn></mml:mrow></mml:math></inline-formula> on the 2018 Coronary Atery Disease (CAD) GWAS study <xref rid="vbad188-B10" ref-type="bibr">Van Der Harst and Verweij (2018)</xref> using four annotations from <xref rid="vbad188-B4" ref-type="bibr">Finucane <italic toggle="yes">et al.</italic> (2015)</xref>. This run produced 149 loci. This figure presents the sixth locus of chromosome 6.</p>
        </caption>
        <graphic xlink:href="vbad188f3" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>3 Details and parameters</title>
    <p><monospace>PaintorPipe</monospace> is designed to work on human data and to be customizable with several adjustable parameters. Only two inputs are required to run the pipeline: the GWAS summary statistics file (using the—<monospace>gwasFile</monospace> parameter) and the annotation location file (using the—<monospace>annotationsFile</monospace> parameter).</p>
    <p>The other input and output parameters are optional and have default values. This includes in particular the header parameters of the GWAS file, the different adjustable thresholds for the <italic toggle="yes">P</italic>-values and the posterior probabilities, but also the version of the reference genome (hg19 or hg38) and the distance in kilobases (kb) around the lead SNP used to define a locus (see Pre-processing section above). As the pipeline is implemented in <monospace>Nextflow</monospace>, it is possible to use <monospace>Nextflow</monospace> optional parameters (in particular the –C option to provide a custom configuration file).</p>
    <p>In order to ensure reproducibility and manage tools, packages and versions in a controlled environment, <monospace>PaintorPipe</monospace> uses a <monospace>Singularity</monospace> image (<xref rid="vbad188-B7" ref-type="bibr">Kurtzer <italic toggle="yes">et al.</italic> 2017</xref>). This <monospace>Singularity</monospace> image is hosted on <monospace>Sylabs</monospace> (<ext-link xlink:href="https://sylabs.io/" ext-link-type="uri">https://sylabs.io/</ext-link>), and is specified in the configuration file. The pipeline can be run on a local machine or on a slurm cluster, and can therefore take advantage of the increased resources available on the latter to speed up the analyses (e.g. over 24 h for a GWAS file of 7 million SNPs).</p>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p><monospace>PAINTOR</monospace> is a popular fine-mapping software, that uses a Bayesian approach to calculate the posterior probability of SNPs to be causal. Its ability to incorporate functional annotations makes it a powerful tool for identifying causal variants underlying polygenic traits and diseases. To address its time-consuming and burdensome pre- and post-processing parts, we developed <monospace>PaintorPipe</monospace>, a <monospace>Nextflow</monospace> DSL2 pipeline that automates the entire process for fast and user-friendly analysis. By reducing the number of candidate variants to a more manageable and meaningful set, <monospace>PaintorPipe</monospace> can be used to prioritize candidate variants for further investigation.</p>
    <p>Indeed, the variants with the highest probability of being causal can be more carefully inspected before experimental validation. For instance their location with respect to genes and regulatory elements can be computed (or derived from the pipeline outputs in case such functional annotations were used) and for the case of variants located in enhancers, the genes they are susceptible to affect can be retrieved from predicted enhancer/gene relationships [for instance from the ABC model (<xref rid="vbad188-B5" ref-type="bibr">Fulco <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="vbad188-B8" ref-type="bibr">Nasser <italic toggle="yes">et al.</italic> 2021</xref>) at <ext-link xlink:href="https://www.engreitzlab.org/resources" ext-link-type="uri">https://www.engreitzlab.org/resources</ext-link>].</p>
    <p>In short, <monospace>PaintorPipe</monospace> greatly facilitates the use of the <monospace>PAINTOR</monospace> fine-mapping program, allowing to run it from a minimum set of inputs (GWAS and annotation location files) in a reproducible way, and producing exploitable results for interpretation and visualization.</p>
    <p>Finally, while we focused our development on <monospace>PAINTOR</monospace>, most fine-mapping methods use similar information (Z-scores, LD matrix across loci, and for some of them functional annotations), and produce similar outputs. We thus expect future versions of <monospace>PaintorPipe</monospace> to be able to use some of these other tools (<xref rid="vbad188-B11" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="vbad188-B12" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2023</xref>).</p>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors would like to thank Cervin Guyomar for providing expertise on <monospace>NextFlow</monospace>, and the genotoul bioinformatics platform (<ext-link xlink:href="https://bioinfo.genotoul.fr/" ext-link-type="uri">https://bioinfo.genotoul.fr/</ext-link>) for help with software installation.</p>
  </ack>
  <sec>
    <title>Author contributions</title>
    <p>Zoé Gerber (Formal analysis [lead], Methodology [equal], Project administration [lead], Software [lead], Visualization [lead], Writing—original draft [equal], Writing—review &amp; editing [supporting]), Michel Fisun (Methodology [supporting], Software [supporting]), Hugues Aschard (Conceptualization [equal], Funding acquisition [supporting], Methodology [equal], Writing—original draft [supporting], Writing—review &amp; editing [supporting]), and Sarah Djebali (Conceptualization [equal], Funding acquisition [lead], Methodology [equal], Project administration [supporting], Software [supporting], Supervision [lead], Writing—original draft [equal], Writing—review &amp; editing [lead])</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was mainly supported by INSERM, and partly supported by Institut Pasteur.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The <monospace>PaintorPipe</monospace> code and small test dataset are freely available from GitHub at <ext-link xlink:href="https://github.com/sdjebali/PaintorPipe" ext-link-type="uri">https://github.com/sdjebali/PaintorPipe</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="vbad188-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Auton</surname><given-names>A</given-names></string-name>, <string-name><surname>Abecasis</surname><given-names>GR</given-names></string-name>, <string-name><surname>Altshuler</surname><given-names>DM</given-names></string-name></person-group><etal>et al</etal>; <collab>The 1000 Genomes Project Consortium</collab>. <article-title>A global reference for human genetic variation</article-title>. <source>Nature</source><year>2015</year>;<volume>526</volume>:<fpage>68</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">26432245</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Claringbould</surname><given-names>A</given-names></string-name>, <string-name><surname>Zaugg</surname><given-names>JB.</given-names></string-name></person-group><article-title>Enhancers in disease: molecular basis and emerging treatment strategies</article-title>. <source>Trends Mol Med</source><year>2021</year>;<volume>27</volume>:<fpage>1060</fpage>–<lpage>73</lpage>.<pub-id pub-id-type="pmid">34420874</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Di Tommaso</surname><given-names>P</given-names></string-name>, <string-name><surname>Chatzou</surname><given-names>M</given-names></string-name>, <string-name><surname>Floden</surname><given-names>EW</given-names></string-name></person-group><etal>et al</etal><article-title>Nextflow enables reproducible computational workflows</article-title>. <source>Nat Biotechnol</source><year>2017</year>;<volume>35</volume>:<fpage>316</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">28398311</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Finucane</surname><given-names>HK</given-names></string-name>, <string-name><surname>Bulik-Sullivan</surname><given-names>B</given-names></string-name>, <string-name><surname>Gusev</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal>; <collab>RACI Consortium</collab>. <article-title>Partitioning heritability by functional annotation using genome-wide association summary statistics</article-title>. <source>Nat Genet</source><year>2015</year>;<volume>47</volume>:<fpage>1228</fpage>–<lpage>35</lpage>.<pub-id pub-id-type="pmid">26414678</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fulco</surname><given-names>CP</given-names></string-name>, <string-name><surname>Nasser</surname><given-names>J</given-names></string-name>, <string-name><surname>Jones</surname><given-names>TR</given-names></string-name></person-group><etal>et al</etal><article-title>Activity-by-contact model of enhancer–promoter regulation from thousands of crispr perturbations</article-title>. <source>Nat Genet</source><year>2019</year>;<volume>51</volume>:<fpage>1664</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">31784727</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kichaev</surname><given-names>G</given-names></string-name>, <string-name><surname>Yang</surname><given-names>W-Y</given-names></string-name>, <string-name><surname>Lindstrom</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Integrating functional data to prioritize causal variants in statistical fine-mapping studies</article-title>. <source>PLoS Genet</source><year>2014</year>;<volume>10</volume>:<fpage>e1004722</fpage>.<pub-id pub-id-type="pmid">25357204</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kurtzer</surname><given-names>GM</given-names></string-name>, <string-name><surname>Sochat</surname><given-names>V</given-names></string-name>, <string-name><surname>Bauer</surname><given-names>MW.</given-names></string-name></person-group><article-title>Singularity: scientific containers for mobility of compute</article-title>. <source>PLoS ONE</source><year>2017</year>;<volume>12</volume>:<fpage>e0177459</fpage>.<pub-id pub-id-type="pmid">28494014</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nasser</surname><given-names>J</given-names></string-name>, <string-name><surname>Bergman</surname><given-names>DT</given-names></string-name>, <string-name><surname>Fulco</surname><given-names>CP</given-names></string-name></person-group><etal>et al</etal><article-title>Genome-wide enhancer maps link risk variants to disease genes</article-title>. <source>Nature</source><year>2021</year>;<volume>593</volume>:<fpage>238</fpage>–<lpage>43</lpage>.<pub-id pub-id-type="pmid">33828297</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schaid</surname><given-names>DJ</given-names></string-name>, <string-name><surname>Chen</surname><given-names>W</given-names></string-name>, <string-name><surname>Larson</surname><given-names>NB.</given-names></string-name></person-group><article-title>From genome-wide associations to candidate causal variants by statistical fine-mapping</article-title>. <source>Nat Rev Genet</source><year>2018</year>;<volume>19</volume>:<fpage>491</fpage>–<lpage>504</lpage>.<pub-id pub-id-type="pmid">29844615</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Van Der Harst</surname><given-names>P</given-names></string-name>, <string-name><surname>Verweij</surname><given-names>N.</given-names></string-name></person-group><article-title>Identification of 64 novel genetic loci provides an expanded view on the genetic architecture of coronary artery disease</article-title>. <source>Circ Res</source><year>2018</year>;<volume>122</volume>:<fpage>433</fpage>–<lpage>43</lpage>.<pub-id pub-id-type="pmid">29212778</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>G</given-names></string-name>, <string-name><surname>Sarkar</surname><given-names>A</given-names></string-name>, <string-name><surname>Carbonetto</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>A simple new approach to variable selection in regression, with application to genetic fine mapping</article-title>. <source>J R Stat Soc Series B Stat Methodol</source><year>2020</year>;<volume>82</volume>:<fpage>1273</fpage>–<lpage>300</lpage>.<pub-id pub-id-type="pmid">37220626</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>Z</given-names></string-name>, <string-name><surname>Wang</surname><given-names>C</given-names></string-name>, <string-name><surname>Liu</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Carma is a new Bayesian model for fine-mapping in genome-wide association meta-analyses</article-title>. <source>Nat Genet</source><year>2023</year>;<volume>55</volume>:<fpage>1057</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">37169873</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinform Adv</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinform Adv</journal-id>
    <journal-id journal-id-type="publisher-id">bioadv</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics Advances</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2635-0041</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10783948</article-id>
    <article-id pub-id-type="doi">10.1093/bioadv/vbad188</article-id>
    <article-id pub-id-type="publisher-id">vbad188</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Application Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genetics and Population Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PaintorPipe: a pipeline for genetic variant fine-mapping using functional annotations</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Gerber</surname>
          <given-names>Zoé</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="https://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="lead">Formal analysis</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="equal">Methodology</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Project administration" vocab-term-identifier="https://credit.niso.org/contributor-roles/project-administration" degree-contribution="lead">Project administration</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Software" vocab-term-identifier="https://credit.niso.org/contributor-roles/software" degree-contribution="lead">Software</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization" degree-contribution="lead">Visualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="supporting">Writing - review &amp; editing</role>
        <aff><institution>IRSD, Université de Toulouse, INSERM, INRAE, ENVT, Université Toulouse III - Paul Sabatier (UPS)</institution>, 31024 Toulouse, <country country="FR">France</country></aff>
        <aff><institution>Bordeaux Bioinformatics Master, Université de Bordeaux</institution>, 33405 Talence, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fisun</surname>
          <given-names>Michel</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="supporting">Methodology</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Software" vocab-term-identifier="https://credit.niso.org/contributor-roles/software" degree-contribution="supporting">Software</role>
        <aff><institution>Department of Computational Biology, Pasteur Institute, Université Paris Cité</institution>, 75015 Paris, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7554-6783</contrib-id>
        <name>
          <surname>Aschard</surname>
          <given-names>Hugues</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/conceptualization" degree-contribution="equal">Conceptualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Funding acquisition" vocab-term-identifier="https://credit.niso.org/contributor-roles/funding-acquisition" degree-contribution="supporting">Funding acquisition</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="equal">Methodology</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="supporting">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="supporting">Writing - review &amp; editing</role>
        <aff><institution>Department of Computational Biology, Pasteur Institute, Université Paris Cité</institution>, 75015 Paris, <country country="FR">France</country></aff>
        <aff><institution>Program in Genetic Epidemiology and Statistical Genetics, Harvard T.H. Chan School of Public Health</institution>, Boston, MA 02115, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0599-1267</contrib-id>
        <name>
          <surname>Djebali</surname>
          <given-names>Sarah</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/conceptualization" degree-contribution="equal">Conceptualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Funding acquisition" vocab-term-identifier="https://credit.niso.org/contributor-roles/funding-acquisition" degree-contribution="lead">Funding acquisition</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="equal">Methodology</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Project administration" vocab-term-identifier="https://credit.niso.org/contributor-roles/project-administration" degree-contribution="supporting">Project administration</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Software" vocab-term-identifier="https://credit.niso.org/contributor-roles/software" degree-contribution="supporting">Software</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="https://credit.niso.org/contributor-roles/supervision" degree-contribution="lead">Supervision</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="lead">Writing - review &amp; editing</role>
        <aff><institution>IRSD, Université de Toulouse, INSERM, INRAE, ENVT, Université Toulouse III - Paul Sabatier (UPS)</institution>, 31024 Toulouse, <country country="FR">France</country></aff>
        <xref rid="vbad188-cor1" ref-type="corresp"/>
        <!--sarah.djebali@inserm.fr-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Mulder</surname>
          <given-names>Nicola</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="vbad188-cor1">Corresponding author. IRSD, Université de Toulouse, INSERM, INRAE, ENVT, Université Toulouse III – Paul Sabatier (UPS), U1220 – Bat B – CHU Purpan Place du Docteur Baylac – CS 60039, 31024 Toulouse Cedex 3, France. E-mail: <email>sarah.djebali@inserm.fr</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-12-21">
      <day>21</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>21</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <volume>4</volume>
    <issue>1</issue>
    <elocation-id>vbad188</elocation-id>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>07</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>11</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>11</day>
        <month>1</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="vbad188.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Genome-wide association studies (GWAS) have identified thousands of genetic variants associated with common diseases. These results include a mix of causal and non-causal variants related through strong linkage disequilibrium (LD, i.e. highly correlated). Fine-mapping methods have been developed to decipher the causal from non-causal variants using GWAS results and LD information, assigning to each variant a probability of being causal. In this field, the <monospace>PAINTOR</monospace> program has become a standard, one of its advantages being its ability to take into account functional annotations. This approach requires many pre- and post-processing steps. Here, we developed a <monospace>Nextflow</monospace> pipeline called <monospace>PaintorPipe</monospace> that wraps all these steps and the fine-mapping itself together. <monospace>PaintorPipe</monospace> uses three independent sources of information: GWAS summary statistics, LD information and functional annotations, to rank the variants according to their susceptibility to be involved in the disease development. The <monospace>PAINTOR</monospace> framework is used to calculate the posterior probability of each variant (single nucleotide polymorphism) to be causal (a.k.a. Bayesian fine-mapping). The resulting credible sets of variants are annotated with their biological functions and visualized using <monospace>CANVIS</monospace>. This pipeline requires minimal input from users (a GWAS summary statistics file and a set of functional annotation files) and is designed to be modular and customizable, allowing for an easy integration of diverse functional annotations.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p><monospace>PaintorPipe</monospace> is implemented in the <monospace>Nextflow</monospace> pipeline specific language, can be run locally or on a slurm cluster and handles containerization using <monospace>Singularity</monospace>. <monospace>PaintorPipe</monospace> is freely available on GitHub (<ext-link xlink:href="https://github.com/sdjebali/PaintorPipe" ext-link-type="uri">https://github.com/sdjebali/PaintorPipe</ext-link>).</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>INSERM</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001677</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="5"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Most common human diseases, such as diabetes, obesity, cardiovascular disease/stroke, cancer, neuropsychiatric, auto-immunity, and inflammatory diseases, are multifactorial, depending on numerous environmental and genetic factors. The genetic component is typically highly polygenic, likely involving hundreds to thousands of causal variants spread across the entire genome. The identification of genetic variants, mostly single nucleotide polymorphisms (SNPs), associated with those common polygenic diseases heavily relies on genome-wide association studies (GWAS). The GWAS consists in a massively parallel univariate testing of millions of variants using a standard linear additive model. This approach has proven quite efficient, identifying thousands of associations, but also has some limitations. In particular, the extent of linkage disequilibrium (LD, i.e. correlation) across variants in the human genome implies that numerous non-causal variants can capture signal through their correlation with causal ones. Deciphering the causal variants from non-causal ones found associated because of LD, has proven extremely difficult.</p>
    <p>To address this challenge, <italic toggle="yes">in silico</italic> fine-mapping methods have been developed (<xref rid="vbad188-B9" ref-type="bibr">Schaid <italic toggle="yes">et al.</italic> 2018</xref>) to prioritize genetic variants more likely to be causal. Most fine-mapping methods are built on a Bayesian framework which jointly model the effects of multiple SNPs on a trait and use LD information to assign a probability of causality to each variant (posterior probability, PP). <monospace>PAINTOR</monospace> (<xref rid="vbad188-B6" ref-type="bibr">Kichaev <italic toggle="yes">et al.</italic> 2014</xref>) is one of such Bayesian fine-mapping methods. It is a popular approach that has been used for the prioritization of variants in hundreds of fine-mapping studies. One advantage of <monospace>PAINTOR</monospace> is its ability to incorporate functional annotations. It builds on the assumption that causal variants might act through similar biological pathways, so that enrichment for a given annotation might be leveraged to improve the accuracy of fine-mapping results. However, running <monospace>PAINTOR</monospace> requires several pre- and post-processing steps, making it time-consuming and cumbersome.</p>
    <p>In this paper, we describe the <monospace>Nextflow</monospace> (<xref rid="vbad188-B3" ref-type="bibr">Di Tommaso <italic toggle="yes">et al.</italic> 2017</xref>) pipeline called <monospace>PaintorPipe</monospace>, that aims at overcoming this issue for fast and efficient fine-mapping analyses. <monospace>PaintorPipe</monospace> performs all the pre- and post-processing steps required for a fine-mapping, apply <monospace>PAINTOR</monospace>, and produce a summary results using existing tools directly from the <monospace>PAINTOR</monospace> output.</p>
  </sec>
  <sec>
    <title>2 Workflow</title>
    <p>The <monospace>PaintorPipe</monospace> workflow is divided into three main parts: Pre-processing, Fine-mapping, and Post-Processing (<xref rid="vbad188-F1" ref-type="fig">Fig. 1</xref>), that are described below.</p>
    <fig position="float" id="vbad188-F1">
      <label>Figure 1.</label>
      <caption>
        <p>The <monospace>PaintorPipe</monospace> Workflow. The <monospace>PaintorPipe</monospace> workflow consists of three main parts, indicated on the left of the figure: pre-processing, fine-mapping, and post-processing. Each part is itself divided into modules represented as large horizontal boxes. The pre-processing part is made of three modules: <italic toggle="yes">Split GWAS into loci</italic>, <italic toggle="yes">Calculate LD</italic>, and <italic toggle="yes">Integrate annotation</italic>; the fine-mapping part is made of a single <monospace>PAINTOR</monospace> module; and the post-processing part is made of two modules, <italic toggle="yes">Interpret results</italic>, and <italic toggle="yes">Visualise</italic> that uses the <monospace>CANVIS</monospace> tool. In practice, each module is composed of several <monospace>Nextflow</monospace> processes, but for clarity purposes, only the module name is indicated on the figure. The required input files, including the GWAS file and the functional annotation files, are represented as small green boxes, while the intermediate files, that are used by other steps of the pipeline and that can optionally be saved, are represented as small yellow boxes. Finally, the output files are represented as small red boxes.</p>
      </caption>
      <graphic xlink:href="vbad188f1" position="float"/>
    </fig>
    <sec>
      <title>2.1 Pre-processing</title>
      <p>The pre-processing part aims at preparing input files for running <monospace>PAINTOR</monospace> and involves three modules: Split GWAS into loci, Calculate LD, and Integrate annotations.</p>
      <sec>
        <title>2.1.1 Split GWAS into loci</title>
        <p>The GWAS dataset is first divided into loci. The SNPs are first split into chromosomes, and ordered by ascending <italic toggle="yes">P</italic>-value. The loci are then generated per chromosome, starting from the smallest <italic toggle="yes">P</italic>-value SNP and iteratively until no SNP with a <italic toggle="yes">P</italic>-value lower than <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="italic">pval</mml:mi><mml:mo>_</mml:mo><mml:mi mathvariant="italic">lead</mml:mi></mml:mrow></mml:math></inline-formula> (5e−8 by default) is found. More precisely the smallest <italic toggle="yes">P</italic>-value SNP is selected and grouped with all other SNPs with <italic toggle="yes">P</italic>-values lower than <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="italic">pval</mml:mi><mml:mo>_</mml:mo><mml:mi mathvariant="italic">nonlead</mml:mi></mml:mrow></mml:math></inline-formula> (1 by default) and located less than a distance away from it (500 kilobases by default). This process is repeated with the second smallest <italic toggle="yes">P</italic>-value SNP, and if the newly formed locus overlaps with the first one, they are merged together. This is done iteratively and when a new locus is formed, its position on the genome is compared to the ones of all previously made loci and in case of overlap they are merged together. Therefore the final loci are completely disjoint on the genome, i.e. do not share any SNPs. The resulting loci are provided as SNP files in which each SNP is associated to multiple pieces of information including a <italic toggle="yes">z-score</italic>, computed by dividing the SNP effect size by the SNP effect size standard error.</p>
      </sec>
      <sec>
        <title>2.1.2 Calculate LD</title>
        <p>Each resulting locus file is subsequently passed on to the <italic toggle="yes">Calculate LD</italic> module that produces a linkage disequilibrium (LD) matrix for each locus, by computing the Pearson correlation coefficient between each pair of SNPs of the locus. In addition to the locus SNPs, this module takes as input a map file and variant VCF files that are automatically downloaded from the 1000 Genomes Project website (<ext-link xlink:href="https://www.internationalgenome.org/" ext-link-type="uri">https://www.internationalgenome.org/</ext-link>, <xref rid="vbad188-B4" ref-type="bibr">Finucane <italic toggle="yes">et al.</italic> 2015</xref>).</p>
      </sec>
      <sec>
        <title>2.1.3 Integrate annotations</title>
        <p>Since the majority of disease associated variants are found in non-coding regions of the genome (<xref rid="vbad188-B2" ref-type="bibr">Claringbould and Zaugg 2021</xref>), a functional annotation of these variants is crucial. Variants located in regulatory regions, such as enhancers or promoters, can influence gene expression and increase the risk of developing the disease (<xref rid="vbad188-B2" ref-type="bibr">Claringbould and Zaugg 2021</xref>).</p>
        <p>Therefore, functional annotations, which provide information on the biological functions of different genomic regions, can help prioritize disease-causing variants by increasing their weight. In addition, functional annotations can also be used <italic toggle="yes">a posteriori</italic>, to better understand the mechanisms underlying diseases, which can lead to the development of new treatments or more effective preventive strategies. An example of possible disease-causing mechanism is shown in <xref rid="vbad188-F2" ref-type="fig">Fig. 2</xref>.</p>
        <fig position="float" id="vbad188-F2">
          <label>Figure 2.</label>
          <caption>
            <p>Illustration of the effect of genetic variants located in gene enhancers. (Top) Each enhancer can be linked to multiple genes, and conversely each gene can be linked to multiple enhancers. (Bottom) Here, an SNP variant located in an enhancer disrupts the activity of a distant gene, leading to increased disease risk.</p>
          </caption>
          <graphic xlink:href="vbad188f2" position="float"/>
        </fig>
        <p>Within <monospace>PaintorPipe</monospace>, the <italic toggle="yes">Integrate annotation</italic> module only requires a single input file that provides the short names and the file paths on the system, of the different annotations. This process then computes the overlap between each SNP and each annotation, leading to an annotation matrix for each locus with SNPs in rows and annotations in columns. These matrices are made of 0 and 1 values, depending on whether the SNP is included in the given annotation. To achieve optimal results with the <monospace>PAINTOR</monospace> framework and as stated by its authors, it is recommended to use a maximum of five annotations.</p>
      </sec>
    </sec>
    <sec>
      <title>2.2 Fine-mapping</title>
      <p>The PP of causality of each variant is calculated by <monospace>PAINTOR</monospace> using the outputs of the pre-processing modules (i.e. the loci, the LD matrices and the annotation matrices). Note that the running time for this module can be computationally expensive (several hours), especially for datasets with a large number of variants (millions). For each locus, <monospace>PAINTOR</monospace> identifies credible sets of SNPs that have a high probability of being causal and are likely to contain the causal variants. Once the fine-mapping analysis is performed, <monospace>PaintorPipe</monospace> retrieves results from each locus and annotates them for a better interpretation. This is the Post-processing part described below.</p>
    </sec>
    <sec>
      <title>2.3 Post-processing</title>
      <p>The post-processing part produces plots and tables for an easier interpretation of the fine-mapping results. Several computations are performed, including the number and percentage of all (or each locus) SNPs reaching 50%, 80%, and 95% of the cumulative sum of all (or each locus) SNP PPs. Finally, thanks to the <monospace>CANVIS</monospace> tool, each credible set of SNPs within a locus is graphically represented, together with the LD structure of the locus (<xref rid="vbad188-F3" ref-type="fig">Fig. 3</xref>).</p>
      <fig position="float" id="vbad188-F3">
        <label>Figure 3.</label>
        <caption>
          <p>Example of a <monospace>CANVIS</monospace> visualization produced by <monospace>PaintorPipe</monospace> on a specific locus. The plot is made of three parts (from top to bottom): (i) a dotplot showing for each SNP of the locus, its genomic position on the <italic toggle="yes">x</italic> axis and its posterior probability to be causal (PP) on the <italic toggle="yes">y</italic> axis, with the credible set highlighted in red. The non-causal SNPs (not significant) are plotted in blue, and the different types of annotations used in this run are indicated by horizontal bars below the plot; (ii) a dotplot representing for each SNP of the locus, its genomic position on the x axis and its −log10(<italic toggle="yes">P</italic> value) on the <italic toggle="yes">y</italic> axis. The most probable causal variant is represented by a black diamond, and the color gradient represents the linkage disequilibrium (correlation) between this variant and the other SNPs of the locus; (iii) a heatmap corresponding to the linkage disequilibrium (SNP pair correlation) of the locus. Here, <monospace>PaintorPipe</monospace> version 1.2 was run with the following parameters <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mi mathvariant="italic">chromosome</mml:mi><mml:mo>_</mml:mo><mml:mi mathvariant="italic">header</mml:mi><mml:mo> </mml:mo><mml:mi mathvariant="italic">Chr</mml:mi><mml:mo> </mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="italic">pvalue</mml:mi><mml:mo>_</mml:mo><mml:mi mathvariant="italic">nonlead</mml:mi><mml:mo> </mml:mo><mml:mn>0.01</mml:mn><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="italic">snp</mml:mi><mml:mo> </mml:mo><mml:mn>100000</mml:mn></mml:mrow></mml:math></inline-formula> on the 2018 Coronary Atery Disease (CAD) GWAS study <xref rid="vbad188-B10" ref-type="bibr">Van Der Harst and Verweij (2018)</xref> using four annotations from <xref rid="vbad188-B4" ref-type="bibr">Finucane <italic toggle="yes">et al.</italic> (2015)</xref>. This run produced 149 loci. This figure presents the sixth locus of chromosome 6.</p>
        </caption>
        <graphic xlink:href="vbad188f3" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>3 Details and parameters</title>
    <p><monospace>PaintorPipe</monospace> is designed to work on human data and to be customizable with several adjustable parameters. Only two inputs are required to run the pipeline: the GWAS summary statistics file (using the—<monospace>gwasFile</monospace> parameter) and the annotation location file (using the—<monospace>annotationsFile</monospace> parameter).</p>
    <p>The other input and output parameters are optional and have default values. This includes in particular the header parameters of the GWAS file, the different adjustable thresholds for the <italic toggle="yes">P</italic>-values and the posterior probabilities, but also the version of the reference genome (hg19 or hg38) and the distance in kilobases (kb) around the lead SNP used to define a locus (see Pre-processing section above). As the pipeline is implemented in <monospace>Nextflow</monospace>, it is possible to use <monospace>Nextflow</monospace> optional parameters (in particular the –C option to provide a custom configuration file).</p>
    <p>In order to ensure reproducibility and manage tools, packages and versions in a controlled environment, <monospace>PaintorPipe</monospace> uses a <monospace>Singularity</monospace> image (<xref rid="vbad188-B7" ref-type="bibr">Kurtzer <italic toggle="yes">et al.</italic> 2017</xref>). This <monospace>Singularity</monospace> image is hosted on <monospace>Sylabs</monospace> (<ext-link xlink:href="https://sylabs.io/" ext-link-type="uri">https://sylabs.io/</ext-link>), and is specified in the configuration file. The pipeline can be run on a local machine or on a slurm cluster, and can therefore take advantage of the increased resources available on the latter to speed up the analyses (e.g. over 24 h for a GWAS file of 7 million SNPs).</p>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p><monospace>PAINTOR</monospace> is a popular fine-mapping software, that uses a Bayesian approach to calculate the posterior probability of SNPs to be causal. Its ability to incorporate functional annotations makes it a powerful tool for identifying causal variants underlying polygenic traits and diseases. To address its time-consuming and burdensome pre- and post-processing parts, we developed <monospace>PaintorPipe</monospace>, a <monospace>Nextflow</monospace> DSL2 pipeline that automates the entire process for fast and user-friendly analysis. By reducing the number of candidate variants to a more manageable and meaningful set, <monospace>PaintorPipe</monospace> can be used to prioritize candidate variants for further investigation.</p>
    <p>Indeed, the variants with the highest probability of being causal can be more carefully inspected before experimental validation. For instance their location with respect to genes and regulatory elements can be computed (or derived from the pipeline outputs in case such functional annotations were used) and for the case of variants located in enhancers, the genes they are susceptible to affect can be retrieved from predicted enhancer/gene relationships [for instance from the ABC model (<xref rid="vbad188-B5" ref-type="bibr">Fulco <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="vbad188-B8" ref-type="bibr">Nasser <italic toggle="yes">et al.</italic> 2021</xref>) at <ext-link xlink:href="https://www.engreitzlab.org/resources" ext-link-type="uri">https://www.engreitzlab.org/resources</ext-link>].</p>
    <p>In short, <monospace>PaintorPipe</monospace> greatly facilitates the use of the <monospace>PAINTOR</monospace> fine-mapping program, allowing to run it from a minimum set of inputs (GWAS and annotation location files) in a reproducible way, and producing exploitable results for interpretation and visualization.</p>
    <p>Finally, while we focused our development on <monospace>PAINTOR</monospace>, most fine-mapping methods use similar information (Z-scores, LD matrix across loci, and for some of them functional annotations), and produce similar outputs. We thus expect future versions of <monospace>PaintorPipe</monospace> to be able to use some of these other tools (<xref rid="vbad188-B11" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="vbad188-B12" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2023</xref>).</p>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors would like to thank Cervin Guyomar for providing expertise on <monospace>NextFlow</monospace>, and the genotoul bioinformatics platform (<ext-link xlink:href="https://bioinfo.genotoul.fr/" ext-link-type="uri">https://bioinfo.genotoul.fr/</ext-link>) for help with software installation.</p>
  </ack>
  <sec>
    <title>Author contributions</title>
    <p>Zoé Gerber (Formal analysis [lead], Methodology [equal], Project administration [lead], Software [lead], Visualization [lead], Writing—original draft [equal], Writing—review &amp; editing [supporting]), Michel Fisun (Methodology [supporting], Software [supporting]), Hugues Aschard (Conceptualization [equal], Funding acquisition [supporting], Methodology [equal], Writing—original draft [supporting], Writing—review &amp; editing [supporting]), and Sarah Djebali (Conceptualization [equal], Funding acquisition [lead], Methodology [equal], Project administration [supporting], Software [supporting], Supervision [lead], Writing—original draft [equal], Writing—review &amp; editing [lead])</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was mainly supported by INSERM, and partly supported by Institut Pasteur.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The <monospace>PaintorPipe</monospace> code and small test dataset are freely available from GitHub at <ext-link xlink:href="https://github.com/sdjebali/PaintorPipe" ext-link-type="uri">https://github.com/sdjebali/PaintorPipe</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="vbad188-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Auton</surname><given-names>A</given-names></string-name>, <string-name><surname>Abecasis</surname><given-names>GR</given-names></string-name>, <string-name><surname>Altshuler</surname><given-names>DM</given-names></string-name></person-group><etal>et al</etal>; <collab>The 1000 Genomes Project Consortium</collab>. <article-title>A global reference for human genetic variation</article-title>. <source>Nature</source><year>2015</year>;<volume>526</volume>:<fpage>68</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">26432245</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Claringbould</surname><given-names>A</given-names></string-name>, <string-name><surname>Zaugg</surname><given-names>JB.</given-names></string-name></person-group><article-title>Enhancers in disease: molecular basis and emerging treatment strategies</article-title>. <source>Trends Mol Med</source><year>2021</year>;<volume>27</volume>:<fpage>1060</fpage>–<lpage>73</lpage>.<pub-id pub-id-type="pmid">34420874</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Di Tommaso</surname><given-names>P</given-names></string-name>, <string-name><surname>Chatzou</surname><given-names>M</given-names></string-name>, <string-name><surname>Floden</surname><given-names>EW</given-names></string-name></person-group><etal>et al</etal><article-title>Nextflow enables reproducible computational workflows</article-title>. <source>Nat Biotechnol</source><year>2017</year>;<volume>35</volume>:<fpage>316</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">28398311</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Finucane</surname><given-names>HK</given-names></string-name>, <string-name><surname>Bulik-Sullivan</surname><given-names>B</given-names></string-name>, <string-name><surname>Gusev</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal>; <collab>RACI Consortium</collab>. <article-title>Partitioning heritability by functional annotation using genome-wide association summary statistics</article-title>. <source>Nat Genet</source><year>2015</year>;<volume>47</volume>:<fpage>1228</fpage>–<lpage>35</lpage>.<pub-id pub-id-type="pmid">26414678</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fulco</surname><given-names>CP</given-names></string-name>, <string-name><surname>Nasser</surname><given-names>J</given-names></string-name>, <string-name><surname>Jones</surname><given-names>TR</given-names></string-name></person-group><etal>et al</etal><article-title>Activity-by-contact model of enhancer–promoter regulation from thousands of crispr perturbations</article-title>. <source>Nat Genet</source><year>2019</year>;<volume>51</volume>:<fpage>1664</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">31784727</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kichaev</surname><given-names>G</given-names></string-name>, <string-name><surname>Yang</surname><given-names>W-Y</given-names></string-name>, <string-name><surname>Lindstrom</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Integrating functional data to prioritize causal variants in statistical fine-mapping studies</article-title>. <source>PLoS Genet</source><year>2014</year>;<volume>10</volume>:<fpage>e1004722</fpage>.<pub-id pub-id-type="pmid">25357204</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kurtzer</surname><given-names>GM</given-names></string-name>, <string-name><surname>Sochat</surname><given-names>V</given-names></string-name>, <string-name><surname>Bauer</surname><given-names>MW.</given-names></string-name></person-group><article-title>Singularity: scientific containers for mobility of compute</article-title>. <source>PLoS ONE</source><year>2017</year>;<volume>12</volume>:<fpage>e0177459</fpage>.<pub-id pub-id-type="pmid">28494014</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nasser</surname><given-names>J</given-names></string-name>, <string-name><surname>Bergman</surname><given-names>DT</given-names></string-name>, <string-name><surname>Fulco</surname><given-names>CP</given-names></string-name></person-group><etal>et al</etal><article-title>Genome-wide enhancer maps link risk variants to disease genes</article-title>. <source>Nature</source><year>2021</year>;<volume>593</volume>:<fpage>238</fpage>–<lpage>43</lpage>.<pub-id pub-id-type="pmid">33828297</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schaid</surname><given-names>DJ</given-names></string-name>, <string-name><surname>Chen</surname><given-names>W</given-names></string-name>, <string-name><surname>Larson</surname><given-names>NB.</given-names></string-name></person-group><article-title>From genome-wide associations to candidate causal variants by statistical fine-mapping</article-title>. <source>Nat Rev Genet</source><year>2018</year>;<volume>19</volume>:<fpage>491</fpage>–<lpage>504</lpage>.<pub-id pub-id-type="pmid">29844615</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Van Der Harst</surname><given-names>P</given-names></string-name>, <string-name><surname>Verweij</surname><given-names>N.</given-names></string-name></person-group><article-title>Identification of 64 novel genetic loci provides an expanded view on the genetic architecture of coronary artery disease</article-title>. <source>Circ Res</source><year>2018</year>;<volume>122</volume>:<fpage>433</fpage>–<lpage>43</lpage>.<pub-id pub-id-type="pmid">29212778</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>G</given-names></string-name>, <string-name><surname>Sarkar</surname><given-names>A</given-names></string-name>, <string-name><surname>Carbonetto</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>A simple new approach to variable selection in regression, with application to genetic fine mapping</article-title>. <source>J R Stat Soc Series B Stat Methodol</source><year>2020</year>;<volume>82</volume>:<fpage>1273</fpage>–<lpage>300</lpage>.<pub-id pub-id-type="pmid">37220626</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>Z</given-names></string-name>, <string-name><surname>Wang</surname><given-names>C</given-names></string-name>, <string-name><surname>Liu</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Carma is a new Bayesian model for fine-mapping in genome-wide association meta-analyses</article-title>. <source>Nat Genet</source><year>2023</year>;<volume>55</volume>:<fpage>1057</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">37169873</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinform Adv</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinform Adv</journal-id>
    <journal-id journal-id-type="publisher-id">bioadv</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics Advances</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2635-0041</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10783948</article-id>
    <article-id pub-id-type="doi">10.1093/bioadv/vbad188</article-id>
    <article-id pub-id-type="publisher-id">vbad188</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Application Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genetics and Population Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PaintorPipe: a pipeline for genetic variant fine-mapping using functional annotations</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Gerber</surname>
          <given-names>Zoé</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="https://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="lead">Formal analysis</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="equal">Methodology</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Project administration" vocab-term-identifier="https://credit.niso.org/contributor-roles/project-administration" degree-contribution="lead">Project administration</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Software" vocab-term-identifier="https://credit.niso.org/contributor-roles/software" degree-contribution="lead">Software</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization" degree-contribution="lead">Visualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="supporting">Writing - review &amp; editing</role>
        <aff><institution>IRSD, Université de Toulouse, INSERM, INRAE, ENVT, Université Toulouse III - Paul Sabatier (UPS)</institution>, 31024 Toulouse, <country country="FR">France</country></aff>
        <aff><institution>Bordeaux Bioinformatics Master, Université de Bordeaux</institution>, 33405 Talence, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fisun</surname>
          <given-names>Michel</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="supporting">Methodology</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Software" vocab-term-identifier="https://credit.niso.org/contributor-roles/software" degree-contribution="supporting">Software</role>
        <aff><institution>Department of Computational Biology, Pasteur Institute, Université Paris Cité</institution>, 75015 Paris, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7554-6783</contrib-id>
        <name>
          <surname>Aschard</surname>
          <given-names>Hugues</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/conceptualization" degree-contribution="equal">Conceptualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Funding acquisition" vocab-term-identifier="https://credit.niso.org/contributor-roles/funding-acquisition" degree-contribution="supporting">Funding acquisition</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="equal">Methodology</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="supporting">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="supporting">Writing - review &amp; editing</role>
        <aff><institution>Department of Computational Biology, Pasteur Institute, Université Paris Cité</institution>, 75015 Paris, <country country="FR">France</country></aff>
        <aff><institution>Program in Genetic Epidemiology and Statistical Genetics, Harvard T.H. Chan School of Public Health</institution>, Boston, MA 02115, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0599-1267</contrib-id>
        <name>
          <surname>Djebali</surname>
          <given-names>Sarah</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/conceptualization" degree-contribution="equal">Conceptualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Funding acquisition" vocab-term-identifier="https://credit.niso.org/contributor-roles/funding-acquisition" degree-contribution="lead">Funding acquisition</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="equal">Methodology</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Project administration" vocab-term-identifier="https://credit.niso.org/contributor-roles/project-administration" degree-contribution="supporting">Project administration</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Software" vocab-term-identifier="https://credit.niso.org/contributor-roles/software" degree-contribution="supporting">Software</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="https://credit.niso.org/contributor-roles/supervision" degree-contribution="lead">Supervision</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="lead">Writing - review &amp; editing</role>
        <aff><institution>IRSD, Université de Toulouse, INSERM, INRAE, ENVT, Université Toulouse III - Paul Sabatier (UPS)</institution>, 31024 Toulouse, <country country="FR">France</country></aff>
        <xref rid="vbad188-cor1" ref-type="corresp"/>
        <!--sarah.djebali@inserm.fr-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Mulder</surname>
          <given-names>Nicola</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="vbad188-cor1">Corresponding author. IRSD, Université de Toulouse, INSERM, INRAE, ENVT, Université Toulouse III – Paul Sabatier (UPS), U1220 – Bat B – CHU Purpan Place du Docteur Baylac – CS 60039, 31024 Toulouse Cedex 3, France. E-mail: <email>sarah.djebali@inserm.fr</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-12-21">
      <day>21</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>21</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <volume>4</volume>
    <issue>1</issue>
    <elocation-id>vbad188</elocation-id>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>07</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>11</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>11</day>
        <month>1</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="vbad188.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Genome-wide association studies (GWAS) have identified thousands of genetic variants associated with common diseases. These results include a mix of causal and non-causal variants related through strong linkage disequilibrium (LD, i.e. highly correlated). Fine-mapping methods have been developed to decipher the causal from non-causal variants using GWAS results and LD information, assigning to each variant a probability of being causal. In this field, the <monospace>PAINTOR</monospace> program has become a standard, one of its advantages being its ability to take into account functional annotations. This approach requires many pre- and post-processing steps. Here, we developed a <monospace>Nextflow</monospace> pipeline called <monospace>PaintorPipe</monospace> that wraps all these steps and the fine-mapping itself together. <monospace>PaintorPipe</monospace> uses three independent sources of information: GWAS summary statistics, LD information and functional annotations, to rank the variants according to their susceptibility to be involved in the disease development. The <monospace>PAINTOR</monospace> framework is used to calculate the posterior probability of each variant (single nucleotide polymorphism) to be causal (a.k.a. Bayesian fine-mapping). The resulting credible sets of variants are annotated with their biological functions and visualized using <monospace>CANVIS</monospace>. This pipeline requires minimal input from users (a GWAS summary statistics file and a set of functional annotation files) and is designed to be modular and customizable, allowing for an easy integration of diverse functional annotations.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p><monospace>PaintorPipe</monospace> is implemented in the <monospace>Nextflow</monospace> pipeline specific language, can be run locally or on a slurm cluster and handles containerization using <monospace>Singularity</monospace>. <monospace>PaintorPipe</monospace> is freely available on GitHub (<ext-link xlink:href="https://github.com/sdjebali/PaintorPipe" ext-link-type="uri">https://github.com/sdjebali/PaintorPipe</ext-link>).</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>INSERM</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001677</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="5"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Most common human diseases, such as diabetes, obesity, cardiovascular disease/stroke, cancer, neuropsychiatric, auto-immunity, and inflammatory diseases, are multifactorial, depending on numerous environmental and genetic factors. The genetic component is typically highly polygenic, likely involving hundreds to thousands of causal variants spread across the entire genome. The identification of genetic variants, mostly single nucleotide polymorphisms (SNPs), associated with those common polygenic diseases heavily relies on genome-wide association studies (GWAS). The GWAS consists in a massively parallel univariate testing of millions of variants using a standard linear additive model. This approach has proven quite efficient, identifying thousands of associations, but also has some limitations. In particular, the extent of linkage disequilibrium (LD, i.e. correlation) across variants in the human genome implies that numerous non-causal variants can capture signal through their correlation with causal ones. Deciphering the causal variants from non-causal ones found associated because of LD, has proven extremely difficult.</p>
    <p>To address this challenge, <italic toggle="yes">in silico</italic> fine-mapping methods have been developed (<xref rid="vbad188-B9" ref-type="bibr">Schaid <italic toggle="yes">et al.</italic> 2018</xref>) to prioritize genetic variants more likely to be causal. Most fine-mapping methods are built on a Bayesian framework which jointly model the effects of multiple SNPs on a trait and use LD information to assign a probability of causality to each variant (posterior probability, PP). <monospace>PAINTOR</monospace> (<xref rid="vbad188-B6" ref-type="bibr">Kichaev <italic toggle="yes">et al.</italic> 2014</xref>) is one of such Bayesian fine-mapping methods. It is a popular approach that has been used for the prioritization of variants in hundreds of fine-mapping studies. One advantage of <monospace>PAINTOR</monospace> is its ability to incorporate functional annotations. It builds on the assumption that causal variants might act through similar biological pathways, so that enrichment for a given annotation might be leveraged to improve the accuracy of fine-mapping results. However, running <monospace>PAINTOR</monospace> requires several pre- and post-processing steps, making it time-consuming and cumbersome.</p>
    <p>In this paper, we describe the <monospace>Nextflow</monospace> (<xref rid="vbad188-B3" ref-type="bibr">Di Tommaso <italic toggle="yes">et al.</italic> 2017</xref>) pipeline called <monospace>PaintorPipe</monospace>, that aims at overcoming this issue for fast and efficient fine-mapping analyses. <monospace>PaintorPipe</monospace> performs all the pre- and post-processing steps required for a fine-mapping, apply <monospace>PAINTOR</monospace>, and produce a summary results using existing tools directly from the <monospace>PAINTOR</monospace> output.</p>
  </sec>
  <sec>
    <title>2 Workflow</title>
    <p>The <monospace>PaintorPipe</monospace> workflow is divided into three main parts: Pre-processing, Fine-mapping, and Post-Processing (<xref rid="vbad188-F1" ref-type="fig">Fig. 1</xref>), that are described below.</p>
    <fig position="float" id="vbad188-F1">
      <label>Figure 1.</label>
      <caption>
        <p>The <monospace>PaintorPipe</monospace> Workflow. The <monospace>PaintorPipe</monospace> workflow consists of three main parts, indicated on the left of the figure: pre-processing, fine-mapping, and post-processing. Each part is itself divided into modules represented as large horizontal boxes. The pre-processing part is made of three modules: <italic toggle="yes">Split GWAS into loci</italic>, <italic toggle="yes">Calculate LD</italic>, and <italic toggle="yes">Integrate annotation</italic>; the fine-mapping part is made of a single <monospace>PAINTOR</monospace> module; and the post-processing part is made of two modules, <italic toggle="yes">Interpret results</italic>, and <italic toggle="yes">Visualise</italic> that uses the <monospace>CANVIS</monospace> tool. In practice, each module is composed of several <monospace>Nextflow</monospace> processes, but for clarity purposes, only the module name is indicated on the figure. The required input files, including the GWAS file and the functional annotation files, are represented as small green boxes, while the intermediate files, that are used by other steps of the pipeline and that can optionally be saved, are represented as small yellow boxes. Finally, the output files are represented as small red boxes.</p>
      </caption>
      <graphic xlink:href="vbad188f1" position="float"/>
    </fig>
    <sec>
      <title>2.1 Pre-processing</title>
      <p>The pre-processing part aims at preparing input files for running <monospace>PAINTOR</monospace> and involves three modules: Split GWAS into loci, Calculate LD, and Integrate annotations.</p>
      <sec>
        <title>2.1.1 Split GWAS into loci</title>
        <p>The GWAS dataset is first divided into loci. The SNPs are first split into chromosomes, and ordered by ascending <italic toggle="yes">P</italic>-value. The loci are then generated per chromosome, starting from the smallest <italic toggle="yes">P</italic>-value SNP and iteratively until no SNP with a <italic toggle="yes">P</italic>-value lower than <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="italic">pval</mml:mi><mml:mo>_</mml:mo><mml:mi mathvariant="italic">lead</mml:mi></mml:mrow></mml:math></inline-formula> (5e−8 by default) is found. More precisely the smallest <italic toggle="yes">P</italic>-value SNP is selected and grouped with all other SNPs with <italic toggle="yes">P</italic>-values lower than <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="italic">pval</mml:mi><mml:mo>_</mml:mo><mml:mi mathvariant="italic">nonlead</mml:mi></mml:mrow></mml:math></inline-formula> (1 by default) and located less than a distance away from it (500 kilobases by default). This process is repeated with the second smallest <italic toggle="yes">P</italic>-value SNP, and if the newly formed locus overlaps with the first one, they are merged together. This is done iteratively and when a new locus is formed, its position on the genome is compared to the ones of all previously made loci and in case of overlap they are merged together. Therefore the final loci are completely disjoint on the genome, i.e. do not share any SNPs. The resulting loci are provided as SNP files in which each SNP is associated to multiple pieces of information including a <italic toggle="yes">z-score</italic>, computed by dividing the SNP effect size by the SNP effect size standard error.</p>
      </sec>
      <sec>
        <title>2.1.2 Calculate LD</title>
        <p>Each resulting locus file is subsequently passed on to the <italic toggle="yes">Calculate LD</italic> module that produces a linkage disequilibrium (LD) matrix for each locus, by computing the Pearson correlation coefficient between each pair of SNPs of the locus. In addition to the locus SNPs, this module takes as input a map file and variant VCF files that are automatically downloaded from the 1000 Genomes Project website (<ext-link xlink:href="https://www.internationalgenome.org/" ext-link-type="uri">https://www.internationalgenome.org/</ext-link>, <xref rid="vbad188-B4" ref-type="bibr">Finucane <italic toggle="yes">et al.</italic> 2015</xref>).</p>
      </sec>
      <sec>
        <title>2.1.3 Integrate annotations</title>
        <p>Since the majority of disease associated variants are found in non-coding regions of the genome (<xref rid="vbad188-B2" ref-type="bibr">Claringbould and Zaugg 2021</xref>), a functional annotation of these variants is crucial. Variants located in regulatory regions, such as enhancers or promoters, can influence gene expression and increase the risk of developing the disease (<xref rid="vbad188-B2" ref-type="bibr">Claringbould and Zaugg 2021</xref>).</p>
        <p>Therefore, functional annotations, which provide information on the biological functions of different genomic regions, can help prioritize disease-causing variants by increasing their weight. In addition, functional annotations can also be used <italic toggle="yes">a posteriori</italic>, to better understand the mechanisms underlying diseases, which can lead to the development of new treatments or more effective preventive strategies. An example of possible disease-causing mechanism is shown in <xref rid="vbad188-F2" ref-type="fig">Fig. 2</xref>.</p>
        <fig position="float" id="vbad188-F2">
          <label>Figure 2.</label>
          <caption>
            <p>Illustration of the effect of genetic variants located in gene enhancers. (Top) Each enhancer can be linked to multiple genes, and conversely each gene can be linked to multiple enhancers. (Bottom) Here, an SNP variant located in an enhancer disrupts the activity of a distant gene, leading to increased disease risk.</p>
          </caption>
          <graphic xlink:href="vbad188f2" position="float"/>
        </fig>
        <p>Within <monospace>PaintorPipe</monospace>, the <italic toggle="yes">Integrate annotation</italic> module only requires a single input file that provides the short names and the file paths on the system, of the different annotations. This process then computes the overlap between each SNP and each annotation, leading to an annotation matrix for each locus with SNPs in rows and annotations in columns. These matrices are made of 0 and 1 values, depending on whether the SNP is included in the given annotation. To achieve optimal results with the <monospace>PAINTOR</monospace> framework and as stated by its authors, it is recommended to use a maximum of five annotations.</p>
      </sec>
    </sec>
    <sec>
      <title>2.2 Fine-mapping</title>
      <p>The PP of causality of each variant is calculated by <monospace>PAINTOR</monospace> using the outputs of the pre-processing modules (i.e. the loci, the LD matrices and the annotation matrices). Note that the running time for this module can be computationally expensive (several hours), especially for datasets with a large number of variants (millions). For each locus, <monospace>PAINTOR</monospace> identifies credible sets of SNPs that have a high probability of being causal and are likely to contain the causal variants. Once the fine-mapping analysis is performed, <monospace>PaintorPipe</monospace> retrieves results from each locus and annotates them for a better interpretation. This is the Post-processing part described below.</p>
    </sec>
    <sec>
      <title>2.3 Post-processing</title>
      <p>The post-processing part produces plots and tables for an easier interpretation of the fine-mapping results. Several computations are performed, including the number and percentage of all (or each locus) SNPs reaching 50%, 80%, and 95% of the cumulative sum of all (or each locus) SNP PPs. Finally, thanks to the <monospace>CANVIS</monospace> tool, each credible set of SNPs within a locus is graphically represented, together with the LD structure of the locus (<xref rid="vbad188-F3" ref-type="fig">Fig. 3</xref>).</p>
      <fig position="float" id="vbad188-F3">
        <label>Figure 3.</label>
        <caption>
          <p>Example of a <monospace>CANVIS</monospace> visualization produced by <monospace>PaintorPipe</monospace> on a specific locus. The plot is made of three parts (from top to bottom): (i) a dotplot showing for each SNP of the locus, its genomic position on the <italic toggle="yes">x</italic> axis and its posterior probability to be causal (PP) on the <italic toggle="yes">y</italic> axis, with the credible set highlighted in red. The non-causal SNPs (not significant) are plotted in blue, and the different types of annotations used in this run are indicated by horizontal bars below the plot; (ii) a dotplot representing for each SNP of the locus, its genomic position on the x axis and its −log10(<italic toggle="yes">P</italic> value) on the <italic toggle="yes">y</italic> axis. The most probable causal variant is represented by a black diamond, and the color gradient represents the linkage disequilibrium (correlation) between this variant and the other SNPs of the locus; (iii) a heatmap corresponding to the linkage disequilibrium (SNP pair correlation) of the locus. Here, <monospace>PaintorPipe</monospace> version 1.2 was run with the following parameters <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mi mathvariant="italic">chromosome</mml:mi><mml:mo>_</mml:mo><mml:mi mathvariant="italic">header</mml:mi><mml:mo> </mml:mo><mml:mi mathvariant="italic">Chr</mml:mi><mml:mo> </mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="italic">pvalue</mml:mi><mml:mo>_</mml:mo><mml:mi mathvariant="italic">nonlead</mml:mi><mml:mo> </mml:mo><mml:mn>0.01</mml:mn><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="italic">snp</mml:mi><mml:mo> </mml:mo><mml:mn>100000</mml:mn></mml:mrow></mml:math></inline-formula> on the 2018 Coronary Atery Disease (CAD) GWAS study <xref rid="vbad188-B10" ref-type="bibr">Van Der Harst and Verweij (2018)</xref> using four annotations from <xref rid="vbad188-B4" ref-type="bibr">Finucane <italic toggle="yes">et al.</italic> (2015)</xref>. This run produced 149 loci. This figure presents the sixth locus of chromosome 6.</p>
        </caption>
        <graphic xlink:href="vbad188f3" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>3 Details and parameters</title>
    <p><monospace>PaintorPipe</monospace> is designed to work on human data and to be customizable with several adjustable parameters. Only two inputs are required to run the pipeline: the GWAS summary statistics file (using the—<monospace>gwasFile</monospace> parameter) and the annotation location file (using the—<monospace>annotationsFile</monospace> parameter).</p>
    <p>The other input and output parameters are optional and have default values. This includes in particular the header parameters of the GWAS file, the different adjustable thresholds for the <italic toggle="yes">P</italic>-values and the posterior probabilities, but also the version of the reference genome (hg19 or hg38) and the distance in kilobases (kb) around the lead SNP used to define a locus (see Pre-processing section above). As the pipeline is implemented in <monospace>Nextflow</monospace>, it is possible to use <monospace>Nextflow</monospace> optional parameters (in particular the –C option to provide a custom configuration file).</p>
    <p>In order to ensure reproducibility and manage tools, packages and versions in a controlled environment, <monospace>PaintorPipe</monospace> uses a <monospace>Singularity</monospace> image (<xref rid="vbad188-B7" ref-type="bibr">Kurtzer <italic toggle="yes">et al.</italic> 2017</xref>). This <monospace>Singularity</monospace> image is hosted on <monospace>Sylabs</monospace> (<ext-link xlink:href="https://sylabs.io/" ext-link-type="uri">https://sylabs.io/</ext-link>), and is specified in the configuration file. The pipeline can be run on a local machine or on a slurm cluster, and can therefore take advantage of the increased resources available on the latter to speed up the analyses (e.g. over 24 h for a GWAS file of 7 million SNPs).</p>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p><monospace>PAINTOR</monospace> is a popular fine-mapping software, that uses a Bayesian approach to calculate the posterior probability of SNPs to be causal. Its ability to incorporate functional annotations makes it a powerful tool for identifying causal variants underlying polygenic traits and diseases. To address its time-consuming and burdensome pre- and post-processing parts, we developed <monospace>PaintorPipe</monospace>, a <monospace>Nextflow</monospace> DSL2 pipeline that automates the entire process for fast and user-friendly analysis. By reducing the number of candidate variants to a more manageable and meaningful set, <monospace>PaintorPipe</monospace> can be used to prioritize candidate variants for further investigation.</p>
    <p>Indeed, the variants with the highest probability of being causal can be more carefully inspected before experimental validation. For instance their location with respect to genes and regulatory elements can be computed (or derived from the pipeline outputs in case such functional annotations were used) and for the case of variants located in enhancers, the genes they are susceptible to affect can be retrieved from predicted enhancer/gene relationships [for instance from the ABC model (<xref rid="vbad188-B5" ref-type="bibr">Fulco <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="vbad188-B8" ref-type="bibr">Nasser <italic toggle="yes">et al.</italic> 2021</xref>) at <ext-link xlink:href="https://www.engreitzlab.org/resources" ext-link-type="uri">https://www.engreitzlab.org/resources</ext-link>].</p>
    <p>In short, <monospace>PaintorPipe</monospace> greatly facilitates the use of the <monospace>PAINTOR</monospace> fine-mapping program, allowing to run it from a minimum set of inputs (GWAS and annotation location files) in a reproducible way, and producing exploitable results for interpretation and visualization.</p>
    <p>Finally, while we focused our development on <monospace>PAINTOR</monospace>, most fine-mapping methods use similar information (Z-scores, LD matrix across loci, and for some of them functional annotations), and produce similar outputs. We thus expect future versions of <monospace>PaintorPipe</monospace> to be able to use some of these other tools (<xref rid="vbad188-B11" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="vbad188-B12" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2023</xref>).</p>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors would like to thank Cervin Guyomar for providing expertise on <monospace>NextFlow</monospace>, and the genotoul bioinformatics platform (<ext-link xlink:href="https://bioinfo.genotoul.fr/" ext-link-type="uri">https://bioinfo.genotoul.fr/</ext-link>) for help with software installation.</p>
  </ack>
  <sec>
    <title>Author contributions</title>
    <p>Zoé Gerber (Formal analysis [lead], Methodology [equal], Project administration [lead], Software [lead], Visualization [lead], Writing—original draft [equal], Writing—review &amp; editing [supporting]), Michel Fisun (Methodology [supporting], Software [supporting]), Hugues Aschard (Conceptualization [equal], Funding acquisition [supporting], Methodology [equal], Writing—original draft [supporting], Writing—review &amp; editing [supporting]), and Sarah Djebali (Conceptualization [equal], Funding acquisition [lead], Methodology [equal], Project administration [supporting], Software [supporting], Supervision [lead], Writing—original draft [equal], Writing—review &amp; editing [lead])</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was mainly supported by INSERM, and partly supported by Institut Pasteur.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The <monospace>PaintorPipe</monospace> code and small test dataset are freely available from GitHub at <ext-link xlink:href="https://github.com/sdjebali/PaintorPipe" ext-link-type="uri">https://github.com/sdjebali/PaintorPipe</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="vbad188-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Auton</surname><given-names>A</given-names></string-name>, <string-name><surname>Abecasis</surname><given-names>GR</given-names></string-name>, <string-name><surname>Altshuler</surname><given-names>DM</given-names></string-name></person-group><etal>et al</etal>; <collab>The 1000 Genomes Project Consortium</collab>. <article-title>A global reference for human genetic variation</article-title>. <source>Nature</source><year>2015</year>;<volume>526</volume>:<fpage>68</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">26432245</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Claringbould</surname><given-names>A</given-names></string-name>, <string-name><surname>Zaugg</surname><given-names>JB.</given-names></string-name></person-group><article-title>Enhancers in disease: molecular basis and emerging treatment strategies</article-title>. <source>Trends Mol Med</source><year>2021</year>;<volume>27</volume>:<fpage>1060</fpage>–<lpage>73</lpage>.<pub-id pub-id-type="pmid">34420874</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Di Tommaso</surname><given-names>P</given-names></string-name>, <string-name><surname>Chatzou</surname><given-names>M</given-names></string-name>, <string-name><surname>Floden</surname><given-names>EW</given-names></string-name></person-group><etal>et al</etal><article-title>Nextflow enables reproducible computational workflows</article-title>. <source>Nat Biotechnol</source><year>2017</year>;<volume>35</volume>:<fpage>316</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">28398311</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Finucane</surname><given-names>HK</given-names></string-name>, <string-name><surname>Bulik-Sullivan</surname><given-names>B</given-names></string-name>, <string-name><surname>Gusev</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal>; <collab>RACI Consortium</collab>. <article-title>Partitioning heritability by functional annotation using genome-wide association summary statistics</article-title>. <source>Nat Genet</source><year>2015</year>;<volume>47</volume>:<fpage>1228</fpage>–<lpage>35</lpage>.<pub-id pub-id-type="pmid">26414678</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fulco</surname><given-names>CP</given-names></string-name>, <string-name><surname>Nasser</surname><given-names>J</given-names></string-name>, <string-name><surname>Jones</surname><given-names>TR</given-names></string-name></person-group><etal>et al</etal><article-title>Activity-by-contact model of enhancer–promoter regulation from thousands of crispr perturbations</article-title>. <source>Nat Genet</source><year>2019</year>;<volume>51</volume>:<fpage>1664</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">31784727</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kichaev</surname><given-names>G</given-names></string-name>, <string-name><surname>Yang</surname><given-names>W-Y</given-names></string-name>, <string-name><surname>Lindstrom</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Integrating functional data to prioritize causal variants in statistical fine-mapping studies</article-title>. <source>PLoS Genet</source><year>2014</year>;<volume>10</volume>:<fpage>e1004722</fpage>.<pub-id pub-id-type="pmid">25357204</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kurtzer</surname><given-names>GM</given-names></string-name>, <string-name><surname>Sochat</surname><given-names>V</given-names></string-name>, <string-name><surname>Bauer</surname><given-names>MW.</given-names></string-name></person-group><article-title>Singularity: scientific containers for mobility of compute</article-title>. <source>PLoS ONE</source><year>2017</year>;<volume>12</volume>:<fpage>e0177459</fpage>.<pub-id pub-id-type="pmid">28494014</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nasser</surname><given-names>J</given-names></string-name>, <string-name><surname>Bergman</surname><given-names>DT</given-names></string-name>, <string-name><surname>Fulco</surname><given-names>CP</given-names></string-name></person-group><etal>et al</etal><article-title>Genome-wide enhancer maps link risk variants to disease genes</article-title>. <source>Nature</source><year>2021</year>;<volume>593</volume>:<fpage>238</fpage>–<lpage>43</lpage>.<pub-id pub-id-type="pmid">33828297</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schaid</surname><given-names>DJ</given-names></string-name>, <string-name><surname>Chen</surname><given-names>W</given-names></string-name>, <string-name><surname>Larson</surname><given-names>NB.</given-names></string-name></person-group><article-title>From genome-wide associations to candidate causal variants by statistical fine-mapping</article-title>. <source>Nat Rev Genet</source><year>2018</year>;<volume>19</volume>:<fpage>491</fpage>–<lpage>504</lpage>.<pub-id pub-id-type="pmid">29844615</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Van Der Harst</surname><given-names>P</given-names></string-name>, <string-name><surname>Verweij</surname><given-names>N.</given-names></string-name></person-group><article-title>Identification of 64 novel genetic loci provides an expanded view on the genetic architecture of coronary artery disease</article-title>. <source>Circ Res</source><year>2018</year>;<volume>122</volume>:<fpage>433</fpage>–<lpage>43</lpage>.<pub-id pub-id-type="pmid">29212778</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>G</given-names></string-name>, <string-name><surname>Sarkar</surname><given-names>A</given-names></string-name>, <string-name><surname>Carbonetto</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>A simple new approach to variable selection in regression, with application to genetic fine mapping</article-title>. <source>J R Stat Soc Series B Stat Methodol</source><year>2020</year>;<volume>82</volume>:<fpage>1273</fpage>–<lpage>300</lpage>.<pub-id pub-id-type="pmid">37220626</pub-id></mixed-citation>
    </ref>
    <ref id="vbad188-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>Z</given-names></string-name>, <string-name><surname>Wang</surname><given-names>C</given-names></string-name>, <string-name><surname>Liu</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Carma is a new Bayesian model for fine-mapping in genome-wide association meta-analyses</article-title>. <source>Nat Genet</source><year>2023</year>;<volume>55</volume>:<fpage>1057</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">37169873</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
