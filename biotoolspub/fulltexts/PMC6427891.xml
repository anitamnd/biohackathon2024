<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Source Code Biol Med</journal-id>
    <journal-id journal-id-type="iso-abbrev">Source Code Biol Med</journal-id>
    <journal-title-group>
      <journal-title>Source Code for Biology and Medicine</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1751-0473</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6427891</article-id>
    <article-id pub-id-type="publisher-id">72</article-id>
    <article-id pub-id-type="doi">10.1186/s13029-019-0072-6</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>IPCAPS: an R package for iterative pruning to capture population structure</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8123-3409</contrib-id>
        <name>
          <surname>Chaichoompu</surname>
          <given-names>Kridsadakorn</given-names>
        </name>
        <address>
          <email>kridsadakorn@biostatgen.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Abegaz</surname>
          <given-names>Fentaw</given-names>
        </name>
        <address>
          <email>y.fabegaz@uliege.be</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tongsima</surname>
          <given-names>Sissades</given-names>
        </name>
        <address>
          <email>sissades@biotec.or.th</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shaw</surname>
          <given-names>Philip James</given-names>
        </name>
        <address>
          <email>philip@biotec.or.th</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sakuntabhai</surname>
          <given-names>Anavaj</given-names>
        </name>
        <address>
          <email>anavaj.sakuntabhai@pasteur.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pereira</surname>
          <given-names>Luísa</given-names>
        </name>
        <address>
          <email>lpereira@ipatimup.pt</email>
        </address>
        <xref ref-type="aff" rid="Aff6">6</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Van Steen</surname>
          <given-names>Kristel</given-names>
        </name>
        <address>
          <email>kristel.vansteen@uliege.be</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff8">8</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0805 7253</institution-id><institution-id institution-id-type="GRID">grid.4861.b</institution-id><institution>GIGA-R Medical Genomics - BIO3, </institution><institution>University of Liege, </institution></institution-wrap>Avenue de l’Hôpital 11, 4000 Liege, Belgium </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.419250.b</institution-id><institution>Genome Technology Research Unit, </institution><institution>National Center for Genetic Engineering and Biotechnology, </institution></institution-wrap>113 Thailand Science Park, Phahonyothin Road, Khlong Neung, Khlong Luang, Pathum Thani 12120 Thailand </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.419250.b</institution-id><institution>Medical Molecular Biology Research Unit, </institution><institution>National Center for Genetic Engineering and Biotechnology, </institution></institution-wrap>113 Thailand Science Park, Phahonyothin Road, Khlong Neung, Khlong Luang, Pathum Thani 12120 Thailand </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2353 6535</institution-id><institution-id institution-id-type="GRID">grid.428999.7</institution-id><institution>Functional Genetics of Infectious Diseases Unit, </institution><institution>Institut Pasteur, </institution></institution-wrap>25-28, rue du Docteur Roux, 75015 Paris, France </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2112 9282</institution-id><institution-id institution-id-type="GRID">grid.4444.0</institution-id><institution>Centre National de la Recherche Scientifique, URA3012, </institution></institution-wrap>Paris, France </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 1503 7226</institution-id><institution-id institution-id-type="GRID">grid.5808.5</institution-id><institution>Instituto de Investigação e Inovação em Saúde, </institution><institution>Universidade do Porto, </institution></institution-wrap>Rua Alfredo Allen, 208, 4200-135 Porto, Portugal </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 1503 7226</institution-id><institution-id institution-id-type="GRID">grid.5808.5</institution-id><institution>Instituto de Patologia e Imunologia Molecular da Universidade do Porto, </institution></institution-wrap>Rua Júlio Amaral de Carvalho, 45, 4200-135 Porto, Portugal </aff>
      <aff id="Aff8"><label>8</label>WELBIO (Walloon Excellence in Lifesciences and Biotechnology), Avenue Pasteur 6, 1300 Wavre, Belgium </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>3</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>3</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>14</volume>
    <elocation-id>2</elocation-id>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>7</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>2</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Resolving population genetic structure is challenging, especially when dealing with closely related or geographically confined populations. Although Principal Component Analysis (PCA)-based methods and genomic variation with single nucleotide polymorphisms (SNPs) are widely used to describe shared genetic ancestry, improvements can be made especially when fine-scale population structure is the target.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">This work presents an R package called IPCAPS, which uses SNP information for resolving possibly fine-scale population structure. The IPCAPS routines are built on the iterative pruning Principal Component Analysis (ipPCA) framework that systematically assigns individuals to genetically similar subgroups. In each iteration, our tool is able to detect and eliminate outliers, hereby avoiding severe misclassification errors.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">IPCAPS supports different measurement scales for variables used to identify substructure. Hence, panels of gene expression and methylation data can be accommodated as well. The tool can also be applied in patient sub-phenotyping contexts. IPCAPS is developed in R and is freely available from <ext-link ext-link-type="uri" xlink:href="http://bio3.giga.ulg.ac.be/ipcaps">http://bio3.giga.ulg.ac.be/ipcaps</ext-link></p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Fine-scale structure</kwd>
      <kwd>Iterative pruning</kwd>
      <kwd>Population clustering</kwd>
      <kwd>Population genetics</kwd>
      <kwd>Outlier detection</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002661</institution-id>
            <institution>Fonds De La Recherche Scientifique - FNRS</institution>
          </institution-wrap>
        </funding-source>
        <award-id>FNRS PDR T.0180.13</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Walloon Excellence in Lifesciences and Biotechnology</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001665</institution-id>
            <institution>Agence Nationale de la Recherche</institution>
          </institution-wrap>
        </funding-source>
        <award-id>ANR GWIS-AM, ANR-11-BSV1-0027</award-id>
        <principal-award-recipient>
          <name>
            <surname>Sakuntabhai</surname>
            <given-names>Anavaj</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004192</institution-id>
            <institution>National Science and Technology Development Agency</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par10">Single Nucleotide Polymorphisms (SNPs) can be used to identify population substructure, but resolving complex substructures remains challenging [<xref ref-type="bibr" rid="CR1">1</xref>]. Owing to the relatively low information load carried by single SNPs, usually thousands of them are needed to generate sufficient power for effective resolution of population strata due to shared genetic ancestry [<xref ref-type="bibr" rid="CR2">2</xref>]. Moreover, in practice with high-density genome-wide SNP datasets, linkage disequilibrium (LD) and haplotype patterns are likely to exist, which can be exploited for the inference of population structure [<xref ref-type="bibr" rid="CR3">3</xref>]. On the one hand, exploiting haplotype patterns is potentially informative, but comes with a high computational burden. On the other hand, although removing LD by pruning strategies can eliminate some spurious substructure patterns, it may limit our ability to identify subtle subgroupings.</p>
    <p id="Par11">The identification of substructure in a genome-wide association study sample of healthy controls or patients is a clustering problem. Conventional population structure analyses use Bayesian statistics to show relationships amongst individuals in terms of their so-called admixture profiles, where individuals can be clustered by using ratios of ancestral components, see also [<xref ref-type="bibr" rid="CR4">4</xref>]. The iterative pruning Principal Component Analysis (ipPCA) approach differs from this paradigm as it assigns individuals to subpopulations without making assumptions of population ancestry [<xref ref-type="bibr" rid="CR5">5</xref>]. At the heart of ipPCA lies performing PCA with genotype data, similar to EIGENSTRAT [<xref ref-type="bibr" rid="CR2">2</xref>]. If substructure exists in a principal component (PC) space (ascertained using, for instance, Tracy-Widom statistics [<xref ref-type="bibr" rid="CR5">5</xref>], or the EigenDev heuristic [<xref ref-type="bibr" rid="CR6">6</xref>]), individuals are assigned into one of two clusters using a 2-means algorithm for which cluster centers are initialized with a fuzzy c-means algorithm. The test for substructure and clustering is performed iteratively on nested datasets until no further substructure is detected, i.e. until a stopping criterion based on fixation index (F<sub>ST</sub>) is satisfied. F<sub>ST</sub> is commonly used to measure genetic distance between populations. The software developed to perform ipPCA has some shortcomings though. Notably, it is limited to a MATLAB environment, which is not freely available. Also, outliers can severely disturb the clustering analysis. These limitations are addressed in IPCAPS [<xref ref-type="bibr" rid="CR7">7</xref>], which improves the power of fine-scale population structure, while appropriately identifying and handling outliers.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par12">The R package IPCAPS provides one synthetic dataset and seven functions:<list list-type="order"><list-item><p id="Par13">simSNP: a synthetic dataset containing SNPs and population labels.</p></list-item><list-item><p id="Par14">ipcaps: a function for unsupervised clustering to capture population structure based on iterative pruning.</p></list-item><list-item><p id="Par15">rubikClust: a function for unsupervised clustering to detect rough structures and outliers.</p></list-item><list-item><p id="Par16">cal. PC.linear: a function for linear PCA.</p></list-item><list-item><p id="Par17">fst.hudson: a function for average F<sub>ST</sub> calculation between two groups.</p></list-item><list-item><p id="Par18">fst.each.snp.hudson: a function for F<sub>ST</sub> calculation for all SNPs between two groups.</p></list-item><list-item><p id="Par19">plot.3views: a function to create scatter plots in three views.</p></list-item><list-item><p id="Par20">top.discriminator: a function to detect top discriminators between two groups.</p></list-item></list></p>
    <p id="Par21">See the IPCAPS reference manual for details of the functions, arguments, default settings, and optional user-defined parameters.</p>
    <p id="Par22">The IPCAPS package implements unsupervised strategies that facilitate the detection of fine-scale structure in samples, extracted from informative genetic markers. For general populations, information regarding substructure may come directly from SNPs. For patient samples, general population structure should first be removed via regressing out ancestry informative markers prior to clustering. The latter is incorporated in IPCAPS. Currently, IPCAPS accepts three data input formats: text, PLINK binary (bed, bim, fam), and RData (more details in Table <xref rid="Tab1" ref-type="table">1</xref>). In the sequel, we will assume the availability of a sufficiently large SNP panel that is called on a collection of population samples.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Input formats supported by the function ipcaps</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Input formats</th><th>Descriptions</th></tr></thead><tbody><tr><td>PLINK binary format</td><td>PLINK binary format consist of 3 files; bed, bim, and fam. To generate these files from PLINK, use option --make-bed</td></tr><tr><td>Text format</td><td>The functions ipcaps supports SNPs in additive coding (0 = AA, 1 = AB, 2 = BB). Each row represents SNP, and each column represents individual. SNPs need to be separated by a space or a Tab. A big text file should be divided into smaller files to load faster. To input several files, set the option as, for example, files = c(‘input1.txt’,‘input2.txt’,‘input3.txt’)</td></tr><tr><td>RData format</td><td>In the case of re-analysis, it is convenient to rerun the function ipcaps using the file <italic>rawdata</italic>. RData is generated by the function ipcaps itself. This file contains a vector of labels and a matrix of SNPs containing N rows of individuals and M columns of SNPs.</td></tr></tbody></table></table-wrap></p>
    <p id="Par23">Prior to clustering with IPCAPS, adequate data quality control (QC) steps need to be taken. These are not supported by IPCAPS itself but can easily be performed in PLINK (1.9) [<xref ref-type="bibr" rid="CR8">8</xref>]. Suggested PLINK parameters include: restrict to founders (--filter-founders), select chromosome 1–22 (--not-chr 0,x,y,xy,mt), perform LD pruning (--indep-pairwise 50 5 0.2), test for Hardy–Weinberg equilibrium (--hwe 0.001), use call rate at least 95% (--mind 0.05), filter out missing SNP above 2% (--geno 0.02), and remove low minimum allele frequency (--maf 0.05). The remaining missing genotype values are SNP-wise imputed by medians.</p>
    <p id="Par24">Rather than performing two-means clustering in PCA-space, at each iteration, IPCAPS clustering potentially involves the consecutive application of 2 clustering modules. The first, which we call rubikClust, is applied in the 3-dimensional space determined by the first three principal components (axes) at an iteration step. It involves applying rotations in 3D by consecutively performing rotations around PC1, PC2, PC3, and may provide more than 2 clusters. Notably, this approach also allows for rapid identification of outliers. When samples cannot be divided into 2 groups in this way, the existing R function mixmod (package Rmixmod) is used for latent subgroup detection. In particular, earlier computed PCs (untransformed) at a particular iteration are subjected to multivariate Gaussian mixture modeling and Clustering EM (CEM) estimation [<xref ref-type="bibr" rid="CR9">9</xref>], allowing for up to three clusters at each iteration. The iterative loop of IPCAPS can be terminated automatically by calling one of three possible stopping criteria: the number of subgroups is lower than a minimum, the fixation index (F<sub>ST</sub>) is lower than a threshold, and EigenFit is lower than a pre-specified cutoff. The EigenFit criterion is defined by the differences between the logarithms of consecutive eigenvalues, sorted from high to low.</p>
    <p id="Par25">All IPCAPS results are saved in a single directory including textual information about cluster allocations, and visual information such as PC plots and hierarchical trees of group membership. Due to memory restrictions in R, large datasets (i.e., a large number of subjects) may need to be split into multiple files and loaded into computer memory via the IPCAPS option <italic>files</italic>, which they are internally merged again for iterative PCA. Extra attention is paid on efficient PC calculation [<xref ref-type="bibr" rid="CR10">10</xref>], also relying on the R package rARPACK.</p>
    <p id="Par26">The analysis procedure using IPCAPS proceeds as follows: Firstly, genotype data are loaded and are analyzed automatically by the function ipcaps. Secondly, cluster membership is returned once clustering process is done. Clusters containing few members are counted as outlying individuals. Lastly, top discriminators between clusters are identified.</p>
    <p id="Par27">Usage example:<list list-type="bullet"><list-item><p id="Par28"># 1) perform clustering (see Availability of data and materials). Note that input files must to be in the working directory.<list list-type="bullet"><list-item><p id="Par29">bed.file &lt;− “simSNP.bed” #the bim file and the fam file are required</p></list-item><list-item><p id="Par30">sample.info &lt;− “simSNP_individuals.txt”</p></list-item><list-item><p id="Par31">column.number = 2</p></list-item><list-item><p id="Par32">output.path &lt;− “result”</p></list-item><list-item><p id="Par33">clusters &lt;− ipcaps (bed = bed.file, label.file=sample.info, lab.col. = column.number, out = output.path)</p></list-item></list></p></list-item><list-item><p id="Par34"># 2) Check clustering result.<list list-type="bullet"><list-item><p id="Par35">print (clusters$cluster$group)</p></list-item><list-item><p id="Par36">table (clusters$cluster$label, clusters$cluster$group)</p></list-item></list></p></list-item><list-item><p id="Par37"># 3) Identify top discriminators between groups, for example, group 4 and group 5.<list list-type="bullet"><list-item><p id="Par38">bim.file &lt;− “simSNP.bim”</p></list-item><list-item><p id="Par39">top.snp &lt; −top.discriminator (clusters,4,5,bim.file)</p></list-item><list-item><p id="Par40">head (top.snp)</p></list-item></list></p></list-item></list></p>
  </sec>
  <sec id="Sec3">
    <title>Results</title>
    <p id="Par41">We simulated genotype data for 10,000 independent SNPs and 760 individuals belonging to one of three populations (250 individuals each) and 10 outliers (see Availability of data and materials). The pairwise genetic distance between populations was set to F<sub>ST</sub> = 0.005 [<xref ref-type="bibr" rid="CR11">11</xref>]. Ten outlying individuals were generated by replacing the 1st and the 2nd eigenvectors by extreme values, and then the SNP matrix was reconstructed using the singular value decomposition formula [<xref ref-type="bibr" rid="CR12">12</xref>]. Two-dimensional PC plots of the first 3 PCs only reveals a separation between populations (with overlap) for PC2 versus PC3 (Fig. <xref rid="Fig1" ref-type="fig">1</xref>-a). However, the application of IPCAPS on the simulated data and thus flexible use of PC information and clustering stopping rules as described before could clearly identify sample substructure (Fig. <xref rid="Fig1" ref-type="fig">1</xref>-b). Non-outlying individuals were correctly assigned to their respective subgroups. In a real-life data application, we considered four populations of HapMap (CEU, YRI, CHB, and JPT) [<xref ref-type="bibr" rid="CR13">13</xref>]. These populations have been considered before in the evaluation of non-linear PCA to detect fine substructure [<xref ref-type="bibr" rid="CR14">14</xref>]. After data QC as described before, 132,873 SNPs and 395 individuals remained (see Availability of data and materials). Using classic PCA, visualizing data into two-dimensional space based on the first two PCs is not enough to fully describe substructures. Whereas non-linear PCA is able to provide a hierarchical visualization with only the first 2 PCs, as claimed by the authors [<xref ref-type="bibr" rid="CR14">14</xref>], including PC3 clearly improves the detection of substructure of four strata, but the authors do not give recommendations on how to select the optimal number of non-linear PCs (Fig. <xref rid="Fig1" ref-type="fig">1</xref>-c). The iterative approach adopted in IPCAPS can distinguish populations for which the internal substructure becomes increasingly finer: CEU, YRI, CHB, and JPT populations are well separated by IPCAPS, which also separates the genetically rather similar population CHB and JPT, with only one misclassified subject. In addition, we obtained 560 unique SNPs after combining the top discriminators among four main groups, while outliers were ignored (Fig. <xref rid="Fig1" ref-type="fig">1</xref>-d).<fig id="Fig1"><label>Fig. 1</label><caption><p>The output from IPCAPs. <bold>a</bold> PC plot of iteration 1 for synthetic data (<bold>b</bold>) a typical tree output and a summary table for synthetic data (<bold>c</bold>) PC plot of iteration 1 for the HapMap data (<bold>d</bold>) a typical tree output and a summary table for the HapMap data. For (<bold>b</bold>) and (<bold>d</bold>), the intermediate results are in blue, and the final clusters are in red</p></caption><graphic xlink:href="13029_2019_72_Fig1_HTML" id="MO1"/></fig></p>
  </sec>
  <sec id="Sec4">
    <title>Conclusions</title>
    <p id="Par42">Fine-scale resolution of population substructure can be captured using independent SNPs once all redundancies are filtered out. In this work, we have introduced a flexible and efficient R package to accomplish an unsupervised clustering without prior knowledge, in the search for strata of individuals with similar genetic profiles. The tool performs well in fine-scale and broad-scale resolution settings. The IPCAPS routines allow a relatively easy extension to input data derived from transcriptome or epigenome experiments.</p>
  </sec>
  <sec id="Sec5">
    <title>Availability and requirements</title>
    <p id="Par43">Project name: IPCAPS</p>
    <p id="Par44">Project home page: <ext-link ext-link-type="uri" xlink:href="http://bio3.giga.ulg.ac.be/ipcaps">http://bio3.giga.ulg.ac.be/ipcaps</ext-link></p>
    <p id="Par45">Operating system: Platform independent</p>
    <p id="Par46">Programming language: R version &gt; = 3.0.0</p>
    <p id="Par47">Other requirements: Dependency R packages; RMatrix, expm, fpc, Rmixmod, LPCM, apcluster, rARPACK, igraph</p>
    <p id="Par48">License: GPLv3</p>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>F<sub>ST</sub></term>
        <def>
          <p id="Par4">Fixation index</p>
        </def>
      </def-item>
      <def-item>
        <term>LD</term>
        <def>
          <p id="Par5">Linkage disequilibrium</p>
        </def>
      </def-item>
      <def-item>
        <term>PC</term>
        <def>
          <p id="Par6">Principal component</p>
        </def>
      </def-item>
      <def-item>
        <term>PCA</term>
        <def>
          <p id="Par7">Principal component analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>QC</term>
        <def>
          <p id="Par8">Quality control</p>
        </def>
      </def-item>
      <def-item>
        <term>SNP</term>
        <def>
          <p id="Par9">Single nucleotide polymorphisms</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank Pongsakorn Wangkumhang, and Alisa Wilantho for helpful discussions. We also thank Chumpol Ngamphiw, Raphaël Philippart, and Alain Empain for critical help on computing clusters.</p>
    <sec id="FPar1">
      <title>Funding</title>
      <p id="Par49">This work was supported by the Fonds de la Recherche Scientifique (FNRS PDR T.0180.13) [KC, KVS]; the Walloon Excellence in Lifesciences and Biotechnology (WELBIO) [FAY, KVS]; the French National Research Agency (ANR GWIS-AM, ANR-11-BSV1–0027) [AS], and the National Science and Technology Development Agency (NSTDA) Chair grant [ST].</p>
    </sec>
    <sec id="FPar2" sec-type="data-availability">
      <title>Availability of data and materials</title>
      <p id="Par50">The datasets generated during and/or analysed during the current study are available in the BIO3’s website, <ext-link ext-link-type="uri" xlink:href="http://bio3.giga.ulg.ac.be/ipcaps">http://bio3.giga.ulg.ac.be/ipcaps</ext-link></p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>KC and KVS conceived the methodology. KC designed the software and implemented the R code for the software. FAY, ST and PJS suggested additional features. All authors contributed to write the paper, read, and approved the final manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="FPar4">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="FPar5">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="FPar6">
      <title>Publisher’s Note</title>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Neuditschko</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Khatkar</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Raadsma</surname>
            <given-names>HW</given-names>
          </name>
        </person-group>
        <article-title>NetView: a high-definition network-visualization approach to detect fine-scale population structures from genome-wide patterns of variation</article-title>
        <source>PLoS One</source>
        <year>2012</year>
        <volume>7</volume>
        <fpage>e48375</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0048375</pub-id>
        <pub-id pub-id-type="pmid">23152744</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Patterson</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Plenge</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Weinblatt</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Shadick</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Reich</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Principal components analysis corrects for stratification in genome-wide association studies</article-title>
        <source>Nat Genet</source>
        <year>2006</year>
        <volume>38</volume>
        <fpage>904</fpage>
        <lpage>909</lpage>
        <pub-id pub-id-type="doi">10.1038/ng1847</pub-id>
        <pub-id pub-id-type="pmid">16862161</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lawson</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Hellenthal</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Falush</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Inference of population structure using dense haplotype data</article-title>
        <source>PLoS Genet</source>
        <year>2012</year>
        <volume>8</volume>
        <fpage>e1002453</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1002453</pub-id>
        <pub-id pub-id-type="pmid">22291602</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Corander</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Marttinen</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sirén</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Enhanced Bayesian modelling in BAPS software for learning genetic structures of populations</article-title>
        <source>BMC Bioinformatics.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>539</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-539</pub-id>
        <pub-id pub-id-type="pmid">19087322</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Intarapanich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shaw</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Assawamakin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wangkumhang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ngamphiw</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chaichoompu</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Iterative pruning PCA improves resolution of highly structured populations</article-title>
        <source>BMC Bioinformatics.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>382</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-10-382</pub-id>
        <pub-id pub-id-type="pmid">19930644</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Limpiti</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Intarapanich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Assawamakin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shaw</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Wangkumhang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Piriyapongsa</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Study of large and highly stratified population datasets by combining iterative pruning principal component analysis and structure</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>255</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-255</pub-id>
        <pub-id pub-id-type="pmid">21699684</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Chaichoompu K, Abegaz F, Tongsima S, Shaw PJ, Sakuntabhai A, Cavadas B, et al. A methodology for unsupervised clustering using iterative pruning to capture fine-scale structure. bioRxiv. 2017;234989.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Chang CC, Chow CC, Tellier LC, Vattikuti S, Purcell SM, Lee JJ. Second-generation PLINK: rising to the challenge of larger and richer datasets. GigaScience. 2015;4.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Lebret R, Iovleff S, Langrognet F, Biernacki C, Celeux G, Govaert G. Rmixmod: TheRPackage of the model-based unsupervised, supervised, and semi-supervised ClassificationMixmodLibrary. J Stat Softw. 2015;67.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Clayton D. snpStats: SnpMatrix and XSnpMatrix classes and methods. R package version 1.32.0. 2018. Available from: 10.18129/B9.bioc.snpStats.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Balding</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Nichols</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>A method for quantifying differentiation between populations at multi-allelic loci and its implications for investigating identity and paternity</article-title>
        <source>Genetica.</source>
        <year>1995</year>
        <volume>96</volume>
        <fpage>3</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01441146</pub-id>
        <pub-id pub-id-type="pmid">7607457</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Arendt</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Robust methods for population stratification in genome wide association studies</article-title>
        <source>BMC Bioinformatics.</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>132</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-132</pub-id>
        <pub-id pub-id-type="pmid">23601181</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gibbs</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Belmont</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Hardenbol</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Willis</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The international HapMap project</article-title>
        <source>Nature.</source>
        <year>2003</year>
        <volume>426</volume>
        <fpage>789</fpage>
        <lpage>796</lpage>
        <pub-id pub-id-type="doi">10.1038/nature02168</pub-id>
        <pub-id pub-id-type="pmid">14685227</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alanis-Lobato</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Cannistraci</surname>
            <given-names>CV</given-names>
          </name>
          <name>
            <surname>Eriksson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Manica</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ravasi</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Highlighting nonlinear patterns in population genetics datasets</article-title>
        <source>Sci Rep</source>
        <year>2015</year>
        <volume>5</volume>
        <fpage>8140</fpage>
        <pub-id pub-id-type="doi">10.1038/srep08140</pub-id>
        <pub-id pub-id-type="pmid">25633916</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
