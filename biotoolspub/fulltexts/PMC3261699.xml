<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NPG//DTD XML Article//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName NPG_XML_Article.dtd?>
<?SourceDTD.Version 2.7.10?>
<?ConverterInfo.XSLTName nature2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Mol Syst Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Mol Syst Biol</journal-id>
    <journal-title-group>
      <journal-title>Molecular Systems Biology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1744-4292</issn>
    <publisher>
      <publisher-name>European Molecular Biology Organization</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3261699</article-id>
    <article-id pub-id-type="pii">msb201175</article-id>
    <article-id pub-id-type="doi">10.1038/msb.2011.75</article-id>
    <article-id pub-id-type="pmid">21988835</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Report</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Fast, scalable generation of high-quality protein multiple sequence alignments using Clustal Omega</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Sievers</surname>
          <given-names>Fabian</given-names>
        </name>
        <xref ref-type="aff" rid="a1">1</xref>
        <xref ref-type="author-notes" rid="n1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wilm</surname>
          <given-names>Andreas</given-names>
        </name>
        <xref ref-type="aff" rid="a2">2</xref>
        <xref ref-type="author-notes" rid="n1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dineen</surname>
          <given-names>David</given-names>
        </name>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gibson</surname>
          <given-names>Toby J</given-names>
        </name>
        <xref ref-type="aff" rid="a3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Karplus</surname>
          <given-names>Kevin</given-names>
        </name>
        <xref ref-type="aff" rid="a4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Weizhong</given-names>
        </name>
        <xref ref-type="aff" rid="a5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lopez</surname>
          <given-names>Rodrigo</given-names>
        </name>
        <xref ref-type="aff" rid="a5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>McWilliam</surname>
          <given-names>Hamish</given-names>
        </name>
        <xref ref-type="aff" rid="a5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Remmert</surname>
          <given-names>Michael</given-names>
        </name>
        <xref ref-type="aff" rid="a6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Söding</surname>
          <given-names>Johannes</given-names>
        </name>
        <xref ref-type="aff" rid="a6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Thompson</surname>
          <given-names>Julie D</given-names>
        </name>
        <xref ref-type="aff" rid="a7">7</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Higgins</surname>
          <given-names>Desmond G</given-names>
        </name>
        <xref ref-type="corresp" rid="c1">a</xref>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <aff id="a1"><label>1</label><institution>School of Medicine and Medical Science, UCD Conway Institute of Biomolecular and Biomedical Research, University College Dublin</institution>, Dublin, <country>Ireland</country></aff>
      <aff id="a2"><label>2</label><institution>Computational and Systems Biology, Genome Institute of Singapore</institution>, <country>Singapore</country></aff>
      <aff id="a3"><label>3</label><institution>Structural and Computational Biology Unit, European Molecular Biology Laboratory</institution>, Heidelberg, <country>Germany</country></aff>
      <aff id="a4"><label>4</label><institution>Department of Biomolecular Engineering, University of California</institution>, Santa Cruz, CA, <country>USA</country></aff>
      <aff id="a5"><label>5</label><institution>EMBL Outstation—European Bioinformatics Institute, Wellcome Trust Genome Campus</institution>, Hinxton, Cambridge, <country>UK</country></aff>
      <aff id="a6"><label>6</label><institution>Gene Center Munich, University of Munich (LMU)</institution>, Muenchen, <country>Germany</country></aff>
      <aff id="a7"><label>7</label><institution>Département de Biologie Structurale et Génomique, IGBMC (Institut de Génétique et de Biologie Moléculaire et Cellulaire), CNRS/INSERM/Université de Strasbourg</institution>, Illkirch, <country>France</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="c1"><label>a</label>UCD Conway Institute of Biomolecular and Biomedical Research, University College Dublin, Belfield, Dublin 4, Ireland. Tel.: +353 1 716 6833; Fax: +353 1 716 6713; <email>des.higgins@ucd.ie</email></corresp>
      <fn id="n1">
        <label>*</label>
        <p>These authors contributed equally to this work</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>10</month>
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>10</month>
      <year>2011</year>
    </pub-date>
    <volume>7</volume>
    <fpage>539</fpage>
    <lpage>539</lpage>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>07</month>
        <year>2011</year>
      </date>
      <date date-type="accepted">
        <day>06</day>
        <month>09</month>
        <year>2011</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2011, EMBO and Macmillan Publishers Limited</copyright-statement>
      <copyright-year>2011</copyright-year>
      <copyright-holder>EMBO and Macmillan Publishers Limited</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbyncsalicense">https://creativecommons.org/licenses/by-nc-sa/3.0/</ali:license_ref>
        <!--author-paid-->
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution Noncommercial Share Alike 3.0 Unported License, which allows readers to alter, transform, or build upon the article and then distribute the resulting work under the same or similar license to this one. The work must be attributed back to the original author and commercial use is not permitted without specific permission.</license-p>
      </license>
    </permissions>
    <!--Hidden abstract:
			 Fast, scalable generation of high-quality protein multiple sequence alignments using Clustal OmegaMultiple sequence alignments are fundamental to many sequence analysis methods. The new program Clustal Omega can align virtually any number of protein sequences quickly and has powerful features for adding sequences to existing precomputed alignments.-->
    <abstract>
      <p>Multiple sequence alignments are fundamental to many sequence analysis methods. Most alignments are computed using the progressive alignment heuristic. These methods are starting to become a bottleneck in some analysis pipelines when faced with data sets of the size of many thousands of sequences. Some methods allow computation of larger data sets while sacrificing quality, and others produce high-quality alignments, but scale badly with the number of sequences. In this paper, we describe a new program called Clustal Omega, which can align virtually any number of protein sequences quickly and that delivers accurate alignments. The accuracy of the package on smaller test cases is similar to that of the high-quality aligners. On larger data sets, Clustal Omega outperforms other packages in terms of execution time and quality. Clustal Omega also has powerful features for adding sequences to and exploiting information in existing alignments, making use of the vast amount of precomputed information in public databases like Pfam.</p>
    </abstract>
    <kwd-group>
      <kwd>bioinformatics</kwd>
      <kwd>hidden Markov models</kwd>
      <kwd>multiple sequence alignment</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec disp-level="1">
    <title>Introduction</title>
    <p>Multiple sequence alignments (MSAs) are essential in most bioinformatics analyses that involve comparing homologous sequences. The exact way of computing an optimal alignment between <italic>N</italic> sequences has a computational complexity of O(<italic>L</italic><sup><italic>N</italic></sup>) for <italic>N</italic> sequences of length <italic>L</italic> making it prohibitive for even small numbers of sequences. Most automatic methods are based on the ‘progressive alignment’ heuristic (<xref ref-type="bibr" rid="b12">Hogeweg and Hesper, 1984</xref>), which aligns sequences in larger and larger subalignments, following the branching order in a ‘guide tree.’ With a complexity of roughly O(<italic>N</italic><sup>2</sup>), this approach can routinely make alignments of a few thousand sequences of moderate length, but it is tough to make alignments much bigger than this. The progressive approach is a ‘greedy algorithm’ where mistakes made at the initial alignment stages cannot be corrected later. To counteract this effect, the consistency principle was developed (<xref ref-type="bibr" rid="b21">Notredame et al, 2000</xref>). This has allowed the production of a new generation of more accurate aligners (e.g. T-Coffee (<xref ref-type="bibr" rid="b21">Notredame et al, 2000</xref>)) but at the expense of ease of computation. These methods give 5–10% more accurate alignments, as measured on benchmarks, but are confined to a few hundred sequences.</p>
    <p>In this report, we introduce a new program called Clustal Omega, which is accurate but also allows alignments of almost any size to be produced. We have used it to generate alignments of over 190 000 sequences on a single processor in a few hours. In benchmark tests, it is distinctly more accurate than most widely used, fast methods and comparable in accuracy to some of the intensive slow methods. It also has powerful features for allowing users to reuse their alignments so as to avoid recomputing an entire alignment, every time new sequences become available.</p>
    <p>The key to making the progressive alignment approach scale is the method used to make the guide tree. Normally, this involves aligning all <italic>N</italic> sequences to each other giving time and memory requirements of O(<italic>N</italic><sup>2</sup>). Protein families with &gt;50 000 sequences are appearing and will become common from various wide scale genome sequencing projects. Currently, the only method that can routinely make alignments of more than about 10 000 sequences is MAFFT/PartTree (<xref ref-type="bibr" rid="b14">Katoh and Toh, 2007</xref>). It is very fast but leads to a loss in accuracy, which has to be compensated for by iteration and other heuristics. With Clustal Omega, we use a modified version of mBed (<xref ref-type="bibr" rid="b3">Blackshields et al, 2010</xref>), which has complexity of O(<italic>N</italic> log <italic>N</italic>), and which produces guide trees that are just as accurate as those from conventional methods. mBed works by ‘emBedding’ each sequence in a space of <italic>n</italic> dimensions where <italic>n</italic> is proportional to log <italic>N</italic>. Each sequence is then replaced by an <italic>n</italic> element vector, where each element is simply the distance to one of <italic>n</italic> ‘reference sequences.’ These vectors can then be clustered extremely quickly by standard methods such as K-means or UPGMA. In Clustal Omega, the alignments are then computed using the very accurate HHalign package (<xref ref-type="bibr" rid="b23">Söding, 2005</xref>), which aligns two profile hidden Markov models (<xref ref-type="bibr" rid="b7">Eddy, 1998</xref>).</p>
    <p>Clustal Omega has a number of features for adding sequences to existing alignments or for using existing alignments to help align new sequences. One innovation is to allow users to specify a profile HMM that is derived from an alignment of sequences that are homologous to the input set. The sequences are then aligned to these ‘external profiles’ to help align them to the rest of the input set. There are already widely available collections of HMMs from many sources such as Pfam (<xref ref-type="bibr" rid="b10">Finn et al, 2009</xref>) and these can now be used to help users to align their sequences.</p>
  </sec>
  <sec disp-level="1">
    <title>Results</title>
    <sec disp-level="2">
      <title>Alignment accuracy</title>
      <p>The standard method for measuring the accuracy of multiple alignment algorithms is to use benchmark test sets of reference alignments, generated with reference to three-dimensional structures. Here, we present results from a range of packages tested on three benchmarks: BAliBASE (<xref ref-type="bibr" rid="b24">Thompson et al, 2005</xref>), Prefab (<xref ref-type="bibr" rid="b8">Edgar, 2004</xref>) and an extended version of HomFam (<xref ref-type="bibr" rid="b3">Blackshields et al, 2010</xref>). For these tests, we just report results using the default settings for all programs but with two exceptions, which were needed to allow MUSCLE (<xref ref-type="bibr" rid="b8">Edgar, 2004</xref>) and MAFFT to align the biggest test cases in HomFam. For test cases with &gt;3000 sequences, we run MUSCLE with the –maxiter parameter set to 2, in order to finish the alignments in reasonable times. Second, we have run several different programs from the MAFFT package. MAFFT (<xref ref-type="bibr" rid="b13">Katoh et al, 2002</xref>) consists of a series of programs that can be run separately or called automatically from a script with the --<italic>auto</italic> flag set. This flag chooses to run a slow, consistency-based program (L-INS-i) when the number and lengths of sequences is small. When the numbers exceed inbuilt thresholds, a conventional progressive aligner is used (FFT-NS-2). The latter is also the program that is run by default if MAFFT is called with no flags set. For very large data sets, the <italic>--parttree</italic> flag must be set on the command line and a very fast guide tree calculation is then used.</p>
      <p>The results for the BAliBASE benchmark tests are shown in <xref ref-type="table" rid="t1">Table I</xref>. BAliBASE is divided into six ‘references.’ Average scores are given for each reference, along with total run times and average total column (TC) scores, which give the proportion of the total alignment columns that is recovered. A score of 1.0 indicates perfect agreement with the benchmark. There are two rows for the MAFFT package: MAFFT (auto) and MAFFT default. In most (203 out of 218) BAliBASE test cases, the number of sequences is small and the script runs L-INS-i, which is the slow accurate program that uses the consistency heuristic (<xref ref-type="bibr" rid="b21">Notredame et al, 2000</xref>) that is also used by MSAprobs (<xref ref-type="bibr" rid="b17">Liu et al, 2010</xref>), Probalign, Probcons (<xref ref-type="bibr" rid="b6">Do et al, 2005</xref>) and T-Coffee. These programs are all restricted to small numbers of sequences but tend to give accurate alignments. This is clearly reflected in the times and average scores in <xref ref-type="table" rid="t1">Table I</xref>. The times range from 25 min up to 22 h for these packages and the accuracies range from 55 to 61% of columns correct. Clustal Omega only takes 9 min for the same runs but has an accuracy level that is similar to that of Probcons and T-Coffee.</p>
      <p>The rest of the table is mainly taken by the programs that use progressive alignment. Some of these are very fast but this speed is matched by a considerable drop in accuracy compared with the consistency-based programs and Clustal Omega. The weakest program here, is Clustal W (<xref ref-type="bibr" rid="b15">Larkin et al, 2007</xref>) followed by PRANK (<xref ref-type="bibr" rid="b18">Löytynoja and Goldman, 2008</xref>). PRANK is not designed for aligning distantly related sequences but at giving good alignments for phylogenetic work with special attention to gaps. These gap positions are not included in these tests as they tend not to be structurally conserved. Dialign (<xref ref-type="bibr" rid="b20">Morgenstern et al, 1998</xref>) does not use consistency or progressive alignment but is based on finding best local multiple alignments. FSA (<xref ref-type="bibr" rid="b4">Bradley et al, 2009</xref>) uses sampling of pairwise alignments and ‘sequence annealing’ and has been shown to deliver good nucleotide sequence alignments in the past.</p>
      <p>The Prefab benchmark test results are shown in <xref ref-type="table" rid="t2">Table II</xref>. Here, the results are divided into five groups according to the percent identity of the sequences. The overall scores range from 53 to 73% of columns correct. The consistency-based programs MSAprobs, MAFFT L-INS-i, Probalign, Probcons and T-Coffee, are again the most accurate but with long run times. Clustal Omega is close to the consistency programs in accuracy but is much faster. There is then a gap to the faster progressive based programs of MUSCLE, MAFFT, Kalign (<xref ref-type="bibr" rid="b16">Lassmann and Sonnhammer, 2005</xref>) and Clustal W.</p>
      <p>Results from testing large alignments with up to 50 000 sequences are given in <xref ref-type="table" rid="t3">Table III</xref> using HomFam. Here, each alignment is made up of a core of a Homstrad (<xref ref-type="bibr" rid="b19">Mizuguchi et al, 1998</xref>) structure-based alignment of at least five sequences. These sequences are then inserted into a test set of sequences from the corresponding, homologous, Pfam domain. This gives very large sets of sequences to be aligned but the testing is only carried out on the sequences with known structures. Only some programs are able to deliver alignments at all, with data sets of this size. We restricted the comparisons to Clustal Omega, MAFFT, MUSCLE and Kalign. MAFFT with default settings, has a limit of 20 000 sequences and we only use MAFFT with --parttree for the last section of <xref ref-type="table" rid="t3">Table III</xref>. MUSCLE becomes increasingly slow when you get over 3000 sequences. Therefore, for &gt;3000 sequences we used MUSCLE with the faster but less accurate setting of –maxiters 2, which restricts the number of iterations to two.</p>
      <p>Overall, Clustal Omega is easily the most accurate program in <xref ref-type="table" rid="t3">Table III</xref>. The run times show MAFFT default and Kalign to be exceptionally fast on the smaller test cases and MAFFT --parttree to be very fast on the biggest families. Clustal Omega does scale well, however, with increasing numbers of sequences. This scaling is described in more detail in the <xref ref-type="supplementary-material" rid="S1">Supplementary Information</xref>. We do have two further test cases with &gt;50 000 sequences, but it was not possible to get results for these from MUSCLE or Kalign. These are described in the <xref ref-type="supplementary-material" rid="S1">Supplementary Information</xref> as well.</p>
      <p><xref ref-type="table" rid="t3">Table III</xref> gives overall run times for the four programs evaluated with HomFam. <xref ref-type="fig" rid="f1">Figure 1</xref> resolves these run times case by case. Kalign is very fast for small families but does not scale as well. Overall, MAFFT is faster than the other programs over all test case sizes but Clustal Omega scales similarly. Points in <xref ref-type="fig" rid="f1">Figure 1</xref> represent different families with different average sequence lengths and pairwise identities. Therefore, the scalability trend is fuzzy, with larger dots occurring generally above smaller dots. <xref ref-type="supplementary-material" rid="S1">Supplementary Figure S3</xref> shows scalability data, where subsets of increasing size are sampled from one large family only. This reduces variability in pairwise identity and sequence length.</p>
    </sec>
    <sec disp-level="2">
      <title>External profile alignment</title>
      <p>Clustal Omega can read extra information from a profile HMM derived from preexisting alignments. For example, if a user wishes to align a set of globin sequences and has an existing globin alignment, this alignment can be converted to a profile HMM and used as well as the sequence input file. This HMM is here referred to as an ‘external profile’ and its use in this way as ‘external profile alignment’ (EPA). During EPA, each sequence in the input set is aligned to the external profile. Pseudocount information from the external profile is then transferred, position by position, to the input sequence. Ideally, this would be used with large curated alignments of particular proteins or domains of interest such as are used in metagenomics projects. Rather than taking the input sequences and aligning them from scratch, every time new sequences are found, the alignment should be carefully maintained and used as an external profile for EPA. Clustal Omega also can align sequences to existing alignments using conventional alignment methods. Users can add sequences to an alignment, one by one or align a set of aligned sequences to the alignment.</p>
      <p>In this paper, we demonstrate the EPA approach with two examples. First, we take the 94 HomFam test cases from the previous section and use the corresponding Pfam HMM for EPA. Before EPA, the average accuracy for the test cases was 0.627 of correctly aligned Homstrad positions but after EPA it rises to 0.653. This is plotted, test case for test case in <xref ref-type="fig" rid="f2">Figure 2A</xref>. Each dot is one test case with the TC score for Clustal Omega plotted against the score using EPA. The second example is illustrated in <xref ref-type="fig" rid="f2">Figure 2B</xref>. Here, we take all the BAliBASE reference sets and align them as normal using Clustal Omega and obtain the benchmark result of 0.554 of columns correctly aligned, as already reported in <xref ref-type="table" rid="t1">Table I</xref>. For EPA, we use the benchmark reference alignments themselves as external profiles. The results now jump to 0.857 of columns correct. This is a jump of over 30% and while it is not a valid measure of Clustal Omega accuracy for comparison with other programs, it does illustrate the potential power of EPA to use information in external alignments.</p>
    </sec>
    <sec disp-level="2">
      <title>Iteration</title>
      <p>EPA can also be used in a simple iteration scheme. Once a MSA has been made from a set of input sequences, it can be converted into a HMM and used for EPA to help realign the input sequences. This can also be combined with a full recalculation of the guide tree. In <xref ref-type="fig" rid="f3">Figure 3</xref>, we show the results of one and two iterations on every test case from HomFam. The graph is plotted as a running average TC score for all test cases with <italic>N</italic> or fewer test cases where <italic>N</italic> is plotted on the horizontal axis using a log scale. With some smaller test cases, iteration actually has a detrimental effect. Once you get near 1000 or more sequences, however, a clear trend emerges. The more sequences you have, the more beneficial the effect of iteration is. With bigger test cases, it becomes more and more beneficial to apply two iterations. This result confirms the usefulness of EPA as a general strategy. It also confirms the difficulty in aligning extremely large numbers of sequences but gives one partial solution. It also gives a very simple but effective iteration scheme, not just for guide tree iteration, as used in many packages, but for iteration of the alignment itself.</p>
    </sec>
  </sec>
  <sec disp-level="1">
    <title>Discussion</title>
    <p>The main breakthroughs since the mid 1980s in MSA methods have been progressive alignment and the use of consistency. Otherwise, most recent work has concerned refinements for speed or accuracy on benchmark test sets. The speed increases have been dramatic but, with just two major exceptions, the methods are still basically O(<italic>N</italic><sup>2</sup>) and incapable of being extended to data sets of &gt;10 000 sequences. The two exceptions are mBed, used here, and MAFFT PartTree. PartTree is faster but at the expense of accuracy, at least as judged by the benchmarking here. The second group of recent developments have concerned accuracy. This has tended to focus on results from benchmarking, a potentially contentious issue (<xref ref-type="bibr" rid="b1">Aniba et al, 2010</xref>; <xref ref-type="bibr" rid="b9">Edgar, 2010</xref>). The benchmark test sets that we have are limited in scope and heavily biased toward single domain globular proteins. This has the potential to lead to methods that behave well on benchmarks but which are not so flexible or useful in real-world situations. One development to improve accuracy has been the recruitment of extra homologs to bulk up input data sets. This seems to work well with the consistency-based methods and for small data sets. It appears, however, that there is a limit to the extra accuracy that can be obtained this way, without further development. The extra sequences may also bring in noise and dramatically increase the complexity of the computational problem. This can be partly fixed by iteration but, EPA to a high-quality reference alignment might be a better solution. This also raises the need for methods to visualize such large alignments, in order to detect problems. A second major focus for development has been the use of external information such as RNA structure (<xref ref-type="bibr" rid="b25">Wilm et al, 2008</xref>) or protein structure predictions (<xref ref-type="bibr" rid="b22">Pirovano et al, 2008</xref>).</p>
    <p>EPA is a new approach that allows users to exploit information in their own or in publicly available alignments. It does not force new sequences to follow the older alignment exactly. The new sequences get aligned to each other using progressive alignment but the information in the external profile can help provide information as to which amino acids are most likely to occur at each position in a sequence. Most methods attempt to predict this from general models of protein evolution with secondary structure prediction as a refinement. In this paper, we have shown that even using the mass produced alignments from Pfam as external profiles provides a small increase in accuracy for a large general set of test cases. This opens up a new set of possibilities for users to make use of the information contained in large, publicly available alignments and creates an incentive for database providers to make very high-quality alignments available.</p>
    <p>One of the reasons for the great success of Clustal X was the very user-friendly graphical user interface (GUI). This, however, is not as critical as in the past due to the widespread availability of web-based services where the GUI is provided by the web-based front-end server. Further, there are several very high-quality alignment viewers and editors such as Jalview (<xref ref-type="bibr" rid="b5">Clamp et al, 2004</xref>) and Seaview (<xref ref-type="bibr" rid="b11">Gouy et al, 2010</xref>) that read Clustal Omega output or which can call Clustal Omega directly.</p>
  </sec>
  <sec disp-level="1">
    <title>Materials and methods</title>
    <p>Clustal Omega is licensed under the GNU Lesser General Public License. Source code as well as precompiled binaries for Linux, FreeBSD, Windows and Mac (Intel and PowerPC) are available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://www.clustal.org">http://www.clustal.org</ext-link>. Clustal Omega is available as a command line program only, which uses GNU-style command line options, and also accepts ClustalW-style command options for backwards compatibility and easy integration into existing pipelines.</p>
    <p>Clustal Omega is written in C and C++ and makes use of a number of excellent free software packages. We used a modified version of Sean Eddy's Squid library (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://selab.janelia.org/software.html">http://selab.janelia.org/software.html</ext-link>) for sequence I/O, allowing the use of a wide variety of file formats. We use David Arthur's k-means++ code (<xref ref-type="bibr" rid="b2">Arthur and Vassilvitskii, 2007</xref>) for fast clustering of sequence vectors. Code for fast UPGMA and guide tree handling routines was adopted from MUSCLE (<xref ref-type="bibr" rid="b8">Edgar, 2004</xref>). We use the OpenMP library to enable multithreaded computation of pairwise distances and alignment match states. The documentation for Clustal Omega's API is part of the source code, and in addition is available from <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://www.clustal.org/omega/clustalo-api/">http://www.clustal.org/omega/clustalo-api/</ext-link>. Full details of all algorithms are given in the accompanying <xref ref-type="supplementary-material" rid="S1">Supplementary Information</xref>.</p>
    <p>The benchmarks that were used were BAliBASE 3 (<xref ref-type="bibr" rid="b24">Thompson et al, 2005</xref>), PREFAB 4.0 (posted March 2005) (<xref ref-type="bibr" rid="b9">Edgar, 2010</xref>) and a newly constructed data set (HomFam) using sequences from Pfam (version 25) and Homstrad (as of 2011-06-13) (<xref ref-type="bibr" rid="b19">Mizuguchi et al, 1998</xref>). The programs that were compared can be obtained from:</p>
    <p>ClustalW2, v2.1 (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://www.clustal.org">http://www.clustal.org</ext-link>)</p>
    <p>DIALIGN 2.2.1 (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://dialign.gobics.de/">http://dialign.gobics.de/</ext-link>)</p>
    <p>FSA 1.15.5 (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://sourceforge.net/projects/fsa/">http://sourceforge.net/projects/fsa/</ext-link>)</p>
    <p>Kalign 2.04 (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://msa.sbc.su.se/cgi-bin/msa.cgi">http://msa.sbc.su.se/cgi-bin/msa.cgi</ext-link>)</p>
    <p>MAFFT 6.857 (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://mafft.cbrc.jp/alignment/software/source.html">http://mafft.cbrc.jp/alignment/software/source.html</ext-link>)</p>
    <p>MSAProbs 0.9.4 (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://sourceforge.net/projects/msaprobs/files/">http://sourceforge.net/projects/msaprobs/files/</ext-link>)</p>
    <p>MUSCLE version 3.8.31 posted 1 May 2010 (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://www.drive5.com/muscle/downloads.htm">http://www.drive5.com/muscle/downloads.htm</ext-link>)</p>
    <p>PRANK v.100802, 2 August 2010 (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/goldman-srv/prank/src/prank/">http://www.ebi.ac.uk/goldman-srv/prank/src/prank/</ext-link>)</p>
    <p>Probalign v1.4 (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://cs.njit.edu/usman/probalign/">http://cs.njit.edu/usman/probalign/</ext-link>)</p>
    <p>PROBCONS version 1.12 (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://probcons.stanford.edu/download.html">http://probcons.stanford.edu/download.html</ext-link>)</p>
    <p>T-Coffee Version 8.99 (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://www.tcoffee.org/Projects_home_page/t_coffee_home_page.html#DOWNLOAD">http://www.tcoffee.org/Projects_home_page/t_coffee_home_page.html#DOWNLOAD</ext-link>).</p>
  </sec>
  <sec sec-type="supplementary-material" id="S1">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="d35e26">
      <caption>
        <title>Supplementary Information</title>
        <p>Supplementary Figures S1–3</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="msb201175-s1.pdf"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="d35e32">
      <caption>
        <title>Review Process File</title>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="msb201175-s2.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>This work was supported by Science Foundation Ireland (Grant number: 07/IN.1/B1783).</p>
    <p><italic>Author contributions</italic>: DGH initiated the project; the original ClustalW software was produced by JDT, DGH and TJG. The HHalign code was written by JS and is maintained by MR. The idea of EPA was suggested by KK. FS adapted HHalign to Clustal Omega; AW devised and adapted guide tree construction routines. DD parallelised the code. AW, DD and FS carried out all software development. The EBI server was set up by RL, HMcW and WL. Benchmarking was carried out by JDT, AW, DD and FS. All authors contributed to the manuscript.</p>
  </ack>
  <ref-list>
    <ref id="b1">
      <mixed-citation publication-type="journal"><name><surname>Aniba</surname><given-names>MR</given-names></name>, <name><surname>Poch</surname><given-names>O</given-names></name>, <name><surname>Thompson</surname><given-names>JD</given-names></name> (<year>2010</year>) <article-title>Issues in bioinformatics benchmarking: the case study of multiple sequence alignment</article-title>. <source>Nucleic Acids Res</source>
<volume>38</volume>: <fpage>7353</fpage>–<lpage>7363</lpage><pub-id pub-id-type="pmid">20639539</pub-id></mixed-citation>
    </ref>
    <ref id="b2">
      <mixed-citation publication-type="other"><name><surname>Arthur</surname><given-names>D</given-names></name>, <name><surname>Vassilvitskii</surname><given-names>S</given-names></name> (<year>2007</year>) <article-title><italic>k</italic>-means++: the advantages of careful seeding</article-title>. Proceedings of the Eighteenth Annual ACM-SIAM Symposium on Discrete Algorithms. pp <fpage>1027</fpage>–<lpage>1035</lpage></mixed-citation>
    </ref>
    <ref id="b3">
      <mixed-citation publication-type="journal"><name><surname>Blackshields</surname><given-names>G</given-names></name>, <name><surname>Sievers</surname><given-names>F</given-names></name>, <name><surname>Shi</surname><given-names>W</given-names></name>, <name><surname>Wilm</surname><given-names>A</given-names></name>, <name><surname>Higgins</surname><given-names>DG</given-names></name> (<year>2010</year>) <article-title>Sequence emBedding for fast construction of guide trees for multiple sequence alignment</article-title>. <source>Algorithms Mol Biol</source>
<volume>5</volume>: <fpage>21</fpage><pub-id pub-id-type="pmid">20470396</pub-id></mixed-citation>
    </ref>
    <ref id="b4">
      <mixed-citation publication-type="journal"><name><surname>Bradley</surname><given-names>RK</given-names></name>, <name><surname>Roberts</surname><given-names>A</given-names></name>, <name><surname>Smoot</surname><given-names>M</given-names></name>, <name><surname>Juvekar</surname><given-names>S</given-names></name>, <name><surname>Do</surname><given-names>J</given-names></name>, <name><surname>Dewey</surname><given-names>C</given-names></name>, <name><surname>Holmes</surname><given-names>I</given-names></name>, <name><surname>Pachter</surname><given-names>L</given-names></name> (<year>2009</year>) <article-title>Fast statistical alignment</article-title>. <source>PLoS Comput Biol</source>
<volume>5</volume>: <fpage>e1000392</fpage><pub-id pub-id-type="pmid">19478997</pub-id></mixed-citation>
    </ref>
    <ref id="b5">
      <mixed-citation publication-type="journal"><name><surname>Clamp</surname><given-names>M</given-names></name>, <name><surname>Cuff</surname><given-names>J</given-names></name>, <name><surname>Searle</surname><given-names>SM</given-names></name>, <name><surname>Barton</surname><given-names>GJ</given-names></name> (<year>2004</year>) <article-title>The Jalview Java alignment editor</article-title>. <source>Bioinformatics</source>
<volume>20</volume>: <fpage>426</fpage>–<lpage>427</lpage><pub-id pub-id-type="pmid">14960472</pub-id></mixed-citation>
    </ref>
    <ref id="b6">
      <mixed-citation publication-type="journal"><name><surname>Do</surname><given-names>CB</given-names></name>, <name><surname>Mahabhashyam</surname><given-names>MSP</given-names></name>, <name><surname>Brudno</surname><given-names>M</given-names></name>, <name><surname>Batzoglou</surname><given-names>S</given-names></name> (<year>2005</year>) <article-title>ProbCons: probabilistic consistency-based multiple sequence alignment</article-title>. <source>Genome Res</source>
<volume>15</volume>: <fpage>330</fpage>–<lpage>340</lpage><pub-id pub-id-type="pmid">15687296</pub-id></mixed-citation>
    </ref>
    <ref id="b7">
      <mixed-citation publication-type="journal"><name><surname>Eddy</surname><given-names>SR</given-names></name> (<year>1998</year>) <article-title>Profile hidden Markov models</article-title>. <source>Bioinformatics</source>
<volume>14</volume>: <fpage>755</fpage>–<lpage>763</lpage><pub-id pub-id-type="pmid">9918945</pub-id></mixed-citation>
    </ref>
    <ref id="b8">
      <mixed-citation publication-type="journal"><name><surname>Edgar</surname><given-names>RC</given-names></name> (<year>2004</year>) <article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput</article-title>. <source>Nucleic Acids Res</source>
<volume>32</volume>: <fpage>1792</fpage>–<lpage>1797</lpage><pub-id pub-id-type="pmid">15034147</pub-id></mixed-citation>
    </ref>
    <ref id="b9">
      <mixed-citation publication-type="journal"><name><surname>Edgar</surname><given-names>RC</given-names></name> (<year>2010</year>) <article-title>Quality measures for protein alignment benchmarks</article-title>. <source>Nucleic Acids Res</source>
<volume>38</volume>: <fpage>2145</fpage>–<lpage>2153</lpage><pub-id pub-id-type="pmid">20047958</pub-id></mixed-citation>
    </ref>
    <ref id="b10">
      <mixed-citation publication-type="journal"><name><surname>Finn</surname><given-names>RD</given-names></name>, <name><surname>Mistry</surname><given-names>J</given-names></name>, <name><surname>Tate</surname><given-names>J</given-names></name>, <name><surname>Coggill</surname><given-names>P</given-names></name>, <name><surname>Heger</surname><given-names>A</given-names></name>, <name><surname>Pollington</surname><given-names>JE</given-names></name>, <name><surname>Gavin</surname><given-names>OL</given-names></name>, <name><surname>Gunasekaran</surname><given-names>P</given-names></name>, <name><surname>Ceric</surname><given-names>G</given-names></name>, <name><surname>Forslund</surname><given-names>K</given-names></name>, <name><surname>Holm</surname><given-names>L</given-names></name>, <name><surname>Sonnhammer</surname><given-names>EL</given-names></name>, <name><surname>Eddy</surname><given-names>SR</given-names></name>, <name><surname>Bateman</surname><given-names>A</given-names></name> (<year>2009</year>) <article-title>The Pfam protein families database</article-title>. <source>Nucleic Acids Res</source>
<volume>38</volume>: <fpage>D211</fpage>–<lpage>D222</lpage><pub-id pub-id-type="pmid">19920124</pub-id></mixed-citation>
    </ref>
    <ref id="b11">
      <mixed-citation publication-type="journal"><name><surname>Gouy</surname><given-names>M</given-names></name>, <name><surname>Guindon</surname><given-names>S</given-names></name>, <name><surname>Gascuel</surname><given-names>O</given-names></name> (<year>2010</year>) <article-title>SeaView version 4: a multiplatform graphical user interface for sequence alignment and phylogenetic tree building</article-title>. <source>Mol Biol Evol</source>
<volume>27</volume>: <fpage>221</fpage>–<lpage>224</lpage><pub-id pub-id-type="pmid">19854763</pub-id></mixed-citation>
    </ref>
    <ref id="b12">
      <mixed-citation publication-type="journal"><name><surname>Hogeweg</surname><given-names>P</given-names></name>, <name><surname>Hesper</surname><given-names>B</given-names></name> (<year>1984</year>) <article-title>The alignment of sets of sequences and the construction of phyletic trees: an integrated method</article-title>. <source>J Mol Evol</source>
<volume>20</volume>: <fpage>175</fpage>–<lpage>186</lpage><pub-id pub-id-type="pmid">6433036</pub-id></mixed-citation>
    </ref>
    <ref id="b13">
      <mixed-citation publication-type="journal"><name><surname>Katoh</surname><given-names>K</given-names></name>, <name><surname>Misawa</surname><given-names>K</given-names></name>, <name><surname>Kuma</surname><given-names>K</given-names></name>, <name><surname>Miyata</surname><given-names>T</given-names></name> (<year>2002</year>) <article-title>MAFFT: a novel method for rapid multiple sequence alignment based on fast Fourier transform</article-title>. <source>Nucleic Acids Res</source>
<volume>30</volume>: <fpage>3059</fpage>–<lpage>3066</lpage><pub-id pub-id-type="pmid">12136088</pub-id></mixed-citation>
    </ref>
    <ref id="b14">
      <mixed-citation publication-type="journal"><name><surname>Katoh</surname><given-names>K</given-names></name>, <name><surname>Toh</surname><given-names>H</given-names></name> (<year>2007</year>) <article-title>PartTree: an algorithm to build an approximate tree from a large number of unaligned sequences</article-title>. <source>Bioinformatics</source>
<volume>23</volume>: <fpage>372</fpage>–<lpage>374</lpage><pub-id pub-id-type="pmid">17118958</pub-id></mixed-citation>
    </ref>
    <ref id="b15">
      <mixed-citation publication-type="journal"><name><surname>Larkin</surname><given-names>MA</given-names></name>, <name><surname>Blackshields</surname><given-names>G</given-names></name>, <name><surname>Brown</surname><given-names>NP</given-names></name>, <name><surname>Chenna</surname><given-names>R</given-names></name>, <name><surname>McGettigan</surname><given-names>PA</given-names></name>, <name><surname>McWilliam</surname><given-names>H</given-names></name>, <name><surname>Valentin</surname><given-names>F</given-names></name>, <name><surname>Wallace</surname><given-names>IM</given-names></name>, <name><surname>Wilm</surname><given-names>A</given-names></name>, <name><surname>Lopez</surname><given-names>R</given-names></name>, <name><surname>Thompson</surname><given-names>JD</given-names></name>, <name><surname>Gibson</surname><given-names>TJ</given-names></name>, <name><surname>Higgins</surname><given-names>DG</given-names></name> (<year>2007</year>) <article-title>Clustal W and Clustal X version 2.0</article-title>. <source>Bioinformatics</source>
<volume>23</volume>: <fpage>2947</fpage>–<lpage>2948</lpage><pub-id pub-id-type="pmid">17846036</pub-id></mixed-citation>
    </ref>
    <ref id="b16">
      <mixed-citation publication-type="journal"><name><surname>Lassmann</surname><given-names>T</given-names></name>, <name><surname>Sonnhammer</surname><given-names>ELL</given-names></name> (<year>2005</year>) <article-title>Kalign—an accurate and fast multiple sequence alignment algorithm</article-title>. <source>BMC Bioinformatics</source>
<volume>6</volume>: <fpage>298</fpage><pub-id pub-id-type="pmid">16343337</pub-id></mixed-citation>
    </ref>
    <ref id="b17">
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>Y</given-names></name>, <name><surname>Schmidt</surname><given-names>B</given-names></name>, <name><surname>Maskell</surname><given-names>DL</given-names></name> (<year>2010</year>) <article-title>MSAProbs: multiple sequence alignment based on pair hidden Markov models and partition function posterior probabilities</article-title>. <source>Bioinformatics</source>
<volume>26</volume>: <fpage>1958</fpage>–<lpage>1964</lpage><pub-id pub-id-type="pmid">20576627</pub-id></mixed-citation>
    </ref>
    <ref id="b18">
      <mixed-citation publication-type="journal"><name><surname>Löytynoja</surname><given-names>A</given-names></name>, <name><surname>Goldman</surname><given-names>N</given-names></name> (<year>2008</year>) <article-title>Phylogeny-aware gap placement prevents errors in sequence alignment and evolutionary analysis</article-title>. <source>Science</source>
<volume>320</volume>: <fpage>1632</fpage>–<lpage>1635</lpage><pub-id pub-id-type="pmid">18566285</pub-id></mixed-citation>
    </ref>
    <ref id="b19">
      <mixed-citation publication-type="journal"><name><surname>Mizuguchi</surname><given-names>K</given-names></name>, <name><surname>Deane</surname><given-names>CM</given-names></name>, <name><surname>Blundell</surname><given-names>TL</given-names></name>, <name><surname>Overington</surname><given-names>JP</given-names></name> (<year>1998</year>) <article-title>HOMSTRAD: a database of protein structure alignments for homologous families</article-title>. <source>Protein Sci</source>
<volume>7</volume>: <fpage>2469</fpage>–<lpage>2471</lpage><pub-id pub-id-type="pmid">9828015</pub-id></mixed-citation>
    </ref>
    <ref id="b20">
      <mixed-citation publication-type="journal"><name><surname>Morgenstern</surname><given-names>B</given-names></name>, <name><surname>Frech</surname><given-names>K</given-names></name>, <name><surname>Dress</surname><given-names>A</given-names></name>, <name><surname>Werner</surname><given-names>T</given-names></name> (<year>1998</year>) <article-title>DIALIGN: finding local similarities by multiple sequence alignment</article-title>. <source>Bioinformatics</source>
<volume>14</volume>: <fpage>290</fpage>–<lpage>294</lpage><pub-id pub-id-type="pmid">9614273</pub-id></mixed-citation>
    </ref>
    <ref id="b21">
      <mixed-citation publication-type="journal"><name><surname>Notredame</surname><given-names>C</given-names></name>, <name><surname>Higgins</surname><given-names>DG</given-names></name>, <name><surname>Heringa</surname><given-names>J</given-names></name> (<year>2000</year>) <article-title>T-coffee: a novel method for fast and accurate multiple sequence alignment</article-title>. <source>J Mol Biol</source>
<volume>302</volume>: <fpage>205</fpage>–<lpage>217</lpage><pub-id pub-id-type="pmid">10964570</pub-id></mixed-citation>
    </ref>
    <ref id="b22">
      <mixed-citation publication-type="journal"><name><surname>Pirovano</surname><given-names>W</given-names></name>, <name><surname>Feenstra</surname><given-names>KA</given-names></name>, <name><surname>Heringa</surname><given-names>J</given-names></name> (<year>2008</year>) <article-title>PRALINETM: a strategy for improved multiple alignment of transmembrane proteins</article-title>. <source>Bioinformatics</source>
<volume>24</volume>: <fpage>492</fpage>–<lpage>497</lpage><pub-id pub-id-type="pmid">18174178</pub-id></mixed-citation>
    </ref>
    <ref id="b23">
      <mixed-citation publication-type="journal"><name><surname>Söding</surname><given-names>J</given-names></name> (<year>2005</year>) <article-title>Protein homology detection by HMM–HMM comparison</article-title>. <source>Bioinformatics</source>
<volume>21</volume>: <fpage>951</fpage>–<lpage>960</lpage><pub-id pub-id-type="pmid">15531603</pub-id></mixed-citation>
    </ref>
    <ref id="b24">
      <mixed-citation publication-type="journal"><name><surname>Thompson</surname><given-names>JD</given-names></name>, <name><surname>Koehl</surname><given-names>P</given-names></name>, <name><surname>Ripp</surname><given-names>R</given-names></name>, <name><surname>Poch</surname><given-names>O</given-names></name> (<year>2005</year>) <article-title>BAliBASE 3.0: latest developments of the multiple sequence alignment benchmark</article-title>. <source>Proteins</source>
<volume>61</volume>: <fpage>127</fpage>–<lpage>136</lpage><pub-id pub-id-type="pmid">16044462</pub-id></mixed-citation>
    </ref>
    <ref id="b25">
      <mixed-citation publication-type="journal"><name><surname>Wilm</surname><given-names>A</given-names></name>, <name><surname>Higgins</surname><given-names>DG</given-names></name>, <name><surname>Notredame</surname><given-names>C</given-names></name> (<year>2008</year>) <article-title>R-Coffee: a method for multiple alignment of non-coding RNA</article-title>. <source>Nucleic Acids Res</source>
<volume>36</volume>: <fpage>e52</fpage><pub-id pub-id-type="pmid">18420654</pub-id></mixed-citation>
    </ref>
  </ref-list>
  <fn-group>
    <fn fn-type="COI-statement">
      <p>The authors declare that they have no conflict of interest.</p>
    </fn>
  </fn-group>
</back>
<floats-group>
  <fig id="f1">
    <label>Figure 1</label>
    <caption>
      <p>Alignment time for Clustal Omega (red), MAFFT (blue), MUSCLE (green) and Kalign (purple) against the number of sequences of HomFam test sets. Average sequence length is rendered by point size. Both axes have logarithmic scales. Clustal Omega and Kalign were run with default flags over the entire range. MUSCLE was run with –maxiters 2 for <italic>N</italic>&gt;3000 sequences. MAFFT was run with --parttree for <italic>N</italic>&gt;10 000 sequences.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="msb201175-f1"/>
  </fig>
  <fig id="f2">
    <label>Figure 2</label>
    <caption>
      <p>EPA for HomFam and BAliBASE. Points represent TC scores of Clustal Omega alignment with EPA versus TC scores of default Clustal Omega alignment (without EPA). Points above bisectrix represent beneficial effect of EPA, points below deleterious effect. Average improvement in (<bold>A</bold>) 2.5%. HMMs taken from Pfam, benchmarking carried out using corresponding structure-based alignment in Homstrad. Average improvement in (<bold>B</bold>) over 30%. Here, test sets and EPA-HMMs were both derived from BAliBASE reference alignments.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="msb201175-f2"/>
  </fig>
  <fig id="f3">
    <label>Figure 3</label>
    <caption>
      <p>Iteration of HomFam alignments. Points represent cumulative running averages of TC scores. Clustal Omega default results in black, results after 1 iteration in red, after 2 iterations in blue. Iterations are combined HMM/guide tree iterations; <italic>x</italic> axis, logarithmic and <italic>y</italic> axis, linear scale.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="msb201175-f3"/>
  </fig>
  <table-wrap position="float" id="t1">
    <label>Table 1</label>
    <caption>
      <title>BAliBASE results</title>
    </caption>
    <table frame="hsides" rules="groups" border="1">
      <colgroup>
        <col align="left"/>
        <col align="char" char="."/>
        <col align="char" char="."/>
        <col align="char" char="."/>
        <col align="char" char="."/>
        <col align="char" char="."/>
        <col align="char" char="."/>
        <col align="char" char="."/>
        <col align="char" char="."/>
        <col align="center"/>
      </colgroup>
      <thead valign="bottom">
        <tr>
          <th align="left" valign="top" charoff="50">Aligner</th>
          <th align="center" valign="top" char="." charoff="50">Av score (218 families)</th>
          <th align="center" valign="top" char="." charoff="50">BB11 (38 families)</th>
          <th align="center" valign="top" char="." charoff="50">BB12 (44 families)</th>
          <th align="center" valign="top" char="." charoff="50">BB2 (41 families)</th>
          <th align="center" valign="top" char="." charoff="50">BB3 (30 families)</th>
          <th align="center" valign="top" char="." charoff="50">BB4 (49 families)</th>
          <th align="center" valign="top" char="." charoff="50">BB5 (16 families)</th>
          <th align="center" valign="top" char="." charoff="50">Tot time (s)</th>
          <th align="center" valign="top" charoff="50">Consistency</th>
        </tr>
      </thead>
      <tfoot valign="top">
        <tr>
          <th colspan="10" align="left" valign="top" charoff="50">The figures are total column scores produced using bali score on core columns only. The average score over all families is given in the second column. The results for BAliBASE subgroupings are in columns 3–8. The total run time for all 218 families is given in the second last column. The last column indicates whether the method is consistency based.</th>
        </tr>
      </tfoot>
      <tbody valign="top">
        <tr>
          <td align="left" valign="top" charoff="50">MSAprobs</td>
          <td align="char" valign="top" char="." charoff="50">0.607</td>
          <td align="char" valign="top" char="." charoff="50">0.441</td>
          <td align="char" valign="top" char="." charoff="50">0.865</td>
          <td align="char" valign="top" char="." charoff="50">0.464</td>
          <td align="char" valign="top" char="." charoff="50">0.607</td>
          <td align="char" valign="top" char="." charoff="50">0.622</td>
          <td align="char" valign="top" char="." charoff="50">0.608</td>
          <td align="char" valign="top" char="." charoff="50">12 382.00</td>
          <td align="center" valign="top" charoff="50">Yes</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Probalign</td>
          <td align="char" valign="top" char="." charoff="50">0.589</td>
          <td align="char" valign="top" char="." charoff="50">0.453</td>
          <td align="char" valign="top" char="." charoff="50">0.862</td>
          <td align="char" valign="top" char="." charoff="50">0.439</td>
          <td align="char" valign="top" char="." charoff="50">0.566</td>
          <td align="char" valign="top" char="." charoff="50">0.603</td>
          <td align="char" valign="top" char="." charoff="50">0.549</td>
          <td align="char" valign="top" char="." charoff="50">10 095.20</td>
          <td align="center" valign="top" charoff="50">Yes</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">MAFFT (auto)</td>
          <td align="char" valign="top" char="." charoff="50">0.588</td>
          <td align="char" valign="top" char="." charoff="50">0.439</td>
          <td align="char" valign="top" char="." charoff="50">0.831</td>
          <td align="char" valign="top" char="." charoff="50">0.450</td>
          <td align="char" valign="top" char="." charoff="50">0.581</td>
          <td align="char" valign="top" char="." charoff="50">0.605</td>
          <td align="char" valign="top" char="." charoff="50">0.591</td>
          <td align="char" valign="top" char="." charoff="50">1475.40</td>
          <td align="center" valign="top" charoff="50">Mostly (203/218)</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Probcons</td>
          <td align="char" valign="top" char="." charoff="50">0.558</td>
          <td align="char" valign="top" char="." charoff="50">0.417</td>
          <td align="char" valign="top" char="." charoff="50">0.855</td>
          <td align="char" valign="top" char="." charoff="50">0.406</td>
          <td align="char" valign="top" char="." charoff="50">0.544</td>
          <td align="char" valign="top" char="." charoff="50">0.532</td>
          <td align="char" valign="top" char="." charoff="50">0.573</td>
          <td align="char" valign="top" char="." charoff="50">13 086.30</td>
          <td align="center" valign="top" charoff="50">Yes</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Clustal Ω</td>
          <td align="char" valign="top" char="." charoff="50">0.554</td>
          <td align="char" valign="top" char="." charoff="50">0.358</td>
          <td align="char" valign="top" char="." charoff="50">0.789</td>
          <td align="char" valign="top" char="." charoff="50">0.450</td>
          <td align="char" valign="top" char="." charoff="50">0.575</td>
          <td align="char" valign="top" char="." charoff="50">0.579</td>
          <td align="char" valign="top" char="." charoff="50">0.533</td>
          <td align="char" valign="top" char="." charoff="50">539.91</td>
          <td align="center" valign="top" charoff="50">No</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">T-Coffee</td>
          <td align="char" valign="top" char="." charoff="50">0.551</td>
          <td align="char" valign="top" char="." charoff="50">0.410</td>
          <td align="char" valign="top" char="." charoff="50">0.848</td>
          <td align="char" valign="top" char="." charoff="50">0.402</td>
          <td align="char" valign="top" char="." charoff="50">0.491</td>
          <td align="char" valign="top" char="." charoff="50">0.545</td>
          <td align="char" valign="top" char="." charoff="50">0.587</td>
          <td align="char" valign="top" char="." charoff="50">81 041.50</td>
          <td align="center" valign="top" charoff="50">Yes</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Kalign</td>
          <td align="char" valign="top" char="." charoff="50">0.501</td>
          <td align="char" valign="top" char="." charoff="50">0.365</td>
          <td align="char" valign="top" char="." charoff="50">0.790</td>
          <td align="char" valign="top" char="." charoff="50">0.360</td>
          <td align="char" valign="top" char="." charoff="50">0.476</td>
          <td align="char" valign="top" char="." charoff="50">0.504</td>
          <td align="char" valign="top" char="." charoff="50">0.435</td>
          <td align="char" valign="top" char="." charoff="50">21.88</td>
          <td align="center" valign="top" charoff="50">No</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">MUSCLE</td>
          <td align="char" valign="top" char="." charoff="50">0.475</td>
          <td align="char" valign="top" char="." charoff="50">0.318</td>
          <td align="char" valign="top" char="." charoff="50">0.804</td>
          <td align="char" valign="top" char="." charoff="50">0.350</td>
          <td align="char" valign="top" char="." charoff="50">0.409</td>
          <td align="char" valign="top" char="." charoff="50">0.450</td>
          <td align="char" valign="top" char="." charoff="50">0.460</td>
          <td align="char" valign="top" char="." charoff="50">789.57</td>
          <td align="center" valign="top" charoff="50">No</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">MAFFT (default)</td>
          <td align="char" valign="top" char="." charoff="50">0.458</td>
          <td align="char" valign="top" char="." charoff="50">0.258</td>
          <td align="char" valign="top" char="." charoff="50">0.749</td>
          <td align="char" valign="top" char="." charoff="50">0.316</td>
          <td align="char" valign="top" char="." charoff="50">0.425</td>
          <td align="char" valign="top" char="." charoff="50">0.480</td>
          <td align="char" valign="top" char="." charoff="50">0.496</td>
          <td align="char" valign="top" char="." charoff="50">68.24</td>
          <td align="center" valign="top" charoff="50">No</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">FSA</td>
          <td align="char" valign="top" char="." charoff="50">0.419</td>
          <td align="char" valign="top" char="." charoff="50">0.270</td>
          <td align="char" valign="top" char="." charoff="50">0.818</td>
          <td align="char" valign="top" char="." charoff="50">0.187</td>
          <td align="char" valign="top" char="." charoff="50">0.259</td>
          <td align="char" valign="top" char="." charoff="50">0.474</td>
          <td align="char" valign="top" char="." charoff="50">0.398</td>
          <td align="char" valign="top" char="." charoff="50">53 648.10</td>
          <td align="center" valign="top" charoff="50">No</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Dialign</td>
          <td align="char" valign="top" char="." charoff="50">0.415</td>
          <td align="char" valign="top" char="." charoff="50">0.265</td>
          <td align="char" valign="top" char="." charoff="50">0.696</td>
          <td align="char" valign="top" char="." charoff="50">0.292</td>
          <td align="char" valign="top" char="." charoff="50">0.312</td>
          <td align="char" valign="top" char="." charoff="50">0.441</td>
          <td align="char" valign="top" char="." charoff="50">0.425</td>
          <td align="char" valign="top" char="." charoff="50">3977.44</td>
          <td align="center" valign="top" charoff="50">No</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">PRANK</td>
          <td align="char" valign="top" char="." charoff="50">0.376</td>
          <td align="char" valign="top" char="." charoff="50">0.223</td>
          <td align="char" valign="top" char="." charoff="50">0.680</td>
          <td align="char" valign="top" char="." charoff="50">0.257</td>
          <td align="char" valign="top" char="." charoff="50">0.321</td>
          <td align="char" valign="top" char="." charoff="50">0.360</td>
          <td align="char" valign="top" char="." charoff="50">0.356</td>
          <td align="char" valign="top" char="." charoff="50">128 355.00</td>
          <td align="center" valign="top" charoff="50">No</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">ClustalW</td>
          <td align="char" valign="top" char="." charoff="50">0.374</td>
          <td align="char" valign="top" char="." charoff="50">0.227</td>
          <td align="char" valign="top" char="." charoff="50">0.712</td>
          <td align="char" valign="top" char="." charoff="50">0.220</td>
          <td align="char" valign="top" char="." charoff="50">0.272</td>
          <td align="char" valign="top" char="." charoff="50">0.396</td>
          <td align="char" valign="top" char="." charoff="50">0.308</td>
          <td align="char" valign="top" char="." charoff="50">766.47</td>
          <td align="center" valign="top" charoff="50">No</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <table-wrap position="float" id="t2">
    <label>Table 2</label>
    <caption>
      <title>Prefab results</title>
    </caption>
    <table frame="hsides" rules="groups" border="1">
      <colgroup>
        <col align="left"/>
        <col align="char" char="."/>
        <col align="char" char="."/>
        <col align="char" char="."/>
        <col align="char" char="."/>
        <col align="char" char="."/>
        <col align="char" char="."/>
        <col align="center"/>
      </colgroup>
      <thead valign="bottom">
        <tr>
          <th align="left" valign="top" charoff="50">Aligner</th>
          <th align="center" valign="top" char="." charoff="50">0&lt;%ID⩽100 (1682 families)</th>
          <th align="center" valign="top" char="." charoff="50">0⩽%ID⩽20 (912 families)</th>
          <th align="center" valign="top" char="." charoff="50">20⩽%ID⩽40 (563 families)</th>
          <th align="center" valign="top" char="." charoff="50">40⩽%ID⩽70 (117 families)</th>
          <th align="center" valign="top" char="." charoff="50">70⩽%ID⩽100 (90 families)</th>
          <th align="center" valign="top" char="." charoff="50">Total time (s) (1682 families)</th>
          <th align="center" valign="top" charoff="50">Consistency</th>
        </tr>
      </thead>
      <tfoot valign="top">
        <tr>
          <th colspan="8" align="left" valign="top" charoff="50">Total column scores (TC) are shown for different percent identity ranges; the second column is the average score over all test cases. The total run time in seconds is shown in the second last column. The last column indicates if the method is consistency based.</th>
        </tr>
      </tfoot>
      <tbody valign="top">
        <tr>
          <td align="left" valign="top" charoff="50">MSAprobs</td>
          <td align="char" valign="top" char="." charoff="50">0.737</td>
          <td align="char" valign="top" char="." charoff="50">0.591</td>
          <td align="char" valign="top" char="." charoff="50">0.889</td>
          <td align="char" valign="top" char="." charoff="50">0.965</td>
          <td align="char" valign="top" char="." charoff="50">0.971</td>
          <td align="char" valign="top" char="." charoff="50">51 286.00</td>
          <td align="center" valign="top" charoff="50">Yes</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">MAFFT (auto)</td>
          <td align="char" valign="top" char="." charoff="50">0.721</td>
          <td align="char" valign="top" char="." charoff="50">0.569</td>
          <td align="char" valign="top" char="." charoff="50">0.876</td>
          <td align="char" valign="top" char="." charoff="50">0.961</td>
          <td align="char" valign="top" char="." charoff="50">0.979</td>
          <td align="char" valign="top" char="." charoff="50">4544.45</td>
          <td align="center" valign="top" charoff="50">Yes</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Probalign</td>
          <td align="char" valign="top" char="." charoff="50">0.719</td>
          <td align="char" valign="top" char="." charoff="50">0.563</td>
          <td align="char" valign="top" char="." charoff="50">0.881</td>
          <td align="char" valign="top" char="." charoff="50">0.961</td>
          <td align="char" valign="top" char="." charoff="50">0.977</td>
          <td align="char" valign="top" char="." charoff="50">35 117.30</td>
          <td align="center" valign="top" charoff="50">Yes</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Probcons</td>
          <td align="char" valign="top" char="." charoff="50">0.717</td>
          <td align="char" valign="top" char="." charoff="50">0.562</td>
          <td align="char" valign="top" char="." charoff="50">0.876</td>
          <td align="char" valign="top" char="." charoff="50">0.955</td>
          <td align="char" valign="top" char="." charoff="50">0.972</td>
          <td align="char" valign="top" char="." charoff="50">46 908.30</td>
          <td align="center" valign="top" charoff="50">Yes</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">T-Coffee</td>
          <td align="char" valign="top" char="." charoff="50">0.710</td>
          <td align="char" valign="top" char="." charoff="50">0.558</td>
          <td align="char" valign="top" char="." charoff="50">0.865</td>
          <td align="char" valign="top" char="." charoff="50">0.950</td>
          <td align="char" valign="top" char="." charoff="50">0.972</td>
          <td align="char" valign="top" char="." charoff="50">175 789.00</td>
          <td align="center" valign="top" charoff="50">Yes</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Clustal Ω</td>
          <td align="char" valign="top" char="." charoff="50">0.700</td>
          <td align="char" valign="top" char="." charoff="50">0.535</td>
          <td align="char" valign="top" char="." charoff="50">0.866</td>
          <td align="char" valign="top" char="." charoff="50">0.967</td>
          <td align="char" valign="top" char="." charoff="50">0.980</td>
          <td align="char" valign="top" char="." charoff="50">1698.06</td>
          <td align="center" valign="top" charoff="50">No</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">MUSCLE</td>
          <td align="char" valign="top" char="." charoff="50">0.677</td>
          <td align="char" valign="top" char="." charoff="50">0.507</td>
          <td align="char" valign="top" char="." charoff="50">0.850</td>
          <td align="char" valign="top" char="." charoff="50">0.946</td>
          <td align="char" valign="top" char="." charoff="50">0.976</td>
          <td align="char" valign="top" char="." charoff="50">2068.56</td>
          <td align="center" valign="top" charoff="50">No</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">MAFFT</td>
          <td align="char" valign="top" char="." charoff="50">0.677</td>
          <td align="char" valign="top" char="." charoff="50">0.513</td>
          <td align="char" valign="top" char="." charoff="50">0.836</td>
          <td align="char" valign="top" char="." charoff="50">0.961</td>
          <td align="char" valign="top" char="." charoff="50">0.979</td>
          <td align="char" valign="top" char="." charoff="50">225.56</td>
          <td align="center" valign="top" charoff="50">No</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Kalign</td>
          <td align="char" valign="top" char="." charoff="50">0.649</td>
          <td align="char" valign="top" char="." charoff="50">0.474</td>
          <td align="char" valign="top" char="." charoff="50">0.817</td>
          <td align="char" valign="top" char="." charoff="50">0.957</td>
          <td align="char" valign="top" char="." charoff="50">0.979</td>
          <td align="char" valign="top" char="." charoff="50">80.81</td>
          <td align="center" valign="top" charoff="50">No</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">ClustalW2</td>
          <td align="char" valign="top" char="." charoff="50">0.617</td>
          <td align="char" valign="top" char="." charoff="50">0.430</td>
          <td align="char" valign="top" char="." charoff="50">0.797</td>
          <td align="char" valign="top" char="." charoff="50">0.933</td>
          <td align="char" valign="top" char="." charoff="50">0.975</td>
          <td align="char" valign="top" char="." charoff="50">3433.53</td>
          <td align="center" valign="top" charoff="50">No</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Dialign</td>
          <td align="char" valign="top" char="." charoff="50">0.595</td>
          <td align="char" valign="top" char="." charoff="50">0.398</td>
          <td align="char" valign="top" char="." charoff="50">0.783</td>
          <td align="char" valign="top" char="." charoff="50">0.940</td>
          <td align="char" valign="top" char="." charoff="50">0.974</td>
          <td align="char" valign="top" char="." charoff="50">18 909.70</td>
          <td align="center" valign="top" charoff="50">No</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">PRANK</td>
          <td align="char" valign="top" char="." charoff="50">0.586</td>
          <td align="char" valign="top" char="." charoff="50">0.390</td>
          <td align="char" valign="top" char="." charoff="50">0.767</td>
          <td align="char" valign="top" char="." charoff="50">0.951</td>
          <td align="char" valign="top" char="." charoff="50">0.978</td>
          <td align="char" valign="top" char="." charoff="50">351 498.00</td>
          <td align="center" valign="top" charoff="50">No</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">FSA</td>
          <td align="char" valign="top" char="." charoff="50">0.534</td>
          <td align="char" valign="top" char="." charoff="50">0.277</td>
          <td align="char" valign="top" char="." charoff="50">0.791</td>
          <td align="char" valign="top" char="." charoff="50">0.965</td>
          <td align="char" valign="top" char="." charoff="50">0.976</td>
          <td align="char" valign="top" char="." charoff="50">229 391.00</td>
          <td align="center" valign="top" charoff="50">No</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <table-wrap position="float" id="t3">
    <label>Table 3</label>
    <caption>
      <title>HomFam benchmarking results</title>
    </caption>
    <table frame="hsides" rules="groups" border="1">
      <colgroup>
        <col align="left"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
      </colgroup>
      <thead valign="bottom">
        <tr>
          <th align="left" valign="top" charoff="50"> </th>
          <th align="center" valign="top" charoff="50">93⩽<italic>N</italic>⩽2957 (41 families)</th>
          <th align="center" valign="top" charoff="50">3127⩽<italic>N</italic>⩽9105 (33 families)</th>
          <th align="center" valign="top" charoff="50">10 099⩽<italic>N</italic>⩽50 157 (18 families)</th>
        </tr>
      </thead>
      <tfoot valign="top">
        <tr>
          <th colspan="4" align="left" valign="top" charoff="50">The columns show total column score (TC) and total run time in seconds for groupings of small (&lt;3000 sequences), medium (3000–10 000 sequences) and large (&gt;10 000 sequences) HomFam test cases.</th>
        </tr>
      </tfoot>
      <tbody valign="top">
        <tr>
          <td align="left" valign="top" charoff="50">Aligner</td>
          <td align="char" valign="top" char="vmk" charoff="50">TC/t (s)</td>
          <td align="char" valign="top" char="vmk" charoff="50">TC/t (s)</td>
          <td align="char" valign="top" char="vmk" charoff="50">TC/t (s)</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Clustal Ω</td>
          <td align="char" valign="top" char="vmk" charoff="50">0.708/2114.0</td>
          <td align="char" valign="top" char="vmk" charoff="50">0.639/11 719.5</td>
          <td align="char" valign="top" char="vmk" charoff="50">0.464/27 328.9</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Kalign</td>
          <td align="char" valign="top" char="vmk" charoff="50">0.569/324.9</td>
          <td align="char" valign="top" char="vmk" charoff="50">0.563/6752.0</td>
          <td align="char" valign="top" char="vmk" charoff="50">0.420/286 711.0</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">MAFFT default</td>
          <td align="char" valign="top" char="vmk" charoff="50">0.550/238.9</td>
          <td align="char" valign="top" char="vmk" charoff="50">0.462/3115.4</td>
          <td align="char" valign="top" char="vmk" charoff="50">−/−</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">MAFFT –parttree</td>
          <td align="char" valign="top" char="vmk" charoff="50">−/−</td>
          <td align="char" valign="top" char="vmk" charoff="50">−/−</td>
          <td align="char" valign="top" char="vmk" charoff="50">0.253/6119.4</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">MUSCLE default</td>
          <td align="char" valign="top" char="vmk" charoff="50">0.533/104 587.0</td>
          <td align="char" valign="top" char="vmk" charoff="50">−/−</td>
          <td align="char" valign="top" char="vmk" charoff="50">−/−</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">MUSCLE –maxiters 2</td>
          <td align="char" valign="top" char="vmk" charoff="50">−/−</td>
          <td align="char" valign="top" char="vmk" charoff="50">0.416/8239.2</td>
          <td align="char" valign="top" char="vmk" charoff="50">0.216/110 292.0</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</floats-group>
