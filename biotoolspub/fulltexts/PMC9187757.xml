<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9187757</article-id>
    <article-id pub-id-type="publisher-id">13446</article-id>
    <article-id pub-id-type="doi">10.1038/s41598-022-13446-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Classification-based motion analysis of single-molecule trajectories using DiffusionLab</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Maris</surname>
          <given-names>J. J. Erik</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rabouw</surname>
          <given-names>Freddy T.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Weckhuysen</surname>
          <given-names>Bert M.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Meirer</surname>
          <given-names>Florian</given-names>
        </name>
        <address>
          <email>f.meirer@uu.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.5477.1</institution-id><institution-id institution-id-type="ISNI">0000000120346234</institution-id><institution>Inorganic Chemistry and Catalysis, Debye Institute for Nanomaterials Science, </institution><institution>Utrecht University, </institution></institution-wrap>3584 CG Utrecht, The Netherlands </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.5477.1</institution-id><institution-id institution-id-type="ISNI">0000000120346234</institution-id><institution>Soft Condensed Matter and Biophysics, Debye Institute for Nanomaterials Science, </institution><institution>Utrecht University, </institution></institution-wrap>3584 CC Utrecht, The Netherlands </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>10</day>
      <month>6</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>6</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>12</volume>
    <elocation-id>9595</elocation-id>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>3</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>5</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Single-particle tracking is a powerful approach to study the motion of individual molecules and particles. It can uncover heterogeneities that are invisible to ensemble techniques, which places it uniquely among techniques to study mass transport. Analysis of the trajectories obtained with single-particle tracking in inorganic porous hosts is often challenging, because trajectories are short and/or motion is heterogeneous. We present the DiffusionLab software package for motion analysis of such challenging data sets. Trajectories are first classified into populations with similar characteristics to which the motion analysis is tailored in a second step. DiffusionLab provides tools to classify trajectories based on the motion type either with machine learning or manually. It also offers quantitative mean squared displacement analysis of the trajectories. The software can compute the diffusion constant for an individual trajectory if it is sufficiently long, or the average diffusion constant for multiple shorter trajectories. We demonstrate the DiffusionLab approach via the analysis of a simulated data set with motion types frequently observed in inorganic porous hosts, such as zeolites. The software package with graphical user interface and its documentation are freely available.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Analytical chemistry</kwd>
      <kwd>Catalysis</kwd>
      <kwd>Materials chemistry</kwd>
      <kwd>Software</kwd>
      <kwd>Software</kwd>
      <kwd>Molecular imaging</kwd>
      <kwd>Fluorescence imaging</kwd>
      <kwd>Imaging techniques</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003246</institution-id>
            <institution>Nederlandse Organisatie voor Wetenschappelijk Onderzoek</institution>
          </institution-wrap>
        </funding-source>
        <award-id>MCEC NWO Gravitation Program</award-id>
        <award-id>VENI Grant 722.017.002</award-id>
        <award-id>VIDI Grant 723.015.007</award-id>
        <principal-award-recipient>
          <name>
            <surname>Rabouw</surname>
            <given-names>Freddy T.</given-names>
          </name>
          <name>
            <surname>Meirer</surname>
            <given-names>Florian</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par2">Mass transport is widely studied across the natural sciences: from the movement of a reactants into a catalyst particle to cellular transport driven by motor proteins<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref></sup>. To understand and model transport phenomena and predict associated properties, quantitative experimental input is crucial. An excellent way to obtain this is to record the location of a single moving object, such as a molecule or nanoparticle, as a function of time, yielding a so-called trajectory. Already back in the 1900’s, Perrin studied the movement of single granular and colloidal particles by recording their trajectory, and by doing so, was the first to experimentally verify Einstein’s work on Brownian motion<sup><xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR4">4</xref></sup>. The modern era of trajectory-based analysis started with the development of algorithms to localize and track particles from time-lapse microscopy videos<sup><xref ref-type="bibr" rid="CR5">5</xref>,<xref ref-type="bibr" rid="CR6">6</xref></sup>. These methods together with fluorescence microscopy techniques, such as single-molecule localization microscopy, enable tracking of single fluorescing molecules, quantum dots, and colloids with nanometre resolution<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR7">7</xref></sup>.</p>
    <p id="Par3">Molecules with the same chemical identity can display very different motion behaviour as a result of the complex environment where the diffusion takes place. Driven by the notion that ensemble-averaging obscures heterogeneities and thus hides important features for cellular function, single-particle tracking has had a crucial role in the discovery of cellular organisation and a variety of cellular processes<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. In the field of materials science, different motion behaviours have been observed for fluorescent molecules diffusing through a porous catalyst particle<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. Interpretation of a data set with fluorophores displaying different motion behaviours requires sufficient statistics on the occurrence of the motion behaviours and a quantitative description of each motion behaviour via a diffusion model. This is challenging as the measured trajectories are often short, i.e. ~5–15 frames, as a result of fast diffusion, rapid photobleaching, and blinking of the fluorophores, and individually do not contain sufficient information for a reliable quantification of the motion.</p>
    <p id="Par4">We present in this work an open access, freely available software package “DiffusionLab” to perform quantitative analysis of datasets of single-molecule trajectories. DiffusionLab is versatile, is user-friendly, and can be readily used to perform complex tasks without the need for programming experience. Most other software packages focus on the quantification of multiple normal diffusion states directly from the analysis of the displacements, using various methods such as fitting of the cumulative distribution of squared displacements<sup><xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR15">15</xref></sup>. In contrast to these software packages, DiffusionLab first simplifies the data set by classification of the trajectories into smaller populations with similar motion behaviour prior to diffusion quantification. In this way, motion heterogeneity can be visualized and quantified in a robust way that is not only dependent on fitting of a single (multistate) diffusion model to the displacements<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR16">16</xref></sup>. Consequently, the DiffusionLab software can handle trajectory data sets containing a mixture of motion types such as normal, confined, and directed diffusion by treating them separately. DiffusionLab focusses on robustness and ease of use to make the tools for quantitative analysis of complex trajectory data sets broadly available to the scientific community.</p>
    <p id="Par5">The combination of trajectory classification and motion analysis has been proven to be a powerful approach for the analysis of complex data sets with short trajectories, particularly in the field of materials science as evidenced by work from our group using the DiffusionLab software<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR16">16</xref></sup>. The potential of feature-based classification has also been reported by Lerner et al. for the classification of confinement in trajectories mixed with normal or directed diffusion<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>. Lerner et al. classified the trajectories based on three features that described properties of individual trajectories and, subsequently, quantified confinement within the classified trajectories with mean squared displacement analysis using the “msdanalyzer” software<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. DiffusionLab has a wide range of built-in trajectory features (or “properties”) as well as the option to add custom features by the user to provide descriptors for many different motion types. The classification is done using these features, either by setting thresholds manually or with feature-based machine learning methods on a user-generated training set. Recently, machine learning methods have been developed for the detection and classification of the different diffusion types, which are mostly focussed on the recognition of anomalous diffusion<sup><xref ref-type="bibr" rid="CR19">19</xref>–<xref ref-type="bibr" rid="CR25">25</xref></sup>. In contrast to the approach employed in DiffusionLab, these models are trained by simulated trajectories with a known set of diffusion models. The presence of anomalous diffusion is some cases not clear from mean squared displacement analysis and can be confused with normal diffusion<sup><xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR26">26</xref></sup>. Further classification by state-of-the-art machine learning models after classification in DiffusionLab could be required to identify the type of anomalous diffusion<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>.</p>
    <p id="Par6">Single-molecule localization microscopy allows the localisation of fluorophores with a spatial resolution much smaller than the diffraction limit of light<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. When light from a point source passes through a lens, it spreads out before it reaches the camera due to diffraction of the relayed light. The “point spread function” (PSF) is a function that describes how a point source at position <italic>r</italic> in the sample makes an image at position <italic>r’</italic> on the camera. The PSF stretches over all positions <italic>r’</italic> on the camera but is virtually zero apart from a small region. If the pixel size is sufficiently small, a mathematical description of the PSF can be fit to the camera image <italic>r’</italic> and the position of the point emitter <italic>r</italic> is retrieved with nanometre precision. A Gaussian function with a full width at half maximum in the order of the emission wavelength is often used to describe the PSF. Since the fluorophores are generally very small, the PSF is virtually the same for light emitted anywhere from the fluorophore’s volume and they can be regarded as point sources. If the fluorophore density in a single micrograph is sufficiently low that the non-zero regions of the PSFs do not overlap, the location coordinates of each fluorophore can be determined rapidly with available algorithms<sup><xref ref-type="bibr" rid="CR28">28</xref>,<xref ref-type="bibr" rid="CR29">29</xref></sup>. In the next step, the localisation coordinates from a time series that most likely belongs to the same molecule are grouped together into a trajectory. Grouping coordinates into trajectories is often achieved by an algorithm that minimizes a cost function, which depends on e.g. the displacement between consecutive coordinates<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR28">28</xref>–<xref ref-type="bibr" rid="CR31">31</xref></sup>. The DiffusionLab software imports trajectories from third-party localization and tracking applications and provides the tools to analyse the trajectories via classification and motion analysis.</p>
    <p id="Par7">Mean-squared displacement (MSD) analysis is one of the most common tools to quantify the motion of a fluorophore described by a trajectory, because of its visual interpretability<sup><xref ref-type="bibr" rid="CR32">32</xref>,<xref ref-type="bibr" rid="CR33">33</xref></sup>. The shape of the MSD curve is dependent on the motion behaviour of the diffusing particle. While normal (Brownian) diffusion is characterised by a linear relation between the MSD and the delay time <inline-formula id="IEq2"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{n}$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2022_13446_Article_IEq2.gif"/></alternatives></inline-formula>, confined motion results in an MSD that reaches a plateau for long delay times and directed motion can be identified by a parabolic MSD curve. Anomalous diffusion can in some cases be mistaken for normal diffusion in the MSD analysis, and careful interpretation is required in systems where anomalous diffusion is expected. The MSD is computed from a time series of positions <inline-formula id="IEq3"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{x}}_{0} ,{\varvec{x}}_{1} , \ldots ,{\varvec{x}}_{N}$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_13446_Article_IEq3.gif"/></alternatives></inline-formula> for a single trajectory as<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{T-MSD}}\left( {t_{n} } \right) = \frac{1}{N - n + 1}\mathop \sum \limits_{i = 0}^{N - n} \left| {{\varvec{x}}_{i + n} - {\varvec{x}}_{i} } \right|^{2}$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mrow><mml:mtext>T-MSD</mml:mtext><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mfenced close="|" open="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><graphic xlink:href="41598_2022_13446_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>with the delay time <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{n} = n{\Delta }t$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_13446_Article_IEq4.gif"/></alternatives></inline-formula> for <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n = 1, 2,...,N$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_13446_Article_IEq5.gif"/></alternatives></inline-formula> and the time between frames <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Delta }t$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_13446_Article_IEq6.gif"/></alternatives></inline-formula><sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR32">32</xref>–<xref ref-type="bibr" rid="CR35">35</xref></sup>. We will refer to this MSD as the time-averaged MSD (T-MSD) to distinguish it from the time–ensemble averaged MSD discussed later in the text—the term MSD will be used when this distinction is not required. In practice, the MSD curve will be affected by noise on the coordinates <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{x}}_{i}$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2022_13446_Article_IEq7.gif"/></alternatives></inline-formula> determined experimentally, because of the localisation error due to photon-counting noise and image blur as a result of motion within the exposure time of a microscope frame. For free two-dimensional normal diffusion including localisation error and motion blur, the measured mean squared displacement <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{MSD}}\left( {t_{n} } \right)$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mtext>MSD</mml:mtext><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_13446_Article_IEq8.gif"/></alternatives></inline-formula> is described by<sup><xref ref-type="bibr" rid="CR32">32</xref>,<xref ref-type="bibr" rid="CR34">34</xref></sup>,<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{MSD}}\left( {t_{n} } \right) = 4Dt_{n} + 4\left( {\sigma^{2} - 2RD{\Delta }t} \right){\text{ for }}n \ge 1$$\end{document}</tex-math><mml:math id="M18" display="block"><mml:mrow><mml:mtext>MSD</mml:mtext><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mi>D</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mi>R</mml:mi><mml:mi>D</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mrow><mml:mspace width="0.333333em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mi>n</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><graphic xlink:href="41598_2022_13446_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>with <inline-formula id="IEq9"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M20"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_13446_Article_IEq9.gif"/></alternatives></inline-formula> the diffusion coefficient, <inline-formula id="IEq10"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M22"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_13446_Article_IEq10.gif"/></alternatives></inline-formula> the localization error, and <inline-formula id="IEq11"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R$$\end{document}</tex-math><mml:math id="M24"><mml:mi>R</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_13446_Article_IEq11.gif"/></alternatives></inline-formula> the motion blur coefficient. The first term in Eq. (<xref rid="Equ2" ref-type="">2</xref>) describes how the MSD increases as function of delay time due to normal diffusion, while the second term adds a constant factor accounting for localization error and motion blur, which are both errors introduced by the experimental measurement. <inline-formula id="IEq12"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R$$\end{document}</tex-math><mml:math id="M26"><mml:mi>R</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_13446_Article_IEq12.gif"/></alternatives></inline-formula> can take values in the interval <inline-formula id="IEq13"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left[ {0, 1/4} \right]$$\end{document}</tex-math><mml:math id="M28"><mml:mfenced close="]" open="["><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41598_2022_13446_Article_IEq13.gif"/></alternatives></inline-formula> and is dependent on the detection scheme. In the case of no motion blur, <inline-formula id="IEq14"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R = 0$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_13446_Article_IEq14.gif"/></alternatives></inline-formula>, while <inline-formula id="IEq15"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R = 1/6$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_13446_Article_IEq15.gif"/></alternatives></inline-formula> if the exposure time of the camera equals the time between frames. Ideally one would fit (a set of) trajectories that can be described by a single diffusion constant; however, if the individual fluorophores switch between diffusive states, the MSD analysis will report only an average diffusion constant.</p>
    <p id="Par8">We include (T-)MSD curve analysis in DiffusionLab as primary motion estimator because it is accessible, well known across the scientific community, and robust for many different motion behaviours. The caveat of T-MSD analysis is that the fitted parameters can be biased when the trajectories are short (Sec. <xref rid="MOESM1" ref-type="media">S1.1</xref>)<sup><xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR34">34</xref></sup>. This is particularly a problem for single-molecule trajectories recorded in inorganic porous hosts, which are generally short and have heterogeneous underlying motion behaviour. Bias in the T-MSD curve makes the identification of the motion behaviour ambiguous and introduces bias in the fitted parameters. Unfortunately, these trajectory properties are inherent to the experiment and cannot be changed substantially—even by experiment design<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. Therefore, we classify the individual trajectories based on similarity and pool them to get their population average, which is a well-known concept in processing hyperspectral images<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>. With this approach we reduce noise and bias in the population-averaged MSD curve, and as a result we obtain the motion type and fitted parameters of the pooled trajectories with improved performance. Ultimately, it allows the spatial mapping of motion heterogeneity on level of single short trajectories.</p>
    <p id="Par9">In this work, we explain the methodology of DiffusionLab and demonstrate it via the classification of trajectories of a simulated example data set. This example contains trajectories of fluorophores that show transient trapping, which is common for fluorophores diffusing in a nanoporous host<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR37">37</xref>,<xref ref-type="bibr" rid="CR38">38</xref></sup>. We demonstrate how to perform classification via machine learning. Finally, the motion of the classified populations is analysed and quantified with MSD analysis.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <p id="Par10">We simulated synthetic trajectories of emitters exhibiting transient trapping. The details are given in the Sec. <xref rid="MOESM1" ref-type="media">S1.2</xref>. Briefly, a synthetic dataset was generated in three steps: (1) simulation of the coordinates of 3-dimensional <italic>xyzt</italic> trajectories<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>; (2) generation of synthetic <italic>xyt</italic> time lapse video frames from 3-dimensional trajectories using a simulated point spread function<sup><xref ref-type="bibr" rid="CR40">40</xref>,<xref ref-type="bibr" rid="CR41">41</xref></sup> and homogeneous background signal; and (3) localization and tracking of the generated synthetic time lapse video with conventional fitting routines<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. To simulate transient trapping, the coordinates of a random walk with two diffusion states was simulated in step (1). The diffusion constant of the first diffusion state was set to zero (<inline-formula id="IEq16"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${D}_{1} = 0$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_13446_Article_IEq16.gif"/></alternatives></inline-formula>) while the other was set to <inline-formula id="IEq17"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${D}_{2}=1.0\times {10}^{-12}$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1.0</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>12</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_13446_Article_IEq17.gif"/></alternatives></inline-formula> m<sup>2</sup> s<sup>−1</sup>. The probability to change diffusion state was 0.02 per frame (0.4 s<sup>−1</sup>). A fixed number of trajectories was simulated in a three-dimensional box with periodic boundary conditions during the full simulation time. Every trajectory coordinate in (1) resulted in a PSF “placed” in the time-lapse video (2). To simulate motion blur, the trajectory coordinates in step (1) were computed with a five times higher time resolution than the synthetic time lapse video in (2). This means that we placed five PSFs along the path the emitter has travelled during one frame. Photon-counting noise and camera noise were simulated in step (2) resulting in an imprecision in the localization in (3), which altogether introduced a localisation error. In the final step, localisation and tracking were done with the DoM plugin (Detection of Molecules, <ext-link ext-link-type="uri" xlink:href="https://github.com/ekatrukha/DoM_Utrecht">https://github.com/ekatrukha/DoM_Utrecht</ext-link>) for ImageJ<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. A small fraction of the simulated emitters was in the microscope frame, i.e., focal volume, at the same time. Importantly, the emitter was only tracked by the DoM plugin when it was sufficiently in focus. Out-of-focus emitters were too broad or had insufficient counts to be picked up by the tracking algorithm. As a result, the three-dimensional trajectories were split into many shorter trajectories due to in- and out-of-focus movement of the simulated emitters.</p>
    <p id="Par11">The hierarchical classification tree was constructed from a manually classified training set of 100 trajectories. The training set was used to automatically select the threshold and the trajectory properties, i.e., features. We allowed all trajectory properties available in DiffusionLab to be used by the model, which was the “elongation”, “elongation angle”, “entropy”, “length”, “minimum bounding circle radius”, “minimum bounding circle minus the centre of mass”, “number of points”, and “tortuosity” (see also Documentation Section 3.1.1). The maximum number of splits in the tree was limited to five in all examples, because a larger tree did not lead to better classification and could cause overfitting.</p>
    <p id="Par12">The classification and analysis of the simulated trajectories was done with version 1.1.0 of the DiffusionLab software package. The MATLAB installer and source code are available online: <ext-link ext-link-type="uri" xlink:href="https://github.com/ErikMaris/DiffusionLab">https://github.com/ErikMaris/DiffusionLab</ext-link>. The latest version of the documentation can be downloaded via <ext-link ext-link-type="uri" xlink:href="https://diffusionlab.readthedocs.io/_/downloads/en/latest/pdf/">https://diffusionlab.readthedocs.io/_/downloads/en/latest/pdf/</ext-link>.</p>
  </sec>
  <sec id="Sec3">
    <title>Results and discussion</title>
    <sec id="Sec4">
      <title>The workflow and concepts of DiffusionLab</title>
      <p id="Par13">The workflow of the classification-based motion analysis in DiffusionLab is given in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. In the first step, the trajectories are imported from a tracking software. At the time of writing, DiffusionLab supports the import of trajectories from the software package Localizer<sup><xref ref-type="bibr" rid="CR28">28</xref></sup> and the ImageJ plug-in DoM<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. Moreover, the import of simulated trajectories from COMSOL Multiphysics® is supported to compare experimental and simulated data sets<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>. Step-by-step instructions for how to export the trajectories from the respective software are given in the Documentation section 2.2. In the second step, a set of descriptors of each trajectory is computed, which are scalars that capture a property of the trajectory. Examples of these properties are the length and tortuosity of the trajectory. Both two and three-dimensional trajectories are supported; however, not all properties are defined in three dimensions. A description and physical interpretation of the properties is given in the Documentation section 3.1.1.<fig id="Fig1"><label>Figure 1</label><caption><p>Workflow of population-based motion analysis in DiffusionLab: (1) the trajectories are imported; (2) a set of descriptors (properties) of each trajectory is computed; (3) a classification model is constructed, this can either be done manually as a hierarchical classification tree (3a) or via supervised machine learning (3b); (4) the classification model is used to classify all trajectories in populations with similar motion behaviour; and (5) the mean squared displacement (MSD) of the populations is analysed separately. Finally, the properties and motion analysis results can be plotted, saved and/or exported.</p></caption><graphic xlink:href="41598_2022_13446_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par14">A classification model is constructed to classify the trajectories into populations with similar motion behaviour. The populations are identified by the user and classification is done via a hierarchical classification tree. The hierarchical classification tree is read from top to bottom for each trajectory, weighing one property at each branch, until the trajectory is classified (example in Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Hierarchical classification trees have the advantage that they are easily interpretable and important properties and their thresholds are readily available from the model<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>. This aids rational design of the classification model when constructed manually. For machine learning, the classification tree model has the advantage that it is very well interpretable compared to other machine learning models. In DiffusionLab, hierarchical classification trees can be constructed manually or via supervised machine learning. For manual construction, DiffusionLab has various tools to find important properties for classification and to set the thresholds. The biplot shows the properties with a high dispersion that are therefore good candidates to implement in the tree (see Sec. <xref rid="MOESM1" ref-type="media">S1.3</xref>). Histograms and correlation plots can be generated to find thresholds in e.g., bimodal distributions as is shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, step 3a. These thresholds can be optimized by applying the classification and visually assessing the result. In supervised machine learning, the model maps an input (trajectory properties) to an output (motion behaviour type) based on example input–output pairs. The example pairs are called a “training set”, which are here a set of representative trajectories labelled with their motion behaviour. DiffusionLab offers a tool to manually classify a subset of experimental trajectories to obtain such a training set. This is then used to compute a hierarchical classification tree model. On top of that, MATLAB’s Classification Learner app can be used to construct a classification model with any classification models available in MATLAB, which includes support vector machines and K-nearest neighbours. In the fourth step, the classification model is used to classify all trajectories in populations.<fig id="Fig2"><label>Figure 2</label><caption><p>(<bold>a</bold>) Example trajectories of the immobile, hybrid, and mobile population. The dashed circle has a radius of the minimum bounding circle radius and marks the immobile segments in the trajectories. (<bold>b</bold>) Classification tree obtained with machine learning on a training set of 100 manually classified trajectories for a simulated dataset with transient trapping. The classification tree is read from top to bottom for each trajectory, weighing one property at each branch, until the trajectory is classified as either mobile, immobile, or hybrid. At each split, the histogram of the property is given for all trajectories of the branch, with the background colour indicating the threshold value of the split.</p></caption><graphic xlink:href="41598_2022_13446_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par15">The motion of the classified populations is analysed in the last step (Fig. <xref rid="Fig1" ref-type="fig">1</xref>, step 5), and this is where the power of the classification-based approach becomes truly visible. With DiffusionLab, the user can quantify both the motion of individual trajectories and the ensemble behaviour of each population. Analysis of the individual trajectories reveals the heterogeneity in molecular motion on the single-molecule level. However, in data sets with short trajectories, the statistical relevance of a single trajectory is limited. Because the trajectories have been classified into populations with similar motion behaviour, we can overcome this by analysing the ensemble-averaged behaviour and diffusion parameters. T-MSD analysis is known to suffer from bias in the estimated diffusion parameters due to correlation in the displacements<sup><xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR34">34</xref></sup>. Since the detected motion behaviour is dependent on the relation between the MSD and the delay time, the bias makes it particularly challenging to determine the diffusion model that best characterizes the motion of the emitters<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. The time–ensemble averaged MSD (TE-MSD) averages the T-MSD over a subset of trajectories, thereby averaging over any correlations within the trajectories<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{TE-MSD}}\left( {t_{n} } \right) = \frac{1}{{J_{n} }}\mathop \sum \limits_{{j,N_{j} \ge n}} \frac{1}{{N_{j} - n + 1}}\mathop \sum \limits_{i = 0}^{{N_{j} - n}} \left| {{\varvec{x}}_{j,i + n} - {\varvec{x}}_{j,i} } \right|^{2}$$\end{document}</tex-math><mml:math id="M38" display="block"><mml:mrow><mml:mtext>TE-MSD</mml:mtext><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>J</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mfrac><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mfenced close="|" open="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><graphic xlink:href="41598_2022_13446_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>with the time series of positions <inline-formula id="IEq18"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{x}}_{j,0} ,{\varvec{x}}_{j,1} ,...,{\varvec{x}}_{{j,N_{j} }}$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_13446_Article_IEq18.gif"/></alternatives></inline-formula> for trajectory <inline-formula id="IEq19"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M42"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_13446_Article_IEq19.gif"/></alternatives></inline-formula>. For each delay time <inline-formula id="IEq20"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{n}$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2022_13446_Article_IEq20.gif"/></alternatives></inline-formula>, we include an ensemble of <inline-formula id="IEq21"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{n}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>J</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2022_13446_Article_IEq21.gif"/></alternatives></inline-formula> trajectories with <inline-formula id="IEq22"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{j} \ge n$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_13446_Article_IEq22.gif"/></alternatives></inline-formula>. The bias in the TE-MSD is strongly reduced with respect to the T-MSD, which results in a interpretable relation between the MSD and the delay time over a longer time domain, facilitating the determination of the motion behaviour type<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. Moreover, the diffusion constant can be readily extracted from the TE-MSD, which allows direct comparison within and between different experiments. We use the T-MSD for the analysis of individual trajectories, while TE-MSD is used to analyse a population of trajectories. Altogether, using these two complementary approaches we obtain both insight in the motion heterogeneity on the single-molecule level as well as the mean diffusion parameters.</p>
    </sec>
    <sec id="Sec5">
      <title>A simulated example of trajectory classification and motion analysis</title>
      <p id="Par16">We demonstrate the workflow of DiffusionLab on a dataset of simulated trajectories (see Methods). The trajectories were simulated from random walkers in three dimensions that could switch between an immobile (<inline-formula id="IEq23"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${D}_{1}=0$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_13446_Article_IEq23.gif"/></alternatives></inline-formula> m<sup>2</sup> s<sup>−1</sup>) and mobile state (<inline-formula id="IEq24"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${D}_{2}=1.0\times {10}^{-12}$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1.0</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>12</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_13446_Article_IEq24.gif"/></alternatives></inline-formula> m<sup>2</sup> s<sup>−1</sup>), mimicking transient trapping often observed in porous solids<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR37">37</xref>,<xref ref-type="bibr" rid="CR38">38</xref></sup>. We imported the data set into DiffusionLab and find 10,600 individual trajectories (Fig. <xref rid="Fig1" ref-type="fig">1</xref>, step 1). Before computing the properties in step 2, we removed trajectories with fewer than five localizations<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>. In this way, we reject trajectories and unconnected localisations whose properties, such as a minimum bounding circle radius, are not or ill-defined. Moreover, the localisation and tracking algorithm sometimes finds localisations due to fluctuations in the camera noise. Since these erroneous localisations are random, the probability that they form a trajectory becomes smaller for longer trajectories. Thus, we can eliminate most of these from the analysis by removing trajectories with fewer than five localizations. Finally, for a trajectory of five localisations, the minimum number of points in the MSD curve is four, which we consider the minimum for MSD analysis. Removing the trajectories with less than five localizations reduces the number of trajectories to 2433. DiffusionLab then computes and stores the trajectory properties, as explained in the Documentation Section 3.1.1.</p>
      <p id="Par17">Next, the hierarchical classification tree was created (Fig. <xref rid="Fig1" ref-type="fig">1</xref>, step 3), and we first identified the motion types present in the data set. Although the movement of all emitters was simulated using the same underlying diffusion constants, we observed three qualitatively different types of trajectories, in agreement with the experimental results of Hendriks and Meirer et al<italic>.</italic><sup><xref ref-type="bibr" rid="CR1">1</xref></sup> (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a and Sec. <xref rid="MOESM1" ref-type="media">S1.4</xref>). For some trajectories, the coordinates are separated from each other by no more than the localisation error. These do likely not reflect actual movement, but the apparent motion is due to the localisation error. We call these trajectories ‘immobile’. Other trajectories show continuous movement without interruptions, which we label ‘mobile’ trajectories. A third group of ‘hybrid’ trajectories has both mobile and immobile periods. Next, we manually classified a hundred trajectories, assigning each to one of the three motion types, and used this as a training set for machine learning. A training set of just a hundred trajectories is typically considered to be very small for machine learning; nevertheless, we show that this can be sufficient to construct a classification tree with reasonable accuracy. The classification tree has a resubstitution loss of 2%, which means that two of the hundred trajectories in our training set were incorrectly classified by the tree. With a small training set as is discussed here, we highly recommend to assess the tree’s performance via the resubstitution loss as well as by visual inspection of the complete data set after classification. The classification tree obtained is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>b. A discussion of the performance of other estimators can be found in Section <xref rid="MOESM1" ref-type="media">S1.5</xref>. Reproduction of the motion analysis with segmentation using a different training set yields a very similar tree and classification results (Sec. <xref rid="MOESM1" ref-type="media">S1.6</xref>). Interestingly, the same track properties, that is, the minimum bounding circle radius (MBCR), the minimum bounding circle centre minus the centre of mass (MBCC–CoM), and the number of points, were again found to be most important as previously reported in the classification tree of Hendriks and Meirer et al<italic>.</italic><sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. The tree in their work was constructed with machine learning from a training set with mobile, hybrid, and immobile trajectories obtained from an experimental dataset of molecules diffusing in a porous catalyst particle. At every split of our classification tree, the histogram of the respective trajectory property is given in Fig. <xref rid="Fig2" ref-type="fig">2</xref>b. A bimodal distribution is clearly visible in the histogram of the MBCR and MBCC–CoM. The machine learning algorithm had found good threshold values to split the bimodal distribution without having access to the complete data set (shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). The stochastic nature of the random walk results in some overlap between the properties of the various motion types, as can been seen in the histogram, and the classification is successful if a vast majority of the trajectories in a population have been correctly classified.</p>
      <p id="Par18">We can rationalize why the MBCR, MBCC–CoM, and number of points are good properties to classify a data set with transient trapping. It is no surprise that the MBCR is a good property to classify immobile trajectories, because the emitter does not move, and localisations are scattered around the emitter’s true position. In Section <xref rid="MOESM1" ref-type="media">S1.7</xref>, we calculate the probability that an immobile trajectory falls entirely within a minimum bounding circle with some threshold radius. A threshold value of the MBCR of 118 nm is reasonable compared to the localization errors of 12 and 28 nm of an in-focus and 400 nm out-of-focus fluorophore<sup><xref ref-type="bibr" rid="CR44">44</xref>,<xref ref-type="bibr" rid="CR45">45</xref></sup>. The probability that a trajectory with 17 localisations, which is the mean length for the immobile population, fits within the minimum bounding circle is &gt; 99.99% for an in-focus immobile emitter, while it drops to 99.95% for an out-of-focus one. Thus, the value of the MBCR allows for out-of-focus emitters to be classified as immobile, while keeping it as low as possible to not include many hybrid trajectories. The MBCC–CoM is a good property to distinguish hybrid trajectories from mobile ones. Because it describes how far the centre of the minimum bounding circle and the centre of mass are apart, its value will be higher when the trajectory has a spatially asymmetric distribution of localisations. This is a characteristic of a trajectory with an immobile segment followed by a mobile segment, in other words: a hybrid trajectory. The number of points is a good indicator for whether the trajectory is either hybrid or mobile. Mobile trajectories are a result of emitters rapidly moving in- and out-of-focus resulting in short trajectories, while the immobile segments in hybrid trajectories make the trajectory longer. Because these properties are good descriptors for this type of motion behaviour, we demonstrated that the presented classification tree can be manually adapted to classify a data set with transient confinement (Sec. <xref rid="MOESM1" ref-type="media">S1.8</xref>). Next, we used the obtained classification tree to classify all trajectories in the transient trapping data set (Fig. <xref rid="Fig1" ref-type="fig">1</xref>, step 4).</p>
      <p id="Par19">The motion of the different populations is quantified with MSD analysis of individual trajectories and in ensemble (Fig. <xref rid="Fig1" ref-type="fig">1</xref>, step 5). The diffusion constant was measured from a linear least-squares fit of the T-MSD curve including 25% of the shortest delay times and at least three points in the fit. A histogram of the measured diffusion constants of individual trajectories is given in Fig. <xref rid="Fig3" ref-type="fig">3</xref>a,b. Prior to classification, we find a continuous range of diffusion constants over six orders of magnitude (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). The distribution contains all information about the heterogeneity of mobility and motion behaviour, but it is hard to interpret. By pooling the data into motion behaviour classes, we learn how the mobility and motion behaviour are related and how they change per experiment. To understand the origin of this wide range in diffusion constants, we consider the same histogram after classification (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). Remarkably, the immobile trajectories make up for most of the spread, while we would expect the diffusion constant of immobile emitters to be <inline-formula id="IEq26"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D = D_{1} = 0$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_13446_Article_IEq26.gif"/></alternatives></inline-formula>. Localisation noise dominates the measured diffusion constants of these immobile emitters, and the spread does not reflect a true distribution of diffusion constants. As expected, the immobile trajectories have a diffusion constant close to zero. The distribution of the diffusion constant of mobile trajectories is narrower and centred around <inline-formula id="IEq27"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D = D_{2} = 10^{ - 12}$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>12</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_13446_Article_IEq27.gif"/></alternatives></inline-formula> m<sup>2</sup> s<sup>−1</sup>, i.e., the true mobility of the mobile diffusion state in the simulation. The hybrid trajectories have a wider range of diffusion constants in between those of the immobile and mobile diffusion states, because of the varying length of mobile and immobile periods in the trajectories.<fig id="Fig3"><label>Figure 3</label><caption><p>(<bold>a</bold>,<bold>b</bold>) Histogram of the measured diffusion constant as obtained by time-averaged mean squared displacement (T-MSD) analysis per trajectory (<bold>a</bold>) before and (<bold>b</bold>) after classification. Negative measured diffusion constants are not displayed in the logarithmic scale. (<bold>c</bold>,<bold>d</bold>) Zoom of the time–ensemble averaged mean squared displacement (TE-MSD) (<bold>c</bold>) before and (<bold>d</bold>) after classification. A zoom-out is shown in the inset in (<bold>d</bold>). (<bold>e</bold>) Correlation plot of the diffusion constant and number of points of the hybrid population. Each dot represents a single trajectory. (<bold>f</bold>) One minus the cumulative distribution function (CDF) of squared displacements for a delay time of one frame of all trajectories plotted with a logarithmic <italic>y</italic>-axis. The colours indicate the populations after classification. The solid black lines are a guide to the eye to indicate two regimes in the cumulative density probability of the mobile trajectories. A zoom-out is shown in the inset.</p></caption><graphic xlink:href="41598_2022_13446_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par20">The TE-MSD curve provides insight in the mean motion behavior of the emitters via the shape of the curve and fit of an appropriate diffusion model. We compare the TE-MSD before and after classification (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c,d). The shape of the TE-MSD curve prior to classification in Fig. <xref rid="Fig3" ref-type="fig">3</xref>c resembles confined motion, marked by the plateau at long delay times<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>. However, we do not expect confined motion in this data set, since the transient trapping diffusion model does not impose confinement on the emitters. Interestingly, we find the same plateau after classification in the hybrid trajectories’ TE-MSD curve, while the mobile and immobile TE-MSD curves are a straight line (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d). To explain the plateau at long delay times, we first consider the TE-MSD curve of the hybrid trajectories. The correlation plot of the diffusion constant and the number of localizations of the hybrid trajectories shows that trajectories with few localizations have a high diffusion constant and vice versa (Fig. <xref rid="Fig3" ref-type="fig">3</xref>e). The number of localisations in the trajectory is highly dependent on the number of immobile segments, because the emitter cannot move out of focus during these immobile periods. At long delay times in the TE-MSD curve, only the trajectories with many localizations (thus a longer time in the immobile state) contribute, which results in a decrease in the slope of the curve. Now that we understand the origin of the plateau at long delay times in the TE-MSD of the hybrid trajectories (Fig. <xref rid="Fig3" ref-type="fig">3</xref>e), we can explain the TE-MSD prior to classification (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d). Here, the curve also flattens to a plateau value—even more rapidly than for the hybrid trajectories—because short mobile trajectories and long immobile trajectories contribute to the TE-MSD curve as well. In contrast to the hybrid trajectories, the TE-MSD curves of the mobile and immobile trajectories are a straight line. This confirms that the mobile trajectories are due to normal diffusion. The slope of the TE-MSD of the immobile trajectories is zero, i.e., the apparent diffusion constant is zero, which is in line with their immobile motion behaviour.</p>
      <p id="Par21">The diffusion constant of the mobile trajectories is extracted from the TE-MSD curves using the model for normal Brownian diffusion. For our data set, we found <italic>D</italic> = 9.23 ± 0.14 × 10<sup>–13</sup> m<sup>2</sup> s<sup>−1</sup>. This value is slightly but statistically significantly lower than the true diffusion constant of the mobile state of <italic>D</italic> = 1.0 × 10<sup>–12</sup> m<sup>2</sup> s<sup>−1</sup> that we had put in our simulations. This is attributed to a small number of immobile steps in the mobile trajectories, which reduces the measured diffusion constant of the population. We can estimate the fraction of immobile steps in the mobile population with the cumulative distribution function (CDF) of squared displacements for a delay time of one frame (Fig. <xref rid="Fig3" ref-type="fig">3</xref>f). Normal diffusion in two dimensions should yield<sup><xref ref-type="bibr" rid="CR46">46</xref></sup>,<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 - {\text{CDF}}\left( {r^{2} ,t_{n} } \right) = {\text{exp}}\left( {\frac{{ - r^{2} }}{{{\text{MSD}}\left( {t_{n} } \right)}}} \right)$$\end{document}</tex-math><mml:math id="M58" display="block"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mtext>CDF</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mtext>exp</mml:mtext><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mo>-</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mtext>MSD</mml:mtext><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="41598_2022_13446_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>with <inline-formula id="IEq28"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r^{2}$$\end{document}</tex-math><mml:math id="M60"><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="41598_2022_13446_Article_IEq28.gif"/></alternatives></inline-formula> the squared displacement at a delay time <inline-formula id="IEq29"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{n}$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2022_13446_Article_IEq29.gif"/></alternatives></inline-formula>. This produces a straight line in a semi-log plot of 1—CDF against <inline-formula id="IEq30"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r^{2}$$\end{document}</tex-math><mml:math id="M64"><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="41598_2022_13446_Article_IEq30.gif"/></alternatives></inline-formula>. Multiple decays in the 1—CDF curve indicate that multiple populations of emitters with a different diffusion constant are present, each with a different MSD resulting in a different slope of the curve. For the mobile trajectories, we find a transition from a fast decay (immobile displacements) to a slower decay (mobile displacements) (see black guides to the eye in Fig. <xref rid="Fig3" ref-type="fig">3</xref>f). This confirms that ~4% of the displacements in mobile trajectories are immobile, which mainly explains a slight underestimation of the true simulated diffusion constant in the TE-MSD analysis. It also shows that the classification is not perfect, and that motion analysis could be further improved by fitting the 1—CDF curve directly. The remainder of the discrepancy between the measured and true diffusion constant originates from imperfect linking of the localisations into tracks. For the immobile trajectories, we find <italic>D</italic> = 0 ± 4 × 10<sup>–18</sup> m<sup>2</sup> s<sup>−1</sup> confirming that the diffusion constant of the immobile trajectories is zero—as expected.</p>
      <p id="Par22">In summary, we have demonstrated how the DiffusionLab software can be used to analyse a set of trajectories originating from complex heterogeneous motion. The software is a powerful tool for a wide range of materials scientists studying the motion of molecules and nanoparticles in porous materials, including but not limited to zeolite-based materials<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR16">16</xref></sup>. Adsorption and confinement play a big role in such porous materials, and classification prior to motion analysis can greatly increase interpretability, avoid bias, and allows for more reliable spatial mapping of diffusion heterogeneity. In previous experimental work using the DiffusionLab software, we have demonstrated this approach in a study of molecular diffusion through a porous catalyst particle, which is industrially used to “crack” long organic molecules into smaller—more useful—chemical building blocks<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. The pore space of the catalyst particle is heterogeneous in material composition and porosity, with pore sizes ranging from the macropore to the micropore regime. The complex structure was reflected in the measured heterogeneous molecular motion behaviour. By classification in mobile, hybrid, and immobile trajectories, diffusivity of only the mobile trajectories could be compared with the bulk diffusion coefficient of feedstock molecules, which turned out to be very similar in magnitude, thereby validating the approach. In other work using DiffusionLab, we have tracked the motion of single oligomers in the pores of ZSM-5 zeolites<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. By performing classification and motion analysis, we could not only compare the average diffusion constant between experiments, but also explain whether differences were the result of a change in diffusivity during and/or frequency of the mobile periods. This had led to a detailed insight in pore geometry–mass transport relationships on the microscopic scale. These successful applications from materials science recommend the DiffusionLab approach for the field of life sciences as well. The motion types supported by DiffusionLab have been frequently observed in cellular environments. For example, directed motion has been reported when vesicles are transported along microtubules by molecular motors, transient trapping when molecules interact with actin proteins, or confined diffusion when molecules are confined by cell membrane components<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR8">8</xref></sup>.</p>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Conclusions and outlook</title>
    <p id="Par23">The DiffusionLab software package, which is open access and freely available to the scientific community, was developed for the analysis and quantification of motion from single-particle trajectories with (1) heterogeneous motion and/or (2) trajectories with only a few localizations. The trajectories are first classified into populations with similar characteristics to which the motion analysis is tailored in a second step. DiffusionLab provides the tools to classify trajectories based on their motion type either with machine learning or manually. MSD analysis is available to perform quantitative motion analysis of the trajectories. The software can compute the diffusion constant for an individual trajectory if it is sufficiently long, or the average diffusion constant for multiple shorter trajectories. We demonstrated DiffusionLab’s workflow with a set of simulated trajectories with a transient trapping model. The data set showed heterogeneous motion behaviour and contained many trajectories with only a few localizations. Using DiffusionLab, we were able to interpret and quantify the motion in this complex data set. Moreover, DiffusionLab has been successfully used to analyse experimental single-molecule trajectories recorded in porous materials as reported previously by our group<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR16">16</xref></sup>. Future developments of the software will focus on the extension of the motion analysis methods, including a fit of the 1—CDF curves, as well as the addition of new properties for trajectories with many localizations.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec7">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41598_2022_13446_MOESM1_ESM.docx">
            <caption>
              <p>Supplementary Information.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary Information</title>
    <p>The online version contains supplementary material available at 10.1038/s41598-022-13446-0.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work was supported by the Netherlands Center for Multiscale Catalytic Energy Conversion (MCEC), an NWO Gravitation Program funded by the Ministry of Education, Culture and Science of the Government of the Netherlands. F.T.R. acknowledges financial support from The Netherlands Organization for Scientific Research NWO (VENI Grant 722.017.002). F.M. acknowledges funding from the Netherlands Organization for Scientific Research (NWO) VIDI Grant (No. 723.015.007).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>F.M. and J.J.E.M. conceived the program and study; J.J.E.M. wrote both the DiffusionLab software and performed the analyses with help from F.M.; J.J.E.M. wrote the software for the simulation of synthetic trajectories with input from F.T.R. and F.M.; J.J.E.M. wrote the manuscript with input from F.T.R., B.M.W., and F.M.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The newest version of the DiffusionLab software is available from the GitHub repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/ErikMaris/DiffusionLab">https://github.com/ErikMaris/DiffusionLab</ext-link>) along with documentation hosted on Read the Docs (<ext-link ext-link-type="uri" xlink:href="https://diffusionlab.readthedocs.io/en/latest/">https://diffusionlab.readthedocs.io/en/latest/</ext-link>). Both the MATLAB app installer and the source code are available here. The trajectories, training sets, and classification trees used in this work are available from the DiffusionLab repository. The synthetic microscopy movies used to generate the trajectories used in this work as well as the code simulate them will be shared by the lead contact upon reasonable request. The movies were analysed with the DoM plugin (Detection of Molecules, <ext-link ext-link-type="uri" xlink:href="https://github.com/ekatrukha/DoM_Utrecht">https://github.com/ekatrukha/DoM_Utrecht</ext-link>) for ImageJ<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>.</p>
  </notes>
  <notes id="FPar1" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par24">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hendriks</surname>
            <given-names>FC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-molecule fluorescence microscopy reveals local diffusion coefficients in the pore network of an individual catalyst particle</article-title>
        <source>J. Am. Chem. Soc.</source>
        <year>2017</year>
        <volume>139</volume>
        <fpage>13632</fpage>
        <lpage>13635</lpage>
        <pub-id pub-id-type="doi">10.1021/jacs.7b07139</pub-id>
        <?supplied-pmid 28902508?>
        <pub-id pub-id-type="pmid">28902508</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katrukha</surname>
            <given-names>EA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Probing cytoskeletal modulation of passive and active intracellular dynamics using nanobody-functionalized quantum dots</article-title>
        <source>Nat. Commun.</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>14772</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms14772</pub-id>
        <?supplied-pmid 28322225?>
        <pub-id pub-id-type="pmid">28322225</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Perrin</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>Atoms</source>
        <year>1915</year>
        <publisher-name>Constable &amp; Company Ltd.</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patterson</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Jean Perrin and the triumph of the atomic doctrine</article-title>
        <source>Endeavour</source>
        <year>2007</year>
        <volume>31</volume>
        <fpage>50</fpage>
        <lpage>53</lpage>
        <pub-id pub-id-type="doi">10.1016/j.endeavour.2007.05.003</pub-id>
        <?supplied-pmid 17602746?>
        <pub-id pub-id-type="pmid">17602746</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Geerts</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nanovid tracking: A new automatic method for the study of mobility in living cells based on colloidal gold and video microscopy</article-title>
        <source>Biophys. J.</source>
        <year>1987</year>
        <volume>52</volume>
        <fpage>775</fpage>
        <lpage>782</lpage>
        <pub-id pub-id-type="doi">10.1016/S0006-3495(87)83271-X</pub-id>
        <?supplied-pmid 3427186?>
        <pub-id pub-id-type="pmid">3427186</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shen</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single particle tracking: From theory to biophysical applications</article-title>
        <source>Chem. Rev.</source>
        <year>2017</year>
        <volume>117</volume>
        <fpage>7331</fpage>
        <lpage>7376</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.chemrev.6b00815</pub-id>
        <?supplied-pmid 28520419?>
        <pub-id pub-id-type="pmid">28520419</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maris</surname>
            <given-names>JJE</given-names>
          </name>
          <name>
            <surname>Fu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Meirer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Weckhuysen</surname>
            <given-names>BM</given-names>
          </name>
        </person-group>
        <article-title>Single-molecule observation of diffusion and catalysis in nanoporous solids</article-title>
        <source>Adsorption</source>
        <year>2021</year>
        <volume>27</volume>
        <fpage>423</fpage>
        <lpage>452</lpage>
        <pub-id pub-id-type="doi">10.1007/s10450-020-00292-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Manzo</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Garcia-Parajo</surname>
            <given-names>MF</given-names>
          </name>
        </person-group>
        <article-title>A review of progress in single particle tracking: From methods to biophysical insights</article-title>
        <source>Rep. Prog. Phys.</source>
        <year>2015</year>
        <volume>78</volume>
        <fpage>124601</fpage>
        <pub-id pub-id-type="doi">10.1088/0034-4885/78/12/124601</pub-id>
        <?supplied-pmid 26511974?>
        <pub-id pub-id-type="pmid">26511974</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Persson</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Lindén</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Unoson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Elf</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Extracting intracellular diffusive states and transition rates from single-molecule tracking data</article-title>
        <source>Nat. Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>265</fpage>
        <lpage>269</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2367</pub-id>
        <?supplied-pmid 23396281?>
        <pub-id pub-id-type="pmid">23396281</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Matysik</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kraut</surname>
            <given-names>RS</given-names>
          </name>
        </person-group>
        <article-title>TrackArt: The user friendly interface for single molecule tracking data analysis and simulation applied to complex diffusion in mica supported lipid bilayers</article-title>
        <source>BMC Res. Notes</source>
        <year>2014</year>
        <volume>7</volume>
        <fpage>274</fpage>
        <pub-id pub-id-type="doi">10.1186/1756-0500-7-274</pub-id>
        <?supplied-pmid 24885944?>
        <pub-id pub-id-type="pmid">24885944</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tinevez</surname>
            <given-names>J-Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TrackMate: An open and extensible platform for single-particle tracking</article-title>
        <source>Methods</source>
        <year>2017</year>
        <volume>115</volume>
        <fpage>80</fpage>
        <lpage>90</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ymeth.2016.09.016</pub-id>
        <?supplied-pmid 27713081?>
        <pub-id pub-id-type="pmid">27713081</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rösch</surname>
            <given-names>TC</given-names>
          </name>
          <name>
            <surname>Oviedo-Bocanegra</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Fritz</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Graumann</surname>
            <given-names>PL</given-names>
          </name>
        </person-group>
        <article-title>SMTracker: a tool for quantitative analysis, exploration and visualization of single-molecule tracking data reveals highly dynamic binding of B. subtilis global repressor AbrB throughout the genome</article-title>
        <source>Sci. Rep.</source>
        <year>2018</year>
        <volume>8</volume>
        <fpage>15747</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-018-33842-9</pub-id>
        <?supplied-pmid 30356068?>
        <pub-id pub-id-type="pmid">30356068</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hansen</surname>
            <given-names>AS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Robust model-based analysis of single-particle tracking experiments with spot-on</article-title>
        <source>eLife</source>
        <year>2018</year>
        <volume>7</volume>
        <fpage>e33125</fpage>
        <pub-id pub-id-type="doi">10.7554/eLife.33125</pub-id>
        <?supplied-pmid 29300163?>
        <pub-id pub-id-type="pmid">29300163</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>BH</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>HY</given-names>
          </name>
        </person-group>
        <article-title>HybTrack: A hybrid single particle tracking software using manual and automatic detection of dim signals</article-title>
        <source>Sci. Rep.</source>
        <year>2018</year>
        <volume>8</volume>
        <fpage>212</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-017-18569-3</pub-id>
        <?supplied-pmid 29317715?>
        <pub-id pub-id-type="pmid">29317715</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuhn</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hettich</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Davtyan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gebhardt</surname>
            <given-names>JCM</given-names>
          </name>
        </person-group>
        <article-title>Single molecule tracking and analysis framework including theory-predicted parameter settings</article-title>
        <source>Sci. Rep.</source>
        <year>2021</year>
        <volume>11</volume>
        <fpage>9465</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-021-88802-7</pub-id>
        <?supplied-pmid 33947895?>
        <pub-id pub-id-type="pmid">33947895</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fu</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Unravelling channel structure-diffusivity relationships in zeolite ZSM-5 at the single-molecule level</article-title>
        <source>Angew. Chem. Int. Ed.</source>
        <year>2022</year>
        <volume>64</volume>
        <fpage>e202114388</fpage>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lerner</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Two-parameter single-molecule analysis for measurement of chromatin mobility</article-title>
        <source>STAR Protoc.</source>
        <year>2020</year>
        <volume>1</volume>
        <fpage>100223</fpage>
        <pub-id pub-id-type="doi">10.1016/j.xpro.2020.100223</pub-id>
        <?supplied-pmid 33377115?>
        <pub-id pub-id-type="pmid">33377115</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tarantino</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TNF and IL-1 exhibit distinct ubiquitin requirements for inducing NEMO–IKK supramolecular structures</article-title>
        <source>J. Cell Biol.</source>
        <year>2014</year>
        <volume>204</volume>
        <fpage>231</fpage>
        <lpage>245</lpage>
        <pub-id pub-id-type="doi">10.1083/jcb.201307172</pub-id>
        <?supplied-pmid 24446482?>
        <pub-id pub-id-type="pmid">24446482</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dosset</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automatic detection of diffusion modes within biological membranes using back-propagation neural network</article-title>
        <source>BMC Bioinform.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>197</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-016-1064-z</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Granik</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-particle diffusion characterization by deep learning</article-title>
        <source>Biophys. J.</source>
        <year>2019</year>
        <volume>117</volume>
        <fpage>185</fpage>
        <lpage>192</lpage>
        <pub-id pub-id-type="doi">10.1016/j.bpj.2019.06.015</pub-id>
        <?supplied-pmid 31280841?>
        <pub-id pub-id-type="pmid">31280841</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kowalek</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Loch-Olszewska</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Szwabiński</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Classification of diffusion modes in single-particle tracking data: Feature-based versus deep-learning approach</article-title>
        <source>Phys. Rev. E</source>
        <year>2019</year>
        <volume>100</volume>
        <fpage>032410</fpage>
        <pub-id pub-id-type="doi">10.1103/PhysRevE.100.032410</pub-id>
        <?supplied-pmid 31640019?>
        <pub-id pub-id-type="pmid">31640019</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Muñoz-Gil</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Garcia-March</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Manzo</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Martín-Guerrero</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Lewenstein</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Single trajectory characterization via machine learning</article-title>
        <source>New J. Phys.</source>
        <year>2020</year>
        <volume>22</volume>
        <fpage>013010</fpage>
        <pub-id pub-id-type="doi">10.1088/1367-2630/ab6065</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Verdier</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Learning physical properties of anomalous random walks using graph neural networks</article-title>
        <source>J. Phys. Math. Theor.</source>
        <year>2021</year>
        <volume>54</volume>
        <fpage>234001</fpage>
        <pub-id pub-id-type="doi">10.1088/1751-8121/abfa45</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Yao</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>WaveNet-based deep neural networks for the characterization of anomalous diffusion (WADNet)</article-title>
        <source>J. Phys. Math. Theor.</source>
        <year>2021</year>
        <volume>54</volume>
        <fpage>404003</fpage>
        <pub-id pub-id-type="doi">10.1088/1751-8121/ac219c</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Manzo</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Extreme learning machine for the characterization of anomalous diffusion from single trajectories (AnDi-ELM)</article-title>
        <source>J. Phys. Math. Theor.</source>
        <year>2021</year>
        <volume>54</volume>
        <fpage>334002</fpage>
        <pub-id pub-id-type="doi">10.1088/1751-8121/ac13dd</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Metzler</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Jeon</surname>
            <given-names>J-H</given-names>
          </name>
          <name>
            <surname>Cherstvy</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Barkai</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Anomalous diffusion models and their properties: Non-stationarity, non-ergodicity, and ageing at the centenary of single particle tracking</article-title>
        <source>Phys. Chem. Chem. Phys.</source>
        <year>2014</year>
        <volume>16</volume>
        <fpage>24128</fpage>
        <lpage>24164</lpage>
        <pub-id pub-id-type="doi">10.1039/C4CP03465A</pub-id>
        <?supplied-pmid 25297814?>
        <pub-id pub-id-type="pmid">25297814</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Muñoz-Gil</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Objective comparison of methods to decode anomalous diffusion</article-title>
        <source>Nat. Commun.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>6253</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-26320-w</pub-id>
        <?supplied-pmid 34716305?>
        <pub-id pub-id-type="pmid">34716305</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dedecker</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Duwé</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Neely</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Localizer: Fast, accurate, open-source, and modular software package for superresolution microscopy</article-title>
        <source>J. Biomed. Opt.</source>
        <year>2012</year>
        <volume>17</volume>
        <fpage>126008</fpage>
        <pub-id pub-id-type="doi">10.1117/1.JBO.17.12.126008</pub-id>
        <?supplied-pmid 23208219?>
        <pub-id pub-id-type="pmid">23208219</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Katrukha, E. A., Cloin, B., Teeuw, J. &amp; Kapitein, L. C. Detection of molecules plugin for ImageJ. Utrecht University. <ext-link ext-link-type="uri" xlink:href="https://github.com/ekatrukha/DoM_Utrecht">https://github.com/ekatrukha/DoM_Utrecht</ext-link> (2017).</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crocker</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Grier</surname>
            <given-names>DG</given-names>
          </name>
        </person-group>
        <article-title>Methods of digital video microscopy for colloidal studies</article-title>
        <source>J. Colloid Interface Sci.</source>
        <year>1996</year>
        <volume>179</volume>
        <fpage>298</fpage>
        <lpage>310</lpage>
        <pub-id pub-id-type="doi">10.1006/jcis.1996.0217</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wöll</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kölbl</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stempfle</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Karrenbauer</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A novel method for automatic single molecule tracking of blinking molecules at low intensities</article-title>
        <source>Phys. Chem. Chem. Phys.</source>
        <year>2013</year>
        <volume>15</volume>
        <fpage>6196</fpage>
        <pub-id pub-id-type="doi">10.1039/c3cp44693j</pub-id>
        <?supplied-pmid 23429424?>
        <pub-id pub-id-type="pmid">23429424</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berglund</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Statistics of camera-based single-particle tracking</article-title>
        <source>Phys. Rev. E</source>
        <year>2010</year>
        <volume>82</volume>
        <fpage>011917</fpage>
        <pub-id pub-id-type="doi">10.1103/PhysRevE.82.011917</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Michalet</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Berglund</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Optimal diffusion coefficient estimation in single-particle tracking</article-title>
        <source>Phys. Rev. E</source>
        <year>2012</year>
        <volume>85</volume>
        <fpage>061916</fpage>
        <pub-id pub-id-type="doi">10.1103/PhysRevE.85.061916</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vestergaard</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Blainey</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Flyvbjerg</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Optimal estimation of diffusion coefficients from single-particle trajectories</article-title>
        <source>Phys. Rev. E</source>
        <year>2014</year>
        <volume>89</volume>
        <fpage>022726</fpage>
        <pub-id pub-id-type="doi">10.1103/PhysRevE.89.022726</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qian</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Sheetz</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Elson</surname>
            <given-names>EL</given-names>
          </name>
        </person-group>
        <article-title>Single particle tracking. Analysis of diffusion and flow in two-dimensional systems</article-title>
        <source>Biophys. J.</source>
        <year>1991</year>
        <volume>60</volume>
        <fpage>910</fpage>
        <lpage>921</lpage>
        <pub-id pub-id-type="doi">10.1016/S0006-3495(91)82125-7</pub-id>
        <?supplied-pmid 1742458?>
        <pub-id pub-id-type="pmid">1742458</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title><italic>TXM-Wizard</italic> : A program for advanced data collection and evaluation in full-field transmission X-ray microscopy</article-title>
        <source>J. Synchrotron Radiat.</source>
        <year>2012</year>
        <volume>19</volume>
        <fpage>281</fpage>
        <lpage>287</lpage>
        <pub-id pub-id-type="doi">10.1107/S0909049511049144</pub-id>
        <?supplied-pmid 22338691?>
        <pub-id pub-id-type="pmid">22338691</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dong</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>In situ quantitative single-molecule study of dynamic catalytic processes in nanoconfinement</article-title>
        <source>Nat. Catal.</source>
        <year>2018</year>
        <volume>1</volume>
        <fpage>135</fpage>
        <lpage>140</lpage>
        <pub-id pub-id-type="doi">10.1038/s41929-017-0021-1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hellriegel</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kirstein</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bräuchle</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Tracking of single molecules as a powerful method to characterize diffusivity of organic species in mesoporous materials</article-title>
        <source>New J. Phys.</source>
        <year>2005</year>
        <volume>7</volume>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1088/1367-2630/7/1/023</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Saxton</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Dopico</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Modeling 2D and 3D diffusion</article-title>
        <source>Methods in Membrane Lipids</source>
        <year>2007</year>
        <publisher-name>Humana Press</publisher-name>
        <fpage>295</fpage>
        <lpage>321</lpage>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sage</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Super-resolution fight club: Assessment of 2D and 3D single-molecule localization microscopy software</article-title>
        <source>Nat. Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>387</fpage>
        <lpage>395</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0364-4</pub-id>
        <?supplied-pmid 30962624?>
        <pub-id pub-id-type="pmid">30962624</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Backer</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Moerner</surname>
            <given-names>WE</given-names>
          </name>
        </person-group>
        <article-title>Extending single-molecule microscopy using optical Fourier processing</article-title>
        <source>J. Phys. Chem. B</source>
        <year>2014</year>
        <volume>118</volume>
        <fpage>8313</fpage>
        <lpage>8329</lpage>
        <pub-id pub-id-type="doi">10.1021/jp501778z</pub-id>
        <?supplied-pmid 24745862?>
        <pub-id pub-id-type="pmid">24745862</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other"><italic>COMSOL multiphysics®</italic>. (COMSOL INC.).</mixed-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>James</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Witten</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <source>An Introduction to Statistical Learning</source>
        <year>2013</year>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mortensen</surname>
            <given-names>KI</given-names>
          </name>
          <name>
            <surname>Churchman</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>Spudich</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Flyvbjerg</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Optimized localization analysis for single-molecule tracking and super-resolution microscopy</article-title>
        <source>Nat. Methods</source>
        <year>2010</year>
        <volume>7</volume>
        <fpage>377</fpage>
        <lpage>381</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1447</pub-id>
        <?supplied-pmid 20364147?>
        <pub-id pub-id-type="pmid">20364147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deschout</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Neyts</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Braeckmans</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>The influence of movement on the localization precision of sub-resolution particles in fluorescence microscopy</article-title>
        <source>J. Biophotonics</source>
        <year>2012</year>
        <volume>5</volume>
        <fpage>97</fpage>
        <lpage>109</lpage>
        <pub-id pub-id-type="doi">10.1002/jbio.201100078</pub-id>
        <?supplied-pmid 22083848?>
        <pub-id pub-id-type="pmid">22083848</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schütz</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Schindler</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Single-molecule microscopy on model membranes reveals anomalous diffusion</article-title>
        <source>Biophys. J.</source>
        <year>1997</year>
        <volume>73</volume>
        <fpage>1073</fpage>
        <lpage>1080</lpage>
        <pub-id pub-id-type="doi">10.1016/S0006-3495(97)78139-6</pub-id>
        <?supplied-pmid 9251823?>
        <pub-id pub-id-type="pmid">9251823</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
