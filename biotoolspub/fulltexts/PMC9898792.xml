<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.6.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art560.dtd?>
<?SourceDTD.Version 5.6.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin publisher?>
<?FILEmeta_XPRO102069 xml ?>
<?FILEmain xml ?>
<?FILEmain pdf ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<?FILEgr3 jpg ?>
<?FILEgr4 jpg ?>
<?FILEgr5 jpg ?>
<?FILEgr6 jpg ?>
<?FILEgr7 jpg ?>
<?FILEgr8 jpg ?>
<?FILEgr9 jpg ?>
<?FILEgr10 jpg ?>
<?FILEfx1 jpg ?>
<?FILEfx2 jpg ?>
<?FILEfx3 jpg ?>
<?FILEfx4 jpg ?>
<?FILEfx5 jpg ?>
<?FILEfx6 jpg ?>
<?FILEfx7 jpg ?>
<?FILEmmc1 zip ?>
<?FILEmmc2 csv ?>
<?FILEmmc3 csv ?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">STAR Protoc</journal-id>
    <journal-id journal-id-type="iso-abbrev">STAR Protoc</journal-id>
    <journal-title-group>
      <journal-title>STAR Protocols</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2666-1667</issn>
    <publisher>
      <publisher-name>Elsevier</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9898792</article-id>
    <article-id pub-id-type="pii">S2666-1667(23)00027-8</article-id>
    <article-id pub-id-type="doi">10.1016/j.xpro.2023.102069</article-id>
    <article-id pub-id-type="publisher-id">102069</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Protocol</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ImmCellFie: A user-friendly web-based platform to infer metabolic function from omics data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="au1">
        <name>
          <surname>Masson</surname>
          <given-names>Helen O.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au2">
        <name>
          <surname>Borland</surname>
          <given-names>David</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author" id="au3">
        <name>
          <surname>Reilly</surname>
          <given-names>Jason</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author" id="au4">
        <name>
          <surname>Telleria</surname>
          <given-names>Adrian</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author" id="au5">
        <name>
          <surname>Shrivastava</surname>
          <given-names>Shalki</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">2</xref>
        <xref rid="fn1" ref-type="fn">8</xref>
      </contrib>
      <contrib contrib-type="author" id="au6">
        <name>
          <surname>Watson</surname>
          <given-names>Matt</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author" id="au7">
        <name>
          <surname>Bustillos</surname>
          <given-names>Luthfi</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author" id="au8">
        <name>
          <surname>Li</surname>
          <given-names>Zerong</given-names>
        </name>
        <xref rid="aff4" ref-type="aff">4</xref>
      </contrib>
      <contrib contrib-type="author" id="au9">
        <name>
          <surname>Capps</surname>
          <given-names>Laura</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author" id="au10">
        <name>
          <surname>Kellman</surname>
          <given-names>Benjamin P.</given-names>
        </name>
        <xref rid="aff3" ref-type="aff">3</xref>
        <xref rid="aff4" ref-type="aff">4</xref>
      </contrib>
      <contrib contrib-type="author" id="au11">
        <name>
          <surname>King</surname>
          <given-names>Zachary A.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au12">
        <name>
          <surname>Richelle</surname>
          <given-names>Anne</given-names>
        </name>
        <xref rid="aff4" ref-type="aff">4</xref>
      </contrib>
      <contrib contrib-type="author" id="au13">
        <name>
          <surname>Lewis</surname>
          <given-names>Nathan E.</given-names>
        </name>
        <email>nlewisres@ucsd.edu</email>
        <xref rid="aff1" ref-type="aff">1</xref>
        <xref rid="aff4" ref-type="aff">4</xref>
        <xref rid="fn3" ref-type="fn">10</xref>
        <xref rid="fn4" ref-type="fn">11</xref>
        <xref rid="cor1" ref-type="corresp">∗</xref>
      </contrib>
      <contrib contrib-type="author" id="au14">
        <name>
          <surname>Robasky</surname>
          <given-names>Kimberly</given-names>
        </name>
        <email>kimberly.robasky@gmail.com</email>
        <xref rid="aff2" ref-type="aff">2</xref>
        <xref rid="aff5" ref-type="aff">5</xref>
        <xref rid="aff6" ref-type="aff">6</xref>
        <xref rid="aff7" ref-type="aff">7</xref>
        <xref rid="fn2" ref-type="fn">9</xref>
        <xref rid="cor2" ref-type="corresp">∗∗</xref>
      </contrib>
      <aff id="aff1"><label>1</label>Department of Bioengineering, UC San Diego, La Jolla, CA 92093, USA</aff>
      <aff id="aff2"><label>2</label>Renaissance Computing Institute, The University of North Carolina at Chapel Hill, Chapel Hill, NC 27517, USA</aff>
      <aff id="aff3"><label>3</label>Bioinformatics and Systems Biology Program, UC San Diego, La Jolla, CA 92093, USA</aff>
      <aff id="aff4"><label>4</label>Department of Pediatrics, UC San Diego, La Jolla, CA 92093, USA</aff>
      <aff id="aff5"><label>5</label>Department of Genetics, University of North Carolina at Chapel Hill, Chapel H0069ll, NC 27514, USA</aff>
      <aff id="aff6"><label>6</label>School of Information and Library Science, University of North Carolina at Chapel Hill, Chapel Hill, NC 27599, USA</aff>
      <aff id="aff7"><label>7</label>Carolina Health and Informatics Program, University of North Carolina at Chapel Hill, Chapel Hill, NC 27599, USA</aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>∗</label>Corresponding author <email>nlewisres@ucsd.edu</email></corresp>
      <corresp id="cor2"><label>∗∗</label>Corresponding author <email>kimberly.robasky@gmail.com</email></corresp>
      <fn id="fn1">
        <label>8</label>
        <p id="ntpara0010">Present address: Lawrence Berkeley National Laboratory, Berkeley, CA, USA</p>
      </fn>
      <fn id="fn2">
        <label>9</label>
        <p id="ntpara0015">Present address: Arrakis Therapeutics, Waltham, MA, USA</p>
      </fn>
      <fn id="fn3">
        <label>10</label>
        <p id="ntpara0020">Technical contact</p>
      </fn>
      <fn id="fn4">
        <label>11</label>
        <p id="ntpara0025">Lead contact</p>
      </fn>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>25</day>
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.-->
    <pub-date pub-type="collection">
      <day>17</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>25</day>
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <volume>4</volume>
    <issue>1</issue>
    <elocation-id>102069</elocation-id>
    <permissions>
      <copyright-statement>© 2023 The Author(s)</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article under the CC BY license (http://creativecommons.org/licenses/by/4.0/).</license-p>
      </license>
    </permissions>
    <abstract id="abs0010">
      <title>Summary</title>
      <p>Understanding cellular metabolism is important across biotechnology and biomedical research and has critical implications in a broad range of normal and pathological conditions. Here, we introduce the user-friendly web-based platform ImmCellFie, which allows the comprehensive analysis of metabolic functions inferred from transcriptomic or proteomic data. We explain how to set up a run using publicly available omics data and how to visualize the results. The ImmCellFie algorithm pushes beyond conventional statistical enrichment and incorporates complex biological mechanisms to quantify cell activity.</p>
      <p>For complete details on the use and execution of this protocol, please refer to Richelle et al. (2021).<xref rid="bib1" ref-type="bibr"><sup>1</sup></xref></p>
    </abstract>
    <abstract abstract-type="graphical" id="abs0015">
      <title>Graphical abstract</title>
      <fig id="undfig1" position="anchor">
        <graphic xlink:href="fx1"/>
      </fig>
    </abstract>
    <abstract abstract-type="author-highlights" id="abs0020">
      <title>Highlights</title>
      <p>
        <list list-type="simple" id="ulist0010">
          <list-item id="u0010">
            <label>•</label>
            <p id="p0010">ImmCellFie provides a platform to infer metabolic function from omics data</p>
          </list-item>
          <list-item id="u0015">
            <label>•</label>
            <p id="p0015">Leverages GeMs to provide mechanistic insights with no special user training required</p>
          </list-item>
          <list-item id="u0020">
            <label>•</label>
            <p id="p0020">The suite of visualization tools allows users to interactively explore results</p>
          </list-item>
          <list-item id="u0025">
            <label>•</label>
            <p id="p0025">API is available to interface with ImmCellFie over HTTP via notebooks (e.g., Jupyter).</p>
          </list-item>
        </list>
      </p>
    </abstract>
    <abstract abstract-type="editor-highlights" id="abs0025">
      <p>Publisher’s note: Undertaking any experimental protocol requires adherence to local institutional guidelines for laboratory safety and ethics.</p>
    </abstract>
    <abstract abstract-type="teaser" id="abs0030">
      <p>Understanding cellular metabolism is important across biotechnology and biomedical research and has critical implications in a broad range of normal and pathological conditions. Here, we introduce the user-friendly web-based platform ImmCellFie, which allows the comprehensive analysis of metabolic functions inferred from transcriptomic or proteomic data. We explain how to set up a run using publicly available omics data and how to visualize the results. The ImmCellFie algorithm pushes beyond conventional statistical enrichment and incorporates complex biological mechanisms to quantify cell activity.</p>
    </abstract>
    <kwd-group id="kwrds0010">
      <title>Subject areas</title>
      <kwd>Bioinformatics</kwd>
      <kwd>Genomics</kwd>
      <kwd>Metabolism</kwd>
      <kwd>Systems Biology</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <title>Before you begin</title>
    <sec id="sec1.1">
      <title>Overview</title>
      <p id="p0035">Life functions through complex interdependencies between genes, proteins, and metabolites. The advent of high-throughput omic technologies have enabled researchers to comprehensively monitor these individual molecule-types; however, interpretation of such omics experiments remains challenging due to the aforementioned interdependence between molecular components. While statistical methods are invaluable for identifying sets of genes involved in a given phenotype, it remains difficult to obtain and quantify mechanisms underlying a cell’s functions from only enriched pathway and ontology terms.</p>
      <p id="p0040">Genome-scale metabolic networks<xref rid="bib2" ref-type="bibr"><sup>2</sup></xref><sup>,</sup><xref rid="bib3" ref-type="bibr"><sup>3</sup></xref> provide systems biologists with tools to analyze genome-scale omics datasets. These reconstructed networks directly link genotype to phenotype via a mathematical knowledge base of all metabolic reactions within an organism. Unfortunately, working with these models requires specialized training and extensive effort to deploy. There is a need for more accessible tools that allow any researcher to obtain similar mechanistic insights from omics data. To this end we developed CellFie,<xref rid="bib1" ref-type="bibr"><sup>1</sup></xref> an approach that leverages 195 metabolic tasks identified in mammalian cells using genome-scale metabolic models, and enables one to overlay transcriptomic and proteomic data to quantify activity changes in each metabolic task. These metabolic tasks are organized into a hierarchical structure of systems and subsystems, grouping tasks based on their biological functions. For detailed descriptions of the tasks and associated references, we point users to the original publication: Richelle et al.<xref rid="bib1" ref-type="bibr"><sup>1</sup></xref> (in particular Table S1 in Richelle et al.). Exhaustive description of the curated list of metabolic tasks). Using the CellFie platform, researchers have studied the metabolic impacts of many systems, including perturbing renal drug transporters,<xref rid="bib4" ref-type="bibr"><sup>4</sup></xref> and identifying metabolic tasks perturbed in Alzheimer’s disease.<xref rid="bib1" ref-type="bibr"><sup>1</sup></xref></p>
      <p id="p0045">ImmCellFie (<ext-link ext-link-type="uri" xlink:href="http://immcellfie.renci.org" id="intref0010">immcellfie.renci.org</ext-link>), presented here, was developed as a web-based platform to house the CellFie package, enabling any scientist, regardless of computational background, to directly predict, quantify, and visualize how changes in omics experiments correspond to the metabolic functions of cells or tissues. Users can easily import proteomic or transcriptomic data and use the provided suite of analytical and interactive visualization tools to explore the metabolic activity of their dataset. The protocol presented here describes how to use ImmCellFie to infer metabolic capabilities from omics data and visualize the complex mechanisms driving metabolic phenotypes. RNA-Seq data from the Human Protein Atlas (HPA) is used as a case-study for this goal.</p>
      <p id="p0050">ImmCellfie uses genome-scale metabolic models (GeMs) to quantify metabolic task activity from omics data. The algorithm precomputes metabolic pathway activities involving thousands of metabolic reactions<xref rid="bib5" ref-type="bibr"><sup>5</sup></xref><sup>,</sup><xref rid="bib6" ref-type="bibr"><sup>6</sup></xref><sup>,</sup><xref rid="bib7" ref-type="bibr"><sup>7</sup></xref> to find gene modules (“metabolic tasks”) that collectively consume a metabolite to produce a final metabolic product of interest.<xref rid="bib8" ref-type="bibr"><sup>8</sup></xref> When transcriptomic or proteomic data are overlaid on the precomputed modules, pathway activities are estimated for each sample. Complementing current enrichment analyses, CellFie quantifies a gene set’s impact on the cell by mathematically defining the function of all genes and determining the expression requirements to accomplish metabolic tasks (see the <xref rid="sec1.3" ref-type="sec">understanding metabolic task calculation</xref> for detailed description of task score calculations). ImmCellfie supports several model organisms including human, mouse, rat, and Chinese hamster (CHO). In this protocol we show how users can conduct rich analyses of omics data with the click of a button, by uploading data, submitting customized jobs, and exploring the results with useful tools and richly annotated scientific visualizations including heatmaps, Voronoi treemaps, and interactive pathway maps.</p>
    </sec>
    <sec id="sec1.2">
      <title>Software download and prerequisites</title>
      <p id="p0055">ImmCellfie can either be operated via the web dashboard (<ext-link ext-link-type="uri" xlink:href="http://immcellfie.renci.org" id="intref0015">immcellfie.renci.org</ext-link>) or through an OpenAPI application programming interface (API). The API can be used for running data in batch and for integrating with notebooks (e.g., Jupyter, Google Colab) (<xref rid="fig9" ref-type="fig">Figure 9</xref>). For documentation on interfacing with the API, see <ext-link ext-link-type="uri" xlink:href="http://immcellfie.renci.org:8081/docs" id="intref0020">http://immcellfie.renci.org:8081/docs</ext-link>. The protocol presented here describes the steps for running ImmCellFie via the web dashboard. Here, we provide specific instructions for preprocessing the HPA example expression data in R prior to running ImmCellFie. However, this preprocessing step can be performed using any programming language and/or online gene-mapping web tool as long as the end result meets ImmCellFie formatting requirements. The easiest option to follow the preprocessing steps outlined in this tutorial is to use RStudio. Both R and RStudio can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://www.r-project.org/" id="intref0025">https://www.r-project.org/</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://rstudio.com/products/rstudio/download/" id="intref0030">https://rstudio.com/products/rstudio/download/</ext-link>, respectively.</p>
    </sec>
    <sec id="sec1.3">
      <title>Understanding metabolic task calculation</title>
      <p id="p0060">Metabolic tasks are defined by the capacity to produce a defined list of output products when only a defined list of input substrates is available. For each available reference GeM, we define a list of tasks supported by the model. Then the reactions required to complete each task are identified. Based on the model’s gene-protein-reaction (GPR) rules, we link the task with genes contributing to the metabolic function. CellFie predicts the relative activity of each task using the expression level of the associated gene set by first attributing a gene score to each expressed gene in the model.<disp-formula id="ufd1"><mml:math id="M1" altimg="si1.gif"><mml:mrow><mml:mi>G</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.25em"/><mml:mi>S</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>5</mml:mn><mml:mo>∗</mml:mo><mml:mi mathvariant="italic">log</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo linebreak="badbreak">+</mml:mo><mml:mfrac><mml:mrow><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.25em"/><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <p id="p0065">The computation of the Gene Score required one to define a threshold that specifies whether a gene is expressed or not. One can use multiple options to define the gene threshold (see section <italic>Threshold Definition</italic> for more details).<xref rid="bib9" ref-type="bibr"><sup>9</sup></xref> Gene Scores are mapped to the GeM via parsing of the GPR rule associated with each reaction: select the minimum expression amongst all the genes associated with an enzyme complex (AND rule) and the maximum expression amongst all the genes associated with an isozyme (OR rule).<xref rid="bib10" ref-type="bibr"><sup>10</sup></xref> As a result, each reaction is assigned a reaction activity level (RAL) equal to the gene score of the main determinant of the reaction.<disp-formula id="ufd2"><mml:math id="M2" altimg="si2.gif"><mml:mrow><mml:mi>A</mml:mi><mml:mspace width="0.25em"/><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:mi>B</mml:mi><mml:mspace width="0.25em"/><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:mi>C</mml:mi><mml:mspace width="0.25em"/><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>X</mml:mi><mml:mspace width="0.25em"/><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.25em"/><mml:mi>Y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.25em"/><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Q</mml:mi><mml:mspace width="0.25em"/><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.25em"/><mml:mi>R</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="ufd3"><mml:math id="M3" altimg="si3.gif"><mml:mrow><mml:msub><mml:mo>↓</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mi mathvariant="italic">min</mml:mi><mml:mo>:</mml:mo><mml:mi>Y</mml:mi><mml:mo linebreak="goodbreak">&lt;</mml:mo><mml:mi>X</mml:mi><mml:mo>;</mml:mo><mml:mspace width="0.25em"/><mml:mi>Q</mml:mi><mml:mo linebreak="goodbreak">&lt;</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:math></disp-formula><disp-formula id="ufd4"><mml:math id="M4" altimg="si4.gif"><mml:mrow><mml:mi>A</mml:mi><mml:mspace width="0.25em"/><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:mi>B</mml:mi><mml:mspace width="0.25em"/><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:mi>C</mml:mi><mml:mspace width="0.25em"/><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.25em"/><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mi>Q</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="ufd5"><mml:math id="M5" altimg="si5.gif"><mml:mrow><mml:msub><mml:mo>↓</mml:mo><mml:mrow><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mi mathvariant="italic">max</mml:mi><mml:mo>:</mml:mo><mml:mi>C</mml:mi><mml:mo linebreak="goodbreak">&gt;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Q</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="ufd6"><mml:math id="M6" altimg="si6.gif"><mml:mrow><mml:mi>C</mml:mi><mml:mspace width="0.25em"/><mml:mo>⇒</mml:mo><mml:mspace width="0.25em"/><mml:mi>R</mml:mi><mml:mi>A</mml:mi><mml:mi>L</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.25em"/><mml:mi>S</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p>
      <p id="p0070">We account for the competition of promiscuous enzymes/genes (i.e., genes used in multiple reactions) by scaling each gene with a specificity score (S).<disp-formula id="ufd7"><mml:math id="M7" altimg="si7.gif"><mml:mrow><mml:mi>S</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mo>#</mml:mo><mml:mspace width="0.25em"/><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>k</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.25em"/><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.25em"/><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.25em"/><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.25em"/><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.25em"/><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p>
      <p id="p0075">Finally, the metabolic task score (MTS) can be computed as the mean scaled reaction activity level.<disp-formula id="ufd8"><mml:math id="M8" altimg="si8.gif"><mml:mrow><mml:mi>M</mml:mi><mml:mi>T</mml:mi><mml:mi>S</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mfrac><mml:mrow><mml:mo>∑</mml:mo><mml:mi>S</mml:mi><mml:mo>∗</mml:mo><mml:mi>R</mml:mi><mml:mi>A</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mo>#</mml:mo><mml:mspace width="0.25em"/><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.25em"/><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.25em"/><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.25em"/><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p>
      <p id="p0080">Some important housekeeping genes are always present at very low expression values, therefore metabolic tasks that will solely rely on these types of genes will always result in a low MTS. In contrast, some tasks are associated with highly expressed genes. This is the reason why tasks should not be compared within the same sample using the quantitative score value. To facilitate intra-sample comparison of tasks, we also modify this scoring approach to a binary form defining tasks as either active or inactive. To this end, a metabolic task is considered active if the average of its associated RAL is greater than 5∗log(2).</p>
    </sec>
    <sec id="sec1.4">
      <title>Defining gene thresholds</title>
      <p id="p0085">We propose two thresholding approaches to define which genes from the input expression data are considered “active”.<xref rid="bib9" ref-type="bibr"><sup>9</sup></xref><list list-type="simple" id="olist0010"><list-item id="o0010"><label>1.</label><p id="p0090">Global approach, the threshold value is the same for all the genes. The global approach is mainly applied when only one sample is available (i.e., sample could be associated to a condition, a cell-type or a tissue) and/or no information is available in the literature to define expression threshold for a single gene. The user can define the global threshold using a value or a percentile.<list list-type="simple" id="olist0015"><list-item id="o0015"><label>a.</label><p id="p0095">value: the user provides a set value above which a gene will be considered active.</p></list-item><list-item id="o0020"><label>b.</label><p id="p0100">percentile: the threshold value will be defined based on a percentile (defined by the user) of the distribution of expression values for all the genes and across all samples of the user dataset.</p></list-item></list></p></list-item><list-item id="o0025"><label>2.</label><p id="p0105">Local approach, the threshold value is gene-specific. The local approach is often applied when multiple samples are available as it enables a relative assessment of the activity of a gene across samples. Multiple options are available to compute the local thresholds:<list list-type="simple" id="olist0020"><list-item id="o0030"><label>a.</label><p id="p0110">mean: the threshold for a gene is defined as the mean expression value of this gene across all the samples, tissues, or conditions.</p></list-item><list-item id="o0035"><label>b.</label><p id="p0115">min-max mean: the threshold for a gene is determined by the mean of expression values observed for that gene among all the samples, tissues, or conditions, but the threshold: (i) must be higher or equal to a lower bound and (ii) must be lower or equal to an upper bound. The lower and upper bound can be defined using a value introduced by the user or based on a percentile of the distribution of expression values for all the genes and across all samples in the dataset. The MinMaxMean option ensures that genes with very low expression values across all the samples will never be considered as active and genes with very high expression across samples are always considered as active.</p></list-item></list></p></list-item></list></p>
    </sec>
  </sec>
  <sec id="sec8">
    <title>Key resources table</title>
    <p id="p0930">
      <table-wrap position="float" id="undtbl1">
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th>REAGENT or RESOURCE</th>
              <th>SOURCE</th>
              <th>IDENTIFIER</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="3">
                <bold>Deposited data</bold>
              </td>
            </tr>
            <tr>
              <td colspan="3">
                <hr/>
              </td>
            </tr>
            <tr>
              <td>RNA HPA blood cell sample gene data (rna_blood_cell_sample.tsv.zip)</td>
              <td>HPA</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://www.proteinatlas.org/about/download" id="intref0115">https://www.proteinatlas.org/about/download</ext-link>
              </td>
            </tr>
            <tr>
              <td>demo_expression.csv</td>
              <td>This manuscript</td>
              <td>N/A</td>
            </tr>
            <tr>
              <td>demo_pheno.csv</td>
              <td>This manuscript</td>
              <td>N/A</td>
            </tr>
            <tr>
              <td colspan="3">
                <hr/>
              </td>
            </tr>
            <tr>
              <td colspan="3">
                <bold>Software and algorithms</bold>
              </td>
            </tr>
            <tr>
              <td colspan="3">
                <hr/>
              </td>
            </tr>
            <tr>
              <td>ImmCellFie</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="http://immcellfie.renci.org" id="intref0120">http://immcellfie.renci.org</ext-link>
              </td>
              <td>This manuscript</td>
            </tr>
            <tr>
              <td>R</td>
              <td>R Core Team<xref rid="bib11" ref-type="bibr"><sup>11</sup></xref></td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://www.R-project.org/" id="intref0125">https://www.R-project.org/</ext-link>
              </td>
            </tr>
            <tr>
              <td>data.table</td>
              <td>Dowle and Srinivasan<xref rid="bib12" ref-type="bibr"><sup>12</sup></xref></td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=data.table" id="intref0130">https://CRAN.R-project.org/package=data.table</ext-link>
              </td>
            </tr>
            <tr>
              <td>Dplyr</td>
              <td>Wickham et al.<xref rid="bib13" ref-type="bibr"><sup>13</sup></xref></td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=dplyr" id="intref0135">https://CRAN.R-project.org/package=dplyr</ext-link>
              </td>
            </tr>
            <tr>
              <td>Tidyr</td>
              <td>Wickham and Girlich<xref rid="bib14" ref-type="bibr"><sup>14</sup></xref></td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=tidyr" id="intref0140">https://CRAN.R-project.org/package=tidyr</ext-link>
              </td>
            </tr>
            <tr>
              <td>AnnotationDbi</td>
              <td>Pagès et al.<xref rid="bib15" ref-type="bibr"><sup>15</sup></xref></td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.18129/B9.bioc.AnnotationDbi" id="intref0145">https://doi.org/10.18129/B9.bioc.AnnotationDbi</ext-link>
              </td>
            </tr>
            <tr>
              <td>org.Hs.eg.db</td>
              <td>Carlson<xref rid="bib16" ref-type="bibr"><sup>16</sup></xref></td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.18129/B9.bioc.org.Hs.eg.db" id="intref0150">https://doi.org/10.18129/B9.bioc.org.Hs.eg.db</ext-link>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </p>
  </sec>
  <sec id="sec2">
    <title>Step-by-step method details</title>
    <sec id="sec2.1">
      <title>Create an account with ImmCellFie</title>
      <p id="p0120">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx2.gif"/>
            <bold>Timing: 30 s</bold>
          </p>
        </disp-quote>
      </p>
      <p id="p0125">User accounts link imported datasets with CellFie results that users can return to and share with colleagues.<list list-type="simple" id="olist0025"><list-item id="o0040"><label>1.</label><p id="p0130">Navigate to the ImmCellFie home page: <ext-link ext-link-type="uri" xlink:href="http://immcellfie.renci.org" id="intref0035">http://immcellfie.renci.org</ext-link>.</p></list-item><list-item id="o0045"><label>2.</label><p id="p0135">Click on the ‘User’ tab at the top of the page (<xref rid="fig1" ref-type="fig">Figure 1</xref>).</p></list-item><list-item id="o0050"><label>3.</label><p id="p0140">Enter your email address as username.</p></list-item></list><disp-quote><p><inline-graphic xlink:href="fx3.gif"/><bold>CRITICAL:</bold> ImmCellFie accounts are NOT password protected. Imported data will be publicly available on the server to other ImmCellFie users with access to your username. Please ensure that no Protected Health Information (PHI) or business sensitive data are imported. Also take care with uploading unpublished data. For private or sensitive data we recommend locally installing and running CellFie.</p></disp-quote></p>
    </sec>
    <sec id="sec2.2">
      <title>Preparing ImmCellFie input files</title>
      <p id="p0145">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx2.gif"/>
            <bold>Timing: 5–10 min</bold>
          </p>
        </disp-quote>
      </p>
      <p id="p0150">ImmCellFie requires a specific format for input data. Expression data must meet the following format requirements: i) entrez gene IDs in the first column, ii) wide format (each subsequent column contains the expression data for individual samples), iii) uploaded as csv, and iv) optional header in the first row with sample names. Users also have the option to include a properties file containing phenotypic information to group samples. This file must: i) include a header with property names (e.g., sex, cell type, treatment, etc.), ii) match row order to the sample order (columns) in the expression data, iii) uploaded as csv. Input data needs to be pre-processed to meet these formatting requirements. The following steps outline how the HPA blood expression data was pre-processed in R.<list list-type="simple" id="olist0030"><list-item id="o0055"><label>4.</label><p id="p0155">Download the expression data from HPA as a zip folder and save into a directory of your choice.</p></list-item><list-item id="o0060"><label>5.</label><p id="p0160">Open RStudio.</p></list-item><list-item id="o0065"><label>6.</label><p id="p0165">Load the required library packages.</p></list-item></list><boxed-text id="dtbox1"><p id="p0170">&gt; library(data.table)</p><p id="p0175">&gt; library(dplyr)</p><p id="p0180">&gt; library(tidyr)</p><p id="p0185">&gt; library(AnnotationDbi)</p><p id="p0190">&gt; library(org.Hs.eg.db)</p></boxed-text><list list-type="simple" id="olist0035"><list-item id="o0070"><label>7.</label><p id="p0195">Load HPA data.</p></list-item></list><boxed-text id="dtbox2"><p id="p0200">&gt; blood.data &lt;- fread(paste('unzip -p', 'Blood_Atlas_Data/rna_blood_cell_sample.tsv.zip'))</p></boxed-text><disp-quote><p><bold><italic>Note:</italic></bold> We have created a folder called ‘Blood_Atlas_Data’ as our directory of choice in this example. Ensure that your RStudio working directory is set to the same location that houses this Blood_Atlas_Data folder.</p></disp-quote><list list-type="simple" id="olist0040"><list-item id="o0075"><label>8.</label><p id="p0205">Generate expression matrix compatible with CellFie.<list list-type="simple" id="olist0045"><list-item id="o0080"><label>a.</label><p id="p0210">Isolate expression data and reshape the data such that rows are samples and columns are genes.<boxed-text id="dtbox3"><p id="p0215">&gt; TPM.matrix &lt;- blood.data[, c("ENSG ID", "Sample ID", "TPM")] %&gt;% spread(‘Sample ID’, TPM)</p></boxed-text></p></list-item><list-item id="o0085"><label>b.</label><p id="p0225">Convert Ensembl gene IDs to entrez IDs.<boxed-text id="dtbox5"><p id="p0230">&gt; gene.map &lt;- AnnotationDbi::select(org.Hs.eg.db, keys=TPM.matrix$`ENSG ID’, columns=c("ENTREZID"), keytype="ENSEMBL") %&gt;% na.omit()</p><p id="p0235">&gt; TPM.matrix.entrez &lt;- left_join(gene.map, TPM.matrix, by=c("ENSEMBL"="ENSG ID")) %&gt;% dplyr::select(-ENSEMBL)</p></boxed-text></p></list-item><list-item id="o0090"><label>c.</label><p id="p0250">Aggregate duplicate genes by max value.<boxed-text id="dtbox7"><p id="p0255">&gt; TPM.entrez.max &lt;- aggregate(TPM.matrix.entrez, by=list((TPM.matrix.entrez[,1])),max) %&gt;% dplyr::select(-Group.1)</p></boxed-text></p></list-item><list-item id="o0095"><label>d.</label><p id="p0265">Add pseudo count.<boxed-text id="dtbox9"><p id="p0270">&gt; TPM.entrez.pseudo &lt;- cbind(ENTREZID=TPM.entrez.max$ENTREZID, TPM.entrez.max[, 2:ncol(TPM.entrez.max)] + 0.00001)</p></boxed-text></p></list-item></list></p></list-item></list><list list-type="simple" id="olist0050"><list-item id="o0100"><label>9.</label><p id="p0280">Generate properties data matrix (phenotypic information for the samples).</p></list-item></list><boxed-text id="dtbox11"><p id="p0285">&gt; pheno.data &lt;- dplyr::select(blood.data, c("Sample ID", "Donor", "Immune cell")) %&gt;% distinct()</p></boxed-text><list list-type="simple" id="olist0055"><list-item id="o0105"><label>10.</label><p id="p0290">Export files.</p></list-item></list><boxed-text id="dtbox12"><p id="p0295">&gt; fwrite(TPM.entrez.pseudo, "demo_expression.csv")</p><p id="p0300">&gt; fwrite(pheno.data, "demo_pheno.csv")</p></boxed-text><disp-quote><p><bold><italic>Note:</italic></bold> We have provided an R Markdown (RMD) file with the complete code to preprocess these files (<xref rid="mmc1" ref-type="supplementary-material">File S1</xref>). The end result of these steps is the generation of two CSV files: demo_expression.csv and demo_pheno.csv. Users are free to use any platform to process files to obtain CSV files. If users wish to avoid using R in this tutorial, they can skip this step and use the provided processed files (<xref rid="mmc2" ref-type="supplementary-material">Files S2</xref> and <xref rid="mmc3" ref-type="supplementary-material">S3</xref>) to follow along with the rest of the tutorial.</p></disp-quote><disp-quote><p><bold><italic>Alternatives:</italic></bold> CSV files can also be generated using spreadsheet programs, such as Microsoft Excel, to make tables that match the layouts of demo_expression.csv and demo_pheno.csv, and save the spreadsheets in CSV format.</p></disp-quote></p>
    </sec>
    <sec id="sec2.3">
      <title>Import data to ImmCellFie</title>
      <p id="p0305">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx2.gif"/>
            <bold>Timing: seconds</bold>
          </p>
        </disp-quote>
      </p>
      <p id="p0310">ImmCellFie allows users to import data in two ways: i) locally from a personal computer and ii) remotely from <ext-link ext-link-type="uri" xlink:href="http://ImmuneSpace.org" id="intref0040">ImmuneSpace.org</ext-link>. Here we will be importing the expression data and properties document saved locally from the previous step. <xref rid="sec5.1" ref-type="sec">Troubleshooting 1</xref>.<list list-type="simple" id="olist0060"><list-item id="o0110"><label>11.</label><p id="p0315">Click ‘Select data’ below your newly entered user name, or click on the ‘Data’ tab on the ImmCellFie Dashboard. Click on ‘Upload local files’. A pop-up will appear with detailed formatting instructions.</p></list-item><list-item id="o0115"><label>12.</label><p id="p0320">Upload the csv files generated from the previous steps: demo_expression.csv and demo_pheno.csv.</p></list-item><list-item id="o0120"><label>13.</label><p id="p0325">Annotate the data set as “ImmCellFie Demo” in the ‘Description (optional)’ box.</p></list-item><list-item id="o0125"><label>14.</label><p id="p0330">Click ‘Upload’ to submit the data set. A pop up will appear indicating that the data has been successfully uploaded to your account.</p></list-item></list><disp-quote><p><bold><italic>Alternatives:</italic></bold> Users have the option to import data remotely from the ImmuneSpace database: <ext-link ext-link-type="uri" xlink:href="https://www.immunespace.org/" id="intref0045">https://www.immunespace.org/</ext-link>. While a complete tutorial of the ImmuneSpace database is beyond the scope of this protocol, navigating their website is quite self-explanatory. To import data groups from your ImmuneSpace account, simply click on ‘ImmuneSpace’ rather than ‘Upload local files’ from the ImmCellFie Data page and follow the detailed instructions (hover over the question marks) to connect your custom ImmuneSpace group with ImmCellFie. For this you will need to obtain an API Key from ImmuneSpace and identify Group Labels for the data you wish to use.</p></disp-quote></p>
    </sec>
    <sec id="sec2.4">
      <title>Run CellFie algorithm</title>
      <p id="p0335">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx2.gif"/>
            <bold>Timing: 9 min (can be longer for larger datasets)</bold>
          </p>
        </disp-quote>
      </p>
      <p id="p0340">The CellFie algorithm presents a powerful approach to predict the activity of many metabolic functions from transcriptomic and proteomic data. This framework facilitates phenotypic interpretation from these complex omic data types by comprehensively quantifying the propensity of a cell line or tissue to express the molecular components underlying a set of metabolic functions. Metabolic task scores can be computed based on any type of transcriptomic (e.g., microarray or RNA-Seq, bulk or single cell) or proteomic dataset for CHO, human, rat, or mouse. Additionally, users can select various types of gene-expression thresholding methods. <xref rid="sec5.3" ref-type="sec">Troubleshooting 2</xref>.<list list-type="simple" id="olist0065"><list-item id="o0130"><label>15.</label><p id="p0345">The previous step merely uploaded data to your ImmCellFie account. Next you will load the dataset as input to the CellFie algorithm (<xref rid="fig2" ref-type="fig">Figure 2</xref>A).<list list-type="simple" id="olist0070"><list-item id="o0135"><label>a.</label><p id="p0350">If the pop-up window is still open, you can click on the ‘Load’ button at the bottom right. Alternatively, you can navigate to the Data page from the ImmCellFie Dashboard and click the ‘Load’ button to the right of the ImmCellFie Demo dataset.</p></list-item></list><fig id="fig1"><label>Figure 1</label><caption><p>Setting up a user account with ImmCellFie</p><p>Screenshots showing how users create an account (or login in with a pre-existing account) with ImmCellFie.</p></caption><graphic xlink:href="gr1"/></fig><fig id="fig2"><label>Figure 2</label><caption><p>Setting up a CellFie run</p><p>Series of screenshots demonstrating various steps of setting up a CellFie run in ImmCellFie.</p><p>(A) Load input data.</p><p>(B) Two methods of navigating to the CellFie setup page.</p><p>(C) Setting CellFie parameters (red box) and starting a run.</p></caption><graphic xlink:href="gr2"/></fig></p></list-item></list><disp-quote><p><bold><italic>Note:</italic></bold> The dashboard should now read ‘ImmCellFie Demo’ under ‘Input’.</p></disp-quote><list list-type="simple" id="olist0075"><list-item id="o0140"><label>16.</label><p id="p0355">Click ‘Analyze’ from the ImmCellFie Dashboard, and select ‘CellFie’ from the drop-down menu. Alternatively, users may click on ‘Analyze’, followed by ‘CellFie’ (<xref rid="fig2" ref-type="fig">Figure 2</xref>B).</p></list-item><list-item id="o0145"><label>17.</label><p id="p0360">The left side of the page contains the necessary parameters for running a CellFie analysis. Select ‘human’ from the ‘Organism’ drop-down menu.<list list-type="simple" id="olist0080"><list-item id="o0150"><label>a.</label><p id="p0365">This will automatically select the correct human model ‘recon v2.2’.</p></list-item></list></p></list-item><list-item id="o0155"><label>18.</label><p id="p0370">CellFie provides two thresholding strategies to determine the set of “active” genes in the input dataset. The global approach is mainly applied when only one sample is available; therefore we will be using the gene-specific local gene thresholding approach in this example. Select ‘local’ from the ‘Threshold type’ drop-down menu and keep the default local thresholding parameters. See <xref rid="sec1.4" ref-type="sec">defining gene thresholds</xref> section for detailed descriptions of the thresholding approaches.<list list-type="simple" id="olist0085"><list-item id="o0160"><label>a.</label><p id="p0375">Percentile or value: percentile.</p></list-item><list-item id="o0165"><label>b.</label><p id="p0380">Local threshold type: min-max mean.</p></list-item><list-item id="o0170"><label>c.</label><p id="p0385">Low percentile: 25.</p></list-item><list-item id="o0175"><label>d.</label><p id="p0390">High percentile: 75.</p></list-item></list></p></list-item><list-item id="o0180"><label>19.</label><p id="p0395">Add the optional description “demo-results” in the ‘Description’ box. <xref rid="sec5.5" ref-type="sec">Troubleshooting 3</xref>.</p></list-item><list-item id="o0185"><label>20.</label><p id="p0400">Click ‘Run CellFie’. A pop-up window will appear with an estimate of how long the run will take. After exiting the pop-up, the ImmCellFie dashboard will continue to display a tiny spinning wheel on the far right to indicate that the run is computing (<xref rid="fig2" ref-type="fig">Figure 2</xref>C).</p></list-item><list-item id="o0190"><label>21.</label><p id="p0405">When the run is complete, click ‘Load’ from the popup window to load the CellFie results. Alternatively, users can load results by navigating to the Data page from the ImmCellFie Dashboard and use the load button to the right of the CellFie run. <xref rid="sec5.7" ref-type="sec">Troubleshooting 4</xref>.</p></list-item></list><disp-quote><p><bold><italic>Note:</italic></bold> The dashboard should now read ‘demo-results’ under ‘Result’.</p></disp-quote></p>
    </sec>
    <sec id="sec2.5">
      <title>Download CellFie results</title>
      <p id="p0410">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx2.gif"/>
            <bold>Timing: seconds</bold>
          </p>
        </disp-quote>
      </p>
      <p id="p0415">Users can download the raw output of a CellFie run. These results can be further analyzed by the user using their platform of choice. The raw output of CellFie includes 4 files (<xref rid="tbl1" ref-type="table">Table 1</xref>). Briefly, the main output of CellFie is a matrix of metabolic task scores (MTSs). The MTS output of CellFie provides a quantification of each metabolic function within the samples. Due to the nature of how MTSs are calculated, scores should not be compared across tasks (within a sample) but only across samples. To facilitate intra-sample comparison of tasks, CellFie also calculates MTSs in a binary form, which simply applies a task-specific threshold to determine whether the task is active or not. This binary form of MTSs provides a “pass” vs “fail” report of metabolic activity.<list list-type="simple" id="olist0090"><list-item id="o0195"><label>22.</label><p id="p0420">Use the ‘Downloads’ button <inline-graphic xlink:href="fx4.gif"/> at the top of the CellFie Results track to batch-download all the results.</p></list-item></list><disp-quote><p><bold><italic>Note:</italic></bold> The score matrices do not contain row or column headers. Row labels for the score matrices (score.csv and scoreBinary.csv) are provided in a separate matrix file (taskInfo.csv), and the column order of the score matrices correspond to the order of samples provided in the input expression file. Appending row labels and headers can be easily done in any spreadsheet software (e.g., Microsoft Excel, Google Sheets, etc.).</p></disp-quote><table-wrap position="float" id="tbl1"><label>Table 1</label><caption><p>Description of CellFie results included in batch-download</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Results file</th><th>Description</th></tr></thead><tbody><tr><td>score.csv</td><td>Matrix of task scores. Rows correspond to individual tasks and columns correspond to samples.</td></tr><tr><td>scoreBinary.csv</td><td>Matrix of binary task score activity (1 = active, 0 = inactive). Rows correspond to individual tasks and columns correspond to samples.</td></tr><tr><td>taskInfo.csv</td><td>Table linking tasks to their respective metabolic pathways systems and subsystems. This is used to map rows of the score matrices to their respective tasks.</td></tr><tr><td>detailScoring.csv</td><td>Detailed description of genes and reactions used to calculate task scores for every sample:<list list-type="simple" id="ulist0015"><list-item id="u0030"><label>•</label><p id="p0960">Column 1: ID of the sample</p></list-item><list-item id="u0035"><label>•</label><p id="p0965">Column 2: ID of the metabolic task</p></list-item><list-item id="u0040"><label>•</label><p id="p0970">Column 3: Task score for this sample</p></list-item><list-item id="u0045"><label>•</label><p id="p0975">Column 4: Binary task score for this sample</p></list-item><list-item id="u0050"><label>•</label><p id="p0980">Column 5: Essential reaction associated with this task</p></list-item><list-item id="u0055"><label>•</label><p id="p0985">Column 6: Expression score associated with the reaction listed in column 5 (i.e., RAL -Reaction Activity Level)</p></list-item><list-item id="u0060"><label>•</label><p id="p0990">Column 7: Gene used to determine the expression of the reaction in column 5</p></list-item><list-item id="u0065"><label>•</label><p id="p0995">Column 8: Original expression value of the gene listed in column 7 Information is concatenated horizontally therefore columns 9–16 will contain information for sample 2, columns 17–24 will contain information for sample 3, etc.</p></list-item></list></td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="sec2.6">
      <title>Use properties data to generate subgroups based on cell type</title>
      <p id="p0425">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx2.gif"/>
            <bold>Timing: seconds to minutes</bold>
          </p>
        </disp-quote>
      </p>
      <p id="p0430">Users can generate subgroups based on information (columns) provided in the properties document. This enables users to explore meaningful comparisons between various groups of samples.<list list-type="simple" id="olist0095"><list-item id="o0200"><label>23.</label><p id="p0435">Click ‘Create subgroups’ from the ‘Select Subgroups to Compare’ box on the bottom left of the screen. Alternatively, users can navigate to the Subgroups page from the ImmCellFie Dashboard.<list list-type="simple" id="olist0100"><list-item id="o0205"><label>a.</label><p id="p0440">This page contains statistics for each data grouping based on the columns provided in the properties document: Sample ID, Donor, and Immune cell. So far the only existing group is ‘All samples’.</p></list-item></list></p></list-item><list-item id="o0210"><label>24.</label><p id="p0445">Split the data into subgroups based on cell type provided in the properties document (<xref rid="fig3" ref-type="fig">Figure 3</xref>A).<list list-type="simple" id="olist0105"><list-item id="o0215"><label>a.</label><p id="p0450">Click on the button below ‘Immune cell’ to split the data into subgroups. You should now see grouping statistics for each cell type in the dataset (MAIT T-cell, NK-cell, T-reg, basophil, etc.).</p></list-item></list><fig id="fig3"><label>Figure 3</label><caption><p>Creating subgroups based on immune cell type</p><p>Series of screenshots demonstrating how to create subgroups.</p><p>(A) Creating subgroups based on columns from the properties document upload.</p><p>(B) Example of creating a custom subgroup.</p></caption><graphic xlink:href="gr3"/></fig></p></list-item><list-item id="o0220"><label>25.</label><p id="p0455">Group cell types into granulocytes, monocytes, dendritic cells, B-cells, and T-cell custom subgroups.<list list-type="simple" id="olist0110"><list-item id="o0225"><label>a.</label><p id="p0460">Click on ‘Add subgroup’ at the bottom of the Subgroups page.</p></list-item><list-item id="o0230"><label>b.</label><p id="p0465">Name the subgroup ‘’Granulocytes”.</p></list-item><list-item id="o0235"><label>c.</label><p id="p0470">Use your mouse to select basophil, eosinophil, and neutrophil from the Immune Cell bar plot (<xref rid="fig3" ref-type="fig">Figure 3</xref>B).</p></list-item><list-item id="o0240"><label>d.</label><p id="p0475">Repeat step a-c to create custom groups for i) “Monocytes”: classical monocyte, intermediate monocyte, and non-classical monocyte, ii) “Dendritic Cells”: myeloid DC and plasmacytoid DC, iii)”B cells”: memory B-cell and naive B-cell, and iv) “T Cells”: MAIT T-cell, T-reg, gdT-cell, memory CD4 T-cell, memory CD8 T-cell, naive CD4 T-cell, and naive CD8 T-cell.</p></list-item></list></p></list-item><list-item id="o0245"><label>26.</label><p id="p0480">Return the results page by clicking on ‘Analyze’ &gt;&gt; ‘CellFie’ from the ImmCellFie Dashboard.</p></list-item></list><disp-quote><p><bold><italic>Note:</italic></bold> Dividing the data into subgroups may take a few seconds. Do not click multiple times as this will generate multiple copies of the same groupings.</p></disp-quote><disp-quote><p><bold><italic>Note:</italic></bold> Users can navigate to the Subgroups page from the ImmCellFie dashboard at any time to view and generate subgroups for comparison.</p></disp-quote></p>
    </sec>
    <sec id="sec2.7">
      <title>Explore activity scores within the CellFie hierarchy</title>
      <p id="p0485">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx2.gif"/>
            <bold>Timing: minutes</bold>
          </p>
        </disp-quote>
      </p>
      <p id="p0490">CellFie tasks are organized into a hierarchical structure of system and subsystems, grouping tasks based on their biological functions. ImmCellFie provides various interactive tools for users to explore and visualize scores at various depths within the CellFie hierarchy.<list list-type="simple" id="olist0115"><list-item id="o0250"><label>27.</label><p id="p0495">Click the ‘Tree’ tab from the CellFie Results (<xref rid="fig4" ref-type="fig">Figure 4</xref>).<list list-type="simple" id="olist0120"><list-item id="o0255"><label>a.</label><p id="p0500">By default the first two subgroups will be selected for comparison: MAIT T-cell and NK-cell.</p></list-item><list-item id="o0260"><label>b.</label><p id="p0505">This interactive tool shows the architecture of the Cellfie hierarchy linking tasks to their respective systems and subsystems, while including annotations of the score (continuous) and activity (binary) results. Users can click on various hierarchy elements to expand/shrink layers.</p></list-item></list><fig id="fig4"><label>Figure 4</label><caption><p>Treemap tool</p><p>The interactive treemap tool allows users to explore the CellFie Hierarchy. Users can click on various levels of the hierarchy to expand/shrink layers.</p></caption><graphic xlink:href="gr4"/></fig></p></list-item><list-item id="o0265"><label>28.</label><p id="p0510">Users can adjust several parameters on the treemap:<list list-type="simple" id="olist0125"><list-item id="o0270"><label>a.</label><p id="p0515">Depth: refers to the system (Depth 1), subsystem (Depth 2), and task (Depth 3) levels within the CellFie hierarchy.</p></list-item><list-item id="o0275"><label>b.</label><p id="p0520">Subgroup: provides a drop-down menu allowing the user to visualize the mean score/activity of individual groups (MAIT T-cell OR NK-cell), or the difference between two groups (MAIT T-cell vs. NK-cell).</p></list-item><list-item id="o0280"><label>c.</label><p id="p0525">Color map: gives the user a choice of color schemes.</p></list-item><list-item id="o0285"><label>d.</label><p id="p0530">Search: Provides a drop-down menu where users can find and select specific elements within the CellFie hierarchy (e.g., “Krebs cycle - NADH generation“).</p></list-item></list></p></list-item><list-item id="o0290"><label>29.</label><p id="p0535">While the Tree tool provides a means for users to explore the CellFie hierarchy to clearly understand the architectural links between tasks-systems-subsystems, it does not generate publication-ready visualizations. The ImmCellFie Hierarchy tool however provides hierarchical visualizations in the form of a treemap, enclosure diagram, or Voronoi map. Click on the ‘Hierarchy’ tab in the CellFie Results.</p></list-item><list-item id="o0295"><label>30.</label><p id="p0540">Use the drop-down menus under ‘Select Subgroups to Compare’ to select two different immune cell types. In this example we will look at differences between two types of memory T cells: memory CD4 T-cells vs. memory CD8 T-cells.</p></list-item><list-item id="o0300"><label>31.</label><p id="p0545">Toggle between the three types of hierarchical visualizations: treemap, enclosure diagram, and Voronoi treemap. Finish by selecting the enclosure diagram tool.</p></list-item><list-item id="o0305"><label>32.</label><p id="p0550">The Hierarchy tool provides many of the same parameters: ‘Depth’, ‘Subgroup’, ‘Color map’. Two additional parameters are available for users to customize the plot:<list list-type="simple" id="olist0130"><list-item id="o0310"><label>a.</label><p id="p0555">Value: allows the user to display results in either the continuous (‘score’) or binary (‘activity’) form.</p></list-item><list-item id="o0315"><label>b.</label><p id="p0560">Label opacity: users can modify the label opacity using the sliding bar at the bottom left of the plot.</p></list-item></list></p></list-item><list-item id="o0320"><label>33.</label><p id="p0565">Set parameters:<list list-type="simple" id="olist0135"><list-item id="o0325"><label>a.</label><p id="p0570">Depth: 3 (task).</p></list-item><list-item id="o0330"><label>b.</label><p id="p0575">Subgroup: memory CD4 T-cell vs. memory CD8 T-cell.</p></list-item><list-item id="o0335"><label>c.</label><p id="p0580">Value: activity.</p></list-item><list-item id="o0340"><label>d.</label><p id="p0585">Color map: blue-orange.</p></list-item><list-item id="o0345"><label>e.</label><p id="p0590">Label opacity: 0.75.</p></list-item></list></p></list-item><list-item id="o0350"><label>34.</label><p id="p0595">Hover your mouse over a plot element to view a pop-out window with summary statistics of the element.</p></list-item><list-item id="o0355"><label>35.</label><p id="p0600">Display multiple summary statistics.<list list-type="simple" id="olist0140"><list-item id="o0360"><label>a.</label><p id="p0605">Select the task, system, and/or subsystem elements of interest. In this example we will look at: i) ‘GPI ANCHOR BIOSYNTHESIS’, ii) ‘Phosphatidyl-inositol to glucosaminyl-acylphosphatidylinositol’, and iii) ‘Malate to pyruvate conversion’. This can be done in 2 ways: 1) locate and select the subsystem bubbles directly from the enclosure diagram, or 2) search for elements using the drop-down menu above the plot (<xref rid="fig5" ref-type="fig">Figure 5</xref>A).<fig id="fig5"><label>Figure 5</label><caption><p>Hierarchy tool</p><p>Screenshots demonstrating use of the Hierarchy tool.</p><p>(A) Users can use the Search tool to select tasks, systems, or subsystems of interest. Here we have already selected the subsystem ‘GPI ANCHOR BIOSYNTHESIS’ (outlined in red in the plot and listed to the right of the search bar) and we are currently searching for the task ‘Phosphatidyl-inositol to glucosaminyl-acylphosphatidylinositol’.</p><p>(B–D) Summary statistics for 3 select CellFie elements showing the difference in activity scores (B) and the activity scores of the individual groups (C and D).</p></caption><graphic xlink:href="gr5"/></fig></p></list-item><list-item id="o0365"><label>b.</label><p id="p0610">Click on the <inline-graphic xlink:href="fx5.gif"/> button to reveal the summary details of the selected tasks.</p></list-item><list-item id="o0370"><label>c.</label><p id="p0615">Use the ‘Subgroup’ parameter to toggle between summaries of individual groups (memory CD4 T-cell OR memory CD8 T-cell, <xref rid="fig5" ref-type="fig">Figures 5</xref>B and 5C) and differences between the two groups (memory CD4 T-cell vs. memory CD8 T-cell, <xref rid="fig5" ref-type="fig">Figure 5</xref>D).</p></list-item></list></p></list-item></list><disp-quote><p><bold><italic>Optional:</italic></bold> Users can save the hierarchy plot as or SVG or PNG using the <inline-graphic xlink:href="fx6.gif"/> button to the right of the plot.</p></disp-quote></p>
    </sec>
    <sec id="sec2.8">
      <title>Explore differences between cell types with the volcano plot</title>
      <p id="p0620">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx2.gif"/>
            <bold>Timing: minutes</bold>
          </p>
        </disp-quote>
      </p>
      <p id="p0625">ImmCellFie offers many interactive visualization tools for users to explore, including volcano plots. This tool allows users to visualize differences in CellFie scores (continuous) between phenotypic groups in the form of a volcano plot. Significantly upregulated and downregulated cell functions are colored in red and blue, respectively. Non-significant differences are shown in gray.<list list-type="simple" id="olist0145"><list-item id="o0375"><label>36.</label><p id="p0630">Click on the ‘Volcano plot’ tab from CellFie Results. <xref rid="sec5.9" ref-type="sec">Troubleshooting 5</xref>.</p></list-item><list-item id="o0380"><label>37.</label><p id="p0635">Use the drop-down menus under ‘Select Subgroups to Compare’ to select two different immune cell types. In this example we will look at differences between 2 types of granulocytes: neutrophils vs. eosinophils.</p></list-item><list-item id="o0385"><label>38.</label><p id="p0640">Toggle between Depth 1, 2, and 3 of the CellFie hierarchy.<list list-type="simple" id="olist0150"><list-item id="o0390"><label>a.</label><p id="p0645">Observe the significant metabolic differences between the two granulocytes. In this example, we find significant differential activity of many metabolic tasks between neutrophils and eosinophils, especially tasks related to energy metabolism.</p></list-item></list></p></list-item><list-item id="o0395"><label>39.</label><p id="p0650">Explore the details of subsystems that show significant differential activity between the two cell types (<xref rid="fig6" ref-type="fig">Figure 6</xref>).<list list-type="simple" id="olist0155"><list-item id="o0400"><label>a.</label><p id="p0655">While the volcano plot is on Depth 2 select the subsystems ‘OXIDATIVE PHOSPHORYLATION &amp; ROS DETOXIFICATION’, ‘PYRIMIDINE CATABOLISM’, ‘AMINO SUGARS METABOLISM’, and ‘N-GLYCAN METABOLISM’. This can be done in 2 ways: 1) locate and select the subsystem bubbles directly from the volcano plot, or 2) search for the subsystems using the drop-down menu above the plot.</p></list-item><list-item id="o0405"><label>b.</label><p id="p0660">Click on the <inline-graphic xlink:href="fx5.gif"/> button to reveal the summary details of the selected subsystems.</p></list-item></list><fig id="fig6"><label>Figure 6</label><caption><p>Volcano plot tool</p><p>Neutrophils and eosinophils are metabolically quite different. Here, we highlight 4 subsystems which show significant differential activity between the two cell types.</p></caption><graphic xlink:href="gr6"/></fig></p></list-item></list><disp-quote><p><bold><italic>Optional:</italic></bold> Users can change the significant level and fold change thresholds.</p></disp-quote><disp-quote><p><bold><italic>Optional:</italic></bold> Users can save the volcano plot as SVG or PNG using the <inline-graphic xlink:href="fx6.gif"/> button to the right of the plot.</p></disp-quote></p>
    </sec>
    <sec id="sec2.9">
      <title>Heatmap visualization of CellFie activity</title>
      <p id="p0665">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx2.gif"/>
            <bold>Timing: minutes</bold>
          </p>
        </disp-quote>
      </p>
      <p id="p0670">ImmCellFie provides a Heatmap tool which generates a grouped heatmap of sample activity.<list list-type="simple" id="olist0160"><list-item id="o0410"><label>40.</label><p id="p0675">Click on the ‘Heatmap’ tab from CellFie Results.</p></list-item><list-item id="o0415"><label>41.</label><p id="p0680">Use the drop-down menus under ‘Select Subgroups to Compare’ to select two different immune cell types. In this example we will compare our custom groups Monocytes vs. Dendritic Cells.</p></list-item><list-item id="o0420"><label>42.</label><p id="p0685">In addition to the ‘Depth’, ‘Value’, and ‘Color map’ parameters you have seen in the previous tools, Heatmap allows users to sort samples by mean, median, or max using the ‘Sort by’ parameter.</p></list-item><list-item id="o0425"><label>43.</label><p id="p0690">Set ‘Depth’ to 2 (subsystem) and ‘Value’ to score (continuous) (<xref rid="fig7" ref-type="fig">Figure 7</xref>A).<list list-type="simple" id="olist0165"><list-item id="o0430"><label>a.</label><p id="p0695">Note that monocytes show increased activity in the top several subsystems.</p></list-item></list><fig id="fig7"><label>Figure 7</label><caption><p>Heatmap tool</p><p>Heatmap showing metabolic differences between Dendritic Cells and Monocytes.</p><p>(A) Metabolic subsystem scores (continuous) of monocyte and dendritic cell samples.</p><p>(B) Metabolic task activity (binary) of the same set of samples.</p></caption><graphic xlink:href="gr7"/></fig></p></list-item><list-item id="o0435"><label>44.</label><p id="p0700">Set ‘Depth’ to 3 (task), ‘Value’ to activity (binary), and ‘Color map’ to ‘yellow-green-blue’ (<xref rid="fig7" ref-type="fig">Figure 7</xref>B).<list list-type="simple" id="olist0170"><list-item id="o0440"><label>a.</label><p id="p0705">Note there are two tasks that are active in all dendritic cell samples and inactive in all monocytes: Synthesis of creatine from arginine &amp; Conversion of lysine to L-2-Aminoadipate.</p></list-item></list></p></list-item></list><disp-quote><p><bold><italic>Optional:</italic></bold> Users can save the heatmap as SVG or PNG using the <inline-graphic xlink:href="fx6.gif"/> button to the right of the plot.</p></disp-quote></p>
    </sec>
    <sec id="sec2.10">
      <title>Visualizing metabolic activity of Escher pathway maps</title>
      <p id="p0710">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx2.gif"/>
            <bold>Timing: minutes</bold>
          </p>
        </disp-quote>
      </p>
      <p id="p0715">This tool overlays reaction activity scores (column 6 of the detailScoring file) onto Escher (v.1.7.3) pathway maps<xref rid="bib17" ref-type="bibr"><sup>17</sup></xref> of CellFie’s 7 main metabolic systems: energy metabolism, nucleotide metabolism, carbohydrate metabolism, amino acid metabolism, lipids metabolism, vitamin and cofactor metabolism, and glycan metabolism. Users can visualize the pathway activity of single samples/groups or the differential pathway activity between two groups.<list list-type="simple" id="olist0175"><list-item id="o0445"><label>45.</label><p id="p0720">Click on the ‘Pathway map’ tab from CellFie Results.</p></list-item><list-item id="o0450"><label>46.</label><p id="p0725">Use the drop-down menu under ‘Select Subgroups to Compare’ to select two different immune cell types. In this example we will look at differences between naive B cells and memory B cells.</p></list-item><list-item id="o0455"><label>47.</label><p id="p0730">Use the drop-down menu under ‘Select map’ to toggle between the 7 metabolic system maps. Select the ‘Amino Acids Metabolism’ map.</p></list-item><list-item id="o0460"><label>48.</label><p id="p0735">The subgroup parameter can be used to view the pathway maps for individual groups (‘naive B cell’ OR ‘memory B cell’), or the differences between groups (‘naive B-cell vs. memory B-cell’). Set ‘Subgroup’ to ‘naive B-cell vs. memory B-cell’ to display the log2 FC between the mean reaction scores of the two groups (<xref rid="fig8" ref-type="fig">Figure 8</xref>).<fig id="fig8"><label>Figure 8</label><caption><p>Pathway map tool</p><p>Escher pathway map of Amino Acid Metabolism differences between naive B cells and memory B cells. The Pathway map tool provides Escher pathway maps for the 7 systems of CellFie. The reaction activity scores of selected samples (using the subgroup parameter) are projected onto the reactions in the map and colored accordingly.</p></caption><graphic xlink:href="gr8"/></fig></p></list-item><list-item id="o0465"><label>49.</label><p id="p0740">Use the drop-down menu under View to display the map in Full Screen. Alternatively, users can click on the <inline-graphic xlink:href="fx7.gif"/> button to view the map full screen.</p></list-item><list-item id="o0470"><label>50.</label><p id="p0745">Users can customize the map using the Settings menu under View options.<list list-type="simple" id="olist0180"><list-item id="o0475"><label>a.</label><p id="p0750">Please refer to <ext-link ext-link-type="uri" xlink:href="https://escher.readthedocs.io/en/latest/getting_started.html#" id="intref0050">https://escher.readthedocs.io/en/latest/getting_started.html#</ext-link> sections 1.9 View options and 1.11 Settings for detailed information.</p></list-item></list></p></list-item></list></p>
    </sec>
  </sec>
  <sec id="sec3">
    <title>Expected outcomes</title>
    <p id="p0755">ImmCellFie is a user-friendly systems biology web tool for inferring metabolic activity from omics data and visualizing metabolic functionality with a variety of publication-ready plots. The CellFie algorithm can infer metabolic activity from transcriptomic or proteomic data for a variety of species including human, CHO, mouse, and rat. To facilitate exploration of immunological data, ImmCellFie supports direct data import from <ext-link ext-link-type="uri" xlink:href="http://ImmuneSpace.org" id="intref0055">ImmuneSpace.org</ext-link> and the upload of local files. Once data has been uploaded to the ImmCellFie account, simple point-and-click features enable users to create custom metabolic analyses using CellFie’s thresholding parameters. The MTS output of CellFie provides a quantification of metabolic functions for each sample within the dataset. Due to the nature of how MTSs are calculated, scores should not be compared across tasks but only across samples. To facilitate intra-sample comparison of tasks, we provide the MTSs in a binary form which simply applies a task-specific threshold to determine whether the task is active or not. This form of binary scoring is referred to as activity. Users can use the ‘Downloads’ link at the top of the CellFie Results track to <bold>batch-download</bold> all the results and create custom downstream analyses using their program of choice.</p>
    <p id="p0760">ImmCellFie provides a suite of interactive analytical tools to visualize CellFie results. First, users can <bold>create subgroups</bold> within their dataset to facilitate conditional comparisons. This can be done manually by selecting which samples belong to designated groups, or semi-automatically based on information provided in the optional phenotypic file uploaded by the user. Here we used the immune cell category from the properties document to semi-automatically group samples based on cell type (<xref rid="fig3" ref-type="fig">Figure 3</xref>A). We also manually created custom subgroups of samples based on their lineage (<xref rid="fig3" ref-type="fig">Figure 3</xref>B). CellFie results can then be explored using ImmCellFie’s five interactive visualization tools: i) Hierarchy, ii) Tree, iii) Volcano plot, iv) Heatmap, and v) Pathway map.</p>
    <p id="p0765">CellFie tasks are organized into a hierarchical structure of metabolic pathways systems and subsystems, grouping tasks based on their biological functions. The Tree and Hierarchy tools enable users to explore and visualize scores at various depths within the CellFie hierarchy. The <bold>Tree tool</bold> allows users to interact with the architecture of the CellFie hierarchy linking tasks to their respective systems and subsystems, while including annotations of the score and binary activity results (<xref rid="fig4" ref-type="fig">Figure 4</xref>). Depth, subgroup, and color map parameters enable the user to toggle between levels of the hierarchy, individual subgroup scores and differential scores, and color schemes, respectively. While the Tree tool provides a means for users to explore the CellFie hierarchy to clearly understand the architectural links between tasks-systems-subsystems, it does not generate downloadable visualizations. The <bold>Hierarchy tool</bold> however provides publication-ready visualizations of the CellFie hierarchy in the form of a treemap, enclosure diagram, or Voronoi map. Here we set the parameters to explore the metabolic differences between two types of memory T cells: memory CD4 T cells vs. memory CD8 T cells. While the mature CD4+ and CD8+ subsets arise from a common progenitor, the CD4+/CD8+ double-positive (DP) cell which expresses both proteins simultaneously, they possess unique functions which are reflected in their unique metabolic signatures (<xref rid="fig5" ref-type="fig">Figure 5</xref>). Users can hover over elements of the plot to view summary statistics. Users can also select elements of the plot using their mouse or the search bar to select and display multiple summary statistics. Summary boxes include distribution plots of sample scores and binary activity. The summary of single subgroups will contain the mean score and activity of the group, otherwise the fold change and significant (p-value) metrics are provided. The bottom of the box also shows the parent term(s) of the selected CellFie function.</p>
    <p id="p0770">The <bold>volcano plot tool</bold> allows users to visualize differential metabolic scores between groups of samples. Here we compared two cell types from the granulocytes lineage: neutrophils vs eosinophils. Both neutrophils and eosinophils play an important role in the innate immune response, however each contain specific granules which impart unique metabolic demands on the cell. This can clearly be seen in the volcano plot of the two cell types (<xref rid="fig6" ref-type="fig">Figure 6</xref>). Sets of parameters allow the user to view differential activity at various levels within the CellFie hierarchy, as well as choose plot thresholds to define significant changes. Typically users would choose a significance level of 0.01 or 0.05, and a fold change threshold of 1.5 or higher. These functions enable immediate visualization of changes within the volcano plot, where significantly upregulated and downregulated cell functions are colored in red and blue, respectively. Similar to the Hierarchy tool, the interactive volcano plot allows users to select cell functions and display summary statistics of the subgroups.</p>
    <p id="p0775">ImmCellFie also provides a <bold>Heatmap tool</bold> which generates a grouped heatmap of subgroup sample scores. Here we used the tool to visualize the metabolic differences between our custom myeloid subgroups Monocytes and Dendritic Cells. Under disturbed homeostasis, monocytes are recruited to sites of inflammation and differentiate into distinct subsets of dendritic cells whose function is to stimulate effector T-lymphocytes.<xref rid="bib18" ref-type="bibr"><sup>18</sup></xref> Users can customize the plot using the set of provided parameters. When the Depth parameter is set to 2 and we sort the subsystems by mean score, we can see that monocytes show increased activity in the top several subsystems, especially ‘EICOSANOID METABOLISM’ (<xref rid="fig7" ref-type="fig">Figure 7</xref>A). Interestingly, eicosanoids play an important role in the inflammatory response. We also observe distinct differences at the task level (Depth 1). In particular two tasks belonging to amino acids metabolism, synthesis of creatine from arginine and conversion of lysine to L-2-Aminoadipate, are active in all dendritic cell samples and inactive in all monocytes. Clearly, the cell types show distinct metabolic signatures reflecting their differences in lineage.</p>
    <p id="p0780">Lastly, ImmCellFie provides a <bold>pathway map tool</bold> to overlay cellular activity onto Escher maps of CellFie’s metabolic systems: energy metabolism, nucleotide metabolism, carbohydrate metabolism, amino acid metabolism, lipids metabolism, vitamin and cofactor metabolism, and glycan metabolism. Using the subgroup parameter, users can visualize single group activity or differential activity between two subgroups at the reaction level. Reactions are colored according to activity (blue-green-red). This enables users to quickly view changes related to specific reactions and enzymes within each metabolic system. Here we used the map to view metabolic differences between naive B cells and memory B cells. The Amino Acids Metabolism map shows clear differences in several reactions (<xref rid="fig8" ref-type="fig">Figure 8</xref>). To gain further insight into specific reactions and the enzymes of interest, users can hover over the reaction and navigate to the reaction page on the BiGG Models database.</p>
    <p id="p0785">In summary, the main features of ImmCellFie are: (1) a web-based platform enabling the inference of metabolic functions from omics data with the CellFie algorithm, (2) options to upload data from personal computer or import directly from <ext-link ext-link-type="uri" xlink:href="http://ImmuneSpace.org" id="intref0060">ImmuneSpace.org</ext-link>, (3) an extensive suite of analytical and interactive visualization tools to explore results, (4) options to export raw CellFie results for further analyses or to generate of graphics for reports and publications using other software, (5) an intuitive user-friendly interface enabling scientists of any field to harness the power of GeMs, and (6) a RESTful, OpenAPI-compliant API for interfacing with all these functions interactively over HTTP via notebooks (e.g., Jupyter, Google Colab). The extendable design of the platform facilitates the addition of cell functionalities to expand the biological scope in future releases.</p>
  </sec>
  <sec id="sec4">
    <title>Limitations</title>
    <p id="p0790">The CellFie tool is constrained by the availability of species-specific GeMs and generation of associated task modules. Therefore, the algorithm is currently compatible with a limited set of mammalian species and is limited to the inference of metabolic activity only. However, the modular design of the software can easily accommodate the integration of additional species and cellular functions as their GeMs and associated task modules become available.</p>
    <p id="p0795">The current state of CellFie does not consider pathway thermodynamics which are known to affect the pathway chemistries and fluxes in central metabolism.<xref rid="bib19" ref-type="bibr"><sup>19</sup></xref><sup>,</sup><xref rid="bib20" ref-type="bibr"><sup>20</sup></xref> The incorporation of thermodynamics-based analysis with CellFie could be considered in a future release as an expanded feature.</p>
    <p id="p0800">The size of the dataset can pose issues for running the CellFie algorithm. This is especially relevant when attempting to run CellFie on single-cell datasets. To run large single cell datasets, users are advised to divide the dataset into smaller subsets and run them separately; however, this can impact the results since the local thresholding approaches are influenced by all samples included in the analysis. Thus, very large datasets with thousands of samples should be run locally.</p>
    <p id="p0805">ImmCellFie provides the user with the ability to easily generate multiple subgroups within the data to facilitate conditional comparisons. However, the suite of analytical and visualization tools only enables direct comparison between two groups and does not enable multi-group comparisons. In order to perform multidimensional analyses, the user should download the raw CellFie scores and use alternate programming tools.</p>
  </sec>
  <sec id="sec5">
    <title>Troubleshooting</title>
    <sec id="sec5.1">
      <title>Problem 1</title>
      <p id="p0810">Can I delete datasets?</p>
    </sec>
    <sec id="sec5.2">
      <title>Potential solution</title>
      <p id="p0815">Users can request removal of datasets by navigating to the Data page and clicking on the ”Remove” icon next to the dataset they wish to remove. This will open an email to the ImmCellFie development team requesting removal of the specified dataset.</p>
    </sec>
    <sec id="sec5.3">
      <title>Problem 2</title>
      <p id="p0820">What should I do if the CellFie run is taking much longer than expected?</p>
    </sec>
    <sec id="sec5.4">
      <title>Potential solution</title>
      <p id="p0825">This is most likely due to the size of the dataset (e.g., large single cell datasets). Upload the data in chunks and run them separately. Note that this will affect gene thresholding, however the effects should be minimal.</p>
    </sec>
    <sec id="sec5.5">
      <title>Problem 3</title>
      <p id="p0830">Can I change the description of a dataset after I’ve already uploaded it and/or complete the CellFie run?</p>
    </sec>
    <sec id="sec5.6">
      <title>Potential solution</title>
      <p id="p0835">Navigate to the Data Selection page, double-click on the description, and add/modify the description.</p>
    </sec>
    <sec id="sec5.7">
      <title>Problem 4</title>
      <p id="p0840">Why did the CellFie run fail?</p>
    </sec>
    <sec id="sec5.8">
      <title>Potential solution</title>
      <p id="p0845">There are 2 main reasons why CellFie runs might fail. First check the format of your input data and ensure the genes are in entrez ID form. Next check that the model/organism parameters correctly correspond to the organism genes used. We recommend googling several of your input genes to double-check they correspond to the correct organism.</p>
    </sec>
    <sec id="sec5.9">
      <title>Problem 5</title>
      <p id="p0850">Why does the volcano plot x-scale not appear properly? (<xref rid="fig10" ref-type="fig">Figure 10</xref>A).<fig id="fig9"><label>Figure 9</label><caption><p>RESTful API</p><p>Screenshot of the RESTful, OpenAPI-compliant API system used to interface with ImmCellFie functions interactively over HTTP via notebooks (e.g., Jupyter, Google Colab).</p></caption><graphic xlink:href="gr9"/></fig><fig id="fig10"><label>Figure 10</label><caption><p>Troubleshooting the volcano plot</p><p>Example volcano plots showing the effect of adding a pseudo-count to the expression data.</p><p>(A) Volcano plot with no pseudo-count added to the expression data.</p><p>(B) Volcano plot using expression data with a pseudo-count.</p></caption><graphic xlink:href="gr10"/></fig></p>
    </sec>
    <sec id="sec5.10">
      <title>Potential solution</title>
      <p id="p0855">This issue arises due to how ImmCellFie handles the log form of zeros. To correct this issue, add a pseudo-count to the expression data and rerun CellFie (<xref rid="fig10" ref-type="fig">Figure 10</xref>B).</p>
    </sec>
  </sec>
  <sec id="sec6">
    <title>Resource availability</title>
    <sec id="sec6.1">
      <title>Lead contact</title>
      <p id="p0860">Further information and requests for resources should be directed to and will be fulfilled by the lead contact, Nathan Lewis, <ext-link ext-link-type="uri" xlink:href="mailto:nlewisres@ucsd.edu" id="intref0065">nlewisres@ucsd.edu</ext-link>.</p>
    </sec>
    <sec id="sec6.2">
      <title>Materials availability</title>
      <p id="p0865">The CellFie tool housed on ImmCellFie is freely available from:</p>
      <p id="p0870"><ext-link ext-link-type="uri" xlink:href="https://github.com/LewisLabUCSD/CellFie" id="intref0070">https://github.com/LewisLabUCSD/CellFie</ext-link> (<ext-link ext-link-type="doi" xlink:href="10.5281/zenodo.7511046" id="intref0075">https://doi.org/10.5281/zenodo.7511046</ext-link>).</p>
      <p id="p0875"><ext-link ext-link-type="uri" xlink:href="https://hub.docker.com/repository/docker/hmasson/cellfie-standalone-app" id="intref0080">https://hub.docker.com/repository/docker/hmasson/cellfie-standalone-app</ext-link>.</p>
      <p id="p0880">Web application code:</p>
      <p id="p0885"><ext-link ext-link-type="uri" xlink:href="https://github.com/RENCI/fuse-dashboard-immcellfie" id="intref0085">https://github.com/RENCI/fuse-dashboard-immcellfie</ext-link> (dashboard front-end code).</p>
      <p id="p0890"><ext-link ext-link-type="uri" xlink:href="https://github.com/RENCI/fuse-agent" id="intref0090">https://github.com/RENCI/fuse-agent</ext-link> (dashboard back-end agent and API code).</p>
      <p id="p0895">Tools orchestrated by fuse-agent:</p>
      <p id="p0900"><ext-link ext-link-type="uri" xlink:href="https://github.com/RENCI/fuse-tool-pca" id="intref0095">https://github.com/RENCI/fuse-tool-pca</ext-link>.</p>
      <p id="p0905"><ext-link ext-link-type="uri" xlink:href="https://github.com/RENCI/fuse-tool-cellfie" id="intref0100">https://github.com/RENCI/fuse-tool-cellfie</ext-link>.</p>
      <p id="p0910">Datasets orchestrated by fuse-agent:</p>
      <p id="p0915"><ext-link ext-link-type="uri" xlink:href="https://github.com/RENCI/fuse-provider-upload" id="intref0105">https://github.com/RENCI/fuse-provider-upload</ext-link>.</p>
      <p id="p0920"><ext-link ext-link-type="uri" xlink:href="https://github.com/RENCI/fuse-provider-immunespace" id="intref0110">https://github.com/RENCI/fuse-provider-immunespace</ext-link>.</p>
    </sec>
  </sec>
</body>
<back>
  <ref-list id="cebib0010">
    <title>References</title>
    <ref id="bib1">
      <label>1</label>
      <element-citation publication-type="journal" id="sref1">
        <person-group person-group-type="author">
          <name>
            <surname>Richelle</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Kellman</surname>
            <given-names>B.P.</given-names>
          </name>
          <name>
            <surname>Wenzel</surname>
            <given-names>A.T.</given-names>
          </name>
          <name>
            <surname>Chiang</surname>
            <given-names>A.W.T.</given-names>
          </name>
          <name>
            <surname>Reagan</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Gutierrez</surname>
            <given-names>J.M.</given-names>
          </name>
          <name>
            <surname>Joshi</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>J.K.</given-names>
          </name>
          <name>
            <surname>Masson</surname>
            <given-names>H.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Model-based assessment of mammalian cell metabolic functionalities using omics data</article-title>
        <source>Cell Rep. Methods</source>
        <volume>1</volume>
        <year>2021</year>
        <fpage>100040</fpage>
        <pub-id pub-id-type="doi">10.1016/j.crmeth.2021.100040</pub-id>
        <pub-id pub-id-type="pmid">34761247</pub-id>
      </element-citation>
    </ref>
    <ref id="bib2">
      <label>2</label>
      <element-citation publication-type="journal" id="sref2">
        <person-group person-group-type="author">
          <name>
            <surname>Lewis</surname>
            <given-names>N.E.</given-names>
          </name>
          <name>
            <surname>Nagarajan</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Palsson</surname>
            <given-names>B.O.</given-names>
          </name>
        </person-group>
        <article-title>Constraining the metabolic genotype-phenotype relationship using a phylogeny of in silico methods</article-title>
        <source>Nat. Rev. Microbiol.</source>
        <volume>10</volume>
        <year>2012</year>
        <fpage>291</fpage>
        <lpage>305</lpage>
        <pub-id pub-id-type="pmid">22367118</pub-id>
      </element-citation>
    </ref>
    <ref id="bib3">
      <label>3</label>
      <element-citation publication-type="journal" id="sref3">
        <person-group person-group-type="author">
          <name>
            <surname>Feist</surname>
            <given-names>A.M.</given-names>
          </name>
          <name>
            <surname>Herrgård</surname>
            <given-names>M.J.</given-names>
          </name>
          <name>
            <surname>Thiele</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Reed</surname>
            <given-names>J.L.</given-names>
          </name>
          <name>
            <surname>Palsson</surname>
            <given-names>B.Ø.</given-names>
          </name>
        </person-group>
        <article-title>Reconstruction of biochemical networks in microorganisms</article-title>
        <source>Nat. Rev. Microbiol.</source>
        <volume>7</volume>
        <year>2009</year>
        <fpage>129</fpage>
        <lpage>143</lpage>
        <pub-id pub-id-type="pmid">19116616</pub-id>
      </element-citation>
    </ref>
    <ref id="bib4">
      <label>4</label>
      <element-citation publication-type="journal" id="sref4">
        <person-group person-group-type="author">
          <name>
            <surname>Granados</surname>
            <given-names>J.C.</given-names>
          </name>
          <name>
            <surname>Richelle</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Gutierrez</surname>
            <given-names>J.M.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Bhatnagar</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>N.E.</given-names>
          </name>
          <name>
            <surname>Nigam</surname>
            <given-names>S.K.</given-names>
          </name>
        </person-group>
        <article-title>Coordinate regulation of systemic and kidney tryptophan metabolism by the drug transporters OAT1 and OAT3</article-title>
        <source>J. Biol. Chem.</source>
        <volume>296</volume>
        <year>2021</year>
        <fpage>100575</fpage>
        <pub-id pub-id-type="pmid">33757768</pub-id>
      </element-citation>
    </ref>
    <ref id="bib5">
      <label>5</label>
      <element-citation publication-type="journal" id="sref5">
        <person-group person-group-type="author">
          <name>
            <surname>Swainston</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Smallbone</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Hefzi</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Dobson</surname>
            <given-names>P.D.</given-names>
          </name>
          <name>
            <surname>Brewer</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Hanscho</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Zielinski</surname>
            <given-names>D.C.</given-names>
          </name>
          <name>
            <surname>Ang</surname>
            <given-names>K.S.</given-names>
          </name>
          <name>
            <surname>Gardiner</surname>
            <given-names>N.J.</given-names>
          </name>
          <name>
            <surname>Gutierrez</surname>
            <given-names>J.M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Recon 2.2: from reconstruction to model of human metabolism</article-title>
        <source>Metabolomics</source>
        <volume>12</volume>
        <year>2016</year>
        <fpage>109</fpage>
        <pub-id pub-id-type="pmid">27358602</pub-id>
      </element-citation>
    </ref>
    <ref id="bib6">
      <label>6</label>
      <element-citation publication-type="journal" id="sref6">
        <person-group person-group-type="author">
          <name>
            <surname>Hefzi</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Ang</surname>
            <given-names>K.S.</given-names>
          </name>
          <name>
            <surname>Hanscho</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Bordbar</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Ruckerbauer</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Lakshmanan</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Orellana</surname>
            <given-names>C.A.</given-names>
          </name>
          <name>
            <surname>Baycin-Hizal</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Ley</surname>
            <given-names>D.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A consensus genome-scale reconstruction of Chinese hamster ovary cell metabolism</article-title>
        <source>Cell Syst.</source>
        <volume>3</volume>
        <year>2016</year>
        <fpage>434</fpage>
        <lpage>443.e8</lpage>
        <pub-id pub-id-type="pmid">27883890</pub-id>
      </element-citation>
    </ref>
    <ref id="bib7">
      <label>7</label>
      <element-citation publication-type="journal" id="sref7">
        <person-group person-group-type="author">
          <name>
            <surname>Sigurdsson</surname>
            <given-names>M.I.</given-names>
          </name>
          <name>
            <surname>Jamshidi</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Steingrimsson</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Thiele</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Palsson</surname>
            <given-names>B.Ø.</given-names>
          </name>
        </person-group>
        <article-title>A detailed genome-wide reconstruction of mouse metabolism based on human Recon 1</article-title>
        <source>BMC Syst. Biol.</source>
        <volume>4</volume>
        <year>2010</year>
        <fpage>140</fpage>
        <pub-id pub-id-type="pmid">20959003</pub-id>
      </element-citation>
    </ref>
    <ref id="bib8">
      <label>8</label>
      <element-citation publication-type="journal" id="sref8">
        <person-group person-group-type="author">
          <name>
            <surname>Richelle</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Chiang</surname>
            <given-names>A.W.T.</given-names>
          </name>
          <name>
            <surname>Kuo</surname>
            <given-names>C.-C.</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>N.E.</given-names>
          </name>
        </person-group>
        <article-title>Increasing consensus of context-specific metabolic models by integrating data-inferred cell functions</article-title>
        <source>PLoS Comput. Biol.</source>
        <volume>15</volume>
        <year>2019</year>
        <fpage>e1006867</fpage>
        <pub-id pub-id-type="pmid">30986217</pub-id>
      </element-citation>
    </ref>
    <ref id="bib9">
      <label>9</label>
      <element-citation publication-type="journal" id="sref9">
        <person-group person-group-type="author">
          <name>
            <surname>Richelle</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Joshi</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>N.E.</given-names>
          </name>
        </person-group>
        <article-title>Assessing key decisions for transcriptomic data integration in biochemical networks</article-title>
        <source>PLoS Comput. Biol.</source>
        <volume>15</volume>
        <year>2019</year>
        <fpage>e1007185</fpage>
        <pub-id pub-id-type="pmid">31323017</pub-id>
      </element-citation>
    </ref>
    <ref id="bib10">
      <label>10</label>
      <element-citation publication-type="journal" id="sref10">
        <person-group person-group-type="author">
          <name>
            <surname>Jensen</surname>
            <given-names>P.A.</given-names>
          </name>
          <name>
            <surname>Lutz</surname>
            <given-names>K.A.</given-names>
          </name>
          <name>
            <surname>Papin</surname>
            <given-names>J.A.</given-names>
          </name>
        </person-group>
        <article-title>TIGER: toolbox for integrating genome-scale metabolic models, expression data, and transcriptional regulatory networks</article-title>
        <source>BMC Syst. Biol.</source>
        <volume>5</volume>
        <year>2011</year>
        <fpage>147</fpage>
        <pub-id pub-id-type="pmid">21943338</pub-id>
      </element-citation>
    </ref>
    <ref id="bib11">
      <label>11</label>
      <element-citation publication-type="book" id="sref11">
        <person-group person-group-type="author">
          <collab>R Core Team</collab>
        </person-group>
        <part-title>R: A Language and Environment for Statistical Computing</part-title>
        <year>2020</year>
        <publisher-name>R Core Team</publisher-name>
      </element-citation>
    </ref>
    <ref id="bib12">
      <label>12</label>
      <element-citation publication-type="book" id="sref12">
        <person-group person-group-type="author">
          <name>
            <surname>Dowle</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Srinivasan</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <part-title>data.table: Extension of ‘data.frame’.</part-title>
        <year>2021</year>
        <publisher-name>R package version 1.14.2.</publisher-name>
        <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=data.table" id="interref0030">https://CRAN.R-project.org/package=data.table</ext-link>
      </element-citation>
    </ref>
    <ref id="bib13">
      <label>13</label>
      <element-citation publication-type="book" id="sref13">
        <person-group person-group-type="author">
          <name>
            <surname>Wickham</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>François</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Henry</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>K.</given-names>
          </name>
        </person-group>
        <part-title>dplyr: A Grammar of Data Manipulation.</part-title>
        <year>2021</year>
        <publisher-name>R package version 1.0.7.</publisher-name>
        <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=dplyr" id="interref0035">https://CRAN.R-project.org/package=dplyr</ext-link>
      </element-citation>
    </ref>
    <ref id="bib14">
      <label>14</label>
      <element-citation publication-type="book" id="sref14">
        <person-group person-group-type="author">
          <name>
            <surname>Wickham</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Girlich</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <part-title>tidyr: Tidy Messy Data.</part-title>
        <year>2022</year>
        <publisher-name>R package version 1.2.0.</publisher-name>
        <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=tidyr" id="interref0040">https://CRAN.R-project.org/package=tidyr</ext-link>
      </element-citation>
    </ref>
    <ref id="bib15">
      <label>15</label>
      <element-citation publication-type="book" id="sref15">
        <person-group person-group-type="author">
          <name>
            <surname>Pagès</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Carlson</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Falcon</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>N.</given-names>
          </name>
        </person-group>
        <part-title>AnnotationDbi: Manipulation of SQLite-Based Annotations in Bioconductor.</part-title>
        <year>2020</year>
        <publisher-name>R package version 1.52.0.</publisher-name>
        <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/AnnotationDbi" id="interref0045">https://bioconductor.org/packages/AnnotationDbi</ext-link>
      </element-citation>
    </ref>
    <ref id="bib16">
      <label>16</label>
      <element-citation publication-type="book" id="sref16">
        <person-group person-group-type="author">
          <name>
            <surname>Carlson</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <part-title>org.Hs.eg.db: Genome Wide Annotation for Human</part-title>
        <year>2020</year>
        <publisher-name>R package version 3.12.0</publisher-name>
      </element-citation>
    </ref>
    <ref id="bib17">
      <label>17</label>
      <element-citation publication-type="journal" id="sref17">
        <person-group person-group-type="author">
          <name>
            <surname>King</surname>
            <given-names>Z.A.</given-names>
          </name>
          <name>
            <surname>Dräger</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Ebrahim</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Sonnenschein</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>N.E.</given-names>
          </name>
          <name>
            <surname>Palsson</surname>
            <given-names>B.O.</given-names>
          </name>
        </person-group>
        <article-title>Escher: a web application for building, sharing, and embedding data-rich visualizations of biological pathways</article-title>
        <source>PLoS Comput. Biol.</source>
        <volume>11</volume>
        <year>2015</year>
        <fpage>e1004321</fpage>
        <pub-id pub-id-type="pmid">26313928</pub-id>
      </element-citation>
    </ref>
    <ref id="bib18">
      <label>18</label>
      <element-citation publication-type="journal" id="sref18">
        <person-group person-group-type="author">
          <name>
            <surname>Wacleche</surname>
            <given-names>V.S.</given-names>
          </name>
          <name>
            <surname>Tremblay</surname>
            <given-names>C.L.</given-names>
          </name>
          <name>
            <surname>Routy</surname>
            <given-names>J.-P.</given-names>
          </name>
          <name>
            <surname>Ancuta</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>The biology of monocytes and dendritic cells: contribution to HIV pathogenesis</article-title>
        <source>Viruses</source>
        <volume>10</volume>
        <year>2018</year>
        <pub-id pub-id-type="doi">10.3390/v10020065</pub-id>
      </element-citation>
    </ref>
    <ref id="bib19">
      <label>19</label>
      <element-citation publication-type="journal" id="sref19">
        <person-group person-group-type="author">
          <name>
            <surname>Noor</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Bar-Even</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Flamholz</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Reznik</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Liebermeister</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Milo</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Pathway thermodynamics highlights kinetic obstacles in central metabolism</article-title>
        <source>PLoS Comput. Biol.</source>
        <volume>10</volume>
        <year>2014</year>
        <fpage>e1003483</fpage>
        <pub-id pub-id-type="pmid">24586134</pub-id>
      </element-citation>
    </ref>
    <ref id="bib20">
      <label>20</label>
      <element-citation publication-type="journal" id="sref20">
        <person-group person-group-type="author">
          <name>
            <surname>Flamholz</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Noor</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Bar-Even</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Milo</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>eQuilibrator--the biochemical thermodynamics calculator</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>40</volume>
        <year>2012</year>
        <fpage>D770</fpage>
        <lpage>D775</lpage>
        <pub-id pub-id-type="pmid">22064852</pub-id>
      </element-citation>
    </ref>
  </ref-list>
  <sec id="appsec2" sec-type="supplementary-material">
    <title>Supplemental information</title>
    <p id="p0955">
      <supplementary-material content-type="local-data" id="mmc1">
        <caption>
          <title>File S1. R code used to process HPA data, related to the “preparing ImmCellFie input files” step</title>
        </caption>
        <media xlink:href="mmc1.zip"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="mmc2">
        <caption>
          <title>File S2. Post-processed version of HPA data compatible with ImmCellFie, related to the “preparing ImmCellFie input files” step</title>
          <p>Post-processed version of the HPA expression data that users can use directly with ImmCellFie. Users should use this if they wish to skip the pre-processing step of the protocol.</p>
        </caption>
        <media xlink:href="mmc2.csv"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="mmc3">
        <caption>
          <title>File S3. Post-processed version of HPA phenotypic data compatible with ImmCellFie, related to the “preparing ImmCellFie input files” step</title>
          <p>Post-processed version of the HPA phenotypic data that users can use directly with ImmCellFie. Users should use this if they wish to skip the pre-processing step of the protocol.</p>
        </caption>
        <media xlink:href="mmc3.csv"/>
      </supplementary-material>
    </p>
  </sec>
  <sec sec-type="data-availability" id="da0010">
    <title>Data and code availability</title>
    <p id="p0030">The example datasets and code generated during this study are included in this published article.</p>
  </sec>
  <ack id="ack0010">
    <title>Acknowledgments</title>
    <p id="p0935">This work was supported by generous funding from <funding-source id="gs1"><institution-wrap><institution-id institution-id-type="doi">10.13039/100000057</institution-id><institution>NIGMS</institution></institution-wrap></funding-source> (R35 GM119850 to N.E.L.) and <funding-source id="gs2"><institution-wrap><institution-id institution-id-type="doi">10.13039/100000060</institution-id><institution>NIAID</institution></institution-wrap></funding-source> (UH2 AI153029 to N.E.L. and K.R.) and the <funding-source id="gs3"><institution-wrap><institution-id institution-id-type="doi">10.13039/501100011747</institution-id><institution>Novo Nordisk Foundation</institution></institution-wrap></funding-source> (NNF20SA0066621 to N.E.L.). The authors also thank Angela Wilden for preliminary analysis that inspired this work.</p>
    <sec id="sec9">
      <title>Author contributions</title>
      <p id="p0940">K.R., H.O.M., and N.E.L. designed the study, conducted the analyses, and wrote the paper. A.R., D.B., J.R., A.T., L.B., S.S., M.W., Z.A.K., Z.L., and B.P.K. developed the codes, tools, and visualization resources and contributed to analyses. L.C. coordinated efforts and facilitated code base issue tracking. All authors have read and approved the work.</p>
    </sec>
    <sec sec-type="COI-statement" id="sec10">
      <title>Declaration of interests</title>
      <p id="p0945">The authors declare no competing interest.</p>
    </sec>
  </ack>
  <fn-group>
    <fn id="appsec1" fn-type="supplementary-material">
      <p id="p0950">Supplemental information can be found online at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.xpro.2023.102069" id="intref0155">https://doi.org/10.1016/j.xpro.2023.102069</ext-link>.</p>
    </fn>
  </fn-group>
</back>
