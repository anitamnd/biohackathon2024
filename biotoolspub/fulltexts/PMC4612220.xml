<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d1 20130915//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4612220</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btv389</article-id>
    <article-id pub-id-type="publisher-id">btv389</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Proteny: discovering and visualizing statistically significant syntenic clusters at the proteome level</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Gehrmann</surname>
          <given-names>Thies</given-names>
        </name>
        <xref ref-type="corresp" rid="btv389-COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Reinders</surname>
          <given-names>Marcel J.T.</given-names>
        </name>
      </contrib>
      <aff>Delft Bioinformatics Lab, Delft University of Technology, Mekelweg 4, 2628 CD Delft, The Netherlands</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btv389-COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="FN100">
        <p>Associate Editor: John Hancock</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>11</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>23</day>
      <month>6</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>6</month>
      <year>2015</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>31</volume>
    <issue>21</issue>
    <fpage>3437</fpage>
    <lpage>3444</lpage>
    <history>
      <date date-type="received">
        <day>2</day>
        <month>12</month>
        <year>2014</year>
      </date>
      <date date-type="rev-recd">
        <day>22</day>
        <month>6</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>6</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2015. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2015</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Background:</bold> With more and more genomes being sequenced, detecting synteny between genomes becomes more and more important. However, for microorganisms the genomic divergence quickly becomes large, resulting in different codon usage and shuffling of gene order and gene elements such as exons.</p>
      <p><bold>Results:</bold> We present Proteny, a methodology to detect synteny between diverged genomes. It operates on the amino acid sequence level to be insensitive to codon usage adaptations and clusters groups of exons disregarding order to handle diversity in genomic ordering between genomes. Furthermore, Proteny assigns significance levels to the syntenic clusters such that they can be selected on statistical grounds. Finally, Proteny provides novel ways to visualize results at different scales, facilitating the exploration and interpretation of syntenic regions. We test the performance of Proteny on a standard ground truth dataset, and we illustrate the use of Proteny on two closely related genomes (two different strains of <italic>Aspergillus niger</italic>) and on two distant genomes (two species of Basidiomycota). In comparison to other tools, we find that Proteny finds clusters with more true homologies in fewer clusters that contain more genes, i.e. Proteny is able to identify a more consistent synteny. Further, we show how genome rearrangements, assembly errors, gene duplications and the conservation of specific genes can be easily studied with Proteny.</p>
      <p><bold>Availability and implementation:</bold> Proteny is freely available at the Delft Bioinformatics Lab website <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.tudelft.nl/dbl/software">http://bioinformatics.tudelft.nl/dbl/software</ext-link>.</p>
      <p>
        <bold>Contact:</bold>
        <email>t.gehrmann@tudelft.nl</email>
      </p>
      <p><bold>Supplementary information</bold>: <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv389/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>A synteny analysis is a useful way to compare organisms that allows us to study the evolution between genomes, make claims about functional conservation (<xref rid="btv389-B21" ref-type="bibr">McClean <italic>et al.</italic>, 2010</xref>; <xref rid="btv389-B25" ref-type="bibr">Overbeek <italic>et</italic>
<italic>al.</italic>, 1999</xref>), identify genome rearrangements (<xref rid="btv389-B31" ref-type="bibr">Sinha and Meller, 2007</xref>), aide genome annotation (<xref rid="btv389-B34" ref-type="bibr">Vallenet <italic>et</italic>
<italic>al.</italic>, 2006</xref>) and even predict genome assembly errors.</p>
    <p>Numerous tools are already available to detect synteny. Tools like Mugsy (<xref rid="btv389-B3" ref-type="bibr">Angiuoli and Salzberg, 2011</xref>), Mauve (<xref rid="btv389-B9" ref-type="bibr">Darling <italic>et</italic>
<italic>al.</italic>, 2004</xref>), Multiz (<xref rid="btv389-B6" ref-type="bibr">Blanchette <italic>et</italic>
<italic>al.</italic>, 2004</xref>) and Sibelia (<xref rid="btv389-B22" ref-type="bibr">Minkin <italic>et</italic>
<italic>al.</italic>, 2013</xref>), focus only on highly related genomes. OrthoCluster (<xref rid="btv389-B37" ref-type="bibr">Zeng <italic>et</italic>
<italic>al.</italic>, 2008</xref>) and SyMAP (<xref rid="btv389-B32" ref-type="bibr">Soderlund <italic>et</italic>
<italic>al.</italic>, 2011</xref>) operate at the DNA level and discover groups of genes with their gene order being conserved. These assumptions are too strict when considering more distant genomes (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv389/-/DC1">Supplementary Material S1</ext-link>).</p>
    <p>i-ADHoRe (<xref rid="btv389-B28" ref-type="bibr">Proost <italic>et al.</italic>, 2012</xref>; <xref rid="btv389-B30" ref-type="bibr">Simillion <italic>et al.</italic>, 2008</xref>; <xref rid="btv389-B35" ref-type="bibr">Vandepoele <italic>et</italic>
<italic>al.</italic>, 2002</xref>) works at the protein level and builds a homologous gene matrix based on protein–protein alignments, detecting clusters of genes by identifying diagonal groups of genes, allowing for a maximum gap size. However, for more distant genomes, exons may be inserted and removed from genes, while splice variants remain conserved (<xref rid="btv389-B19" ref-type="bibr">Long <italic>et</italic>
<italic>al.</italic>, 2003</xref>). Consequently, it seems more reasonable to detect synteny between more distant genomes by considering the protein level at the resolution of exons, rather than the genes.</p>
    <p>We introduce a method, called Proteny, which can discover statistically significant syntenic clusters between diverged genomes that may have different codon usages. Proteny analyses synteny at the exon level, so that more distant homologies can be revealed. As Proteny assigns a significance level to the detected syntenic clusters, it only requires setting a <italic>P</italic>-value cutoff and an intuitive parameter balancing the conservation ratio of the detected clusters.</p>
    <p>Traditionally, synteny is visualized using dot-matrix plots such as those in R2Cat (<xref rid="btv389-B14" ref-type="bibr">Husemann and Stoye, 2010</xref>) and SyMAP (<xref rid="btv389-B32" ref-type="bibr">Soderlund <italic>et</italic>
<italic>al.</italic>, 2011</xref>), which is useful to visualize the synteny between entire genomes but not when closely inspecting specific regions. Novel techniques such as (<xref rid="btv389-B29" ref-type="bibr">Shaw, 2008</xref>) can visualize synteny between many genomes at a lower level but quickly produces complicated figures when looking at very large regions or sufficiently different organisms. Easyfig (<xref rid="btv389-B33" ref-type="bibr">Sullivan <italic>et</italic>
<italic>al.</italic>, 2011</xref>) can look at different levels and can be used to annotate interesting regions; however, it must be done manually. Cinteny (<xref rid="btv389-B31" ref-type="bibr">Sinha and Meller, 2007</xref>) provides multi-level visualizations to display synteny between multiple organisms, but it cannot visualize exons. With Proteny, we also introduce a user-friendly visualization for examining the discovered syntenic regions, which are especially useful when genomes are more distant.</p>
    <p>Proteny is quantitatively benchmarked against a dataset from the Yeast Gene Order Browser that includes a gold standard of orthology relationships (<xref rid="btv389-B7" ref-type="bibr">Byrne and Wolfe, 2005</xref>), and it is compared to i-ADHoRe. We demonstrate the utility of Proteny on two fungal datasets: (i) two <italic>Aspergillus niger</italic> genomes that are known to be highly related, illustrating how Proteny can be used to explore the similarities and differences between two genomes and (ii) two mushroom forming fungi (of the phylum basidiomycota) <italic>Schizopyllum</italic>
<italic>commune</italic> and <italic>Agaricus bisporus</italic>, demonstrating the power of Proteny to detect syntenic regions between more distant genomes which also differ in their codon usage (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv389/-/DC1">Supplementary Material S1</ext-link>). As there is no gold standard for these datasets, we qualitatively analyze the discovered clusters.</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <sec>
      <title>2.1 General overview</title>
      <p>Proteny detects syntenic clusters by translating all exon regions into protein sequences and producing a set of BLASTp hits (<xref ref-type="fig" rid="btv389-F1">Fig. 1</xref>a). Proteny then calculates a distance between all hits based on genomic distance, resulting in a distance matrix. From this distance matrix, Proteny builds a dendrogram where each node represents a cluster of hits (<xref ref-type="fig" rid="btv389-F1">Fig. 1</xref>b). The dendrogram is traversed in a depth first procedure, searching for clusters with significant scores based on a statistical test. Each cluster is scored depending on the hits which are found within the cluster and the number of unaccounted exons (exons without hits) that lie within the genomic regions that the cluster covers. When a significant cluster is found (and its child is not <italic>more</italic> significant), the branch is cut (i.e. no smaller clusters are evaluated in that branch). Proteny terminates when no more significant clusters can be found, culminating in a set of significant clusters of hits (<xref ref-type="fig" rid="btv389-F1">Fig. 1</xref>c). These clusters can then be visualized by looking at the individual hits (<xref ref-type="fig" rid="btv389-F1">Fig. 1</xref>d) or at a higher level (<xref ref-type="fig" rid="btv389-F1">Fig. 1</xref>e).
<fig id="btv389-F1" orientation="portrait" position="float"><label>Fig. 1.</label><caption><p>An illustration of how Proteny works. (<bold>a</bold>) First, BLASTp is used to produce a set of hits, which are used to build (<bold>b</bold>) a dendrogram which is traversed to find (<bold>c</bold>) significant clusters (red boxes). (<bold>d</bold>) Individual hits are displayed (here in turquoise) in a region visualization, while (<bold>e</bold>) significant clusters are displayed (here in red) in a chromosome visualization</p></caption><graphic xlink:href="btv389f1p"/></fig></p>
    </sec>
    <sec>
      <title>2.2 Obtaining a mapping</title>
      <p>A mapping from organism β to organism γ is a set of pairs, whereby a locus in organism β is linked to a locus in organism γ. Proteny links loci on their translated sequence similarity. For that, all exons in each organism are translated to construct two BLAST databases (<xref rid="btv389-B1" ref-type="bibr">Altschul <italic>et</italic>
<italic>al.</italic>, 1997</xref>) and two sequence sets for each genome. A bi-directional BLASTp (using default parameters) then produces a mapping, i.e. a set of bi-directional hits <inline-formula><mml:math id="MM1"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math></inline-formula>, between sequences from the two organisms describing a similarity between two sequences. Consequently, a hit represents two regions, <inline-formula><mml:math id="MM2"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>γ</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, which correspond to the genomic location of subsequences of exons in the genomes of organisms β and γ, respectively. A region has a start and an end, i.e. <inline-formula><mml:math id="MM3"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>χ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>χ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>χ</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where χ corresponds to an organism. All these variables are clarified in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv389/-/DC1">Supplementary Figure S3a</ext-link>.</p>
    </sec>
    <sec>
      <title>2.3 Distances between hits</title>
      <p>To cluster hits, we need a definition of similarity between them, which we base on the distance between their associated regions. The distance between two regions on the same genome is given by <xref ref-type="disp-formula" rid="btv389-M1">Equation (1)</xref>.
<disp-formula id="btv389-M1"><label>(1)</label><mml:math id="MM4"><mml:mrow><mml:mtext>dist</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>χ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>χ</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>max</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>χ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>χ</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>min</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>χ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>χ</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
</p>
      <p>The distance between two hits is then defined as the sum of the distance between the two regions on one genome and the distance between the two regions on the other genome.
<disp-formula id="btv389-M2"><label>(2)</label><mml:math id="MM5"><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mtext>dist</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mtext>dist</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>γ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>γ</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
      <p>Note that when two regions overlap (i.e. their distance is zero), they do not contribute to the distance between two hits. <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv389/-/DC1">Supplementary Figure S3b</ext-link> illustrates the distance between two hits as the sum of the distances between the regions they involve. In <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv389/-/DC1">Supplementary Figure S3c</ext-link>, we see an example of an exon duplication and two hits referring to the same exon.</p>
    </sec>
    <sec>
      <title>2.4 Constructing a dendrogram</title>
      <p>Using this distance measure between hits, we construct a dendrogram through a single linkage hierarchical clustering. An example is shown in <xref ref-type="fig" rid="btv389-F1">Figure 1</xref>b. We first group all hits by the chromosomes on which the hits fall. For any pair of chromosomes (each on a different genome), Proteny builds a dendrogram, in which each node represents a cluster of hits. It is important to note that we cluster not exons but hits. This strategy may result in an exon being present in multiple clusters (and multiple dendrograms), allowing us to handle duplications.</p>
      <p>However, the height of the tree reflects only the density of hits not the quality of conservation within. Cutting the tree to produce clusters based on height alone will therefore not be sufficient. Instead, we define a cluster score which reflects our expectations of syntenic clusters.</p>
    </sec>
    <sec>
      <title>2.5 A cluster score</title>
      <p>As in <xref rid="btv389-B10" ref-type="bibr">Ghiurcuta and Moret (2014)</xref>, we consider a syntenic region good if it maximizes the similarity within the cluster and minimizes the similarity between them. We characterize each cluster with a cluster score, which describes the similarity within the cluster but is punished by the similarity to other regions. The similarity within the cluster is described by the quality of the hits which lie within the region, and the similarity to other regions is described by the quality of hits which fall within the genomic region defined by the cluster but have no hits within the cluster (unaccounted exons). The quality of a hit should reflect the coverage of the hit over the exons it covers and the significance of this hit. We therefore define a quality score <inline-formula><mml:math id="MM6"><mml:mrow><mml:mi>K</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for a hit <inline-formula><mml:math id="MM7"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math></inline-formula> between two exon sequences:
<disp-formula id="btv389-M3"><label>(3)</label><mml:math id="MM8"><mml:mrow><mml:mi>K</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>min</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>γ</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>γ</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="MM9"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>χ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is the exon the hit <italic>h<sub>i</sub></italic> refers to on genome χ, <inline-formula><mml:math id="MM10"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula> is the length of a given sequence or region and <inline-formula><mml:math id="MM11"><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the e-value of the hit. The ratio represents the fraction of the size of the exons which are covered by the hits, favoring hits which cover the whole exon. This ratio is multiplied by <inline-formula><mml:math id="MM12"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> to factor in the significance of the hit, so that insignificant hits will deteriorate the score. Note that <inline-formula><mml:math id="MM13"><mml:mrow><mml:mi>K</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> where 1 is the perfect score.</p>
      <p>Then, the cluster score, <italic>s</italic>(<italic>C</italic>), accumulates the hit scores for the hits within the cluster but is penalized by exons within the cluster which do not have a hit in the cluster <italic>C</italic>:
<disp-formula id="btv389-M4"><label>(4)</label><mml:math id="MM14"><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>·</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:munder><mml:mi>K</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msubsup><mml:mo>∪</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>γ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mi>K</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="MM15"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>χ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is the set of exons on genome χ which are located within cluster <italic>C</italic> but are unaccounted for within the cluster, and <italic>H<sub>e</sub></italic> are all the bi-directional BLASTp hits to exon <italic>e</italic> (for <italic>e</italic> from organism β or γ). If <italic>H<sub>e</sub></italic> is empty (i.e. the unaccounted exon has no hit to the other genome), then the cluster is not penalized (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv389/-/DC1">Supplementary Fig. S3d</ext-link>).</p>
      <p>Note that the penalization for unaccounted exons is based on the maximum hit score. The main motivation for this is that if an unaccounted exon has a better hit somewhere else then it should not be in the current cluster. However, if the unaccounted exon does not have a hit anywhere on the other genome (<italic>H<sub>e</sub></italic> being empty), then, without knowing anything more about it, it should not affect the cluster score.</p>
    </sec>
    <sec>
      <title>2.6 A dynamic cutting algorithm</title>
      <p>Proteny cuts the dendrogram at a given node depending upon the significance of the cluster score assigned to that node (see next section). However, some clusters contain so many good hits that they may contain many large gaps (unaccounted exons), while still being significant. To counter that, we restrict ourselves to clusters which satisfy a minimum ‘conservation ratio’, given by the user-specified parameter τ. The conservation ratio τ<italic><sub>C</sub></italic> of a cluster <italic>C</italic>, is defined as <inline-formula><mml:math id="MM16"><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>γ</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="MM17"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula>, the number of hits in the cluster, <inline-formula><mml:math id="MM18"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:msubsup><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msubsup><mml:mo>∩</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula>, the number of unaccounted exons on genome β which have a hit elsewhere and <inline-formula><mml:math id="MM19"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>γ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:msubsup><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>γ</mml:mi></mml:mrow></mml:msubsup><mml:mo>∩</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula>, the number of unaccounted exons on genome γ, that have a hit elsewhere.</p>
      <p>The dendrogram will therefore not be cut at a single height but at different heights depending on the significance and the conservation ratio. For such an approach, a ‘dynamic tree cut’, other methods exist (<xref rid="btv389-B18" ref-type="bibr">Langfelder <italic>et</italic>
<italic>al.</italic>, 2008</xref>; <xref rid="btv389-B20" ref-type="bibr">Mason <italic>et</italic>
<italic>al.</italic>, 2009</xref>), but those do not rely upon a statistical significance to cut. We use a greedy cutting algorithm, given in SE-8. Starting at the root node, check if the current node satisfies the conservation ratio and has a lower <italic>P</italic>-value than its child nodes. If both are true, and the node is significant, then we cut at this node and we do not descend further into the tree. Alternatively, if the current node is not significant or either of the child nodes have a lower <italic>P</italic> value and satisfy the conservation ratio, we descend instead to the children.</p>
    </sec>
    <sec>
      <title>2.7 Testing the significance of a cluster</title>
      <p>To calculate the significance of a cluster, we must build a null distribution of cluster scores. Other methods which calculate the statistical significance of a cluster such as <xref rid="btv389-B15" ref-type="bibr">Jahn <italic>et</italic>
<italic>al.</italic> (2013)</xref> do not take into account the similarity between clusters that our cluster score does. Therefore, we must build our own null distribution of cluster scores for each particular size of cluster (i.e. combination of <italic>n<sub>C</sub></italic>, <inline-formula><mml:math id="MM20"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM21"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>γ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>). Although a null distribution constructed from hits with random scores that are randomly distributed along the genome would be ideal, it is computationally infeasible as we would need to re-cluster at every iteration. Instead, we permute hit scores after the clustering, thereby assuming no fixed structure in successive hits, as would be the case if the hits were randomly distributed. Hence, the cluster score for one permutation becomes:
<disp-formula id="btv389-M5"><label>(5)</label><mml:math id="MM22"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>·</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo>−</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munderover><mml:mrow><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>*</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>γ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munderover><mml:mrow><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>γ</mml:mi><mml:mo>*</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where <italic>P<sub>k</sub></italic> is the <italic>k</italic>th element of a randomly shuffled list of all bi-directional BLASTp all bi-directional BLASTp hit scores <italic>H</italic> (created by random reordering), and <inline-formula><mml:math id="MM23"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>χ</mml:mi><mml:mo>*</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is the <italic>k</italic>th element of a randomly permuted list of only best bi-directional BLASTp hits for each exon in organism χ (by taking only the best hit for each exon).</p>
      <p><italic>P</italic> values can now easily be obtained by comparing the actual cluster score to the permuted scores. However, since many nodes in the dendrograms are tested, we need to correct for multiple testing. For a pair of organisms with <inline-formula><mml:math id="MM24"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula> hits between them, we would in the worst case perform <inline-formula><mml:math id="MM25"><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula> tests, calling for a Bonferroni correction of <inline-formula><mml:math id="MM26"><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula>. With such a correction, and a <italic>P</italic>-value threshold of α, at least <inline-formula><mml:math id="MM27"><mml:mrow><mml:mrow><mml:mo>⌈</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>⌉</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> permutations would be required just to achieve the resolution required to detect a cluster. This correction factor, and thereby the number of permutations can become very high, and we therefore wish to limit the number of permutations when possible.</p>
      <p>Unfortunately, the inheritance procedure of <xref rid="btv389-B11" ref-type="bibr">Goeman and Finos (2012)</xref>, which controls the family-wise error rate for hierarchical tests does not apply, since our problem does not fulfill the condition that significant tests must have significant parent tests. Similarly, the same condition for the false-discovery-rate correction for trees of <xref rid="btv389-B36" ref-type="bibr">Yekutieli (2008)</xref> is not met. We integrate four approaches which help us making the number of permutations more tractable.</p>
      <sec>
        <title>2.7.1 Not considering all clusters</title>
        <p>As we are interested in synteny (beyond homology statements between genes), we are not interested in clusters which are smaller than two genes, nodes in the dendrogram which contain fewer than two genes are not tested.</p>
      </sec>
      <sec>
        <title>2.7.2 Early stopping</title>
        <p>We can apply the method of <xref rid="btv389-B16" ref-type="bibr">Knijnenburg <italic>et</italic>
<italic>al.</italic> (2009)</xref>, to limit further permutations when the number of exceedences is already sufficient. The cluster which is then not significant, will never be significant with more permutations. As we only wish to detect significant clusters, we can apply this strategy.</p>
      </sec>
      <sec>
        <title>2.7.3 Analytical solution</title>
        <p>If a cluster is large enough (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv389/-/DC1">Supplementary Material S4.1</ext-link>), we can make use of an analytical description of the null distribution, based on the central limit theorem (CLT) described in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv389/-/DC1">Supplementary Equation S6</ext-link>. The cluster score is a sum of three different distributions, each component being a summation over random variables. Consequently, where possible, we use the CLT approximation for the null distribution. We revert to the permutation method if the cluster size is too small.</p>
      </sec>
      <sec>
        <title>2.7.4 Dynamic correction</title>
        <p>Rather than using a worst-case multiple testing scenario to determine the number of tests to correct for, we determine the number of tests dynamically. That is, we start out by setting the initial number of tests to 1, and, following the dynamic cutting algorithm (SE-8), we increase the correction factor only when we descend to a child node in the tree. Alternatively, if a node is called significant, we do not need to increase the correction factor.</p>
        <p>For insignificant nodes, this is always allowed since it will only be <italic>more</italic> insignificant at higher correction factors. However, significant nodes will have to be revisited (since with the larger correction factor, they may become insignificant). The advantage here is that when we need to revisit a node, we only need to do the additional permutations; i.e. we can still make use of the earlier permutations. This procedure is performed iteratively until no further tests are performed.</p>
      </sec>
    </sec>
    <sec>
      <title>2.8 Visualization</title>
      <p>Proteny provides two different types of visualization: (i) a <italic>chromosome</italic>-level visualization and (ii) a <italic>region</italic>-level visualization. Chromosome-level visualizations allow us to have an overview of the relationships between two genomes. In this visualization (e.g. <xref ref-type="fig" rid="btv389-F3">Fig. 3</xref>), the outer ring is the genome, the inner ring represents the genes (blue and orange representing genes on the forward and reverse strand, respectively) and the ribbons between two loci represent a conserved cluster. The query chromosome is shown first, in a clockwise-fashion from 12 O’clock onward.</p>
      <p>The region-level visualizations show only a few loci from both genomes (e.g. <xref ref-type="fig" rid="btv389-F4">Fig. 4</xref>e). Again, the outer ring represents the regions on the genome and the inner ring represents genes. Now, additional green boxes within the genes represent exons. The intensity of each link represents the quality score <inline-formula><mml:math id="MM28"><mml:mrow><mml:mi>K</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of the hit. The ribbons no longer represent clusters, rather, they are the original BLASTp hits between exons.</p>
    </sec>
    <sec>
      <title>2.9 Implementation details</title>
      <p>For data handling, we use the Ibidas (<xref rid="btv389-B13" ref-type="bibr">Hulsman <italic>et</italic>
<italic>al.</italic>, 2013</xref>) data query and manipulation suite, and the Circos (<xref rid="btv389-B17" ref-type="bibr">Krzywinski <italic>et</italic>
<italic>al.</italic>, 2009</xref>) utility is used to visualize the discovered clusters. For more information, see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv389/-/DC1">Supplementary Material S6</ext-link>.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Yeast gene order browser dataset</title>
      <p>The YGOB (<xref rid="btv389-B7" ref-type="bibr">Byrne and Wolfe, 2005</xref>) provides a ground truth through a large set of ortholog relationships between 20 yeast genomes. We use the data and scores described in <xref rid="btv389-B10" ref-type="bibr">Ghiurcuta and Moret (2014)</xref> to compare Proteny to i-ADHoRe. Since Proteny performs a pairwise synteny discovery analysis, the two scores are equivalent. We use the same parameters for i-ADHoRe and fasta36 (<xref rid="btv389-B26" ref-type="bibr">Pearson, 1998</xref>) as given in <xref rid="btv389-B10" ref-type="bibr">Ghiurcuta and Moret (2014)</xref>. For Proteny, a <italic>P</italic>-value threshold of 0.05 and a conservation threshold of 1. We score the clusters that i-adhore and Proteny find using the relaxed score in (<xref rid="btv389-B10" ref-type="bibr">Ghiurcuta and Moret, 2014</xref>).</p>
      <p><xref ref-type="fig" rid="btv389-F2">Figure 2</xref> shows the means of the relaxed scores for all clusters in each of the pairwise tests for both Proteny and i-ADHoRe. Proteny had a higher average cluster score in 16 out of 28 experiments. In 15 of these, the relaxed cluster score distributions were significantly different (by a Bonferroni corrected Kolmogorov–Smirnov test), see also <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv389/-/DC1">Supplementary Figure S12c</ext-link>. Although i-ADHoRe had higher average relaxed scores in 12 experiments, in 10 of these cases, the distributions of relaxed scores are not significantly different. Based on this, Proteny either performs comparably to or outperforms i-ADHoRe on this dataset.
<fig id="btv389-F2" orientation="portrait" position="float"><label>Fig. 2.</label><caption><p>The means and their standard deviations of relaxed scores across all syntenic clusters for Proteny (<italic>y</italic>-axis) and i-ADHoRe (<italic>x</italic>-axis) clusters, for each pairwise test. Red points are cases where the relaxed score distributions are not significantly different between Proteny and i-ADHoRe (<italic>q</italic> &lt; 0.5 Kolmogorov–Smirnov test with Bonferroni multiple testing correction)</p></caption><graphic xlink:href="btv389f2p"/></fig></p>
    </sec>
    <sec>
      <title>3.2 Aspergillus niger</title>
      <p>We study two strains of <italic>A.</italic><italic>niger</italic>, which have been separated by 50 years of evolution, n402 and CBS513.88. CBS513.88 is an industrial strain, which is used as a cell factory for enzyme and metabolite production, while n402 is a laboratory strain used in research. We use this to demonstrate the performance of the method. Since we know that the two strains must be highly related, we expect to find large similarities between the two genomes. The <italic>A.</italic><italic>niger</italic> CBS513.88 genome (<xref rid="btv389-B27" ref-type="bibr">Pel <italic>et</italic>
<italic>al.</italic>, 2007</xref>) and annotation were retrieved from the Aspergillus genome database (<xref rid="btv389-B4" ref-type="bibr">Arnaud <italic>et</italic>
<italic>al.</italic>, 2010</xref>). The <italic>de novo</italic> genome sequence of laboratory strain <italic>A.niger</italic> n402 was unpublished at time of writing (see Acknowledgements). The n402 strain has 13 612 genes, whereas the industrial strain CBS513.88 has 14 067 genes. Because of incomplete genome assemblies, we deal with scaffolds rather than chromosomes. The n402 and CBS513.88 strains have 24 and 19 scaffolds, respectively. For this dataset, we set τ = 2, because we assume that the two strains are quite similar.</p>
      <sec>
        <title>3.2.1 General synteny</title>
        <p>Proteny finds high conservation between the two strains. In total, Proteny finds 119 syntenic clusters, covering 10 880 n402 genes and 10 956 genes in CBS513.88 (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv389/-/DC1">Supplementary Table S2</ext-link>). We compare Proteny’s results to those of i-ADHoRe, as it is the only tool that also works on the protein level and is not specifically designed for similar genomes. i-ADHoRe finds 189 syntenic clusters, covering 9667 (9310 in common with Proteny) and 9728 genes (9343 in common) from the n402 and CBS513.88 strains, respectively. We find that 66.5% of the area covered by the clusters discovered by Proteny and i-ADHoRe is found by both algorithms.</p>
        <p>By calculating the score for each i-ADHoRe cluster using our scoring function, we find that only 93 (49.2%) of the clusters that i-ADHoRe finds are significant (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv389/-/DC1">Supplementary Table S6</ext-link>), and most have a very small conservation ratio (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv389/-/DC1">Supplementary Fig. S10b</ext-link>). Furthermore, we see in <xref ref-type="fig" rid="btv389-F4">Figure 4</xref>f, that Proteny generally has more genes in i-ADHoRe clusters of the same size. From this we conclude that Proteny finds more genes in fewer clusters. Apparently, Proteny discovers informative clusters that tightly describe the syntenic genes.</p>
      </sec>
      <sec>
        <title>3.2.2 Identifying a genome rearrangement</title>
        <p><xref ref-type="fig" rid="btv389-F3">Figure 3</xref>a and b shows the syntenic clusters Proteny discovers for n402 scaffolds 5 and 6, respectively. These figures show that <italic>A.niger</italic>n402 was formed by a rearrangement: parts 5<italic>A</italic> and 12<italic>A</italic> from CBS513.88 (<xref ref-type="fig" rid="btv389-F3">Fig. 3</xref>a) have fused together to form scaffold 5 in the n402 strain. Likewise, scaffold 6 from n402 was formed by the fusion of parts 5<italic>B</italic> and 12<italic>B</italic> (<xref ref-type="fig" rid="btv389-F3">Fig. 3</xref>b). From these detected syntenic regions, one can conclude that scaffolds 5 and 12 of CBS513.88 have split in two and fused together over time to form two scaffolds in n402. When comparing with i-ADHoRe (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv389/-/DC1">Supplementary Fig. S5a–c</ext-link>), we see that Proteny gives a clearer synteny (i.e. i-ADHoRe is cluttered with other supposed syntenies), and at the same time, Proteny gives more detail on the fused or separated syntenic regions.
<fig id="btv389-F3" orientation="portrait" position="float"><label>Fig. 3.</label><caption><p>Syntenic clusters found for <italic>S.commune</italic> on (<bold>a</bold>) scaffold 5, (<bold>b</bold>) scaffold 6 and (<bold>c</bold>) scaffold 7 in n402. For scaffolds 5 and 6, one can see that n402 has undergone a rearrangement</p></caption><graphic xlink:href="btv389f3p"/></fig>
<fig id="btv389-F4" orientation="portrait" position="float"><label>Fig. 4.</label><caption><p>(<bold>a</bold>) The synteny between scaffold 2 in <italic>S.commune</italic> and the scaffolds in <italic>A.bisporus.</italic> (<bold>b</bold>) The hits between scaffold 2 in <italic>S.commune</italic> and scaffold 2 in <italic>A.bisporus</italic> show a scattered synteny. (<bold>c</bold>) The syntenic relationships between scaffold 1 in <italic>S.commune</italic> and the scaffolds in <italic>A.bisporus.</italic> The three scaffolds 1, 4 and 14 share a lot in common with scaffold 1 in <italic>S.commune</italic>, and it follows that, at some point the two species diverged when the scaffold split in the branch of <italic>A.bisporus</italic> but not in the branch of <italic>S.commune.</italic> (<bold>d</bold>) There is an interesting region on scaffold 8 of <italic>S.commune.</italic> (<bold>e</bold>) A repeated gene elucidates a divergent trait between <italic>A.bisporus</italic> and <italic>S.commune.</italic> (<bold>f</bold>) A Proteny cluster of a given size generally has more genes than an i-ADHoRe cluster of the same size. In this figure, ‘<italic>basid’</italic> refers to the basidiomycete analysis, and ‘<italic>aspni’</italic> refers to the <italic>A.niger</italic> analysis. It can be seen in this figure that Proteny cluster gene densities are higher than those of i-ADHoRe and a <italic>t</italic>-test with unequal variance assumptions states that the distributions of cluster scores are separated with a <italic>P</italic> value of <inline-formula><mml:math id="MM29"><mml:mrow><mml:mn>9.1</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>75</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></p></caption><graphic xlink:href="btv389f4p"/></fig></p>
      </sec>
      <sec>
        <title>3.2.3 Assisting genome assembly</title>
        <p>Proteny can also assist in genome assembly. By studying the visualizations, we can quickly inform ourselves about the results of an assembly. <xref ref-type="fig" rid="btv389-F3">Figure 3</xref>c shows that scaffold 7 of n402 maps to part 5<italic>C</italic> from CBS513.88, whereas according to <xref ref-type="fig" rid="btv389-F3">Figure 3</xref>b, scaffold 6 of n402 maps to the connecting part 5<italic>B</italic> in CBS513.88. This indicates that scaffolds 6 and 7 in the n402 assembly could be joined together.</p>
        <p>The effect is even more pronounced in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv389/-/DC1">Supplementary Figure S7a–c</ext-link>. We see that three chromosomes in n402 map to a single chromosome in the CBS513.88 genome. Proteny can guide an assembly and suggest that they be joined together in the n402 genome, as in the CBS513.88 genome.</p>
      </sec>
    </sec>
    <sec>
      <title>3.3 Basidiomycota</title>
      <p>Next, we applied Proteny to <italic>S.</italic><italic>commune </italic>(<xref rid="btv389-B23" ref-type="bibr">Ohm <italic>et</italic>
<italic>al.</italic>, 2010</xref>), a model organism for mushroom formation, and <italic>A.</italic><italic>bisporus </italic>(<xref rid="btv389-B5" ref-type="bibr">Baker <italic>et</italic>
<italic>al.</italic>, 2013</xref>), which is a commercially valuable mushroom but has a relatively large evolutionary distance to <italic>S.commune.</italic> We retrieved the genomes and genome annotation files for <italic>S.</italic><italic>commune</italic><inline-formula><mml:math id="MM30"><mml:mrow><mml:mi>v</mml:mi><mml:mn>2.0</mml:mn></mml:mrow></mml:math></inline-formula> and <italic>A.</italic><italic>bisporus</italic><inline-formula><mml:math id="MM31"><mml:mrow><mml:mi>v</mml:mi><mml:mn>2.0</mml:mn></mml:mrow></mml:math></inline-formula> from the JGI genome portal (<xref rid="btv389-B12" ref-type="bibr">Grigoriev <italic>et</italic>
<italic>al.</italic>, 2012</xref>). <italic>S.</italic><italic>commune</italic> has 14 652 genes, and <italic>A.</italic><italic>bisporus</italic> has 10 438 genes. As before, these organisms have incomplete genome assemblies, with 36 and 31 scaffolds, respectively. For this experiment, we set τ = 1, because while we assume a lot of divergence, we are interested in conserved clusters.</p>
      <sec>
        <title>3.3.1 General synteny</title>
        <p>Proteny finds 345 significant clusters, covering 5828 <italic>S.</italic><italic>commune</italic> genes lying within conserved regions, and 4572 <italic>A.</italic><italic>bisporus</italic> genes (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv389/-/DC1">Supplementary Table S2</ext-link>). Many exons do not have a bi-directional BLASTp hit, resulting in many smaller clusters. i-ADHoRe discovers 377 clusters which cover 2588 <italic>S.</italic><italic>commune</italic> genes (2889 in common with Proteny) and 4090 <italic>A.</italic><italic>bisporus</italic> genes (2662 in common). The area (41.4%) covered by the clusters discovered by Proteny and i-ADHoRe is found by both algorithms. From these clusters (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv389/-/DC1">Supplementary Table S7</ext-link>), we find that, using our scoring function, only 327 (57.1%) i-ADHoRe clusters are significant. The reason we find so many more genes than i-ADHoRe stems from the orderless detection of the clusters. The results from Proteny show that although both mushrooms are evolutionarily distant, a large portion of the genes remain conserved.</p>
        <p><xref ref-type="fig" rid="btv389-F4">Figure 4</xref>f shows the genomic size of a Proteny cluster is smaller than that of an i-ADHoRe cluster containing the same number of genes. The figure also shows that a Proteny cluster of a given size generally has more genes than an i-ADHoRe cluster of the same size. i-ADHoRe clusters contain more unaccounted exons (gaps), confirmed by <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv389/-/DC1">Supplementary Figure S10b</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv389/-/DC1">e</ext-link>. Again, we conclude that Proteny finds fewer clusters which harbor more genes.</p>
      </sec>
      <sec>
        <title>3.3.2 Large similarities</title>
        <p>We even observe large similarities between the diverged genomes, as shown in <xref ref-type="fig" rid="btv389-F4">Figure 4</xref>a between scaffold 2 in <italic>S.</italic><italic>commune</italic> and scaffold 2 in <italic>A.bisporus.</italic> When we look at this cluster more closely in <xref ref-type="fig" rid="btv389-F4">Figure 4</xref>b, we see that the hits are very dense. <xref ref-type="fig" rid="btv389-F4">Figure 4</xref>a also shows that Proteny results in a much clearer synteny between the scaffolds than i-ADHoRe (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv389/-/DC1">Supplementary Fig. S6b</ext-link>), which includes many other clusters which occlude the results. This can be attributed to the result of the orderless synteny detection of Proteny. i-ADHoRe discovers more clusters, which contain large stretches of gaps between genes. For example, the additional cluster between chromosome 2 in <italic>S.</italic><italic>commune</italic> and chromosome 7 in <italic>A.</italic><italic>bisporus</italic> seen in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv389/-/DC1">Supplementary Figure S6b</ext-link>, which is not found by Proteny in <xref ref-type="fig" rid="btv389-F4">Figure 4</xref>a, contains only a few spurious hits between a few genes with many unaccounted exons (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv389/-/DC1">Supplementary Table S6</ext-link>, no. 141).</p>
      </sec>
      <sec>
        <title>3.3.3 Scattered synteny</title>
        <p><xref ref-type="fig" rid="btv389-F4">Figure 4</xref>c shows that scaffold 1 of the <italic>S.</italic><italic>commune</italic> assembly consists primarily of three scaffolds in the <italic>A.</italic><italic>bisporus</italic> assembly, over a number of syntenic blocks. Clearly, the three <italic>A.</italic><italic>bisporus</italic> scaffolds 1, 4 and 14 have a lot in common with scaffold 1 in <italic>S.commune</italic>, and it follows that at some point the two species diverged when the scaffold split in the branch of <italic>A.bisporus</italic> but not in the branch of <italic>S.commune.</italic> Alternatively, the ‘scattered’ effect may be the result of an incorrect assembly of scaffolds 1, 4 and 14 in <italic>A.bisporus.</italic> Note that despite the syntenic regions between the two fungi being highly scattered, Proteny is able to detect the syntenic relationships and the visualizations allow us to explore the discovered clusters. For i-ADHoRe, the results are harder to examine, see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv389/-/DC1">Supplementary Figure S6a</ext-link>.</p>
      </sec>
      <sec>
        <title>3.3.4 Gene duplication</title>
        <p><xref ref-type="fig" rid="btv389-F4">Figure 4</xref>d shows the syntenic clusters detected in scaffold 8 of <italic>S.commune.</italic> We see an interesting phenomenon here: there is a region in <italic>S.</italic><italic>commune,</italic> which is repeated several times in <italic>A.bisporus.</italic>
<xref ref-type="fig" rid="btv389-F4">Figure 4</xref>e zooms in on this region. Here it becomes clear that there are three genes which are duplicated many times in <italic>A.bisporus.</italic> These genes are cytochrome P450 monooxygenases, which are involved in metabolism detoxification (<xref rid="btv389-B8" ref-type="bibr">Crešnar and Petrič, 2011</xref>), and are expected to be involved in the detoxification of byproducts from lignin degradation. The fact that <italic>S.</italic><italic>commune</italic> has fewer copies of the P450 compared with <italic>A.</italic><italic>bisporus</italic> highlights the fact that <italic>S.</italic><italic>commune</italic> does not have the ability to degrade lignin, while <italic>A.</italic><italic>bisporus</italic> does. The speciation event which separated <italic>S.</italic><italic>commune</italic> and <italic>A.</italic><italic>bisporus</italic> came before <italic>A.</italic><italic>bisporus</italic> was able to degrade lignin and can be derived from the number of P450 copies in <italic>A.bisporus.</italic>
<xref ref-type="fig" rid="btv389-F4">Figure 4</xref>e reveals that many of these duplications are not entirely conserved, often exons are missing or new ones are there instead, exemplifying the benefit of the exon-level analysis. This again shows the capabilities of Proteny (i-ADHoRe does not detect this region, <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv389/-/DC1">Supplementary Fig. S6c</ext-link>).</p>
      </sec>
      <sec>
        <title>3.3.5 Developmental proteins are conserved</title>
        <p>We are particularly interested in eight transcription factors and a light sensing protein which have been linked to mushroom formation in <italic>S.commune </italic>(<xref rid="btv389-B24" ref-type="bibr">Ohm <italic>et</italic>
<italic>al.</italic>, 2012</xref>). To increase the confidence that these transcription factors are functionally similar in both <italic>S.</italic><italic>commune</italic> and <italic>A.bisporus</italic>, we wish to find that these genes lie in syntenic regions. Proteny reveals that six of these nine developmental proteins lie within conserved clusters. <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv389/-/DC1">Supplementary Figure S8c</ext-link> shows the region-level plot for the cluster which contains the transcription factor <italic>gat1.</italic> The figure clearly shows that the transcription factor lies in a well-conserved region, i.e. neighboring genes in <italic>A.</italic><italic>bisporus</italic> match to neighboring genes in <italic>S.commune.</italic>
<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv389/-/DC1">Supplementary Figure S8</ext-link> shows the region-level plots for the clusters of the other developmental proteins found in syntenic clusters, and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv389/-/DC1">Supplementary Figure S9</ext-link> shows the developmental proteins which were <italic>not</italic> found.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>We presented Proteny, a methodology which identifies significant conserved syntenic clusters of exons between two genomes through a novel method for cutting dendrograms and a new dynamic multiple testing correction algorithm. Knowledge of the discovered clusters allow us to uncover genome rearrangement events (as shown for both the <italic>A.</italic><italic>niger</italic> strains and the Basidiomycota), make more motivated statements about functional conservation (as for <italic>S.commune</italic>), identify possible errors in the assembly of related genomes (like in <italic>A.niger</italic>) and study the evolution between species (as in looking at the cytochrome P450 monooxygenases in <italic>A.</italic><italic>bisporus</italic> and <italic>S.commune</italic>).</p>
    <p>When comparing with i-ADHoRe, the most competitive tool, on a ground truth dataset, we find Proteny outperforms i-ADHoRe. Qualitatively, we observe that i-ADHoRe finds more clusters, covering fewer genes than Proteny clusters. Proteny finds gene-dense clusters of high quality, as verified by the cluster scores achieved by Proteny on the YGOB dataset. This can be attributed to the statistical testing procedure and the conservation ratio we enforce in Proteny.</p>
    <p>One practical advantage of Proteny over other synteny tools is that, besides the BLASTp settings (for which we used default values in our experiments), it only requires specifying a significance threshold (which can be set by statistical reasoning) and a conservation ratio parameter τ. It should be noted that Proteny could work with other aligners also and that BLASTp could be replaced by other protein sequence aligner.</p>
    <p>On the other hand, i-ADHoRe and many other tools are able to perform an analysis on more than two genomes at a time. Proteny could be generalized towards any number of species by a progressive heuristic similar to the star multiple alignment heuristic (<xref rid="btv389-B2" ref-type="bibr">Altschul and Lipman, 1989</xref>), which uses a central sequence with pairwise sequence alignments to guide the multiple alignment.</p>
    <p>It is important to note that the cluster score of Proteny does not account for the conservation of the order of the exons within the cluster. This can most prominently be seen in the synteny between scaffold 2 of <italic>S.</italic><italic>commune</italic> and scaffold 2 of <italic>A.bisporus</italic> (<xref ref-type="fig" rid="btv389-F4">Fig. 4</xref>a and b), where the order of the hits is scrambled. Although the ordering of the exons does play a role when constructing the dendrogram (nearby hits are merged first), we chose that the ordering should not play a role when scoring the clusters. This was a deliberate choice since Proteny was designed to find synteny between relatively divergent organisms in a microbiology context where evolution is fast; insertions, inversions, strand changes and gene shuffling occur frequently. Clearly, in other problem settings, the order may be important, in which case the cluster score in Proteny should be adjusted. However, one should be careful when designing a corresponding permutation scheme, e.g. a circular permutation of hit scores to preserve the order of hits in that set, as this might result in computational difficulties, as (e.g.) the CLT approximation will not hold anymore.</p>
    <p>By searching for synteny at the exon level, we exclude the influence of noncoding regions of the genome, which are typically not well conserved between divergent genomes. While an analysis at the gene level is interesting, we reasoned that it makes more sense to look at the conservation of individual exons within the gene. The region-level visualizations indeed show that conservation is higher at the exon level than at the gene level, i.e. some exons may be missing, making the gene less conserved, while individual exons are conserved.</p>
    <p>The ability to give each cluster a <italic>P</italic> value is an important contribution. However, the null distribution assumes that there is a completely random relationship between the organisms, which is not true. Currently, the τ parameter, representing a lower bound on their conservation ratio (in terms of the ratio of conserved and non-conserved exons) is used to regulate the clusters. Future contributions could develop a null model which takes into account evolution between two species. For example, a better permutation may shuffle groups of exons (genes), rather than individual exons. Yet as indicated earlier, this will give rise to computational difficulties.</p>
    <p>Another important consideration is that exons which do not have a hit with the other organism increase the distance between hits when constructing the dendrogram, but they do not penalize the cluster score. Again, this was a deliberate choice to be less sensitive to evolutionary insertions and deletions but could be changed by using a different distance measure.</p>
    <p>Altogether, Proteny is a powerful tool which can detect synteny between relatively divergent genomes at the amino acid sequence level. It detects clusters of exons based on a significance test and provides a rich visualization which supports the interpretation of the detected syntenic regions.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_31_21_3437__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btv389_supp.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Marc Hulsman for making the <italic>A.niger</italic>n402 genome available, for valuable discussions during the development of the algorithm and for the Ibidas data query and manipulation suite (<xref rid="btv389-B13" ref-type="bibr">Hulsman <italic>et al.</italic>, 2013</xref>). We also thank Han A.B. Wösten and Jordi F. Pelkmans for their reflections on the results and visualizations.</p>
  </ack>
  <sec>
    <title>Funding</title>
    <p>This research is supported by the <funding-source>Dutch Technology Foundation</funding-source> STW, which is part of the Netherlands Organisation for Scientific Research (NWO), and which is partly funded by the <funding-source>Ministry of Economic Affairs</funding-source>.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="btv389-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altschul</surname><given-names>S.F.</given-names></name><etal/></person-group> (<year>1997</year>) <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>. <source>Nucleic Acids Res.</source>, <volume>25</volume>, <fpage>3389</fpage>–<lpage>3402</lpage>.<pub-id pub-id-type="pmid">9254694</pub-id></mixed-citation>
    </ref>
    <ref id="btv389-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altschul</surname><given-names>S.F.</given-names></name><name><surname>Lipman</surname><given-names>D.J.</given-names></name></person-group> (<year>1989</year>) <article-title>Trees, stars, and multiple biological sequence alignment</article-title>. <source>SIAM J. Appl. Math.</source>, <volume>49</volume>, <fpage>197</fpage>–<lpage>209</lpage>.</mixed-citation>
    </ref>
    <ref id="btv389-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Angiuoli</surname><given-names>S.V.</given-names></name><name><surname>Salzberg</surname><given-names>S.L.</given-names></name></person-group> (<year>2011</year>) <article-title>Mugsy: fast multiple alignment of closely related whole genomes</article-title>. <source>Bioinformatics</source>, <volume>27</volume>, <fpage>334</fpage>–<lpage>342</lpage>.<pub-id pub-id-type="pmid">21148543</pub-id></mixed-citation>
    </ref>
    <ref id="btv389-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arnaud</surname><given-names>M.B.</given-names></name><etal/></person-group> (<year>2010</year>) <article-title>The Aspergillus Genome Database, a curated comparative genomics resource for gene, protein and sequence information for the <italic>Aspergillus</italic> research community</article-title>. <source>Nucleic Acids Res.</source>, <volume>38</volume>(<issue>Database Issue</issue>), <fpage>D420</fpage>–<lpage>D427</lpage>.<pub-id pub-id-type="pmid">19773420</pub-id></mixed-citation>
    </ref>
    <ref id="btv389-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baker</surname><given-names>A.R.</given-names></name><etal/></person-group> (<year>2013</year>) <article-title>Genome sequence of the button mushroom <italic>Agaricus bisporus</italic> reveals mechanisms governing adaptation to a humic-rich ecological niche</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>110</volume>, <fpage>4146</fpage>.</mixed-citation>
    </ref>
    <ref id="btv389-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blanchette</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2004</year>) <article-title>Aligning multiple genomic sequences with the threaded blockset aligner</article-title>. <source>Genome Res.</source>, <volume>14</volume>, <fpage>708</fpage>–<lpage>715</lpage>.<pub-id pub-id-type="pmid">15060014</pub-id></mixed-citation>
    </ref>
    <ref id="btv389-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Byrne</surname><given-names>K.P.</given-names></name><name><surname>Wolfe</surname><given-names>K.H.</given-names></name></person-group> (<year>2005</year>) <article-title>The Yeast Gene Order Browser: combining curated homology and syntenic context reveals gene fate in polyploid species</article-title>. <source>Genome Res.</source>, <volume>15</volume>, <fpage>1456</fpage>–<lpage>1461</lpage>.<pub-id pub-id-type="pmid">16169922</pub-id></mixed-citation>
    </ref>
    <ref id="btv389-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crešnar</surname><given-names>B.</given-names></name><name><surname>Petrič</surname><given-names>S.</given-names></name></person-group> (<year>2011</year>) <article-title>Cytochrome P450 enzymes in the fungal kingdom</article-title>. <source>Biochim. Biophys. Acta</source>, <volume>1814</volume>, <fpage>29</fpage>–<lpage>35</lpage>.<pub-id pub-id-type="pmid">20619366</pub-id></mixed-citation>
    </ref>
    <ref id="btv389-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Darling</surname><given-names>A.C.E.</given-names></name><etal/></person-group> (<year>2004</year>) <article-title>Mauve: multiple alignment of conserved genomic sequence with rearrangements</article-title>. <source>Genome Res.</source>, <volume>14</volume>, <fpage>1394</fpage>–<lpage>1403</lpage>.<pub-id pub-id-type="pmid">15231754</pub-id></mixed-citation>
    </ref>
    <ref id="btv389-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ghiurcuta</surname><given-names>C.G.</given-names></name><name><surname>Moret</surname><given-names>B.M.E.</given-names></name></person-group> (<year>2014</year>) <article-title>Evaluating synteny for improved comparative studies</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>i9</fpage>–<lpage>i18</lpage>.<pub-id pub-id-type="pmid">24932010</pub-id></mixed-citation>
    </ref>
    <ref id="btv389-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goeman</surname><given-names>J.J.</given-names></name><name><surname>Finos</surname><given-names>L.</given-names></name></person-group> (<year>2012</year>) <article-title>The inheritance procedure: multiple testing of tree-structured hypotheses</article-title>. <source>Stat. Appl. Genet. Mol. Biol.</source>, <volume>11</volume>, <fpage>Article 11</fpage>.<pub-id pub-id-type="pmid">22499687</pub-id></mixed-citation>
    </ref>
    <ref id="btv389-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grigoriev</surname><given-names>I.V.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>The genome portal of the Department of Energy Joint Genome Institute</article-title>. <source>Nucleic Acids Res.</source>, <volume>40</volume>(<issue>Database issue</issue>), <fpage>D26</fpage>–<lpage>D32</lpage>.<pub-id pub-id-type="pmid">22110030</pub-id></mixed-citation>
    </ref>
    <ref id="btv389-B13">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Hulsman</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2013</year>) <article-title>Ibidas: querying flexible data structures to explore heterogeneous bioinformatics data</article-title>. In: <person-group person-group-type="editor"><name><surname>Baker</surname><given-names>C.J.O.</given-names></name><etal/></person-group> (eds.) <source>Data Integration in the Life Sciences</source>, <publisher-name>Springer</publisher-name>, <publisher-loc>Berlin Heidelberg</publisher-loc>, pp. <fpage>23</fpage>–<lpage>37</lpage>.</mixed-citation>
    </ref>
    <ref id="btv389-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Husemann</surname><given-names>P.</given-names></name><name><surname>Stoye</surname><given-names>J.</given-names></name></person-group> (<year>2010</year>) <article-title>R2Cat: synteny plots and comparative assembly</article-title>. <source>Bioinformatics</source>, <volume>26</volume>, <fpage>570</fpage>–<lpage>571</lpage>.<pub-id pub-id-type="pmid">20015948</pub-id></mixed-citation>
    </ref>
    <ref id="btv389-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jahn</surname><given-names>K.</given-names></name><etal/></person-group> (<year>2013</year>) <article-title>Statistics for approximate gene clusters</article-title>. <source>BMC Bioinformatics</source>, <volume>14</volume>(<issue>Suppl. 15</issue>), <fpage>S14</fpage>.<pub-id pub-id-type="pmid">24564620</pub-id></mixed-citation>
    </ref>
    <ref id="btv389-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Knijnenburg</surname><given-names>T.A.</given-names></name><etal/></person-group> (<year>2009</year>) <article-title>Fewer permutations, more accurate P-values</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>i161</fpage>–<lpage>i168</lpage>.<pub-id pub-id-type="pmid">19477983</pub-id></mixed-citation>
    </ref>
    <ref id="btv389-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krzywinski</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2009</year>) <article-title>Circos: an information aesthetic for comparative genomics</article-title>. <source>Genome Res.</source>, <volume>19</volume>, <fpage>1639</fpage>–<lpage>1645</lpage>.<pub-id pub-id-type="pmid">19541911</pub-id></mixed-citation>
    </ref>
    <ref id="btv389-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langfelder</surname><given-names>P.</given-names></name><etal/></person-group> (<year>2008</year>) <article-title>Defining clusters from a hierarchical cluster tree: the Dynamic Tree Cut package for R</article-title>. <source>Bioinformatics</source>, <volume>24</volume>, <fpage>719</fpage>–<lpage>720</lpage>.<pub-id pub-id-type="pmid">18024473</pub-id></mixed-citation>
    </ref>
    <ref id="btv389-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Long</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2003</year>) <article-title>The origin of new genes: glimpses from the young and old</article-title>. <source>Nat. Rev. Genet.</source>, <volume>4</volume>, <fpage>865</fpage>–<lpage>875</lpage>.<pub-id pub-id-type="pmid">14634634</pub-id></mixed-citation>
    </ref>
    <ref id="btv389-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mason</surname><given-names>M.J.</given-names></name><etal/></person-group> (<year>2009</year>) <article-title>Signed weighted gene co-expression network analysis of transcriptional regulation in murine embryonic stem cells</article-title>. <source>BMC Genomics</source>, <volume>10</volume>, <fpage>327</fpage>.<pub-id pub-id-type="pmid">19619308</pub-id></mixed-citation>
    </ref>
    <ref id="btv389-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McClean</surname><given-names>P.E.</given-names></name><etal/></person-group> (<year>2010</year>) <article-title>Synteny mapping between common bean and soybean reveals extensive blocks of shared loci</article-title>. <source>BMC Genomics</source>, <volume>11</volume>, <fpage>184</fpage>.<pub-id pub-id-type="pmid">20298570</pub-id></mixed-citation>
    </ref>
    <ref id="btv389-B22">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Minkin</surname><given-names>I.</given-names></name><etal/></person-group> (<year>2013</year>) <article-title>Sibelia: a scalable and comprehensive synteny block generation tool for closely related microbial genomes</article-title>. In: <person-group person-group-type="author"><name><surname>Aaron</surname><given-names>D.</given-names></name><name><surname>Jens</surname><given-names>S.</given-names></name><etal/></person-group> (eds.) <source>Proceedings of the 13th Workshop Algorithms in Bioinformatics (WABI'13)</source>, <comment>Vol. 8126 of Lecture Notes in Computer Science</comment> pp. <fpage>215</fpage>–<lpage>229</lpage>. <publisher-name>Springer Verlag</publisher-name>, <publisher-loc>Berlin</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btv389-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ohm</surname><given-names>R.A.</given-names></name><etal/></person-group> (<year>2010</year>) <article-title>Genome sequence of the model mushroom <italic>Schizophyllum commune</italic></article-title>. <source>Nat. Biotechnol.</source>, <volume>28</volume>, <fpage>957</fpage>–<lpage>963</lpage>.<pub-id pub-id-type="pmid">20622885</pub-id></mixed-citation>
    </ref>
    <ref id="btv389-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ohm</surname><given-names>R.A.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>The blue light receptor complex WC-1/2 of <italic>Schizophyllum commune</italic> is involved in mushroom formation and protection against phototoxicity</article-title>. <source>Environ. Microbiol.</source>, <volume>15</volume>, <fpage>943</fpage>–<lpage>955</lpage>.<pub-id pub-id-type="pmid">22998561</pub-id></mixed-citation>
    </ref>
    <ref id="btv389-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Overbeek</surname><given-names>R.</given-names></name><etal/></person-group> (<year>1999</year>) <article-title>Use of contiguity on the chromosome to predict functional coupling</article-title>. <source>In Silico Biol.</source>, <volume>1</volume>, <fpage>93</fpage>–<lpage>108</lpage>.<pub-id pub-id-type="pmid">11471247</pub-id></mixed-citation>
    </ref>
    <ref id="btv389-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pearson</surname><given-names>W.R.</given-names></name></person-group> (<year>1998</year>) <article-title>Empirical statistical estimates for sequence similarity searches</article-title>. <source>J. Mol. Biol.</source>, <volume>276</volume>, <fpage>71</fpage>–<lpage>84</lpage>.<pub-id pub-id-type="pmid">9514730</pub-id></mixed-citation>
    </ref>
    <ref id="btv389-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pel</surname><given-names>H.J.</given-names></name><etal/></person-group> (<year>2007</year>) <article-title>Genome sequencing and analysis of the versatile cell factory <italic>Aspergillus niger</italic> CBS 513.88</article-title>. <source>Nat. Biotechnol.</source>, <volume>25</volume>, <fpage>221</fpage>–<lpage>231</lpage>.<pub-id pub-id-type="pmid">17259976</pub-id></mixed-citation>
    </ref>
    <ref id="btv389-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Proost</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>i-ADHoRe 3.0–fast and sensitive detection of genomic homology in extremely large data sets</article-title>. <source>Nucleic Acids Res.</source>, <volume>40</volume>, <fpage>e11</fpage>.<pub-id pub-id-type="pmid">22102584</pub-id></mixed-citation>
    </ref>
    <ref id="btv389-B29">
      <mixed-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Shaw</surname><given-names>C.D.</given-names></name></person-group> (<year>2008</year>) <article-title>Genomic spring-synteny visualization with IMAS</article-title>. In: <person-group person-group-type="editor"><name><surname>Moore</surname><given-names>C.</given-names></name><etal/></person-group> (eds.) <conf-name>2008 Fifth International Conference BioMedical Visualization: Information Visualization in Medical and Biomedical Informatics</conf-name>, <publisher-name>IEEE Computer Society</publisher-name>, pp. <fpage>3</fpage>–<lpage>8</lpage>.</mixed-citation>
    </ref>
    <ref id="btv389-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Simillion</surname><given-names>C.</given-names></name><etal/></person-group> (<year>2008</year>) <article-title>i-ADHoRe 2.0: an improved tool to detect degenerated genomic homology using genomic profiles</article-title>. <source>Bioinformatics</source>, <volume>24</volume>, <fpage>127</fpage>–<lpage>128</lpage>.<pub-id pub-id-type="pmid">17947255</pub-id></mixed-citation>
    </ref>
    <ref id="btv389-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sinha</surname><given-names>A.U.</given-names></name><name><surname>Meller</surname><given-names>J.</given-names></name></person-group> (<year>2007</year>) <article-title>Cinteny: flexible analysis and visualization of synteny and genome rearrangements in multiple organisms</article-title>. <source>BMC Bioinformatics</source>, <volume>8</volume>, <fpage>82</fpage>.<pub-id pub-id-type="pmid">17343765</pub-id></mixed-citation>
    </ref>
    <ref id="btv389-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soderlund</surname><given-names>C.</given-names></name><etal/></person-group> (<year>2011</year>) <article-title>SyMAP v3.4: a turnkey synteny system with application to plant genomes</article-title>. <source>Nucleic Acids Res.</source>, <volume>39</volume>, <fpage>e68</fpage>.<pub-id pub-id-type="pmid">21398631</pub-id></mixed-citation>
    </ref>
    <ref id="btv389-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sullivan</surname><given-names>M.J.</given-names></name><etal/></person-group> (<year>2011</year>) <article-title>Easyfig: a genome comparison visualizer</article-title>. <source>Bioinformatics</source>, <volume>27</volume>, <fpage>1009</fpage>–<lpage>1010</lpage>.<pub-id pub-id-type="pmid">21278367</pub-id></mixed-citation>
    </ref>
    <ref id="btv389-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vallenet</surname><given-names>D.</given-names></name><etal/></person-group> (<year>2006</year>) <article-title>MaGe: a microbial genome annotation system supported by synteny results</article-title>. <source>Nucleic Acids Res.</source>, <volume>34</volume>, <fpage>53</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">16407324</pub-id></mixed-citation>
    </ref>
    <ref id="btv389-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vandepoele</surname><given-names>K.</given-names></name><etal/></person-group> (<year>2002</year>) <article-title>The automatic detection of homologous regions (ADHoRe) and its application to microcolinearity between <italic>Arabidopsis</italic> and rice</article-title>. <source>Genome Res.</source>, <volume>12</volume>, <fpage>1792</fpage>–<lpage>1801</lpage>.<pub-id pub-id-type="pmid">12421767</pub-id></mixed-citation>
    </ref>
    <ref id="btv389-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yekutieli</surname><given-names>D.</given-names></name></person-group> (<year>2008</year>) <article-title>Hierarchical false discovery rate controlling methodology</article-title>. <source>J. Am. Stat. Assoc.</source>, <volume>103</volume>, <fpage>309</fpage>–<lpage>316</lpage>.</mixed-citation>
    </ref>
    <ref id="btv389-B37">
      <mixed-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Zeng</surname><given-names>X.</given-names></name><etal/></person-group> (<year>2008</year>) <article-title>OrthoCluster: a new tool for mining synteny blocks and applications in comparative genomics</article-title>. In: <conf-name>Proceedings of the 11th International Conference on Extending Database Technology: Advances in Database Technology</conf-name>, <publisher-name>ACM New York</publisher-name>, <publisher-loc>NY, USA</publisher-loc>, pp. <fpage>656</fpage>–<lpage>667</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
