<?properties open_access?>
<?subarticle pcbi.1008223.r001?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">ploscomp</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7875426</article-id>
    <article-id pub-id-type="pmid">33513136</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-19-01120</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008223</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Expression</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Identification and Analysis</subject>
            <subj-group>
              <subject>Genetic Networks</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Network Analysis</subject>
          <subj-group>
            <subject>Genetic Networks</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene expression</subject>
            <subj-group>
              <subject>DNA transcription</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Gene Regulatory Networks</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Regulatory Networks</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Network Analysis</subject>
          <subj-group>
            <subject>Metabolic Networks</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Network Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Proteins</subject>
            <subj-group>
              <subject>DNA-binding proteins</subject>
              <subj-group>
                <subject>Transcription Factors</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Expression</subject>
            <subj-group>
              <subject>Gene Regulation</subject>
              <subj-group>
                <subject>Transcription Factors</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Proteins</subject>
            <subj-group>
              <subject>Regulatory Proteins</subject>
              <subj-group>
                <subject>Transcription Factors</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Information Theory</subject>
          <subj-group>
            <subject>Graph Theory</subject>
            <subj-group>
              <subject>Directed Graphs</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Graph Theory</subject>
            <subj-group>
              <subject>Directed Graphs</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Causal network inference from gene transcriptional time-series response to glucocorticoids</article-title>
      <alt-title alt-title-type="running-head">Causal gene network inference from time series</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1302-4875</contrib-id>
        <name>
          <surname>Lu</surname>
          <given-names>Jonathan</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Dumitrascu</surname>
          <given-names>Bianca</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-5811-1297</contrib-id>
        <name>
          <surname>McDowell</surname>
          <given-names>Ian C.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9641-7948</contrib-id>
        <name>
          <surname>Jo</surname>
          <given-names>Brian</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9244-9822</contrib-id>
        <name>
          <surname>Barrera</surname>
          <given-names>Alejandro</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
        <xref ref-type="aff" rid="aff005">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hong</surname>
          <given-names>Linda K.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Leichter</surname>
          <given-names>Sarah M.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7629-061X</contrib-id>
        <name>
          <surname>Reddy</surname>
          <given-names>Timothy E.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Project administration</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <xref ref-type="aff" rid="aff006">
          <sup>6</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6139-7334</contrib-id>
        <name>
          <surname>Engelhardt</surname>
          <given-names>Barbara E.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Project administration</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff007">
          <sup>7</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Computer Science, Princeton University, Princeton, New Jersey, United States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Lewis-Sigler Institute for Integrative Genomics, Princeton University, Princeton, New Jersey, United States of America</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Element Genomics, A UCB Company, Durham, North Carolina, United States of America</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Center for Genomic and Computational Biology, Duke University, Durham, North Carolina, United States of America</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Department of Biostatistics and Bioinformatics, Duke University Medical Center, Durham, North Carolina, United States of America</addr-line>
    </aff>
    <aff id="aff006">
      <label>6</label>
      <addr-line>Department of Genome Sciences, Duke University, Durham, North Carolina, United States of America</addr-line>
    </aff>
    <aff id="aff007">
      <label>7</label>
      <addr-line>Center for Statistics and Machine Learning, Princeton University, Princeton, New Jersey, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Leslie</surname>
          <given-names>Christina S.</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Memorial Sloan-Kettering Cancer Center, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>I have read the journal’s policy and the authors of this manuscript have the following competing interests: BEE is on the SAB for Freenome, Celsius Therapeutics, and Creyon Bio; is a consultant for Freenome; and was an employee of Genomics plc during a year of absence from Princeton University.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>tim.reddy@duke.edu</email> (TER); <email>bee@princeton.edu</email> (BEE)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>1</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>1</month>
      <year>2021</year>
    </pub-date>
    <volume>17</volume>
    <issue>1</issue>
    <elocation-id>e1008223</elocation-id>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>7</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>7</day>
        <month>8</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2021 Lu et al</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Lu et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1008223.pdf"/>
    <abstract>
      <p>Gene regulatory network inference is essential to uncover complex relationships among gene pathways and inform downstream experiments, ultimately enabling regulatory network re-engineering. Network inference from transcriptional time-series data requires accurate, interpretable, and efficient determination of causal relationships among thousands of genes. Here, we develop Bootstrap Elastic net regression from Time Series (BETS), a statistical framework based on Granger causality for the recovery of a directed gene network from transcriptional time-series data. BETS uses elastic net regression and stability selection from bootstrapped samples to infer causal relationships among genes. BETS is highly parallelized, enabling efficient analysis of large transcriptional data sets. We show competitive accuracy on a community benchmark, the DREAM4 100-gene network inference challenge, where BETS is one of the fastest among methods of similar performance and additionally infers whether causal effects are activating or inhibitory. We apply BETS to transcriptional time-series data of differentially-expressed genes from A549 cells exposed to glucocorticoids over a period of 12 hours. We identify a network of 2768 genes and 31,945 directed edges (FDR ≤ 0.2). We validate inferred causal network edges using two external data sources: Overexpression experiments on the same glucocorticoid system, and genetic variants associated with inferred edges in primary lung tissue in the Genotype-Tissue Expression (GTEx) v6 project. BETS is available as an open source software package at <ext-link ext-link-type="uri" xlink:href="https://github.com/lujonathanh/BETS">https://github.com/lujonathanh/BETS</ext-link>.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>We can better understand human health and disease by studying the state of cells and how environmental dysregulation affects cell state. Cellular assays, when collected across time, can show us how genes in cells respond to stimuli. These time-series assays provide an opportunity to identify causal relationships among thousands of genes without performing hundreds of thousands of experiments. However, inferring causal relationships from these time-series data needs to be fast, robust, and accurate. We present a method, BETS, that infers causal gene networks from gene expression time series. BETS runs quickly because it is parallelized, allowing even data sets with thousands of genes to be analyzed. We demonstrate the performance of BETS compared to 22 other state-of-the-art inference methods on benchmark data. We then use BETS to build causal networks from gene expression responses to the widely-prescribed drug dexamethasone. We replicate the estimated causal relationships using gene expression data from the Genotype-Tissue Expression (GTEx) project and from additional experiments with dexamethasone. We release our software so that BETS can be used to accurately and effectively infer causal relationships from gene expression time-series assays.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution>NIH / National Human Genome Research Institute</institution>
        </funding-source>
        <award-id>NIH R01 HL133218</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6139-7334</contrib-id>
          <name>
            <surname>Engelhardt</surname>
            <given-names>Barbara E.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution>NIH / National Human Genome Research Institute</institution>
        </funding-source>
        <award-id>NIH U01 HG007900</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6139-7334</contrib-id>
          <name>
            <surname>Engelhardt</surname>
            <given-names>Barbara E.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution>NSF / Division of Information and Intelligent Systems</institution>
        </funding-source>
        <award-id>NSF 711 CAREER 1750729</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6139-7334</contrib-id>
          <name>
            <surname>Engelhardt</surname>
            <given-names>Barbara E.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This work was funded by the following grants to BEE: NIH R01 HL133218 and NIH U01 HG007900 (National Human Genome Research Institute), and an NSF 711 CAREER 1750729 (Division of Information and Intelligent Systems). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="7"/>
      <table-count count="0"/>
      <page-count count="29"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2021-02-10</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All files have been submitted to the Gene Expression Omnibus, accession number: GSE91208. <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE91208">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE91208</ext-link> All other data are contained in the manuscript and the <xref ref-type="sec" rid="sec033">Supporting information</xref>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All files have been submitted to the Gene Expression Omnibus, accession number: GSE91208. <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE91208">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE91208</ext-link> All other data are contained in the manuscript and the <xref ref-type="sec" rid="sec033">Supporting information</xref>.</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic>PLOS Computational Biology</italic> Methods paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>1 Introduction</title>
    <p>The recent availability of gene expression measurements over time has enabled the search for interpretable statistical models of gene regulatory dynamics [<xref rid="pcbi.1008223.ref001" ref-type="bibr">1</xref>]. These time-series data present a unique opportunity to use the coordinated transcriptional response to environmental exposure to infer causal relationships between genes. However, there are several challenges to overcome in the analysis of time-series transcriptomic data. These data are generally high-dimensional: the number of quantified gene transcripts—approximately 20,000 in human samples—often dramatically exceeds the number of available time points and samples. Many classical statistical assumptions fail to hold in this high-dimensional regime [<xref rid="pcbi.1008223.ref002" ref-type="bibr">2</xref>, <xref rid="pcbi.1008223.ref003" ref-type="bibr">3</xref>]. Moreover, the large number of gene transcripts poses a computational burden, as the number of possible edges in a gene network grows quadratically. Also, a transcriptional time series often has a small number of time points, and those time points are often not uniformly spaced; furthermore, because transcriptional time-series data often quantify transcription post exposure, the time series is not stationary, and genes respond to the exposure and return to baseline at different rates [<xref rid="pcbi.1008223.ref004" ref-type="bibr">4</xref>, <xref rid="pcbi.1008223.ref005" ref-type="bibr">5</xref>].</p>
    <p>In this work, we develop an approach that uses gene transcription time series following glucocorticoid (GC) exposure to build a directed gene network [<xref rid="pcbi.1008223.ref006" ref-type="bibr">6</xref>]. GCs play an essential role in regulating stress response, and are widely used as anti-inflammatory and immunosuppresive medications [<xref rid="pcbi.1008223.ref006" ref-type="bibr">6</xref>, <xref rid="pcbi.1008223.ref007" ref-type="bibr">7</xref>]. Dexamethasone and other GCs have recently been recommended by the U.K. Government, U.S. National Institutes of Health, World Health Organization, and Infectious Disease Society of America for treatment of hospitalized COVID-19 patients with severe disease who are on mechanical ventilation or extracorporeal membrane oxygenation [<xref rid="pcbi.1008223.ref008" ref-type="bibr">8</xref>–<xref rid="pcbi.1008223.ref011" ref-type="bibr">11</xref>]. Despite clinical benefits, prolonged exposure to GCs has been linked to increased risk of type 2 diabetes mellitus (T2DM) [<xref rid="pcbi.1008223.ref012" ref-type="bibr">12</xref>] and obesity [<xref rid="pcbi.1008223.ref013" ref-type="bibr">13</xref>]. Understanding the immune, metabolic, and transcriptional effects of GCs may enable the development of improved anti-inflammatory treatments without metabolic side effects. A recent study assayed A549 lung cells over 12 hours to characterize the effect of GCs on cell state [<xref rid="pcbi.1008223.ref006" ref-type="bibr">6</xref>]. Here, we develop a method to accurately, interpretably, and efficiently infer a directed gene network using the study’s transcription time-series data. We focus our network analysis on immune-related genes, metabolism-related genes, and transcription factors (TFs) to study the inferred coordinated response of these systems to GCs.</p>
    <p>Our method, Bootstrap Elastic net inference from Time Series (BETS), uses vector autoregression with elastic net regularization to infer directed edges between genes. Stability selection, which assesses the robustness of an edge to perturbations in the data, leads to improvements over baseline vector autoregression methods in this high-dimensional context [<xref rid="pcbi.1008223.ref003" ref-type="bibr">3</xref>]. Furthermore, BETS is biologically interpretable because estimated coefficients provide the direction (sign) and effect size of the causal relationship between a pair of genes. Finally, BETS’s parallelization enables efficient inference of networks with millions of possible edges in a computationally tractable way.</p>
    <p>We use the causal network inferred by BETS on the GC time-series data to study the relationships between TFs, immune genes, and metabolic genes. We validate our network using two approaches: Ten measurements of the same GC system with an overexpressed TF, and an expression quantitative trait loci (eQTL) study in human primary lung tissue [<xref rid="pcbi.1008223.ref014" ref-type="bibr">14</xref>]. Although our framework is motivated by transcriptional response to GC exposure, our approaches are general, and BETS is able to infer directed networks from arbitrary high-dimensional time-series data.</p>
    <sec id="sec002">
      <title>1.1 Related work</title>
      <p>Several methods have been developed to estimate directed gene networks from transcription time-series data (<xref ref-type="supplementary-material" rid="pcbi.1008223.s001">S1 Fig</xref>) [<xref rid="pcbi.1008223.ref015" ref-type="bibr">15</xref>–<xref rid="pcbi.1008223.ref023" ref-type="bibr">23</xref>]. These methods estimate directed networks in which the directed edges between nodes—representing genes—indicate a cause-effect relationship between genes. In other words, perturbing expression of the <italic>causal gene</italic> would lead to changes in expression of the <italic>effect gene</italic> [<xref rid="pcbi.1008223.ref024" ref-type="bibr">24</xref>]. We briefly overview these methods; for detailed discussion, see the Supplemental Information. Here, we take <italic>g</italic>′ to be the causal gene and <italic>g</italic> to be the effect gene, and we quantify support for a causal edge <italic>g</italic>′ → <italic>g</italic> in the time-series data.</p>
      <p>Mutual information (MI) methods assess the MI between the expression of <italic>g</italic>′ at the previous time point and the expression of <italic>g</italic> at the current time point (<xref ref-type="supplementary-material" rid="pcbi.1008223.s001">S1(A) Fig</xref>) [<xref rid="pcbi.1008223.ref025" ref-type="bibr">25</xref>–<xref rid="pcbi.1008223.ref030" ref-type="bibr">30</xref>]. A causal edge <italic>g</italic>′ → <italic>g</italic> is included in the network if the MI of the two genes across time exceeds a threshold.</p>
      <p>Granger causality methods determine if including the expression of <italic>g</italic>′ at the previous time point improves our ability to predict the expression of <italic>g</italic> at the current time point beyond using the expression of <italic>g</italic> at the previous time point [<xref rid="pcbi.1008223.ref031" ref-type="bibr">31</xref>]. A common way to implement Granger causality is through a vector autoregression (VAR) model, which assumes a linear relationship between all genes’ expression at the previous time point and the expression of <italic>g</italic> at the current time point. A causal edge <italic>g</italic>′ → <italic>g</italic> is included in the network when <italic>g</italic>′ has a statistically significant coefficient in the VAR.</p>
      <p>Ordinary differential equations (ODEs) fit the derivative of the expression of <italic>g</italic> as a function of all genes’ expression at a single time point (<xref ref-type="supplementary-material" rid="pcbi.1008223.s001">S1(C) Fig</xref>) [<xref rid="pcbi.1008223.ref015" ref-type="bibr">15</xref>, <xref rid="pcbi.1008223.ref032" ref-type="bibr">32</xref>, <xref rid="pcbi.1008223.ref033" ref-type="bibr">33</xref>]. ODE methods typically assume linearity, as small sample sizes make it challenging to infer the parameters of nonlinear functions. A causal edge <italic>g</italic>′ → <italic>g</italic> is included when <italic>g</italic>′ has a statistically significant coefficient in the ODE.</p>
      <p>Decision trees (DTs) are a type of nonparametric function based on partitioning the data [<xref rid="pcbi.1008223.ref034" ref-type="bibr">34</xref>, <xref rid="pcbi.1008223.ref035" ref-type="bibr">35</xref>]. DT methods fall either under VAR or ODE; either the DTs fit the expression of <italic>g</italic> at the current time as a function of all genes’ expression at the previous time point (VAR), or they fit the derivative of the expression of <italic>g</italic> as a function of all genes’ expression at a single time point (ODE) (<xref ref-type="supplementary-material" rid="pcbi.1008223.s001">S1(D) Fig</xref>) [<xref rid="pcbi.1008223.ref036" ref-type="bibr">36</xref>, <xref rid="pcbi.1008223.ref037" ref-type="bibr">37</xref>]. A causal edge <italic>g</italic>′ → <italic>g</italic> is included in the network when an importance score for <italic>g</italic>′ exceeds some threshold, where importance scores are typically the reduction in variance of <italic>g</italic> when <italic>g</italic>′ is included as a predictor.</p>
      <p>Dynamic Bayesian networks (DBNs) search the space of possible directed acyclic graphs between previous and current expression levels to identify the network structure with the highest posterior probability of each edge given the data (<xref ref-type="supplementary-material" rid="pcbi.1008223.s001">S1(E) Fig</xref>) [<xref rid="pcbi.1008223.ref038" ref-type="bibr">38</xref>–<xref rid="pcbi.1008223.ref042" ref-type="bibr">42</xref>]. DBNs typically assume a linear relationship between previous and current expression. A causal edge <italic>g</italic>′ → <italic>g</italic> is included in the network when its marginal posterior probability of existence exceeds some threshold.</p>
      <p>A Gaussian process (GP) is a distribution over continuous, nonlinear functions. GPs are often used in the context of nonlinear DBNs, where GP regression is used to model a nonlinear relationship between previous expression and current expression (<xref ref-type="supplementary-material" rid="pcbi.1008223.s001">S1(F) Fig</xref>) [<xref rid="pcbi.1008223.ref043" ref-type="bibr">43</xref>, <xref rid="pcbi.1008223.ref044" ref-type="bibr">44</xref>]. A causal edge <italic>g</italic>′ → <italic>g</italic> is included in the network when its posterior probability of existence exceeds some threshold.</p>
      <p>While these approaches produce directed networks that have the flavor of Bayesian networks, except for DBNs, none of them produce graphs that are constrained to be acyclic, so they do not have the same statistical semantics as Bayesian networks.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec003">
    <title>2 Results</title>
    <p>First, we briefly describe the approach that BETS uses to infer a directed gene network. Next, we compare results from BETS to those from twenty two other methods on the 100-gene time-series data from the DREAM4 Network Inference Challenge [<xref rid="pcbi.1008223.ref045" ref-type="bibr">45</xref>]. Then, we describe the network estimated from the GC transcription time-series data. Finally, we validate the inferred network using two different frameworks: Overexpression experiments on the same system, and genetic variants associated with inferred edges in human primary lung tissue in the Genotype-Tissue Expression (GTEx) v6 project [<xref rid="pcbi.1008223.ref014" ref-type="bibr">14</xref>].</p>
    <sec id="sec004">
      <title>2.1 BETS: A vector autoregressive approach to causal inference of gene regulatory networks</title>
      <p>Directed networks represent causal relationships among diverse interacting variables in complex systems. We developed a robust, scalable approach based on ideas from Granger causality to construct these directed networks from short, high-dimensional time-series observations of gene expression levels.</p>
      <p>Let <italic>G</italic> be the set of all <italic>p</italic> = |<italic>G</italic>| genes in the data set and <italic>g</italic> ∈ <italic>G</italic> be a gene. Let ¬<italic>g</italic> be <italic>G</italic> with <italic>g</italic> removed. Let <italic>t</italic> be a single time point, ranging from {1, 2, …, <italic>T</italic>}. Let <inline-formula id="pcbi.1008223.e001"><alternatives><graphic xlink:href="pcbi.1008223.e001.jpg" id="pcbi.1008223.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:msubsup><mml:mi>X</mml:mi><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> be the expression of gene <italic>g</italic> at time <italic>t</italic>. Let <italic>L</italic> be the time lag, or the number of previous time point observations; so <italic>L</italic> = 2 means that we use two previous time points, <italic>t</italic> − 1 and <italic>t</italic> − 2, to predict expression at time <italic>t</italic>. These types of autoregressive models work best with similarly-spaced time points, as the data sets in this paper approximate, and assume stationarity, or the same causal effects across each time gap.</p>
      <p><bold>Definition 2.1</bold> (Granger causality). For lag <italic>L</italic>, a gene <italic>g</italic>′ is said to <italic>Granger-cause</italic> another gene <italic>g</italic> if using <inline-formula id="pcbi.1008223.e002"><alternatives><graphic xlink:href="pcbi.1008223.e002.jpg" id="pcbi.1008223.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, the expression values of <italic>g</italic>′ at times <italic>t</italic> − 1 to <italic>t</italic> − <italic>L</italic>, improves prediction of <inline-formula id="pcbi.1008223.e003"><alternatives><graphic xlink:href="pcbi.1008223.e003.jpg" id="pcbi.1008223.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:msubsup><mml:mi>X</mml:mi><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, the expression value of <italic>g</italic> at time <italic>t</italic>, beyond predicting <inline-formula id="pcbi.1008223.e004"><alternatives><graphic xlink:href="pcbi.1008223.e004.jpg" id="pcbi.1008223.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:msubsup><mml:mi>X</mml:mi><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> using <inline-formula id="pcbi.1008223.e005"><alternatives><graphic xlink:href="pcbi.1008223.e005.jpg" id="pcbi.1008223.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> alone.</p>
      <p>To test for Granger causality from <italic>g</italic>′ to <italic>g</italic>, we first preprocessed the gene expression time-series data (<xref ref-type="sec" rid="sec010">Methods</xref>). For every potential effect gene <italic>g</italic>, we fit all other genes <italic>g</italic>′ ∈ ¬<italic>g</italic> simultaneously (<xref ref-type="disp-formula" rid="pcbi.1008223.e006">Eq 1</xref>), echoing ideas from the graphical lasso for undirected network inference [<xref rid="pcbi.1008223.ref046" ref-type="bibr">46</xref>]. Intuitively, this adapts the idea of Granger causality to conditional Granger causality, where we consider how gene <italic>g</italic>′ Granger-causes <italic>g</italic> conditioning on the effects of all other genes. This approach uses the regression:
<disp-formula id="pcbi.1008223.e006"><alternatives><graphic xlink:href="pcbi.1008223.e006.jpg" id="pcbi.1008223.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>∈</mml:mo><mml:mo>¬</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:munder><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:msubsup><mml:mi>β</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula>
where <inline-formula id="pcbi.1008223.e007"><alternatives><graphic xlink:href="pcbi.1008223.e007.jpg" id="pcbi.1008223.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. For BETS, we set <italic>L</italic> = 2. To test for an edge, if there is statistical support for <inline-formula id="pcbi.1008223.e008"><alternatives><graphic xlink:href="pcbi.1008223.e008.jpg" id="pcbi.1008223.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:mrow><mml:msubsup><mml:mi>β</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, then we say <italic>g</italic>′ conditionally Granger-causes <italic>g</italic> at lag <italic>L</italic>. We build the directed network by including a directed edge to <italic>g</italic> from every gene <italic>g</italic>′ that has been inferred to conditionally Granger-cause <italic>g</italic>.</p>
      <p>Robustly building this network is difficult due to the high dimensionality of the problem: The number of genes that could Granger-cause a given <italic>g</italic> far exceeds the available time points and technical replicates. To address this challenge, BETS regularizes the VAR model parameters using an <italic>elastic net</italic> penalty (<xref ref-type="sec" rid="sec010">Methods</xref>, <xref ref-type="fig" rid="pcbi.1008223.g001">Fig 1A</xref>). Elastic net regression encourages sparsity and performs automatic variable selection on the genes being tested for causal influence [<xref rid="pcbi.1008223.ref047" ref-type="bibr">47</xref>]. The elastic net penalty, unlike the lasso penalty [<xref rid="pcbi.1008223.ref048" ref-type="bibr">48</xref>], is able to select groups of correlated variables and allows the number of selected variables to be greater than the number of samples. This is important for gene expression assays where gene expression levels are often well correlated, and there are far more genes than samples [<xref rid="pcbi.1008223.ref002" ref-type="bibr">2</xref>].</p>
      <fig id="pcbi.1008223.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008223.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>BETS Algorithm.</title>
          <p><bold>A) Model fit</bold>. The VAR model is fit on both the original and a permuted data set (blue arrows indicate shuffling each gene’s expression independently across time). Based on the null distribution of coefficients, a threshold is chosen to control the edge FDR at ≤ 0.05. <bold>B) Stability selection</bold>. From the original data, 1000 bootstrap samples are generated. For each sample, a network is inferred as in A. Each edge’s selection frequency across the bootstrapped networks is computed. <bold>C) Statistical significance</bold>. For both the original and permuted data, a selection frequency distribution is generated for stability selection as in B. Edges are thresholded to control the stability FDR at ≤ 0.2. See <xref ref-type="supplementary-material" rid="pcbi.1008223.s001">S1 Fig</xref> for an overview of network inference methods.</p>
        </caption>
        <graphic xlink:href="pcbi.1008223.g001"/>
      </fig>
      <p>In BETS, we fit the same VAR model to a data set in which causal genes have their expression permuted over time to generate a null distribution of edge coefficients. The coefficients are thresholded to produce a causal network with each edge at edge false discovery rate (FDR) ≤ 0.05 (<xref ref-type="fig" rid="pcbi.1008223.g001">Fig 1A</xref>). We then applied this network inference procedure to multiple (here, 1000) bootstrapped samples of the original data set (<xref ref-type="fig" rid="pcbi.1008223.g001">Fig 1B</xref>). Each edge has a <italic>selection frequency</italic>, or the frequency that the edge appears in networks inferred from the bootstrapped samples. Inspired by stability selection, this approach assesses if network edges are robust to perturbations of the data [<xref rid="pcbi.1008223.ref003" ref-type="bibr">3</xref>]. Finally, we ran this overall procedure on a permuted version of the original data set to obtain a null distribution of selection frequencies (<xref ref-type="fig" rid="pcbi.1008223.g001">Fig 1C</xref>). The selection frequency threshold for including each edge is chosen to control the stability FDR ≤0.2. As a baseline, we compare BETS against Enet, which runs elastic net regression without stability selection to produce a causal network with each edge at edge FDR ≤ 0.05 (<xref ref-type="fig" rid="pcbi.1008223.g001">Fig 1A</xref>).</p>
    </sec>
    <sec id="sec005">
      <title>2.2 Leading performance on DREAM Network Inference Challenge</title>
      <p>We evaluated BETS against other directed network inference methods. We used the DREAM4 Network Inference Challenge [<xref rid="pcbi.1008223.ref045" ref-type="bibr">45</xref>], a community benchmark for directed network inference using gene time-series data. This benchmark consisted of five data sets, each with ten time-series measurements for 100 genes across 21 time points [<xref rid="pcbi.1008223.ref045" ref-type="bibr">45</xref>]. Evaluation was previously done by looking at the average of the area under the precision recall curve (AUPR) or the area under the receiver operating characteristic (AUROC) over the five data sets [<xref rid="pcbi.1008223.ref037" ref-type="bibr">37</xref>, <xref rid="pcbi.1008223.ref045" ref-type="bibr">45</xref>]. Any method that provides a ranking of possible network edges could be evaluated in this framework.</p>
      <p>We tested BETS and Enet against 22 other methods on the DREAM challenge [<xref rid="pcbi.1008223.ref036" ref-type="bibr">36</xref>, <xref rid="pcbi.1008223.ref037" ref-type="bibr">37</xref>, <xref rid="pcbi.1008223.ref040" ref-type="bibr">40</xref>, <xref rid="pcbi.1008223.ref049" ref-type="bibr">49</xref>–<xref rid="pcbi.1008223.ref051" ref-type="bibr">51</xref>]. We ran SWING-RF, SWING-Lasso, CSId, Jump3, CLR, MRNET, and ARACNE in-house and found our results consistent with those reported in the literature. All 22 methods reported AUPR, but only 17 reported AUROC.</p>
      <p>BETS ranked 7th out of 24 in AUPR with an average AUPR of 0.128 (<xref ref-type="fig" rid="pcbi.1008223.g002">Fig 2A</xref> and <xref ref-type="supplementary-material" rid="pcbi.1008223.s003">S1 Table</xref>) and 4th out of 19 in AUROC with an average AUROC of 0.688 (<xref ref-type="fig" rid="pcbi.1008223.g002">Fig 2B</xref> and <xref ref-type="supplementary-material" rid="pcbi.1008223.s004">S2 Table</xref>). BETS was the top performer of all VAR methods, and Enet was second best. All 24 methods outperformed random selection of edges, which achieved an average AUPR of 0.002 and average AUROC of 0.50 [<xref rid="pcbi.1008223.ref049" ref-type="bibr">49</xref>]. We also found that BETS and Enet had similar performance to the DBN methods in AUPR, and outperformed most of them in AUROC. Ranked by the top AUPR of each class of methods, the best performing class was DT, followed by GP, MI, VAR, DBN, and ODE [<xref rid="pcbi.1008223.ref036" ref-type="bibr">36</xref>, <xref rid="pcbi.1008223.ref040" ref-type="bibr">40</xref>, <xref rid="pcbi.1008223.ref049" ref-type="bibr">49</xref>]. The VAR method used in BETS produces edge signs (indicating excitatory or inhibitory causal effects) and effect sizes. While other methods based on GPs (e.g., CSId), MI (e.g., tl-CLR) or DTs (e.g., SWING-RF) had marginally better overall network inference, they do not provide insight into the causal relationships because they only output a positive measure of a causal interaction [<xref rid="pcbi.1008223.ref032" ref-type="bibr">32</xref>, <xref rid="pcbi.1008223.ref044" ref-type="bibr">44</xref>, <xref rid="pcbi.1008223.ref051" ref-type="bibr">51</xref>].</p>
      <fig id="pcbi.1008223.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008223.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Algorithm performance on the DREAM community benchmark.</title>
          <p><bold>A) AUPR scores from 24 methods</bold>, averaged across the five DREAM networks. <bold>B) AUROC scores from 19 methods</bold>, averaged across the five DREAM networks. Arrows indicate our methods. Stars indicate methods that we ran in-house; results were consistent with reported results. The bars reach one standard deviation from the average as calculated across the five DREAM networks; no bar indicates the standard deviation was not reported. See also <xref ref-type="supplementary-material" rid="pcbi.1008223.s003">S1</xref>–<xref ref-type="supplementary-material" rid="pcbi.1008223.s007">S5</xref> Tables.</p>
        </caption>
        <graphic xlink:href="pcbi.1008223.g002"/>
      </fig>
      <p>Next, we compared the speed of BETS and three other top-performing methods: SWING-RF, CSId and Jump3 (<xref ref-type="supplementary-material" rid="pcbi.1008223.s005">S3 Table</xref>). SWING-RF was the fastest at 0.11 hours, while BETS took 4.8 hours, CSId took 9.8 hours and Jump3 took 45 hours. Thus, while BETS had a lower AUPR compared to CSId and Jump3, it was substantially faster. BETS had both a lower AUPR and longer runtime than SWING-RF.</p>
      <p>BETS improved upon Enet using stability selection. To quantify this improvement, we compared three other models: Elastic net with lag <italic>L</italic> = 1, ridge regression with lag <italic>L</italic> = 2, and lasso with lag <italic>L</italic> = 2 (<xref ref-type="supplementary-material" rid="pcbi.1008223.s006">S4 Table</xref>). In each case, the stability selection version outperformed the original version in average AUPR and AUROC. The improvement in average AUPR ranged between 0.016 and 0.03 (+20% to +31%), while the improvement in average AUROC ranged between 0.012 and 0.04 (+1.8% to +6.1%). Thus, our stability selection procedure leads to improved performance for multiple versions of VAR.</p>
      <p>We also found that stability selection performance is robust to the number of bootstrap samples (<xref ref-type="supplementary-material" rid="pcbi.1008223.s007">S5 Table</xref>). Decreasing the number of bootstrap samples from 1000 to 100 led to minor decreases of −0.004 in AUPR and −0.008 in AUROC, within the standard deviation across the networks. It also resulted in a 10-fold decrease in memory usage and 3-fold decrease in run time, due to a constant-time hyperparameter search. If users face computational constraints, we recommend that they use 100 bootstrap samples for nearly equivalent performance.</p>
      <p>Finally, we found that BETS’ performance on DREAM is robust to the choice of lag. We ran BETS with lag <italic>L</italic> = 1 instead of lag <italic>L</italic> = 2 (<xref ref-type="supplementary-material" rid="pcbi.1008223.s006">S4 Table</xref>). BETS with lag <italic>L</italic> = 1 achieves an average AUPR of 0.14 (an increase of 0.012 from lag <italic>L</italic> = 2) and an average AUROC of 0.686 (a decrease of 0.002 from lag <italic>L</italic> = 2, within the standard deviation across networks). BETS with lag <italic>L</italic> = 1 still ranks 7th out of 24 in AUPR and 4th out of 19 in AUROC (tied with GP4GRN). Thus, BETS achieves consistently good performance on DREAM for both lags <italic>L</italic> = 1 and <italic>L</italic> = 2.</p>
    </sec>
    <sec id="sec006">
      <title>2.3 Application to gene transcription response to glucocorticoids</title>
      <p>To infer the causal relationships in the GC response network, we analyzed RNA-seq data collected from human adenocarcinoma and lung model cell line A549, which consists of two data sets. In an <italic>original exposure</italic> data set, cells were exposed to the synthetic GC dexamethasone (dex) for 0, 0.5, 1, 2, 3, 4, 5, 6, 7, 8, 10, and 12 hours [<xref rid="pcbi.1008223.ref006" ref-type="bibr">6</xref>]. In an <italic>unperturbed</italic> data set, the cells were first exposed to dex for 12 hours, after which the media was replaced and dex removed, and then measurements were taken at the same intervals 0, 0.5, 1, 2, 3, 4, 5, 6, 7, 8, 10, and 12 hours. BETS was fit jointly over the two data sets. In total there were 7 technical replicates (4 from <italic>original exposure</italic> and 3 from <italic>unperturbed</italic>). A single VAR was fit on 70 samples: Each of the 7 replicates had 10 samples, because using a lag <italic>L</italic> = 2 VAR model turns 12 time points into 10 samples.</p>
      <p>We applied BETS to the GC-mediated expression responses to infer a causal network (<xref ref-type="fig" rid="pcbi.1008223.g003">Fig 3A</xref>). Edges with selection frequency (i.e., frequency of appearance among bootstrap networks) at least 0.097 were declared significant (FDR ≤ 0.2; <xref ref-type="fig" rid="pcbi.1008223.g003">Fig 3B</xref>). The network contained 2, 768 nodes representing distinct genes and 31, 945 directed edges (0.4% of possible edges). Of these, 466 genes were causes (i.e., had an outward directed edge) and all 2, 768 genes were effects (i.e., had an incoming directed edge). In Granger causality, and dynamical systems more generally, a causal gene <italic>g</italic>′ is allowed to have incoming directed edges because <italic>g</italic>′ may be affected by the past value of another gene <italic>g</italic>″, and <italic>g</italic>′ may have a causal effect on the later value of gene <italic>g</italic>. The out-degree distribution was heavy-tailed and skewed right (<xref ref-type="fig" rid="pcbi.1008223.g003">Fig 3C</xref>), while the in-degree distribution was lighter-tailed and more symmetric (<xref ref-type="fig" rid="pcbi.1008223.g003">Fig 3D</xref>). The network’s edge in-degree had a heavier left tail and lighter right tail than a normal distribution (<xref ref-type="fig" rid="pcbi.1008223.g003">Fig 3E</xref>). This suggests that causal genes are relatively rare (only 1/6th of network genes are causes) and a fifth of those only affect a single gene, whereas genes that are effects tend to have multiple causes. The network was inferred efficiently due to parallelization across genes, taking six days in real time and 292 days in CPU time to fit 5.5 million elastic net models.</p>
      <fig id="pcbi.1008223.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008223.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Causal network inferred from glucocorticoid receptor data.</title>
          <p><bold>A) Causal network clustered by gene type</bold>. Edge color indicates the type of the causal gene: red edge indicates an immune causal edge, blue edge indicates a metabolic causal edge, purple edge (<italic>both</italic>) indicates an immune and metabolic causal edge, and tan edge indicates a neither immune nor metabolic other causal edge. <bold>B) Significance thresholding for edges</bold>, based on the null distribution of selection frequencies. <bold>C) Out-degree distribution of network</bold>. For clarity, several high out-degree values with low frequencies are not shown. <bold>D) In-degree distribution of network</bold>. <bold>E) Quantile-quantile (Q-Q) plot of in-degree distribution against normal quantiles</bold>. The in-degrees have a heavier left tail and lighter right tail than the normal distribution. <bold>F) Enrichment of gene classes among network causal genes</bold>, measured by odds ratio. <bold>G) Enrichment of edge classes among network edges</bold>, measured by odds ratio. See also <xref ref-type="supplementary-material" rid="pcbi.1008223.s008">S6 Table</xref>.</p>
        </caption>
        <graphic xlink:href="pcbi.1008223.g003"/>
      </fig>
      <p>To study the network with respect to the glucocorticoid system, we annotated specific genes as transcription factors (TFs), immune-related, or metabolism-related [<xref rid="pcbi.1008223.ref052" ref-type="bibr">52</xref>–<xref rid="pcbi.1008223.ref055" ref-type="bibr">55</xref>]. First, we inspected enrichment of each category among the causal genes (<xref ref-type="fig" rid="pcbi.1008223.g003">Fig 3F</xref>). At FDR ≤ 0.05, we found enrichment for TFs among causes; there were 226 causal TFs, representing 8.2% of the 2, 768 input genes. 62 of these TFs were causal, representing 13% of all causal genes (odds ratio (OR) = 2.0, Fisher’s exact test (FET) adjusted <italic>p</italic> ≤ 2.9 × 10<sup>−5</sup>). Similarly, we found an enrichment among immune-related genes as causes: of 109 immune genes, representing 3.9% of the input genes, 39 of these were causes, representing 8.4% of all causal genes (OR = 2.9, FET adjusted <italic>p</italic> ≤ 2.5 × 10<sup>−6</sup>). In contrast, there was no enrichment among metabolism-related genes: there were 120 metabolic genes, representing 4.3% of input genes; 19 of these metabolism genes were causes, representing 4.1% of all causes (OR = 0.93, FET adjusted <italic>p</italic> ≤ 0.66). This suggests that our network is enriched for causal TFs and immune genes.</p>
      <p>To study the interactions among gene classes inferred by our network, we quantified enrichment for edges between each of the four gene classes—immune, metabolic, TF, and other gene types (<xref ref-type="fig" rid="pcbi.1008223.g003">Fig 3G</xref>; <xref ref-type="supplementary-material" rid="pcbi.1008223.s008">S6 Table</xref>). We found enrichment of 11 of the 16 possible edge types (FDR ≤ 0.05). The network was enriched for edges from i) causal TFs to immune genes and other genes; ii) causal immune genes to TFs, immune genes, metabolic genes, and other genes; and iii) causal metabolic genes to TFs, immune genes, metabolic genes, and other genes. This suggests that our network is enriched for a broad range of edge types.</p>
      <p>The inferred relationships in BETS are conditionally Granger-causal, meaning that we find that gene <italic>g</italic>′ Granger-causes <italic>g</italic> conditioning on the effects of other genes. Thus, an edge <italic>g</italic>′ → <italic>g</italic> should be assessed based on <italic>g</italic>’s residuals after controlling for the effects of other genes and itself, instead of <italic>g</italic>’s raw values. Consider the edge <italic>KRT6A</italic> → <italic>NKAIN4</italic> (<xref ref-type="fig" rid="pcbi.1008223.g004">Fig 4</xref>): <italic>NKAIN4</italic>’s raw expression values suggest a negative relationship between <italic>KRT6A</italic> and <italic>NKAIN4</italic> (<xref ref-type="fig" rid="pcbi.1008223.g004">Fig 4A and 4B</xref>). However, after controlling for the effects of all covariates besides <italic>KRT6A</italic>, a positive relationship between <italic>KRT6A</italic> and <italic>NKAIN4</italic> appears (<xref ref-type="fig" rid="pcbi.1008223.g004">Fig 4C and 4D</xref>). Thus, conditionally Granger-causal relationships <italic>g</italic>′ → <italic>g</italic> should assess <italic>g</italic> only after controlling all other effects on <italic>g</italic>.</p>
      <fig id="pcbi.1008223.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008223.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Conditional Granger causality reveals opposite sign of relationship <italic>KRT6A</italic> → <italic>NKAIN4</italic>.</title>
          <p><bold>A) Time series</bold> and <bold>B) scatter plot of expression values from <italic>KRT6A</italic> and <italic>NKAIN4</italic></bold>. <bold>C) Time series</bold> and <bold>D) scatter plot of expression values from <italic>KRT6A</italic> and residual expression values from <italic>NKAIN4</italic></bold> after controlling for the effects of other covariates in <italic>NKAIN4</italic>. Each y-axis tick in A and C indicates 0.1 unit-variance standardized ln(TPM), where TPM is Transcripts Per kilobase Million. The grey line marks zero-centered expression. B and D axes are in units of ln(TPM).</p>
        </caption>
        <graphic xlink:href="pcbi.1008223.g004"/>
      </fig>
      <p>Our network identified known biological interactions between genes with immune, metabolic, and TF roles; we highlighted 16 gene pairs with experimentally validated interactions (<xref ref-type="fig" rid="pcbi.1008223.g005">Fig 5</xref>, <xref ref-type="supplementary-material" rid="pcbi.1008223.s002">S2 Fig</xref>, and <xref ref-type="supplementary-material" rid="pcbi.1008223.s009">S7 Table</xref>). Known interactions were found using the BIOGRID PPI database [<xref rid="pcbi.1008223.ref056" ref-type="bibr">56</xref>]. <italic>SOCS1</italic> and <italic>SOCS3</italic> bind <italic>IRS2</italic> and promote its degradation, leading to reduced insulin signaling [<xref rid="pcbi.1008223.ref057" ref-type="bibr">57</xref>, <xref rid="pcbi.1008223.ref058" ref-type="bibr">58</xref>]; furthermore, <italic>SOCS1</italic> represses <italic>IL-4</italic>-induced <italic>IRS2</italic> singling [<xref rid="pcbi.1008223.ref059" ref-type="bibr">59</xref>]. <italic>NR4A1</italic> heterodimerizes with <italic>RXRA</italic> to activate it in order to promote gene expression under vitamin A signaling [<xref rid="pcbi.1008223.ref060" ref-type="bibr">60</xref>]; <italic>NR4A1</italic> also inhibits <italic>p</italic>300-induced <italic>RXRA</italic> acetylation [<xref rid="pcbi.1008223.ref061" ref-type="bibr">61</xref>]. Eleven of the 16 edges had the correct interaction direction; the five that were reversed are <italic>TNFAIP3</italic> → <italic>IRAK2</italic>, <italic>SOCS3</italic> → <italic>HIVEP1</italic>, <italic>ATF3</italic> → <italic>MDM2</italic>, <italic>E2F1</italic> → <italic>CDH1</italic>, and <italic>FOS</italic> → <italic>EGFR</italic>. These results suggest that BETS infers biologically meaningful relationships, but transcriptional data, absent other assays on protein abundance and cellular dynamics, are often underpowered to resolve the direction of the edge.</p>
      <fig id="pcbi.1008223.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008223.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Time-series profiles of experimentally validated causal interactions across gene classes.</title>
          <p>For each gene pair, their profiles were from either the <italic>original exposure</italic> data set or the <italic>unperturbed</italic> data set. The effects of all covariates beside the causal gene were controlled in the effect gene values to show the conditional Granger-causal relationship. Colors encode gene classes: pink shows immune genes, dark blue/gray shows metabolic genes, teal shows TFs, and brown/tan shows other genes. Darker colors show causal genes and lighter colors show effect genes. The grey line marks zero-centered expression. Each y-axis tick indicates 0.1 unit-variance standardized ln(TPM). See also <xref ref-type="supplementary-material" rid="pcbi.1008223.s009">S7 Table</xref> and <xref ref-type="supplementary-material" rid="pcbi.1008223.s002">S2 Fig</xref>.</p>
        </caption>
        <graphic xlink:href="pcbi.1008223.g005"/>
      </fig>
    </sec>
    <sec id="sec007">
      <title>2.4 Validation of inferred network on overexpression data</title>
      <p>We asked whether our inferred network edges validated on overexpression versions of the same experimental system, in which each of ten TFs was separately overexpressed over the same 12 hours of observations. Specifically, we assessed the concordance between inferred network edges <italic>g</italic>′ → <italic>g</italic> and their coefficient in the overexpression data set under a VAR model (<xref ref-type="sec" rid="sec010">Methods</xref>).</p>
      <p>We first evaluated how well network edges replicated on individual overexpression data sets. We performed linear regression of a one-hot encoding of the original network’s edge sign (i.e., positive versus no edge or negative; negative versus positive or no edge) as the predictor against the VAR model edge coefficients estimated from each of the overexpression time series as the response (<xref ref-type="fig" rid="pcbi.1008223.g006">Fig 6A and 6B</xref>, <xref ref-type="sec" rid="sec010">Methods</xref>). Of the ten data sets, 9 showed enriched positive effect sizes among positive edges at FDR ≤0.2 (<italic>CEBPB</italic>, <italic>CEBPD</italic>, <italic>FOSL2</italic>, <italic>FOXO1</italic>, <italic>FOXO3</italic>, <italic>KLF6</italic>, <italic>KLF9</italic>, <italic>KLF15</italic>, <italic>OCT4</italic>; <xref ref-type="fig" rid="pcbi.1008223.g006">Fig 6A</xref>). Three data sets showed enriched negative effect sizes among negative edges (<italic>OCT4</italic>, <italic>TFCP2L1</italic>, <italic>CEBPD</italic>) and four showed enriched positive effect sizes among negative edges (<italic>CEBPB</italic>, <italic>FOSL2</italic>, <italic>KLF9</italic>, <italic>KLF15</italic>; <xref ref-type="fig" rid="pcbi.1008223.g006">Fig 6B</xref>). Taken together, the positive edges inferred by BETS validate on the overexpression data, but the negative edges do not, indicating repressive effects may have inconsistent signs or feedback loops.</p>
      <fig id="pcbi.1008223.g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008223.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>Validation of inferred network on overexpression data.</title>
          <p><bold>A-B) Regression of one-hot encoding of positive (negative for B) edges as the predictor against the VAR model edge coefficient from the overexpression data as the response</bold>. A 1 indicates that an edge had a positive (in A) or negative (in B) coefficient in the original inferred network (FDR ≤ 0.2). <bold>C) For the 123 causal edges from <italic>TFCP2L1</italic>, regression of edge sign as the predictor against the VAR model edge coefficient from <italic>TFCP2L1</italic> overexpression data as the response</bold>.</p>
        </caption>
        <graphic xlink:href="pcbi.1008223.g006"/>
      </fig>
      <p>Next, we checked whether the 123 inferred causal edges from the TF <italic>TFCP2L1</italic> validated in the <italic>TFCP2L1</italic> overexpression data set (there were only about 10 causal edges from each of the other 9 TFs). We regressed the original network’s edge sign (+ 1 for positive edges, 0 for no edge, and −1 for negative edge) as the predictor against the overexpression VAR model edge coefficients as the response (<xref ref-type="fig" rid="pcbi.1008223.g006">Fig 6C</xref>). We found a positive relationship between the edge sign and overexpression coefficient (slope 0.17, two-sided t-test <italic>p</italic> ≤ 5 × 10<sup>−5</sup>). This shows that causal edges from <italic>TFCP2L1</italic> are enriched for matched effect directions in the <italic>TFCP2L1</italic> overexpression data.</p>
      <p>This validation may be limited by a misspecification of the linear regression model. As a supplementary analysis, we fit nonstationary GPs to gene trajectories using <italic>nsgp</italic>; genes that were differentially expressed in the TF overexpression data compared to the original exposure data were listed as potential targets of that TF (Supplemental Information). We found that BETS weakly predicts potential targets of 5 of the 10 over-expression TFs. This approach did not show substantial improvement above random prediction of potential targets on these data (FDR ≤ 0.1).</p>
    </sec>
    <sec id="sec008">
      <title>2.5 Validation of network edges through lung trans-eQTLs</title>
      <p>We next validated our network edges on an expression quantitative trait-loci (eQTL) study. A single nucleotide polymorphism (SNP) <italic>S</italic> is an eQTL for a gene <italic>g</italic>′ if it is associated with <italic>g</italic>′’s expression level within a population. Given a true causal edge <italic>g</italic>′ → <italic>g</italic>, if a SNP <italic>S</italic> is a local (cis-) eQTL for <italic>g</italic>′, <italic>S</italic> might also be a distal (trans-) eQTL for <italic>g</italic> [<xref rid="pcbi.1008223.ref062" ref-type="bibr">62</xref>]. We used gene expression levels in primary lung tissue (<italic>n</italic> = 278) from the Genotype Tissue Expression (GTEx) project v6p [<xref rid="pcbi.1008223.ref014" ref-type="bibr">14</xref>]. We observed an enrichment of low trans-eQTL association p-values from the directed network compared to shuffling the variant labels (<xref ref-type="fig" rid="pcbi.1008223.g007">Fig 7A and 7B</xref>). This suggests our network captures more valid causal effects than expected by chance.</p>
      <fig id="pcbi.1008223.g007" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008223.g007</object-id>
        <label>Fig 7</label>
        <caption>
          <title>Network edge validation using known cis- elements from GTEx v6 lung cis-eQTLs.</title>
          <p><bold>A) Enrichment of trans associations in primary lung tissue among p-values from edges inferred by BETS</bold> compared to p-values from permutations. <bold>B) Quantile-quantile plot of validated edges</bold> shows signal enrichment in lung samples when compared to signals from four other tissues in the GTEx v6 study. <bold>C) SNPs associated with inferred gene pairs</bold>. Genotype-phenotype plots corresponding to the cis-effect (left column), correlation in the GTEx v6 data between cause (y-axis) and effect (x-axis) gene pairs (right column).</p>
        </caption>
        <graphic xlink:href="pcbi.1008223.g007"/>
      </fig>
      <p>We next inspected specific associations and their corresponding edges. We found 340 trans-eQTL pairs in lung samples corresponding to 130 network edges (q-value FDR ≤ 0.2). There are more trans-eQTLs than edges because there are multiple cis-eQTLs for some causal genes <italic>g</italic>′. The 340 trans-eQTLs greatly improved upon the 2 identified in primary lung tissue in the GTEx v6 trans-eQTL study [<xref rid="pcbi.1008223.ref063" ref-type="bibr">63</xref>], demonstrating the utility of transcriptional time series for prioritizing promising associations. The top trans-associations were rs2302178-<italic>CLDN1</italic> (q-value FDR ≤ 0.095; extended from the cis-association rs2302178-<italic>HS3ST6</italic>), rs590429-<italic>ADAMTS</italic> (q-value FDR ≤ 0.11; extended from the cis-association rs2302178-<italic>OLR1</italic>), and rs2072783-<italic>CLIP2</italic> (q-value FDR ≤ 0.11; extended from the cis-association rs2302178-<italic>GMPR</italic>; <xref ref-type="fig" rid="pcbi.1008223.g007">Fig 7C</xref>).</p>
      <p>We searched for validated associations between immune-related genes, metabolic-related genes, and TFs. One association was <italic>OLR1</italic> → <italic>ITGAV</italic>, where the known association between SNP rs4329754 and <italic>OLR1</italic> extends to an association between the same genetic variant and effect gene <italic>ITGAV</italic> (q-value FDR ≤0.13) [<xref rid="pcbi.1008223.ref014" ref-type="bibr">14</xref>]. <italic>OLR1</italic> plays key roles in immunity and metabolism [<xref rid="pcbi.1008223.ref064" ref-type="bibr">64</xref>, <xref rid="pcbi.1008223.ref065" ref-type="bibr">65</xref>]. It is associated with metabolic syndrome [<xref rid="pcbi.1008223.ref066" ref-type="bibr">66</xref>] and atherosclerosis [<xref rid="pcbi.1008223.ref066" ref-type="bibr">66</xref>], and modulates inflammatory and humoral immune responses [<xref rid="pcbi.1008223.ref067" ref-type="bibr">67</xref>, <xref rid="pcbi.1008223.ref068" ref-type="bibr">68</xref>]. Meanwhile, <italic>ITGAV</italic> plays a key role in the motility of <italic>CD</italic>4<sup>+</sup> T cells during inflammation [<xref rid="pcbi.1008223.ref069" ref-type="bibr">69</xref>].</p>
      <p>Another association was between the TF <italic>SNAI2</italic> and gene <italic>PTPN6</italic>, where we find that the known association between genetic variant rs56800165 and <italic>SNAI2</italic> extends to an association between the same SNP rs56800165 and effect gene <italic>PTPN6</italic> (q-value FDR ≤0.17) [<xref rid="pcbi.1008223.ref014" ref-type="bibr">14</xref>]. <italic>SNAI2</italic> is a direct target of the glucocorticoid receptor <italic>GR</italic> that regulates cell migration in breast cancer [<xref rid="pcbi.1008223.ref070" ref-type="bibr">70</xref>], while <italic>PTPN6</italic> is involved in glucose homeostasis via negative regulation of insulin signalling [<xref rid="pcbi.1008223.ref071" ref-type="bibr">71</xref>]. <italic>PTPN6</italic> is also associated with inflammatory phenotypes in multiple diseases [<xref rid="pcbi.1008223.ref072" ref-type="bibr">72</xref>, <xref rid="pcbi.1008223.ref073" ref-type="bibr">73</xref>]. Finally, both <italic>SNAI2</italic> and <italic>PTPN6</italic> are involved in the cell-cell adherens junctions pathway, as <italic>SNAI2</italic> represses transcription of cadherin, while <italic>PTPN6</italic> positively regulates the cadherin-catenin complex [<xref rid="pcbi.1008223.ref074" ref-type="bibr">74</xref>]. Thus, for several eQTL-validated edges for gene pairs, we find that the genes are involved in related biological processes, but further experimentation is required to confirm direct interactions.</p>
      <p>As A549 cells are models for lung tissue [<xref rid="pcbi.1008223.ref075" ref-type="bibr">75</xref>], we quantified enrichment of validated edges in lung compared to enrichment in four non-lung tissues with similar sample sizes: subcutaneous adipose (<italic>n</italic> = 298), transformed fibroblasts (<italic>n</italic> = 272), tibial artery (<italic>n</italic> = 285), and thyroid (<italic>n</italic> = 278). We validated 341 unique network edges across the five tissues (FDR ≤ 0.2). 130 edges validated for lung, 4 for subcutaneous adipose, 125 for transformed fibroblasts, 3 for tibial artery, and 82 for thyroid tissues. More network edges validated in primary lung than in non-lung tissues, suggesting that A549 cells most closely match lung samples among GTEx tissues; this is consistent with their tissue of tumor origin.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec009">
    <title>3 Discussion and conclusion</title>
    <p>We described an approach, BETS, to build directed networks using short time-series observations of high-dimensional transcription data. BETS combined ideas from elastic net regression, graphical lasso, stability selection, and VAR models to infer Granger-causal relationships in high-dimensional transcription time-series data. Our method achieved competitive performance on the DREAM4 100-Gene Network Inference Challenge, ranking 7th out of 24 methods in AUPR and 4th out of 19 methods in AUROC; it was also faster than several methods with similar or better performance and infers effect size and sign, unlike the other top performing methods. Stability selection resulted in consistent improvement to VAR models across different hyperparameter settings.</p>
    <p>Next, we applied BETS to time-series RNA-seq data from human A549 cells exposed to glucocorticoids and identified a directed network of 31, 945 edges (FDR ≤0.2), capturing the causal relationships among genes after exposure to GCs. Despite the intervention of GCs in this cell line, we expect that many of the causal relationships estimated using these data will exist across cellular environments in lung cells. In our estimated causal network, we found enrichment of immune genes and TFs among causal genes. We also found enrichment of 11 specific types of causal edges from TFs, immune genes, and metabolic genes. We validated our network first in ten overexpression data sets. Edges that were positive in the original network had an enrichment of positive VAR effect sizes in the overexpression data. However, edges in the original network did not predict differential expression of genes in the overexpression data, as called by <italic>nsgp</italic>. Validating network edges by searching for trans-eQTLs in GTEx primary lung tissue samples, we found an enrichment of associations with genetic variants across network edges. Finally, we discovered 340 trans-eQTLs, a dramatic improvement from the GTEx v6 trans-eQTL study [<xref rid="pcbi.1008223.ref063" ref-type="bibr">63</xref>].</p>
    <p>While BETS has demonstrated effective inference of causal relationships, there are interesting future directions to explore. All methods that infer networks from transcriptional time series face several difficulties: i) Transcript levels are sometimes an imperfect proxy for protein levels, especially when transcript dynamics are changing [<xref rid="pcbi.1008223.ref015" ref-type="bibr">15</xref>, <xref rid="pcbi.1008223.ref076" ref-type="bibr">76</xref>]; ii) the scarcity of time point samples causes statistical challenges for inferring millions of possible causal interactions between genes, let alone non-additive interactions among causes [<xref rid="pcbi.1008223.ref003" ref-type="bibr">3</xref>, <xref rid="pcbi.1008223.ref077" ref-type="bibr">77</xref>, <xref rid="pcbi.1008223.ref078" ref-type="bibr">78</xref>]; iii) transcription data do not capture the complete regulatory context including chromatin structure and epigenetic regulations [<xref rid="pcbi.1008223.ref015" ref-type="bibr">15</xref>]; iv) transcription relationships are often nonstationary: the relationship may change over time due to responses from the environment [<xref rid="pcbi.1008223.ref004" ref-type="bibr">4</xref>, <xref rid="pcbi.1008223.ref005" ref-type="bibr">5</xref>]; and v) inferred networks are often sensitive to the choice of preprocessing and parameter choices [<xref rid="pcbi.1008223.ref079" ref-type="bibr">79</xref>]. Single-cell data also implicitly include transcription time-series information when pseudotime is inferred, making ideas from Granger causality exceptionally relevant. However, recent preprints suggest some limits to pseudotime’s potential for network inference [<xref rid="pcbi.1008223.ref080" ref-type="bibr">80</xref>, <xref rid="pcbi.1008223.ref081" ref-type="bibr">81</xref>]. Finally, experimental followup is key to establishing causality; BETS only generates promising, interpretable hypotheses. Indeed, by discovering hundreds more trans-eQTLs than the GTEx study (a 170-fold increase) [<xref rid="pcbi.1008223.ref063" ref-type="bibr">63</xref>], BETS demonstrates its potential to prioritize biologically meaningful associations.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec010">
    <title>4 Methods</title>
    <sec id="sec011">
      <title>4.1 Method details</title>
      <sec id="sec012">
        <title>Bootstrap Elastic net regression from Time Series (BETS)</title>
        <p>Bootstrap Elastic net regression from Time Series (BETS) is a vector-autoregressive approach to causal inference from gene expression time-series data. It is based on the principle of Granger causality [<xref rid="pcbi.1008223.ref031" ref-type="bibr">31</xref>]: a gene <italic>g</italic>′ Granger-causes another gene <italic>g</italic> if previous information from gene <italic>g</italic>′ improves our current predictions of gene <italic>g</italic>, beyond using previous information from <italic>g</italic> and from other genes.</p>
        <p>BETS first preprocesses the data. BETS fits an elastic net vector autoregression model to handle the high dimensionality of the time series, inferring a network (<xref ref-type="fig" rid="pcbi.1008223.g001">Fig 1A</xref>). It infers one network for each of 1000 bootstrapped samples of the original data set and computes each edge’s selection frequency, or its frequency of appearance among the bootstrapped networks (<xref ref-type="fig" rid="pcbi.1008223.g001">Fig 1B</xref>) [<xref rid="pcbi.1008223.ref003" ref-type="bibr">3</xref>]. Finally, BETS includes an edge in the network using the selection frequencies (<xref ref-type="fig" rid="pcbi.1008223.g001">Fig 1B</xref>). Our baseline comparison, Enet, only preprocesses the data and fits an elastic net vector autoregression model from the original data (<xref ref-type="fig" rid="pcbi.1008223.g001">Fig 1A</xref>; Section 2.2).</p>
      </sec>
      <sec id="sec013">
        <title>Preprocessing temporal time-series data</title>
        <p>For a <bold>gene temporal profile</bold> (i.e., one gene’s expression values across time for a single replicate), we used zero-mean unstandardized normalization, which centers each gene temporal profile to have mean zero across time. Because gene temporal profile ranges from staying almost constant to having drastic fluctuations, BETS uses this approach because a unit-variance normalization would over-represent the weak causal effects of genes with lower variability.</p>
      </sec>
      <sec id="sec014">
        <title>Vector autoregression model</title>
        <p>Let <italic>G</italic> be the set of all genes in the data, let <italic>p</italic> = |<italic>G</italic>| be the number of genes, and let <italic>g</italic> be a gene. Let ¬<italic>g</italic> be <italic>G</italic> with <italic>g</italic> removed. Let there be <italic>T</italic> time points total, and let <italic>t</italic> ∈ {1, 2, …, <italic>T</italic>} be a single time point. Let there be <italic>R</italic> replicates of the gene expression time series.</p>
        <p>Let <inline-formula id="pcbi.1008223.e009"><alternatives><graphic xlink:href="pcbi.1008223.e009.jpg" id="pcbi.1008223.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> be the expression of gene <italic>g</italic> at time <italic>t</italic> for replicate <italic>r</italic>. Let <inline-formula id="pcbi.1008223.e010"><alternatives><graphic xlink:href="pcbi.1008223.e010.jpg" id="pcbi.1008223.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:mo>]</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> be the <italic>R</italic> × 1 vector of gene expression levels of gene <italic>g</italic> across <italic>R</italic> replicates at time <italic>t</italic>. The rest of the paper does not mention replicates for simplicity, but here we discuss replicates for completeness.</p>
        <p>Let <italic>g</italic>′ be the gene we are testing to be causal for gene <italic>g</italic> and let <italic>ℓ</italic> refer to the time lag of the causal edge <italic>g</italic>′ → <italic>g</italic>. Let <italic>L</italic> be the maximum lag. In BETS, <italic>L</italic> = 2 is the default.</p>
        <p>We model each gene <italic>g</italic> as
<disp-formula id="pcbi.1008223.e011"><alternatives><graphic xlink:href="pcbi.1008223.e011.jpg" id="pcbi.1008223.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>∈</mml:mo><mml:mo>¬</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>β</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
where <inline-formula id="pcbi.1008223.e012"><alternatives><graphic xlink:href="pcbi.1008223.e012.jpg" id="pcbi.1008223.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. In other words, the expression of each gene <italic>g</italic> is modeled as a linear function of its and other genes’ <italic>L</italic> previous expression values, under independent Gaussian noise. <inline-formula id="pcbi.1008223.e013"><alternatives><graphic xlink:href="pcbi.1008223.e013.jpg" id="pcbi.1008223.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> represents the (scalar) effect size of gene <italic>g</italic>’s <italic>ℓ</italic>th previous value, <inline-formula id="pcbi.1008223.e014"><alternatives><graphic xlink:href="pcbi.1008223.e014.jpg" id="pcbi.1008223.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, on its current value, <inline-formula id="pcbi.1008223.e015"><alternatives><graphic xlink:href="pcbi.1008223.e015.jpg" id="pcbi.1008223.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:msubsup><mml:mi>X</mml:mi><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>. <inline-formula id="pcbi.1008223.e016"><alternatives><graphic xlink:href="pcbi.1008223.e016.jpg" id="pcbi.1008223.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:msubsup><mml:mi>β</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> represents the (scalar) effect size of the <italic>ℓ</italic>th previous value of gene <italic>g</italic>′ ≠ <italic>g</italic>, <inline-formula id="pcbi.1008223.e017"><alternatives><graphic xlink:href="pcbi.1008223.e017.jpg" id="pcbi.1008223.e017g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M17"><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msubsup></mml:math></alternatives></inline-formula>, on gene <italic>g</italic>’s current value, <inline-formula id="pcbi.1008223.e018"><alternatives><graphic xlink:href="pcbi.1008223.e018.jpg" id="pcbi.1008223.e018g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M18"><mml:msubsup><mml:mi>X</mml:mi><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>. <xref ref-type="disp-formula" rid="pcbi.1008223.e011">Eq 2</xref> requires that <italic>t</italic> &gt; <italic>ℓ</italic> for the <italic>ℓ</italic>th previous value, <inline-formula id="pcbi.1008223.e019"><alternatives><graphic xlink:href="pcbi.1008223.e019.jpg" id="pcbi.1008223.e019g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M19"><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, to exist.</p>
        <p>To demonstrate how our model is fit in practice, we reformulate <xref ref-type="disp-formula" rid="pcbi.1008223.e011">Eq 2</xref> using matrix notation. Each row represents one time point for one replicate. There are <italic>T</italic> − <italic>L</italic> time points with <italic>t</italic> &gt; <italic>L</italic> and <italic>R</italic> replicates, so there are <italic>R</italic>(<italic>T</italic> − <italic>L</italic>) samples, or rows, in total. Let <italic>N</italic> = <italic>R</italic>(<italic>T</italic> − <italic>L</italic>).</p>
        <p>Define <inline-formula id="pcbi.1008223.e020"><alternatives><graphic xlink:href="pcbi.1008223.e020.jpg" id="pcbi.1008223.e020g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M20"><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, an <italic>N</italic> × 1 vector, as:
<disp-formula id="pcbi.1008223.e021"><alternatives><graphic xlink:href="pcbi.1008223.e021.jpg" id="pcbi.1008223.e021g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M21"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>g</mml:mi></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>g</mml:mi></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula></p>
        <p>We can similarly write <inline-formula id="pcbi.1008223.e022"><alternatives><graphic xlink:href="pcbi.1008223.e022.jpg" id="pcbi.1008223.e022g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M22"><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, which is <inline-formula id="pcbi.1008223.e023"><alternatives><graphic xlink:href="pcbi.1008223.e023.jpg" id="pcbi.1008223.e023g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M23"><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> with each entry replaced by its <italic>ℓ</italic>th previous value. Define <inline-formula id="pcbi.1008223.e024"><alternatives><graphic xlink:href="pcbi.1008223.e024.jpg" id="pcbi.1008223.e024g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M24"><mml:msubsup><mml:mi mathvariant="double-struck">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, a <italic>N</italic> × <italic>L</italic> matrix consisting of the first <italic>L</italic> previous vectors <inline-formula id="pcbi.1008223.e025"><alternatives><graphic xlink:href="pcbi.1008223.e025.jpg" id="pcbi.1008223.e025g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M25"><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, i.e., for <italic>ℓ</italic> ranging in {1, …, <italic>L</italic>}.
<disp-formula id="pcbi.1008223.e026"><alternatives><graphic xlink:href="pcbi.1008223.e026.jpg" id="pcbi.1008223.e026g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M26"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi mathvariant="double-struck">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(4)</label></disp-formula>
Let <inline-formula id="pcbi.1008223.e027"><alternatives><graphic xlink:href="pcbi.1008223.e027.jpg" id="pcbi.1008223.e027g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M27"><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> be a <italic>L</italic> × 1 vector of the <italic>L</italic> lagged coefficients.
<disp-formula id="pcbi.1008223.e028"><alternatives><graphic xlink:href="pcbi.1008223.e028.jpg" id="pcbi.1008223.e028g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M28"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mi>α</mml:mi><mml:mn>1</mml:mn><mml:mi>g</mml:mi></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>α</mml:mi><mml:mi>L</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(5)</label></disp-formula></p>
        <p>Next, let us formulate <xref ref-type="disp-formula" rid="pcbi.1008223.e011">Eq 2</xref> involving the genes <italic>g</italic>′ in matrix notation. Let <inline-formula id="pcbi.1008223.e029"><alternatives><graphic xlink:href="pcbi.1008223.e029.jpg" id="pcbi.1008223.e029g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M29"><mml:msubsup><mml:mi mathvariant="double-struck">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mo>¬</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> be a <italic>N</italic> × <italic>L</italic>(|<italic>G</italic>| − 1) predictor matrix of the vectors <inline-formula id="pcbi.1008223.e030"><alternatives><graphic xlink:href="pcbi.1008223.e030.jpg" id="pcbi.1008223.e030g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M30"><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msubsup></mml:math></alternatives></inline-formula>, for <italic>g</italic>′ ≠ <italic>g</italic> and <italic>ℓ</italic> ∈ {1, … <italic>L</italic>}. Note the number of columns is <italic>L</italic>(|<italic>G</italic>| − 1), because there are <italic>L</italic> previous time points <italic>ℓ</italic> ∈ {1, …, <italic>L</italic>}, and for each <italic>ℓ</italic>, there are |<italic>G</italic>| − 1 genes <italic>g</italic>′ ≠ <italic>g</italic>, giving |<italic>G</italic>| − 1 vectors: <inline-formula id="pcbi.1008223.e031"><alternatives><graphic xlink:href="pcbi.1008223.e031.jpg" id="pcbi.1008223.e031g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M31"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:mo>′</mml:mo></mml:msubsup></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mi>G</mml:mi><mml:mo>|</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>.
<disp-formula id="pcbi.1008223.e032"><alternatives><graphic xlink:href="pcbi.1008223.e032.jpg" id="pcbi.1008223.e032g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M32"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi mathvariant="double-struck">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mo>¬</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:mo>′</mml:mo></mml:msubsup></mml:msubsup><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mi>G</mml:mi><mml:mo>|</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:msubsup><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:mo>′</mml:mo></mml:msubsup></mml:msubsup><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mi>G</mml:mi><mml:mo>|</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:msubsup><mml:mo>⋯</mml:mo><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mi>G</mml:mi><mml:mo>|</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(6)</label></disp-formula>
Let <inline-formula id="pcbi.1008223.e033"><alternatives><graphic xlink:href="pcbi.1008223.e033.jpg" id="pcbi.1008223.e033g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M33"><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mi>ℓ</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> be a <italic>L</italic>(|<italic>G</italic>| − 1) × 1 vector of the causal coefficients <inline-formula id="pcbi.1008223.e034"><alternatives><graphic xlink:href="pcbi.1008223.e034.jpg" id="pcbi.1008223.e034g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M34"><mml:msubsup><mml:mi>β</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> where <italic>g</italic>′ ≠ <italic>g</italic>.
<disp-formula id="pcbi.1008223.e035"><alternatives><graphic xlink:href="pcbi.1008223.e035.jpg" id="pcbi.1008223.e035g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M35"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mi>ℓ</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mi>β</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>β</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mi>G</mml:mi><mml:mo>|</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>β</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>β</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mi>G</mml:mi><mml:mo>|</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>β</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mi>G</mml:mi><mml:mo>|</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(7)</label></disp-formula></p>
        <p>We then fit the model:
<disp-formula id="pcbi.1008223.e036"><alternatives><graphic xlink:href="pcbi.1008223.e036.jpg" id="pcbi.1008223.e036g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M36"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mo>¬</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mi>ℓ</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(8)</label></disp-formula>
where <italic>ϵ</italic><sub><italic>t</italic></sub> is a <italic>N</italic> × 1 vector with each element <inline-formula id="pcbi.1008223.e037"><alternatives><graphic xlink:href="pcbi.1008223.e037.jpg" id="pcbi.1008223.e037g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M37"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. In its most compact form, we can write
<disp-formula id="pcbi.1008223.e038"><alternatives><graphic xlink:href="pcbi.1008223.e038.jpg" id="pcbi.1008223.e038g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M38"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi mathvariant="double-struck">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>G</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:msubsup><mml:mi mathvariant="double-struck">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mo>¬</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="4pt"/><mml:msup><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mi>ℓ</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(9)</label></disp-formula></p>
        <p>Note that <inline-formula id="pcbi.1008223.e039"><alternatives><graphic xlink:href="pcbi.1008223.e039.jpg" id="pcbi.1008223.e039g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M39"><mml:msubsup><mml:mi mathvariant="double-struck">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>G</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is a <italic>N</italic> × <italic>L</italic>|<italic>G</italic>| matrix and <inline-formula id="pcbi.1008223.e040"><alternatives><graphic xlink:href="pcbi.1008223.e040.jpg" id="pcbi.1008223.e040g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M40"><mml:msup><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msup></mml:math></alternatives></inline-formula> is a <italic>L</italic>|<italic>G</italic>| × 1 vector. Thus, the matrix formulation of <xref ref-type="disp-formula" rid="pcbi.1008223.e011">Eq 2</xref> is:
<disp-formula id="pcbi.1008223.e041"><alternatives><graphic xlink:href="pcbi.1008223.e041.jpg" id="pcbi.1008223.e041g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M41"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>G</mml:mi></mml:msubsup><mml:msup><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(10)</label></disp-formula></p>
      </sec>
      <sec id="sec015">
        <title>Elastic net penalty</title>
        <p>Because of the large number of predictors as compared to the small number of samples, we use the elastic net penalty, which is a generalization of both ridge and lasso penalties. The elastic net fits the following objective:
<disp-formula id="pcbi.1008223.e042"><alternatives><graphic xlink:href="pcbi.1008223.e042.jpg" id="pcbi.1008223.e042g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M42"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mtext>ELASTIC</mml:mtext><mml:mspace width="4pt"/><mml:mtext>NET</mml:mtext></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>arg</mml:mtext><mml:mspace width="0.166667em"/><mml:mtext>min</mml:mtext></mml:mrow><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>|</mml:mo><mml:mi>G</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:mrow><mml:mo>‖</mml:mo><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>G</mml:mi></mml:msubsup><mml:msup><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msup><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>λ</mml:mo><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msup><mml:msub><mml:mo>‖</mml:mo><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msup><mml:mrow><mml:msubsup><mml:mo>‖</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(11)</label></disp-formula>
Here ‖ ⋅ ‖<sub>1</sub> represents the <italic>ℓ</italic><sub>1</sub>-norm and ‖ ⋅ ‖<sub>2</sub> represents the <italic>ℓ</italic><sub>2</sub>-norm.</p>
        <p>For the elastic net, we used the following ranges of hyperparameter values: λ ∈ {10<sup>−4</sup>, 10<sup>−3</sup>, …, 1}, <italic>a</italic> ∈ {0.1, 0.3, …, 0.9}. For lasso, we used λ ∈ {10<sup>−5</sup>, …, 1}. For ridge, when we used {10<sup>−5</sup>, …, 1}, we found that the optimal value selected in some cases was the maximum value of λ = 1. We thus expanded the range to {10<sup>−5</sup>, …, 10<sup>6</sup>} to ensure that we were not missing better hyperparameters at larger values. At this point, the optimal λ was found to be 100.</p>
      </sec>
      <sec id="sec016">
        <title>Hyperparameter tuning</title>
        <p>Hyperparameters were selected using leave-one-out cross-validation (LOOCV). The hyperparameter (or pair of hyperparameters, for elastic net) that minimizes the mean-squared error on the held-out observations is selected. More specifically, we first fix a hyperparameter (λ, <italic>a</italic>). Then, for a given gene <italic>g</italic> and row index <italic>i</italic>, extract the <italic>i</italic>th row of <inline-formula id="pcbi.1008223.e043"><alternatives><graphic xlink:href="pcbi.1008223.e043.jpg" id="pcbi.1008223.e043g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M43"><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1008223.e044"><alternatives><graphic xlink:href="pcbi.1008223.e044.jpg" id="pcbi.1008223.e044g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M44"><mml:msubsup><mml:mi mathvariant="double-struck">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>G</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>. We refer to this extracted validation set as <inline-formula id="pcbi.1008223.e045"><alternatives><graphic xlink:href="pcbi.1008223.e045.jpg" id="pcbi.1008223.e045g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M45"><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> (<italic>target</italic>) and <inline-formula id="pcbi.1008223.e046"><alternatives><graphic xlink:href="pcbi.1008223.e046.jpg" id="pcbi.1008223.e046g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M46"><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> (<italic>predictors</italic>). The remaining data is the training set, <inline-formula id="pcbi.1008223.e047"><alternatives><graphic xlink:href="pcbi.1008223.e047.jpg" id="pcbi.1008223.e047g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M47"><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> (<italic>target</italic>) and <inline-formula id="pcbi.1008223.e048"><alternatives><graphic xlink:href="pcbi.1008223.e048.jpg" id="pcbi.1008223.e048g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M48"><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>G</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> (<italic>predictors</italic>).</p>
        <p>First, let <inline-formula id="pcbi.1008223.e049"><alternatives><graphic xlink:href="pcbi.1008223.e049.jpg" id="pcbi.1008223.e049g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M49"><mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mo>λ</mml:mo><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> be the <inline-formula id="pcbi.1008223.e050"><alternatives><graphic xlink:href="pcbi.1008223.e050.jpg" id="pcbi.1008223.e050g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M50"><mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mtext>ELASTIC</mml:mtext><mml:mspace width="2pt"/><mml:mtext>NET</mml:mtext></mml:mrow><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> that is fit from the training set.
<disp-formula id="pcbi.1008223.e051"><alternatives><graphic xlink:href="pcbi.1008223.e051.jpg" id="pcbi.1008223.e051g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M51"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mo>λ</mml:mo><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>arg</mml:mtext><mml:mspace width="0.166667em"/><mml:mtext>min</mml:mtext></mml:mrow><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>|</mml:mo><mml:mi>G</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:mrow><mml:mo>‖</mml:mo><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>G</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msup><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>λ</mml:mo><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msup><mml:msub><mml:mo>‖</mml:mo><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msup><mml:mrow><mml:msubsup><mml:mo>‖</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(12)</label></disp-formula></p>
        <p>We then compute prediction error on the validation set, <inline-formula id="pcbi.1008223.e052"><alternatives><graphic xlink:href="pcbi.1008223.e052.jpg" id="pcbi.1008223.e052g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M52"><mml:mrow><mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>G</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mo>λ</mml:mo><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mo>‖</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. We repeat the fit <inline-formula id="pcbi.1008223.e053"><alternatives><graphic xlink:href="pcbi.1008223.e053.jpg" id="pcbi.1008223.e053g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M53"><mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mo>λ</mml:mo><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and error for every row index <italic>i</italic> of <inline-formula id="pcbi.1008223.e054"><alternatives><graphic xlink:href="pcbi.1008223.e054.jpg" id="pcbi.1008223.e054g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M54"><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and for every gene <italic>g</italic>. The mean held-out cross-validation error for (λ, <italic>a</italic>) is:
<disp-formula id="pcbi.1008223.e055"><alternatives><graphic xlink:href="pcbi.1008223.e055.jpg" id="pcbi.1008223.e055g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M55"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mo>λ</mml:mo><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:munder><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>G</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mo>λ</mml:mo><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(13)</label></disp-formula>
The (λ, <italic>a</italic>) that minimizes the error in <xref ref-type="disp-formula" rid="pcbi.1008223.e055">Eq 13</xref> is selected.</p>
      </sec>
      <sec id="sec017">
        <title>Permuted coefficients</title>
        <p>We evaluate the significance of any given edge <italic>g</italic>′ → <italic>g</italic> through permutation. In detail, we remove the time dependency between <italic>g</italic>′ and <italic>g</italic> via permutations of individual gene temporal profiles over time.</p>
        <p>We first generate a single permuted data set <inline-formula id="pcbi.1008223.e056"><alternatives><graphic xlink:href="pcbi.1008223.e056.jpg" id="pcbi.1008223.e056g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M56"><mml:msubsup><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>. For each gene, we independently shuffle the temporal profile of each gene <italic>g</italic> ∈ {1, …, |<italic>G</italic>|} across time (<xref ref-type="fig" rid="pcbi.1008223.g001">Fig 1A</xref>). This is done separately for distinct replicates.</p>
        <p>We wish to model the hypothesis of no causal relations from any gene <italic>g</italic>′ ∈ ¬<italic>g</italic>, upon a given effect gene <italic>g</italic>. We use the unpermuted values of the effect gene <inline-formula id="pcbi.1008223.e057"><alternatives><graphic xlink:href="pcbi.1008223.e057.jpg" id="pcbi.1008223.e057g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M57"><mml:msubsup><mml:mi>X</mml:mi><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and the permuted values of all other causal genes <italic>g</italic>′ ∈ ¬<italic>g</italic>, as <inline-formula id="pcbi.1008223.e058"><alternatives><graphic xlink:href="pcbi.1008223.e058.jpg" id="pcbi.1008223.e058g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M58"><mml:msubsup><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>t</mml:mi><mml:mrow><mml:mo>¬</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. The effect gene <italic>g</italic> remains unpermuted, as we do not consider self-regulatory loops.</p>
        <p>Permutation-based causal coefficients <inline-formula id="pcbi.1008223.e059"><alternatives><graphic xlink:href="pcbi.1008223.e059.jpg" id="pcbi.1008223.e059g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M59"><mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>ℓ</mml:mi><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> are then fit as
<disp-formula id="pcbi.1008223.e060"><alternatives><graphic xlink:href="pcbi.1008223.e060.jpg" id="pcbi.1008223.e060g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M60"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>∈</mml:mo><mml:mo>¬</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(14)</label></disp-formula>
We use these coefficients to perform FDR calibration.</p>
      </sec>
      <sec id="sec018">
        <title>Edge FDR</title>
        <p>The result of the elastic net VAR model is a complete network whose edges are weighted according to the estimated regression coefficients.</p>
        <p>For each lag <italic>ℓ</italic> ∈ {1, …, <italic>L</italic>} and effect gene <italic>g</italic>, we control the edge FDR at ≤0.05 by finding the threshold <inline-formula id="pcbi.1008223.e061"><alternatives><graphic xlink:href="pcbi.1008223.e061.jpg" id="pcbi.1008223.e061g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M61"><mml:msubsup><mml:mi>T</mml:mi><mml:mi>ℓ</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> such that
<disp-formula id="pcbi.1008223.e062"><alternatives><graphic xlink:href="pcbi.1008223.e062.jpg" id="pcbi.1008223.e062g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M62"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>∈</mml:mo><mml:mo>¬</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo>{</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mi>ℓ</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>∈</mml:mo><mml:mo>¬</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo>{</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo></mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mi>ℓ</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mrow><mml:mo>}</mml:mo><mml:mo>+</mml:mo></mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>∈</mml:mo><mml:mo>¬</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo>{</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:msubsup><mml:mi>β</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mi>ℓ</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>≤</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>05</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(15)</label></disp-formula>
For each gene pair (<italic>g</italic>′, <italic>g</italic>), <italic>g</italic>′ ∈ ¬<italic>g</italic>, a directed edge <italic>g</italic>′ → <italic>g</italic> exists if, for at least one of the lags <italic>ℓ</italic> ∈ {1, …, <italic>L</italic>}, <inline-formula id="pcbi.1008223.e063"><alternatives><graphic xlink:href="pcbi.1008223.e063.jpg" id="pcbi.1008223.e063g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M63"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msubsup><mml:mi>β</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo></mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mi>ℓ</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
      </sec>
      <sec id="sec019">
        <title>Stability selection</title>
        <p>Stability selection is used to ensure the robustness of BETS to small sample size. Stability selection is a method for high-dimensional graph estimation that uses bootstrap samples [<xref rid="pcbi.1008223.ref082" ref-type="bibr">82</xref>]. While the authors prove finite sample control for the family-wise error rate (FWER), we are interested in controlling the false discovery rate (FDR).</p>
        <p>This procedure draws <italic>B</italic> = 1000 bootstrap samples, where each sample consists of <italic>N</italic> rows drawn with replacement from output <inline-formula id="pcbi.1008223.e064"><alternatives><graphic xlink:href="pcbi.1008223.e064.jpg" id="pcbi.1008223.e064g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M64"><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and input <inline-formula id="pcbi.1008223.e065"><alternatives><graphic xlink:href="pcbi.1008223.e065.jpg" id="pcbi.1008223.e065g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M65"><mml:msubsup><mml:mi mathvariant="double-struck">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>G</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> (<xref ref-type="disp-formula" rid="pcbi.1008223.e041">Eq 10</xref>). Let the <italic>j</italic>th bootstrap sample from the original data be <inline-formula id="pcbi.1008223.e066"><alternatives><graphic xlink:href="pcbi.1008223.e066.jpg" id="pcbi.1008223.e066g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M66"><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1008223.e067"><alternatives><graphic xlink:href="pcbi.1008223.e067.jpg" id="pcbi.1008223.e067g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M67"><mml:msubsup><mml:mi mathvariant="double-struck">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. A set of <italic>N</italic> row indices, <italic>I</italic><sup><italic>j</italic></sup>, are sampled with replacement from [1, 2, …, <italic>N</italic>]. <inline-formula id="pcbi.1008223.e068"><alternatives><graphic xlink:href="pcbi.1008223.e068.jpg" id="pcbi.1008223.e068g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M68"><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1008223.e069"><alternatives><graphic xlink:href="pcbi.1008223.e069.jpg" id="pcbi.1008223.e069g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M69"><mml:msubsup><mml:mi mathvariant="double-struck">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> are created by choosing the rows <italic>I</italic><sup><italic>j</italic></sup> of <inline-formula id="pcbi.1008223.e070"><alternatives><graphic xlink:href="pcbi.1008223.e070.jpg" id="pcbi.1008223.e070g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M70"><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1008223.e071"><alternatives><graphic xlink:href="pcbi.1008223.e071.jpg" id="pcbi.1008223.e071g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M71"><mml:msubsup><mml:mi mathvariant="double-struck">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>G</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>. <inline-formula id="pcbi.1008223.e072"><alternatives><graphic xlink:href="pcbi.1008223.e072.jpg" id="pcbi.1008223.e072g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M72"><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is an <italic>N</italic> × 1 vector and <inline-formula id="pcbi.1008223.e073"><alternatives><graphic xlink:href="pcbi.1008223.e073.jpg" id="pcbi.1008223.e073g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M73"><mml:msubsup><mml:mi mathvariant="double-struck">X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is an <italic>N</italic> × <italic>L</italic>|<italic>G</italic>| matrix.</p>
        <p>Now consider the permuted output and input, <inline-formula id="pcbi.1008223.e074"><alternatives><graphic xlink:href="pcbi.1008223.e074.jpg" id="pcbi.1008223.e074g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M74"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1008223.e075"><alternatives><graphic xlink:href="pcbi.1008223.e075.jpg" id="pcbi.1008223.e075g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M75"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="double-struck">X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>G</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, constructed from <inline-formula id="pcbi.1008223.e076"><alternatives><graphic xlink:href="pcbi.1008223.e076.jpg" id="pcbi.1008223.e076g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M76"><mml:msubsup><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> (<xref ref-type="disp-formula" rid="pcbi.1008223.e041">Eq 10</xref>). Let the <italic>j</italic>th bootstrap sample from the permuted data be <inline-formula id="pcbi.1008223.e077"><alternatives><graphic xlink:href="pcbi.1008223.e077.jpg" id="pcbi.1008223.e077g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M77"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>t</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1008223.e078"><alternatives><graphic xlink:href="pcbi.1008223.e078.jpg" id="pcbi.1008223.e078g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M78"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="double-struck">X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. <inline-formula id="pcbi.1008223.e079"><alternatives><graphic xlink:href="pcbi.1008223.e079.jpg" id="pcbi.1008223.e079g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M79"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>t</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1008223.e080"><alternatives><graphic xlink:href="pcbi.1008223.e080.jpg" id="pcbi.1008223.e080g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M80"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="double-struck">X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> are created by choosing the rows <italic>I</italic><sup><italic>j</italic></sup> of <inline-formula id="pcbi.1008223.e081"><alternatives><graphic xlink:href="pcbi.1008223.e081.jpg" id="pcbi.1008223.e081g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M81"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1008223.e082"><alternatives><graphic xlink:href="pcbi.1008223.e082.jpg" id="pcbi.1008223.e082g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M82"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="double-struck">X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>G</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>.</p>
        <p>Thus, the <italic>j</italic>th bootstrap sample for both the original and permuted data sets use the same row indices <italic>I</italic><sup><italic>j</italic></sup>.</p>
        <p>For each of the 1000 bootstrap samples, we infer a network using the elastic net fit and edge FDR procedure described earlier. Each edge <italic>g</italic>′ → <italic>g</italic>’s selection frequency, <italic>π</italic><sub><italic>g</italic>′, <italic>g</italic></sub> (the frequency of <italic>g</italic>′ → <italic>g</italic> among the 1000 bootstrap networks) is computed (<xref ref-type="fig" rid="pcbi.1008223.g001">Fig 1B</xref>).</p>
      </sec>
      <sec id="sec020">
        <title>Stability FDR</title>
        <p>To determine the appropriate cutoff for the selection frequency of each edge (<italic>π</italic><sub><italic>g</italic>′, <italic>g</italic></sub>), we generate a null distribution of selection frequencies using permutations. First, we generate a second permuted data set <inline-formula id="pcbi.1008223.e083"><alternatives><graphic xlink:href="pcbi.1008223.e083.jpg" id="pcbi.1008223.e083g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M83"><mml:msubsup><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> in which we again independently shuffle the temporal profile of each gene <italic>g</italic> ∈ {1, …, |<italic>G</italic>|} across time. This is done separately for distinct replicates.</p>
        <p>We run the stability selection procedure on <inline-formula id="pcbi.1008223.e084"><alternatives><graphic xlink:href="pcbi.1008223.e084.jpg" id="pcbi.1008223.e084g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M84"><mml:msubsup><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> as if it were <inline-formula id="pcbi.1008223.e085"><alternatives><graphic xlink:href="pcbi.1008223.e085.jpg" id="pcbi.1008223.e085g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M85"><mml:msubsup><mml:mi>X</mml:mi><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, using the same set of row indices <italic>I</italic><sup><italic>j</italic></sup> to generate the bootstrap samples, and using <inline-formula id="pcbi.1008223.e086"><alternatives><graphic xlink:href="pcbi.1008223.e086.jpg" id="pcbi.1008223.e086g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M86"><mml:msubsup><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> to generate the permuted coefficients.</p>
        <p>After running for all <italic>B</italic> = 1000 bootstrap samples, we obtain the null selection frequency of each edge, <inline-formula id="pcbi.1008223.e087"><alternatives><graphic xlink:href="pcbi.1008223.e087.jpg" id="pcbi.1008223.e087g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M87"><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>.</p>
        <p>We control the stability FDR at 0.2 by finding the threshold <italic>T</italic><sub><italic>b</italic></sub> such that 
<disp-formula id="pcbi.1008223.e088"><alternatives><graphic xlink:href="pcbi.1008223.e088.jpg" id="pcbi.1008223.e088g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M88"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>∈</mml:mo><mml:mo>¬</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mn mathvariant="double-struck">1</mml:mn><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>∈</mml:mo><mml:mo>¬</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mn mathvariant="double-struck">1</mml:mn><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>∈</mml:mo><mml:mo>¬</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mn mathvariant="double-struck">1</mml:mn><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>≤</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>2</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(16)</label></disp-formula>
Because the maximum lag is 2, each edge <italic>g</italic>′ → <italic>g</italic> has two possible lags and thus two selection frequencies. The lag with larger absolute value of average coefficient across the 1, 000 networks is considered in both the permuted and the real empirical distributions. So, if <inline-formula id="pcbi.1008223.e089"><alternatives><graphic xlink:href="pcbi.1008223.e089.jpg" id="pcbi.1008223.e089g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M89"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msubsup><mml:mi>β</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> exceeds <inline-formula id="pcbi.1008223.e090"><alternatives><graphic xlink:href="pcbi.1008223.e090.jpg" id="pcbi.1008223.e090g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M90"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msubsup><mml:mi>β</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, the lag is said to be 1 and the selection frequency <inline-formula id="pcbi.1008223.e091"><alternatives><graphic xlink:href="pcbi.1008223.e091.jpg" id="pcbi.1008223.e091g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M91"><mml:msubsup><mml:mi>π</mml:mi><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> is used.</p>
      </sec>
      <sec id="sec021">
        <title>Network inference performance metrics</title>
        <p>Refer to every network edge inferred by a method as a positive and every missing edge as a negative. Let <italic>TP</italic> be True Positives, <italic>FP</italic> be False Positives, <italic>TN</italic> be True Negatives, and <italic>FN</italic> be False Negatives. Let <italic>TPR</italic> be True Positive Rate, (i.e., recall), and <italic>FPR</italic> be False Positive Rate. Then, we have
<disp-formula id="pcbi.1008223.e092"><alternatives><graphic xlink:href="pcbi.1008223.e092.jpg" id="pcbi.1008223.e092g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M92"><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1008223.e093"><alternatives><graphic xlink:href="pcbi.1008223.e093.jpg" id="pcbi.1008223.e093g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M93"><mml:mrow><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1008223.e094"><alternatives><graphic xlink:href="pcbi.1008223.e094.jpg" id="pcbi.1008223.e094g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M94"><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></disp-formula></p>
        <p>In the DREAM benchmark, each network inference method is evaluated by comparing the true network (i.e., the network used to generate the synthetic data) with the inferred network at different thresholds for edge inclusion. The two main evaluation metrics are Area Under the Receiver Operating Characteristic curve (AUROC) and Area Under the Precision-Recall curve (AUPR). AUROC plots TPR on the <italic>y</italic> axis and FPR on the <italic>x</italic> axis. AUPR plots precision on the <italic>y</italic> axis and recall on the <italic>x</italic> axis. When the number of negatives greatly exceeds the number of positives, as with gene networks, which are typically sparse, AUPR is a more relevant metric [<xref rid="pcbi.1008223.ref083" ref-type="bibr">83</xref>].</p>
      </sec>
    </sec>
    <sec id="sec022">
      <title>4.2 Software</title>
      <p>BETS is available for download on Github at <ext-link ext-link-type="uri" xlink:href="https://github.com/lujonathanh/BETS">https://github.com/lujonathanh/BETS</ext-link>. The software is licensed under the terms of the Apache License, version 2.0. The analysis code is available at <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/4009546#.X5XEh0JKg1g">https://zenodo.org/record/4009546#.X5XEh0JKg1g</ext-link>.</p>
    </sec>
    <sec id="sec023">
      <title>4.3 Data sets and processing</title>
      <sec id="sec024">
        <title>DREAM Network Inference Challenge</title>
        <p>There were five data sets in the DREAM4 Network Inference Challenge, each consisting of ten time series of 21 time points and 100 genes [<xref rid="pcbi.1008223.ref045" ref-type="bibr">45</xref>, <xref rid="pcbi.1008223.ref084" ref-type="bibr">84</xref>]. For the first half of the time series, a “drug perturbation” was applied; this affected about 1/3 of genes. For the second half, the perturbation was removed and the system was allowed to relax back to the wild-type state.</p>
      </sec>
      <sec id="sec025">
        <title>Glucocorticoid gene expression data</title>
        <p>We analyzed RNA-sequencing data from a set of experiments developed to study glucocorticoid receptors (GRs) in the human adenocarcinoma and lung model cell line, A549 [<xref rid="pcbi.1008223.ref006" ref-type="bibr">6</xref>]. There was an <italic>original exposure</italic> data set of 4 replicates in which cells were stimulated by the glucocorticoid dexamethasone (dex), and gene expression was profiled at {0, 0.5, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12} hours of dex stimulation. There was also an <italic>unperturbed</italic> data set of 3 replicates in which cells were exposed to dex for 12 hours, after which the conditioned media was replaced and dex removed. Gene expression was profiled at {0, 0.5, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12} hours after dex removal. We integrated the <italic>original exposure</italic> and <italic>unperturbed</italic> data into a joint data set with 7 replicates. The <italic>original exposure</italic> data set is available at the Gene Expression Omnibus (GEO), with reference numbers listed for the rows that list “RNASeq” as the Assay under the column “Experiment_GEO_Series” in Supplementary Table 3 of [<xref rid="pcbi.1008223.ref006" ref-type="bibr">6</xref>]. The GEO accession numbers for time points {0, 0.5, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12} of the <italic>original exposure data</italic> set are GSE91305, GSE91198, GSE91311, GSE91358, GSE91303, GSE91243, GSE91281, GSE91229, GSE91255, GSE91284, GSE91222, and GSE91212, respectively. The <italic>unperturbed</italic> data set is available at GEO accession number GSE144662.</p>
        <p>We selected 2768 genes for analysis, which had average expression &gt; 2 Transcripts Per kilobase Million (TPM) and were differentially expressed in the original exposure data. A gene was called differentially expressed if its expression at any time point differed from its expression at time 0, ascertained by running edgeR (FDR ≤ 0.05) [<xref rid="pcbi.1008223.ref006" ref-type="bibr">6</xref>]. We added <italic>NR3C1</italic>, which encodes the glucocorticoid receptor (GR). <italic>NR3C1</italic> was not found to be differentially expressed at FDR ≤ 0.05.</p>
        <p>After genes were selected, gene expression TPM were log-normalized and corrected for surrogate variables using SVAseq [<xref rid="pcbi.1008223.ref085" ref-type="bibr">85</xref>]. Each gene’s temporal profile was centered to have mean zero across time. In the <italic>original exposure data</italic>, all replicates besides replicate 1 had a measurement for each time point. Replicate 1 was missing time points 5 and 6 hrs, so we imputed these values using a linear interpolation from time points 4 and 7 hrs in the log-transformed, surrogate-corrected space.</p>
      </sec>
      <sec id="sec026">
        <title>Overexpression transcriptional time-series data</title>
        <p>There were ten <italic>overexpression</italic> data sets, in which each of the transcription factors <italic>CEBPB</italic>, <italic>CEBPD</italic>, <italic>FOSL2</italic>, <italic>FOXO1</italic>, <italic>FOXO3</italic>, <italic>KLF6</italic>, <italic>KLF9</italic>, <italic>KLF15</italic>, <italic>POU5F1</italic>, and <italic>TFCP2L1</italic> was separately overexpressed across 12 hours of dex stimulation. Each overexpression data set had three replicates; gene expression was profiled after {0, 1, 4, 8, 12} hours of dex stimulation. The same 2768 genes were selected and the same normalization and SVAseq correction as earlier was performed. The <italic>overexpression</italic> data sets are available at the Gene Expression Omnibus at GEO accession number GSE144660.</p>
      </sec>
    </sec>
    <sec id="sec027">
      <title>4.4 Application of methods to the data</title>
      <sec id="sec028">
        <title>DREAM benchmarking</title>
        <p>We ran the methods BETS, Enet, CSId [<xref rid="pcbi.1008223.ref044" ref-type="bibr">44</xref>], Jump3 [<xref rid="pcbi.1008223.ref036" ref-type="bibr">36</xref>], CLR [<xref rid="pcbi.1008223.ref027" ref-type="bibr">27</xref>], MRNET [<xref rid="pcbi.1008223.ref028" ref-type="bibr">28</xref>], ARACNE [<xref rid="pcbi.1008223.ref029" ref-type="bibr">29</xref>], SWING-RF [<xref rid="pcbi.1008223.ref051" ref-type="bibr">51</xref>], and SWING-Lasso [<xref rid="pcbi.1008223.ref051" ref-type="bibr">51</xref>] on the DREAM challenge. In BETS, inferred edges were ranked by their selection frequency for calculating AUPR and AUROC. In Enet, edges were ranked by the absolute value of their coefficient. The Python3 version of CSId was run after obtaining it from correspondence with Dr. Penfold.</p>
        <p>Jump3 required setting the “systematic noise” and “observational noise” parameters. We used Dr. Huynh-Thu’s settings on the DREAM challenge, with systematic noise at 1<italic>e</italic> − 4 and observational noise at 0.01 times the value of the gene’s expression. ARACNE, MRNET, and CLR were run using the minet R library. BETS, Enet, CSId, and Jump3 were run on a single node without parallelization. The node had 28 cores, 128 GB of memory, and 2.4 GHz processor speed. ARACNE, MRNET, and CLR were run on a 4 GB RAM, Intel Core i5 1.3 GHz laptop.</p>
      </sec>
      <sec id="sec029">
        <title>Network analysis: Gene annotations</title>
        <p>We considered genes with three possible labels: immune system, metabolism, or transcription factor. Immune genes were labeled as such using two sources. The first source is the Gene Ontology (GO) annotation “Immune” (<italic>GO:0002376</italic>) [<xref rid="pcbi.1008223.ref052" ref-type="bibr">52</xref>]. We applied this label when the evidence codes were one of EXP, IDA, IGI, IMP, IPI, IC, TAS. The second source is the Gene Ontology Consortium’s curated, ranked list of immune-related genes based on multiple databases and experimental evidence [<xref rid="pcbi.1008223.ref054" ref-type="bibr">54</xref>]. For the GO annotation, we selected all genes with score ≥ 7. This resulted in 616 immune genes overall, and 109 immune genes in our list of 2768 genes.</p>
        <p>Metabolic genes were called using two sources. The first source is the GO annotation “carbohydrate metabolic process” <italic>GO:0005975</italic> [<xref rid="pcbi.1008223.ref052" ref-type="bibr">52</xref>]. We applied this label when the evidence codes were EXP, IDA, IGI, IMP, IPI, IC, TAS. The second source is the Gene Set Enrichment Analysis (GSEA)-curated list of metabolic-related genes [<xref rid="pcbi.1008223.ref053" ref-type="bibr">53</xref>]. We searched only among those with experimental evidence: the Canonical, KEGG, BIOCARTA, and Reactome pathways. We used the following four search queries: “gluconeogenesis OR (glucose AND metabolism) OR glycolysis,” “lipid AND metabolism,” “Diabetes,” “Obesity.” This resulted in 544 metabolic genes overall, of which 120 were in our gene list. 65 genes were both immune and metabolic overall; 12 of these were in our gene list.</p>
        <p>Transcription factors (TFs) were called using the Bioguo database of human TFs [<xref rid="pcbi.1008223.ref055" ref-type="bibr">55</xref>]. There were 1463 TFs overall, of which 226 were present in our gene list.</p>
      </sec>
      <sec id="sec030">
        <title>Experimental interactions</title>
        <p>We created a list of experimentally validated interactions from the BIOGRID Homo sapiens Protein-Protein Interactions database [<xref rid="pcbi.1008223.ref056" ref-type="bibr">56</xref>]. Proteins were mapped to genes using BioMart from Ensembl 94 [<xref rid="pcbi.1008223.ref086" ref-type="bibr">86</xref>]. Among genes in our gene list, there were 17, 990 BIOGRID interactions.</p>
      </sec>
      <sec id="sec031">
        <title>Validation on overexpression data</title>
        <p>The overexpression data had four time points with 1 to 4 hour time gaps, unlike the original 12 time points with 0.5 to 2 hour time gaps. On the overexpression data, we used a VAR model that regressed each effect gene’s expression level on its previous expression level and the causal gene’s previous expression level, assuming normal noise <inline-formula id="pcbi.1008223.e095"><alternatives><graphic xlink:href="pcbi.1008223.e095.jpg" id="pcbi.1008223.e095g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M95"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>:
<disp-formula id="pcbi.1008223.e096"><alternatives><graphic xlink:href="pcbi.1008223.e096.jpg" id="pcbi.1008223.e096g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M96"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mi>g</mml:mi></mml:msup><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mi>d</mml:mi><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msup><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(17)</label></disp-formula>
No regularization was included, and ordinary least squares was used to fit the equation. The expression <inline-formula id="pcbi.1008223.e097"><alternatives><graphic xlink:href="pcbi.1008223.e097.jpg" id="pcbi.1008223.e097g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M97"><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msubsup></mml:math></alternatives></inline-formula> of a causal gene <italic>g</italic>′ is fit as a single predictor without the other expression. Lag 1, not 2, is used due to the larger time gaps.</p>
      </sec>
      <sec id="sec032">
        <title>Validation on lung trans-eQTLs in GTEx v6</title>
        <p>Trans-eQTLs were discovered using the Genotype Tissue Expression (GTEx) v6 data [<xref rid="pcbi.1008223.ref014" ref-type="bibr">14</xref>, <xref rid="pcbi.1008223.ref063" ref-type="bibr">63</xref>]. First, we mapped our genes from hg38 to hg19. For every edge <italic>g</italic>′ → <italic>g</italic>, we tested the set of genetic variants within 20 kilobases of <italic>g</italic>′ for trans-eQTL association with <italic>g</italic> [<xref rid="pcbi.1008223.ref087" ref-type="bibr">87</xref>]. Specifically, we computed the p-value for linear association of each variant with the corresponding effect gene <italic>g</italic> using MatrixEQTL [<xref rid="pcbi.1008223.ref088" ref-type="bibr">88</xref>]. A null distribution was generated by taking every edge <italic>g</italic>′ → <italic>g</italic>, permuting the effect gene <italic>g</italic>’s expression values, and repeating the linear association test. FDR over test statistics was calculated using q-value [<xref rid="pcbi.1008223.ref089" ref-type="bibr">89</xref>]. Because not every causal gene <italic>g</italic>′ had a cis-eQTL, only 26,839 edges (84% of the original 31,945 edges) were tested.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="sec033">
    <title>5 Supporting information</title>
    <supplementary-material content-type="local-data" id="pcbi.1008223.s001">
      <label>S1 Fig</label>
      <caption>
        <title>Overview of gene regulatory network inference methods.</title>
        <p>Panels show each inference method applied to a cause gene <italic>g’</italic> (blue, solid) and an effect gene <italic>g</italic> (blue, dotted). A) Mutual information is computed between the cause and effect. B) The effect’s expression is fit as an autoregression from the cause’s past expression. C) The effect’s expression is fit as a differential equation from the cause’s current expression. D) The effect’s expression is fit as a decision tree function of the cause’s past expression. E) The space of dynamic causal networks is searched, with linear relationships between cause and effect. F) The space of dynamic causal networks is searched, with nonlinear relationships between cause and effect.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1008223.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008223.s002">
      <label>S2 Fig</label>
      <caption>
        <title>Causal gene expression and effect gene residuals from experimentally validated interactions.</title>
        <p>On the y-axes are the effect gene residual expression values after subtracting the effects of all other covariates. Axes are in units of ln(TPM). Related to <xref ref-type="fig" rid="pcbi.1008223.g005">Fig 5</xref> and <xref ref-type="supplementary-material" rid="pcbi.1008223.s009">S7 Table</xref>.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1008223.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008223.s003">
      <label>S1 Table</label>
      <caption>
        <title>DREAM4 100-gene network inference results, AUPR.</title>
        <p>DBN is dynamic Bayesian network, DT is decision tree, GP is Gaussian process, MI is mutual information, ODE is ordinary differential equation, VAR is vector autoregression. The references that reported ebdbnet, ScanBMA, and LASSO did not provide AUPR values for individual networks. Algorithms that were run in-house were ARACNE, BETS, CLR, CSId, Enet, Jump3, MRNET, SWING-Lasso, and SWING-RF. Where reported literature values were available, they were consistent with these values. Values for CSIc, G1DBN, GCCA, GP4GRN, TSNI, VBSSMa and VBSSMb were taken from [<xref rid="pcbi.1008223.ref049" ref-type="bibr">49</xref>]. Values for ebdnet, LASSO and ScanBMA, were taken from [<xref rid="pcbi.1008223.ref040" ref-type="bibr">40</xref>]. Values for dynGENIE3, GENIE3, OKVAR-Boost and tl-CLR were taken from [<xref rid="pcbi.1008223.ref037" ref-type="bibr">37</xref>]. Values for Inferelator and Jump3 were taken from [<xref rid="pcbi.1008223.ref036" ref-type="bibr">36</xref>]. Related to <xref ref-type="fig" rid="pcbi.1008223.g002">Fig 2</xref>.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pcbi.1008223.s003.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008223.s004">
      <label>S2 Table</label>
      <caption>
        <title>DREAM4 100-gene network inference results, AUROC.</title>
        <p>DBN is dynamic Bayesian network, DT is decision tree, GP is Gaussian process, MI is mutual information, ODE is ordinary differential equation, VAR is vector autoregression. The references that reported ebdbnet, ScanBMA, and LASSO did not provide AUROC values for individual networks. Algorithms that were run in-house were ARACNE, BETS, CLR, CSId, Enet, Jump3, MRNET, SWING-Lasso, and SWING-RF. Values for CSIc, G1DBN, GCCA, GP4GRN, TSNI, VBSSMa and VBSSMb were taken from [<xref rid="pcbi.1008223.ref049" ref-type="bibr">49</xref>]. Values for ebdnet, LASSO, and ScanBMA, were taken from [<xref rid="pcbi.1008223.ref040" ref-type="bibr">40</xref>]. Related to <xref ref-type="fig" rid="pcbi.1008223.g002">Fig 2</xref>.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pcbi.1008223.s004.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008223.s005">
      <label>S3 Table</label>
      <caption>
        <title>Results of in-house algorithms on DREAM4 100-gene network inference.</title>
        <p>AUPR, AUROC, and Time indicate average AUPR, AUROC, and time over the five networks, respectively. BETS and Enet are in bold to indicate that they are our own developed methods, based on vector autoregression. SWING-RF [<xref rid="pcbi.1008223.ref051" ref-type="bibr">51</xref>] and Jump3 [<xref rid="pcbi.1008223.ref036" ref-type="bibr">36</xref>] are decision tree methods. CSId is a Gaussian process method [<xref rid="pcbi.1008223.ref044" ref-type="bibr">44</xref>]. CLR [<xref rid="pcbi.1008223.ref027" ref-type="bibr">27</xref>], MRNET [<xref rid="pcbi.1008223.ref090" ref-type="bibr">90</xref>], and ARACNE [<xref rid="pcbi.1008223.ref029" ref-type="bibr">29</xref>] are mutual information methods. SWING-Lasso is a vector autoregression method [<xref rid="pcbi.1008223.ref051" ref-type="bibr">51</xref>]. Related to <xref ref-type="fig" rid="pcbi.1008223.g002">Fig 2</xref>.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pcbi.1008223.s005.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008223.s006">
      <label>S4 Table</label>
      <caption>
        <title>Improvement on DREAM4 100-gene network inference from bootstrap.</title>
        <p>For each AUROC or AUPR column, the average is the listed value and the standard deviation is listed in parentheses. “Coefficient” denotes the result when ranking edges by their fitted coefficient, as in the original method. “Bootstrap” denotes the results when ranking edges by the frequency by which they appear in the bootstrap networks.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pcbi.1008223.s006.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008223.s007">
      <label>S5 Table</label>
      <caption>
        <title>Dependency of BETS performance on bootstrap samples.</title>
        <p>DREAM results reported for running BETS on both 100 and 1000 bootstrap samples. All values in the columns are averages and the parenthetical values as standard deviations across the 5 DREAM4 Networks. The 1000 samples row is bolded because 1000 samples are the default settings. These use zero-mean normalization, lag 2, and the elastic net penalty. Related to <xref ref-type="fig" rid="pcbi.1008223.g002">Fig 2</xref>.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pcbi.1008223.s007.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008223.s008">
      <label>S6 Table</label>
      <caption>
        <title>Enrichment of edges between specific gene classes in inferred causal network.</title>
        <p>A Fisher’s Exact Test was performed, where the rows of the contingency table were whether or not an edge was of the edge type, and the columns were whether or not the edge was part of the inferred network. Related to <xref ref-type="fig" rid="pcbi.1008223.g003">Fig 3</xref>.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pcbi.1008223.s008.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008223.s009">
      <label>S7 Table</label>
      <caption>
        <title>Gene pair information from <xref ref-type="fig" rid="pcbi.1008223.g005">Fig 5</xref>.</title>
        <p>Shown Data Set indicates whether the gene temporal profiles in <xref ref-type="fig" rid="pcbi.1008223.g005">Fig 5</xref> are taken from the <italic>original exposure data</italic> or <italic>unperturbed data</italic>. The edge type indicates the gene class of the causal and effect gene; for example, I → M indicates an edge from an Immune causal gene to a Metabolic effect gene. I = Immune; M = Metabolic; T = Transcription Factor; A = Any gene. Related to <xref ref-type="fig" rid="pcbi.1008223.g005">Fig 5</xref>.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pcbi.1008223.s009.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008223.s010">
      <label>S1 Text</label>
      <caption>
        <title>Supplemental information.</title>
        <p>Additional overview and analyses.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pcbi.1008223.s010.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>The authors would like to thank Gregory Darnell, Derek Aguiar, Ariel Gewirtz, Allison Chaney, Isabella Grabski, Cristina Anastase, and Genna Gliner for helpful discussion, feedback, and generosity in running cluster jobs; and Jian Peng for productive discussion and helpful comments.</p>
    <p>The authors gratefully acknowledge that this work was performed using the Princeton Research Computing resources sponsored by the Princeton Institute for Computational Science and Engineering (PICSciE) at Princeton University.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1008223.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Bar-Joseph</surname><given-names>Z</given-names></name>, <name><surname>Gitter</surname><given-names>A</given-names></name>, <name><surname>Simon</surname><given-names>I</given-names></name>. <article-title>Studying and modelling dynamic biological processes using time-series gene expression data</article-title>. <source>Nature Reviews Genetics</source>. <year>2012</year>;<volume>13</volume>(<issue>8</issue>):<fpage>552</fpage>–<lpage>564</lpage>. <pub-id pub-id-type="doi">10.1038/nrg3244</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Bernardo</surname><given-names>J</given-names></name>, <name><surname>Bayarri</surname><given-names>M</given-names></name>, <name><surname>Berger</surname><given-names>J</given-names></name>, <name><surname>Dawid</surname><given-names>A</given-names></name>, <name><surname>Heckerman</surname><given-names>D</given-names></name>, <name><surname>Smith</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>Bayesian factor regression models in the “large p, small n” paradigm</article-title>. <source>Bayesian Statistics</source>. <year>2003</year>;<volume>7</volume>:<fpage>733</fpage>–<lpage>742</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Bühlmann</surname><given-names>P</given-names></name>, <name><surname>Kalisch</surname><given-names>M</given-names></name>, <name><surname>Meier</surname><given-names>L</given-names></name>. <article-title>High-dimensional statistics with a view toward applications in biology</article-title>. <source>Annual Review of Statistics and Its Application</source>. <year>2014</year>;<volume>1</volume>:<fpage>255</fpage>–<lpage>278</lpage>. <pub-id pub-id-type="doi">10.1146/annurev-statistics-022513-115545</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Mas</surname><given-names>P</given-names></name>. <article-title>Circadian clock function in Arabidopsis thaliana: time beyond transcription</article-title>. <source>Trends in cell biology</source>. <year>2008</year>;<volume>18</volume>(<issue>6</issue>):<fpage>273</fpage>–<lpage>281</lpage>. <pub-id pub-id-type="doi">10.1016/j.tcb.2008.03.005</pub-id><pub-id pub-id-type="pmid">18468438</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Robinson</surname><given-names>JW</given-names></name>, <name><surname>Hartemink</surname><given-names>AJ</given-names></name>. <article-title>Learning non-stationary dynamic Bayesian networks</article-title>. <source>Journal of Machine Learning Research</source>. <year>2010</year>;<volume>11</volume>(<issue>Dec</issue>):<fpage>3647</fpage>–<lpage>3680</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>McDowell</surname><given-names>IC</given-names></name>, <name><surname>Barrera</surname><given-names>A</given-names></name>, <name><surname>D’Ippolito</surname><given-names>AM</given-names></name>, <name><surname>Vockley</surname><given-names>CM</given-names></name>, <name><surname>Hong</surname><given-names>LK</given-names></name>, <name><surname>Leichter</surname><given-names>SM</given-names></name>, <etal>et al</etal><article-title>Glucocorticoid receptor recruits to enhancers and drives activation by motif-directed binding</article-title>. <source>Genome Research</source>. <year>2018</year>;<volume>28</volume>(<issue>9</issue>):<fpage>1272</fpage>–<lpage>1284</lpage>. <pub-id pub-id-type="doi">10.1101/gr.233346.117</pub-id><?supplied-pmid 30097539?><pub-id pub-id-type="pmid">30097539</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Cain</surname><given-names>DW</given-names></name>, <name><surname>Cidlowski</surname><given-names>JA</given-names></name>. <article-title>Immune regulation by glucocorticoids</article-title>. <source>Nature Reviews Immunology</source>. <year>2017</year>;. <pub-id pub-id-type="doi">10.1038/nri.2017.1</pub-id><?supplied-pmid 28192415?><pub-id pub-id-type="pmid">28192415</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref008">
      <label>8</label>
      <mixed-citation publication-type="other">UK Government. World first coronavirus treatment approved for NHS use by government; 2020. <ext-link ext-link-type="uri" xlink:href="https://www.gov.uk/government/news/world-first-coronavirus-treatment-approved-for-nhs-use-by-government">https://www.gov.uk/government/news/world-first-coronavirus-treatment-approved-for-nhs-use-by-government</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref009">
      <label>9</label>
      <mixed-citation publication-type="other">National Institutes of Health. COVID-19 Treatment Guidelines: Corticosteroids; 2020. <ext-link ext-link-type="uri" xlink:href="https://www.covid19treatmentguidelines.nih.gov/immune-based-therapy/immunomodulators/corticosteroids/">https://www.covid19treatmentguidelines.nih.gov/immune-based-therapy/immunomodulators/corticosteroids/</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref010">
      <label>10</label>
      <mixed-citation publication-type="other">World Health Organization. Corticosteroids for COVID-19; 2020. <ext-link ext-link-type="uri" xlink:href="https://www.who.int/publications/i/item/WHO-2019-nCoV-Corticosteroids-2020.1">https://www.who.int/publications/i/item/WHO-2019-nCoV-Corticosteroids-2020.1</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref011">
      <label>11</label>
      <mixed-citation publication-type="other">Infectious Diseases Society of America. Infectious Diseases Society of America Guidelines on the Treatment and Management of Patients with COVID-19; 2020. <ext-link ext-link-type="uri" xlink:href="https://www.idsociety.org/practice-guideline/covid-19-guideline-treatment-and-management">https://www.idsociety.org/practice-guideline/covid-19-guideline-treatment-and-management</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Geer</surname><given-names>EB</given-names></name>, <name><surname>Islam</surname><given-names>J</given-names></name>, <name><surname>Buettner</surname><given-names>C</given-names></name>. <article-title>Mechanisms of glucocorticoid-induced insulin resistance: focus on adipose tissue function and lipid metabolism</article-title>. <source>Endocrinology and Metabolism Clinics of North America</source>. <year>2014</year>;<volume>43</volume>(<issue>1</issue>):<fpage>75</fpage>–<lpage>102</lpage>. <pub-id pub-id-type="doi">10.1016/j.ecl.2013.10.005</pub-id><pub-id pub-id-type="pmid">24582093</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Spencer</surname><given-names>SJ</given-names></name>, <name><surname>Tilbrook</surname><given-names>A</given-names></name>. <article-title>The glucocorticoid contribution to obesity</article-title>. <source>Stress</source>. <year>2011</year>;<volume>14</volume>(<issue>3</issue>):<fpage>233</fpage>–<lpage>246</lpage>. <pub-id pub-id-type="doi">10.3109/10253890.2010.534831</pub-id><pub-id pub-id-type="pmid">21294656</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><collab>GTEx Consortium</collab>, <etal>et al</etal><article-title>Genetic effects on gene expression across human tissues</article-title>. <source>Nature</source>. <year>2017</year>;<volume>550</volume>(<issue>7675</issue>):<fpage>204</fpage><pub-id pub-id-type="doi">10.1038/nature24277</pub-id><?supplied-pmid 29022597?><pub-id pub-id-type="pmid">29022597</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>ZP</given-names></name>. <article-title>Reverse Engineering of Genome-wide Gene Regulatory Networks from Gene Expression Data</article-title>. <source>Current Genomics</source>. <year>2015</year>;<volume>16</volume>(<issue>1</issue>):<fpage>3</fpage>–<lpage>22</lpage>. <pub-id pub-id-type="doi">10.2174/1389202915666141110210634</pub-id><pub-id pub-id-type="pmid">25937810</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Opgen-Rhein</surname><given-names>R</given-names></name>, <name><surname>Strimmer</surname><given-names>K</given-names></name>. <article-title>Learning causal networks from systems biology time course data: an effective model selection procedure for the vector autoregressive process</article-title>. <source>BMC Bioinformatics</source>. <year>2007</year>;<volume>8</volume>(<issue>2</issue>):<fpage>1</fpage>.<pub-id pub-id-type="pmid">17199892</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Lozano</surname><given-names>AC</given-names></name>, <name><surname>Abe</surname><given-names>N</given-names></name>, <name><surname>Liu</surname><given-names>Y</given-names></name>, <name><surname>Rosset</surname><given-names>S</given-names></name>. <article-title>Grouped graphical Granger modeling for gene expression regulatory networks discovery</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>(<issue>12</issue>):<fpage>i110</fpage>–<lpage>i118</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp199</pub-id><pub-id pub-id-type="pmid">19477976</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Cho</surname><given-names>H</given-names></name>, <name><surname>Berger</surname><given-names>B</given-names></name>, <name><surname>Peng</surname><given-names>J</given-names></name>. <article-title>Reconstructing Causal Biological Networks through Active Learning</article-title>. <source>PLOS One</source>. <year>2016</year>;<volume>11</volume>(<issue>3</issue>):<fpage>e0150611</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0150611</pub-id><pub-id pub-id-type="pmid">26930205</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Maathuis</surname><given-names>MH</given-names></name>, <name><surname>Kalisch</surname><given-names>M</given-names></name>, <name><surname>Bühlmann</surname><given-names>P</given-names></name>, <etal>et al</etal><article-title>Estimating high-dimensional intervention effects from observational data</article-title>. <source>The Annals of Statistics</source>. <year>2009</year>;<volume>37</volume>(<issue>6A</issue>):<fpage>3133</fpage>–<lpage>3164</lpage>. <pub-id pub-id-type="doi">10.1214/09-AOS685</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref020">
      <label>20</label>
      <mixed-citation publication-type="book"><name><surname>Murphy</surname><given-names>KP</given-names></name>. <source>Active Learning of Causal Bayes Net Structure</source>. <publisher-name>University of California</publisher-name>, <publisher-loc>Berkeley</publisher-loc>; <year>2001</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Rau</surname><given-names>A</given-names></name>, <name><surname>Jaffrézic</surname><given-names>F</given-names></name>, <name><surname>Nuel</surname><given-names>G</given-names></name>. <article-title>Joint estimation of causal effects from observational and intervention gene expression data</article-title>. <source>BMC Systems Biology</source>. <year>2013</year>;<volume>7</volume>(<issue>1</issue>):<fpage>1</fpage>.<pub-id pub-id-type="pmid">23280066</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Hauser</surname><given-names>A</given-names></name>, <name><surname>Bühlmann</surname><given-names>P</given-names></name>. <article-title>Two optimal strategies for active learning of causal models from interventional data</article-title>. <source>International Journal of Approximate Reasoning</source>. <year>2014</year>;<volume>55</volume>(<issue>4</issue>):<fpage>926</fpage>–<lpage>939</lpage>. <pub-id pub-id-type="doi">10.1016/j.ijar.2013.11.007</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>He</surname><given-names>YB</given-names></name>, <name><surname>Geng</surname><given-names>Z</given-names></name>. <article-title>Active learning of causal networks with intervention experiments and optimal designs</article-title>. <source>Journal of Machine Learning Research</source>. <year>2008</year>;<volume>9</volume>(<issue>Nov</issue>):<fpage>2523</fpage>–<lpage>2547</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Grzegorczyk</surname><given-names>M</given-names></name>. <article-title>An introduction to Gaussian Bayesian networks</article-title>. <source>Systems Biology in Drug Discovery and Development: Methods and Protocols</source>. <year>2010</year>; p. <fpage>121</fpage>–<lpage>147</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Madar</surname><given-names>A</given-names></name>, <name><surname>Greenfield</surname><given-names>A</given-names></name>, <name><surname>Vanden-Eijnden</surname><given-names>E</given-names></name>, <name><surname>Bonneau</surname><given-names>R</given-names></name>. <article-title>DREAM3: network inference using dynamic context likelihood of relatedness and the inferelator</article-title>. <source>PLOS One</source>. <year>2010</year>;<volume>5</volume>(<issue>3</issue>):<fpage>e9803</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0009803</pub-id><pub-id pub-id-type="pmid">20339551</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Lopes</surname><given-names>M</given-names></name>, <name><surname>Bontempi</surname><given-names>G</given-names></name>. <article-title>Experimental assessment of static and dynamic algorithms for gene regulation inference from time series expression data</article-title>. <source>Frontiers in Genetics</source>. <year>2013</year>;<volume>4</volume>:<fpage>303</fpage>.<pub-id pub-id-type="pmid">24400020</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Faith</surname><given-names>JJ</given-names></name>, <name><surname>Hayete</surname><given-names>B</given-names></name>, <name><surname>Thaden</surname><given-names>JT</given-names></name>, <name><surname>Mogno</surname><given-names>I</given-names></name>, <name><surname>Wierzbowski</surname><given-names>J</given-names></name>, <name><surname>Cottarel</surname><given-names>G</given-names></name>, <etal>et al</etal><article-title>Large-scale mapping and validation of Escherichia coli transcriptional regulation from a compendium of expression profiles</article-title>. <source>PLOS Biology</source>. <year>2007</year>;<volume>5</volume>(<issue>1</issue>):<fpage>e8</fpage><pub-id pub-id-type="doi">10.1371/journal.pbio.0050008</pub-id><?supplied-pmid 17214507?><pub-id pub-id-type="pmid">17214507</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Meyer</surname><given-names>PE</given-names></name>, <name><surname>Kontos</surname><given-names>K</given-names></name>, <name><surname>Lafitte</surname><given-names>F</given-names></name>, <name><surname>Bontempi</surname><given-names>G</given-names></name>. <article-title>Information-theoretic inference of large transcriptional regulatory networks</article-title>. <source>EURASIP Journal on Bioinformatics and Systems Biology</source>. <year>2007</year>;<volume>2007</volume>:<fpage>8</fpage>–<lpage>8</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Margolin</surname><given-names>AA</given-names></name>, <name><surname>Nemenman</surname><given-names>I</given-names></name>, <name><surname>Basso</surname><given-names>K</given-names></name>, <name><surname>Wiggins</surname><given-names>C</given-names></name>, <name><surname>Stolovitzky</surname><given-names>G</given-names></name>, <name><surname>Dalla Favera</surname><given-names>R</given-names></name>, <etal>et al</etal><article-title>ARACNE: an algorithm for the reconstruction of gene regulatory networks in a mammalian cellular context</article-title>. In: <source>BMC Bioinformatics</source>. vol. <volume>7</volume> BioMed Central; <year>2006</year> p. <fpage>S7</fpage>
<pub-id pub-id-type="doi">10.1186/1471-2105-7-S1-S7</pub-id>
<?supplied-pmid 16723010?><pub-id pub-id-type="pmid">16723010</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Zoppoli</surname><given-names>P</given-names></name>, <name><surname>Morganella</surname><given-names>S</given-names></name>, <name><surname>Ceccarelli</surname><given-names>M</given-names></name>. <article-title>TimeDelay-ARACNE: Reverse engineering of gene networks from time-course data by an information theoretic approach</article-title>. <source>BMC Bioinformatics</source>. <year>2010</year>;<volume>11</volume>(<issue>1</issue>):<fpage>154</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-11-154</pub-id><pub-id pub-id-type="pmid">20338053</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Granger</surname><given-names>CWJ</given-names></name>. <article-title>Testing for causality</article-title>. <source>Journal of Economic Dynamics and Control</source>. <year>1980</year>;<volume>2</volume>:<fpage>329</fpage>–<lpage>352</lpage>. <pub-id pub-id-type="doi">10.1016/0165-1889(80)90069-X</pub-id>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Bansal</surname><given-names>M</given-names></name>, <name><surname>Gatta</surname><given-names>GD</given-names></name>, <name><surname>Di Bernardo</surname><given-names>D</given-names></name>. <article-title>Inference of gene regulatory networks and compound mode of action from time course gene expression profiles</article-title>. <source>Bioinformatics</source>. <year>2006</year>;<volume>22</volume>(<issue>7</issue>):<fpage>815</fpage>–<lpage>822</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btl003</pub-id><pub-id pub-id-type="pmid">16418235</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Bonneau</surname><given-names>R</given-names></name>, <name><surname>Reiss</surname><given-names>DJ</given-names></name>, <name><surname>Shannon</surname><given-names>P</given-names></name>, <name><surname>Facciotti</surname><given-names>M</given-names></name>, <name><surname>Hood</surname><given-names>L</given-names></name>, <name><surname>Baliga</surname><given-names>NS</given-names></name>, <etal>et al</etal><article-title>The Inferelator: an algorithm for learning parsimonious regulatory networks from systems-biology data sets de novo</article-title>. <source>Genome Biology</source>. <year>2006</year>;<volume>7</volume>(<issue>5</issue>):<fpage>R36</fpage><pub-id pub-id-type="doi">10.1186/gb-2006-7-5-r36</pub-id><?supplied-pmid 16686963?><pub-id pub-id-type="pmid">16686963</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Quinlan</surname><given-names>JR</given-names></name>. <article-title>Induction of decision trees</article-title>. <source>Machine Learning</source>. <year>1986</year>;<volume>1</volume>(<issue>1</issue>):<fpage>81</fpage>–<lpage>106</lpage>. <pub-id pub-id-type="doi">10.1007/BF00116251</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref035">
      <label>35</label>
      <mixed-citation publication-type="book"><name><surname>Breiman</surname><given-names>L</given-names></name>. <source>Classification and regression trees</source>. <publisher-name>Routledge</publisher-name>; <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Huynh-Thu</surname><given-names>VA</given-names></name>, <name><surname>Sanguinetti</surname><given-names>G</given-names></name>. <article-title>Combining tree-based and dynamical systems for the inference of gene regulatory networks</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>(<issue>10</issue>):<fpage>1614</fpage>–<lpage>1622</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btu863</pub-id><pub-id pub-id-type="pmid">25573916</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Geurts</surname><given-names>P</given-names></name>, <etal>et al</etal><article-title>dynGENIE3: dynamical GENIE3 for the inference of gene networks from time series expression data</article-title>. <source>Scientific Reports</source>. <year>2018</year>;<volume>8</volume>(<issue>1</issue>):<fpage>3384</fpage><pub-id pub-id-type="doi">10.1038/s41598-018-21715-0</pub-id><?supplied-pmid 29467401?><pub-id pub-id-type="pmid">29467401</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Lèbre</surname><given-names>S</given-names></name>. <article-title>Inferring dynamic genetic networks with low order independencies</article-title>. <source>Statistical Applications in Genetics and Molecular Biology</source>. <year>2009</year>;<volume>8</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>38</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Hartemink</surname><given-names>AJ</given-names></name>, <name><surname>Gifford</surname><given-names>DK</given-names></name>, <name><surname>Jaakkola</surname><given-names>TS</given-names></name>, <name><surname>Young</surname><given-names>RA</given-names></name>, <etal>et al</etal><article-title>Using graphical models and genomic expression data to statistically validate models of genetic regulatory networks</article-title>. In: <source>Pacific Symposium on Biocomputing</source>. vol. <volume>6</volume>; <year>2001</year> p. <fpage>266</fpage>
<?supplied-pmid 11262961?><pub-id pub-id-type="pmid">11262961</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Young</surname><given-names>WC</given-names></name>, <name><surname>Raftery</surname><given-names>AE</given-names></name>, <name><surname>Yeung</surname><given-names>KY</given-names></name>. <article-title>Fast Bayesian inference for gene regulatory networks using ScanBMA</article-title>. <source>BMC Systems Biology</source>. <year>2014</year>;<volume>8</volume>(<issue>1</issue>):<fpage>47</fpage><pub-id pub-id-type="doi">10.1186/1752-0509-8-47</pub-id><pub-id pub-id-type="pmid">24742092</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Beal</surname><given-names>MJ</given-names></name>, <name><surname>Falciani</surname><given-names>F</given-names></name>, <name><surname>Ghahramani</surname><given-names>Z</given-names></name>, <name><surname>Rangel</surname><given-names>C</given-names></name>, <name><surname>Wild</surname><given-names>DL</given-names></name>. <article-title>A Bayesian approach to reconstructing genetic regulatory networks with hidden factors</article-title>. <source>Bioinformatics</source>. <year>2004</year>;<volume>21</volume>(<issue>3</issue>):<fpage>349</fpage>–<lpage>356</lpage>.<pub-id pub-id-type="pmid">15353451</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Rau</surname><given-names>A</given-names></name>, <name><surname>Jaffrézic</surname><given-names>F</given-names></name>, <name><surname>Foulley</surname><given-names>JL</given-names></name>, <name><surname>Doerge</surname><given-names>RW</given-names></name>. <article-title>An empirical Bayesian method for estimating biological networks from temporal microarray data</article-title>. <source>Statistical Applications in Genetics and Molecular Biology</source>. <year>2010</year>;<volume>9</volume>(<issue>1</issue>). <pub-id pub-id-type="doi">10.2202/1544-6115.1513</pub-id><?supplied-pmid 20196759?><pub-id pub-id-type="pmid">20196759</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Äijö</surname><given-names>T</given-names></name>, <name><surname>Lähdesmäki</surname><given-names>H</given-names></name>. <article-title>Learning gene regulatory networks from gene expression measurements using non-parametric molecular kinetics</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>(<issue>22</issue>):<fpage>2937</fpage>–<lpage>2944</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp511</pub-id><pub-id pub-id-type="pmid">19706742</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Penfold</surname><given-names>CA</given-names></name>, <name><surname>Shifaz</surname><given-names>A</given-names></name>, <name><surname>Brown</surname><given-names>PE</given-names></name>, <name><surname>Nicholson</surname><given-names>A</given-names></name>, <name><surname>Wild</surname><given-names>DL</given-names></name>. <article-title>CSI: a nonparametric Bayesian approach to network inference from multiple perturbed time series gene expression data</article-title>. <source>Statistical Applications in Genetics and Molecular Biology</source>. <year>2015</year>;<volume>14</volume>(<issue>3</issue>):<fpage>307</fpage>–<lpage>310</lpage>.<pub-id pub-id-type="pmid">26030796</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Marbach</surname><given-names>D</given-names></name>, <name><surname>Schaffter</surname><given-names>T</given-names></name>, <name><surname>Mattiussi</surname><given-names>C</given-names></name>, <name><surname>Floreano</surname><given-names>D</given-names></name>. <article-title>Generating realistic in silico gene networks for performance assessment of reverse engineering methods</article-title>. <source>Journal of Computational Biology</source>. <year>2009</year>;<volume>16</volume>(<issue>2</issue>):<fpage>229</fpage>–<lpage>239</lpage>. <pub-id pub-id-type="doi">10.1089/cmb.2008.09TT</pub-id><pub-id pub-id-type="pmid">19183003</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Friedman</surname><given-names>J</given-names></name>, <name><surname>Hastie</surname><given-names>T</given-names></name>, <name><surname>Tibshirani</surname><given-names>R</given-names></name>. <article-title>Sparse inverse covariance estimation with the graphical lasso</article-title>. <source>Biostatistics</source>. <year>2008</year>;<volume>9</volume>(<issue>3</issue>):<fpage>432</fpage>–<lpage>441</lpage>. <pub-id pub-id-type="doi">10.1093/biostatistics/kxm045</pub-id><pub-id pub-id-type="pmid">18079126</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Zou</surname><given-names>H</given-names></name>, <name><surname>Hastie</surname><given-names>T</given-names></name>. <article-title>Regularization and variable selection via the elastic net</article-title>. <source>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</source>. <year>2005</year>;<volume>67</volume>(<issue>2</issue>):<fpage>301</fpage>–<lpage>320</lpage>. <pub-id pub-id-type="doi">10.1111/j.1467-9868.2005.00503.x</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Tibshirani</surname><given-names>R</given-names></name>. <article-title>Regression shrinkage and selection via the lasso</article-title>. <source>Journal of the Royal Statistical Society Series B (Methodological)</source>. <year>1996</year>; p. <fpage>267</fpage>–<lpage>288</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Penfold</surname><given-names>CA</given-names></name>, <name><surname>Wild</surname><given-names>DL</given-names></name>. <article-title>How to infer gene networks from expression profiles, revisited</article-title>. <source>Interface Focus</source>. <year>2011</year>;<volume>1</volume>(<issue>6</issue>):<fpage>857</fpage>–<lpage>870</lpage>. <pub-id pub-id-type="doi">10.1098/rsfs.2011.0053</pub-id><pub-id pub-id-type="pmid">23226586</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref050">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Irrthum</surname><given-names>A</given-names></name>, <name><surname>Wehenkel</surname><given-names>L</given-names></name>, <name><surname>Geurts</surname><given-names>P</given-names></name>, <etal>et al</etal><article-title>Inferring regulatory networks from expression data using tree-based methods</article-title>. <source>PLOS ONE</source>. <year>2010</year>;<volume>5</volume>(<issue>9</issue>):<fpage>e12776</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0012776</pub-id><?supplied-pmid 20927193?><pub-id pub-id-type="pmid">20927193</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref051">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Finkle</surname><given-names>JD</given-names></name>, <name><surname>Wu</surname><given-names>JJ</given-names></name>, <name><surname>Bagheri</surname><given-names>N</given-names></name>. <article-title>Windowed Granger causal inference strategy improves discovery of gene regulatory networks</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2018</year>;<volume>115</volume>(<issue>9</issue>):<fpage>2252</fpage>–<lpage>2257</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1710936115</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Ashburner</surname><given-names>M</given-names></name>, <name><surname>Ball</surname><given-names>CA</given-names></name>, <name><surname>Blake</surname><given-names>JA</given-names></name>, <name><surname>Botstein</surname><given-names>D</given-names></name>, <name><surname>Butler</surname><given-names>H</given-names></name>, <name><surname>Cherry</surname><given-names>JM</given-names></name>, <etal>et al</etal><article-title>Gene Ontology: tool for the unification of biology</article-title>. <source>Nature Genetics</source>. <year>2000</year>;<volume>25</volume>(<issue>1</issue>):<fpage>25</fpage>–<lpage>29</lpage>. <pub-id pub-id-type="doi">10.1038/75556</pub-id><?supplied-pmid 10802651?><pub-id pub-id-type="pmid">10802651</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref053">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Subramanian</surname><given-names>A</given-names></name>, <name><surname>Tamayo</surname><given-names>P</given-names></name>, <name><surname>Mootha</surname><given-names>VK</given-names></name>, <name><surname>Mukherjee</surname><given-names>S</given-names></name>, <name><surname>Ebert</surname><given-names>BL</given-names></name>, <name><surname>Gillette</surname><given-names>MA</given-names></name>, <etal>et al</etal><article-title>Gene set enrichment analysis: A knowledge-based approach for interpreting genome-wide expression profiles</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2005</year>;<volume>102</volume>(<issue>43</issue>):<fpage>15545</fpage>–<lpage>15550</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.0506580102</pub-id><?supplied-pmid 16199517?><pub-id pub-id-type="pmid">16199517</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref054">
      <label>54</label>
      <mixed-citation publication-type="journal"><collab>Consortium TGO</collab>. <source>Gene Ontology Consoritum’s Curated List of Immune Genes</source>; <year>2014</year><ext-link ext-link-type="uri" xlink:href="http://wiki.geneontology.org/index.php/Immunology">http://wiki.geneontology.org/index.php/Immunology</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref055">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>HM</given-names></name>, <name><surname>Chen</surname><given-names>H</given-names></name>, <name><surname>Liu</surname><given-names>W</given-names></name>, <name><surname>Liu</surname><given-names>H</given-names></name>, <name><surname>Gong</surname><given-names>J</given-names></name>, <name><surname>Wang</surname><given-names>H</given-names></name>, <etal>et al</etal><article-title>AnimalTFDB: a comprehensive animal transcription factor database</article-title>. <source>Nucleic Acids Research</source>. <year>2012</year>;<volume>40</volume>(<issue>Database issue</issue>):<fpage>D144</fpage>–<lpage>D149</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkr965</pub-id><?supplied-pmid 22080564?><pub-id pub-id-type="pmid">22080564</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref056">
      <label>56</label>
      <mixed-citation publication-type="journal"><name><surname>Chatr-Aryamontri</surname><given-names>A</given-names></name>, <name><surname>Oughtred</surname><given-names>R</given-names></name>, <name><surname>Boucher</surname><given-names>L</given-names></name>, <name><surname>Rust</surname><given-names>J</given-names></name>, <name><surname>Chang</surname><given-names>C</given-names></name>, <name><surname>Kolas</surname><given-names>NK</given-names></name>, <etal>et al</etal><article-title>The BioGRID interaction database: 2017 update</article-title>. <source>Nucleic Acids Research</source>. <year>2017</year>;<volume>45</volume>(<issue>D1</issue>):<fpage>D369</fpage>–<lpage>D379</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkw1102</pub-id><?supplied-pmid 27980099?><pub-id pub-id-type="pmid">27980099</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref057">
      <label>57</label>
      <mixed-citation publication-type="journal"><name><surname>Rui</surname><given-names>L</given-names></name>, <name><surname>Yuan</surname><given-names>M</given-names></name>, <name><surname>Frantz</surname><given-names>D</given-names></name>, <name><surname>Shoelson</surname><given-names>S</given-names></name>, <name><surname>White</surname><given-names>MF</given-names></name>. <article-title>SOCS-1 and SOCS-3 block insulin signaling by ubiquitin-mediated degradation of IRS1 and IRS2</article-title>. <source>Journal of Biological Chemistry</source>. <year>2002</year>;<volume>277</volume>(<issue>44</issue>):<fpage>42394</fpage>–<lpage>42398</lpage>. <pub-id pub-id-type="doi">10.1074/jbc.C200444200</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref058">
      <label>58</label>
      <mixed-citation publication-type="journal"><name><surname>Calegari</surname><given-names>VC</given-names></name>, <name><surname>Alves</surname><given-names>M</given-names></name>, <name><surname>Picardi</surname><given-names>PK</given-names></name>, <name><surname>Inoue</surname><given-names>RY</given-names></name>, <name><surname>Franchini</surname><given-names>KG</given-names></name>, <name><surname>Saad</surname><given-names>MJ</given-names></name>, <etal>et al</etal><article-title>Suppressor of cytokine signaling-3 provides a novel interface in the cross-talk between angiotensin II and insulin signaling systems</article-title>. <source>Endocrinology</source>. <year>2005</year>;<volume>146</volume>(<issue>2</issue>):<fpage>579</fpage>–<lpage>588</lpage>. <pub-id pub-id-type="doi">10.1210/en.2004-0466</pub-id><?supplied-pmid 15514089?><pub-id pub-id-type="pmid">15514089</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref059">
      <label>59</label>
      <mixed-citation publication-type="journal"><name><surname>McCormick</surname><given-names>SM</given-names></name>, <name><surname>Gowda</surname><given-names>N</given-names></name>, <name><surname>Fang</surname><given-names>JX</given-names></name>, <name><surname>Heller</surname><given-names>NM</given-names></name>. <article-title>Suppressor of cytokine signaling (SOCS) 1 regulates IL-4-activated insulin receptor substrate (IRS)-2 tyrosine phosphorylation in monocytes and macrophages via the proteasome</article-title>. <source>Journal of Biological Chemistry</source>. <year>2016</year>; p. <fpage>jbc</fpage>–<lpage>M116</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref060">
      <label>60</label>
      <mixed-citation publication-type="journal"><name><surname>Perlmann</surname><given-names>T</given-names></name>, <name><surname>Jansson</surname><given-names>L</given-names></name>. <article-title>A novel pathway for vitamin A signaling mediated by RXR heterodimerization with NGFI-B and NURR1</article-title>. <source>Genes &amp; Development</source>. <year>1995</year>;<volume>9</volume>(<issue>7</issue>):<fpage>769</fpage>–<lpage>782</lpage>. <pub-id pub-id-type="doi">10.1101/gad.9.7.769</pub-id><pub-id pub-id-type="pmid">7705655</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref061">
      <label>61</label>
      <mixed-citation publication-type="journal"><name><surname>Zhao</surname><given-names>Wx</given-names></name>, <name><surname>Tian</surname><given-names>M</given-names></name>, <name><surname>Zhao</surname><given-names>Bx</given-names></name>, <name><surname>Li</surname><given-names>Gd</given-names></name>, <name><surname>Liu</surname><given-names>B</given-names></name>, <name><surname>Zhan</surname><given-names>Yy</given-names></name>, <etal>et al</etal><article-title>Orphan receptor TR3 attenuates the p300-induced acetylation of retinoid X receptor-<italic>α</italic></article-title>. <source>Molecular Endocrinology</source>. <year>2007</year>;<volume>21</volume>(<issue>12</issue>):<fpage>2877</fpage>–<lpage>2889</lpage>. <pub-id pub-id-type="doi">10.1210/me.2007-0107</pub-id><pub-id pub-id-type="pmid">17761950</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref062">
      <label>62</label>
      <mixed-citation publication-type="book"><name><surname>Peters</surname><given-names>J</given-names></name>. <source>Causality: Lecture Notes</source>. <publisher-name>ETH Zurich</publisher-name>: ETH Zurich; <year>2015</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref063">
      <label>63</label>
      <mixed-citation publication-type="journal"><name><surname>Jo</surname><given-names>B</given-names></name>, <name><surname>He</surname><given-names>Y</given-names></name>, <name><surname>Strober</surname><given-names>BJ</given-names></name>, <name><surname>Parsana</surname><given-names>P</given-names></name>, <name><surname>Aguet</surname><given-names>F</given-names></name>, <name><surname>Brown</surname><given-names>AA</given-names></name>, <etal>et al</etal><article-title>Distant regulatory effects of genetic variation in multiple human tissues</article-title>. <source>bioRxiv</source>. <year>2016</year>;.</mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref064">
      <label>64</label>
      <mixed-citation publication-type="journal"><name><surname>Chui</surname><given-names>PC</given-names></name>, <name><surname>Guan</surname><given-names>HP</given-names></name>, <name><surname>Lehrke</surname><given-names>M</given-names></name>, <name><surname>Lazar</surname><given-names>MA</given-names></name>. <article-title>PPAR<italic>γ</italic> regulates adipocyte cholesterol metabolism via oxidized LDL receptor 1</article-title>. <source>The Journal of Clinical Investigation</source>. <year>2005</year>;<volume>115</volume>(<issue>8</issue>):<fpage>2244</fpage>–<lpage>2256</lpage>. <pub-id pub-id-type="doi">10.1172/JCI24130</pub-id><pub-id pub-id-type="pmid">16007265</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref065">
      <label>65</label>
      <mixed-citation publication-type="journal"><name><surname>Arslan</surname><given-names>C</given-names></name>, <name><surname>Bayoglu</surname><given-names>B</given-names></name>, <name><surname>Tel</surname><given-names>C</given-names></name>, <name><surname>Cengiz</surname><given-names>M</given-names></name>, <name><surname>Dirican</surname><given-names>A</given-names></name>, <name><surname>Besirli</surname><given-names>K</given-names></name>. <article-title>Upregulation of OLR1 and IL17A genes and their association with blood glucose and lipid levels in femoropopliteal artery disease</article-title>. <source>Experimental and Therapeutic Medicine</source>. <year>2017</year>;<volume>13</volume>(<issue>3</issue>):<fpage>1160</fpage>–<lpage>1168</lpage>. <pub-id pub-id-type="doi">10.3892/etm.2017.4081</pub-id><pub-id pub-id-type="pmid">28450958</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref066">
      <label>66</label>
      <mixed-citation publication-type="journal"><name><surname>Palmieri</surname><given-names>VO</given-names></name>, <name><surname>Coppola</surname><given-names>B</given-names></name>, <name><surname>Grattagliano</surname><given-names>I</given-names></name>, <name><surname>Casieri</surname><given-names>V</given-names></name>, <name><surname>Cardinale</surname><given-names>G</given-names></name>, <name><surname>Portincasa</surname><given-names>P</given-names></name>, <etal>et al</etal><article-title>Oxidized LDL receptor 1 gene polymorphism in patients with metabolic syndrome</article-title>. <source>European Journal of Clinical Investigation</source>. <year>2013</year>;<volume>43</volume>(<issue>1</issue>):<fpage>41</fpage>–<lpage>48</lpage>. <pub-id pub-id-type="doi">10.1111/eci.12013</pub-id><?supplied-pmid 23134583?><pub-id pub-id-type="pmid">23134583</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref067">
      <label>67</label>
      <mixed-citation publication-type="journal"><name><surname>Oh</surname><given-names>S</given-names></name>, <name><surname>Joo</surname><given-names>H</given-names></name>. <article-title>LOX-1 boosts immunity</article-title>. <source>Oncotarget</source>. <year>2015</year>;<volume>6</volume>(<issue>26</issue>):<fpage>21763</fpage><pub-id pub-id-type="doi">10.18632/oncotarget.4756</pub-id><pub-id pub-id-type="pmid">26312565</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref068">
      <label>68</label>
      <mixed-citation publication-type="journal"><name><surname>Joo</surname><given-names>H</given-names></name>, <name><surname>Li</surname><given-names>D</given-names></name>, <name><surname>Dullaers</surname><given-names>M</given-names></name>, <name><surname>Kim</surname><given-names>TW</given-names></name>, <name><surname>Duluc</surname><given-names>D</given-names></name>, <name><surname>Upchurch</surname><given-names>K</given-names></name>, <etal>et al</etal><article-title>C-type lectin-like receptor LOX-1 promotes dendritic cell-mediated class-switched B cell responses</article-title>. <source>Immunity</source>. <year>2014</year>;<volume>41</volume>(<issue>4</issue>):<fpage>592</fpage>–<lpage>604</lpage>. <pub-id pub-id-type="doi">10.1016/j.immuni.2014.09.009</pub-id><?supplied-pmid 25308333?><pub-id pub-id-type="pmid">25308333</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref069">
      <label>69</label>
      <mixed-citation publication-type="journal"><name><surname>Overstreet</surname><given-names>MG</given-names></name>, <name><surname>Gaylo</surname><given-names>A</given-names></name>, <name><surname>Angermann</surname><given-names>B</given-names></name>, <name><surname>Hughson</surname><given-names>A</given-names></name>, <name><surname>Hyun</surname><given-names>Ym</given-names></name>, <name><surname>Lambert</surname><given-names>K</given-names></name>, <etal>et al</etal><article-title>Inflammation-induced effector CD4+ T cell interstitial migration is alpha-v integrin dependent</article-title>. <source>Nature Immunology</source>. <year>2013</year>;<volume>14</volume>(<issue>9</issue>):<fpage>949</fpage><pub-id pub-id-type="doi">10.1038/ni.2682</pub-id><?supplied-pmid 23933892?><pub-id pub-id-type="pmid">23933892</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref070">
      <label>70</label>
      <mixed-citation publication-type="other">Ling J, Singhal A, Lopez-Dee ZP, Porreca B, Sprague T. Snai2 is a new target to mediate glucocorticoid signaling on breast cancer cell migration. In: Proceedings of the American Association of Cancer Research Annual Meeting, July 2018. vol. 78. AACR; 2018.</mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref071">
      <label>71</label>
      <mixed-citation publication-type="journal"><name><surname>Dubois</surname><given-names>MJ</given-names></name>, <name><surname>Bergeron</surname><given-names>S</given-names></name>, <name><surname>Kim</surname><given-names>HJ</given-names></name>, <name><surname>Dombrowski</surname><given-names>L</given-names></name>, <name><surname>Perreault</surname><given-names>M</given-names></name>, <name><surname>Fournès</surname><given-names>B</given-names></name>, <etal>et al</etal><article-title>The SHP-1 protein tyrosine phosphatase negatively modulates glucose homeostasis</article-title>. <source>Nature Medicine</source>. <year>2006</year>;<volume>12</volume>(<issue>5</issue>):<fpage>549</fpage><pub-id pub-id-type="doi">10.1038/nm1397</pub-id><?supplied-pmid 16617349?><pub-id pub-id-type="pmid">16617349</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref072">
      <label>72</label>
      <mixed-citation publication-type="journal"><name><surname>Eriksen</surname><given-names>KW</given-names></name>, <name><surname>Woetmann</surname><given-names>A</given-names></name>, <name><surname>Skov</surname><given-names>L</given-names></name>, <name><surname>Krejsgaard</surname><given-names>T</given-names></name>, <name><surname>Bovin</surname><given-names>LF</given-names></name>, <name><surname>Hansen</surname><given-names>ML</given-names></name>, <etal>et al</etal><article-title>Deficient SOCS3 and SHP-1 expression in psoriatic T cells</article-title>. <source>Journal of Investigative Dermatology</source>. <year>2010</year>;<volume>130</volume>(<issue>6</issue>):<fpage>1590</fpage>–<lpage>1597</lpage>. <pub-id pub-id-type="doi">10.1038/jid.2010.6</pub-id><?supplied-pmid 20130595?><pub-id pub-id-type="pmid">20130595</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref073">
      <label>73</label>
      <mixed-citation publication-type="journal"><name><surname>Christophi</surname><given-names>GP</given-names></name>, <name><surname>Panos</surname><given-names>M</given-names></name>, <name><surname>Hudson</surname><given-names>CA</given-names></name>, <name><surname>Christophi</surname><given-names>RL</given-names></name>, <name><surname>Gruber</surname><given-names>RC</given-names></name>, <name><surname>Mersich</surname><given-names>AT</given-names></name>, <etal>et al</etal><article-title>Macrophages of multiple sclerosis patients display deficient SHP-1 expression and enhanced inflammatory phenotype</article-title>. <source>Laboratory Investigation</source>. <year>2009</year>;<volume>89</volume>(<issue>7</issue>):<fpage>742</fpage><pub-id pub-id-type="doi">10.1038/labinvest.2009.32</pub-id><?supplied-pmid 19398961?><pub-id pub-id-type="pmid">19398961</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref074">
      <label>74</label>
      <mixed-citation publication-type="journal"><name><surname>Kanehisa</surname><given-names>M</given-names></name>, <name><surname>Furumichi</surname><given-names>M</given-names></name>, <name><surname>Tanabe</surname><given-names>M</given-names></name>, <name><surname>Sato</surname><given-names>Y</given-names></name>, <name><surname>Morishima</surname><given-names>K</given-names></name>. <article-title>KEGG: new perspectives on genomes, pathways, diseases and drugs</article-title>. <source>Nucleic Acids Res</source>. <year>2017</year>;<volume>45</volume>(<issue>D1</issue>):<fpage>D353</fpage>–<lpage>D361</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkw1092</pub-id><pub-id pub-id-type="pmid">27899662</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref075">
      <label>75</label>
      <mixed-citation publication-type="journal"><name><surname>Lieber</surname><given-names>M</given-names></name>, <name><surname>Todaro</surname><given-names>G</given-names></name>, <name><surname>Smith</surname><given-names>B</given-names></name>, <name><surname>Szakal</surname><given-names>A</given-names></name>, <name><surname>Nelson-Rees</surname><given-names>W</given-names></name>. <article-title>A continuous tumor-cell line from a human lung carcinoma with properties of type II alveolar epithelial cells</article-title>. <source>International Journal of Cancer</source>. <year>1976</year>;<volume>17</volume>(<issue>1</issue>):<fpage>62</fpage>–<lpage>70</lpage>. <pub-id pub-id-type="doi">10.1002/ijc.2910170110</pub-id><pub-id pub-id-type="pmid">175022</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref076">
      <label>76</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>Y</given-names></name>, <name><surname>Beyer</surname><given-names>A</given-names></name>, <name><surname>Aebersold</surname><given-names>R</given-names></name>. <article-title>On the dependency of cellular protein levels on mRNA abundance</article-title>. <source>Cell</source>. <year>2016</year>;<volume>165</volume>(<issue>3</issue>):<fpage>535</fpage>–<lpage>550</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2016.03.014</pub-id><pub-id pub-id-type="pmid">27104977</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref077">
      <label>77</label>
      <mixed-citation publication-type="journal"><name><surname>De Smet</surname><given-names>R</given-names></name>, <name><surname>Marchal</surname><given-names>K</given-names></name>. <article-title>Advantages and limitations of current network inference methods</article-title>. <source>Nature Reviews Microbiology</source>. <year>2010</year>;<volume>8</volume>(<issue>10</issue>):<fpage>717</fpage><pub-id pub-id-type="doi">10.1038/nrmicro2419</pub-id><pub-id pub-id-type="pmid">20805835</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref078">
      <label>78</label>
      <mixed-citation publication-type="journal"><name><surname>Marbach</surname><given-names>D</given-names></name>, <name><surname>Prill</surname><given-names>RJ</given-names></name>, <name><surname>Schaffter</surname><given-names>T</given-names></name>, <name><surname>Mattiussi</surname><given-names>C</given-names></name>, <name><surname>Floreano</surname><given-names>D</given-names></name>, <name><surname>Stolovitzky</surname><given-names>G</given-names></name>. <article-title>Revealing strengths and weaknesses of methods for gene network inference</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2010</year>;<volume>107</volume>(<issue>14</issue>):<fpage>6286</fpage>–<lpage>6291</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.0913357107</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref079">
      <label>79</label>
      <mixed-citation publication-type="journal"><name><surname>Uygun</surname><given-names>S</given-names></name>, <name><surname>Peng</surname><given-names>C</given-names></name>, <name><surname>Lehti-Shiu</surname><given-names>MD</given-names></name>, <name><surname>Last</surname><given-names>RL</given-names></name>, <name><surname>Shiu</surname><given-names>SH</given-names></name>. <article-title>Utility and limitations of using gene expression data to identify functional associations</article-title>. <source>PLOS Computational Biology</source>. <year>2016</year>;<volume>12</volume>(<issue>12</issue>):<fpage>e1005244</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005244</pub-id><pub-id pub-id-type="pmid">27935950</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref080">
      <label>80</label>
      <mixed-citation publication-type="journal"><name><surname>Qiu</surname><given-names>X</given-names></name>, <name><surname>Rahimzamani</surname><given-names>A</given-names></name>, <name><surname>Wang</surname><given-names>L</given-names></name>, <name><surname>Mao</surname><given-names>Q</given-names></name>, <name><surname>Durham</surname><given-names>T</given-names></name>, <name><surname>McFaline-Figueroa</surname><given-names>JL</given-names></name>, <etal>et al</etal><article-title>Towards inferring causal gene regulatory networks from single cell expression measurements</article-title>. <source>Cell Systems</source>. <year>2020</year>; <volume>10</volume>(<issue>3</issue>):<fpage>265</fpage>–<lpage>274.e11</lpage>. <pub-id pub-id-type="doi">10.1016/j.cels.2020.02.003</pub-id><pub-id pub-id-type="pmid">32135093</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref081">
      <label>81</label>
      <mixed-citation publication-type="journal"><name><surname>Deshpande</surname><given-names>A</given-names></name>, <name><surname>Chu</surname><given-names>LF</given-names></name>, <name><surname>Stewart</surname><given-names>R</given-names></name>, <name><surname>Gitter</surname><given-names>A</given-names></name>. <article-title>Network Inference with Granger Causality Ensembles on Single-Cell Transcriptomic Data</article-title>. <source>BioRxiv</source>. <year>2019</year>; p. <fpage>534834</fpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref082">
      <label>82</label>
      <mixed-citation publication-type="journal"><name><surname>Meinshausen</surname><given-names>N</given-names></name>, <name><surname>Bühlmann</surname><given-names>P</given-names></name>. <article-title>Stability selection</article-title>. <source>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</source>. <year>2010</year>;<volume>72</volume>(<issue>4</issue>):<fpage>417</fpage>–<lpage>473</lpage>. <pub-id pub-id-type="doi">10.1111/j.1467-9868.2010.00740.x</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref083">
      <label>83</label>
      <mixed-citation publication-type="other">Davis J, Goadrich M. The relationship between Precision-Recall and ROC curves. In: Proceedings of the 23rd International Conference on Machine Learning. ACM; 2006. p. 233–240.</mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref084">
      <label>84</label>
      <mixed-citation publication-type="journal"><name><surname>Marbach</surname><given-names>D</given-names></name>, <name><surname>Schaffter</surname><given-names>T</given-names></name>, <name><surname>Floreano</surname><given-names>D</given-names></name>, <name><surname>Prill</surname><given-names>RJ</given-names></name>, <name><surname>Stolovitsky</surname><given-names>G</given-names></name>. <source>The DREAM4 In-silico Network Challenge: Training data, gold standards, and supplementary information</source>; <year>2009</year><ext-link ext-link-type="uri" xlink:href="http://gnw.sourceforge.net/resources/DREAM4%20in%20silico%20challenge.pdf">http://gnw.sourceforge.net/resources/DREAM4%20in%20silico%20challenge.pdf</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref085">
      <label>85</label>
      <mixed-citation publication-type="journal"><name><surname>Leek</surname><given-names>JT</given-names></name>, <name><surname>Storey</surname><given-names>JD</given-names></name>. <article-title>Capturing Heterogeneity in Gene Expression Studies by Surrogate Variable Analysis</article-title>. <source>PLOS Genetics</source>. <year>2007</year>;<volume>3</volume>(<issue>9</issue>):<fpage>1</fpage>–<lpage>12</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref086">
      <label>86</label>
      <mixed-citation publication-type="journal"><name><surname>Zerbino</surname><given-names>DR</given-names></name>, <name><surname>Achuthan</surname><given-names>P</given-names></name>, <name><surname>Akanni</surname><given-names>W</given-names></name>, <name><surname>Amode</surname><given-names>MR</given-names></name>, <name><surname>Barrell</surname><given-names>D</given-names></name>, <name><surname>Bhai</surname><given-names>J</given-names></name>, <etal>et al</etal><article-title>Ensembl 2018</article-title>. <source>Nucleic Acids Research</source>. <year>2017</year>;<volume>46</volume>(<issue>D1</issue>):<fpage>D754</fpage>–<lpage>D761</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkx1098</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref087">
      <label>87</label>
      <mixed-citation publication-type="journal"><name><surname>Gao</surname><given-names>C</given-names></name>, <name><surname>Zhao</surname><given-names>S</given-names></name>, <name><surname>McDowell</surname><given-names>IC</given-names></name>, <name><surname>Brown</surname><given-names>CD</given-names></name>, <name><surname>Engelhardt</surname><given-names>BE</given-names></name>. <article-title>Context-specific and differential gene co-expression networks via Bayesian biclustering models</article-title>. <source>PLOS Computational Biology</source>. <year>2016</year>;<volume>12</volume>:<fpage>e1004791</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004791</pub-id><pub-id pub-id-type="pmid">27467526</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref088">
      <label>88</label>
      <mixed-citation publication-type="journal"><name><surname>Shabalin</surname><given-names>AA</given-names></name>. <article-title>Matrix eQTL: ultra fast eQTL analysis via large matrix operations</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>(<issue>10</issue>):<fpage>1353</fpage>–<lpage>1358</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bts163</pub-id><pub-id pub-id-type="pmid">22492648</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref089">
      <label>89</label>
      <mixed-citation publication-type="journal"><name><surname>Storey</surname><given-names>JD</given-names></name>, <name><surname>Tibshirani</surname><given-names>R</given-names></name>. <article-title>Statistical significance for genomewide studies</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2003</year>;<volume>100</volume>(<issue>16</issue>):<fpage>9440</fpage>–<lpage>9445</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1530509100</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008223.ref090">
      <label>90</label>
      <mixed-citation publication-type="journal"><name><surname>Meyer</surname><given-names>PE</given-names></name>, <name><surname>Lafitte</surname><given-names>F</given-names></name>, <name><surname>Bontempi</surname><given-names>G</given-names></name>. <article-title>minet: AR/Bioconductor package for inferring large transcriptional networks using mutual information</article-title>. <source>BMC Bioinformatics</source>. <year>2008</year>;<volume>9</volume>(<issue>1</issue>):<fpage>461</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-9-461</pub-id><pub-id pub-id-type="pmid">18959772</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="pcbi.1008223.r001" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008223.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lengauer</surname>
          <given-names>Thomas</given-names>
        </name>
        <role>Methods Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Leslie</surname>
          <given-names>Christina S.</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Lengauer, Leslie</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Lengauer, Leslie</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj001" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008223" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">16 Sep 2019</named-content>
    </p>
    <p>Dear Dr Engelhardt,</p>
    <p>Thank you very much for submitting your manuscript 'Causal network inference from gene transcription time series response to glucocorticoids' for review by PLOS Computational Biology. Your manuscript has been fully evaluated by the PLOS Computational Biology editorial team and in this case also by independent peer reviewers. The reviewers appreciated the attention to an important problem, but raised some substantial critiques of the manuscript as it currently stands. While your manuscript cannot be accepted in its present form, we are willing to consider a revised version in which the issues raised by the reviewers have been adequately addressed. We cannot, of course, promise publication at that time.</p>
    <p>In your revision, note in particular the suggestions for method comparison made by Reviewer #1 to demonstrate the practical advantages of the novel features of BETS, as well as technical and model interpretation questions from both reviewers. Please also clarify if a new RNA-seq data set has been generated for this study and if it has been deposited in a public repository.</p>
    <p>Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>Your revisions should address the specific points made by each reviewer. Please return the revised version within the next 60 days. If you anticipate any delay in its return, we ask that you let us know the expected resubmission date by email at <email>ploscompbiol@plos.org</email>. Revised manuscripts received beyond 60 days may require evaluation and peer review similar to that applied to newly submitted manuscripts.</p>
    <p>In addition, when you are ready to resubmit, please be prepared to provide the following:</p>
    <p>(1) A detailed list of your responses to the review comments and the changes you have made in the manuscript. We require a file of this nature before your manuscript is passed back to the editors.</p>
    <p>(2) A copy of your manuscript with the changes highlighted (encouraged). We encourage authors, if possible to show clearly where changes have been made to their manuscript e.g. by highlighting text.</p>
    <p>(3) A striking still image to accompany your article (optional). If the image is judged to be suitable by the editors, it may be featured on our website and might be chosen as the issue image for that month. These square, high-quality images should be accompanied by a short caption. Please note as well that there should be no copyright restrictions on the use of the image, so that it can be published under the Open-Access license and be subject only to appropriate attribution.</p>
    <p>Before you resubmit your manuscript, please consult our Submission Checklist to ensure your manuscript is formatted correctly for PLOS Computational Biology: <ext-link ext-link-type="uri" xlink:href="http://www.ploscompbiol.org/static/checklist.action">http://www.ploscompbiol.org/static/checklist.action</ext-link>. Some key points to remember are:</p>
    <p>- Figures uploaded separately as TIFF or EPS files (if you wish, your figures may remain in your main manuscript file in addition).</p>
    <p>- Supporting Information uploaded as separate files, titled Dataset, Figure, Table, Text, Protocol, Audio, or Video.</p>
    <p>- Funding information in the 'Financial Disclosure' box in the online system.</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com">https://pacev2.apexcovantage.com</ext-link> PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>.</p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/submission-guidelines#loc-materials-and-methods">here</ext-link>. </p>
    <p>We are sorry that we cannot be more positive about your manuscript at this stage, but if you have any concerns or questions, please do not hesitate to contact us.</p>
    <p>Sincerely,</p>
    <p>Christina S. Leslie</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Thomas Lengauer</p>
    <p>Methods Editor</p>
    <p>PLOS Computational Biology</p>
    <p>A link appears below if there are any accompanying review attachments. If you believe any reviews to be missing, please contact <email>ploscompbiol@plos.org</email> immediately:</p>
    <p>[LINK]</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: This manuscript presents the Bootstrap Elastic net regression from Time Series (BETS) algorithm, an network inference approach for time series gene expression data. The core question in time series-based network inference is how to use past information from regulators to detect their influence on the later expression levels of target genes. BETS adopts a Granger causality approach to address this question. Although Granger causality has been widely applied to time series gene expression data, there are multiple characteristics that differentiate BETS from prior work. The most notable is that BETS provides a false discovery rate (FDR) framework to rank and select network edges. Because it operates with temporal data, permuting the time points generates a convenient dataset in which the true regulator-target dependencies should be destroyed. Running BETS on the permuted data then creates a null distribution of regression coefficients or edge frequencies that can be used for FDR calculations. This FDR evaluation is combined with traditional bootstrapping and stability selection to make BETS robust to small sample sizes and false positive associations that are problematic in short time series. In addition, BETS incorporates an elastic net regression penalty and automated hyperparameter tuning, which are not implemented in many prior Granger causality methods.</p>
    <p>In general, the presentation (figures, writing, review of related work, etc.), methodological choices, and analyses are superb. The synthesis of different types of time series network inference techniques in Figure S1 is an excellent high-level overview of the field. The evaluation on the simulated data DREAM4 challenge is valuable, demonstrating that BETS performs reasonably well on this popular benchmarking dataset and putting BETS in the context of many other types of network inference tools. There is a sizeable AUPR performance gap between BETS and the top method. However, this is not a concern because there are other advantages of BETS besides its AUPR on a simulated data set (e.g. parallelism, speed, and statistical rigor). Furthermore, other work in the gene network inference field has shown that AUPR on simulated data does not reflect the challenges of network inference in real mammalian systems, so maximizing AUPR on the DREAM4 data should not be the main objective of new methods.</p>
    <p>Therefore, the glucocorticoid case study is more relevant and interesting. Because there are not complete gold standard networks available for evaluating condition-specific human regulatory networks, the BETS predictions are assessed with two independent datasets. Overexpression of 10 transcription factors demonstrates that there is general agreement between the gene expression changes induced by overexpression and the edge signs predicted by BETS. The BETS predictions are not perfect, as four transcription factors have positive effects enriched among negative predicted edges. In addition, trans-eQTL analysis of GTEx lung gene expression data reveals many new trans-eQTLs that are nominated by the BETS network edges. These demonstrate how BETS predictions can be used to gain biological insights.</p>
    <p>One weakness with respect to the method's originality and relevance to the network inference field is that there is not a direct analysis demonstrating that the novel methodological aspects of BETS have a practical impact. The DREAM4 results are 10 years old and do not reflect the state of the art in Granger causality analysis. Only BETS was run on the glucocorticoid express data. Conceptually, the null distributions and FDR-based approach should improve network quality, but this claim is not directly assessed.</p>
    <p>Major comments:</p>
    <p>1) Related to the comment above, the manuscript would be improved by more specifically demonstrating to readers why they should use BETS over other modern Granger causality approaches. For instance, if the FDR framework is the main appeal, can it directly demonstrate the advantages of having a principled way to select the size of a network? If it is the scalability and parallelization, can the high-throughput software pipeline be made more robust and user friendly (see below)? There is a comparison with elastic net regression without stability selection, but ensembling or stability selection is now common place in network inference. The most closely related Granger causality work that shares some features with BETS is not included in the DREAM4 benchmarking. Examples of closely related methods include the last two methods in Section 2.1.6 of the supplement (the references are broken so specific manuscripts are unknown) or SWING (Finkle 2018 doi:10.1073/pnas.1710936115), which was not referenced.</p>
    <p>2) The analyses all fix the lag at L=2. It is unknown whether that lag would still be appropriate for time series data with more time points. The lag can be set by the user, but the relationships between the lag hyperparameter, the length of the time series, and the effectiveness of the FDR procedures have not been assessed.</p>
    <p>3) The permutation and bootstrapping concepts in Figure 1 are understandable at a high level. The methodological details are challenging to follow. It appears that a single temporal permutation is made in the outer loop and another is made in the inner loop. Is a single permutation sufficient to obtain a robust null distribution? In addition, if the bootstrapping is done on the matrix form in Equation 10, which has already unrolled or expanded the L previous time points, how is the inner loop permutation performed? The details of the permutation and FDR procedures are difficult to verify.</p>
    <p>4) Using the BETS network's edge signs to predict the vector autoregressive model's edge coefficients is a creative way to use the overexpression data to validate the network that accounts for the edge signs. However, there are some unaddressed caveats with this approach. The overexpression data have fewer time points, so a simpler regression model is used (Equation 17). Any errors in that simple model's fits will confound the BETS network assessment. This approach may also ignore false negative edges in the BETS network. An alternative approach would be to focus on the edge directions in the BETS network by estimating the differentially expressed genes in each overexpression experiment using a temporally-aware statistical test. nsgp (Heinonen 2015 doi:10.1093/bioinformatics/btu699) or a similar method may be able to accommodate the different number of time points in the original and overexpression data. Then, these genes can be treated as the targets of that regulator in a pseudo-gold standard network. The predicted edges for that regular in the BETS network could be evaluated with a precision-recall curve, even if they have very few predicted target genes.</p>
    <p>5) The author contributions imply that the RNA-seq data were generated as part of this study. If that is the case, the experimental protocols and methods are incomplete. In addition, the expression data should be made available.</p>
    <p>Minor comments:</p>
    <p>6) The supplement and GitHub readme note that the time points must be approximately equally spaced. This is an important assumption that limits the applicability to irregular time series. It should be stated more clearly in the main text.</p>
    <p>7) The supplement describes the global and local null distributions and FDR approaches in excellent detail. It is difficult to link this discussion to the methods that were actually used in the main text. Stating where the global and local versions were used in the main text methods would help connect these discussions.</p>
    <p>8) The main text does not explain the biological goals of the glucocorticoid study or why immune and metabolic genes are of interest. It would help guide readers if some of the well-written explanation from the supplement's Sections 1 and 2.3 was moved to the main text results.</p>
    <p>9) The discussion notes that applying Granger causality to single-cell pseudotemporal data is a relevant related area. This is indeed an exciting future direction for BETS, but recent preprints have shown that pseudotimes may not have the same information for network inference as bona fide time series data (Qiu 2018 doi:10.1101/426981; Deshpande 2019 doi:10.1101/534834). That related work may guide readers who attempt to apply BETS to pseudotemporal data.</p>
    <p>10) The methods describes BIOGRID PPI, which do not appear to have been used in the analyses described in the results.</p>
    <p>11) The references in the supplement are broken</p>
    <p>12) The supplement refers to a method named VAR-GEN instead of BETS. Are these the same?</p>
    <p>13) Supplemental Figure 7 is difficult to understand. What are the indices and percentages?</p>
    <p>14) It is commendable that the software pipelines are available on GitHub with an open source license. Some challenges in running the software are detailed below. In addition, the final version should be archived on Zenodo, Figshare, Software Heritage, or a comparable resource. The Google Drive materials could also be migrated to a permanent repository. The support group <ext-link ext-link-type="uri" xlink:href="https://groups.google.com/forum/#">https://groups.google.com/forum/#</ext-link>!forum/bets-support displayed an error "You do not have permission to access this content. (#418)".</p>
    <p>15) The supplement contains typos "we uses the" (page 9) and "multiple sclrosis patients" (page 29).</p>
    <p>Software comments:</p>
    <p>The software was tested on Windows 10 with Git for Windows (GNU bash, version 4.4.23(1)-release (x86_64-pc-msys)) in the following Python 2 conda environment:</p>
    <p>$ conda create --name bets python=2.7 numpy=1.13 scipy=0.19 pandas=0.20 matplotlib scikit-learn</p>
    <p>Python 2's end of life date is in 2020 and support will be dropped by several packages BETS requires (<ext-link ext-link-type="uri" xlink:href="https://python3statement.org/">https://python3statement.org/</ext-link>). Porting the code to Python 3 is strongly recommended.</p>
    <p>Overall, the software would be much easier to run if it adopted an establishing pipeline workflow. The five major steps require substantial user intervention even though everything could be automated after the options in package_params_cpipeline.sh are configured. This would also help with eventual cross-platform compatibility (currently macOS is supported) and formal testing to ensure the pipeline can run on a different system.</p>
    <p>The BETS pipeline in BETS_tutorial.md did not work in the environment described above. After editing dozens of lines, it was possible to run the code through Step 3 (Fit the model on the original data), but then there were too many scripts to edit. The most common incompatibilities were:</p>
    <p>- Assuming 'python2' instead of 'python' to run .py files in the shell scripts</p>
    <p>- The 'rB' argument when loading pickled files generated "ValueError: Invalid mode ('rB')". Removing the 'rB' worked.</p>
    <p>- The 'wB' argument when writing pickled files needed to be 'w' instead.</p>
    <p>- The paths to scripts combined different path separators / and \\</p>
    <p>- The 'module load' command is not needed to load Python in many systems (this does not terminate execution though)</p>
    <p>- Exporting environment variables as a way to configure BETS can be unreliable.</p>
    <p>Reviewer #2: In the manuscript, Engelhardt and colleagues describe a new method called Bootstrap Elastic net regression from Time Series (BETS) to infer causal gene networks from time-series gene expression data. BETS uses vector autoregression with elastic net regularization to infer causal relationships (directed edges) between genes. The authors benchmark the performance of BETS by comparing their results against those from 21 other methods on the time-series data from the DREAM4 Network Inference Challenge. Assessed using previously used metrics of performance (AUPR, area under the precision recal curve; AUROC, area under the ROC), BETS’ ranks 6th out of 22 in terms of the AUPR metric (0.13 vs the top-performing CSId @ ~0.2) and ranks 3rd out of 17 in AUROC (0.7 vs the top-performing CSId @0.72). Compared to other top-performing methods, BETS is the fastest (~2-10 times faster), making it an attractive alternative to the top-performing CSId and Jump3. The authors demonstrate the utility of BETS by applying it on a previously published time-series expression (RNA-Seq) data on A549 cells (human adenocarcinoma cell line) exposed to dexamethasone (synthetic glucocorticoid). BETS-inferred causal gene network is validated against orthogonal over-expression datasets.</p>
    <p>The proposed method is technically sound, and manuscript is generally well written, concise and easy to read. As the authors correctly state, BETS’ advantage over other methods is its speed, with performance comparable to the best-performing methods. BETS would be a nice addition to the arsenal of methods used to infer causal gene networks from time-series expression data. And, the authors have made their method available on GitHub.</p>
    <p>Major Points</p>
    <p>1. With regards to the text related to the inferred Glucocorticoid response network (on page 8), where the authors describe the inferred network containing 2,768 nodes (genes): It is noted that all 2,768 genes are ‘effect genes’ (had an incoming directed edge), and 466/2,768 genes are ‘causes’ (causal?), defined as nodes with an outward directed edge. If all the genes have an out-degree (outgoing edge), I don’t understand how the authors can define 466 genes that has both incoming and outgoing edge as causal. I would think that only those nodes with one or more out-going edges and no incoming edge are ‘causal.’ The authors need to explicitly clarify what their definition of ‘causal gene’ is because this raises questions about their ‘causal gene network’ definition.</p>
    <p>2. The fact that all 2,768 genes have an out-going edge means that the resulting network/graph is not a directed acyclic graph (DAG; network free of cycles) and that it contains strongly connected component (SCCs), defined as a sub‐networks where, for every pair of nodes u and v in the sub‐network, there exists a directed path from u to v, and from v to u. Given this, I wonder if a method like Vertex Sort (PMID: 19690563) would be more appropriate to infer the network hierarchy and thus ‘causal genes’.</p>
    <p>Minor Points:</p>
    <p>1. I recommend the authors consider using “time-series” instead of “time series.”</p>
    <p>2. The authors have been objective overall in describing/interpreting their results/findings. Line 184 on page 6 states that “BETS had a slightly lower AUPR compared with CSId (~0.12 vs 0.20).” I take issue with ‘slightly’ since CSId’s is ~65% better than BETS w.r.t this metric. I would just remove ‘slightly.’</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Computational Biology</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: No: The manuscript states "All files have been or are being submitted to the Gene Expression Omnibus under the same study name, including accession number GSE91208." However, that accession number only lists DNase-seq data, not RNA-seq data. Reviewer access links to any private data used in this study should be made available.</p>
    <p>Reviewer #2: None</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
  </body>
</sub-article>
<sub-article id="pcbi.1008223.r002" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008223.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article id="rel-obj002" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008223" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">3 Feb 2020</named-content>
    </p>
    <supplementary-material content-type="local-data" id="pcbi.1008223.s011">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">BETS_r2r.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1008223.s011.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pcbi.1008223.r003" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008223.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lengauer</surname>
          <given-names>Thomas</given-names>
        </name>
        <role>Methods Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Leslie</surname>
          <given-names>Christina S.</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Lengauer, Leslie</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Lengauer, Leslie</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj003" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008223" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">11 May 2020</named-content>
    </p>
    <p>Dear Dr. Engelhardt,</p>
    <p>Thank you very much for submitting your manuscript "Causal network inference from gene transcription time-series response to glucocorticoids" for consideration at PLOS Computational Biology. As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. The reviewers appreciated the attention to an important topic. Based on the reviews, we are likely to accept this manuscript for publication, providing that you modify the manuscript and accompanying software and materials according to the review recommendations.</p>
    <p>In particular, Reviewer #1 has concerns about the usability of the BETS software, as this reviewer tried and was not able to run the package.  Minor additional concerns include ensuring the availability of the overexpression data by depositing in GEO as well as the source code and supplementary materials by placing in a suitable repository.</p>
    <p>Please prepare and submit your revised manuscript within 30 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. </p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to all review comments, and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Thank you again for your submission to our journal. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Christina S. Leslie</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Thomas Lengauer</p>
    <p>Methods Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>A link appears below if there are any accompanying review attachments. If you believe any reviews to be missing, please contact <email>ploscompbiol@plos.org</email> immediately:</p>
    <p>[LINK]</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: The authors have made substantial revisions that greatly enhance the manuscript and address almost all of my comments with the initial submission. These include clarifications in the Methods text, demonstration of robustness to the lag parameter values, results from new network inference algorithms, and another approach for evaluating the glucocorticoid predictions. Even though not all of the quantitative results favor the BETS algorithm, the additional results strengthen the manuscript. The authors have conducted fair and objective evaluations instead of skewing the results and language to only highlight advantages of BETS. For instance, they are honest in reporting that SWING-RF is now the top performer in the DREAM dataset and the nsgp-based glucocorticoid evaluation shows the BETS predictions are not significantly better than random guessing. (Those glucocorticoid predictions are still supported by two other analyses.) All network inference algorithms have some limitations, so the objective assessment will raise readers' confidence in the reported results and improves the manuscript overall.</p>
    <p>The main reason I am enthusiastic about this manuscript is that the false discovery rate framework is a major and novel contribution to the network inference field. Figure 2 shows that BETS substantially improves upon other vector autoregressive network inference algorithms (including the new SWING-Lasso) in the DREAM evaluation. BETS remains very good at identifying trans-eQTLs. In addition, the analyses and results are rigorous, and the manuscript is very polished overall.</p>
    <p>The only remaining major concern is the usability of the BETS software, as detailed below.</p>
    <p>Major comments:</p>
    <p>1) I am still unable to run the BETS pipeline. This time I tried running BETS in Python 3 on a Linux server. I created a fresh conda environment with</p>
    <p>$ conda create --name bets python=3 numpy=1.13 scipy=0.19 pandas=0.20 matplotlib scikit-learn</p>
    <p>There were fatal errors within the first few minutes of running the pipeline described in BETS_tutorial.md</p>
    <p>- The line 'export NULL=g' comes after $NULL is used in package_params_cpipeline.sh so the directory names are incorrect</p>
    <p>- prep_jobs_bootstrap.sh still uses the 'python2' command to run the Python script so it does not work in a Python 3 environment. Because this command is run within a script, aliasing python2 to point to python3 does not work.</p>
    <p>Because the software is an important part of the contribution, the authors should ensure the pipeline can run in a fresh Python environment. One way to guarantee this would be to run it in a continuous integration service like Travis CI or GitHub Actions.</p>
    <p>Minor comments:</p>
    <p>2) To keep the discussion balanced, some of the new negative results could be included alongside the existing positive results. SWING-RF is very fast and accurate (Table S3), but it is not included in the runtime discussion on line 191. BETS is substantially faster than CSId and Jump3 but not SWING-RF. The Discussion paragraph starting at line 379 only focuses on the positive validations for the glucocorticoid network but ignores the nsgp-based results</p>
    <p>3) The editors should ensure the overexpression data is available on GEO before publication.</p>
    <p>4) The source code and supplementary materials on Google Drive should be archived in a more permanent repository, even if they are &gt; 100 GB. The NIH figshare instance allows 100 GB of storage, and researchers can request more (<ext-link ext-link-type="uri" xlink:href="https://nih.figshare.com/f/faq">https://nih.figshare.com/f/faq</ext-link>). Zenodo has 50 GB by default, but more is available upon request (<ext-link ext-link-type="uri" xlink:href="https://about.zenodo.org/policies/">https://about.zenodo.org/policies/</ext-link>). PLOS Computational Biology partners with Dryad (<ext-link ext-link-type="uri" xlink:href="https://datadryad.org/stash/publishing_charges">https://datadryad.org/stash/publishing_charges</ext-link>) and offers a 300 GB limit (<ext-link ext-link-type="uri" xlink:href="https://datadryad.org/stash/faq">https://datadryad.org/stash/faq</ext-link>)</p>
    <p>5) Some inconsistencies and typos have been introduced over the different versions of the manuscript</p>
    <p>- References to 'STAR Methods' remain</p>
    <p>- Some text describes 340 trans-eQTLs, other text states 341</p>
    <p>- Line 442 states 'In BETS, L = 2.' but now the results include multiple values of L, so this could state L = 2 is the default</p>
    <p>- Line 476 'that the the'</p>
    <p>- Line 576 states 'reference numbers listed in Supplementary Table 3' but that table contains other data</p>
    <p>- The 'DREAM benchmarking' section (line 601) omits the new SWING methods</p>
    <p>- Line 638 still refers to STRING interactions</p>
    <p>- Line 799 'gene g \\in \\not tf a random score' is missing a word</p>
    <p>Reviewer #2: The authors have have satisfactorily addressed the reviewers' comments.</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Computational Biology</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: No: Not yet. The accession number GSE91208 is listed but does not seem relevant. The GEO accession numbers for the 100 nM dexamethasone treatment time course have now been provided. The GEO uploads for the overexpression data are still in progress. The Google Drive data should still be archived as well.</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/" xlink:type="simple">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email xlink:type="simple">figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link ext-link-type="uri" xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, PLOS recommends that you deposit laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see <underline><ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plospathogens/s/submission-guidelines" xlink:type="simple">http://journals.plos.org/ploscompbiol/s/submission-guidelines#loc-materials-and-methods</ext-link></underline></p>
  </body>
</sub-article>
<sub-article id="pcbi.1008223.r004" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008223.r004</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 1</article-title>
    </title-group>
    <related-article id="rel-obj004" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008223" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">14 Jul 2020</named-content>
    </p>
    <supplementary-material content-type="local-data" id="pcbi.1008223.s012">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">bets_r2r_v2.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1008223.s012.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pcbi.1008223.r005" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008223.r005</article-id>
    <title-group>
      <article-title>Decision Letter 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lengauer</surname>
          <given-names>Thomas</given-names>
        </name>
        <role>Methods Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Leslie</surname>
          <given-names>Christina S.</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Lengauer, Leslie</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Lengauer, Leslie</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj005" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008223" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">7 Aug 2020</named-content>
    </p>
    <p>Dear Dr. Engelhardt,</p>
    <p>We are pleased to inform you that your manuscript 'Causal network inference from gene transcription time-series response to glucocorticoids' has been provisionally accepted for publication in PLOS Computational Biology. Please note the reviewers additional comments, though.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Christina S. Leslie</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Thomas Lengauer</p>
    <p>Methods Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: The authors have addressed my previous comments about the manuscript, data, and software. I was able to access the GEO datasets and spot checked the expression data. The supplementary results and files are now archived on Zenodo. Finally, I confirmed that I could run BETS on a Linux server in the conda environment described in the previous review. I have no other concerns and remain enthusiastic about this research.</p>
    <p>One last comment is that the Zenodo file port-from-della.zip contains many files that could be removed. For instance, I noticed</p>
    <p>- drive-download-20200629T235020Z-001.zip</p>
    <p>- ProbGenReceipt_2016.pdf</p>
    <p>- Goldwater_ResearchEssay_1_25_17.docx</p>
    <p>- BACKUP* files</p>
    <p>- The code/ subdirectory</p>
    <p>- Many other files in the presentations/ subdirectory that aren't referenced in 'Full Progeny.xlsx'</p>
    <p>The Zenodo dataset can be updated at any time by uploading a new version of the zip file, so this suggestion does not impact my recommendation for the manuscript.</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Computational Biology</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
  </body>
</sub-article>
<sub-article id="pcbi.1008223.r006" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008223.r006</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lengauer</surname>
          <given-names>Thomas</given-names>
        </name>
        <role>Methods Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Leslie</surname>
          <given-names>Christina S.</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Lengauer, Leslie</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Lengauer, Leslie</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj006" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008223" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">22 Jan 2021</named-content>
    </p>
    <p>PCOMPBIOL-D-19-01120R2 </p>
    <p>Causal network inference from gene transcription time-series response to glucocorticoids</p>
    <p>Dear Dr Engelhardt,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Jutka Oroszlan</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link ext-link-type="uri" xlink:href="http://ploscompbiol.org">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
