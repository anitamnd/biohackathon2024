<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinform Biol Insights</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinform Biol Insights</journal-id>
    <journal-id journal-id-type="publisher-id">Bioinformatics and Biology Insights</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics and Biology Insights</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1177-9322</issn>
    <publisher>
      <publisher-name>SAGE Publications</publisher-name>
      <publisher-loc>Sage UK: London, England</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5478290</article-id>
    <article-id pub-id-type="doi">10.1177/1177932217712241</article-id>
    <article-id pub-id-type="publisher-id">10.1177_1177932217712241</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CellTrans: An R Package to Quantify Stochastic Cell State Transitions</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Buder</surname>
          <given-names>Thomas</given-names>
        </name>
        <xref ref-type="aff" rid="af1-10.1177_1177932217712241">1</xref>
        <xref ref-type="aff" rid="af2-10.1177_1177932217712241">2</xref>
        <xref ref-type="corresp" rid="c1-10.1177_1177932217712241"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Deutsch</surname>
          <given-names>Andreas</given-names>
        </name>
        <xref ref-type="aff" rid="af1-10.1177_1177932217712241">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Seifert</surname>
          <given-names>Michael</given-names>
        </name>
        <xref ref-type="aff" rid="af3-10.1177_1177932217712241">3</xref>
        <xref ref-type="aff" rid="af4-10.1177_1177932217712241">4</xref>
        <xref ref-type="author-notes" rid="fn1-10.1177_1177932217712241">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Voss-Böhme</surname>
          <given-names>Anja</given-names>
        </name>
        <xref ref-type="aff" rid="af1-10.1177_1177932217712241">1</xref>
        <xref ref-type="aff" rid="af2-10.1177_1177932217712241">2</xref>
        <xref ref-type="author-notes" rid="fn1-10.1177_1177932217712241">*</xref>
      </contrib>
    </contrib-group>
    <aff id="af1-10.1177_1177932217712241"><label>1</label>Fakultät Informatik/Mathematik, Hochschule für Technik und Wirtschaft Dresden, Dresden, Germany.</aff>
    <aff id="af2-10.1177_1177932217712241"><label>2</label>Zentrum für Informationsdienste und Hochleistungsrechnen (ZIH), Technische Universität Dresden, Dresden, Germany.</aff>
    <aff id="af3-10.1177_1177932217712241"><label>3</label>Institut für Medizinische Informatik und Biometrie, Medizinische Fakultät Carl Gustav Carus, Dresden, Germany.</aff>
    <aff id="af4-10.1177_1177932217712241"><label>4</label>Nationales Centrum für Tumorerkrankungen (NCT) Dresden, Dresden, Germany.</aff>
    <author-notes>
      <corresp id="c1-10.1177_1177932217712241">CORRESPONDING AUTHOR: Thomas Buder, Fakultät Informatik/Mathematik, Hochschule für Technik und Wirtschaft Dresden, Friedrich-List-Platz 1, 01069 Dresden, Germany. Email: <email>thomas.buder@tu-dresden.de</email></corresp>
      <fn id="fn1-10.1177_1177932217712241">
        <label>*</label>
        <p>MS and AV-B contributed equally to supervising this work.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>6</month>
      <year>2017</year>
    </pub-date>
    <volume>11</volume>
    <elocation-id>1177932217712241</elocation-id>
    <history>
      <date date-type="received">
        <day>31</day>
        <month>1</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>4</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2017</copyright-statement>
      <copyright-year>2017</copyright-year>
      <copyright-holder content-type="sage">SAGE Publications Ltd unless otherwise noted. Manuscript content on this site is licensed under Creative Commons Licenses</copyright-holder>
      <license license-type="open-access">
        <license-p>This article is distributed under the terms of the Creative Commons Attribution-NonCommercial 4.0 License (<ext-link ext-link-type="uri" xlink:href="http://www.creativecommons.org/licenses/by-nc/4.0/">http://www.creativecommons.org/licenses/by-nc/4.0/</ext-link>) which permits non-commercial use, reproduction and distribution of the work without further permission provided the original work is attributed as specified on the SAGE and Open Access page(<ext-link ext-link-type="uri" xlink:href="https://us.sagepub.com/en-us/nam/open-access-at-sage">https://us.sagepub.com/en-us/nam/open-access-at-sage</ext-link>).</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Many normal and cancerous cell lines exhibit a stable composition of cells in distinct states which can, e.g., be defined on the basis of cell surface markers. There is evidence that such an equilibrium is associated with stochastic transitions between distinct states. Quantifying these transitions has the potential to better understand cell lineage compositions. We introduce CellTrans, an R package to quantify stochastic cell state transitions from cell state proportion data from fluorescence-activated cell sorting and flow cytometry experiments. The R package is based on a mathematical model in which cell state alterations occur due to stochastic transitions between distinct cell states whose rates only depend on the current state of a cell. CellTrans is an automated tool for estimating the underlying transition probabilities from appropriately prepared data. We point out potential analytical challenges in the quantification of these cell transitions and explain how CellTrans handles them. The applicability of CellTrans is demonstrated on publicly available data on the evolution of cell state compositions in cancer cell lines. We show that CellTrans can be used to (1) infer the transition probabilities between different cell states, (2) predict cell line compositions at a certain time, (3) predict equilibrium cell state compositions, and (4) estimate the time needed to reach this equilibrium. We provide an implementation of CellTrans in R, freely available via GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/tbuder/CellTrans">https://github.com/tbuder/CellTrans</ext-link>).</p>
    </abstract>
    <kwd-group>
      <kwd>Equilibrium cell state proportions</kwd>
      <kwd>cell state transitions</kwd>
      <kwd>Markov model</kwd>
      <kwd>fluorescence-activated cell sorting (FACS)</kwd>
      <kwd>flow cytometry experiments</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Homeostasis with respect to the proportions of cells in different states is crucial for the functioning of multicellular organisms, and its regulation enables organisms to stay in a healthy state. Different types of tissues and organs need to maintain a stable composition of different cell types regardless of external conditions, injuries, and changing environmental conditions to function normally.<xref rid="b1-10.1177_1177932217712241" ref-type="bibr">1</xref> Hence, finding mechanisms of homeostasis regulation is a key aspect in understanding the emergence of diseases, such as cancer, that leads to disturbance and loss of cell state homeostasis.<xref rid="b2-10.1177_1177932217712241" ref-type="bibr">2</xref></p>
    <p>Remarkably, diseases such as cancer disturb healthy homeostatic states but can lead themselves to a characteristic composition with respect to the proportions of distinctive neoplastic cell states.<xref rid="b3-10.1177_1177932217712241" ref-type="bibr">3</xref> The establishment and maintenance of such a characteristic composition has been experimentally shown using fluorescence-activated cell sorting (FACS) and flow cytometry experiments for many types of cancer, e.g., breast cancer<xref rid="b4-10.1177_1177932217712241" ref-type="bibr">4</xref> and colon cancer.<xref rid="b5-10.1177_1177932217712241" ref-type="bibr">5</xref>–<xref rid="b7-10.1177_1177932217712241" ref-type="bibr">7</xref> In these experiments, it has been observed that subpopulations of cells purified for a given cell state return to the composition of cell state proportions of the original tumor over time.</p>
    <p>The mechanisms for the maintenance of these characteristic compositions are only poorly understood. Cell state proportions could be maintained by regulated cell state–specific proliferation rates, e.g., due to intercellular signaling.<xref rid="b4-10.1177_1177932217712241" ref-type="bibr">4</xref> However, in many cases, this possibility can be experimentally excluded by showing that the proliferation rates of all involved cell types are equal and constant over time. There is evidence that cell types stochastically transition between different states and that the transition rates do not depend on the current tissue composition or on intercellular signaling,<xref rid="b4-10.1177_1177932217712241" ref-type="bibr">4</xref> i.e., the chances to transition into other cell states only depend on the current state of the cell. Quantifying the probabilities for transitions from one cell state to another would allow to predict the evolution of cell state proportions. Such a quantification can potentially help to understand the differences in homeostasis regulation between healthy and diseased tissues.</p>
    <p>One approach to model cell state transitions uses ordinary differential equations (ODEs). Typically, the dynamics between different cell states is described by formulating ODEs incorporating parameters which describe detailed cell properties such as symmetrical/asymmetrical division rates and transition rates between cell states.<xref rid="b5-10.1177_1177932217712241" ref-type="bibr">5</xref>,<xref rid="b7-10.1177_1177932217712241" ref-type="bibr">7</xref></p>
    <p>Another possibility to model the evolution of cell state proportions is discrete-time Markov models. Discrete-time Markov models are particular stochastic processes which can be understood as sequences of random variables indexed by discrete time points, where the next state only depends on the current state of the process but is independent of earlier states.<xref rid="b8-10.1177_1177932217712241" ref-type="bibr">8</xref> For instance, in Gupta et al,<xref rid="b4-10.1177_1177932217712241" ref-type="bibr">4</xref> a Markov model describing the evolution of cell state proportions has been introduced and applied to breast cancer cell lines. However, a detailed discussion of how the transition probabilities are derived from the experimental data and of potential analytical challenges is missing. The quantification of cell state transitions by estimating transition probabilities would allow to better understand characteristics of cell state proportions in both healthy and disease-related tissues. To our knowledge, there is no tool available that allows to automatically estimate cell state transition rates from FACS and flow cytometry experiments.</p>
    <p>We develop such a general tool to estimate the transition probabilities between different cell states from appropriately prepared data. The underlying model is based on a discrete-time Markov model and allows to quantify cell state transitions from data on the temporal evolution of cell state proportions. We use a discrete-time Markov model because it serves as a minimal model for the evolution of cell state proportions. In contrast, ODE models often require additional parameters which must be measured experimentally<xref rid="b5-10.1177_1177932217712241" ref-type="bibr">5</xref> or obtained by fitting.<xref rid="b7-10.1177_1177932217712241" ref-type="bibr">7</xref> Moreover, Markov models have already been successfully used to analyze dynamic cell compositions.<xref rid="b4-10.1177_1177932217712241" ref-type="bibr">4</xref>,<xref rid="b9-10.1177_1177932217712241" ref-type="bibr">9</xref>–<xref rid="b11-10.1177_1177932217712241" ref-type="bibr">11</xref> Here, we generalize this approach and develop an automated tool for the analysis of cell state transitions. We demonstrate which analytical problems can occur in the estimation and in which way these problems are automatically solved by our tool. Furthermore, we provide a publicly available R package called CellTrans which can be directly used by experimentalists to analyze cell state proportion data from FACS and flow cytometry cell line experiments.</p>
    <p>We illustrate potential applications of CellTrans by analyzing publicly available data on the evolution of cell state compositions in different cell lines. We show that the quantification of cell state transitions allows to predict the cell state composition at any time point of interest. In particular, our model is able to predict the long-term equilibrium composition of cell types. Furthermore, our model can reveal frequent and rare cell state transitions. Moreover, CellTrans can be used to estimate the time needed until perturbations of the characteristic cell state compositions level out. Such predictions have the potential to support experimentalists in planning the duration of FACS and flow cytometry cell line experiments.</p>
  </sec>
  <sec sec-type="materials|methods">
    <title>Materials and Methods</title>
    <sec>
      <title>Reference experiment</title>
      <p>CellTrans is able to analyze data recording changes of cell state proportions over time. The identification of individual cell states from mixed cell populations is mainly based on cell type–specific gene markers which allow to experimentally separate the different cell types, for instance, by FACS techniques.<xref rid="b12-10.1177_1177932217712241" ref-type="bibr">12</xref> We assume that cell state proportions change in time due to stochastic transitions dependent only on the current state of the cell. A further prerequisite for the application of our model is the equality of proliferation and death rates of all cell types.</p>
      <p>According to the number of different cell types distinguished in the experiments, an arbitrarily large, but finite integer <italic>m</italic> is fixed, defining the number of distinct cell states in the model. Typically, all distinct cell states are purified and a large number of cells are separately cultured for each cell type. This experimental setup leads to <italic>m</italic> experiments whose evolution of cell state proportions are simultaneously monitored at <italic>t</italic> different time points <italic>n</italic><sub>1</sub>, <italic>n</italic><sub>2</sub>,…, <italic>n<sub>t</sub></italic>. The time points are multiples of a unit time step of length <italic>τ</italic> depending on the timescale of the experiment, e.g. <italic>τ</italic> is 1 hour, 1 day, or 1 week. The time points of measurement are not necessarily integer multiples of <italic>τ</italic>. The data on cell state proportions at each time point <italic>n<sub>j</sub></italic>, <italic>j</italic> = 1,…, <italic>t</italic> are the basis of the analysis with CellTrans as described in the next section.</p>
      <p>Note that CellTrans also allows to analyze experiments with nonpure initial cell state proportions. Importantly, the number of experiments has to be the same as the number of defined cell states <italic>m</italic>. Furthermore, the vectors describing the initial cell state proportions have to be linearly independent, i.e., they cannot be represented as linear combinations of each other (see also the next section).</p>
    </sec>
    <sec sec-type="methods">
      <title>Detailed description and analysis of CellTrans</title>
      <p>We denote the cell states distinguished in the experiments by 1,…, <italic>m.</italic> The experimental data on cell state proportions obtained for each time point <italic>n<sub>j</sub></italic>, <italic>j</italic> = 1, …, <italic>t</italic> need to be arranged in matrices:
<disp-formula id="fd1-10.1177_1177932217712241"><mml:math id="mm1"><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p>
      <p>Here, <inline-formula><mml:math id="mm2"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> describes the proportion of cell state <italic>k</italic> in the <italic>l</italic> th experiment at time <italic>n<sub>j</sub></italic>. These matrices can be stored into text files and read into the CellTrans R package. <xref ref-type="fig" rid="f1-10.1177_1177932217712241">Figure 1</xref> illustrates the experimental setup and the construction of the data matrices.</p>
      <p>We assume that each cell transitions from state <italic>i</italic> to state <italic>j</italic> during a time step of length <italic>τ</italic> with probability <italic>p<sub>ij,</sub> i</italic>, <italic>j</italic> = 1,2,…, <italic>m</italic>. Note that the choice of the time step length has no substantial influence on the predictions which we discuss later. Furthermore, it is assumed that the transition probabilities are constant over time and do only depend on the state of the cell.<xref rid="b4-10.1177_1177932217712241" ref-type="bibr">4</xref> These considerations lead to a discrete-time Markov process with transition matrix <italic>P</italic> = (<italic>p<sub>ij</sub></italic>)<italic><sub>i, j</sub></italic><sub>=1,…,</sub><italic><sub>m</sub></italic> for the random evolution of the state of individual cells. Our goal is to estimate <italic>P</italic>, i.e., all transition probabilities between the cell states, from the experimental data stored in the matrices <inline-formula><mml:math id="mm3"><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>_</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. The interaction graph of the underlying Markov model together with the transition probabilities is illustrated in <xref ref-type="fig" rid="f5-10.1177_1177932217712241">Figure 5A</xref>.</p>
    </sec>
    <sec sec-type="methods">
      <title>Construction of data matrices</title>
      <p>Let <inline-formula><mml:math id="mm4"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> denote the initial cell state proportions in the <italic>k</italic>th experiment which is a row vector of length <italic>m</italic> with non-negative entries summing to one. As explained before, <italic>m</italic> of those initial cell state proportions <inline-formula><mml:math id="mm5"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> are needed. The initial experimental matrix <italic>W</italic><sup>(0)</sup> is row-wise constructed from these cell state proportions, i.e.,
<disp-formula id="fd2-10.1177_1177932217712241"><mml:math id="mm6"><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>−</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mo>−</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>−</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>−</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>−</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mo>−</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋱</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <p>An analytical requirement for the applicability of CellTrans is the existence of the inverse of <italic>W</italic><sup>(0)</sup>. This can be assured by appropriate initial cell state proportions, e.g. by choosing purified initial cell cultures. Because this experimental setup is very common in FACS and flow cytometry experiments, it is implemented as default option in CellTrans. However, also an individually designed initial experimental matrix can be used.</p>
      <p>In the experiments, the cell state proportions at each time point <italic>n</italic><sub>1</sub>, <italic>n</italic><sub>2</sub>,…, <italic>n<sub>t</sub></italic> have to be assessed. Let <inline-formula><mml:math id="mm7"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> denote the cell state proportions of experiment <italic>k</italic> = 1,2,…, <italic>m</italic> after time <italic>n<sub>j</sub></italic> with <italic>j</italic> = 1,2,…, <italic>t.</italic> For each of these time points, a cell state proportion matrix after time <italic>n<sub>j</sub></italic> is obtained by constructing the matrix as described above for <italic>W</italic><sup>(0)</sup>:
<disp-formula id="fd3-10.1177_1177932217712241"><mml:math id="mm8"><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>−</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mo>−</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>−</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mo>−</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>−</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>−</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>−</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mo>−</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <p>Because each row describes the cell state proportions in the corresponding experiment, all rows sum up to one with non-negative entries. In total, <italic>t</italic> of such matrices need to be constructed from the experiments, one for each time point of measurement.</p>
    </sec>
    <sec>
      <title>Derivation of transition matrices <inline-formula><mml:math id="mm9"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></title>
      <p>For each time point <italic>n<sub>j</sub></italic> with <italic>j</italic> = 1,2,…,<italic>t</italic>, CellTrans derives a transition matrix <inline-formula><mml:math id="mm10"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> as follows. This derivation is based on the theory of Markov models.<xref rid="b8-10.1177_1177932217712241" ref-type="bibr">8</xref> We use that the distribution of a Markov chain after <italic>n<sub>j</sub></italic> time steps can be obtained by multiplying the initial distribution with the transition matrix raised to the power of <italic>n<sub>j</sub></italic>; hence,
<disp-formula id="fd4-10.1177_1177932217712241"><mml:math id="mm11"><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula></p>
      <p>Here, <italic>W</italic><sup>(0)</sup> denotes the initial experimental matrix and <inline-formula><mml:math id="mm12"><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> the cell state proportion matrix after time <italic>n<sub>j</sub></italic>. Because we are interested in the underlying transition matrix <italic>P</italic>, we solve this equation for <italic>P</italic> by multiplying with the inverse of <italic>W</italic><sup>(0)</sup> and computing the <italic>n<sub>j</sub></italic> th matrix root, i.e.,
<disp-formula id="fd5-10.1177_1177932217712241"><mml:math id="mm13"><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mspace width="0.2em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:math><label>(1)</label></disp-formula>for <italic>j</italic> = 1,2,…,<italic>t</italic>. Here, we compute the so-called principal matrix root because matrix roots are not necessarily unique. For an overview of the existence and computation of matrix roots see the work by Higham and Lin.<xref rid="b13-10.1177_1177932217712241" ref-type="bibr">13</xref> Note that the existence of (<italic>W</italic><sup>(0)</sup>)<sup>−1</sup> is assured by the appropriate choice of the initial cell state proportions described earlier. The matrix <inline-formula><mml:math id="mm14"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the estimated transition matrix derived from time point <italic>n<sub>j</sub></italic>. Although this derivation looks straightforward, there are potential analytical problems which are described in the following section.</p>
    </sec>
    <sec>
      <title>Regularizing matrix roots to stochastic matrix roots</title>
      <p>Importantly, <xref ref-type="disp-formula" rid="fd5-10.1177_1177932217712241">equation (1)</xref> should yield a transition matrix of a Markov chain, i.e., a stochastic matrix with non-negative entries and row sums equal to one. However, the root of a stochastic matrix is not necessarily stochastic again.<xref rid="b13-10.1177_1177932217712241" ref-type="bibr">13</xref> CellTrans verifies whether the matrix roots are stochastic or not. If not, the matrix roots are regularized to be stochastic with the quasi-optimization of the root matrix (QOM) algorithm which is sketched in the following section and described in detail in Kreinin and Sidelnikova.<xref rid="b14-10.1177_1177932217712241" ref-type="bibr">14</xref></p>
      <p>The QOM algorithm performs a row-wise Euclidean distance minimization by transforming each row of the matrix into a valid row of a transition matrix, i.e., a vector containing non-negative entries which sum to one. The result is a uniquely determined stochastic matrix which closely approximates the original matrix. In the work by Kreinin and Sidelnikova,<xref rid="b14-10.1177_1177932217712241" ref-type="bibr">14</xref> the effect of QOM regularization on nonstochastic matrix roots is numerically investigated. The authors calculated the infinity matrix norm and also the mean absolute deviation of the difference between the QOM result and the original transition matrix for 32 examples of matrix regulation. This numerical comparison demonstrates a low approximation error of the QOM regularization.</p>
    </sec>
    <sec>
      <title>Computation of the transition matrix P</title>
      <p>CellTrans estimates the transition matrix <italic>P</italic> by averaging the transition matrices <inline-formula><mml:math id="mm15"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for each time point <italic>j</italic> = 1,2,…,<italic>t</italic>, i.e.,
<disp-formula id="fd6-10.1177_1177932217712241"><mml:math id="mm16"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math><label>(2)</label></disp-formula></p>
      <p>This transition matrix is the final estimation of CellTrans quantifying the transition probabilities between all cell states. The overall workflow of CellTrans is summarized in <xref ref-type="fig" rid="f1-10.1177_1177932217712241">Figure 1</xref>.</p>
      <p>Note that the dynamics of the Markov chain model can also be described by a master equation, i.e., a set of first-order differential equations. The master equation reads
<disp-formula id="fd7-10.1177_1177932217712241"><mml:math id="mm17"><mml:mrow><mml:mfrac><mml:mi>d</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="1em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mstyle></mml:mrow></mml:math><label>(3)</label></disp-formula>with initial conditions <italic>a<sub>i</sub></italic>(0) = <italic>c<sub>i</sub></italic>.<xref rid="b15-10.1177_1177932217712241" ref-type="bibr">15</xref> Here, <italic>a<sub>i</sub></italic>(<italic>t</italic>) describes the proportion of cells in state <italic>i</italic> at time <italic>t</italic>, and <italic>P</italic> = (<italic>p<sub>ij</sub></italic>)<italic><sub>i, j</sub></italic>
<sub>=1,…,</sub><italic><sub>m</sub></italic> represents the estimated transition matrix from CellTrans. Hence, these differential equations describe the temporal evolution of the cell state proportions. We will use this master equation later to compare the results of CellTrans to those of ODE models.</p>
    </sec>
    <sec>
      <title>Important functions in CellTrans</title>
      <p>Here, we introduce the most important functions which are implemented in CellTrans. In the following sections, we will demonstrate the usage of these functions in several case studies.</p>
      <sec sec-type="methods">
        <title>readExperimentalData()</title>
        <p>This function reads all necessary data. First, it opens a dialog box which asks for the number of cell types, the names of the cell types, the time step length <italic>τ</italic>, and the time points of measurement. Then, the files containing the cell state proportion matrices are read. First, the initial experimental setup matrix <italic>W</italic><sup>(0)</sup> can be chosen as identity matrix (for pure initial cell populations) or an individual initial matrix can be used. Then, the experimental cell proportion matrices are read for each time point of measurement. It is recommendable to save the input into a variable for further analysis, e.g. input &lt;-readExperimentalData().</p>
      </sec>
      <sec>
        <title>celltransitions(input)</title>
        <p>This function derives and prints the estimated transition probabilities and the predicted equilibrium distribution. The variable input contains the read data from the function readExperimentalData().</p>
      </sec>
      <sec>
        <title>celltrans_plot(input), celltrans_plotPDF(input)</title>
        <p>These functions allow to create plots of the predictions of CellTrans and the experimental data. The variable input contains the read data from readExperimentalData().</p>
      </sec>
      <sec>
        <title>timeToEquilibrium(input,initialDistribution,tol)</title>
        <p>This function estimates the time from any initial cell state proportions until the equilibrium proportions are reached. The variable input contains the read data from the function readExperimentalData(). The variable initialDistribution is a vector of length <italic>m</italic> which describes the initial cell state proportions, e.g. c(0.25,0.25,0.25,0.25) for equal proportions of <italic>m</italic> = 4 cell types. The third parameter tol gives a tolerance deviation between the cell state proportions of the equilibrium distribution and those of the predicted cell state proportions, as the exact equilibrium distribution is not reached, in general. For the parameter tol, we recommend values between 0.01 and 0.02.</p>
        <p>For a comprehensive introduction demonstrating the application of these functions, see the detailed vignette provided with the R package (<xref ref-type="supplementary-material" rid="s1-10.1177_1177932217712241">Additional file 1—supplementary material</xref>).</p>
      </sec>
    </sec>
    <sec>
      <title>Applications of CellTrans</title>
      <p>CellTrans can be applied to analyze cell state proportion data from FACS and flow cytometry experiments with respect to several questions. The applications are based on the estimation of the transition probabilities of the underlying model as described above:
<list list-type="order"><list-item><p>The estimated probabilities quantify the frequencies of state transitions and can be used to detect frequent, rare, or almost never occurring transitions. Such a prediction allows to hypothesize about biological mechanisms which are responsible for the observed transition structure, e.g. an underlying transition hierarchy.</p></list-item><list-item><p>Another application is the prediction of cell line compositions at any time point. Such an estimate can be used to predict cell line compositions even beyond the time periods of experiments which we will demonstrate in the “Results” section.</p></list-item><list-item><p>CellTrans can be used to estimate the equilibrium cell state proportions. This information can support experimentalists to decide whether experimentally observed cell line compositions already reached equilibrium.</p></list-item><list-item><p>CellTrans allows the prediction of the time needed to reach equilibrium proportions from any initial cell state composition. The choice of the time period of FACS experiments and the time points at which cell state compositions are measured is often difficult. Here, the estimate of the time needed to reach equilibrium can be useful.</p></list-item></list></p>
      <p><xref ref-type="table" rid="t1-10.1177_1177932217712241">Table 1</xref> summarizes the main applications and the corresponding functions in CellTrans.</p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <p>In this section, we apply CellTrans to publicly available data on the evolution of cell state proportions obtained from FACS and flow cytometry experiments. We point out possible conclusions that can be drawn from the application of CellTrans. The used data are provided in <xref ref-type="supplementary-material" rid="s1-10.1177_1177932217712241">Additional file 2 (supplementary material)</xref> so that the results of this section can be reproduced.</p>
    <sec>
      <title>Dynamics between cancer cell subpopulations in colon cancer</title>
      <sec>
        <title>Background</title>
        <p>There is evidence that CD133<sup>+</sup> cells represent a cancer stem cell (CSC) subpopulation within SW620 human colon cells.<xref rid="b6-10.1177_1177932217712241" ref-type="bibr">6</xref> In the work by Yang et al,<xref rid="b6-10.1177_1177932217712241" ref-type="bibr">6</xref> the dynamics between CSCs and nonstem cancer cells (NSCCs) has been experimentally investigated. In detail, purified NSCCs and CSCs sorted from the SW620 cell line by FACS were cultured for 26 days, and the composition of these cultures was measured every second day in both experiments. Here, we analyze the data from these experiments with CellTrans and compare the resulting predictions with those obtained from an ODE model which has been analyzed in the work by Wang et al.<xref rid="b5-10.1177_1177932217712241" ref-type="bibr">5</xref></p>
      </sec>
      <sec>
        <title>Application of CellTrans</title>
        <p>The experimental setup in the work by Yang et al <xref rid="b6-10.1177_1177932217712241" ref-type="bibr">6</xref> can be formulated within the framework of CellTrans as follows. There are <italic>m</italic> = 2 subpopulations considered in SW620 human colon cancer cells which are called CSC and NSCC. Note that the assumption that both of these cell types do not differ in their proliferation and death rates is justified.<xref rid="b5-10.1177_1177932217712241" ref-type="bibr">5</xref> The initial experimental matrix representing purified initial cell cultures is as follows:
<disp-formula id="fd8-10.1177_1177932217712241"><mml:math id="mm18"><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>where the first row corresponds to the experiment with sorted CSCs and the second row with sorted NSCCs. Hence, we choose the identity matrix in CellTrans as initial experimental matrix.</p>
        <p>There are in total 12 time points of cell state proportion measurements which are given by 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, and 24 days. Thus, it is sensible to choose a time step length <italic>τ</italic> of 1 day. The cell state proportion matrices for each of these time points can be derived from the experimental data provided in Tables S2 and S3 in the work by Wang et al<xref rid="b5-10.1177_1177932217712241" ref-type="bibr">5</xref> which leads to 12 corresponding cell state proportion matrices. These matrices are provided in .TXT files in <xref ref-type="supplementary-material" rid="s1-10.1177_1177932217712241">Additional file 1 (supplementary material)</xref>. For example, the cell state proportion matrix after 8 days is as follows:
<disp-formula id="fd9-10.1177_1177932217712241"><mml:math id="mm19"><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>8</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>7150</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>2850</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>5523</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>4477</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p>
        <p>That is, the experiment starting with 100% CSCs evolved to 71.5% CSCs and 28.5% NSCCs, and the experiment starting with pure NSCCs evolved to 55.23% CSCs and 44.77% NSCCs after 8 days, respectively.</p>
        <p>The function CellTransitions(input) allows to derive the transition probabilities between the cell states and the predicted equilibrium distribution. CellTrans derives a transition matrix for each of the 12 cell state proportion matrices. Note that none of these matrices require regularization by the QOM algorithm because the matrix roots are already stochastic matrices. For example, the transition matrix derived from the experimental data after 8 days <italic>W</italic><sup>(8)</sup> is as follows:
<disp-formula id="fd10-10.1177_1177932217712241"><mml:math id="mm20"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>8</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>9309</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>0691</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>1339</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>8661</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p>
        <p>Finally, the transition matrix <italic>P</italic> is obtained by computing the average of the 12 transition matrices from each time point, i.e.,
<disp-formula id="fd11-10.1177_1177932217712241"><mml:math id="mm21"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>9455</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>0545</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>1030</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>8970</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>which is an estimate of the transition probabilities between NSCC and CSC per day. For example, a CSC converts with probability 0.0545 to an NSCC or an NSCC converts with probability 0.1030 to a CSC within a day. The predicted long-term cell state proportions can be obtained by CellTrans from the steady state of the transition matrix <italic>P</italic> and are also provided by the function CellTransitions(input) which yields the following:
<disp-formula id="fd12-10.1177_1177932217712241"><mml:math id="mm22"><mml:mrow><mml:mi>w</mml:mi><mml:mo>*</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>654</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>346</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p>
        <p>That is, CellTrans predicts a proportion of 65.4% CSCs and of 34.6% NSCCs after sufficient time. The time from 100% CSCs to the equilibrium composition can be estimated with the command timetoEquilibrium(input,c(1,0),0.01) which yields 21 days. Similarly, the time from 100% NSCCs to the equilibrium composition can be estimated with the command timetoEquilibrium(input,c(0,1),0.01) which yields 25 days. Therefore, the time of the experiment was sufficient to reach the equilibrium in this case.</p>
      </sec>
      <sec>
        <title>Model comparison</title>
        <p>In the work by Wang et al,<xref rid="b5-10.1177_1177932217712241" ref-type="bibr">5</xref> the dynamics between CSCs and NSCCs has been modeled by an ODE model with 8 parameters. Some of these parameters have been collected from in situ experiments (see <xref ref-type="table" rid="t1-10.1177_1177932217712241">Table 1</xref>). The predictions from our model show a much better accordance to the data than the predictions of the ODE model (root mean square deviation (RMSD) CellTrans vs ODE: 0.03737 vs 0.09874 for the experiment starting with pure CSC cultures, RMSD CellTrans vs ODE: 0.05326 vs 0.10484 for the experiment starting with pure NSCC cultures). A comparison between the original data from the work by Wang et al<xref rid="b5-10.1177_1177932217712241" ref-type="bibr">5</xref> and the predictions of the derived Markov chain is shown in <xref ref-type="fig" rid="f2-10.1177_1177932217712241">Figure 2A</xref> illustrating that the estimated Markov model well describes the experimental data.</p>
        <p>We can use the master <xref ref-type="disp-formula" rid="fd7-10.1177_1177932217712241">equation (3)</xref> to equivalently describe the cell state dynamics with an ODE system
<disp-formula id="fd13-10.1177_1177932217712241"><mml:math id="mm23"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mfrac><mml:mi>d</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mi>C</mml:mi><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>0545</mml:mn><mml:mi>C</mml:mi><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>103</mml:mn><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:mi>d</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>0545</mml:mn><mml:mi>C</mml:mi><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>1030</mml:mn><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>with appropriate initial conditions <italic>CSC</italic>(0) = 1, <italic>NSCC</italic>(0) = 0 for the experiment with pure CSCs in the beginning. The solution
<disp-formula id="fd14-10.1177_1177932217712241"><mml:math id="mm24"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>C</mml:mi><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>346</mml:mn><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>1575</mml:mn><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>654</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>346</mml:mn><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>1575</mml:mn><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>346</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>allows to obtain the steady state by letting <italic>t</italic> → ∞</p>
      </sec>
      <sec sec-type="conclusions">
        <title>Summary</title>
        <p>This case study demonstrates that the Markov model underlying CellTrans is potentially able to make better predictions than more complex ODE models with parameter calibration. The experimental data on the evolution of cell state proportions are sufficient to interpolate the data. Moreover, the equilibrium proportion is reliably predicted.</p>
      </sec>
    </sec>
    <sec>
      <title>Dynamic switch between adhesive and suspended cell types in colon cancer</title>
      <sec>
        <title>Background</title>
        <p>In the work by Geng et al,<xref rid="b7-10.1177_1177932217712241" ref-type="bibr">7</xref> the dynamic switch between 2 different adhesion phenotypes in colorectal cancer cells has been analyzed. The involved cell states in this study are <italic>adherent</italic> and <italic>suspended</italic> cells. Both of these cell types have been separated and replated. Subsequently, both initially pure cell cultures have been monitored for 8 hours, and the cell state proportions have been measured after 0.5 and 1 hours and subsequently in 2-hour intervals.</p>
      </sec>
      <sec>
        <title>Application of CellTrans</title>
        <p>The study can be integrated in the CellTrans framework in the following way. There are <italic>m</italic> = 2 cell states: adherent and suspended. Although there is no explicit statement regarding the proliferation rates in the work by Geng et al,<xref rid="b7-10.1177_1177932217712241" ref-type="bibr">7</xref> we assume equal rates because the authors model the evolution of the cell state proportions without considering effects of proliferation. The initial experimental matrix is given by the identity matrix because the experimental initial cell state proportions are pure cell cultures of both phenotypes. Here, the first row corresponds to the experiment with 100% adherent cells and the second row with 100% suspended cells.</p>
        <p>Subsequently, the cell state proportion matrices for <italic>t</italic> = 6 time points (at 0.5, 1, 2, 4, 6, and 8 hours) can be deduced from the experiments. Here, the time step length <italic>τ</italic> is chosen to be 1 hour. The matrices are provided in <xref ref-type="supplementary-material" rid="s1-10.1177_1177932217712241">Additional file 1 (supplementary material)</xref>.</p>
        <p>Subsequently, CellTrans derives transition matrices for each of these cell state proportion matrices. This leads to 6 transition matrices <italic>P</italic><sub>0.5</sub>, <italic>P</italic><sub>1</sub>, <italic>P</italic><sub>2</sub>, <italic>P</italic><sub>4</sub>, <italic>P</italic><sub>6</sub>, and <italic>P</italic><sub>8</sub>. All of these matrices do not require regularization in this case because all of them are already stochastic matrices.</p>
        <p>Finally, the transition matrix <italic>P</italic> is obtained as average:
<disp-formula id="fd15-10.1177_1177932217712241"><mml:math id="mm25"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow><mml:mn>6</mml:mn></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>8612</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>1388</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>2908</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>7092</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p>
        <p>The predicted cell state proportions based on the estimated transition matrix and the experimental data are plotted in <xref ref-type="fig" rid="f2-10.1177_1177932217712241">Figure 2B</xref>.</p>
        <p>The steady state of the derived transition matrix <italic>P</italic> is given as follows:
<disp-formula id="fd16-10.1177_1177932217712241"><mml:math id="mm26"><mml:mrow><mml:mi>w</mml:mi><mml:mo>*</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>6768</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>3232</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p>
        <p>That is, the long-term cell state proportions of adherent and suspended cells are predicted as 67.68% and 32.32%, respectively. This prediction is in good accordance with the corresponding experimentally observed equilibrium proportions described in the work by Geng et al.<xref rid="b7-10.1177_1177932217712241" ref-type="bibr">7</xref></p>
      </sec>
      <sec>
        <title>Model comparison</title>
        <p>Geng et al<xref rid="b7-10.1177_1177932217712241" ref-type="bibr">7</xref> formulated a mathematical ODE model to describe the dynamics for the adherent and the suspended cells to reestablish the equilibrium ratio. Note that this approach requires to fit the analytical solution of the model to the experimental data. The fit in the work by Geng et al<xref rid="b7-10.1177_1177932217712241" ref-type="bibr">7</xref> yields the solution <italic>adh</italic>(<italic>t</italic>) = 0.3<italic>e</italic><sup>−0.5</sup><italic><sup>t</sup></italic> +0.7.</p>
        <p>In contrast, we can derive an alternative ODE system with the same structure using the master <xref ref-type="disp-formula" rid="fd7-10.1177_1177932217712241">equation (3)</xref> based on the predictions of CellTrans, i.e.,
<disp-formula id="fd17-10.1177_1177932217712241"><mml:math id="mm27"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mfrac><mml:mi>d</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>1388</mml:mn><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>2908</mml:mn><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:mi>d</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>1388</mml:mn><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>2908</mml:mn><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>with initial conditions <italic>adh</italic>(0) = 1, <italic>susp</italic>(0) = 0. The solution
<disp-formula id="fd18-10.1177_1177932217712241"><mml:math id="mm28"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>323</mml:mn><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>4296</mml:mn><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>67</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>323</mml:mn><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>4296</mml:mn><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>323</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>is close to the solution in the work by Geng et al<xref rid="b7-10.1177_1177932217712241" ref-type="bibr">7</xref> and allows to predict the equilibrium distribution by letting <italic>t</italic> → ∞. This equilibrium solution well corresponds to the experimental findings.</p>
        <p>The predictions of CellTrans and the ad hoc ODE in the work by Geng et al<xref rid="b7-10.1177_1177932217712241" ref-type="bibr">7</xref> are in good accordance with the original data (RMSD CellTrans vs ODE: 0.0219 vs 0.0278 for the experiment starting with pure adherent cultures and RMSD CellTrans vs ODE: 0.02709 vs. 0.02407 for the experiment starting with pure suspended cultures) (see also <xref ref-type="fig" rid="f2-10.1177_1177932217712241">Figure 2B</xref>).</p>
      </sec>
      <sec sec-type="conclusions">
        <title>Summary</title>
        <p>It remains unclear in which way the “best-fit” solution in the introduced ODE approach in the work by Geng et al<xref rid="b7-10.1177_1177932217712241" ref-type="bibr">7</xref> has been obtained. Instead of fitting parameters, our approach offers a transparent estimation of the underlying transition matrix yielding good predictions. Moreover, especially from the point of view of an experimentalist, the automated estimation by CellTrans does not require a deeper engagement with mathematical modeling.</p>
      </sec>
    </sec>
    <sec>
      <title>Proportions of stem-like, basal, and luminal phenotypes in breast cancer</title>
      <sec>
        <title>Background</title>
        <p>The dynamics of phenotypic proportions in human breast cancer cell lines is studied by Gupta et al.<xref rid="b4-10.1177_1177932217712241" ref-type="bibr">4</xref> In detail, the authors used FACS analysis to isolate three mammary epithelial cell states (stem-like, basal, and luminal) from the SUM159 and SUM149 breast cancer cell lines. Pure subpopulations of the three cell states have been cultured for 6 days, and cell state proportions have been measured at the end of the experiment.</p>
      </sec>
      <sec>
        <title>Application of CellTrans</title>
        <p>We apply CellTrans to both cell lines, SUM149 and SUM159. The proliferation rates of the involved cell types are equal.<xref rid="b4-10.1177_1177932217712241" ref-type="bibr">4</xref> The initial experimental cell proportions in both cases can be described as follows:
<disp-formula id="fd19-10.1177_1177932217712241"><mml:math id="mm29"><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>where the first line corresponds to the experiment with sorted stem-like cells, the second row to sorted basal cells, and the third row to sorted luminal cells.</p>
        <p>The proportions of cell states have been obtained at a single time point after 6 days. The time step length <italic>τ</italic> is 1 day in this case. For SUM149, the following cell state proportion matrix can be obtained from the work by Gupta et al<xref rid="b4-10.1177_1177932217712241" ref-type="bibr">4</xref>:
<disp-formula id="fd20-10.1177_1177932217712241"><mml:math id="mm30"><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>6</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>053</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>168</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>78</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>026</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>504</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>47</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>013</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>007</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>98</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>where the first row contains the cell state proportions of the experiment with sorted stem-like cells, the second row with sorted basal cells, and the third row with sorted luminal cells in the beginning, respectively.</p>
        <p>Using the function celltransitions(input), CellTrans derives the following transition matrix from this time point:
<disp-formula id="fd21-10.1177_1177932217712241"><mml:math id="mm31"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>5814</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>1102</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>3084</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>0145</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>8887</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>0968</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>0058</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>0006</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>9936</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>which yields the final transition probabilities because there is only one time point of measurement in this case. For example, the second row indicates that basal cells transition to stem-like cells within a day with a probability of 1.45%, do not change their state with a probability of 88.87%, and convert to the luminal state with a probability of 9.68%. A similar derivation leads to the transition probabilities for SUM159 which exhibits different transition dynamics.</p>
        <p>The predicted equilibrium distribution of our model for SUM149 is
<disp-formula id="fd22-10.1177_1177932217712241"><mml:math id="mm32"><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>014</mml:mn><mml:mspace width="1em"/><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>019</mml:mn><mml:mspace width="1em"/><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>967</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>and for the SUM159 cell line
<disp-formula id="fd23-10.1177_1177932217712241"><mml:math id="mm33"><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>0235</mml:mn><mml:mspace width="1em"/><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>9734</mml:mn><mml:mspace width="1em"/><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>0031</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>(first entry stem-like, second basal, and third luminal) (see <xref ref-type="fig" rid="f3-10.1177_1177932217712241">Figure 3A to F</xref>). These plots can be created in CellTrans with the command celltrans_plot(input). The predictions are in good accordance with the original tumor compositions. In detail, the SUM149 tumor sample is composed of 3.9% stem, 3.3% basal, and 92.8% luminal cells. The proportions within the SUM159 cell line is 1.9% stem, 97.3% basal, and 0.62% luminal cells.<xref rid="b4-10.1177_1177932217712241" ref-type="bibr">4</xref></p>
        <p>The time from 100% stem-like cells to the predicted equilibrium composition can be estimated by CellTrans with the command timetoEquilibrium(input,c(1,0,0),0.01) which yields 31 days. In contrast, the command timeToEquilibrium(input,c(0,0,1),0.01) gives an estimation of 8 days to reach the equilibrium from 100% luminal cells. These predictions reflect that purified luminal cells are much closer to the equilibrium composition than purified stem-like cells.</p>
      </sec>
      <sec>
        <title>Comparison with previously used Markov model</title>
        <p>Gupta et al<xref rid="b4-10.1177_1177932217712241" ref-type="bibr">4</xref> introduced a Markov model of cell state transitions to explain the observed equilibrium. The predictions are based on a single time point, and no regularization of the matrix root is required. CellTrans is able to recover the transition matrices for both cell lines SUM149 and SUM159 presented in the work by Gupta et al<xref rid="b4-10.1177_1177932217712241" ref-type="bibr">4</xref> (<xref ref-type="table" rid="t1-10.1177_1177932217712241">Table 1</xref>). <xref ref-type="fig" rid="f3-10.1177_1177932217712241">Figure 3A to F</xref> illustrates the predicted evolution of cell fractions for both cell lines.</p>
        <p>The master <xref ref-type="disp-formula" rid="fd7-10.1177_1177932217712241">equation (3)</xref> can also be applied to derive an equivalent ODE system:
<disp-formula id="fd24-10.1177_1177932217712241"><mml:math id="mm34"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mfrac><mml:mi>d</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>4186</mml:mn><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>0145</mml:mn><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>0058</mml:mn><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:mi>d</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>1102</mml:mn><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>1113</mml:mn><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>0006</mml:mn><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:mi>d</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>3084</mml:mn><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>0968</mml:mn><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>0064</mml:mn><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
        <p>The solution for the initial conditions <italic>stem</italic>(0) = 1, <italic>bas</italic>(0) = 0, <italic>lum</italic>(0) = 0 reads
<disp-formula id="fd25-10.1177_1177932217712241"><mml:math id="mm35"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>0141</mml:mn><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>9771</mml:mn><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>4274</mml:mn><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>0088</mml:mn><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>1089</mml:mn><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>0191</mml:mn><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>3394</mml:mn><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>4274</mml:mn><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>3203</mml:mn><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>1089</mml:mn><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>9668</mml:mn><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>6377</mml:mn><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>4274</mml:mn><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>3291</mml:mn><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>1089</mml:mn><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
      </sec>
      <sec sec-type="conclusions">
        <title>Summary</title>
        <p>Several applications of our model are demonstrated here. First, CellTrans is able to analyze arbitrarily many cell states, not only 2. Second, the original tumor composition, which is not included in the analysis, is precisely predicted. Third, the estimation of the time to the equilibrium composition potentially helps experimentalists in planning the time periods of cell line experiments.</p>
      </sec>
    </sec>
    <sec>
      <title>Epithelial-mesenchymal transition in breast cancer</title>
      <sec>
        <title>Background</title>
        <p>To investigate the epithelial-mesenchymal transition (EMT) and its implication on the development and progression of breast cancer, Mani et al<xref rid="b16-10.1177_1177932217712241" ref-type="bibr">16</xref> induced an EMT in nontumorigenic, immortalized human mammary epithelial cells (HMLEs). Subsequently, they used flow cytometry analysis to sort the cells based on the expression of CD44 and CD24, 2 cell surface markers whose expression in the CD44<sup>+</sup>/CD24<sup>−</sup> configuration is associated with both human breast CSCs and normal mammary epithelial stem cells. One of their aims was to determine whether the CD44<sup>+</sup>/CD24<sup>−</sup> cells isolated from monolayer cultures of HMLE cells could generate CD44<sup>−</sup>/CD24<sup>+</sup> cells in vitro.</p>
        <p>To examine this question, the authors cultured purified cell phenotypes into monolayer cultures and assayed for the appearance of other cell phenotypes during time. The results of these experiments are summarized in Table S1.<xref rid="b16-10.1177_1177932217712241" ref-type="bibr">16</xref></p>
      </sec>
      <sec>
        <title>Application of CellTrans</title>
        <p>This experimental setup can be formulated within the CellTrans framework as follows. There are <italic>m</italic> = 2 cell states which are named CD44<sup>+</sup>/CD24<sup>−</sup> and CD44<sup>−</sup>/CD24<sup>+</sup>. The initial experimental matrix is given by the identity matrix. This matrix is constructed such that the first row represents the pure CD44<sup>+</sup>/CD24<sup>−</sup> initial cell culture, and the second row corresponds to pure CD44<sup>−</sup>/CD24<sup>+</sup> cell culture.</p>
        <p>The cell state proportions have been experimentally determined for <italic>t</italic> = 4 time points (at 2, 4, 6, and 8 days). Here, the time step length <italic>τ</italic> is 1 day. The cell state proportions matrices <italic>W</italic><sup>(2)</sup>, <italic>W</italic><sup>(4)</sup>, <italic>W</italic><sup>(6)</sup>, and <italic>W</italic><sup>(8)</sup> can be constructed from the data in Mani et al,<xref rid="b16-10.1177_1177932217712241" ref-type="bibr">16</xref> e.g.
<disp-formula id="fd26-10.1177_1177932217712241"><mml:math id="mm36"><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>70</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>01</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>99</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>where the first row represents the experiments starting with pure cultures of cell phenotype CD44<sup>+</sup>/CD24<sup>−</sup> and the second row with cell phenotype CD44<sup>−</sup>/CD24<sup>+</sup>, respectively. The files containing these matrices are provided in <xref ref-type="supplementary-material" rid="s1-10.1177_1177932217712241">Additional file 1 (supplementary material)</xref>.</p>
        <p>CellTrans estimates transition matrices for each of the cell state proportion matrices. This approach leads to 4 matrices <italic>P</italic><sub>2</sub>, <italic>P</italic><sub>4</sub>, <italic>P</italic><sub>6</sub>, and <italic>P</italic><sub>8</sub>. In this case, all of the derived matrices do not require regularization because all matrices are already stochastic matrices. The transition matrix <italic>P</italic> is obtained by averaging over the derived transition matrices which yields the following:
<disp-formula id="fd27-10.1177_1177932217712241"><mml:math id="mm37"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow><mml:mn>4</mml:mn></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>8868</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>1132</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>0007</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>9993</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p>
        <p>The predicted cell state proportions of this transition matrix with the initial states from the experiments and the experimental data are plotted in <xref ref-type="fig" rid="f3-10.1177_1177932217712241">Figure 3G</xref>.</p>
        <p>The solution of the master <xref ref-type="disp-formula" rid="fd7-10.1177_1177932217712241">equation (3)</xref> for the experiment with pure CD44<sup>+</sup>/CD24<sup>−</sup> cells in the beginning is as follows:
<disp-formula id="fd28-10.1177_1177932217712241"><mml:math id="mm38"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>C</mml:mi><mml:mi>D</mml:mi><mml:msup><mml:mn>44</mml:mn><mml:mo>+</mml:mo></mml:msup><mml:mo>/</mml:mo><mml:mi>C</mml:mi><mml:mi>D</mml:mi><mml:msup><mml:mn>24</mml:mn><mml:mo>−</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>0006</mml:mn><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>1133</mml:mn><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>9994</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>C</mml:mi><mml:mi>D</mml:mi><mml:msup><mml:mn>44</mml:mn><mml:mo>−</mml:mo></mml:msup><mml:mo>/</mml:mo><mml:mi>C</mml:mi><mml:mi>D</mml:mi><mml:msup><mml:mn>24</mml:mn><mml:mo>+</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>0006</mml:mn><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>1133</mml:mn><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>0006</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
      </sec>
      <sec sec-type="conclusions">
        <title>Summary</title>
        <p>This case study demonstrates two potential applications of CellTrans. First, CellTrans can reveal rare cell transitions which are indicated by the estimated probability to convert from CD44<sup>−</sup>/CD24<sup>+</sup> to CD44<sup>+</sup>/CD24<sup>−</sup> of 0.0007 per day. Hence, transitions from CD44<sup>−</sup>/CD24<sup>+</sup> to CD44<sup>+</sup>/CD24<sup>−</sup> cells almost never occur suggesting a potential cell transition hierarchy.</p>
        <p>Second, the experiments only cover the first 8 days after culturing, but the time period until the equilibrium proportions are reached is not clear from the beginning. Here, the predicted equilibrium distribution is given as follows:
<disp-formula id="fd29-10.1177_1177932217712241"><mml:math id="mm39"><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>0063</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>9937</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>which corresponds to an equilibrium proportion of 0.63% of CD44<sup>+</sup>/CD24<sup>−</sup> and 99.37% of CD44<sup>−</sup>/CD24<sup>+</sup>. CellTrans can estimate the expected time until this equilibrium is reached. The command timetoEquilibrium(input,c(1,0),0.01) estimates the expected time to the equilibrium starting with a pure CD44<sup>+</sup>/CD24<sup>−</sup> cell line composition with a tolerance deviation of 1%. With these parameters, CellTrans predicts a time of 39 days until the equilibrium proportions are reached.</p>
      </sec>
    </sec>
    <sec>
      <title>Influence of the choice of the time step length τ</title>
      <p>To demonstrate that the predictions and results of CellTrans are independent of the choice of the time step length <italic>τ</italic>, we varied <italic>τ</italic> in the case studies with data from the works by Wang et al<xref rid="b5-10.1177_1177932217712241" ref-type="bibr">5</xref> and Geng et al.<xref rid="b7-10.1177_1177932217712241" ref-type="bibr">7</xref> We predicted the equilibrium distribution, the expected time to equilibrium, and the predicted cell state composition after an arbitrary time for different time step lengths. The results are summarized in <xref ref-type="supplementary-material" rid="s1-10.1177_1177932217712241">Additional file 3 (supplementary material)</xref> and indicate that the predictions are not influenced by <italic>τ</italic>.</p>
    </sec>
    <sec>
      <title>Validation of the predicted equilibrium of CellTrans</title>
      <p>One important application of CellTrans is the prediction of the equilibrium of cell state proportions and the time needed to reach this equilibrium. In some experiments, the equilibrium proportions are not reached at the end of the experiment, e.g. in the investigation of the EMT in breast cancer introduced above.<xref rid="b16-10.1177_1177932217712241" ref-type="bibr">16</xref> Here, we show that CellTrans is able to make predictions beyond the duration of the experiments. In detail, CellTrans is able to reliably predict both the equilibrium cell state proportions and the time needed to reach this proportion. To demonstrate this, we performed a validation analysis based on the 2 case studies dealing with colon cancer cells.<xref rid="b6-10.1177_1177932217712241" ref-type="bibr">6</xref>,<xref rid="b7-10.1177_1177932217712241" ref-type="bibr">7</xref> We used only a subset of the available data points to create predictions of the cell state proportions over time with CellTrans. We excluded late data points to mimic an experimental situation in which the equilibrium is not reached yet. The results of this validation study are illustrated in <xref ref-type="fig" rid="f3-10.1177_1177932217712241">Figure 3H</xref> to I. It turns out that only a few data points are sufficient to reliably predict the equilibrium cell state proportions. Moreover, the predicted time to reach equilibrium proportions is very robust with respect to the choice of available data points. This investigation indicates that CellTrans is able to make predictions even beyond the time period of experiments and might therefore also support the planning of experimental time periods.</p>
    </sec>
    <sec>
      <title>Influence of nonpure initial cell state compositions</title>
      <p>As our case studies demonstrate, most FACS and flow cytometry experiments are based on pure initial cell state compositions. However, CellTrans can also be used to analyze experimental data with nonpure initial compositions. Here, we demonstrate this possibility and investigate whether the predictions and results are influenced by such an initial composition. For this, we reused data from the works by Yang et al<xref rid="b6-10.1177_1177932217712241" ref-type="bibr">6</xref> and Geng et al<xref rid="b7-10.1177_1177932217712241" ref-type="bibr">7</xref> but excluded several of the first data points such that the initial cell state compositions are nonpure. We then used CellTrans to estimate a transition matrix based on these remaining data and compare the corresponding predictions with the original estimates derived from all available data. It turns out that both the evolution of cell line compositions and the equilibria are reliably predicted with nonpure initial cell state compositions. The results of this analysis are illustrated in <xref ref-type="fig" rid="f4-10.1177_1177932217712241">Figure 4</xref>.</p>
    </sec>
    <sec sec-type="methods">
      <title>A simulation study demonstrating matrix regularization</title>
      <p>The presented case studies so far do not require matrix regularization; ie, the matrix roots that CellTrans calculate are already stochastic matrices. To demonstrate that such a regularization might be necessary, we introduce a simulation study and explain how the QOM algorithm performs the necessary regularization.</p>
      <p>In the simulation study, we assume the existence of <italic>m</italic> = 3 cell states. We simulate 3 experiments starting with pure cultures of each cell state. Hence, the experimental initial matrix is as follows:
<disp-formula id="fd30-10.1177_1177932217712241"><mml:math id="mm40"><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <p>As time points, we choose <italic>t</italic> = 2<italic>τ</italic>, 4<italic>τ</italic>, 6<italic>τ</italic>. Here, <italic>τ</italic> is an arbitrary time step length.</p>
      <p>We created an arbitrary transition matrix to describe the transition probabilities between the 3 cell states:
<disp-formula id="fd31-10.1177_1177932217712241"><mml:math id="mm41"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>7739</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>1762</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>0499</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>0006</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>8210</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>1784</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>0937</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>0712</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>8351</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <p>The Markov chain associated with this transition matrix has the steady-state distribution:
<disp-formula id="fd32-10.1177_1177932217712241"><mml:math id="mm42"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>1872</mml:mn><mml:mspace width="1em"/><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>3632</mml:mn><mml:mspace width="1em"/><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>4496</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <p>Then, we generated experimental data after times 2<italic>τ</italic>, 4<italic>τ</italic>, and 6<italic>τ</italic> from the matrix powers <italic>P</italic><sup>2</sup>, <italic>P</italic><sup>4</sup>, and <italic>P</italic><sup>6</sup>. We also added a normally distributed noise with mean 0 and a standard deviation of 0.01 to reflect unprecise measurements. This led to the following cell state proportion matrices:
<disp-formula id="fd33-10.1177_1177932217712241"><mml:math id="mm43"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>6028</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>2769</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>1203</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>0087</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>7003</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>2910</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>1526</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>1224</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>7250</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>3934</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>3819</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>2247</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>0492</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>5175</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>4333</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>1989</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>2465</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>5546</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>6</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>2824</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>4050</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>3126</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>1044</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>4489</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>4467</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>2191</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>2862</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>4947</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
      <p>Applying formula <xref ref-type="disp-formula" rid="fd5-10.1177_1177932217712241">(1)</xref> to derive the matrix roots does not yield a stochastic matrix for all of these 3 matrices. The fourth matrix root of <italic>W</italic><sup>(4)</sup> is as follows:
<disp-formula id="fd34-10.1177_1177932217712241"><mml:math id="mm44"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>7822</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>1737</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>0441</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>0102</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>8205</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>1896</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>0943</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>0792</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>8265</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>which is not a stochastic matrix due to the negative entry in the second row. The QOM algorithm transforms this matrix root into the stochastic matrix:
<disp-formula id="fd35-10.1177_1177932217712241"><mml:math id="mm45"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>7822</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>1737</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>0441</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>0000</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>8154</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>1846</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>0943</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>0792</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>8265</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <p>The further derivation is continued with this regularized matrix root.</p>
      <p>Finally, CellTrans derives the transition matrix:
<disp-formula id="fd36-10.1177_1177932217712241"><mml:math id="mm46"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>7786</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>1708</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>0506</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>0000</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>8258</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>1742</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>0951</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>0694</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>8355</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>which is close to the originally generated <italic>P<sub>sim</sub></italic>. Furthermore, the steady state of the process associated with <italic>P</italic> is as follows:
<disp-formula id="fd37-10.1177_1177932217712241"><mml:math id="mm47"><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>191</mml:mn><mml:mspace width="1em"/><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>3644</mml:mn><mml:mspace width="1em"/><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>4446</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <p>The effect of the QOM regularization on the prediction of CellTrans in this case is visualized in <xref ref-type="fig" rid="f5-10.1177_1177932217712241">Figure 5B</xref> to D.</p>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>Characteristic equilibrium proportions of distinct cell states are commonly observed in vivo and in vitro. Normal and cancerous cell lines exhibit and are able to maintain such an equilibrium.<xref rid="b4-10.1177_1177932217712241" ref-type="bibr">4</xref>,<xref rid="b5-10.1177_1177932217712241" ref-type="bibr">5</xref>,<xref rid="b7-10.1177_1177932217712241" ref-type="bibr">7</xref>,<xref rid="b16-10.1177_1177932217712241" ref-type="bibr">16</xref> Understanding the mechanisms which are responsible for this observation is important to develop appropriate therapies against cancer. There is evidence that stochastic transitions between different cell states can lead to such an equilibrium. To infer the underlying transition dynamics and to quantify these transitions is a key to understand and control the origin of such an equilibrium.</p>
    <p>We introduce CellTrans, an automated framework to deduce the transition probabilities between different cell states from FACS and flow cytometry experiments, in which no differences in the proliferative properties between cell states are observed. The key assumption of the underlying mathematical model is that cells stochastically transition between different states and that the rates for these transitions only depend on the current state of the cell.</p>
    <p>We point out that the transition probabilities can be derived on the basis of Markov chain theory by determining matrix roots from appropriately arranged data matrices and regularizing them to stochastic matrices if necessary. We discuss which mathematical challenges can occur and demonstrate how these challenges are handled by CellTrans. We use the QOM algorithm <xref rid="b14-10.1177_1177932217712241" ref-type="bibr">14</xref> to achieve matrix regularization and provide a simulation study which demonstrates that regularization might be necessary and how it can be achieved by the QOM algorithm.</p>
    <p>To ensure a reliable estimation of cell state transitions, the cell state proportion data should be obtained on the basis of a large number of cells. This ensures the validity of the estimation based on the law of large numbers.<xref rid="b15-10.1177_1177932217712241" ref-type="bibr">15</xref> We suggest to use at least 100 cells in each cell culture experiment to obtain the data for CellTrans.</p>
    <p>Our stochastic approach on the basis of a Markov model can be translated into a system of first-order ODEs with the help of the master <xref ref-type="disp-formula" rid="fd7-10.1177_1177932217712241">equation (3)</xref>. The predictions of these ODEs are equivalent to those of the underlying Markov model of CellTrans. We demonstrate that CellTrans is able to predict the evolution of cell state proportions even more precisely compared with more complicated ODE models which use in situ parameter estimation, as, e.g. in the work by Wang et al.<xref rid="b5-10.1177_1177932217712241" ref-type="bibr">5</xref></p>
    <p>The analyzed case studies in this work demonstrate that CellTrans can be used to compare different cell types with respect to their ability to convert to other cell types, their frequency within equilibrium proportions, and their position within an existing cell transition hierarchy. We showed that the main application of CellTrans is the quantitative inference of transitions between distinctive cell types. The resulting transition probabilities allow to estimate which transitions occur frequently, rarely, or even almost never. Therefore, CellTrans might be able to reveal a hierarchy with respect to the importance of specific transitions for maintaining the observed equilibrium distributions.</p>
    <p>The steady state derived by CellTrans can be interpreted as prediction of the equilibrium cell state proportions. Moreover, CellTrans is able to predict the duration from any initial experimental setup to such an equilibrium (see <xref ref-type="fig" rid="f3-10.1177_1177932217712241">Figure 3H to I</xref>).</p>
    <p>As demonstrated in <xref ref-type="fig" rid="f3-10.1177_1177932217712241">Figure 3A to F</xref>, even patients classified to have the same type of tumor exhibit different equilibrium distributions. Hence, the dynamics of the cell state transitions is patient specific. CellTrans is able to predict these patient-specific transitions and can therefore be used to reveal differences within the same tissue in different patients. These predictions might be a step toward individual therapies.</p>
    <p>Although the presented case studies in this work deal with disease-related cell line experiments, CellTrans can also be used to analyze nondiseased cell lines, such as immunostained progenitor cells, as long as the underlying model prerequisites are fulfilled. Hence, CellTrans can be used to analyze all cell line experiments in which cell state transitions only depend on the current state of the cell, and cell proliferation and death rates are equal.</p>
    <p>We focus here on the case in which cell states exhibit similar proliferation and death rates. In principle, it would be possible to apply a similar approach also if this prerequisite is not fulfilled. This would first require to formulate an extended and more complicated mathematical model which is a challenging task for future work.</p>
    <p>Our case studies demonstrate that CellTrans is a valuable tool to model and quantify cell state transitions. Experimentalists only have to validate the model assumptions. Then, the whole process of mathematical modeling and estimation is automatized. CellTrans allows versatile experiments by being able to analyze also cell state data originating from nonpure initial cell state distributions. In summary, CellTrans is an automated tool that facilitates the analysis and interpretation of cell state proportion data from these experiments on the basis of a Markov model for cell state transitions.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional Files (supplementary material)</title>
    <supplementary-material content-type="local-data" id="s1-10.1177_1177932217712241">
      <caption>
        <p><italic>Additional file 1 (pdf)—Vignette: A quick guide to CellTrans</italic>. A comprehensive example demonstrating how CellTrans can be used.</p>
        <p><italic>Additional file 2 (zip)—Cell state proportion matrices of the case studies</italic>. Additional file containing text files with cell state proportion matrices of the introduced case studies. These data can directly be used for the analysis with CellTrans.</p>
        <p><italic>Additional file 3 (pdf)—The influence of the time step length</italic>. Predictions of CellTrans for varying time step lengths τ for case studies by Yang et al<xref rid="b6-10.1177_1177932217712241" ref-type="bibr">6</xref> and Geng et al.<xref rid="b7-10.1177_1177932217712241" ref-type="bibr">7</xref></p>
      </caption>
      <media xlink:href="10.1177_1177932217712241-s001.pdf" mimetype="application" mime-subtype="pdf" xlink:type="simple" id="d35e5099" position="anchor"/>
      <media xlink:href="10.1177_1177932217712241-s002.zip" mimetype="application" mime-subtype="x-zip-compressed" xlink:type="simple" id="d35e5100" position="anchor"/>
      <media xlink:href="10.1177_1177932217712241-s003.pdf" mimetype="application" mime-subtype="pdf" xlink:type="simple" id="d35e5101" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>The authors thank the Center for Information Services and High Performance Computing at TU Dresden for providing an excellent infrastructure. We also thank Anne Dirkse and Anna Golebiewska (both NORLUX Neuro-Oncology Laboratory, Luxembourg) for helpful discussions.</p>
  </ack>
  <fn-group>
    <fn id="fn2-10.1177_1177932217712241">
      <p><bold>PEER REVIEW:</bold> Five peer reviewers contributed to the peer review report. Reviewers’ reports totaled 711 words, excluding any confidential comments to the academic editor.</p>
    </fn>
    <fn id="fn3-10.1177_1177932217712241">
      <p><bold>FUNDING:</bold> The author(s) disclosed receipt of the following financial support for the research, authorship, and/or publication of this article: TB and AV-B acknowledge support by “Sächsisches Staatsministerium für Wissenschaft und Kunst” (SMWK) project INTERDIS-2. AD acknowledges support by Deutsche Krebshilfe and by DFG-SFB-TRR79 project M8. This work is supported by the German Research Foundation and the Open Access Publication Funds of the TU Dresden.</p>
    </fn>
    <fn id="fn4-10.1177_1177932217712241" fn-type="COI-statement">
      <p><bold>DECLARATION OF CONFLICTING INTERESTS:</bold> The author(s) declared no potential conflicts of interest with respect to the research, authorship, and/or publication of this article.</p>
    </fn>
    <fn id="fn5-10.1177_1177932217712241">
      <p>
        <bold>Author Contributions</bold>
      </p>
      <p>TB wrote the manuscript, designed, and analyzed the mathematical model and wrote the R package. AD contributed to study design and writing the manuscript. MS and AV-B contributed to study design, writing the manuscript, and supervised the study.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="b1-10.1177_1177932217712241">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Biteau</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hochmuth</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Jasper</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Maintaining tissue homeostasis: dynamic control of somatic stem cell activity</article-title>
        <source>Cell Stem Cell</source>
        <year>2011</year>
        <volume>9</volume>
        <fpage>402</fpage>
        <lpage>411</lpage>
        <pub-id pub-id-type="pmid">22056138</pub-id>
      </element-citation>
    </ref>
    <ref id="b2-10.1177_1177932217712241">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hanahan</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Weinberg</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>The hallmarks of cancer</article-title>
        <source>Cell</source>
        <year>2000</year>
        <volume>100</volume>
        <fpage>57</fpage>
        <lpage>70</lpage>
        <pub-id pub-id-type="pmid">10647931</pub-id>
      </element-citation>
    </ref>
    <ref id="b3-10.1177_1177932217712241">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lopez-Bertoni</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Laterra</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Cancer stem cells: dynamic entities in an ever-evolving paradigm</article-title>
        <source>Biol Med</source>
        <year>2015</year>
        <volume>2015</volume>
      </element-citation>
    </ref>
    <ref id="b4-10.1177_1177932217712241">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gupta</surname>
            <given-names>PB</given-names>
          </name>
          <name>
            <surname>Fillmore</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Stochastic state transitions give rise to phenotypic equilibrium in populations of cancer cells</article-title>
        <source>Cell</source>
        <year>2011</year>
        <volume>146</volume>
        <fpage>633</fpage>
        <lpage>644</lpage>
        <pub-id pub-id-type="pmid">21854987</pub-id>
      </element-citation>
    </ref>
    <ref id="b5-10.1177_1177932217712241">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Quan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Fu</surname>
            <given-names>Q</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dynamics between cancer cell subpopulations reveals a model coordinating with both hierarchical and stochastic concepts</article-title>
        <source>PLoS ONE</source>
        <year>2014</year>
        <volume>9</volume>
        <fpage>e84654</fpage>
        <pub-id pub-id-type="pmid">24416258</pub-id>
      </element-citation>
    </ref>
    <ref id="b6-10.1177_1177932217712241">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Quan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dynamic equilibrium between cancer stem cells and non-stem cancer cells in human sw620 and mcf-7 cancer cell populations</article-title>
        <source>Br J Cancer</source>
        <year>2012</year>
        <volume>106</volume>
        <fpage>1512</fpage>
        <lpage>1519</lpage>
        <pub-id pub-id-type="pmid">22472879</pub-id>
      </element-citation>
    </ref>
    <ref id="b7-10.1177_1177932217712241">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Geng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Chandrasekaran</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Agastin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>King</surname>
            <given-names>MR</given-names>
          </name>
        </person-group>
        <article-title>Dynamic switch between two adhesion phenotypes in colorectal cancer cells</article-title>
        <source>Cell Mol Bioeng</source>
        <year>2014</year>
        <volume>7</volume>
        <fpage>35</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="pmid">24575161</pub-id>
      </element-citation>
    </ref>
    <ref id="b8-10.1177_1177932217712241">
      <label>8</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Brémaud</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <source>Markov Chains: Gibbs Fields, Monte Carlo Simulation, and Queues</source>
        <volume>31</volume>
        <publisher-loc>Berlin, Germany</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <year>2013</year>
      </element-citation>
    </ref>
    <ref id="b9-10.1177_1177932217712241">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buder</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Deutsch</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Klink</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Voss-Böhme</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Model-based evaluation of spontaneous tumor regression in pilocytic astrocytoma</article-title>
        <source>PLoS Comput Biol</source>
        <year>2015</year>
        <volume>11</volume>
        <fpage>e1004662</fpage>
        <pub-id pub-id-type="pmid">26658166</pub-id>
      </element-citation>
    </ref>
    <ref id="b10-10.1177_1177932217712241">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Foo</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Leder</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Michor</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Stochastic dynamics of cancer initiation</article-title>
        <source>Phys Biol</source>
        <year>2011</year>
        <volume>8</volume>
        <fpage>015002</fpage>
        <pub-id pub-id-type="pmid">21301064</pub-id>
      </element-citation>
    </ref>
    <ref id="b11-10.1177_1177932217712241">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Komarova</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sengupta</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nowak</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Mutation-selection networks of cancer initiation: tumor suppressor genes and chromosomal instability</article-title>
        <source>J Theor Biol</source>
        <year>2003</year>
        <volume>223</volume>
        <fpage>433</fpage>
        <lpage>450</lpage>
        <pub-id pub-id-type="pmid">12875822</pub-id>
      </element-citation>
    </ref>
    <ref id="b12-10.1177_1177932217712241">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Herzenberg</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Parks</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sahaf</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Perez</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Roederer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Herzenberg</surname>
            <given-names>LA</given-names>
          </name>
        </person-group>
        <article-title>The history and future of the fluorescence activated cell sorter and flow cytometry: a view from Stanford</article-title>
        <source>Clin Chem</source>
        <year>2002</year>
        <volume>48</volume>
        <fpage>1819</fpage>
        <lpage>1827</lpage>
        <pub-id pub-id-type="pmid">12324512</pub-id>
      </element-citation>
    </ref>
    <ref id="b13-10.1177_1177932217712241">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Higham</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>On <italic>p</italic> th roots of stochastic matrices</article-title>
        <source>Lin Algebra Appl</source>
        <year>2011</year>
        <volume>435</volume>
        <fpage>448</fpage>
        <lpage>463</lpage>
      </element-citation>
    </ref>
    <ref id="b14-10.1177_1177932217712241">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kreinin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sidelnikova</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Regularization algorithms for transition matrices</article-title>
        <source>Algo Res Quart</source>
        <year>2001</year>
        <volume>4</volume>
        <fpage>23</fpage>
        <lpage>40</lpage>
      </element-citation>
    </ref>
    <ref id="b15-10.1177_1177932217712241">
      <label>15</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Gardiner</surname>
            <given-names>CW</given-names>
          </name>
        </person-group>
        <source>Stochastic Methods</source>
        <volume>4</volume>
        <publisher-loc>Berlin, Germany</publisher-loc>
        <publisher-name>Springer-Verlag</publisher-name>
        <year>1985</year>
      </element-citation>
    </ref>
    <ref id="b16-10.1177_1177932217712241">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mani</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Liao</surname>
            <given-names>M-J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The epithelial-mesenchymal transition generates cells with properties of stem cells</article-title>
        <source>Cell</source>
        <year>2008</year>
        <volume>133</volume>
        <fpage>704</fpage>
        <lpage>715</lpage>
        <pub-id pub-id-type="pmid">18485877</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="f1-10.1177_1177932217712241" position="float">
    <label>Figure 1</label>
    <caption>
      <p>CellTrans application workflow. To demonstrate the general workflow of CellTrans, we use a fictive experiment with 3 illustrative cell states: 1 (blue), 2 (green), and 3 (red). (A) Three different fluorescence-activated cell sorting experiments E1, E2, and E3 with pure initial cell states and fictional evolutions of these proportions are illustrated. (B) The measured cell state compositions at times <italic>n<sub>j</sub></italic> are used to construct the cell state proportion matrix <inline-formula><mml:math id="mm48"><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <italic>j</italic> = 1,…,<italic>t</italic> Here, each row corresponds to the cell state proportions of one experiment. (C) CellTrans estimates a transition matrix <inline-formula><mml:math id="mm49"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> based on the cell state proportion matrix <inline-formula><mml:math id="mm50"><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> for each time point of measurement <italic>j</italic> = 1,…,<italic>t</italic>. (D) Finally, averaging the estimated transition matrices <inline-formula><mml:math id="mm51"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> leads to the final transition matrix <italic>P</italic>.</p>
    </caption>
    <graphic xlink:href="10.1177_1177932217712241-fig1"/>
  </fig>
  <fig id="f2-10.1177_1177932217712241" position="float">
    <label>Figure 2</label>
    <caption>
      <p>Comparison of model predictions for colon cancer cell lines. (A) We used CellTrans to analyze data about the evolution of cancer cell line compositions from Yang et al.<xref rid="b6-10.1177_1177932217712241" ref-type="bibr">6</xref> The involved cell states are cancer stem cells (CSCs) and nonstem cancer cells (NSCCs), and the original data are plotted as colored dots including the experimental standard deviation. The red curve is the prediction of the cell state compositions of the experiment starting with pure CSCs and the blue curve represents the prediction starting with pure NSCCs. The gray line corresponds to the predictions of ordinary differential equation (ODE) models which have been proposed in the original study.<xref rid="b6-10.1177_1177932217712241" ref-type="bibr">6</xref> (B) Analysis of colon cancer cell line data from Geng et al<xref rid="b7-10.1177_1177932217712241" ref-type="bibr">7</xref> with the cell states adherent and suspended. The red curve is the prediction of CellTrans for the experiment starting with adherent cells only, and the blue curve is the corresponding prediction starting with suspended cells. The gray line is the prediction of the ODE model introduced in the work by Geng et al.<xref rid="b7-10.1177_1177932217712241" ref-type="bibr">7</xref></p>
    </caption>
    <graphic xlink:href="10.1177_1177932217712241-fig2"/>
  </fig>
  <fig id="f3-10.1177_1177932217712241" position="float">
    <label>Figure 3</label>
    <caption>
      <p>CellTrans model predictions and validations. (A) to (G) We used CellTrans to analyze data of the evolution of cell state proportions of publicly available data. The data are plotted by colored dots. (A) to (F) The data originate from the work by Gupta et al4 with 3 different cell states (stem, basal, and luminal) from SUM149 and SUM159 breast cancer cell lines. The predictions of our analysis are plotted by colored curves. The color indicates the state of the cells at the beginning of the corresponding experiment. (G) Analysis of composition data (dots) of human mammary epithelial cell lines<xref rid="b16-10.1177_1177932217712241" ref-type="bibr">16</xref> with cell states CD44−/CD24+ and CD44+/CD24−. The corresponding predictions are plotted as colored curves. (H) to (I) We excluded several of the late data points from the data of the proportions of cancer stem cells (CSCs) and nonstem cancer cells from the work by Yang et al<xref rid="b6-10.1177_1177932217712241" ref-type="bibr">6</xref> and the data with adherent and suspended cells from the work by Geng et al.<xref rid="b7-10.1177_1177932217712241" ref-type="bibr">7</xref> The predictions based on the remaining data are plotted, compare also with <xref ref-type="fig" rid="f2-10.1177_1177932217712241">Figure 2</xref>. This investigation indicates that CellTrans is able to predict cell state proportions even beyond the duration of experiments and that only a few data points are needed to reliably predict the equilibrium.</p>
    </caption>
    <graphic xlink:href="10.1177_1177932217712241-fig3"/>
  </fig>
  <fig id="f4-10.1177_1177932217712241" position="float">
    <label>Figure 4</label>
    <caption>
      <p>Influence of nonpure initial cell state compositions. To obtain nonpure initial cell state proportions, we excluded several of the early data points, as indicated in the legends, from the case studies with data from the works by Yang et al<xref rid="b6-10.1177_1177932217712241" ref-type="bibr">6</xref> and Geng et al.<xref rid="b7-10.1177_1177932217712241" ref-type="bibr">7</xref> The plotted predictions in both figures are based on the analysis of the remaining data points with CellTrans. The starting point of each curve indicates the initial cell state composition. Data from the works by (A) Yang et al<xref rid="b6-10.1177_1177932217712241" ref-type="bibr">6</xref> and (B) Geng et al.<xref rid="b7-10.1177_1177932217712241" ref-type="bibr">7</xref> CSC indicates cancer stem cell.</p>
    </caption>
    <graphic xlink:href="10.1177_1177932217712241-fig4"/>
  </fig>
  <fig id="f5-10.1177_1177932217712241" position="float">
    <label>Figure 5</label>
    <caption>
      <p>Transitions in the model and regularization of the matrix root. (A) CellTrans estimates the transition matrix of the underlying discrete-time Markov model. This matrix contains the transition probabilities between all cell states. Here, these transitions are illustrated for 3 fictive cell states. (B) to (D) We simulated cell state proportion data for an experiment with 3 fictive cell states in which regularization of the matrix roots is necessary to obtain a stochastic matrix. The dots represent simulated data points, and the solid curves represent the prediction of CellTrans. For details on the required matrix root regularization, see the main text.</p>
    </caption>
    <graphic xlink:href="10.1177_1177932217712241-fig5"/>
  </fig>
  <table-wrap id="t1-10.1177_1177932217712241" position="float">
    <label>Table 1</label>
    <caption>
      <p>Main applications of CellTrans and corresponding implemented functions.</p>
    </caption>
    <table frame="box" rules="rows">
      <thead>
        <tr>
          <th valign="middle" align="left" rowspan="1" colspan="1">ESTIMATION OF</th>
          <th valign="middle" align="left" rowspan="1" colspan="1">APPLICATION/INTERPRETATION</th>
          <th valign="middle" align="left" rowspan="1" colspan="1">CORRESPONDING FUNCTION(S)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td valign="top" align="left" rowspan="1" colspan="1">Transition probabilities</td>
          <td valign="top" align="left" rowspan="1" colspan="1">Quantification of cell state transitions<break/>Transition hierarchies<break/>Detect rare and frequent transitions and conclude responsible mechanisms</td>
          <td valign="top" align="left" rowspan="1" colspan="1">celltransitions()</td>
        </tr>
        <tr>
          <td valign="top" align="left" rowspan="1" colspan="1">Cell state compositions</td>
          <td valign="top" align="left" rowspan="1" colspan="1">Predictions beyond time period of experiments<break/>Validate experimental results</td>
          <td valign="top" align="left" rowspan="1" colspan="1">celltrans_plot()<break/>celltrans_plotPDF()</td>
        </tr>
        <tr>
          <td valign="top" align="left" rowspan="1" colspan="1">Equilibrium compositions</td>
          <td valign="top" align="left" rowspan="1" colspan="1">Predict equilibrium compositions<break/>Validate experimental results</td>
          <td valign="top" align="left" rowspan="1" colspan="1">celltransitions()</td>
        </tr>
        <tr>
          <td valign="top" align="left" rowspan="1" colspan="1">Time to equilibrium</td>
          <td valign="top" align="left" rowspan="1" colspan="1">Plan time periods of experiments<break/>Choice of time points of measurement</td>
          <td valign="top" align="left" rowspan="1" colspan="1">timeToEquilibrium()</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</floats-group>
