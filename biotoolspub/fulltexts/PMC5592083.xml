<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PeerJ</journal-id>
    <journal-id journal-id-type="iso-abbrev">PeerJ</journal-id>
    <journal-id journal-id-type="publisher-id">peerj</journal-id>
    <journal-id journal-id-type="pmc">peerj</journal-id>
    <journal-title-group>
      <journal-title>PeerJ</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2167-8359</issn>
    <publisher>
      <publisher-name>PeerJ Inc.</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5592083</article-id>
    <article-id pub-id-type="publisher-id">3788</article-id>
    <article-id pub-id-type="doi">10.7717/peerj.3788</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Bioinformatics</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Computational Biology</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Ecology</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Genomics</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Microbiology</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MetaCRAST: reference-guided extraction of CRISPR spacers from unassembled metagenomes</article-title>
    </title-group>
    <contrib-group>
      <contrib id="author-1" contrib-type="author">
        <name>
          <surname>Moller</surname>
          <given-names>Abraham G.</given-names>
        </name>
        <xref ref-type="aff" rid="aff-1"/>
      </contrib>
      <contrib id="author-2" contrib-type="author" corresp="yes">
        <name>
          <surname>Liang</surname>
          <given-names>Chun</given-names>
        </name>
        <email>liangc@miamioh.edu</email>
        <xref ref-type="aff" rid="aff-1"/>
      </contrib>
      <aff id="aff-1"><institution>Department of Biology, Miami University</institution>, <city>Oxford</city>, <state>OH</state>, <country>United States of America</country></aff>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Gomez</surname>
          <given-names>Shawn</given-names>
        </name>
      </contrib>
    </contrib-group>
    <pub-date pub-type="epub" date-type="pub" iso-8601-date="2017-09-07">
      <day>7</day>
      <month>9</month>
      <year iso-8601-date="2017">2017</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <volume>5</volume>
    <elocation-id>e3788</elocation-id>
    <history>
      <date date-type="received" iso-8601-date="2017-01-26">
        <day>26</day>
        <month>1</month>
        <year iso-8601-date="2017">2017</year>
      </date>
      <date date-type="accepted" iso-8601-date="2017-08-18">
        <day>18</day>
        <month>8</month>
        <year iso-8601-date="2017">2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>©2017 Moller and Liang</copyright-statement>
      <copyright-year>2017</copyright-year>
      <copyright-holder>Moller and Liang</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, reproduction and adaptation in any medium and for any purpose provided that it is properly attributed. For attribution, the original author(s), title, publication source (PeerJ) and either DOI or URL of the article must be cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="https://peerj.com/articles/3788"/>
    <abstract>
      <p>Clustered regularly interspaced short palindromic repeat (CRISPR) systems are the adaptive immune systems of bacteria and archaea against viral infection. While CRISPRs have been exploited as a tool for genetic engineering, their spacer sequences can also provide valuable insights into microbial ecology by linking environmental viruses to their microbial hosts. Despite this importance, metagenomic CRISPR detection remains a major challenge. Here we present a reference-guided CRISPR spacer detection tool (<bold>Meta</bold>genomic <bold>C</bold>RISPR <bold>R</bold>eference-<bold>A</bold>ided <bold>S</bold>earch <bold>T</bold>ool—MetaCRAST) that constrains searches based on user-specified direct repeats (DRs). These DRs could be expected from assembly or taxonomic profiles of metagenomes. We compared the performance of MetaCRAST to those of two existing metagenomic CRISPR detection tools—Crass and MinCED—using both real and simulated acid mine drainage (AMD) and enhanced biological phosphorus removal (EBPR) metagenomes. Our evaluation shows MetaCRAST improves CRISPR spacer detection in real metagenomes compared to the <italic>de novo</italic> CRISPR detection methods Crass and MinCED. Evaluation on simulated metagenomes show it performs better than <italic>de novo</italic> tools for Illumina metagenomes and comparably for 454 metagenomes. It also has comparable performance dependence on read length and community composition, run time, and accuracy to these tools. MetaCRAST is implemented in Perl, parallelizable through the Many Core Engine (MCE), and takes metagenomic sequence reads and direct repeat queries (FASTA or FASTQ) as input. It is freely available for download at <ext-link ext-link-type="uri" xlink:href="https://github.com/molleraj/MetaCRAST">https://github.com/molleraj/MetaCRAST</ext-link>.</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>Metagenomics</kwd>
      <kwd>Repetitive sequences</kwd>
      <kwd>CRISPR</kwd>
      <kwd>Microbial ecology</kwd>
      <kwd>Virus-host interactions</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="fund-1">
        <funding-source>Committee on Faculty Research (CFR) program</funding-source>
      </award-group>
      <award-group id="fund-2">
        <funding-source>Advancement of Research &amp; Scholarship (OARS)</funding-source>
      </award-group>
      <award-group id="fund-3">
        <funding-source>Department of Biology (Miami University)</funding-source>
      </award-group>
      <funding-statement>The project was funded by the Committee on Faculty Research (CFR) program, the Office for the Advancement of Research &amp; Scholarship (OARS), and by an Academic Challenge grant from the Department of Biology (Miami University). There was no additional external funding received for this study. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>The clustered regularly interspaced short palindromic repeat (CRISPR) arrays found in prokaryotic genomes can help us better understand viral-microbial interactions important in many ecosystems. Viruses can release cellular nutrients back into the ecosystem through lytic infection, forming an ecological short-circuit called the viral shunt (<xref rid="ref-28" ref-type="bibr">Weitz &amp; Wilhelm, 2012</xref>). In this manner, viruses not only contribute to nutrient cycling in individual ecosystems, but also to maintaining biogeochemical cycles on a broader scale. The short spacers of viral DNA incorporated into CRISPR arrays form a historical record of past infections, thus linking virus to host (<xref rid="ref-25" ref-type="bibr">Sorek, Kunin &amp; Hugenholtz, 2008</xref>; <xref rid="ref-17" ref-type="bibr">Makarova, Wolf &amp; Koonin, 2013</xref>). This power of CRISPR spacers to determine viruses’ host specificity has recently been exploited using metagenomes from many ecosystems (<xref rid="ref-2" ref-type="bibr">Anderson, Brazelton &amp; Baross, 2011</xref>; <xref rid="ref-22" ref-type="bibr">Sanguino et al., 2015</xref>; <xref rid="ref-9" ref-type="bibr">Edwards et al., 2015</xref>). While many tools exist for detecting CRISPRs in assembled genomes (<xref rid="ref-6" ref-type="bibr">Bland et al., 2007</xref>; <xref rid="ref-8" ref-type="bibr">Edgar, 2007</xref>; <xref rid="ref-10" ref-type="bibr">Grissa, Vergnaud &amp; Pourcel, 2007a</xref>; <xref rid="ref-21" ref-type="bibr">Rousseau et al., 2009</xref>), few exist for CRISPR detection in metagenomic reads (<xref rid="ref-20" ref-type="bibr">Rho et al., 2012</xref>; <xref rid="ref-24" ref-type="bibr">Skennerton, Imelfort &amp; Tyson, 2013</xref>; <xref rid="ref-23" ref-type="bibr">Skennerton, 2006</xref>).</p>
    <p>The repetitive nature of CRISPRs makes them difficult to assemble from metagenomes, necessitating special tools to detect them in unassembled reads. Several tools have been developed to detect and assemble CRISPR arrays in unassembled reads rather than assembled contigs. The tool MinCED (<underline>Min</underline>ing <underline>C</underline>RISPRs in <underline>E</underline>nvironmental <underline>D</underline>atasets), like metaCRT (<xref rid="ref-20" ref-type="bibr">Rho et al., 2012</xref>), is a modified version of CRT (<xref rid="ref-6" ref-type="bibr">Bland et al., 2007</xref>) that detects CRISPR spacers (<xref rid="ref-23" ref-type="bibr">Skennerton, 2006</xref>), while the tool Crass (<underline>CR</underline>ISPR <underline>ass</underline>embler) detects and assembles CRISPR arrays (<xref rid="ref-24" ref-type="bibr">Skennerton, Imelfort &amp; Tyson, 2013</xref>), both from raw metagenomic reads. MinCED searches each read for CRISPRs using the same strategy as CRT; it searches for appropriately spaced short k-mers from which it extends longer repeats if appropriately frequent nucleotides are identified at the ends of the growing repeats. Crass relies on a hybrid algorithm to detect spacers that blends strategies of CRT (<xref rid="ref-6" ref-type="bibr">Bland et al., 2007</xref>) and CRISPRFinder (<xref rid="ref-11" ref-type="bibr">Grissa, Vergnaud &amp; Pourcel, 2007b</xref>). In long reads (&gt;177 bp), it searches for repeats using the CRT strategy previously described. In short reads (&lt;177 bp), on the other hand, it searches for appropriately spaced full-length repeats (i.e., 20–50 bp) and extends these repeats only with identical nucleotides, thus avoiding the potential errors caused by the CRT algorithm over- or under-extending the few repeats found in a short sequence. Crass then searches further for reads containing a single repeat, determines consensus direct repeats, uses the first and last k-mers of detected spacers to build a graph of spacer arrangement, and assembles CRISPR arrays using this graph. Both MinCED and Crass do not rely on prior knowledge of direct repeat sequences, making them <italic>de novo</italic> detection methods. Instead, they use heuristics to determine whether detected repeats are indeed CRISPRs. Such heuristics include threshold array lengths to avoid short, spurious CRISPR arrays and threshold repeat-spacer similarities to avoid arrays where spacers are too similar to repeats (<xref rid="ref-6" ref-type="bibr">Bland et al., 2007</xref>; <xref rid="ref-10" ref-type="bibr">Grissa, Vergnaud &amp; Pourcel, 2007a</xref>; <xref rid="ref-24" ref-type="bibr">Skennerton, Imelfort &amp; Tyson, 2013</xref>), which might indicate microsatellites rather than CRISPRs.</p>
    <p>In this work, we present the <underline>Meta</underline>genomic <underline>C</underline>RISPR <underline>R</underline>eference-<underline>A</underline>ided <underline>S</underline>earch <underline>T</underline>ool (MetaCRAST), a novel reference-guided tool to improve CRISPR spacer detection in unassembled metagenomic sequence reads. While MetaCRAST, to our knowledge, is the first reference-guided, read-dependent metagenomic CRISPR detection tool, prior studies have used known direct repeats to improve CRISPR detection. The genomic CRISPR identification algorithm CRISPRDetect matches newly identified direct repeats to a reference library to refine repeat boundaries and validate arrays (<xref rid="ref-5" ref-type="bibr">Biswas et al., 2016</xref>). Searching reference repeat libraries, together with annotating <italic>cas</italic> genes adjacent to CRISPR arrays, has been used to exclude false positive “putative” CRISPRs from CRISPR annotation (<xref rid="ref-30" ref-type="bibr">Zhang &amp; Ye, 2017</xref>). Unlike MinCED and Crass, as a reference-guided method, MetaCRAST constrains spacer detection by searching metagenomes for direct repeats (DRs) that the user specifies. Relationships amongst these tools and such differences in use are further illustrated in <xref ref-type="fig" rid="fig-1">Fig. 1</xref>. Such specified DRs may be selected based on assembly or taxonomic profiling of metagenomic reads. MetaCRAST improves CRISPR annotation by allowing users to control for the taxonomic composition of the metagenome. It also avoids the rejection of true CRISPRs that can occur due to the heuristics required for <italic>de novo</italic> detection methods. In addition, unlike Crass and MinCED, MetaCRAST provides consistent performance over different read length Illumina datasets.</p>
    <fig id="fig-1" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.7717/peerj.3788/fig-1</object-id>
      <label>Figure 1</label>
      <caption>
        <title>This diagram outlines relationships amongst different metagenomic CRISPR detection methods.</title>
        <p>CRISPR detection can be performed either using specified direct repeats (reference-guided detection) or without prior knowledge of direct repeat sequences (<italic>de novo</italic> detection). <italic>De novo</italic> detection searches raw metagenomic reads for direct repeat sequences of the appropriate length and spacing (i.e., 25–60 bp long repeats with 25–60 bp spacers between them). <italic>De novo</italic> detection techniques either detect spacers in reads only (MinCED) or assemble reads into arrays (Crass). Reference-guided CRISPR detection, on the other hand, searches reads for user-specified direct repeat sequences, and extracts spacers from between direct repeat sequences identified in reads containing direct repeats. While the query is user-specified, general strategies for generating a query include using direct repeats found in assembled metagenomic contigs with CRISPR array detection tools (e.g., PILER-CR) or direct repeats found in genomic CRISPR arrays (e.g., those found in microbial genomes included in CRISPRdb) that might be expected based on taxonomic profiles. An example of the latter strategy would be searching for known genomic <italic>Streptococcus pyogenes</italic> direct repeats if <italic>Streptococcus pyogenes</italic> is found in the metagenome’s taxonomic profile.</p>
      </caption>
      <graphic xlink:href="peerj-05-3788-g001"/>
    </fig>
  </sec>
  <sec sec-type="materials|methods">
    <title>Materials and Methods</title>
    <sec>
      <title>Algorithm and implementation</title>
      <p>MetaCRAST can constrain spacer detection by expected host species’ DRs or DRs identified from assembly (<xref ref-type="fig" rid="fig-2">Fig. 2A</xref>). It searches each read for DR sequences matching query DRs specified by the user. These DRs can be selected from CRISPR arrays detected with genomic CRISPR detection tools such as PILER-CR (<xref rid="ref-8" ref-type="bibr">Edgar, 2007</xref>), CRF (<xref rid="ref-27" ref-type="bibr">Wang &amp; Liang, 2017</xref>), or CRISPRFinder (<xref rid="ref-11" ref-type="bibr">Grissa, Vergnaud &amp; Pourcel, 2007b</xref>) in fully assembled microbial genomes or assembled metagenomic contigs. The steps of the MetaCRAST pipeline are outlined in <xref ref-type="fig" rid="fig-2">Fig. 2B</xref>. In the first step of the pipeline, reads containing DRs within a certain Levenshtein edit distance (i.e., number of insertions, deletions, or substitutions necessary to convert one sequence to another) of the query DRs are quickly identified using the Wu-Manber multi-pattern search algorithm (<xref rid="ref-29" ref-type="bibr">Wu, Manber &amp; Myers, 1995</xref>). In the second step, individual reads found to contain a query DR sequence are searched for two or more copies of the query DRs. In the third step, the sequence fragments between the DRs detected in these sequence reads are extracted into a comprehensive spacer set, which are then clustered using CD-HIT into a non-redundant unique spacer set stored in FASTA format (<xref rid="ref-15" ref-type="bibr">Li &amp; Godzik, 2006</xref>).</p>
      <fig id="fig-2" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.3788/fig-2</object-id>
        <label>Figure 2</label>
        <caption>
          <title>A comparison of per-read CRISPR detection strategies (A) between MetaCRAST and existing <italic>de novo</italic> detection tools (e.g., Crass, MinCED) and an outline of the MetaCRAST workflow (B).</title>
          <p>DR represents direct repeat, while S represents spacer.</p>
        </caption>
        <graphic xlink:href="peerj-05-3788-g002"/>
      </fig>
      <p>MetaCRAST is implemented in Perl as a command line tool to analyze metagenomes in FASTA or FASTQ formats. The tool has been implemented in several versions that differ in metagenome loading method (using BioPerl or readfq, the latter of which was paired either with the standard open routine to load a single file or mce_open for parallel file loading). Optionally, the user can specify the maximum spacer length, the distance metric used for comparing DRs to reads (Hamming or Levenshtein), whether to search for the reverse complement of the DR, the CD-HIT similarity threshold for clustering spacers, and the maximum number of threads to use to parallelize the search. The reverse complement argument (-r) should be used when the CRISPR direction is unknown. When the search is run in parallel, the FASTA (or FASTQ) file is split based on the specified number of threads. All command line arguments are further described in <xref ref-type="table" rid="table-1">Table 1</xref>. Each split file is searched in parallel. An additional tool has been provided to assist taxonomy-guided query selection. This tool searches a taxonomically-annotated library of CRISPRdb DRs for those that belong to a particular taxon query (e.g., <italic>Streptococcus</italic>).</p>
      <table-wrap id="table-1" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.3788/table-1</object-id>
        <label>Table 1</label>
        <caption>
          <title>Command line arguments for MetaCRAST.</title>
          <p>Required arguments are in bold.</p>
        </caption>
        <alternatives>
          <graphic xlink:href="peerj-05-3788-g008"/>
          <table frame="hsides" rules="groups" content-type="text">
            <colgroup span="1">
              <col span="1"/>
              <col span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1">Argument</th>
                <th rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td style="text-align:left;white-space:normal;;" rowspan="1" colspan="1">
                  <bold>-p</bold>
                </td>
                <td rowspan="1" colspan="1">Pattern file containing query DR sequences in <bold>FASTA or FASTQ</bold> format</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">
                  <bold>-i</bold>
                </td>
                <td rowspan="1" colspan="1">Input metagenome in <bold>FASTA or FASTQ</bold> format</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">
                  <bold>-o</bold>
                </td>
                <td rowspan="1" colspan="1">Output directory for detected reads and spacers</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">
                  <bold>-d</bold>
                </td>
                <td rowspan="1" colspan="1">Allowed edit distance (insertions, deletions, or substitutions) for initial read detection with the Wu-Manber algorithm and subsequent DR detection steps</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">-t</td>
                <td rowspan="1" colspan="1">Temporary directory to put metagenome parts (use this if -n option also selected)</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">-q</td>
                <td rowspan="1" colspan="1">Input metagenome is a FASTQ file (directs use of fastq-splitter.pl instead of fasta-splitter.pl)</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">-h</td>
                <td rowspan="1" colspan="1">Use Hamming distance metric (substitutions only - no insertions or deletions) to find direct repeat locations in reads (default: use Levenshtein distance metric - look for sequences matching DR within insertion, deletion, and/or substitution edit distance)</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">-r</td>
                <td rowspan="1" colspan="1">Search for reverse complement of CRISPR direct repeat sequences</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">-l</td>
                <td rowspan="1" colspan="1">Maximum spacer length in bp</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">-c</td>
                <td rowspan="1" colspan="1">CD-HIT similarity threshold for clustering spacers detected for each query direct repeat (value from 0 to 1)</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">-a</td>
                <td rowspan="1" colspan="1">CD-HIT similarity threshold for clustering all detected spacers (value from 0 to 1)</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">-n</td>
                <td rowspan="1" colspan="1">Number of processors to use for parallel processing (and number of temporary metagenome parts)</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>To analyze the distribution of taxonomic affiliations to direct repeats, we examined all direct repeats found in microbial genomes using the CRISPRdb database. CRISPRdb provides a library of direct repeats labeled with respective GenBank accessions in the CRISPR utilities section of the database (<xref rid="ref-10" ref-type="bibr">Grissa, Vergnaud &amp; Pourcel, 2007a</xref>). We processed this library to assign taxonomy information based on GenBank accession. Taxonomy information was extracted from GenBank records with the Perl module Bio::DB::GenBank. Statistics describing the distribution of unique binomial names or genuses to which individual direct repeats affiliated was compiled with Microsoft Excel. Binomial name (species-level) and genus statistics are presented in <xref ref-type="table" rid="table-2">Table 2</xref>.</p>
      <table-wrap id="table-2" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.3788/table-2</object-id>
        <label>Table 2</label>
        <caption>
          <title>Distribution statistics for binomial name and genus-level taxonomic affiliation of CRISPRdb direct repeats.</title>
          <p>A library of direct repeats labeled with respective GenBank accessions from CRISPRdb was processed to assign taxonomy information based on GenBank accession. Taxonomy information was extracted from GenBank records with the Perl module Bio::DB::GenBank. Statistics describing the distribution of binomial names or genuses to which individual direct repeats affiliated were compiled with Microsoft Excel.</p>
        </caption>
        <alternatives>
          <graphic xlink:href="peerj-05-3788-g009"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1">Statistic</th>
                <th rowspan="1" colspan="1">Binomial names</th>
                <th rowspan="1" colspan="1">Genuses</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">Mean</td>
                <td rowspan="1" colspan="1">1.308</td>
                <td rowspan="1" colspan="1">1.063</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Median</td>
                <td rowspan="1" colspan="1">1</td>
                <td rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Mode</td>
                <td rowspan="1" colspan="1">1</td>
                <td rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Minimum</td>
                <td rowspan="1" colspan="1">1</td>
                <td rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Maximum</td>
                <td rowspan="1" colspan="1">46</td>
                <td rowspan="1" colspan="1">20</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Standard deviation</td>
                <td rowspan="1" colspan="1">1.567</td>
                <td rowspan="1" colspan="1">0.521</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
    </sec>
    <sec>
      <title>Performance evaluation with simulated and real metagenomes</title>
      <p>To study the relationship between CRISPR spacer detection and read length or sequencing technology, simulated acid mine drainage (AMD) and enhanced biological phosphorus removal (EBPR) metagenomes were generated using Grinder (<xref rid="ref-3" ref-type="bibr">Angly et al., 2012</xref>). We generated simulated metagenomes over a range of average read lengths (100 to 600 base pairs) using models of 454 (<xref rid="ref-4" ref-type="bibr">Balzer et al., 2010</xref>) and Illumina (<xref rid="ref-14" ref-type="bibr">Korbel et al., 2009</xref>) errors. Following previous studies, we used a fourth-degree polynomial (3e−3 + 3.3e−8 * i<sup>4</sup>, where i is the nucleotide position from the 5′ end of the read, and the output is percentage chance of an error at that position) to model the Illumina sequencing error rate (<xref rid="ref-7" ref-type="bibr">Dohm et al., 2008</xref>; <xref rid="ref-14" ref-type="bibr">Korbel et al., 2009</xref>; <xref rid="ref-3" ref-type="bibr">Angly et al., 2012</xref>). This polynomial determined the probability of substitution, insertion, or deletion at each base of a simulated read (<xref rid="ref-14" ref-type="bibr">Korbel et al., 2009</xref>). For Illumina simulations, the ratio of substitutions to insertions and deletions was set to 80:20 by default. For 454 metagenome simulations, we modeled homopolymer errors as homopolymer length variation within simulated reads. The distributions of homopolymer lengths were defined by the mean n and standard deviation 0.03494 + n * 0.06856, where n is the homopolymer length, based on a prior study (<xref rid="ref-4" ref-type="bibr">Balzer et al., 2010</xref>; <xref rid="ref-3" ref-type="bibr">Angly et al., 2012</xref>).</p>
      <p>We generated six simulated metagenomes per condition (average read length, model, and microbial community). We used highly simplified taxonomic profiles to model the AMD and EBPR metagenomes (<xref ref-type="supplementary-material" rid="supp-2">Tables S1</xref> and <xref ref-type="supplementary-material" rid="supp-3">S2</xref>). To test the effects of community composition on spacer detection, we simulated the AMD metagenome with a 454 error model and 600 bp average read length, varying the relative proportions of <italic>Leptospirillum</italic> and <italic>Ferroplasma</italic> genome used for the simulation (i.e., from 0 to 100% <italic>Leptospirillum</italic>). All simulated metagenomes contained 100,000 reads. 454 metagenomes were generated with this command: <italic>grinder -reference_file AMDgenomes.fasta—abundance_file AMDprofile.txt -total_reads 100000 -read_dist (one of 100, 150, 200, 250, 300, 400, or 600) normal 50 -homopolymer_dist balzer</italic>. All 454 read length distributions were normal with a standard deviation of 50 bp. Illumina metagenomes were generated with this command: <italic>grinder -reference_file AMDgenomes.fasta -abundance_file AMDprofile.txt -total_reads 100000 -read_dist (one of 100, 150, 200, 250, or 300) -md poly4 3e−3 3.3e−8</italic>. All Illumina read length distributions were uniform with all reads having exactly the average read length.</p>
      <p>Simulated metagenomes were searched for CRISPR spacers using Crass (<xref rid="ref-24" ref-type="bibr">Skennerton, Imelfort &amp; Tyson, 2013</xref>), MinCED (Skennerton), and MetaCRAST. Crass and MinCED were run with default parameters (<italic>crass grinder-reads.fa; minced -spacers grinder-reads.fa minced.crispr</italic>). The default minimum and maximum DR lengths for both Crass and MinCED were 23 and 47 bp. The default minimum and maximum spacer lengths for both Crass and MinCED were 26 and 50 bp. MetaCRAST was run with a taxonomy-guided query (<xref ref-type="supplementary-material" rid="supp-4">Tables S3</xref> and <xref ref-type="supplementary-material" rid="supp-5">S4</xref>), a maximum spacer length of 60, a maximum allowed edit distance (insertions, deletions, or substitutions) between query and target direct repeats of three, a CD-HIT clustering similarity threshold of 0.9, and a total of 16 parallel threads (<italic>MetaCRAST -p query.fa -i grinder-reads.fa -o MetaCRAST -d 3 -l 60 -c 0.90 -a 0.90 -n 16 -t tmp</italic>). We selected a maximum allowed edit distance of three based on results of our prior metagenomic CRISPR detection studies, which showed MetaCRAST searches with a taxonomy-guided query that found similar numbers of spacers to Crass when we set this edit distance (<xref rid="ref-19" ref-type="bibr">Moller &amp; Liang, 2017</xref>). For all analyses, detected spacers were clustered with CD-HIT with a similarity threshold of 0.9 (<italic>cdhit -i spacers.fa -o spacersCD90.fa -c 0.9</italic>) to reduce spacer redundancy. Performance on these simulated metagenomes was evaluated based on total number of spacers detected, number of false positive spacers detected, and run time for each average read length. For the mixed composition simulated AMD metagenomes described above, spacers were aligned against CRISPR spacers present in the source <italic>Leptospirillum</italic> and <italic>Ferroplasma</italic> genomes and the number of matching true positive spacers for each organism were reported.</p>
      <p>The number of false positive spacers found in simulated metagenomes was determined by comparing the total detected spacers with the expected CRISPRdb spacers found in the source genomes used for the simulations (AMD and EBPR). Alignments were made to the annotated CRISPRdb spacers using BLAST with an <italic>E</italic>-value cutoff of 1e−6 (<xref rid="ref-1" ref-type="bibr">Altschul et al., 1990</xref>). This analysis was repeated with an <italic>E</italic>-value cutoff of 1e−1 to consider whether the original threshold was too stringent. The number of detected spacers that were aligned to expected ones was subtracted from the total number of spacers detected to determine the number of false positive spacers for a particular method and condition. Cases where zero spacers were detected in a metagenome were treated as zero false positive spacers and included in overall analysis. Run times were determined for each metagenome and method using the built-in Linux command <italic>time</italic>. Run time was calculated as the sum of the user and system time (together the total CPU time).</p>
      <p>Similarly, CRISPR spacers were also detected by the aforementioned three tools in real AMD and EBPR metagenomes (<xref ref-type="supplementary-material" rid="supp-6">Table S5</xref>) downloaded from iMicrobe (<xref rid="ref-13" ref-type="bibr">Hurwitz, 2014</xref>) and taxonomically profiled with MetaPhyler (<xref rid="ref-16" ref-type="bibr">Liu et al., 2011</xref>). MetaCRAST analyses of the real metagenomes were performed with taxonomy- or assembly-guided query DRs generated as follows. To make an assembly-guided query, CAP3-assembled contigs (<xref rid="ref-12" ref-type="bibr">Huang &amp; Madan, 1999</xref>) were searched for CRISPR DRs using PILER-CR (<xref rid="ref-8" ref-type="bibr">Edgar, 2007</xref>), which finds CRISPRs in assembled genomes or contigs. These DRs formed an assembly-guided query (<xref ref-type="supplementary-material" rid="supp-7">Tables S6</xref> and <xref ref-type="supplementary-material" rid="supp-8">S7</xref>), while DRs found in assembled <italic>Leptospirillum</italic> (AMD), <italic>Ferroplasma</italic> (AMD), and Candidatus <italic>Accumulibacter phosphatis</italic> (EBPR) genomes included in CRISPRdb (<xref rid="ref-10" ref-type="bibr">Grissa, Vergnaud &amp; Pourcel, 2007a</xref>) formed a taxonomy-guided query (<xref ref-type="supplementary-material" rid="supp-4">Tables S3</xref> and <xref ref-type="supplementary-material" rid="supp-5">S4</xref>). All of these aforementioned taxa were found to be major components of the microbial community based on the AMD and EBPR taxonomic profiles determined with MetaPhyler (<xref ref-type="supplementary-material" rid="supp-9">Tables S8</xref> and <xref ref-type="supplementary-material" rid="supp-10">S9</xref>).</p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <sec>
      <title>Effects of read length, sequencing technology, and community composition on CRISPR spacer detection</title>
      <p>We first investigated the relationships between detected spacers and read length or sequencing technology. Performance, here determined by the number of spacers detected, increased with read length over all 454 tests (<xref ref-type="fig" rid="fig-3">Fig. 3</xref>). While the total number of spacers detected by Crass and MetaCRAST converged as read length increased, the total number of spacers detected by MinCED steadily increased even beyond the true number of spacers found in the genomes used to generate the simulated metagenomes. We speculate that MinCED inconsistently determined DR lengths amongst different CRISPR-containing reads due to its CRT-based algorithm, leading to the same spacers being inappropriately truncated or extended. Meanwhile, amongst metagenomes simulated with the Illumina model, MetaCRAST detected significantly more spacers than Crass and MinCED for average read lengths of 200 bp or greater (<xref ref-type="fig" rid="fig-3">Fig. 3</xref>; <italic>p</italic> &lt; 0.05 for both AMD and EBPR simulations using unpaired <italic>t</italic>-tests). Crass detected more spacers than MinCED and MetaCRAST for short Illumina reads (100 and 150 bp), however (<xref ref-type="fig" rid="fig-3">Fig. 3</xref>; <italic>p</italic> &lt; 0.05 for both AMD and EBPR simulations using unpaired <italic>t</italic>-tests).</p>
      <fig id="fig-3" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.3788/fig-3</object-id>
        <label>Figure 3</label>
        <caption>
          <title>Evaluation of MetaCRAST, Crass, and MinCED performance on simulated AMD (A and B) and EBPR (C and D) metagenomes.</title>
          <p>The procedure used to generate the simulated metagenomes is described in Materials and Methods. All data points represent the averages of six individual simulations and are presented with error bars representing two times the standard error above and two below the average. The true number of spacers expected in each simulated metagenome is marked with a black line (138 expected in the AMD metagenomes; 219 in the EBPR metagenomes).</p>
        </caption>
        <graphic xlink:href="peerj-05-3788-g003"/>
      </fig>
      <p>We also tested the effects of community composition on CRISPR detection for each of the three methods using AMD metagenomes simulated with a 454 error model and 600 bp average read length. We selected the 600 bp average read length for all mixed metagenomes to minimize differences in detection between methods based on read length (<xref ref-type="fig" rid="fig-3">Fig. 3</xref>). We varied the relative abundances of <italic>Leptospirillum</italic> and <italic>Ferroplasma</italic> from 0 to 100 percent in our taxonomic profiles, thus varying the proportions of CRISPR arrays specific to each included in the simulated metagenomes. For all detection methods, detected spacers specific to a genome decreased as the relative proportion of that taxon decreased, with roughly the same pattern for each method (<xref ref-type="fig" rid="fig-4">Fig. 4</xref>). As in the read length studies, MinCED consistently detected far more genome-specific spacers in the metagenomes than were originally present in the source genomes (<xref ref-type="fig" rid="fig-4">Fig. 4</xref>). This may account for its steeper increase in detected genome-specific spacers as the proportion of the corresponding genome in the simulated metagenomes increased.</p>
      <fig id="fig-4" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.3788/fig-4</object-id>
        <label>Figure 4</label>
        <caption>
          <title>Evaluation of MetaCRAST, Crass, and MinCED performance on simulated metagenomes with varying proportions of <italic>Ferroplasma acidarmanus</italic> fer1 and <italic>Leptospirillum</italic> sp. Group II ‘CF-1’ genome sequences.</title>
          <p>Simulated metagenomes were generated with Grinder. The data points shown represent the average number of “true positive” spacers detected that matched spacers in corresponding <italic>Ferroplasma</italic> or <italic>Leptospirillum</italic> CRISPR arrays (A and B, respectively). All data points represent the averages of six individual simulations and are presented with error bars representing two times the standard error above and two below the average. The true number of spacers expected for each genome is marked with a black line (20 expected in the <italic>Ferroplasma</italic> genome; 118 in the <italic>Leptospirillum</italic> genome).</p>
        </caption>
        <graphic xlink:href="peerj-05-3788-g004"/>
      </fig>
    </sec>
    <sec>
      <title>Evaluation of CRISPR spacer detection on real AMD and EBPR metagenomes</title>
      <p>We also evaluated MetaCRAST against Crass and MinCED using real AMD and EBPR metagenomes (<xref rid="ref-26" ref-type="bibr">Tyson et al., 2004</xref>; <xref rid="ref-18" ref-type="bibr">Martín et al., 2006</xref>). While taxonomy-guided queries consistently found fewer spacers than the other two methods (583 compared to 2,486 for Crass and 4,265 for MinCED in the AMD metagenome; 196 compared to 1,014 for Crass and 1,821 for MinCED in the EBPR metagenome), an assembly-guided MetaCRAST search identified more spacers than Crass did in the AMD metagenome (2,813 compared to 2,486—<xref ref-type="fig" rid="fig-5">Fig. 5A</xref>). In both AMD and EBPR metagenomes, many common spacers were detected amongst Crass, MetaCRAST (assembly-guided query), and MinCED (7.1% of all detected spacers for AMD and 2.5% for EBPR—<xref ref-type="fig" rid="fig-5">Figs. 5B</xref> and <xref ref-type="fig" rid="fig-5">5C</xref>). Despite this, there were also many spacers detected with Crass and MinCED not identified with MetaCRAST searches (<xref ref-type="fig" rid="fig-5">Figs. 5B</xref> and <xref ref-type="fig" rid="fig-5">5C</xref>). Notably, however, none of the spacers detected with MetaCRAST using the taxonomy-guided query overlapped with the Crass-detected spacers (<xref ref-type="fig" rid="fig-5">Figs. 5B</xref> and <xref ref-type="fig" rid="fig-5">5C</xref>), suggesting MetaCRAST can detect spacers missed by Crass given an appropriate taxonomy-guided query.</p>
      <fig id="fig-5" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.3788/fig-5</object-id>
        <label>Figure 5</label>
        <caption>
          <title>Evaluation of MetaCRAST, Crass, and MinCED on real AMD and EBPR metagenomes.</title>
          <p>(A) Total number of CRISPR spacers detected in real AMD and EBPR metagenomes using four different detection methods—Crass (<italic>de novo</italic>), MetaCRAST (using assembly-guided queries), MetaCRAST (using taxonomy-guided queries), and MinCED (<italic>de novo</italic>). Taxonomy-guided and assembly-guided queries are provided as <xref ref-type="supplementary-material" rid="supp-4">Tables S3</xref>–<xref ref-type="supplementary-material" rid="supp-5">S4</xref> and <xref ref-type="supplementary-material" rid="supp-7">S6</xref>–<xref ref-type="supplementary-material" rid="supp-8">S7</xref>. (B) Comparison of spacers detected in the real AMD metagenome using Crass (<italic>de novo</italic>), MetaCRAST (using taxonomy-guided queries), MetaCRAST (using assembly-guided queries), and MinCED (<italic>de novo</italic>). Comparison was performed using Venny 2.1 (<ext-link ext-link-type="uri" xlink:href="http://bioinfogp.cnb.csic.es/tools/venny/">http://bioinfogp.cnb.csic.es/tools/venny/</ext-link>). (C) Comparison of spacers detected in the real EBPR metagenome using the same methods as in (B) Comparison was performed using Venny 2.1.</p>
        </caption>
        <graphic xlink:href="peerj-05-3788-g005"/>
      </fig>
    </sec>
    <sec>
      <title>Evaluation of accuracy and runtime performance</title>
      <p>In addition to our studies comparing detected spacers over a variety of conditions, we evaluated all three detection methods for spacer detection accuracy and run time (<xref ref-type="fig" rid="fig-6">Figs. 6</xref> and <xref ref-type="fig" rid="fig-7">7</xref>). We performed these evaluations on the simulated AMD and EBPR metagenomes previously used to examine effects of read length and sequencing technology on CRISPR detection (<xref ref-type="fig" rid="fig-3">Fig. 3</xref>). For AMD metagenomes simulated with the 454 model, MinCED detected significantly more false positive spacers than Crass or MetaCRAST for average read lengths of 200 bp or more (<xref ref-type="fig" rid="fig-6">Fig. 6</xref>; <italic>p</italic> &lt; 0.05 using unpaired <italic>t</italic>-tests). Crass and MetaCRAST, on the other hand, did not have statistically significant differences in detected false positive spacers over the entire range of average read lengths (<italic>p</italic> &gt; 0.05 using unpaired <italic>t</italic>-tests). For the AMD Illumina metagenomes, on the other hand, MetaCRAST generated the largest number of false positive spacers for average read lengths greater than 200 bp (Crass for average read lengths of 150 bp and lower), but not by a statistically significant margin compared with MinCED (<italic>p</italic> &gt; 0.05 using unpaired <italic>t</italic>-tests). For the EBPR metagenomes simulated with the 454 model, there were remarkably few false positive spacers detected with all methods over the full range of average read lengths. For the EBPR Illumina metagenomes, MinCED generated the largest number of false positive spacers for average read lengths greater than 200 bp (Crass for average read lengths of 150 bp and lower), with MetaCRAST overlapping its pattern closely (<xref ref-type="fig" rid="fig-6">Fig. 6</xref>). Because of this overlap, differences between MinCED and MetaCRAST false positive spacers were not statistically significant (<italic>p</italic> &gt; 0.05 using unpaired <italic>t</italic>-tests), (EBPR Illumina metagenomes, <xref ref-type="fig" rid="fig-6">Fig. 6</xref>). MetaCRAST did detect more false positives than MinCED for the 200 bp read length (<italic>p</italic> &lt; 0.05 using unpaired <italic>t</italic>-tests, EBPR Illumina metagenomes, <xref ref-type="fig" rid="fig-6">Fig. 6</xref>). We note that these false positive spacers are only detected spacers that did not align to expected ones. The false positives do not necessarily include improperly truncated or extended spacers, which we suspect MinCED creates, leading to its artificially high spacer counts (<xref ref-type="fig" rid="fig-3">Fig. 3</xref>). We repeated this false positive spacer analysis using a weaker <italic>E</italic>-value threshold of 1e−1 (<xref ref-type="supplementary-material" rid="supp-1">Fig. S1</xref>). Using this weaker threshold decreased the number of false positive spacers identified in all conditions (<xref ref-type="supplementary-material" rid="supp-1">Fig. S1</xref>).</p>
      <fig id="fig-6" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.3788/fig-6</object-id>
        <label>Figure 6</label>
        <caption>
          <title>Evaluation of MetaCRAST, Crass, and MinCED false positive detection on simulated AMD (A and B) and EBPR (C and D) metagenomes.</title>
          <p>The procedure for generating the simulated metagenomes is described in Materials and Methods. The number of detected spacers matching expected ones was subtracted from the total number of spacers detected to determine the number of false positive spacers for a particular method and condition. All data points represent the averages of three individual simulations and are presented with error bars representing two times the standard error above and two below the average.</p>
        </caption>
        <graphic xlink:href="peerj-05-3788-g006"/>
      </fig>
      <fig id="fig-7" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.3788/fig-7</object-id>
        <label>Figure 7</label>
        <caption>
          <title>Evaluation of MetaCRAST, Crass, and MinCED run times on simulated AMD (A and B) and EBPR (C and D) metagenomes.</title>
          <p>We evaluated seven different combinations of algorithms, implementations, and parameters. We evaluated both Crass and MinCED with default parameters. For MetaCRAST, we evaluated five different conditions differing in parallelization and metagenome loading method—BioPerl loading and 16 threads, BioPerl and a single thread, readfq with mce_open for loading and 16 threads, readfq with mce_open and a single thread, and readfq with the standard open routine and a single thread. The procedure for generating the simulated metagenomes is described in Materials and Methods. Run time was calculated as the sum of the user and system time (together the total CPU time). All data points represent the averages of three individual simulations and are presented with error bars representing two times the standard error above and two below the average.</p>
        </caption>
        <graphic xlink:href="peerj-05-3788-g007"/>
      </fig>
      <p>We also evaluated relative speed of the detection methods using the Linux function <italic>time</italic>. We evaluated seven different combinations of algorithms, implementations, and parameters. We evaluated both Crass and MinCED with default parameters. For MetaCRAST, we evaluated five different conditions differing in parallelization and metagenome loading method—BioPerl for loading and 16 threads, BioPerl and a single thread, readfq with mce_open for loading and 16 threads, readfq with mce_open and a single thread, and readfq with the standard open routine and a single thread (<xref ref-type="fig" rid="fig-7">Fig. 7</xref>). We used CPU time (user and system time) rather than wall clock time (real time) as a measure of speed performance.</p>
      <p>We noticed steady increases in run time with increasing read length for all detection methods, metagenomes, and sequencing technologies (<xref ref-type="fig" rid="fig-7">Fig. 7</xref>). MetaCRAST showed a linear CPU time dependence on read length in all cases (<italic>R</italic><sup>2</sup> &gt; 0.98 in all cases; <italic>p</italic>-values calculated from Pearson correlation were less than 1e−5 in all cases), while linear correlations for MinCED and crass were much weaker (<italic>R</italic><sup>2</sup> &lt; 0.88 in all cases; <italic>p</italic>-values calculated from the Pearson correlations were more than 0.05 for Illumina datasets but between 9e−4 and 8e−3 for 454 datasets). Among MetaCRAST implementations, the readfq/open version used the least CPU time by statistically significant margins for all conditions (<xref ref-type="fig" rid="fig-7">Fig. 7</xref>; <italic>p</italic> &lt; 0.05 in all cases using unpaired <italic>t</italic>-tests). MetaCRAST was slower than Crass for all read lengths by statistically significant margins (<xref ref-type="fig" rid="fig-7">Fig. 7</xref>; <italic>p</italic> &lt; 0.05 in all cases using unpaired <italic>t</italic>-tests). On the other hand, it was faster than MinCED for 454 read lengths between 100 and 400 bp and Illumina read lengths between 100 and 250 bp (<xref ref-type="fig" rid="fig-7">Fig. 7</xref>; <italic>p</italic> &lt; 0.05 using unpaired <italic>t</italic>-tests).</p>
    </sec>
    <sec>
      <title>Taxonomic affiliations of CRISPR direct repeats annotated in CRISPRdb</title>
      <p>To analyze how direct repeats affiliated to taxa, we examined all direct repeats annotated in microbial genomes using the CRISPRdb database. We used a Perl script to assign taxonomy information based on GenBank accession using the module Bio::DB::GenBank. The results of this analysis for species (binomial name) and genus-level designations are presented in <xref ref-type="table" rid="table-2">Table 2</xref>. The average number of unique taxon designations per DR was greater at the species level than the genus level (1.308 compared to 1.063). Variation was also greater for species-level designations compared to genus-level (standard deviation of 1.567 compared 0.521). Both species- and genus-level analyses identified DRs that were affiliated to many taxa (a maximum of 20 genuses and 46 species). We acknowledge that our analysis does not examine the number of unique DRs per taxon. It also only considers independent, unique DRs, ignoring the possibility that many unique DRs may have closely related sequences.</p>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>In this work, we present and evaluate a novel reference-guided method for CRISPR detection in unassembled metagenomic reads. This method searches metagenomic reads for user-specified direct repeats which could be provided through taxonomy- or assembly-guided searches (<xref ref-type="fig" rid="fig-1">Figs. 1</xref> and <xref ref-type="fig" rid="fig-2">2</xref>). We analyzed currently known DRs with respect to their taxonomic designations to determine the robustness of taxonomy-guided searches (<xref ref-type="table" rid="table-2">Table 2</xref>). We found that most DRs in fact do affiliate to a single species or genus, but there are exceptions that may have arisen through horizontal gene transfer (<xref ref-type="table" rid="table-2">Table 2</xref>). This analysis does not consider small polymorphisms between closely related DRs. Depending on the circumstance, it may be important to consider whether one DR could be present in multiple taxa found in a sample.</p>
    <p>Our studies of simulated metagenomes show distinct advantages for Crass and MetaCRAST depending on average read length (<xref ref-type="fig" rid="fig-3">Fig. 3</xref>). While the modified assembly procedure and exhaustive searches Crass provides make it well suited for short read 454 and Illumina metagenomes, MetaCRAST outperforms Crass for long read Illumina metagenomes (<xref ref-type="fig" rid="fig-3">Fig. 3</xref>). We speculate that heuristics to avoid misassembly of CRISPR arrays or improper repeat detection may hinder Crass in these long-read Illumina metagenomes. We also noted that all three algorithms detected far more spacers in 454 compared to Illumina metagenomes (<xref ref-type="fig" rid="fig-3">Fig. 3</xref>). We have two possible explanations for this phenomenon. First, our algorithms may have handled homopolymer error better than the substitution error simulated in the Illumina metagenomes. Second, our Illumina model may have introduced higher error rates than the 454 error model, making it more difficult to find multiple similar DRs in the reads. The very high numbers of MinCED-detected spacers are deceptive because this algorithm has the potential for substantial errors in determining repeat and spacer lengths (<xref ref-type="fig" rid="fig-3">Figs. 3</xref> and <xref ref-type="fig" rid="fig-4">4</xref>). Inconsistencies in defining repeat length leads to false splitting of identical spacers into different groups.</p>
    <p>Studies on real metagenomes suggest substantial advantages for Crass and MinCED in terms of numbers of detected spacers (<xref ref-type="fig" rid="fig-5">Fig. 5</xref>). While in most cases MetaCRAST detected fewer spacers than Crass or MinCED, it did identify spacers unique to those from the two other methods. This suggests that it can complement these methods, finding spacers missed due to the heuristics that Crass and MinCED use to avoid false positives (<xref ref-type="fig" rid="fig-5">Fig. 5</xref>). We had expected that MetaCRAST would underperform compared to Crass and MinCED in these real metagenomes, because the taxonomy-guided queries we used did not fully account for all the taxa found with taxonomic profiling. We only used one or two genomes to simulate the AMD and EBPR metagenomes, making the simulated metagenomes much simpler in taxonomic diversity. This simplification was what made MetaCRAST detection performance comparable to that of Crass and MinCED for the simulations.</p>
    <p>Accuracy was roughly similar amongst the three tools (<xref ref-type="fig" rid="fig-6">Fig. 6</xref>). Relaxing the error threshold reduced false positive spacers detected by all tools, suggesting sequencing error rather than algorithm issues could account for some of these false positive spacers (<xref ref-type="supplementary-material" rid="supp-1">Fig. S1</xref>). MetaCRAST follows the same pattern of increasing run time with average read length as the other two tools, and it is comparable in run time to MinCED (<xref ref-type="fig" rid="fig-7">Fig. 7</xref>). MetaCRAST run time increases linearly with average read length (<xref ref-type="fig" rid="fig-7">Fig. 7</xref>). We acknowledge that implementation of the algorithm in a compiled language or increasing the number of threads used to parallelize the search could further improve MetaCRAST speed. Nonetheless, while MetaCRAST is not as fast as the compiled program Crass under the conditions tested, it does identify spacers distinct from these methods in real metagenomes and outperforms it in overall spacer detection for simulated Illumina metagenomes.</p>
    <p>Recent studies of computational methods for determining phage-host interactions suggest CRISPR spacer alignment is a highly accurate signature of phage-host interaction but that most identified CRISPR spacers do not align to known phage genomes (<xref rid="ref-9" ref-type="bibr">Edwards et al., 2015</xref>). This suggests that it is critical to improve metagenomic CRISPR spacer detection to increase the chances of matching spacers to viral genomes. More broadly, increasing spacer matching would provide a fuller appreciation of a microbial ecosystem’s phage-host interaction space. We have recently used MetaCRAST to improve our determination of virus-host interactions in solar salterns (<xref rid="ref-19" ref-type="bibr">Moller &amp; Liang, 2017</xref>), complementing Crass with our spacer detection method. MetaCRAST complements <italic>de novo</italic> methods like Crass because it avoids the heuristics they use to reduce false positive spacers. Using a targeted direct repeat query, our tool can avoid the false negative bias of these approaches. We anticipate that MetaCRAST will be of great interest to microbial ecologists interested in phage-host interactions because it complements existing <italic>de novo</italic> methods to improve metagenomic CRISPR detection.</p>
  </sec>
  <sec sec-type="supplementary-material" id="supplemental-information">
    <title> Supplemental Information</title>
    <supplementary-material content-type="local-data" id="supp-1">
      <object-id pub-id-type="doi">10.7717/peerj.3788/supp-1</object-id>
      <label>Figure S1</label>
      <caption>
        <title>Evaluation of MetaCRAST, Crass, and MinCED false positive detection on simulated AMD and EBPR metagenomes</title>
        <p>The procedure for generating the simulated metagenomes is described in Materials and Methods. The <italic>E</italic>-value threshold used for alignment of detected spacers against expected spacers was 1e−1. The number of detected spacers matching expected ones was subtracted from the total number of spacers detected to determine the number of false positive spacers for a particular method and condition. All data points represent the averages of three individual simulations and are presented with error bars representing two times the standard error above and two below the average.</p>
      </caption>
      <media xlink:href="peerj-05-3788-s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-2">
      <object-id pub-id-type="doi">10.7717/peerj.3788/supp-2</object-id>
      <label>Table S1</label>
      <caption>
        <title>Profile used to generate simulated AMD metagenomes using Grinder</title>
        <p>All simulated metagenomes contained 100,000 reads. 454 metagenomes were generated with this command: grinder—reference_file AMDgenomes.fasta—abundance_file AMDprofile.txt -total_reads 100000 -read_dist (one of 100, 150, 200, 250, 300, 400, or 600) normal 50 -homopolymer_dist balzer. All 454 read length distributions were normal with a standard deviation of 50 bp. Illumina metagenomes were generated with this command: grinder -reference_file AMDgenomes.fasta -abundance_file AMDprofile.txt -total_reads 100000 -read_dist (one of 100, 150, 200, 250, or 300) -md poly4 3e−3 3.3e−8. All Illumina read length distributions were uniform with all reads having exactly the average read length.</p>
      </caption>
      <media xlink:href="peerj-05-3788-s002.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-3">
      <object-id pub-id-type="doi">10.7717/peerj.3788/supp-3</object-id>
      <label>Table S2</label>
      <caption>
        <title>Profile used to generate simulated EBPR metagenomes using Grinder</title>
        <p>All simulated metagenomes contained 100,000 reads. 454 metagenomes were generated with this command: grinder -reference_file EBPRgenomes.fasta—abundance_file EBPRprofile.txt -total_reads 100000 -read_dist (one of 100, 150, 200, 250, 300, 400, or 600) normal 50 -homopolymer_dist balzer. All 454 read length distributions were normal with a standard deviation of 50 bp. Illumina metagenomes were generated with this command: grinder -reference_file EBPRgenomes.fasta -abundance_file EBPRprofile.txt -total_reads 100000 -read_dist (one of 100, 150, 200, 250, or 300) -md poly4 3e−3 3.3e−8. All Illumina read length distributions were uniform with all reads having exactly the average read length.</p>
      </caption>
      <media xlink:href="peerj-05-3788-s003.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-4">
      <object-id pub-id-type="doi">10.7717/peerj.3788/supp-4</object-id>
      <label>Table S4</label>
      <caption>
        <title>Taxonomy-guided query used for real AMD metagenome</title>
        <p>Direct repeats were obtained from CRISPRdb tables of CRISPRs detected in the listed microbial genomes. The <italic>Leptospirillum</italic> sp. Group IV ‘UBA BS’ direct repeat was detected in the listed assembly using CRISPRFinder and was not found in CRISPRdb.</p>
      </caption>
      <media xlink:href="peerj-05-3788-s004.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-5">
      <object-id pub-id-type="doi">10.7717/peerj.3788/supp-5</object-id>
      <label>Table S4</label>
      <caption>
        <title>Taxonomy-guided query used for the real EBPR metagenome</title>
        <p>Direct repeats were obtained from CRISPRdb tables of CRISPRs detected in the listed microbial genomes.</p>
      </caption>
      <media xlink:href="peerj-05-3788-s005.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-6">
      <object-id pub-id-type="doi">10.7717/peerj.3788/supp-6</object-id>
      <label>Table S5</label>
      <caption>
        <title>Details about the AMD and EBPR metagenomes used for evaluation of the tools</title>
        <p>The AMD metagenome was downloaded from <ext-link ext-link-type="uri" xlink:href="http://data.imicrobe.us/project/view/1">http://data.imicrobe.us/project/view/1</ext-link>, while the EBPR metagenome was downloaded from <ext-link ext-link-type="uri" xlink:href="http://data.imicrobe.us/project/view/22">http://data.imicrobe.us/project/view/22</ext-link>.</p>
      </caption>
      <media xlink:href="peerj-05-3788-s006.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-7">
      <object-id pub-id-type="doi">10.7717/peerj.3788/supp-7</object-id>
      <label>Table S6</label>
      <caption>
        <title>Assembly-guided query used for the real AMD metagenome</title>
        <p>CAP3 assembled AMD reads into contigs with default parameters. CRISPR DRs were detected in CAP3 contigs using PILER-CR. The DRs clustered with a similarity threshold of 0.9 were then used to search the real AMD metagenome.</p>
      </caption>
      <media xlink:href="peerj-05-3788-s007.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-8">
      <object-id pub-id-type="doi">10.7717/peerj.3788/supp-8</object-id>
      <label>Table S7</label>
      <caption>
        <title>Assembly-guided query used for the real EBPR metagenome</title>
        <p>CAP3 assembled EBPR reads into contigs with default parameters. CRISPR DRs were detected in CAP3 contigs using PILER-CR. The DRs clustered with a similarity threshold of 0.9 were then used to search the real EBPR metagenome.</p>
      </caption>
      <media xlink:href="peerj-05-3788-s008.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-9">
      <object-id pub-id-type="doi">10.7717/peerj.3788/supp-9</object-id>
      <label>Table S8</label>
      <caption>
        <title>Taxonomic profile of the real AMD metagenome determined using MetaPhyler</title>
      </caption>
      <media xlink:href="peerj-05-3788-s009.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-10">
      <object-id pub-id-type="doi">10.7717/peerj.3788/supp-10</object-id>
      <label>Table S9</label>
      <caption>
        <title>Taxonomic profile of the real EBPR metagenome determined using MetaPhyler</title>
      </caption>
      <media xlink:href="peerj-05-3788-s010.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>Thanks to Michael Crowder and Gary Lorigan (Miami University) for feedback on the project and manuscript.</p>
  </ack>
  <sec sec-type="additional-information">
    <title>Additional Information and Declarations</title>
    <fn-group content-type="competing-interests">
      <title>Competing Interests</title>
      <fn id="conflict-1" fn-type="COI-statement">
        <p>Chun Liang is an Academic Editor for PeerJ.</p>
      </fn>
    </fn-group>
    <fn-group content-type="author-contributions">
      <title>Author Contributions</title>
      <fn id="contribution-1" fn-type="con">
        <p><xref ref-type="contrib" rid="author-1">Abraham G. Moller</xref> conceived and designed the experiments, performed the experiments, analyzed the data, contributed reagents/materials/analysis tools, wrote the paper, prepared figures and/or tables, reviewed drafts of the paper.</p>
      </fn>
      <fn id="contribution-2" fn-type="con">
        <p><xref ref-type="contrib" rid="author-2">Chun Liang</xref> conceived and designed the experiments, contributed reagents/materials/analysis tools, wrote the paper, prepared figures and/or tables, reviewed drafts of the paper.</p>
      </fn>
    </fn-group>
    <fn-group content-type="other">
      <title>Data Availability</title>
      <fn id="addinfo-1">
        <p>The following information was supplied regarding data availability:</p>
        <p>GitHub: <ext-link ext-link-type="uri" xlink:href="https://github.com/molleraj/MetaCRAST">https://github.com/molleraj/MetaCRAST</ext-link>.</p>
      </fn>
    </fn-group>
  </sec>
  <ref-list content-type="authoryear">
    <title>References</title>
    <ref id="ref-1">
      <label>Altschul et al. (1990)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Gish</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <year>1990</year>
        <article-title>Basic local alignment search tool</article-title>
        <source>Journal of Molecular Biology</source>
        <volume>215</volume>
        <fpage>403</fpage>
        <lpage>410</lpage>
        <pub-id pub-id-type="doi">10.1016/S0022-2836(05)80360-2</pub-id>
        <pub-id pub-id-type="pmid">2231712</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-2">
      <label>Anderson, Brazelton &amp; Baross (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anderson</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Brazelton</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Baross</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <year>2011</year>
        <article-title>Using CRISPRs as a metagenomic tool to identify microbial hosts of a diffuse flow hydrothermal vent viral assemblage: CRISPR spacers reveal hosts of marine vent viral assemblage</article-title>
        <source>FEMS Microbiology Ecology</source>
        <volume>77</volume>
        <fpage>120</fpage>
        <lpage>133</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1574-6941.2011.01090.x</pub-id>
        <pub-id pub-id-type="pmid">21410492</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-3">
      <label>Angly et al. (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Angly</surname>
            <given-names>FE</given-names>
          </name>
          <name>
            <surname>Willner</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rohwer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tyson</surname>
            <given-names>GW</given-names>
          </name>
        </person-group>
        <year>2012</year>
        <article-title>Grinder: a versatile amplicon and shotgun sequence simulator</article-title>
        <source>Nucleic Acids Research</source>
        <volume>40</volume>
        <fpage>e94</fpage>
        <lpage>e94</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks251</pub-id>
        <pub-id pub-id-type="pmid">22434876</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-4">
      <label>Balzer et al. (2010)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Balzer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Malde</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lanzén</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sharma</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jonassen</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <year>2010</year>
        <article-title>Characteristics of 454 pyrosequencing data—enabling realistic simulation with flowsim</article-title>
        <source>Bioinformatics</source>
        <volume>26</volume>
        <fpage>i420</fpage>
        <lpage>i425</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq365</pub-id>
        <pub-id pub-id-type="pmid">20823302</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-5">
      <label>Biswas et al. (2016)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Biswas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Staals</surname>
            <given-names>RHJ</given-names>
          </name>
          <name>
            <surname>Morales</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Fineran</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <year>2016</year>
        <article-title>CRISPRDetect: A flexible algorithm to define CRISPR arrays</article-title>
        <source>BMC Genomics</source>
        <volume>17</volume>
        <fpage>356</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-016-2627-0</pub-id>
        <pub-id pub-id-type="pmid">27184979</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-6">
      <label>Bland et al. (2007)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bland</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ramsey</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Sabree</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Lowe</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kyrpides</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>CRISPR Recognition Tool (CRT): a tool for automatic detection of clustered regularly interspaced palindromic repeats</article-title>
        <source>BMC Bioinformatics</source>
        <volume>8</volume>
        <fpage>209</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-8-209</pub-id>
        <pub-id pub-id-type="pmid">17577412</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-7">
      <label>Dohm et al. (2008)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dohm</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Lottaz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Borodina</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Himmelbauer</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Substantial biases in ultra-short read data sets from high-throughput DNA sequencing</article-title>
        <source>Nucleic Acids Research</source>
        <volume>36</volume>
        <fpage>e105</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkn425</pub-id>
        <pub-id pub-id-type="pmid">18660515</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-8">
      <label>Edgar (2007)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>PILER-CR: fast and accurate identification of CRISPR repeats</article-title>
        <source>BMC Bioinformatics</source>
        <volume>8</volume>
        <fpage>18</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-8-18</pub-id>
        <pub-id pub-id-type="pmid">17239253</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-9">
      <label>Edwards et al. (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edwards</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>McNair</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Faust</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Raes</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dutilh</surname>
            <given-names>BE</given-names>
          </name>
        </person-group>
        <year>2015</year>
        <article-title>Computational approaches to predict bacteriophage—host relationships</article-title>
        <source>FEMS Microbiology Reviews</source>
        <volume>40</volume>
        <issue>2</issue>
        <fpage>258</fpage>
        <lpage>272</lpage>
        <pub-id pub-id-type="doi">10.1093/femsre/fuv048</pub-id>
        <pub-id pub-id-type="pmid">26657537</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-10">
      <label>Grissa, Vergnaud &amp; Pourcel (2007a)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grissa</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Vergnaud</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Pourcel</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <year>2007a</year>
        <article-title>The CRISPRdb database and tools to display CRISPRs and to generate dictionaries of spacers and repeats</article-title>
        <source>BMC Bioinformatics</source>
        <volume>8</volume>
        <fpage>172</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-8-172</pub-id>
        <pub-id pub-id-type="pmid">17521438</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-11">
      <label>Grissa, Vergnaud &amp; Pourcel (2007b)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grissa</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Vergnaud</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Pourcel</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <year>2007b</year>
        <article-title>CRISPRFinder: a web tool to identify clustered regularly interspaced short palindromic repeats</article-title>
        <source>Nucleic Acids Research</source>
        <volume>35</volume>
        <fpage>W52</fpage>
        <lpage>W57</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkm360</pub-id>
        <pub-id pub-id-type="pmid">17537822</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-12">
      <label>Huang &amp; Madan (1999)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Madan</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <year>1999</year>
        <article-title>CAP3: a DNA sequence assembly program</article-title>
        <source>Genome Research</source>
        <volume>9</volume>
        <fpage>868</fpage>
        <lpage>877</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.9.9.868</pub-id>
        <pub-id pub-id-type="pmid">10508846</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-13">
      <label>Hurwitz (2014)</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Hurwitz</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <year>2014</year>
        <article-title>iMicrobe: advancing clinical and environmental microbial research using the iPlant cyberinfrastructure</article-title>
        <conf-name>Plant and animal genome XXII conference</conf-name>
        <conf-sponsor>Scherago International</conf-sponsor>
        <conf-loc>San Diego</conf-loc>
      </element-citation>
    </ref>
    <ref id="ref-14">
      <label>Korbel et al. (2009)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Korbel</surname>
            <given-names>JO</given-names>
          </name>
          <name>
            <surname>Abyzov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mu</surname>
            <given-names>XJ</given-names>
          </name>
          <name>
            <surname>Carriero</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Cayting</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>MB</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>PEMer: a computational framework with simulation-based error models for inferring genomic structural variants from massive paired-end sequencing data</article-title>
        <source>Genome Biology</source>
        <volume>10</volume>
        <issue>2</issue>
        <comment>Article R23</comment>
        <pub-id pub-id-type="doi">10.1186/gb-2009-10-2-r23</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-15">
      <label>Li &amp; Godzik (2006)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Godzik</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>Cd-hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <volume>22</volume>
        <fpage>1658</fpage>
        <lpage>1659</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl158</pub-id>
        <pub-id pub-id-type="pmid">16731699</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-16">
      <label>Liu et al. (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gibbons</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ghodsi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Treangen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <year>2011</year>
        <article-title>Accurate and fast estimation of taxonomic profiles from metagenomic shotgun sequences</article-title>
        <source>BMC Genomics</source>
        <volume>12</volume>
        <fpage>S4</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-12-S2-S4</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-17">
      <label>Makarova, Wolf &amp; Koonin (2013)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Makarova</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Wolf</surname>
            <given-names>YI</given-names>
          </name>
          <name>
            <surname>Koonin</surname>
            <given-names>EV</given-names>
          </name>
        </person-group>
        <year>2013</year>
        <article-title>Comparative genomics of defense systems in archaea and bacteria</article-title>
        <source>Nucleic Acids Research</source>
        <volume>41</volume>
        <fpage>4360</fpage>
        <lpage>4377</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt157</pub-id>
        <pub-id pub-id-type="pmid">23470997</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-18">
      <label>Martín et al. (2006)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martín</surname>
            <given-names>HG</given-names>
          </name>
          <name>
            <surname>Ivanova</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Kunin</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Warnecke</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Barry</surname>
            <given-names>KW</given-names>
          </name>
          <name>
            <surname>McHardy</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Yeates</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Salamov</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Szeto</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Dalin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Putnam</surname>
            <given-names>NH</given-names>
          </name>
          <name>
            <surname>Shapiro</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Pangilinan</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Rigoutsos</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Kyrpides</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Blackall</surname>
            <given-names>LL</given-names>
          </name>
          <name>
            <surname>McMahon</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>Metagenomic analysis of two enhanced biological phosphorus removal (EBPR) sludge communities</article-title>
        <source>Nature Biotechnology</source>
        <volume>24</volume>
        <fpage>1263</fpage>
        <lpage>1269</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt1247</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-19">
      <label>Moller &amp; Liang (2017)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moller</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <year>2017</year>
        <article-title>Determining virus-host interactions and glycerol metabolism profiles in geographically diverse solar salterns with metagenomics</article-title>
        <source>PeerJ</source>
        <volume>5</volume>
        <elocation-id>e2844</elocation-id>
        <pub-id pub-id-type="doi">10.7717/peerj.2844</pub-id>
        <pub-id pub-id-type="pmid">28097058</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-20">
      <label>Rho et al. (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rho</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Y-W</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Doak</surname>
            <given-names>TG</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <year>2012</year>
        <article-title>Diverse CRISPRs Evolving in Human Microbiomes</article-title>
        <source>PLOS Genetics</source>
        <volume>8</volume>
        <elocation-id>e1002441</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1002441</pub-id>
        <pub-id pub-id-type="pmid">22719260</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-21">
      <label>Rousseau et al. (2009)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rousseau</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gonnet</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Romancer</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Nicolas</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>CRISPI: a CRISPR interactive database</article-title>
        <source>Bioinformatics</source>
        <volume>25</volume>
        <fpage>3317</fpage>
        <lpage>3318</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp586</pub-id>
        <pub-id pub-id-type="pmid">19846435</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-22">
      <label>Sanguino et al. (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sanguino</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Franqueville</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Vogel</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Larose</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <year>2015</year>
        <article-title>Linking environmental prokaryotic viruses and their host through CRISPRs</article-title>
        <source>FEMS Microbiology Ecology</source>
        <volume>91</volume>
        <issue>5</issue>
        <comment>Article fiv046</comment>
        <pub-id pub-id-type="doi">10.1093/femsec/fiv046</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-23">
      <label>Skennerton (2006)</label>
      <element-citation publication-type="data">
        <person-group person-group-type="author">
          <name>
            <surname>Skennerton</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <year>2016</year>
        <data-title>Minced—mining CRISPRs in environmental datasets</data-title>
        <uri xlink:href="https://github.com/ctSkennerton/minced">https://github.com/ctSkennerton/minced</uri>
        <date-in-citation content-type="access-date" iso-8601-date="2016-03-27">27 May 2016</date-in-citation>
      </element-citation>
    </ref>
    <ref id="ref-24">
      <label>Skennerton, Imelfort &amp; Tyson (2013)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Skennerton</surname>
            <given-names>CT</given-names>
          </name>
          <name>
            <surname>Imelfort</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tyson</surname>
            <given-names>GW</given-names>
          </name>
        </person-group>
        <year>2013</year>
        <article-title>Crass: identification and reconstruction of CRISPR from unassembled metagenomic data</article-title>
        <source>Nucleic Acids Research</source>
        <volume>41</volume>
        <elocation-id>e105</elocation-id>
        <pub-id pub-id-type="doi">10.1093/nar/gkt183</pub-id>
        <pub-id pub-id-type="pmid">23511966</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-25">
      <label>Sorek, Kunin &amp; Hugenholtz (2008)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sorek</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kunin</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>CRISPR—a widespread system that provides acquired resistance against phages in bacteria and archaea</article-title>
        <source>Nature Reviews Microbiology</source>
        <volume>6</volume>
        <fpage>181</fpage>
        <lpage>186</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro1793</pub-id>
        <pub-id pub-id-type="pmid">18157154</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-26">
      <label>Tyson et al. (2004)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tyson</surname>
            <given-names>GW</given-names>
          </name>
          <name>
            <surname>Chapman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Ram</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Solovyev</surname>
            <given-names>VV</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Rokhsar</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Banfield</surname>
            <given-names>JF</given-names>
          </name>
        </person-group>
        <year>2004</year>
        <article-title>Community structure and metabolism through reconstruction of microbial genomes from the environment</article-title>
        <source>Nature</source>
        <volume>428</volume>
        <fpage>37</fpage>
        <lpage>43</lpage>
        <pub-id pub-id-type="doi">10.1038/nature02340</pub-id>
        <pub-id pub-id-type="pmid">14961025</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-27">
      <label>Wang &amp; Liang (2017)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <year>2017</year>
        <article-title>CRF: detection of CRISPR arrays using random forest</article-title>
        <source>PeerJ</source>
        <volume>5</volume>
        <elocation-id>e3219</elocation-id>
        <pub-id pub-id-type="doi">10.7717/peerj.3219</pub-id>
        <pub-id pub-id-type="pmid">28462029</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-28">
      <label>Weitz &amp; Wilhelm (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weitz</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Wilhelm</surname>
            <given-names>SW</given-names>
          </name>
        </person-group>
        <year>2012</year>
        <article-title>Ocean viruses and their effects on microbial communities and biogeochemical cycles</article-title>
        <source>F1000 Biology Reports</source>
        <volume>4</volume>
        <comment>Article 17</comment>
        <pub-id pub-id-type="doi">10.3410/B4-17</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-29">
      <label>Wu, Manber &amp; Myers (1995)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Manber</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <year>1995</year>
        <article-title>A subquadratic algorithm for approximate regular expression matching</article-title>
        <source>Journal of Algorithms</source>
        <volume>19</volume>
        <fpage>346</fpage>
        <lpage>360</lpage>
        <pub-id pub-id-type="doi">10.1006/jagm.1995.1041</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-30">
      <label>Zhang &amp; Ye (2017)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <year>2017</year>
        <article-title>Not all predicted CRISPR—Cas systems are equal: isolated cas genes and classes of CRISPR like elements</article-title>
        <source>BMC Bioinformatics</source>
        <volume>18</volume>
        <fpage>92</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-017-1512-4</pub-id>
        <pub-id pub-id-type="pmid">28166719</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
