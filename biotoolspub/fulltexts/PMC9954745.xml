<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.3 20210610//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1-3.dtd?>
<?SourceDTD.Version 1.3?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Cells</journal-id>
    <journal-id journal-id-type="iso-abbrev">Cells</journal-id>
    <journal-id journal-id-type="publisher-id">cells</journal-id>
    <journal-title-group>
      <journal-title>Cells</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2073-4409</issn>
    <publisher>
      <publisher-name>MDPI</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9954745</article-id>
    <article-id pub-id-type="doi">10.3390/cells12040604</article-id>
    <article-id pub-id-type="publisher-id">cells-12-00604</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SINFONIA: Scalable Identification of Spatially Variable Genes for Deciphering Spatial Domains</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Jiang</surname>
          <given-names>Rui</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org/" vocab-term="Conceptualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org/" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org/" vocab-term="Validation" vocab-term-identifier="https://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org/" vocab-term="Writing – review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org/" vocab-term="Funding acquisition" vocab-term-identifier="https://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <xref rid="af1-cells-12-00604" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Zhen</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org/" vocab-term="Validation" vocab-term-identifier="https://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org/" vocab-term="Resources" vocab-term-identifier="https://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org/" vocab-term="Data curation" vocab-term-identifier="https://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <xref rid="af1-cells-12-00604" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jia</surname>
          <given-names>Yuhang</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org/" vocab-term="Visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <xref rid="af2-cells-12-00604" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Siyu</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org/" vocab-term="Visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <xref rid="af2-cells-12-00604" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-3503-9306</contrib-id>
        <name>
          <surname>Chen</surname>
          <given-names>Shengquan</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org/" vocab-term="Conceptualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org/" vocab-term="Software" vocab-term-identifier="https://credit.niso.org/contributor-roles/software/">Software</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org/" vocab-term="Validation" vocab-term-identifier="https://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org/" vocab-term="Formal analysis" vocab-term-identifier="https://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org/" vocab-term="Investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org/" vocab-term="Writing – original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org/" vocab-term="Writing – review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org/" vocab-term="Supervision" vocab-term-identifier="https://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org/" vocab-term="Project administration" vocab-term-identifier="https://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org/" vocab-term="Funding acquisition" vocab-term-identifier="https://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <xref rid="af3-cells-12-00604" ref-type="aff">3</xref>
        <xref rid="c1-cells-12-00604" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kim</surname>
          <given-names>Sang Woo</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <aff id="af1-cells-12-00604"><label>1</label>MOE Key Laboratory of Bioinformatics and Bioinformatics Division, BNRIST/Department of Automation, Tsinghua University, Beijing 100084, China</aff>
    <aff id="af2-cells-12-00604"><label>2</label>School of Statistics and Data Science, Nankai University, Tianjin 300071, China</aff>
    <aff id="af3-cells-12-00604"><label>3</label>School of Mathematical Sciences and LPMC, Nankai University, Tianjin 300071, China</aff>
    <author-notes>
      <corresp id="c1-cells-12-00604"><label>*</label>Correspondence: <email>chenshengquan@nankai.edu.cn</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>2</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2023</year>
    </pub-date>
    <volume>12</volume>
    <issue>4</issue>
    <elocation-id>604</elocation-id>
    <history>
      <date date-type="received">
        <day>04</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>29</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>07</day>
        <month>2</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2023 by the authors.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>Licensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC BY) license (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>).</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Recent advances in spatial transcriptomics have revolutionized the understanding of tissue organization. The identification of spatially variable genes (SVGs) is an essential step for downstream spatial domain characterization. Although several methods have been proposed for identifying SVGs, inadequate ability to decipher spatial domains, poor efficiency, and insufficient interoperability with existing standard analysis workflows still impede the applications of these methods. Here we propose SINFONIA, a scalable method for identifying spatially variable genes via ensemble strategies. Implemented in Python, SINFONIA can be seamlessly integrated into existing analysis workflows. Using 15 spatial transcriptomic datasets generated with different protocols and with different sizes, dimensions and qualities, we show the advantage of SINFONIA over three baseline methods and two variants via systematic evaluation of spatial clustering, domain resolution, latent representation, spatial visualization, and computational efficiency with 21 quantitative metrics. Additionally, SINFONIA is robust relative to the choice of the number of SVGs. We anticipate SINFONIA will facilitate the analysis of spatial transcriptomics.</p>
    </abstract>
    <kwd-group>
      <kwd>spatial transcriptomics</kwd>
      <kwd>spatial autocorrelation</kwd>
      <kwd>spatially variable genes</kwd>
      <kwd>spatial domains</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>National Key Research and Development Program of China</funding-source>
        <award-id>2021YFF1200902</award-id>
      </award-group>
      <award-group>
        <funding-source>National Natural Science Foundation of China</funding-source>
        <award-id>62203236</award-id>
        <award-id>62273194</award-id>
        <award-id>61873141</award-id>
        <award-id>61721003</award-id>
      </award-group>
      <funding-statement>This research was funded by the National Key Research and Development Program of China, grant number 2021YFF1200902, and the National Natural Science Foundation of China, grant numbers 62203236, 62273194, 61873141 and 61721003.</funding-statement>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="sec1-cells-12-00604">
    <title>1. Introduction</title>
    <p>Spatially resolved transcriptomics grants us a unique perspective on coherent spatial and gene expression patterns and hence allows for insights into the molecular organization of tissues. Advanced technologies for spatial transcriptomics (STs) have enabled genome-wide profiling of expression levels, demanding scalable methods that take advantage of spatial context to facilitate the identification of spatially variable genes (SVGs), which is regarded as the first critical step in ST data analysis [<xref rid="B1-cells-12-00604" ref-type="bibr">1</xref>]. We note that the task of SVG identification, an essential step before spatial domain characterization, is different from that of spatial pattern visualization and detected-gene evaluation, which are performed after spatial domain characterization, and that the former aims to select individual genes and visualize the expression of the gene in different spatial domains [<xref rid="B2-cells-12-00604" ref-type="bibr">2</xref>,<xref rid="B3-cells-12-00604" ref-type="bibr">3</xref>], while the latter aims to evaluate the differentially expressed genes between different spatial domains [<xref rid="B4-cells-12-00604" ref-type="bibr">4</xref>,<xref rid="B5-cells-12-00604" ref-type="bibr">5</xref>].</p>
    <p>Li et al. have provided a survey of computational methods for SVG detection, including eight tools implemented in R and five tools implemented in Python [<xref rid="B6-cells-12-00604" ref-type="bibr">6</xref>]. In recent years, many researchers have preferred to analyze data in Python due to its attractive syntax and highly optimized scientific computing libraries for machine learning [<xref rid="B7-cells-12-00604" ref-type="bibr">7</xref>]. Additionally, in the single-cell community, a number of advanced frameworks have been implemented in Python, such as Scanpy [<xref rid="B8-cells-12-00604" ref-type="bibr">8</xref>], scvi-tools [<xref rid="B9-cells-12-00604" ref-type="bibr">9</xref>] and Squidy [<xref rid="B3-cells-12-00604" ref-type="bibr">3</xref>], suggesting the wide acceptance of Python in single-cell studies. In this study, we focus on Python-based methods and aim to provide an effective and scalable method for the Python community.</p>
    <p>Among the tools implemented in Python, SPADE integrates high-level image features and spatial transcriptomes to identify genes that show rich patterns in morphological context [<xref rid="B10-cells-12-00604" ref-type="bibr">10</xref>]. SpatialDE decomposes the variation of each gene into spatial and nonspatial components and identifies SVGs through the comparison between the full model and a model without spatial random effect term [<xref rid="B1-cells-12-00604" ref-type="bibr">1</xref>]. GPcounts is built on a Gaussian process regression model and utilizes a negative binomial likelihood function to model the temporal and spatial variations in gene expression profiles [<xref rid="B11-cells-12-00604" ref-type="bibr">11</xref>]. SOMDE first clusters the neighboring cells into separated nodes based on the self-organizing map (SOM), and then fits the node-level gene expression variation with a Gaussian process to identify SVGs [<xref rid="B12-cells-12-00604" ref-type="bibr">12</xref>]. HMRF uses hidden Markov random fields to identify spatial domains based on cross-platform cell-type mapping [<xref rid="B13-cells-12-00604" ref-type="bibr">13</xref>].</p>
    <p>However, these methods are still impeded by relatively low effectiveness and scalability. Additionally, considering that many newly developed methods for STs (e.g., STAGATE [<xref rid="B14-cells-12-00604" ref-type="bibr">14</xref>], stPlus [<xref rid="B15-cells-12-00604" ref-type="bibr">15</xref>], Squidpy [<xref rid="B3-cells-12-00604" ref-type="bibr">3</xref>]) are built on the AnnData format and can be seamlessly integrated into the SCANPY workflow [<xref rid="B8-cells-12-00604" ref-type="bibr">8</xref>], new tools should provide interoperability with AnnData and SCANPY. In addition, the performance of the identified SVGs for deciphering spatial domains still lacks systematic, and especially quantitative, evaluation using the ST datasets with a gold standard.</p>
    <p>Spatial autocorrelation statistics, such as Moran’s <italic toggle="yes">I</italic> and Geary’s <italic toggle="yes">C</italic>, have been adopted to select individual genes for spatial pattern visualization (e.g., Seurat [<xref rid="B2-cells-12-00604" ref-type="bibr">2</xref>] and Squidpy [<xref rid="B3-cells-12-00604" ref-type="bibr">3</xref>]), and to quantify the existence of spatial patterns of detected genes (e.g., SpaGE [<xref rid="B4-cells-12-00604" ref-type="bibr">4</xref>] and SpaGCN [<xref rid="B5-cells-12-00604" ref-type="bibr">5</xref>]). However, spatial autocorrelation statistics have not been used to identify SVGs for the characterization of ST data (e.g., dimension reduction) and downstream analyses of ST data (e.g., spatial domain identification). Additionally, the low computational efficiency of existing implementations for calculating the statistics limits their scalability to high-throughput data.</p>
    <p>To fill these gaps, we propose a method named SINFONIA to identify spatially variable genes for deciphering spatial domains. Specifically, we construct a spatial neighbor graph and, for the first time, apply spatial autocorrelation statistics to identify SVGs for deciphering spatial domains. We propose an ensemble strategy based on spatial autocorrelation statistics to better identify SVGs and achieve about a four- to two-hundred-and-sixty-two-times speedup compared with other spatial autocorrelation statistics implementations. Additionally, it is the first time that a systematic and quantitative evaluation of SVG identification performance has been conducted using a number of ST datasets.</p>
  </sec>
  <sec id="sec2-cells-12-00604">
    <title>2. Materials and Methods</title>
    <sec id="sec2dot1-cells-12-00604">
      <title>2.1. Construction of Spatial Neighbor Graph</title>
      <p>As the SINFONIA framework shown in <xref rid="cells-12-00604-f001" ref-type="fig">Figure 1</xref>, SINFONIA identifies SVGs based on Moran’s <italic toggle="yes">I</italic> and Geary’s <italic toggle="yes">C</italic> statistics. To calculate the spatial autocorrelation statistics, we construct a spatial neighbor graph (SNG), considering that aggregating information from each spot’s neighbors can improve the characterization of spatial patterns and, consequently, SVGs [<xref rid="B16-cells-12-00604" ref-type="bibr">16</xref>]. Specifically, for each spot we use spatial coordinates to identify <inline-formula><mml:math id="mm1" overflow="scroll"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula> nearest neighbors in a Euclidean space. The weights <inline-formula><mml:math id="mm2" overflow="scroll"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>W</mml:mi></mml:mstyle></mml:mrow></mml:math></inline-formula> of SNG are then defined by (1).
<disp-formula id="FD1-cells-12-00604"><label>(1)</label><mml:math id="mm3" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>D</mml:mi></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mo> </mml:mo><mml:mi>s</mml:mi><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mo> </mml:mo><mml:mi>i</mml:mi><mml:mo> </mml:mo><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo> </mml:mo><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo> </mml:mo><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>b</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm4" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> denotes the weight between spots <inline-formula><mml:math id="mm5" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm6" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm7" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> denotes the distance between spots <inline-formula><mml:math id="mm8" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm9" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm10" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>D</mml:mi></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> denotes the maximum distance between spot <inline-formula><mml:math id="mm11" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> and its nearest neighbors. We implemented the calculation via sparse matrix operations, which decrease the space complexity from <inline-formula><mml:math id="mm12" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="mm13" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>≫</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, and thus enable memory-efficient and high-speed calculation for the large-scale spatial transcriptomic (ST) data.</p>
    </sec>
    <sec id="sec2dot2-cells-12-00604">
      <title>2.2. Calculation of Spatial Autocorrelation Statistics</title>
      <p>We then compute Moran’s <italic toggle="yes">I</italic> and Geary’s <italic toggle="yes">C</italic> for each gene based on <inline-formula><mml:math id="mm14" overflow="scroll"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>W</mml:mi></mml:mstyle></mml:mrow></mml:math></inline-formula>, the former of which characterize spatial autocorrelation in the given gene among neighbors in the SNG. In ST data, the gene expression in spots from localized spatial neighborhoods tends to be closer in value than those at distant locations. For example, the expression levels of a gene at nearby locations may be closer in value than expression levels at distant locations. Therefore, genes with stronger spatial autocorrelation can exhibit more organized spatial expression patterns. Here, we calculate spatial autocorrelation statistics based on our constructed SNG to quantify the spatial autocorrelation degree of each gene.</p>
      <p>Specifically, Moran’s <italic toggle="yes">I</italic> measures the overall spatial autocorrelation of a dataset [<xref rid="B17-cells-12-00604" ref-type="bibr">17</xref>]. Given a gene and SNG of the spots, Moran’s <italic toggle="yes">I</italic> evaluates whether the spatial expression pattern is clustered, dispersed, or random. The Moran’s <italic toggle="yes">I</italic> score ranges from −1 to 1, where a score close to 1 indicates a clear spatial pattern, a score close to 0 indicates random spatial expression, and a score close to −1 indicates a chess board-like pattern. For each gene, the Moran’s <italic toggle="yes">I</italic> score is computed as (2):<disp-formula id="FD2-cells-12-00604"><label>(2)</label><mml:math id="mm15" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>N</mml:mi><mml:mi>W</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mstyle mathsize="70%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mstyle mathsize="70%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mstyle mathsize="70%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm16" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm17" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> denote the gene expression levels of spots <inline-formula><mml:math id="mm18" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm19" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula>, respectively, <inline-formula><mml:math id="mm20" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is the mean expression level of the gene, <inline-formula><mml:math id="mm21" overflow="scroll"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> is the total number of spots, <inline-formula><mml:math id="mm22" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the edge weight between spots <inline-formula><mml:math id="mm23" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm24" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula> in SNG, and <inline-formula><mml:math id="mm25" overflow="scroll"><mml:mrow><mml:mi>W</mml:mi></mml:mrow></mml:math></inline-formula> is the sum of SNG weights.</p>
      <p>Geary’s <italic toggle="yes">C</italic>, another commonly used statistic [<xref rid="B18-cells-12-00604" ref-type="bibr">18</xref>], is inversely related to Moran’s <italic toggle="yes">I</italic>, but is not identical to Moran’s <italic toggle="yes">I</italic>. Compared with Moran’s <italic toggle="yes">I</italic>, which measures global spatial autocorrelation, Geary’s <italic toggle="yes">C</italic> is more sensitive to local spatial autocorrelation. For each gene, the Geary’s <italic toggle="yes">C</italic> score is computed as (3):<disp-formula id="FD3-cells-12-00604"><label>(3)</label><mml:math id="mm26" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mstyle mathsize="70%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mstyle mathsize="70%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>W</mml:mi><mml:msub><mml:mstyle mathsize="70%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <p>The score of Geary’s <italic toggle="yes">C</italic> ranges from 0 to 2. To make it on the same scale as that of Moran’s <italic toggle="yes">I</italic>, we rescale it by (4):<disp-formula id="FD4-cells-12-00604"><label>(4)</label><mml:math id="mm27" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msup><mml:mi>C</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where a <inline-formula><mml:math id="mm28" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mi>C</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> close to 1 means positive spatial autocorrelation, a <inline-formula><mml:math id="mm29" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mi>C</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> close to 0 means poor spatial autocorrelation, and a <inline-formula><mml:math id="mm30" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mi>C</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> close to −1 means negative spatial autocorrelation.</p>
    </sec>
    <sec id="sec2dot3-cells-12-00604">
      <title>2.3. Identification of Spatially Variable Genes</title>
      <p>SINFONIA identifies SVGs for spatial domain detection based on an ensemble strategy for Moran’s <italic toggle="yes">I</italic> and Geary’s <italic toggle="yes">C</italic>. Given a specified number <inline-formula><mml:math id="mm31" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> of SVGs, SINFONIA_<italic toggle="yes">I</italic>, a variant of SINFONIA, selects the top <inline-formula><mml:math id="mm32" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> genes with the highest Moran’s <italic toggle="yes">I</italic> scores as SVGs, while SINFONIA_<italic toggle="yes">C</italic>, another variant of SINFONIA, selects the top <inline-formula><mml:math id="mm33" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> genes with the highest rescaled Geary’s <italic toggle="yes">C</italic> scores as SVGs. In this work, following the SCANPY workflow for ST data, we identified the top 2000 SVGs with SINFONIA_<italic toggle="yes">I</italic>, SINFONIA_<italic toggle="yes">C</italic> and other baseline methods by default on all datasets. SINFONIA adopts the union of SVGs identified by SINFONIA_<italic toggle="yes">I</italic> and SINFONIA_<italic toggle="yes">C</italic> as SVGs, based on an ensemble idea that integrates both global and local spatial autocorrelation. The ensemble strategy provides overall better performance than the two variants and is more robust than the variants, which fluctuate using different downstream clustering methods.</p>
    </sec>
    <sec id="sec2dot4-cells-12-00604">
      <title>2.4. Implementation and Usage of SINFONIA</title>
      <p>With the increase of data throughput and data scale, computational methods should meet the critical principles of efficiency and scalability [<xref rid="B14-cells-12-00604" ref-type="bibr">14</xref>]. To achieve superior efficiency and scalability, we implemented the calculation of Moran’s <italic toggle="yes">I</italic> and Geary’s <italic toggle="yes">C</italic> via sparse matrix operations and implemented parallel computing for genes. Specifically, SINFONIA performs sparse matrix operations using SciPy 2-D sparse array grammar for numeric data [<xref rid="B19-cells-12-00604" ref-type="bibr">19</xref>], which focuses on the calculation of only non-zero values, and thus enables memory-efficient and high-speed calculation for large-scale data. Additionally, SINFONIA adopts Numba (<uri xlink:href="https://numba.pydata.org/">https://numba.pydata.org/</uri> accessed on 17 July 2022) to translate functions to optimized fast machine code and achieve parallel computing. In addition, with tailored programming, SINFONIA computes Moran’s <italic toggle="yes">I</italic> and Geary’s <italic toggle="yes">C</italic> simultaneously with almost no extra time consumption compared to computing a single statistic.</p>
      <p>The AnnData format offers a convenient way to store data matrices and annotations together. The use of AnnData format also facilitates interoperability with existing single-cell analysis tools such as SCANPY [<xref rid="B8-cells-12-00604" ref-type="bibr">8</xref>]. We designed the structure of the SINFONIA class to smoothly interface with the widely-used AnnData format. Therefore, SINFONIA can be seamlessly integrated into the SCANPY vignette by taking the AnnData object as input, and replace the default SVG identification method via just a single line of code. In addition, its modularity makes it efficient for data representation and storage, and makes it flexible to be interfaced with various external tools in the Python data science and machine-learning ecosystem, such as advanced deep-learning frameworks. Nevertheless, existing SVG identification methods in the Python community, such as SpatialDE [<xref rid="B1-cells-12-00604" ref-type="bibr">1</xref>] and SOMDE [<xref rid="B12-cells-12-00604" ref-type="bibr">12</xref>], have poor interoperability with the widely-used AnnData format and SCANPY workflow, and thus hamper the usage and application of these methods.</p>
      <p>Additionally, SINFONIA provides rich documentation in the form of functional application programming interface documentation, tutorials and example workflows. It is easy to navigate and is accessible to both experienced developers and beginner analysts.</p>
    </sec>
    <sec id="sec2dot5-cells-12-00604">
      <title>2.5. Data Collection</title>
      <p>We systematically assessed the performance of SINFONIA using 15 ST datasets generated with different protocols, and with different sizes, dimensions and qualities. We note that limited sequencing coverage of single-cell technologies, especially for STs, results in large fractions of observed zeros, namely a high degree of data sparsity, providing data with low quality [<xref rid="B20-cells-12-00604" ref-type="bibr">20</xref>].</p>
      <p>First, we collected a 10X Genomics Visium dataset containing spatial expressions of 12 human dorsolateral prefrontal cortex (DLPFC) sections from spatialLIBD [<xref rid="B21-cells-12-00604" ref-type="bibr">21</xref>]. The spots were manually annotated based on morphological features and gene markers [<xref rid="B22-cells-12-00604" ref-type="bibr">22</xref>]. </p>
      <p>Second, we downloaded 10X Genomics Visium ST data of a mouse brain coronal (MBC) section [<xref rid="B23-cells-12-00604" ref-type="bibr">23</xref>]. The annotation was collected from Squidpy [<xref rid="B3-cells-12-00604" ref-type="bibr">3</xref>], which annotated the spots using several resources, including the Allen Brain Atlas [<xref rid="B24-cells-12-00604" ref-type="bibr">24</xref>], the Mouse Brain gene expression atlas (<uri xlink:href="http://mousebrain.org/">http://mousebrain.org/</uri> accessed on 17 July 2022), and this study [<xref rid="B25-cells-12-00604" ref-type="bibr">25</xref>].</p>
      <p>Third, we collected a Slide-seqV2 dataset with 10 μm spatial resolution profiled from mouse hippocampus [<xref rid="B26-cells-12-00604" ref-type="bibr">26</xref>]. This dataset does not come with annotations that can serve as ground-truth since spatial domain detection was not performed in the original study. To evaluate the performance of spatial domain characterization visually, we also retrieved the annotation of hippocampus structures from the Allen Brain Atlas [<xref rid="B24-cells-12-00604" ref-type="bibr">24</xref>].</p>
      <p>Fourth, we downloaded a mouse olfactory bulb ST dataset generated by Stereo-seq [<xref rid="B27-cells-12-00604" ref-type="bibr">27</xref>]. Analogously, because of a lack of ground-truth domain annotation for this dataset, we relied on the Allen Brain Atlas [<xref rid="B24-cells-12-00604" ref-type="bibr">24</xref>] to evaluate the consistency between the identified clusters and the annotated tissue structures.</p>
      <p>A summary of the fifteen ST datasets used for performance evaluation is provided in <xref rid="cells-12-00604-t001" ref-type="table">Table 1</xref>.</p>
    </sec>
    <sec id="sec2dot6-cells-12-00604">
      <title>2.6. Performance Evaluation</title>
      <p>Deciphering spatial domains (i.e., regions with similar spatial expression patterns) is one of the great challenges for STs [<xref rid="B14-cells-12-00604" ref-type="bibr">14</xref>]. We illustrate the benefits of SINFONIA for deciphering spatial domains from five perspectives: spatial clustering, domain resolution, latent representation, spot visualization, and computational efficiency. We identified SVGs by various methods and performed data analysis following the SCANPY vignette for ST data. All the experiments were performed on a standard desktop with an AMD Ryzen 7 1700X Eight-Core CPU with 32GB of RAM.</p>
      <sec id="sec2dot6dot1-cells-12-00604">
        <title>2.6.1. Spatial Clustering</title>
        <p>We performed clustering on the latent representation of spots obtained from principal component analysis on expression levels of the identified SVGs following the SCANPY vignette for ST data [<xref rid="B8-cells-12-00604" ref-type="bibr">8</xref>]. Two widely-used community detection-based clustering methods, i.e., Louvain clustering and Leiden clustering, with default resolution in SCANPY, were adopted. In addition, for the situation where the number of clusters is specified, we implemented a binary search to tune the resolution parameter in clustering to make the number of clusters and the specified number as close as possible. The number was specified as the unique number of ground-truth labels in our benchmark experiments. For the binary search strategy, we searched the resolution in the range from 0.0 to 3.0. If the number of clusters did not match the specified number, the resolution value inducing the closest number of clusters to the specified number was used to perform clustering in the next iteration.</p>
        <p>We considered the first scenario since the number of ground-truth spatial domains is unknown in advance in most studies and Louvain or Leiden clustering with default resolution is usually adopted [<xref rid="B8-cells-12-00604" ref-type="bibr">8</xref>,<xref rid="B28-cells-12-00604" ref-type="bibr">28</xref>]. The benchmark results in this scenario can indicate the performance of different SVG identification methods in general ST applications. We also considered the second scenario, one inspired by several studies for benchmarking single-cell analysis performance [<xref rid="B15-cells-12-00604" ref-type="bibr">15</xref>,<xref rid="B29-cells-12-00604" ref-type="bibr">29</xref>,<xref rid="B30-cells-12-00604" ref-type="bibr">30</xref>,<xref rid="B31-cells-12-00604" ref-type="bibr">31</xref>,<xref rid="B32-cells-12-00604" ref-type="bibr">32</xref>]. The benchmark results in this scenario can indicate the performance of different methods more fairly and objectively because the number of clusters is made to be as close as possible to the number of spatial domains. Briefly, the former is more general and can be considered as an evaluation of real data, while the latter is more specific and can be considered as an evaluation of simulation data.</p>
        <p>We evaluated the clustering results based on four widely-used metrics: adjusted mutual information (AMI) [<xref rid="B33-cells-12-00604" ref-type="bibr">33</xref>], adjusted Rand index (ARI) [<xref rid="B34-cells-12-00604" ref-type="bibr">34</xref>], homogeneity (Homo) [<xref rid="B35-cells-12-00604" ref-type="bibr">35</xref>], and normalized mutual information (NMI) [<xref rid="B36-cells-12-00604" ref-type="bibr">36</xref>]. Note that AMI is preferred for unbalanced clusters, while ARI is more suitable for ST datasets with large balanced clusters [<xref rid="B15-cells-12-00604" ref-type="bibr">15</xref>,<xref rid="B32-cells-12-00604" ref-type="bibr">32</xref>,<xref rid="B37-cells-12-00604" ref-type="bibr">37</xref>]. Since the sizes of spot populations in most ST data, including the datasets used in this study, are unbalanced, AMI is more appropriate than ARI in the benchmarking results.</p>
        <p>To be more specific, let <inline-formula><mml:math id="mm34" overflow="scroll"><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> denote the ground-truth labels of spots, <inline-formula><mml:math id="mm35" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:math></inline-formula> denote the clustering results, <inline-formula><mml:math id="mm36" overflow="scroll"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> denote the total number of spots, <inline-formula><mml:math id="mm37" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> denote the number of spots assigned to the <inline-formula><mml:math id="mm38" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>-th unique cluster of <italic toggle="yes">P</italic>, <inline-formula><mml:math id="mm39" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> denote the number of spots that belong to the <inline-formula><mml:math id="mm40" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula>-th unique label of <inline-formula><mml:math id="mm41" overflow="scroll"><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm42" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> denote the number of overlapping spots between the <inline-formula><mml:math id="mm43" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>-th cluster and the <inline-formula><mml:math id="mm44" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula>-th unique label, <inline-formula><mml:math id="mm45" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> denote the mutual entropy, <inline-formula><mml:math id="mm46" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> denote the expectation function, <inline-formula><mml:math id="mm47" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> denote the entropy function, and <inline-formula><mml:math id="mm48" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>|</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> denote the uncertainty of ground-truth labels based on the knowledge of clustering results. Then the AMI score is calculated as (5):<disp-formula id="FD5-cells-12-00604"><label>(5)</label><mml:math id="mm49" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mi>AMI</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>v</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>]</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo>[</mml:mo></mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></disp-formula></p>
        <p>The ARI score is computed as (6):<disp-formula id="FD6-cells-12-00604"><label>(6)</label><mml:math id="mm50" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>ARI</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mstyle mathsize="70%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mstyle mathsize="70%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mstyle mathsize="70%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>N</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mstyle mathsize="70%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathsize="70%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mstyle mathsize="70%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mstyle mathsize="70%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>N</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></disp-formula></p>
        <p>The Homo score is calculated as (7):<disp-formula id="FD7-cells-12-00604"><label>(7)</label><mml:math id="mm51" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>Homo</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>|</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></disp-formula></p>
        <p>The NMI score is computed as (8):<disp-formula id="FD8-cells-12-00604"><label>(8)</label><mml:math id="mm52" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>NMI</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      </sec>
      <sec id="sec2dot6dot2-cells-12-00604">
        <title>2.6.2. Domain Resolution</title>
        <p>Intuitively, based on the ground-truth domain labels and the spot embeddings learned from the identified SVGs, discovery of more nearest neighbors with the same domain label indicates better domain resolution and, consequently, better performance for the characterization of spatial domains. As suggested by [<xref rid="B38-cells-12-00604" ref-type="bibr">38</xref>], we evaluated domain resolution by mean average precision (MAP). Supposing that the domain label of the <inline-formula><mml:math id="mm53" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>-th spot is <inline-formula><mml:math id="mm54" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="normal">y</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, and the domain labels of its <inline-formula><mml:math id="mm55" overflow="scroll"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula> ordered nearest neighbors are <inline-formula><mml:math id="mm56" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">y</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:mrow><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, the MAP score is computed as (9) and (10).
<disp-formula id="FD9-cells-12-00604"><label>(9)</label><mml:math id="mm57" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>MAP</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:munderover><mml:mstyle mathsize="100%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msup><mml:mrow><mml:mi>AP</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></disp-formula>
<disp-formula id="FD10-cells-12-00604"><label>(10)</label><mml:math id="mm58" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:msup><mml:mrow><mml:mi>AP</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mstyle mathsize="70%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mstyle mathsize="70%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:msub></mml:mrow><mml:mi>k</mml:mi></mml:mfrac></mml:mrow><mml:mrow><mml:msubsup><mml:mstyle mathsize="70%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mo> </mml:mo><mml:munderover><mml:mstyle mathsize="100%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mo> </mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm59" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is an indicator function that equals 1 if <inline-formula><mml:math id="mm60" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> and 0 otherwise, and <inline-formula><mml:math id="mm61" overflow="scroll"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula> is set to 30. For each spot, average precision (AP) measures the average label precision up to each domain-matched neighbor. MAP, ranging from 0 to 1, is the average AP across all spots, and a higher MAP indicates better domain resolution.</p>
      </sec>
      <sec id="sec2dot6dot3-cells-12-00604">
        <title>2.6.3. Latent Representation</title>
        <p>We also investigated the representation performance of latent embeddings learned from the identified SVGs. First, we directly evaluated the information contained in the latent representation for predicting the true spatial domains in a supervised manner. Specifically, we treated the latent representation as the input and treated the true spatial domains as the output. As suggested by two benchmark studies on supervised cell type identification for single-cell RNA-seq data [<xref rid="B39-cells-12-00604" ref-type="bibr">39</xref>,<xref rid="B40-cells-12-00604" ref-type="bibr">40</xref>], we adopted the support vector machine (SVM) with radial basis function kernel as the classifier. We conducted five-fold cross-validation experiments by randomly splitting all spots into five folds and iteratively predicting spatial domains of the spots in each fold using the model trained with the remaining four folds. We computed the mean accuracy of the five folds (mean cross-validation accuracy, MCVA) to evaluate the predictive ability of the latent representation in predicting the spatial domains. A higher MCVA score suggests that the latent representation learned from the identified SVGs can better extract information in accurately predicting spatial domains.</p>
        <p>We further adopted the local inverse Simpson’s index (LISI), a commonly-used integration quality quantification metric in single-cell RNA-seq [<xref rid="B41-cells-12-00604" ref-type="bibr">41</xref>,<xref rid="B42-cells-12-00604" ref-type="bibr">42</xref>], to evaluate the characterized spatial domain patterns in latent representation for each spot. We built Gaussian kernel-based distributions of neighborhoods in the latent space, and calculated the LISI score using the <inline-formula><mml:math id="mm62" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mo>_</mml:mo><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> function from the LISI R package with default parameters (perplexity = 30). A lower LISI score means more homogeneous neighborhood spatial domains of the spot [<xref rid="B41-cells-12-00604" ref-type="bibr">41</xref>,<xref rid="B42-cells-12-00604" ref-type="bibr">42</xref>]. To facilitate the benchmark, we used the transformed LISI scores, namely the tinverse of the median or mean LISI (iLISImd or iLISIm), to evaluate the performance. A higher iLISImd or iLISIm score suggests that the latent representation contains more effective information for deciphering spatial domains.</p>
      </sec>
      <sec id="sec2dot6dot4-cells-12-00604">
        <title>2.6.4. Spot Visualization</title>
        <p>With the spatial coordinates and clustering results of spots, we assessed the performance of SVG identification methods via spot visualization. We collected annotations of related tissues from the Allen Reference Atlas [<xref rid="B24-cells-12-00604" ref-type="bibr">24</xref>], and used the annotation as a reference. We can evaluate the performance by visually investigating whether different domains were clearly segregated, whether the detected domains were spatially continuous and smooth, whether the revealed spatial domains were well consistent with the collected annotations, and whether the known tissue structures were successfully identified.</p>
      </sec>
      <sec id="sec2dot6dot5-cells-12-00604">
        <title>2.6.5. Computational Efficiency</title>
        <p>Advanced high-throughput technologies for spatial transcriptomics have generated massive ST datasets, impeding exploratory data analysis on standard desktops. Therefore, we also benchmarked the computation time of various methods. We first compared the computation time of SINFONIA and its two variants with other SVG identification methods, including hvg [<xref rid="B8-cells-12-00604" ref-type="bibr">8</xref>], SOMDE [<xref rid="B12-cells-12-00604" ref-type="bibr">12</xref>], and SpatialDE [<xref rid="B1-cells-12-00604" ref-type="bibr">1</xref>]. Second, we compared the computation time of SINFONIA and its two variants with other Python implementations for the calculation of Moran’s <italic toggle="yes">I</italic> and Geary’s <italic toggle="yes">C</italic>, including Squidpy [<xref rid="B3-cells-12-00604" ref-type="bibr">3</xref>] and SpaGCN [<xref rid="B5-cells-12-00604" ref-type="bibr">5</xref>]. We note that the implementation in SpaGE [<xref rid="B4-cells-12-00604" ref-type="bibr">4</xref>] is the same as that in SpaGCN.</p>
        <p>To sum up, we evaluated SVG identification performance by twenty-one metrics, including MAP, MCVA, iLISImd, iLISIm, computation time, and four clustering metrics for two clustering methods with default resolution or specified cluster number.</p>
      </sec>
    </sec>
    <sec id="sec2dot7-cells-12-00604">
      <title>2.7. Baseline Methods</title>
      <p>We compared the performance of SINFONIA with three baseline methods, including SpatialDE [<xref rid="B1-cells-12-00604" ref-type="bibr">1</xref>], SOMDE [<xref rid="B12-cells-12-00604" ref-type="bibr">12</xref>], and hvg [<xref rid="B8-cells-12-00604" ref-type="bibr">8</xref>], which is adopted in the widely-used SCANPY workflow for ST data. Specifically, SpatialDE and SOMDE were executed using the Python packages SpatialDE (v1.1.3, <uri xlink:href="https://github.com/Teichlab/SpatialDE">https://github.com/Teichlab/SpatialDE</uri> accessed on 17 July 2022) and somde (v0.1.8, <uri xlink:href="https://github.com/XuegongLab/somde">https://github.com/XuegongLab/somde</uri> accessed on 17 July 2022), respectively, while hvg was executed using the SCANPY (v1.9.1, <uri xlink:href="https://github.com/scverse/scanpy">https://github.com/scverse/scanpy</uri> accessed on 17 July 2022) implementation of the Seurat method for hvg filtering. We identified SVGs by various methods with the default parameters or settings provided in the accompanying examples. Following the SCANPY vignette for ST data, the top 2000 SVGs identified by various methods were used for benchmarking. We used the standard SCANPY workflow for ST data with default settings to evaluate the performance for characterizing spatial domains.</p>
      <p>We also tried to benchmark the performance of other three Python-based methods, including SPADE [<xref rid="B10-cells-12-00604" ref-type="bibr">10</xref>], GPcounts [<xref rid="B11-cells-12-00604" ref-type="bibr">11</xref>], and HMRF [<xref rid="B13-cells-12-00604" ref-type="bibr">13</xref>]. However, SPADE requires additional high-resolution tissue images as input, which are not available on most of the ST datasets. Additionally, it would have led to an unfair comparison, even though the images are available. We then ran GPcounts following its tutorials. However, when we performed GPcounts on the smallest dataset, i.e., the MBC dataset, the status bar demonstrated that the computational time of the method would be more than 1668 h, making it impossible to benchmark the performance of GPcounts. We also tried to benchmark HMRF. Nevertheless, we failed to access the instructions of HMRF (<uri xlink:href="http://spatial.rc.fas.harvard.edu/install.html">http://spatial.rc.fas.harvard.edu/install.html</uri> accessed on 17 July 2022). Therefore, we finally adopted SpatialDE [<xref rid="B1-cells-12-00604" ref-type="bibr">1</xref>], SOMDE [<xref rid="B12-cells-12-00604" ref-type="bibr">12</xref>], and hvg [<xref rid="B8-cells-12-00604" ref-type="bibr">8</xref>] as baseline methods.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec3-cells-12-00604">
    <title>3. Results</title>
    <sec id="sec3dot1-cells-12-00604">
      <title>3.1. SINFONIA Enables Accurate Spatial Clustering</title>
      <p>It is intuitive that, based on the ground-truth domain labels and expression levels of the identified SVGs, a higher score of clustering metric indicates better performance for deciphering spatial domains. We first quantitatively evaluated the spatial clustering performance of SINFONIA. To mimic the scenario where the number of spatial domains is unknown, we used Louvain clustering with default resolution. This is a general scenario, since the number of ground-truth spatial domains is unknown in advance in most studies. We performed spatial clustering on each of the 12 DLPFC datasets. As shown in <xref rid="cells-12-00604-f002" ref-type="fig">Figure 2</xref>A, SINFONIA achieved significantly higher AMI, ARI, Homo and NMI values than did the baseline methods. SpatialDE also achieved satisfactory performance, while with high variance across the 12 DLPFC datasets. Additionally, we considered the scenario where a specified number of clusters is given. The scenario is often adopted in benchmarking studies [<xref rid="B15-cells-12-00604" ref-type="bibr">15</xref>,<xref rid="B29-cells-12-00604" ref-type="bibr">29</xref>,<xref rid="B30-cells-12-00604" ref-type="bibr">30</xref>,<xref rid="B31-cells-12-00604" ref-type="bibr">31</xref>,<xref rid="B32-cells-12-00604" ref-type="bibr">32</xref>]. We used a binary search strategy to obtain clusters, and SINFONIA again outperformed the baseline methods (<xref rid="cells-12-00604-f002" ref-type="fig">Figure 2</xref>B). In addition, we also evaluated the performance of two SINFONIA variants, namely SINFONIA_<italic toggle="yes">I</italic> and SINFONIA_<italic toggle="yes">C</italic>, to demonstrate the advantages of the ensemble strategy in SINFONIA. The evaluation of SINFONIA and its two variants is equivalent to ablation experiments. As shown in <xref rid="cells-12-00604-f002" ref-type="fig">Figure 2</xref>A,B, SINFONIA achieved better performance than SINFONIA_<italic toggle="yes">I</italic>, and SINFONIA_<italic toggle="yes">I</italic> achieved better performance than SINFONIA_<italic toggle="yes">C</italic>, indicating that SINFONIA integrates the advantages of Moran’s <italic toggle="yes">I</italic> and Geary’s <italic toggle="yes">C</italic> and thus achieves the best performance. In addition to Louvain clustering, we also assessed the spatial clustering performance of SVGs identified by various methods via Leiden clustering, which is another widely-used clustering method in the single-cell community [<xref rid="B2-cells-12-00604" ref-type="bibr">2</xref>,<xref rid="B8-cells-12-00604" ref-type="bibr">8</xref>]. As shown in <xref rid="cells-12-00604-f002" ref-type="fig">Figure 2</xref>C,D, Leiden clustering with default resolution or searched resolution also provided similar results, suggesting that the evaluation results are robust relative to clustering methods and SINFONIA consistently outperformed the baseline methods regardless of clustering methods and scenarios.</p>
      <p>To demonstrate the superiority of spatial clustering results across multiple datasets, we further benchmarked SINFONIA on the MBC dataset. As shown in <xref rid="cells-12-00604-f003" ref-type="fig">Figure 3</xref>A–D, SINFONIA again deciphered the spatial domains better than baseline methods. Additionally, SINFONIA provided overall better performance than its two variants and was more robust than the variants. We note that SINFONIA_<italic toggle="yes">C</italic> outperformed SINFONIA_<italic toggle="yes">I</italic> when clustering by Leiden with default resolution on this dataset, while SINFONIA_<italic toggle="yes">I</italic> outperformed SINFONIA_<italic toggle="yes">C</italic> in other cases and on the 12 DLPFC datasets, suggesting that SVG identification based on an individual statistic may provide fluctuating performance while SINFONIA can provide the overall best performance based on its ensemble strategy.</p>
    </sec>
    <sec id="sec3dot2-cells-12-00604">
      <title>3.2. SINFONIA Effectively Characterizes Spatial Patterns</title>
      <p>To further investigate the effectiveness of spatial patterns that were characterized based on the SVGs identified by the different methods, we assessed the domain resolution by MAP, and assessed the prediction ability by MCVA, iLISImd and iLISIm. Again, SINFONIA achieved consistent superiority over baseline methods and, overall, performed better than its two variants on 12 DLPFC datasets (<xref rid="cells-12-00604-f004" ref-type="fig">Figure 4</xref>A,B) and the MBC dataset (<xref rid="cells-12-00604-f004" ref-type="fig">Figure 4</xref>C). Note that hvg, the SVG identification method used in the SCANPY vignette tailored for ST data analysis, provided relatively undesirable performance, which is consistent with the evaluation results in spatial clustering. The above results indicate that a simple replacement of the SVG identification step with SINFONIA can significantly improve the domain resolution and prediction ability of characterized spatial patterns.</p>
    </sec>
    <sec id="sec3dot3-cells-12-00604">
      <title>3.3. SINFONIA Facilitates Interpretable Spot Visualization</title>
      <p>Interpretable visualization of spatial domains is important for researchers to better understand tissue structures and study biological functions. We next applied SINFONIA to a mouse hippocampus dataset sequenced by Slide-seqV2 [<xref rid="B26-cells-12-00604" ref-type="bibr">26</xref>] and a mouse olfactory bulb dataset sequenced by Stereo-seq [<xref rid="B27-cells-12-00604" ref-type="bibr">27</xref>]. Since these two datasets lack manually annotated spatial domain labels, we evaluated the interpretability by comparing the spatial domains obtained by clustering (Louvain with default resolution) with the annotated function structures in the Allen Brain Atlas [<xref rid="B24-cells-12-00604" ref-type="bibr">24</xref>].</p>
      <p>We visualized the spots with the spatial coordinates and clustering results. As shown in <xref rid="cells-12-00604-f005" ref-type="fig">Figure 5</xref>A,B, on both of these two datasets, the spatial domains revealed based on the SVGs identified by SINFONIA were well consistent with the annotation from the Allen Reference Atlas, while the clusters identified by other methods lacked clear spatial separation, indicating the advantage of SINFONIA for characterizing and visualizing spatial domains. For example, based on the SVGs identified by SINFONIA, we successfully detected the third ventricle (V3), dentate gyrus-granule cell layer (DG-sg), and CA field of pyramidal layer in the mouse hippocampus, and detected the subependymal zone (SEZ) in the mouse olfactory bulb. However, based on the SVGs identified by other methods, most of the tissue structures can hardly be characterized. Additionally, the baseline methods tended to claim significantly more spatial domains than did SINFONIA, which may be due to the limited spatial patterns and the even noise in the identified SVGs. In addition, we note that errors were encountered when performing SpatialDE and SOMDE on these two datasets, respectively, highlighting the importance of user-friendliness and software quality to the success of bioinformatics tools [<xref rid="B43-cells-12-00604" ref-type="bibr">43</xref>].</p>
    </sec>
    <sec id="sec3dot4-cells-12-00604">
      <title>3.4. SINFONIA Is Robust and Computationally Efficient</title>
      <p>The robustness of hyperparameters is an important aspect that affects the ease of use of a method. The major hyperparameter of SVG identification is the number of SVGs to be selected. In order to investigate the robustness of SINFONIA relative to the choice of the number of SVGs, we further performed SINFONIA on the 12 DLPFC datasets to select different numbers of SVGs. We adopted 20 metrics (i.e., four clustering metrics for two clustering methods with default resolution or specified cluster number: MAP, MCVA, iLISImd, and iLISIm) to demonstrate the robustness. For each choice of the number of SVGs, we computed the median of each metric on the 12 datasets, and thus obtained 20 median metrics. We then performed two-sided Wilcoxon signed-rank tests on different pairs of choice of the number of SVGs to test if the performance has a significant difference using different numbers of SVGs. As shown in <xref rid="cells-12-00604-f006" ref-type="fig">Figure 6</xref>A, the performance of SINFONIA did not differ significantly using various numbers of SVGs (all the <italic toggle="yes">p</italic>-values were greater than 0.1), indicating that SINFONIA was robust to the choice of the number of SVGs.</p>
      <p>To catch up with the growth in data throughput, computational methods should be designed with scalability in mind. Therefore, in addition to the comparison of spatial characterization performance of different SVG identification methods, we also compared the computational efficiency of different methods on the 12 DLPFC datasets. As shown in <xref rid="cells-12-00604-f006" ref-type="fig">Figure 6</xref>B, SINFONIA and its two variants significantly outperformed the other methods except for the conventional hvg method. Additionally, we also systematically benchmarked the computational efficiency of different implementations for calculating Moran’s <italic toggle="yes">I</italic> and Geary’s <italic toggle="yes">C</italic>. In the Python community of ST data analysis, Squidpy [<xref rid="B3-cells-12-00604" ref-type="bibr">3</xref>] and SpaGCN [<xref rid="B5-cells-12-00604" ref-type="bibr">5</xref>] provide implementations for the calculation of Moran’s <italic toggle="yes">I</italic> and Geary’s <italic toggle="yes">C</italic>. The Moran’s <italic toggle="yes">I</italic> implementation of SpaGCN is the same as that of SpaGE [<xref rid="B4-cells-12-00604" ref-type="bibr">4</xref>]. Hence, we compared the computational efficiency of SINFONIA and its two variants with Squidpy and SpaGCN. We used various implementations to calculate spatial autocorrelation statistics based on the same spatial neighbor graph to ensure the fairness of assessment. As shown in <xref rid="cells-12-00604-f006" ref-type="fig">Figure 6</xref>C, SINFONIA offered about four- to two-hundred-and-sixty-two- times speedup compared with other implementations for calculating spatial autocorrelation statistics Moran’s <italic toggle="yes">I</italic> and Geary’s <italic toggle="yes">C</italic>. In addition, SINFONIA computed Moran’s <italic toggle="yes">I</italic> and Geary’s <italic toggle="yes">C</italic> simultaneously with almost no extra time consumption compared to computing a single statistic. The above results highlight that the contribution of SINFONIA to the ST data analysis community lies in not only the superior spatial characterization performance, but also the advanced implementation of spatial autocorrelation statistics.</p>
    </sec>
    <sec id="sec3dot5-cells-12-00604">
      <title>3.5. SINFONIA Improves the Performance of Other Spatial Embedding Methods</title>
      <p>In addition to the principal component analysis used in the SCANPY vignette tailored for ST data analysis, we further adopted STAGATE, the state-of-the-art method for ST data embedding [<xref rid="B14-cells-12-00604" ref-type="bibr">14</xref>], to demonstrate that using the SVGs identified by SINFONIA can also improve the performance of more advanced spatial embedding methods. We systematically evaluated the performance of STAGATE on the 12 DLPFC datasets and the MBC section dataset using the SVGs identified by hvg and SINFONIA, respectively. We assessed the performance with spatial clustering, domain resolution and prediction ability. As shown in <xref rid="cells-12-00604-f007" ref-type="fig">Figure 7</xref>A,B, by simply replacing the SVG identification method from hvg used in SCANPY workflow to SINFONIA, STAGATE can achieve significant improvements. The results of the combination of SINFONIA and STAGATE indicate that our method can be used as a general step in ST data analysis to enhance the performance of existing ST data embedding methods.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="sec4-cells-12-00604">
    <title>4. Discussion</title>
    <p>Rapid advances in spatially resolved transcriptomics have revolutionized the interrogation of spatial heterogeneity and granted us a novel perspective on the cellular transcriptome. The identification of spatially variable genes (SVGs) is an essential step for downstream spatial domain characterization, and is regarded as the first critical step in spatial transcriptomic (ST) data analysis [<xref rid="B1-cells-12-00604" ref-type="bibr">1</xref>]. In this study, we propose SINFONIA, a scalable method for identifying spatially variable genes via ensemble strategies. We systematically benchmarked the performance of SINFONIA on 15 ST datasets generated with different protocols, and with different sizes, dimensions and qualities. We have demonstrated the applications of SINFONIA from five perspectives, including spatial clustering, spatial domain annotation, spot visualization, spatial embedding and applicability to various ST datasets. Furthermore, we have also shown that SINFONIA is robust relative to the number of SVGs and is computationally efficient. As an ensemble-based method, SINFONIA can provide the overall best performance based on both the global autocorrelation (Moran’s <italic toggle="yes">I</italic>) and the local spatial autocorrelation (Geary’s <italic toggle="yes">C</italic>), highlighting the contribution of the ensemble strategy in SINFONIA for SVG identification. Certainly, although SINFONIA successfully integrates the spatial coordinates and gene expression profiles in ST data to identify SVGs, its performance can be further improved in the future. For example, more advanced computational technologies and hardware such as the graphics processing unit (GPU) can be used to further accelerate the computation of spatial autocorrelation statistics, and thus facilitate the analysis of large-scale ST data.</p>
  </sec>
  <sec sec-type="conclusions" id="sec5-cells-12-00604">
    <title>5. Conclusions</title>
    <p>This study is the first attempt to apply spatial autocorrelation statistics to the identification of SVGs for deciphering spatial domains. Additionally, it is the first time that a systematic and quantitative evaluation of SVG identification performance has been conducted using a number of ST datasets. SINFONIA, the ensemble-based method proposed in this study, provides an effective way to identify SVGs to facilitate ST data analysis, and achieves about four- to two-hundred-sixty-two-times speedup compared with other implementations. With its smooth interfaces to SCANPY and the Python data science ecosystem, we anticipate broad application of SINFONIA within ST data analysis.</p>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Disclaimer/Publisher’s Note:</bold> The statements, opinions and data contained in all publications are solely those of the individual author(s) and contributor(s) and not of MDPI and/or the editor(s). MDPI and/or the editor(s) disclaim responsibility for any injury to people or property resulting from any ideas, methods, instructions or products referred to in the content.</p>
    </fn>
  </fn-group>
  <notes>
    <title>Author Contributions</title>
    <p>Conceptualization, S.C. and R.J.; methodology, R.J.; software, S.C.; validation, R.J., Z.L. and S.C.; formal analysis, S.C.; investigation, S.C.; resources, Z.L.; data curation, Z.L.; writing—original draft preparation, S.C.; writing—review and editing, R.J. and S.C.; visualization, Y.J. and S.L.; supervision, S.C.; project administration, S.C.; funding acquisition, R.J. and S.C. All authors have read and agreed to the published version of the manuscript.</p>
  </notes>
  <notes>
    <title>Institutional Review Board Statement</title>
    <p>Not applicable.</p>
  </notes>
  <notes>
    <title>Informed Consent Statement</title>
    <p>Not applicable.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data Availability Statement</title>
    <p>The 10X Genomics Visium dataset of 12 DLPFC sections [<xref rid="B22-cells-12-00604" ref-type="bibr">22</xref>] can be downloaded from spatialLIBD at <uri xlink:href="http://spatial.libd.org/spatialLIBD/">http://spatial.libd.org/spatialLIBD/</uri> (accessed on 17 July 2022) [<xref rid="B21-cells-12-00604" ref-type="bibr">21</xref>]. The 10X Genomics Visium dataset of a coronal mouse brain section is available at <uri xlink:href="https://support.10xgenomics.com/spatial-gene-expression/datasets">https://support.10xgenomics.com/spatial-gene-expression/datasets</uri> (accessed on 17 July 2022) [<xref rid="B23-cells-12-00604" ref-type="bibr">23</xref>]. The Slide-seqV2 dataset of mouse hippocampus is accessible at <uri xlink:href="https://singlecell.broadinstitute.org/single_cell/study/SCP815/highly-sensitive-spatial-transcriptomics-at-near-cellular-resolution-with-slide-seqv2#study-summary">https://singlecell.broadinstitute.org/single_cell/study/SCP815/highly-sensitive-spatial-transcriptomics-at-near-cellular-resolution-with-slide-seqv2#study-summary</uri> (accessed on 17 July 2022) [<xref rid="B26-cells-12-00604" ref-type="bibr">26</xref>]. The Stereo-seq dataset of mouse olfactory bulb tissues can be downloaded from <uri xlink:href="https://db.cngb.org/search/project/CNP0001543/">https://db.cngb.org/search/project/CNP0001543/</uri> (accessed on 17 July 2022) [<xref rid="B27-cells-12-00604" ref-type="bibr">27</xref>]. The annotated function structures in Allen Brain Atlas are available at <uri xlink:href="https://atlas.brain-map.org/">https://atlas.brain-map.org/</uri> (accessed on 17 July 2022) [<xref rid="B24-cells-12-00604" ref-type="bibr">24</xref>]. SINFONIA is freely accessible at <uri xlink:href="https://sinfonia-svg.readthedocs.io/">https://sinfonia-svg.readthedocs.io/</uri> (accessed on 17 July 2022) under the MIT License, along with detailed tutorials and examples. It can be seamlessly integrated into existing analysis workflows. The source code is available at <uri xlink:href="https://github.com/BioX-NKU/SINFONIA">https://github.com/BioX-NKU/SINFONIA</uri> (accessed on 17 July 2022).</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Conflicts of Interest</title>
    <p>The authors declare no conflict of interest.</p>
  </notes>
  <ref-list>
    <title>References</title>
    <ref id="B1-cells-12-00604">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Svensson</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>S.A.</given-names>
          </name>
          <name>
            <surname>Stegle</surname>
            <given-names>O.</given-names>
          </name>
        </person-group>
        <article-title>SpatialDE: Identification of spatially variable genes</article-title>
        <source>Nat. Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>343</fpage>
        <lpage>346</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4636</pub-id>
        <?supplied-pmid 29553579?>
        <pub-id pub-id-type="pmid">29553579</pub-id>
      </element-citation>
    </ref>
    <ref id="B2-cells-12-00604">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hao</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Andersen-Nissen</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Mauck</surname>
            <given-names>W.M.</given-names>
            <suffix>III</suffix>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>M.J.</given-names>
          </name>
          <name>
            <surname>Wilk</surname>
            <given-names>A.J.</given-names>
          </name>
          <name>
            <surname>Darby</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Zager</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrated analysis of multimodal single-cell data</article-title>
        <source>Cell</source>
        <year>2021</year>
        <volume>184</volume>
        <fpage>3573</fpage>
        <lpage>3587.e29</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2021.04.048</pub-id>
        <?supplied-pmid 34062119?>
        <pub-id pub-id-type="pmid">34062119</pub-id>
      </element-citation>
    </ref>
    <ref id="B3-cells-12-00604">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Palla</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Spitzer</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Fischer</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Schaar</surname>
            <given-names>A.C.</given-names>
          </name>
          <name>
            <surname>Kuemmerle</surname>
            <given-names>L.B.</given-names>
          </name>
          <name>
            <surname>Rybakov</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Ibarra</surname>
            <given-names>I.L.</given-names>
          </name>
          <name>
            <surname>Holmberg</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Virshup</surname>
            <given-names>I.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Squidpy: A scalable framework for spatial omics analysis</article-title>
        <source>Nat. Methods</source>
        <year>2022</year>
        <volume>19</volume>
        <fpage>171</fpage>
        <lpage>178</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-021-01358-2</pub-id>
        <?supplied-pmid 35102346?>
        <pub-id pub-id-type="pmid">35102346</pub-id>
      </element-citation>
    </ref>
    <ref id="B4-cells-12-00604">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abdelaal</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Mourragui</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Mahfouz</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Reinders</surname>
            <given-names>M.J.T.</given-names>
          </name>
        </person-group>
        <article-title>SpaGE: Spatial Gene Enhancement using scRNA-seq</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2020</year>
        <volume>48</volume>
        <fpage>E107</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkaa740</pub-id>
        <?supplied-pmid 32955565?>
        <pub-id pub-id-type="pmid">32955565</pub-id>
      </element-citation>
    </ref>
    <ref id="B5-cells-12-00604">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Coleman</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Schroeder</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Irwin</surname>
            <given-names>D.J.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>E.B.</given-names>
          </name>
          <name>
            <surname>Shinohara</surname>
            <given-names>R.T.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>SpaGCN: Integrating gene expression, spatial location and histology to identify spatial domains and spatially variable genes by graph convolutional network</article-title>
        <source>Nat. Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <fpage>1342</fpage>
        <lpage>1351</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-021-01255-8</pub-id>
        <pub-id pub-id-type="pmid">34711970</pub-id>
      </element-citation>
    </ref>
    <ref id="B6-cells-12-00604">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Bao</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Computational elucidation of spatial gene expression variation from spatially resolved transcriptomics data</article-title>
        <source>Mol. Ther. Nucleic Acids</source>
        <year>2022</year>
        <volume>27</volume>
        <fpage>404</fpage>
        <lpage>411</lpage>
        <pub-id pub-id-type="doi">10.1016/j.omtn.2021.12.009</pub-id>
        <pub-id pub-id-type="pmid">35036053</pub-id>
      </element-citation>
    </ref>
    <ref id="B7-cells-12-00604">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lu</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Welch</surname>
            <given-names>J.D.</given-names>
          </name>
        </person-group>
        <article-title>PyLiger: Scalable single-cell multi-omic data integration in Python</article-title>
        <source>Bioinformatics</source>
        <year>2022</year>
        <volume>38</volume>
        <fpage>2946</fpage>
        <lpage>2948</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btac190</pub-id>
        <pub-id pub-id-type="pmid">35561174</pub-id>
      </element-citation>
    </ref>
    <ref id="B8-cells-12-00604">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wolf</surname>
            <given-names>F.A.</given-names>
          </name>
          <name>
            <surname>Angerer</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>F.J.</given-names>
          </name>
        </person-group>
        <article-title>SCANPY: Large-scale single-cell gene expression data analysis</article-title>
        <source>Genome Biol.</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>15</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1382-0</pub-id>
        <pub-id pub-id-type="pmid">29409532</pub-id>
      </element-citation>
    </ref>
    <ref id="B9-cells-12-00604">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gayoso</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Lopez</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Xing</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Boyeau</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Valiollah Pour Amiri</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Hong</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Jayasuriya</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Mehlman</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Langevin</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A Python library for probabilistic analysis of single-cell omics data</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2022</year>
        <volume>40</volume>
        <fpage>163</fpage>
        <lpage>166</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-021-01206-w</pub-id>
        <pub-id pub-id-type="pmid">35132262</pub-id>
      </element-citation>
    </ref>
    <ref id="B10-cells-12-00604">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bae</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Choi</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>D.S.</given-names>
          </name>
        </person-group>
        <article-title>Discovery of molecular features underlying the morphological landscape by integrating spatial transcriptomic data with deep features of tissue images</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2021</year>
        <volume>49</volume>
        <fpage>e55</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkab095</pub-id>
        <pub-id pub-id-type="pmid">33619564</pub-id>
      </element-citation>
    </ref>
    <ref id="B11-cells-12-00604">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>BinTayyash</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Georgaka</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>John</surname>
            <given-names>S.T.</given-names>
          </name>
          <name>
            <surname>Ahmed</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Boukouvalas</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Hensman</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Rattray</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Non-parametric modelling of temporal and spatial counts data from RNA-seq experiments</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>37</volume>
        <fpage>3788</fpage>
        <lpage>3795</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btab486</pub-id>
        <?supplied-pmid 34213536?>
        <pub-id pub-id-type="pmid">34213536</pub-id>
      </element-citation>
    </ref>
    <ref id="B12-cells-12-00604">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hao</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Hua</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X.</given-names>
          </name>
        </person-group>
        <article-title>SOMDE: A scalable method for identifying spatially variable genes with self-organizing map</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>37</volume>
        <fpage>4392</fpage>
        <lpage>4398</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btab471</pub-id>
        <?supplied-pmid 34165490?>
        <pub-id pub-id-type="pmid">34165490</pub-id>
      </element-citation>
    </ref>
    <ref id="B13-cells-12-00604">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>Q.</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Dries</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>G.C.</given-names>
          </name>
        </person-group>
        <article-title>Identification of spatially associated subpopulations by combining scRNAseq and sequential fluorescence in situ hybridization data</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>1183</fpage>
        <lpage>1190</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4260</pub-id>
        <?supplied-pmid 30371680?>
        <pub-id pub-id-type="pmid">30371680</pub-id>
      </element-citation>
    </ref>
    <ref id="B14-cells-12-00604">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dong</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Deciphering spatial domains from spatially resolved transcriptomics with an adaptive graph attention auto-encoder</article-title>
        <source>Nat. Commun.</source>
        <year>2022</year>
        <volume>13</volume>
        <fpage>1739</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-022-29439-6</pub-id>
        <pub-id pub-id-type="pmid">35365632</pub-id>
      </element-citation>
    </ref>
    <ref id="B15-cells-12-00604">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>stPlus: A reference-based method for the accurate enhancement of spatial transcriptomics</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>37</volume>
        <fpage>i299</fpage>
        <lpage>i307</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btab298</pub-id>
        <pub-id pub-id-type="pmid">34252941</pub-id>
      </element-citation>
    </ref>
    <ref id="B16-cells-12-00604">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeng</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>Statistical and machine learning methods for spatially resolved transcriptomics data analysis</article-title>
        <source>Genome Biol.</source>
        <year>2022</year>
        <volume>23</volume>
        <fpage>83</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-022-02653-7</pub-id>
        <pub-id pub-id-type="pmid">35337374</pub-id>
      </element-citation>
    </ref>
    <ref id="B17-cells-12-00604">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moran</surname>
            <given-names>P.A.</given-names>
          </name>
        </person-group>
        <article-title>Notes on continuous stochastic phenomena</article-title>
        <source>Biometrika</source>
        <year>1950</year>
        <volume>37</volume>
        <fpage>17</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="doi">10.1093/biomet/37.1-2.17</pub-id>
        <pub-id pub-id-type="pmid">15420245</pub-id>
      </element-citation>
    </ref>
    <ref id="B18-cells-12-00604">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Geary</surname>
            <given-names>R.C.</given-names>
          </name>
        </person-group>
        <article-title>The Contiguity Ratio and Statistical Mapping</article-title>
        <source>Inc. Stat.</source>
        <year>1954</year>
        <volume>5</volume>
        <fpage>115</fpage>
        <lpage>146</lpage>
        <pub-id pub-id-type="doi">10.2307/2986645</pub-id>
      </element-citation>
    </ref>
    <ref id="B19-cells-12-00604">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Virtanen</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Gommers</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Oliphant</surname>
            <given-names>T.E.</given-names>
          </name>
          <name>
            <surname>Haberland</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Reddy</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Cournapeau</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Burovski</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Peterson</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Weckesser</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Bright</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SciPy 1.0: Fundamental algorithms for scientific computing in Python</article-title>
        <source>Nat. Methods</source>
        <year>2020</year>
        <volume>17</volume>
        <fpage>261</fpage>
        <lpage>272</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id>
        <pub-id pub-id-type="pmid">32015543</pub-id>
      </element-citation>
    </ref>
    <ref id="B20-cells-12-00604">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lahnemann</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Koster</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Szczurek</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>D.J.</given-names>
          </name>
          <name>
            <surname>Hicks</surname>
            <given-names>S.C.</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>M.D.</given-names>
          </name>
          <name>
            <surname>Vallejos</surname>
            <given-names>C.A.</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>K.R.</given-names>
          </name>
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Mahfouz</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Eleven grand challenges in single-cell data science</article-title>
        <source>Genome Biol</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>31</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-020-1926-6</pub-id>
        <pub-id pub-id-type="pmid">32033589</pub-id>
      </element-citation>
    </ref>
    <ref id="B21-cells-12-00604">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pardo</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Spangler</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>L.M.</given-names>
          </name>
          <name>
            <surname>Page</surname>
            <given-names>S.C.</given-names>
          </name>
          <name>
            <surname>Hicks</surname>
            <given-names>S.C.</given-names>
          </name>
          <name>
            <surname>Jaffe</surname>
            <given-names>A.E.</given-names>
          </name>
          <name>
            <surname>Martinowich</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Maynard</surname>
            <given-names>K.R.</given-names>
          </name>
          <name>
            <surname>Collado-Torres</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>spatialLIBD: An R/Bioconductor package to visualize spatially-resolved transcriptomics data</article-title>
        <source>BMC Genom.</source>
        <year>2022</year>
        <volume>23</volume>
        <elocation-id>434</elocation-id>
        <pub-id pub-id-type="doi">10.1186/s12864-022-08601-w</pub-id>
        <?supplied-pmid 35689177?>
        <pub-id pub-id-type="pmid">35689177</pub-id>
      </element-citation>
    </ref>
    <ref id="B22-cells-12-00604">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maynard</surname>
            <given-names>K.R.</given-names>
          </name>
          <name>
            <surname>Collado-Torres</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>L.M.</given-names>
          </name>
          <name>
            <surname>Uytingco</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Barry</surname>
            <given-names>B.K.</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>S.R.</given-names>
          </name>
          <name>
            <surname>Catallini</surname>
            <given-names>J.L.</given-names>
            <suffix>II</suffix>
          </name>
          <name>
            <surname>Tran</surname>
            <given-names>M.N.</given-names>
          </name>
          <name>
            <surname>Besich</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Tippani</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptome-scale spatial gene expression in the human dorsolateral prefrontal cortex</article-title>
        <source>Nat. Neurosci.</source>
        <year>2021</year>
        <volume>24</volume>
        <fpage>425</fpage>
        <lpage>436</lpage>
        <pub-id pub-id-type="doi">10.1038/s41593-020-00787-0</pub-id>
        <pub-id pub-id-type="pmid">33558695</pub-id>
      </element-citation>
    </ref>
    <ref id="B23-cells-12-00604">
      <label>23.</label>
      <element-citation publication-type="webpage">
        <person-group person-group-type="author">
          <collab>10XGenomics</collab>
        </person-group>
        <article-title>Visium Spatial Gene Expression Reagent Kits User Guide</article-title>
        <year>2021</year>
        <comment>Available online: <ext-link xlink:href="https://www.10xgenomics.com/support/spatial-gene-expression-fresh-frozen/documentation/steps/library-construction/visium-spatial-gene-expression-reagent-kits-user-guide" ext-link-type="uri">https://www.10xgenomics.com/support/spatial-gene-expression-fresh-frozen/documentation/steps/library-construction/visium-spatial-gene-expression-reagent-kits-user-guide</ext-link></comment>
        <date-in-citation content-type="access-date" iso-8601-date="2022-07-17">(accessed on 17 July 2022)</date-in-citation>
      </element-citation>
    </ref>
    <ref id="B24-cells-12-00604">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sunkin</surname>
            <given-names>S.M.</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Lau</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Dolbeare</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Gilbert</surname>
            <given-names>T.L.</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>C.L.</given-names>
          </name>
          <name>
            <surname>Hawrylycz</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Dang</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>Allen Brain Atlas: An integrated spatio-temporal portal for exploring the central nervous system</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2013</year>
        <volume>41</volume>
        <fpage>D996</fpage>
        <lpage>D1008</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks1042</pub-id>
        <?supplied-pmid 23193282?>
        <pub-id pub-id-type="pmid">23193282</pub-id>
      </element-citation>
    </ref>
    <ref id="B25-cells-12-00604">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gracia Villacampa</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Larsson</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Mirzazadeh</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Kvastad</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Andersson</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Mollbrink</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Kokaraki</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Monteil</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Schultz</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Appelberg</surname>
            <given-names>K.S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide spatial expression profiling in formalin-fixed tissues</article-title>
        <source>Cell Genom.</source>
        <year>2021</year>
        <volume>1</volume>
        <fpage>100065</fpage>
        <pub-id pub-id-type="doi">10.1016/j.xgen.2021.100065</pub-id>
        <pub-id pub-id-type="pmid">36776149</pub-id>
      </element-citation>
    </ref>
    <ref id="B26-cells-12-00604">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stickels</surname>
            <given-names>R.R.</given-names>
          </name>
          <name>
            <surname>Murray</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Marshall</surname>
            <given-names>J.L.</given-names>
          </name>
          <name>
            <surname>Di Bella</surname>
            <given-names>D.J.</given-names>
          </name>
          <name>
            <surname>Arlotta</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Macosko</surname>
            <given-names>E.Z.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>F.</given-names>
          </name>
        </person-group>
        <article-title>Highly sensitive spatial transcriptomics at near-cellular resolution with Slide-seqV2</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2021</year>
        <volume>39</volume>
        <fpage>313</fpage>
        <lpage>319</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-0739-1</pub-id>
        <?supplied-pmid 33288904?>
        <pub-id pub-id-type="pmid">33288904</pub-id>
      </element-citation>
    </ref>
    <ref id="B27-cells-12-00604">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Liao</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Lai</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Qiu</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spatiotemporal transcriptomic atlas of mouse organogenesis using DNA nanoball-patterned arrays</article-title>
        <source>Cell</source>
        <year>2022</year>
        <volume>185</volume>
        <fpage>1777</fpage>
        <lpage>1792.e1721</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2022.04.003</pub-id>
        <pub-id pub-id-type="pmid">35512705</pub-id>
      </element-citation>
    </ref>
    <ref id="B28-cells-12-00604">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stuart</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Hafemeister</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Papalexi</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Mauck</surname>
            <given-names>W.M.</given-names>
            <suffix>3rd</suffix>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Stoeckius</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Smibert</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive Integration of Single-Cell Data</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>177</volume>
        <fpage>1888</fpage>
        <lpage>1902.e21</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2019.05.031</pub-id>
        <pub-id pub-id-type="pmid">31178118</pub-id>
      </element-citation>
    </ref>
    <ref id="B29-cells-12-00604">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Lareau</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Andreani</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Vinyard</surname>
            <given-names>M.E.</given-names>
          </name>
          <name>
            <surname>Garcia</surname>
            <given-names>S.P.</given-names>
          </name>
          <name>
            <surname>Clement</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Andrade-Navarro</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Buenrostro</surname>
            <given-names>J.D.</given-names>
          </name>
          <name>
            <surname>Pinello</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>Assessment of computational methods for the analysis of single-cell ATAC-seq data</article-title>
        <source>Genome Biol.</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>241</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1854-5</pub-id>
        <pub-id pub-id-type="pmid">31739806</pub-id>
      </element-citation>
    </ref>
    <ref id="B30-cells-12-00604">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Danese</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Richter</surname>
            <given-names>M.L.</given-names>
          </name>
          <name>
            <surname>Chaichoompu</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Fischer</surname>
            <given-names>D.S.</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>F.J.</given-names>
          </name>
          <name>
            <surname>Colome-Tatche</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>EpiScanpy: Integrated single-cell epigenomic analysis</article-title>
        <source>Nat. Commun.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>5228</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-25131-3</pub-id>
        <pub-id pub-id-type="pmid">34471111</pub-id>
      </element-citation>
    </ref>
    <ref id="B31-cells-12-00604">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Long</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>ASTER: Accurately estimating the number of cell types in single-cell chromatin accessibility data</article-title>
        <source>Bioinformatics</source>
        <year>2023</year>
        <volume>39</volume>
        <fpage>btac842</fpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btac842</pub-id>
        <pub-id pub-id-type="pmid">36610708</pub-id>
      </element-citation>
    </ref>
    <ref id="B32-cells-12-00604">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Z.</given-names>
          </name>
        </person-group>
        <article-title>RA3 is a reference-guided approach for epigenetic characterization of single cells</article-title>
        <source>Nat. Commun.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>2177</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-22495-4</pub-id>
        <?supplied-pmid 33846355?>
        <pub-id pub-id-type="pmid">33846355</pub-id>
      </element-citation>
    </ref>
    <ref id="B33-cells-12-00604">
      <label>33.</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Vinh</surname>
            <given-names>N.X.</given-names>
          </name>
          <name>
            <surname>Epps</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Information theoretic measures for clusterings comparison: Is a correction for chance necessary?</article-title>
        <source>Proceedings of the 26th Annual International Conference on Machine Learning</source>
        <conf-loc>Montreal, QC, Canada</conf-loc>
        <conf-date>14–18 June 2009</conf-date>
        <fpage>1073</fpage>
        <lpage>1080</lpage>
      </element-citation>
    </ref>
    <ref id="B34-cells-12-00604">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hubert</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Arabie</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>Comparing partitions</article-title>
        <source>J. Classif.</source>
        <year>1985</year>
        <volume>2</volume>
        <fpage>193</fpage>
        <lpage>218</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01908075</pub-id>
      </element-citation>
    </ref>
    <ref id="B35-cells-12-00604">
      <label>35.</label>
      <element-citation publication-type="webpage">
        <person-group person-group-type="author">
          <name>
            <surname>Rosenberg</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Hirschberg</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>V-Measure: A Conditional Entropy-Based External Cluster Evaluation Measure</article-title>
        <year>2007</year>
        <fpage>410</fpage>
        <lpage>420</lpage>
        <comment>Available online: <ext-link xlink:href="https://aclanthology.org/D07-1043.pdf" ext-link-type="uri">https://aclanthology.org/D07-1043.pdf</ext-link></comment>
        <date-in-citation content-type="access-date" iso-8601-date="2022-07-17">(accessed on 17 July 2022)</date-in-citation>
      </element-citation>
    </ref>
    <ref id="B36-cells-12-00604">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Strehl</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Ghosh</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Cluster ensembles—A knowledge reuse framework for combining multiple partitions</article-title>
        <source>J. Mach. Learn. Res.</source>
        <year>2003</year>
        <volume>3</volume>
        <fpage>583</fpage>
        <lpage>617</lpage>
        <pub-id pub-id-type="doi">10.1162/153244303321897735</pub-id>
      </element-citation>
    </ref>
    <ref id="B37-cells-12-00604">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Romano</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Vinh</surname>
            <given-names>N.X.</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Verspoor</surname>
            <given-names>K.</given-names>
          </name>
        </person-group>
        <article-title>Adjusting for chance clustering comparison measures</article-title>
        <source>J. Mach. Learn. Res.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>1</fpage>
        <lpage>32</lpage>
      </element-citation>
    </ref>
    <ref id="B38-cells-12-00604">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cao</surname>
            <given-names>Z.-J.</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <article-title>Multi-omics single-cell data integration and regulatory inference with graph-linked embedding</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2022</year>
        <volume>40</volume>
        <fpage>1458</fpage>
        <lpage>1466</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-022-01284-4</pub-id>
        <?supplied-pmid 35501393?>
        <pub-id pub-id-type="pmid">35501393</pub-id>
      </element-citation>
    </ref>
    <ref id="B39-cells-12-00604">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abdelaal</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Michielsen</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Cats</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Hoogduin</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Mei</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Reinders</surname>
            <given-names>M.J.T.</given-names>
          </name>
          <name>
            <surname>Mahfouz</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>A comparison of automatic cell identification methods for single-cell RNA sequencing data</article-title>
        <source>Genome Biol.</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>194</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1795-z</pub-id>
        <?supplied-pmid 31500660?>
        <pub-id pub-id-type="pmid">31500660</pub-id>
      </element-citation>
    </ref>
    <ref id="B40-cells-12-00604">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>H.</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of some aspects in supervised cell type identification for single-cell RNA-seq: Classifier, feature selection, and reference construction</article-title>
        <source>Genome Biol.</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>264</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-021-02480-2</pub-id>
        <?supplied-pmid 34503564?>
        <pub-id pub-id-type="pmid">34503564</pub-id>
      </element-citation>
    </ref>
    <ref id="B41-cells-12-00604">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Korsunsky</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Millard</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Slowikowski</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Baglaenko</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Brenner</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Loh</surname>
            <given-names>P.R.</given-names>
          </name>
          <name>
            <surname>Raychaudhuri</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Fast, sensitive and accurate integration of single-cell data with Harmony</article-title>
        <source>Nat. Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>1289</fpage>
        <lpage>1296</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0619-0</pub-id>
        <pub-id pub-id-type="pmid">31740819</pub-id>
      </element-citation>
    </ref>
    <ref id="B42-cells-12-00604">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shang</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X.</given-names>
          </name>
        </person-group>
        <article-title>Spatially Aware Dimension Reduction for Spatial Transcriptomics</article-title>
        <source>Nat. Commun.</source>
        <year>2022</year>
        <volume>13</volume>
        <fpage>7203</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-022-34879-1</pub-id>
        <pub-id pub-id-type="pmid">36418351</pub-id>
      </element-citation>
    </ref>
    <ref id="B43-cells-12-00604">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mangul</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>L.S.</given-names>
          </name>
          <name>
            <surname>Eskin</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Blekhman</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Improving the usability and archival stability of bioinformatics software</article-title>
        <source>Genome Biol.</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>47</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1649-8</pub-id>
        <pub-id pub-id-type="pmid">30813962</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig position="float" id="cells-12-00604-f001">
    <label>Figure 1</label>
    <caption>
      <p>The framework of SINFONIA.</p>
    </caption>
    <graphic xlink:href="cells-12-00604-g001" position="float"/>
  </fig>
  <fig position="float" id="cells-12-00604-f002">
    <label>Figure 2</label>
    <caption>
      <p>Louvain clustering results with (<bold>A</bold>) default resolution and (<bold>B</bold>) searched resolution (given a specified number of clusters) on 12 DLPFC datasets. Leiden clustering results with (<bold>C</bold>) default resolution and (<bold>D</bold>) searched resolution on 12 DLPFC datasets.</p>
    </caption>
    <graphic xlink:href="cells-12-00604-g002" position="float"/>
  </fig>
  <fig position="float" id="cells-12-00604-f003">
    <label>Figure 3</label>
    <caption>
      <p>Louvain clustering results with (<bold>A</bold>) default resolution and (<bold>B</bold>) searched resolution on the MBC dataset. Leiden clustering results with (<bold>C</bold>) default resolution and (<bold>D</bold>) searched resolution on the MBC dataset.</p>
    </caption>
    <graphic xlink:href="cells-12-00604-g003" position="float"/>
  </fig>
  <fig position="float" id="cells-12-00604-f004">
    <label>Figure 4</label>
    <caption>
      <p>(<bold>A</bold>) Performance of MAP and MCVA on the 12 DLPFC datasets. (<bold>B</bold>) Performance of iLISImd and iLISIm on the 12 DLPFC datasets. (<bold>C</bold>) Performance of MAP, MCVA, iLISImd and iLISIm on the MBC dataset.</p>
    </caption>
    <graphic xlink:href="cells-12-00604-g004" position="float"/>
  </fig>
  <fig position="float" id="cells-12-00604-f005">
    <label>Figure 5</label>
    <caption>
      <p>Visualization of datasets of (<bold>A</bold>) a mouse hippocampus and (<bold>B</bold>) a mouse olfactory bulb with tissue regions annotated from the Allen Brain Atlas and spatial domains detected by different methods.</p>
    </caption>
    <graphic xlink:href="cells-12-00604-g005" position="float"/>
  </fig>
  <fig position="float" id="cells-12-00604-f006">
    <label>Figure 6</label>
    <caption>
      <p>(<bold>A</bold>) <italic toggle="yes">p</italic>-values of two-sided Wilcoxon signed-rank tests on the performance of different numbers of SVGs identified by SINFONIA. (<bold>B</bold>) Computation time of different methods on 12 DLPFC datasets. (<bold>C</bold>) Computation time of different implementations for calculating spatial autocorrelation statistics on 12 DLPFC datasets.</p>
    </caption>
    <graphic xlink:href="cells-12-00604-g006" position="float"/>
  </fig>
  <fig position="float" id="cells-12-00604-f007">
    <label>Figure 7</label>
    <caption>
      <p>Performance improvement of STAGATE using SINFONIA on (<bold>A</bold>) the 12 DLPFC datasets and (<bold>B</bold>) the MBC dataset. The performance of spatial clustering, domain resolution and prediction ability were evaluated.</p>
    </caption>
    <graphic xlink:href="cells-12-00604-g007" position="float"/>
  </fig>
  <table-wrap position="float" id="cells-12-00604-t001">
    <object-id pub-id-type="pii">cells-12-00604-t001_Table 1</object-id>
    <label>Table 1</label>
    <caption>
      <p>Summary of the fifteen benchmarking datasets.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Dataset</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1"># of Spots</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1"># of Genes</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1"># of Domains</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Sparsity</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Protocol</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Species</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Reference</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">DLPFC_151507</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">4221</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">33,538</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">7</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.958</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">10X Visium</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">
            <italic toggle="yes">Homo sapiens</italic>
          </td>
          <td align="center" valign="middle" rowspan="1" colspan="1">[<xref rid="B22-cells-12-00604" ref-type="bibr">22</xref>]</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">DLPFC_151508</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">4381</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">33,538</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">7</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.964</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">10X Visium</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">
            <italic toggle="yes">Homo sapiens</italic>
          </td>
          <td align="center" valign="middle" rowspan="1" colspan="1">[<xref rid="B22-cells-12-00604" ref-type="bibr">22</xref>]</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">DLPFC_151509</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">4788</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">33,538</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">7</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.957</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">10X Visium</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">
            <italic toggle="yes">Homo sapiens</italic>
          </td>
          <td align="center" valign="middle" rowspan="1" colspan="1">[<xref rid="B22-cells-12-00604" ref-type="bibr">22</xref>]</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">DLPFC_151510</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">4595</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">33,538</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">7</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.959</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">10X Visium</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">
            <italic toggle="yes">Homo sapiens</italic>
          </td>
          <td align="center" valign="middle" rowspan="1" colspan="1">[<xref rid="B22-cells-12-00604" ref-type="bibr">22</xref>]</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">DLPFC_151669</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">3636</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">33,538</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">5</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.946</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">10X Visium</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">
            <italic toggle="yes">Homo sapiens</italic>
          </td>
          <td align="center" valign="middle" rowspan="1" colspan="1">[<xref rid="B22-cells-12-00604" ref-type="bibr">22</xref>]</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">DLPFC_151670</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">3484</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">33,538</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">5</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.950</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">10X Visium</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">
            <italic toggle="yes">Homo sapiens</italic>
          </td>
          <td align="center" valign="middle" rowspan="1" colspan="1">[<xref rid="B22-cells-12-00604" ref-type="bibr">22</xref>]</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">DLPFC_151671</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">4093</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">33,538</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">5</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.945</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">10X Visium</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">
            <italic toggle="yes">Homo sapiens</italic>
          </td>
          <td align="center" valign="middle" rowspan="1" colspan="1">[<xref rid="B22-cells-12-00604" ref-type="bibr">22</xref>]</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">DLPFC_151672</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">3888</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">33,538</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">5</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.947</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">10X Visium</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">
            <italic toggle="yes">Homo sapiens</italic>
          </td>
          <td align="center" valign="middle" rowspan="1" colspan="1">[<xref rid="B22-cells-12-00604" ref-type="bibr">22</xref>]</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">DLPFC_151673</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">3611</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">33,538</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">7</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.934</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">10X Visium</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">
            <italic toggle="yes">Homo sapiens</italic>
          </td>
          <td align="center" valign="middle" rowspan="1" colspan="1">[<xref rid="B22-cells-12-00604" ref-type="bibr">22</xref>]</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">DLPFC_151674</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">3635</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">33,538</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">7</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.920</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">10X Visium</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">
            <italic toggle="yes">Homo sapiens</italic>
          </td>
          <td align="center" valign="middle" rowspan="1" colspan="1">[<xref rid="B22-cells-12-00604" ref-type="bibr">22</xref>]</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">DLPFC_151675</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">3566</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">33,538</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">7</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.946</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">10X Visium</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">
            <italic toggle="yes">Homo sapiens</italic>
          </td>
          <td align="center" valign="middle" rowspan="1" colspan="1">[<xref rid="B22-cells-12-00604" ref-type="bibr">22</xref>]</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">DLPFC_151676</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">3431</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">33,538</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">7</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.942</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">10X Visium</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">
            <italic toggle="yes">Homo sapiens</italic>
          </td>
          <td align="center" valign="middle" rowspan="1" colspan="1">[<xref rid="B22-cells-12-00604" ref-type="bibr">22</xref>]</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Brain coronal</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">2800</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">32,285</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">15</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.870</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">10X Visium</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">
            <italic toggle="yes">Mus musculus</italic>
          </td>
          <td align="center" valign="middle" rowspan="1" colspan="1">[<xref rid="B23-cells-12-00604" ref-type="bibr">23</xref>]</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Hippocampus</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">53,208</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">23,264</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">-</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.982</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">Slide-seqV2</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">
            <italic toggle="yes">Mus musculus</italic>
          </td>
          <td align="center" valign="middle" rowspan="1" colspan="1">[<xref rid="B26-cells-12-00604" ref-type="bibr">26</xref>]</td>
        </tr>
        <tr>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Olfactory bulb</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">19,527</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">27,106</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">-</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.987</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Stereo-seq</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">
            <italic toggle="yes">Mus musculus</italic>
          </td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">[<xref rid="B27-cells-12-00604" ref-type="bibr">27</xref>]</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</floats-group>
