<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.6.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art560.dtd?>
<?SourceDTD.Version 5.6.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin publisher?>
<?FILEmeta_CSBJ1471 xml ?>
<?FILEmain xml ?>
<?FILEmain pdf ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<?FILEgr3 jpg ?>
<?FILEgr4 jpg ?>
<?FILEgr5 jpg ?>
<?FILEgr6 jpg ?>
<?FILEmmc1 pdf ?>
<?FILEmmc2 zip ?>
<?FILEmmc3 zip ?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Comput Struct Biotechnol J</journal-id>
    <journal-id journal-id-type="iso-abbrev">Comput Struct Biotechnol J</journal-id>
    <journal-title-group>
      <journal-title>Computational and Structural Biotechnology Journal</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2001-0370</issn>
    <publisher>
      <publisher-name>Research Network of Computational and Structural Biotechnology</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9034014</article-id>
    <article-id pub-id-type="pii">S2001-0370(22)00117-9</article-id>
    <article-id pub-id-type="doi">10.1016/j.csbj.2022.03.042</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>UPIMAPI, reCOGnizer and KEGGCharter: Bioinformatics tools for functional annotation and visualization of (meta)-omics datasets</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="au005">
        <name>
          <surname>Sequeira</surname>
          <given-names>João C.</given-names>
        </name>
        <xref rid="af005" ref-type="aff">a</xref>
        <xref rid="af010" ref-type="aff">b</xref>
      </contrib>
      <contrib contrib-type="author" id="au010">
        <name>
          <surname>Rocha</surname>
          <given-names>Miguel</given-names>
        </name>
        <xref rid="af005" ref-type="aff">a</xref>
        <xref rid="af010" ref-type="aff">b</xref>
      </contrib>
      <contrib contrib-type="author" id="au015">
        <name>
          <surname>Alves</surname>
          <given-names>M. Madalena</given-names>
        </name>
        <xref rid="af005" ref-type="aff">a</xref>
        <xref rid="af010" ref-type="aff">b</xref>
      </contrib>
      <contrib contrib-type="author" id="au020">
        <name>
          <surname>Salvador</surname>
          <given-names>Andreia F.</given-names>
        </name>
        <email>asalvador@ceb.uminho.pt</email>
        <xref rid="af005" ref-type="aff">a</xref>
        <xref rid="af010" ref-type="aff">b</xref>
        <xref rid="cor1" ref-type="corresp">⁎</xref>
      </contrib>
      <aff id="af005"><label>a</label>CEB - Centre of Biological Engineering, University of Minho, 4710-057 Braga, Portugal</aff>
      <aff id="af010"><label>b</label>LABBELS – Associate Laboratory, Braga/Guimarães, Portugal</aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>⁎</label>Corresponding author at: Universidade do Minho, Centro de Engenharia Biológica, Campus de Gualtar, 4710-057 Braga, Portugal. <email>asalvador@ceb.uminho.pt</email></corresp>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>09</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.-->
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>09</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <volume>20</volume>
    <fpage>1798</fpage>
    <lpage>1810</lpage>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>7</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>31</day>
        <month>3</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>3</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2022 The Authors. Published by Elsevier B.V. on behalf of Research Network of Computational and Structural Biotechnology.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder/>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbyncndlicense">https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref>
        <license-p>This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).</license-p>
      </license>
    </permissions>
    <abstract id="ab005">
      <p>Omics and meta-omics technologies are powerful approaches to explore microorganisms’ functions, but the sheer size and complexity of omics datasets often turn the analysis into a challenging task. Software developed for omics and <italic>meta</italic>-omics analyses, together with knowledgebases encompassing information on genes, proteins, taxonomic and functional annotation, among other types of information, are valuable resources for analyzing omics data. Although several bioinformatics resources are available for <italic>meta</italic>-omics analyses, many require significant computational expertise. Web interfaces are more user-friendly, but often struggle to handle large data files, such as those obtained in metagenomics, metatranscriptomics, or metaproteomics experiments.</p>
      <p>In this work, we present three novel bioinformatics tools, which are available through user-friendly command-line interfaces, can be run sequentially or stand-alone, and combine popular resources for functional annotation. UPIMAPI performs sequence homology-based annotation and obtains data from UniProtKB (e.g., protein names, EC numbers, Gene Ontology, Taxonomy, cross-references to external databases). reCOGnizer performs multithreaded domain homology-based annotation of protein sequences with several functional databases (i.e., CDD, NCBIfam, Pfam, Protein Clusters, SMART, TIGRFAM, COG and KOG) and in addition, obtains information on domain names and descriptions and EC numbers. KEGGCharter represents omics results, including differential gene expression, in KEGG metabolic pathways. In addition, it shows the taxonomic assignment of the enzymes represented, which is particularly useful in metagenomics studies in which several microorganisms are present.</p>
      <p>reCOGnizer, UPIMAPI and KEGGCharter together provide a comprehensive and complete functional characterization of large datasets, facilitating the interpretation of microbial activities in nature and in biotechnological processes.</p>
    </abstract>
    <kwd-group id="kg005">
      <title>Keywords</title>
      <kwd>Genomics</kwd>
      <kwd>Metagenomics</kwd>
      <kwd>Metatranscriptomics</kwd>
      <kwd>Functional annotation</kwd>
      <kwd>Metabolic pathways mapping</kwd>
      <kwd>Differential expression analysis</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec id="s0005">
    <label>1</label>
    <title>Introduction</title>
    <p id="p0005">Current high-throughput sequencing technologies produce valuable information to characterize microbial communities in terms of taxonomic composition and functional behavior. The biological interpretation of such big datasets benefits from easy-to-use tools, that automatically convert raw data into comprehensive information, ideally with minor input from users and reduced time of analysis.</p>
    <p id="p0010">Generally, bioinformatics tools used for metagenomics (MG) and other <italic>meta</italic>-omics analyses (e.g., metatranscriptomics (MT) and metaproteomics (MP)) perform taxonomic and functional annotations, thus linking microbial identity to function in complex microbial communities. The most popular methodology for gene/protein annotation consists in inferring function based on sequence homology, using sequence alignment tools such as BLAST, DIAMOND, lastal, or MMSeq2, among others <xref rid="b0005" ref-type="bibr">[1]</xref>. These tools find similarities between gene or protein sequences present in biological samples, and those in reference databases. The most popular reference databases for homology-based annotation are UniProtKB <xref rid="b0010" ref-type="bibr">[2]</xref> and RefSeq <xref rid="b0015" ref-type="bibr">[3]</xref>. An advantage of using the UniProtKB as the reference database for protein annotation is the possibility of obtaining complementary information from several other databases (e.g., BioCyc, BRENDA, PDB, RefSeq, CDD, KEGG, InterPro, PRIDE, eggNOG, Ensembl), by using the UniProt ID mapping service (available at <ext-link ext-link-type="uri" xlink:href="https://www.uniprot.org/uploadlists/" id="ir005">https://www.uniprot.org/uploadlists/</ext-link>).</p>
    <p id="p0015">In <italic>meta</italic>-omics experiments, it is common that the majority of genes and proteins are not annotated, as a significant number of genomes are not sequenced, or are poorly annotated, which results in a significant amount of proteins identified as “putative” or “uncharacterized” <xref rid="b0020" ref-type="bibr">[4]</xref>. Using sequence homology annotation, proteins with low sequence similarity, but with the same function, may not be annotated <xref rid="b0020" ref-type="bibr">[4]</xref>. Allying sequence homology-based annotation to, for example, annotation based in protein conserved domains maximizes function assignment and better reflects microbial functions in complex communities <xref rid="b0020" ref-type="bibr">[4]</xref>, <xref rid="b0025" ref-type="bibr">[5]</xref>. A well-known protein domain database is the Conserved Domains Database (CDD), which includes the Cluster of Orthologous Groups of proteins (COG), and is a manually curated collection of protein profiles and domains, represented as Hidden Markov Models (HMMs) <xref rid="b0030" ref-type="bibr">[6]</xref>. COG is one of the most used resources for protein functional characterization and is recommended by the Genome Standards Consortium to characterize newly published genomes <xref rid="b0020" ref-type="bibr">[4]</xref>.</p>
    <p id="p0020">Web-based applications performing functional annotation using the COG database as reference include WebMGA and the NCBI’s Batch CD-search <xref rid="b0035" ref-type="bibr">[7]</xref>. WebMGA performs annotation with HMMER3, and PFAM and TIGRFAM databases as reference, and with RPS-BLAST using COG, KOG and Protein Clusters databases as reference <xref rid="b0040" ref-type="bibr">[8]</xref>. The Batch CD-search service performs annotation with the models present in the CDD database, which include PFAM, TIGRFAM, Protein Clusters, NCBIfam, SMART, COG and KOG. Web-based applications depend on webservers that limit the number of sequences that can be submitted simultaneously, turning the process slower, and requiring that the datasets are split before analysis. Thus, using command-line tools may be advantageous, as it is the case of DFAST, which uses GHOSTX or BLASTP for protein alignment against a reference database containing 124 well-curated prokaryotic genomes, and RPS-BLAST and HMMER for protein functional annotation based on the COG and TIGRFAM databases <xref rid="b0045" ref-type="bibr">[9]</xref>. Prokka, another command-line tool, uses BLAST+ blastp and HMMER for annotation based in sequence and domain homology, respectively, using a series of databases as reference, which includes user-set databases, good-quality protein sequences from UniProt and RefSeq, Pfam and TIGRFAM <xref rid="b0050" ref-type="bibr">[10]</xref>. eggNOG-mapper <xref rid="b0055" ref-type="bibr">[11]</xref> and Mantis <xref rid="b0060" ref-type="bibr">[12]</xref> are also command-line tools that perform functional annotation by using HMMER and DIAMOND. eggNOG-mapper annotates protein sequences with reference to the eggNOG database, while Mantis performs annotation with a larger set of reference databases, i.e., eggNOG, Pfam, KOfam, TIGRfam, and NCBIfam <xref rid="b0060" ref-type="bibr">[12]</xref>.</p>
    <p id="p0025">Even though these tools provide diverse methods for gene/protein annotation, there is no tool allowing complete retrieval of information from UniProt’s ID mapping, preceded by sequence homology annotation. Also, none of these tools include all the databases available at CDD, while avoiding the use of web servers.</p>
    <p id="p0030">Several other tools have been developed to facilitate the interpretation of functional annotation results and represent the identified genes or proteins in metabolic pathways. The Kyoto Encyclopedia of Genes and Genomes (KEGG) database provides many functionalities to explore metabolic and regulatory networks through interactions between enzymes and metabolites <xref rid="b0065" ref-type="bibr">[13]</xref>. Most resources are accessed through the KEGG Orthology database, where for each function a K number, or a KEGG Ortholog (KO), is assigned <xref rid="b0065" ref-type="bibr">[13]</xref>. KEGG Pathway provides hundreds of hand-drawn maps that represent different metabolic pathways, and that can be customized to represent functions of interest, with these functions identified by their KOs. This visualization helps to understand the intricate relations between different enzymes <xref rid="b0070" ref-type="bibr">[14]</xref>.</p>
    <p id="p0035">Some tools have been developed to represent functions of interest in KEGG’s metabolic maps. For example, KEGG Mapper offers a collection of tools that connect the databases of KEGG, e.g., “Reconstruct Pathway”, which maps KOs to PATHWAY’s maps, and “Color Pathway” which expands the mapping of KOs with the option to color differently the identified boxes <xref rid="b0075" ref-type="bibr">[15]</xref>. iPath3.0 is a tool that produces interactive plots, where detailed descriptions of the pathway reactions can be accessed by hovering the corresponding elements in the metabolic maps <xref rid="b0080" ref-type="bibr">[16]</xref>. The Pathway Projector tool provides a Zoomable User Interface that allows the visualization of the entire global metabolic map of KEGG <xref rid="b0085" ref-type="bibr">[17]</xref>. PathCase is another web service, which integrates information from several different sources, including KEGG and BioCyc, to build custom functional maps. These custom maps allow PathCase to provide querying for different levels of detail (at the organisms, biochemistry, molecular or genetic level) directly on the maps <xref rid="b0090" ref-type="bibr">[18]</xref>. SQMTools is an R package that analyzes results from SqueezeMeta, a MG and MT data analysis pipeline, and can be used to represent differential gene expression between two samples through a color gradient <xref rid="b0095" ref-type="bibr">[19]</xref>. KEGGprofile is an R package that represents expression profiles in KEGG maps <xref rid="b0100" ref-type="bibr">[20]</xref>. MEGAN, a popular MG annotation pipeline, also represents results in KEGG Pathways <xref rid="b0105" ref-type="bibr">[21]</xref>. However, there is no automated tool that, from a simple table of information, represents the functional characterization of MG/MT/MP datasets in metabolic pathways.</p>
    <p id="p0040">In this work, we present three command-line bioinformatics tools, UPIMAPI, reCOGnizer and KEGGCharter, developed for functional annotation with multiple databases, and representation of <italic>meta</italic>-omics data in metabolic pathways. After performing sequence-based annotation, UPIMAPI allows to obtain information on UniProt IDs, and after performing domain-based annotation with several databases, reCOGnizer obtains taxonomic classifications, EC numbers, and COG categories. Finally, KEGGCharter represents functional potential, taxonomy and differential gene expression in KEGG metabolic maps. All these functionalities are accessed through completely automated workflows.</p>
  </sec>
  <sec id="s0010">
    <label>2</label>
    <title>Methods</title>
    <sec id="s0015">
      <label>2.1</label>
      <title>Development of UPIMAPI tool for taxonomic and functional annotation</title>
      <p id="p0045">UPIMAPI (UniProt’s Id Mapping through API) was developed with Python 3 and combines automatic construction of reference databases, sequence-based annotation with DIAMOND, and retrieval of information from UniProt (<xref rid="f0005" ref-type="fig">Fig. 1</xref>). UPIMAPI constructs reference databases in three different ways (<xref rid="f0005" ref-type="fig">Fig. 1</xref>, step 1), which should be chosen by the user through the “--database” parameter: if “uniprot” is chosen, UPIMAPI will download the entire UniProt database, and use it as the reference; similarly, if “swissprot” is chosen, the SwissProt database will be downloaded and used; finally, if “taxids” is chosen, a selection of tax IDs must be inputted through the “--taxids” parameter, and UPIMAPI will download the reference proteomes corresponding to those tax IDs through UniProt’s Taxonomy database and use it as the reference database. A custom database can also be inputted directly to UPIMAPI in FASTA or DMND (DIAMOND binary) format, but it must contain UniProt IDs in the headers, in the right format (e.g., “sp|Q74FU6|SFRA_GEOSL”). UPIMAPI also downloads the versions of the UniProt Knowledgebase, the UniProtKB/SwissProt, and the UniProtKB/TrEMBL.<fig id="f0005"><label>Fig. 1</label><caption><p>Workflow of UPIMAPI, which includes the first step of sequence-based annotation with DIAMOND and a second step where functional information is obtained from the UniProtKB, including cross-references to other databases. Green icons represent input files (i.e., FASTA protein sequences, reference database, and UniProt IDs either through a BLAST result file, a TXT file, or directly through the CLI), orange icons represent intermediate files (BLAST result file), and blue icons represent output files, i.e., TSV files containing information from UniProtKB (including cross-references to several databases), and FASTA files containing the annotated protein sequences. Database logos identify some databases from which information can be obtained through UPIMAPI. The pink box identifies the different possibilities to submit the IDs to the UniProt ID mapping.</p></caption><graphic xlink:href="gr1"/></fig></p>
      <p id="p0050">Annotation with DIAMOND takes as input the query protein sequences (in FASTA format) and the reference database (<xref rid="f0005" ref-type="fig">Fig. 1</xref>, step 2). An additional perk of UPIMAPI is the automatic determination of the optimal parameter values for running DIAMOND, i.e., the number of threads, block size, and index chunks – with the last two increasing annotation speed at the cost of higher memory usage. The automatic number of threads is the number of threads available minus 2, the automatic block size is set as the amount of memory available in Gb divided by 20, and the automatic number of index chunks is set as 1, 2, 3, or 4 depending on if the block size is over 3, between 2 and 3, between 1 and 2, or 1 or less, respectively. The default E-value is 1e-3, determined as described in <xref rid="s0085" ref-type="sec">SI (Section 1.6)</xref>. If the user wants to manually alter these parameters, this can be done directly through the CLI. UniProt IDs are obtained after annotation with DIAMOND (<xref rid="f0005" ref-type="fig">Fig. 1</xref>, step 2) and are automatically submitted to the UniProt ID mapping (<xref rid="f0005" ref-type="fig">Fig. 1</xref>, step 3).</p>
      <p id="p0055">Mapping of IDs follows two different implementations: (a) mapping through UniProt’s API, using urllib to sequentially submit batch requests, and parsing and storing the information obtained in local storage; and (b) local mapping of SwissProt IDs (to use if the input data have SwissProt IDs), that does the download of the SwissProt’s DAT file from UniProt’s FTP site (<xref rid="s0085" ref-type="sec">Table S2</xref>), which is then parsed and queried with BioPython <xref rid="b0110" ref-type="bibr">[22]</xref>. The information obtained with this last option is parsed to be as close as possible to the information obtained through the API and then it is also stored locally. UPIMAPI offers the possibility of submitting UniProt IDs directly to the ID mapping, skipping the annotation step, i.e., outfmt6 files resulting from sequence alignment, either with DIAMOND (without using UPIMAPI) or BLASTp, TXT files with UniProt IDs separated by commas, or UniProt IDs directly inputted through the command line (<xref rid="f0005" ref-type="fig">Fig. 1</xref>, pink box). Requests to the Uniprot API are performed by using the following default parameters: 10,000 IDs per request, and 3 s between requests. The user can also choose the fields of information to be retrieved from the UniProtKB through the command line. Otherwise, UPIMAPI will use a default list of fields to be outputted (<xref rid="s0085" ref-type="sec">Table S1</xref>). UPIMAPI organizes the information in “columns” and “databases”: “Columns” correspond to functional, taxonomic, expression, structural, and additional information stored at UniProt (e.g., “Gene names”, “Protein names”, “EC number”, “Pathway”, “Gene ontology (GO)”, “Taxonomic lineage”); “Databases” correspond to cross-references between UniProt and external databases, such as BioCyc, BRENDA, PDB, RefSeq, CDD, KEGG, InterPro, PRIDE, eggNOG, Ensembl, among others. These parameters may be changed by the user if necessary, through the command line. Examples and explanations of commands to install and run UPIMAPI are given in <xref rid="s0085" ref-type="sec">SI (Section 1.4.1)</xref>.</p>
    </sec>
    <sec id="s0020">
      <label>2.2</label>
      <title>Development of reCOGnizer tool for domain-based functional annotation</title>
      <p id="p0060">reCOGnizer combines HMM databases construction with domain-based annotation and retrieves the information obtained from the annotation with different databases (<xref rid="f0010" ref-type="fig">Fig. 2</xref>).<fig id="f0010"><label>Fig. 2</label><caption><p>Workflow of reGOGnizer: construction of databases (step 1); domain-based annotation of inputted protein sequences with the reference databases (step 3), after splitting the input sequences into multiple FASTA files (step 2); post-processing of annotation results (steps 4 and 5); interconversion of CDD IDs to other databases IDs (step 6) and retrieval of information from several databases, by using relational tables (step 7); output the annotation information in TSV, Excel and HTML report files (step 8). Web icons represent resources retrieved from the web, specifically the domain models from CDD and the relational tables from NCBI, COG, eggNOG, and SMART. The green icons represent the input files (FASTA protein sequences and the file containing the taxonomic information), the orange icons represent intermediate files generated during the analyses (input protein sequences split into multiple FASTA files and the annotation results in ASN and TSV formats), and the blue icons represent the output files.</p></caption><graphic xlink:href="gr2"/></fig></p>
      <p id="p0065">For database construction, the Position Specific Scoring Matrices (PSSMs) are first retrieved from CDD through NCBI’s FTP site, and then two different workflows can be followed: (a) a taxonomic workflow (<xref rid="f0010" ref-type="fig">Fig. 2</xref>, step 1a), which is applied to Pfam, NCBIfam, Protein Clusters, TIGRFAM, and COG databases, and which splits the SMP files by the respective taxonomy assigned as detailed in the hmm_PGAP and NOG.members relation tables (<xref rid="s0085" ref-type="sec">Table S2</xref>); and (b) a more general workflow (<xref rid="f0010" ref-type="fig">Fig. 2</xref>, step 1b), applied to all databases, which builds the databases in a similar structure as the one available in the “little_endian” directory (<ext-link ext-link-type="uri" xlink:href="https://ftp.ncbi.nlm.nih.gov/pub/mmdb/cdd/little_endian/" id="ir010">https://ftp.ncbi.nlm.nih.gov/pub/mmdb/cdd/little_endian/</ext-link>), containing all the SMPs of each database. These databases are built using the makeprofiledb tool with default parameters. reCOGnizer also downloads the version of the CDD database. Domain-based annotation is performed with Reverse PSI-BLAST (RPS-BLAST), a variant of PSI-BLAST <xref rid="b0115" ref-type="bibr">[23]</xref>, and may follow two different workflows, depending on the availability of taxonomic information. A taxonomic file can be used to detail the tax IDs for each protein and is specified with the parameter “--tax-file”, while the column with the proteins IDs (as they are in the FASTA file) and corresponding tax IDs must be specified with the “--protein-id-col” and “--tax-col” parameters, respectively. In this case, reCOGnizer will apply the taxonomic workflow for annotation with Pfam, NCBIfam, Protein Clusters, TIGRFAM, and COG databases. For this purpose, reCOGnizer splits the FASTA file into the different tax IDs and then, for each tax ID specified in the taxonomic file, reCOGnizer retrieves the tax IDs of the entire lineage (from the taxonomy.rdf file, <xref rid="s0085" ref-type="sec">Table S2</xref>) and uses the partial databases corresponding to those tax IDs together as reference (<xref rid="f0010" ref-type="fig">Fig. 2</xref>, step 3a). A more general workflow, which annotates all sequences against all HMMs present in the database, is applied for annotation with CDD, KOG and SMART databases, and for the remaining databases if taxonomic information is not provided by the user. In this taxonomy-independent annotation workflow, the entire databases are used as the reference for annotation (<xref rid="f0010" ref-type="fig">Fig. 2</xref>, step 3b). Before the annotation step, reCOGnizer splits the FASTA files into the number of threads to be used to achieve parallelization, which increases the speed of the analysis (<xref rid="f0010" ref-type="fig">Fig. 2</xref>, step 2). The default E-value for annotation is 1e-3, determined as described in <xref rid="s0085" ref-type="sec">SI (Section 1.6)</xref>, which can be changed through the CLI. There is also the option of annotating only with a specified set of databases, by using the “--databases” parameter (e.g., --databases COG,Pfam – to annotate only with COG and Pfam databases).</p>
      <p id="p0070">The annotation results are obtained in ASN (outfmt11) reports, which are inputted to the rpsbproc tool for multi-domain solving (<xref rid="f0010" ref-type="fig">Fig. 2</xref>, step 4). rpsbproc processes the annotation results providing a non-redundant list of conserved domains that do not overlap in the query sequences, which bypasses the problems of considering only the first annotation for proteins with several domains for several functions. ASN reports are converted into TSV (outfmt6) reports, with the blast_formatter tool (<xref rid="f0010" ref-type="fig">Fig. 2</xref>, step 5), to facilitate the visualization of the annotation results and respective metrics. At the end of the workflow, CDD IDs, obtained from the annotation in the previous steps, are converted to the IDs of the other databases (i.e., Pfam, NCBIfam, Protein Clusters, TIGRFAM, SMART, CDD, COG, and KOG databases) using the “cddid.tbl” relational table (<xref rid="f0010" ref-type="fig">Fig. 2</xref>, step 6). From this relational table, a domain description from CDD is also obtained.</p>
      <p id="p0075">Once the protein IDs from the 8 databases are obtained, additional functional information is collected (<xref rid="f0010" ref-type="fig">Fig. 2</xref>, step 7), namely: COG functional categories and protein descriptions, by ID mapping of COG and KOG IDs with “cog-20.def.tab” and “kog” files, respectively; COG general functional categories, by mapping the obtained categories with “fun-20.tab”; EC numbers and KOs, by mapping COG IDs with eggNOG’s (Huerta-cepas et al., 2019) files “NOG.members.tsv” and “egg-nog4.protein_id_conversion.tsv”; domain names, EC numbers and taxonomic classifications, obtained by mapping NCBIfam, Pfam, Protein Clusters and TIGRFAM IDs with the “hmm_PGAP.tsv” file; and SMART descriptions, by mapping SMART IDs with the “<ext-link ext-link-type="uri" xlink:href="http://descriptions.pl" id="ir015">descriptions.pl</ext-link>” file.</p>
      <p id="p0080">Web locations of relational tables used by reCOGnizer, and the CDD tarball containing the HMM models of the databases, are given in <xref rid="s0085" ref-type="sec">Table S2</xref>.</p>
      <p id="p0085">Regarding the assignment of EC numbers to COG IDs, these are only assigned when at least 50 % of the EC numbers that match the COD ID are concordant. On the other hand, all the KOs assigned are listed in the final output.</p>
      <p id="p0090">Examples and explanations of commands to install and run reCOGnizer are given in <xref rid="s0085" ref-type="sec">SI (Section 1.4.2)</xref>.</p>
    </sec>
    <sec id="s0025">
      <label>2.3</label>
      <title>Development of KEGGCharter for visualization of functional annotation results in metabolic maps</title>
      <p id="p0095">KEGGCharter is a command-line tool that accesses the following KEGG Pathway’s functionalities: the interconversion of KEGG IDs, KOs and EC numbers, and the representation of KOs in KEGG metabolic maps, together with taxonomy and gene expression information.</p>
      <p id="p0100">The input to KEGGCharter is a table, in either TSV or Excel format (<xref rid="f0015" ref-type="fig">Fig. 3</xref>), containing:<list list-type="simple" id="l0005"><list-item id="o0005"><label>•</label><p id="p0105">a column with either KEGG IDs, KOs, or EC numbers;</p></list-item><list-item id="o0010"><label>•</label><p id="p0110">columns with either MG and/or MT quantification, i.e., abundance of different taxa in MG datasets and gene expression analysis, respectively. If no quantification is available, the “--input-quantification” parameter may be used to input a placeholder quantification, assigning a value of 1 to all rows;</p></list-item><list-item id="o0015"><label>•</label><p id="p0115">a column with taxonomic information, for the MG workflow. If no taxonomic classification is available, the “--input-taxonomy” parameter may be used to input a value directly from the command line.</p></list-item></list><fig id="f0015"><label>Fig. 3</label><caption><p>Workflow of KEGGCharter, which begins with the interconversion between KEGG IDs, KOS, and EC numbers, followed by the retrieval of KGMLs and EC number to box relation from the KEGG API, and finally by the generation of metabolic maps representing the genomic potential (MG analysis) or the gene expression (MT analysis) information. The web icon represents the retrieval of KGMLs and EC number to box relations; the green file icon represents the input file containing KEEG IDs, KOs, or EC numbers, together with quantification and taxonomic information; and the blue file icons represent the two outputs from KEGGCharter: TSV files with tables containing the IDs obtained from the interconversion step, and the KEGG metabolic maps in PNG format, containing taxonomic and quantitative information. For each map, a KGML file is obtained, which is the XML description of the metabolic map. A CSV file is also built by KEGGCharter, where the KOs of each box are stored.</p></caption><graphic xlink:href="gr3"/></fig></p>
      <p id="p0120">KEGGCharter’s workflow begins with the interconversion of input IDs (from KEGG IDs or EC numbers to KOs and from KOs to EC numbers) (<xref rid="f0015" ref-type="fig">Fig. 3</xref>, step 1). These interconversions are performed to obtain as much information as possible from the KEGG database. The interconversions between IDs use the “KEGG.REST.kegg_link” method of BioPython <xref rid="b0110" ref-type="bibr">[22]</xref>. Results from these interconversions are outputted in TSV format (<xref rid="f0015" ref-type="fig">Fig. 3</xref>, step 4a). The KOs obtained are then mapped in KEGG metabolic maps.</p>
      <p id="p0125">The list of metabolic maps to be represented can be inputted through the command line, otherwise, a default selection of maps is used (<xref rid="s0085" ref-type="sec">Table S3</xref>). If the user wants to know which maps are available, the following command can be run: <ext-link ext-link-type="uri" xlink:href="http://keggcharter.py" id="ir020"><italic>keggcharter.py</italic></ext-link>
<italic>--show-available-maps</italic>.</p>
      <p id="p0130">For each metabolic map, KEGGCharter will obtain information necessary for mapping function into maps and store it into two files: a Kegg Markup Language (KGML) file with the detailed description of the map pulled directly from KEGG, and a Comma-Separated Values (CSV) file relating KOs to corresponding boxes in the maps, built by extracting the information of EC numbers to boxes from the KGML and converting those EC numbers to KOs (<xref rid="f0015" ref-type="fig">Fig. 3</xref>, step 2). KGMLs are obtained with the “KEGG.REST.kegg_get” method of BioPython.</p>
      <p id="p0135">The main feature of KEGG metabolic maps is the presence of boxes representing reactions. The maps and the corresponding boxes are described in XML format on KGML files, obtained in step 2. In these KGMLs, each box contains a list of orthologs, which are the corresponding KOs. KEGGCharter identifies the specific boxes to manipulate, superimposes each box with a new box, and colorizes according to the information to be represented. The label of these boxes is always an EC number, in the original version of the maps, but when new boxes are superimposed, that information is hidden. KEGGCharter retrieves these EC numbers by converting the KOs of each box (obtained from the KGML) to EC numbers and storing that information in CSV files. When generating new maps, for each box the most abundant EC number is set as the label for the new boxes.</p>
      <p id="p0140">It is also important to note that a given KEGG ID can correspond to more than one KO, which can lead to an overestimation of the protein expression. To overcome this, KEGGCharter determines how many KOs are assigned to each protein and divides the protein quantification by the number of KOs, before drawing the maps.</p>
      <p id="p0145">Representation of (meta)genomics and (meta)transcriptomics data in KEGGCharter follows two distinct workflows depending on the type of analysis, i.e., MG or MT analysis (<xref rid="f0015" ref-type="fig">Fig. 3</xref>, step 3). Representation of MG results distinguishes between different taxa by attributing a different color to each taxon. By default, KEGGCharter represents the 10 most abundant microorganisms from the metagenome in the metabolic maps. Nevertheless, a different number of microorganisms can be represented simultaneously by inputting the desired number in the “--number-of-taxa” parameter. In addition, the user might select the specific taxa to be represented by using the “--taxa-list” parameter. For example, if the user intends to compare the genomic potential between two microorganisms present in the metagenome, only their taxa names should be indicated. Because this representation is made by changing the color of the boxes in metabolic maps, if different taxa have KOs corresponding to the same box, the new box will be split between the colors of the different corresponding taxa. On the other hand, representation of MT results describes the gene expression of the community as a whole. MT quantification is first summed by KO, and for each box in each metabolic map, KEGGCharter will sum the quantifications of the several KOs mapping to that box and represent that quantification with a colored gradient. The new boxes will be divided by the number of samples represented, up to a maximum of 10 samples.</p>
      <p id="p0150">KEGGCharter obtains information from KEGG on the correspondence of different taxa to specific functions and specific maps. This avoids the representation of functions associated with organisms that are not able to perform those functions, which can happen when using KOs for mapping functions, since KOs are specific to functions but not to taxa. Metabolic maps are outputted in PDF format with the “KEGG.KGML.KGML_pathway.to_pdf” method of Biopython. The colors for both different taxa and different levels of expression are obtained with matplotlib, which is also used to export the legends explaining the color codes as PNG files. pdftoppm (available at <ext-link ext-link-type="uri" xlink:href="https://man.archlinux.org/man/pdftoppm" id="ir025">https://man.archlinux.org/man/pdftoppm</ext-link>) is used to convert the colorized metabolic maps from PDF to PNG format, and PIL is used to resize the images and join the metabolic maps with the respective labels, outputting the joined information in PNG format (<xref rid="f0015" ref-type="fig">Fig. 3</xref>, steps 4b and 4c).</p>
      <p id="p0155">KEGGCharter can be run using the outputs from UPIMAPI or reCOGnizer (<xref rid="f0020" ref-type="fig">Fig. 4</xref>). The commands to automatically perform this analysis are given in <xref rid="s0085" ref-type="sec">SI (Section 1.4.3)</xref>.<fig id="f0020"><label>Fig. 4</label><caption><p>Interconnection between UPIMAPI, reCOGnizer and KEGGCharter. UPIMAPI and reCOGnizer annotate protein sequences inputted in FASTA format and obtain functional information, i.e., KEGG IDs, KOs, and EC numbers, that can be used as input for KEGGCharter, which represents proteins in KEGG metabolic maps. Blue file icons represent the main output files obtained by the three tools.</p></caption><graphic xlink:href="gr4"/></fig></p>
    </sec>
    <sec id="s0030">
      <label>2.4</label>
      <title>Benchmarking methodology</title>
      <p id="p0160">UPIMAPI (version 1.6.4) and reCOGnizer (version 1.6.4) were compared with state-of-the-art functional annotation tools, namely Prokka (version 1.14.6), DFAST (version 1.2.15), Mantis (version 1.4.5) and eggNOG-mapper (version 2.1.6). For that purpose, different datasets were used, one real metagenomics dataset (described in <xref rid="s0085" ref-type="sec">SI, Section 1.5.3</xref>), and five datasets each one consisting of seven genomes, obtained from Ensembl Genomes database (<xref rid="s0085" ref-type="sec">SI, Section 1.5.1</xref>), and hereafter named as artificial metagenomes (artificial metagenome #1 to #5). The real dataset was used to evaluate the performance regarding the analysis of real metagenomics data, while the artificial metagenomes were used to determine the accuracy of the annotation by calculating quality metrics.</p>
      <p id="p0165">Because all the functional annotation tools run for benchmarking, i.e., Mantis, eggNOG-mapper, Prokka and DFAST, combine sequence and domain homology annotation, the results of UPIMAPI (performing sequence homology annotation) and reCOGnizer (performing domain homology annotation) were combined for comparative purposes, i.e., the proteins without EC number or orthologous groups (OGs) assigned by UPIMAPI received the annotation obtained with reCOGnizer.</p>
      <p id="p0170">All tools were run with default parameters, with the following exceptions that were necessary to run the tools in the most similar conditions: (1) the UniProt database was added to the reference databases used to run Mantis; (2) Prokka was run using the “--metagenome“ parameter; and (3) protein sequences from the organisms in the artificial metagenomes were removed from the UniProt database, to guarantee that the datasets were independent of the reference database (<xref rid="s0085" ref-type="sec">SI, Section 1.5.1</xref>).</p>
      <p id="p0175">Prokka and DFAST used as input the reference genomes (in the case of the artificial metagenomes) and the contigs (in the case of the real metagenome) because these tools perform their gene calling before functional annotation. On the other hand, UPIMAPI, reCOGnizer, Mantis and eggNOG-mapper used protein FASTA files as input, containing protein sequences obtained after gene calling (with Prodigal, using default parameters) of the reference genomes and the contigs, in the case of the artificial metagenomes and the real metagenome, respectively.</p>
      <p id="p0180">The quality metrics precision, recall and F1 score, calculated as described in <xref rid="s0085" ref-type="sec">SI (Section 1.6)</xref>, were used to assess the performance of the tools. The number of proteins with OGs and EC number assigned with each one of the annotation tools was also taken into account to perform the comparison.</p>
      <p id="p0185">All analyses were run on a #116-Ubuntu SMP kernel, with 126 Gb of memory and 16 threads.</p>
    </sec>
  </sec>
  <sec id="s0035">
    <label>3</label>
    <title>Results</title>
    <p id="p0190">The source codes of UPIMAPI, reCOGnizer and KEGGCharter are available at GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/iquasere/UPIMAPI" id="ir030">https://github.com/iquasere/UPIMAPI</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://github.com/iquasere/reCOGnizer" id="ir035">https://github.com/iquasere/reCOGnizer</ext-link>, and <ext-link ext-link-type="uri" xlink:href="https://github.com/iquasere/KEGGCharter" id="ir040">https://github.com/iquasere/KEGGCharter</ext-link>, respectively.</p>
    <sec id="s0040">
      <label>3.1</label>
      <title>Functional annotation with UPIMAPI and reCOGnizer</title>
      <p id="p0195">UPIMAPI provides a Command Line Interface (CLI) to perform protein sequence annotation and to retrieve functional information from the UniProtKB, through UniProt’s ID mapping service <xref rid="b0120" ref-type="bibr">[24]</xref>. The annotation step runs local sequence alignment with DIAMOND (<xref rid="f0005" ref-type="fig">Fig. 1</xref>, step 2) against a reference database that can be automatically downloaded (<xref rid="f0005" ref-type="fig">Fig. 1</xref>, step 1). In the UniProt ID mapping step, UPIMAPI uses the UniProt API for obtaining diverse information about the proteins/IDs analyzed (<xref rid="f0005" ref-type="fig">Fig. 1</xref>, step 3). This is an iterative process, repeated until functional information is acquired for the highest number of UniProt IDs. As a result, complete information assigned to UniProt IDs, including those from cross-reference databases linked to UniProtKB and taxonomic assignment, is obtained.</p>
      <p id="p0200">Two types of output can be obtained with UPIMAPI: the protein sequences, in FASTA format, or the data available at the UniProt knowledgebase, in a TSV table (<xref rid="f0005" ref-type="fig">Fig. 1</xref>). Besides these two main outputs, files resulting from annotation with DIAMOND are also generated, i.e., an outfmt6 file with the annotation result and metrics of the sequence alignments, and a FASTA file containing query sequences that were not annotated (because they did not show significant homology to those in the reference database).</p>
      <p id="p0205">In addition to the ID mapping through the UniProt’s API, UPIMAPI performs the local ID mapping of SwissProt IDs. The information outputted after local ID mapping is organized differently from the output obtained through the UniProt’s API, and UPIMAPI resolved this issue by parsing the information into the formats of the API for almost all columns. However, ID mapping with UPIMAPI is still largely dependent on UniProt’s API for mapping TrEMBL IDs, and this information could potentially be obtained with a fully local method. Nevertheless, we noticed that local TrEMBL ID mapping would require the storage of ∼1 Tb of data, which could be a problem for the users who have no access to servers with enough space. UPIMAPI retrieves the same information as UniProt’s ID mapping web service but can handle millions of IDs with a single command, which is a major improvement for the analysis of <italic>meta</italic>-omics datasets (containing typically hundreds of thousands of IDs). Comparatively, through the UniProt’s API, a maximum of 50,000 protein IDs can be uploaded at a time (from <ext-link ext-link-type="uri" xlink:href="https://www.uniprot.org/help/uploadlists" id="ir045">https://www.uniprot.org/help/uploadlists</ext-link>).</p>
      <p id="p0210">While UPIMAPI performs sequence-based functional annotation, reCOGnizer performs domain-based annotation of large datasets (protein FASTA files), using as reference the following databases: CDD, COG, KOG, NCBIfam, Protein Clusters, Pfam, SMART, and TIGRFAM. The general steps of reCOGnizer are the following: database construction for general and taxonomic workflows (<xref rid="f0010" ref-type="fig">Fig. 2</xref>, step 1), sequence alignment with RPS-BLAST (<xref rid="f0010" ref-type="fig">Fig. 2</xref>, step 2), interconversion of CDD IDs to other database IDs (<xref rid="f0010" ref-type="fig">Fig. 2</xref>, step 6), retrieval of information from databases (<xref rid="f0010" ref-type="fig">Fig. 2</xref>, step 7) and generation of output reports (<xref rid="f0010" ref-type="fig">Fig. 2</xref>, step 8).</p>
      <p id="p0215">For each database, reCOGnizer generates a TSV report, containing the BLAST metrics and annotation results obtained with RPS-BLAST, as well as extra information including functional sites and motifs, protein superfamilies, domain names, and descriptions, EC numbers, taxonomic classifications, and KOs (<xref rid="f0010" ref-type="fig">Fig. 2</xref>, step 8a). All these reports are gathered into general reports in TSV and Excel formats (<xref rid="f0010" ref-type="fig">Fig. 2</xref>, step 8b). For the results obtained from COG and KOG databases, another report is generated, quantifying the occurrence of each COG/KOG and organizing the results by the respective COGs’ categories. This information is represented in interactive pie charts (Krona plots) (<xref rid="f0010" ref-type="fig">Fig. 2</xref>, step 8c).</p>
      <p id="p0220">Some of the IDs attributed by reCOGnizer, i.e., those from NCBIfam, Pfam, Protein Clusters and TIGRFAM, have taxonomy assigned, and this is the taxonomy that is reported by reCOGnizer. Sequences of the proteins annotated are also included in the reports, but to avoid considerably larger outputs when analyzing big datasets, reCOGnizer provides an option “--no-output-sequences” to exclude this information.</p>
      <p id="p0225">The analysis of the artificial metagenomics dataset #3 is given as example. UPIMAPI annotated 26,634 proteins from a total of 26,920 proteins, i.e., 99 % of the total proteins (<xref rid="t0005" ref-type="table">Table 1</xref>), from which 14 % were assigned to a KEGG ID and 17 % were assigned to an EC number (<xref rid="t0005" ref-type="table">Table 1</xref>, <xref rid="s0085" ref-type="sec">Table S5</xref>). These results correspond to the information present in the UniProtKB.<table-wrap position="float" id="t0005"><label>Table 1</label><caption><p>Results obtained from the analysis of the artificial metagenomes with UPIMAPI.</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th colspan="5">Number of proteins and respective percentage <xref rid="tblfn1" ref-type="table-fn">a</xref><hr/></th></tr><tr><th/><th>Artificial metagenome #1</th><th>Artificial metagenome #2</th><th>Artificial metagenome #3</th><th>Artificial metagenome #4</th><th>Artificial metagenome #5</th></tr></thead><tbody><tr><td>Genes identified after gene calling</td><td>23,283</td><td>22,817</td><td>26,920</td><td>28,908</td><td>41,511</td></tr><tr><td>Annotated proteins</td><td>22,489<break/>(96.59 %)</td><td>22,397<break/>(98.16 %)</td><td>26,634<break/>(98.94 %)</td><td>27,912<break/>(96.55 %)</td><td>40,865<break/>(98.44 %)</td></tr><tr><td>Unique UniProt IDs</td><td>21,485<break/>(92.28 %)</td><td>22,118<break/>(96.94 %)</td><td>26,364<break/>(97.93 %)</td><td>27,066<break/>(93.63 %)</td><td>40,655<break/>(97.94 %)</td></tr><tr><td>Uncharacterized proteins</td><td>4333<break/>(18.61 %)</td><td>3608<break/>(15.81 %)</td><td>4073<break/>(15.13 %)</td><td>6129<break/>(21.2 %)</td><td>7681<break/>(18.5 %)</td></tr><tr><td>Proteins with assigned KEGG ID</td><td>2931<break/>(12.59 %)</td><td>1654<break/>(7.25 %)</td><td>3861<break/>(14.34 %)</td><td>1102<break/>(3.81 %)</td><td>1660<break/>(4.0 %)</td></tr><tr><td>Proteins with assigned EC number</td><td>4205<break/>(18.06 %)</td><td>4349<break/>(19.06 %)</td><td>4602<break/>(17.1 %)</td><td>4202<break/>(14.54 %)</td><td>6434<break/>(15.5 %)</td></tr><tr><td>Proteins with assigned OG</td><td>493<break/>(2.12 %)</td><td>1318<break/>(5.78 %)</td><td>5014<break/>(18.63 %)</td><td>356<break/>(1.23 %)</td><td>1185<break/>(2.85 %)</td></tr></tbody></table><table-wrap-foot><fn id="tblfn1"><label>a</label><p id="np005">The percentages were calculated relatively to the number of proteins identified by gene calling.</p></fn></table-wrap-foot></table-wrap></p>
      <p id="p0230">After the annotation with UPIMAPI, 15 to 21 % of the proteins from the artificial metagenomes were identified as uncharacterized (<xref rid="t0005" ref-type="table">Table 1</xref>). The high number of uncharacterized proteins makes it more difficult the evaluation of the overall functional potential of microbial communities. In this study, domain-based annotation with reCOGnizer increased significantly the functional information retrieved from the artificial metagenome (<xref rid="t0010" ref-type="table">Table 2</xref>, <xref rid="s0085" ref-type="sec">Table S9</xref>). <xref rid="t0010" ref-type="table">Table 2</xref> contains the functional categories obtained by reCOGnizer for proteins identified by UPIMAPI as “uncharacterized” in the artificial metagenomes. reCOGnizer could obtain information for 19.44 ± 0.97 % (excluding the ones annotated as “poorly characterized” and with “no COG ID”) of the proteins annotated as “uncharacterized proteins” by UPIMAPI.<table-wrap position="float" id="t0010"><label>Table 2</label><caption><p>Number of proteins assigned to COG categories by reCOGnizer that were classified as “uncharacterized” by sequence-based annotation with UPIMAPI.</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th/><th colspan="5"># of proteins<hr/></th></tr><tr><th/><th/><th>Artificial metagenome #1</th><th>Artificial metagenome #2</th><th>Artificial metagenome #3</th><th>Artificial metagenome #4</th><th>Artificial metagenome #5</th></tr></thead><tbody><tr><td rowspan="10">CELLULAR PROCESSES AND SIGNALING</td><td>Cell cycle control, cell division, chromosome partitioning</td><td>70</td><td>24</td><td>52</td><td>108</td><td>72</td></tr><tr><td>Cell motility</td><td>29</td><td>9</td><td>7</td><td>46</td><td>22</td></tr><tr><td>Cell wall/membrane/envelope biogenesis</td><td>81</td><td>52</td><td>41</td><td>171</td><td>99</td></tr><tr><td>Cytoskeleton</td><td>9</td><td>0</td><td>0</td><td>5</td><td>14</td></tr><tr><td>Defense mechanisms</td><td>41</td><td>38</td><td>27</td><td>65</td><td>42</td></tr><tr><td>Extracellular structures</td><td>34</td><td>7</td><td>9</td><td>61</td><td>28</td></tr><tr><td>Intracellular trafficking, secretion, and vesicular transport</td><td>20</td><td>13</td><td>14</td><td>40</td><td>22</td></tr><tr><td>Mobilome: prophages, transposons</td><td>16</td><td>12</td><td>11</td><td>6</td><td>18</td></tr><tr><td>Posttranslational modification, protein turnover, chaperones</td><td>51</td><td>19</td><td>17</td><td>73</td><td>53</td></tr><tr><td>Signal transduction mechanisms</td><td>216</td><td>29</td><td>46</td><td>272</td><td>151</td></tr><tr><td rowspan="4">INFORMATION STORAGE AND PROCESSING</td><td>RNA processing and modification</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td></tr><tr><td>Replication, recombination and repair</td><td>23</td><td>9</td><td>11</td><td>23</td><td>31</td></tr><tr><td>Transcription</td><td>43</td><td>43</td><td>33</td><td>66</td><td>79</td></tr><tr><td>Translation, ribosomal structure and biogenesis</td><td>22</td><td>16</td><td>14</td><td>12</td><td>24</td></tr><tr><td rowspan="8">METABOLISM</td><td>Amino acid transport and metabolism</td><td>12</td><td>24</td><td>18</td><td>26</td><td>54</td></tr><tr><td>Carbohydrate transport and metabolism</td><td>13</td><td>26</td><td>26</td><td>31</td><td>77</td></tr><tr><td>Coenzyme transport and metabolism</td><td>28</td><td>27</td><td>14</td><td>38</td><td>27</td></tr><tr><td>Energy production and conversion</td><td>26</td><td>21</td><td>10</td><td>41</td><td>40</td></tr><tr><td>Inorganic ion transport and metabolism</td><td>35</td><td>19</td><td>31</td><td>35</td><td>68</td></tr><tr><td>Lipid transport and metabolism</td><td>14</td><td>18</td><td>7</td><td>35</td><td>52</td></tr><tr><td>Nucleotide transport and metabolism</td><td>4</td><td>3</td><td>7</td><td>11</td><td>17</td></tr><tr><td>Secondary metabolites biosynthesis, transport and catabolism</td><td>3</td><td>3</td><td>30</td><td>12</td><td>33</td></tr><tr><td>No COG ID</td><td>–</td><td>3715</td><td>3192</td><td>3655</td><td>5303</td><td>6764</td></tr><tr><td rowspan="2">POORLY CHARACTERIZED</td><td>Function unknown</td><td>84</td><td>86</td><td>67</td><td>59</td><td>175</td></tr><tr><td>General function prediction only</td><td>205</td><td>81</td><td>102</td><td>296</td><td>183</td></tr></tbody></table></table-wrap></p>
      <p id="p0235">In total, reCOGnizer retrieved functional information for 83.76 ± 2.00 % of the proteins inputted (<xref rid="t0015" ref-type="table">Table 3</xref>, <xref rid="s0085" ref-type="sec">Table S9</xref>), and EC numbers were obtained for 41.00 ± 1.57 % of the proteins, considering the analysis of all the artificial metagenomes. Our results clearly show that these two methodologies (i.e., sequence- and domain-based annotation) are complementary and useful to extract the most information possible from the analyzed datasets. <xref rid="f0025" ref-type="fig">Fig. 5</xref> shows the default interactive Krona plot generated by reCOGnizer, representing the functional characterization of the artificial metagenome #3, which is organized by COG IDs and respective COG categories.<table-wrap position="float" id="t0015"><label>Table 3</label><caption><p>Number of proteins annotated by reCOGnizer, with different reference databases, and respective percentages relatively to the total number of proteins in the artificial metagenomes, for E-value = 0.001.</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th/><th colspan="7"># of proteins annotated with reference to the databases included in reCOGnizer<hr/></th></tr><tr><th/><th/><th>CDD</th><th>NCBIfam</th><th>Protein<break/>Clusters</th><th>TIGRFAM</th><th>Pfam</th><th>Smart</th><th>COG</th></tr></thead><tbody><tr><td rowspan="2">Artificial metagenome #1</td><td>Annotated proteins</td><td>11,119<break/>(47.76 %)</td><td>4108<break/>(17.64 %)</td><td>12,728<break/>(54.67 %)</td><td>10,162<break/>(43.65 %)</td><td>18,332<break/>(78.74 %)</td><td>5362<break/>(23.03 %)</td><td>17,292<break/>(74.27 %)</td></tr><tr><td>Proteins with assigned EC number</td><td>0<break/>(0.0 %)</td><td>73<break/>(0.31 %)</td><td>3795<break/>(16.3 %)</td><td>2743<break/>(11.78 %)</td><td>30<break/>(0.13 %)</td><td>0<break/>(0 %)</td><td>8199<break/>(35.21 %)</td></tr><tr><td rowspan="2">Artificial metagenome #2</td><td>Annotated proteins</td><td>11,119<break/>(48.73 %)</td><td>4108<break/>(18.0 %)</td><td>12,728<break/>(55.78 %)</td><td>10,162<break/>(44.54 %)</td><td>18,332<break/>(80.34 %)</td><td>5362<break/>(23.5 %)</td><td>17,292<break/>(75.79 %)</td></tr><tr><td>Proteins with assigned EC number</td><td>0<break/>(0.0 %)</td><td>73<break/>(0.32 %)</td><td>3795<break/>(16.63 %)</td><td>2743<break/>(12.02 %)</td><td>30<break/>(0.13 %)</td><td>0<break/>(0 %)</td><td>8199<break/>(35.93 %)</td></tr><tr><td rowspan="2">Artificial metagenome #3</td><td>Annotated proteins</td><td>11,119<break/>(41.3 %)</td><td>4108<break/>(15.26 %)</td><td>12,728<break/>(47.28 %)</td><td>10,162<break/>(37.75 %)</td><td>18,332<break/>(68.1 %)</td><td>5362<break/>(19.92 %)</td><td>17,292<break/>(64.23 %)</td></tr><tr><td>Proteins with assigned EC number</td><td>0<break/>(0.0 %)</td><td>73<break/>(0.27 %)</td><td>3795<break/>(14.1 %)</td><td>2743<break/>(10.19 %)</td><td>30<break/>(0.11 %)</td><td>0<break/>(0 %)</td><td>8199<break/>(30.46 %)</td></tr><tr><td rowspan="2">Artificial metagenome #4</td><td>Annotated proteins</td><td>11,119<break/>(38.46 %)</td><td>4108<break/>(14.21 %)</td><td>12,728<break/>(44.03 %)</td><td>10,162<break/>(35.15 %)</td><td>18,332<break/>(63.41 %)</td><td>5362<break/>(18.55 %)</td><td>17,292<break/>(59.82 %)</td></tr><tr><td>Proteins with assigned EC number</td><td>0<break/>(0.0 %)</td><td>73<break/>(0.25 %)</td><td>3795<break/>(13.13 %)</td><td>2743<break/>(9.49 %)</td><td>30<break/>(0.1 %)</td><td>0<break/>(0 %)</td><td>8199<break/>(28.36 %)</td></tr><tr><td rowspan="2">Artificial metagenome #5</td><td>Annotated proteins</td><td>11,119<break/>(26.79 %)</td><td>4108<break/>(9.9 %)</td><td>12,728<break/>(30.66 %)</td><td>10,162<break/>(24.48 %)</td><td>18,332<break/>(44.16 %)</td><td>5362<break/>(12.92 %)</td><td>17,292<break/>(41.66 %)</td></tr><tr><td>Proteins with assigned EC number</td><td>0<break/>(0.0 %)</td><td>73<break/>(0.18 %)</td><td>3795<break/>(9.14 %)</td><td>2743<break/>(6.61 %)</td><td>30<break/>(0.07 %)</td><td>0<break/>(0 %)</td><td>8199<break/>(19.75 %)</td></tr></tbody></table></table-wrap><fig id="f0025"><label>Fig. 5</label><caption><p>Visual representation of COG categories in a Krona plot, obtained from the annotation of the artificial metagenome #3 with reCOGnizer. Percentages reflect the abundance of each COG category in the dataset. Cell CC, CD, CP represents Cell cycle control, cell division, chromosome partitioning; Cell W/M/E B represents Cell wall/membrane/envelope biogenesis; Posttranslational M, PT, C represents Posttranslational modification, protein turnover, chaperones; Replication, R and R represents Replication, recombination and repair; Signal TM represents Signal transduction mechanisms; Translation, RSB represents Translation, ribosomal structure and biogenesis; Amino acid T and M represents Amino acid transport and metabolism; Inorganic ion T and M represents Inorganic ion transport and metabolism; General function PO represents General function prediction only; Secondary MB, T and C represents Secondary metabolites biosynthesis, transport and catabolism.</p></caption><graphic xlink:href="gr5"/></fig></p>
    </sec>
    <sec id="s0045">
      <label>3.2</label>
      <title>Representation of metabolic functions in KEGG maps with KEGGCharter</title>
      <p id="p0240">KEGGCharter provides an elegant view of (meta)genomics and (meta)transcriptomics/ (meta)proteomics results, by showing the functions each taxon can perform, and by showing the gene/protein expression of the collective community. This tool is useful to visualize, in metabolic maps, the functions that microbial communities can perform (i.e., the genomic potential of microbial communities, obtained by metagenomics studies) and to identify the microorganisms inside the communities that can perform that function. In addition, KEGGCharter can represent gene expression, the result of (meta)transcriptomics and (meta)proteomics studies, by showing the metabolic functions expressed in heatmaps.</p>
      <p id="p0245">KEGGCharter accesses the following KEGG Pathway’s functionalities: the interconversion of KEGG IDs, KOs, and EC numbers and the representation of taxonomy and gene expression in KEGG metabolic maps. To show the functionalities of KEGGCharter, MT datasets were simulated as described in <xref rid="s0085" ref-type="sec">SI, Section 1.5.2</xref>, to simulate a gene expression experiment. The TSV report obtained with UPIMAPI, together with gene expression quantification data obtained from MT analysis, was used as the input for KEGGCharter (<xref rid="f0030" ref-type="fig">Fig. 6</xref>). Comparative gene expression maps produced by KEGGCharter show the quantification of each function for the entire community under different conditions. An example of KEGGCharter output with differential gene expression is given in SI (<xref rid="s0085" ref-type="sec">Fig. S1</xref>). <xref rid="f0030" ref-type="fig">Fig. 6</xref> represents one of the maps obtained with KEGGCharter from the analysis of the real metagenome, after functional annotation with UPIMAPI.<fig id="f0030"><label>Fig. 6</label><caption><p>Example of a KEGGCharter output map obtained from the analysis of the real metagenome. This map represents the genomic potential of the community for “Methane metabolism” (map00680 of KEGG Pathway). Enzymes assigned to different taxa are represented in different colors in the enzyme boxes, with the legend under the map identifying the taxa corresponding to each color. KEGGCharter was run from the results of UPIMAPI by setting the “input” parameter to the “UPIMAPI_results.tsv” table outputted by UPIMAPI. KEGG IDs column was set to “Cross-reference (KEGG)”, taxa column set to “Taxonomic lineage (SPECIES)” and the input quantification parameter was set to true.</p></caption><graphic xlink:href="gr6"/></fig></p>
      <p id="p0250">In this metabolic map, it is possible to visualize which enzymes present in the metagenome are related to the methane metabolism pathway. In this metagenomics dataset, microorganisms assigned to <italic>Methanosaeta concilii</italic> and <italic>Methanobacterium subterranum</italic>, colored in orange and purple, are the ones with the higher genomic potential to produce methane, as several enzymes assigned to these microorganisms could be mapped by KEGGCharter in this metabolic map. Other microorganisms with less representation in the dataset (identified as “other taxa”) also contain enzymes involved in the methane metabolism pathway. In addition, <italic>Syntrophobacter fumaroxidans</italic>, which is not a methanogen, has several enzymes identified in this map, that are not involved in methane production but participate in other reactions represented in the methane metabolism map.</p>
    </sec>
    <sec id="s0050">
      <label>3.3</label>
      <title>Qualitative and quantitative benchmark</title>
      <p id="p0255">Several functional annotation tools were run to analyze the artificial metagenomes and the real metagenome. Regarding the artificial metagenomes, the number of genes annotated after gene calling by each one of the tools is presented in <xref rid="s0085" ref-type="sec">Table S11</xref>. UPIMAPI + reCOGnizer obtained functional annotation for 97.83 ± 0.93 % of the proteins, while 96.49 ± 1.70 % of the proteins were annotated with Mantis, 92.76 ± 2.21 % with eggNOG-mapper, 49.34 ± 3.65 % with Prokka and 40.63 ± 5.54 % with DFAST (<xref rid="s0085" ref-type="sec">Table S11</xref>). Functional annotation tools were compared regarding the assignment of EC numbers and OGs to the proteins present in the artificial metagenomes. <xref rid="t0020" ref-type="table">Table 4</xref> shows the average number (and standard deviation) of total EC numbers and OGs identified by each one of the tools, and respective quality metrics. Detailed results for the annotation of all datasets are given in <xref rid="s0085" ref-type="sec">Table S9</xref>. The highest F1 score for EC numbers’ assignments was obtained with UPIMAPI + reCOGnizer (93.81 ± 1.26 %). For OGs assignments the highest F1 scores were obtained with eggNOG mapper and Mantis (89.47 ± 3.73 and 88.62 ± 3.10, respectively). These results show that the combination of UPIMAPI with reCOGnizer provides precise identifications for both OGs and EC numbers (precisions ranging between 89 % and 94 %, with the exception of OG assignment in artificial metagenome #1, which obtained a precision of 72 %), and assigns EC numbers to almost all proteins (recall higher than 95 %). On the other hand, assignment of OGs with UPIMAPI + reCOGnizer resulted in lower F1 scores (between 67 and 97 %) when compared with the other tools. eggNOG-mapper could assign more OG IDs than the remaining tools and presented a very low number of false negatives. Generally, regarding OG assignments, Mantis and eggNOG-mapper presented high F1 scores, but DFAST and Prokka showed F1 scores lower than 70 %. On the other hand, the F1 score obtained for the EC number assignment with Prokka was above 80 %, which was similar to the F1 scores obtained with Mantis and eggNOG-mapper (<xref rid="t0020" ref-type="table">Table 4</xref>). Regarding the percentage of proteins that received a functional annotation beyond the information available at UniProt, UPIMAPI + reCOGnizer could retrieve the highest number of EC numbers (more than one third of the total number of proteins were assigned to an EC number) and eggNOG mapper assigned the most OGs (for over two-thirds of the total number of proteins). The concordance of the results obtained by the different annotation tools is presented in <xref rid="s0085" ref-type="sec">Table S10</xref>.<table-wrap position="float" id="t0020"><label>Table 4</label><caption><p>Quality metrics of annotation of the artificial metagenomes, regarding the assignment of EC numbers and OGs, with UPIMAPI + reCOGnizer, Mantis, eggNOG-mapper, Prokka and DFAST. Only the proteins with EC number/OG assigned in the UniProt database were considered for this comparison, except for the last column, where it is shown the total number of proteins that were assigned OG/EC numbers. True positives (TP), false positives (FP), false negatives (FN), precision, recall, and F1 score were calculated as described in <xref rid="s0085" ref-type="sec">SI, Section 1.6</xref>. Because multiple iterations were performed, TPs, FPs and FNs were normalized by dividing by the total number of proteins with functional information (the sum of TPs. FPs and FNs).</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Qualifier</th><th>Tool</th><th>TPs (%)</th><th>FPs (%)</th><th>FNs (%)</th><th>Precision (%)</th><th>Recall (%)</th><th>F1 score (%)</th><th>% of total identifications</th></tr></thead><tbody><tr><td rowspan="5">EC number<break/></td><td>UPIMAPI + reCOGnizer</td><td><bold>88.37</bold><break/>(±2.25)</td><td><bold>7.9</bold><break/>(±1.63)</td><td><bold>3.73</bold><break/>(±0.86)</td><td><bold>91.78</bold><break/>(±1.73)</td><td><bold>95.94</bold><break/>(±0.97)</td><td><bold>93.81</bold><break/>(±1.26)</td><td><bold>34.79</bold><break/>(±6.75)</td></tr><tr><td>Prokka</td><td><bold>72.2</bold><break/>(±6.25)</td><td><bold>14.79</bold><break/>(±2.99)</td><td><bold>13.0</bold><break/>(±3.3)</td><td><bold>82.84</bold><break/>(±4.24)</td><td><bold>84.58</bold><break/>(±4.57)</td><td><bold>83.7</bold><break/>(±4.39)</td><td><bold>27.14</bold><break/>(±3.4)</td></tr><tr><td>Mantis</td><td><bold>66.94</bold><break/>(±3.34)</td><td><bold>22.25</bold><break/>(±1.66)</td><td><bold>10.82</bold><break/>(±2.08)</td><td><bold>75.02</bold><break/>(±2.26)</td><td><bold>86.05</bold><break/>(±2.87)</td><td><bold>80.15</bold><break/>(±2.4)</td><td><bold>26.03</bold><break/>(±5.36)</td></tr><tr><td>eggNOG-mapper</td><td><bold>65.96</bold><break/>(±2.86)</td><td><bold>17.9</bold><break/>(±1.0)</td><td><bold>16.13</bold><break/>(±2.0)</td><td><bold>78.62</bold><break/>(±1.62)</td><td><bold>80.32</bold><break/>(±2.62)</td><td><bold>79.46</bold><break/>(±2.07)</td><td><bold>20.22</bold><break/>(±4.18)</td></tr><tr><td>DFAST</td><td><bold>59.18</bold><break/>(±8.72)</td><td><bold>9.06</bold><break/>(±1.1)</td><td><bold>31.76</bold><break/>(±9.55)</td><td><bold>86.62</bold><break/>(±1.15)</td><td><bold>65.16</bold><break/>(±10.03)</td><td><bold>73.95</bold><break/>(±7.36)</td><td><bold>14.75</bold><break/>(±3.03)</td></tr><tr><td rowspan="5">OG<break/></td><td>eggNOG-mapper</td><td><bold>81.15</bold><break/>(±5.85)</td><td><bold>18.84</bold><break/>(±5.84)</td><td><bold>0.02</bold><break/>(±0.02)</td><td><bold>81.16</bold><break/>(±5.85)</td><td><bold>99.98</bold><break/>(±0.02)</td><td><bold>89.47</bold><break/>(±3.73)</td><td><bold>71.19</bold><break/>(±13.72)</td></tr><tr><td>Mantis</td><td><bold>79.71</bold><break/>(±4.92)</td><td><bold>11.35</bold><break/>(±5.67)</td><td><bold>8.94</bold><break/>(±2.2)</td><td><bold>87.61</bold><break/>(±5.97)</td><td><bold>89.96</bold><break/>(±2.16)</td><td><bold>88.62</bold><break/>(±3.1)</td><td><bold>59.9</bold><break/>(±11.22)</td></tr><tr><td>UPIMAPI + reCOGnizer</td><td><bold>66.32</bold><break/>(±15.11)</td><td><bold>8.14</bold><break/>(±5.94)</td><td><bold>25.54</bold><break/>(±12.19)</td><td><bold>88.52</bold><break/>(±8.78)</td><td><bold>71.79</bold><break/>(±13.57)</td><td><bold>78.83</bold><break/>(±10.13)</td><td><bold>48.8</bold><break/>(±9.17)</td></tr><tr><td>DFAST</td><td><bold>53.37</bold><break/>(±6.28)</td><td><bold>7.86</bold><break/>(±4.64)</td><td><bold>38.77</bold><break/>(±3.64)</td><td><bold>87.07</bold><break/>(±7.92)</td><td><bold>57.77</bold><break/>(±4.87)</td><td><bold>69.37</bold><break/>(±5.51)</td><td><bold>48.92</bold><break/>(±6.51)</td></tr><tr><td>Prokka</td><td><bold>36.33</bold><break/>(±4.55)</td><td><bold>3.75</bold><break/>(±1.73)</td><td><bold>59.93</bold><break/>(±2.92)</td><td><bold>90.28</bold><break/>(±5.47)</td><td><bold>37.67</bold><break/>(±4.17)</td><td><bold>53.12</bold><break/>(±5.1)</td><td><bold>30.09</bold><break/>(±5.39)</td></tr></tbody></table></table-wrap></p>
      <p id="p0260">The performance of the annotation tools when analyzing the real MG dataset was similar to what was obtained with the artificial metagenomes, in respects to the number of functional assignments (<xref rid="t0025" ref-type="table">Table 5</xref>). The highest number of proteins annotated was obtained with UPIMAPI + reCOGnizer (89 %), followed by Mantis (86 %), eggNOG-mapper (77 %), DFAST (38 %) and Prokka (27 %), but on the other hand, eggNOG-mapper could assign much more OGs (77 %), when compared with the other tools. Mantis assigned OGs to over 50 % of the proteins, UPIMAPI + reCOGnizer to 38 %, and DFAST and Prokka to lower percentages (28 % and 17 %, respectively) (<xref rid="t0025" ref-type="table">Table 5</xref>). The highest number of EC numbers assigned was obtained by UPIMAPI + reCOGnizer (34 %), followed closely by Mantis (25 %) and eggNOG-mapper (24 %), and then by Prokka and DFAST with 17 % and 9 %, respectively.<table-wrap position="float" id="t0025"><label>Table 5</label><caption><p>Comparison of the results obtained with the functional annotation tools after analysis of the real metagenomics dataset, regarding the number of proteins annotated and the number of assigned EC numbers and OG IDs. Percentages were calculated with reference to the total number of genes obtained after gene calling.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Tool</th><th># of proteins annotated</th><th># of proteins with EC number assigned</th><th># of proteins with OG assigned</th></tr></thead><tbody><tr><td>UPIMAPI + reCOGnizer</td><td>434,310 (88.77 %)</td><td>165,602 (33.85 %)</td><td>184,633 (37.74 %)</td></tr><tr><td>Mantis</td><td>419,527 (85.75 %)</td><td>123,960 (25.34 %)</td><td>248,109 (50.71 %)</td></tr><tr><td>eggNOG mapper</td><td>375,654 (76.78 %)</td><td>117,355 (23.99 %)</td><td>375,654 (76.78 %)</td></tr><tr><td>DFAST</td><td>43,726 (37.99 %)</td><td>10,318 (8.96 %)</td><td>32,540 (28.27 %)</td></tr><tr><td>Prokka</td><td>70,302 (27.31 %)</td><td>44,202 (17.17 %)</td><td>43,435 (16.87 %)</td></tr></tbody></table></table-wrap></p>
      <p id="p0265">All tools assigned more OG IDs than EC numbers, except Prokka that assigned OGs and EC numbers to approximately the same number of proteins (<xref rid="t0020" ref-type="table">Table 4</xref>, <xref rid="t0025" ref-type="table">Table 5</xref>). Generally, all tools could annotate a higher percentage of proteins from the artificial metagenomes (ranging from 99 and 35 %, depending on the tool, <xref rid="s0085" ref-type="sec">Table S11</xref>) than from the real metagenome (ranging from 89 and 27 %, depending on the tool, <xref rid="t0025" ref-type="table">Tables 5</xref>).</p>
    </sec>
  </sec>
  <sec id="s0055">
    <label>4</label>
    <title>Discussion</title>
    <p id="p0270">Functional annotation of <italic>meta</italic>-omics datasets is essential for understanding microbial behavior, and linking microbial identity to function in microbial communities. The combination of sequence-based functional annotation with domain-based functional annotation has been shown to provide a more complete picture of the data analyzed <xref rid="b0125" ref-type="bibr">[25]</xref>, and several tools have implemented this approach <xref rid="b0045" ref-type="bibr">[9]</xref>, <xref rid="b0050" ref-type="bibr">[10]</xref>, <xref rid="b0055" ref-type="bibr">[11]</xref>, <xref rid="b0060" ref-type="bibr">[12]</xref>. This work contributed to the improvement of the state of the art, by developing two novel command-line tools performing sequence (UPIMAPI) and domain (reCOGnizer) homology-based functional annotation of big datasets, and a tool to visualize the annotation results in metabolic maps (KEGGCharter). These tools offer several advantages for the end-users. For instance, they are fully automated, as they are run by using a single command. Also, they offer many options for customization, e.g., the choice of different reference databases and the content of the output information. In addition, functional annotation is obtained from 9 databases (UniProt, CDD, COG, KOG, Pfam, SMART, Protein Clusters, NCBIfam and TIGRFAM), providing a complete functional characterization. Both UPIMAPI and reCOGnizer are run with the most recent versions of these databases, providing up-to-date information. The annotation results of both metagenomics and gene expression analysis can be further visualized by using KEGGCharter, thus facilitating the interpretation of <italic>meta</italic>-omics results.</p>
    <p id="p0275">UPIMAPI and reCOGnizer offer some unique features for functional annotation. UPIMAPI retrieves information from the UniProt KB, which includes functional and taxonomic information from all proteins present in the UniProt database. It automatically builds customized databases for inputted tax IDs, which may be useful for studies relying only on a limited number of taxonomic groups. UPIMAPI could annotate a high percentage of proteins from the artificial (98 ± 0.9 %) and real (89 %) metagenomes (<xref rid="t0005" ref-type="table">Table 1</xref>, <xref rid="t0025" ref-type="table">Table 5</xref> and <xref rid="s0085" ref-type="sec">Table S9</xref>), presenting high recall and sensitivity. Nevertheless, a significant percentage (18 ± 2.4 %) of the proteins annotated by UPIMAPI were uncharacterized proteins, for which functional information is not available in the UniProt database. The analysis with reCOGnizer decreased the number of proteins without information, thus increasing the functional characterization of the artificial metagenomes (<xref rid="t0010" ref-type="table">Table 2</xref>, <xref rid="t0020" ref-type="table">Table 4</xref>, <xref rid="t0025" ref-type="table">Table 5</xref> and <xref rid="s0085" ref-type="sec">Table S9</xref>). This happened because reCOGnizer uses different methodologies for annotation, i.e., sequence-based annotation with UPIMAPI is dependent on the availability of information about homologous sequences, while domain-based annotation with reCOGnizer tolerates less sequence homology, focusing on small but biologically relevant similarities <xref rid="b0020" ref-type="bibr">[4]</xref>. These results reinforce the advantage of combining both methods for functional annotation.</p>
    <p id="p0280">When comparing the annotation metrics obtained after analysis of the artificial metagenomes and the real metagenome with different tools, UPIMAPI + reCOGnizer obtained the highest F1 score and highest number of functional assignments regarding EC numbers (<xref rid="t0020" ref-type="table">Table 4</xref>, <xref rid="t0025" ref-type="table">Table 5</xref>). This better performance may be related to the differences between UPIMAPI + reCOGnizer and the remaining tools such as the nature and number of the reference databases. UPIMAPI and reCOGnizer annotate with reference to the entire UniProt database (including SwissProt and TrEMBL), CDD, COG, KOG, Pfam, SMART, Protein Clusters, NCBIfam and TIGRFAM, while eggNOG-mapper uses only the eggNOG database, Mantis uses the eggNOG database, NCBIfam, KOfam, Pfam and offers the possibility to add customized databases (in this comparison the UniProt database was included), Prokka uses SwissProt, some reference genomes from RefSeq, Pfam and TIGRFAM, and finally, DFAST uses a database composed of 124 reference genomes, TIGRFAM and COG. While some tools were better at obtaining EC numbers (UPIMAPI and Prokka), others were better suited for OG annotation (eggNOG-mapper and Mantis). OG annotation with UPIMAPI was particularly affected, since the sequences in the artificial metagenomics datasets were removed from the reference database, to ensure that the benchmark data is independent from the reference database. Therefore, the functional assignment was obtained from the proteins of closely related species. Because artificial metagenomes # 1 to 5 contain different microorganisms, with different closely related species, this explains the different results obtained for each one of the artificial metagenomes, i.e., the datasets containing species closely related to well characterized microorganisms obtained better annotation results with UPIMAPI. Since the sequences of the organisms studied were removed from UniProt, the results for OGs were mostly based on the results from reCOGnizer, which had consistently less recall than UPIMAPI (<xref rid="s0085" ref-type="sec">Table S9</xref>).</p>
    <p id="p0285">Generally, the tools with best performance in the functional annotation of the artificial metagenomes, were also the ones identifying the highest number of proteins, and attributing the highest number of EC numbers and OGs, in the real metagenome (<xref rid="t0020" ref-type="table">Table 4</xref>, <xref rid="t0025" ref-type="table">Table 5</xref>). Nevertheless, the results show that when analyzing real metagenomes, containing several unknown and uncharacterized proteins, it is important to use the broadest and most complete databases, as it is the case of the UniProt KB and eggNOG. For instance, UPIMAPI + reCOGnizer identified the highest number of EC numbers while eggNOG-mapper retrieved the highest number of OGs (<xref rid="t0025" ref-type="table">Table 5</xref>). Thus, different tools may be the best choice depending on the objective of the study. UPIMAPI + reCOGnizer may be the best choice if further analysis is necessary, such as mapping metabolic functions or developing metabolic models, as the combination of these tools resulted in the highest number of proteins with EC numbers assigned, independently of the dataset used (<xref rid="t0020" ref-type="table">Table 4</xref>, <xref rid="t0025" ref-type="table">Table 5</xref>). On the other hand, a deeper study on the identification of OGs would benefit from the utilization of eggNOG-mapper or Mantis. Note that the performance of the annotation with Mantis was very close to the best performing tools, i.e., it presented high F1 scores for OGs and EC numbers assignments (<xref rid="t0020" ref-type="table">Table 4</xref>), and annotated a high number of proteins from the real metagenome (<xref rid="t0025" ref-type="table">Table 5</xref>). In addition, Mantis determines a consensus identification by using text mining and a hierarchical organization of the databases, which might be useful for certain studies <xref rid="b0060" ref-type="bibr">[12]</xref>. The results obtained with UPIMAPI + reCOGnizer could have been further improved if the reference database used for the annotation contained only the proteins from the microorganisms present in the dataset, instead of using the entire UniProt database. This can be done by specifying the taxon IDs when constructing the reference database (by using the “--taxids” option), and may be useful when the microbial composition of the communities is previously known. However, from a practical viewpoint, metagenomics data are usually annotated with the entire UniProt database, since typically the taxonomic composition is unknown, and thus these results better reflect what can be obtained with real metagenomics data analyses. Results with reCOGnizer could also be improved by inputting taxonomic information with the “--tax-file” parameter (this information can be obtained for example from UPIMAPI’s output).</p>
    <p id="p0290">A major difficulty in <italic>meta</italic>-omics studies is the interpretation of the data. To overcome this limitation, it is important that the outputs from the bioinformatics analysis are easily handled, organized and that can be easily visualized. KEGGCharter represents an alternative to already existing mapping options, offering the possibility to represent in metabolic maps both taxonomic assignment and differential gene expression up to 10 samples. The representation of differential expression for many samples can also be obtained through KEGGprofile, but it requires extensive input through R commands <xref rid="b0100" ref-type="bibr">[20]</xref>. KEGG Mapper is another tool with similar purposes to KEGGCharter, but requires much more input from the users, and does not perform the automatic representation of different taxonomies and differential gene expression results in metabolic maps. Still, KEGG Mapper provides extra information, for instance, it indicates gene IDs next to the corresponding enzyme boxes <xref rid="b0075" ref-type="bibr">[15]</xref>.</p>
    <p id="p0295">Visualization with KEGGCharter can still be improved by, for example, producing more interactive maps or combining taxonomy and expression levels in the same plot. However, the main limitation of applying KEGGCharter, and other mapping tools, to datasets containing poorly characterized proteins, is the quality of the input data, e.g., a protein without functional annotation in knowledge bases will not be mapped. This results in an underestimation of the functions that can be performed by a microbial community when visualizing the data in metabolic maps. Therefore, as functional annotation evolves, more reliable pathway enrichment results can be visualized. In this context, UPIMAPI + reCOGnizer brought a very important contribution, as they retrieve a high number of EC numbers and KEGG IDs (<xref rid="t0005" ref-type="table">Table 1</xref>, <xref rid="t0015" ref-type="table">Table 3</xref>, <xref rid="t0020" ref-type="table">Table 4</xref>). But there is room for further improvements. Annotation with reCOGnizer could be expanded by parsing more information from the domain descriptions, such as EC numbers being obtained from CDD and SMART. Additionally, a methodology to reach a consensus annotation could be implemented, as it was done in other tools <xref rid="b0060" ref-type="bibr">[12]</xref>. However, obtaining as much information as possible might be advantageous depending on the studies’ objectives and requirements. Some users may want to use only the COG database because it is a known and trusted resource in bioinformatics and other users may want to annotate with the UniProt database only. For studies on single proteins, running a tool that obtains different matches in different databases may provide a higher level of trust in the results. ID mapping with UPIMAPI could also be improved, since it is still largely dependent on UniProt’s API for mapping TrEMBL IDs, and this information could potentially be explored with a fully local method. Nevertheless, local TrEMBL ID mapping would require the storage of ∼1 Tb of data, which could be a problem for the users who have no access to servers with enough space.</p>
  </sec>
  <sec id="s0060">
    <label>5</label>
    <title>Conclusions</title>
    <p id="p0300">In this work, we present three new command-line tools, tailored for retrieving the maximum amount of information from protein sequences. reCOGnizer and UPIMAPI together compose a powerful approach for protein annotation by providing complementary functional information, which can then be represented in metabolic pathways by using KEGGCharter. A great advantage of these new tools is that they are fully automated, requiring minimum input from the user. The three tools can be easily installed through Bioconda.</p>
  </sec>
  <sec sec-type="data-availability" id="s0065">
    <title>Data availability</title>
    <p id="p0305">All the scripts and commands used in this paper are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/iquasere/annotation_paper" id="ir050">https://github.com/iquasere/annotation_paper</ext-link>.</p>
    <p id="p0310">The real dataset analysed in this paper was deposited in ENA database under the study accession PRJEB50269 (<ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/ena/browser/view/PRJEB50269" id="ir055">https://www.ebi.ac.uk/ena/browser/view/PRJEB50269</ext-link>).</p>
    <sec id="s0070">
      <title>CRediT authorship contribution statement</title>
      <p id="p0315"><bold>João C. Sequeira:</bold> Conceptualization, Methodology, Software, Validation, Investigation, Formal analysis, Writing – original draft, Data curation, Resources. <bold>Miguel Rocha:</bold> Funding acquisition, Resources, Software, Writing – review &amp; editing, Supervision. <bold>M. Madalena Alves:</bold> Funding acquisition, Resources, Writing – review &amp; editing, Supervision. <bold>Andreia F. Salvador:</bold> Conceptualization, Methodology, Investigation, Writing – review &amp; editing, Visualization, Supervision.</p>
    </sec>
  </sec>
  <sec sec-type="COI-statement">
    <title>Declaration of Competing Interest</title>
    <p id="p0320">The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.</p>
  </sec>
</body>
<back>
  <ref-list id="bi005">
    <title>References</title>
    <ref id="b0005">
      <label>1</label>
      <element-citation publication-type="journal" id="h0005">
        <person-group person-group-type="author">
          <name>
            <surname>Hernández-Salmerón</surname>
            <given-names>J.E.</given-names>
          </name>
          <name>
            <surname>Moreno-Hagelsieb</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <article-title>Progress in quickly finding orthologs as reciprocal best hits: comparing blast, last, diamond and MMseqs2</article-title>
        <source>BMC Genomics</source>
        <volume>21</volume>
        <year>2020</year>
        <fpage>741</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-020-07132-6</pub-id>
        <pub-id pub-id-type="pmid">33099302</pub-id>
      </element-citation>
    </ref>
    <ref id="b0010">
      <label>2</label>
      <element-citation publication-type="journal" id="h0010">
        <person-group person-group-type="author">
          <name>
            <surname>The UniProt Consortium</surname>
          </name>
        </person-group>
        <article-title>UniProt: A hub for protein information</article-title>
        <source>Nucleic Acids Res</source>
        <volume>43</volume>
        <year>2015</year>
        <fpage>D204</fpage>
        <lpage>D212</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku989</pub-id>
        <pub-id pub-id-type="pmid">25348405</pub-id>
      </element-citation>
    </ref>
    <ref id="b0015">
      <label>3</label>
      <element-citation publication-type="journal" id="h0015">
        <person-group person-group-type="author">
          <name>
            <surname>O’Leary</surname>
            <given-names>N.A.</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>M.W.</given-names>
          </name>
          <name>
            <surname>Brister</surname>
            <given-names>J.R.</given-names>
          </name>
          <name>
            <surname>Ciufo</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Haddad</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>McVeigh</surname>
            <given-names>R.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reference sequence (RefSeq) database at NCBI: Current status, taxonomic expansion, and functional annotation</article-title>
        <source>Nucleic Acids Res</source>
        <volume>44</volume>
        <year>2016</year>
        <fpage>D733</fpage>
        <lpage>D745</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1189</pub-id>
        <pub-id pub-id-type="pmid">26553804</pub-id>
      </element-citation>
    </ref>
    <ref id="b0020">
      <label>4</label>
      <element-citation publication-type="journal" id="h0020">
        <person-group person-group-type="author">
          <name>
            <surname>Galperin</surname>
            <given-names>M.Y.</given-names>
          </name>
          <name>
            <surname>Kristensen</surname>
            <given-names>D.M.</given-names>
          </name>
          <name>
            <surname>Makarova</surname>
            <given-names>K.S.</given-names>
          </name>
          <name>
            <surname>Wolf</surname>
            <given-names>Y.I.</given-names>
          </name>
          <name>
            <surname>Koonin</surname>
            <given-names>E.V.</given-names>
          </name>
        </person-group>
        <article-title>Microbial genome analysis: The COG approach</article-title>
        <source>Brief Bioinform</source>
        <volume>20</volume>
        <year>2019</year>
        <fpage>1063</fpage>
        <lpage>1070</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbx117</pub-id>
        <pub-id pub-id-type="pmid">28968633</pub-id>
      </element-citation>
    </ref>
    <ref id="b0025">
      <label>5</label>
      <element-citation publication-type="journal" id="h0025">
        <person-group person-group-type="author">
          <name>
            <surname>De Filippo</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Ramazzotti</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Fontana</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Cavalieri</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <article-title>Bioinformatic approaches for functional annotation and pathway inference in metagenomics data</article-title>
        <source>Brief Bioinform</source>
        <volume>13</volume>
        <year>2012</year>
        <fpage>696</fpage>
        <lpage>710</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbs070</pub-id>
        <pub-id pub-id-type="pmid">23175748</pub-id>
      </element-citation>
    </ref>
    <ref id="b0030">
      <label>6</label>
      <element-citation publication-type="journal" id="h0030">
        <person-group person-group-type="author">
          <name>
            <surname>Lu</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Chitsaz</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Derbyshire</surname>
            <given-names>M.K.</given-names>
          </name>
          <name>
            <surname>Geer</surname>
            <given-names>R.C.</given-names>
          </name>
          <name>
            <surname>Gonzales</surname>
            <given-names>N.R.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CDD/SPARCLE: the conserved domain database in 2020</article-title>
        <source>Nucleic Acids Res</source>
        <volume>48</volume>
        <year>2020</year>
        <fpage>D265</fpage>
        <lpage>D268</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkz991</pub-id>
        <pub-id pub-id-type="pmid">31777944</pub-id>
      </element-citation>
    </ref>
    <ref id="b0035">
      <label>7</label>
      <element-citation publication-type="journal" id="h0035">
        <person-group person-group-type="author">
          <name>
            <surname>Marchler-Bauer</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Bryant</surname>
            <given-names>S.H.</given-names>
          </name>
        </person-group>
        <article-title>CD-Search: Protein domain annotations on the fly</article-title>
        <source>Nucleic Acids Res</source>
        <volume>32</volume>
        <year>2004</year>
        <fpage>327</fpage>
        <lpage>331</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkh454</pub-id>
      </element-citation>
    </ref>
    <ref id="b0040">
      <label>8</label>
      <element-citation publication-type="journal" id="h0040">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Fu</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Niu</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W.</given-names>
          </name>
        </person-group>
        <article-title>WebMGA: A customizable web server for fast metagenomic sequence analysis</article-title>
        <source>BMC Genomics</source>
        <volume>12</volume>
        <year>2011</year>
        <fpage>444</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-12-444</pub-id>
        <pub-id pub-id-type="pmid">21899761</pub-id>
      </element-citation>
    </ref>
    <ref id="b0045">
      <label>9</label>
      <element-citation publication-type="journal" id="h0045">
        <person-group person-group-type="author">
          <name>
            <surname>Tanizawa</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Fujisawa</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Nakamura</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>DFAST: A flexible prokaryotic genome annotation pipeline for faster genome publication</article-title>
        <source>Bioinformatics</source>
        <volume>34</volume>
        <year>2018</year>
        <fpage>1037</fpage>
        <lpage>1039</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx713</pub-id>
        <pub-id pub-id-type="pmid">29106469</pub-id>
      </element-citation>
    </ref>
    <ref id="b0050">
      <label>10</label>
      <element-citation publication-type="journal" id="h0050">
        <person-group person-group-type="author">
          <name>
            <surname>Prokka</surname>
            <given-names>S.T.</given-names>
          </name>
        </person-group>
        <article-title>Rapid prokaryotic genome annotation</article-title>
        <source>Bioinformatics</source>
        <volume>30</volume>
        <year>2014</year>
        <fpage>2068</fpage>
        <lpage>2069</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu153</pub-id>
        <pub-id pub-id-type="pmid">24642063</pub-id>
      </element-citation>
    </ref>
    <ref id="b0055">
      <label>11</label>
      <mixed-citation publication-type="other" id="h0055">Cantalapiedra CP, Hern Andez-Plaza A, Letunic I, Bork P, Huerta-Cepas J. eggNOG-mapper v2: Functional Annotation, Orthology Assignments, and Domain Prediction at the Metagenomic Scale. Mol Biol Evol 2021;msab293:1–5. 10.1093/molbev/msab293.</mixed-citation>
    </ref>
    <ref id="b0060">
      <label>12</label>
      <element-citation publication-type="journal" id="h0060">
        <person-group person-group-type="author">
          <name>
            <surname>Queirós</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Delogu</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Hickl</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>May</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Wilmes</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>Mantis: flexible and consensus-driven genome annotation</article-title>
        <source>GigaScience</source>
        <volume>10</volume>
        <year>2021</year>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1093/gigascience/giab042</pub-id>
      </element-citation>
    </ref>
    <ref id="b0065">
      <label>13</label>
      <element-citation publication-type="journal" id="h0065">
        <person-group person-group-type="author">
          <name>
            <surname>Kanehisa</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Sato</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Kawashima</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Furumichi</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Tanabe</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>KEGG as a reference resource for gene and protein annotation</article-title>
        <source>Nucleic Acids Res</source>
        <volume>44</volume>
        <year>2016</year>
        <fpage>D457</fpage>
        <lpage>D462</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1070</pub-id>
        <pub-id pub-id-type="pmid">26476454</pub-id>
      </element-citation>
    </ref>
    <ref id="b0070">
      <label>14</label>
      <element-citation publication-type="journal" id="h0070">
        <person-group person-group-type="author">
          <name>
            <surname>Klukas</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Schreiber</surname>
            <given-names>F.</given-names>
          </name>
        </person-group>
        <article-title>Dynamic exploration and editing of KEGG pathway diagrams</article-title>
        <source>Bioinformatics</source>
        <volume>23</volume>
        <year>2007</year>
        <fpage>344</fpage>
        <lpage>350</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl611</pub-id>
        <pub-id pub-id-type="pmid">17142815</pub-id>
      </element-citation>
    </ref>
    <ref id="b0075">
      <label>15</label>
      <element-citation publication-type="journal" id="h0075">
        <person-group person-group-type="author">
          <name>
            <surname>Kanehisa</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Sato</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>KEGG Mapper for inferring cellular functions from protein sequences</article-title>
        <source>Protein Sci</source>
        <volume>29</volume>
        <year>2020</year>
        <fpage>28</fpage>
        <lpage>35</lpage>
        <pub-id pub-id-type="doi">10.1002/pro.3711</pub-id>
        <pub-id pub-id-type="pmid">31423653</pub-id>
      </element-citation>
    </ref>
    <ref id="b0080">
      <label>16</label>
      <element-citation publication-type="journal" id="h0080">
        <person-group person-group-type="author">
          <name>
            <surname>Darzi</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Letunic</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Yamada</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>IPath3.0: Interactive pathways explorer v3</article-title>
        <source>Nucleic Acids Res</source>
        <volume>46</volume>
        <year>2018</year>
        <fpage>W510</fpage>
        <lpage>W513</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky299</pub-id>
        <pub-id pub-id-type="pmid">29718427</pub-id>
      </element-citation>
    </ref>
    <ref id="b0085">
      <label>17</label>
      <element-citation publication-type="journal" id="h0085">
        <person-group person-group-type="author">
          <name>
            <surname>Kono</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Arakawa</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Ogawa</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Kido</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Oshita</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Ikegami</surname>
            <given-names>K.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pathway Projector: Web-Based Zoomable Pathway Browser Using KEGG Atlas and Google Maps API</article-title>
        <source>PLoS ONE</source>
        <volume>4</volume>
        <year>2009</year>
        <object-id pub-id-type="publisher-id">e7710</object-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0007710</pub-id>
      </element-citation>
    </ref>
    <ref id="b0090">
      <label>18</label>
      <element-citation publication-type="journal" id="h0090">
        <person-group person-group-type="author">
          <name>
            <surname>Elliott</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Kirac</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Cakmak</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Yavas</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Mayes</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>E.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PathCase: Pathways database system</article-title>
        <source>Bioinformatics</source>
        <volume>24</volume>
        <year>2008</year>
        <fpage>2526</fpage>
        <lpage>2533</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn459</pub-id>
        <pub-id pub-id-type="pmid">18728044</pub-id>
      </element-citation>
    </ref>
    <ref id="b0095">
      <label>19</label>
      <element-citation publication-type="journal" id="h0095">
        <person-group person-group-type="author">
          <name>
            <surname>Puente-Sánchez</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Garciá-Garciá</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Tamames</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>SQMtools: Automated processing and visual analysis of ’omics data with R and anvi’o</article-title>
        <source>BMC Bioinf</source>
        <volume>21</volume>
        <year>2020</year>
        <fpage>358</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-020-03703-2</pub-id>
      </element-citation>
    </ref>
    <ref id="b0100">
      <label>20</label>
      <mixed-citation publication-type="other" id="h0100">Zhao S. KEGGprofile: Application Examples. https://bioconductor.riken.jp/packages/3.2/bioc/vignettes/KEGGprofile/inst/doc/KEGGprofile.pdf. 2020.</mixed-citation>
    </ref>
    <ref id="b0105">
      <label>21</label>
      <element-citation publication-type="journal" id="h0105">
        <person-group person-group-type="author">
          <name>
            <surname>Huson</surname>
            <given-names>D.H.</given-names>
          </name>
          <name>
            <surname>Beier</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Flade</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Górska</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>El-Hadidi</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Mitra</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MEGAN Community Edition-Interactive Exploration and Analysis of Large-Scale Microbiome Sequencing Data</article-title>
        <source>PLoS Comput Biol</source>
        <volume>12</volume>
        <year>2016</year>
        <object-id pub-id-type="publisher-id">e1004957</object-id>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004957</pub-id>
      </element-citation>
    </ref>
    <ref id="b0110">
      <label>22</label>
      <element-citation publication-type="journal" id="h0110">
        <person-group person-group-type="author">
          <name>
            <surname>Cock</surname>
            <given-names>P.J.A.</given-names>
          </name>
          <name>
            <surname>Antao</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>J.T.</given-names>
          </name>
          <name>
            <surname>Chapman</surname>
            <given-names>B.A.</given-names>
          </name>
          <name>
            <surname>Cox</surname>
            <given-names>C.J.</given-names>
          </name>
          <name>
            <surname>Dalke</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Biopython: Freely available Python tools for computational molecular biology and bioinformatics</article-title>
        <source>Bioinformatics</source>
        <volume>25</volume>
        <year>2009</year>
        <fpage>1422</fpage>
        <lpage>1423</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp163</pub-id>
        <pub-id pub-id-type="pmid">19304878</pub-id>
      </element-citation>
    </ref>
    <ref id="b0115">
      <label>23</label>
      <element-citation publication-type="journal" id="h0115">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>S.F.</given-names>
          </name>
          <name>
            <surname>Madden</surname>
            <given-names>T.L.</given-names>
          </name>
          <name>
            <surname>Schäffer</surname>
            <given-names>A.A.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>
        <source>Nucleic Acids Res</source>
        <volume>25</volume>
        <year>1997</year>
        <fpage>3389</fpage>
        <lpage>3402</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/25.17.3389</pub-id>
        <pub-id pub-id-type="pmid">9254694</pub-id>
      </element-citation>
    </ref>
    <ref id="b0120">
      <label>24</label>
      <element-citation publication-type="journal" id="h0120">
        <person-group person-group-type="author">
          <name>
            <surname>The UniProt Consortium</surname>
          </name>
        </person-group>
        <article-title>UniProt: the universal protein knowledgebase</article-title>
        <source>Nucleic Acids Res</source>
        <volume>45</volume>
        <year>2017</year>
        <fpage>D158</fpage>
        <lpage>D169</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw1099</pub-id>
        <pub-id pub-id-type="pmid">27899622</pub-id>
      </element-citation>
    </ref>
    <ref id="b0125">
      <label>25</label>
      <element-citation publication-type="journal" id="h0125">
        <person-group person-group-type="author">
          <name>
            <surname>Loewenstein</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Raimondo</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Redfern</surname>
            <given-names>O.C.</given-names>
          </name>
          <name>
            <surname>Watson</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Frishman</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Linial</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Protein function annotation by homology-based inference</article-title>
        <source>Genome Biol</source>
        <volume>10</volume>
        <year>2009</year>
        <fpage>207</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2009-10-2-207</pub-id>
        <pub-id pub-id-type="pmid">19226439</pub-id>
      </element-citation>
    </ref>
  </ref-list>
  <sec id="s0085" sec-type="supplementary-material">
    <label>Appendix A</label>
    <title>Supplementary data</title>
    <p id="p0345">The following are the Supplementary data to this article:<supplementary-material content-type="local-data" id="m0015"><caption><title>Supplementary data 1</title></caption><media xlink:href="mmc1.pdf"/></supplementary-material></p>
    <p id="p0350">
      <supplementary-material content-type="local-data" id="m0010">
        <caption>
          <title>Supplementary data 2</title>
        </caption>
        <media xlink:href="mmc2.zip"/>
      </supplementary-material>
    </p>
    <p id="p0355">
      <supplementary-material content-type="local-data" id="m0005">
        <caption>
          <title>Supplementary data 3</title>
        </caption>
        <media xlink:href="mmc3.zip"/>
      </supplementary-material>
    </p>
  </sec>
  <ack id="ak005">
    <sec id="s0075">
      <title>Acknowledgments</title>
      <p id="p0325">The research leading to these results has received funding from the European Union, Horizon 2020 innovation action programme under grant agreement No 952908—GLOMICAVE project.</p>
      <p id="p0330">This study was supported by the Portuguese Foundation for Science and Technology (FCT) under the scope of the strategic funding of UIDB/04469/2020 unit and the FCT grant SFRH/BD/147271/2019 (attributed to João Sequeira).</p>
      <p id="p0335">We would also like to acknowledge the contribution of Tiago Oliveira in the development of KEGGCharter.</p>
    </sec>
  </ack>
  <fn-group>
    <fn id="s0080" fn-type="supplementary-material">
      <label>Appendix A</label>
      <p id="p0340">Supplementary data to this article can be found online at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.csbj.2022.03.042" id="ir060">https://doi.org/10.1016/j.csbj.2022.03.042</ext-link>.</p>
    </fn>
  </fn-group>
</back>
