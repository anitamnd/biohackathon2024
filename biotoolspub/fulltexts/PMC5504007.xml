<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5504007</article-id>
    <article-id pub-id-type="publisher-id">4567</article-id>
    <article-id pub-id-type="doi">10.1038/s41598-017-04567-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MIST: Accurate and Scalable Microscopy Image Stitching Tool with Stage Modeling and Error Minimization</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Chalfoun</surname>
          <given-names>Joe</given-names>
        </name>
        <address>
          <email>joe.chalfoun@nist.gov</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Majurski</surname>
          <given-names>Michael</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Blattner</surname>
          <given-names>Tim</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bhadriraju</surname>
          <given-names>Kiran</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Keyrouz</surname>
          <given-names>Walid</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bajcsy</surname>
          <given-names>Peter</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Brady</surname>
          <given-names>Mary</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">000000012158463X</institution-id><institution-id institution-id-type="GRID">grid.94225.38</institution-id><institution>Information Technology Laboratory, </institution><institution>National Institute of Standards and Technology, </institution></institution-wrap>100 Bureau Dr, Gaithersburg, 20878 MD USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">000000012158463X</institution-id><institution-id institution-id-type="GRID">grid.94225.38</institution-id><institution>Physical Measurement Laboratory, </institution><institution>National Institute of Standards and Technology, </institution></institution-wrap>100 Bureau Drive, Gaithersburg, 20899 MD USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0941 7177</institution-id><institution-id institution-id-type="GRID">grid.164295.d</institution-id><institution>Fischell Department of Bioengineering, </institution><institution>University of Maryland at College Park, </institution></institution-wrap>College Park, 20742 MD USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>10</day>
      <month>7</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>7</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <volume>7</volume>
    <elocation-id>4988</elocation-id>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>1</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>5</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2017</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Automated microscopy can image specimens larger than the microscope’s field of view (FOV) by stitching overlapping image tiles. It also enables time-lapse studies of entire cell cultures in multiple imaging modalities. We created MIST (Microscopy Image Stitching Tool) for rapid and accurate stitching of large 2D time-lapse mosaics. MIST estimates the mechanical stage model parameters (actuator backlash, and stage repeatability ‘<italic>r</italic>’) from computed pairwise translations and then minimizes stitching errors by optimizing the translations within a (4<italic>r</italic>)<sup>2</sup> square area. MIST has a performance-oriented implementation utilizing multicore hybrid CPU/GPU computing resources, which can process terabytes of time-lapse multi-channel mosaics 15 to 100 times faster than existing tools. We created 15 reference datasets to quantify MIST’s stitching accuracy. The datasets consist of three preparations of stem cell colonies seeded at low density and imaged with varying overlap (10 to 50%). The location and size of 1150 colonies are measured to quantify stitching accuracy. MIST generated stitched images with an average centroid distance error that is less than 2% of a FOV. The sources of these errors include mechanical uncertainties, specimen photobleaching, segmentation, and stitching inaccuracies. MIST produced higher stitching accuracy than three open-source tools. MIST is available in ImageJ at isg.nist.gov.</p>
    </abstract>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2017</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par2">Microscopy imaging of cell cultures must address the spatial scale mismatch between the microscope’s FOV (given its resolution and magnification) and the size of the specimen under study. For example, the area of a standard 6-well plate well is approximately 1000 times larger than the FOV acquired with a 10X objective. Automated microscopy overcomes this limitation by acquiring a grid of partially overlapping images that are stitched together into a time-sequence of composite images. A primary motivation for large coverage imaging is better statistical sampling and the capture of rare events. The probability of observing interesting events increases with respect to the spatial extent and temporal length of the acquisition. These spatial and temporal scales pose challenges for image stitching software. Creating a large mosaic is challenging because the stitching algorithm is sensitive to image feature sparsity in the overlapping regions of adjacent tiles (e.g., during the early period of cell colony growth) and in the computational resources needed for assembling the resulting mosaic. Furthermore, quantitative measurements, such as counts, densities, texture, and protein expressions, depend on the accuracy of stitching algorithms. Existing 2D stitching tools did not meet the accuracy or the runtime requirements to analyze our large dataset projects, like the Oct4 temporal gene expression analysis in stem cell colonies<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>, and some existing 3D stitching tools<sup><xref ref-type="bibr" rid="CR2">2</xref></sup> are not even applicable to 2D stitching problems.</p>
    <p id="Par3">We address the stitching problem of creating time-lapse mosaics from large 2D grids of overlapping images to enable time-lapse studies of entire cell cultures in multiple imaging modalities. Each tile has a vertical and horizontal overlap with its neighbors. There are three steps for stitching a grid of image tiles: (1) compute candidate translations between adjacent tiles, (2) adjust translations to reduce errors in the stitched image, and (3) compose tiles to produce the mosaic image.</p>
    <p id="Par4">There are two commonly used general approaches to compute the translations between adjacent tiles, feature-based<sup><xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR8">8</xref></sup> and Fourier-based<sup><xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR14">14</xref></sup>. Feature-based approaches identify matching features in adjacent images and then use these features to compute image translations. However, these techniques require a feature extraction step to detect common features of interest present in two adjacent images. Approaches based on Fourier transforms use image frequency components as the main features. This approach assumes that images have enough pixels with unique frequency components in the overlapping image areas. Both approaches can be effective; the choice of which one to use depends on the overall image content and the characteristics of matching features. Due to its simplicity and predictable parallelism, we decided to include the Fourier-based translation computation.</p>
    <p id="Par5">For the translation improvement step, microscopy imaging of sparsely populated cell cultures generates feature-poor images (e.g., imaging live colonies with low colony density) that introduce errors in the translation computation. A global optimization of the computed translations will reduce the errors in the stitched image. Multiple different optimization techniques can be used to perform this translation optimization: Levenberg-Marquardt<sup><xref ref-type="bibr" rid="CR3">3</xref></sup> or weighted least squares<sup><xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR15">15</xref></sup> applied to all translations, maximize the number of features found in the overlap areas<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>, minimize an error function between hypothesized and actual point correspondences using a joint registration algorithm<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, maximize the normalized cross correlation<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>, minimize a predefined energy function<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>, or use global geometric and radiometric parameter estimation<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. These optimization methods do not consider the physical system (e.g., the microscope stage) limitations on the search space, which may lead to large residual errors after optimization in sparse experiments. In contrast, MIST estimates the mechanical stage model parameters from the computed translations to limit the optimization search space and achieve better stitching accuracy.</p>
    <p id="Par6">For the mosaic construction step, multiple approaches exist to assemble the mosaic based on the computed translations. Some treat the translations and their corresponding normalized cross correlations as an undirected graph where an algorithm like the minimum spanning tree<sup><xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR15">15</xref></sup> is used to assemble the mosaic. Others treat the problem as an over constrained system of linear equations and solve it using least squares methods<sup><xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR14">14</xref></sup>, iterative square displacement minimization<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>, or singular value decomposition<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>. With our optimization approach, a minimum spanning tree algorithm produced an accurate mosaic.</p>
    <p id="Par7">We present a novel grid stitching technique called Microscopy Image Stitching Tool (MIST) that estimates the mechanical stage model parameters (actuator backlash, stage repeatability ‘<italic>r</italic>’, and camera angle) from computed pairwise translations and then minimizes stitching errors by constraining and optimizing the translations within a square area of (4<italic>r</italic>)<sup>2</sup>. This constraint reduces the maximum error related to the translation computation for any pair of images. The stage modeling and error minimization methodology is applicable to microscopy images or any mechanical instrument that acquires a 2D grid of image tiles. Another novel aspect of MIST is its multicore hybrid CPU/GPU implementation which can process terabytes of 2D time-lapse multi-channel mosaics 15 to 100 times faster than existing tools. We quantify MIST’s accuracy on three preparations of stem cell colonies seeded at low density and imaged with varying spatial overlap (10 to 50%) where the location and size of 1150 colonies are automatically measured on the microscope. MIST generated stitched images with an average colony centroid distance error less than 2% of a FOV and an average colony area error less than 5%. The sources of these errors include mechanical uncertainties, sample photobleaching, segmentation, and the stitching itself. We show that the area error is mainly due to photobleaching and not stitching, see Supplementary Document section 1 for details. MIST produced the most accurate stitching result when compared to three open-source tools used in the literature on the reference datasets.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>MIST highlights</title>
      <p id="Par8">Figure <xref rid="Fig1" ref-type="fig">1</xref> highlights MIST’s algorithm and novel aspects: the global optimization and the performance.<fig id="Fig1"><label>Figure 1</label><caption><p>Schematic description of MIST’s algorithm summary and novelties.</p></caption><graphic xlink:href="41598_2017_4567_Fig1_HTML" id="d29e399"/></fig>
</p>
    </sec>
    <sec id="Sec4">
      <title>Application across image content, modalities, and instruments</title>
      <p id="Par9">We evaluated MIST’s applicability and robustness on over a thousand fully stitched images (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). These large and diverse datasets comprise multiple image content types, imaging modalities, microscopes, and data sizes. They were acquired using five microscopes (Leica, Olympus, Nikon, Focused Ion Beam Scanning Electron Microscope (FIB-SEM), and Zeiss), four imaging modalities (fluorescent, phase contrast, bright-field, and FIB-SEM), eight content types (A10 cells, carbon nanotubes, Human Bone Marrow Stromal Cells (HBMSC), Induced Pluripotent Stem Cells (IPSCs), paper nanoparticles, rat brain cells, Human Embryonic Stem Cells, and C. elegans), large range of image overlaps (10–70%), and a large range of grid sizes (5 × 5 to 70 × 93). These datasets are available at isg.nist.gov.<fig id="Fig2"><label>Figure 2</label><caption><p>MIST application example images: (<bold>1</bold>) A10 cells, (<bold>2</bold>) Carbon Nanotubes, (<bold>3</bold>) HBMSC, (<bold>4</bold>) IPS cell colonies, (<bold>5</bold>) Paper nanoparticle, (<bold>6</bold>) Rat brain cells, (<bold>7</bold>) Stem cell colonies, and (<bold>8</bold>) Worms.</p></caption><graphic xlink:href="41598_2017_4567_Fig2_HTML" id="d29e442"/></fig>
</p>
    </sec>
    <sec id="Sec5">
      <title>Quantitative accuracy measurement</title>
      <p id="Par10">Accuracy metrics: we use the following three metrics to quantify the stitching accuracy when comparing reference and stitched measurements over regions of interest (ROI): (1) false positive (added ROIs) &amp; false negative (undetected ROI), (2) centroid distance error in pixels (<italic>D</italic>
<sub><italic>err</italic></sub>), and (3) percent area error (<italic>S</italic>
<sub><italic>err</italic></sub>) between ROIs.</p>
      <p id="Par11">We used three regular 6-well plates of stem cell colonies to generate stitching reference and testing datasets. Only one well is used in each plate where stem cell colonies are seeded at low density to allow for colony growth.</p>
      <p id="Par12">Reference dataset: for each plate, we automatically imaged each colony with an exposure time that produces a high quality fluorescent image and centered it inside the FOV by an automated microscopy feedback loop. This loop minimizes the difference between the colony centroid and the middle of the FOV until it reaches convergence (difference less than 1 μm). The final centroid location for a colony is saved from the microscope stage controller and its area measured by segmentation. More detail is available in Supplementary Document section 1.5.</p>
      <p id="Par13">Test dataset: for each plate, we imaged an inscribed square area with five overlap values ranging from 10% to 50% for a total of 5 × 3 stitched test datasets.</p>
      <p id="Par14">We ran MIST and three other open-source tools on the test datasets and generated the corresponding stitched images. These tools: FijiIS<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, TeraStitcher<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>, iStitch<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>, had implementations available from the literature and operate on 2D images. We measured stitching accuracy using the three metrics <italic>FP</italic> + <italic>FN</italic>, <italic>D</italic>
<sub><italic>err</italic></sub>, and <italic>S</italic>
<sub><italic>err</italic></sub>. Table <xref rid="Tab1" ref-type="table">1</xref> summarizes the stitching accuracy quantitative measurement across all three reference datasets. The results were combined on all three experiments by adding the <italic>FP</italic> + <italic>FN</italic> metric and by reporting the average and standard deviation of the <italic>D</italic>
<sub><italic>err</italic></sub>, and <italic>S</italic>
<sub><italic>err</italic></sub> metrics.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Stitching accuracy measurement results across all three experiments.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Metric</th><th>Tool</th><th>10% overlap</th><th>20% overlap</th><th>30% overlap</th><th>40% overlap</th><th>50% overlap</th></tr></thead><tbody><tr><td rowspan="4"><italic>FP</italic> + <italic>FN</italic> (Count)</td><td>MIST</td><td>1</td><td>1</td><td>1</td><td>2</td><td>2</td></tr><tr><td>TeraStitcher</td><td>2</td><td>8</td><td>6</td><td>13</td><td>5</td></tr><tr><td>iStitch</td><td>1008</td><td>1052</td><td>960</td><td>574</td><td>748</td></tr><tr><td>FijiIS</td><td>3</td><td>2</td><td>4</td><td>4</td><td>5</td></tr><tr><td rowspan="4"><italic>D</italic><sub><italic>err</italic></sub> (Pixels)</td><td>MIST</td><td>14 ± 7</td><td>16 ± 8</td><td>16 ± 9</td><td>16 ± 8</td><td>16 ± 8</td></tr><tr><td>TeraStitcher</td><td>18 ± 9</td><td>16 ± 10</td><td>19 ± 11</td><td>19 ± 9</td><td>18 ± 10</td></tr><tr><td>iStitch</td><td>153 ± 0</td><td>679 ± 0</td><td>586 ± 87</td><td>164 ± 80</td><td>254 ± 122</td></tr><tr><td>FijiIS</td><td>14 ± 44</td><td>29 ± 52</td><td>15 ± 8</td><td>15 ± 7</td><td>29 ± 40</td></tr><tr><td rowspan="4"><italic>S</italic><sub><italic>err</italic></sub> (Percent)</td><td>MIST</td><td>−1 ± 4</td><td>1 ± 5</td><td>0 ± 5</td><td>1 ± 5</td><td>0 ± 5</td></tr><tr><td>TeraStitcher</td><td>−1 ± 5</td><td>3 ± 6</td><td>2 ± 7</td><td>5 ± 8</td><td>5 ± 8</td></tr><tr><td>iStitch</td><td>−14 ± 0</td><td>−59 ± 0</td><td>1 ± 8</td><td>3 ± 5</td><td>0 ± 7</td></tr><tr><td>FijiIS</td><td>−1 ± 4</td><td>1 ± 5</td><td>0 ± 5</td><td>1 ± 5</td><td>0 ± 5</td></tr></tbody></table></table-wrap>
</p>
      <p id="Par15">It is important for any stitching tool to minimize all three metrics, but paramount is the <italic>FP</italic> + <italic>FN</italic> metric, which measures ROI duplication or deletion. The <italic>FP</italic> + <italic>FN</italic> metric should have a value as close as possible to zero for any accurate stitching. The results show that MIST has the lowest <italic>FP</italic> + <italic>FN</italic> metric among all evaluated tools. Any colony with a centroid distance error larger than the smallest dimension of the FOV is considered missed, thereby increasing the value of the <italic>FP</italic> + <italic>FN</italic> metric. The <italic>D</italic>
<sub><italic>err</italic></sub> metric measures the global accuracy of a stitching method over the entire reconstructed image. MIST has consistently one of the lowest average and standard deviation <italic>D</italic>
<sub><italic>err</italic></sub>. The <italic>S</italic>
<sub><italic>err</italic></sub> metric measures the local stitching accuracy over an ROI (in this case a colony). Both MIST and FijiIS performed well locally over the colonies area. TeraStitcher did well on the low overlap datasets but not as well on the higher overlaps. iStitch did not produce any results for all the test datasets.</p>
    </sec>
    <sec id="Sec6">
      <title>Qualitative accuracy measurement</title>
      <p id="Par16">For our application, feature sparse image grids occur at the early time-points of a time-lapse experiment where colonies are seeded at low density to allow for growth<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. Time-lapse stem cell colony experiments often start with very low colony seeding densities to give the colonies room to grow. The test dataset for qualitative accuracy measurement is our Stem Cell Replicate1<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. Each grid of the 161 phase-contrast time-lapse images consists of 18 × 22 images (396 total) acquired at 10% overlap.</p>
      <p id="Par17">Due to the lack of reference measurements in these large-coverage time-lapse experiments with live stem cells we resorted to visual inspection and a qualitative distance error metric to measure the general correctness of the stitched images.</p>
      <p id="Par18">This qualitative stitching accuracy illustrates the robustness of MIST in stitching large feature-sparse datasets. Figure <xref rid="Fig3" ref-type="fig">3</xref> shows three example images of each tool for different time points and Fig. <xref rid="Fig4" ref-type="fig">4</xref> displays the distance error to the reference 10% overlap image grid and the corresponding runtime for each tool.<fig id="Fig3"><label>Figure 3</label><caption><p>Example of stem cell colonies over time that are stitched by all four tools and with different values of the regression threshold in FijiIS.</p></caption><graphic xlink:href="41598_2017_4567_Fig3_HTML" id="d29e906"/></fig>
<fig id="Fig4"><label>Figure 4</label><caption><p>(<bold>a</bold>) Qualitative stitching accuracy and (<bold>b</bold>) Execution time throughout the time-sequence.</p></caption><graphic xlink:href="41598_2017_4567_Fig4_HTML" id="d29e922"/></fig>
</p>
      <p id="Par19">All three open-source tools (TeraStitcher, iStitch, and FijiIS) failed to produce a correctly stitched image at some point in the time-sequence. The final stitched images should not have any blank pixels inside the gridded boundaries because the 10% overlap between FOVs (67 <italic>μm</italic>) is large enough to overcome any actuator backlash or stage position errors. A blank pixel in grayscale images is defined as a pixel that is neither a background nor a foreground and has no intensity value ( = 0). Figure <xref rid="Fig3" ref-type="fig">3</xref> shows blank pixels cutting through the colonies for the TeraStitcher assembled image at <italic>t</italic> = 150. TeraStitcher performed well for the early time points, but was challenged by the later time points. Figure <xref rid="Fig4" ref-type="fig">4</xref> illustrates stitching errors for TeraStitcher at late time-points (<italic>t</italic> = [125,140] and <italic>t</italic> = [155,161]) similar to the example shown (<italic>t</italic> = [150] in Fig. <xref rid="Fig3" ref-type="fig">3</xref>). This tool’s slow runtime (multiple hours per image) prevents its use on such large datasets. iStitch was unable to produce viable results for any time point, in some cases it had not finished after 10<sup>4</sup> s. FijiIS has a regression threshold (<italic>rT</italic>) parameter, which when lowered improved the accuracy of the stitched image at the cost of longer runtimes. The default <italic>rT</italic> value (0.3) does not yield a viable result for any time-point. Even with a very low regression threshold, FijiIS does not produce reliable stitched images during the early time points. It does well at later time points where colonies are big enough to cover the overlapping area between consecutive images. However, for such a low regression threshold value, FijiIS is as slow as TeraStitcher during the early time points.</p>
    </sec>
    <sec id="Sec7">
      <title>Performance</title>
      <p id="Par20">The MIST ImageJ plugin was developed with performance in mind so it can process large datasets in a timely manner especially with respect to time-lapse studies. Our specific performance goal is to stitch large grids (55 × 55 images of 1040 × 1392 pixels each) in less than 1 minute, thereby allowing enough computing time to analyze the acquired images before the start of the next imaging cycle. Our strategy to achieve this goal is to take advantage of the hardware parallelism that is available in a single machine with multicore CPUs and GPUs. As an illustration of MIST’s temporal scalability, MIST stitches all 161 time points of the feature-sparse Stem Cell Replicate1 dataset (Fig. <xref rid="Fig4" ref-type="fig">4</xref>) in 67.2 minutes on our test system (with two high end Intel Xeon CPUs). In contrast, FijiIS (<italic>rT</italic> = 0.01) requires 73.7 hours using the same hardware (nearly 65 × slower). Furthermore, adding one NVIDIA Tesla K40 GPU to the test machine nearly halves the dataset’s processing time, down to 36.6 minutes (1.8 × speedup). Individual time points stitch at interactive rates, requiring an average of 25 and 14 seconds for the CPU and GPU, respectively. This allows users to interact with their data in near real-time. In general, adding a second GPU can reduce the execution time for large grids; however, this is not the case for the 18 × 22 grids in this dataset as processing with two GPUs becomes dominated by disk I/O.</p>
      <p id="Par21">Figure <xref rid="Fig5" ref-type="fig">5</xref> illustrates the scalability of all 4 stitching tools for successively larger image grids. To reduce potential confounding factors, each grid is a subset of a 55 × 55 tile dataset consisting of phase contrast images of stem cell colonies acquired with a 10× objective covering a 10 cm well with 10% image overlap (50 000 × 70 000 pixel stitched image). By sub-setting a single dataset, both image content and overlap are constant while the grid size varies. The reported times are an average of 10 consecutive runs with the 10<sup>th</sup> and 90<sup>th</sup> percentiles removed. MIST-CPU outperforms the other stitching tools by 1–3 orders of magnitude and scales better as the image grid increases in size. Additionally, MIST-1GPU is on average 3.6× faster than MIST-CPU with identical scaling. This speedup improves upon the 1.8× speedup from the temporal experiment, which is limited by the Stem Cell Replicate1 image data being stored on a standard hard drive versus this dataset being cached in memory. This factor highlights the effect that disk I/O has on scalable performance. Adding a second GPU improves performance for grids larger than 25 × 25; providing an average 4.5× speedup compared to MIST-CPU. With grids smaller than 20 × 20 MIST-2GPU is slower than the 1 GPU version due to setup overhead, GPU-to-GPU communication, and there not being enough work to keep both GPUs busy.<fig id="Fig5"><label>Figure 5</label><caption><p>Stitching execution times for varying grid sizes (number of images).</p></caption><graphic xlink:href="41598_2017_4567_Fig5_HTML" id="d29e990"/></fig>
</p>
    </sec>
  </sec>
  <sec id="Sec8" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par22">MIST is a robust 2D time-lapse multi-channel stitching tool that can be used on any grid-based dataset like those acquired by a microscope. Its demonstrated accuracy, performance, and scalability make MIST optimal for handling large microscopy datasets. MIST is available in MATLAB and as an ImageJ/Fiji plugin with CPU and GPU implementations from isg.nist.gov.</p>
    <p id="Par23">MIST has several limitations that should be noted. It was designed to stitch microscopy images acquired using a mechanical stage which moves the sample in a repeatable grid pattern. Additionally, MIST expects the overlap error between images to be less than a pre-defined actuator backlash (default value of ±3%). Any computed overlap value beyond that error is deemed unreliable. This stage mechanical model prevents MIST from handling stitching problems with varying overlaps within the same acquisition. MIST is designed to perform 2D time-lapse multi-channel stitching. It cannot perform volumetric (3D) stitching, but MIST’s ability to stitch a time sequence makes it usable for 3D data if the z-stack is acquired for every (<italic>x</italic>,<italic>y</italic>) location as explained in Supplementary Document section 3.2. MIST uses normalized cross correlations (<italic>ncc</italic>) to compute image registrations. The presence of high levels of image noise can affect this metric and impact stitching accuracy. If the images being stitched are very noisy, then they may need to be preprocessed before stitching. Preprocessing images with a Gaussian filter, for example, can reduce the noise level and smooth the derived <italic>ncc</italic> surface. Supplementary Document section 3.3 presents an example of preprocessing noisy carbon-nanotubes images.</p>
  </sec>
  <sec id="Sec9" sec-type="materials|methods">
    <title>Methods</title>
    <p id="Par24">Regular stitching algorithms typically consist of three steps: (1) compute candidate translations between adjacent tiles, (2) optimize translations to reduce stitching errors in the mosaic image, and (3) produce the mosaic image based on the translations.</p>
    <p id="Par25">Our algorithm introduces an estimation of the microscope mechanical stage parameters as a new step between the steps 1 and 2 if the stage parameters are not provided by the user. MIST uses the stage modeling to perform translation optimization. Translation optimization is needed in experiments with intensity-homogeneous background and sparse foreground objects because of poor signal in overlapping areas. This causes large errors in the estimated tile translations. In addition, translations have a large uncertainty in the relative stage position due to the stage repeatability, that amounts to 1 to 2 microns for good microscopes, and the microscope’s camera angle between the stage coordinate system and the camera coordinate system. The user might specify a desired 10% spatial overlap between consecutive tiles but the actual overlap value could fluctuate between 8% and 12%. This fluctuation is the reason why naïve stitching with fixed overlap will not be accurate. Our method takes advantage of the stage modeling to limit the search space around the 10% value within a range that is proportional to the amount of estimated (or given) stage repeatability.</p>
    <p id="Par26">The MIST algorithm consists of the following four steps: (1) compute candidate translations between adjacent tiles, (2) estimate mechanical stage model from computed translations if model parameters are not given by the user, (3) optimize translations to reduce stitching errors in the mosaic image, and (4) compose tiles to produce the mosaic image.</p>
    <sec id="Sec10">
      <title>Translation computation</title>
      <p id="Par27">MIST uses a Fourier-based approach for simplicity and predictable performance since it does not need an additional feature detection tool. MIST implements the Phase Correlation Method<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> (PCM) to compute translations between adjacent tiles. PCM is based on the Fourier Shift Theorem which computes the spatial shift between two images as a phase shift in the frequency domain.</p>
      <p id="Par28">In real images, phase correlation (<italic>PC</italic>) contains several peaks that correspond to different translation values<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. To determine the correct translation, the top two peaks in the <italic>PC</italic> matrix are evaluated. The number of peaks is adjustable and the default is two. Due to the periodicity of the Fourier domain, each peak corresponds to four different possible translations (in 2D). We evaluate these four possible translations, for each peak, using the normalized cross-correlation (<italic>ncc</italic>) of the overlap area between adjacent images. The candidate translation with the highest <italic>ncc</italic> value is selected as the translation between two adjacent images.</p>
    </sec>
    <sec id="Sec11">
      <title>Estimation of mechanical stage model from pairwise translations</title>
      <p id="Par29">There is a degree of uncertainty in the translation computation that causes errors in the stitching results. The sources of errors that affect translation computation between pairs of images are: (1) the signal to noise ratio in the acquired image, (2) the amount of signal in the overlap area, (3) the signal distribution with respect to the stage movement in the overlap area (i.e., flat-field effect in some imaging modalities, uniform or periodic signal distribution), and (4) the mechanical imperfections of the automated microscope stage (i.e., stage repeatability and actuator backlash).</p>
      <p id="Par30">Moreover, the mechanical stage model parameters vary over time and the variation magnitude depends on the microscope usage. If the microscope’s user calibrated the equipment and measured the stage repeatability, there is an option to input such parameters in the advanced tab of the tool. If the user inputs those parameters, then MIST does not estimate them. However, it is difficult and time consuming to calibrate and estimate the mechanical stage properties of the microscope.</p>
      <p id="Par31">Additionally, there are research environments where a microscope might have multiple users. Each user might adjust/change/perturb the camera settings or mechanical stage. These physical changes can alter the microscope to be out of calibration.</p>
      <p id="Par32">Finally, there are time-lapse experiments in which touching the mechanical stage cannot be avoided. For example, cells in live experiments need to be fed intermittently. To do this, the sample is removed from the microscope and then put back on the stage after media change. This feeding process can alter the mechanical stage properties among many other experimental settings.</p>
      <p id="Par33">Therefore, we are offering an automated way to estimate these stage parameters from the computed translations to prevent the user from having to calibrate and measure these parameters before every acquisition.</p>
      <p id="Par34">An automated microscope has two co-planar coordinate frames, the observation frame (i.e., camera) and the control frame (i.e., stage actuators), that are related by the camera angle <italic>α</italic>, as shown in Fig. <xref rid="Fig6" ref-type="fig">6.a</xref>. This angle is difficult to calibrate. Therefore, a misalignment between the camera and stage axes will remain in most experiments. The camera observes the horizontal and vertical stage movements, <italic>H</italic> and <italic>V</italic>, as (<italic>H</italic>
<sub><italic>x</italic></sub>,<italic>H</italic>
<sub><italic>y</italic></sub>) and (<italic>V</italic>
<sub><italic>x</italic></sub>,<italic>V</italic>
<sub><italic>y</italic></sub>) which are computed as follows:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[\begin{array}{c}{H}_{x}\\ {H}_{y}\end{array}]=[\begin{array}{c}H\,\cos \,\alpha \\ -H\,\sin \,\alpha \end{array}]\,{\&amp;}\,[\begin{array}{c}{V}_{x}\\ {V}_{y}\end{array}]=[\begin{array}{c}V\,\sin \,\alpha \\ V\,\cos \,\alpha \end{array}]$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>H</mml:mi><mml:mspace width=".25em"/><mml:mi>cos</mml:mi><mml:mspace width=".10em"/><mml:mi>α</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mi>H</mml:mi><mml:mspace width=".25em"/><mml:mi>sin</mml:mi><mml:mspace width=".10em"/><mml:mi>α</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mspace width=".25em"/><mml:mo>&amp;</mml:mo><mml:mspace width=".1em"/><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>V</mml:mi><mml:mspace width=".25em"/><mml:mi>sin</mml:mi><mml:mspace width=".10em"/><mml:mi>α</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>V</mml:mi><mml:mspace width=".25em"/><mml:mi>cos</mml:mi><mml:mspace width=".10em"/><mml:mi>α</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:math><graphic xlink:href="41598_2017_4567_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>
<fig id="Fig6"><label>Figure 6</label><caption><p>Stage mechanical model. (<bold>a</bold>) Stage displacements as observed by the camera. (<bold>b</bold>) Uncertainty and errors of horizontal and vertical tile translations due to stage mechanical properties.</p></caption><graphic xlink:href="41598_2017_4567_Fig6_HTML" id="d29e1250"/></fig>
</p>
      <p id="Par35">A motorized mechanical XY-Stage moves a biological sample relative to the microscope’s optical column. This movement is carried out by two independent stepper motor linear actuators, one for each direction. The mechanical uncertainty of such a system is known as the stage repeatability. Moreover, the imperfection of the stage as a mechanical device introduces a variable overlap between adjacent tiles. Modeling the mechanical properties of a stage provides an upper bound to the variable overlap and can be used to limit the search for optimal translations, thereby minimizing the margin of stitching error.</p>
      <p id="Par36">Figure <xref rid="Fig6" ref-type="fig">6.b</xref> shows a grid tiling with the positions (<italic>x</italic>,<italic>y</italic>) that the stage will visit. Each position has an uncertainty equal to the stage repeatability (<italic>x</italic> ± <italic>r</italic>
<sub><italic>x</italic></sub>,<italic>y</italic> ± <italic>r</italic>
<sub><italic>y</italic></sub>). However, translations (<italic>dx</italic>,<italic>dy</italic>) computed in the vertical or horizontal directions between adjacent tiles are differences between respective positions. Therefore, the maximum possible error in the computed translation values is (<italic>dx</italic> ± 2<italic>r</italic>
<sub><italic>x</italic></sub>,<italic>dy</italic> ± 2<italic>r</italic>
<sub><italic>y</italic></sub>).</p>
      <p id="Par37">The horizontal and vertical translations in the image coordinate system must account for the camera angle as well as the mechanical uncertainties. The equations for horizontal and vertical translations that include the microscope models are the following:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{\begin{array}{c}{H}_{x}=d{x}_{i}\,\cos (\alpha )\pm 2{r}_{x}\\ {H}_{y}=d{x}_{i}\,\sin (\alpha )\pm 2{r}_{y}\end{array}\,{\rm{and}}\,\{\begin{array}{c}{V}_{x}=d{y}_{i}\,\sin (\alpha )\pm 2{r}_{x}\\ {V}_{y}=d{y}_{i}\,\cos (\alpha )\pm 2{r}_{y}\end{array}$$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width=".25em"/><mml:mi>cos</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>±</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width=".25em"/><mml:mi>sin</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>±</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mspace width=".25em"/><mml:mi mathvariant="normal">and</mml:mi><mml:mspace width=".25em"/><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width=".25em"/><mml:mi>sin</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>±</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width=".25em"/><mml:mi>cos</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>±</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math><graphic xlink:href="41598_2017_4567_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p id="Par38">MIST estimates the following four quantities from the translation matrices <italic>H</italic> and <italic>V</italic>: (1) overlap amount, (2) the camera angle, (3) the microscope stage repeatability, and (4) the microscope backlash. Supplementary Document section 5 describes the details of this estimation.</p>
    </sec>
    <sec id="Sec12">
      <title>Translation optimization constrained by stage repeatability</title>
      <p id="Par39">Figure <xref rid="Fig6" ref-type="fig">6.b</xref> shows each column in <italic>H</italic> as having the same <italic>dx</italic>
<sub><italic>i</italic></sub> and the same <italic>dy</italic>
<sub><italic>i</italic></sub> for each row in <italic>V</italic> within a ±2<italic>r</italic> limit. <italic>dx</italic>
<sub><italic>i</italic></sub> values differ between the columns of <italic>H</italic> while <italic>dy</italic>
<sub><italic>i</italic></sub> values are different between the rows of <italic>V</italic> due to backlash and mechanical imperfections. As such, we filter <italic>H</italic> column wise and <italic>V</italic> row wise where we replace all computed translations, whose <italic>dx</italic>
<sub><italic>i</italic></sub> or <italic>dy</italic>
<sub><italic>i</italic></sub> values deviate from the median value by more than 4 × <italic>r</italic> (the stage repeatability), by the median value in that direction. We then apply Constrained Hill Climbing<sup><xref ref-type="bibr" rid="CR19">19</xref></sup> to the <italic>ncc</italic> values centered at the median translation and constrained within 4 × <italic>r</italic> region. Hill climbing will find the translation with the maximum <italic>ncc</italic> value by following the steepest gradient. The 4 × <italic>r</italic> constrain comes from the model and bounds the algorithm to a small search space while converging to an optimal value.</p>
    </sec>
    <sec id="Sec13">
      <title>Mosaic assembly</title>
      <p id="Par40">The assembly problem can be represented as an undirected graph where vertices are tiles and ncc values are edges. Each tile is connected to its surrounding four neighbors, three neighbors for tiles on edges and two neighbors for tiles on corners. This over-constraint problem needs to be resolved to construct a well-formed image. We use the weighted maximum spanning tree algorithm<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> to find the optimal subset of edges that connects all tiles together, without any circular subsets of edges per tile (each tile is connected only once to the reconstructed image) while maximizing the sum of all weights along that path. The weight of all computed translations that satisfy the physically plausible offset stage model criteria (offsets &lt;4<italic>r</italic>) are increased to ensure preferential selection of these translations during assembly. When creating the final stitched image, a linear or non-linear blending is applied to each individual tile<sup><xref ref-type="bibr" rid="CR12">12</xref></sup> to compensate for shading differences in overlapping areas between adjacent tiles. Supplementary Document section 6 gives more detail about the mosaic assembly process.</p>
    </sec>
    <sec id="Sec14">
      <title>Accuracy measurement</title>
      <p id="Par41">The mathematical formulas of the two performance metrics are:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${({D}_{err})}_{i}=\sqrt{{({x}_{{m}_{i}}-{x}_{{c}_{i}})}^{2}+{({y}_{{m}_{i}}-{y}_{{c}_{i}})}^{2}}$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:math><graphic xlink:href="41598_2017_4567_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${({S}_{err})}_{i}=\frac{{A}_{{c}_{i}}-{A}_{{m}_{i}}}{{A}_{{m}_{i}}}\times 100$$\end{document}</tex-math><mml:math id="M8" display="block"><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:mn>100</mml:mn></mml:math><graphic xlink:href="41598_2017_4567_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where <italic>D</italic>
<sub><italic>err</italic></sub> is the centroid distance error metric, <inline-formula id="IEq1"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({x}_{{m}_{i}},{y}_{{m}_{i}})$$\end{document}</tex-math><mml:math id="M10"><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math><inline-graphic xlink:href="41598_2017_4567_Article_IEq1.gif"/></alternatives></inline-formula> is the measured centroid location of reference colony <italic>i</italic> and <inline-formula id="IEq2"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({x}_{{c}_{i}},{y}_{{c}_{i}})$$\end{document}</tex-math><mml:math id="M12"><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math><inline-graphic xlink:href="41598_2017_4567_Article_IEq2.gif"/></alternatives></inline-formula> is its computed centroid location from the stitched image. <italic>S</italic>
<sub><italic>err</italic></sub> is the size error metric in percent, <inline-formula id="IEq3"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${A}_{{m}_{i}}$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2017_4567_Article_IEq3.gif"/></alternatives></inline-formula> is the measured area in pixels of reference colony <italic>i</italic> and <inline-formula id="IEq4"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${A}_{{c}_{i}}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2017_4567_Article_IEq4.gif"/></alternatives></inline-formula> is the computed area from the stitched image and <italic>i</italic> = 1,…,<italic>N</italic> is the number of reference colonies.</p>
      <p id="Par42">The reference measurements are single colony images where the colony is automatically centered in the middle of the FOV and the corresponding stage coordinate locations (<italic>x</italic>
<sub><italic>r</italic></sub>,<italic>y</italic>
<sub><italic>r</italic></sub>) are saved in a CSV file. The output of a stitching method is a mosaic image from which colonies are segmented, cropped, and their locations computed. This will generate one image per centered colony. We then use the Hungarian algorithm<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> to find the optimal matching pairs between the two datasets. We apply the Hungarian algorithm to the similarity matrix <italic>T</italic> based on the <italic>ncc</italic> value between all reference colonies and the stitched ones. The output of a stitching method may result in adding some colonies by duplication or deleting some colonies by misaligning tiles. This results in a difference between the reference and stitched colony counts. This difference is characterized by the <italic>FP</italic> + <italic>FN</italic> metric. Furthermore, FN and FP metrics increase in value when the centroid distance of two matching colonies is larger than half a field of view (e.g., 340 μm). The corresponding match between such colonies is deleted; the reference colony will be considered as missed and the corresponding stitched colony as added.</p>
      <p id="Par43">We adjust the computed locations from the stitched image for rotation and translation due to the camera angle between absolute position read on the microscope controller and the relative positions computed from the stitched image. We use Kabsch’s algorithm<sup><xref ref-type="bibr" rid="CR22">22</xref></sup> to compute the optimal rotation matrix that minimizes the root mean squared deviation between the two sets. Supplementary Document section 1 gives more detail about this methodology.</p>
    </sec>
    <sec id="Sec15">
      <title>Data acquisition protocols</title>
      <p id="Par44">The H9 human embryonic stem cell line (WiCell, Madison, WI)<sup><xref ref-type="bibr" rid="CR23">23</xref></sup> was prepared to express GFP under the influence of the native Oct4 promoter and images were collected as previously described<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>. This study was approved by NIST and carried out in accordance with the approved guidelines of the NIST Human Subjects Protection Office. The final dataset consists of three data collections, each collection with around 161 time-lapse images at roughly 20 000 × 20 000 pixels per stitched image frame.</p>
    </sec>
    <sec id="Sec16">
      <title>Implementation</title>
      <p id="Par45">The MIST ImageJ plugin is a parallel application that uses coarse-grained parallelism to take advantage of computing resources available in a high-end workstation, namely multi-core CPUs and zero or more GPUs<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>. The salient features of MIST’s implementation are: (1) its pipelined workflow architecture, (2) its use of GPUs, and (3) its memory management. The pipelined workflow architecture organizes the image stitching algorithm as a series of connected stages that operate concurrently on multi-core CPUs. Data flows from one stage to the next using shared thread-safe first in, first out queues. The processing stages within image stitching operate on either computational, input/output (I/O), or state update tasks. For example, one computational stage might perform Fourier transforms, while an I/O stage reads images, and a bookkeeper determines when to issue more work. This creates a separation of concerns, disconnecting algorithm state management from the individual computational elements the algorithm is composed of. This allows computational stages to begin processing without considering the overall state of the computation, which improves CPU utilization. A computational stage is configured to operate using multiple workers (threads); this design improves the stage’s data production and consumption rates. In addition, I/O stages and computational stages operate concurrently, which allows for data motion to overlap with computation (such as overlapping reading images from disk with computing the FFTs of other images).</p>
      <p id="Par46">This workflow system is also used to take advantage of GPUs by altering the computational stages to issue work for GPU accelerators, preceded by a copy between the address space of the CPUs and GPUs. Furthermore, MIST instantiates one GPU-based pipeline workflow per GPU and distributes data across all pipelines, thereby allowing it to take advantage of multiple GPUs within a single machine.</p>
      <p id="Par47">MIST diligently manages memory and reclaims buffers so it only needs to keep one row (or column) of image tiles in memory. It does so by allocating all required memory buffers at startup and then recycling buffers as it completes the processing of individual image tiles. This management is important to enable the CPU-oriented implementation to process large datasets: the Fourier transform that corresponds to a tile or an adjacent tile pair is 8 or 16 times the size of the tile itself; keeping all the tiles and transforms in memory quickly uses up all the available physical memory in a machine and results in very poor performance. This management of memory is even more critical when using GPUs because memory is a much scarcer resource on GPUs; even high-end GPUs have far less memory than comparable CPUs. See Supplementary Document section 2 for more details.</p>
    </sec>
    <sec id="Sec17">
      <title>Hardware</title>
      <p id="Par48">All runtimes discussed were generated using Ubuntu 14.04.4 LTS (Linux kernel 3.19.0–68, OpenJDK IcedTea 2.6.7, and FFTW 3.3<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>) with 2× Intel® Xeon® E5–2650 v3 CPUs @2.30 GHz, 128GB DDR4 memory, 2× NVIDIA Tesla K40 GPUs (CUDA 7.5<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>).</p>
    </sec>
    <sec id="Sec18">
      <title>Disclaimer</title>
      <p id="Par49">The identification of any commercial product or trade name does not imply endorsement or recommendation by the National Institute of Standards and Technology, nor is it intended to imply that the materials or equipment identified are necessarily the best available for the purpose.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Electronic supplementary material</title>
    <sec id="Sec19">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41598_2017_4567_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Document</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Electronic supplementary material</bold>
      </p>
      <p><bold>Supplementary information</bold> accompanies this paper at doi:10.1038/s41598-017-04567-y
</p>
    </fn>
    <fn>
      <p><bold>Publisher's note:</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>This work is supported by NIST. We want to acknowledge the following NIST colleagues for their support and input: Michael Halter, Greg Cooksey, John Elliott and Anne Plant (NIST’s Material Measurement Laboratory), and Adele Peskin and Steve Lund (NIST’s Information Technology Laboratory). We want to acknowledge David Nimorwicz for creating the layout of MIST’s GUI, Shannon Hanna and Keana Scott (NIST’s MML) for sharing the worms datasets, paper sample and carbon nanotube images, and Daniel Hoeppner (Lieber Institute) for sharing the brain images.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author Contributions</title>
    <p>J.C. created and modeled the MIST theoretical framework with input from M.M., T.B. and K.B. J.C. wrote the paper with contributions and input from all co-authors. M.M. wrote the supplementary document with input from J.C., T.B. and W.K. M.M. and J.C. implemented and validated the algorithm in MATLAB. T.B. and M.M. developed the ImageJ plugin with input from W.K. J.C. and M.M. acquired the reference dataset for stitching evaluation and created the performance evaluation framework with input from P.B. M.B. provided overall strategic direction for the Information System Group.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="FPar1">
      <title>Competing Interests</title>
      <p id="Par50">The authors declare that they have no competing interests.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bhadriraju</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Large-scale time-lapse microscopy of Oct4 expression in human embryonic stem cell colonies</article-title>
        <source>Stem Cell Res.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>122</fpage>
        <lpage>129</lpage>
        <pub-id pub-id-type="doi">10.1016/j.scr.2016.05.012</pub-id>
        <?supplied-pmid 27286574?>
        <pub-id pub-id-type="pmid">27286574</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Emmenlauer</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>XuvTools: Free, fast and reliable stitching of large 3D datasets</article-title>
        <source>J. Microsc.</source>
        <year>2009</year>
        <volume>233</volume>
        <fpage>42</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1365-2818.2008.03094.x</pub-id>
        <?supplied-pmid 19196411?>
        <pub-id pub-id-type="pmid">19196411</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brown</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lowe</surname>
            <given-names>DG</given-names>
          </name>
        </person-group>
        <article-title>Automatic Panoramic Image Stitching using Invariant Features</article-title>
        <source>Int. J. Comput. Vis.</source>
        <year>2006</year>
        <volume>74</volume>
        <fpage>59</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="doi">10.1007/s11263-006-0002-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Can</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stewart</surname>
            <given-names>CV</given-names>
          </name>
          <name>
            <surname>Roysam</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Tanenbaum</surname>
            <given-names>HL</given-names>
          </name>
        </person-group>
        <article-title>A feature-based technique for joint, linear estimation of high-order image-to-Mosaic transformations: Mosaicing the curved human retina</article-title>
        <source>IEEE Trans. Pattern Anal. Mach. Intell.</source>
        <year>2002</year>
        <volume>24</volume>
        <fpage>412</fpage>
        <lpage>419</lpage>
        <pub-id pub-id-type="doi">10.1109/34.990145</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chow</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automated microscopy system for mosaic acquisition and processing</article-title>
        <source>J. Microsc.</source>
        <year>2006</year>
        <volume>222</volume>
        <fpage>76</fpage>
        <lpage>84</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1365-2818.2006.01577.x</pub-id>
        <?supplied-pmid 16774516?>
        <pub-id pub-id-type="pmid">16774516</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bajcsy</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>S-C</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>a</given-names>
          </name>
          <name>
            <surname>Folberg</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Three-dimensional volume reconstruction of extracellular matrix proteins in uveal melanoma from fluorescent confocal laser scanning microscope images</article-title>
        <source>J. Microsc.</source>
        <year>2006</year>
        <volume>221</volume>
        <fpage>30</fpage>
        <lpage>45</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1365-2818.2006.01539.x</pub-id>
        <?supplied-pmid 16438687?>
        <pub-id pub-id-type="pmid">16438687</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saalfeld</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cardona</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hartenstein</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Tomancák</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>As-rigid-as-possible mosaicking and serial section registration of large ssTEM datasets</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>57</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq219</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tsai</surname>
            <given-names>C-L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Robust, globally consistent and fully automatic multi-image registration and montage synthesis for 3-D multi-channel images</article-title>
        <source>J. Microsc.</source>
        <year>2011</year>
        <volume>243</volume>
        <fpage>154</fpage>
        <lpage>71</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1365-2818.2011.03489.x</pub-id>
        <?supplied-pmid 21361958?>
        <pub-id pub-id-type="pmid">21361958</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Preibisch</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Saalfeld</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tomancak</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Globally optimal stitching of tiled 3D microscopic image acquisitions</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1463</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp184</pub-id>
        <?supplied-pmid 19346324?>
        <pub-id pub-id-type="pmid">19346324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Argyriou, V. A study of sub-pixel motion estimation using phase correlation. <italic>Br. Mach. Vis. Assoc. 17th BMVC</italic>, 1–10, at http://citeseerx.ist.psu.edu/viewdoc/download?doi:10.1.1.96.4780&amp;;rep=rep1&amp;;type=pdf (2006).</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Bican, J. &amp; Flusser, J. 3D Rigid registration by cylindrical phase correlation method. <italic>Pattern Recognit. Lett</italic>. 30, 914–921 (2009).</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Davis, J. Mosaics of scenes with moving objects. in <italic>Proceedings</italic>. <italic>1998 IEEE Computer Society Conference on Computer Vision and Pattern Recognition</italic> 354–360, doi:10.1109/CVPR.1998.698630 (IEEE Comput. Soc, 1998).</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koshevoy</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automatic mosaicking and volume assembly for high-throughput serial-section transmission electron microscopy</article-title>
        <source>J. Neurosci. Methods</source>
        <year>2011</year>
        <volume>193</volume>
        <fpage>132</fpage>
        <lpage>144</lpage>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steckhan</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bergen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wittenberg</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Rupp</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Efficient large scale image stitching for virtual microscopy. <italic>Conf. Proc</italic></article-title>
        <source>IEEE Eng. Med. Biol. Soc.</source>
        <year>2008</year>
        <volume>2008</volume>
        <fpage>4019</fpage>
        <lpage>23</lpage>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bria</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Iannello</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>TeraStitcher - A tool for fast automatic 3D-stitching of teravoxel-sized microscopy images</article-title>
        <source>BMC Bioinformatics</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>316</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-13-316</pub-id>
        <?supplied-pmid 23181553?>
        <pub-id pub-id-type="pmid">23181553</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sun</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Beare</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hilsenstein</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Jackway</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Mosaicing of microscope images with global geometric and radiometric corrections</article-title>
        <source>J. Microsc.</source>
        <year>2006</year>
        <volume>224</volume>
        <fpage>158</fpage>
        <lpage>165</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1365-2818.2006.01687.x</pub-id>
        <?supplied-pmid 17204063?>
        <pub-id pub-id-type="pmid">17204063</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Yu, Y. &amp; Peng, H. Automated high speed stitching of large 3D microscopic images. <italic>2011 IEEE Int. Symp. Biomed. Imaging From Nano to Macro</italic> 238–241, doi:10.1109/ISBI.2011.5872396 (2011).</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Kuglin, C. &amp; Hines, D. The Phase Correlation Image Alignement Method. in <italic>Proceedings of the 1975 IEEE International Conference on Cybernetics and Society</italic> 163–165 (1975).</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Russell, S. &amp; Norvig, P. Artificial Intelligence: A Modern Approach. Prentice hall <bold>2</bold> (2003).</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kruskall</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>On the Shortest Spanning Subtree of a Graph and the Traveling Salesman Problem</article-title>
        <source>Proc. Am. Math. Soc.</source>
        <year>1956</year>
        <volume>7</volume>
        <fpage>48</fpage>
        <lpage>50</lpage>
        <pub-id pub-id-type="doi">10.1090/S0002-9939-1956-0078686-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Munkres</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Algorithms for the Assignment and Transportation Problems</article-title>
        <source>J. Soc. Ind. Appl. Math.</source>
        <year>1957</year>
        <volume>5</volume>
        <fpage>32</fpage>
        <lpage>38</lpage>
        <pub-id pub-id-type="doi">10.1137/0105003</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kabsch</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>A discussion of the solution for the best rotation to relate two sets of vectors</article-title>
        <source>Acta Crystallogr. Sect. A</source>
        <year>1978</year>
        <volume>34</volume>
        <fpage>827</fpage>
        <lpage>828</lpage>
        <pub-id pub-id-type="doi">10.1107/S0567739478001680</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thomson</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A. Embryonic Stem Cell Lines Derived from Human Blastocysts</article-title>
        <source>Science (80-).</source>
        <year>1998</year>
        <volume>282</volume>
        <fpage>1145</fpage>
        <lpage>1147</lpage>
        <pub-id pub-id-type="doi">10.1126/science.282.5391.1145</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zwaka</surname>
            <given-names>TP</given-names>
          </name>
          <name>
            <surname>Thomson</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Homologous recombination in human embryonic stem cells</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2003</year>
        <volume>21</volume>
        <fpage>319</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt788</pub-id>
        <?supplied-pmid 12577066?>
        <pub-id pub-id-type="pmid">12577066</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">Blattner, T., Chalfoun, J., Stivalet, B. &amp; Brady, M. A Hybrid CPU-GPU System for Stitching of Large Scale Optical Microscopy Images. in <italic>International Conference on Parallel Processing</italic> (<italic>ICPP</italic>) doi:10.1109/ICPP.2014.9 (2014).</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frigo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>The Design and Implementation of FFTW3</article-title>
        <source>Proc. IEEE</source>
        <year>2005</year>
        <volume>93</volume>
        <fpage>216</fpage>
        <lpage>231</lpage>
        <pub-id pub-id-type="doi">10.1109/JPROC.2004.840301</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">NVIDIA. CUDA Toolkit. at https://developer.nvidia.com/cuda-toolkit (2014).</mixed-citation>
    </ref>
  </ref-list>
</back>
