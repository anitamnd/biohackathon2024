<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8734264</article-id>
    <article-id pub-id-type="publisher-id">4532</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-021-04532-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>LaRA 2: parallel and vectorized program for sequence–structure alignment of RNA sequences</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1979-8553</contrib-id>
        <name>
          <surname>Winkler</surname>
          <given-names>Jörg</given-names>
        </name>
        <address>
          <email>j.winkler@fu-berlin.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Urgese</surname>
          <given-names>Gianvito</given-names>
        </name>
        <address>
          <email>gianvito.urgese@polito.it</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ficarra</surname>
          <given-names>Elisa</given-names>
        </name>
        <address>
          <email>elisa.ficarra@polito.it</email>
        </address>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Reinert</surname>
          <given-names>Knut</given-names>
        </name>
        <address>
          <email>knut.reinert@fu-berlin.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.14095.39</institution-id><institution-id institution-id-type="ISNI">0000 0000 9116 4836</institution-id><institution>Department of Mathematics and Computer Science, </institution><institution>Free University Berlin, </institution></institution-wrap>Takustraße 9, 14195 Berlin, Germany </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.419538.2</institution-id><institution-id institution-id-type="ISNI">0000 0000 9071 0620</institution-id><institution>Max Planck Institute for Molecular Genetics, </institution></institution-wrap>Ihnestraße 63-73, 14195 Berlin, Germany </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.4800.c</institution-id><institution-id institution-id-type="ISNI">0000 0004 1937 0343</institution-id><institution>Interuniversity Department of Regional and Urban Studies and Planning, </institution><institution>Politecnico di Torino, </institution></institution-wrap>C.so Duca degli Abruzzi 24, 10129 Turin, Italy </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.4800.c</institution-id><institution-id institution-id-type="ISNI">0000 0004 1937 0343</institution-id><institution>Department of Control and Computer Science, </institution><institution>Politecnico di Torino, </institution></institution-wrap>C.so Duca degli Abruzzi 24, 10129 Turin, Italy </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>6</day>
      <month>1</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>6</day>
      <month>1</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>18</elocation-id>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>9</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>12</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">The function of non-coding RNA sequences is largely determined by their spatial conformation, namely the secondary structure of the molecule, formed by Watson–Crick interactions between nucleotides. Hence, modern RNA alignment algorithms routinely take structural information into account. In order to discover yet unknown RNA families and infer their possible functions, the structural alignment of RNAs is an essential task. This task demands a lot of computational resources, especially for aligning many long sequences, and it therefore requires efficient algorithms that utilize modern hardware when available. A subset of the secondary structures contains overlapping interactions (called pseudoknots), which add additional complexity to the problem and are often ignored in available software.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We present the SeqAn-based software LaRA 2 that is significantly faster than comparable software for accurate pairwise and multiple alignments of structured RNA sequences. In contrast to other programs our approach can handle arbitrary pseudoknots. As an improved re-implementation of the LaRA tool for structural alignments, LaRA 2 uses multi-threading and vectorization for parallel execution and a new heuristic for computing a lower boundary of the solution. Our algorithmic improvements yield a program that is up to 130 times faster than the previous version.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">With LaRA 2 we provide a tool to analyse large sets of RNA secondary structures in relatively short time, based on structural alignment. The produced alignments can be used to derive structural motifs for the search in genomic databases.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>RNA secondary structure</kwd>
      <kwd>Integer linear program</kwd>
      <kwd>Bioinformatics</kwd>
      <kwd>Structural alignment</kwd>
      <kwd>RNA</kwd>
      <kwd>Algorithms</kwd>
      <kwd>Parallel computing</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001659</institution-id>
            <institution>Deutsche Forschungsgemeinschaft</institution>
          </institution-wrap>
        </funding-source>
        <award-id>RE 1712/10-1</award-id>
        <principal-award-recipient>
          <name>
            <surname>Winkler</surname>
            <given-names>Jörg</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Freie Universität Berlin (1008)</institution>
        </funding-source>
      </award-group>
      <open-access>
        <p>Open Access funding enabled and organized by Projekt DEAL.</p>
      </open-access>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par17">Non-coding RNAs (ncRNAs) are RNA molecules that do not translate into proteins, but instead have various functions, e.g. they participate in splicing or gene regulation. Analysing ncRNA molecules by comparison to functionally related RNA molecules requires more than sequence information, because their function is primarily determined by their structure, which is often better conserved than the primary sequence. Hence, sequence–structure alignment rewards the conservation of structural interactions of the ncRNA molecules, which is a key property for many applications, e.g. finding homologous structures of known ncRNA families [<xref ref-type="bibr" rid="CR1">1</xref>], phylogenetic fingerprinting as conducted for example for the ITS2 database [<xref ref-type="bibr" rid="CR2">2</xref>], or the computation of a consensus structure of a set of related RNA molecules [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR11">11</xref>].</p>
    <p id="Par18">It is now well-established that ncRNA molecules introduce an additional layer in genetic information processing. They play a significant, active role in cell and developmental biology and carry out many tasks that were previously attributed exclusively to proteins. However, only a small fraction of ncRNA families have been identified so far and many more can still be discovered [<xref ref-type="bibr" rid="CR12">12</xref>]. Structural RNA elements are also involved in the control of virus replication [<xref ref-type="bibr" rid="CR13">13</xref>], transcription and translation, indicating that the usage of the RNA structure features will be exploited in the near future for designing novel antiviral strategies [<xref ref-type="bibr" rid="CR14">14</xref>].</p>
    <p id="Par19">Owing to the importance of ncRNA molecules, there has been a steady stream of developments for analysing the molecules computationally. Specific rules govern RNA structure formation, therefore structured RNAs provide clear patterns of selection with base pairing patterns directly reflecting structural conservation [<xref ref-type="bibr" rid="CR15">15</xref>]. In other words, two nucleotides that form a base pair may be changed by mutations but preserve the propensity to form a valid base pair (i.e. compensatory mutations). Having a good model of an RNA structure (or a secondary structure as proxy of the 3D structure) is therefore crucial to elucidate its function [<xref ref-type="bibr" rid="CR16">16</xref>].</p>
    <p id="Par20">Considering structural information unfortunately adds complexity to the problem of aligning two or several sequences. The original algorithm for simultaneous alignment and folding by Sankoff [<xref ref-type="bibr" rid="CR17">17</xref>] has the time complexity <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {O}}(n^6)$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>6</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq1.gif"/></alternatives></inline-formula> for the pairwise case with sequence length <italic>n</italic>. The tool LocARNA [<xref ref-type="bibr" rid="CR18">18</xref>] reduces the time complexity to <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {O}}(n^4)$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>4</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq2.gif"/></alternatives></inline-formula> by limiting the computations to the thermodynamically probable base pairs. Also other tools like FoldAlignM [<xref ref-type="bibr" rid="CR4">4</xref>] achieve this complexity for pairwise alignments. A quadratic complexity is reached by the programs SPARSE [<xref ref-type="bibr" rid="CR19">19</xref>] and LaRA [<xref ref-type="bibr" rid="CR5">5</xref>].<fig id="Fig1"><label>Fig. 1</label><caption><p>The secondary structure of the 0419 Odontoglossum ringspot virus with 11 predicted pseudoknots. In the central part the linear representation of the RNA structure with all the predicted interaction edges (blue lines) is shown. Evidently, pseudoknots are non-nesting interactions, i.e. the interaction edges of a pseudoknot cross each other. The circular view on the perimeter, shows the sample pseudoknots disposition on the RNA sequence by representing the interaction edges with pink lines</p></caption><graphic xlink:href="12859_2021_4532_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par21">It is estimated that about <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$12\%$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mn>12</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq3.gif"/></alternatives></inline-formula> of known RNA structures contain pseudoknots [<xref ref-type="bibr" rid="CR20">20</xref>], which are crossing interactions of loop regions. In Fig. <xref rid="Fig1" ref-type="fig">1</xref> we show an example of pseudoknotted secondary structure from Shabash and Wiese [<xref ref-type="bibr" rid="CR21">21</xref>] that has been predicted to have 11 pseudoknots and 13 hairpins [<xref ref-type="bibr" rid="CR22">22</xref>]. In pseudoknotted structures the base pairing is not well nested, i.e. base pairs overlap each other with respect to their sequence position. Thus, pseudoknots are difficult to predict with standard methods that use dynamic programming or stochastic context-free grammars that rely on the nestedness property [<xref ref-type="bibr" rid="CR23">23</xref>]. In fact the majority of today’s software for structure prediction and alignment does not recognize pseudoknots, and the programs that do support them are more complex and are therefore more limited regarding the input size [<xref ref-type="bibr" rid="CR24">24</xref>–<xref ref-type="bibr" rid="CR26">26</xref>].</p>
    <p id="Par22">A short run time in relation to the problem size is an important aspect. Given the current rapid increase of the size of data sets it is essential to have efficient implementations available that solve the structural alignment problem in reasonable time, while securing a sufficient quality of the results. Some programs already allow to distribute the work on several cores for parallel execution through multi-threading. We go a step further and combine multi-threading and vectorization with SIMD instructions: By storing the data of 4 or 8 alignments in vectors we compute a vector of alignments simultaneously on each core. For example, with 16 cores and vector length 8, we process 128 alignments simultaneously.</p>
    <p id="Par23">Previous work has been done on the vectorization of the pairwise alignment computation using the wavefront approach [<xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR28">28</xref>] and for the recognition of barcode and adapter sequences [<xref ref-type="bibr" rid="CR29">29</xref>]. Our implementation is written in C++ and extends the work by Rahn et al. [<xref ref-type="bibr" rid="CR28">28</xref>]. In order to use vectorization for our structural alignment approach, we implemented a version that can cope with position-specific scoring functions rather than a pure character comparison.</p>
    <p id="Par24">In 2007 and 2008 the tools LaRA and T-LaRA [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR30">30</xref>] introduced a very competitive method, based on an ILP formulation that was solved using Lagrangian relaxation. It is still very competitive, however the software is not maintained any more, depends on outdated libraries and lacks parallelization.</p>
    <p id="Par25">We present an improved and parallelized version of the LaRA program for RNA sequence–structure alignment, which is up to <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$130{\times}$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mn>130</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq4.gif"/></alternatives></inline-formula> faster than the previous version thanks to vectorized and multi-threaded C++ code, while maintaining the accuracy. In contrast to existing software it can handle arbitrary pseudoknots and shows better performance on both simulated and experimentally determined RNA structures.</p>
    <p id="Par26">For a complete overview of all tools related to sequence–structure alignment we refer to the review paper by Lalwani et al. [<xref ref-type="bibr" rid="CR31">31</xref>]. A recent paper in this field introduced a new tool RNAmountAlign [<xref ref-type="bibr" rid="CR32">32</xref>] which uses mountain distance for pairwise structural alignments and runs in <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {O}}(n^3)$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq5.gif"/></alternatives></inline-formula> time for sequences of length <italic>n</italic>. The paper demonstrates besides RNAmountAlign also good performance for LocARNA [<xref ref-type="bibr" rid="CR6">6</xref>] and LaRA [<xref ref-type="bibr" rid="CR5">5</xref>]. LocARNA implements a variant of Sankoff’s algorithm and is based on computing pairwise local alignments that consider the pairing probabilities, which have been obtained by the algorithm of McCaskill. LocARNA has complexity <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {O}}(n^4)$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>4</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq6.gif"/></alternatives></inline-formula> in the pairwise case, which makes it computationally expensive. The tool Pankov [<xref ref-type="bibr" rid="CR33">33</xref>], which has <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {O}}(n^2)$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq7.gif"/></alternatives></inline-formula> asymptotic time complexity, applies an energy model that derives its energies from conditional loop probabilities, such that the probability of a structure can be more accurately computed.</p>
    <p id="Par27">The general workflow for LaRA is as follows: For given <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s \ge 2$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi>s</mml:mi><mml:mo>≥</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq8.gif"/></alternatives></inline-formula> RNA sequences with secondary structure annotation, LaRA computes sequence–structure alignments of all <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{s(s-1)}{2}$$\end{document}</tex-math><mml:math id="M18"><mml:mfrac><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq9.gif"/></alternatives></inline-formula> pairwise combinations. This process is depicted in Fig. <xref rid="Fig2" ref-type="fig">2</xref>.2 for one structured sequence pair. All pairwise structural alignments are then progressively merged into a multiple alignment that conserves the structural information. In LaRA this is done with the T-Coffee algorithm (therefore it is also referenced as T-LaRA), which takes the information of the pairwise aligned sequences to compute the multiple alignment.</p>
    <p id="Par28">Katoh and Toh [<xref ref-type="bibr" rid="CR34">34</xref>] presented a MAFFT-based framework named X-INS-i that incorporates structural information in the progressive multiple alignment step. Based on the structural pairwise alignments, e.g. from LaRA, and the base pair probabilities from McCaskill’s algorithm, it adds a so-called four-way-consistency score contribution to the progressive alignment, which favours base pair interactions of high probability in combination with a high pairwise similarity of the involved nucleotides.</p>
    <p id="Par29">The following paragraphs introduce how LaRA solves pairwise sequence–structure alignments, however for the mathematical background we refer to the LaRA paper [<xref ref-type="bibr" rid="CR5">5</xref>].</p>
    <p id="Par30">As a first step, the LaRA algorithm computes the base pair probability matrix (BPPM) of the sequences to be aligned by using the RNAfold tool [<xref ref-type="bibr" rid="CR35">35</xref>], a widely known implementation of the McCaskill algorithm. Then, LaRA constructs from the given sequences an alignment graph, which is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>.3. Between the nodes, which correspond to the sequences’ characters, the graph contains two sets of edges: <list list-type="order"><list-item><p id="Par31"><italic>Vertical alignment edges</italic> exist between each combination of a node from the first sequence and a node from the second sequence. For distinction, we use the term <italic>line</italic> for this type of edge. If a line <italic>l</italic> is <italic>active</italic>, i.e. the connected nodes are aligned, the flag <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_l$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mi>x</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq10.gif"/></alternatives></inline-formula> is set to 1 and otherwise to 0. The weight of a line <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_l$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mi>w</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq11.gif"/></alternatives></inline-formula> is initialized with the sequence alignment score of aligning the two nodes according to a given scoring scheme.</p></list-item><list-item><p id="Par32"><italic>Horizontal interaction edges</italic> represent structural alignment. Let <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}_1$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq12.gif"/></alternatives></inline-formula> and <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}_2$$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq13.gif"/></alternatives></inline-formula> be the sets of structural interactions of the two sequences. For each combination of two interactions from <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}_1 \times {\mathcal {S}}_2$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq14.gif"/></alternatives></inline-formula> we determine line <italic>l</italic> which is incident to the left interaction partners and line <italic>m</italic> which is incident to the right interaction partners. We draw two directed edges (<italic>l</italic>, <italic>m</italic>) and (<italic>m</italic>, <italic>l</italic>) between those two lines and assign weights <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec {w}_{lm} = \vec {w}_{ml} = \frac{p_1 + p_2}{2}$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">lm</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">ml</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq15.gif"/></alternatives></inline-formula> to them, where <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_1$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq16.gif"/></alternatives></inline-formula> is the probability of the respective interaction of the first sequence, and <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_2$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq17.gif"/></alternatives></inline-formula> is the probability of the respective interaction of the second sequence. Like above, the flag <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec {y}_{(l,m)}$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq18.gif"/></alternatives></inline-formula> equals 1 if the edge (<italic>l</italic>, <italic>m</italic>) is active and 0 otherwise.</p></list-item></list>In order to represent a valid alignment, the graph needs to satisfy the following constraints:<list list-type="bullet"><list-item><p id="Par33">All active lines must be conflict-free, i.e. any two lines with <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x=1$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq19.gif"/></alternatives></inline-formula> cannot cross or be incident to the same node.</p></list-item><list-item><p id="Par34">Each line is incident to at most 1 interaction edge.</p></list-item><list-item><p id="Par35">An interaction edge can only be active if the line at its origin is active.</p></list-item><list-item><p id="Par36">For any active interaction edge (<italic>l</italic>, <italic>m</italic>) the reverse edge must also be active: <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec {y}_{(l,m)} = \vec {y}_{(m,l)}$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq20.gif"/></alternatives></inline-formula>.</p></list-item></list>As we want to find the best alignment with regard to both sequence and structure, the objective function is<disp-formula id="Equ2"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \max \sum _{l} w_l \cdot x_l + \sum _{(l,m)} \vec {w}_{lm} \cdot \vec {y}_{(l,m)} \end{aligned}$$\end{document}</tex-math><mml:math id="M42" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo movablelimits="true">max</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>l</mml:mi></mml:munder><mml:msub><mml:mi>w</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">lm</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4532_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>such that the constraints above are satisfied.</p>
    <p id="Par37">The problem can be solved by applying Lagrange relaxation on the last constraint: The maximum profit that a line can contribute is the weight of the maximum weighted outgoing edge plus the line weight itself, minus a penalty if the last constraint has been violated. The maximum score for each line is interpreted as a value in a position-specific score matrix, which is then used by a global alignment algorithm, e.g. Needleman and Wunsch [<xref ref-type="bibr" rid="CR36">36</xref>]. As a result of the alignment algorithm, we have got a set of active, non-crossing lines where each nucleotide is incident to at most one line. The nucleotides which are not incident to an active line are aligned with a gap symbol to represent an insertion or deletion. Each active line has zero or one outgoing active interaction edge, which (if present) is the edge of maximum weight among all possible outgoing edges. We denote this alignment the <italic>relaxed</italic> solution, because it may violate the last constraint. Its score <inline-formula id="IEq21"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_U$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mi>z</mml:mi><mml:mi>U</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq21.gif"/></alternatives></inline-formula> is an upper bound for the optimal <italic>valid</italic> solution, because the computed alignment is optimal with respect to fewer constraints.</p>
    <p id="Par38">If for all pairs of lines <italic>l</italic> and <italic>m</italic> the equation <inline-formula id="IEq22"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec {y}_{(l,m)} = \vec {y}_{(m,l)}$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq22.gif"/></alternatives></inline-formula> holds, then we have found the optimal valid solution to the original problem. Otherwise, some interaction edges contradict each other. Given the fixed set of active lines, we have to find a subset of interaction edges such that each nucleotide is paired with at most one other nucleotide and the interactions have the maximum weight. This is a maximum weighted matching problem that we solve with a greedy heuristic (see the following section). The result is a <italic>valid</italic> structural alignment and its score <inline-formula id="IEq23"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_L$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>z</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq23.gif"/></alternatives></inline-formula> is a lower bound for the solution of the original problem.</p>
    <p id="Par39">Overall, LaRA iteratively solves the relaxed problem, where the penalty for violating the constraint is incorporated in the scoring matrix. In each iteration after the alignment a new lower bound is computed by finding the best structural interactions of this alignment. The solutions get increasingly better through the iterations and the bounds <inline-formula id="IEq24"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_U$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mi>z</mml:mi><mml:mi>U</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq24.gif"/></alternatives></inline-formula> and <inline-formula id="IEq25"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_L$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mi>z</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq25.gif"/></alternatives></inline-formula> provide a quality guarantee after any number of iterations, as depicted in Fig. <xref rid="Fig2" ref-type="fig">2</xref>.4. When the bounds coincide, the optimal solution has been found.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par40">The following subsections describe algorithmic and implementation details of the LaRA 2 program and point out the differences from the old version.<fig id="Fig2"><label>Fig. 2</label><caption><p>The five steps of the LaRA 2 workflow. <bold>1.</bold> Compute individual structure annotation based on base pair probabilities and create all the combinations of pairs to be computed in parallel. <bold>2.</bold> Create an alignment graph that satisfies the problem constraints. <bold>3.</bold> Formalize constraints as an integer linear program (ILP). <bold>4.</bold> The upper boundary for the optimal solution is computed as an ILP that is solved with Lagrangian Relaxation. The lower boundary is obtained with Maximum Weighted Matching. <bold>5.</bold> The pairwise sequence–structure alignments are combined with a multiple sequence aligner tool like T-Coffee or MAFFT</p></caption><graphic xlink:href="12859_2021_4532_Fig2_HTML" id="MO3"/></fig></p>
    <p id="Par41">LaRA 2 consists of five main steps as can be seen in Fig. <xref rid="Fig2" ref-type="fig">2</xref>: In the first step (Fig. <xref rid="Fig2" ref-type="fig">2</xref>.1) we compute the structural interactions in the form of a base pair probability matrix (BPPM) for each individual sequence by using the RNAfold tool [<xref ref-type="bibr" rid="CR35">35</xref>]. If sequences with structure annotation are provided as input for LaRA 2, this step is omitted. Subsequently, we create all the pairwise combinations to be aligned in parallel.</p>
    <p id="Par42">The second step computes and validates the alignment graph, which we introduced in the previous section, ensuring that the constraints are satisfied. The application of a sequence alignment algorithm ensures that aligned base pairs are mutually conflict-free: in Fig. <xref rid="Fig2" ref-type="fig">2</xref>.3 the red lines must not cross each other. We implemented a procedure that validates the alignment structure ensuring that at most one pair of interaction edges (blue lines in Fig. <xref rid="Fig2" ref-type="fig">2</xref>.2) is incident to each red alignment line.</p>
    <p id="Par43">Step three formalizes the constraints as an integer linear program (ILP) with an objective function designed to maximize the weighted sum of sequence and structure scores, as introduced in the previous section.</p>
    <p id="Par44">In the fourth step we solve the ILP with Lagrangian Relaxation. The solution to the relaxed ILP can be computed via a sequence alignment with position-specific scores, and it serves as an upper boundary of the optimal solution. It is based on the Needleman-Wunsch algorithm in which we allow choosing among three different gap scoring models: Linear [<xref ref-type="bibr" rid="CR36">36</xref>], Dynamic [<xref ref-type="bibr" rid="CR37">37</xref>], and Affine [<xref ref-type="bibr" rid="CR38">38</xref>]. The lower boundary is the result of a maximum weighted matching routine, which we improved in LaRA 2 with a greedy approach, which is explained in a following subsection.</p>
    <p id="Par45">Step five combines the pairwise alignments progressively according to the pairwise similarity. We use the multiple sequence alignment program T-Coffee or the MAFFT X-INS-i framework to combine all pairwise alignments into one multiple alignment.</p>
    <p id="Par46">In the following subsections we describe deeply some of the most important optimizations implemented in LaRA 2 for improving both performances and quality of produced alignments.</p>
    <sec id="Sec3">
      <title>Generating the input</title>
      <p id="Par47">LaRA 2 works on a set of at least two RNA sequences with <italic>structure annotation</italic>. An RNA sequence is a string of <italic>n</italic> characters over the RNA alphabet <inline-formula id="IEq26"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = \{A,C,G,U,N\}$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq26.gif"/></alternatives></inline-formula> where the characters represent the four nucleotides Adenine, Cytosine, Guanine, Uracil and the wildcard for an unknown nucleotide, respectively. The structure annotation of a sequence of length <italic>n</italic> is given as an <inline-formula id="IEq27"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n \times n$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq27.gif"/></alternatives></inline-formula> matrix <inline-formula id="IEq28"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {A}}$$\end{document}</tex-math><mml:math id="M58"><mml:mi mathvariant="script">A</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq28.gif"/></alternatives></inline-formula>, where the entry <inline-formula id="IEq29"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {A}}(i,j)$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:mi mathvariant="script">A</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq29.gif"/></alternatives></inline-formula> denotes the probability <inline-formula id="IEq30"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p \in [0 \ldots 1]$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>…</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq30.gif"/></alternatives></inline-formula> of nucleotide <italic>i</italic> and nucleotide <italic>j</italic> forming a pair in the secondary structure of the RNA molecule.</p>
      <p id="Par48">If the structure information is not available, LaRA 2 can internally compute it with the <italic>RNAfold</italic> tool [<xref ref-type="bibr" rid="CR35">35</xref>], which calculates the partition function in order to obtain the individual interaction probabilities between base pairs. For the purpose of a fair comparison with other tools we always include the time for folding the sequences in our benchmarks. However, if the user has the structure annotation at hand the folding step can be omitted.</p>
    </sec>
    <sec id="Sec4">
      <title>Computing the alignments in parallel</title>
      <p id="Par49">The first implementation of the LaRA algorithm [<xref ref-type="bibr" rid="CR5">5</xref>] computes sequentially a sequence–structure alignment for all pairs of sequences and then combines the pairwise alignments using T-Coffee [<xref ref-type="bibr" rid="CR39">39</xref>]. The program is still competitive (see results section), however it is not well maintained in the sense that old libraries are used (e.g. LEDA [<xref ref-type="bibr" rid="CR40">40</xref>] for access to general matching algorithms) and the code is not parallelized. Hence, we present a re-implementation of the core algorithms in the C++ library SeqAn [<xref ref-type="bibr" rid="CR41">41</xref>], which offers not only fast implementations of vectorized and multi-threaded sequence alignment routines, we also added efficient methods for maximum weighted matching.</p>
      <p id="Par50">To make the LaRA algorithm amenable for acceleration via vectorization, we changed the internal logic. In the LaRA algorithm each individual, pairwise sequence–structure alignment is solved using a Lagrange relaxation approach which in essence computes a series of interleaved standard sequence alignments with position dependent scores and a matching routine to adapt the Lagrange multipliers. In Algorithm 1 the code in line 3 shows the inner loop which computes per iteration one alignment followed by a general matching to update weights for the alignment in the next iteration. <graphic position="anchor" xlink:href="12859_2021_4532_Figa_HTML" id="MO4"/></p>
      <p id="Par51">We have changed this execution flow in order to use our recently developed many-against-many alignment interface which allows us to compute many pairwise sequence alignments in parallel using multi-core and SIMD vectorization. Hence, we compute the first iteration of <italic>all</italic> pairwise sequence alignments followed by a parallelized version of the matchings. This can be seen in Algorithm 2. This parallelized computation of the first iteration step is then followed by the second iteration of sequence alignments and matchings. We measured that the sequence alignment step is about 200 times faster on a 16 core standard Xeon processor with 256 bit SIMD registers (see [<xref ref-type="bibr" rid="CR42">42</xref>] for a similar computation benchmark). <graphic position="anchor" xlink:href="12859_2021_4532_Figb_HTML" id="MO5"/></p>
      <p id="Par52">In our SIMD implementation the value types of the matrices and other data structures are SIMD vectors. A SIMD vector enables us to compute an operation on multiple data in a single step, and the amount of data—the vector length—is system-dependent. There exist different instruction sets, like SSE4, AVX2 and AVX512, which support 128, 256 and 512 bits per vector, respectively. For instance, given the AVX2 instruction set and an integer size of 32 bits, we can store and compute 8 integer values at once. We changed the data type of e.g. a score matrix cell from int to seqan::SimdVector&lt;int&gt;, which is a data structure in SeqAn for SIMD vectors. This data structure provides a system-independent interface for operations on SIMD vectors and uses internally the Intel compiler intrinsics [<xref ref-type="bibr" rid="CR43">43</xref>], applying the vector size that is determined through compilation with one of the instruction sets. Currently, the alignments and boundary computation are implemented with SIMD instructions, whereas the matching step uses multi-threading (and updates the values inside the SIMD vectors for the next iteration).</p>
      <p id="Par53">Users of LaRA 2 do not need to care about enabling the SIMD functionality during run time. Instead, this decision is made with the compilation of LaRA 2, where the -march flag should be used to tell the compiler about the minimal hardware the code should run on. Details on the compiler configuration for <italic>Clang</italic> and <italic>GCC</italic> can be found in the installation instructions on our project website.</p>
      <p id="Par54">For the structural alignment problem we use Lagrangian Relaxation and solve the relaxed problem by feeding the structural information into a (vectorized) position-specific score matrix <inline-formula id="IEq31"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}$$\end{document}</tex-math><mml:math id="M64"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq31.gif"/></alternatives></inline-formula>, which is then used as a parameter for the sequence alignment algorithm. This matrix is updated in each iteration and contains the scores for comparing the nucleotides as well as rewards or penalties for conserving or breaking structural interactions. The relaxed solution can still contain outgoing interactions that are not consistent with an incoming interaction and therefore the solution of the alignment is an upper boundary for the optimal score.</p>
    </sec>
    <sec id="Sec5">
      <title>Maximum weighted matching for the lower bound</title>
      <p id="Par55">A valid solution (the Lagrangian primal) of the original alignment problem is computed by applying a maximum weighted matching (MWM) algorithm on the interaction graph that is depicted in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. The algorithm ensures that no nucleotide is used twice for structural interactions and that they are consistent. The goal is to find the interactions of maximal weight that satisfy the conditions.<fig id="Fig3"><label>Fig. 3</label><caption><p>Maximum weighted matching. The algorithm selects the best valid interactions in order to compute a lower boundary for the optimal score. The matching property in the displayed interaction graph is not yet satisfied, because the leftmost node is incident to two interactions</p></caption><graphic xlink:href="12859_2021_4532_Fig3_HTML" id="MO6"/></fig></p>
      <p id="Par56">We have tested two different heuristics for MWM: The Blossom algorithm by Edmonds [<xref ref-type="bibr" rid="CR44">44</xref>], which is implemented in the Lemon Graph Library [<xref ref-type="bibr" rid="CR45">45</xref>], and a greedy approach with look-ahead strategy, which we implemented in the SeqAn library [<xref ref-type="bibr" rid="CR41">41</xref>].</p>
      <p id="Par57">The main idea of the Blossom algorithm is to search for cycles consisting of an odd number of edges and contract each such cycle into a single node, which is called a blossom. The search is then continued in the reduced graph.</p>
      <p id="Par58">In our greedy approach we generate a list of all edges sorted by their weight. Then we consider the heaviest <italic>k</italic> edges from the beginning of this list and perform an exhaustive search on the maximum weighting combination. The selected edges become part of the resulting matching and all incident edges are excluded from the list. We repeat this process with the next <italic>k</italic> heaviest edges from the list until the list is empty.</p>
      <p id="Par59">We find that using the greedy approach with <inline-formula id="IEq32"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=5$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq32.gif"/></alternatives></inline-formula> in our application results in a lower total run time compared to the Blossom algorithm. Although the greedy heuristic produces fewer optimal matchings, LaRA 2 compensates the outcome with a few more alignment and matching iterations.</p>
      <p id="Par60">The score for the lower bound of the current LaRA 2 iteration is the sum of the weights of the edges that are part of the computed matching, plus the sequence alignment score. The highest score over all iterations together with the corresponding alignment is reported as the valid solution of the pairwise sequence–structure alignment problem.</p>
    </sec>
    <sec id="Sec6">
      <title>Combining the pairwise alignments into a multiple one</title>
      <p id="Par61">LaRA 2 can produce two different output formats, which can be selected with a parameter: MSA library for T-Coffee [<xref ref-type="bibr" rid="CR39">39</xref>] and pairwise alignments for MAFFT [<xref ref-type="bibr" rid="CR34">34</xref>].</p>
      <p id="Par62">The MSA library is a data structure that stores the base pairings with their individual scores for each of the <inline-formula id="IEq33"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{s(s-1)}{2}$$\end{document}</tex-math><mml:math id="M68"><mml:mfrac><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq33.gif"/></alternatives></inline-formula> pairwise alignments. Its scores correspond to the sequence and structure conservation in the associated nucleotide pair. The MSA Library can be directly used by the T-Coffee [<xref ref-type="bibr" rid="CR39">39</xref>] algorithm for progressive multiple sequence alignment (MSA). T-Coffee incorporates structural information by constructing an alignment graph that contains the structural weights of the pairwise alignments. As the library data structure consists of a weighted set of sequences with weighted character pairings, it is flexible enough to support also the incorporation of other constraints (from e.g. already computed alignments) or additional, experimentally gained structures (e.g. obtained by SHAPE experiments) by adjusting the library weights accordingly in the file or by using T-Coffee’s input flags.</p>
      <p id="Par63">The pairwise alignment output is designed to be parsed by the MAFFT framework and contains three lines per pairwise alignment: The first line is a header line similar to the FastA format containing both sequence identifiers, and the other two lines consist of the first and the second aligned sequence. The aligned sequences possibly contain gap symbols and have equal length. Through the four-way-consistency score in MAFFT it incorporates the structural information not only through the (here unweighted) base pairs in the pairwise alignments but additionally from the initial base pair probabilities resulting from the McCaskill algorithm.</p>
      <p id="Par64">In case <inline-formula id="IEq34"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s = 2$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq34.gif"/></alternatives></inline-formula> there is no need for generating a multiple alignment, because there is only one pairwise alignment. In addition to the output formats described above, we support aligned FastA output for two sequences. Then there are four lines recorded: the first identifier, the first sequence (with gap symbols), the second identifier and the second sequence (with gap symbols). This format is accepted by most existing tools that take an alignment as input, and also T-Coffee and MAFFT can produce this format for the multiple alignment.</p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Results and discussion</title>
    <p id="Par65">We implemented the algorithm for pairwise structural alignments in a new C++ program with the name LaRA 2, which computes structural alignments with pseudoknots in high quality. It is capable of processing large data sets because of its enormous speed-up thanks to its implementation optimized for multi-threading and vectorization. The name reflects that the underlying model is the one of LaRA [<xref ref-type="bibr" rid="CR5">5</xref>] that has been improved with the techniques described in this paper.</p>
    <p id="Par66">Alongside the program we develop an interactive iPython manual that serves as a template for getting started and provides practical use cases. Furthermore, the manual on <ext-link ext-link-type="uri" xlink:href="https://seqan.github.io/lara/">https://seqan.github.io/lara/</ext-link> provides assistance for using LaRA 2 with T-Coffee or MAFFT for multiple structural alignments and demonstrates the supported input and output formats.<table-wrap id="Tab1"><label>Table 1</label><caption><p>The program versions and parameters for the benchmark</p></caption><table frame="hsides" rules="groups"><tbody><tr><td align="left">LaRA 2</td><td align="left">2.0.1</td><td align="left">lara --threads 16</td></tr><tr><td align="left"> + MAFFT</td><td align="left">7.453</td><td align="left">mafft-xinsi --larapair</td></tr><tr><td align="left"> + T-Coffee</td><td align="left">13.41.0</td><td align="left">t_coffee</td></tr><tr><td align="left">LaRA</td><td align="left">1.4.3</td><td align="left">lara</td></tr><tr><td align="left">LocARNA</td><td align="left">1.9.0</td><td align="left">mlocarna --threads=16</td></tr><tr><td align="left">RNAmountAlign</td><td align="left">1.0</td><td align="left">RNAmountAlign</td></tr><tr><td align="left">MAFFT</td><td align="left">7.453</td><td align="left">mafft --thread 16</td></tr></tbody></table></table-wrap></p>
    <p id="Par67">In order to demonstrate the performance of LaRA 2 compared to relevant existing software, we evaluate three different benchmarks with focus on multiple alignment with conserved structure, run time on a large data set, and the detection of pseudoknots. All benchmarks have been performed on a Linux server using an x86_64 architecture with Intel<sup>®</sup> Xeon<sup>®</sup> CPU E5-2650 v3 with 2.30 GHz and 126 GB RAM. We compiled with GCC version 9 and where applicable, we used up to 16 threads and AVX2 instructions. For the benchmarks we have used the program versions and parameters displayed in Table <xref rid="Tab1" ref-type="table">1</xref>. The standalone MAFFT [<xref ref-type="bibr" rid="CR46">46</xref>] tool was included as a sequence aligner in order to demonstrate the need of structural alignment.</p>
    <sec id="Sec8">
      <title>Benchmark on general RNA families</title>
      <p id="Par68">In this benchmark we show the performance across several RNA families dependent on the sequence similarity. We took the BRAliBase 2.1 data set, which consists of 388 reference alignments of 5 sequences each. For RNAmountAlign we excluded 46 sequences that contain the character ‘N’, because the program does not accept wildcard symbols.</p>
      <p id="Par69">In order to evaluate the resulting multiple structural alignments we use two metrics: SPS and MCC. The sum-of-pairs (SPS) score is a measure of similarity between the test alignment and the curated reference alignment that is available in the Rfam database [<xref ref-type="bibr" rid="CR1">1</xref>]. Values are in [0..1] where 1 means identity and value 0 represents maximal distance. While SPS considers solely the character matchings, the Matthews correlation coefficient (MCC) [<xref ref-type="bibr" rid="CR47">47</xref>] evaluates the predicted secondary structure. It is a value in <inline-formula id="IEq39"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[-1..1]$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq39.gif"/></alternatives></inline-formula> where 1 denotes a perfect prediction, 0 is a random prediction according to the background distribution and <inline-formula id="IEq40"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-1$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq40.gif"/></alternatives></inline-formula> denotes a total disagreement.</p>
      <p id="Par70">In order to compute the MCC (Eq. <xref rid="Equ1" ref-type="">1</xref>), we follow the publications of Murlet [<xref ref-type="bibr" rid="CR48">48</xref>] and RNAmountAlign [<xref ref-type="bibr" rid="CR32">32</xref>]. For future reference and reproducibility we provide the script in our LaRA 2 repository. In a first step we fold the test alignments with <italic>RNAalifold</italic> from the ViennaRNA package [<xref ref-type="bibr" rid="CR35">35</xref>]. We have computed the consensus structures with <italic>PETfold</italic> [<xref ref-type="bibr" rid="CR49">49</xref>] as well, which led to the same results. The reference alignments from BRAliBase do not contain the structure annotations, and therefore we assigned the respective structures from the Rfam 5.0 database, where the content of BRAliBase originates [<xref ref-type="bibr" rid="CR50">50</xref>]. In the next step we assign the consensus structure to each sequence of the respective alignment. For all matching base pairs the sequence positions are extracted per sequence and stored in two sets: <inline-formula id="IEq41"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_i$$\end{document}</tex-math><mml:math id="M76"><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq41.gif"/></alternatives></inline-formula> contains the base pairs of sequence <italic>i</italic> in the test alignment and <inline-formula id="IEq42"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_i$$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq42.gif"/></alternatives></inline-formula> contains the base pairs of sequence <italic>i</italic> in the reference. Based on these sets we define the confusion matrix and calculate the MCC. Note that the true negative (<italic>tn</italic>) value contains the number of all possible base pairs that are contained in neither the test nor the reference set.<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} tp&amp;:= \sum _i \left| T_i \cap R_i \right| \\ fp&amp;:= \sum _i \left| T_i \setminus R_i \right| \\ fn&amp;:= \sum _i \left| R_i \setminus T_i \right| \\ tn&amp;:= \sum _i \left| \left( T_i \cup R_i \right) ^c \right| \\ {\text {MCC}}&amp;:= \frac{tp \cdot tn - fp \cdot fn}{\sqrt{(tp+fp)(tp+fn)(tn+fp)(tn+fn)}} \end{aligned} \end{aligned}$$\end{document}</tex-math><mml:math id="M80" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="italic">tp</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mfenced close="|" open="|"><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mi>f</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mfenced close="|" open="|"><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mi>f</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mfenced close="|" open="|"><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mfenced close="|" open="|"><mml:msup><mml:mfenced close=")" open="("><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∪</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mi>c</mml:mi></mml:msup></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mtext>MCC</mml:mtext></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi><mml:mo>·</mml:mo><mml:mi>t</mml:mi><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mi>f</mml:mi><mml:mi>p</mml:mi><mml:mo>·</mml:mo><mml:mi>f</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:msqrt><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4532_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>In Fig. <xref rid="Fig4" ref-type="fig">4</xref> we show the performance of the tested tools according to the SPS and MCC benchmarks. The curves in (a) and (b) are fitted through the data points with a lowess smoother (<inline-formula id="IEq43"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f=0.5$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq43.gif"/></alternatives></inline-formula>). The statistical significance of the MCC benchmark is displayed in (c). As annotated in BRAliBase [<xref ref-type="bibr" rid="CR50">50</xref>], we divided the alignments in three groups of low, medium and high sequence similarity. For each group and each tool we calculated the median and <inline-formula id="IEq44"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$95\%$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mn>95</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq44.gif"/></alternatives></inline-formula> confidence intervals after bootstrapping 1000 samples.<fig id="Fig4"><label>Fig. 4</label><caption><p><bold>a</bold> Sum-of-pairs score and <bold>b</bold> Matthews correlation coefficient are shown for different tools dependent on the sequence similarity. The tools were run on 388 alignments of the BRAliBase 2.1 data set (without SRP) and the curves were generated with a lowess function on the results. In order to show the MCC performance of MAFFT as a sequence alignment tool, as well as of the reference alignment from BRAliBase, we calculated the best secondary structure of the alignments with <italic>RNAalifold</italic> [<xref ref-type="bibr" rid="CR35">35</xref>]. <bold>c</bold>
<inline-formula id="IEq45"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$95\%$$\end{document}</tex-math><mml:math id="M86"><mml:mrow><mml:mn>95</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq45.gif"/></alternatives></inline-formula> bootstrap percentile confidence intervals and medians for the MCC values. The first axis represents the sequence similarity in three groups: low (<inline-formula id="IEq46"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;55\%$$\end{document}</tex-math><mml:math id="M88"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>55</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq46.gif"/></alternatives></inline-formula>), medium (<inline-formula id="IEq47"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge 55\%$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:mo>≥</mml:mo><mml:mn>55</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq47.gif"/></alternatives></inline-formula> and <inline-formula id="IEq48"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;75\%$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>75</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq48.gif"/></alternatives></inline-formula>) and high (<inline-formula id="IEq49"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge 75\%$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:mo>≥</mml:mo><mml:mn>75</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq49.gif"/></alternatives></inline-formula>), as annotated in BRAliBase [<xref ref-type="bibr" rid="CR50">50</xref>]. For each group we bootstrapped 1000 samples of the MCC experiment</p></caption><graphic xlink:href="12859_2021_4532_Fig4_HTML" id="MO8"/></fig></p>
      <p id="Par71">The results demonstrate that LaRA 2 performs as good as LocARNA and LaRA 1, and better than RNAmountAlign and MAFFT. In the alignments with more than <inline-formula id="IEq50"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$70\%$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:mn>70</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq50.gif"/></alternatives></inline-formula> sequence similarity we observe the same performance for all tools in the SPS benchmark. This is expected, as the importance of the structure is low and even a sequence aligner like MAFFT is able to compute alignments that are close to the reference alignment. For lower sequence similarities we observe an almost linear regression in the SPS score of MAFFT, because the structure becomes more crucial. Here we observe that LaRA and LocARNA clearly perform the best among the tested tools.</p>
      <p id="Par72">Another question that has concerned us is the performance drop of all programs around the <inline-formula id="IEq51"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$55\%$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:mn>55</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq51.gif"/></alternatives></inline-formula> sequence similarity region in the SPS benchmark. As Löwes et al. [<xref ref-type="bibr" rid="CR51">51</xref>] have pointed out, this is the effect of an unbalanced representation of RNA families in the BRAliBase benchmark set.</p>
      <p id="Par73">For the structure evaluation with Matthews correlation coefficient we find again that LaRA 2 has the same performance as LocARNA and LaRA 1, while outperforming RNAmountAlign and MAFFT. An interesting observation is the decline of the reference curve for high sequence similarity, which is mainly represented by alignments of the tRNA family. For the reference curve we computed the optimal structures of the BRAliBase reference alignments with RNAalifold [<xref ref-type="bibr" rid="CR35">35</xref>] (they do not provide reference structures), and compared them with the respective curated structures from Rfam with the MCC. We can see that the results of all the programs follow the same trend as the reference and for high sequence similarity the curves get closer to each other.</p>
      <p id="Par74">We were surprised to see that above <inline-formula id="IEq52"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$55\%$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:mn>55</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq52.gif"/></alternatives></inline-formula> sequence similarity MAFFT has a better performance than RNAmountAlign in the MCC benchmark (see Fig. <xref rid="Fig4" ref-type="fig">4</xref>b, c). The comparably poor performance of RNAmountAlign for low sequence similarities is compliant with the results that have already been published [<xref ref-type="bibr" rid="CR32">32</xref>]. Our assumption is that RNAmountAlign balances the weight too much on the sequence similarity.</p>
      <p id="Par75">The run time for the benchmark is displayed in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. We summed up the run time for 481 executions of each tool, except RNAmountAlign, which we ran on the limited set as described above and scaled the run time accordingly.</p>
      <p id="Par76">The fastest result of the sequence–structure aligners is delivered by LaRA 2 with T-Coffee in less than 5.5 min. This is closely followed by RNAmountAlign (below 7 min), which is impressive in the light of its non-parallel execution, but shadowed by its performance in the benchmark. LaRA 2 with MAFFT runs in less than 13 min, LocARNA takes almost 35 min and the single-threaded LaRA requires more than 1 h to compute the test alignments. MAFFT is the fastest among all tested tools, however this is expected because sequence alignment is a less complex problem. As there are only five sequences aligned at a time, parallel execution has just a minor effect compared to the benchmark in the following subsection.<fig id="Fig5"><label>Fig. 5</label><caption><p>Run time of the tested programs for 481 alignments of 5 sequences each from the BRAliBase 2.1 benchmark, including the SRP data. The calculation of the base pair probabilities is included in the run time. For RNAmountAlign we multiplied the time for computing 384 alignments that do not contain wildcards with factor <inline-formula id="IEq53"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{481}{384}$$\end{document}</tex-math><mml:math id="M102"><mml:mfrac><mml:mn>481</mml:mn><mml:mn>384</mml:mn></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq53.gif"/></alternatives></inline-formula> in order to compare it with the other tools</p></caption><graphic xlink:href="12859_2021_4532_Fig5_HTML" id="MO9"/></fig></p>
      <p id="Par77">In addition, we examined the time and memory consumption of LaRA 2 with respect to the average sequence length. As the BRAliBase data set contains rather short sequences (up to 300 bases) we extended the set with two additional RNA families from the RNAStrAlign database [<xref ref-type="bibr" rid="CR11">11</xref>]: Telomerase and 16S rRNA. Each alignment consists of five sequences, and we averaged the run time per alignment over 10 runs in order to gain more accurate results. Figure <xref rid="Fig6" ref-type="fig">6</xref> shows the results for the run time (left) and the maximum allocated memory (right). In both cases we observe a monotonic increase with sequence length, and an alignment of average sequence length 1500 takes about one minute and occupies at most 2.5 GB memory.<fig id="Fig6"><label>Fig. 6</label><caption><p>Run time and memory of LaRA 2 in relation to the sequence length. We used the sequences from BRAliBase 2.1 including SRP as well as Telomerase RNA and Mollicutes’ 16S rRNA from RNAStrAlign database [<xref ref-type="bibr" rid="CR11">11</xref>]. Each of the 560 alignments consists of 5 sequences, of which the average length is denoted on the x-axis. The y-axis shows the run time or peak memory consumption respectively for each alignment computation, including the calculation of the base pair probabilities. We averaged over 10 runs per alignment in order to obtain more accurate measurements</p></caption><graphic xlink:href="12859_2021_4532_Fig6_HTML" id="MO10"/></fig></p>
    </sec>
    <sec id="Sec9">
      <title>Benchmark of the run time for deep alignments</title>
      <p id="Par78">In order to demonstrate the ability of LaRA 2 to process large data sets in reasonable time, we use the plastids data set from the 5SrRNAdb [<xref ref-type="bibr" rid="CR52">52</xref>] database, which contains 838 sequences with average length 123. This results in 350703 pairwise structural alignments that are then combined to a single multiple alignment. As Table <xref rid="Tab2" ref-type="table">2</xref> demonstrates, LaRA 2 with MAFFT X-INS-i can compute this in 26.5 min due to its efficient and parallel implementation. The run time with T-Coffee is about 54 min, and we found that in both cases the common pairwise alignment part takes less than 7.5 min. MAFFT is significantly faster in this benchmark due to the fact that it is a pure sequence aligner, which is a less complex problem. Interestingly, the multi-threaded version is even disadvantageous for MAFFT, likely because of the larger memory allocation. As stated in the introduction, LocARNA has a worse run time complexity compared to LaRA 2, which leads to a significantly slower execution with this large alignment. Note that RNAmountAlign and LaRA support only single-threaded execution. We computed also the SPS scores for the results of this benchmark, which were high values between 0.95 and 0.98 for all programs.</p>
      <p id="Par79">The speed-up of LaRA 2 with MAFFT using 16 threads is about 9 which is much better than the other tools. With T-Coffee it reduces to a factor of 3 due to the non-parallel implementation of T-Coffee. Still this is the same speed-up as LocARNA. Taking a look at the peak memory allocation in Table <xref rid="Tab2" ref-type="table">2</xref> reveals that even with so many sequences the calculations do not require an extensive amount of memory. The maximum allocation of around 4 GB we find when running T-Coffee (with LaRA 2 and LaRA 1) or RNAmountAlign. When we run LaRA 2 with MAFFT X-INS-i the peak memory is determined by LaRA 2, which is around 2 GB for 16 threads and 1.3 GB for single threaded execution. As this is lower than any other program in multi-threaded mode, we recommend using LaRA 2 with MAFFT if the memory is limited.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Run time and memory consumption for the computation of a multiple alignment with 838 sequences of 5S rRNA Plastids, taken from the 5SrRNAdb database [<xref ref-type="bibr" rid="CR52">52</xref>]</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left"># threads</th><th align="left">LaRA 2 + MAFFT</th><th align="left">LaRA 2 + T-Coffee</th><th align="left">LaRA</th><th align="left">LocARNA</th><th align="left">RNAmount-Align</th><th align="left">MAFFT</th></tr></thead><tbody><tr><td align="left" rowspan="2">Time [min:sec]</td><td char="." align="char">16</td><td align="left">26:28</td><td align="left">54:14</td><td align="left">na</td><td align="left">419:59</td><td align="left">na</td><td align="left">00:04</td></tr><tr><td char="." align="char">1</td><td align="left">237:00</td><td align="left">151:17</td><td align="left">3424:57</td><td align="left">1260:50</td><td align="left">212:30</td><td align="left">00:02</td></tr></tbody></table><table frame="hsides" rules="groups"><tbody><tr><td align="left" rowspan="2">M﻿emory [MB]</td><td char="." align="char">16</td><td align="left">2059</td><td align="left">3917</td><td align="left">na</td><td align="left">3003</td><td align="left">na</td><td align="left">357</td></tr><tr><td char="." align="char">1</td><td align="left">1362</td><td align="left">3908</td><td align="left">4172</td><td align="left">453</td><td align="left">3923</td><td align="left">36</td></tr></tbody></table><table-wrap-foot><p>We compare different programs using 1 or 16 threads. The calculation of the base pair probabilities is included</p></table-wrap-foot></table-wrap></p>
      <p id="Par80">
        <fig id="Fig7">
          <label>Fig. 7</label>
          <caption>
            <p>Run time of LaRA 2 for computing the base pair probabilities of 838 sequences of the Plastids data set and pairwise alignment of the 350703 combinations. Multiple alignment is not considered here. The matrix shows the run time for 1, 4, 8 and 16 threads with different SIMD instruction sets, which compute 1, 4 or 8 alignments per thread. In the bar-graph, we reported the time with minute:second [m:s] notation</p>
          </caption>
          <graphic xlink:href="12859_2021_4532_Fig7_HTML" id="MO11"/>
        </fig>
      </p>
      <p id="Par81">In addition, we use the Plasmids data set to demonstrate the scaling of the run time of pairwise structural alignments with LaRA 2 in the light of SIMD instruction sets and multi-threading. Figure <xref rid="Fig7" ref-type="fig">7</xref> visualizes the results. Note that this benchmark includes calculating the base pair probabilities of the sequences, but not a multiple alignment, which is performed by the T-Coffee or MAFFT X-INS-i programs.</p>
      <p id="Par82">The effect of SIMD instructions is a speed-up of <inline-formula id="IEq55"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1.8{\times}$$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:mn>1.8</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq55.gif"/></alternatives></inline-formula>–<inline-formula id="IEq56"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1.6{\times}$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:mn>1.6</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq56.gif"/></alternatives></inline-formula> with AVX2 and <inline-formula id="IEq57"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1.6{\times}$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:mn>1.6</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq57.gif"/></alternatives></inline-formula> with SSE4. Because the vectorization is implemented for the alignment step and not for the matching and folding, these factors are reasonable. In combination with multi-threading we gain a large improvement of the run time. With 16 threads we achieve <inline-formula id="IEq58"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$13{\times}$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:mn>13</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq58.gif"/></alternatives></inline-formula> speed-up compared to the single-threaded run of LaRA 2 in the SSE4 or non-SIMD case and <inline-formula id="IEq59"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$11.5{\times}$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:mn>11.5</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq59.gif"/></alternatives></inline-formula> with AVX2. We analysed that the remaining sequential part in the program is mainly the computation of the base pair probabilities with <italic>RNAfold</italic>, which takes constantly 25 seconds. An additional effect has a larger memory allocation, e.g. for AVX2 instructions and 16 threads the program needs to allocate 128 alignments.</p>
    </sec>
    <sec id="Sec10">
      <title>Benchmark on RNA structures with pseudoknots</title>
      <p id="Par83">Although it is estimated that <inline-formula id="IEq61"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$12\%$$\end{document}</tex-math><mml:math id="M114"><mml:mrow><mml:mn>12</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq61.gif"/></alternatives></inline-formula> of RNA structures contain at least one pseudoknot [<xref ref-type="bibr" rid="CR20">20</xref>] the most structural alignment methods do not implement mechanisms to conserve pseudoknotted structures, because their detection is computationally more demanding. As many commonly used software tools do not detect pseudoknots, the number <inline-formula id="IEq62"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$12\%$$\end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:mn>12</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq62.gif"/></alternatives></inline-formula> may still be underestimated. Generally, in alignments with a high enough sequence conservation a pseudoknot can be aligned correctly by any method that aligns for sequence similarity, while for alignments with low sequence similarity the ability of the methods to represent crossing structures becomes more important.</p>
      <p id="Par84">We show with SPS values of some pseudoknotted RNAs from Rfam and in a graphical example that LaRA 2 actually detects pseudoknots. SPS scores express the similarity to the reference alignment and therefore a high score indicates that the pseudoknot is aligned properly, however a low score can result from a different location and is not sufficient to prove the absence of the pseudoknot in the test alignment.<table-wrap id="Tab3"><label>Table 3</label><caption><p>SPS evaluation of the test programs on pseudoknotted structures from Rfam</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">RNA family id</th><th align="left">RF01089</th><th align="left">RF01084</th><th align="left">RF00499</th><th align="left">RF00165</th></tr><tr><th align="left">sequence similarity</th><th align="left"><inline-formula id="IEq63"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$59.46\%$$\end{document}</tex-math><mml:math id="M118"><mml:mrow><mml:mn>59.46</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq63.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq64"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$53.51\%$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:mn>53.51</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq64.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq65"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$81.67\%$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:mn>81.67</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq65.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq66"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$66.92\%$$\end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:mn>66.92</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4532_Article_IEq66.gif"/></alternatives></inline-formula></th></tr></thead><tbody><tr><td align="left">LaRA 2 + T-Coffee</td><td align="left">0.82</td><td align="left"><bold>0.79</bold></td><td align="left">0.93</td><td align="left">0.84</td></tr><tr><td align="left">LaRA 2 + MAFFT</td><td align="left"><bold>0.86</bold></td><td align="left">0.75</td><td align="left"><bold>0.94</bold></td><td align="left"><bold>0.94</bold></td></tr><tr><td align="left">LaRA</td><td align="left">0.81</td><td align="left">0.77</td><td align="left">0.91</td><td align="left">0.83</td></tr><tr><td align="left">LocARNA</td><td align="left">0.76</td><td align="left">0.68</td><td align="left">0.89</td><td align="left">0.80</td></tr><tr><td align="left">RNAmountAlign</td><td align="left">0.63</td><td align="left">0.67</td><td align="left">0.93</td><td align="left">0.83</td></tr><tr><td align="left">MAFFT</td><td align="left">0.70</td><td align="left">0.59</td><td align="left">0.92</td><td align="left">0.83</td></tr></tbody></table><table-wrap-foot><p>The best values are printed in bold font</p></table-wrap-foot></table-wrap></p>
      <p id="Par85">The scores in Table <xref rid="Tab3" ref-type="table">3</xref> show that LaRA 2 performs the best according to the SPS criterion. This is expected, because LaRA 2 and LaRA receive their structural information from individual base pair probabilities and can model pseudoknots in their graph representation. The high scores of the structural interactions of the pseudoknot benefit the conservation of the respective columns of the multiple alignment as shown in the example above. A pure sequence aligner like MAFFT can only show good results with high sequence similarity like RF00499.</p>
      <p id="Par86">We have chosen a structure for the graphical example where the pseudoknot interactions are biologically essential: Athanasopoulos et al. [<xref ref-type="bibr" rid="CR53">53</xref>] describe a pseudoknot in the regulatory region of the repBA gene, which consists of two complementary sequences of 8 bases. The base pairing between them forms a pseudoknot that is essential for translation. We have downloaded for this benchmark the respective seven seed sequences (accession RF01089) from the Rfam database [<xref ref-type="bibr" rid="CR1">1</xref>] as well as the respective reference alignment.<fig id="Fig8"><label>Fig. 8</label><caption><p>Double covariance plots of RF01089 with R-chie [<xref ref-type="bibr" rid="CR54">54</xref>] after structure prediction with IPKnot [<xref ref-type="bibr" rid="CR55">55</xref>]. The plots demonstrate how well the different programs align the pseudoknot with respect to the reference structure from Rfam</p></caption><graphic xlink:href="12859_2021_4532_Fig8_HTML" id="MO12"/></fig></p>
      <p id="Par87">We computed the structural multiple alignment from the seed sequences with all the tools. Based on these alignments we ran IPknot [<xref ref-type="bibr" rid="CR55">55</xref>] (mode: McCaskill model with refinement, allow pseudoknots) to produce a folding of the alignments in order to detect whether the alignments have the correct pseudoknot positions aligned. Figure <xref rid="Fig8" ref-type="fig">8</xref> visualizes the foldings from IPknot in comparison to the Rfam reference structure. The plots were computed as double covariance plots with the R-chie tool [<xref ref-type="bibr" rid="CR54">54</xref>].</p>
      <p id="Par88">The pseudoknot of subject is the long-range interaction that is displayed in the reference part of all the plots. Comparing the plots reveals that almost all the tools correctly aligned the pseudoknot and placed it in the same position as in the reference; however with LocARNA the left side of the pseudoknot cannot be correctly spotted and is thus not represented in the alignment. We were surprised to see how well MAFFT aligns the pseudoknot in this example—apparently there is enough sequence similarity present in these pseudoknot sites such that a sequence aligner is able to align them correctly.</p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Conclusion</title>
    <p id="Par89">We have presented LaRA 2, a fast program for sequence–structure alignment of RNA sequences. LaRA 2 benefits from its improvements in parallel execution and a new matching algorithm such that it can solve the problem for large data sets in relatively short time. The underlying graph model allows the representation of pseudoknotted structures, which we demonstrated in the previous section. Furthermore, we show that on the BRAliBase benchmark set we have a similar performance as LocARNA.</p>
    <p id="Par90">In the future, we plan to analyse non coding RNA sequences named pre-miRNA with the new LaRA 2 tool that will be integrated in an investigation pipeline developed for calculating the miRNA and isomiR expression levels in small RNA-Seq datasets [<xref ref-type="bibr" rid="CR56">56</xref>, <xref ref-type="bibr" rid="CR57">57</xref>].</p>
    <p id="Par91">We also plan to derive structural motifs from the resulting alignments of LaRA 2 in order to scan genomic sequences for the occurrences of the motif. This allows to analyse yet unknown RNA families and to derive possible functions.</p>
  </sec>
  <sec id="Sec12">
    <title>Availability and requirements</title>
    <p id="Par92">
      <list list-type="bullet">
        <list-item>
          <p id="Par93">Project name: LaRA 2</p>
        </list-item>
        <list-item>
          <p id="Par94">Project home page: <ext-link ext-link-type="uri" xlink:href="https://seqan.github.io/lara">https://seqan.github.io/lara</ext-link></p>
        </list-item>
        <list-item>
          <p id="Par95">Operating systems: Tested on GNU/Linux and MacOS</p>
        </list-item>
        <list-item>
          <p id="Par96">Programming language: C++</p>
        </list-item>
        <list-item>
          <p id="Par97">Other requirements: SeqAn 2.4, Lemon 1.3.1, ViennaRNA 2.0 or higher</p>
        </list-item>
        <list-item>
          <p id="Par98">Licence: BSD-License (3-clause)</p>
        </list-item>
        <list-item>
          <p id="Par99">Any restrictions to use by non-academics: None</p>
        </list-item>
      </list>
    </p>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>AVX</term>
        <def>
          <p id="Par4">Advanced vector extensions</p>
        </def>
      </def-item>
      <def-item>
        <term>BPPM</term>
        <def>
          <p id="Par5">Base pair probability matrix</p>
        </def>
      </def-item>
      <def-item>
        <term>ILP</term>
        <def>
          <p id="Par6">Integer linear program</p>
        </def>
      </def-item>
      <def-item>
        <term>MFE</term>
        <def>
          <p id="Par7">Minimum free energy</p>
        </def>
      </def-item>
      <def-item>
        <term>miRNA</term>
        <def>
          <p id="Par8">Micro ribonucleic acid</p>
        </def>
      </def-item>
      <def-item>
        <term>MCC</term>
        <def>
          <p id="Par9">Matthews correlation coefficient</p>
        </def>
      </def-item>
      <def-item>
        <term>MSA</term>
        <def>
          <p id="Par10">Multiple sequence alignment</p>
        </def>
      </def-item>
      <def-item>
        <term>MWM</term>
        <def>
          <p id="Par11">Maximum weighted matching</p>
        </def>
      </def-item>
      <def-item>
        <term>ncRNA</term>
        <def>
          <p id="Par12">Non-coding ribonucleic acid</p>
        </def>
      </def-item>
      <def-item>
        <term>RNA</term>
        <def>
          <p id="Par13">Ribonucleic acid</p>
        </def>
      </def-item>
      <def-item>
        <term>SIMD</term>
        <def>
          <p id="Par14">Single instruction, multiple data</p>
        </def>
      </def-item>
      <def-item>
        <term>SSE</term>
        <def>
          <p id="Par15">Streaming SIMD extensions</p>
        </def>
      </def-item>
      <def-item>
        <term>SPS</term>
        <def>
          <p id="Par16">Sum-of-pairs score</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank the SeqAn team for support regarding the SeqAn interface, as well as anonymous referees for valuable comments.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>JW implemented LaRA 2 with major contributions from GU; JW and GU performed the benchmarks and wrote the publication; KR and EF designed and supervised the project. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Open Access funding enabled and organized by Projekt DEAL. JW has been supported by the Deutsche Forschungsgemeinschaft [RE 1712/10-1] and the International Max Planck Research School for Biology and Computation. The vectorization efforts in SeqAn have been supported by Intel in an IPCC at FU Berlin. The funding body did not play any role in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The source code of LaRA 2 is freely available on GitHub: <ext-link ext-link-type="uri" xlink:href="https://github.com/seqan/lara">https://github.com/seqan/lara</ext-link>. Data and scripts for the BRAliBase 2 benchmark are available on <ext-link ext-link-type="uri" xlink:href="http://projects.binf.ku.dk/pgardner/bralibase/bralibase2.html">http://projects.binf.ku.dk/pgardner/bralibase/bralibase2.html</ext-link>. The Plastids data for the deep alignment benchmark is available on <ext-link ext-link-type="uri" xlink:href="http://combio.pl/rrna/download">http://combio.pl/rrna/download</ext-link>. Reference alignments for the RNA structures used in our study can be accessed with the identification numbers RF00001, RF00005, RF00020, RF00029, RF00165, RF00499, RF01084, RF01089 on <ext-link ext-link-type="uri" xlink:href="https://rfam.xfam.org">https://rfam.xfam.org</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar2">
      <title>Ethics approval and consent to participate</title>
      <p id="Par100">Not applicable.</p>
    </notes>
    <notes id="FPar3">
      <title>Consent for publication</title>
      <p id="Par101">Not applicable.</p>
    </notes>
    <notes id="FPar4" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par102">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kalvari</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Nawrocki</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Argasinska</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Quinones-Olvera</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Finn</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Bateman</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Non-coding RNA analysis using the Rfam database</article-title>
        <source>Curr Protoc Bioinform</source>
        <year>2018</year>
        <volume>62</volume>
        <issue>1</issue>
        <fpage>e51</fpage>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wolf</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Achtziger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schultz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dandekar</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Homology modeling revealed more than 20,000 rRNA internal transcribed spacer 2 (ITS2) secondary structures</article-title>
        <source>RNA</source>
        <year>2005</year>
        <volume>11</volume>
        <issue>11</issue>
        <fpage>1616</fpage>
        <lpage>23</lpage>
        <?supplied-pmid 16244129?>
        <pub-id pub-id-type="pmid">16244129</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
          <name>
            <surname>Bernhart</surname>
            <given-names>SHF</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
        </person-group>
        <article-title>Alignment of RNA base pairing probability matrices</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <issue>14</issue>
        <fpage>2222</fpage>
        <lpage>7</lpage>
        <?supplied-pmid 15073017?>
        <pub-id pub-id-type="pmid">15073017</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Torarinsson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Havgaard</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Gorodkin</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Multiple structural alignment and clustering of RNA sequences</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <issue>8</issue>
        <fpage>926</fpage>
        <lpage>932</lpage>
        <?supplied-pmid 17324941?>
        <pub-id pub-id-type="pmid">17324941</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bauer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Klau</surname>
            <given-names>GW</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Accurate multiple sequence–structure alignment of RNA sequences using combinatorial optimization</article-title>
        <source>BMC Bioinform</source>
        <year>2007</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>18</lpage>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Will</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Reiche</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Backofen</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Inferring noncoding RNA families and classes by means of genome-scale structure-based clustering</article-title>
        <source>PLoS Comput Biol</source>
        <year>2007</year>
        <volume>3</volume>
        <issue>4</issue>
        <fpage>e65</fpage>
        <?supplied-pmid 17432929?>
        <pub-id pub-id-type="pmid">17432929</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Mathews</surname>
            <given-names>DH</given-names>
          </name>
        </person-group>
        <article-title>Multilign: an algorithm to predict secondary structures conserved in multiple RNA sequences</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>5</issue>
        <fpage>626</fpage>
        <lpage>32</lpage>
        <?supplied-pmid 21193521?>
        <pub-id pub-id-type="pmid">21193521</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tabei</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kiryu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Asai</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>A fast structural multiple alignment method for long RNA sequences</article-title>
        <source>BMC Bioinform</source>
        <year>2008</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>33</fpage>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wei</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Alpert</surname>
            <given-names>LV</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>RNAG: a new Gibbs sampler for predicting RNA secondary structure for unaligned sequences</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>18</issue>
        <fpage>2486</fpage>
        <lpage>93</lpage>
        <?supplied-pmid 21788211?>
        <pub-id pub-id-type="pmid">21788211</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meyer</surname>
            <given-names>IM</given-names>
          </name>
          <name>
            <surname>Miklós</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>SimulFold: simultaneously inferring RNA structures including pseudoknots, alignments, and trees using a Bayesian MCMC framework</article-title>
        <source>PLoS Comput Biol</source>
        <year>2007</year>
        <volume>3</volume>
        <issue>8</issue>
        <fpage>e149</fpage>
        <?supplied-pmid 17696604?>
        <pub-id pub-id-type="pmid">17696604</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tan</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Fu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sharma</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Mathews</surname>
            <given-names>DH</given-names>
          </name>
        </person-group>
        <article-title>TurboFold II: RNA structural alignment and secondary structure prediction informed by multiple homologs</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>45</volume>
        <issue>20</issue>
        <fpage>11570</fpage>
        <lpage>11581</lpage>
        <?supplied-pmid 29036420?>
        <pub-id pub-id-type="pmid">29036420</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mattick</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>The functional genomics of noncoding RNA</article-title>
        <source>Science</source>
        <year>2005</year>
        <volume>309</volume>
        <issue>5740</issue>
        <fpage>1527</fpage>
        <lpage>8</lpage>
        <?supplied-pmid 16141063?>
        <pub-id pub-id-type="pmid">16141063</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Viehweger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Krautwurst</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lamkiewicz</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Madhugiri</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ziebuhr</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hölzer</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Direct RNA nanopore sequencing of full-length coronavirus genomes provides novel insights into structural variants and enables modification analysis</article-title>
        <source>Genome Res</source>
        <year>2019</year>
        <volume>29</volume>
        <issue>9</issue>
        <fpage>1545</fpage>
        <lpage>1554</lpage>
        <?supplied-pmid 31439691?>
        <pub-id pub-id-type="pmid">31439691</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lim</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <article-title>Know your enemy: successful bioinformatic approaches to predict functional RNA structures in viral RNAs</article-title>
        <source>Front Microbiol</source>
        <year>2018</year>
        <volume>8</volume>
        <fpage>2582</fpage>
        <?supplied-pmid 29354101?>
        <pub-id pub-id-type="pmid">29354101</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rivas</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Clements</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>A statistical test for conserved RNA structure shows lack of evidence for structure in lncRNAs</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>45</fpage>
        <lpage>48</lpage>
        <?supplied-pmid 27819659?>
        <pub-id pub-id-type="pmid">27819659</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gutell</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Power</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hertz</surname>
            <given-names>GZ</given-names>
          </name>
          <name>
            <surname>Putz</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Stormo</surname>
            <given-names>GD</given-names>
          </name>
        </person-group>
        <article-title>Identifying constraints on the higher-order structure of RNA: continued development and application of comparative sequence analysis methods</article-title>
        <source>Nucleic Acids Res</source>
        <year>1992</year>
        <volume>20</volume>
        <issue>21</issue>
        <fpage>5785</fpage>
        <lpage>95</lpage>
        <?supplied-pmid 1454539?>
        <pub-id pub-id-type="pmid">1454539</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sankoff</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Simultaneous solution of the RNA folding, alignment and protosequence problems</article-title>
        <source>SIAM J Appl Math</source>
        <year>1985</year>
        <volume>45</volume>
        <issue>5</issue>
        <fpage>810</fpage>
        <lpage>825</lpage>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Will</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Joshi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Backofen</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>LocARNA-P: accurate boundary prediction and improved detection of structural RNAs</article-title>
        <source>RNA</source>
        <year>2012</year>
        <volume>18</volume>
        <issue>5</issue>
        <fpage>900</fpage>
        <lpage>914</lpage>
        <?supplied-pmid 22450757?>
        <pub-id pub-id-type="pmid">22450757</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Will</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Otto</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Miladi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Möhl</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Backofen</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>SPARSE: quadratic time simultaneous alignment and folding of RNAs without sequence-based heuristics</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>15</issue>
        <fpage>2489</fpage>
        <lpage>96</lpage>
        <?supplied-pmid 25838465?>
        <pub-id pub-id-type="pmid">25838465</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Danaee</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Rouches</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wiley</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hendrix</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>bpRNA: large-scale automated annotation and analysis of RNA secondary structure</article-title>
        <source>Nucleic Acids Res</source>
        <year>2018</year>
        <volume>46</volume>
        <issue>11</issue>
        <fpage>5381</fpage>
        <lpage>5394</lpage>
        <?supplied-pmid 29746666?>
        <pub-id pub-id-type="pmid">29746666</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shabash</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wiese</surname>
            <given-names>KC</given-names>
          </name>
        </person-group>
        <article-title>jViz. RNA 4.0—visualizing pseudoknots and RNA editing employing compressed tree graphs</article-title>
        <source>PLoS ONE</source>
        <year>2019</year>
        <volume>14</volume>
        <issue>5</issue>
        <fpage>e0210281</fpage>
        <?supplied-pmid 31059508?>
        <pub-id pub-id-type="pmid">31059508</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kucharik</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Qin</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Pseudoknots in RNA folding landscapes</article-title>
        <source>Bioinformatics.</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>2</issue>
        <fpage>187</fpage>
        <lpage>194</lpage>
        <?supplied-pmid 26428288?>
        <pub-id pub-id-type="pmid">26428288</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jabbari</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wark</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Montemagno</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Will</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Knotty: efficient and accurate prediction of complex RNA pseudoknot structures</article-title>
        <source>Bioinformatics.</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>22</issue>
        <fpage>3849</fpage>
        <lpage>3856</lpage>
        <?supplied-pmid 29868872?>
        <pub-id pub-id-type="pmid">29868872</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rivas</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>A dynamic programming algorithm for RNA structure prediction including pseudoknots</article-title>
        <source>J Mol Biol.</source>
        <year>1999</year>
        <volume>285</volume>
        <issue>5</issue>
        <fpage>2053</fpage>
        <lpage>68</lpage>
        <?supplied-pmid 9925784?>
        <pub-id pub-id-type="pmid">9925784</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dirks</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Pierce</surname>
            <given-names>NA</given-names>
          </name>
        </person-group>
        <article-title>An algorithm for computing nucleic acid base-pairing probabilities including pseudoknots</article-title>
        <source>J Comput Chem.</source>
        <year>2004</year>
        <volume>25</volume>
        <issue>10</issue>
        <fpage>1295</fpage>
        <lpage>304</lpage>
        <?supplied-pmid 15139042?>
        <pub-id pub-id-type="pmid">15139042</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Möhl</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Will</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Backofen</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Lifting prediction to alignment of RNA pseudoknots</article-title>
        <source>J Comput Biol.</source>
        <year>2010</year>
        <volume>17</volume>
        <issue>3</issue>
        <fpage>429</fpage>
        <lpage>42</lpage>
        <?supplied-pmid 20377455?>
        <pub-id pub-id-type="pmid">20377455</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Daily</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Parasail: SIMD C library for global, semi-global, and local pairwise sequence alignments</article-title>
        <source>BMC Bioinform</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>81</fpage>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rahn</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Budach</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Costanza</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ehrhardt</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hancox</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Generic accelerated sequence alignment in SeqAn using vectorization and multi-threading</article-title>
        <source>Bioinformatics.</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>20</issue>
        <fpage>3437</fpage>
        <lpage>3445</lpage>
        <?supplied-pmid 29726911?>
        <pub-id pub-id-type="pmid">29726911</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roehr</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Dieterich</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Flexbar 3.0—SIMD and multicore parallelization</article-title>
        <source>Bioinformatics.</source>
        <year>2017</year>
        <volume>33</volume>
        <issue>18</issue>
        <fpage>2941</fpage>
        <lpage>2942</lpage>
        <?supplied-pmid 28541403?>
        <pub-id pub-id-type="pmid">28541403</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bauer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Klau</surname>
            <given-names>GW</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>An exact mathematical programming approach to multiple RNA sequence–structure alignment</article-title>
        <source>Algor Oper Res.</source>
        <year>2008</year>
        <volume>3</volume>
        <fpage>130</fpage>
        <lpage>146</lpage>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lalwani</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gupta</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Sequence–structure alignment techniques for RNA: a comprehensive survey</article-title>
        <source>Adv Life Sci.</source>
        <year>2014</year>
        <volume>4</volume>
        <issue>1</issue>
        <fpage>21</fpage>
        <lpage>35</lpage>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bayegan</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Clote</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>RNAmountAlign: efficient software for local, global, semiglobal pairwise and multiple RNA sequence/structure alignment</article-title>
        <source>PLoS ONE.</source>
        <year>2020</year>
        <volume>15</volume>
        <issue>1</issue>
        <fpage>e0227177</fpage>
        <?supplied-pmid 31978147?>
        <pub-id pub-id-type="pmid">31978147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miladi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Raden</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Will</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Backofen</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate structure probability estimation for simultaneous alignment and folding of RNAs with Markov chains</article-title>
        <source>Algor Mol Biol.</source>
        <year>2020</year>
        <volume>15</volume>
        <issue>1</issue>
        <fpage>19</fpage>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Improved accuracy of multiple ncRNA alignment by incorporating structural information into a MAFFT-based framework</article-title>
        <source>BMC Bioinform.</source>
        <year>2008</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>212</fpage>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lorenz</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bernhart</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Zu Siederdissen</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Tafer</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Flamm</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ViennaRNA package 2.0</article-title>
        <source>Algor Mol Biol.</source>
        <year>2011</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>26</fpage>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Needleman</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Wunsch</surname>
            <given-names>CD</given-names>
          </name>
        </person-group>
        <article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins</article-title>
        <source>J Mol Biol.</source>
        <year>1970</year>
        <volume>48</volume>
        <issue>3</issue>
        <fpage>443</fpage>
        <lpage>453</lpage>
        <?supplied-pmid 5420325?>
        <pub-id pub-id-type="pmid">5420325</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Urgese G, Paciello G, Acquaviva A, Ficarra E, Graziano M, Zamboni M. Dynamic gap selector: a Smith Waterman sequence alignment algorithm with affine gap model optimisation. In: 2nd International work-conference on bioinformatics and biomedical engineering (IWBBIO), 7–9 April 2014; Granada. Copicentro Granada SL; 2014. p. 1347–1358.</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gotoh</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Consistency of optimal sequence alignments</article-title>
        <source>Bull Math Biol.</source>
        <year>1990</year>
        <volume>52</volume>
        <fpage>509</fpage>
        <lpage>525</lpage>
        <?supplied-pmid 1697773?>
        <pub-id pub-id-type="pmid">1697773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Notredame</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Heringa</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>T-Coffee: a novel method for fast and accurate multiple sequence alignment</article-title>
        <source>J Mol Biol.</source>
        <year>2000</year>
        <volume>302</volume>
        <issue>1</issue>
        <fpage>205</fpage>
        <lpage>217</lpage>
        <?supplied-pmid 10964570?>
        <pub-id pub-id-type="pmid">10964570</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Mehlhorn</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Näher</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Uhrig</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Palamidessi</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Yung</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The LEDA platform for combinatorial and geometric computing</article-title>
        <source>Automata, languages and programming</source>
        <year>1997</year>
        <publisher-loc>Berlin</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>7</fpage>
        <lpage>16</lpage>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reinert</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dadi</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Ehrhardt</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hauswedell</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Mehringer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rahn</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The SeqAn C++ template library for efficient sequence analysis: a resource for programmers</article-title>
        <source>J Biotechnol.</source>
        <year>2017</year>
        <volume>261</volume>
        <fpage>157</fpage>
        <lpage>168</lpage>
        <?supplied-pmid 28888961?>
        <pub-id pub-id-type="pmid">28888961</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">Budach S. Generic SIMD extension of dynamic programming algorithms in SeqAn. Freie Universität Berlin; 2015. Master’s thesis.</mixed-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <mixed-citation publication-type="other">Intel Corporation. Intel<sup>®</sup> intrinsics guide. Accessed on 18th December; 2020. Available from <ext-link ext-link-type="uri" xlink:href="https://software.intel.com/sites/landingpage/IntrinsicsGuide">https://software.intel.com/sites/landingpage/IntrinsicsGuide</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edmonds</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Paths, trees, and flowers</article-title>
        <source>Can J Math.</source>
        <year>1965</year>
        <volume>17</volume>
        <fpage>449</fpage>
        <lpage>467</lpage>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dezső</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Jüttner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kovács</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>LEMON—an open source C++ graph template library</article-title>
        <source>Electron Notes Theor Comput Sci.</source>
        <year>2011</year>
        <volume>264</volume>
        <issue>5</issue>
        <fpage>23</fpage>
        <lpage>45</lpage>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Standley</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>MAFFT multiple sequence alignment software version 7: improvements in performance and usability</article-title>
        <source>Mol Biol Evol.</source>
        <year>2013</year>
        <volume>30</volume>
        <issue>4</issue>
        <fpage>772</fpage>
        <lpage>780</lpage>
        <?supplied-pmid 23329690?>
        <pub-id pub-id-type="pmid">23329690</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Matthews</surname>
            <given-names>BW</given-names>
          </name>
        </person-group>
        <article-title>Comparison of the predicted and observed secondary structure of T4 phage lysozyme</article-title>
        <source>Biochim Biophys Acta.</source>
        <year>1975</year>
        <volume>405</volume>
        <issue>2</issue>
        <fpage>442</fpage>
        <lpage>51</lpage>
        <?supplied-pmid 1180967?>
        <pub-id pub-id-type="pmid">1180967</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiryu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Tabei</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Asai</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Murlet: a practical multiple alignment tool for structural RNA sequences</article-title>
        <source>Bioinformatics.</source>
        <year>2007</year>
        <volume>23</volume>
        <issue>13</issue>
        <fpage>1588</fpage>
        <lpage>98</lpage>
        <?supplied-pmid 17459961?>
        <pub-id pub-id-type="pmid">17459961</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Seemann</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Menzel</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Backofen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gorodkin</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The PETfold and PETcofold web servers for intra- and intermolecular structures of multiple RNA sequences</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2011</year>
        <volume>39</volume>
        <issue>Web Server issue</issue>
        <fpage>W107</fpage>
        <lpage>11</lpage>
        <?supplied-pmid 21609960?>
        <pub-id pub-id-type="pmid">21609960</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gardner</surname>
            <given-names>PP</given-names>
          </name>
          <name>
            <surname>Wilm</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Washietl</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>A benchmark of multiple sequence alignment programs upon structural RNAs</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2005</year>
        <volume>33</volume>
        <issue>8</issue>
        <fpage>2433</fpage>
        <lpage>2439</lpage>
        <?supplied-pmid 15860779?>
        <pub-id pub-id-type="pmid">15860779</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Löwes</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Chauve</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ponty</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Giegerich</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>The BRaliBase dent—a tale of benchmark design and interpretation</article-title>
        <source>Brief Bioinform.</source>
        <year>2016</year>
        <volume>18</volume>
        <issue>2</issue>
        <fpage>306</fpage>
        <lpage>311</lpage>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Szymanski</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Barciszewska</surname>
            <given-names>MZ</given-names>
          </name>
          <name>
            <surname>Erdmann</surname>
            <given-names>VA</given-names>
          </name>
          <name>
            <surname>Barciszewski</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>5S ribosomal RNA database</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2002</year>
        <volume>30</volume>
        <issue>1</issue>
        <fpage>176</fpage>
        <lpage>8</lpage>
        <?supplied-pmid 11752286?>
        <pub-id pub-id-type="pmid">11752286</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Athanasopoulos</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Praszkier</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pittard</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Analysis of elements involved in pseudoknot-dependent expression and regulation of the repA gene of an IncL/M plasmid</article-title>
        <source>J Bacteriol.</source>
        <year>1999</year>
        <volume>181</volume>
        <issue>6</issue>
        <fpage>1811</fpage>
        <lpage>1819</lpage>
        <?supplied-pmid 10074073?>
        <pub-id pub-id-type="pmid">10074073</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lai</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Proctor</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>JYA</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>IM</given-names>
          </name>
        </person-group>
        <article-title>R-chie: a web server and R package for visualizing RNA secondary structures</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2012</year>
        <volume>40</volume>
        <issue>12</issue>
        <fpage>e95</fpage>
        <?supplied-pmid 22434875?>
        <pub-id pub-id-type="pmid">22434875</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sato</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kato</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hamada</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Akutsu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Asai</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>IPknot: fast and accurate prediction of RNA secondary structures with pseudoknots using integer programming</article-title>
        <source>Bioinformatics.</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>13</issue>
        <fpage>i85</fpage>
        <lpage>i93</lpage>
        <?supplied-pmid 21685106?>
        <pub-id pub-id-type="pmid">21685106</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Urgese</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Paciello</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Acquaviva</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ficarra</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>isomiR-SEA: an RNA-Seq analysis tool for miRNAs/isomiRs expression level profiling and miRNA–mRNA interaction sites evaluation</article-title>
        <source>BMC Bioinform.</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Urgese</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Parisi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Scicolone</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Di Cataldo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ficarra</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>BioSeqZip: a collapser of NGS redundant reads for the optimization of sequence analysis</article-title>
        <source>Bioinformatics.</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>9</issue>
        <fpage>2705</fpage>
        <lpage>2711</lpage>
        <?supplied-pmid 31999333?>
        <pub-id pub-id-type="pmid">31999333</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
