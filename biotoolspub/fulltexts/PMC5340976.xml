<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.0 20120330//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Res</journal-id>
    <journal-id journal-id-type="hwp">genome</journal-id>
    <journal-id journal-id-type="pmc">genome</journal-id>
    <journal-id journal-id-type="publisher-id">GENOME</journal-id>
    <journal-title-group>
      <journal-title>Genome Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1088-9051</issn>
    <issn pub-type="epub">1549-5469</issn>
    <publisher>
      <publisher-name>Cold Spring Harbor Laboratory Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5340976</article-id>
    <article-id pub-id-type="pmid">28100584</article-id>
    <article-id pub-id-type="medline">9509184</article-id>
    <article-id pub-id-type="doi">10.1101/gr.209601.116</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>UMI-tools: modeling sequencing errors in Unique Molecular Identifiers to improve quantification accuracy</article-title>
      <alt-title alt-title-type="left-running">Smith et al.</alt-title>
      <alt-title alt-title-type="right-running">Modeling UMI errors improves quantification accuracy</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-0697-8777</contrib-id>
        <name>
          <surname>Smith</surname>
          <given-names>Tom</given-names>
        </name>
        <xref ref-type="aff" rid="af1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-7720-0447</contrib-id>
        <name>
          <surname>Heger</surname>
          <given-names>Andreas</given-names>
        </name>
        <xref ref-type="aff" rid="af1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-5038-0190</contrib-id>
        <name>
          <surname>Sudbery</surname>
          <given-names>Ian</given-names>
        </name>
        <xref ref-type="aff" rid="af2">2</xref>
      </contrib>
    </contrib-group>
    <aff id="af1"><label>1</label>Computational Genomics Analysis and Training Programme, MRC WIMM Centre for Computational Biology, University of Oxford, Oxford OX3 9DS, United Kingdom;</aff>
    <aff id="af2"><label>2</label>Department of Molecular Biology and Biotechnology, University of Sheffield, Sheffield S10 2TN, United Kingdom</aff>
    <author-notes>
      <corresp>Corresponding author: <email>i.sudbery@sheffield.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>3</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <month>3</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="ppub"/>. -->
    <volume>27</volume>
    <issue>3</issue>
    <fpage>491</fpage>
    <lpage>499</lpage>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>5</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>1</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>
        <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/site/misc/terms.xhtml">© 2017 Smith et al.; Published by Cold Spring Harbor Laboratory Press</ext-link>
      </copyright-statement>
      <copyright-year>2017</copyright-year>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This article, published in <italic>Genome Research</italic>, is available under a Creative Commons License (Attribution 4.0 International), as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="491.pdf"/>
    <abstract>
      <p>Unique Molecular Identifiers (UMIs) are random oligonucleotide barcodes that are increasingly used in high-throughput sequencing experiments. Through a UMI, identical copies arising from distinct molecules can be distinguished from those arising through PCR amplification of the same molecule. However, bioinformatic methods to leverage the information from UMIs have yet to be formalized. In particular, sequencing errors in the UMI sequence are often ignored or else resolved in an ad hoc manner. We show that errors in the UMI sequence are common and introduce network-based methods to account for these errors when identifying PCR duplicates. Using these methods, we demonstrate improved quantification accuracy both under simulated conditions and real iCLIP and single-cell RNA-seq data sets. Reproducibility between iCLIP replicates and single-cell RNA-seq clustering are both improved using our proposed network-based method, demonstrating the value of properly accounting for errors in UMIs. These methods are implemented in the open source UMI-tools software package.</p>
    </abstract>
    <funding-group>
      <award-group id="funding-1">
        <funding-source>Medical Research Council <named-content content-type="funder-id">http://dx.doi.org/10.13039/501100000265</named-content></funding-source>
        <award-id>G1000902</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <p>High-throughput sequencing technologies yield vast numbers of short sequences (reads) from a pool of DNA fragments. Over the last ten years, a wide variety of sequencing applications have been developed that estimate the abundance of a particular DNA fragment by the number of reads obtained in a sequencing experiment (read counting) and then compare these abundances across biological conditions. Perhaps the most widely used read counting approach is RNA-seq, which seeks to compare the number of copies of each transcript in different cell types or conditions. Prior to sequencing, a PCR amplification step is normally performed to ensure sufficient DNA for sequencing and/or enrichment for fragments with successful adapter ligation. Biases in the PCR amplification step lead to particular sequences becoming overrepresented in the final library (<xref rid="SMITHGR209601C1" ref-type="bibr">Aird et al. 2011</xref>). In order to prevent this bias propagating to the quantification estimates, it is common to remove reads or read pairs with the same alignment coordinates, because they are assumed to arise through PCR amplification of the same molecule (<xref rid="SMITHGR209601C28" ref-type="bibr">Sims et al. 2014</xref>). This is appropriate where sequencing depth is low and thus the probability of two independent fragments having the same genomic coordinates are low, as with paired-end whole-genome DNA-seq from a large genome. However, the probability of generating independent fragments mapping to the same genomic coordinates increases as the distribution of the alignment coordinates deviates from a random sampling across the genome and/or the sequencing depth increases. For example, in RNA-seq, highly expressed transcripts are more likely to generate multiple fragments with exactly the same genomic coordinates. The problem of PCR duplicates is more acute when greater numbers of PCR cycles are required to increase the library concentration, as in single-cell RNA-seq, or when the alignment coordinates are limited to a few distinct loci, as in individual-nucleotide resolution Cross-Linking and ImmunoPrecipitation (iCLIP). Random barcodes were initially proposed as a method to count the number of mRNA molecules in a sample (<xref rid="SMITHGR209601C7" ref-type="bibr">Hug and Schuler 2003</xref>), and have since been used to explicitly label PCR duplicates (<xref rid="SMITHGR209601C19" ref-type="bibr">McCloskey et al. 2007</xref>). More recently, random barcodes, referred to as Unique Molecular Identifiers (UMIs), have been used to confidently identify PCR duplicates in high-throughput sequencing experiments (<xref rid="SMITHGR209601C12" ref-type="bibr">König et al. 2010</xref>; <xref rid="SMITHGR209601C10" ref-type="bibr">Kivioja et al. 2012</xref>; <xref rid="SMITHGR209601C8" ref-type="bibr">Islam et al. 2014</xref>). By incorporating a UMI into the same location in each fragment during library preparation, but prior to PCR amplification, it is possible to accurately identify true PCR duplicates because they have both identical alignment coordinates and identical UMI sequences (<xref ref-type="fig" rid="SMITHGR209601F1">Fig. 1</xref>A). In addition to their use in single-cell RNA-seq and iCLIP (<xref rid="SMITHGR209601C12" ref-type="bibr">König et al. 2010</xref>), UMIs may be applied to almost any sequencing method in which confident identification of PCR duplicates by alignment coordinates alone is not possible and/or an accurate quantification is required, including ChIP-exo (<xref rid="SMITHGR209601C6" ref-type="bibr">He et al. 2015</xref>), DNA-seq karyotyping (<xref rid="SMITHGR209601C9" ref-type="bibr">Karlsson et al. 2015</xref>), detection of rare mutations (<xref rid="SMITHGR209601C26" ref-type="bibr">Schmitt et al. 2012</xref>), and antibody repertoire sequencing (<xref rid="SMITHGR209601C31" ref-type="bibr">Vollmers et al. 2013</xref>).</p>
  <fig id="SMITHGR209601F1" orientation="portrait" position="float">
    <label>Figure 1.</label>
    <caption>
      <p>Modeling errors in UMIs. (<italic>A</italic>) Schematic representation of how UMIs are used to count unique molecules. Fragmented DNA is labeled with a random UMI sequence (short oligonucleotide; represented as colored blocks). Following PCR amplification, sequencing, and bioinformatics steps, the sequence read alignment coordinates and UMI sequences are used to identify sequence reads originating from the same initial DNA fragment (PCR duplicates) and so count the unique molecules. (<italic>B</italic>) Average edit distances (rounded to integers) between UMIs with the same alignment coordinates. Genomic positions with a single UMI are not shown. (Null) Null expectation from random sampling of UMIs, taking into account the genome-wide distribution of UMIs. (<italic>C</italic>) Correlation between duplication rate and enrichment of positions with an average edit distance of 1 for iCLIP data. (<italic>D</italic>) Topologies of networks formed by joining reads with the same genomic coordinates and UMIs a single edit distance apart. (Single hub) One node connected to all other nodes; (complex) no node connected to all other nodes. (<italic>E</italic>) Methods for estimating unique molecules from UMI sequences and counts at a single locus. Where the method uses the UMI counts, these are shown. Red bases are inferred to be sequencing errors, and blue bases are inferred to be PCR errors. The inferred number of unique molecules for each method is shown in parentheses.</p>
    </caption>
    <graphic xlink:href="491f01"/>
  </fig>
  <p>Accurate quantification with UMIs is predicated on a one-to-one relationship between the number of unique UMI barcodes at a given genomic locus and the number of unique fragments that have been sequenced. However, errors within the UMI sequence, including nucleotide substitutions during PCR and nucleotide miscalling and insertions or deletions (indels) during sequencing, create additional artifactual UMIs. Nucleotide miscalling and substitution errors affect only the UMI sequence itself and do not affect the alignment coordinates. Hence, these errors will inflate the estimation of the number of unique molecules at a particular genomic coordinate. These errors can be identified by examining all UMIs at a single genomic coordinate. On the other hand, UMI indels will affect the alignment position also, leading to the assignment of reads to incorrect genome coordinates. Identification of such events requires the examination of sets of UMIs at neighboring coordinates. Recombination events, also called “PCR jumping,” create chimeric sequences that may change either the UMI sequence and/or alignment. Miscalling during sequencing is by far the most prevalent error, occurring one to two orders of magnitude more frequently than indels for Illumina sequencing (<xref rid="SMITHGR209601C18" ref-type="bibr">Marinier et al. 2015</xref>; <xref rid="SMITHGR209601C23" ref-type="bibr">Schirmer et al. 2015</xref>, <xref rid="SMITHGR209601C24" ref-type="bibr">2016</xref>). Recombination is common when sequencing amplicons, but much rarer with the shotgun sequencing approaches in which UMIs are utilized (<xref rid="SMITHGR209601C25" ref-type="bibr">Schloss et al. 2011</xref>; <xref rid="SMITHGR209601C32" ref-type="bibr">Waugh et al. 2015</xref>). We therefore focus here on improving quantification via UMIs by considering nucleotide miscalling and substitution errors within pools of UMIs from the same genomic coordinate. Herein, we will refer to these errors as UMI errors.</p>
  <p>UMI errors have been considered in previous analyses (<xref rid="SMITHGR209601C8" ref-type="bibr">Islam et al. 2014</xref>; <xref rid="SMITHGR209601C3" ref-type="bibr">Bose et al. 2015</xref>; <xref rid="SMITHGR209601C17" ref-type="bibr">Macosko et al. 2015</xref>; <xref rid="SMITHGR209601C35" ref-type="bibr">Yaari and Kleinstein 2015</xref>). However, their impact on quantification accuracy has not previously been demonstrated, and there is no consistency in the approach taken to resolve these errors. For example, <xref rid="SMITHGR209601C8" ref-type="bibr">Islam et al. (2014)</xref> removed all UMIs where the counts were &gt;1% of the mean counts of all other nonzero UMIs at the genomic locus, whereas <xref rid="SMITHGR209601C3" ref-type="bibr">Bose et al. (2015)</xref> merged together all UMIs within a Hamming distance of two or less, with little explanation as to how this was achieved. We therefore set out to demonstrate the need to account for UMI errors, to compare different methods for resolving UMI errors and to formalize an approach for removing PCR duplicates with UMIs.</p>
  <sec sec-type="results" id="s1">
    <title>Results</title>
    <p>We reasoned that UMI errors create groups of similar UMIs at a given genomic locus. To confirm this, we calculated the average number of bases different (edit distance) between UMIs at a given genomic locus and compared the distribution of average edit distances to a null distribution generated by randomly sampling (Methods). Using iCLIP data (<xref rid="SMITHGR209601C20" ref-type="bibr">Müller-McNicoll et al. 2016</xref>), we confirmed that the UMIs are more similar to one another than expected according to the null, strongly suggesting sequencing and/or PCR errors are generating artifactual UMIs (Methods; <xref ref-type="fig" rid="SMITHGR209601F1">Fig. 1</xref>B; for other data sets, see <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.209601.116/-/DC1">Supplemental Fig. S1</ext-link>). Furthermore, the enrichment of low edit distances is well correlated with the degree of PCR duplication (<xref ref-type="fig" rid="SMITHGR209601F1">Fig. 1</xref>C). Overall, we detected a 25-fold enrichment for positions with an average edit distance of 1, compared to our null expectation. In contrast, when we compared the UMI sequences at adjacent positions, we detected an 1.1-fold (± standard deviation of 0.1) (Methods) enrichment for UMIs, which may have originated from a single nucleotide deletion, suggesting UMI indels are much less prevalent than UMI errors, as expected. We then constructed networks between UMIs at the same genomic locus, where nodes represent UMIs and edges connect UMI separated by a single nucleotide difference. Although most of the networks contained just a single node, we observed that 3%–36% of networks contained two or more nodes, of which 4%–20% did not contain a single central node, and thus could not be naïvely resolved (<xref ref-type="fig" rid="SMITHGR209601F1">Fig. 1</xref>D). This indicates that the majority of networks are likely to originate from a single unique molecule prior to PCR amplification, but a minority of networks may originate from a combination of errors during PCR and sequencing or may originate from multiple unique molecules, which by chance have similar UMIs.</p>
    <sec id="s1a">
      <title>Methods to identify unique molecules</title>
      <p>Many previous studies assume each UMI at a given genomic locus represents a different unique molecule (<xref rid="SMITHGR209601C27" ref-type="bibr">Shiroguchi et al. 2012</xref>; <xref rid="SMITHGR209601C29" ref-type="bibr">Soumillon et al. 2014</xref>; <xref rid="SMITHGR209601C4" ref-type="bibr">Collins et al. 2015</xref>). We refer to this method as <italic>unique</italic>. <xref rid="SMITHGR209601C8" ref-type="bibr">Islam et al. (2014)</xref> previously identified the issue of sequencing errors and proposed removing UMIs whose counts fall below a threshold of 1% of the mean of all nonzero UMIs at the locus, a method we refer to as <italic>percentile</italic>.</p>
      <p>We have developed three methods to identify the number of unique molecules at a given locus by resolving UMI networks formed by linking UMIs separated by a single edit distance (<xref ref-type="fig" rid="SMITHGR209601F1">Fig. 1</xref>E). In all cases, the aim is to reduce the network down to a representative UMI(s) that accounts for the network; identifying the exact sequence of the original UMI(s) is not important for the purposes of quantification. The simplest method we examined was to merge all UMIs within the network, retaining only the UMI with the highest counts. For this method, the number of networks formed at a given locus is equivalent to the estimated number of unique molecules. This is similar to the method used by <xref rid="SMITHGR209601C3" ref-type="bibr">Bose et al. (2015)</xref> where UMIs with an edit distance of 2 or less were considered to originate from an identical molecule. We refer to this method as <italic>cluster</italic>. This method is expected to underestimate the number of unique molecules, especially for complex networks. We therefore developed the <italic>adjacency</italic> method, which attempts to correctly resolve the complex networks by using the node counts. The most abundant node and all nodes connected to it are removed from the network. If this does not account for all the nodes in the network, the next most abundant node and its neighbors are also removed. This is repeated until all nodes in the network are accounted for. In the method, the total number of steps to resolve the network(s) formed at a given locus is equivalent to the number of estimated unique molecules. This method allows a complex network to originate from more than one UMI, although UMIs with an edit distance of two will always be removed in separate steps. The excess of UMIs pairs with an edit distance of two observed in the iCLIP data sets indicate that some of these UMIs are artifactual. Reasoning that counts for UMIs generated by a single sequencing error should be higher than those generated by two errors and UMIs resulting from errors during the PCR amplification stage should have higher counts than UMIs resulting from sequencing errors, we developed a final method, <italic>directional</italic>. We generated networks from the UMIs at a single locus, in which directional edges connect nodes a single edit distance apart when <italic>n</italic><sub>a</sub> ≥ 2<italic>n</italic><sub>b</sub> − 1, where <italic>n</italic><sub>a</sub> and <italic>n</italic><sub>b</sub> are the counts of node a and node b. The entire directional network is then considered to have originated from the node with the highest counts. The ratio between the final counts for the true UMI and the erroneous UMI generated from a PCR error is dependent upon which PCR cycle the error occurs and the relative amplification biases for the two UMIs, but should rarely be less than twofold. The −1 component was included to account for strings of UMIs with low counts, each separated by a single edit distance for which the 2<italic>n</italic> threshold alone is too conservative. This method allows UMIs separated by edit distances greater than one to be merged so long as the intermediate UMI is also observed, and with each sequential base change from the most abundant UMI, the count decreases. For this method, the number of directional networks formed is equivalent to the estimated number of unique molecules.</p>
    </sec>
    <sec id="s1b">
      <title>Comparing methods with simulated data</title>
      <p>To compare the accuracy of the proposed methods, we simulated the process of UMI amplification and sequencing for UMIs at a single locus and varied the simulation parameters (Methods). To examine the accuracy of the five methods, we computed two metrics: the log<sub>2</sub>-fold difference between the estimate and ground truth log<sub>2</sub>[(estimate − truth)/truth] and the coefficient of variation (CV) (standard deviation/mean) across 10,000 iterations. Increasing UMI length or sequencing depth results in a linear increase in the degree of overestimation for <italic>unique</italic> and <italic>percentile</italic> (<xref ref-type="fig" rid="SMITHGR209601F2">Fig. 2</xref>A,B), since increasing either parameter linearly increases the total amount of UMI sequence that may harbor errors. In contrast, the estimates from the network-based methods remain relatively stable, with <italic>directional</italic> showing the highest accuracy and lowest variance. We also simulated the effect of including a very long UMI (up to 50 bp) as there may be occasions where it is preferable to concatenate a UMI with another barcode, such as a sample barcode or cell barcode in single-cell RNA-seq, leading to longer barcodes. We noted that the network-based methods showed reduced accuracy for very long barcodes (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.209601.116/-/DC1">Supplemental Fig. S2A</ext-link>). Investigating further, we found this was correlated with an increase in UMIs with two errors in which the single error intermediate was not observed, as detected by counting the number of networks that did not contain any of the initial UMIs prior to PCR and sequencing (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.209601.116/-/DC1">Supplemental Fig. S2B</ext-link>). In order to resolve this inherent problem with very long UMIs, we modified the network-based methods so that edges joined nodes with an edit distance less than or equal to 2. This considerably decreased the number of networks without any initial UMIs and improved the accuracy of the network-based methods for very long UMI sequences (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.209601.116/-/DC1">Supplemental Fig. S2A,B</ext-link>).</p>
      <fig id="SMITHGR209601F2" orientation="portrait" position="float">
        <label>Figure 2.</label>
        <caption>
          <p>Comparison of methods with simulated data. In each panel, all but one of the simulation parameters are held constant, with the remaining parameter varied as shown on the <italic>x</italic>-axis. (<italic>A</italic>) UMI length. (<italic>B</italic>) Sequencing depth. (<italic>C</italic>) Sequencing error rate. The <italic>left</italic> plots show the accuracy of quantification, presented as the log<sub>2</sub>-transformed normalized difference between the estimate and ground truth. The <italic>right</italic> plots show the coefficient of variation (standard deviation/mean). The dashed red line represents the value used for this parameter in all other simulations. The dashed gray line represents perfect accuracy. The <italic>unique</italic> and <italic>percentile</italic> methods give identical results with the parameters shown here and are hence overplotted.</p>
        </caption>
        <graphic xlink:href="491f02"/>
      </fig>
      <p>Increased sequencing error rate leads to an exponential overestimation for <italic>unique</italic> and <italic>percentile</italic> (<xref ref-type="fig" rid="SMITHGR209601F2">Fig. 2</xref>C), with a 1.3-fold overestimation observed with an error rate of 0.01, compared to &lt;1.05-fold for the network based methods. Increasing the rate of errors during the PCR step had a similar impact (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.209601.116/-/DC1">Supplemental Fig. S2C</ext-link>). However, this was only observed when the rate of DNA polymerase errors was simulated as &gt;0.001, considerably higher than reported error rates for even nonrecombinant <italic>Taq</italic> DNA polymerase (<xref rid="SMITHGR209601C22" ref-type="bibr">Rittié and Perbal 2008</xref>; <xref rid="SMITHGR209601C33" ref-type="bibr">Whalen et al. 2016</xref>), confirming sequencing errors are likely to be the primary source of UMI errors. Increasing the number of PCR cycles or modifying the amplification bias had little impact on the relative accuracy of the methods (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.209601.116/-/DC1">Supplemental Fig. S2D,E</ext-link>). Increasing the number of initial UMIs reduced the accuracy of the network-based methods; however, even with 100 initial 8-bp UMIs at a single locus, the network methods remained the most accurate (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.209601.116/-/DC1">Supplemental Fig. S2F</ext-link>).</p>
      <p>Although the network methods performed very similarly, <italic>directional</italic> consistently yielded more accurate and less variable estimates. For example, when the sequencing depth was increased to 400 reads, the average estimates were 19.92, 19.94, and 19.99 (truth = 20), respectively, for <italic>cluster</italic>, <italic>adjacency</italic>, and <italic>directional</italic> methods, and the CVs were 0.0167, 0.0144, and 0.0099. We observed no difference between <italic>percentile</italic> and <italic>unique</italic> under most conditions tested. Increasing the number of reads sequenced per initial UMI, we were able to see an improvement in accuracy for <italic>percentile</italic> relative to <italic>unique</italic> when sequencing error rates are between 1 × 10<sup>−3</sup> and 1 × 10<sup>−5</sup>; however, even under this specific parameterization, the network-based methods are more accurate (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.209601.116/-/DC1">Supplemental Fig. S2G</ext-link>).</p>
      <p>In summary, under simulation conditions, the <italic>directional</italic> method outperforms all other methods; however, <italic>adjacency</italic> and <italic>cluster</italic> perform equally well under simulation conditions that are expected to reflect a well-designed and well-executed experiment.</p>
    </sec>
    <sec id="s1c">
      <title>Implementation</title>
      <p>To implement our methods within the framework of removing PCR duplicates from BAM alignment files, we developed a command line tool set, UMI-tools, with two commands, <italic>extract</italic> and <italic>dedup</italic>. <italic>extract</italic> takes the UMI from the read sequence contained in a FASTQ read sequence and appends it to the read identifier so it is retained in the downstream alignment. <italic>extract</italic> expects the UMIs to be contained at the same location in each read. Where this is not the case, e.g., with sequencing techniques such as inDrop-seq (<xref rid="SMITHGR209601C11" ref-type="bibr">Klein et al. 2015</xref>), the user will need to extract the UMI sequence from the read sequence and append it to the read identifier. <italic>dedup</italic> takes an alignment BAM file, identifies reads with the same genomic coordinates as potential PCR duplicates, and removes PCR duplicates using the UMI sequence according to the method chosen. Time requirements for running <italic>dedup</italic> depend on number of input reads, length of UMI, and level of duplication. Memory requirements depend on the number of output reads. On a desktop with a Xeon E3-1246 CPU, it takes ∼220 sec and ∼100 MB RAM to process a 32-million-read single-end input file with 5-bp UMIs to ∼700,000 unique alignments. Inputs with longer UMIs may take significantly longer.</p>
    </sec>
    <sec id="s1d">
      <title>Comparing methods with iCLIP data</title>
      <p>We next sought to examine the effect of these methods on real data, starting with the previously mentioned iCLIP data, which includes 3–6 replicates for nine proteins (<xref rid="SMITHGR209601C20" ref-type="bibr">Müller-McNicoll et al. 2016</xref>). For replicate 1, the distribution of the average edit distance between UMIs present at each genomic locus showed enrichment for single-edit distance relative to a null distribution from random sampling, taking into account the genome-wide distribution of UMIs (<xref ref-type="fig" rid="SMITHGR209601F3">Fig. 3</xref>A). For all samples, application of the <italic>directional</italic> method resulted in an edit distance distribution resembling the null, whereas using the <italic>percentile</italic> method made little or no difference. The same was also true of other replicates of this data set or other data sets (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.209601.116/-/DC1">Supplemental Fig. S2</ext-link>). In some cases, a residual enrichment of positions with an average edit distance of 2 was observed, but this was also reduced in most cases.</p>
      <fig id="SMITHGR209601F3" orientation="portrait" position="float">
        <label>Figure 3.</label>
        <caption>
          <p>UMI-tools improves reproducibility between iCLIP replicates. (<italic>A</italic>) Average edit distances between UMIs with the same alignment coordinates. Genomic positions with a single UMI are not shown. (Null) Null expectation from random sampling of UMIs, taking into account the genome-wide distribution of UMIs. Only the first replicate of the data set is shown for each pull down. (<italic>B</italic>) iCLIP reproducibility as represented by the percentage of positions with more than two tags also cross-linked in at least one of two other replicates. (<italic>C</italic>) Spearman's rank correlation between the numbers of significant tags in each exon.</p>
        </caption>
        <graphic xlink:href="491f03"/>
      </fig>
      <p>We reasoned that if the <italic>directional</italic> method removed PCR duplicates more accurately, the reproducibility between replicates should be improved. To test this, we turned to a previously defined measure of iCLIP reproducibility (<xref rid="SMITHGR209601C12" ref-type="bibr">König et al. 2010</xref>). Briefly, we identified in each sample the bases with two or more tags mapping at that position and asked what percentage had a tag present in one or more other replicates for that pull down. We limited the analysis to the first three replicates for each protein. In each case, after de-duplication with the <italic>directional</italic> method, bases with two or more tags were more reproducible (<xref ref-type="fig" rid="SMITHGR209601F3">Fig. 3</xref>B), with the difference being very large in some cases (e.g., 21% vs. 59% of bases reproducible for SRSF7 replicate 1). In contrast, the <italic>percentile</italic> method was little different from <italic>unique</italic> (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.209601.116/-/DC1">Supplemental Fig. S3</ext-link>).</p>
      <p>In order to measure reproducibility of their data, <xref rid="SMITHGR209601C20" ref-type="bibr">Müller-McNicoll et al. (2016)</xref> measured the Spearman's rank correlation between the numbers of significant tags in each exon across the genome. We repeated this calculation with data processed, using either the <italic>unique</italic> or <italic>directional</italic> method, and compared the average Spearman's correlation between each sample and other replicates of the same pull down. In all cases, we see an improvement in the correlation between replicates of the same pull down when data are processed using the <italic>directional</italic> method (<xref ref-type="fig" rid="SMITHGR209601F3">Fig. 3</xref>C). As expected, the degree of improvement for a particular sample was correlated with the enrichment of positions with an average edit distance of 1 (<italic>R</italic><sup>2</sup>= 0.4) (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.209601.116/-/DC1">Supplemental Fig. S3</ext-link>). Thus our method substantially improves the reproducibility of replicates in this iCLIP experiment.</p>
    </sec>
    <sec id="s1e">
      <title>Comparing methods with single-cell RNA-seq data</title>
      <p>To further demonstrate the utility of our network-based method, we applied it to two differentiation single-cell RNA-seq data sets: the first reported use of UMIs in a single-cell RNA-seq experiment seeking to describe a developmental pathway (<xref rid="SMITHGR209601C29" ref-type="bibr">Soumillon et al. 2014</xref>), referred to here as SCRB-seq, and a recently reported single-cell RNA-seq utilizing droplet-barcoding (<xref rid="SMITHGR209601C11" ref-type="bibr">Klein et al. 2015</xref>), referred to here as inDrop-seq. As before, network-based methods show a marked improvement in the distribution of edit distances over the <italic>percentile</italic> method and the <italic>unique</italic> method (<xref ref-type="fig" rid="SMITHGR209601F4">Fig. 4</xref>A). Improvements are generally less pronounced than observed with the iCLIP data, likely due to a lower maximum read depth in single-cell RNA-seq. To demonstrate that this improvement in the edit distance led to an improved accuracy in transcript abundance estimates, we used the ERCC spike-ins. The naïve use of UMIs to identify PCR duplicates with the <italic>unique</italic> method improved the per-cell correlation between ERCC concentration and counts, compared to quantification without considering PCR duplicates (median coefficients were 0.86 and 0.89, respectively). As expected, the correlation was further improved using the <italic>directional</italic> method (median coefficient = 0.91) (<xref ref-type="fig" rid="SMITHGR209601F4">Fig. 4</xref>B).</p>
      <fig id="SMITHGR209601F4" orientation="portrait" position="float">
        <label>Figure 4.</label>
        <caption>
          <p>UMI-tools improves accuracy and clustering in single-cell RNA-seq. (<italic>A</italic>) Average edit distances between UMIs with the same alignment coordinates following removal of PCR duplicates using the methods indicated on the <italic>x</italic>-axis. Genomic positions with a single UMI are not shown. (Null) Null expectation from random sampling of UMIs, taking into account the genome-wide distribution of UMIs; (<italic>top</italic>) SCRB-seq; (<italic>bottom</italic>) inDrop-seq. (<italic>B</italic>) Distribution of Pearson correlation coefficients between log ERCC concentration and log counts for raw reads (UMIs ignored) and <italic>unique</italic> and <italic>directional</italic> methods. (<italic>C</italic>,<italic>D</italic>) Hierarchical clustering based on the gene expression estimates obtained using <italic>unique</italic> and <italic>directional</italic>. Color bars represent differentiation stage. (<italic>C</italic>) SCRB-seq. (<italic>D</italic>) inDrop-DSeq. The red arrow indicates mES cells clustering with Day 4 cells.</p>
        </caption>
        <graphic xlink:href="491f04"/>
      </fig>
      <p>We applied hierarchical clustering to the SCRB-seq gene expression data using the <italic>unique</italic> method and observed the Day 0 and Day 14 cells separated relatively well (<xref ref-type="fig" rid="SMITHGR209601F4">Fig. 4</xref>C). However, seven cells clustered with cells of the wrong time point, reflecting either a failure to commit to differentiation or misclassification event due to noise in the expression estimates. With the <italic>directional</italic> method, this was reduced to five cells, suggesting that failure to account for UMI errors can lead to misclassification in single-cell RNA-seq. Applying hierarchical clustering to the inDrop-seq gene expression estimates, we observed that 44/2717 (1.6%) of cells clustered with cells from another time point when using the <italic>unique</italic> method. Biological variation in the progression of differentiation may explain Day 2, Day 4, and Day 7 misclassification events. However, 19/44 events involved undifferentiated mES cells, suggesting these misclassification events were the result of low-accuracy quantification estimates (<xref ref-type="fig" rid="SMITHGR209601F4">Fig. 4</xref>D). With the application of the <italic>directional</italic> method, the rate of misclassification was reduced to 0.9%, and strikingly, all the mES cells were correctly classified. These results indicate that application of the <italic>directional</italic> method improves the quantification estimates and can improve classification by hierarchical clustering.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s2">
    <title>Discussion</title>
    <p>UMIs can be utilized across a broad range of sequencing techniques; however, bioinformatic methods to leverage the information from UMIs have yet to be standardized. In particular, others have noted the problem of UMI errors, but the solutions applied are varied (<xref rid="SMITHGR209601C8" ref-type="bibr">Islam et al. 2014</xref>; <xref rid="SMITHGR209601C3" ref-type="bibr">Bose et al. 2015</xref>). The <italic>adjacency</italic> and <italic>directional</italic> methods we set out here are, to our knowledge, novel approaches to remove PCR duplicates when using UMIs. By comparing these methods to previous methods with simulated data, we observed that our methods are superior at estimating the true number of unique molecules. Of the three network-based methods, <italic>directional</italic> was the most robust over the simulation conditions and should be preferred. We note that the performance of all network-based methods will decrease as the number of aligned reads at a genomic locus approaches the number of possible UMIs; however, this is an intrinsic issue with UMIs and not one that can be solved computationally post-sequencing. For this reason, we recommend all experiments to use UMIs of at least 8 bp in length and to use longer UMIs for higher sequencing depth experiments. The simulations also indicated that very long UMIs actually decrease the accuracy of quantification when not accounting for UMI errors, since the UMIs are more likely to accumulate errors. For experiments utilizing long UMIs, network-based methods therefore show an even greater performance relative to the <italic>unique</italic> method. The simulations provide an insight into the impact on quantification accuracy and indicate that application of an error-aware method is even more important with higher sequencing depth. This is perhaps most pertinent for single-cell RNA-seq, as cost decreases continue to drive higher sequencing depths.</p>
    <p>The analysis of iCLIP and single-cell RNA-seq and data sets established that UMI errors are present in all of the data sets tested and that quantification accuracy could therefore be improved by modeling these errors during the de-duplication step. The frequency of UMI indels was far less than UMI errors, suggesting only minimal gains would be achieved by also considering UMI indels. We observed an improved distribution of edit distances for all samples when using network-based methods to detect PCR duplicates, although theoretical reasoning and empirical evidence suggests that the extent of the errors depends on the quality of the sequencing base calls and the sequencing depth, as confirmed by the simulations.</p>
    <p>Modeling UMI errors yielded improvements in single-cell RNA-seq sample clustering, demonstrating the value of considering UMI errors. Because iCLIP aims to identify specific bases bound by RNA binding proteins, data sets have a high level of PCR duplication. The effects of UMI errors are therefore particularly strong, creating the impression of reproducible cross-linking sites within a replicate but not between replicates; for example, only 21% of positions with two or more tags in SRSF7 replicate 1 had any tags in replicates 2 or 3 when naïve de-duplication was used, but this increased to 59% when the <italic>directional</italic> method was used (<xref ref-type="fig" rid="SMITHGR209601F3">Fig. 3</xref>B). Application of the network-based methods increases the correlation between replicates in all cases, with larger differences in samples in which PCR duplication was higher. From the results of the simulation and real data analyses, we recommend the use of an error-aware method to identify PCR duplicates whenever UMIs are used.</p>
    <p>We provide our methods within the open-source UMI-tools software (<uri xlink:href="https://GitHub.com/CGATOxford/UMI-tools">https://GitHub.com/CGATOxford/UMI-tools</uri>) (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.209601.116/-/DC1">Supplemental File 1</ext-link>), which can easily be integrated into existing pipelines for analysis of sequencing techniques utilizing UMIs.</p>
  </sec>
  <sec sec-type="methods" id="s3">
    <title>Methods</title>
    <sec id="s3a">
      <title>Simulation</title>
      <p>To simulate the effects of errors on UMI counts, an initial number of UMIs were generated at random, with a uniform random probability of amplification [0.8–1.0] assigned to each initial UMI. To simulate a PCR cycle, each UMI was selected in turn and duplicated according to its probability of amplification. Polymerase errors were also added randomly at this stage, and any resulting new UMI sequences assigned new probabilities of amplification. Following multiple PCR cycles, a defined number of UMIs were randomly sampled to model the sampling of reads during sequencing (“sequencing depth”), and sequencing errors were introduced at a given probability, with all errors (e.g., A → T, C → G) being equally likely. The number of true UMIs within the sampled UMIs was then estimated from the final pool of UMIs using each method. To test the performance of the methods under a variety of simulation parameters, each parameter was varied in turn. The following values are the range of the parameter values tested with the value used for all other simulations in parentheses: sequencing depth 10–400 (100), number of initial UMIs 10–100 (20), UMI length 6–16 (8), DNA polymerase error rate 1 × 10<sup>−3</sup>–1 × 10<sup>−7</sup> (1 × 10<sup>−5</sup>), sequencing error rate 1 × 10<sup>−1</sup>–1 × 10<sup>−5</sup> (1 × 10<sup>−3</sup>), number of PCR cycles 4–12 (6), and minimum amplification probability 0.1–1 (0.8). The maximum amplification probability was set at 1, with the probability of amplification for each UMI drawn from a uniform distribution.</p>
    </sec>
    <sec id="s3b">
      <title>Real data</title>
      <p>Re-analysis of the iCLIP and single-cell RNA-seq data was performed with in-house pipelines following the methods described in the original publication with exceptions as highlighted below. Pipelines are available at <uri xlink:href="https://GitHub.com/CGATOxford/UMI-tools_pipelines">https://GitHub.com/CGATOxford/UMI-tools_pipelines</uri> and as <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.209601.116/-/DC1">Supplemental File 2</ext-link>.</p>
      <sec id="s3b1">
        <title>iCLIP</title>
        <p>Raw sequence was obtained from the European Nucleotide Archive (accessions SRP059277 and ERR039854) (<xref rid="SMITHGR209601C30" ref-type="bibr">Tollervey et al. 2011</xref>; <xref rid="SMITHGR209601C20" ref-type="bibr">Müller-McNicoll et al. 2016</xref>). Raw sequences were processed to move the UMI sequences to the read name using “umi_tools extract”. Sample barcodes were verified and removed, and the adapter sequence was removed from the 3′ end of reads using the reaper tool from the Kraken package (version 15-065) (<xref rid="SMITHGR209601C5" ref-type="bibr">Davis et al. 2013</xref>) with parameters “-3p-head-to-tail 2 -3p-prefix 6/2/1”. Reads were mapped to the same genome as the original publication (mm9 for SRSF data set, hg19 for the TDP43 data set) using Bowtie version v1.1.2 (<xref rid="SMITHGR209601C14" ref-type="bibr">Langmead et al. 2009</xref>) with the same parameters as the original publications (-v 2 -m 10 -a).</p>
        <p>We measured the rate at which UMIs might represent indel mutations by noting that an indel in the UMI sequence would cause the final base of the presumed UMI to match the genomic base at position −1 relative to the mapping location of the read. Thus, we examined each UMI at a particular position and tested for the presence of a UMI that would correspond to a 1-bp deletion existing at the following base. We compared this to the situation when the UMIs at the following base were randomized, respecting the number of UMIs at the position and the genome-wide usage of each UMI. Enrichment was defined as the count at the unrandomized positions compared to the count at the randomized positions. We calculated this metric for one replicate of each pull down from SRP059277. See the <italic>Examining_indels</italic> notebook in the <italic>UMI-tools_pipelines</italic> repository (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.209601.116/-/DC1">Supplemental File 2</ext-link>).</p>
        <p>Mapped reads were de-duplicated using “umi_tools dedup” using each of the possible methods and edit distance distribution produced using the “--output-stats” option. For the <italic>cluster</italic> method, only the “--further-stats” option was used to output statistics on the distribution of network topology types.</p>
        <p>Significant bases were produced by comparing tag count height at each position compared to randomized profiles (<xref rid="SMITHGR209601C12" ref-type="bibr">König et al. 2010</xref>), and bases with FDR &lt; 0.05 retained.</p>
        <p>Coverage over exons was calculated by collapsing Ensembl 67 transcripts. Where exons overlapped, they were restricted to their intersection, and the number of reads mapped to significant bases were counted for each exon. Exons that contained no tags in any sample were removed (<xref rid="SMITHGR209601C12" ref-type="bibr">König et al. 2010</xref>). Spearman's ρ between all pairwise combinations of replicates of pull downs for the same protein were calculated and averaged for each replicate.</p>
        <p>Reproducibility between replicates was calculated as per <xref rid="SMITHGR209601C12" ref-type="bibr">König et al. (2010)</xref>. Bases with a depth greater than two were identified in the sample in question, and then the fraction of these bases that had one or more tags in other replicates was calculated.</p>
      </sec>
      <sec id="s3b2">
        <title>Single-cell RNA-seq</title>
        <p>For both data sets, raw data was downloaded from Gene Expression Omnibus (<uri xlink:href="http://www.ncbi.nlm.nih.gov/geo">http://www.ncbi.nlm.nih.gov/geo</uri>). For the SCRB-seq data (GSE53638) (<xref rid="SMITHGR209601C29" ref-type="bibr">Soumillon et al. 2014</xref>), a single Day 0 (SRR1058003) and Day 14 (SRR1058023) sample were obtained. For the inDrop data (GSE65525) (<xref rid="SMITHGR209601C11" ref-type="bibr">Klein et al. 2015</xref>), the mouse ES cells sample 1 (SRR1784310), mouse ES cells LIF-, 2 d (SRR1784313), mouse ES cells LIF-, 4 d (SRR1784314), and mouse ES cells LIF-, 7 d (SRR1784315) samples were obtained. FASTQ files were extracted using the SRA toolkit. The sequence read filtering, preparation, and alignment differed for the two data sets. In both cases, one of the paired end reads contained adapter barcodes and UMI, and the other read pair contained sequence for alignment. In addition, with the inDrop data, the position of the UMI within the read varied depending on the length of the cell barcode. For this reason, for both data sets, the UMIs had to be extracted from the reads with bespoke code rather than using UMI-tools <italic>extract</italic>.</p>
        <p>For SCRB-seq samples, the UMI was extracted from read 2 and appended onto the read identifier of read 1 to generate a single-end FASTQ. Reads were filtered out if any of the following conditions were not met: Phred sequence quality of all cell barcode bases ≥10 and all UMI bases ≥30 and cell barcode matched expected cell barcodes. A reference transcriptome was built comprising all human protein-coding genes (Ensembl v75, hg19) and the ERCC spike-ins. Because expression quantification was being performed at the gene level, overlapping transcripts from the same gene were merged so that each gene contained a single transcript covering all exons from all transcripts. Reads were aligned to the reference transcriptome using BWA Aln (<xref rid="SMITHGR209601C16" ref-type="bibr">Li and Durbin 2009</xref>) with the following parameters: “<italic>-l 24 –k 2</italic>” to set seed length to 24 bp, and mismatches allowed in the seed to two.</p>
        <p>For inDrop samples, the cell barcode and UMI were extracted from read 1, and read 2 was written out to a single-end FASTQ file with the cell barcode incorporated into the file name and the UMI appended to the read identifier. Only reads containing the adapter sequence (allowing two mismatches) were retained. For each sample, only reads containing one of the <italic>n</italic> most abundant cell barcodes were retained, where <italic>n</italic> was the number of cells in a given sample. The resulting single-end reads were filtered using Trimmomatic v0.32 (<xref rid="SMITHGR209601C2" ref-type="bibr">Bolger et al. 2014</xref>) with the following options—“<italic>LEADING:28 SLIDINGWINDOW:4:20 MINLEN:19</italic>”—to remove bases with Phred quality scores below 28 from the 5′ end, scan the reads in 4-bp sliding windows and trim when average quality score falls below 20, and retain all reads at least 19 bp in length following trimming. Our alignment procedure is a deviation from the method used by <xref rid="SMITHGR209601C11" ref-type="bibr">Klein et al. (2015)</xref>, which involved alignment of reads to a reference transcriptome containing all transcripts (e.g., not collapsed into one gene model), reporting up to 200 alignments per read, and dealing with multimapping alignments in a downstream step. As this method was not compatible with our de-duplication method, we took a simpler approach. A reference transcriptome was built comprising all mouse protein-coding genes (Ensembl v78, mm10) plus ERCC spike-ins. Because expression quantification was being performed at the gene level, overlapping transcripts from the same gene were merged so that each gene contained a single transcript covering all exons from all transcripts. Reads were aligned to the reference transcriptome with Bowtie v1.1.2 (<xref rid="SMITHGR209601C14" ref-type="bibr">Langmead et al. 2009</xref>) with the following options—“<italic>-n1 -l 15 -M 1 --best --strata</italic>”—to allow one mismatch, set seed length to 15 bp, and report only one alignment where multiple “best” alignments were found. The seed length and mismatch parameters were the same as the <xref rid="SMITHGR209601C11" ref-type="bibr">Klein et al. (2015)</xref> alignment method.</p>
        <p>Following alignment, de-duplication was performed with UMI-tools dedup with <italic>unique</italic>, <italic>percentile</italic>, and <italic>directional</italic> used in turn. Both data sets were generated with sequencing methods that generate reads with different alignment coordinates from the same initial DNA fragment (SCRB-seq, CEL-Seq). De-duplication was therefore performed with the “<italic>--per-contig</italic>” option so that the UMI and the contig (in this case, gene) rather than the exact alignment coordinates were used to identify duplicate reads. The “--stats-output” and “--further-stats” options were used to generate summary statistics for the alignment files before and after de-duplication. Gene expression was quantified by counting the number of remaining reads per gene following de-duplication.</p>
      </sec>
      <sec id="s3b3">
        <title>Exploratory gene expression analysis</title>
        <p>PCA was performed in R (<xref rid="SMITHGR209601C21" ref-type="bibr">R Core Team 2015</xref>) using the <italic>prcomp</italic> function<italic>.</italic> Hierarchical clustering was performed in R using the <italic>hclust</italic> function, and heatmaps were generated using the <italic>heatmap.2</italic> function from the gplots package. Clustering was performed using the distance measure (1 − Spearman's correlation coefficient), and clustering method “ward.D2”. Because many genes show very low expression in the SCRB-seq data, the top 100 most highly expressed genes were selected for clustering.</p>
      </sec>
    </sec>
    <sec id="s3c">
      <title>Software availability</title>
      <p>UMI-tools is available from PyPI (package: umi_tools) and conda (channel: <uri xlink:href="https://conda.anaconda.org/toms">https://conda.anaconda.org/toms</uri>; package: umi_tools) or GitHub (<uri xlink:href="https://GitHub.com/CGATOxford/UMI-tools">https://GitHub.com/CGATOxford/UMI-tools</uri>). Analyses conducted in this manuscript used version 0.2.6 (archived on Zenodo as <uri xlink:href="https://doi.org/10.5281/Zenodo.165403">https://doi.org/10.5281/Zenodo.165403</uri> and in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.209601.116/-/DC1">Supplemental File 1</ext-link>). Analyses were performed using automated Python pipelines. iCLIP specific analyses were completed using the iCLIPlib Python library (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.209601.116/-/DC1">Supplemental File 2</ext-link>; I Sudbery, in prep.). Figures were created by Python pipelines or in Jupyter notebooks using the ggplot2 package (<xref rid="SMITHGR209601C34" ref-type="bibr">Wickham 2009</xref>) unless otherwise noted. All pipelines, notebooks, and other code, along with configuration files used, are available from the GitHub repository (<uri xlink:href="https://GitHub.com/CGATOxford/UMI-tools_pipelines">https://GitHub.com/CGATOxford/UMI-tools_pipelines</uri>), archived on Zenodo (<uri xlink:href="https://doi.org/10.5281/zenodo.215974">https://doi.org/10.5281/zenodo.215974</uri>), and in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.209601.116/-/DC1">Supplemental File 2</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplemental Material</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_27_3_491__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_gr.209601.116_Supplementary_Figures.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="x-zip-compressed" xlink:href="supp_gr.209601.116_Supplementary_File1.zip"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="x-zip-compressed" xlink:href="supp_gr.209601.116_Supplementary_File2.zip"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>This research received no specific grant from any funding agency in the public, commercial, or not-for-profit sectors. T.S. and A.H. are supported by a Medical Research Council (MRC) programme grant (G1000902). We thank David Sims and members of CGAT for reviewing the manuscript. We thank the GitHub community for helping us to improve the UMI-tools codebase.</p>
    <p><italic>Author contributions:</italic> T.S. and I.S. conceived the study. I.S. implemented the first iteration of UMI-tools. T.S. implemented further methods and improved the code base. A.H. implemented performance improvements to UMI-tools and advised on software development. T.S. performed the simulation and single-cell RNA-seq analyses. I.S. performed the iCLIP analysis. T.S. and I.S. wrote the original draft of the manuscript. T.S., I.S., and A.H. edited the final draft of the manuscript. I.S. supervised the study.</p>
  </ack>
  <fn-group>
    <fn fn-type="supplementary-material">
      <p>[Supplemental material is available for this article.]</p>
    </fn>
    <fn>
      <p>Article published online before print. Article, supplemental material, and publication date are at <ext-link ext-link-type="uri" xlink:href="http://www.genome.org/cgi/doi/10.1101/gr.209601.116">http://www.genome.org/cgi/doi/10.1101/gr.209601.116</ext-link>.</p>
    </fn>
    <fn>
      <p>Freely available online through the <italic>Genome Research</italic> Open Access option.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="SMITHGR209601C1">
      <mixed-citation publication-type="journal"><string-name><surname>Aird</surname><given-names>D</given-names></string-name>, <string-name><surname>Ross</surname><given-names>MG</given-names></string-name>, <string-name><surname>Chen</surname><given-names>WS</given-names></string-name>, <string-name><surname>Danielsson</surname><given-names>M</given-names></string-name>, <string-name><surname>Fennell</surname><given-names>T</given-names></string-name>, <string-name><surname>Russ</surname><given-names>C</given-names></string-name>, <string-name><surname>Jaffe</surname><given-names>DB</given-names></string-name>, <string-name><surname>Nusbaum</surname><given-names>C</given-names></string-name>, <string-name><surname>Gnirke</surname><given-names>A</given-names></string-name>. <year>2011</year><article-title>Analyzing and minimizing PCR amplification bias in Illumina sequencing libraries</article-title>. <source>Genome Biol</source><volume>12</volume>: <fpage>R18</fpage>.<pub-id pub-id-type="pmid">21338519</pub-id></mixed-citation>
    </ref>
    <ref id="SMITHGR209601C2">
      <mixed-citation publication-type="journal"><string-name><surname>Bolger</surname><given-names>AM</given-names></string-name>, <string-name><surname>Lohse</surname><given-names>M</given-names></string-name>, <string-name><surname>Usadel</surname><given-names>B</given-names></string-name>. <year>2014</year><article-title>Trimmomatic: a flexible trimmer for Illumina sequence data</article-title>. <source>Bioinformatics</source><volume>30</volume>: <fpage>2114</fpage>–<lpage>2120</lpage>.<pub-id pub-id-type="pmid">24695404</pub-id></mixed-citation>
    </ref>
    <ref id="SMITHGR209601C3">
      <mixed-citation publication-type="journal"><string-name><surname>Bose</surname><given-names>S</given-names></string-name>, <string-name><surname>Wan</surname><given-names>Z</given-names></string-name>, <string-name><surname>Carr</surname><given-names>A</given-names></string-name>, <string-name><surname>Rizvi</surname><given-names>AH</given-names></string-name>, <string-name><surname>Vieira</surname><given-names>G</given-names></string-name>, <string-name><surname>Pe'er</surname><given-names>D</given-names></string-name>, <string-name><surname>Sims</surname><given-names>PA</given-names></string-name>. <year>2015</year><article-title>Scalable microfluidics for single cell RNA printing and sequencing</article-title>. <source>Genome Biol</source><volume>16</volume>: <fpage>120</fpage>.<pub-id pub-id-type="pmid">26047807</pub-id></mixed-citation>
    </ref>
    <ref id="SMITHGR209601C4">
      <mixed-citation publication-type="journal"><string-name><surname>Collins</surname><given-names>JE</given-names></string-name>, <string-name><surname>Wali</surname><given-names>N</given-names></string-name>, <string-name><surname>Sealy</surname><given-names>IM</given-names></string-name>, <string-name><surname>Morris</surname><given-names>JA</given-names></string-name>, <string-name><surname>White</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Leonard</surname><given-names>SR</given-names></string-name>, <string-name><surname>Jackson</surname><given-names>DK</given-names></string-name>, <string-name><surname>Jones</surname><given-names>MC</given-names></string-name>, <string-name><surname>Smerdon</surname><given-names>NC</given-names></string-name>, <string-name><surname>Zamora</surname><given-names>J</given-names></string-name>, <etal/><year>2015</year><article-title>High-throughput and quantitative genome-wide messenger RNA sequencing for molecular phenotyping</article-title>. <source>BMC Genomics</source><volume>16</volume>: <fpage>578</fpage>.<pub-id pub-id-type="pmid">26238335</pub-id></mixed-citation>
    </ref>
    <ref id="SMITHGR209601C5">
      <mixed-citation publication-type="journal"><string-name><surname>Davis</surname><given-names>MPA</given-names></string-name>, <string-name><surname>van Dongen</surname><given-names>S</given-names></string-name>, <string-name><surname>Abreu-Goodger</surname><given-names>C</given-names></string-name>, <string-name><surname>Bartonicek</surname><given-names>N</given-names></string-name>, <string-name><surname>Enright</surname><given-names>AJ</given-names></string-name>. <year>2013</year><article-title>Kraken: a set of tools for quality control and analysis of high-throughput sequence data</article-title>. <source>Methods</source><volume>63</volume>: <fpage>41</fpage>–<lpage>49</lpage>.<pub-id pub-id-type="pmid">23816787</pub-id></mixed-citation>
    </ref>
    <ref id="SMITHGR209601C6">
      <mixed-citation publication-type="journal"><string-name><surname>He</surname><given-names>Q</given-names></string-name>, <string-name><surname>Johnston</surname><given-names>J</given-names></string-name>, <string-name><surname>Zeitlinger</surname><given-names>J</given-names></string-name>. <year>2015</year><article-title>ChIP-nexus enables improved detection of <italic>in vivo</italic> transcription factor binding footprints</article-title>. <source>Nat Biotechnol</source><volume>33</volume>: <fpage>395</fpage>–<lpage>401</lpage>.<pub-id pub-id-type="pmid">25751057</pub-id></mixed-citation>
    </ref>
    <ref id="SMITHGR209601C7">
      <mixed-citation publication-type="journal"><string-name><surname>Hug</surname><given-names>H</given-names></string-name>, <string-name><surname>Schuler</surname><given-names>R</given-names></string-name>. <year>2003</year><article-title>Measurement of the number of molecules of a single mRNA species in a complex mRNA preparation</article-title>. <source>J Theor Biol</source><volume>221</volume>: <fpage>615</fpage>–<lpage>624</lpage>.<pub-id pub-id-type="pmid">12713944</pub-id></mixed-citation>
    </ref>
    <ref id="SMITHGR209601C8">
      <mixed-citation publication-type="journal"><string-name><surname>Islam</surname><given-names>S</given-names></string-name>, <string-name><surname>Zeisel</surname><given-names>A</given-names></string-name>, <string-name><surname>Joost</surname><given-names>S</given-names></string-name>, <string-name><surname>La Manno</surname><given-names>G</given-names></string-name>, <string-name><surname>Zajac</surname><given-names>P</given-names></string-name>, <string-name><surname>Kasper</surname><given-names>M</given-names></string-name>, <string-name><surname>Lönnerberg</surname><given-names>P</given-names></string-name>, <string-name><surname>Linnarsson</surname><given-names>S</given-names></string-name>. <year>2014</year><article-title>Quantitative single-cell RNA-seq with unique molecular identifiers</article-title>. <source>Nat Methods</source><volume>11</volume>: <fpage>163</fpage>–<lpage>166</lpage>.<pub-id pub-id-type="pmid">24363023</pub-id></mixed-citation>
    </ref>
    <ref id="SMITHGR209601C9">
      <mixed-citation publication-type="journal"><string-name><surname>Karlsson</surname><given-names>K</given-names></string-name>, <string-name><surname>Sahlin</surname><given-names>E</given-names></string-name>, <string-name><surname>Iwarsson</surname><given-names>E</given-names></string-name>, <string-name><surname>Westgren</surname><given-names>M</given-names></string-name>, <string-name><surname>Nordenskjöld</surname><given-names>M</given-names></string-name>, <string-name><surname>Linnarsson</surname><given-names>S</given-names></string-name>. <year>2015</year><article-title>Amplification-free sequencing of cell-free DNA for prenatal non-invasive diagnosis of chromosomal aberrations</article-title>. <source>Genomics</source><volume>105</volume>: <fpage>150</fpage>–<lpage>158</lpage>.<pub-id pub-id-type="pmid">25543032</pub-id></mixed-citation>
    </ref>
    <ref id="SMITHGR209601C10">
      <mixed-citation publication-type="journal"><string-name><surname>Kivioja</surname><given-names>T</given-names></string-name>, <string-name><surname>Vähärautio</surname><given-names>A</given-names></string-name>, <string-name><surname>Karlsson</surname><given-names>K</given-names></string-name>, <string-name><surname>Bonke</surname><given-names>M</given-names></string-name>, <string-name><surname>Enge</surname><given-names>M</given-names></string-name>, <string-name><surname>Linnarsson</surname><given-names>S</given-names></string-name>, <string-name><surname>Taipale</surname><given-names>J</given-names></string-name>. <year>2012</year><article-title>Counting absolute numbers of molecules using unique molecular identifiers</article-title>. <source>Nat Methods</source><volume>9</volume>: <fpage>72</fpage>–<lpage>74</lpage>.</mixed-citation>
    </ref>
    <ref id="SMITHGR209601C11">
      <mixed-citation publication-type="journal"><string-name><surname>Klein</surname><given-names>AM</given-names></string-name>, <string-name><surname>Mazutis</surname><given-names>L</given-names></string-name>, <string-name><surname>Akartuna</surname><given-names>I</given-names></string-name>, <string-name><surname>Tallapragada</surname><given-names>N</given-names></string-name>, <string-name><surname>Veres</surname><given-names>A</given-names></string-name>, <string-name><surname>Li</surname><given-names>V</given-names></string-name>, <string-name><surname>Peshkin</surname><given-names>L</given-names></string-name>, <string-name><surname>Weitz</surname><given-names>DA</given-names></string-name>, <string-name><surname>Kirschner</surname><given-names>MW</given-names></string-name>. <year>2015</year><article-title>Droplet barcoding for single-cell transcriptomics applied to embryonic stem cells</article-title>. <source>Cell</source><volume>161</volume>: <fpage>1187</fpage>–<lpage>1201</lpage>.<pub-id pub-id-type="pmid">26000487</pub-id></mixed-citation>
    </ref>
    <ref id="SMITHGR209601C12">
      <mixed-citation publication-type="journal"><string-name><surname>König</surname><given-names>J</given-names></string-name>, <string-name><surname>Zarnack</surname><given-names>K</given-names></string-name>, <string-name><surname>Rot</surname><given-names>G</given-names></string-name>, <string-name><surname>Curk</surname><given-names>T</given-names></string-name>, <string-name><surname>Kayikci</surname><given-names>M</given-names></string-name>, <string-name><surname>Zupan</surname><given-names>B</given-names></string-name>, <string-name><surname>Turner</surname><given-names>DJ</given-names></string-name>, <string-name><surname>Luscombe</surname><given-names>NM</given-names></string-name>, <string-name><surname>Ule</surname><given-names>J</given-names></string-name>. <year>2010</year><article-title>iCLIP reveals the function of hnRNP particles in splicing at individual nucleotide resolution</article-title>. <source>Nat Struct Mol Biol</source><volume>17</volume>: <fpage>909</fpage>–<lpage>915</lpage>.<pub-id pub-id-type="pmid">20601959</pub-id></mixed-citation>
    </ref>
    <ref id="SMITHGR209601C14">
      <mixed-citation publication-type="journal"><string-name><surname>Langmead</surname><given-names>B</given-names></string-name>, <string-name><surname>Trapnell</surname><given-names>C</given-names></string-name>, <string-name><surname>Pop</surname><given-names>M</given-names></string-name>, <string-name><surname>Salzberg</surname><given-names>SL</given-names></string-name>. <year>2009</year><article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>. <source>Genome Biol</source><volume>10</volume>: <fpage>R25</fpage>.<pub-id pub-id-type="pmid">19261174</pub-id></mixed-citation>
    </ref>
    <ref id="SMITHGR209601C16">
      <mixed-citation publication-type="journal"><string-name><surname>Li</surname><given-names>H</given-names></string-name>, <string-name><surname>Durbin</surname><given-names>R</given-names></string-name>. <year>2009</year><article-title>Fast and accurate short read alignment with Burrows–Wheeler transform</article-title>. <source>Bioinformatics</source><volume>25</volume>: <fpage>1754</fpage>–<lpage>1760</lpage>.<pub-id pub-id-type="pmid">19451168</pub-id></mixed-citation>
    </ref>
    <ref id="SMITHGR209601C17">
      <mixed-citation publication-type="journal"><string-name><surname>Macosko</surname><given-names>EZ</given-names></string-name>, <string-name><surname>Basu</surname><given-names>A</given-names></string-name>, <string-name><surname>Satija</surname><given-names>R</given-names></string-name>, <string-name><surname>Nemesh</surname><given-names>J</given-names></string-name>, <string-name><surname>Shekhar</surname><given-names>K</given-names></string-name>, <string-name><surname>Goldman</surname><given-names>M</given-names></string-name>, <string-name><surname>Tirosh</surname><given-names>I</given-names></string-name>, <string-name><surname>Bialas</surname><given-names>AR</given-names></string-name>, <string-name><surname>Kamitaki</surname><given-names>N</given-names></string-name>, <string-name><surname>Martersteck</surname><given-names>EM</given-names></string-name>, <etal/><year>2015</year><article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title>. <source>Cell</source><volume>161</volume>: <fpage>1202</fpage>–<lpage>1214</lpage>.<pub-id pub-id-type="pmid">26000488</pub-id></mixed-citation>
    </ref>
    <ref id="SMITHGR209601C18">
      <mixed-citation publication-type="journal"><string-name><surname>Marinier</surname><given-names>E</given-names></string-name>, <string-name><surname>Brown</surname><given-names>DG</given-names></string-name>, <string-name><surname>McConkey</surname><given-names>BJ</given-names></string-name>. <year>2015</year><article-title>Pollux: platform independent error correction of single and mixed genomes</article-title>. <source>BMC Bioinformatics</source><volume>16</volume>: <fpage>10</fpage>.<pub-id pub-id-type="pmid">25592313</pub-id></mixed-citation>
    </ref>
    <ref id="SMITHGR209601C19">
      <mixed-citation publication-type="journal"><string-name><surname>McCloskey</surname><given-names>ML</given-names></string-name>, <string-name><surname>Stöger</surname><given-names>R</given-names></string-name>, <string-name><surname>Hansen</surname><given-names>RS</given-names></string-name>, <string-name><surname>Laird</surname><given-names>CD</given-names></string-name>. <year>2007</year><article-title>Encoding PCR products with batch-stamps and barcodes</article-title>. <source>Biochem Genet</source><volume>45</volume>: <fpage>761</fpage>–<lpage>767</lpage>.<pub-id pub-id-type="pmid">17955361</pub-id></mixed-citation>
    </ref>
    <ref id="SMITHGR209601C20">
      <mixed-citation publication-type="journal"><string-name><surname>Müller-McNicoll</surname><given-names>M</given-names></string-name>, <string-name><surname>Botti</surname><given-names>V</given-names></string-name>, <string-name><surname>de Jesus Domingues</surname><given-names>AM</given-names></string-name>, <string-name><surname>Brandl</surname><given-names>H</given-names></string-name>, <string-name><surname>Schwich</surname><given-names>OD</given-names></string-name>, <string-name><surname>Steiner</surname><given-names>MC</given-names></string-name>, <string-name><surname>Curk</surname><given-names>T</given-names></string-name>, <string-name><surname>Poser</surname><given-names>I</given-names></string-name>, <string-name><surname>Zarnack</surname><given-names>K</given-names></string-name>, <string-name><surname>Neugebauer</surname><given-names>KM</given-names></string-name>. <year>2016</year><article-title>SR proteins are NXF1 adaptors that link alternative RNA processing to mRNA export</article-title>. <source>Genes Dev</source><volume>30</volume>: <fpage>553</fpage>–<lpage>566</lpage>.<pub-id pub-id-type="pmid">26944680</pub-id></mixed-citation>
    </ref>
    <ref id="SMITHGR209601C21">
      <mixed-citation publication-type="book"><collab>R Core Team</collab>. <year>2015</year><source>R: a language and environment for statistical computing</source>. <publisher-name>R Foundation for Statistical Computing</publisher-name>, <publisher-loc>Vienna, Austria</publisher-loc><comment><uri xlink:href="http://www.R-project.org/">http://www.R-project.org/</uri></comment>.</mixed-citation>
    </ref>
    <ref id="SMITHGR209601C22">
      <mixed-citation publication-type="journal"><string-name><surname>Rittié</surname><given-names>L</given-names></string-name>, <string-name><surname>Perbal</surname><given-names>B</given-names></string-name>. <year>2008</year><article-title>Enzymes used in molecular biology: a useful guide</article-title>. <source>J Cell Commun Signal</source><volume>2</volume>: <fpage>25</fpage>–<lpage>45</lpage>.<pub-id pub-id-type="pmid">18766469</pub-id></mixed-citation>
    </ref>
    <ref id="SMITHGR209601C23">
      <mixed-citation publication-type="journal"><string-name><surname>Schirmer</surname><given-names>M</given-names></string-name>, <string-name><surname>Ijaz</surname><given-names>UZ</given-names></string-name>, <string-name><surname>D'Amore</surname><given-names>R</given-names></string-name>, <string-name><surname>Hall</surname><given-names>N</given-names></string-name>, <string-name><surname>Sloan</surname><given-names>WT</given-names></string-name>, <string-name><surname>Quince</surname><given-names>C</given-names></string-name>. <year>2015</year><article-title>Insight into biases and sequencing errors for amplicon sequencing with the Illumina MiSeq platform</article-title>. <source>Nucleic Acids Res</source><volume>43</volume>: <fpage>e37</fpage>.<pub-id pub-id-type="pmid">25586220</pub-id></mixed-citation>
    </ref>
    <ref id="SMITHGR209601C24">
      <mixed-citation publication-type="journal"><string-name><surname>Schirmer</surname><given-names>M</given-names></string-name>, <string-name><surname>D'Amore</surname><given-names>R</given-names></string-name>, <string-name><surname>Ijaz</surname><given-names>UZ</given-names></string-name>, <string-name><surname>Hall</surname><given-names>N</given-names></string-name>, <string-name><surname>Quince</surname><given-names>C</given-names></string-name>. <year>2016</year><article-title>Illumina error profiles: resolving fine-scale variation in metagenomic sequencing data</article-title>. <source>BMC Bioinformatics</source><volume>17</volume>: <fpage>125</fpage>.<pub-id pub-id-type="pmid">26968756</pub-id></mixed-citation>
    </ref>
    <ref id="SMITHGR209601C25">
      <mixed-citation publication-type="journal"><string-name><surname>Schloss</surname><given-names>PD</given-names></string-name>, <string-name><surname>Gevers</surname><given-names>D</given-names></string-name>, <string-name><surname>Westcott</surname><given-names>SL</given-names></string-name>. <year>2011</year><article-title>Reducing the effects of PCR amplification and sequencing artifacts on 16s rRNA-based studies</article-title>. <source>PLoS One</source><volume>6</volume>: <fpage>e27310</fpage>.<pub-id pub-id-type="pmid">22194782</pub-id></mixed-citation>
    </ref>
    <ref id="SMITHGR209601C26">
      <mixed-citation publication-type="journal"><string-name><surname>Schmitt</surname><given-names>MW</given-names></string-name>, <string-name><surname>Kennedy</surname><given-names>SR</given-names></string-name>, <string-name><surname>Salk</surname><given-names>JJ</given-names></string-name>, <string-name><surname>Fox</surname><given-names>EJ</given-names></string-name>, <string-name><surname>Hiatt</surname><given-names>JB</given-names></string-name>, <string-name><surname>Loeb</surname><given-names>LA</given-names></string-name>. <year>2012</year><article-title>Detection of ultra-rare mutations by next-generation sequencing</article-title>. <source>Proc Natl Acad Sci</source><volume>109</volume>: <fpage>14508</fpage>–<lpage>14513</lpage>.<pub-id pub-id-type="pmid">22853953</pub-id></mixed-citation>
    </ref>
    <ref id="SMITHGR209601C27">
      <mixed-citation publication-type="journal"><string-name><surname>Shiroguchi</surname><given-names>K</given-names></string-name>, <string-name><surname>Jia</surname><given-names>TZ</given-names></string-name>, <string-name><surname>Sims</surname><given-names>PA</given-names></string-name>, <string-name><surname>Xie</surname><given-names>XS</given-names></string-name>. <year>2012</year><article-title>Digital RNA sequencing minimizes sequence-dependent bias and amplification noise with optimized single-molecule barcodes</article-title>. <source>Proc Natl Acad Sci</source><volume>109</volume>: <fpage>1347</fpage>–<lpage>1352</lpage>.<pub-id pub-id-type="pmid">22232676</pub-id></mixed-citation>
    </ref>
    <ref id="SMITHGR209601C28">
      <mixed-citation publication-type="journal"><string-name><surname>Sims</surname><given-names>D</given-names></string-name>, <string-name><surname>Sudbery</surname><given-names>I</given-names></string-name>, <string-name><surname>Ilott</surname><given-names>NE</given-names></string-name>, <string-name><surname>Heger</surname><given-names>A</given-names></string-name>, <string-name><surname>Ponting</surname><given-names>CP</given-names></string-name>. <year>2014</year><article-title>Sequencing depth and coverage: key considerations in genomic analyses</article-title>. <source>Nat Rev Genet</source><volume>15</volume>: <fpage>121</fpage>–<lpage>132</lpage>.<pub-id pub-id-type="pmid">24434847</pub-id></mixed-citation>
    </ref>
    <ref id="SMITHGR209601C29">
      <mixed-citation publication-type="journal"><string-name><surname>Soumillon</surname><given-names>M</given-names></string-name>, <string-name><surname>Cacchiarelli</surname><given-names>D</given-names></string-name>, <string-name><surname>Semrau</surname><given-names>S</given-names></string-name>, <string-name><surname>van Oudenaarden</surname><given-names>A</given-names></string-name>, <string-name><surname>Mikkelsen</surname><given-names>TS</given-names></string-name>. <year>2014</year><article-title>Characterization of directed differentiation by high-throughput single-cell RNA-Seq</article-title>. <source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/003236</pub-id>.</mixed-citation>
    </ref>
    <ref id="SMITHGR209601C30">
      <mixed-citation publication-type="journal"><string-name><surname>Tollervey</surname><given-names>JR</given-names></string-name>, <string-name><surname>Curk</surname><given-names>T</given-names></string-name>, <string-name><surname>Rogelj</surname><given-names>B</given-names></string-name>, <string-name><surname>Briese</surname><given-names>M</given-names></string-name>, <string-name><surname>Cereda</surname><given-names>M</given-names></string-name>, <string-name><surname>Kayikci</surname><given-names>M</given-names></string-name>, <string-name><surname>Hortobágyi</surname><given-names>T</given-names></string-name>, <string-name><surname>Nishimura</surname><given-names>AL</given-names></string-name>, <string-name><surname>Župunski</surname><given-names>V</given-names></string-name>, <string-name><surname>Patani</surname><given-names>R</given-names></string-name>, <etal/><year>2011</year><article-title>Characterising the RNA targets and position-dependent splicing regulation by TDP-43; implications for neurodegenerative diseases</article-title>. <source>Nat Neurosci</source><volume>14</volume>: <fpage>452</fpage>–<lpage>458</lpage>.<pub-id pub-id-type="pmid">21358640</pub-id></mixed-citation>
    </ref>
    <ref id="SMITHGR209601C31">
      <mixed-citation publication-type="journal"><string-name><surname>Vollmers</surname><given-names>C</given-names></string-name>, <string-name><surname>Sit</surname><given-names>RV</given-names></string-name>, <string-name><surname>Weinstein</surname><given-names>JA</given-names></string-name>, <string-name><surname>Dekker</surname><given-names>CL</given-names></string-name>, <string-name><surname>Quake</surname><given-names>SR</given-names></string-name>. <year>2013</year><article-title>Genetic measurement of memory B-cell recall using antibody repertoire sequencing</article-title>. <source>Proc Natl Acad Sci</source><volume>110</volume>: <fpage>13463</fpage>–<lpage>13468</lpage>.<pub-id pub-id-type="pmid">23898164</pub-id></mixed-citation>
    </ref>
    <ref id="SMITHGR209601C32">
      <mixed-citation publication-type="journal"><string-name><surname>Waugh</surname><given-names>C</given-names></string-name>, <string-name><surname>Cromer</surname><given-names>D</given-names></string-name>, <string-name><surname>Grimm</surname><given-names>A</given-names></string-name>, <string-name><surname>Chopra</surname><given-names>A</given-names></string-name>, <string-name><surname>Mallal</surname><given-names>S</given-names></string-name>, <string-name><surname>Davenport</surname><given-names>M</given-names></string-name>, <string-name><surname>Mak</surname><given-names>J</given-names></string-name>. <year>2015</year><article-title>A general method to eliminate laboratory induced recombinants during massive, parallel sequencing of cDNA library</article-title>. <source>Virol J</source><volume>12</volume>: <fpage>55</fpage>.<pub-id pub-id-type="pmid">25879746</pub-id></mixed-citation>
    </ref>
    <ref id="SMITHGR209601C33">
      <mixed-citation publication-type="journal"><string-name><surname>Whalen</surname><given-names>S</given-names></string-name>, <string-name><surname>Truty</surname><given-names>RM</given-names></string-name>, <string-name><surname>Pollard</surname><given-names>KS</given-names></string-name>. <year>2016</year><article-title>Enhancer–promoter interactions are encoded by complex genomic signatures on looping chromatin</article-title>. <source>Nat Genet</source><volume>48</volume>: <fpage>488</fpage>–<lpage>496</lpage>.<pub-id pub-id-type="pmid">27064255</pub-id></mixed-citation>
    </ref>
    <ref id="SMITHGR209601C34">
      <mixed-citation publication-type="book"><string-name><surname>Wickham</surname><given-names>H</given-names></string-name>. <year>2009</year><source>ggplot2: elegant graphics for data analysis</source>. <publisher-name>Springer-Verlag</publisher-name>, <publisher-loc>New York</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="SMITHGR209601C35">
      <mixed-citation publication-type="journal"><string-name><surname>Yaari</surname><given-names>G</given-names></string-name>, <string-name><surname>Kleinstein</surname><given-names>SH</given-names></string-name>. <year>2015</year><article-title>Practical guidelines for B-cell receptor repertoire sequencing analysis</article-title>. <source>Genome Med</source><volume>7</volume>: <fpage>121</fpage>.<pub-id pub-id-type="pmid">26589402</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
