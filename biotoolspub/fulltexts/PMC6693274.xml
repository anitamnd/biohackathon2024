<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6693274</article-id>
    <article-id pub-id-type="publisher-id">2947</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-019-2947-6</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Yanagi: Fast and interpretable segment-based alternative splicing and gene expression analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Gunady</surname>
          <given-names>Mohamed K</given-names>
        </name>
        <address>
          <email>mgunady@cs.umd.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mount</surname>
          <given-names>Stephen M</given-names>
        </name>
        <address>
          <email>smount@umd.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Corrada Bravo</surname>
          <given-names>Héctor</given-names>
        </name>
        <address>
          <email>hcorrada@umiacs.umd.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0370 3414</institution-id><institution-id institution-id-type="GRID">grid.410443.6</institution-id><institution>Department of Computer Science, University of Maryland, </institution></institution-wrap>College Park, Maryland USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0941 7177</institution-id><institution-id institution-id-type="GRID">grid.164295.d</institution-id><institution>Center for Bioinformatics and Computational Biology, University of Maryland, </institution></institution-wrap>College Park, Maryland USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0941 7177</institution-id><institution-id institution-id-type="GRID">grid.164295.d</institution-id><institution>Department of Cell Biology and Molecular Genetics, University of Maryland, </institution></institution-wrap>College Park, Maryland USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>421</elocation-id>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>9</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>6</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Ultra-fast pseudo-alignment approaches are the tool of choice in transcript-level RNA sequencing (RNA-seq) analyses. Unfortunately, these methods couple the tasks of pseudo-alignment and transcript quantification. This coupling precludes the direct usage of pseudo-alignment to other expression analyses, including alternative splicing or differential gene expression analysis, without including a non-essential transcript quantification step.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>In this paper, we introduce a transcriptome segmentation approach to decouple these two tasks. We propose an efficient algorithm to generate maximal disjoint segments given a transcriptome reference library on which ultra-fast pseudo-alignment can be used to produce per-sample segment counts. We show how to apply these maximally unambiguous count statistics in two specific expression analyses – alternative splicing and gene differential expression – without the need of a transcript quantification step. Our experiments based on simulated and experimental data showed that the use of segment counts, like other methods that rely on local coverage statistics, provides an advantage over approaches that rely on transcript quantification in detecting and correctly estimating local splicing in the case of incomplete transcript annotations.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>The transcriptome segmentation approach implemented in <italic>Yanagi</italic> exploits the computational and space efficiency of pseudo-alignment approaches. It significantly expands their applicability and interpretability in a variety of RNA-seq analyses by providing the means to model and capture local coverage variation in these analyses.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s12859-019-2947-6) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Transcriptome quantification</kwd>
      <kwd>Differential gene expression</kwd>
      <kwd>Alternative splicing</kwd>
      <kwd>RNA-seq</kwd>
      <kwd>Pseudo-alignment</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id>
            <institution>National Institute of General Medical Sciences</institution>
          </institution-wrap>
        </funding-source>
        <award-id>GM114267</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000051</institution-id>
            <institution>National Human Genome Research Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>HG005220</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>ABI 1564785</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Messenger RNA transcript abundance estimation from RNA-seq data is a crucial task in high-throughput studies that seek to describe the effect of genetic or environmental changes on gene expression. Transcript-level analysis and abundance estimation can play a central role in both fine-grained analysis of local splicing events and global analysis of changes in gene expression.</p>
    <p>Over the years, various approaches have addressed the joint problems of (gene level) transcript expression quantification and differential alternative RNA processing. Much effort in the area has been dedicated to the problem of efficient alignment, or pseudo-alignment, of reads to a genome or a transcriptome, since this is typically a significant computational bottleneck in the analytical process starting from RNA-seq reads to produce gene-level expression or differentially expressed transcripts. Among these approaches are alignment techniques such as Bowtie [<xref ref-type="bibr" rid="CR1">1</xref>], Tophat [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>], and Cufflinks [<xref ref-type="bibr" rid="CR4">4</xref>], and newer techniques such as sailfish [<xref ref-type="bibr" rid="CR5">5</xref>], RapMap [<xref ref-type="bibr" rid="CR6">6</xref>], Kallisto [<xref ref-type="bibr" rid="CR7">7</xref>] and Salmon [<xref ref-type="bibr" rid="CR8">8</xref>], which provide efficient strategies through k-mer counting that are much faster, but maintain comparable, or superior, accuracy.</p>
    <p>These methods simplified the expected outcome of the alignment step to only find sufficient read-alignment information required by the transcript quantification step. Given a transcriptome reference, an index of k-mers is created and used to find a mapping between reads and the list of compatible transcripts based on each approach’s definition of compatibility. The next step, quantification, would be to resolve the ambiguity in reads that were mapped to multiple transcripts. Many reads will multi-map to shared regions produced by alternative splicing even if free from error. The ambiguity in mapping reads is resolved using probabilistic models, such as the EM algorithm, to produce the abundance estimate of each transcript [<xref ref-type="bibr" rid="CR9">9</xref>]. It is at this step that transcript-level abundance estimation faces substantial challenges that inherently affect the underlying analysis.</p>
    <p>Sequence repeats and paralogous genes can create ambiguity in the placement of reads. But more importantly, the fact that alternatively spliced isoforms share substantial portions of their coding regions, greatly increases the proportion of reads coming from these shared regions and, consequently, reads are frequently multi-mapped when aligning to annotated transcripts (Fig. <xref rid="Fig1" ref-type="fig">1</xref><bold>a</bold>-<bold>b</bold>). In fact, local splicing variations can be joined combinatorially to create a very large number of possible transcripts from many genes. An extreme case is the Drosophila gene Dscam, which can produce over 38,000 transcripts by joining less than 50 exons [<xref ref-type="bibr" rid="CR10">10</xref>]. Long-read sequencing indicates that a large number of possible splicing combinations is typical even in the presence of correlations between distant splicing choices [<xref ref-type="bibr" rid="CR11">11</xref>].
<fig id="Fig1"><label>Fig. 1</label><caption><p>An overview of transcriptome segmentation and Yanagi-based workflow. (<bold>a</bold>) Shows the example set of exons and its corresponding sequenced reads. (<bold>b</bold>) shows the result of alignment over the annotated three isoforms spliced from the exons. (<bold>c</bold>) shows the splice graph representation of the three isoforms along with the generated segments from yanagi. (<bold>d</bold>) shows the alignment outcome when using the segments, and its segment counts (SCs). (<bold>e</bold>) Yanagi-based workflow: segments are used to align a paired-end sample then use the segments counts for downstream alternative splicing analysis. Dotted blocks are components of Yanagi. (<bold>f</bold>) Yanagi’s three steps for generating segments starting from the splice graph for an example of a complex splicing event. Assuming no short exons for simplicity. Step two and three are cropped to include only the beginning portion of the graph for brevity</p></caption><graphic xlink:href="12859_2019_2947_Fig1_HTML" id="MO1"/></fig></p>
    <p>Standard annotations, which enumerate only a minimal subset of transcripts from a gene (e.g. [<xref ref-type="bibr" rid="CR12">12</xref>]), are thus inadequate descriptions. Furthermore, short read sequencing, which is likely to remain the norm for some time, does not provide information of long-range correlations between splicing events.</p>
    <p>In this paper, we propose a novel strategy based on the construction and use of a transcriptome sequence segment library that can be used, without loss of information, in place of the whole transcriptome sequence library in the read-alignment-quantification steps. The segment library can fully describe individual events (primarily local splicing variation, but also editing sites or sequence variants) independently, leaving the estimation of transcript abundances through quantification as a separate problem. Here we introduce and formalize the idea of transcriptome segmentation, and propose and analyze an algorithm for transcriptome segmentation, implemented with a tool called Yanagi. To show how the segment library and segment counts can be used in downstream analysis, we show results from gene-level and alternative splicing differential analyses.</p>
    <p>We propose the use of pseudo-alignment to calculate segment-level counts as a computationally efficient data reduction technique for RNA-seq data that yields sufficient intepretable information for a variety of downstream gene expression analysis.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Yanagi’s Workflow for RNA-seq analysis</title>
      <p>Figure <xref rid="Fig1" ref-type="fig">1</xref><bold>e</bold> gives an overview of a Yanagi-based workflow which consists of three steps. The first step is the transcriptome segmentation, in which the segment library is generated. Given the transcriptome annotation and the genome sequences, Yanagi generates the segments in FASTA file format. This step of library preparation – done once and independently from the RNA-seq samples – requires a parameter value <italic>L</italic> which specifies the <italic>m</italic>aximum overlap length of the generated segments. The second step is pseudo-alignment. Using any k-mer based aligner (<italic>e.g.</italic> Kallisto or RapMap), the aligner uses the segments library for library indexing and alignment. The outcome of this step is read counts per segment (in case of single-end reads) or segment-pair counts (in case of paired-end reads). These segment counts (SCs) are the statistics that Yanagi provides for downstream analysis. The third step depends on the specific target analysis. On later subsections, we describe two use cases where using segment counts shows to be computationally efficient and statistically beneficial.</p>
    </sec>
    <sec id="Sec4">
      <title>Analysis of Generated Segments</title>
      <p>For practical understanding of the generated segments, we used Yanagi to build segment libraries for the Drosophila melanogaster and Homo sapiens genome assemblies and annotations. These organisms show different genome characteristics, <italic>e.g.</italic> the fruit fly genome has longer exons than the human genome, while the number of annotated transcripts per gene is much higher for the human genome. A summary of the properties of each genome is found in [<xref ref-type="bibr" rid="CR13">13</xref>].</p>
      <sec id="Sec5">
        <title>Sequence lengths of generated segments</title>
        <p>Segments generated by Yanagi’s approach are <italic>L</italic>-disjoint segments (See “<xref rid="Sec24" ref-type="sec">Segments Properties</xref>” section). Since <italic>L</italic> is the only parameter required by the segmentation algorithm, we tried different values of <italic>L</italic> to understand the impact of that choice on the generated segments library. As mentioned in “<xref rid="Sec24" ref-type="sec">Segments Properties</xref>” section, a proper choice of <italic>L</italic> is based on the expected read length of the sequencing experiment. For this analysis we chose the set <italic>L</italic>=(40,100,1000,10000) as a wide span of possible values of <italic>L</italic>.</p>
        <p>Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1 shows the histogram of the lengths of the generated segments compared to the histogram of the transcripts lengths, for each value of <italic>L</italic>, for both fruit fly (left) and human (right) genomes. The figure shows the expected behavior when increasing the value of <italic>L</italic>; using small values of <italic>L</italic> tends to shred the transcriptome more (higher frequencies for small sequence lengths), especially with genomes of complex splicing structure like the human genome. With high values of <italic>L</italic>, such as <italic>L</italic>=10,000, segments representing full transcripts are generated since the specificed minimum segment length tends to be longer than the length of most transcripts. It is important to note that the parameter <italic>L</italic> does not define the segments length since a segment length is mainly determined based on the neighboring branches in the splicing graph (See “<xref rid="Sec24" ref-type="sec">Segments Properties</xref>” section), but rather <italic>L</italic> defines the maximum overlap allowed between segments, hence in a sense controls the minimum segment length (excluding trivial cases where the transcript itself is shorter than L).</p>
      </sec>
      <sec id="Sec6">
        <title>Number of generated segments per gene</title>
        <p>Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2 shows how the number of generated segments in a gene is compared to the number of the transcripts in that gene, for each value of <italic>L</italic>, for both fruit fly (left) and human (right) genomes. A similar behavior is observed while increasing the value <italic>L</italic>, as with the segment length distribution. The fitted line included in each scatter plot provides indication of how the number of target sequences grows compared to the original transcriptome. For example, when using <italic>L</italic>=100 (a common read length with Illumina sequencing), the number of target sequences per gene, which will be the target of the subsequent pseudo-alignment steps, almost doubles. It is clear from both figures the effect of the third step in the segmentation stage. It is important not to shred the transcriptome so much that the target sequences become very short leading to complications in the pseudo-alignment and quantification steps, and not to increase the number of target sequences increasing the processing complexity of these steps.</p>
      </sec>
      <sec id="Sec7">
        <title>Library Size of the generated segments</title>
        <p>As a summary, Table <xref rid="Tab1" ref-type="table">1</xref> shows the library size when using segments compared to the reference transcriptome in terms of the total number of sequences, sequence bases, and file sizes. The total number of sequence bases clearly shows the advantage of using segments to reduce repeated sequences appearing in the library that corresponds to genomic regions shared among multiple isoforms. For instance, using <italic>L</italic>=100 achieves 54% and 35% compression rates in terms of sequence lengths for fruit-fly and human genomes, respectively. The higher the value of <italic>L</italic> is, the more overlap is allowed between segments, hence providing less the compression rate. Moreover, that necessarily hints to the expected behavior of the alignment step in terms of the frequency of multi-mappings.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Library size summary when using segments compared to the reference transcriptome in terms of the total number of sequences, number of sequence bases, and total FASTA file sizes</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">Transcriptome</th><th align="left"/><th align="left" colspan="4">Segments</th></tr><tr><th align="left"/><th align="left"/><th align="left"/><th align="left"><italic>L</italic>=40</th><th align="left"><italic>L</italic>=100</th><th align="left"><italic>L</italic>=1000</th><th align="left"><italic>L</italic>=10000</th></tr></thead><tbody><tr><td align="left">BDGP6</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">Number of bases (Gb)</td><td align="left">90</td><td align="left"/><td align="left">39</td><td align="left">41</td><td align="left">71</td><td align="left">90</td></tr><tr><td align="left">Number of Sequences</td><td align="left">34,681</td><td align="left"/><td align="left">54,680</td><td align="left">53,694</td><td align="left">48,741</td><td align="left">34,625</td></tr><tr><td align="left">FASTA File Size (MB)</td><td align="left">89</td><td align="left"/><td align="left">44</td><td align="left">47</td><td align="left">76</td><td align="left">92</td></tr><tr><td align="left">GRCh38</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">Number of bases (Gb)</td><td align="left">278</td><td align="left"/><td align="left">147</td><td align="left">181</td><td align="left">308</td><td align="left">281</td></tr><tr><td align="left">Number of Sequences</td><td align="left">182,435</td><td align="left"/><td align="left">544,991</td><td align="left">541,361</td><td align="left">264,083</td><td align="left">183,165</td></tr><tr><td align="left">FASTA File Size (MB)</td><td align="left">276</td><td align="left"/><td align="left">206</td><td align="left">239</td><td align="left">338</td><td align="left">302</td></tr></tbody></table><table-wrap-foot><p>With <italic>L</italic>=100, using segments achieves 54% and 35% compression rates over the transcriptome in terms of number of bases for fruit fly and human genomes, respectively.</p></table-wrap-foot></table-wrap></p>
      </sec>
      <sec id="Sec8">
        <title>Impact of using segments on Multi-mapped Reads</title>
        <p>To study the impact of using the segments library instead of the transcriptome for alignment, we created segments library with different values of <italic>L</italic> and compared the number of multi-mapped and unmapped reads for each case to alignemnt to the full transcriptome. We used RapMap [<xref ref-type="bibr" rid="CR6">6</xref>] as our k-mer based aligner, to align samples of 40 million simulated reads of length 101 (samples from the switchTx human dataset discussed in “<xref rid="Sec27" ref-type="sec">Simulation Datasets</xref>” section) in a single-end mode. We tested values of <italic>L</italic> centered around <italic>L</italic>=101 with many values close to 101, in order to test how sensitive the results are to small changes in the selection of <italic>L</italic>. Figure <xref rid="Fig2" ref-type="fig">2</xref> shows the alignment performance in terms of the number of multi-mapped reads (red solid line) and unmapped reads (blue solid line), compared to the number of multi-mapped reads (red dotted line) and unmapped reads (blue dotted line) when aligning using the transcriptome. Using segments highly reduces the number of multi-mapped reads produced mainly from reads mapped to a single genomic location but different transcripts. The plot shows that too short segments compared to the read length results in a lot of unmapped reads, while using long segments compared to the read length causes an increasing number of multimappings. Consequently, choosing <italic>L</italic> to be close to the read length is the optimal choice to minimize multimappings while maintaining a steady number of mapped reads. This significant reduction in multimappings reported from the alignment step eliminates the need for a quantification step to resolve the ambiguity when producing raw pseudo-alignment counts. It is important to note that the best segments configuration still produces some multimappings. These result from reads sequenced from paralogs and sequence repeats which are not handled by the current version of Yanagi. Nevertheless, using segments can achieve around 10-fold decrease in the number of multimappings.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Alignment performance using segments from human transcriptome, tested for different values of <italic>L</italic>, to align 40 million reads of length 101 (first sample in SwitchTx dataset, see section <xref rid="Sec27" ref-type="sec">3</xref>). Performance is shown in terms of the number of multimapped reads (red solid line) and unmapped reads (blue solid line), compared to the number of multimapped reads (red dotted line) and unmapped reads (blue dotted line) when aligning using the transcriptome</p></caption><graphic xlink:href="12859_2019_2947_Fig2_HTML" id="MO2"/></fig></p>
      </sec>
      <sec id="Sec9">
        <title>The importance of maximality property</title>
        <p>Yanagi generates maximal segments, as mentioned in Definition 4 (“<xref rid="Sec24" ref-type="sec">Segments Properties</xref>” section), which are extended as much as possible between branching points in the segments graph. The purpose of this property is to maintain stability in the produced segment counts since shorter segments will inherently produce lower counts which introduces higher variability that can complicate downstream analysis. To examine the effect of the maximal property, we simulated 10 replicates from 1000 random genes (with more than two isoforms) from the human transcriptome using Ployester [<xref ref-type="bibr" rid="CR14">14</xref>]. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3 shows the distribution of the coefficient of variation (CV) of the produced segment counts from segments with and without the maximal property. When segments are created without maximal property, the scatter plot clearly shows that maximal segments have lower CVs to their corresponding short segments for a majority of points (40% of the points has a difference in CVs &gt;0.05). That corresponds to generating counts with lower means and/or higher variances if the maximal property was not enforced.</p>
      </sec>
    </sec>
    <sec id="Sec10">
      <title>Segment-based Gene Expression Analysis</title>
      <p>We propose a segment-based approach to gene expression analysis to take advantage of pseudo-alignment while avoiding a transcript quantification step. The standard RNA-seq pipeline for gene expression analysis depends on performing k-mer based alignment over the transcriptome to obtain transcripts abundances, e.g. Transcripts Per Million (TPM). Then depending on the objective of the differential analysis, an appropriate hypothesis test is used to detect genes that are differentially expressed. Methods that perform differential gene expression (DGE) prepare gene abundances by summing the underlying transcript abundances. Consequently, DGE methods aims at testing for differences in the overall gene expression. Among these methods are: DESeq2 [<xref ref-type="bibr" rid="CR15">15</xref>] and edgeR [<xref ref-type="bibr" rid="CR16">16</xref>]. Such methods fail to detect cases where some transcripts switch usage levels while the total gene abundance is not significantly changing. Note that estimating gene abundances by summing counts from the underlying transcripts can be problematic, as discussed in [<xref ref-type="bibr" rid="CR17">17</xref>]. RATs [<xref ref-type="bibr" rid="CR18">18</xref>] on the other hand is among those methods that target to capture such behavior and tests for differential transcript usage (DTU). Regardless of the testing objective, both tests entirely depend on the transcript abundances that were obtained from algorithms like EM during the quantification step to resolve the ambiguity of the multi-mapped reads, which requires bias-correction modeling [<xref ref-type="bibr" rid="CR8">8</xref>] adding another layer of complexity to achieve the final goal of gene-level analysis.</p>
      <p>Our segment-based approach aims at breaking the coupling between the quantification, bias modeling, and gene expression analysis, while maintaining the advantage of using ultra-fast pseudo-alignment techniques provided by k-mer based aligners. When aligning over the L-disjoint segments, the problem of multimapping across target sequences is eliminated making the quantification step unecessary. Statistical analysis for differences across conditions of interest is performed on segment counts matrix instead of TPMs.</p>
      <sec id="Sec11">
        <title>Kallisto’s TCC-based approach</title>
        <p>Yi et al. introduce a comparable approach in [<xref ref-type="bibr" rid="CR19">19</xref>]. This approach uses an intermediate set defined in Kallisto’s index core as equivalence classes (EC). Specifically, a set of k-mers are grouped into a single EC if the k-mers belong to the same set of transcripts during the transcriptome reference indexing step. Then during the alignment step Kallisto derives a count statistic for each EC. The statistics are referred to as Transcript Compatibility Counts (TCC). In other words, Kallisto produces one TCC per EC representing number of fragments that appeared compatible with the corresponding set of transcripts during the pseudo-alignment step. Then the work in [<xref ref-type="bibr" rid="CR19">19</xref>] uses these TCCs to directly perform gene-level differential analysis by skipping the quantification step using logistic regression and compared it to other approaches like using DESeq2. We will refer to that direction as the TCC-based approach. To put that approach into perspective with our segment-based approach, we will discuss how the two approaches compare to each other.</p>
      </sec>
      <sec id="Sec12">
        <title>Comparison between segment-based and TCC-based approaches</title>
        <p>Both segment-based and TCC-based approaches avoid a quantification step when targeting gene-level analysis. This can be seen as an advantage in efficiency, speed, simplicity, and accuracy, as previously discussed. One difference is that segment-based approach is agnostic to the alignment technique used, while TCC-based approach is a Kallisto-specific approach. More importantly, statistics derived in segment-based approach are easily interpretable. Since segments are formed to preserve the genomic location and splicing structure of genes, Segment Counts (SC)s can be directly mapped and interpreted with respect to the genome coordinates. In contrast, ECs do not have a direct intepretation in this sense. For instance, all k-mers that belong to the same transcript yet originated from distinct locations over the genome will all fall under the same EC, making TCCs less interpretable. Figure <xref rid="Fig3" ref-type="fig">3</xref>-top shows a toy example for a simple case with two transcripts and three exons along with its resulting segments and ECs. In this case, k-mer contigs from the first and last exons are merged into one EC (EC1) in Kallisto, while Yanagi creates a separate segment for each of the two constitutive exons (S1, S2), hence preserving their respective location information. This advantage can be crucial for a biologist who tries to interpret the outcome of the differential analysis. In the next section we show a segment-based gene visualization that exploits the genomic location information of segments to allow users to visually examine what transcripts exons and splicing events contributed to differences for genes identified as determined differentially expressed.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Segment-based gene-level differential expression analysis. (<bold>Top</bold>) Diagram showing an example of two transcripts splicing three exons and their corresponding segments from Yanagi versus equivelance classes (ECs) from kallisto. K-mer contigs from the first and last exons are merged into one EC (EC1) in kallisto while Yanagi creates two segments, one for each exon (S1, S2), hence preserving their respective location information. Both Kallisto and Yanagi generate ECs or segments corresponding to exon inclusion (EC2, S3) and skipping (EC3, S4). (<bold>Middle</bold>) ROC curve for simulation data for DEX-Seq based differential gene-level differential expression test based on segment counts (SC) and Kallisto equivalence class counts (TCC) for <italic>D. melanogaster</italic> and <italic>H. sapiens</italic>. (<bold>Bottom</bold>) Scatter plot of number of segments per gene (x-axis) vs. Kallisto equivalence classes per gene (y-axis) for the same pair of transcriptomes</p></caption><graphic xlink:href="12859_2019_2947_Fig3_HTML" id="MO3"/></fig></p>
        <p>Figure <xref rid="Fig3" ref-type="fig">3</xref>-bottom shows the number of Yanagi’s segments per gene versus the number of Kallisto’s equivalence classes per gene. The number of equivalence classes were obtained by building Kallisto’s index on human transcriptome, then running the pseudo command of Kallisto (Kallisto 0.43) on the 6 simulated samples from SwitchTx dataset (“<xref rid="Sec27" ref-type="sec">Simulation Datasets</xref>” section).</p>
        <p>Note that, in principle there should be more segments than ECs since segments preserve genome localization, however in practice Kallisto reports more ECs than those discovered in the annotation alone in some genes. The extra ECs are formed during pseudo-alignment when reads show evidence of unannotated junctions.</p>
      </sec>
      <sec id="Sec13">
        <title>DEXSeq-based model for differential analysis</title>
        <p>In this work we adopt the DEXSeq [<xref ref-type="bibr" rid="CR20">20</xref>] method to perform segment-based gene differential analysis. DEXSeq is a method that performs differential exon usage (DEU). The standard DEXSeq workflow begins by aligning reads to a reference genome (not to the transcriptome) using TopHat2 or STAR [<xref ref-type="bibr" rid="CR21">21</xref>] to derive exon counts. Then, given the exon counts matrix and the transcriptome annotation, DEXSeq tests for DEU after handling coverage biases, technical and biological variations. It fits, per gene, a negative binomial (NB) generalized linear model (GLM) accounting for effect of the condition factor, and compares it to the null model (without the condition factor) using a chi-square test. Exons that have their null hypotheses rejected are identified as differentially expressed across conditions. DEXSeq can tehn produce a list of genes with at least one exon with significant differential usage and controls the false discovery rate (FDR) at the gene level using the Benjamini–Hochberg procedure.</p>
        <p>We adopt the DEXSeq model for the case of segments by replacing exons counts with segments counts, the latter derived from pseudo-alignment. Once segments are tested for differential usage across conditions, the same procedure provided by DEXSeq is used to control FDR on the list of genes that showed at least one segment with significant differential usage.</p>
        <p>We tested that model on simulated data (SwitchTx dataset in “<xref rid="Sec27" ref-type="sec">Simulation Datasets</xref>” section) for both human and fruit fly samples and compared our segment-based approach with the TCC-based approach since they are closely comparable. Since the subject of study is the effectiveness of using either SCs or TCCs as a statistic, we fed TCCs reported by Kallisto to DEXSeq’s model as well to eliminate any performance bias due the testing model. As expected, Fig. <xref rid="Fig3" ref-type="fig">3</xref>-middle shows that both approaches provide highly comparable results on the tested dataset. Recall that using segment counts to test for differentially expressed genes adds to the interpretability of the test outcomes.</p>
        <p>Although that experiment was chosen to test the use of SCs or TCCs as statistics to perform differential usage, different gene-level tests can also be performed on segment counts. For instance, testing for significant differences in overall gene expression is possible based on segment counts as well. A possible procedure for that purpose would be using DESeq2. One can prepare the abundance matrix by R package tximport [<xref ref-type="bibr" rid="CR22">22</xref>], except that the matrix now represent segment instead of transcript abundances. The next section shows how visualizing segment counts connects the result of some hypotheses testing with the underlying biology of the gene.</p>
      </sec>
    </sec>
    <sec id="Sec14">
      <title>Segment-based Gene Visualization</title>
      <p>Figure <xref rid="Fig4" ref-type="fig">4</xref> shows Yanagi’s proposed method to visualize segments and the segment counts of a single gene. The plot includes multiple panels, each showing a different aspect of the mechanisms involved in differential expression calls. The main panel of the plot is the segment-exon membership matrix (Panel A). This matrix shows the structure of the segments (rows) over the exonic bins (columns) prepared during the annotation preprocessing step. An exon (or a retained intron) in the genome can be represented with more than one exonic bin in case of within-exon splicing events (See Step 1 in “<xref rid="Sec25" ref-type="sec">Segmentation Algorithm</xref>” section). Panel B is a transcript-exon membership matrix. It encapsulates the transcriptome annotation with transcripts as rows and the exonic bins as columns. Both membership matrices together allow the user to map segments (through exonic bins) to transcripts.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Visualizing segments and segment counts of a single gene with differentially expressed transcripts. It shows human gene EFS (Ensembl ENSG00000100842). The gene is on the reverse strand, so the bins axis is reversed and segments are created from right to left. (<bold>a</bold>) Segment-exonic bin membership matrix, (<bold>b</bold>) Transcript-exonic bin membership matrix. (<bold>c</bold>) Segment counts for three control and three case samples, fill used to indicate segments that were significantly differential in the gene. (<bold>d</bold>) Segment length bar chart, (<bold>e</bold>) (optional) Estimated TPMs for each transcript</p></caption><graphic xlink:href="12859_2019_2947_Fig4_HTML" id="MO4"/></fig></p>
      <p>Panel C shows the segment counts (SCs) for each segment row. Panel D shows the length distribution of the exonic bins. Panel E is optional. It adds the transcript abundances of the samples, if provided. This can be useful to capture cases where coverage biases over the transcriptome is considered, or to capture local switching in abundances that are inconsistent with the overall abundances of the transcripts. The exonic bins axis is reversed and segments are created from right to left as the gene shown is on the reverse strand.</p>
      <p>Consider the top-most segment (S.1310) for instance. It was formed by spanning the first exonic bin (right-most bin) plus the junction between the first two bins. This junction is present only at the second transcript (T.1354) and hence that segment belongs to only that transcript. In the segment-exon matrix, red-colored cells mean that the segment spans the entire bin, while salmon-colored cells represent partial bin spanning; usually at the start or end of a segment with correspondence to some junction.</p>
      <p>Alternative splicing events can be easily visualized from Fig. <xref rid="Fig4" ref-type="fig">4</xref>. For instance, the third and fourth segments from the top (S.1308 and S.1307) represent an exon-skipping event where the exon is spliced in T.6733 and skipped in both T.1354 and T.9593.</p>
    </sec>
    <sec id="Sec15">
      <title>Segment-based Alternative Splicing Analysis</title>
      <p>The analysis of how certain genomic regions in a gene are alternatively spliced into different isoforms is related to the study of relative transcript abundances. For instance, an exon cassette event (exon skipping) describes either including or excluding an exon between the upstream and downstream exons. Consequently, isoforms are formed through a sequential combination of local splicing events. For binary events, the relative abundance of an event is commonly described in terms of percent spliced-in (PSI) [<xref ref-type="bibr" rid="CR23">23</xref>] which measures the proportion of reads sequenced from one splicing possibility versus the alternative splicing possibility, while <italic>Δ</italic><italic>PSI</italic> describes the difference in PSI across experimental conditions of interest.</p>
      <p>Several approaches were introduced to study alternative splicing and its impact in studying multiple diseases. [<xref ref-type="bibr" rid="CR24">24</xref>] surveyed eight different approaches that are commonly used in the area. These approaches can be roughly categorized into two categories depending on how the event abundance is derived for the analysis. The first category is considered count-based where the approach focuses on local measures spanning specific counting bins (e.g. exons or junctions) defining the event, like DEXSeq [<xref ref-type="bibr" rid="CR20">20</xref>], MATS [<xref ref-type="bibr" rid="CR25">25</xref>] and MAJIQ [<xref ref-type="bibr" rid="CR26">26</xref>]. Unfortunately, many of these approaches can be expensive in terms of computation and/or storage requirements since it requires mapping reads to the genome and subsequent processing of the large matrix of counting bins. The second category is isoform-based where the approach uses the relative transcript abundances as basis to derive PSI values. This direction utilizes the transcript abundance (e.g. TPMs) as a summary of the behavior of the underlying local events. Cufflinks [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR17">17</xref>], DiffSplice [<xref ref-type="bibr" rid="CR27">27</xref>] and SUPPA [<xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR29">29</xref>] are of that category. Unlike Cufflinks and DiffSplice which perform read assembly and discovers novel events, SUPPA succeeds in overcoming the computational and storage limitations by using transcript abundances that were rapidly prepared by lightweight k-mer counting alignment like Kallisto or Salmon.</p>
      <p>One drawback of SUPPA and other transcript-based approaches alike is that it assumes a homogeneous abundance behavior across the transcript making it susceptible to coverage biases. Previous work showed that RNA-seq data suffers from coverage bias that needs to be modeled into methods that estimate transcript abundances [<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR31">31</xref>]. Sources of bias can vary between fragment length, positional bias due to RNA degradation, and GC content in the fragment sequences.</p>
      <p>Another critical drawback with transcript-based approaches is that its accuracy highly depends on the completeness of the transcript annotation. As mentioned earlier standard transcriptome annotations enumerate only a parsimonious subset of all possible sequential combinations of the present splicing events. Consider the diagram in Fig. <xref rid="Fig5" ref-type="fig">5</xref> with a case of two annotated isoforms (Isoform 1 and 2) whereas a third isoform (isoform 3) is missing from the annotation. The three isoforms represent three possible combinations of two splicing events (skipping exons E1 and E2). If the two events are sufficiently far apart in genomic location, short reads would fail to provide evidence of the presence of isoform 3, leading to mis-assignment of reads into the other two isoforms (Fig. <xref rid="Fig5" ref-type="fig">5</xref> right). That behavior can bias the calculated <italic>PSI</italic> values of both events E1 and E2. Even if the mis-assigned reads did not change the estimation of <italic>TPM</italic><sub>1</sub> and <italic>TPM</italic><sub>2</sub>, the calculated <italic>PSI</italic>s for both events can be significantly far from the truth. Further in this paper we refer to any pair of events that involves such behavior as coupled events.
<fig id="Fig5"><label>Fig. 5</label><caption><p>This diagram illustrates a problem with transcript-based approaches for calculating <italic>PSI</italic> in the presence of unannotated transcripts. (<bold>Left</bold>) shows the truth, with three isoforms combining two exon skipping events (E1, E2). However, isoform 3 is missing from the annotation. Reads spanning both events are shown along their true source. Reads spanning an exon incluion are colored green whereas reads spanning a skipping junction are colored orange. (<bold>Right</bold>) shows the problem with <italic>PSI</italic> values from transcript abundance. Because these two alternative splicing events are coupled in the annotation, their <italic>PSI</italic> values calculated from transcript abundances will always be the same (<inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\psi ^{TPM}_{1}$\end{document}</tex-math><mml:math id="M2"><mml:msubsup><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">TPM</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2947_Article_IEq1.gif"/></alternatives></inline-formula> = <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\psi ^{TPM}_{2}$\end{document}</tex-math><mml:math id="M4"><mml:msubsup><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">TPM</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2947_Article_IEq2.gif"/></alternatives></inline-formula>), even though the true values are not (<italic>True</italic><italic>ψ</italic><sub>1</sub>≠<italic>True</italic><italic>ψ</italic><sub>2</sub>). Furthermore, changes in the estimated abundances (<italic>TPM</italic><sub>1</sub>,<italic>TPM</italic><sub>2</sub>) make the calculated <italic>PSI</italic> values unpredictable. Count-based <italic>PSI</italic> values (<inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\psi ^{C}_{1}, \psi ^{C}_{2}$\end{document}</tex-math><mml:math id="M6"><mml:msubsup><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2947_Article_IEq3.gif"/></alternatives></inline-formula>) on the other hand correctly reflect the truth</p></caption><graphic xlink:href="12859_2019_2947_Fig5_HTML" id="MO5"/></fig></p>
      <p>Our segment-based approach works as a middle ground between count-based and transcript-based approaches. It provides local measures of splicing events while avoiding the computational and storage expenses of count-based approaches by using the rapid lightweight alignment strategies that transcript-based approaches use. Once the segment counts are prepared from the alignment step, Yanagi maps splicing events to their corresponding segments, e.g. each event is mapped into two sets of segments: The first set spans the inclusion splice, and the second for the alternative splice (See “<xref rid="Sec26" ref-type="sec">Segment-based calculation of PSI</xref>” section). Current version of Yanagi follows SUPPA’s notation for defining a splice event and can process seven event types: Skipped Exon (SE), Retained Intron (RI), Mutually Exclusive Exons (MX), Alternative 5’ Splice-Site (A5), Alternative 3’ Splice-Site (A3), Alternative First Exon (AF) and Alternative Last Exon (AL).</p>
    </sec>
    <sec id="Sec16">
      <title>Comparing Segment-based and isoform-based PSI values with incomplete annotation</title>
      <p>To show how the estimated transcript abundances in the case of incomplete annotations can affect local splicing analysis, we ran both SUPPA and Yanagi pipelines on dataset simulating situations like the one in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. We simulated reads from 2454 genes of the human genome. A novel isoform is formed in each gene by combining two genomically distant events in the same gene (coupled events) where the inclusion of the first and the alternative splicing of the second does not appear in any of the annotated isoforms of that gene (IncompTx dataset in “<xref rid="Sec27" ref-type="sec">Simulation Datasets</xref>” section). After reads are simulated from the annotated plus novel isoforms, both SUPPA and Yanagi pipelines where run with the original annotation which does not contain the novel isoforms.</p>
      <p>Figure <xref rid="Fig6" ref-type="fig">6</xref> shows the calculated PSI values of the coupled events compared to the true PSI values. It is clear how the PSI values for both events can be severely affected by the biased estimated abundances. In SUPPA’s case, abundance of both sets of inclusion and exclusion isoforms were overestimated. However, the error in abundance estimates of inclusion transcripts were consistently higher than the error in exclusion transcripts. Therefore, the PSI values of the second event were consistently overestimated by SUPPA whereas PSI values of the first events were consistently underestimated. Furthermore, splicing events involving the affected isoforms will be inherently affected as well even when they were unrelated to the missing transcript. This coupling problem between events inherent in transcript-based approaches is circumvented in values calculated by Yanagi, and generally, by count-based approaches.
<fig id="Fig6"><label>Fig. 6</label><caption><p>The PSI values of 2454 coupled events formulating novel isoforms used in simulated data to simulate scenarios of incomplete annotation, similar to Fig. <xref rid="Fig5" ref-type="fig">5</xref>. Each novel isoform consists of combining the inclusion splicing of the first event and the alternative (skipping) splicing of the second event. PSI values obtained by Yanagi and SUPPA are compared to the true PSI values. Red points are measures of error larger than 0.2. SUPPA tends to underestimate the PSI of the first event and overestimate in the second event (43% of the points are red compared to only 7% in Yanagi)</p></caption><graphic xlink:href="12859_2019_2947_Fig6_HTML" id="MO6"/></fig></p>
      <p>Figure <xref rid="Fig7" ref-type="fig">7</xref> shows the trends in estimation error of <italic>PSI</italic> across methods for the 2454 coupled events. <italic>Δ</italic><italic>PSI</italic> of an event is calculated here as the difference between the calculated <italic>PSI</italic> of that event obtained either by Yanagi or SUPPA, and the true <italic>PSI</italic>. For each splicing event couple, a line connecting <italic>Δ</italic><italic>PSI</italic> of the first event to the second’s is drawn to show the trend of change in error between the first and second event in each pair. We found that estimates by SUPPA drastically exhibit a trend we refer to as overestimation-to-underestimation (or underestimation-to-overestimation) in 50% of the pairs while 36% of the pairs showed minor errors (<italic>Δ</italic><italic>PSI</italic>&lt;0.2). Yanagi’s estimates on the other hand showed the further trend only in 7% of the pairs while 87% of the pairs showed minor errors.
<fig id="Fig7"><label>Fig. 7</label><caption><p>Trends of error in event PSI values across methods. <italic>Δ</italic><italic>PSI</italic> of an event is calculated here as the difference in the calculated <italic>PSI</italic> of that event obtained either by Yanagi, SUPPA, or the truth. For each coupled event, a line connecting <italic>Δ</italic><italic>PSI</italic> of the first event to the second’s is drawn to show the trend of change in error among the first and second event in each pair. Overestimation-to-underestimation (and underestimation-to-overestimation) trends are colored red. Orange colored trends represent trends where both events were either overestimated or underestimated. Trends with insignificant differences (|<italic>Δ</italic><italic>PSI</italic>|&lt;0.2) are colored grey</p></caption><graphic xlink:href="12859_2019_2947_Fig7_HTML" id="MO7"/></fig></p>
    </sec>
    <sec id="Sec17">
      <title>Comparing Segment-based and isoform-based PSI values on drosophila melanogaster</title>
      <p>Based on known complexity and incompleteness of the <italic>D</italic>rosophila melanogaster transcript annotation we examined an RNA-seq dataset of male fly head (available online with GEO accession number GSM2108304) for evidence of similar behavior to that studied in the previous simulation. Since the true <italic>PSI</italic> values are unknown, we compare the trends of the difference in <italic>PSI</italic> between SUPPA and Yanagi. We add to the comparison the <italic>PSI</italic>s obtained from a count-based approach, rMATS.</p>
      <p>The scenario studied in the simulation is just one possible scenario of missing isoforms. More complex scenarios are likely to occur in real situations. Complex scenarios may include missing more than one isoform or when the event coupling problem involves more than two events. Such scenarios make detecting the full scale of the problem more complicated. Here we focus on the issue of coupled events as described in our simulation.</p>
      <p>We follow the same analogy used in the simulation to define coupled events and find candidate genes of at least one missing isoform that couples two sufficiently distant events. By searching genes only in the forward strand and only events of type SE, A3, A5, we found 172 candidate genes and pair of coupled events where some splicing combination is possibly missing. Note that this candidate search is independent of the RNA-seq data, or the segment generation process. Figure <xref rid="Fig8" ref-type="fig">8</xref> shows the trends in <italic>Δ</italic><italic>PSI</italic> between Yanagi, SUPPA and rMATS for the 172 cases of coupled events. Evidence of overestimation-to-underestimation trends were found between SUPPA and both Yanagi and rMATS, suggesting a similar behavior to the phenomenon present in our simulation (33% in Yanagi-SUPPA, 11% in Yanagi-rMATS, 29% in rMATS-SUPPA). It should be noted that those 172 cases of coupled events were only selected from part of the genome as candidates of one scenario of missing isoforms which means it is very likely for more cases to exist at the scale of the whole transcriptome. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4 shows a scatter plot of the <italic>PSI</italic> values of full list of events found in the transcriptome annotation.
<fig id="Fig8"><label>Fig. 8</label><caption><p>Trends in <italic>Δ</italic><italic>PSI</italic> across methods Yanagi, SUPPA, rMATS for 172 coupled events in candidate genes for incomplete annotation in drosophila melanogaster (SRR3332174). Overestimation-to-underestimation (and underestimation-to-overestimation) trends are colored red. Orange colored trends represent trends where both events were either overestimated or underestimated. Trends with insignificant differences (|<italic>Δ</italic><italic>PSI</italic>|&lt;0.2) are colored grey. Out of the 172 cases, 33% showed Overestimation-to-underestimation (or underestimation-to-overestimation) trends in Yanagi-SUPPA, 11% in Yanagi-rMATS, 29% in rMATS-SUPPA</p></caption><graphic xlink:href="12859_2019_2947_Fig8_HTML" id="MO8"/></fig></p>
      <p>We study the Bruchpilot gene (FBgn0259246) as a specific illustration of a candidate gene with coupled events exhibiting overestimation-to-underestimation trend in SUPPA’s <italic>Δ</italic><italic>PSI</italic>s on Drosophila sample SRR3332174. Figure <xref rid="Fig9" ref-type="fig">9</xref> shows three panels: (top panel) the read coverage of the genomic region of the gene by IGV alongside the 9 annotated transcripts, (bottom left panel) the segments visualization and its counts along with the transcripts abundances estimated by Kallisto, (bottom right panel) the <italic>PSI</italic> values of the coupled events E1, E2 calculated by SUPPA, Yanagi and rMATS. The read coverage for both events supports Yanagi’s results rather than SUPPA’s. The overestimation of one particular transcript, NM_001259298.2 (T.5059 in figure), can be one potential cause of such deviation. As the read coverage panel shows, most of the reads supporting that transcript are in fact coming from the first coding exon (its junction segment is highlighted grey) whereas the rest of the junctions, e.g. the skipping junction in E1, does not show sufficient coverage supporting its high abundance estimated by Kallisto. One possible explanation is that the annotation is missing isoform X (colored green on the top panel). It is the same as the present transcript T.5059 except it combines the skipping splicing for E1 and the inclusion splicing for E2. The inclusion of isoform X in the annotation during transcript abundance estimation would have directed most reads aligned to the first exon towards isoform X rather than T.5059 for a more consistent coverage over both transcripts. Consequently, SUPPA’s <italic>PSI</italic> values for both E1 and E2 would align better with Yanagi and rMATS values.
<fig id="Fig9"><label>Fig. 9</label><caption><p>The <italic>Bruchpilot</italic> gene in <italic>Drosophila melanogaster</italic> (SRR3332174) serves as an example of a gene likely to have incomplete annotation. (<bold>Bottom-Right</bold>) The <italic>PSI</italic> values of the coupled events E1 and E2 exhibit severe overestimation and underestimation, respectively, by transcript-based approaches compared to Yanagi and rMATS. (<bold>Top</bold>) illustrates read coverage across the gene prepared using IGV, aligned with the 9 annotated isoforms. (<bold>Bottom-Left</bold>) The segments visualization of the gene is compared to transcript-level expression (TPM) obtained from kallisto, and the segment counts (normalized) from Yanagi’s pipeline. Refer to section <xref rid="Sec14" ref-type="sec">3</xref> for details on this panel’s components. Postulating a isoform X (shown as a green-colored track on the top panel) missing from the annotation explains the deviation in both <italic>PSI</italic> values and the inconsistency in coverage across transcript T.5059</p></caption><graphic xlink:href="12859_2019_2947_Fig9_HTML" id="MO9"/></fig></p>
    </sec>
    <sec id="Sec18">
      <title>Comparing segment-based PSI values with counting-based and isoform-based PSI values</title>
      <p>Here we are comparing PSI values obtained from Yanagi (See “<xref rid="Sec26" ref-type="sec">Segment-based calculation of PSI</xref>” section) versus counting-based approaches like rMATS and isoform-based approaches like SUPPA on a very controlled setting. In that setting, we expect no significant difference between measures obtained from each of the three approaches. We used the simulation of switching abundance dataset (SwitchTx dataset in “<xref rid="Sec27" ref-type="sec">Simulation Datasets</xref>” section). Since each tool provides separate set of events, we focus our comparison on the intersection set of events between SUPPA and rMATS. That includes events from five types of splicing events. Table <xref rid="Tab2" ref-type="table">2</xref> summarizes the number of events subject to the study. Two levels of filtering are applied to observe how the different approaches behave in different scenarios. Non-overlapping events is the smallest subset of events. Those events exclude complex splicings where more than two splicings define the event. While highTPM events is a subset of events in which inclusion and exclusion isoform levels are relatively high (<italic>TPM</italic><sub><italic>inc</italic></sub>&gt;1,<italic>TPM</italic><sub><italic>ex</italic></sub>&gt;1). This is a typical filtering criterion adopted by isoform-based approaches. This filter excludes events involving isoforms of low levels of expression which inherently suffer from low estimation accuracy. Note that when complex events are included, they are treated as a set of separate binary events.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Running time (seconds) and memory usage (gigabytes) by Yanagi to generate segment library for fruit fly (BDGP6) and human (GRCh38) genomes, for both the preprocessing and segmentation steps</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left" colspan="2">BDGP6</th><th align="left"/><th align="left" colspan="2">GRCh38</th></tr><tr><th align="left"/><th align="left">time(s)</th><th align="left">memory(GB)</th><th align="left"/><th align="left">time(s)</th><th align="left">memory(GB)</th></tr></thead><tbody><tr><td align="justify">Preprocessing</td><td align="left">13</td><td align="left">0.9</td><td align="left"/><td align="left">112</td><td align="left">1.5</td></tr><tr><td align="justify">Segmentation</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="justify">L=40</td><td align="left">20</td><td align="left">0.4</td><td align="left"/><td align="left">248</td><td align="left">1.3</td></tr><tr><td align="justify">L=108</td><td align="left">20</td><td align="left">0.4</td><td align="left"/><td align="left">250</td><td align="left">1.3</td></tr><tr><td align="justify">L=1000</td><td align="left">20</td><td align="left">0.4</td><td align="left"/><td align="left">228</td><td align="left">1.3</td></tr><tr><td align="justify">L=10000</td><td align="left">8.5</td><td align="left">0.4</td><td align="left"/><td align="left">77</td><td align="left">1.3</td></tr><tr><td align="justify" colspan="6">Rapmap Indexing (4 Threads)</td></tr><tr><td align="justify">L=108</td><td align="left">103</td><td align="left">0.8</td><td align="left"/><td align="left">420</td><td align="left">2.6</td></tr><tr><td align="justify">Txs</td><td align="left">121</td><td align="left">1.1</td><td align="left"/><td align="left">480</td><td align="left">3.7</td></tr><tr><td align="justify" colspan="6">Rapmap Quantification (8 Threads)</td></tr><tr><td align="justify">L=108</td><td align="left">236</td><td align="left">0.7</td><td align="left"/><td align="left">220</td><td align="left">2.1</td></tr><tr><td align="justify">Txs</td><td align="left">292</td><td align="left">1.2</td><td align="left"/><td align="left">416</td><td align="left">3.1</td></tr></tbody></table><table-wrap-foot><p>Time for the preprocessing step does not include the time to load the FASTA and GTF files. Most of the memory usage is from loading the input data in both steps. Running on a 6-core 2.1 GHz AMD processor, using single-threaded processes. The lower half shows the time and memory usage for running Rapmap’s quasi-mapping using the segments library and the the full transcriptome, to quantify samples of 40M paired-end reads, each of length 101bp.</p></table-wrap-foot></table-wrap></p>
      <p>Figure <xref rid="Fig10" ref-type="fig">10</xref> (Top) shows a scatter plot of PSI values calculated by the three approaches for all events. Separate plots for the filtered events in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5. Among the five different splicing types exon skipping, alternative 3’ and alternative 5’ events give the highest correlation between segment counts and rMATS approaches. In our experiments we noticed that rMATS (v4.0.1) does not behave as intended for intron retention events. We noticed that counts including junction reads only and counts including both junction and intron reads (which we use in this study) are the same. In other words, rMATS fails to report reads spanning the intron, which explains the underestimated inclusion counts and PSI values for retained introns.
<fig id="Fig10"><label>Fig. 10</label><caption><p>(<bold>Top</bold>) Comparing PSI values calculated using segment counts versus rMATS (first row), segment counts vs SUPPA (second row) and rMATS versus SUPPA (third row) on human samples from SwitchTx simulated dataset. Columns indicate seven types of alternative splicing events. (<bold>Bottom</bold>) Comparing ROC curves for differential alternative splicing using segment counts, rMATS and SUPPA for simulation dataset of switched abundance. Plots are stratified by event types. See Table <xref rid="Tab2" ref-type="table">2</xref> for number of events of each AS event type shown</p></caption><graphic xlink:href="12859_2019_2947_Fig10_HTML" id="MO10"/></fig></p>
      <p>It should be noted that most count-based approaches require aligning to the genome which is usually the bottle-neck process in the pipeline that some try to overcome in the expense of storage by storing large intermediate data (BAM files). The major motivation of transcript-based approaches is to achieve fast and light-weight pipelines that is not that expensive in terms of time and memory. For instance, even when using STAR, which is one of the fastest genome mappers in the field, using pseudo-alignment tools can be several orders of magnitude faster (or efficient in terms of storage and memory). That is why our segments approach is unique in leveraging such light-weight tools that utilizes pseudo-alignment algorithms with the capability of obtaining local measurements.</p>
      <sec id="Sec19">
        <title>Segment-based Differential Alternative Splicing</title>
        <p>Since the scope of this paper is to introduce the use of segment counts as a statistic for studying alternative splicing, we want to use the simplest statistical model for differential splicing to exclude any advantage obtained by the model itself. In that matter we used the PSI values of the three approaches (SCs, rMATS, SUPPA) as discussed in the previous section. Then we used a linear model for differential hypothesis testing (implemented with Limma-voom R Package [<xref ref-type="bibr" rid="CR32">32</xref>, <xref ref-type="bibr" rid="CR33">33</xref>]). However, more advanced models of differential analysis can be used instead. For example, a similar model to SUPPA2 can be developed to test the significance of <italic>Δ</italic><italic>PSI</italic> by considering all events genome-wide [<xref ref-type="bibr" rid="CR29">29</xref>]. Figure <xref rid="Fig10" ref-type="fig">10</xref> (Bottom) shows ROC plots for sensitivity and specificity measures. Using segment counts achieves comparable performance to both rMATS and isoform-based approaches in that setting.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec20" sec-type="discussion">
    <title>Discussion</title>
    <p>Recent efforts like recount2 [<xref ref-type="bibr" rid="CR34">34</xref>] and refine.bio [<xref ref-type="bibr" rid="CR35">35</xref>] provide comprehensive uniformly processed summary data for large repositories of RNA-seq data. refine.bio uses psuedo-mapping procedures to process data and thus provide statistics at transcript level resulting from a transcript quantification step. This precludes the direct use of these data in downstream analyses where transcript quantification is not essential. Recount2 provides data as exon and junction-level counts but requires genome alignment procedures which are computationally heavier and prone to errors (e.g. in the case of extremely small exons). Our proposed segment approach provides a useful compromise for these large-scale uniform data catalogs between using lightweight pseudo-mapping and providing data directly usable in a variety of expression analyses.</p>
    <p>Recent work done on alternative splicing, e.g. Whippet [<xref ref-type="bibr" rid="CR36">36</xref>] and ASGAL [<xref ref-type="bibr" rid="CR37">37</xref>], may seem similar to Yanagi’s approach since they all rely on processing the splice graph. ASGAL uses graph-based alignment approach to align reads directly into the splice graph which may introduce more complexity processing and traversing the graph. Whippet prepares and indexes what it defines as contiguous splice graph (CSG) before linear alignment of reads is performed. Both methods are built solely for the purpose of alternative splicing analysis. Yanagi’s motivation and objective is different. It is important to note that the intent of this work is not to propose another alternative splicing method, but rather to introduce a conceptual framework that extends pseudo-alignment techniques through decoupling the alignment and quantification steps to generate statistics suitable to a variety of downstream analyses, including alternative splicing.</p>
    <p>Alternative Splicing (AS) methods that use transcript abundance, provided that a complete transcript annotation and a transcript quantification method that sufficiently addresses coverage bias across a transcript is used, can provide an advantage over methods that only use local information for AS analysis, including AS based on segment counts produced by Yanagi. Nonetheless, as we discussed elsewhere in the manuscript, there is no loss of information in segment counts and they may be used to perform transcript quantification or as statistics into a AS method that borrows information across splicing events to take advantage of their correlation.</p>
    <p>This type of extension on the use of segment counts to perform transcript quantification is a fruitful direction for future research. Another interesting extension of our work would be to study the use of segments in discovering novel transcripts. Using paired-end reads mapped to two segments that do not share any common transcripts can be a potential direction.</p>
    <p>For the moment, analysts using ultra-fast pseudo-mapping will need to decide if they prefer possible loss of performance in AS analysis from using only local information, or from using an incomplete annotation. We believe that the results we show in our paper are informative in this situation. In Section 2.6, we showed how severely an incomplete annotation can decrease the correlation of PSI estimates with the truth (0.6 compared to 0.9 when using segments). Incomplete annotations are common in species with multiple introns per gene because the standard is to report a parsimonious set of transcripts rather than a complete set that represents all combinations of local splicing choices. We also showed in Section 2.8 an analysis on simulated data where the annotation is complete comparing the performance of the segments approach to an approach that makes use of information from other parts of the transcript (SUPPA). We observed that segment-based PSIs, that didn’t use the information in the other parts of the transcript unlike transcript-based PSIs, obtain a 0.92 correlation with those PSI values estimated using that information. Given these results indicating there is greater loss of performance when using an incomplete annotation compared to the exclusive use of local information, we suggest that a conservative approach based on segment counts, which is more robust to incomplete annotation, is used for AS analysis.</p>
    <p>The current version of Yanagi, discussed here, generates L-disjoint segments from gene independently, since that is arguably the major cause of ambiguity from multimapping reads. However, other sources of ambiguity (such as overlapping genes and paralogs) are also of interest. That can be tackled in future versions by processing multiple genes simultaneously in the segmentation step.</p>
    <p>Here we have discussed the use of segments and segment counts in two resolutions of RNA-seq analysis: gene level expression estimates and local alternative splicing. We demonstrated comparable results while avoiding the transcript quantification step completely. A natural extension to our work is to study the use of segments into the middle resolution of transcript level analysis. We hypothesize that the usage of segments can simplify the task of transcript abundance estimation and enable simpler incorporation of different sources of bias. Consequently, downstream analyses where quantification is appropriate are still available after generating segment-level counts.</p>
  </sec>
  <sec id="Sec21" sec-type="conclusion">
    <title>Conclusions</title>
    <p>In this paper we have formalized the concept of transcriptome segmentation and proposed an efficient algorithm for generating segment libraries from transcript libraries based on a length parameter <italic>L</italic> (typically chosen dependent on an experiment-specific RNA-seq library construction). The resulting segment sequences are used with pseudo-alignment tools to quantify expression at the segment level, providing sufficient information for a variety of expression analyses. We have characterized segment libraries for the reference transcriptomes of <italic>Drosophila melanogaster</italic> and <italic>Homo sapiens</italic> for various read-length RNA-seq experimental designs. We also provide a novel gene-level visualization of transcriptome segments and transcript structure for ease of interpretation. Finally, we have demonstrated the use of segment-level quantification in differential gene expression and alternative splicing analysis.</p>
    <p>Using a segment library rather than the standard transcriptome succeeds in significantly reducing ambiguous alignments where reads are multi-mapped to several sequences in the reference, thereby decoupling the pseudo-alignment and quantification steps used in current k-mer based pipelines for gene expression analysis. Moreover, using segment counts as statistics for gene-level differential expression and alternative splicing analyses achieves performance comparable to counting-based approaches (e.g. rMATS for splicing analysis) while using fast and lightweight pseudo-alignment. The notion of transcript segmentation as introduced here and implemented in Yanagi has the potential to extend the application of lightweight, ultra-fast, pseudo-alignment algorithms to a wider variety of RNA-seq analyses.</p>
  </sec>
  <sec id="Sec22">
    <title>Methods</title>
    <sec id="Sec23">
      <title>Transcriptome Segmentation</title>
      <p>Figure <xref rid="Fig1" ref-type="fig">1</xref> shows a typical situation in RNA-seq data analysis and provides an overview of the transcript segmentation strategy. In particular, it summarizes how reads that would be multi-mapped when aligning to a transcript library would be aligned to segments. In the latter case, all reads are aligned to a single target sequence and read counts are obtained per segment without the need of probabilistic quantification methods to resolve ambiguity. The next few subsections present specifics of the Yanagi [<xref ref-type="bibr" rid="CR38">38</xref>] method for transcriptome segmentation.</p>
    </sec>
    <sec id="Sec24">
      <title>Segments Properties</title>
      <p>Yanagi’s objective is to generate a minimal set of disjoint sequences (where disjointness is parameterized by <italic>L</italic>, which is typically chosen to be the experimental sequencing read length), while maintaining transcriptome sequence completeness.</p>
      <p>The following definitions are for a given transcriptome T, and parameter L.</p>
      <sec id="d29e1725">
        <title>
          <bold>Definition 1</bold>
        </title>
        <p>(A Segment) A segment <italic>seg</italic> defined by the tuple 〈<italic>ex</italic><italic>s,l</italic><italic>o</italic><italic>c,w</italic>〉 is a genomic region of width <italic>w</italic> beginning at genomic location <italic>loc</italic> and spanning the sequence of consecutive exonic regions <italic>ex</italic><italic>s</italic>∈<italic>Exs</italic><sub><italic>T</italic></sub> (either exons or retained introns). Exonic regions are considered consecutive if they are consecutively spliced into at least one possible isoform in T. And for all segments in a segment library <italic>S</italic><sub><italic>T,L</italic></sub>, its width <italic>w</italic> is at least <italic>L</italic> bases.</p>
      </sec>
      <sec id="d29e1774">
        <title>
          <bold>Definition 2</bold>
        </title>
        <p>(Segments Sequences Completeness) The set of segments <italic>S</italic><sub><italic>T,L</italic></sub> is <italic>Complete</italic> if and only if 
<disp-formula id="Equa"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned} seq \in S_{T, L}; \forall seq \in &amp; {Substring}({T}), len(seq) \leq L\\ &amp;\text{and}\\ seq \in {Substring}({T}); &amp;\forall seq \in {Substring}(S_{T, L}) \end{aligned} $$ \end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtext mathvariant="italic">seq</mml:mtext><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mo>∀</mml:mo><mml:mtext mathvariant="italic">seq</mml:mtext><mml:mo>∈</mml:mo></mml:mtd><mml:mtd><mml:mtext mathvariant="italic">Substring</mml:mtext><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mtext mathvariant="italic">len</mml:mtext><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">seq</mml:mtext><mml:mo>)</mml:mo><mml:mo>≤</mml:mo><mml:mi>L</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>and</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext mathvariant="italic">seq</mml:mtext><mml:mo>∈</mml:mo><mml:mtext mathvariant="italic">Substring</mml:mtext><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo><mml:mo>;</mml:mo></mml:mtd><mml:mtd><mml:mo>∀</mml:mo><mml:mtext mathvariant="italic">seq</mml:mtext><mml:mo>∈</mml:mo><mml:mtext mathvariant="italic">Substring</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2019_2947_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="d29e1890">
        <title>
          <bold>Definition 3</bold>
        </title>
        <p>(L-disjoint Segments) Each segment in the set <italic>S</italic><sub><italic>T,L</italic></sub> is <italic>L-disjoint</italic> if and only if <italic>width</italic>[<italic>overlap</italic>(<italic>seg</italic><sub><italic>i</italic></sub>,<italic>seg</italic><sub><italic>j</italic></sub>)]&lt;<italic>L</italic>;∀<italic>seg</italic><sub><italic>i</italic></sub>,<italic>seg</italic><sub><italic>j</italic></sub>∈<italic>S,i</italic>≠<italic>j</italic></p>
        <p>The L-disjointness property restricts any pair of <italic>L-disjoint</italic> segments to have an overlap region shorter than parameter <italic>L</italic>, which typically equals to the sequencing read length. In other words, no read of length at least <italic>L</italic> can be mapped to both segments of an <italic>L-disjoint</italic> segment pair, assuming error-free reads.</p>
        <p>Another property of the generated segments is to be maximal. For <italic>seg</italic>:〈<italic>ex</italic><italic>s,l</italic><italic>o</italic><italic>c,w</italic>〉, denote <italic>Txs</italic>(<italic>seg</italic>) as the set intersection of annotated transcripts splicing exons <italic>exs</italic>. We can define a subsumption relationship between segments as <italic>seg</italic><sub>1</sub>≻<italic>seg</italic><sub>2</sub> if and only if <italic>ex</italic><italic>s</italic><sub>1</sub>=<italic>ex</italic><italic>s</italic><sub>2</sub>,<italic>loc</italic><sub>1</sub>=<italic>loc</italic><sub>2</sub>,<italic>Txs</italic>(<italic>seg</italic><sub>1</sub>)=<italic>Txs</italic>(<italic>seg</italic><sub>2</sub>) and <italic>w</italic><sub>1</sub>&gt;<italic>w</italic><sub>2</sub>. With this relationship we can define the following property of a segment library <italic>S</italic><sub><italic>T,L</italic></sub></p>
      </sec>
      <sec id="d29e2051">
        <title>
          <bold>Definition 4</bold>
        </title>
        <p>Maximal Segments For each segment in the set <italic>S</italic><sub><italic>T,L</italic></sub> to be <italic>Maximal</italic>
<italic>seg</italic><sub>1</sub>≻<italic>seg</italic><sub>2</sub>⇒<italic>seg</italic><sub>2</sub>∉<italic>S</italic><sub><italic>T,L</italic></sub>,∀<italic>seg</italic><sub>1</sub>∈<italic>S</italic><sub><italic>T,L</italic></sub>Thus a maximal segment is the longest common sequence of genomic regions starting at <italic>loc</italic>, such that these regions are spliced similarly, i.e. the entire sequence belongs to the same set of transcripts. That is why in Fig. <xref rid="Fig1" ref-type="fig">1</xref><bold>c</bold> segment S5 is extended to include two exons and its junction, while segment S2 is interrupted by the different splicing of Tx1 and Tx2.</p>
      </sec>
    </sec>
    <sec id="Sec25">
      <title>Segmentation Algorithm</title>
      <p>The transcriptome segmentation process can be summarized into three steps: (1) Preprocessing the transcriptome annotation to obtain disjoint exonic bins, (2) Constructing a Segments Graph, and finally (3) Generating the final segments. Transactions in Fig. <xref rid="Fig1" ref-type="fig">1</xref><bold>f</bold> represent these three steps.</p>
      <p>1. <italic>Annotation Preprocessing:</italic></p>
      <p>Yanagi applies a preprocessing step to eliminate overlaps present in the transcriptome reference. Parts of an exon (or a retained intron) can be differentially spliced between isoforms either due alternative 3’/5’ splice sites, or transcription start/end sites. For example, splicing the first and second exons between Tx1 and Tx3 in Fig. <xref rid="Fig1" ref-type="fig">1</xref><bold>f</bold>. This step ensures that any splicing event is occurring either at the beginning or the end of a disjoint exonic bin (henceforth, simply ’exonic bin’), which makes the process of generating maximal L-disjoint segments easier. The preprocessing step is independent from the parameter <italic>L</italic>, so it can be done only once per transcriptome reference.</p>
      <p>2. <italic>Constructing Segments Graph:</italic></p>
      <p>Currently Yanagi builds a separate segment graph for each gene, since there are no alternative splicing events between transcripts of different genes. However, future work may use segment graphs that connect different genes sharing regions of identical sequence length L or greater, but we have yet to address this.</p>
      <sec id="d29e2138">
        <title>
          <bold>Definition 5</bold>
        </title>
        <p>Segments Graph A segment graph <italic>G</italic><sub><italic>T,L</italic></sub> is an acyclic directed graph defined by the pair (<italic>N,E</italic>), where <italic>N</italic> is a set of nodes representing segments, and <italic>E</italic> is the set of directed edges between the nodes. An edge <italic>e</italic>:(<italic>n</italic><sub><italic>i</italic></sub>,<italic>n</italic><sub><italic>j</italic></sub>)∈<italic>E</italic> is created if the segment corresponding to node <italic>n</italic><sub><italic>i</italic></sub> directly precedes the segment corresponding to node <italic>n</italic><sub><italic>j</italic></sub> in some transcript.</p>
        <p>For each gene, the preprocessed Splice graph is parsed to construct a set of segment nodes (review algorithm details in [<xref ref-type="bibr" rid="CR38">38</xref>]). These nodes formulate the segments graph of that gene. Each segment node represents an L-disjoint segment, which is not necessarily a maximal segment.</p>
        <p>3. <italic>Generating Segments:</italic></p>
        <p>To preserve the maximality property, the segments graph is parsed to aggregated segment nodes into the final maximal segments. In a segment graph, if there is an edge from <italic>node</italic><sub><italic>i</italic></sub> to <italic>node</italic><sub><italic>j</italic></sub> while <italic>outdegree</italic>(<italic>node</italic><sub><italic>i</italic></sub>)=<italic>indegree</italic>(<italic>node</italic><sub><italic>j</italic></sub>)=1, that implies that both nodes belong to the same set of transcripts and can be aggregated into a segment that subsumes both nodes. In other words, aggregating nodes along a path in the segment graph bounded by branching points (nodes with indegree or outdegree greater than 1).</p>
        <p>Yanagi reports the segments into a FASTA file. Each sequence represents a maximal L-disjoint segment. Each segment sequence has a header specifying metadata of how each segment was formed, including: gene ID, the set of exonic bins <italic>exs</italic> included in the segment, genome location in the first exonic bin of <italic>exs</italic> where the segment starts, genome location in the last exonic bin of <italic>exs</italic> where the segment ends, and the set of transcripts splicing the segment’s region.</p>
      </sec>
    </sec>
    <sec id="Sec26">
      <title>Segment-based calculation of PSI</title>
      <p>While Yanagi uses the transcriptome annotation to prepare the segments along with the splicing events, it generates mapping between each event and its corresponding segments spanning the event. For each event, Yanagi takes into consideration the transcripts involved and the event genomic coordinates to decide the set of transcriptome segments that correspond to each of the two possibilities of the splicing event. This step becomes complicated in case of overlapping events. The current version of Yanagi selects segments that spans either the event exon or junctions while the segment belong to at least one transcript that undergoes the corresponding splicing.</p>
      <p>After alignment, Yanagi provides segment counts or segment-pair counts in case of paired-end reads. For each splicing event, we calculate the PSI value of event <italic>e</italic> in sample <italic>x</italic> as follows: 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \begin{aligned} PSI(e, x) = \frac{\tilde{C}_{{inc}}(e,x)}{\tilde{C}_{{inc}}(e,x)+\tilde{C}_{{alt}}(e,x)}; \end{aligned}  $$ \end{document}</tex-math><mml:math id="M10"><mml:mtable><mml:mtr><mml:mtd><mml:mtext mathvariant="italic">PSI</mml:mtext><mml:mo>(</mml:mo><mml:mi>e</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">inc</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>e</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">inc</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>e</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">alt</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>e</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>;</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2019_2947_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>
        <disp-formula id="Equ2">
          <label>2</label>
          <alternatives>
            <tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \begin{aligned} \tilde{C}_{{inc}}(e,x) &amp;= \frac{\sum\nolimits_{s \in S_{{inc}}(e)}SC(s,x)}{\sum\nolimits_{s \in S_{{inc}}(e)}len(s)}, \\ \tilde{C}_{{alt}}(e,x) &amp;= \frac{\sum\nolimits_{s \in S_{{alt}}(e)}SC(s,x)}{\sum\nolimits_{s \in S_{{alt}}(e)}len(s)} \end{aligned}  $$ \end{document}</tex-math>
            <mml:math id="M12">
              <mml:mtable>
                <mml:mtr>
                  <mml:mtd>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mover accent="true">
                          <mml:mrow>
                            <mml:mi>C</mml:mi>
                          </mml:mrow>
                          <mml:mo>~</mml:mo>
                        </mml:mover>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext mathvariant="italic">inc</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>(</mml:mo>
                    <mml:mi>e</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>x</mml:mi>
                    <mml:mo>)</mml:mo>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:munder>
                          <mml:mrow>
                            <mml:mo>∑</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>s</mml:mi>
                            <mml:mo>∈</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>S</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext mathvariant="italic">inc</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>(</mml:mo>
                            <mml:mi>e</mml:mi>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:munder>
                        <mml:mtext mathvariant="italic">SC</mml:mtext>
                        <mml:mo>(</mml:mo>
                        <mml:mi>s</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>x</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:munder>
                          <mml:mrow>
                            <mml:mo>∑</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>s</mml:mi>
                            <mml:mo>∈</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>S</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext mathvariant="italic">inc</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>(</mml:mo>
                            <mml:mi>e</mml:mi>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:munder>
                        <mml:mtext mathvariant="italic">len</mml:mtext>
                        <mml:mo>(</mml:mo>
                        <mml:mi>s</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo>,</mml:mo>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mover accent="true">
                          <mml:mrow>
                            <mml:mi>C</mml:mi>
                          </mml:mrow>
                          <mml:mo>~</mml:mo>
                        </mml:mover>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext mathvariant="italic">alt</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>(</mml:mo>
                    <mml:mi>e</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>x</mml:mi>
                    <mml:mo>)</mml:mo>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:munder>
                          <mml:mrow>
                            <mml:mo>∑</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>s</mml:mi>
                            <mml:mo>∈</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>S</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext mathvariant="italic">alt</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>(</mml:mo>
                            <mml:mi>e</mml:mi>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:munder>
                        <mml:mtext mathvariant="italic">SC</mml:mtext>
                        <mml:mo>(</mml:mo>
                        <mml:mi>s</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>x</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:munder>
                          <mml:mrow>
                            <mml:mo>∑</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>s</mml:mi>
                            <mml:mo>∈</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>S</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext mathvariant="italic">alt</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>(</mml:mo>
                            <mml:mi>e</mml:mi>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:munder>
                        <mml:mtext mathvariant="italic">len</mml:mtext>
                        <mml:mo>(</mml:mo>
                        <mml:mi>s</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="12859_2019_2947_Article_Equ2.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>where <italic>S</italic><sub><italic>inc</italic></sub>(<italic>e</italic>) and <italic>S</italic><sub><italic>alt</italic></sub>(<italic>e</italic>) are inclusion and exclusion segments, respectively, and <italic>SC</italic>(<italic>s,x</italic>) is the segment count in the sample. That means segment-based PSI values uses reads spanning both the junctions and the target inclusion exon towards the inclusion count. In fact, read counts can also include reads extended around the event as far as the segment extends on both sides. This extension takes advantage of situations where multiple splicing events are adjacent, in which the segment approach will include as much discriminative reads into the counts to achieve higher levels of confidence when calculating PSI values.</p>
      <p>Finally, as we did here while calculating <italic>PSI</italic> values, one can obtain segment quantification units normalized for sequencing depth and segment length. One way of normalization is to follow similar calculation of <italic>TPM</italic> which is a widely accepted normalized quantification of transcript expressions. However, it may require more sophisticated modeling for length normalization in the presence of complex splicing.</p>
    </sec>
    <sec id="Sec27">
      <title>Simulation Datasets</title>
      <p><bold>Simulation of Switching Abundance (SwitchTx):</bold> We used the simulation data provided by [<xref ref-type="bibr" rid="CR13">13</xref>] for both fruit fly and human organisms (<ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-3766/">E-MTAB-3766</ext-link>). Each dataset consists of six samples from two conditions. Each condition has three replicates. The reads for the replicates are simulated from real RNA-seq samples, to get realistic expression values, after incorporating a variance model and the change required between conditions. The simulation is restricted to protein-coding genes in the primary genome assembly. The difference in transcript usage across conditions was simulated in 1000 genes randomly selected from genes with at least two transcripts and high enough expression levels. For each of these 1000 genes, the expression levels of the two most abundant transcripts is switched across conditions. Refer to [<xref ref-type="bibr" rid="CR13">13</xref>] for full details of the preparation procedure of the dataset.</p>
      <p><bold>Simulation of Incomplete Annotation (IncompTx):</bold> Starting from the transcriptome annotation of the human genome, we searched for candidate cases where one combination of splicing events can be missing from the annotation. For a given gene, a combination of two splicing events (<italic>e</italic><sub>1</sub>,<italic>e</italic><sub>2</sub>) can form a candidate case if two conditions are satisfied. 1) If the two splicing events (ordered by their genomic coordinates) have at least one transcript common in their inclusion splicing <inline-formula id="IEq4"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$T_{1}^{inc} \cap T_{2}^{inc} = T_{c}^{inc}$\end{document}</tex-math><mml:math id="M14"><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">inc</mml:mtext></mml:mrow></mml:msubsup><mml:mo>∩</mml:mo><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">inc</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">inc</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2947_Article_IEq4.gif"/></alternatives></inline-formula> while there are no transcripts common between the inclusion of the first event and exclusion of the second event <inline-formula id="IEq5"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$T_{1}^{inc} \cap T_{2}^{alt} = \phi $\end{document}</tex-math><mml:math id="M16"><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">inc</mml:mtext></mml:mrow></mml:msubsup><mml:mo>∩</mml:mo><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">alt</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>ϕ</mml:mi></mml:math><inline-graphic xlink:href="12859_2019_2947_Article_IEq5.gif"/></alternatives></inline-formula> (which will later form the missing isoform in that gene). 2) If the transcript sets <inline-formula id="IEq6"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$T_{c}^{inc}$\end{document}</tex-math><mml:math id="M18"><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">inc</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2947_Article_IEq6.gif"/></alternatives></inline-formula> and <inline-formula id="IEq7"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$T_{2}^{alt}$\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">alt</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2947_Article_IEq7.gif"/></alternatives></inline-formula> share "long enough" contig in the splice graph between the two events. In our simulation, we searched genes on the forward strand for only combinations of SE, A3, A5 typed events. We used a cutoff of 100bp required for the common contig between the two events to be long enough. 2454 genes were found as candidate cases of possible missing isoforms and were used to simulate the data. In each of these genes a single novel isoform is formed by combining the inclusion splicing path of the first event with the alternative splicing path of the second event. Then we used polyester [<xref ref-type="bibr" rid="CR14">14</xref>] to simulate RNA-seq reads (100bp single end reads) including the novel isoforms which were given high expression levels.</p>
      <p>Experiments run throughout the paper used Ensembl GRCh37 and BDGP5 (unless mentioned otherwise) reference genomes and transcriptomes for human and fruit fly annotations, respectively.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional file</title>
    <sec id="Sec28">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2019_2947_MOESM1_ESM.pdf">
            <label>Additional file 1</label>
            <caption>
              <p>Supplementary Figures and Tables. (PDF 909 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>A3</term>
        <def>
          <p>Alternative 3’splice-site</p>
        </def>
      </def-item>
      <def-item>
        <term>A5</term>
        <def>
          <p>Alternative 5’splice-site</p>
        </def>
      </def-item>
      <def-item>
        <term>AS</term>
        <def>
          <p>Alternative splicing</p>
        </def>
      </def-item>
      <def-item>
        <term>EC</term>
        <def>
          <p>Equivalence class</p>
        </def>
      </def-item>
      <def-item>
        <term>MX</term>
        <def>
          <p>Mutually exclusive exons</p>
        </def>
      </def-item>
      <def-item>
        <term>RI</term>
        <def>
          <p>Retained intron</p>
        </def>
      </def-item>
      <def-item>
        <term>RNA-seq</term>
        <def>
          <p>RNA sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>SC</term>
        <def>
          <p>Segment counts</p>
        </def>
      </def-item>
      <def-item>
        <term>SE</term>
        <def>
          <p>Skipped exon</p>
        </def>
      </def-item>
      <def-item>
        <term>TCC</term>
        <def>
          <p>Transcript compatibility count</p>
        </def>
      </def-item>
      <def-item>
        <term>TPM</term>
        <def>
          <p>Transcripts per million</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We want to thank Julien Buchbinder and Steffen Cornwell for preliminary work in transcript segmentation.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>SMM and HCB conceived the study; HCB, SMM, and MKG, designed the study. HCB and MKG designed all software tools used in the study, MKG implemented all software tools used in the study. MKG acquired all data used and analyzed and interpreted results with HCB. MKG wrote the initial draft of the manuscript, and prepared the final draft of the manuscript along with HCB and SMM. All authors have read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was partially supported by NSF grant ABI 1564785 to SMM, and NIH grants HG005220 and GM114267 to HCB and MKG. No funding body played any role in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Yanagi is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/HCBravoLab/yanagi">https://github.com/HCBravoLab/yanagi</ext-link>. The repository provides all code scripts required to run the segmentation pipeline to obtain segment counts. z Additionally, We provide ready-to-use segment library (FASTA File) for human (Ensembl GRCh37) and fruit fly (Ensembl BDGP6) transcriptomes at 10.5281/zenodo.2646964. The repository (DOI 10.5281/zenodo.2646964) also provides segment counts and analysis scripts used in the experiments shown in this paper.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p>Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p>Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Fast gapped-read alignment with bowtie 2</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <issue>4</issue>
        <fpage>357</fpage>
        <lpage>9</lpage>
        <?supplied-pmid 22388286?>
        <pub-id pub-id-type="pmid">22388286</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Tophat: discovering splice junctions with rna-seq</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>9</issue>
        <fpage>1105</fpage>
        <lpage>11</lpage>
        <?supplied-pmid 19289445?>
        <pub-id pub-id-type="pmid">19289445</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Pertea</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pimentel</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kelley</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Tophat2: accurate alignment of transcriptomes in the presence of insertions, deletions and gene fusions</article-title>
        <source>Genome Biol</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>4</issue>
        <fpage>36</fpage>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Pertea</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Mortazavi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kwan</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Van Baren</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Wold</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Transcript assembly and quantification by rna-seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title>
        <source>Nat Biotechnol</source>
        <year>2010</year>
        <volume>28</volume>
        <issue>5</issue>
        <fpage>511</fpage>
        <lpage>5</lpage>
        <?supplied-pmid 3146043?>
        <pub-id pub-id-type="pmid">20436464</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patro</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Mount</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Kingsford</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Sailfish enables alignment-free isoform quantification from RNA-seq reads using lightweight algorithms</article-title>
        <source>Nature Biotechnol</source>
        <year>2014</year>
        <volume>32</volume>
        <issue>5</issue>
        <fpage>462</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="pmid">24752080</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Srivastava</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sarkar</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Gupta</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Patro</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Rapmap: a rapid, sensitive and accurate tool for mapping rna-seq reads to transcriptomes</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>12</issue>
        <fpage>192</fpage>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bray</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Pimentel</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Melsted</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Near-optimal probabilistic rna-seq quantification</article-title>
        <source>Nat Biotechnol</source>
        <year>2016</year>
        <volume>34</volume>
        <issue>5</issue>
        <fpage>525</fpage>
        <lpage>7</lpage>
        <?supplied-pmid 27043002?>
        <pub-id pub-id-type="pmid">27043002</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patro</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Duggal</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Kingsford</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Salmon provides fast and bias-aware quantification of transcript expression</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>4</issue>
        <fpage>417</fpage>
        <lpage>419</lpage>
        <?supplied-pmid 28263959?>
        <pub-id pub-id-type="pmid">28263959</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dewey</surname>
            <given-names>CN</given-names>
          </name>
        </person-group>
        <article-title>Rsem: accurate transcript quantification from rna-seq data with or without a reference genome</article-title>
        <source>BMC bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>323</fpage>
        <?supplied-pmid 21816040?>
        <pub-id pub-id-type="pmid">21816040</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zipursky</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Wojtowicz</surname>
            <given-names>WM</given-names>
          </name>
          <name>
            <surname>Hattori</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Got diversity? wiring the fly brain with dscam</article-title>
        <source>Trends Biochem Sci</source>
        <year>2006</year>
        <volume>31</volume>
        <issue>10</issue>
        <fpage>581</fpage>
        <lpage>8</lpage>
        <?supplied-pmid 16919957?>
        <pub-id pub-id-type="pmid">16919957</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tilgner</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Jahanbani</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Blauwkamp</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Moshrefi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jaeger</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Harel</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bustamante</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Rasmussen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>MP</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive transcriptome analysis using synthetic long-read sequencing reveals molecular co-association of distant splicing events</article-title>
        <source>Nat Biotechnol</source>
        <year>2015</year>
        <volume>33</volume>
        <issue>7</issue>
        <fpage>736</fpage>
        <lpage>42</lpage>
        <?supplied-pmid 25985263?>
        <pub-id pub-id-type="pmid">25985263</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haas</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Delcher</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Mount</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Wortman</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Smith Jr</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Hannick</surname>
            <given-names>LI</given-names>
          </name>
          <name>
            <surname>Maiti</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ronning</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Rusch</surname>
            <given-names>DB</given-names>
          </name>
          <name>
            <surname>Town</surname>
            <given-names>CD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improving the arabidopsis genome annotation using maximal transcript alignment assemblies</article-title>
        <source>Nucleic Acids Res</source>
        <year>2003</year>
        <volume>31</volume>
        <issue>19</issue>
        <fpage>5654</fpage>
        <lpage>66</lpage>
        <?supplied-pmid 14500829?>
        <pub-id pub-id-type="pmid">14500829</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soneson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Matthes</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Nowicka</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Law</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>Isoform prefiltering improves performance of count-based methods for analysis of differential transcript usage</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>12</fpage>
        <?supplied-pmid 26813113?>
        <pub-id pub-id-type="pmid">26813113</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frazee</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Jaffe</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Leek</surname>
            <given-names>JT</given-names>
          </name>
        </person-group>
        <article-title>Polyester: simulating rna-seq datasets with differential transcript expression</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>17</issue>
        <fpage>2778</fpage>
        <lpage>84</lpage>
        <?supplied-pmid 25926345?>
        <pub-id pub-id-type="pmid">25926345</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Moderated estimation of fold change and dispersion for rna-seq data with deseq2</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>12</issue>
        <fpage>550</fpage>
        <?supplied-pmid 25516281?>
        <pub-id pub-id-type="pmid">25516281</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Differential expression analysis of multifactor rna-seq experiments with respect to biological variation</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <issue>10</issue>
        <fpage>4288</fpage>
        <lpage>97</lpage>
        <?supplied-pmid 3378882?>
        <pub-id pub-id-type="pmid">22287627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hendrickson</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Sauvageau</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Goff</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Rinn</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Differential analysis of gene regulation at transcript resolution with rna-seq</article-title>
        <source>Nat Biotechnol</source>
        <year>2013</year>
        <volume>31</volume>
        <issue>1</issue>
        <fpage>46</fpage>
        <?supplied-pmid 23222703?>
        <pub-id pub-id-type="pmid">23222703</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <mixed-citation publication-type="other">Froussios K, Mourão K, Schurch NJ, Barton GJ. Identifying differential isoform abundance with rats: a universal tool and a warning. bioRxiv. 2017. 10.1101/132761. <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/early/2017/05/01/132761.full.pdf">https://www.biorxiv.org/content/early/2017/05/01/132761.full.pdf</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pimentel</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bray</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Gene-level differential analysis at transcript-level resolution</article-title>
        <source>Genome Biol</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>53</fpage>
        <?supplied-pmid 29650040?>
        <pub-id pub-id-type="pmid">29650040</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Reyes</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Detecting differential usage of exons from rna-seq data</article-title>
        <source>Genome Res</source>
        <year>2012</year>
        <volume>22</volume>
        <issue>10</issue>
        <fpage>2008</fpage>
        <lpage>17</lpage>
        <?supplied-pmid 22722343?>
        <pub-id pub-id-type="pmid">22722343</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dobin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Schlesinger</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Drenkow</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zaleski</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jha</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Batut</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Chaisson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gingeras</surname>
            <given-names>TR</given-names>
          </name>
        </person-group>
        <article-title>Star: ultrafast universal rna-seq aligner</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>1</issue>
        <fpage>15</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="pmid">23104886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soneson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>Differential analyses for rna-seq: transcript-level estimates improve gene-level inferences</article-title>
        <source>F1000Research</source>
        <year>2015</year>
        <volume>4</volume>
        <fpage>1521</fpage>
        <?supplied-pmid 26925227?>
        <pub-id pub-id-type="pmid">26925227</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schafer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Miao</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Benson</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Heinig</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Cook</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Hubner</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Alternative splicing signatures in rna-seq data: Percent spliced in (psi)</article-title>
        <source>Curr Protoc Hum Genet</source>
        <year>2015</year>
        <volume>22</volume>
        <fpage>11</fpage>
        <lpage>16</lpage>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Loraine</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Dickerson</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Comparisons of computational methods for differential alternative splicing detection using rna-seq in plant systems</article-title>
        <source>BMC bioinformatics</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>1</issue>
        <fpage>364</fpage>
        <?supplied-pmid 25511303?>
        <pub-id pub-id-type="pmid">25511303</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>Z-X</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Henry</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>YN</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Xing</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>rmats: robust and flexible detection of differential alternative splicing from replicate rna-seq data</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2014</year>
        <volume>111</volume>
        <issue>51</issue>
        <fpage>5593</fpage>
        <lpage>601</lpage>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vaquero-Garcia</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Barrera</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gazzara</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Gonzalez-Vallinas</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lahens</surname>
            <given-names>NF</given-names>
          </name>
          <name>
            <surname>Hogenesch</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Lynch</surname>
            <given-names>KW</given-names>
          </name>
          <name>
            <surname>Barash</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Valcárcel</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A new view of transcriptome complexity and regulation through the lens of local splicing variations</article-title>
        <source>eLife</source>
        <year>2016</year>
        <volume>5</volume>
        <fpage>11752</fpage>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Du</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Orellana</surname>
            <given-names>CF</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Monroy</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kuan</surname>
            <given-names>P-F</given-names>
          </name>
          <name>
            <surname>Hammond</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Makowski</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Diffsplice: the genome-wide detection of differential splicing events with rna-seq</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>41</volume>
        <issue>2</issue>
        <fpage>39</fpage>
        <lpage>9</lpage>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alamancos</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Pagès</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Trincado</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Bellora</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Eyras</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Leveraging transcript quantification for fast computation of alternative splicing profiles</article-title>
        <source>RNA</source>
        <year>2015</year>
        <volume>21</volume>
        <issue>9</issue>
        <fpage>1521</fpage>
        <lpage>1531</lpage>
        <?supplied-pmid 26179515?>
        <pub-id pub-id-type="pmid">26179515</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trincado</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Entizne</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Hysenaj</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Skalic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Elliott</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Eyras</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>SUPPA2: fast, accurate, and uncertainty-aware differential splicing analysis across multiple conditions</article-title>
        <source>Genome Biol</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>40</fpage>
        <?supplied-pmid 29571299?>
        <pub-id pub-id-type="pmid">29571299</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lahens</surname>
            <given-names>NF</given-names>
          </name>
          <name>
            <surname>Kavakli</surname>
            <given-names>IH</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hayer</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Black</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Dueck</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Pizarro</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>RS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ivt-seq reveals extreme bias in rna sequencing</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>6</issue>
        <fpage>86</fpage>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Hogenesch</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Modeling of rna-seq fragment sequence bias reduces systematic errors in transcript abundance estimation</article-title>
        <source>Nat Biotechnol</source>
        <year>2016</year>
        <volume>34</volume>
        <issue>12</issue>
        <fpage>1287</fpage>
        <?supplied-pmid 27669167?>
        <pub-id pub-id-type="pmid">27669167</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Linear models and empirical bayes methods for assessing differential expression in microarray experiments</article-title>
        <source>Stat Appl Genet Mol Biol</source>
        <year>2004</year>
        <volume>3</volume>
        <issue>1</issue>
        <fpage>3</fpage>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Law</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Voom: precision weights unlock linear model analysis tools for rna-seq read counts</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>2</issue>
        <fpage>29</fpage>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Collado-Torres</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Nellore</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kammers</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ellis</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Taub</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Hansen</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Jaffe</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Leek</surname>
            <given-names>JT</given-names>
          </name>
        </person-group>
        <article-title>Reproducible rna-seq analysis using recount2</article-title>
        <source>Nat Biotechnol</source>
        <year>2017</year>
        <volume>35</volume>
        <issue>4</issue>
        <fpage>319</fpage>
        <lpage>21</lpage>
        <?supplied-pmid 28398307?>
        <pub-id pub-id-type="pmid">28398307</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <mixed-citation publication-type="other">(CCDL) CCDL. Harmonized, ready-to-use transcriptome data from publicly available sources. <ext-link ext-link-type="uri" xlink:href="https://www.refine.bio/">https://www.refine.bio/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sterne-Weiler</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Weatheritt</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Best</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Ha</surname>
            <given-names>KCH</given-names>
          </name>
          <name>
            <surname>Blencowe</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>Efficient and accurate quantitative profiling of alternative splicing patterns of any complexity on a laptop</article-title>
        <source>Mol Cell</source>
        <year>2018</year>
        <volume>72</volume>
        <issue>1</issue>
        <fpage>187</fpage>
        <lpage>2006</lpage>
        <?supplied-pmid 30220560?>
        <pub-id pub-id-type="pmid">30220560</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Denti</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Rizzi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Beretta</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Vedova</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Previtali</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bonizzoni</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Asgal: aligning rna-seq data to a splicing graph to detect novel alternative splicing events</article-title>
        <source>BMC Bioinformatics</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>444</fpage>
        <?supplied-pmid 30458725?>
        <pub-id pub-id-type="pmid">30458725</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Gunady</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Cornwell</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mount</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Bravo</surname>
            <given-names>HC</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>In: Schwartz</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>K.</given-names>
          </name>
        </person-group>
        <article-title>Yanagi: Transcript Segment Library Construction for RNA-Seq Quantification</article-title>
        <source>17th International Workshop on Algorithms in Bioinformatics (WABI 2017). Leibniz International Proceedings in Informatics (LIPIcs)</source>
        <year>2017</year>
        <publisher-loc>Dagstuhl, Germany</publisher-loc>
        <publisher-name>Schloss Dagstuhl–Leibniz-Zentrum fuer Informatik</publisher-name>
      </element-citation>
    </ref>
  </ref-list>
</back>
