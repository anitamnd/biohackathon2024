<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5860205</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btx576</article-id>
    <article-id pub-id-type="publisher-id">btx576</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genetics and Population Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>LinkageMapView—rendering high-resolution linkage and QTL maps</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ouellette</surname>
          <given-names>Lisa A</given-names>
        </name>
        <xref ref-type="corresp" rid="btx576-cor1"/>
        <!--<email>louellet@uncc.edu</email>-->
        <xref ref-type="aff" rid="btx576-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-7125-7151</contrib-id>
        <name>
          <surname>Reid</surname>
          <given-names>Robert W</given-names>
        </name>
        <xref ref-type="aff" rid="btx576-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Blanchard</surname>
          <given-names>Steven G</given-names>
        </name>
        <xref ref-type="aff" rid="btx576-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Brouwer</surname>
          <given-names>Cory R</given-names>
        </name>
        <xref ref-type="aff" rid="btx576-aff1"/>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Stegle</surname>
          <given-names>Oliver</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btx576-aff1">Department of Bioinformatics and Genomics, University of North Carolina Charlotte, Kannapolis, NC, USA</aff>
    <author-notes>
      <corresp id="btx576-cor1">To whom correspondence should be addressed. Email: <email>louellet@uncc.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>1</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-09-13">
      <day>13</day>
      <month>9</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>9</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>34</volume>
    <issue>2</issue>
    <fpage>306</fpage>
    <lpage>307</lpage>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>2</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>26</day>
        <month>5</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>9</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="cc-by">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btx576.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Linkage and quantitative trait loci (QTL) maps are critical tools for the study of the genetic basis of complex traits. With the advances in sequencing technology over the past decade, linkage map densities have been increasing dramatically, while the visualization tools have not kept pace. LinkageMapView is a free add-on package written in R that produces high resolution, publication-ready visualizations of linkage and QTL maps. While there is software available to generate linkage map graphics, none are freely available, produce publication quality figures, are open source and can run on all platforms. LinkageMapView can be integrated into map building pipelines as it seamlessly incorporates output from R/qtl and also accepts simple text or comma delimited files. There are numerous options within the package to build highly customizable maps, allow for linkage group comparisons, and annotate QTL regions.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>
          <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/LinkageMapView/">https://cran.r-project.org/web/packages/LinkageMapView/</ext-link>
        </p>
      </sec>
    </abstract>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Linkage studies over the years have been producing genetic maps (linkage maps) that act as invaluable tools in areas of genetic disease detection, anchoring genome sequence assemblies and elucidating genetic mechanisms of agronomical important traits in plants. The advent of high-throughput sequencing has allowed for better marker identification and greater map densities. This is a desirable outcome for solving many genetics based problems but visualizing these maps creates a new challenge. As the marker density increases, it becomes difficult to add labels, QTL regions and centimorgan values and still maintain readability.</p>
    <p>There is existing software that generates linkage and QTL maps and these fall into three categories. Rudimentary maps are available in software where the primary objective is QTL analysis. For example, R/qtl (<xref rid="btx576-B1" ref-type="bibr">Broman <italic>et al.</italic>, 2003</xref>) is widely used for QTL analysis but the plot functionality is not a strength. High-quality maps can be produced with feature-rich software such as MapChart (<xref rid="btx576-B5" ref-type="bibr">Voorrips, 2002</xref>). MapChart only runs on Windows. Lastly, there is web-based software like R/qtlcharts (<xref rid="btx576-B2" ref-type="bibr">Broman, 2015</xref>), but it is more useful for interactively exploring linkage and QTL maps. Here, we introduce LinkageMapView, an open source package in R that can produce publication quality genetic maps, can be run on any platform supported by R, and can be incorporated into a user’s existing R-based pipeline.</p>
  </sec>
  <sec>
    <title>2 Software</title>
    <p>LinkageMapView uses R base graphics for plotting, labels and optional colored segments. The main function, lmv.linkage.plot, is the only function a user needs to directly invoke. The generated maps are output in Adobe Portable Document Format (PDF). Because linkage maps can be dense with loci, LinkageMapView has many options that allow the user to reduce extraneous detail, minimize map dimensions, and highlight areas of importance.</p>
  </sec>
  <sec>
    <title>3 Program overview</title>
    <sec>
      <title>3.1 Program input data</title>
      <p>Input to LinkageMapView is a delimited text file with the first three columns containing linkage group name, cM position, and locus. Alternatively, input can be an R/qtl (<xref rid="btx576-B1" ref-type="bibr">Broman <italic>et al.</italic>, 2003</xref>) cross object.</p>
    </sec>
    <sec>
      <title>3.2 Program usage</title>
      <p>To generate the map, a user calls the lmv.linkage.plot function. Parameters allow users to customize most aspects of the map. Users can alter map size, title, fonts, colors and label display to emphasize markers or QTLs of importance. Some common parameters are discussed below.</p>
      <p>mapthese: An ordered vector of linkage group names to print.</p>
      <p>showonly: A vector of loci labels to print. All other loci labels will not be printed although their presence is depicted with a line segment across the chromosome to indicate loci density.</p>
      <p>dupnbr: If TRUE, the first locus name at a position will be shown followed by a count of the duplicate markers at that position.</p>
      <p>ruler: If TRUE, instead of printing position numbers on each chromosome, a ruler is printed on the left side.</p>
      <p>markerformatlist: A list of loci with the desired R font, color, and size for the labels. This list overrides any other specifications for the loci listed.</p>
      <p>qtldf: An optional R data frame containing QTL information:</p>
      <p>autoconnadj: If TRUE (the default), loci with the same name and in adjacent linkage groups will be connected with a line.</p>
      <p>conndf: An optional data frame containing the homologs to connect with a line. If autoconnadj is TRUE, this list will be merged with the automatic list.</p>
      <p>revthese: An optional vector of linkage group names to reverse. The end position becomes position 0 and position 0 becomes the largest position.</p>
      <p>posonleft: An optional boolean vector the length of the number linkage groups to map, indicating if the positions should be plotted on the left (TRUE) or on the right (FALSE).</p>
    </sec>
  </sec>
  <sec>
    <title>4 Results</title>
    <p>The maps from two use cases are shown in <xref ref-type="fig" rid="btx576-F1">Figure 1</xref>.
</p>
    <fig id="btx576-F1" orientation="portrait" position="float">
      <label>Fig. 1</label>
      <caption>
        <p>(<bold>A</bold>) Map from R/qtl (<xref rid="btx576-B1" ref-type="bibr">Broman <italic>et al.</italic>, 2003</xref>) cross object using the hyper sample data from the R/qtl package. (<bold>B</bold>) A comparative map of three populations of carrot (<xref rid="btx576-B3" ref-type="bibr">Cavagnaro <italic>et al.</italic>, 2011</xref>)</p>
      </caption>
      <graphic xlink:href="btx576f1"/>
    </fig>
    <p>The first case (<xref ref-type="fig" rid="btx576-F1">Fig. 1A</xref>) demonstrates using a cross object from R/qtl as input to LinkageMapView (Listing 1) using all default formats.</p>
    <p><bold>Listing 1.</bold> Sample commands to generate linkage group map from R/qtl cross object.</p>
    <p>
      <monospace>library(qtl)</monospace>
    </p>
    <p>
      <monospace>data(hyper)</monospace>
    </p>
    <p><monospace>lmv.linkage.plot(hyper,</monospace>"qtlhyper.pdf"<monospace>, mapthese</monospace> <monospace>=</monospace> <monospace>c(1, 4, 6, 7, 15))</monospace></p>
    <p>The second case (<xref ref-type="fig" rid="btx576-F1">Fig. 1B</xref>) demonstrates using LinkageMapView to produce a comparative map with homologs connected, a QTL mapped, a cM ruler and several color and font options.</p>
  </sec>
  <sec>
    <title>5 Conclusion</title>
    <p>LinkageMapView is a freely available and open source tool to produce publication quality linkage and QTL maps. It is implemented in R to provide easy integration with R QTL analysis programs and so it can be run on any platform. The plethora of options provides the user with flexibility in dealing with high<bold>-</bold>density linkage maps. These characteristics make LinkageMapView more useful than currently available linkage map plotting tools.</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Samantha Case, Scott Smith and Massimo Iorizzo for suggestions and test data.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="btx576-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Broman</surname><given-names>K.W.</given-names></name></person-group><etal>et al</etal> (<year>2003</year>) 
<article-title>R/qtl: QTL mapping in experimental crosses</article-title>. <source>Bioinformatics</source>, <volume>19</volume>, <fpage>889</fpage>–<lpage>890</lpage>.<pub-id pub-id-type="pmid">12724300</pub-id></mixed-citation>
    </ref>
    <ref id="btx576-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Broman</surname><given-names>K.W.</given-names></name></person-group> (<year>2015</year>) 
<article-title>R/qtlcharts: interactive graphics for quantitative trait locus mapping</article-title>. <source>Genetics</source>, <volume>199</volume>, <fpage>359</fpage>–<lpage>361</lpage>.<pub-id pub-id-type="pmid">25527287</pub-id></mixed-citation>
    </ref>
    <ref id="btx576-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cavagnaro</surname><given-names>P.F.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Microsatellite isolation and marker development in carrot—genomic distribution, linkage mapping, genetic diversity analysis and marker transferability across apiaceae</article-title>. <source>BMC Genom</source>., <volume>12</volume>, <fpage>386</fpage>–<lpage>407</lpage>.</mixed-citation>
    </ref>
    <ref id="btx576-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Voorrips</surname><given-names>R.E.</given-names></name></person-group> (<year>2002</year>) 
<article-title>MapChart: software for the graphical presentation of linkage maps and QTLs</article-title>. <source>J. Hered</source>., <volume>93</volume>, <fpage>77</fpage>–<lpage>78</lpage>.<pub-id pub-id-type="pmid">12011185</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
