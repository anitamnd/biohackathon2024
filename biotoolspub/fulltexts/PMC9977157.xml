<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.0 20120330//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Res</journal-id>
    <journal-id journal-id-type="hwp">genome</journal-id>
    <journal-id journal-id-type="publisher-id">GENOME</journal-id>
    <journal-title-group>
      <journal-title>Genome Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1088-9051</issn>
    <issn pub-type="epub">1549-5469</issn>
    <publisher>
      <publisher-name>Cold Spring Harbor Laboratory Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9977157</article-id>
    <article-id pub-id-type="pmid">36657977</article-id>
    <article-id pub-id-type="medline">9509184</article-id>
    <article-id pub-id-type="doi">10.1101/gr.277075.122</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>An efficient genotyper and star-allele caller for pharmacogenomics</article-title>
      <alt-title alt-title-type="left-running">Hari et al.</alt-title>
      <alt-title alt-title-type="right-running">Aldy 4</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Hari</surname>
          <given-names>Ananth</given-names>
        </name>
        <xref rid="af1" ref-type="aff">1</xref>
        <xref rid="af2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhou</surname>
          <given-names>Qinghui</given-names>
        </name>
        <xref rid="af3" ref-type="aff">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gonzaludo</surname>
          <given-names>Nina</given-names>
        </name>
        <xref rid="af4" ref-type="aff">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Harting</surname>
          <given-names>John</given-names>
        </name>
        <xref rid="af4" ref-type="aff">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5720-1864</contrib-id>
        <name>
          <surname>Scott</surname>
          <given-names>Stuart A.</given-names>
        </name>
        <xref rid="af5" ref-type="aff">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Qin</surname>
          <given-names>Xiang</given-names>
        </name>
        <xref rid="af6" ref-type="aff">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Scherer</surname>
          <given-names>Steve</given-names>
        </name>
        <xref rid="af6" ref-type="aff">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sahinalp</surname>
          <given-names>S. Cenk</given-names>
        </name>
        <xref rid="af2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2970-7937</contrib-id>
        <name>
          <surname>Numanagić</surname>
          <given-names>Ibrahim</given-names>
        </name>
        <xref rid="af3" ref-type="aff">3</xref>
      </contrib>
    </contrib-group>
    <aff id="af1"><label>1</label>Department of Electrical and Computer Engineering, University of Maryland, College Park, Maryland 20742, USA;</aff>
    <aff id="af2"><label>2</label>Cancer Data Science Laboratory, National Cancer Institute, National Institutes of Health, Bethesda, Maryland 20892, USA;</aff>
    <aff id="af3"><label>3</label>Department of Computer Science, University of Victoria, Victoria, British Columbia V8P 5C2, Canada;</aff>
    <aff id="af4"><label>4</label>Pacific Biosciences, Menlo Park, California 94025, USA;</aff>
    <aff id="af5"><label>5</label>Department of Pathology, Stanford University, Palo Alto, California 94304, USA;</aff>
    <aff id="af6"><label>6</label>Baylor College of Medicine Human Genome Sequencing Center, Houston, Texas 77030, USA</aff>
    <author-notes>
      <corresp>Corresponding author: <email>inumanag@uvic.ca</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <volume>33</volume>
    <issue>1</issue>
    <fpage>61</fpage>
    <lpage>70</lpage>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>12</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>
        <ext-link xlink:href="http://genome.cshlp.org/site/misc/terms.xhtml" ext-link-type="uri">© 2023 Hari et al.; Published by Cold Spring Harbor Laboratory Press</ext-link>
      </copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This article is distributed exclusively by Cold Spring Harbor Laboratory Press for the first six months after the full-issue publication date (see <ext-link ext-link-type="uri" xlink:href="https://genome.cshlp.org/site/misc/terms.xhtml">https://genome.cshlp.org/site/misc/terms.xhtml</ext-link>). After six months, it is available under a Creative Commons License (Attribution-NonCommercial 4.0 International), as described at <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="61.pdf"/>
    <abstract>
      <p>High-throughput sequencing provides sufficient means for determining genotypes of clinically important pharmacogenes that can be used to tailor medical decisions to individual patients. However, pharmacogene genotyping, also known as star-allele calling, is a challenging problem that requires accurate copy number calling, structural variation identification, variant calling, and phasing within each pharmacogene copy present in the sample. Here we introduce Aldy 4, a fast and efficient tool for genotyping pharmacogenes that uses combinatorial optimization for accurate star-allele calling across different sequencing technologies. Aldy 4 adds support for long reads and uses a novel phasing model and improved copy number and variant calling models. We compare Aldy 4 against the current state-of-the-art star-allele callers on a large and diverse set of samples and genes sequenced by various sequencing technologies, such as whole-genome and targeted Illumina sequencing, barcoded 10x Genomics, and Pacific Biosciences (PacBio) HiFi. We show that Aldy 4 is the most accurate star-allele caller with near-perfect accuracy in all evaluated contexts, and hope that Aldy remains an invaluable tool in the clinical toolbox even with the advent of long-read sequencing technologies.</p>
    </abstract>
    <funding-group>
      <award-group id="funding-1">
        <funding-source>Human Genome Sequencing Center</funding-source>
      </award-group>
      <award-group id="funding-2">
        <funding-source>
          <institution-wrap>
            <institution>Baylor College of Medicine </institution>
            <institution-id institution-id-type="doi">10.13039/100007915</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group id="funding-3">
        <funding-source>Natural Sciences and Engineering Research Council of Canada (NSERC)</funding-source>
        <award-id>RGPIN-04973</award-id>
      </award-group>
      <award-group id="funding-4">
        <funding-source>
          <institution-wrap>
            <institution>Canada Research Chairs </institution>
            <institution-id institution-id-type="doi">10.13039/501100001804</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group id="funding-5">
        <funding-source>Center</funding-source>
      </award-group>
      <award-group id="funding-6">
        <funding-source>for Biomedical Informatics and Information Technology</funding-source>
      </award-group>
      <award-group id="funding-7">
        <funding-source>
          <institution-wrap>
            <institution>National Cancer Institute </institution>
            <institution-id institution-id-type="doi">10.13039/100000054</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group id="funding-8">
        <funding-source>NCI</funding-source>
      </award-group>
      <award-group id="funding-9">
        <funding-source>NCI-UMD Partnership Program</funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <p>The rapid development of high-throughput sequencing (HTS) technologies has ushered in the era of precision medicine that aims to tailor medical decisions at the individual level (<xref rid="GR277075HARC18" ref-type="bibr">Hamburg and Collins 2010</xref>). A key component of precision medicine is pharmacogenomics, which studies the associations between the individual genotypes of clinically important genes (also known as <italic>pharmacogenes</italic>) and individual variation in drug response (<xref rid="GR277075HARC50" ref-type="bibr">Weinshilboum and Wang 2017</xref>). Although the HTS data theoretically provide sufficient means to accurately genotype any gene in a given individual, genotyping of many pharmacogenes remains challenging (<xref rid="GR277075HARC46" ref-type="bibr">Twesigomwe et al. 2020</xref>). One of the key challenges is the fact that many pharmacogenes of vital clinical importance—most notably the <italic>CYP2D6</italic> gene, whose genotype impacts up to 25% of clinically prescribed drugs (<xref rid="GR277075HARC20" ref-type="bibr">Ingelman-Sundberg 2005</xref>)—are highly polymorphic and, furthermore, are located next to the highly similar pseudogenes owing to being located within segmental duplications (<xref rid="GR277075HARC20" ref-type="bibr">Ingelman-Sundberg 2005</xref>). Many of these pharmacogenes are also subject to various copy number and structural changes, for example, through a fusion event between a gene and its pseudogene, possibly owing to the instability of the segmental duplication region wherein they reside (<xref rid="GR277075HARC43" ref-type="bibr">Sezutsu et al. 2013</xref>). These issues need to be carefully and comprehensively accounted for before the genotyping process in order to obtain accurate results. Lastly, alleles of many pharmacogenes are not defined through a single-nucleotide variant (SNV) but through a complete gene haplotype. Thus, the exact functional impact of an allele can only be determined through phasing, or haplotyping, of the whole genic region. In the pharmacogenomics community, haplotyping is commonly known as <italic>star-allele calling</italic> (<xref rid="GR277075HARC39" ref-type="bibr">Robarge et al. 2007</xref>), owing to the fact that most of the known pharmacogenetic haplotypes are assigned a unique star-allele identifier.</p>
  <p>Standard tools for genotyping HTS data sets, such as the Genome Analysis Toolkit (GATK) (<xref rid="GR277075HARC30" ref-type="bibr">McKenna et al. 2010</xref>; <xref rid="GR277075HARC33" ref-type="bibr">Poplin et al. 2017</xref>), cannot be used for star-allele calling because they are unable to haplotype the whole genic regions and assign correct star-alleles. General-purpose computational phasing tools, such as HapCUT2 (<xref rid="GR277075HARC7" ref-type="bibr">Edge et al. 2017</xref>) and HapTree-X (<xref rid="GR277075HARC1" ref-type="bibr">Berger et al. 2020</xref>), are also inadequate for calling star-alleles: Either these tools are designed for phasing diploid organisms and thus cannot phase regions that underwent significant copy number changes or they cannot handle fusions and other structural variations. Furthermore, the distance between allele-defining variants is often too large, and as a result, many alleles cannot be phased with short-read sequencing data. On the other hand, statistical phasing tools, such as Beagle (<xref rid="GR277075HARC2" ref-type="bibr">Browning et al. 2021</xref>) or Eagle (<xref rid="GR277075HARC28" ref-type="bibr">Loh et al. 2016</xref>), also do not handle the presence of fusions and structural variations. Thus, most of the star-allele calling was—and still is—being performed by various custom primer-specific PCR and array assays (<xref rid="GR277075HARC31" ref-type="bibr">Numanagić et al. 2015</xref>), mostly owing to their price and speed, despite calls generated by these assays being often limited in breadth and scope (<xref rid="GR277075HARC35" ref-type="bibr">Pratt et al. 2010</xref>; <xref rid="GR277075HARC8" ref-type="bibr">Fang et al. 2014</xref>).</p>
  <p>Several tools have been recently developed to address the challenge of accurate star-allele calling (<xref rid="GR277075HARC3" ref-type="bibr">Caspar et al. 2020</xref>). Cypiripi (<xref rid="GR277075HARC31" ref-type="bibr">Numanagić et al. 2015</xref>), the first tool specifically designed for this purpose, supported calling <italic>CYP2D6</italic> star-alleles from Illumina WGS data. Cypiripi was followed by Aldy (<xref rid="GR277075HARC32" ref-type="bibr">Numanagić et al. 2018</xref>), Stargazer (<xref rid="GR277075HARC23" ref-type="bibr">Lee et al. 2019</xref>), Astrolabe (<xref rid="GR277075HARC48" ref-type="bibr">Twist et al. 2016</xref>), StellarPGx (<xref rid="GR277075HARC47" ref-type="bibr">Twesigomwe et al. 2021</xref>), PharmCAT (<xref rid="GR277075HARC41" ref-type="bibr">Sangkuhl et al. 2020</xref>), and Cyrius (<xref rid="GR277075HARC4" ref-type="bibr">Chen et al. 2021</xref>). These tools aggregate the data from the existing star-allele databases, such as PharmVar (<xref rid="GR277075HARC12" ref-type="bibr">Gaedigk et al. 2018</xref>), and use it to call star-alleles directly from HTS data. Some of these tools, such as Aldy and Stargazer, are also able to detect copy number changes and fusions with a high level of accuracy. However, a majority of these tools target only a small set of pharmacogenes (typically <italic>CYP2D6</italic> and other cytochrome P450 genes) and are tuned for short-read HTS data generated by the Illumina whole-genome sequencing (WGS), whole-exome sequencing (WES), and (in some cases) targeted sequencing panels such as PGRNseq (<xref rid="GR277075HARC15" ref-type="bibr">Gordon et al. 2016</xref>).</p>
  <p>In recent years, there has been a slow but steady shift toward third-generation HTS technologies such as Pacific Biosciences (PacBio) and Oxford Nanopore (<xref rid="GR277075HARC6" ref-type="bibr">De Coster et al. 2021</xref>). These technologies produce significantly longer reads (typically measured in tens of kilobases) than Illumina reads (measured in tens of base pairs). Although they were initially dismissed in clinical settings owing to the high cost of sequencing and high error rates, these technologies are making a resurgence thanks to the recent improvements in terms of accuracy and cost. For example, PacBio HiFi sequencing offers up to 25-kbp-long reads with a 99.5% accuracy rate (<xref rid="GR277075HARC19" ref-type="bibr">Hon et al. 2020</xref>). Unfortunately, not many tools are able to correctly use the data generated by these technologies for calling pharmacogenomic star-alleles owing to the different assumptions and biases compared with the standard Illumina short-read data. Star-allele callers are also unable to make use of the long-range information within long reads for better phasing of allele-defining variants.</p>
  <p>Here we present Aldy 4, the next iteration of Aldy software that addresses the aforementioned challenges. Aldy 4 completely revamps its original star-allele calling pipeline and adds support for long-read technologies such as PacBio HiFi, while extending support for short-read technologies (whole-genome and targeted capture data). Other updates also include extensive support for genotyping whole-exome (<xref rid="GR277075HARC29" ref-type="bibr">Ly et al. 2022</xref>) and VCF data. The changes include an alignment correction module that addresses various biases and errors common during the alignment of long reads to the pharmacogenomic regions. It also provides a novel star-allele calling pipeline that incorporates the long-range phasing information from long reads into the star-allele calling model. Finally, Aldy 4 brings support for 19 new pharmacogenes, provides an easy interface for adding the support for other pharmacogenes, adds an application programming interface (API) for easy incorporation of pharmacogenomic calling within the existing pipelines, and brings various other improvements to the original pipeline. As such, we envision Aldy to be a single-stop tool for calling star-alleles from diverse sequencing technology data sets, and hope that it will remain a crucial tool in the pharmacogenomics toolbox even with the advent of long-read sequencing technologies.</p>
  <sec sec-type="results" id="s1">
    <title>Results</title>
    <p>We have compared Aldy 4.3 (with PharmVar v5.2.3) against Astrolabe v0.8.7.2 (<xref rid="GR277075HARC48" ref-type="bibr">Twist et al. 2016</xref>), StellarPGx v1.2.5 (<xref rid="GR277075HARC47" ref-type="bibr">Twesigomwe et al. 2021</xref>), Stargazer v1.0.8 (<xref rid="GR277075HARC23" ref-type="bibr">Lee et al. 2019</xref>), and Cyrius v1.1.1 (<xref rid="GR277075HARC4" ref-type="bibr">Chen et al. 2021</xref>). Aldy 4 was also compared against Aldy v3.3 (<xref rid="GR277075HARC32" ref-type="bibr">Numanagić et al. 2018</xref>), the previous version of Aldy. The comparisons were performed on a sizeable GeT-RM set of publicly available samples and genes for which genotyping panel validations were available (<xref rid="GR277075HARC35" ref-type="bibr">Pratt et al. 2010</xref>, <xref rid="GR277075HARC36" ref-type="bibr">2016</xref>; <xref rid="GR277075HARC13" ref-type="bibr">Gaedigk et al. 2019</xref>). These samples were sequenced with three technologies: (1) a PGRNseq v.3 Illumina-based pharmacogene-targeted panel (137 samples) (<xref rid="GR277075HARC15" ref-type="bibr">Gordon et al. 2016</xref>), (2) Illumina WGS (70 samples), and (3) 10x Genomics sequencing (95 samples). In addition to these samples, Aldy 4 was also run on the set of 45 Coriell samples sequenced by a PacBio HiFi pharmacogene-targeted panel (<xref rid="GR277075HARC34" ref-type="bibr">Portik et al. 2021</xref>; <xref rid="GR277075HARC21" ref-type="bibr">Kingan et al. 2022</xref>) and validated by <xref rid="GR277075HARC42" ref-type="bibr">Scott et al. (2021)</xref>. The percentage of known alleles covered by these data sets for each evaluated gene is available in <ext-link xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.277075.122/-/DC1" ext-link-type="uri">Supplemental Table S1</ext-link>.</p>
    <p>Aldy 4 and other tools were run on the following 19 genes: <italic>CYP1A1</italic>, <italic>CYP1A2</italic>, <italic>CYP2A13</italic>, <italic>CYP2A6</italic>, <italic>CYP2B6</italic>, <italic>CYP2C8</italic>, <italic>CYP2C9</italic>, <italic>CYP2C19</italic>, <italic>CYP2D6</italic>, <italic>CYP2J2</italic>, <italic>CYP2S1</italic>, <italic>CYP3A4</italic>, <italic>CYP3A5</italic>, <italic>CYP3A7</italic>, <italic>CYP3A43</italic>, <italic>CYP4F2</italic>, <italic>DPYD</italic>, <italic>SLCO1B1</italic>, and <italic>TPMT</italic>. Although Aldy 4 also supports additional 15 genes, their evaluation was omitted because we did not have the ground truth panel data for these genes. Note that not every tool supports all these genes: As a rule of thumb, Stargazer, Aldy 3, and Aldy 4 provide the broadest support, whereas the other tools are geared toward a small subset of these genes (typically CYP genes, such as <italic>CYP2D6</italic> and <italic>CYP2C19</italic>).</p>
    <p>In an ideal world, we would have a “perfect” phase for each sample and would be able to evaluate each tool against such phase. Unfortunately, the available ground truth data are obtained through genotyping panels and assays designed to detect only the common <italic>major star-alleles</italic> (or <italic>core alleles</italic>, alleles defined solely by functional, or core, variants). These panels often cannot call <italic>minor star-alleles</italic> (or <italic>suballeles</italic>, alleles defined by nonfunctional variants, or subvariants, and functionally indistinguishable from the major star-alleles), as well as less common alleles. The low resolution of the available ground truth data and the differences in database specifications between the different tools necessitated a few accommodations within the evaluation process for the sake of fairness. First, we updated ground truth calls that missed the presence of less common variants and alleles. Updates were only performed if there was a consensus between the star-allele calling tools that differed from the ground truth data and if an updated call extended the validated allele definition (i.e., if the variants defining the validated allele also form a part of the consensus definition). Note that a similar approach was used by <xref rid="GR277075HARC32" ref-type="bibr">Numanagić et al. (2018)</xref>. Each updated call was further manually inspected to ensure that the variants missing from the ground truth calls are indeed present and not sequencing artifacts. In rare instances, it was hard to precisely distinguish the presence of the variant, especially if the variant allele frequency (VAF) was too low (alleles with lower VAFs are sometimes caused by the sequencing or read alignment bias, especially in the presence of pseudogenes, and are typically validated through Sanger sequencing). Samples with such variants were marked as “need validation” (<xref rid="GR277075HARTB1" ref-type="table">Table 1</xref>). For such samples, calls that either used or ignored such ambiguous variants were deemed “correct.” Second, we have followed the common strategy used in clinical studies (<xref rid="GR277075HARC29" ref-type="bibr">Ly et al. 2022</xref>) by only comparing the major (core) star-allele calls and ignoring the minor star-allele (suballele) designations. In other words, only the phasing of functional (core) variants was considered; subvariants and silent variants that do not alter the functionality of an allele were ignored (i.e., a *1A/*2B minor star-allele call was treated as a functionally equivalent *1/*2 major star-allele call). Note that major (core) star-alleles are typically distinguished by the number (e.g., *1 functionally differs from *2), whereas minor star-alleles (suballeles) are traditionally distinguished by a letter (e.g., *2A and *2B harbor different silent variants despite sharing common core variants) or by a numerical suffix in the recent PharmVar definitions (e.g., *2.001 instead of *2A).</p>
    <table-wrap position="float" id="GR277075HARTB1">
      <label>Table 1.</label>
      <caption>
        <p>Summary of the star-allele calls generated by six tools (Aldy 4, Aldy 3, StellarPGx, Stargazer, Astrolabe, and Cyrius) on 137 GeT-RM samples sequenced by three different technologies</p>
      </caption>
      <graphic xlink:href="61tb01" position="float"/>
    </table-wrap>
    <p>The further complication lies in the discrepancies among the databases themselves: Different tools ship with different databases and often augment such databases with custom entries. For that reason, identical alleles with differing names were treated equally, and ambiguities were resolved in the individual tool's favor (e.g., if a tool's call could be interpreted as correct, we called it as correct; this way, we ensured that custom database entries were accounted for). The exact criteria used for allele updates and allele comparisons are listed in the <ext-link xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.277075.122/-/DC1" ext-link-type="uri">Supplemental Note S1</ext-link>.</p>
    <p>Where possible, the <italic>CYP2D8</italic> region was used as the copy number neutral region; exceptions include Aldy 4 using <italic>F1</italic> region for the PacBio data. Some tools, such as Astrolabe and Stargazer, required VCF files; where needed, VCFs were generated by BCFtools (<xref rid="GR277075HARC27" ref-type="bibr">Li et al. 2009</xref>).</p>
    <p>All results were obtained on machines with Intel Xeon E5-2680v4 and 8260 CPUs. Each evaluated tool genotypes a single gene in a single sample within a few minutes, regardless of the sequencing technology used. However, note that Aldy 4 only needs BAM/CRAM to run; other tools often require VCF or GDF files that can take significant time to generate.</p>
    <p>Overall, the best accuracy on short-read data sets (PGRNseq v.3, Illumina WGS, and 10x Genomics) was achieved by Aldy 4 (98.42%), followed by Aldy 3 (96.78%), StellarPGx (90.40%), Astrolabe (86.50%), Cyrius (82.63%), and Stargazer (76.47%).</p>
    <sec id="s1a">
      <title>PGRNseq v.3</title>
      <p>Aldy 4, Aldy 3, Stargazer, and Astrolabe were run on 137 PGRNseq v.3 targeted sequencing (<xref rid="GR277075HARC15" ref-type="bibr">Gordon et al. 2016</xref>) samples from the GeT-RM collection. PGRNseq v.3 targets common pharmacogenes and sequences them at high depths (up to 1000× per loci).</p>
      <p>Note that we could not get either Stargazer or Astrolabe to run on targeted sequencing data natively; thus, VCF files were provided as an input for these tools. Because of the limited nature of VCF files, these tools were unable to call copy number changes and fusions on this data set. Although Stargazer has a mode for targeted data, we were unable to get good results with it; a detailed explanation is given in the <ext-link xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.277075.122/-/DC1" ext-link-type="uri">Supplemental Notebook</ext-link>. The comparison with StellarPGx was omitted as it does not support targeted sequencing data.</p>
      <p>As can be seen in <xref rid="GR277075HARTB1" ref-type="table">Table 1</xref>, Aldy 4 identifies nearly all of the alleles in all genes correctly—more than the other two tools—with a total accuracy of 98.45%. In some cases (e.g., failed cases in the genes <italic>CYP1A1</italic> and <italic>CYP2B6</italic>), no caller was able to call correct star-alleles because the PGRNseq panel did not sequence the variant of interest (e.g., a nonexonic downstream variant rs4646903 that defines <italic>CYP1A1*2A</italic> was not covered by the panel at all).</p>
      <p>On this data set, Aldy 4's performance is only marginally better than Aldy 3. This is expected as neither of the model updates unique to Aldy 4 applies to the high-quality PGRNseq data set with stable coverage. Minor changes are mostly owing to the differences in the variant calling (e.g., Aldy 4's incorporation of quality scores and mapping qualities).</p>
    </sec>
    <sec id="s1b">
      <title>Illumina WGS</title>
      <p>We have run all tools on 70 Illumina HiSeq-sequenced WGS samples from the GeT-RM sample collection. These samples were sequenced with an average depth of roughly 30×. The details are also available in <xref rid="GR277075HARTB1" ref-type="table">Table 1</xref>.</p>
      <p>Here, Aldy 4 again calls nearly all star-alleles correctly and genotypes more samples than the competition for every considered gene. The only exception is <italic>CYP2D6</italic>, for which Cyrius genotypes two samples (NA21781) more than Aldy 4. In this case, Aldy 4 misses the nonfunctional *68 and identifies the *2 allele as *65; however, the *65 allele extends the *2 allele with a single variant (rs1065852), and it is unclear if this allele is indeed a *2 or a *65.</p>
      <p>Aldy 4 and other tools were able to correctly call alleles defined by intronic and downstream variants across the genes on these data. Note that the main reason behind the Stargazer's lower accuracy on this data set was copy number calling: Although Stargazer often identified the star-allele correctly, it would often call them more times than needed (e.g., *1/*2 + *2 instead of *1/*2). Note that Aldy 4 only calls copy numbers and fusions on genes that are known to harbor such changes; otherwise, it assumes that two copies are present.</p>
      <p>Note that Astrolabe used a modified <italic>CYP4F2</italic> database whose allele nomenclature differed from the other databases. Thus, the comparison with Astrolabe on <italic>CYP4F2</italic> was omitted for the sake of consistency. We also observed a large number of mismatches in <italic>SLCO1B1</italic> across all tools owing to the incomplete panel validation and inconsistent database specifications used by various tools.</p>
      <p>Finally, the improvements in the copy number model and more sensitive variant calling in Aldy 4 account for a few improved calls on more complex <italic>CYP2D6</italic> and <italic>CYP2A6</italic> samples.</p>
    </sec>
    <sec id="s1c">
      <title>10x Genomics</title>
      <p>We have run all tools on 95 GeT-RM samples sequenced by a 10x Genomics WGS sequencer. The average depth of sequencing was roughly 40×. Because several important pharmacogenes reside within repeated regions of the human genome, EMA aligner (<xref rid="GR277075HARC44" ref-type="bibr">Shajii et al. 2018</xref>) with the density-based optimization mode was used for improved alignment of the 10x reads to the reference genome (hg19 at the time of alignment; the same results should be expected when aligning the data to GRCh38 as well because the gene regions of interest did not undergo major changes between the two releases). The comparison details are available in <xref rid="GR277075HARTB1" ref-type="table">Table 1</xref>.</p>
      <p>Although the 10x Genomics protocol uses Illumina HiSeq for sequencing, the read coverage is not as uniform as it is in an average Illumina WGS sample; 10x-specific biases also result in quite a few misaligned reads compared with the WGS data. For this reason, the overall allele calling accuracy is lower than the WGS data set; this is especially evident in Stargazer, in which the accuracy of its copy number detection module is even lower than in WGS data.</p>
      <p>However, Aldy 4 still correctly calls the majority of alleles (with 97.11%) accuracy, especially compared with the other tools. The most challenging genes for all tools were <italic>CYP2A6</italic> and <italic>CYP2D6</italic>. Aldy's accuracy is lower in these genes, primarily owing to the occasional copy number mismatch (owing to the coverage unevenness) and sequencing artifacts (where many misidentified variants were either an artifact or were undersequenced). Note that Aldy 4 benefited from the novel phasing module that was able to successfully use 10x Genomics barcodes to link long-distance variants together. Finally, we observe significant improvements over Aldy 3 in <italic>CYP2D6</italic> and <italic>CYP2A6</italic> samples on this data set owing to an improved copy number model that better handles noisy coverage and ambiguous variants (a common case in 10x Genomics samples) and is, as such, able to improve the calling accuracy up to 30% in these genes.</p>
    </sec>
    <sec id="s1d">
      <title>PacBio HiFi</title>
      <p>Finally, Aldy 4 was run on two sets of PacBio HiFi samples sequenced by a custom targeted pharmacogenomics panel (<xref rid="GR277075HARC34" ref-type="bibr">Portik et al. 2021</xref>; <xref rid="GR277075HARC21" ref-type="bibr">Kingan et al. 2022</xref>). The first set contained 24 samples, whereas the second set was comprised of 21 samples. The coverage of these data sets varies—it can be as low as 10×—and at times exceed even 200×. Aldy's calls were compared with those of Astrolabe. Although none of the other tools support PacBio long reads natively, we were able to at least run Astrolabe in VCF mode. The validation data were obtained from <xref rid="GR277075HARC42" ref-type="bibr">Scott et al. (2021)</xref> and <xref rid="GR277075HARC36" ref-type="bibr">Pratt et al. (2016)</xref>. The call details are available in <xref rid="GR277075HARTB2" ref-type="table">Table 2</xref>.</p>
      <table-wrap position="float" id="GR277075HARTB2">
        <label>Table 2.</label>
        <caption>
          <p>Overview of the star-allele calls generated by Aldy 4 and Astrolabe on PacBio HiFi targeted data</p>
        </caption>
        <graphic xlink:href="61tb02" position="float"/>
      </table-wrap>
      <p>Star-allele calls generated by Aldy 4 agree with the ground truth in all genes except for a few <italic>CYP2D6</italic> calls and one <italic>CYP2C9</italic> call. Furthermore, its calls augmented and phased many ground truth calls generated by panels with limited variant coverage with additional variants observed by PacBio data (<xref rid="GR277075HARTB2" ref-type="table">Table 2</xref>). Aldy was also able to find and phase alleles that have not been cataloged in <italic>CYP2B6</italic>, <italic>CYP2C19</italic>, <italic>CYP3A4</italic>, <italic>DPYD</italic>, and <italic>SLCO1B1</italic>. Further validation of such novel calls, as well as of the calls that were deemed ambiguous, is needed to fully confirm and understand such alleles.</p>
      <p>When it comes to <italic>CYP2D6</italic>, Aldy 4's calls disagree with the ground truth data owing to the difference in predicted copy number. In two instances, Aldy 4 called an additional copy (i.e., *1 + *1 instead of *1, and *4 + *4 instead of *4), whereas in the other two instances, Aldy 4 did not call an existing copy (i.e., it called *2 instead of *2 + *2 and *10 instead of *10 + *10). In one instance, Aldy called *36 instead of *10 (note that these alleles are nearly identical, with the only difference being a conversion of exon 9 in *36); in the final instance Aldy did not call the nonfunctional *68 fusion allele. In all these cases, the observed coverage was noisy, and further validation is needed to ascertain the exact copy number of these samples. Let us also point out that Astrolabe's calls in genes <italic>CYP2C19</italic> and <italic>SLCO1B1</italic>, as well as <italic>CYP2D6</italic> in the second data set, were highly ambiguous, often containing more than 10 functionally different solutions.</p>
    </sec>
    <sec id="s1e">
      <title>Other remarks</title>
      <p>Many tools often confuse <italic>CYP2B6*6</italic> and <italic>CYP2B6*9</italic> alleles that differ only in the variant rs2279343. This variant is often either undersequenced or covered by ambiguous reads that potentially originate from the neighboring <italic>CYP2B7</italic> pseudogene and is thus hard to call with high confidence in some technologies (e.g., PGRNseq v.3). When the true call was ambiguous, both possible calls were deemed “correct.” Similar cases were also observed with <italic>CYP2A6*1</italic> and <italic>CYP2A6*35</italic> alleles. Further validation is needed to properly ascertain the true existence of these alleles in problematic samples.</p>
      <p>If multiple allele calls were generated by a tool for a given sample and gene combination, the call was deemed “correct” if at least one such multicall matched the ground truth. Note that the prevalence of multiple calls was overall low: ∼1.1% for Aldy 4, 2.7% for Aldy 3, 1.9% for Stargazer, 1.9% for StellarPGx, and 15.7% for Astrolabe. Aldy 4's new phasing model was a significant factor for a low multicall rate: Although the rate was 1.6% on PGRNseq v.3 and 1.8% on WGS samples owing to the short read lengths of such samples, it decreased to 0.5% on 10x and PacBio samples that allowed better phasing. The vast majority of ambiguous calls were observed when genotyping <italic>CYP4F2</italic> and <italic>SLCO1B1</italic>. Finally, note that Aldy 4 generated no more than three diplotypes for each ambiguous call.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s2">
    <title>Discussion</title>
    <p>Pharmacogenomics is becoming a key component of evidence-based medicine (<xref rid="GR277075HARC38" ref-type="bibr">Relling and Evans 2015</xref>). Genes like <italic>CYP2D6</italic> and <italic>CYP2C19</italic> regulate a large portion of clinically prescribed drugs; other genes, such as those in the <italic>HLA</italic> or <italic>IGH</italic> gene clusters, are vital for understanding the immune response (<xref rid="GR277075HARC9" ref-type="bibr">Ford et al. 2020</xref>, <xref rid="GR277075HARC10" ref-type="bibr">2022</xref>). As their function is dependent on their haplotype, it is of vital importance to genotype and haplotype these genes before administering medical treatment (<xref rid="GR277075HARC5" ref-type="bibr">Crews et al. 2014</xref>). HTS technologies are a natural candidate for this process, especially when considered that the currently available clinical genotyping panels are often restricted only to the most common genotypes and struggle to detect more complex structural alterations within pharmacogenes.</p>
    <p>In this work, we have presented Aldy 4, the first tool that can accurately and consistently call star-alleles in data from various sequencing technologies, including but not limited to long-read PacBio data, Illumina short-read sequencing in all of its flavors (i.e., whole-genome, whole-exome, and targeted capture data), as well as the 10x Genomics barcoded data. Aldy 4 achieves this by using combinatorial optimization models to solve various challenges associated with calling pharmacogenetic haplotypes from sequencing data, such as copy number and structural variation detection, variant calling, and variant phasing, ultimately resulting in a star-allele decomposition of a gene of interest. We have shown the strength of Aldy 4's approach through a series of comparisons against the current state-of-the-art star-allele callers, in which Aldy 4 performed the best. We hope that Aldy 4 will be of vital importance to clinicians in tailoring prescription recommendations, thus leading to improved medical care.</p>
    <p>There are still some open questions left that need to be answered in future work. Most importantly, the panel-validated calls improved by the star-allele callers through the use of HTS data—often containing novel alleles not previously cataloged in the existing databases—need to be validated in a wet-laboratory environment for all genes presented, as was performed recently for a selection of CYP2C genes (<xref rid="GR277075HARC14" ref-type="bibr">Gaedigk et al. 2022</xref>). More tests are also needed on larger cohorts to accurately evaluate the precision of these tools, Aldy 4 included, on rare fusions. The incorporation of other highly polymorphic pharmacogenomics regions, such as <italic>HLA</italic> or <italic>IGH</italic>, should also be considered, as Aldy (and other evaluated pharmacogenomics tools) are currently unable to handle the complexities of such regions. Finally, the complete characterization of minor star-alleles, accompanied by the careful characterization of noncoding variants, is also needed to understand the full effect of pharmacogenes on the treatment and drug dosage decisions.</p>
  </sec>
  <sec sec-type="methods" id="s3">
    <title>Methods</title>
    <p>The goal of Aldy is to reconstruct the exact sequence content (or haplotype) of each gene copy of a given pharmacogene from an HTS data sample and assign a star-allele to each reconstructed haplotype present in the data set. This process is subsequently referred to as <italic>star-allele calling</italic>.</p>
    <p>To accurately call star-alleles, it is necessary to consult a database of known star-alleles that contains the exact sequence content of each pharmacogene allele. Suppose that a pharmacogene <italic>G</italic> harbors variants <inline-formula id="il1"><mml:math id="IL1" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo fence="false">{</mml:mo><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mo fence="false">|</mml:mo><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mo fence="false">|</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo fence="false">}</mml:mo></mml:math></inline-formula>, where any <inline-formula id="il2"><mml:math id="IL2" display="inline" overflow="scroll"><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow></mml:math></inline-formula> is a single-nucleotide substitution or a small indel. Depending on their impact on the gene <italic>G</italic>, these variants are either deemed functional (core) variants or silent variants (subvariants); although core variants are typically nonsynonymous, they might also include UTR and intronic variants that affect the drug metabolism. The reference allele of <italic>G</italic> is an allele that harbors no variants at all. It is commonly known as the *1 star-allele. Notable exceptions to this rule include <italic>CYP2C19</italic> (where <italic>CYP2C19*1</italic> was recently renamed to <italic>CYP2C19*38</italic>) and wild-type alleles in <italic>IFNL3</italic> and <italic>DPYD</italic>. Any other star-allele <italic>S</italic><sub><italic>i</italic></sub> is defined by the subset of known variants <inline-formula id="il3"><mml:math id="IL3" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow></mml:math></inline-formula> that distinguish its sequence content from the reference *1 allele.</p>
    <p>In some genes, such as <italic>CYP2D6</italic>, star-allele identifiers are also assigned to fusions and other pseudogene-induced structural changes that affect the pharmacogene. For this reason, the definition of star-alleles is extended to also include their structural configuration. This configuration describes whether a pharmacogene is wholly present in the genome, is deleted, or is a gene–pseudogene hybrid. The set of valid configurations is denoted as <inline-formula id="il4"><mml:math id="IL4" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:math></inline-formula>. Note that each structural configuration can induce many distinct star-alleles depending on the choice of variants from <inline-formula id="il5"><mml:math id="IL5" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow></mml:math></inline-formula>. Thus, we can formally define a <italic>star-allele</italic>
<italic>S</italic><sub><italic>i</italic></sub> as a tuple (<bold>g</bold><sub><italic>i</italic></sub>, <italic>A</italic><sub><italic>i</italic></sub>), where <inline-formula id="il6"><mml:math id="IL6" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">g</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula id="il7"><mml:math id="IL7" display="inline" overflow="scroll"><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⊆</mml:mo><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow></mml:math></inline-formula>. The <italic>star-allele database</italic> is formally a collection of all known structural configurations, variants, and known star-alleles <inline-formula id="il8"><mml:math id="IL8" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mo fence="false">{</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo></mml:mrow><mml:mo fence="false">}</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:math></inline-formula>, where <italic>S</italic><sub><italic>i</italic></sub> = (<bold>g</bold><sub><italic>i</italic></sub>, <italic>A</italic><sub><italic>i</italic></sub>) such that <inline-formula id="il9"><mml:math id="IL9" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">g</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula id="il10"><mml:math id="IL10" display="inline" overflow="scroll"><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⊆</mml:mo><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow></mml:math></inline-formula>.</p>
    <p>To call star-alleles of a given pharmacogene from the given sequencing sample, Aldy needs to perform the following steps:
<list list-type="bullet"><list-item><p>analyze the aligned HTS reads in BAM/CRAM format and resolve incorrectly aligned reads,</p></list-item><list-item><p>detect structural configurations by calling copy number changes and gene–pseudogene fusions, and</p></list-item><list-item><p>use the read alignments from BAM/CRAM to call star-alleles and phase the gene.</p></list-item></list></p>
    <sec id="s3a">
      <title>BAM/CRAM analysis and alignment correction</title>
      <p>Aldy begins by taking a SAM, BAM, or CRAM file (<xref rid="GR277075HARC27" ref-type="bibr">Li et al. 2009</xref>) generated by a read aligner (e.g., BWA [<xref rid="GR277075HARC26" ref-type="bibr">Li and Durbin 2009</xref>], pbbm2 [<uri xlink:href="https://github.com/PacificBiosciences/pbmm2">https://github.com/PacificBiosciences/pbmm2</uri>], or minimap2 [<xref rid="GR277075HARC25" ref-type="bibr">Li 2018</xref>]). It is recommended to postprocess these files with the GATK's “best practices” pipeline (the local indel realignment step is especially helpful for the subsequent variant calling) (<xref rid="GR277075HARC49" ref-type="bibr">Van der Auwera et al. 2013</xref>). Aldy extracts the relevant variants that are present in a given pharmacogene from the alignment file, as well as coverage information needed for the copy number and structural variation detection step. It also collects phasing information from long reads, barcoded fragments, and paired-end fragments where available.</p>
      <p>The original version of Aldy relied on the assumption that read alignments produced by the off-the-shelf aligner are mostly correct. Although this assumption holds for short paired-end Illumina reads, it breaks for long reads such as PacBio HiFi reads. For example, if a sample harbors a gene duplication and if the highly similar pseudogene is located immediately next to this gene, any long read spanning two duplicated copies of the gene will get its second half incorrectly aligned to the pseudogene because the reference genome does not contain two copies of the gene in question (<xref rid="GR277075HARF1" ref-type="fig">Fig. 1</xref>). The correct alignment would perform a split mapping and align the second half again to the pharmacogene. These incorrect alignments are even more problematic in the presence of gene fusions: Any read that spans a gene–pseudogene fusion breakpoint will not be split-mapped but incorrectly aligned to either pharmacogene or its pseudogene.</p>
      <fig position="float" id="GR277075HARF1">
        <label>Figure 1.</label>
        <caption>
          <p>An example of an incorrect long read alignment to the reference genome and its correction. If a donor genome (<italic>above</italic>) contains two copies of <italic>CYP2D6</italic> pharmacogene, any long read (gray rectangle) that spans both copies will get aligned to the reference genome (<italic>below</italic>) that contains only a single <italic>CYP2D6</italic> copy. However, this read will get its second half (containing <italic>CYP2D6</italic> sequence) incorrectly aligned to the <italic>CYP2D7</italic> pseudogene owing to the high sequence similarity between these genes. The final result is the overabundance of coverage in the pseudogene region compared with the <italic>CYP2D6</italic> region (an Integrative Genomics Viewer [IGV; <xref rid="GR277075HARC40" ref-type="bibr">Robinson et al. 2011</xref>] coverage plot is shown <italic>above</italic> the reference genome).</p>
        </caption>
        <graphic xlink:href="61f01" position="float"/>
      </fig>
      <p>Aldy 4 corrects such alignments by splitting any long read that spans the gene–pseudogene boundary into shorter gene-level segments and aligning each segment independently. Each segment is guaranteed to span only one gene (either pharmacogene or a pseudogene) and thus avoid being misaligned in the manner described above. The size of each such segment is at most the size of the gene. Aldy 4 performs a further split-mapping of each segment that spans a potential fusion breakpoint to determine whether a read originates from a fusion event or not (a read is said to originate from a fusion event if its split-mapping alignment score is better than the original alignment score).</p>
      <p>Unlike previous versions, Aldy 4 considers base quality scores and read mapping qualities when calling the allele-specific variants. This ensures that the low-quality variants in noisy and low-coverage samples are filtered out before the star-allele calling. Finally, Aldy 4 performs the indel-realignment step through indelpost (<xref rid="GR277075HARC17" ref-type="bibr">Hagiwara et al. 2022</xref>) to correct misalignments that often happen when aligning short reads to small indels (<xref rid="GR277075HARC24" ref-type="bibr">Li 2014</xref>).</p>
    </sec>
    <sec id="s3b">
      <title>Copy number and structural variation analysis</title>
      <p>In a typical scenario, a sample contains two parental copies of a pharmacogene of interest for which star-alleles need to be called. This is generally true for most of the pharmacogenes of interest. However, a few major pharmacogenes do not follow this pattern and are prone to various copy number changes and structural events. The most notable example is that of the <italic>CYP2D6</italic> gene, one of the most important pharmacogenes (<xref rid="GR277075HARC20" ref-type="bibr">Ingelman-Sundberg 2005</xref>), whose copies can undergo whole-gene deletions, duplications, and hybrid fusions (where a copy begins with the <italic>CYP2D6</italic> sequence but switches to the pseudogene <italic>CYP2D7</italic> sequence at a given breakpoint, or vice versa) (<xref rid="GR277075HARC22" ref-type="bibr">Kramer et al. 2009</xref>). Other prominent examples include <italic>CYP2A6</italic>, <italic>G6PD</italic>, and so on. Each copy—fusions included—yields its own star-allele. Thus, to correctly call star-alleles of such genes, it is necessary to correctly detect the total number of available gene copies as well as the configuration (i.e., structure) of each copy.</p>
      <p>Each gene copy can be described by its structural configuration represented as a binary vector <inline-formula id="il11"><mml:math id="IL11" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">g</mml:mi></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:math></inline-formula> that indicates the presence or absence of genic regions in a given configuration (<xref rid="GR277075HARF2" ref-type="fig">Fig. 2</xref>). Because each star-allele is defined by a matching structural configuration, such configurations must be found before the star-alleles can be accurately called. The size of the configuration vector depends on the number of gene segments that define various structural configurations. For example, the <italic>CYP2D6</italic> gene is divided into <italic>r</italic> = 20 segments that correspond to its exons, introns, and flanking regions, because all structural variations are described at the level of whole exons and introns (<xref rid="GR277075HARC22" ref-type="bibr">Kramer et al. 2009</xref>). The total length of the <italic>CYP2D6</italic> configuration vector is 2<italic>r</italic> (i.e., 40) because the vector also includes segments from the neighboring <italic>CYP2D7</italic> pseudogene. This vector can encode any known <italic>CYP2D6</italic> structural configuration: for example, a single <italic>CYP2D6</italic> copy (<italic>r</italic> ones followed by <italic>r</italic> zeros), a single <italic>CYP2D7</italic> copy (<italic>r</italic> zeros followed by <italic>r</italic> ones), <italic>CYP2D6</italic>–<italic>2D7</italic> fusion in intron 1 (one followed by <italic>r</italic> − 1 zeros, in turn followed by a 0 and <italic>r</italic> − 1 ones), and so on. Once these vectors are established, any complex configuration within <italic>CYP2D</italic> locus can be represented as an aggregate of individual configuration vectors (for an example, see <xref rid="GR277075HARF2" ref-type="fig">Fig. 2</xref>A). Note that valid structural configuration vectors are obtained from the corresponding allele databases and that each such vector is typically assigned a star-allele identifier (e.g., <italic>CYP2D6*13A</italic> represents a <italic>CYP2D6</italic> fusion with the breakpoint in exon 1).</p>
      <fig position="float" id="GR277075HARF2">
        <label>Figure 2.</label>
        <caption>
          <p>A sample decomposition of aggregate coverage into individual structural configurations. (<italic>A</italic>) An example database of <italic>CYP2D6</italic> structural configurations containing three such configurations (<bold><italic>v</italic></bold><sub><italic>CYP</italic>2<italic>D</italic>6</sub>, <bold><italic>v</italic></bold><sub><italic>CYP</italic>2<italic>D</italic>7</sub>, and <bold><italic>v</italic></bold><sub><italic>CYP</italic>2<italic>D</italic>6*<italic>13</italic></sub>). Regions on <italic>top</italic> of the configurations that were defined (i.e., <italic>e</italic><sub>1</sub>, <italic>i</italic><sub>1</sub>, etc.) are shaded with lighter color. In this example, <bold><italic>v</italic></bold><sub><italic>CYP</italic>2<italic>D</italic>6</sub> corresponds to the <bold><italic>g</italic></bold><sub>1</sub>. (<italic>B</italic>) Sample decomposition of the aggregate coverage vector <bold><italic>cn</italic></bold>, observed after aligning the reads originating from the donor genome (<italic>above</italic>) to the reference genome (<italic>below</italic>). As can be seen, <bold><italic>cn</italic></bold> can be expressed as the sum of four structural configuration vectors from the database.</p>
        </caption>
        <graphic xlink:href="61f02" position="float"/>
      </fig>
      <p>In a sequenced sample, we only observe the aggregate coverage vector <bold>cn</bold> that describes the number of reads covering each genomic loci of interest within the sample (the formation of this vector is described in <ext-link xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.277075.122/-/DC1" ext-link-type="uri">Supplemental Note S2</ext-link>; an example is shown in <xref rid="GR277075HARF2" ref-type="fig">Fig. 2</xref>B). The goal of Aldy is to find a set of configuration vectors <inline-formula id="il12"><mml:math id="IL12" display="inline" overflow="scroll"><mml:mo fence="false">{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">g</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">g</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo fence="false">}</mml:mo><mml:mo>⊆</mml:mo><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:math></inline-formula> whose sum is closest to the observed aggregate coverage, where each structural configuration can be selected only once (an assumption made for the sake of clarity; in practice, Aldy allows selecting the same configurations multiple times). As there might be many such sets, Aldy only looks for the most parsimonious solution: a solution that selects the minimal number of such vectors. This problem, previously dubbed as the copy number estimation problem (CNEP) (<xref rid="GR277075HARC32" ref-type="bibr">Numanagić et al. 2018</xref>), can be efficiently solved via integer linear programming (ILP) as follows.</p>
      <p>Assume that a gene <italic>G</italic> is segmented into 2<italic>r</italic> regions. Let <inline-formula id="il13"><mml:math id="IL13" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo fence="false">{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">g</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">g</mml:mi></mml:mrow><mml:mrow><mml:mo fence="false">|</mml:mo><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mo fence="false">|</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo fence="false">}</mml:mo></mml:math></inline-formula> stand for the set of the available configuration vectors, where <bold>g</bold><sub><italic>i</italic></sub> = [<bold>g</bold><sub><italic>i</italic>,1</sub>, …, <bold>g</bold><sub><italic>i</italic>,2<italic>r</italic></sub>] and <bold>g</bold><sub><italic>i</italic>,<italic>j</italic></sub> ∈ {0, 1} for any <italic>i</italic> and <italic>j</italic>. Let <bold>cn</bold> be the aggregate coverage vector observed from HTS data, and let us introduce a binary variable <italic>z</italic><sub><italic>i</italic></sub> for each <bold>g</bold><sub><italic>i</italic></sub> that indicates if <bold>g</bold><sub><italic>i</italic></sub> is a part of the solution or not. The objective—minimization of difference between the observed aggregate coverage and predicted solution—can be modeled as follows:<disp-formula id="GR277075HARUM1"><mml:math id="UM1" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow><mml:munderover><mml:mrow><mml:mo movablelimits="false">∑</mml:mo></mml:mrow><mml:mrow><mml:mspace width="0.4em"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>r</mml:mi></mml:mrow></mml:munderover><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">n</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:munderover><mml:mrow><mml:mo movablelimits="false">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo fence="false">|</mml:mo><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mo fence="false">|</mml:mo></mml:mrow></mml:munderover><mml:mo>⁡</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">g</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula>
Although this model performs well on WGS and targeted data (<xref rid="GR277075HARC32" ref-type="bibr">Numanagić et al. 2018</xref>), it is rather sensitive to deviations from the expected coverage distribution. It also cannot properly handle the cases in which the normalized aggregate coverage is not stable or uniform. For targeted panels with nonuniform coverage distributions, aggregate coverage can be “normalized” by dividing it by the coverage of the control sample if it is stable across different samples. Aldy does this automatically for known targeted panels. Thus, Aldy 4 improves the original CNEP formulation by introducing additional optimization terms. This is performed by modifying the original objective term and extending it with two additional terms, resulting in a three-term optimization objective.</p>
      <p>The first term is the same as the original CNEP objective but focuses only on the regions associated with the pharmacogene (and not its pseudogene):<disp-formula id="GR277075HARUM2"><mml:math id="UM2" display="block" overflow="scroll"><mml:msub><mml:mi>o</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo movablelimits="false">∑</mml:mo></mml:mrow><mml:mrow><mml:mspace width="0.4em"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>r</mml:mi></mml:munderover><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">n</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:munderover><mml:mrow><mml:mo movablelimits="false">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo fence="false">|</mml:mo><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mo fence="false">|</mml:mo></mml:mrow></mml:munderover><mml:mo>⁡</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">g</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula>
The second term of the objective function considers the interaction between the pharmacogene and the corresponding pseudogene region by considering the changes between their respective region coverage. For example, if the coverage of the exon 2 in <italic>CYP2D6</italic> is three and in <italic>CYP2D7</italic> is two, the resulting region coverage difference would be one. This difference can be further normalized (in this case, divided by three). Using normalized differences allows us to handle samples in which the observed aggregate coverage (<bold>cn</bold>) varies between the regions owing to various sequencing and alignment biases. Despite region-specific coverage variation, the relative abundances between the matching gene–pseudogene regions remain constant. This term can formally be expressed as<disp-formula id="GR277075HARUM3"><mml:math id="UM3" display="block" overflow="scroll"><mml:msub><mml:mi>o</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo movablelimits="false">∑</mml:mo></mml:mrow><mml:mrow><mml:mspace width="0.4em"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>r</mml:mi></mml:munderover><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">n</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">n</mml:mi></mml:mrow><mml:mrow><mml:mspace width="0.4em"/><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>−</mml:mo><mml:munderover><mml:mrow><mml:mo movablelimits="false">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo fence="false">|</mml:mo><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mo fence="false">|</mml:mo></mml:mrow></mml:munderover><mml:mo>⁡</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">g</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">g</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:mstyle></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula>
Here ν<sub><italic>j</italic></sub> = max{<bold>cn</bold><sub><italic>j</italic></sub>, <bold>cn</bold><sub><italic>j</italic>+<italic>r</italic></sub>} + 1 is the normalization factor.</p>
      <p>The final term of the objective function ensures that the ILP solver selects the most parsimonious solution:<disp-formula id="GR277075HARUM4"><mml:math id="UM4" display="block" overflow="scroll"><mml:msub><mml:mi>o</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo movablelimits="false">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo fence="false">|</mml:mo><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mo fence="false">|</mml:mo></mml:mrow></mml:munderover><mml:mo>⁡</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:math></disp-formula>
μ<sub><italic>i</italic></sub> is parsimony parameter (by default set to <inline-formula id="il14"><mml:math id="IL14" display="inline" overflow="scroll"><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo fence="false">|</mml:mo><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mo fence="false">|</mml:mo></mml:math></inline-formula>). However, some unlikely configurations, such as left fusions, will have higher parsimony scores to reflect the observation that such configurations are rare (<xref rid="GR277075HARC45" ref-type="bibr">Sim et al. 2012</xref>).</p>
      <p>Aldy 4's modified CNEP model uses an ILP solver to minimize sum of these three terms <italic>o</italic><sub>1</sub> + <italic>o</italic><sub>2</sub> + <italic>o</italic><sub>3</sub>. These solutions are passed to the later steps that will decide the best overall solution.</p>
    </sec>
    <sec id="s3c">
      <title>Star-allele calling</title>
      <p>Aldy now proceeds by assigning the exact star-allele identifier to each of the <italic>n</italic> structural configurations obtained in the previous step. As stated in Methods, a star-allele <italic>S</italic><sub><italic>i</italic></sub> is defined as a tuple (<bold>g</bold><sub><italic>i</italic></sub>, <italic>A</italic><sub><italic>i</italic></sub>), where <inline-formula id="il15"><mml:math id="IL15" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">g</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula id="il16"><mml:math id="IL16" display="inline" overflow="scroll"><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⊆</mml:mo><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow></mml:math></inline-formula>. The star-allele assignment problem can also be modeled through the ILP as follows.</p>
      <p>Let us indicate the presence of star-allele <italic>S</italic><sub><italic>i</italic></sub> with a binary variable <italic>a</italic><sub><italic>i</italic></sub>. Our goal is to select a set of star-alleles <italic>S</italic><sub>1</sub>, …, <italic>S</italic><sub><italic>n</italic></sub> such that (1) the set of the structural configurations that describes selected star-alleles is identical to the set of the structural configurations from the previous step, and (2) the difference between predicted and observed coverage for each variant <italic>m</italic> (denoted as cov(<italic>m</italic>)) is minimized. In other words, we want to minimize<disp-formula id="GR277075HARUM5"><mml:math id="UM5" display="block" overflow="scroll"><mml:munder><mml:mrow><mml:mo movablelimits="false">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">cov</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:munder><mml:mrow><mml:mo movablelimits="false">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mo>⁡</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula>
Although conceptually simple, this model does not account for cases in which database definitions are incomplete or incorrect. To account for these cases, the model must be allowed to alter star-allele definitions if needed. Aldy thus introduces new binary variables <italic>p</italic><sub><italic>i</italic>,<italic>m</italic></sub> and <italic>q</italic><sub><italic>i</italic>,<italic>m</italic></sub> that indicate if a variant <italic>m</italic> is to be “removed” from the star-allele <italic>S</italic><sub><italic>i</italic></sub> (while being present in the database definition <italic>A</italic><sub><italic>i</italic></sub>), or “added” to it (while being absent in <italic>A</italic><sub><italic>i</italic></sub>). Then it attempts to minimize the following expression for each variant <italic>m</italic>:<disp-formula id="GR277075HARUM6"><mml:math id="UM6" display="block" overflow="scroll"><mml:msub><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">cov</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mrow><mml:mo movablelimits="false">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mo>⁡</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:mo movablelimits="false">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:mi>m</mml:mi><mml:mo>∉</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mo>⁡</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula>
As <italic>a</italic><sub><italic>i</italic></sub>, <italic>p</italic><sub><italic>i</italic>,<italic>m</italic></sub>, and <italic>q</italic><sub><italic>i</italic>,<italic>m</italic></sub> are all binary variables, their product can be expressed as a set of linear constraints.</p>
      <p>The minimization objective can be expressed as<disp-formula id="GR277075HARUM7"><mml:math id="UM7" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow><mml:munder><mml:mrow><mml:mo movablelimits="false">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mo>⁡</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:mo movablelimits="false">∑</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:munder><mml:mo>⁡</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munder><mml:mrow><mml:mo movablelimits="false">∑</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:munder><mml:mo>⁡</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:mo movablelimits="false">∑</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:munder><mml:mo>⁡</mml:mo><mml:msub><mml:mtext>β</mml:mtext><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula>
Parameters α<sub><italic>i</italic>,<italic>m</italic></sub> and β<sub><italic>i</italic>,<italic>m</italic></sub> are penalties for adding or removing the variant <italic>m</italic> from allele <italic>S</italic><sub><italic>i</italic></sub>. Adding a variant is less common than missing a variant, so generally we use α<sub><italic>i</italic>,<italic>m</italic></sub> = 2 and β<sub><italic>i</italic>,<italic>m</italic></sub> = 1 for any <italic>i</italic> and <italic>m</italic> (<xref rid="GR277075HARC32" ref-type="bibr">Numanagić et al. 2018</xref>). Note that not all variants are the same: As functional (core) variants can fundamentally alter the behavior of a star-allele (and thus change its designation), Aldy disallows removing such variants from any star-allele and allows adding novel functional (core) variants to the allele if and only if no other assignment is possible. This is performed by setting the corresponding α<sub><italic>i</italic>,<italic>m</italic></sub> to a very large value. Note that novel core variants are added only if no other decision can be made.</p>
      <p>The star-allele calling model also enforces other constraints: Each functional (core) variant must be expressed by at least one allele, and each structural configuration must be expressed by at least one allele compatible with it. Finally, Aldy performs two rounds of star-allele calling for improved accuracy. In the first round, Aldy only considers functional (core) variants and identifies all major (core) star-allele combinations that explain the present functional variants (<xref rid="GR277075HARC32" ref-type="bibr">Numanagić et al. 2018</xref>). Being restricted solely to core variants, this step alone often produces multiple candidate solutions. Thus, Aldy then uses the second round to refine the candidate calls from the first round and break the ties by considering the silent variants (subvariants) as well. It finally selects the star-allele with the best second-round objective score as the final call.</p>
      <p>The formulation Aldy 4 uses for this step remains similar to the original model used in the older versions of Aldy. The single major difference is the change in the first (functional star-allele calling) round: Aldy 4 can now call star-alleles that contain novel functional (core) variants—a not uncommon event if a gene database is incomplete—if no other call can be made.</p>
    </sec>
    <sec id="s3d">
      <title>Read-based phasing</title>
      <p>The above-described model essentially performs a variant of statistical phasing: It uses the database knowledge to select the most likely haplotypes that best explain the given observations from the data. Although performing well in practice (<xref rid="GR277075HARC32" ref-type="bibr">Numanagić et al. 2018</xref>), there are nevertheless cases when the aforementioned model produces multiple equally likely calls. It is also unable to assign a novel variant to a particular star-allele unambiguously. Finally, in sporadic cases, the above model can produce incorrect results. These challenges can be resolved with long reads that provide long-range phasing information. Aldy 4 newly incorporates the handling of long-range phasing information to the star-allele calling model as follows.</p>
      <p>Suppose that there are <italic>z</italic> fragments <italic>R</italic><sub>1</sub>, …, <italic>R</italic><sub><italic>z</italic></sub>, each fragment being defined by a set of variants that it spans: <inline-formula id="il17"><mml:math id="IL17" display="inline" overflow="scroll"><mml:msub><mml:mi>R</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo fence="false">{</mml:mo><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo></mml:mrow><mml:mo fence="false">}</mml:mo><mml:mo>⊆</mml:mo><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow></mml:math></inline-formula>. Each sequenced fragment originated from a single star-allele and can thus be assigned to one of the star-alleles in the data set. This assignment can be controlled by introducing a binary variable <italic>f</italic><sub><italic>i</italic>,<italic>j</italic></sub> that is set if and only if a fragment <italic>R</italic><sub><italic>j</italic></sub> is assigned to <italic>S</italic><sub><italic>i</italic></sub>. Clearly, <inline-formula id="il18"><mml:math id="IL18" display="inline" overflow="scroll"><mml:munder><mml:mrow><mml:mo movablelimits="false">∑</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:munder><mml:mo>⁡</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> must be one for every <italic>R</italic><sub><italic>j</italic></sub> because each fragment originates from a single allele.</p>
      <p>Ideally, we want to assign a <italic>R</italic><sub><italic>j</italic></sub> to <italic>S</italic><sub><italic>i</italic></sub> only if such an assignment agrees with the star-allele sequence as much as possible. In other words, we want to minimize the number of disagreements between allele <italic>S</italic><sub><italic>i</italic></sub> and fragment <italic>R</italic><sub><italic>j</italic></sub>. Thus, the total disagreement of an assignment can be expressed as follows:<disp-formula id="GR277075HARUM8"><mml:math id="UM8" display="block" overflow="scroll"><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo movablelimits="false">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:mo movablelimits="false">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mspace width="0.4em"/><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula>
where <inline-formula id="il19"><mml:math id="IL19" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> denotes the set of variants that are not present in read <italic>R</italic><sub><italic>j</italic></sub> but are spanned by it.</p>
      <p>The total phasing error can be expressed as <inline-formula id="il20"><mml:math id="IL20" display="inline" overflow="scroll"><mml:munder><mml:mrow><mml:mo movablelimits="false">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:munder><mml:mo>⁡</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. This expression can be added to the objective function of the star-allele calling model. Although the expanded version of this expression contains quadratic terms, each quadratic term is a product of two binary variables and, as such, can be trivially linearized.</p>
      <p>As a final remark, note that the number of binary variables in the phasing model is dependent on the total number of present reads and alleles. In some cases, it can exceed half a million variables, making the overall model very costly to solve. The model can be significantly improved by using a smaller random sample of fragments, where the size of the random sample depends on the number of present reads and alleles.</p>
    </sec>
    <sec id="s3e">
      <title>Limitations</title>
      <p>Aldy uses ILP solvers to solve the presented models. Although ILP solving is NP-hard even when restricted to the models mentioned above (<xref rid="GR277075HARC32" ref-type="bibr">Numanagić et al. 2018</xref>), all these models are solvable in practice in less than a minute thanks to the state-of-the-art integer programming solvers used by Gurobi (<uri xlink:href="https://www.gurobi.com/">https://www.gurobi.com/</uri>) or CBC (<uri xlink:href="https://github.com/coin-or/Cbc/tree/releases/2.9.9">https://github.com/coin-or/Cbc/tree/releases/2.9.9</uri>) solvers.</p>
      <p>In some rare instances, Aldy cannot unambiguously call star-alleles from short-read data sets owing to the read length limitations and lack of strand information. In these cases, Aldy will report all possible solutions. In some cases, this might be misleading; for example, a *68 + *4/*5 call can be reported as *68/*4 (where *5 stands for deletion allele). However, both calls are functionally identical and should be treated as equal (as is performed here). Aldy also makes heavy use of the existing star-allele databases to call star-alleles and fusion breakpoints. Although it can handle cases in which the database is incomplete or lacking, it can theoretically report incorrect results if a present allele is wildly divergent from any allele in the database.</p>
      <p>Aldy 4's detection of structural configurations is highly dependent on the stability of coverage across different sequencing runs. Although this is not a significant issue for short-read WGS and targeted sequencing panels, the coverage might vary more than expected in PacBio samples. For this reason, Aldy 4 brings support for the exploration of a broader solution space when needed to account for potential noise.</p>
      <p>Finally, note that Aldy 4 does not cover all existing pharmacogenes: Genes from the <italic>IGH</italic> and <italic>HLA</italic> regions, ABC gene families (e.g., <italic>ABCG2</italic>), and the UGT1/2 gene clusters are prominently not included. Although some genes, such as <italic>ABCG2</italic>, can be easily supported with a corresponding database file (something that is planned for the future releases), more complex clusters such as HLA or IGH require major changes to the core algorithm to account for challenges posed by those regions and are better left to the specialized tools such as ImmunoTyper-SR (<xref rid="GR277075HARC10" ref-type="bibr">Ford et al. 2022</xref>).</p>
    </sec>
    <sec id="s3f">
      <title>Software availability</title>
      <p>Aldy 4 is available at GitHub (<uri xlink:href="https://github.com/0xTCG/aldy">https://github.com/0xTCG/aldy</uri>) and also uploaded as <ext-link xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.277075.122/-/DC1" ext-link-type="uri">Supplemental Code</ext-link>. The experimental procedure and results are available at GitHub (<uri xlink:href="https://github.com/0xTCG/aldy/tree/master/paper">https://github.com/0xTCG/aldy/tree/master/paper</uri>) and are also uploaded as the <ext-link xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.277075.122/-/DC1" ext-link-type="uri">Supplemental Notebook</ext-link> and <ext-link xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.277075.122/-/DC1" ext-link-type="uri">Supplemental Experiments</ext-link>, respectively.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplemental Material</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_33_1_61__DC1.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="x-zip-compressed" xlink:href="supp_gr.277075.122_Supplemental_Code.zip"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="vnd.ms-excel" xlink:href="supp_gr.277075.122_Supplemental_Experiments.xlsx"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_gr.277075.122_Supplemental_Notes.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="x-zip-compressed" xlink:href="supp_gr.277075.122_SupplementalNotebook.zip"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>We thank Richard Gibbs, Donna Muzny, and the rest of the Human Genome Sequencing Center at Baylor College of Medicine (Houston, Texas) for generating PGRNseq v.3 sequencing data. Q.Z. and I.N. were supported by a Natural Sciences and Engineering Research Council of Canada (NSERC) Discovery Grant (RGPIN-04973) and the Canada Research Chairs Program. A.H. and S.C.S. were supported by funding from the Intramural Research Programs of the National Cancer Institute (NCI). A.H. is also funded by the NCI-UMD Partnership Program.</p>
    <p><italic>Author contributions:</italic> A.H., S.C.S., and I.N. designed the study. N.G., J.H., and S.A.S. oversaw the generation of PacBio sequencing data. X.Q. and S.S. oversaw the generation of PGRNseq v.3 sequencing data. I.N. developed the software. A.H. and Q.Z. tested the software, designed the experimental procedure, and performed the experiments. A.H., Q.Z., and I.N. wrote the manuscript.</p>
  </ack>
  <fn-group>
    <fn fn-type="supplementary-material">
      <p>[Supplemental material is available for this article.]</p>
    </fn>
    <fn>
      <p>Article published online before print. Article, supplemental material, and publication date are at <ext-link xlink:href="https://www.genome.org/cgi/doi/10.1101/gr.277075.122" ext-link-type="uri">https://www.genome.org/cgi/doi/10.1101/gr.277075.122</ext-link>.</p>
    </fn>
  </fn-group>
  <sec id="s5">
    <title>Competing interest statement</title>
    <p>S.C.S. and I.N. are listed as coinventors on the U.S. Patent App. 16/615,089. N.G. and J.H. are employees and shareholders of Pacific Biosciences.</p>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="GR277075HARC1">
      <mixed-citation publication-type="journal"><string-name><surname>Berger</surname><given-names>E</given-names></string-name>, <string-name><surname>Yorukoglu</surname><given-names>D</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>L</given-names></string-name>, <string-name><surname>Nyquist</surname><given-names>SK</given-names></string-name>, <string-name><surname>Shalek</surname><given-names>AK</given-names></string-name>, <string-name><surname>Kellis</surname><given-names>M</given-names></string-name>, <string-name><surname>Numanagić</surname><given-names>I</given-names></string-name>, <string-name><surname>Berger</surname><given-names>B</given-names></string-name>. <year>2020</year>. <article-title>Improved haplotype inference by exploiting long-range linking and allelic imbalance in RNA-seq datasets</article-title>. <source>Nat Commun</source><volume>11</volume>: <fpage>4662</fpage>. <pub-id pub-id-type="doi">10.1038/s41467-020-18320-z</pub-id><pub-id pub-id-type="pmid">32938926</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC2">
      <mixed-citation publication-type="journal"><string-name><surname>Browning</surname><given-names>BL</given-names></string-name>, <string-name><surname>Tian</surname><given-names>X</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>Y</given-names></string-name>, <string-name><surname>Browning</surname><given-names>SR</given-names></string-name>. <year>2021</year>. <article-title>Fast two-stage phasing of large-scale sequence data</article-title>. <source>Am J Hum Genet</source><volume>108</volume>: <fpage>1880</fpage>–<lpage>1890</lpage>. <pub-id pub-id-type="doi">10.1016/j.ajhg.2021.08.005</pub-id><pub-id pub-id-type="pmid">34478634</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC3">
      <mixed-citation publication-type="journal"><string-name><surname>Caspar</surname><given-names>SM</given-names></string-name>, <string-name><surname>Schneider</surname><given-names>T</given-names></string-name>, <string-name><surname>Meienberg</surname><given-names>J</given-names></string-name>, <string-name><surname>Matyas</surname><given-names>G</given-names></string-name>. <year>2020</year>. <article-title>Added value of clinical sequencing: WGS-based profiling of pharmacogenes</article-title>. <source>Int J Mol Sci</source><volume>21</volume>: <fpage>2308</fpage>. <pub-id pub-id-type="doi">10.3390/ijms21072308</pub-id><pub-id pub-id-type="pmid">32225115</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC4">
      <mixed-citation publication-type="journal"><string-name><surname>Chen</surname><given-names>X</given-names></string-name>, <string-name><surname>Shen</surname><given-names>F</given-names></string-name>, <string-name><surname>Gonzaludo</surname><given-names>N</given-names></string-name>, <string-name><surname>Malhotra</surname><given-names>A</given-names></string-name>, <string-name><surname>Rogert</surname><given-names>C</given-names></string-name>, <string-name><surname>Taft</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Bentley</surname><given-names>DR</given-names></string-name>, <string-name><surname>Eberle</surname><given-names>MA</given-names></string-name>. <year>2021</year>. <article-title>Cyrius: accurate <italic>CYP2D6</italic> genotyping using whole-genome sequencing data</article-title>. <source>Pharmacogenomics J</source><volume>21</volume>: <fpage>251</fpage>–<lpage>261</lpage>. <pub-id pub-id-type="doi">10.1038/s41397-020-00205-5</pub-id><pub-id pub-id-type="pmid">33462347</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC5">
      <mixed-citation publication-type="journal"><string-name><surname>Crews</surname><given-names>KR</given-names></string-name>, <string-name><surname>Gaedigk</surname><given-names>A</given-names></string-name>, <string-name><surname>Dunnenberger</surname><given-names>HM</given-names></string-name>, <string-name><surname>Steve Leeder</surname><given-names>J</given-names></string-name>, <string-name><surname>Klein</surname><given-names>TE</given-names></string-name>, <string-name><surname>Caudle</surname><given-names>KE</given-names></string-name>, <string-name><surname>Haidar</surname><given-names>CE</given-names></string-name>, <string-name><surname>Shen</surname><given-names>DD</given-names></string-name>, <string-name><surname>Callaghan</surname><given-names>JT</given-names></string-name>, <string-name><surname>Sadhasivam</surname><given-names>S</given-names></string-name>, <etal/><year>2014</year>. <article-title>Clinical pharmacogenetics implementation consortium guidelines for cytochrome P450 2D6 genotype and codeine therapy: 2014 update</article-title>. <source>Clin Pharmacol Ther</source><volume>95</volume>: <fpage>376</fpage>–<lpage>382</lpage>. <pub-id pub-id-type="doi">10.1038/clpt.2013.254</pub-id><pub-id pub-id-type="pmid">24458010</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC6">
      <mixed-citation publication-type="journal"><string-name><surname>De Coster</surname><given-names>W</given-names></string-name>, <string-name><surname>Weissensteiner</surname><given-names>MH</given-names></string-name>, <string-name><surname>Sedlazeck</surname><given-names>FJ</given-names></string-name>. <year>2021</year>. <article-title>Towards population-scale long-read sequencing</article-title>. <source>Nat Rev Genet</source><volume>22</volume>: <fpage>572</fpage>–<lpage>587</lpage>. <pub-id pub-id-type="doi">10.1038/s41576-021-00367-3</pub-id><pub-id pub-id-type="pmid">34050336</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC7">
      <mixed-citation publication-type="journal"><string-name><surname>Edge</surname><given-names>P</given-names></string-name>, <string-name><surname>Bafna</surname><given-names>V</given-names></string-name>, <string-name><surname>Bansal</surname><given-names>V</given-names></string-name>. <year>2017</year>. <article-title>HapCUT2: robust and accurate haplotype assembly for diverse sequencing technologies</article-title>. <source>Genome Res</source><volume>27</volume>: <fpage>801</fpage>–<lpage>812</lpage>. <pub-id pub-id-type="doi">10.1101/gr.213462.116</pub-id><pub-id pub-id-type="pmid">27940952</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC8">
      <mixed-citation publication-type="journal"><string-name><surname>Fang</surname><given-names>H</given-names></string-name>, <string-name><surname>Liu</surname><given-names>X</given-names></string-name>, <string-name><surname>Ramírez</surname><given-names>J</given-names></string-name>, <string-name><surname>Choudhury</surname><given-names>N</given-names></string-name>, <string-name><surname>Kubo</surname><given-names>M</given-names></string-name>, <string-name><surname>Im</surname><given-names>HK</given-names></string-name>, <string-name><surname>Konkashbaev</surname><given-names>A</given-names></string-name>, <string-name><surname>Cox</surname><given-names>NJ</given-names></string-name>, <string-name><surname>Ratain</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Nakamura</surname><given-names>Y</given-names></string-name>, <etal/><year>2014</year>. <article-title>Establishment of CYP2D6 reference samples by multiple validated genotyping platforms</article-title>. <source>Pharmacogenomics J</source><volume>14</volume>: <fpage>564</fpage>–<lpage>572</lpage>. <pub-id pub-id-type="doi">10.1038/tpj.2014.27</pub-id><pub-id pub-id-type="pmid">24980783</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC9">
      <mixed-citation publication-type="journal"><string-name><surname>Ford</surname><given-names>M</given-names></string-name>, <string-name><surname>Haghshenas</surname><given-names>E</given-names></string-name>, <string-name><surname>Watson</surname><given-names>CT</given-names></string-name>, <string-name><surname>Sahinalp</surname><given-names>SC</given-names></string-name>. <year>2020</year>. <article-title>Genotyping and copy number analysis of immunoglobin heavy chain variable genes using long reads</article-title>. <source>iScience</source><volume>23</volume>: <fpage>100883</fpage>. <pub-id pub-id-type="doi">10.1016/j.isci.2020.100883</pub-id><pub-id pub-id-type="pmid">32109676</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC10">
      <mixed-citation publication-type="confproc"><string-name><surname>Ford</surname><given-names>M</given-names></string-name>, <string-name><surname>Hari</surname><given-names>A</given-names></string-name>, <string-name><surname>Rodriguez</surname><given-names>O</given-names></string-name>, <string-name><surname>Xu</surname><given-names>J</given-names></string-name>, <string-name><surname>Lack</surname><given-names>J</given-names></string-name>, <string-name><surname>Oguz</surname><given-names>C</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Weber</surname><given-names>S</given-names></string-name>, <string-name><surname>Magliocco</surname><given-names>M</given-names></string-name>, <string-name><surname>Barnett</surname><given-names>J</given-names></string-name>, <etal/><year>2022</year>. <article-title>ImmunoTyper-SR: a novel computational approach for genotyping immunoglobulin heavy chain variable genes using short read data</article-title>. In <conf-name>International Conference on Research in Computational Molecular Biology</conf-name>, San Diego, pp. <fpage>382</fpage>–<lpage>384</lpage>. <publisher-name>Springer</publisher-name>.</mixed-citation>
    </ref>
    <ref id="GR277075HARC12">
      <mixed-citation publication-type="journal"><string-name><surname>Gaedigk</surname><given-names>A</given-names></string-name>, <string-name><surname>Ingelman-Sundberg</surname><given-names>M</given-names></string-name>, <string-name><surname>Miller</surname><given-names>NA</given-names></string-name>, <string-name><surname>Steven Leeder</surname><given-names>J</given-names></string-name>, <string-name><surname>Whirl-Carrillo</surname><given-names>M</given-names></string-name>, <string-name><surname>Klein</surname><given-names>TE</given-names></string-name>, <collab>PharmVar Steering Committee</collab>. <year>2018</year>. <article-title>The Pharmacogene Variation (PharmVar) Consortium: incorporation of the human cytochrome P450 (<italic>CYP</italic>) allele nomenclature database</article-title>. <source>Clin Pharmacol Ther</source><volume>103</volume>: <fpage>399</fpage>–<lpage>401</lpage>. <pub-id pub-id-type="doi">10.1002/cpt.910</pub-id><pub-id pub-id-type="pmid">29134625</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC13">
      <mixed-citation publication-type="journal"><string-name><surname>Gaedigk</surname><given-names>A</given-names></string-name>, <string-name><surname>Turner</surname><given-names>A</given-names></string-name>, <string-name><surname>Everts</surname><given-names>RE</given-names></string-name>, <string-name><surname>Scott</surname><given-names>SA</given-names></string-name>, <string-name><surname>Aggarwal</surname><given-names>P</given-names></string-name>, <string-name><surname>Broeckel</surname><given-names>U</given-names></string-name>, <string-name><surname>McMillin</surname><given-names>GA</given-names></string-name>, <string-name><surname>Melis</surname><given-names>R</given-names></string-name>, <string-name><surname>Boone</surname><given-names>EC</given-names></string-name>, <string-name><surname>Pratt</surname><given-names>VM</given-names></string-name>, <etal/><year>2019</year>. <article-title>Characterization of reference materials for genetic testing of <italic>CYP2D6</italic> alleles: a GeT-RM collaborative project</article-title>. <source>J Mol Diagn</source><volume>21</volume>: <fpage>1034</fpage>–<lpage>1052</lpage>. <pub-id pub-id-type="doi">10.1016/j.jmoldx.2019.06.007</pub-id><pub-id pub-id-type="pmid">31401124</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC14">
      <mixed-citation publication-type="journal"><string-name><surname>Gaedigk</surname><given-names>A</given-names></string-name>, <string-name><surname>Boone</surname><given-names>EC</given-names></string-name>, <string-name><surname>Scherer</surname><given-names>SE</given-names></string-name>, <string-name><surname>Lee</surname><given-names>S-B</given-names></string-name>, <string-name><surname>Numanagić</surname><given-names>I</given-names></string-name>, <string-name><surname>Sahinalp</surname><given-names>C</given-names></string-name>, <string-name><surname>Smith</surname><given-names>JD</given-names></string-name>, <string-name><surname>Smith</surname><given-names>JD</given-names></string-name>, <string-name><surname>McGee</surname><given-names>S</given-names></string-name>, <string-name><surname>Radhakrishnan</surname><given-names>A</given-names></string-name>, <etal/><year>2022</year>. <article-title><italic>CYP2C8</italic>, <italic>CYP2C9</italic>, and <italic>CYP2C19</italic> characterization using next-generation sequencing and haplotype analysis: a GeT-RM collaborative project</article-title>. <source>J Mol Diagn</source><volume>24</volume>: <fpage>337</fpage>–<lpage>350</lpage>. <pub-id pub-id-type="doi">10.1016/j.jmoldx.2021.12.011</pub-id><pub-id pub-id-type="pmid">35134542</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC15">
      <mixed-citation publication-type="journal"><string-name><surname>Gordon</surname><given-names>AS</given-names></string-name>, <string-name><surname>Fulton</surname><given-names>RS</given-names></string-name>, <string-name><surname>Qin</surname><given-names>X</given-names></string-name>, <string-name><surname>Mardis</surname><given-names>ER</given-names></string-name>, <string-name><surname>Nickerson</surname><given-names>DA</given-names></string-name>, <string-name><surname>Scherer</surname><given-names>S</given-names></string-name>. <year>2016</year>. <article-title>PGRNseq: a targeted capture sequencing panel for pharmacogenetic research and implementation</article-title>. <source>Pharmacogenet Genomics</source><volume>26</volume>: <fpage>161</fpage>–<lpage>168</lpage>. <pub-id pub-id-type="doi">10.1097/FPC.0000000000000202</pub-id><pub-id pub-id-type="pmid">26736087</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC17">
      <mixed-citation publication-type="journal"><string-name><surname>Hagiwara</surname><given-names>K</given-names></string-name>, <string-name><surname>Edmonson</surname><given-names>MN</given-names></string-name>, <string-name><surname>Wheeler</surname><given-names>DA</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>J</given-names></string-name>. <year>2022</year>. <article-title>indelPost: harmonizing ambiguities in simple and complex indel alignments</article-title>. <source>Bioinformatics</source><volume>38</volume>: <fpage>549</fpage>–<lpage>551</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btab601</pub-id><pub-id pub-id-type="pmid">34431982</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC18">
      <mixed-citation publication-type="journal"><string-name><surname>Hamburg</surname><given-names>MA</given-names></string-name>, <string-name><surname>Collins</surname><given-names>FS</given-names></string-name>. <year>2010</year>. <article-title>The path to personalized medicine</article-title>. <source>N Engl J Med</source><volume>363</volume>: <fpage>301</fpage>–<lpage>304</lpage>. <pub-id pub-id-type="doi">10.1056/NEJMp1006304</pub-id><pub-id pub-id-type="pmid">20551152</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC19">
      <mixed-citation publication-type="journal"><string-name><surname>Hon</surname><given-names>T</given-names></string-name>, <string-name><surname>Mars</surname><given-names>K</given-names></string-name>, <string-name><surname>Young</surname><given-names>G</given-names></string-name>, <string-name><surname>Tsai</surname><given-names>Y-C</given-names></string-name>, <string-name><surname>Karalius</surname><given-names>JW</given-names></string-name>, <string-name><surname>Landolin</surname><given-names>JM</given-names></string-name>, <string-name><surname>Maurer</surname><given-names>N</given-names></string-name>, <string-name><surname>Kudrna</surname><given-names>D</given-names></string-name>, <string-name><surname>Hardigan</surname><given-names>MA</given-names></string-name>, <string-name><surname>Steiner</surname><given-names>CC</given-names></string-name>, <etal/><year>2020</year>. <article-title>Highly accurate long-read HiFi sequencing data for five complex genomes</article-title>. <source>Sci Data</source><volume>7</volume>: <fpage>399</fpage>. <pub-id pub-id-type="doi">10.1038/s41597-020-00743-4</pub-id><pub-id pub-id-type="pmid">33203859</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC20">
      <mixed-citation publication-type="journal"><string-name><surname>Ingelman-Sundberg</surname><given-names>M</given-names></string-name>. <year>2005</year>. <article-title>Genetic polymorphisms of cytochrome <italic>P</italic>450 2D6 (CYP2D6): clinical consequences, evolutionary aspects and functional diversity</article-title>. <source>Pharmacogenomics J</source><volume>5</volume>: <fpage>6</fpage>–<lpage>13</lpage>. <pub-id pub-id-type="doi">10.1038/sj.tpj.6500285</pub-id><pub-id pub-id-type="pmid">15492763</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC21">
      <mixed-citation publication-type="confproc"><string-name><surname>Kingan</surname><given-names>S</given-names></string-name>, <string-name><surname>Harting</surname><given-names>J</given-names></string-name>, <string-name><surname>Hon</surname><given-names>T</given-names></string-name>, <string-name><surname>Tsai</surname><given-names>YC</given-names></string-name>, <string-name><surname>McLaughlin</surname><given-names>I</given-names></string-name>, <string-name><surname>Ziegle</surname><given-names>J</given-names></string-name>, <string-name><surname>Han</surname><given-names>T</given-names></string-name>, <string-name><surname>Arbiza</surname><given-names>L</given-names></string-name>, <string-name><surname>Kloet</surname><given-names>S</given-names></string-name>, <string-name><surname>Busscher</surname><given-names>L</given-names></string-name>, <etal/><year>2022</year>. <article-title>Poster: enablement of long-read targeted sequencing panels using twist hybrid capture and PacBio HiFi sequencing</article-title>. In <conf-name>ESHG 2022</conf-name>, Vienna.</mixed-citation>
    </ref>
    <ref id="GR277075HARC22">
      <mixed-citation publication-type="journal"><string-name><surname>Kramer</surname><given-names>WE</given-names></string-name>, <string-name><surname>Walker</surname><given-names>DL</given-names></string-name>, <string-name><surname>O'Kane</surname><given-names>DJ</given-names></string-name>, <string-name><surname>Mrazek</surname><given-names>DA</given-names></string-name>, <string-name><surname>Fisher</surname><given-names>PK</given-names></string-name>, <string-name><surname>Dukek</surname><given-names>BA</given-names></string-name>, <string-name><surname>Bruflat</surname><given-names>JK</given-names></string-name>, <string-name><surname>Black</surname><given-names>JL</given-names></string-name>. <year>2009</year>. <article-title><italic>CYP2D6</italic>: novel genomic structures and alleles</article-title>. <source>Pharmacogenet Genomics</source><volume>19</volume>: <fpage>813</fpage>–<lpage>822</lpage>. <pub-id pub-id-type="doi">10.1097/FPC.0b013e3283317b95</pub-id><pub-id pub-id-type="pmid">19741566</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC23">
      <mixed-citation publication-type="journal"><string-name><surname>Lee</surname><given-names>S-b</given-names></string-name>, <string-name><surname>Wheeler</surname><given-names>MM</given-names></string-name>, <string-name><surname>Patterson</surname><given-names>K</given-names></string-name>, <string-name><surname>McGee</surname><given-names>S</given-names></string-name>, <string-name><surname>Dalton</surname><given-names>R</given-names></string-name>, <string-name><surname>Woodahl</surname><given-names>EL</given-names></string-name>, <string-name><surname>Gaedigk</surname><given-names>A</given-names></string-name>, <string-name><surname>Thummel</surname><given-names>KE</given-names></string-name>, <string-name><surname>Nickerson</surname><given-names>DA</given-names></string-name>. <year>2019</year>. <article-title>Stargazer: a software tool for calling star alleles from next-generation sequencing data using <italic>CYP2D6</italic> as a model</article-title>. <source>Genet Med</source><volume>21</volume>: <fpage>361</fpage>–<lpage>372</lpage>. <pub-id pub-id-type="doi">10.1038/s41436-018-0054-0</pub-id><pub-id pub-id-type="pmid">29875422</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC24">
      <mixed-citation publication-type="journal"><string-name><surname>Li</surname><given-names>H</given-names></string-name>. <year>2014</year>. <article-title>Toward better understanding of artifacts in variant calling from high-coverage samples</article-title>. <source>Bioinformatics</source><volume>30</volume>: <fpage>2843</fpage>–<lpage>2851</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btu356</pub-id><pub-id pub-id-type="pmid">24974202</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC25">
      <mixed-citation publication-type="journal"><string-name><surname>Li</surname><given-names>H</given-names></string-name>. <year>2018</year>. <article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>. <source>Bioinformatics</source><volume>34</volume>: <fpage>3094</fpage>–<lpage>3100</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bty191</pub-id><pub-id pub-id-type="pmid">29750242</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC26">
      <mixed-citation publication-type="journal"><string-name><surname>Li</surname><given-names>H</given-names></string-name>, <string-name><surname>Durbin</surname><given-names>R</given-names></string-name>. <year>2009</year>. <article-title>Fast and accurate short read alignment with Burrows–Wheeler transform</article-title>. <source>Bioinformatics</source><volume>25</volume>: <fpage>1754</fpage>–<lpage>1760</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp324</pub-id><pub-id pub-id-type="pmid">19451168</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC27">
      <mixed-citation publication-type="journal"><string-name><surname>Li</surname><given-names>H</given-names></string-name>, <string-name><surname>Handsaker</surname><given-names>B</given-names></string-name>, <string-name><surname>Wysoker</surname><given-names>A</given-names></string-name>, <string-name><surname>Fennell</surname><given-names>T</given-names></string-name>, <string-name><surname>Ruan</surname><given-names>J</given-names></string-name>, <string-name><surname>Homer</surname><given-names>N</given-names></string-name>, <string-name><surname>Marth</surname><given-names>G</given-names></string-name>, <string-name><surname>Abecasis</surname><given-names>G</given-names></string-name>, <string-name><surname>Durbin</surname><given-names>R</given-names></string-name>, <collab>1000 Genome Project Data Processing Subgroup</collab>. <year>2009</year>. <article-title>The Sequence Alignment/MAP format and SAMtools</article-title>. <source>Bioinformatics</source><volume>25</volume>: <fpage>2078</fpage>–<lpage>2079</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id><pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC28">
      <mixed-citation publication-type="journal"><string-name><surname>Loh</surname><given-names>P-R</given-names></string-name>, <string-name><surname>Palamara</surname><given-names>PF</given-names></string-name>, <string-name><surname>Price</surname><given-names>AL</given-names></string-name>. <year>2016</year>. <article-title>Fast and accurate long-range phasing in a UK Biobank cohort</article-title>. <source>Nat Genet</source><volume>48</volume>: <fpage>811</fpage>–<lpage>816</lpage>. <pub-id pub-id-type="doi">10.1038/ng.3571</pub-id><pub-id pub-id-type="pmid">27270109</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC29">
      <mixed-citation publication-type="journal"><string-name><surname>Ly</surname><given-names>RC</given-names></string-name>, <string-name><surname>Shugg</surname><given-names>T</given-names></string-name>, <string-name><surname>Ratcliff</surname><given-names>R</given-names></string-name>, <string-name><surname>Osei</surname><given-names>W</given-names></string-name>, <string-name><surname>Lynnes</surname><given-names>TC</given-names></string-name>, <string-name><surname>Pratt</surname><given-names>VM</given-names></string-name>, <string-name><surname>Schneider</surname><given-names>BP</given-names></string-name>, <string-name><surname>Radovich</surname><given-names>M</given-names></string-name>, <string-name><surname>Bray</surname><given-names>SM</given-names></string-name>, <string-name><surname>Salisbury</surname><given-names>BA</given-names></string-name>, <etal/><year>2022</year>. <article-title>Analytical validation of a computational method for pharmacogenetic genotyping from clinical whole exome sequencing</article-title>. <source>J Mol Diagn</source><volume>24</volume>: <fpage>576</fpage>–<lpage>585</lpage>. <pub-id pub-id-type="doi">10.1016/j.jmoldx.2022.03.008</pub-id><pub-id pub-id-type="pmid">35452844</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC30">
      <mixed-citation publication-type="journal"><string-name><surname>McKenna</surname><given-names>A</given-names></string-name>, <string-name><surname>Hanna</surname><given-names>M</given-names></string-name>, <string-name><surname>Banks</surname><given-names>E</given-names></string-name>, <string-name><surname>Sivachenko</surname><given-names>A</given-names></string-name>, <string-name><surname>Cibulskis</surname><given-names>K</given-names></string-name>, <string-name><surname>Kernytsky</surname><given-names>A</given-names></string-name>, <string-name><surname>Garimella</surname><given-names>K</given-names></string-name>, <string-name><surname>Altshuler</surname><given-names>D</given-names></string-name>, <string-name><surname>Gabriel</surname><given-names>S</given-names></string-name>, <string-name><surname>Daly</surname><given-names>M</given-names></string-name>, <etal/><year>2010</year>. <article-title>The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>. <source>Genome Res</source><volume>20</volume>: <fpage>1297</fpage>–<lpage>1303</lpage>. <pub-id pub-id-type="doi">10.1101/gr.107524.110</pub-id><pub-id pub-id-type="pmid">20644199</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC31">
      <mixed-citation publication-type="journal"><string-name><surname>Numanagić</surname><given-names>I</given-names></string-name>, <string-name><surname>Malikić</surname><given-names>S</given-names></string-name>, <string-name><surname>Pratt</surname><given-names>VM</given-names></string-name>, <string-name><surname>Skaar</surname><given-names>TC</given-names></string-name>, <string-name><surname>Flockhart</surname><given-names>DA</given-names></string-name>, <string-name><surname>Sahinalp</surname><given-names>SC</given-names></string-name>. <year>2015</year>. <article-title>Cypiripi: exact genotyping of <italic>CYP2D6</italic> using high-throughput sequencing data</article-title>. <source>Bioinformatics</source><volume>31</volume>: <fpage>i27</fpage>–<lpage>i34</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btv232</pub-id><pub-id pub-id-type="pmid">26072492</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC32">
      <mixed-citation publication-type="journal"><string-name><surname>Numanagić</surname><given-names>I</given-names></string-name>, <string-name><surname>Malikić</surname><given-names>S</given-names></string-name>, <string-name><surname>Ford</surname><given-names>M</given-names></string-name>, <string-name><surname>Qin</surname><given-names>X</given-names></string-name>, <string-name><surname>Toji</surname><given-names>L</given-names></string-name>, <string-name><surname>Radovich</surname><given-names>M</given-names></string-name>, <string-name><surname>Skaar</surname><given-names>TC</given-names></string-name>, <string-name><surname>Pratt</surname><given-names>VM</given-names></string-name>, <string-name><surname>Berger</surname><given-names>B</given-names></string-name>, <string-name><surname>Scherer</surname><given-names>S</given-names></string-name>, <etal/><year>2018</year>. <article-title>Allelic decomposition and exact genotyping of highly polymorphic and structurally variant genes</article-title>. <source>Nat Commun</source><volume>9</volume>: <fpage>828</fpage>. <pub-id pub-id-type="doi">10.1038/s41467-018-03273-1</pub-id><pub-id pub-id-type="pmid">29483503</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC33">
      <mixed-citation publication-type="other"><string-name><surname>Poplin</surname><given-names>R</given-names></string-name>, <string-name><surname>Ruano-Rubio</surname><given-names>V</given-names></string-name>, <string-name><surname>DePristo</surname><given-names>MA</given-names></string-name>, <string-name><surname>Fennell</surname><given-names>TJ</given-names></string-name>, <string-name><surname>Carneiro</surname><given-names>MO</given-names></string-name>, <string-name><surname>Van der Auwera</surname><given-names>GA</given-names></string-name>, <string-name><surname>Kling</surname><given-names>DE</given-names></string-name>, <string-name><surname>Gauthier</surname><given-names>LD</given-names></string-name>, <string-name><surname>Levy-Moonshine</surname><given-names>A</given-names></string-name>, <string-name><surname>Roazen</surname><given-names>D</given-names></string-name>, <etal/><year>2017</year>. <article-title>Scaling accurate genetic variant discovery to tens of thousands of samples</article-title>. <source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/201178</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC34">
      <mixed-citation publication-type="confproc"><string-name><surname>Portik</surname><given-names>D</given-names></string-name>, <string-name><surname>Hon</surname><given-names>T</given-names></string-name>, <string-name><surname>Wilcots</surname><given-names>J</given-names></string-name>, <string-name><surname>Gonzaludo</surname><given-names>N</given-names></string-name>, <string-name><surname>Yang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Hammond</surname><given-names>NA</given-names></string-name>, <string-name><surname>Kronenberg</surname><given-names>Z</given-names></string-name>, <string-name><surname>Watson</surname><given-names>N</given-names></string-name>, <string-name><surname>Harting</surname><given-names>J</given-names></string-name>, <string-name><surname>Ashley</surname><given-names>E</given-names></string-name>, <etal/><year>2021</year>. <article-title>Abstract: development and optimization of a 43 gene pharmacogenomic panel using enrichment-based capture and PacBio HiFi sequencing</article-title>. In <conf-name>ASHG 2021 Virtual Conference</conf-name>.</mixed-citation>
    </ref>
    <ref id="GR277075HARC35">
      <mixed-citation publication-type="journal"><string-name><surname>Pratt</surname><given-names>VM</given-names></string-name>, <string-name><surname>Zehnbauer</surname><given-names>B</given-names></string-name>, <string-name><surname>Wilson</surname><given-names>JA</given-names></string-name>, <string-name><surname>Baak</surname><given-names>R</given-names></string-name>, <string-name><surname>Babic</surname><given-names>N</given-names></string-name>, <string-name><surname>Bettinotti</surname><given-names>M</given-names></string-name>, <string-name><surname>Buller</surname><given-names>A</given-names></string-name>, <string-name><surname>Butz</surname><given-names>K</given-names></string-name>, <string-name><surname>Campbell</surname><given-names>M</given-names></string-name>, <string-name><surname>Civalier</surname><given-names>C</given-names></string-name>, <etal/><year>2010</year>. <article-title>Characterization of 107 genomic DNA reference materials for <italic>CYP2D6</italic>, <italic>CYP2C19</italic>, <italic>CYP2C9</italic>, <italic>VKORC1</italic>, and <italic>UGT1A1</italic>: a GeT-RM and association for molecular pathology collaborative project</article-title>. <source>J Mol Diagn</source><volume>12</volume>: <fpage>835</fpage>–<lpage>846</lpage>. <pub-id pub-id-type="doi">10.2353/jmoldx.2010.100090</pub-id><pub-id pub-id-type="pmid">20889555</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC36">
      <mixed-citation publication-type="journal"><string-name><surname>Pratt</surname><given-names>VM</given-names></string-name>, <string-name><surname>Everts</surname><given-names>RE</given-names></string-name>, <string-name><surname>Aggarwal</surname><given-names>P</given-names></string-name>, <string-name><surname>Beyer</surname><given-names>BN</given-names></string-name>, <string-name><surname>Broeckel</surname><given-names>U</given-names></string-name>, <string-name><surname>Epstein-Baak</surname><given-names>R</given-names></string-name>, <string-name><surname>Hujsak</surname><given-names>P</given-names></string-name>, <string-name><surname>Kornreich</surname><given-names>R</given-names></string-name>, <string-name><surname>Liao</surname><given-names>J</given-names></string-name>, <string-name><surname>Lorier</surname><given-names>R</given-names></string-name>, <etal/><year>2016</year>. <article-title>Characterization of 137 genomic DNA reference materials for 28 pharmacogenetic genes: a GeT-RM collaborative project</article-title>. <source>J Mol Diagn</source><volume>18</volume>: <fpage>109</fpage>–<lpage>123</lpage>. <pub-id pub-id-type="doi">10.1016/j.jmoldx.2015.08.005</pub-id><pub-id pub-id-type="pmid">26621101</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC38">
      <mixed-citation publication-type="journal"><string-name><surname>Relling</surname><given-names>MV</given-names></string-name>, <string-name><surname>Evans</surname><given-names>WE</given-names></string-name>. <year>2015</year>. <article-title>Pharmacogenomics in the clinic</article-title>. <source>Nature</source><volume>526</volume>: <fpage>343</fpage>–<lpage>350</lpage>. <pub-id pub-id-type="doi">10.1038/nature15817</pub-id><pub-id pub-id-type="pmid">26469045</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC39">
      <mixed-citation publication-type="journal"><string-name><surname>Robarge</surname><given-names>JD</given-names></string-name>, <string-name><surname>Li</surname><given-names>L</given-names></string-name>, <string-name><surname>Desta</surname><given-names>Z</given-names></string-name>, <string-name><surname>Nguyen</surname><given-names>A</given-names></string-name>, <string-name><surname>Flockhart</surname><given-names>DA</given-names></string-name>. <year>2007</year>. <article-title>The star-allele nomenclature: retooling for translational genomics</article-title>. <source>Clin Pharmacol Ther</source><volume>82</volume>: <fpage>244</fpage>–<lpage>248</lpage>. <pub-id pub-id-type="doi">10.1038/sj.clpt.6100284</pub-id><pub-id pub-id-type="pmid">17700589</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC40">
      <mixed-citation publication-type="journal"><string-name><surname>Robinson</surname><given-names>JT</given-names></string-name>, <string-name><surname>Thorvaldsdóttir</surname><given-names>H</given-names></string-name>, <string-name><surname>Winckler</surname><given-names>W</given-names></string-name>, <string-name><surname>Guttman</surname><given-names>M</given-names></string-name>, <string-name><surname>Lander</surname><given-names>ES</given-names></string-name>, <string-name><surname>Getz</surname><given-names>G</given-names></string-name>, <string-name><surname>Mesirov</surname><given-names>JP</given-names></string-name>. <year>2011</year>. <article-title>Integrative genomics viewer</article-title>. <source>Nat Biotechnol</source><volume>29</volume>: <fpage>24</fpage>–<lpage>26</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.1754</pub-id><pub-id pub-id-type="pmid">21221095</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC41">
      <mixed-citation publication-type="journal"><string-name><surname>Sangkuhl</surname><given-names>K</given-names></string-name>, <string-name><surname>Whirl-Carrillo</surname><given-names>M</given-names></string-name>, <string-name><surname>Whaley</surname><given-names>RM</given-names></string-name>, <string-name><surname>Woon</surname><given-names>M</given-names></string-name>, <string-name><surname>Lavertu</surname><given-names>A</given-names></string-name>, <string-name><surname>Altman</surname><given-names>RB</given-names></string-name>, <string-name><surname>Carter</surname><given-names>L</given-names></string-name>, <string-name><surname>Verma</surname><given-names>A</given-names></string-name>, <string-name><surname>Ritchie</surname><given-names>MD</given-names></string-name>, <string-name><surname>Klein</surname><given-names>TE</given-names></string-name>. <year>2020</year>. <article-title>Pharmacogenomics Clinical Annotation Tool (PharmCAT)</article-title>. <source>Clin Pharmacol Ther</source><volume>107</volume>: <fpage>203</fpage>–<lpage>210</lpage>. <pub-id pub-id-type="doi">10.1002/cpt.1568</pub-id><pub-id pub-id-type="pmid">31306493</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC42">
      <mixed-citation publication-type="journal"><string-name><surname>Scott</surname><given-names>SA</given-names></string-name>, <string-name><surname>Scott</surname><given-names>ER</given-names></string-name>, <string-name><surname>Seki</surname><given-names>Y</given-names></string-name>, <string-name><surname>Chen</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Wallsten</surname><given-names>R</given-names></string-name>, <string-name><surname>Obeng</surname><given-names>AO</given-names></string-name>, <string-name><surname>Botton</surname><given-names>MR</given-names></string-name>, <string-name><surname>Cody</surname><given-names>N</given-names></string-name>, <string-name><surname>Shi</surname><given-names>H</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>G</given-names></string-name>, <etal/><year>2021</year>. <article-title>Development and analytical validation of a 29 gene clinical pharmacogenetic genotyping panel: multi-ethnic allele and copy number variant detection</article-title>. <source>Clin Transl Sci</source><volume>14</volume>: <fpage>204</fpage>–<lpage>213</lpage>. <pub-id pub-id-type="doi">10.1111/cts.12844</pub-id><pub-id pub-id-type="pmid">32931151</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC43">
      <mixed-citation publication-type="journal"><string-name><surname>Sezutsu</surname><given-names>H</given-names></string-name>, <string-name><surname>Le Goff</surname><given-names>G</given-names></string-name>, <string-name><surname>Feyereisen</surname><given-names>R</given-names></string-name>. <year>2013</year>. <article-title>Origins of P450 diversity</article-title>. <source>Philos Trans R Soc B Biol Sci</source><volume>368</volume>: <fpage>20120428</fpage>. <pub-id pub-id-type="doi">10.1098/rstb.2012.0428</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC44">
      <mixed-citation publication-type="confproc"><string-name><surname>Shajii</surname><given-names>A</given-names></string-name>, <string-name><surname>Numanagic</surname><given-names>I</given-names></string-name>, <string-name><surname>Berger</surname><given-names>B</given-names></string-name>. <year>2018</year>. <article-title>Latent variable model for aligning barcoded short-reads improves downstream analyses</article-title>. In <conf-name>RECOMB</conf-name>, Paris, pp. <fpage>280</fpage>–<lpage>282</lpage>. <publisher-name>Springer</publisher-name>.</mixed-citation>
    </ref>
    <ref id="GR277075HARC45">
      <mixed-citation publication-type="journal"><string-name><surname>Sim</surname><given-names>SC</given-names></string-name>, <string-name><surname>Daly</surname><given-names>AK</given-names></string-name>, <string-name><surname>Gaedigk</surname><given-names>A</given-names></string-name>. <year>2012</year>. <article-title><italic>CYP2D6</italic> update: revised nomenclature for <italic>CYP2D7</italic>/<italic>2D6</italic> hybrid genes</article-title>. <source>Pharmacogenet Genomics</source><volume>22</volume>: <fpage>692</fpage>–<lpage>694</lpage>. <pub-id pub-id-type="doi">10.1097/FPC.0b013e3283546d3c</pub-id><pub-id pub-id-type="pmid">22868903</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC46">
      <mixed-citation publication-type="journal"><string-name><surname>Twesigomwe</surname><given-names>D</given-names></string-name>, <string-name><surname>Wright</surname><given-names>GE</given-names></string-name>, <string-name><surname>Drögemöller</surname><given-names>BI</given-names></string-name>, <string-name><surname>da Rocha</surname><given-names>J</given-names></string-name>, <string-name><surname>Lombard</surname><given-names>Z</given-names></string-name>, <string-name><surname>Hazelhurst</surname><given-names>S</given-names></string-name>. <year>2020</year>. <article-title>A systematic comparison of pharmacogene star allele calling bioinformatics algorithms: a focus on <italic>CYP2D6</italic> genotyping</article-title>. <source>NPJ Genom Med</source><volume>5</volume>: <fpage>30</fpage>. <pub-id pub-id-type="doi">10.1038/s41525-020-0135-2</pub-id><pub-id pub-id-type="pmid">32789024</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC47">
      <mixed-citation publication-type="journal"><string-name><surname>Twesigomwe</surname><given-names>D</given-names></string-name>, <string-name><surname>Drögemöller</surname><given-names>BI</given-names></string-name>, <string-name><surname>Wright</surname><given-names>GE</given-names></string-name>, <string-name><surname>Siddiqui</surname><given-names>A</given-names></string-name>, <string-name><surname>da Rocha</surname><given-names>J</given-names></string-name>, <string-name><surname>Lombard</surname><given-names>Z</given-names></string-name>, <string-name><surname>Hazelhurst</surname><given-names>S</given-names></string-name>. <year>2021</year>. <article-title>StellarPGx: a Nextflow pipeline for calling star alleles in cytochrome P450 genes</article-title>. <source>Clin Pharmacol Ther</source><volume>110</volume>: <fpage>741</fpage>–<lpage>749</lpage>. <pub-id pub-id-type="doi">10.1002/cpt.2173</pub-id><pub-id pub-id-type="pmid">33492672</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC48">
      <mixed-citation publication-type="journal"><string-name><surname>Twist</surname><given-names>GP</given-names></string-name>, <string-name><surname>Gaedigk</surname><given-names>A</given-names></string-name>, <string-name><surname>Miller</surname><given-names>NA</given-names></string-name>, <string-name><surname>Farrow</surname><given-names>EG</given-names></string-name>, <string-name><surname>Willig</surname><given-names>LK</given-names></string-name>, <string-name><surname>Dinwiddie</surname><given-names>DL</given-names></string-name>, <string-name><surname>Petrikin</surname><given-names>JE</given-names></string-name>, <string-name><surname>Soden</surname><given-names>SE</given-names></string-name>, <string-name><surname>Herd</surname><given-names>S</given-names></string-name>, <string-name><surname>Gibson</surname><given-names>M</given-names></string-name>, <etal/><year>2016</year>. <article-title>Constellation: a tool for rapid, automated phenotype assignment of a highly polymorphic pharmacogene, <italic>CYP2D6</italic>, from whole-genome sequences</article-title>. <source>NPJ Genom Med</source><volume>1</volume>: <fpage>15007</fpage>. <pub-id pub-id-type="doi">10.1038/npjgenmed.2015.7</pub-id><pub-id pub-id-type="pmid">29263805</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC49">
      <mixed-citation publication-type="journal"><string-name><surname>Van der Auwera</surname><given-names>GA</given-names></string-name>, <string-name><surname>Carneiro</surname><given-names>MO</given-names></string-name>, <string-name><surname>Hartl</surname><given-names>C</given-names></string-name>, <string-name><surname>Poplin</surname><given-names>R</given-names></string-name>, <string-name><surname>del Angel</surname><given-names>G</given-names></string-name>, <string-name><surname>Levy-Moonshine</surname><given-names>A</given-names></string-name>, <string-name><surname>Jordan</surname><given-names>T</given-names></string-name>, <string-name><surname>Shakir</surname><given-names>K</given-names></string-name>, <string-name><surname>Roazen</surname><given-names>D</given-names></string-name>, <string-name><surname>Thibault</surname><given-names>J</given-names></string-name>, <etal/><year>2013</year>. <article-title>From FastQ data to high confidence variant calls: the Genome Analysis Toolkit best practices pipeline</article-title>. <source>Curr Protoc Bioinformatics</source><volume>43</volume>: <fpage>11.10.1</fpage>–<lpage>11.10.33</lpage>. <pub-id pub-id-type="doi">10.1002/0471250953.bi1110s43</pub-id></mixed-citation>
    </ref>
    <ref id="GR277075HARC50">
      <mixed-citation publication-type="journal"><string-name><surname>Weinshilboum</surname><given-names>RM</given-names></string-name>, <string-name><surname>Wang</surname><given-names>L</given-names></string-name>. <year>2017</year>. <article-title>Pharmacogenomics: precision medicine and drug response</article-title>. <source>Mayo Clin Proc</source><volume>92</volume>: <fpage>1711</fpage>–<lpage>1722</lpage>. <pub-id pub-id-type="doi">10.1016/j.mayocp.2017.09.001</pub-id><pub-id pub-id-type="pmid">29101939</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
