<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2951084</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btq455</article-id>
    <article-id pub-id-type="publisher-id">btq455</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group>
          <subject>Database and Ontologies</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>METAREP: JCVI metagenomics reports—an open source tool for high-performance comparative metagenomics</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Goll</surname>
          <given-names>Johannes</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rusch</surname>
          <given-names>Douglas B.</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tanenbaum</surname>
          <given-names>David M.</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Thiagarajan</surname>
          <given-names>Mathangi</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Kelvin</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Methé</surname>
          <given-names>Barbara A.</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yooseph</surname>
          <given-names>Shibu</given-names>
        </name>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff>The J. Craig Venter Institute, Rockville, MD 20850, USA</aff>
    <author-notes>
      <corresp id="COR1">* To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate Editor: Martin Bishop</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>10</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>26</day>
      <month>8</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>26</day>
      <month>8</month>
      <year>2010</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>26</volume>
    <issue>20</issue>
    <fpage>2631</fpage>
    <lpage>2632</lpage>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>6</month>
        <year>2010</year>
      </date>
      <date date-type="rev-recd">
        <day>28</day>
        <month>7</month>
        <year>2010</year>
      </date>
      <date date-type="accepted">
        <day>4</day>
        <month>8</month>
        <year>2010</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2010. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2010</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">http://creativecommons.org/licenses/by-nc/2.5</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> JCVI Metagenomics Reports (METAREP) is a Web 2.0 application designed to help scientists analyze and compare annotated metagenomics datasets. It utilizes Solr/Lucene, a high-performance scalable search engine, to quickly query large data collections. Furthermore, users can use its SQL-like query syntax to filter and refine datasets. METAREP provides graphical summaries for top taxonomic and functional classifications as well as a GO, NCBI Taxonomy and KEGG Pathway Browser. Users can compare absolute and relative counts of multiple datasets at various functional and taxonomic levels. Advanced comparative features comprise statistical tests as well as multidimensional scaling, heatmap and hierarchical clustering plots. Summaries can be exported as tab-delimited files, publication quality plots in PDF format. A data management layer allows collaborative data analysis and result sharing.</p>
      <p><bold>Availability:</bold> Web site <ext-link ext-link-type="uri" xlink:href="http://www.jcvi.org/metarep">http://www.jcvi.org/metarep</ext-link>; source code <ext-link ext-link-type="uri" xlink:href="http://github.com/jcvi/METAREP">http://github.com/jcvi/METAREP</ext-link></p>
      <p>
        <bold>Contact:</bold>
        <email>syooseph@jcvi.org</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq455/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>Recent advances in sequencing technologies have boosted microbial ecology research by allowing cost-effective sequencing of microbial communities directly from their natural environment. As of today, 210 microbial metagenomes sampled from diverse environments such as the ocean, acid mine drainage, soil, bovine rumen and the human body have been reported (<ext-link ext-link-type="uri" xlink:href="http://www.genomesonline.org/">http://www.genomesonline.org/</ext-link>). Such studies promise to reveal new insights into how microbes adapt to their abiotic and biotic environment. To distill such information from metagenomic sequences, computational methods are being used to identify and analyze their functional and taxonomic signatures.</p>
    <p>Metagenomic annotation pipelines have been developed that help researchers to identify such information (Markowitz <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2008</xref>; Meyer <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2008</xref>; Tanenbaum <italic>et al.</italic>, <xref ref-type="bibr" rid="B5">2010</xref>). To make higher level inferences from such annotated data, computational biologists have developed various analysis tools. MEGAN, for example, allows users to import BLAST outputs to generate taxonomic and functional summaries (Huson <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">2007</xref>). Others allow statistical analysis, such as MetaStats and ShotgunFunctionalizeR (Kristiansson <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2009</xref>; White <italic>et al.</italic>, <xref ref-type="bibr" rid="B6">2009</xref>). While most of these tools provide generic interfaces that are independent of the annotation pipeline used, they do not allow to analyze function in the context of phylogeny and vice versa. For example, MG-RAST facilitates the analysis of either phylogenetic or metabolic content, but they cannot be related to one another. The same is true for MEGAN that provides individual taxonomic and functional summaries. Most importantly, with the ever increasing size of metagenomics datasets, performance and scalability of such tools becomes essential.</p>
    <p>We describe JCVI Metagenomics Reports (METAREP), a new open source tool that addresses such shortcomings by providing a scalable yet flexible comparative metagenomics framework.</p>
  </sec>
  <sec id="SEC2">
    <title>2 DATA IMPORT</title>
    <p>Users can install METAREP and import annotation data obtained from reads or assemblies using METAREP's index generation scripts. The METAREP data format supports the most common metagenomics annotation data types including a free-text functional description, best BLAST hit information such as NCBI taxon, <italic>E</italic>-value, percent identity, percent sequence coverage, as well as GO ID, EC ID and protein domain ID (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq455/DC1">Supplementary Table S1</ext-link>). During the import process, auxiliary fields are populated using the NCBI Taxonomy and Gene Ontology (GO) to store all ancestors of a taxon or GO ID, respectively.</p>
  </sec>
  <sec id="SEC3">
    <title>3 WEB ANALYSIS FEATURES</title>
    <p>The METAREP View pages provide high-level summaries for a dataset (<xref ref-type="fig" rid="F1">Fig. 1</xref>A). Each tab provides a ranked list and bar chart for the respective data type. The <italic>Species Tab</italic>, for example, summarizes top ranks for identified species. The Search pages let users specify fields, or logical combinations of fields (14 fields are supported) to filter datasets. The auxiliary fields <italic>blast_tree</italic> and <italic>go_tree</italic> may be used to select or exclude certain subsets of the NCBI Taxonomy or the GO tree. For example, one can search for all bacteria or exclude eukaryotes or search for a certain GO/taxonomic combination. The search returns lists and pie charts that summarize the top functional and taxonomic categories of the found subset. Similar summaries can be studied by using the Browse pages that are available for taxonomic, pathway, enzyme and GO classifications (<xref ref-type="fig" rid="F1">Fig. 1</xref>B). The goal of the Compare pages is to help the user quickly find the interesting differences between datasets (<xref ref-type="fig" rid="F1">Fig. 1</xref>C–E). Individual datasets can be grouped together to provide greater statistical resolving power. After selecting datasets using the searchable dataset-select box, users can specify a filter query that is applied to all datasets before the comparison. In addition, a minimum absolute count can be specified to filter out categories that are spurious. Various comparative options can be selected ranging from absolute and relative counts, to chi-square and non-parametric <italic>t</italic>-tests (MetaStats; White <italic>et al.</italic>, <xref ref-type="bibr" rid="B6">2009</xref>)) to multidimensional scaling, heatmap (<xref ref-type="fig" rid="F1">Fig. 1</xref>D) and hierarchical cluster plots (<xref ref-type="fig" rid="F1">Fig. 1</xref>E). Users can choose the annotation data type they wish to compare by choosing from several tabs (Taxonomy, GO, pathway, HMM, enzyme and common name are supported). The level of the comparison can be specified in each tab (for taxonomy the rank can be adjusted, for GO the distance from the root, etc.). Counts and statistics can be exported in tab-delimited, plots in PDF format.
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>The METAREP web interface is designed to be user-friendly and fast, allowing users to view, search, browse and compare metagenomics datasets.</p></caption><graphic xlink:href="btq455f1"/></fig></p>
  </sec>
  <sec id="SEC4">
    <title>4 IT INFRASTRUCTURE AND PERFORMANCE</title>
    <p>METAREP uses the enterprise search platform Lucene/Solr served by a JETTY web server that runs on a Java HotSpot 64-Bit Server VM. Currently, we have indexed 68 million documents (46 GB) distributed over 330 index files. Much larger index volumes can be handled as shown by HAthi Trust, a digital library, which currently indexes 227 Tbytes of data (<ext-link ext-link-type="uri" xlink:href="http://www.hathitrust.org/">http://www.hathitrust.org/</ext-link>). User account information and dataset meta-information is stored in a MySQL database. The web logic is implemented in PHP using the CAKEPHP framework. Index files are served by two load balanced Dell Power Edge R710 servers each having eight cores (2.66 GHz), 72G RAM and 2x 600 GB HD. Query performance increases linearly with increasing workload until it peaks at 3100 search requests per second (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq455/DC1">Supplementary Fig. 1</ext-link>).</p>
  </sec>
  <sec sec-type="discussion" id="SEC5">
    <title>5 DISCUSSION</title>
    <p>A variety of metagenomics analysis tools are provided either as standalone or via the web. The strength of our web-based approach is a generic data model indexed by a high-performance search engine in combination with a user-friendly Web 2.0 interface. JCVI's annotated metagenomes as well as other selected public datasets can be accessed at <ext-link ext-link-type="uri" xlink:href="www.jcvi.org/metarep">www.jcvi.org/metarep</ext-link>. Users that wish to analyze their own metagenomics data must install the software and import their own annotations. We invite interested programmers to contribute to the METAREP open-source project hosted at <ext-link ext-link-type="uri" xlink:href="http://github.com/jcvi/METAREP">http://github.com/jcvi/METAREP</ext-link>. Finally, users are encouraged to suggest additional features of interest.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_26_20_2631__index.html"/>
      <media xlink:role="associated-file" mimetype="text" mime-subtype="plain" xlink:href="supp_btq455_metarep-supplementary-figure-1.png"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="vnd.ms-excel" xlink:href="supp_btq455_metarep-supplementary-table-1.xls"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We would like to thank Cynthia Pfannkoch and Shannon Williamson for their critique and input.</p>
    <p><italic>Funding</italic>: US Department of Energy (#DE-FG02-02ER63453, #DE-FC02-02ER63446); National Institute of Allergy and Infectious Diseases (1U54AI084844); National Cancer Institute (UH2CA14023); Sloan Foundation (#2004-5-46EG); University of Illinois, Department of Primary Industries, Victoria, Australia.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huson</surname>
            <given-names>DH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MEGAN analysis of metagenomic data</article-title>
        <source>Genome Res.</source>
        <year>2007</year>
        <volume>17</volume>
        <fpage>377</fpage>
        <lpage>386</lpage>
        <pub-id pub-id-type="pmid">17255551</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kristiansson</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ShotgunFunctionalizeR: an R-package for functional comparison of metagenomes</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2737</fpage>
        <lpage>2738</lpage>
        <pub-id pub-id-type="pmid">19696045</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Markowitz</surname>
            <given-names>VM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>IMG/M: a data management and analysis system for metagenomes</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>D534</fpage>
        <lpage>D538</lpage>
        <pub-id pub-id-type="pmid">17932063</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meyer</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The metagenomics RAST server - a public resource for the automatic phylogenetic and functional analysis of metagenomes</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>386</fpage>
        <pub-id pub-id-type="pmid">18803844</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tanenbaum</surname>
            <given-names>DM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The JCVI standard operating procedure for annotating prokaryotic metagenomic shotgun sequencing data</article-title>
        <source>Stand. Genomic Sci.</source>
        <year>2010</year>
        <volume>2</volume>
        <fpage>2</fpage>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>White</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Statistical methods for detecting differentially abundant features in clinical metagenomic samples</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2009</year>
        <volume>5</volume>
        <fpage>e1000352</fpage>
        <pub-id pub-id-type="pmid">19360128</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
