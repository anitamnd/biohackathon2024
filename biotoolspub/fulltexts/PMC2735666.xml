<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1460-2059</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2735666</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btp410</article-id>
    <article-id pub-id-type="publisher-id">btp410</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group>
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>k</italic>-link EST clustering: evaluating error introduced by chimeric sequences under different degrees of linkage</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Bragg</surname>
          <given-names>Lauren M.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stone</surname>
          <given-names>Glenn</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup>CSIRO Mathematical and Information Sciences, North Ryde, NSW 2113 and <sup>2</sup>Preventative Health National Research Flagship, Locked Bag 17, North Ryde, NSW 1670, Australia</aff>
    <author-notes>
      <corresp id="COR1">*To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate Editor: Dmitrij Frishman</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>9</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>7</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>1</day>
      <month>7</month>
      <year>2009</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>25</volume>
    <issue>18</issue>
    <fpage>2302</fpage>
    <lpage>2308</lpage>
    <history>
      <date date-type="received">
        <day>6</day>
        <month>4</month>
        <year>2009</year>
      </date>
      <date date-type="rev-recd">
        <day>4</day>
        <month>6</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>6</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> The clustering of expressed sequence tags (ESTs) is a crucial step in many sequence analysis studies that require a high level of redundancy. Chimeric sequences, while uncommon, can make achieving the optimal EST clustering a challenge. Single-linkage algorithms are particularly vulnerable to the effects of chimeras. To avoid chimera-facilitated erroneous merges, researchers using single-linkage algorithms are forced to use stringent sequence–similarity thresholds. Such thresholds reduce the sensitivity of the clustering algorithm.</p>
      <p><bold>Results:</bold> We introduce the concept of <monospace><italic>k</italic>-link</monospace> clustering for EST data. We evaluate how clustering error rates vary over a range of linkage thresholds. Using <monospace><italic>k</italic>-link</monospace>, we show that Type II error decreases in response to increasing the number of shared ESTs (ie. links) required. We observe a base level of Type II error likely caused by the presence of unmasked low-complexity or repetitive sequence. We find that Type I error increases gradually with increased linkage. To minimize the Type I error introduced by increased linkage requirements, we propose an extension to <monospace><italic>k</italic>-link</monospace> which modifies the required number of links with respect to the size of clusters being compared.</p>
      <p><bold>Availability:</bold> The implementation of <monospace><italic>k</italic>-link</monospace> is available under the terms of the GPL from <ext-link ext-link-type="uri" xlink:href="http://www.bioinformatics.csiro.au/products.shtml">http://www.bioinformatics.csiro.au/products.shtml</ext-link>. <monospace><italic>k</italic>-link</monospace> is licensed under the GNU General Public License, and can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://www.bioinformatics.csiro.au/products.shtml">http://www.bioinformatics.csiro.au/products.shtml</ext-link>. <monospace><italic>k</italic>-link</monospace> is written in C++.</p>
      <p>
        <bold>Contact:</bold>
        <email>lauren.bragg@csiro.au</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp410/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>While sequencing may be becoming more economical, many species are unlikely to be fully sequenced in the near future. Genome size and complexity can often decide whether an organism will become a candidate for genome sequencing. Even when a genome has been sequenced, there is no guarantee that sequencing reads can be assembled successfully. High-repeat content and extensive gene families (due to rounds of genome duplication) can often confound sequence assemblers, resulting in fragmented or ambiguous assemblies. <italic>Sorghum</italic>, perhaps one of the genetically simpler grasses, with a haploid genome of 10 chromosomes, a genome size ≈730 Mb, 61% of which is repetitive content, has been sequenced with at least 8 × redundancy, yet still has over 3000 super-contigs (constituting roughly 10% of the genomic sequence) that cannot be assigned to a chromosome (Patterson <italic>et al</italic>., <xref ref-type="bibr" rid="B18">2009</xref>).</p>
    <p>Expressed sequence tags (ESTs) have often provided an inexpensive, transcriptionally biased, genomic substitute for many types of analyses. Studies that require high levels of sequence redundancy, such as polymorphism discovery, often use EST data. A crucial step within most sequence analysis pipelines is the process of clustering.</p>
    <p>Clustering acts as a coarse filter in these analysis pipelines, reducing the input size to the, often computationally expensive, alignment process. The algorithm used often depends on whether the user wants to construct clusters of ESTs representing the same transcript (<italic>transcript assemblies</italic>), or alternatively, grouping all transcriptional products of the same gene (<italic>gene index)</italic>.</p>
    <p>Many clustering algorithms are designed to cluster ESTs given a set of reference sequences, be it a genome or a set of complete mRNA sequences [TGICL (Pertea <italic>et al</italic>., <xref ref-type="bibr" rid="B20">2003</xref>); Unigene (Boguski and Schuler, <xref ref-type="bibr" rid="B2">1995</xref>); ECgene (Kim <italic>et al</italic>., <xref ref-type="bibr" rid="B11">2005</xref>); to name a few). Many benefits can be gained from the use of genomic scaffolds: they reduce the number of pair wise sequence comparisons, they are often less error-prone than ESTs and they ensure that phylogenetically divergent transcripts with shared domains (such as paralogues, chimeras and repeat-containing transcripts) are not placed in the same cluster.</p>
    <p>When species-specific reference sequences are unavailable, it is not uncommon to use the genome of a related species to guide the clustering process. However, use of a reference derived from a related organism should be approached with caution. To account for genomic distance, sequence identity thresholds may need to be dropped significantly. This can easily confound efforts to separate paralogous sequences. This will be particularly deleterious for those species which have experienced several rounds of genome duplication.</p>
    <p>The presence of chimeric sequences in a EST dataset is considered a significant barrier to achieving accurate clusterings in the absence of a reference genome (Sorek and Safer, <xref ref-type="bibr" rid="B23">2003</xref>). Chimerism is typically a PCR-induced artefact whereby two or more ESTs, typically from different genes, are artificially ligated. The detrimental influence of chimeric sequences may be somewhat restrained by increasing the align-length threshold (for example, requiring that 75% of the larger EST aligns to the smaller EST). However, such an approach would reduce the overall sensitivity of the clustering algorithm. Clustering algorithms which implement the single-linkage merging method will be particularly vulnerable to chimera-facilitated erroneous merges.</p>
    <p>A previous study evaluated the effect of the sequence–similarity threshold on EST clustering error (Wang <italic>et al</italic>., <xref ref-type="bibr" rid="B25">2004</xref>). Analogous to their statistical interpretation, errors in clustering can be designated as Type I or Type II errors. A Type I clustering error indicates that ESTs from the same gene have been placed in separate clusters. A Type II error describes the case where sequences from different genes have been clustered together. Wang <italic>et al</italic>. (<xref ref-type="bibr" rid="B25">2004</xref>) identified that Type I and Type II errors were minimized while using a sequence–similarity threshold of 25–40 bases aligned at 90% identity. Despite these findings, many clustering algorithms default to significantly more stringent parameters [<monospace>CLOBB</monospace> (Parkinson <italic>et al</italic>., <xref ref-type="bibr" rid="B19">2002</xref>), with 30 bases at 95% identity, <monospace>d2_cluster</monospace> (Burke <italic>et al</italic>., <xref ref-type="bibr" rid="B3">1999</xref>) with 100 bases at 90% identity, just to name a few]. Curiously, no one has investigated how the degree of linkage is used when clustering influences the magnitude and the type of clustering error. Here, we investigate how, when using this optimal sequence–similarity threshold, the required number of links (<italic>k</italic>) between clusters influences clustering error. To facilitate this investigation, we have developed a clustering algorithm, <monospace><italic>k</italic>-link</monospace>, to produce a <italic>k</italic>-link EST clustering.</p>
    <sec id="SEC1.1">
      <title>1.1 Existing clustering methods</title>
      <p>EST clustering has been an extensively explored research area. Quite a number of algorithms and computational tools have been described in the literature. Perhaps the most commonly used reference clusterings are the ‘gene indices’ (where each cluster contains transcripts from the same gene) produced by the <monospace>TGICL</monospace> algorithm, developed by TIGR (Pertea <italic>et al</italic>., <xref ref-type="bibr" rid="B20">2003</xref>).</p>
      <p>TIGR gene index construction involves comparing EST and gene sequences using <monospace>FLAST</monospace> (Quackenbush <italic>et al</italic>., <xref ref-type="bibr" rid="B22">2001</xref>). Sequences sharing a minimum identity of 95% over a ≥40 nt region, with each end of the alignment having less than 40 mismatches, are grouped into a cluster. This means one EST can belong to multiple clusters, and relies on anchor sequences (genomic or cDNA) to ensure that ESTs generated from different regions of the same gene are clustered together. Strictly speaking, TIGR does not need reference sequences to produce clusters; however, we expect the quality of the clustering will suffer as merges are not conducted between clearly overlapping EST clusters.</p>
      <p><monospace>CAP3</monospace> (Huang and Madan, <xref ref-type="bibr" rid="B7">1999</xref>), a ‘DNA sequence assembly program’, has been the mainstay (with over 700 citations) in sequence clustering and assembly since its inception. While it is intended as genomic sequence-assembly program, its versatility has lead to its use in numerous EST analysis pipelines [for example, <monospace>autoSNP</monospace> (Barker <italic>et al</italic>., <xref ref-type="bibr" rid="B1">2003</xref>); <monospace>QualitySNP</monospace> (Tang <italic>et al</italic>., <xref ref-type="bibr" rid="B24">2006</xref>)]. In our personal experience, CAP3 is a highly conservative algorithm, which while being very precise about which sequences are placed together, produced significantly large numbers (≈80% of input dataset) of ‘singlet’ (or singleton) clusters when using 90% identity and 40 base overlap as parameters (Bragg, unpublished data). The <monospace>CAP3</monospace> algorithm uses numerous heuristics which will not be summarized here.</p>
      <p>There are several algorithms which have been specifically developed to cluster ESTs in the absence of genomic or full-length mRNA scaffolds. Most prominently, a succession of single-linkage EST clustering algorithms which use the <monospace>d</monospace><sup>2</sup> distance metric (Hide <italic>et al</italic>., <xref ref-type="bibr" rid="B5">1994</xref>) [see <monospace>d2_cluster</monospace> (Burke <italic>et al</italic>., <xref ref-type="bibr" rid="B3">1999</xref>); <monospace>CLU</monospace> (Ptitsyn and Hide, <xref ref-type="bibr" rid="B21">2005</xref>); and more recently, <monospace>wcd</monospace> (Hazelhurst <italic>et al</italic>., <xref ref-type="bibr" rid="B4">2008</xref>)]. While these algorithms are fast and highly scalable, the single-linkage clustering method implemented therein is highly susceptible to merges between unrelated clusters due to chimeric sequences. While chimeras are uncommon [frequency of 0.01 (Hillier <italic>et al</italic>., <xref ref-type="bibr" rid="B6">1996</xref>)], it is intuitive, especially in large datasets, that random chimeric sequences can cause an inordinate amount of damage to clustering results. In the absence of a genomic reference, the influence of chimeric sequences on the clustering outcome becomes a real problem. It is for this reason that many clustering algorithms are run with very stringent similarity thresholds. Unfortunately, the end result is often a trade-off of errors introduced by chimeric sequences for errors introduced by high sequence–similarity thresholds.</p>
      <p>The study conducted by Wang <italic>et al</italic>. (<xref ref-type="bibr" rid="B25">2004</xref>) evaluated how the sequence-identity and align-length clustering parameters contributed to clustering error. Here, we investigate how the number of links required to merge clusters influences the error of the clustering.</p>
    </sec>
  </sec>
  <sec sec-type="methods" id="SEC2">
    <title>2 METHODS</title>
    <sec id="SEC2.1">
      <title>2.1 <monospace><italic>k</italic>-link</monospace> clustering algorithm</title>
      <p>The clustering algorithm begins with an all-against-all EST comparison. For every query EST, a cluster is created with this EST as the seed, and every EST that aligned at or above our similarity threshold is added to the cluster. This means for a set of <italic>n</italic> ESTs, there will be <italic>n</italic> initial clusters. This is seen as the initialization step of the clustering process, and is separate from the clustering algorithm itself. We have used <monospace>megaBLAST</monospace> for this comparison, and filtered the hits based on our earlier definition of a match. Non-default parameters (<italic>N</italic> = 0, <italic>E</italic> = 0.1, <italic>W</italic> = 12, <italic>T</italic> = 21) for <monospace>megaBLAST</monospace> were used as suggested in Korf <italic>et al</italic>. (<xref ref-type="bibr" rid="B13">2003</xref>). These initial clusters can be easily generated using other alignment methods, and for this reason, we have decoupled the cluster initialization process from the cluster comparison and merge steps. This flexibility enables users to decide which sequence alignment algorithm they wish to use to construct the initial cluster seeds.</p>
      <p>The start of the iteration begins with the pair wise cluster comparison, where the number of ESTs shared by two clusters is calculated. If the number of shared ESTs is larger than the number of required links <italic>k</italic>, or the clusters are identical, this is recorded. Otherwise, if there are shared ESTs, but this is less than the number required, these ESTs are marked as potential chimeras. In the first iteration only, clusters seeded with an EST that is marked as chimeric will be removed. This is because a cluster seeded with a chimera (composed of genes A and B, say) will contain a mix of sequences from genes A to B. This chimera-seeded cluster, depending on the value of <italic>k</italic>, would be able to merge with both clusters containing A sequences, and clusters containing B sequences. To avoid this, we ensure that putative chimeras are removed prior to any merging operations. At the end of all the required cluster comparisons, the cluster pairs which had at least <italic>k</italic> links are now merged. This marks the end of the iteration.</p>
      <p>As the parameter <italic>k</italic> must be estimated from cluster sizes, a rough clustering iteration is performed using a large number of links (<italic>k</italic> defaults to 6). The actual number of links required is then calculated (this calculation is described in <xref ref-type="sec" rid="SEC2.2">Section 2.2</xref>). The rough clustering is then discarded. The clustering algorithm then begins its first iteration using the estimated <italic>k</italic>.</p>
      <p>Consecutive iterations consist of the cluster comparison and merge steps. Clustering stops when no merges are recorded within an iteration, or when the maximum number of iterations has been reached.</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Estimating the links parameter</title>
      <p>The <monospace><italic>k</italic>-link</monospace> algorithm outlined requires users to specify <italic>k</italic>, the number of links required. Clearly, to choose an appropriate linkage level, the chimeric frequency, dataset size and number of expected clusters (or ‘gene indices’ represented in the data) will need to be taken into account. Here, we describe the statistical model behind estimating the linkage parameter.</p>
      <p>A chimeric sequence, or chimera, can suggest similarity between unrelated clusters of ESTs. As mentioned earlier, chimerism is a relatively rare event, and for this reason we have restricted our statistical model to consider only chimeras generated by a fusion of <italic>two</italic> unrelated ESTs.</p>
      <p>In the single-link-based algorithms, non-exclusive clusters of ESTs will be merged when they have a common member. In practice, this will occur erroneously whenever there is a chimera that links two clusters. In the clustering algorithm that we propose, we will merge clusters based on <italic>k</italic> links. Thus, we need to consider the probability of obtaining multiple chimeras of the same chimeric type, that is, with one part of an EST derived from gene (cluster) A (say) and the second part derived from gene (cluster) B.</p>
      <p>Clearly, if there are <italic>m</italic> genes in the organism of interest, there are <inline-formula><inline-graphic xlink:href="btp410i1.jpg"/></inline-formula> different possible chimeric types. In order to control the erroneous merging of clusters, we need to understand the probability of observing a number of chimeras of the same chimeric type. When the number of links of interest is two, this is analogous to the so called ‘Birthday Problem’.</p>
      <p>The Birthday Problem considers a class of <italic>n</italic> individuals and then asks what is the probability that two (or more) individuals have the same birthday. In general, this probability can be written as
<disp-formula><graphic xlink:href="btp410um1"/></disp-formula>
where <italic>n</italic> is the number of individuals, and <italic>N</italic> is the number of possible birthdays (365). This formulation assumes for simplicity that the probability of an individual having a particular birthday is uniform across all possible birthdays.</p>
      <p>For our example, we need to generalize this problem in two ways. First, we are interested in considering <italic>k</italic> or more common links between clusters. Second, it is unlikely that uniform probabilities of occurrence of chimeric types will even approximately hold. This then becomes a general problem in multinomial probabilities. Suppose we decide to merge all cluster with <italic>k</italic> or more links (ESTs in common). We will make an erroneous merge due to chimeras with probability <italic>q</italic><sub><italic>k</italic></sub> where
<disp-formula><graphic xlink:href="btp410um2"/></disp-formula>
and (<italic>X</italic><sub>1</sub>,…, <italic>X</italic><sub><italic>N</italic></sub>) is a random vector from a multinomial distribution with parameters <italic>n</italic> and (<italic>p</italic><sub>1</sub>,…, <italic>p</italic><sub><italic>N</italic></sub>). In this case, <italic>N</italic> is the number of possible chimeric types and is given by <inline-formula><inline-graphic xlink:href="btp410i2.jpg"/></inline-formula>, <italic>n</italic> is the total number of chimeras in the database of ESTs and <italic>p</italic><sub><italic>i</italic></sub> is the probability of observing a chimera of type <italic>i</italic>. In our example, <italic>N</italic> and <italic>n</italic> are likely very large and computation of <italic>q</italic><sub><italic>k</italic></sub> by enumeration is computationally tedious, however, Levin (<xref ref-type="bibr" rid="B14">1981</xref>) proposes an approximation approach based on Edgeworth expansions, and provides bounds for the true probabilities.</p>
      <p>Thus, given <italic>m</italic>, <italic>n</italic> and the vector of probabilities <italic>p</italic>, we can determine the probability of observing <italic>k</italic> or more chimeras of the same type. This can be used to set the number of links in the clustering algorithm, that is, choose <italic>k</italic> such that the probability of observing these many chimeras of the same type is small, which corresponds to the probability of erroneously merging two clusters because of chimeras being small. To estimate that the parameter <italic>n</italic> is relatively straightforward, we simply assume that 1% of ESTs are chimeric. Possible estimates for <italic>p</italic> can be derived from the distribution of cluster sizes expected (if they are known, or taken from a species with a similar number of genes and expression profile) or by simply assuming uniform probabilities (analogous to the Birthday Problem).</p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 Datasets</title>
      <p>Three EST datasets were selected for evaluating clustering error rates. All were downloaded from NCBI using eUtils on November 10, 2008. (i) <italic>Caenorhabditis elegans</italic> ESTs (352 043 sequences), (ii) <italic>Oryza sativa</italic> ssp. Indica (173 887 sequences) and (iii) <italic>Sorghum Bicolor</italic> (202 294 sequences).</p>
      <p>For the construction of the reference clusters, genomic sequences for these species were also downloaded [<italic>C.elegans</italic> genome build Ce6, <italic>S.bicolor</italic> genome (Sbi1) and <italic>O.sativa</italic> ssp. Indica (Gramene build Jan 2005, 48)]. The <italic>Sorghum</italic> genome assembly Sbi1 consists of 10 chromosomes and over 3000 super-contigs. For ease-of-analysis with BLAT (Kent, <xref ref-type="bibr" rid="B9">2002</xref>), the 3000 super-contigs were excluded from our study.</p>
    </sec>
    <sec id="SEC2.4">
      <title>2.4 Masking</title>
      <p>Masking is a crucial process that must be applied, especially in EST datasets, to prevent common EST features (such as linkers, poly-A tails and repeat sequences) from negatively influencing the clustering process. Repeat databases have been constructed for many species, and are commonly used in the masking process.</p>
      <p>For novel or unsequenced species, a species-specific repeat database may not exist. Recent studies have shown that use of repeats from a related organism have little to no positive effect on clustering outcomes (Malde and Jonassen, <xref ref-type="bibr" rid="B16">2008</xref>). The use of library-less repeat-masking, such as that provided by <monospace>RBR</monospace> (Malde <italic>et al</italic>., <xref ref-type="bibr" rid="B15">2006</xref>), can overcome the lack of a species-specific repeat library.</p>
      <p>All ESTs used in this experiment had been processed with <monospace>RBR</monospace> prior to clustering. The default configuration of <italic>s</italic> = 1.5 and <italic>d</italic> = 6 was used for the <italic>C.elegans</italic> and <italic>O.sativa</italic> datasets. <italic>Sorghum</italic>, with its high repeat content, was subjected to the more aggressive masking thresholds of <italic>s</italic> = 1 and <italic>d</italic> = 4. For all datasets, the default word size of 16 was used.</p>
      <p>For each dataset, 100 000 ESTs were randomly selected and supplied to <monospace>RBR</monospace> for the generation of the oligomer repeat library. All ESTs in the dataset were then masked using this library.</p>
      <p>As some low-complexity sequences are not statistically overrepresented in these datasets, any remaining low-complexity sequences were masked using <monospace>mdust</monospace> (R.L.Tatusov and D.J.Lipman, unpublished data) at default settings.</p>
      <p>A preliminary run of <monospace><italic>k</italic>-link</monospace> (<italic>k</italic> = 10) showed a large cluster forming in each dataset. Upon manual inspection, the clustering appeared due to inadequate masking of repeats/transposed elements. Increasing <monospace>RBR</monospace> (<italic>s</italic> = 1 and <italic>d</italic> = 3) and <monospace>mdust</monospace> (word size = 12) masking failed to mute these uninformative regions within the large clusters. At the risk of losing a large proportion of the dataset by trying to aggressively mask these large clusters, we decided to omit these ESTs altogether.</p>
      <p>After masking, sequences with less than 40 consecutively unmasked bases were removed from further analysis. For the creation of reference clusters, 314 784 <italic>C.elegans</italic> ESTs, 160 537 <italic>O.sativa</italic> ESTs and 187 894 <italic>S.bicolor</italic> sequences were available.</p>
    </sec>
    <sec id="SEC2.5">
      <title>2.5 Reference clusters</title>
      <p>Reference clusters were constructed in a similar manner to those in Malde and Jonassen (<xref ref-type="bibr" rid="B16">2008</xref>). ESTs were matched to their genomic location using <monospace>BLAT</monospace> (step size = 6) (Kent, <xref ref-type="bibr" rid="B9">2002</xref>). To maintain consistency throughout the study, we define a match as a 40 base window in the alignment of query and target sequence where there is at least 90% sequence identity (i.e. at least 36 bases are identical). It has been shown that a sequence identity threshold of 90% minimizes the Type I and Type II clustering errors introduced by the sequence alignment component of the clustering process (Wang <italic>et al</italic>., <xref ref-type="bibr" rid="B25">2004</xref>).</p>
      <p>If multiple locations matched, the best hit was taken. Unmatched ESTs were removed from further analysis.</p>
      <p>A sliding window was moved along the genomic sequence to identify clusters. Overlapping ESTs were aggregated into the same cluster if their genomic coordinates overlapped by at least 40 bases. Clustering results are shown in <xref ref-type="table" rid="T1">Table 1</xref>. For all three datasets, roughly half of the ESTs could be aligned to the genome. We believe this is due to both the high level of sequence masking and BLATs relatively poor performance on short (and/or divergent) query sequences (<ext-link ext-link-type="uri" xlink:href="http://genome.ucsc.edu/FAQ/FAQblat">http://genome.ucsc.edu/FAQ/FAQblat</ext-link>).
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Results of clustering ESTs using a genomic reference</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Species</th><th rowspan="1" colspan="1">#Clusters</th><th rowspan="1" colspan="1">#ESTs</th><th rowspan="1" colspan="1">Percentage alignable<xref ref-type="table-fn" rid="TF1"><sup>a</sup></xref> to genome</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1"><italic>Caenorhabditis elegans</italic></td><td rowspan="1" colspan="1">23 002</td><td rowspan="1" colspan="1">151 923</td><td rowspan="1" colspan="1">48.26</td></tr><tr><td rowspan="1" colspan="1"><italic>Oryza sativa</italic></td><td rowspan="1" colspan="1">24 525</td><td rowspan="1" colspan="1">71 113</td><td rowspan="1" colspan="1">44.30</td></tr><tr><td rowspan="1" colspan="1"><italic>Sorghum bicolor</italic></td><td rowspan="1" colspan="1">20 361</td><td rowspan="1" colspan="1">96 506</td><td rowspan="1" colspan="1">51.36</td></tr></tbody></table><table-wrap-foot><fn id="TF1"><p><sup>a</sup>With align threshold being 90% identity over a window of 40 bases.</p></fn></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="SEC2.6">
      <title>2.6 Clustering comparison</title>
      <p>Common metrics for comparing the clusterings [Jaccard Index (Jaccard, <xref ref-type="bibr" rid="B8">1901</xref>); Variation of Information metric (Meila, <xref ref-type="bibr" rid="B17">2007</xref>)] assume that a clustering is a partitioning of a dataset into mutually disjoint sets. While this may be true of our reference clustering (where we took the ‘best’ hit for each EST), this one-to-one mapping is not guaranteed by the <monospace><italic>k</italic>-link</monospace> algorithm (for <italic>k</italic> &gt; 1). This is because clusters with insufficient links will not be merged, thus the shared members will belong to both clusters. These sequences represent putative chimeras.</p>
      <p>In the case of disjoint clusters, we can define
<disp-formula><graphic xlink:href="btp410um3"/></disp-formula>
Then the number of <italic>true positives</italic> is,
<disp-formula><graphic xlink:href="btp410um4"/></disp-formula>
and the number of <italic>true negatives</italic> is,
<disp-formula><graphic xlink:href="btp410um5"/></disp-formula>
where the sums are taken over all pairs of objects. For non-disjoint (comparison) clusterings, we need to adapt <italic>C</italic><sub><italic>ij</italic></sub>. Let <italic>A</italic><sub><italic>i</italic></sub> be the set of clusters containing object <italic>i</italic>. Then for disjoint clusters we can write,
<disp-formula><graphic xlink:href="btp410um6"/></disp-formula>
We propose for (possibly) non-disjoint clusters the measure,
<disp-formula><graphic xlink:href="btp410um7"/></disp-formula>
which represents the probability that a cluster chosen randomly from the set <italic>A</italic><sub><italic>i</italic></sub> is the same as one chosen randomly from <italic>A</italic><sub><italic>j</italic></sub>. This has the effect of penalizing the amount of non-disjointness in the clustering.</p>
      <p>The definitions of true negatives and positives then go through as before with <italic>C</italic><sup>⋆</sup><sub><italic>ij</italic></sub> replacing <italic>C</italic><sub><italic>ij</italic></sub>. The complete table of definitions is,
<disp-formula><graphic xlink:href="btp410um8"/></disp-formula>
For further reading, see Klastorin (<xref ref-type="bibr" rid="B12">1980</xref>). Using the definitions above, we proceed to define the type I error rate as the number of false negatives (FN) divided by the sum of true positives (TP) and false negatives. Correspondingly, the type II error rate is the number of false positives (FP) divided by the sum of the true positives and false positives.</p>
      <p>To investigate how linkage degree effects clustering error, we ran <monospace><italic>k</italic>-link</monospace> on the three datasets for <italic>k</italic> ∈ {1, 2, 3, 4, 5}. Error rates were calculated for the results of each run.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>3 RESULTS</title>
    <p>To validate whether use of a rough clustering (<italic>k</italic> = 6) was a good enough approximation to the ‘true’ distribution of clusters, we estimated the probability bounds for co-occurrence using <italic>k</italic> = 2, 3. This bound estimation is provided in the <monospace><italic>k</italic>-link</monospace> software. As a reference, we also estimated <italic>k</italic> using the reference cluster size distribution (see <xref ref-type="table" rid="T1">Table 1</xref> of the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp410/DC1">supplementary figures</ext-link>). The probabilities estimated from the rough clusterings were similar in magnitude (but not identical) to the probabilities estimated from the reference cluster sizes (<xref ref-type="table" rid="T2">Table 2</xref>). Despite these differences, each rough clustering suggested the same number of required links (<italic>k</italic> = 3, at the 0.01 significance level) as that estimated from the reference clustering for the dataset.
<table-wrap id="T2" position="float"><label>Table 2.</label><caption><p>Probability of seeing at least <italic>k</italic> occurrences of the same chimeric type</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Species</th><th colspan="2" rowspan="1">Number of occurences<hr/></th></tr><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">2</th><th rowspan="1" colspan="1">3</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1"><italic>Caenorhabditis elegans</italic></td><td rowspan="1" colspan="1">(0.3696, 0.4611)</td><td rowspan="1" colspan="1">(0.0049, 0.0049)</td></tr><tr><td rowspan="1" colspan="1"><italic>Oryza sativa</italic></td><td rowspan="1" colspan="1">(0.0183, 0.0185)</td><td rowspan="1" colspan="1">(&lt;0.0001, &lt;0.0001)</td></tr><tr><td rowspan="1" colspan="1"><italic>Sorghum bicolor</italic></td><td rowspan="1" colspan="1">(0.1888, 0.2092)</td><td rowspan="1" colspan="1">(0.0012, 0.0012)</td></tr></tbody></table><table-wrap-foot><fn><p>Probabilities were calculated using a rough 6-link clustering.</p></fn></table-wrap-foot></table-wrap></p>
    <sec id="SEC3.1">
      <title>3.1 Evaluating clustering error</title>
      <p>There appears to be a significant amount of Type II error in the datasets (<xref ref-type="table" rid="T3">Table 3</xref>). As expected, the Type I error FN/(TP + FN) is increasing as the number of required links is incremented. Conversely, the Type II error [FP/(TP + FP)] is decreasing as the number of required links is incremented.
<table-wrap id="T3" position="float"><label>Table 3.</label><caption><p>Evaluation of error introduced by linkage degree</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Species</th><th rowspan="1" colspan="1">TP</th><th rowspan="1" colspan="1">FP</th><th rowspan="1" colspan="1">FN</th><th rowspan="1" colspan="1">FN/(TP + FN)</th><th rowspan="1" colspan="1">FP/(TP + FP)</th></tr></thead><tbody align="left"><tr><td colspan="6" rowspan="1"><italic>Caenorhabditis elegans</italic></td></tr><tr><td rowspan="1" colspan="1">    Single-link</td><td rowspan="1" colspan="1">6 293 463</td><td rowspan="1" colspan="1">1 873 985</td><td rowspan="1" colspan="1">7256</td><td rowspan="1" colspan="1">0.0012</td><td rowspan="1" colspan="1">0.2294</td></tr><tr><td rowspan="1" colspan="1">    2-link</td><td rowspan="1" colspan="1">6 293 463</td><td rowspan="1" colspan="1">1 873 985</td><td rowspan="1" colspan="1">7256</td><td rowspan="1" colspan="1">0.0012</td><td rowspan="1" colspan="1">0.2294</td></tr><tr><td rowspan="1" colspan="1">    3-link</td><td rowspan="1" colspan="1">6 220 829.56</td><td rowspan="1" colspan="1">1 608 038.61</td><td rowspan="1" colspan="1">79 889.44</td><td rowspan="1" colspan="1">0.0127</td><td rowspan="1" colspan="1">0.2054</td></tr><tr><td rowspan="1" colspan="1">    4-link</td><td rowspan="1" colspan="1">6 171 122.04</td><td rowspan="1" colspan="1">1 340 286.73</td><td rowspan="1" colspan="1">129 596.96</td><td rowspan="1" colspan="1">0.0206</td><td rowspan="1" colspan="1">0.1784</td></tr><tr><td rowspan="1" colspan="1">    5-link</td><td rowspan="1" colspan="1">6 129 294.1</td><td rowspan="1" colspan="1">1 282 964.12</td><td rowspan="1" colspan="1">171 424.9</td><td rowspan="1" colspan="1">0.0272</td><td rowspan="1" colspan="1">0.1731</td></tr><tr><td colspan="6" rowspan="1"><italic>Oryza sativa</italic></td></tr><tr><td rowspan="1" colspan="1">    Single-link</td><td rowspan="1" colspan="1">544 450</td><td rowspan="1" colspan="1">777 126</td><td rowspan="1" colspan="1">1723</td><td rowspan="1" colspan="1">0.0032</td><td rowspan="1" colspan="1">0.5880</td></tr><tr><td rowspan="1" colspan="1">    2-link</td><td rowspan="1" colspan="1">544 409.5</td><td rowspan="1" colspan="1">771 706.75</td><td rowspan="1" colspan="1">1763.5</td><td rowspan="1" colspan="1">0.0032</td><td rowspan="1" colspan="1">0.5864</td></tr><tr><td rowspan="1" colspan="1">    3-link</td><td rowspan="1" colspan="1">531 223.34</td><td rowspan="1" colspan="1">581 126.43</td><td rowspan="1" colspan="1">14 949.66</td><td rowspan="1" colspan="1">0.0274</td><td rowspan="1" colspan="1">0.5224</td></tr><tr><td rowspan="1" colspan="1">    4-link</td><td rowspan="1" colspan="1">514 636.5</td><td rowspan="1" colspan="1">457 709.57</td><td rowspan="1" colspan="1">31 536.5</td><td rowspan="1" colspan="1">0.05772</td><td rowspan="1" colspan="1">0.4707</td></tr><tr><td rowspan="1" colspan="1">    5-link</td><td rowspan="1" colspan="1">496 927.81</td><td rowspan="1" colspan="1">419 862.93</td><td rowspan="1" colspan="1">49 245.19</td><td rowspan="1" colspan="1">0.0902</td><td rowspan="1" colspan="1">0.4580</td></tr><tr><td colspan="6" rowspan="1"><italic>Sorghum bicolor</italic></td></tr><tr><td rowspan="1" colspan="1">    Single-link</td><td rowspan="1" colspan="1">2 798 705</td><td rowspan="1" colspan="1">1 246 093</td><td rowspan="1" colspan="1">5950</td><td rowspan="1" colspan="1">0.0021</td><td rowspan="1" colspan="1">0.3081</td></tr><tr><td rowspan="1" colspan="1">    2-link</td><td rowspan="1" colspan="1">2 798 705</td><td rowspan="1" colspan="1">1 246 093</td><td rowspan="1" colspan="1">5950</td><td rowspan="1" colspan="1">0.0021</td><td rowspan="1" colspan="1">0.3081</td></tr><tr><td rowspan="1" colspan="1">    3-link</td><td rowspan="1" colspan="1">2 774 210</td><td rowspan="1" colspan="1">737 405.33</td><td rowspan="1" colspan="1">30445</td><td rowspan="1" colspan="1">0.0109</td><td rowspan="1" colspan="1">0.2100</td></tr><tr><td rowspan="1" colspan="1">    4-link</td><td rowspan="1" colspan="1">2 754 055.07</td><td rowspan="1" colspan="1">680 983.11</td><td rowspan="1" colspan="1">50 599.92</td><td rowspan="1" colspan="1">0.01804</td><td rowspan="1" colspan="1">0.1982</td></tr><tr><td rowspan="1" colspan="1">    5-link</td><td rowspan="1" colspan="1">2 728 152.31</td><td rowspan="1" colspan="1">628 988.71</td><td rowspan="1" colspan="1">76 502.69</td><td rowspan="1" colspan="1">0.0273</td><td rowspan="1" colspan="1">0.1874</td></tr></tbody></table><table-wrap-foot><fn><p>TP, FP and FN values for <monospace><italic>k</italic>-link</monospace> clustering (for various <italic>k</italic>) when compared with the reference clustering. The proportion of pairs in the reference clustering which were incorrectly separated (i.e. similar to Type I error) in the <monospace><italic>k</italic>-link</monospace> clustering was calculated using FN/(TP + FN). The proportion of pairs in the non-reference clustering which were not together in the reference(similar to Type II error), was calculated using FP/(TP + FP).</p></fn></table-wrap-foot></table-wrap></p>
      <p>The most significant result is observed in the <italic>Sorghum</italic> dataset, whereby increasing the required links from 2 to 3 decreased the Type II error from 30% to 20%. In contrast, the Type I error only increased from 0.02% to 1%. This disproportionately large decrease in Type II error is what one would expect from the removal of chimeric sequences joining two otherwise unrelated clusters. Examination of the cluster size statistics (<xref ref-type="table" rid="T4">Table 4</xref>) shows that of the three datasets, <italic>Sorghum</italic> had the largest decrease in maximum cluster size as required links were increased from 2 to 3 (1354 members down to 1086). This is consistent with the hypothesis that a chimeric sequence linked these otherwise unrelated clusters.
<table-wrap id="T4" position="float"><label>Table 4.</label><caption><p>Summary statistics for cluster sizes in the reference and <monospace><italic>k</italic>-link</monospace> clusterings</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Clustering</th><th rowspan="1" colspan="1">Min</th><th rowspan="1" colspan="1">Q1</th><th rowspan="1" colspan="1">Median</th><th rowspan="1" colspan="1">Mean</th><th rowspan="1" colspan="1">Q3</th><th rowspan="1" colspan="1">Max</th><th rowspan="1" colspan="1">No. of Clusters</th></tr></thead><tbody align="left"><tr><td colspan="8" rowspan="1"><italic>Caenorhabditis elegans</italic></td></tr><tr><td rowspan="1" colspan="1">    Reference</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">6.605</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">1321</td><td rowspan="1" colspan="1">23 002</td></tr><tr><td rowspan="1" colspan="1">    Single-link</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">7.455</td><td rowspan="1" colspan="1">6</td><td rowspan="1" colspan="1">1407</td><td rowspan="1" colspan="1">20 378</td></tr><tr><td rowspan="1" colspan="1">    2-link</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">7.455</td><td rowspan="1" colspan="1">6</td><td rowspan="1" colspan="1">1407</td><td rowspan="1" colspan="1">20 378</td></tr><tr><td rowspan="1" colspan="1">    3-link</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">6.830</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">1407</td><td rowspan="1" colspan="1">23 019</td></tr><tr><td rowspan="1" colspan="1">    4-link</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">6.471</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">1407</td><td rowspan="1" colspan="1">25 402</td></tr><tr><td rowspan="1" colspan="1">    5-link</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">6.289</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">1407</td><td rowspan="1" colspan="1">27 420</td></tr><tr><td colspan="8" rowspan="1"><italic>Oryza sativa</italic></td></tr><tr><td rowspan="1" colspan="1">    Reference</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">2.900</td><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">337</td><td rowspan="1" colspan="1">24 525</td></tr><tr><td rowspan="1" colspan="1">    Single-link</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">3.668</td><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">713</td><td rowspan="1" colspan="1">19 387</td></tr><tr><td rowspan="1" colspan="1">    2-link</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">3.668</td><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">713</td><td rowspan="1" colspan="1">19 390</td></tr><tr><td rowspan="1" colspan="1">    3-link</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">3.413</td><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">712</td><td rowspan="1" colspan="1">22 887</td></tr><tr><td rowspan="1" colspan="1">    4-link</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">3.367</td><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">653</td><td rowspan="1" colspan="1">25 786</td></tr><tr><td rowspan="1" colspan="1">    5-link</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">3.420</td><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">653</td><td rowspan="1" colspan="1">28 136</td></tr><tr><td colspan="8" rowspan="1"><italic>Sorghum bicolor</italic></td></tr><tr><td rowspan="1" colspan="1">    Reference</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">4.740</td><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">1060</td><td rowspan="1" colspan="1">20 361</td></tr><tr><td rowspan="1" colspan="1">    Single-link</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">5.656</td><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">1354</td><td rowspan="1" colspan="1">17 062</td></tr><tr><td rowspan="1" colspan="1">    2-link</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">5.656</td><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">1354</td><td rowspan="1" colspan="1">17 062</td></tr><tr><td rowspan="1" colspan="1">    3-link</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">5.266</td><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">1086</td><td rowspan="1" colspan="1">19 102</td></tr><tr><td rowspan="1" colspan="1">    4-link</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">5.075</td><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">1086</td><td rowspan="1" colspan="1">20 862</td></tr><tr><td rowspan="1" colspan="1">    5-link</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">4.994</td><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">1080</td><td rowspan="1" colspan="1">22 572</td></tr></tbody></table></table-wrap></p>
      <p>All three datasets have a small amount of false negatives under the single-linkage requirement. Ideally, this would be zero, however, it is likely caused by differences between the BLAT and BLAST algorithms.</p>
      <p>Interestingly, the difference between clusterings produced by single-linkage and 2-linkage is minimal, if any. This may suggest that the data represents at least 2-fold coverage of the gene indicies in these species—excluding the singletons representing truly rare transcripts. However, this conclusion is confounded by the overwhelming effect of the unmasked repetitive sequences that still remain within the dataset.</p>
      <p>Manual inspection of a subset of the putative chimeras revealed the ESTs to be a mixture of chimeras, splice variants, low expression transcripts and long ESTs which bridged the gap between sense and antisense clusters (<xref ref-type="fig" rid="F1">Fig. 1</xref>). Images were obtained from WormBase (<ext-link ext-link-type="uri" xlink:href="http://www.wormbase.org/,">http://www.wormbase.org/,</ext-link> version WS201), and the UCSC Genome Browser (Kent <italic>et al</italic>., <xref ref-type="bibr" rid="B10">2002</xref>).
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Manual inspection of putative chimeras identified by <monospace><italic>k</italic>-link</monospace> appear to be a mixture of true chimeric sequences and low-abundance transcripts. In (<bold>A</bold>), the EST shown is a <italic>C.elegans</italic> chimera of two genes, one fragment from <italic>dod-6</italic> on chromosome III (consisting of two exons-location is marked with two red asterisks), and the other fragment from <italic>col-103</italic> on chromosome IV (one exon-marked with one red asterisk). This chimera was the only sequence suggesting a link between the transcripts from these two separate genes. (<bold>B</bold>) ESTs derived from the T09F3.2 gene (<ext-link ext-link-type="uri" xlink:href="http://genome.ucsc.edu,">http://genome.ucsc.edu,</ext-link> <italic>C.elegans</italic>, May 2008). A rare splice variant (BJ751277) spans the two otherwise non-overlapping EST clusters, and for this reason is marked as a putative chimera.</p></caption><graphic xlink:href="btp410f1"/></fig></p>
      <p>For consistency with previous sequence clustering studies (Burke <italic>et al</italic>., <xref ref-type="bibr" rid="B3">1999</xref>), we have also compared the size of clusters produced by the reference versus the <monospace><italic>k</italic>-link</monospace> clusterings (<xref ref-type="table" rid="T4">Table 4</xref>). Excluding <italic>O.sativa</italic>, the 3-linkage clustering produced cluster sizes similar to those in the reference clustering. The largest cluster size in all 3-link clusterings was slightly larger than that in the reference. Boxplots of the cluster sizes for each clustering are supplied in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp410/DC1">Supplementary Materials</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>4 DISCUSSION AND CONCLUSION</title>
    <p>Understanding how error rates vary in response to parameter selection is crucial to obtaining the optimal (in this case, the most reference-like) clustering. Past studies have indicated that a sequence identity threshold of 90%, with an alignment length between 25 and 40 bp, minimizes the Type I and Type II errors introduced by these thresholds. Despite these findings, the majority of clustering algorithms still maintain high sequence–similarity thresholds. Our results emphasize that single-linkage algorithms perform poorly (in terms of Type II error) when using the optimal sequence similarity threshold. Despite the high level of activity in this research area, no one has tried varying the cluster-merging algorithm to take into account the number of links between clusters. We feel that it is a natural progression from the study by Wang <italic>et al</italic>. (<xref ref-type="bibr" rid="B25">2004</xref>) to investigate how the linkage algorithm used in EST clustering influences Type I and Type II error rates.</p>
    <p>To our knowledge, no algorithm has been developed which merges EST clusters based on a <italic>k</italic>-link threshold. Using our algorithm, <monospace><italic>k</italic>-link</monospace>, we have shown that Type II error can be reduced by increasing the number of links required between clusters. It is difficult to say whether the reduction in error was due to appropriate handling of chimeric sequences, or the increased linkage requirements mitigating some of the effect of unmasked repetitive sequence. Given the very low frequency of chimeric sequences, intuition suggests that the significant initial decrease in Type II error as <italic>k</italic> is increased from 2 to 3 shows the algorithm overcoming the effect of the chimeric sequences. The substantial ‘base’ Type II error suggests that the remaining errors are due to uninformative sequences, be it repeats or stretches of low-complexity sequence.</p>
    <p>The traditional definitions of Type I and Type II errors in statistics often imply an inverse relationship between the two measures. Many of the EST clustering approaches, described in the literature, have minimized Type I error at the cost of increased Type II error. This coincides with the prevailing view that Type I errors are more difficult to correct post-clustering than Type II errors (Hazelhurst <italic>et al</italic>., <xref ref-type="bibr" rid="B4">2008</xref>). However, as the <monospace><italic>k</italic>-link</monospace> algorithm permits an EST to belong to multiple clusters, this inverse relationship does not strictly hold. The negation of chimeric sequences, combined with the tolerance of non-disjoint clusters, causes the Type I error to grow disproportionately slower than the rate of loss in Type II errors.</p>
    <p>The growth in Type I error as <italic>k</italic> is increased may be further impeded While there was a slight increase in type I error as <italic>k</italic> was increased, this is likely to be reduced by introducing an adaptive linkage algorithm. Such an algorithm would take into account the size of the compared clusters and adjust the required number of links accordingly.</p>
    <p>Our study has also shown that unmasked uninformative sequences (such as repeats, vector sequences or low-complexity stretches) can have a significant impact on the Type II clustering error. No clustering algorithm is impervious to the effects of unmasked repeat sequences. For a novel species, it is difficult to know how much masking is required. While we removed some super-clusters during the construction of the datasets, many repeat sequences still filtered through. This highlights the need to inspect cluster sizes produced by a clustering algorithm to identify whether sequence masking was adequate. We suggest that users of <monospace><italic>k</italic>-link</monospace> perform a rough clustering (without parameter estimation, option -E) to identify any significantly large clusters. Future research will involve evaluating linkage-related error by running <monospace><italic>k</italic>-link</monospace> on a EST dataset from a species with a well-characterized repeat database. We would like to emphasize that the RBR supplementary library option used in this study was implemented at our request—and its efficiency has not been benchmarked.</p>
    <p>We have shown that single-linkage clustering produces a significant level of type II error when using less-stringent (but more sensitive) sequence—similarity parameters. By using the optimal number of required links (through probabilistic estimation), we mitigate the effect of chimeras, and potentially of some repeat sequences, in the EST dataset. The Type I errors introduced by using the smallest number of links required to overcome the effect of chimeric sequences, while minimized for the constant link-level case, may be further reduced by using an adaptive linkage algorithm.</p>
    <p>The introduction of variable linkage to EST clustering should be seen as an additional parameterization of the clustering algorithm, allowing researchers to fine-tune the desired proportion of Type I and Type II errors. Understanding when either error type is preferable will be dependent on the analysis conducted post-clustering.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>The authors are grateful to Andrew George, for encouraging research in this area, and for the highly valued advice and suggestions from Peter Humburg, Ketil Malde and Scott Hazelhurst. In addition, we would like to thank Ketil Malde for making an extension to the RBR software. Finally, we wish to thank the two anonymous referees for their helpful comments.</p>
    <p><italic>Funding</italic>: CSIRO's Transformational Biology Platform (in part).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barker</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Redundancy based detection of sequence polymorphisms in expressed sequence tag data using autoSNP</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>421</fpage>
        <lpage>422</lpage>
        <pub-id pub-id-type="pmid">12584131</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boguski</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Schuler</surname>
            <given-names>GD</given-names>
          </name>
        </person-group>
        <article-title>Establishing a human transcript map</article-title>
        <source>Nat. Genet.</source>
        <year>1995</year>
        <volume>10</volume>
        <fpage>369</fpage>
        <lpage>371</lpage>
        <pub-id pub-id-type="pmid">7670480</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Burke</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>d2_cluster: a validated method for clustering EST and full-length cDNA sequences</article-title>
        <source>Genome Res.</source>
        <year>1999</year>
        <volume>9</volume>
        <fpage>1135</fpage>
        <lpage>1142</lpage>
        <pub-id pub-id-type="pmid">10568753</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hazelhurst</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An overview of the wcd EST clustering tool</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>1542</fpage>
        <lpage>1546</lpage>
        <pub-id pub-id-type="pmid">18480101</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hide</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Biological evaluation of d2, an algorithm for high-performance sequence comparison</article-title>
        <source>J. Comput. Biol.</source>
        <year>1994</year>
        <volume>1</volume>
        <fpage>199</fpage>
        <lpage>215</lpage>
        <pub-id pub-id-type="pmid">8790465</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hillier</surname>
            <given-names>LD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Generation and analysis of 280 000 human expressed sequence tag</article-title>
        <source>Genome Res.</source>
        <year>1996</year>
        <volume>6</volume>
        <fpage>807</fpage>
        <lpage>828</lpage>
        <pub-id pub-id-type="pmid">8889549</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Madan</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>CAP3: a DNA sequence assembly program</article-title>
        <source>Genome Res.</source>
        <year>1999</year>
        <volume>9</volume>
        <fpage>868</fpage>
        <lpage>877</lpage>
        <pub-id pub-id-type="pmid">10508846</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jaccard</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Étude comparative de la distribution florale dans une portion des Alpes et des Jura</article-title>
        <source>Bull. Soc. Vaudoise Sci. Nat</source>
        <year>1901</year>
        <volume>37</volume>
        <fpage>547</fpage>
        <lpage>579</lpage>
      </element-citation>
    </ref>
    <ref id="B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <article-title>BLAT - the BLAST-like alignment tool</article-title>
        <source>Genome Res.</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>656</fpage>
        <lpage>664</lpage>
        <pub-id pub-id-type="pmid">11932250</pub-id>
      </element-citation>
    </ref>
    <ref id="B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The human genome browser at UCSC</article-title>
        <source>Genome Res.</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>996</fpage>
        <lpage>1006</lpage>
        <pub-id pub-id-type="pmid">12045153</pub-id>
      </element-citation>
    </ref>
    <ref id="B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ECgene: genome-based EST clustering and gene modeling for alternative splicing</article-title>
        <source>Genome Res.</source>
        <year>2005</year>
        <volume>15</volume>
        <fpage>566</fpage>
        <lpage>576</lpage>
        <pub-id pub-id-type="pmid">15805497</pub-id>
      </element-citation>
    </ref>
    <ref id="B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Klastorin</surname>
            <given-names>TD</given-names>
          </name>
        </person-group>
        <article-title>Merging groups to maximize object partition comparison</article-title>
        <source>Psychometrika</source>
        <year>1980</year>
        <volume>45</volume>
        <fpage>425</fpage>
        <lpage>433</lpage>
      </element-citation>
    </ref>
    <ref id="B13">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Korf</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <source>BLAST: An Essential Guide to the Basic Alignment Search Tool</source>
        <year>2003</year>
        <publisher-loc>Sebastopol</publisher-loc>
        <publisher-name>O'Reilly &amp; Associates</publisher-name>
      </element-citation>
    </ref>
    <ref id="B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Levin</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>A representation for multinomial cumulative distribution functions</article-title>
        <source>Ann. Stat.</source>
        <year>1981</year>
        <volume>9</volume>
        <fpage>1123</fpage>
        <lpage>1126</lpage>
      </element-citation>
    </ref>
    <ref id="B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Malde</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RBR: library-less repeat detection for ESTs</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>2232</fpage>
        <lpage>2236</lpage>
        <pub-id pub-id-type="pmid">16837527</pub-id>
      </element-citation>
    </ref>
    <ref id="B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Malde</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Jonassen</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Repeats and EST analysis for new organisms</article-title>
        <source>BMC Genomics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>1471</fpage>
        <lpage>2164</lpage>
      </element-citation>
    </ref>
    <ref id="B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meila</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Comparing clusterings an information based distance</article-title>
        <source>J. Multivar. Anal.</source>
        <year>2007</year>
        <volume>98</volume>
        <fpage>873</fpage>
        <lpage>895</lpage>
      </element-citation>
    </ref>
    <ref id="B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patterson</surname>
            <given-names>AH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The <italic>Sorghum bicolor</italic> genome and the diversification of grasses</article-title>
        <source>Nature</source>
        <year>2009</year>
        <volume>457</volume>
        <fpage>551</fpage>
        <lpage>556</lpage>
        <pub-id pub-id-type="pmid">19189423</pub-id>
      </element-citation>
    </ref>
    <ref id="B19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parkinson</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Making sense of EST sequences by CLOBBing them</article-title>
        <source>BMC Bioinformatics</source>
        <year>2002</year>
        <volume>3</volume>
        <fpage>31</fpage>
        <pub-id pub-id-type="pmid">12398795</pub-id>
      </element-citation>
    </ref>
    <ref id="B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pertea</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TIGR gene indices clustering tools (TGICL): a software system for fast clustering of large EST datasets</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>651</fpage>
        <lpage>652</lpage>
        <pub-id pub-id-type="pmid">12651724</pub-id>
      </element-citation>
    </ref>
    <ref id="B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ptitsyn</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hide</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>CLU: a new algorithm for EST clustering</article-title>
        <source>BMC Bioinformatics</source>
        <year>2005</year>
        <volume>6</volume>
        <issue>Suppl. 2</issue>
        <fpage>S3</fpage>
        <pub-id pub-id-type="pmid">16026600</pub-id>
      </element-citation>
    </ref>
    <ref id="B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quackenbush</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The TIGR gene indices: analysis of gene transcript sequences in highly sampled eukaryotic species</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2001</year>
        <volume>29</volume>
        <fpage>159</fpage>
        <lpage>164</lpage>
        <pub-id pub-id-type="pmid">11125077</pub-id>
      </element-citation>
    </ref>
    <ref id="B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sorek</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Safer</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A novel algorithm for computational identification of contaminated EST libraries</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2003</year>
        <volume>31</volume>
        <fpage>1067</fpage>
        <lpage>1074</lpage>
        <pub-id pub-id-type="pmid">12560505</pub-id>
      </element-citation>
    </ref>
    <ref id="B24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>JF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>QualitySNP: a pipeline for detecting Single nucleotide polymorphisms and insertions/deletions in EST data from diploids and polyploidy species</article-title>
        <source>BMC Bioinformatics</source>
        <year>2006</year>
        <volume>7</volume>
        <issue>Article 438</issue>
      </element-citation>
    </ref>
    <ref id="B25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>JZ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>EST clustering error evaluation and correction</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>2973</fpage>
        <lpage>2984</lpage>
        <pub-id pub-id-type="pmid">15189818</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
