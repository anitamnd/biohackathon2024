<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6567636</article-id>
    <article-id pub-id-type="publisher-id">2869</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-019-2869-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>fastJT: An R package for robust and efficient feature selection for machine learning and genome-wide association studies</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lin</surname>
          <given-names>Jiaxing</given-names>
        </name>
        <address>
          <email>jiaxing.lin@duke.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sibley</surname>
          <given-names>Alexander</given-names>
        </name>
        <address>
          <email>alexander.sibley@duke.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shterev</surname>
          <given-names>Ivo</given-names>
        </name>
        <address>
          <email>i.shterev@duke.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nixon</surname>
          <given-names>Andrew</given-names>
        </name>
        <address>
          <email>anixon@duke.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Innocenti</surname>
          <given-names>Federico</given-names>
        </name>
        <address>
          <email>innocenti@email.unc.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chan</surname>
          <given-names>Cliburn</given-names>
        </name>
        <address>
          <email>cliburn.chan@duke.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3340-1287</contrib-id>
        <name>
          <surname>Owzar</surname>
          <given-names>Kouros</given-names>
        </name>
        <address>
          <email>Kouros.Owzar@duke.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2232 0951</institution-id><institution-id institution-id-type="GRID">grid.414179.e</institution-id><institution>Department of Biostatistics and Bioinformatics, Duke University, </institution></institution-wrap>Durham, NC USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 7961</institution-id><institution-id institution-id-type="GRID">grid.26009.3d</institution-id><institution>Duke Cancer Institute, Duke University Medical Center, </institution></institution-wrap>Durham, NC USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000000100241216</institution-id><institution-id institution-id-type="GRID">grid.189509.c</institution-id><institution>Duke Human Vaccine Institute, Duke University Medical Center, </institution></institution-wrap>Durham, NC USA </aff>
      <aff id="Aff4"><label>4</label>Division of Pharmacotherapy and Experimental Therapeutics, Chapel Hill, NC USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>6</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>6</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>333</elocation-id>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>4</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>4</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Â© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Parametric feature selection methods for machine learning and association studies based on genetic data are not robust with respect to outliers or influential observations. While rank-based, distribution-free statistics offer a robust alternative to parametric methods, their practical utility can be limited, as they demand significant computational resources when analyzing high-dimensional data. For genetic studies that seek to identify variants, the hypothesis is constrained, since it is typically assumed that the effect of the genotype on the phenotype is monotone (e.g., an additive genetic effect). Similarly, predictors for machine learning applications may have natural ordering constraints. Cross-validation for feature selection in these high-dimensional contexts necessitates highly efficient computational algorithms for the robust evaluation of many features.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We have developed an R extension package, fastJT, for conducting genome-wide association studies and feature selection for machine learning using the Jonckheere-Terpstra statistic for constrained hypotheses. The kernel of the package features an efficient algorithm for calculating the statistics, replacing the pairwise comparison and counting processes with a data sorting and searching procedure, reducing computational complexity from O(<italic>n</italic><sup>2</sup>) to O(<italic>n</italic> log(<italic>n</italic>)). The computational efficiency is demonstrated through extensive benchmarking, and example applications to real data are presented.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>fastJT is an open-source R extension package, applying the Jonckheere-Terpstra statistic for robust feature selection for machine learning and association studies. The package implements an efficient algorithm which leverages internal information among the samples to avoid unnecessary computations, and incorporates shared-memory parallel programming to further boost performance on multi-core machines.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s12859-019-2869-3) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Jonckheere-Terpstra</kwd>
      <kwd>Linear rank statistic</kwd>
      <kwd>Constrained inference</kwd>
      <kwd>Robust statistic</kwd>
      <kwd>Logarithmic complexity</kwd>
      <kwd>Genome-wide association studies</kwd>
      <kwd>Feature selection</kwd>
      <kwd>Machine learning</kwd>
      <kwd>Parallel processing</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000054</institution-id>
            <institution>National Cancer Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>P01CA142538</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000054</institution-id>
            <institution>National Cancer Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>P01CA142538</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000054</institution-id>
            <institution>National Cancer Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>P01CA142538</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>Â© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Feature selection is a critical step in machine learning [<xref ref-type="bibr" rid="CR1">1</xref>] and association studies based on high-dimensional genetic data. When building a model, attempting to use all available features can perform as poorly as random guessing [<xref ref-type="bibr" rid="CR2">2</xref>]. The key to building a generalizable model is a robust feature selection procedure that minimizes the inclusion of noisy features due to the presence of a few outliers or influential observations. Similarly, a robust feature selection procedure protects against over-inflation of the significance of a null variant. To illustrate this point, we consider an example from a recently published genome-wide association study (GWAS) which identified common variants associated with baseline circulating protein levels in advanced pancreatic cancer patients [<xref ref-type="bibr" rid="CR3">3</xref>]. FigureÂ <xref rid="Fig1" ref-type="fig">1</xref> illustrates the presence of extreme outliers for three markers from this GWAS. These examples underscore the need for inferential methods which are robust to such potentially influential observations.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Boxplot of selected plasma protein levels for CALGB 80303 data.Box plot of VEGF-A, VEGF-C, and MCP1 plasma protein levels in CALGB 80303. The boxes indicate the 25<sup>th</sup> (Q1) and 75<sup>th</sup> (Q3) percentiles, with the heavy line showing the median value. Whiskers indicate max(min(plasma levels), Q1â1.5 * IQR) and min(max(plasma levels), Q3+1.5 * IQR). The circles represent individual patient plasma levels</p></caption><graphic xlink:href="12859_2019_2869_Fig1_HTML" id="MO1"/></fig></p>
    <p>Both parametric and nonparametric methods for feature selection are available. Parametric tests are more widely adopted for feature selection, as they are generally faster and, under certain assumptions, have greater power. Furthermore, the parameter estimates of the parametric models often have an intuitive interpretation. However, the statistical validity of parametric methods is dependent on distributional assumptions, for example normality or homogeneity of the variability of the observations. Conversely, nonparametric tests, also known as distribution-free tests, do not require assumptions about the distribution of the data and are, unlike their parametric counterparts, robust to outliers and influential points. For a general comparison of parametric versus nonparametric methods see [<xref ref-type="bibr" rid="CR4">4</xref>].</p>
    <p>Commonly employed nonparametric tests include the Wilcoxon rank-sum (Wilcoxon-Mann-Whitney) [<xref ref-type="bibr" rid="CR5">5</xref>] and the Kruskal-Wallis [<xref ref-type="bibr" rid="CR6">6</xref>] tests, which are nonparametric counterparts of the two-sample t-test and the analysis of variance (ANOVA) model, respectively. Feature selection theory based on the Wilcoxon rank-sum test has been proposed to study lung and prostate cancers [<xref ref-type="bibr" rid="CR7">7</xref>]. For ordered alternatives, the Jonckheere-Terpstra (JT) test [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>] is a nonparametric counterpart to the simple linear regression model.</p>
    <p>The JT test is used to assess whether a quantitative trait is associated with an ordinal feature. For example, the association between ammonia levels and the severity of hepatic encephalopathy [<xref ref-type="bibr" rid="CR10">10</xref>], and the association of abnormal MRI findings with bone-marrow-related disease [<xref ref-type="bibr" rid="CR11">11</xref>]. More recently, studies have used the JT test to investigate the association between single nucleotide polymorphisms (SNPs) in human genes and quantitative phenotypes [<xref ref-type="bibr" rid="CR12">12</xref>â<xref ref-type="bibr" rid="CR18">18</xref>]. However, in these cases the use of the JT test for feature selection in genomic studies is limited to small data sets, examining only a few candidate SNPs. Feature selection for high-dimensional problems, for example the analysis of SNPs genome-wide, or mapping expression quantitative trait loci (eQTL), using the JT test is computationally expensive and often infeasible, since the computational complexity of the JT test is quadratic in the number of samples. Further, robust feature selection for machine learning involves not only the application of the JT test to high-dimensional data, but also cross-validation, to avoid overfitting. Cross-validation requires repeating the JT test on different subsets of the data, demanding significant computational resources.</p>
    <p>In this paper, we present fastJT, an open source R [<xref ref-type="bibr" rid="CR19">19</xref>] package featuring an efficient implementation of the JT test that is capable of computing statistics across multiple features and quantitative traits. The naive/brute force implementation of the JT test has computational complexity of O(<italic>n</italic><sup>2</sup>), where <italic>n</italic> is the number of samples. By replacing the pairwise comparison of quantitative traits values with a sorting and searching algorithm, we are able to achieve a computational complexity of O(<italic>n</italic> log(<italic>n</italic>)). This improvement makes the computing of large numbers of rank-based, distribution-free statistics possible within reasonable computational time. fastJT also provides a function for cross-validation-based feature selection using the JT test. In the following sections, we provide a detailed explanation of how the O(<italic>n</italic> log(<italic>n</italic>)) complexity is achieved, a description of the new algorithm, and a series of benchmarking examples for selecting top features for GWAS and machine learning. We demonstrate the application of the algorithm to real data, and conclude with a discussion of the benefits and limitations of this implementation.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Computational complexity</title>
      <p>The JT test assesses the association between an ordinal feature and a quantitative trait. The latter could be a clinical outcome (e.g., blood pressure) or a biomarker (e.g., protein or mRNA level). The JT test compares the values of the quantitative trait between samples from the different ordinal groups. The resulting test statistic is composed of a weighted sum of these comparisons.</p>
      <p>The contribution to the statistic from any pair of ordinal groups is the Mann-Whitney count [<xref ref-type="bibr" rid="CR5">5</xref>], given by [<xref ref-type="bibr" rid="CR20">20</xref>] 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ U_{k l} = \sum_{i=1}^{n_{k}} \sum_{j=1}^{n_{l}} \phi(y_{ik},y_{jl}).  $$ \end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">kl</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>â</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:munderover><mml:mrow><mml:mo>â</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mi>Ï</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jl</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2019_2869_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Here, <italic>k</italic> and <italic>l</italic> are the indices for the ordinal groups being compared (assume <italic>k</italic>&lt;<italic>l</italic>). The numbers of samples in each group are <italic>n</italic><sub><italic>k</italic></sub> and <italic>n</italic><sub><italic>l</italic></sub>, and <italic>y</italic><sub><italic>ik</italic></sub> and <italic>y</italic><sub><italic>jl</italic></sub> represent the values of the quantitative trait for the <italic>i</italic><sup><italic>t</italic><italic>h</italic></sup> and <italic>j</italic><sup><italic>t</italic><italic>h</italic></sup> members of the groups, respectively. The function <italic>Ï</italic>(<italic>a</italic>,<italic>b</italic>) has a value 1, 0.5, or 0, if <italic>a</italic> is less than, equal to, or greater than <italic>b</italic>, respectively. This group-wise comparison is carried out for each pairing of <italic>t</italic> ordinal groups, resulting in a total of <italic>t</italic>(<italic>t</italic>â1)/2 between-group comparisons. Note that the ordinal categories being compared are predetermined by the experimental design, as opposed to being based on the observed data (Section 6.2 in [<xref ref-type="bibr" rid="CR20">20</xref>]). In association studies based on genetic data, as in the case of a linear regression, we treat the SNP as a non-random predictor. The full statistic for the JT test is then the summation of the values of <italic>U</italic><sub><italic>kl</italic></sub> for each possible <italic>k</italic> and <italic>l</italic> combination, 
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \mathbf{J} = \sum_{k=1}^{t-1} \sum_{l=k+1}^{t} U_{kl}.  $$ \end{document}</tex-math><mml:math id="M4"><mml:mi mathvariant="bold">J</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>â</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>â</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mrow><mml:mo>â</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">kl</mml:mtext></mml:mrow></mml:msub><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2019_2869_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Note that computing the standardized version of the JT statistic requires the calculation of the expected value and the variance of <bold>J</bold> (Eq. 6.19 in [<xref ref-type="bibr" rid="CR20">20</xref>]). The computational overhead of these additional steps is relatively small (O(1)), so the overall computational complexity is dominated by the calculation of <bold>J</bold>, which has a cost of <inline-formula id="IEq1"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathrm {O}(\sum _{k=1}^{t-1} \sum _{l=k+1}^{t} n_{k} n_{l})$\end{document}</tex-math><mml:math id="M6"><mml:mi mathvariant="normal">O</mml:mi><mml:mo>(</mml:mo><mml:munderover><mml:mrow><mml:mo>â</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>â</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mrow><mml:mo>â</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2869_Article_IEq1.gif"/></alternatives></inline-formula> for this simple pairwise comparison scheme.</p>
      <p>The number of pairwise comparisons required is greatest when the ordinal groups are of equal size. Since the number of ordinal categories, (and therefore the number of between-group comparisons), is a predetermined constant, the total computational complexity will be <inline-formula id="IEq2"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathrm {O}(\bar {n}^{2})$\end{document}</tex-math><mml:math id="M8"><mml:mi mathvariant="normal">O</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>Â¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2869_Article_IEq2.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq3"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {n}=n/t$\end{document}</tex-math><mml:math id="M10"><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>Â¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mo>/</mml:mo><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="12859_2019_2869_Article_IEq3.gif"/></alternatives></inline-formula>, (see â<xref rid="Sec11" ref-type="sec">Appendix: Computational Complexity</xref>â for detailed derivations), i.e., quadratic in the number of samples. When analyzing multiple features and quantitative traits, this calculation must be conducted <italic>m</italic>Ã<italic>p</italic> times, where <italic>m</italic> is the number of features and <italic>p</italic> is the number of quantitative traits. This can become very expensive for some applications, e.g., a GWAS, which might involve dozens of biomarkers and thousands or millions of SNPs. Therefore, a faster algorithm for computing JT test statistics is highly desirable.</p>
      <p>One way to reduce the computational complexity is to sort the values of the quantitative trait prior to calculation of the statistic, to minimize unnecessary and repeated comparisons. This comes at the cost of adding a preliminary sorting step. In general, a sorting algorithm can be used that has (as an upper bound) O(<italic>n</italic> log(<italic>n</italic>) complexity. After sorting, many unnecessary comparisons can be avoided (the details of this are presented in the â<xref rid="Sec4" ref-type="sec">Algorithm and implementation</xref>â section below). It can be shown that the computational cost for obtaining the JT test statistic for sorted quantitative traits (ignoring, for a moment, the cost of sorting) is <inline-formula id="IEq4"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathrm {O}(\bar {n})$\end{document}</tex-math><mml:math id="M12"><mml:mi mathvariant="normal">O</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>Â¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2869_Article_IEq4.gif"/></alternatives></inline-formula>, i.e., linear in the number of samples. It can further be shown that the computational complexity of the sorting step is <inline-formula id="IEq5"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathrm {O}\left (\bar {n}\log (\bar {n})\right)$\end{document}</tex-math><mml:math id="M14"><mml:mi mathvariant="normal">O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>Â¯</mml:mo></mml:mover><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>Â¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2869_Article_IEq5.gif"/></alternatives></inline-formula> (see â<xref rid="Sec11" ref-type="sec">Appendix: Computational Complexity</xref>â for detailed derivation), where <inline-formula id="IEq6"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {n}$\end{document}</tex-math><mml:math id="M16"><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>Â¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_2869_Article_IEq6.gif"/></alternatives></inline-formula> could be interpreted as the mean number of samples per ordinal group. Thus the overall cost will be dominated by the sorting process. For relatively large samples, (i.e., <inline-formula id="IEq7"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {n} &gt; 50$\end{document}</tex-math><mml:math id="M18"><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>Â¯</mml:mo></mml:mover><mml:mo>&gt;</mml:mo><mml:mn>50</mml:mn></mml:math><inline-graphic xlink:href="12859_2019_2869_Article_IEq7.gif"/></alternatives></inline-formula>), this is a significant improvement over the quadratic complexity of the naive, pairwise comparisons. If the sample size is very close to the number of subgroups, or if the samples are very sparse, then the improvements in performance may not be as dramatic.</p>
    </sec>
    <sec id="Sec4">
      <title>Algorithm and implementation</title>
      <p>The essence of the JT test is to count the number of observations in one ordinal group that have smaller, larger, or equal values of the quantitative trait compared to the observations in higher ordinals. Recall, however, that for <italic>k</italic>&lt;<italic>l</italic>, counts of <italic>y</italic><sub><italic>ik</italic></sub>&gt;<italic>y</italic><sub><italic>jl</italic></sub> are weighted by zero. Therefore, we can improve computational efficiency by avoiding such noncontributing comparisons. In that case, Eqs. <xref rid="Equ1" ref-type="">1</xref> and <xref rid="Equ2" ref-type="">2</xref> can be written as 
<disp-formula id="Equa"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\mathbf{J} = \sum_{k=1}^{t-1} \sum_{l=k+1}^{t} \sum_{i=1}^{n_{k}} \sum_{j s.t. y_{jl} \ge y_{ik}} \phi(y_{ik}, y_{jl}). $$ \end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi mathvariant="bold">J</mml:mi><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">â</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>â</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">â</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">â</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:munder><mml:mrow><mml:mo mathsize="big">â</mml:mo></mml:mrow><mml:mrow><mml:mi>js.t.</mml:mi><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jl</mml:mtext></mml:mrow></mml:msub><mml:mo>â¥</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mi>Ï</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jl</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2019_2869_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Further gains can be made if we increment the indices <italic>i</italic> and <italic>j</italic> in order of ascending values of the quantitative trait for each ordinal group. In this case, no further comparisons are needed once <italic>y</italic><sub><italic>ik</italic></sub> is strictly less than <italic>y</italic><sub><italic>jl</italic></sub>. The additional contribution to the statistic is equal to the number of remaining members of group <italic>l</italic> such that <italic>y</italic><sub><italic>jl</italic></sub>&gt;<italic>y</italic><sub><italic>ik</italic></sub>.</p>
      <p>The algorithm below demonstrates how this improved counting process can be implemented. Initially, the values of <italic>y</italic><sub><italic>ik</italic></sub> and <italic>y</italic><sub><italic>jl</italic></sub> for groups <italic>k</italic> and <italic>l</italic> are sorted in ascending order into vectors <italic>Y</italic><sub>1</sub> and <italic>Y</italic><sub>2</sub>, respectively. Then the computation is conducted as follows:</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2019_2869_Figa_HTML" id="MO2"/>
      </p>
      <p>The pointers <italic>p</italic><sub>1</sub> and <italic>p</italic><sub>2</sub> proceed along the vectors <italic>Y</italic><sub>1</sub> and <italic>Y</italic><sub>2</sub>, moving one or, in the case of equal values, multiple positions at a time, thereby accounting for all comparisons while requiring only a single pass over the two vectors. Therefore the computational complexity of computing the Mann-Whitney count <italic>U</italic><sub><italic>kl</italic></sub> is <italic>O</italic>(<italic>n</italic><sub><italic>k</italic></sub>+<italic>n</italic><sub><italic>l</italic></sub>), i.e., linear in the number of samples involved. The overall cost of computing <bold>J</bold> is a summation of the above calculations for all <italic>t</italic>(<italic>t</italic>â1)/2 between-group comparisons. Since <italic>t</italic> is predetermined, the computation complexity is <inline-formula id="IEq8"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathrm {O}(\bar {n})$\end{document}</tex-math><mml:math id="M22"><mml:mi mathvariant="normal">O</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>Â¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2869_Article_IEq8.gif"/></alternatives></inline-formula>, remaining linear in the number of samples.</p>
      <p>This algorithm is implemented in the R [<xref ref-type="bibr" rid="CR19">19</xref>] extension package fastJT [<xref ref-type="bibr" rid="CR21">21</xref>], primarily coded in C++ and ported to the R platform using Rcpp [<xref ref-type="bibr" rid="CR22">22</xref>]. This package is designed to compute the JT test statistics for large numbers of ordinal features and quantitative traits for conducting feature selection for machine learning or GWAS. The package provides functions for k-fold cross-validation of the feature selection process. Incorporation of the C++ library OpenMP [<xref ref-type="bibr" rid="CR23">23</xref>] enables simultaneous testing of multiple phenotypes, as for example in the case of eQTL analyses, improving performance for analyzing large data sets.</p>
    </sec>
    <sec id="Sec5">
      <title>Example applications to real data</title>
      <p>Here we demonstrate the use of fastJT in a machine learning application to real-world data. We illustrate a practical application of our package in the context of conducting cross-validated robust feature selection for building a model to predict baseline circulating protein levels for the three biomarkers, VEGF-A, VEGF-C and MCP1, shown in Fig.Â <xref rid="Fig1" ref-type="fig">1</xref>. These analyses are based on genome-wide genotyping and plasma protein marker data from CALGB 80303, a randomized, placebo-controlled, double-blind, phase III study of bevacizumab plus gemcitabine in advanced pancreatic adenocarcinoma patients [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR24">24</xref>â<xref ref-type="bibr" rid="CR26">26</xref>]. For these analyses, we use data from 216 CALGB 80303 patients who are estimated to be genetically European and have baseline circulating protein level data available. The number of SNPs in this analysis is 484,523. Additional information about these data, including quality control methods used for the genotype and protein marker assays, are provided in the four previously referenced papers. The genotyping data from CALGB 80303 can be downloaded from the database of Genotypes and Phenotypes (dbGaP) through study accession phs000250.v1.p1. The protein marker data are provided as part of the supplemental information from Innocenti et al. [<xref ref-type="bibr" rid="CR3">3</xref>].</p>
      <p>For each marker, the predictive model is trained based on a two-layer cross-validation approach as described by Simon et al. [<xref ref-type="bibr" rid="CR27">27</xref>]. The outer layer utilizes leave-one-out cross-validation for robust feature selection using fastJT, while the inner layer uses 10-fold cross-validation to tune an elastic net model using the cv.glmnet function from the glmnet [<xref ref-type="bibr" rid="CR28">28</xref>] package. In the outer layer, the data from a single patient are removed, and the JT test is applied to the data from the 216â1=215 remaining patients. The resulting <italic>P</italic>-values are used to select the top 10 features. In the inner layer, the elastic model is tuned using data from the 215 patients on the basis of the features selected from the outer layer. The resulting model is used to predict the plasma protein level for the patient which was initially removed, and this process is repeated for all patients. The cross-validated predicted levels are then compared to the corresponding observed levels using <italic>R</italic><sup>2</sup> values and scatter plots. See Additional fileÂ <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1 for a schematic of this process.</p>
    </sec>
  </sec>
  <sec id="Sec6" sec-type="results">
    <title>Results</title>
    <p>In this section, we provide benchmarks to demonstrate how the computational cost of our algorithm is related to the number of samples and the dimensions of the data. We also assess the statistical operating characteristics of our method in the presence of outliers. Benchmarks for parallel analyses are also reported, to explore the cost of the overhead required for multiple threading. Benchmarking was conducted on an AMD Opteron(tm) 6180 SE CPU running the Debian 4.9.130-2 AMD64 GNU/Linux operating system. We also demonstrate a real-world application of our algorithm using data from the CALGB 80303 GWAS.</p>
    <sec id="Sec7">
      <title>Simulation and benchmarking</title>
      <p>We begin by benchmarking the performance of fastJT in the context of feature selection for a simulated machine learning analysis, looking at the computational costs of k-fold cross-validation. A single quantitative trait (<italic>p</italic>=1) is sampled from <italic>N</italic>(0,1), a normal distribution with mean 0 and variance 1. The features (<italic>m</italic>=1,000,000) are each sampled from <italic>B</italic>(2,0.5), a binomial distribution with size parameter 2 and probability parameter 0.5. These represent counts of variant alleles (0, 1 or 2) from genotyping biallelic SNPs. The traits and features are simulated for <italic>n</italic>=1,000 observations, and each simulation is replicated <italic>B</italic>=100 times.</p>
      <p>FigureÂ <xref rid="Fig2" ref-type="fig">2</xref> shows the CPU times for feature selection corresponding to an analysis using the full training set, and <italic>k</italic>=5,10 and 15 fold cross-validation.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Cross-validation CPU times. CPU times for computing standardized JT test statistics using cross-validation with different numbers of folds, <italic>k</italic>, based on <italic>n</italic>=1,000 samples with <italic>m</italic>=1,000,000 features and <italic>p</italic>=1 quantitative trait. Each reported time is the mean of <italic>B</italic>=100 simulation replicates</p></caption><graphic xlink:href="12859_2019_2869_Fig2_HTML" id="MO3"/></fig></p>
      <p>The remaining simulation studies are conducted within the context of an eQTL analysis. In the first study, we benchmark the effects of varying the sample size, <italic>n</italic>, number of features, <italic>m</italic>, or number of traits, <italic>p</italic>, on execution time. In the second study, we benchmark the performance gained from using the OpenMP implementation of our method. In the third study, we assess the robustness of our approach in presence of outliers, as compared to a parametric method.</p>
      <p>For the first two studies, each of the <italic>p</italic> quantitative traits are sampled from <italic>N</italic>(0,1), a normal distribution with mean 0 and variance 1, and the genotypes of the <italic>m</italic> SNPs are sampled from a binomial distribution with size 2 and probability MAF where MAF, the relative minor allele frequency, is 0.5. For the final study, which involves outliers, the quantitative traits for samples simulated as having two minor alleles are drawn from a mixture distribution consisting of components <italic>N</italic>(0,1) (standard) and <italic>N</italic>(8,1) (outlier), with mixture probability <italic>Ï</italic> â[0,0.03], the proportion of the observations drawn from the outlier component. The simulations are repeated for MAF equal to 0.2,0.3,0.4, and 0.5.</p>
      <p>We first consider the effect of varying the number of features or traits. FigureÂ <xref rid="Fig3" ref-type="fig">3</xref>a shows the CPU times for simulations with varying numbers of SNPs, <italic>m</italic>, and a fixed number of traits (<italic>p</italic>=1,000) and samples (<italic>n</italic>=1,000). FigureÂ <xref rid="Fig3" ref-type="fig">3</xref>b shows results for a similar study, but instead varies the number of traits, <italic>p</italic>, while holding the number of SNPs fixed (<italic>m</italic>=1,000).
<fig id="Fig3"><label>Fig. 3</label><caption><p>CPU times for varying numbers of SNPs and traits. <bold>a</bold>: CPU times for computing standardized JT test statistics for different numbers of SNPs, <italic>m</italic>, with a fixed number of traits (<italic>p</italic>=50) and samples (<italic>n</italic>=1,000) using 8 threads. <bold>b</bold>: CPU times for computing standardized JT test statistics for different numbers of traits, <italic>p</italic>, with a fixed number of SNPs (<italic>m</italic>=1,000) and samples (<italic>n</italic>=1,000). Reported time for panel (<bold>a</bold>) is the mean of <italic>B</italic>=10 simulation replicates. Reported time for panel (<bold>b</bold>) is the mean of <italic>B</italic>=100 simulation replicates</p></caption><graphic xlink:href="12859_2019_2869_Fig3_HTML" id="MO4"/></fig></p>
      <p>We next examine the computational cost of increasing the sample size, comparing two different implementations of the JT test. The first implementation is fastJT, using the algorithm described above. The second is a ânaiveâ implementation of the test, which does not include the sorting step. This algorithm therefore requires exhaustive pairwise comparisons. FigureÂ <xref rid="Fig4" ref-type="fig">4</xref> shows the CPU times based on a fixed number of features (<italic>m</italic>=1,000) and traits (<italic>p</italic>=1,000), with a varying number of samples (<italic>n</italic>). Each reported time is the mean of <italic>B</italic>=100 simulation replicates.
<fig id="Fig4"><label>Fig. 4</label><caption><p>CPU times for varying numbers of samples. CPU times for fastJT and an implementation of the JT test using (unsorted) pairwise comparisons. Results are shown for different numbers of samples (<italic>n</italic>), with a fixed number of SNPs (<italic>m</italic>=1,000) and traits (<italic>p</italic>=1,000). Each reported time is the mean of <italic>B</italic>=100 simulation replicates</p></caption><graphic xlink:href="12859_2019_2869_Fig4_HTML" id="MO5"/></fig></p>
      <p>Specifically, we observe that if the number of samples is increased from 100 to 5000, the corresponding CPU time for fastJT is increased from 13.8 to 870.2s. The corresponding times based on the naive pairwise comparison algorithm are 14.7s and 5589.0s, respectively.</p>
      <p>Beyond improving algorithmic efficiency, computation time for investigating multiple features and quantitative traits can be reduced by processing separate tests in parallel. However, this approach can incur additional overhead due to the cost of passing data to, and retrieving results from, the processing cores.</p>
      <p>FigureÂ <xref rid="Fig5" ref-type="fig">5</xref> shows the elapsed CPU times for for a fixed number of traits (<italic>p</italic>=1,000), SNPs (<italic>m</italic>=1,000), and samples (<italic>n</italic>=1,000), when using different numbers of parallel processing cores. The red dots represent the CPU times for the multi-core OpenMP implementation. For comparison, the dashed curve shows the single core CPU time divided by the number of cores. This represents the idealized parallel processing time in which there is no overhead for passing data among cores.
<fig id="Fig5"><label>Fig. 5</label><caption><p>CPU times for varying numbers of processing cores. CPU times for different numbers of processing cores, with a fixed number of SNPs (<italic>m</italic>=1,000), traits (<italic>p</italic>=1,000), and samples (<italic>n</italic>=1,000). The dashed line gives the single core CPU time divided by the number of cores. Each reported time is the mean of <italic>B</italic>=100 simulation replicates</p></caption><graphic xlink:href="12859_2019_2869_Fig5_HTML" id="MO6"/></fig></p>
      <p>Having explored the computational performance of our algorithm empirically, we next examine its statistical performance in the presence of outliers. This is shown in the context of inference for a single feature/quantitative trait pair (<italic>m</italic>=1, <italic>p</italic>=1) in <italic>n</italic>=500 samples. For this illustration, we simulate the genotypes for a variety of MAFs, and simulate the quantitative trait to include a small proportion of outliers, as described above. The statistical performance of the fastJT algorithm is compared to that of the simple linear regression model. The simple linear regression model is a parametric counterpart to the JT test for testing the association of ordinal and a quantitative variables, using the genotype as a numeric predictor of the marker level. We consider the rejection rate at the nominal 0.05 level (i.e., we call the feature to be significant if the corresponding asymptotic <italic>P</italic>-value is less than 0.05).</p>
      <p>FigureÂ <xref rid="Fig6" ref-type="fig">6</xref> shows the rejection rates for the linear model, using the lm function in R, and the JT test, as implemented in fastJT, for varying levels of <italic>Ï</italic>, the proportion of the observations drawn from the outlier distribution.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Empirical rejection rates in the presence of outliers. Empirical rejection rates for the linear regression model and the JT test, for data simulated with <italic>n</italic>=500 samples for varying levels of MAFs and varying proportions of outliers, <italic>Ï</italic>. The red solid line indicates the nominal rate of 0.05. Each reported rate is based on <italic>B</italic>=10,000 simulation replicates</p></caption><graphic xlink:href="12859_2019_2869_Fig6_HTML" id="MO7"/></fig></p>
    </sec>
    <sec id="Sec8">
      <title>Example application to real data</title>
      <p>In FigureÂ <xref rid="Fig7" ref-type="fig">7</xref>, we show scatter plots of the predicted versus observed marker levels for VEGF-A, VEGF-C and MCP1 from the CALGB 80303 GWAS. The analysis is conducted on an AMD Opteron(tm) 6386 SE CPU running the Ubuntu 18.04.1 LTS GNU/Linux operating system. The completion of the entire analysis, including the robust feature selection step using fastJT, is 2.51 hours. Note that this process includes executing 216 leave-one-out cross-validation replicates, each of which consists of a GWAS of three protein markers, based on 215 patients and 484,523 SNPs. The predicted and observed circulating protein levels for VEGF-A, VEGF-C and MCP1 have <italic>R</italic><sup>2</sup> values of 0.047, 0.24 and 0.19, respectively.
<fig id="Fig7"><label>Fig. 7</label><caption><p>Machine learning prediction of plasma levels in CALGB 80303. Comparison of observed and predicted plasma protein levels of VEGF-A, VEGF-C, and MCP1. The machine learning model is built based on the top 100 SNPs selected by fastJT, and trained using the glmnet package</p></caption><graphic xlink:href="12859_2019_2869_Fig7_HTML" id="MO8"/></fig></p>
      <p>As another example application, the fastJT algorithm is used by Innocenti et al. [<xref ref-type="bibr" rid="CR3">3</xref>] to conduct an eQTL analysis of data from CALGB 80303 [<xref ref-type="bibr" rid="CR24">24</xref>] and 80203 [<xref ref-type="bibr" rid="CR29">29</xref>].</p>
    </sec>
  </sec>
  <sec id="Sec9" sec-type="discussion">
    <title>Discussion</title>
    <p>These benchmarks provide a practical demonstration of how the computational cost of our JT test algorithm is related to the number of samples and the dimensions of the data. These simulations and results are completely reproducible using the code included with this manuscript as Additional filesÂ <xref rid="MOESM2" ref-type="media">2</xref>, <xref rid="MOESM3" ref-type="media">3</xref>, <xref rid="MOESM4" ref-type="media">4</xref> and <xref rid="MOESM5" ref-type="media">5</xref>. In addition to the evaluations shown here, we also confirm the accuracy of the calculation against known results based on example 6.2 of [<xref ref-type="bibr" rid="CR20">20</xref>]. The statistics calculated by our fastJT package match the published results. The code used for this verification is provided as Additional fileÂ <xref rid="MOESM6" ref-type="media">6</xref>.</p>
    <p>While the computational costs given here would be greatest if the simulated samples were evenly distributed across the ordinal groups, i.e., if the simulated counts of the variant alleles (0, 1 or 2) occured in proportions of 1/3, 1/3 and 1/3, a binomial distribution with probability parameter 0.5, giving proportions of 1/4, 1/2, and 1/4, represents the worst case under Hardy-Weinberg.</p>
    <p>FigureÂ <xref rid="Fig2" ref-type="fig">2</xref> shows that the CPU times grow linearly with the number of folds, since each cross-validation is a repeat of the JT test (excluding a subset of samples). The CPU times also grow linearly with the numbers of features and traits (Fig.Â <xref rid="Fig3" ref-type="fig">3</xref>), when the other parameters are fixed, since the JT test is conducted for all possible combinations of features and traits.</p>
    <p>When the sample size is increased (Fig.Â <xref rid="Fig4" ref-type="fig">4</xref>), a 50-fold increase in sample size corresponds to a similar relative increase, about 50-fold, in execution time for fastJT, while the naive pairwise comparison algorithm shows a more than 380-fold increase.</p>
    <p>The limiting factor in the performance of our algorithm is the efficiency of the sorting algorithm. The computational complexity of <inline-formula id="IEq9"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathrm {O}(\bar {n}\log (\bar {n}))$\end{document}</tex-math><mml:math id="M24"><mml:mi mathvariant="normal">O</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>Â¯</mml:mo></mml:mover><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>Â¯</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2869_Article_IEq9.gif"/></alternatives></inline-formula> is the worst case. In our simulations, as shown in Fig.Â <xref rid="Fig4" ref-type="fig">4</xref>, the computational complexity is <inline-formula id="IEq10"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathrm {O}(c\times \bar {n}\log (\bar {n}))$\end{document}</tex-math><mml:math id="M26"><mml:mi mathvariant="normal">O</mml:mi><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>Ã</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>Â¯</mml:mo></mml:mover><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>Â¯</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2869_Article_IEq10.gif"/></alternatives></inline-formula>, where <italic>c</italic> is a very small factor, thanks to the efficient sorting algorithm implemented in C++ STL. Ultimately, the optimal choice of sorting algorithm depends on the data type.</p>
    <p>For application of the JT test, the trait is assumed to be continuous while the feature is assumed to be ordinal. Note that by the nature of the Jonckheere-Terpstra test, our approach is not applicable in the case when both the trait and feature are continuous, except when such features can reasonably be binned into a manageable set of ordinal values. The algorithm also lacks support for selection of interaction effects. In the case of overlapping or correlated features, additional preprocessing, e.g., LD pruning, is required to prevent the selection of redundant features.</p>
    <p>When leveraging OpenMP for multi-core processing, as shown in Fig.Â <xref rid="Fig5" ref-type="fig">5</xref>, the observed times match closely with the theoretical ideal, indicating that the overhead of performing the multi-core computation is negligible.</p>
    <p>Finally, in Fig.Â <xref rid="Fig6" ref-type="fig">6</xref> we observe that for small proportions of outliers, the empirical rejection rate for the parametric approach exceeds the nominal rate of 0.05. The JT test, while more computationally demanding compared to the parametric approach, as expected, is robust to the presence of outliers.</p>
    <p>In addition to benchmarking on simulated data, we use our package to to build prediction models for three circulating protein markers from the CALGB 80303 GWAS. This application of the algorithm for robust feature selection produces predictions of the observed marker levels within a few of hours using a desktop CPU. Because the predictions are based leave-one-out feature selection, processing time is dominated by the number of patients, rather than the number of traits being predicted.</p>
    <p>The <italic>R</italic><sup>2</sup> values between the observed and cross-validated predicted levels of circulating VEGF-A, VEGF-C and MCP1 (Fig.Â <xref rid="Fig7" ref-type="fig">7</xref>), which are 0.047, 0.24 and 0.19, respectively, provide estimates of the proportion of the variability in the marker levels that can be attributed to common genetic variation. We note that if one skips the outer layer of the cross-validation, by selecting the top ten features based on data from all 216 patients, and then reusing the same set of features for each of the 216 leave-one-out cross-validation replicates, the estimated <italic>R</italic><sup>2</sup> values are 0.38, 0.31 and 0.20 for VEGF-A, VEGF-C and MCP1, respectively. The risk of producing potentially over-optimistic results, when the feature selection process is not cross-validated, is well known [<xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR30">30</xref>]. The main objective of this example is not to carry out a full analysis of the estimated proportion of variability of these protein markers explained by common genetic variation but rather to illustrate a practical application of our package for properly cross-validated robust feature selection.</p>
    <p>The key feature of the proposed algorithm is that it leverages the sorting of sample values to minimize unnecessary comparisons when calculating the statistics. The gain in performance of this algorithm over pairwise comparisons is substantial (Fig.Â <xref rid="Fig4" ref-type="fig">4</xref>), and this improvement is magnified as the sample size increases. The JT method shows markedly less inflation of the empirical rejection rate in the presence of outliers than the method of linear models. While these results are shown in the context of feature selection for machine learning and trait-SNP associations, our approach can be applied to a wide variety of statistical problems requiring large-scale feature selection.</p>
  </sec>
  <sec id="Sec10" sec-type="conclusion">
    <title>Conclusion</title>
    <p>This paper introduces the R extension package fastJT for robust and efficient feature selection for machine learning and genome-wide association studies with multiple quantitative phenotypes. The package employs an efficient algorithm which uses sorting to avoid unnecessary and redundant computations. This algorithm achieves a reduction in computational complexity to <inline-formula id="IEq11"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathrm {O}(\bar {n}\log (\bar {n}))$\end{document}</tex-math><mml:math id="M28"><mml:mi mathvariant="normal">O</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>Â¯</mml:mo></mml:mover><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>Â¯</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2869_Article_IEq11.gif"/></alternatives></inline-formula>, compared to O(<italic>n</italic><sup>2</sup>) for the naive approach. The JT test is robust in the presence of outliers when compared to a parametric linear regression test. fastJT is released under a public license and provides ample documentation, including a vignette.</p>
  </sec>
  <sec id="Sec11">
    <title>Appendix: Computational Complexity</title>
    <p>The core of the JT test statistic is the the Mann-Whitney count [<xref ref-type="bibr" rid="CR5">5</xref>]: 
<disp-formula id="Equb"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$U_{kl} = \Sigma_{i=1}^{n_{k}}\Sigma_{j=1}^{n_{l}} \phi(y_{ik},y_{jl}). $$ \end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">kl</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>Î£</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>Î£</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mi>Ï</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jl</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2019_2869_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> Here, <italic>k</italic> and <italic>l</italic> are the ranked indices for the ordinal groups being compared (assume <italic>k</italic>&lt;<italic>l</italic>). The numbers of samples in each group are <italic>n</italic><sub><italic>k</italic></sub> and <italic>n</italic><sub><italic>l</italic></sub>, and <italic>y</italic><sub><italic>ik</italic></sub> and <italic>y</italic><sub><italic>jl</italic></sub> represent the values of the quantitative trait for the <italic>i</italic><sup><italic>t</italic><italic>h</italic></sup> and <italic>j</italic><sup><italic>t</italic><italic>h</italic></sup> members of the groups, respectively. Then the JT test statistic is the summation of the Mann-Whitney counts across all pairings of the ordinal categories 
<disp-formula id="Equc"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\mathbf{J} = \sum_{k=1}^{t-1} \sum_{l=k+1}^{t} U_{kl}, $$ \end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mi mathvariant="bold">J</mml:mi><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">â</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>â</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">â</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">kl</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2019_2869_Article_Equc.gif" position="anchor"/></alternatives></disp-formula> where <italic>t</italic> is the number of categories. The overall computational complexity of the above process has a cost (in terms of elementary operations) of 
<disp-formula id="Equd"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\sum_{k=1}^{t-1} \sum_{l=k+1}^{t} n_{k} n_{l}. $$ \end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">â</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>â</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">â</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2019_2869_Article_Equd.gif" position="anchor"/></alternatives></disp-formula> In the worst-case scenario, all groups have size <inline-formula id="IEq12"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {n}=n/t$\end{document}</tex-math><mml:math id="M36"><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>Â¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mo>/</mml:mo><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="12859_2019_2869_Article_IEq12.gif"/></alternatives></inline-formula>. The total computation cost can then be given as 
<disp-formula id="Eque"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\frac{t(t-1)}{2} \bar{n}^{2}. $$ \end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>â</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>Â¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2019_2869_Article_Eque.gif" position="anchor"/></alternatives></disp-formula> Since the number of categories, <italic>t</italic>, is a predefined constant, the computational complexity, in big O notation, is: 
<disp-formula id="Equf"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\mathrm{O}\left(\bar{n}^{2}\right). $$ \end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi mathvariant="normal">O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>Â¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2019_2869_Article_Equf.gif" position="anchor"/></alternatives></disp-formula> That is to say, the computational cost for a naive implementation of the JT test statistics is quadratic in the number of samples.</p>
    <p>In the fastJT package, the computation of the statistics is carried out in two parts, sorting and counting. After sorting the quantitative trait, the Mann-Whitney count is carried out by conducting a searching and counting process, shown in the â<xref rid="Sec4" ref-type="sec">Algorithm and implementation</xref>â section to have a computational complexity of <inline-formula id="IEq13"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathrm {O}(\bar {n})$\end{document}</tex-math><mml:math id="M42"><mml:mi mathvariant="normal">O</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>Â¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2869_Article_IEq13.gif"/></alternatives></inline-formula>. For this implementation of the statistic, the computational cost, in terms of the total number of elementary operations, is: 
<disp-formula id="Equg"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$t \bar{n}\log(\bar{n}) + \mathrm{O}(\bar{n})= \mathrm{O}(\text{max} (t \bar{n}\log(\bar{n}), \bar{n})). $$ \end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:mi>t</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>Â¯</mml:mo></mml:mover><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>Â¯</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi mathvariant="normal">O</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>Â¯</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="normal">O</mml:mi><mml:mo>(</mml:mo><mml:mtext>max</mml:mtext><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>Â¯</mml:mo></mml:mover><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>Â¯</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>Â¯</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2019_2869_Article_Equg.gif" position="anchor"/></alternatives></disp-formula> The logarithmic term of the cost is incurred from sorting the quantitative trait values for the samples in each of the ordinal groups. The linear term accounts for the searching and counting process. Thus, the sorting process dominates the overall cost of computation, so the computational complexity for computing the JT statistic in fastJT is <inline-formula id="IEq14"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathrm {O}(t\bar {n} \log (\bar {n}))$\end{document}</tex-math><mml:math id="M46"><mml:mi mathvariant="normal">O</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>Â¯</mml:mo></mml:mover><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>Â¯</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2869_Article_IEq14.gif"/></alternatives></inline-formula>, or essentially <inline-formula id="IEq15"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathrm {O}(\bar {n} \log (\bar {n}))$\end{document}</tex-math><mml:math id="M48"><mml:mi mathvariant="normal">O</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>Â¯</mml:mo></mml:mover><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>Â¯</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2869_Article_IEq15.gif"/></alternatives></inline-formula> for a fixed number of ordinal categories.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional files</title>
    <sec id="Sec12">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2019_2869_MOESM1_ESM.pdf">
            <label>Additional file 1</label>
            <caption>
              <p>A figure of the schematic for two-layer cross-validation machine learning model. (PDF 203 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2019_2869_MOESM2_ESM.r">
            <label>Additional file 2</label>
            <caption>
              <p>An R script verifying the accuracy of the fastJT package results compared to the examples in the literature. (R 1 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2019_2869_MOESM3_ESM.r">
            <label>Additional file 3</label>
            <caption>
              <p>An R script performing the benchmarking of the fastJT algorithm reported in this paper. (R 3 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="12859_2019_2869_MOESM4_ESM.r">
            <label>Additional file 4</label>
            <caption>
              <p>An R script for comparing the empirical rejection rates between the JT method and the linear regression method. (R 2 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="12859_2019_2869_MOESM5_ESM.r">
            <label>Additional file 5</label>
            <caption>
              <p>An R script for producing the figures presented in this paper. (R 6 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="12859_2019_2869_MOESM6_ESM.r">
            <label>Additional file 6</label>
            <caption>
              <p>An R script demonstrating using the fastJT package for feature selection for machine learning based on data from CALGB 80303. (R 8 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>ANOVA</term>
        <def>
          <p>analysis of variance</p>
        </def>
      </def-item>
      <def-item>
        <term>eQTL</term>
        <def>
          <p>expression quantitative trait loci</p>
        </def>
      </def-item>
      <def-item>
        <term>GWAS</term>
        <def>
          <p>genome-wide association studies</p>
        </def>
      </def-item>
      <def-item>
        <term>JT</term>
        <def>
          <p>Jonckheere-Terpstra</p>
        </def>
      </def-item>
      <def-item>
        <term>MAF</term>
        <def>
          <p>minor allele frequency</p>
        </def>
      </def-item>
      <def-item>
        <term>SNP</term>
        <def>
          <p>single nucleotide polymorphism</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank a reviewer for comments and suggestions that substantially improved the paper. The content is solely the responsibility of the authors and does not necessarily represent the official views of the National Institute of Health. The authors gratefully acknowledge the Alliance for Oncology Clinical Trial for sharing the data from the CALGB 80303 GWAS.</p>
    <sec id="d29e2412">
      <title>Funding</title>
      <p>This research was supported in part by Award number P01CA142538 from the National Cancer Institute (FI, KO, JL). The funding agency had no role in study design, data collection, analysis and interpretation, decision to publish, or preparation of the manuscript.</p>
    </sec>
    <sec id="d29e2417" sec-type="data-availability">
      <title>Availability of data and materials</title>
      <p>The latest release version of the fastJT package, along with archived older releases, including release version 1.0.4 used in this paper, are available from CRAN (<ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=fastJT">https://CRAN.R-project.org/package=fastJT</ext-link>). The development code and scripts to reproduce all the figures and results from the paper are available from the project source code repository (<ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/impactp01/fastjt">https://bitbucket.org/impactp01/fastjt</ext-link>). The latter scripts are also included as Additional Files. The release and development source code are freely available with no need for registration. The GWAS data used for the illustrations are available through the database of Genotypes and Phenotypes (dbGaP) through study accession phs000250.v1.p1. The protein marker data are provided as part of the supplemental information from Innocenti et al. [<xref ref-type="bibr" rid="CR3">3</xref>].</p>
    </sec>
    <sec id="d29e2435">
      <title>Availability and requirements</title>
      <p>Project name: fastJT</p>
      <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=fastJT">https://CRAN.R-project.org/package=fastJT</ext-link></p>
      <p>Operating system(s): Platform independent</p>
      <p>Programming language: R (â¥3.3)</p>
      <p>Other requirements: R packages Rcpp, stats</p>
      <p>License: GPL-3</p>
      <p>Any restrictions to use by non-academics: None</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authorsâ contributions</title>
    <p>KO proposed the project, JL, AS and KO wrote the manuscript, JL developed the algorithm and wrote the package, FI led the CALGB 80303 genome-wide study, AN led the CALGB 80303 protein biomarker study, IS and CC critically revised the manuscript, AS contributed to testing, IS contributed to programming. All authors read and approved the final manuscript.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p>Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p>Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </notes>
  <notes>
    <title>Publisherâs Note</title>
    <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saeys</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Inza</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>LarraÃ±aga</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>A review of feature selection techniques in bioinformatics</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <issue>19</issue>
        <fpage>2507</fpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm344</pub-id>
        <pub-id pub-id-type="pmid">17720704</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>High-dimensional classification using features annealed independence rules</article-title>
        <source>Ann Statist</source>
        <year>2008</year>
        <volume>36</volume>
        <issue>6</issue>
        <fpage>2605</fpage>
        <pub-id pub-id-type="doi">10.1214/07-AOS504</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Innocenti</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sibley</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Etheridge</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Hatch</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Denning</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Niedzwiecki</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Shterev</surname>
            <given-names>ID</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Furukawa</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kubo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kindler</surname>
            <given-names>HL</given-names>
          </name>
          <name>
            <surname>Auman</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Venook</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Hurwitz</surname>
            <given-names>HI</given-names>
          </name>
          <name>
            <surname>McLeod</surname>
            <given-names>HL</given-names>
          </name>
          <name>
            <surname>Ratain</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Gordan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Nixon</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Owzar</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Genetic variation determines VEGF-A plasma levels in cancer patients</article-title>
        <source>Sci Rep</source>
        <year>2018</year>
        <volume>8</volume>
        <fpage>16332</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-018-34506-4</pub-id>
        <pub-id pub-id-type="pmid">30397360</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altman</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>Parametric vs non-parametric methods for data analysis</article-title>
        <source>BMJ</source>
        <year>2009</year>
        <volume>338</volume>
        <fpage>3167</fpage>
        <pub-id pub-id-type="doi">10.1136/bmj.a3167</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mann</surname>
            <given-names>HB</given-names>
          </name>
          <name>
            <surname>Whitney</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>On a test of whether one of two random variables is stochastically larger than the other</article-title>
        <source>Ann Math Stat</source>
        <year>1947</year>
        <volume>18</volume>
        <fpage>50</fpage>
        <pub-id pub-id-type="doi">10.1214/aoms/1177730491</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kruskal</surname>
            <given-names>WH</given-names>
          </name>
          <name>
            <surname>Wallis</surname>
            <given-names>WA</given-names>
          </name>
        </person-group>
        <article-title>Use of ranks in one-criterion variance analysis</article-title>
        <source>J Am Stat Assoc</source>
        <year>1952</year>
        <volume>47</volume>
        <fpage>583</fpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1952.10483441</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abebe</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nudurupati Sai</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Smooth Nonparametric Allocation of Classification</article-title>
        <source>Commun Stat - Simul Comput</source>
        <year>2011</year>
        <volume>40</volume>
        <issue>5</issue>
        <fpage>694</fpage>
        <pub-id pub-id-type="doi">10.1080/03610918.2010.551013</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jonckheere</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>A distribution-free k-sample test against ordered alternatives</article-title>
        <source>Biometrika</source>
        <year>1954</year>
        <volume>41</volume>
        <fpage>133</fpage>
        <pub-id pub-id-type="doi">10.1093/biomet/41.1-2.133</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Terpstra</surname>
            <given-names>TJ</given-names>
          </name>
        </person-group>
        <article-title>The asymptotic normality and consistency of kendallâs test against trend, when ties are present in one ranking</article-title>
        <source>Indag Math</source>
        <year>1952</year>
        <volume>14</volume>
        <fpage>327</fpage>
        <pub-id pub-id-type="doi">10.1016/S1385-7258(52)50043-X</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ong</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Aggarwal</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Krieger</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Easley</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Karafa</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Van Lente</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Arroliga</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Mullen</surname>
            <given-names>KD</given-names>
          </name>
        </person-group>
        <article-title>Correlation between ammonia levels and the severity of hepatic encephalopathy</article-title>
        <source>Am J Med</source>
        <year>2003</year>
        <volume>114</volume>
        <fpage>188</fpage>
        <pub-id pub-id-type="doi">10.1016/S0002-9343(02)01477-8</pub-id>
        <pub-id pub-id-type="pmid">12637132</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bredella</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Steinbach</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>Morgan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ward</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Mri of the sacroiliac joints in patients with moderate to severe ankylosing spondylitis</article-title>
        <source>AJR Am J Roentgenol</source>
        <year>2006</year>
        <volume>187</volume>
        <fpage>1420</fpage>
        <pub-id pub-id-type="doi">10.2214/AJR.05.1423</pub-id>
        <pub-id pub-id-type="pmid">17114530</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoffmeyer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Burk</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>von Richter</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Arnold</surname>
            <given-names>HP</given-names>
          </name>
          <name>
            <surname>Brockmoller</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Johne</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cascorbi</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Gerloff</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Roots</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Eichelbaum</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Brinkmann</surname>
            <given-names>U</given-names>
          </name>
        </person-group>
        <article-title>Functional polymorphisms of the human multidrug-resistance gene: Multiple sequence variations and correlation of one allele with p-glycoprotein expression and activity in vivo</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2000</year>
        <volume>97</volume>
        <fpage>3473</fpage>
        <pub-id pub-id-type="doi">10.1073/pnas.97.7.3473</pub-id>
        <pub-id pub-id-type="pmid">10716719</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rakvag</surname>
            <given-names>TT</given-names>
          </name>
          <name>
            <surname>Klepstad</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Baar</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kvam</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Dale</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Kaasa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Krokan</surname>
            <given-names>HE</given-names>
          </name>
          <name>
            <surname>Skorpen</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>The val158met polymorphism of the human catechol-o-methyltransferase (comt) gene may influence morphine requirements in cancer pain patients</article-title>
        <source>Pain</source>
        <year>2005</year>
        <volume>116</volume>
        <fpage>73</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1016/j.pain.2005.03.032</pub-id>
        <pub-id pub-id-type="pmid">15927391</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qing</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>WenJian</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>C</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Ching-Hon</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>V</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>E</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <article-title>Karyotypic abnormalities create discordance of germline genotype and cancer cell phenotypes</article-title>
        <source>Nat Genet</source>
        <year>2005</year>
        <volume>37</volume>
        <fpage>878</fpage>
        <pub-id pub-id-type="doi">10.1038/ng1612</pub-id>
        <pub-id pub-id-type="pmid">16041371</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Takahisa</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Yoshio</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Atsushi</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Keitaro</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Meiko</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Toshinari</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kohichiroh</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Toshiji</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Etsuko</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Miwa</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sumio</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Sumio</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Yasuharu</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Miki</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Toshihide</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hyohun</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hideo</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kazuo</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ryo</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Fumihiko</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Takeshi</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Genetic polymorphisms of the human pnpla3 gene are strongly associated with severity of non-alcoholic fatty liver disease in japanese</article-title>
        <source>PLoS ONE</source>
        <year>2012</year>
        <volume>7</volume>
        <fpage>38322</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0038322</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tan</surname>
            <given-names>H. -L.</given-names>
          </name>
          <name>
            <surname>Zain</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Mohamed</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Rampal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chin</surname>
            <given-names>K. -F.</given-names>
          </name>
          <name>
            <surname>Basu</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Cheah</surname>
            <given-names>P. -L.</given-names>
          </name>
          <name>
            <surname>Mahadeva</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mohamed</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Association of glucokinase regulatory gene polymorphisms with risk and severity of non-alcoholic fatty liver disease: an interaction study with adiponutrin gene</article-title>
        <source>J Gastroenterol</source>
        <year>2014</year>
        <volume>49</volume>
        <issue>6</issue>
        <fpage>1056</fpage>
        <pub-id pub-id-type="doi">10.1007/s00535-013-0850-x</pub-id>
        <pub-id pub-id-type="pmid">23800943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Uchiyama</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kanno</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ishitani</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Fujii</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ohta</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Matsui</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kamatani</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Saito</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>An SNP in CYP39A1 is associated with severe neutropenia induced by docetaxel</article-title>
        <source>Cancer Chemother Pharmacol</source>
        <year>2012</year>
        <volume>69</volume>
        <issue>6</issue>
        <fpage>1617</fpage>
        <pub-id pub-id-type="doi">10.1007/s00280-012-1872-4</pub-id>
        <pub-id pub-id-type="pmid">22562553</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yorifuji</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Uemura</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Horibata</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tsuji</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Suzuki</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Miyagawa</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Nakayama</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hirata</surname>
            <given-names>K. -i.</given-names>
          </name>
          <name>
            <surname>Kumagai</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Emoto</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>CHST3 and CHST13 polymorphisms as predictors of bosentan-induced liver toxicity in japanese patients with pulmonary arterial hypertension</article-title>
        <source>Pharmacol Res</source>
        <year>2018</year>
        <volume>135</volume>
        <fpage>259</fpage>
        <pub-id pub-id-type="doi">10.1016/j.phrs.2018.08.011</pub-id>
        <pub-id pub-id-type="pmid">30118797</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <collab>R Core Team</collab>
        </person-group>
        <source>R: A Language and Environment for Statistical Computing</source>
        <year>2018</year>
        <publisher-loc>Vienna</publisher-loc>
        <publisher-name>R Foundation for Statistical Computing</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Hollander</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wolfe</surname>
            <given-names>DA</given-names>
          </name>
        </person-group>
        <source>Nonparametric Statistical Methods, 2nd edn</source>
        <year>1999</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Wiley</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <mixed-citation publication-type="other">Lin J, Sibley A, Shterev I, Owzar K. fastJT: Efficient Jonckheere-Terpstra Test Statistics for Robust Machine Learning and Genome-Wide Association Studies. 2017. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=fastJT">https://CRAN.R-project.org/package=fastJT</ext-link> R package version 1.0.4.</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eddelbuettel</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>FranÃ§ois</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Rcpp: Seamless R and C++ integration</article-title>
        <source>J Stat Softw</source>
        <year>2011</year>
        <volume>40</volume>
        <issue>8</issue>
        <fpage>1</fpage>
        <pub-id pub-id-type="doi">10.18637/jss.v040.i08</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dagum</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Menon</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Openmp: An industry-standard api for shared-memory programming</article-title>
        <source>IEEE Comput Sci Eng</source>
        <year>1998</year>
        <volume>5</volume>
        <fpage>46</fpage>
        <pub-id pub-id-type="doi">10.1109/99.660313</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kindleri</surname>
            <given-names>HL</given-names>
          </name>
          <name>
            <surname>Niedzwiecki</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hollis</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sutherland</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schrag</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hurwitz</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Innocenti</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Mulcahy</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>OâReilly</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Wozniak</surname>
            <given-names>TF</given-names>
          </name>
          <name>
            <surname>Picus</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bhargava</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mayer</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Schilsky</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Goldberg</surname>
            <given-names>RM</given-names>
          </name>
        </person-group>
        <article-title>Gemcitabine plus bevacizumab compared with gemcitabine plus placebo in patients with advanced pancreatic cancer: phase III trial of the Cancer and Leukemia Group B (CALGB 80303)</article-title>
        <source>J Clin Oncol</source>
        <year>2010</year>
        <volume>28</volume>
        <fpage>3617</fpage>
        <pub-id pub-id-type="doi">10.1200/JCO.2010.28.1386</pub-id>
        <pub-id pub-id-type="pmid">20606091</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Innocenti</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Owzar</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Cox</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Evans</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kubo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zembutsu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hollis</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mushiroda</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Glubb</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hurwitz</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Giacomini</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>McLeod</surname>
            <given-names>HL</given-names>
          </name>
          <name>
            <surname>Goldberg</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Schilsky</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Kindler</surname>
            <given-names>HL</given-names>
          </name>
          <name>
            <surname>Nakamura</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ratain</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>A genome-wide association study of overall survival in pancreatic cancer patients treated with gemcitabine in CALGB 80303</article-title>
        <source>Clin Cancer Res</source>
        <year>2012</year>
        <volume>18</volume>
        <fpage>577</fpage>
        <pub-id pub-id-type="doi">10.1158/1078-0432.CCR-11-1387</pub-id>
        <pub-id pub-id-type="pmid">22142827</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nixon</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Pang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Starr</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>PN</given-names>
          </name>
          <name>
            <surname>Bertagnolli</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Kindler</surname>
            <given-names>HL</given-names>
          </name>
          <name>
            <surname>Goldberg</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Venook</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Hurwitz</surname>
            <given-names>HI</given-names>
          </name>
        </person-group>
        <article-title>Prognostic and predictive blood-based biomarkers in patients with advanced pancreatic cancer: Results from CALGB80303 (Alliance)</article-title>
        <source>Clin Cancer Res</source>
        <year>2013</year>
        <volume>19</volume>
        <fpage>6957</fpage>
        <pub-id pub-id-type="doi">10.1158/1078-0432.CCR-13-0926</pub-id>
        <pub-id pub-id-type="pmid">24097873</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Simon</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Korn</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>McShane</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Radmacher</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>GW</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <source>Design and Analysis of DNA Microarray Investigations</source>
        <year>2011</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Friedman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Regularization paths for generalized linear models via coordinate descent</article-title>
        <source>J Stat Softw</source>
        <year>2010</year>
        <volume>33</volume>
        <fpage>1</fpage>
        <pub-id pub-id-type="doi">10.18637/jss.v033.i01</pub-id>
        <pub-id pub-id-type="pmid">20808728</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hatch</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Sibley</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Starr</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Brady</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jia</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bowers</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Pang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Owzar</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Niedzwiecki</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Innocenti</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Venook</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Hurwitz</surname>
            <given-names>HI</given-names>
          </name>
          <name>
            <surname>Nixon</surname>
            <given-names>AB</given-names>
          </name>
        </person-group>
        <article-title>Blood-based markers of efficacy and resistance to cetuximab treatment in metastatic colorectal cancer: results from CALGB 80203 (Alliance)</article-title>
        <source>Cancer Med</source>
        <year>2016</year>
        <volume>5</volume>
        <fpage>2249</fpage>
        <pub-id pub-id-type="doi">10.1002/cam4.806</pub-id>
        <pub-id pub-id-type="pmid">27465221</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Owzar</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Barry</surname>
            <given-names>WT</given-names>
          </name>
          <name>
            <surname>Jung</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Statistical considerations for analysis of microarray experiments</article-title>
        <source>Clin Transl Sci</source>
        <year>2011</year>
        <volume>4</volume>
        <fpage>466</fpage>
        <pub-id pub-id-type="doi">10.1111/j.1752-8062.2011.00309.x</pub-id>
        <pub-id pub-id-type="pmid">22212230</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
