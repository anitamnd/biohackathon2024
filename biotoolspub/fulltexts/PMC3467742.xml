<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3467742</article-id>
    <article-id pub-id-type="pmid">22851531</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bts486</article-id>
    <article-id pub-id-type="publisher-id">bts486</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group>
          <subject>Databases and Ontologies</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MetiTree: a web application to organize and process high-resolution multi-stage mass spectrometry metabolomics data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Rojas-Chertó</surname>
          <given-names>Miguel</given-names>
        </name>
        <xref ref-type="aff" rid="bts486-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="bts486-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="bts486-COR1">*</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>van Vliet</surname>
          <given-names>Michael</given-names>
        </name>
        <xref ref-type="aff" rid="bts486-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="bts486-AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Peironcely</surname>
          <given-names>Julio E.</given-names>
        </name>
        <xref ref-type="aff" rid="bts486-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="bts486-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="bts486-AFF1">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>van Doorn</surname>
          <given-names>Ronnie</given-names>
        </name>
        <xref ref-type="aff" rid="bts486-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Kooyman</surname>
          <given-names>Maarten</given-names>
        </name>
        <xref ref-type="aff" rid="bts486-AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>te Beek</surname>
          <given-names>Tim</given-names>
        </name>
        <xref ref-type="aff" rid="bts486-AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>van Driel</surname>
          <given-names>Marc A.</given-names>
        </name>
        <xref ref-type="aff" rid="bts486-AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Hankemeier</surname>
          <given-names>Thomas</given-names>
        </name>
        <xref ref-type="aff" rid="bts486-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="bts486-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Reijmers</surname>
          <given-names>Theo</given-names>
        </name>
        <xref ref-type="aff" rid="bts486-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="bts486-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="bts486-COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="bts486-AFF1"><sup>1</sup>Netherlands Metabolomics Centre, Einsteinweg 55, 2333 CC Leiden and <sup>2</sup>Division of Analytical Biosciences, Leiden/Amsterdam Center for Drug Research, Leiden University, Einsteinweg 55, 2300 RA Leiden and <sup>3</sup>Netherlands Bioinformatics Centre, Geert Grooteplein 28, 6525 GA Nijmegen and <sup>4</sup>TNO Research Group Quality and Safety, P.O. Box 360, NL-3700 AJ Zeist, The Netherlands</aff>
    <author-notes>
      <corresp id="bts486-COR1">*To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate Editor: Janet Kelso</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>10</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>31</day>
      <month>7</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>31</day>
      <month>7</month>
      <year>2012</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>28</volume>
    <issue>20</issue>
    <fpage>2707</fpage>
    <lpage>2709</lpage>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>4</month>
        <year>2012</year>
      </date>
      <date date-type="rev-recd">
        <day>3</day>
        <month>7</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>7</month>
        <year>2012</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2012. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2012</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/3.0">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/3.0">http://creativecommons.org/licenses/by/3.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> Identification of metabolites using high-resolution multi-stage mass spectrometry (MS<italic><sup>n</sup></italic>) data is a significant challenge demanding access to all sorts of computational infrastructures. MetiTree is a user-friendly, web application dedicated to organize, process, share, visualize and compare MS<italic><sup>n</sup></italic> data. It integrates several features to export and visualize complex MS<italic><sup>n</sup></italic> data, facilitating the exploration and interpretation of metabolomics experiments. A dedicated spectral tree viewer allows the simultaneous presentation of three related types of MS<italic><sup>n</sup></italic> data, namely, the spectral data, the fragmentation tree and the fragmentation reactions. MetiTree stores the data in an internal database to enable searching for similar fragmentation trees and matching against other MS<italic><sup>n</sup></italic> data. As such MetiTree contains much functionality that will make the difficult task of identifying unknown metabolites much easier.</p>
      <p><bold>Availability:</bold> MetiTree is accessible at <ext-link ext-link-type="uri" xlink:href="http://www.MetiTree.nl">http://www.MetiTree.nl</ext-link>. The source code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/NetherlandsMetabolomicsCentre/metitree/wiki">https://github.com/NetherlandsMetabolomicsCentre/metitree/wiki</ext-link>.</p>
      <p><bold>Contact:</bold><email>m.rojas@lacdr.leidenuniv.nl</email> or <email>t.reijmers@lacdr.leidenuniv.nl</email></p>
    </abstract>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>Metabolite identification is a challenging but essential step for the interpretation and understanding of many biological processes for an increasing number of applications such as biomarker discovery, drug discovery or nutritional studies. The feasibility of using multi-stage mass spectrometry (MS<italic><sup>n</sup></italic>) for identification of metabolites has been shown before (<xref ref-type="bibr" rid="bts486-B5">Sheldon <italic>et al.</italic>, 2009</xref>). The complexity of the data generated demands new computational infrastructures to organize the data and to extract relevant information. Recently, databases have been set up for storing fragmentation spectra such as MS<italic><sup>n</sup></italic> data (e.g. MassBank; <xref ref-type="bibr" rid="bts486-B1">Horai <italic>et al.</italic>, 2010</xref>), and tools have been developed to process MS<italic><sup>n</sup></italic> data (e.g. the MEF tool; <xref ref-type="bibr" rid="bts486-B3">Rojas-Chertó <italic>et al.</italic>, 2011</xref>), or to compare MS<italic><sup>n</sup></italic> data (e.g. Mass Frontier; Thermo Fisher Scientific). In this article we present a web application called MetiTree with the novelty that it combines the processing of high-resolution MS<italic><sup>n</sup></italic> data with a personal local library to organize the fragmentation data. Furthermore, it allows the comparison of MS<italic><sup>n</sup></italic> data to help the researcher with the identification of metabolites. MetiTree is available at <ext-link ext-link-type="uri" xlink:href="http://www.MetiTree.nl">http://www.MetiTree.nl</ext-link> together with some test MS<italic><sup>n</sup></italic> data.</p>
  </sec>
  <sec id="SEC2">
    <title>2 METHODS</title>
    <sec id="SEC2.1">
      <title>2.1 Web application</title>
      <p>MetiTree (Metabolite Identification Tree) is a web application intended to aid in the metabolite identification process. Currently, MetiTree offers the possibility to organize, process, share, visualize and search for similar high-resolution MS<italic><sup>n</sup></italic> data. MetiTree’s web interface is accessed through a web browser and it was created using the Grails (<ext-link ext-link-type="uri" xlink:href="http://grails.org">http://grails.org</ext-link>) frame-work.</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Data processing and comparison</title>
      <p>In order to process MS<italic><sup>n</sup></italic> data, MetiTree integrates the MEF tool (<xref ref-type="bibr" rid="bts486-B3">Rojas-Chertó <italic>et al.</italic>, 2011</xref>), which extracts chemical information from the fragments assigning the elemental composition to the ions and neutral losses. MetiTree also allows the comparison of newly acquired MS<italic><sup>n</sup></italic> data to data that are already stored in an internal library (<xref ref-type="bibr" rid="bts486-B4">Rojas-Chertó <italic>et al.</italic>, 2012</xref>).</p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 Data visualization</title>
      <p>MetiTree incorporates a JavaScript spectral tree viewer developed to visualize MS<italic><sup>n</sup></italic> data (<ext-link ext-link-type="uri" xlink:href="https://trac.nbic.nl/brsp201017/">https://trac.nbic.nl/brsp201017/</ext-link>), in order to facilitate the exploration, interpretation and validation of the results. This viewer interconnects three MS<italic><sup>n</sup></italic> items: the spectrum, which contains mass peaks, the fragmentation tree, which contains fragment nodes/elemental compositions, and the fragmentation reactions, which contain structures.</p>
    </sec>
  </sec>
  <sec id="SEC3">
    <title>3 USAGE EXAMPLE</title>
    <p>MS<italic><sup>n</sup></italic> data previously published by our group (<xref ref-type="bibr" rid="bts486-B3">Rojas-Chertó <italic>et al.</italic>, 2011</xref>, <xref ref-type="bibr" rid="bts486-B4">2012</xref>) are used to demonstrate how metabolites can be identified using the MetiTree web application. These data are freely accessible as test data in MetiTree.</p>
    <sec id="SEC3.1">
      <title>3.1 Data processing</title>
      <p>The required input to process MS<italic><sup>n</sup></italic> data is mzXML files and the settings of the processing parameters. Processing parameters are grouped into those to extract the mass spectrometry information (<italic>m</italic>/<italic>z</italic>, intensity and retention time) and those to enrich the MS data with chemical information (elements and number of atoms). MetiTree allows individual file as well as batch processing. Furthermore, the same mzXML file can be processed several times with different sets of parameters. The results and parameters’ information are stored to allow for posterior revision.</p>
    </sec>
    <sec id="SEC3.2">
      <title>3.2 Data visualization</title>
      <p>Once the data are processed, it can be displayed using the spectral tree viewer (<xref ref-type="fig" rid="bts486-F1">Fig. 1</xref>A). When the node (a fragment) is selected, the corresponding spectrum is displayed together with the concatenated reactions that connect the parent ion with the selected fragment. The structure of the fragment can only be displayed if it has been previously assigned. The results generated by MetiTree can be exported to different formats (CSV, CML; <xref ref-type="bibr" rid="bts486-B2">Murray-Rust and Rzepa, 1999</xref>) and PDF) for further analysis or for presenting results in reports and publications.
<fig id="bts486-F1" position="float"><label>Fig. 1.</label><caption><p>Overview of the MetiTree process flow. After the user submits MS<italic><sup>n</sup></italic> spectra, MetiTree will process these according to a set of parameters. Afterwards, the processed data can be stored in an internal library and labeled as a reference compound using the InChI identifier. The results are presented in different formats and viewers, which facilitates the exporting of text and figures for their use in reports and publications (<bold>A</bold>). Finally, MS<italic><sup>n</sup></italic> data can be queried to find similar MS<italic><sup>n</sup></italic> data in the library (<bold>B</bold>) and the query results are presented in a list</p></caption><graphic xlink:href="bts486f1p"/></fig></p>
    </sec>
    <sec id="SEC3.3">
      <title>3.3 Library storage</title>
      <p>MetiTree creates directories for grouping mzXML files, assisting with the organization of the data according projects or topics. Processed MS<italic><sup>n</sup></italic> data can be stored in one or multiple internal databases (<xref ref-type="fig" rid="bts486-F1">Fig. 1</xref>B). Because the users are organized in groups, they can share files and libraries with other group members. All MS<italic><sup>n</sup></italic> data can be labeled with an InChI identifier of the compound, which is automatically cross-referenced with PubChem and ChemSpider databases.</p>
    </sec>
    <sec id="SEC3.4">
      <title>3.4 Data search</title>
      <p>MetiTree integrates the functionality to query for similar MS<italic><sup>n</sup></italic> data (<xref ref-type="bibr" rid="bts486-B4">Rojas-Chertó <italic>et al.</italic>, 2012</xref>) stored in the library. The results are presented in a list showing the chemical structures of the most similar MS<italic><sup>n</sup></italic> data and the corresponding similarity values. A value near 100 indicates that MS<italic><sup>n</sup></italic> data are highly similar, while a value close to 0 illustrates that they are very different. If a fragmentation tree of the same compound is present in the library, complete identification is possible (identity search). If similar fragmentation data are found (similarity search), this substructure information can be used to generate candidate structures of the unknown compound (partial identification).</p>
    </sec>
    <sec id="SEC3.5">
      <title>3.5 Future</title>
      <p>In the near future this new web application will also accept the uploading of other types of MS<italic><sup>n</sup></italic> files (e.g. cml, mzML) and manual annotation of MS<italic><sup>n</sup></italic> data with chemical structural information (assigning substructures to the nodes of the fragmentation trees) will also be possible.</p>
    </sec>
  </sec>
  <sec id="SEC4">
    <title>4 CONCLUSION</title>
    <p>The growing interest in metabolite identification has increased the need to create computational and visual tools for MS<italic><sup>n</sup></italic> analysis. MetiTree, which gathers several in-house developed tools, is an easy-to-use web application that combines processing, sharing, visualizing and querying MS<italic><sup>n</sup></italic> data to help researches to identify metabolites of interest and decrease the time-consuming task of identifying metabolites.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>The authors are grateful to Prof. Dr N.M.M. Nibbering, Dr A.C. Tas, P.T. Kasper, Dr R. Vreeken, J.J.J. van der Hooft and M. Ries for their input.</p>
    <p><italic>Funding</italic>: The research programme of the <funding-source>Netherlands Metabolomics Centre (NMC)</funding-source>, which is a part of <funding-source>The Netherlands Genomics Initiative/Netherlands Organization for Scientific Research</funding-source>. This work was part of the BioAssist programme of the <funding-source>Netherlands Bioinformatics Centre (NBIC)</funding-source>, which is supported by the <funding-source>Netherlands Genomics Initiative (NGI)</funding-source>.</p>
    <p><italic>Conflict of Interest:</italic> none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="bts486-B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Horai</surname>
            <given-names>H.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MassBank: a public repository for sharing mass spectral data for life sciences</article-title>
        <source>J. Mass Spectromet.: JMS</source>
        <year>2010</year>
        <volume>45</volume>
        <fpage>703</fpage>
        <lpage>714</lpage>
      </element-citation>
    </ref>
    <ref id="bts486-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Murray-Rust</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Rzepa</surname>
            <given-names>H.S.</given-names>
          </name>
        </person-group>
        <article-title>Chemical Markup, XML, and the Worldwide Web. 1. Basic Principles</article-title>
        <source>J. Chem. Inform. Model.</source>
        <year>1999</year>
        <volume>39</volume>
        <fpage>928</fpage>
        <lpage>942</lpage>
      </element-citation>
    </ref>
    <ref id="bts486-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rojas-Chertó</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Elemental Composition determination based on MSn</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>2376</fpage>
        <lpage>2383</lpage>
        <pub-id pub-id-type="pmid">21757467</pub-id>
      </element-citation>
    </ref>
    <ref id="bts486-B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rojas-Chertó</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Metabolite identification using automated comparison of high resolution multistage mass spectral trees</article-title>
        <source>Anal. Chem.</source>
        <year>2012</year>
        <volume>84</volume>
        <fpage>5524</fpage>
        <lpage>5534</lpage>
        <pub-id pub-id-type="pmid">22612383</pub-id>
      </element-citation>
    </ref>
    <ref id="bts486-B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sheldon</surname>
            <given-names>M.T.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Determination of ion structures in structurally related compounds using precursor ion fingerprinting</article-title>
        <source>J. Am. Soc. Mass Spectrom.</source>
        <year>2009</year>
        <volume>20</volume>
        <fpage>370</fpage>
        <lpage>376</lpage>
        <pub-id pub-id-type="pmid">19041260</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
