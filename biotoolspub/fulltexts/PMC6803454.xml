<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Genet</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Genet</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Genet.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1664-8021</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6803454</article-id>
    <article-id pub-id-type="doi">10.3389/fgene.2019.00999</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Genetics</subject>
        <subj-group>
          <subject>Methods</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>An Integrated Pipeline for Annotation and Visualization of Metagenomic Contigs</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Dong</surname>
          <given-names>Xiaoli</given-names>
        </name>
        <xref ref-type="author-notes" rid="fn001">
          <sup>*</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="https://loop.frontiersin.org/people/294586"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Strous</surname>
          <given-names>Marc</given-names>
        </name>
        <uri xlink:type="simple" xlink:href="https://loop.frontiersin.org/people/18013"/>
      </contrib>
    </contrib-group>
    <aff id="aff1"><institution>Department of Geoscience, University of Calgary</institution>, <addr-line>Calgary, AB</addr-line>, <country>Canada</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p>Edited by: Bas E. Dutilh, Utrecht University, Netherlands</p>
      </fn>
      <fn fn-type="edited-by">
        <p>Reviewed by: Cuncong Zhong, University of Kansas, United States; João Marcelo Pereira Alves, University of São Paulo, Brazil; Julien Tremblay, National Research Council Canada (NRCCNRC), Canada</p>
      </fn>
      <corresp id="fn001">*Correspondence: Xiaoli Dong, <email xlink:href="mailto:xdong@ucalgary.ca" xlink:type="simple">xdong@ucalgary.ca</email></corresp>
      <fn fn-type="other" id="fn002">
        <p>This article was submitted to Bioinformatics and Computational Biology, a section of the journal Frontiers in Genetics</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>10</volume>
    <elocation-id>999</elocation-id>
    <history>
      <date date-type="received">
        <day>08</day>
        <month>4</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>9</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2019 Dong and Strous</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Dong and Strous</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Here, we describe MetaErg, a standalone and fully automated metagenome and metaproteome annotation pipeline. Annotation of metagenomes is challenging. First, metagenomes contain sequence data of many organisms from all domains of life. Second, many of these are from understudied lineages, encoding genes with low similarity to experimentally validated reference genes. Third, assembly and binning are not perfect, sometimes resulting in artifactual hybrid contigs or genomes. To address these challenges, MetaErg provides graphical summaries of annotation outcomes, both for the complete metagenome and for individual metagenome-assembled genomes (MAGs). It performs a comprehensive annotation of each gene, including taxonomic classification, enabling functional inferences despite low similarity to reference genes, as well as detection of potential assembly or binning artifacts. When provided with metaproteome information, it visualizes gene and pathway activity using sequencing coverage and proteomic spectral counts, respectively. For visualization, MetaErg provides an HTML interface, bringing all annotation results together, and producing sortable and searchable tables, collapsible trees, and other graphic representations enabling intuitive navigation of complex data. MetaErg, implemented in Perl, HTML, and JavaScript, is a fully open source application, distributed under Academic Free License at <uri xlink:type="simple" xlink:href="https://github.com/xiaoli-dong/metaerg">https://github.com/xiaoli-dong/metaerg</uri>. MetaErg is also available as a docker image at <uri xlink:type="simple" xlink:href="https://hub.docker.com/r/xiaolidong/docker-metaerg">https://hub.docker.com/r/xiaolidong/docker-metaerg</uri>.</p>
    </abstract>
    <kwd-group>
      <kwd>metagenomics</kwd>
      <kwd>metaproteomics</kwd>
      <kwd>bioinformatics</kwd>
      <kwd>gene prediction</kwd>
      <kwd>functional annotation</kwd>
      <kwd>taxonomic classification</kwd>
      <kwd>pathway prediction</kwd>
      <kwd>visualization</kwd>
    </kwd-group>
    <counts>
      <fig-count count="4"/>
      <table-count count="1"/>
      <equation-count count="0"/>
      <ref-count count="39"/>
      <page-count count="10"/>
      <word-count count="4401"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="s1">
    <title>Introduction</title>
    <p>Genome annotation is, literally, the annotation of features on assembled DNA molecules. Such features are, in the first place, genes, including those encoding proteins [“open reading frames” (ORFs)] and those encoding ribosomal or transfer RNA molecules. Annotation consists of the identification of such features and providing each feature with a meaningful list of hints about its possible biological function. Annotation is usually the final step of the automated computational processing of genomic or metagenomic data and the beginning of biology.</p>
    <p>Depending on their background and research question, biologists will have different annotation needs. For example, when the research targets a single microbe, detailed gene-by-gene annotation of its genome would be desired. On the other hand, when the research targets a complete ecosystem, a high level summary of the functional potential of the associated metagenome might be the aim. These examples also display a different starting point for annotation. In the first case, it may consist of a single, near-perfect whole genome sequence. In the second case, it may consist of many MAGs of varying quality, unbinned metagenomic contigs, or even billions of unassembled reads.</p>
    <p>What sets annotation apart from other computational steps in processing metagenomic data is that no benchmarks for annotation tools exist. That means that ranking these tools and objectively declaring a winner is not straightforward. The choice of the best annotation pipeline will depend on the data, the research question, the computational resources available, and the background of the researcher who needs to make sense of the annotation software’s hints and the way they are presented.</p>
    <p>In practice, options for genome annotation come in two flavors: online platforms and standalone pipelines. Examples of online platforms are IMG (<xref rid="B8" ref-type="bibr">Chen et al., 2017</xref>), MG-RAST (<xref rid="B19" ref-type="bibr">Keegan et al., 2016</xref>), MicroScope (<xref rid="B36" ref-type="bibr">Vallenet et al., 2017</xref>), Mgnify (<xref rid="B26" ref-type="bibr">Mitchell et al., 2018</xref>), and Edge (<xref rid="B25" ref-type="bibr">Li et al., 2017</xref>). When opting for a platform, you avoid the need for local computational infrastructure or tedious installation and updating of tools and databases, while benefiting from online collaboration abilities. The platform may provide accession numbers for sharing data after publication, as these platforms may also be data repositories.</p>
    <p>However, a platform might not offer the type of annotation needed for a specific research question or might be slower in the uptake of the latest selection of tools and databases. If such factors are important, opting for a standalone pipeline might be the way to go. Scientists who are fluent in scripting languages, such as Python or Perl, might even create their own pipeline from scratch. Examples of available standalone pipelines for annotation of assembled contigs, scaffolds, or whole genome sequences are Prokka (<xref rid="B31" ref-type="bibr">Seemann, 2014</xref>), DFAST-core (<xref rid="B34" ref-type="bibr">Tanizawa et al., 2018</xref>), and PGAP (<xref rid="B35" ref-type="bibr">Tatusova et al., 2016</xref>). Prokka is a very fast genome annotation pipeline. Its core concept is that some databases or tools provide better or more information than others. Once a gene is annotated with a positive “hit” to a good database, there is no need to perform additional searches. DFAST adds to this approach by using a faster similarity search tool (ghostx). It infers orthology assignments based on reciprocal-best-blast-hits between the query genome and a larger set of reference genomes, potentially including user-added custom reference genomes. It is thus especially useful to transfer annotations from a well-annotated reference genome. PGAP is used by the NCBI to annotate submitted whole genome sequences. It combines sophisticated gene prediction algorithms with gene assignments to its set of prokaryotic protein clusters (<xref rid="B21" ref-type="bibr">Klimke et al., 2009</xref>). As an institutional “gold standard” annotation, it emphasizes annotation standards and conventions, quality control, and due diligence during execution.</p>
    <p>Here, we present MetaErg, an extendable standalone annotation pipeline developed for metagenome-assembled genomes (MAGs). Genome-centric metagenome data provides three major challenges. The first is that assembly quality can be relatively poor, and some contamination of MAGs with “foreign” genes can be expected. This challenge is addressed by performing fast similarity searches against a much larger database than would be needed to simply infer functions, to classify each gene taxonomically. This enables detection of potentially artefactual, hybrid bins or contigs. The second is that the user will likely need to make sense of many annotated genomes simultaneously. This challenge is addressed by visualizing and summarizing data, to enable quick inferences about encoded biological functions and pathways. The third is that, for many environmental microorganisms, meaningful/close reference genomes are not yet available. This challenge is addressed by always providing comprehensive information about each gene, derived from different tools and databases, to assign functions as well as practically possible for genes with low similarity to reference genes.</p>
  </sec>
  <sec sec-type="materials|methods" id="s2">
    <title>Materials and Methods</title>
    <sec id="s2_1">
      <title>Program Implementation Overview</title>
      <p>MetaErg is an integrated and fully automated pipeline for annotating metagenome-assembled contigs. It integrates a number of open-source tools and its modular design allows for flexible workflows, addition of new functions, and easy refactoring. MetaErg’s implementation consists of five main modules (<xref ref-type="fig" rid="f1"><bold>Figure 1</bold></xref>), including a command-line interface, an input data preprocessing module for filtering and formatting input DNA sequences, a structural annotation module for predicting biological features and elements, a function annotation module for inferring gene functions and classifying rRNA genes and ORFs to taxonomic lineages, and a presentation module for presenting annotation results in various summary reports and for visualization using HTML and JavaScript.</p>
      <fig id="f1" position="float">
        <label>Figure 1</label>
        <caption>
          <p>MetaErg annotation workflow. The input file to MetaErg is a FASTA file that contains the assembled contigs.</p>
        </caption>
        <graphic xlink:href="fgene-10-00999-g001"/>
      </fig>
    </sec>
    <sec id="s2_2">
      <title>Command Line Interface</title>
      <p>MetaErg is a command line program, designed to run on a Linux server or cluster. It accepts a preassembled FASTA format DNA sequence file as the minimum required input. The default values for the optional parameters in the pipeline are optimized for metagenome analysis. Through a command-line interface, experienced users can interact with the program to customize the gene prediction and database searching parameters, enable or disable certain tools and functions, setup data filtering thresholds, and specify an output directory.</p>
    </sec>
    <sec id="s2_3">
      <title>Sequence Data Preprocessing</title>
      <p>Every input DNA sequence is inspected, validated, and reformatted before annotation. The sequence identifiers in the input file must be unique; otherwise, the input file will be rejected, and the annotation process will be terminated. Any ambiguous nucleotides in the input sequence file are replaced by N. Gaps (-) and pads (*) are removed. Sequences shorter than a user defined minimum length are removed.</p>
    </sec>
    <sec id="s2_4">
      <title>Structural Annotation</title>
      <p>MetaErg begins biological feature and element prediction by identifying CRISPR elements and noncoding RNA genes (tRNA, rRNA genes). Next, to avoid identification of artefactual protein coding genes overlapping with detected noncoding features, MetaErg masks these features by replacing them with Ns. Next, protein encoding genes are predicted. <xref ref-type="fig" rid="f1"><bold>Figure 1</bold></xref> shows the MetaErg workflow.</p>
      <p>The identification of CRISPR elements is achieved using MinCED (<xref rid="B32" ref-type="bibr">Skennerton, 2016</xref>) with default parameters. tRNA genes are predicted with the ARAGORN program (<xref rid="B24" ref-type="bibr">Laslett and Canback, 2004</xref>).</p>
      <p>Ribosomal RNA genes (5S, 5.8S, 16S, 18S, 23S, 28S) are identified and classified using rRNAFinder, an in-house tool package, which is included in the MetaErg release. rRNAFinder uses nhmmer (<xref rid="B37" ref-type="bibr">Wheeler and Eddy, 2013</xref>) to query locally built rRNA HMM profiles against the input contig sequences for detecting rRNA genes on the contigs. To build the rRNA HMM profiles, the “rfam.seed.gz” file was downloaded from the Rfam database (<xref rid="B15" ref-type="bibr">Kalvari et al., 2018</xref>). The FASTA-formatted rRNA gene alignments were extracted and written to separate files for each of the three domains of life (<italic>Bacteria, Archaea, Eukaryota</italic>), respectively. The alignment files for each domain were then used by the hmmbuild program in HMMER (<xref rid="B10" ref-type="bibr">Eddy, 2011</xref>) to create an rRNA gene HMM profile for the domain. Because a metagenome may contain rRNA sequences from all domains of life, in “metagenome” mode, rRNAFinder uses HMM models from all three domains of life. When multiple models yield hits to the same region, rRNAFinder outputs only the result of the model with the lowest <italic>E</italic>-value. When the <italic>E</italic>-value is the same for multiple hits, all best scoring predictions are kept. rRNAFinder uses blastn (<xref rid="B2" ref-type="bibr">Altschul et al., 1990</xref>) for classification of detected rRNA genes using the full-length SILVA SSU and LSU database (<xref rid="B30" ref-type="bibr">Quast et al., 2012</xref>). The standalone rRNAFinder tool is also freely available at <uri xlink:type="simple" xlink:href="https://github.com/xiaoli-dong/rRNAFinder">https://github.com/xiaoli-dong/rRNAFinder</uri>.</p>
      <p>Protein coding genes (ORFs) are predicted using Prodigal (<xref rid="B13" ref-type="bibr">Hyatt et al., 2010</xref>). ORFs shorter than 180 nucleotides are excluded from further analysis by default.</p>
    </sec>
    <sec id="s2_5">
      <title>Functional and Taxonomic Annotation</title>
      <p>Metagenome functional annotation is very similar to genomic annotation and relies on comparisons of predicted genes with existing, previously annotated sequences. The goal is to propagate accurate annotations to correctly identified orthologs (<xref rid="B23" ref-type="bibr">Kunin et al., 2008</xref>).</p>
      <p>Firstly, predicted ORFs are run through motif prediction tools. SignalP 5.0 (<xref rid="B1" ref-type="bibr">Armenteros et al., 2019</xref>) is run on all ORFs to predict the presence and absence of signal peptides and the location of their cleavage sites within an ORF. TMHMM (<xref rid="B22" ref-type="bibr">Krogh et al., 2001</xref>) is run on all ORFs to detect the transmembrane helices.</p>
      <p>MetaErg uses profile HMMs and blast-based searches to detect similarity. All ORFs are searched against different databases. All search results are combined to associate query genes with functional categories, protein domains, KEGG Orthology (KO) terms, Gene Ontology (GO) terms, Enzyme Commission (EC) numbers, and metabolic potentials and traits. In brief, ORFs are searched with HMMs from Pfam-A (<xref rid="B11" ref-type="bibr">Finn et al., 2014</xref>), TIGRFAM (<xref rid="B12" ref-type="bibr">Haft et al., 2013</xref>), FOAM (<xref rid="B29" ref-type="bibr">Prestat et al., 2014</xref>), Metabolic-hmm (Anantharaman et al., 2016), and casgenes.hmm (<xref rid="B6" ref-type="bibr">Burstein et al., 2016</xref>) using the hmmsearch tool. ORFs are also searched against the SwissProt (<xref rid="B4" ref-type="bibr">BBairoch and Apweiler, 2000</xref>) database using DIAMOND (<xref rid="B5" ref-type="bibr">Buchfink et al., 2014</xref>). ORFs without any search outcomes are annotated as “hypothetical protein”.</p>
      <p>MinPath (Minimal set of Pathways) was used to reconstruct metabolic pathways. MinPath minimizes parsimony and yields a conservative estimate of the biological pathways present in a query dataset (<xref rid="B39" ref-type="bibr">Ye and Doak, 2009</xref>). MetaErg uses MinPath to predict KEGG (<xref rid="B16" ref-type="bibr">Kanehisa and Goto, 2000</xref>) and MetaCyc (<xref rid="B18" ref-type="bibr">Karp et al., 2002</xref>) pathways. For predicting the minimal set of KEGG pathways that still explains the presence of the detected functional genes, an ORF-identifier-to-KO-number-mapping-file is provided as the input to MinPath. For inferring the list of MetaCyc pathways, an ORF-identifier-to-EC-number-mapping-file is provided as the input to MinPath. The mapping files are derived from the blast searches of the ORFs against the Swiss-Prot databases, as well as HMM searches against the FOAM and the TIGRFAMs database.</p>
      <p>MetaErg classifies all ORFs based on best DIAMOND hits against a custom database, GenomeDB. To build GenomeDB, the Genome Taxonomy Database (GTDB) gtdbtk_r89_data.tar.gz (<xref rid="B28" ref-type="bibr">Parks et al., 2018</xref>) was downloaded from <uri xlink:type="simple" xlink:href="https://data.ace.uq.edu.au/public/gtdb/data/releases/release89/89.0/">https://data.ace.uq.edu.au/public/gtdb/data/releases/release89/89.0/</uri>. Each genome included in GTDB was checked for presence in the NCBI RefSeq database. If present, the FASTA-formatted protein files were downloaded. Otherwise, the ORFs for the genome were predicted using Prodigal. The downloaded and locally predicted ORFs inherited their taxonomy from GTDB. To the GTDB data, only associated with <italic>Bacteria</italic> and <italic>Archaea</italic>, we added <italic>Eukaryota</italic> and viral data, by downloading the available NCBI RefSeq protein sequences of unicellular protozoa, fungi, plants (excluding <italic>Embryophyta</italic>), and viruses. The taxonomy of those proteins in GenomeDB was inherited from the NCBI records. For that, we inspected the assembly_summary.txt file, present in each NCBI RefSeq subdirectory (<uri xlink:type="simple" xlink:href="http://ftp://ftp.ncbi.nlm.nih.gov/genomes/refseq/">ftp://ftp.ncbi.nlm.nih.gov/genomes/refseq/</uri>), which associates each assembled genome with a “ftp_path” and a “species_taxid”. We retrieved the protein sequences of each available Eukaryote or viral genome by following “ftp_path”. The taxonomy of the protein sequences was obtained <italic>via</italic> “species_taxid”. This process was automated in a Perl script, enabling periodical updating of the database.</p>
      <p>With a user-supplied coverage file generated by mapping reads from each sample to the assembled contig sequences, MetaErg quantifies the relative abundance of organisms, functions, metabolic processes, and pathways in each sample by tracking the number of reads that map to each gene family or orthologous group. The coverage file, generated using “jgi_summarize_bam_contig_depths” from MetaBat (<xref rid="B17" ref-type="bibr">Kang et al., 2015</xref>), is a tab delimited text file and the example coverage file is available at <uri xlink:type="simple" xlink:href="https://github.com/xiaoli-dong/metaerg/blob/master/example/demo.depth.txt">https://github.com/xiaoli-dong/metaerg/blob/master/example/demo.depth.txt</uri>. With a user-supplied metaproteomics spectral count file, MetaErg quantifies the abundance (in the proteome) of each taxon, function, metabolic process, and pathway based on expressed genes included in the spectral counts file for each sample. The spectral count file is a tab-delimited text file. The first column of the file is the gene id and all the columns after are the normalized protein expression level. The example metaproteomics spectral count file is available at <uri xlink:type="simple" xlink:href="https://github.com/xiaoli-dong/metaerg/blob/master/example/demo.plevel.txt">https://github.com/xiaoli-dong/metaerg/blob/master/example/demo.plevel.txt</uri>.</p>
    </sec>
    <sec id="s2_6">
      <title>Output and Visualization</title>
      <p>MetaErg reports annotations at the individual gene, single genome, and community level. For each gene, it reports the taxonomic classification and functional annotations, GO terms, EC numbers, KO terms, and its association with a metabolic pathway. At the community or genome level, MetaErg presents the taxonomic composition, protein function profiles, metabolic process profiles, and metabolic pathway profiles. A MetaErg output demo page is available at <uri xlink:type="simple" xlink:href="https://xiaoli-dong.github.io/metaerg/">https://xiaoli-dong.github.io/metaerg/</uri>
</p>
      <p>To facilitate the exploration of complex metagenome annotation results and make sense of the data, MetaErg’s annotation reports are presented in various formats. The HTML result page (<xref ref-type="fig" rid="f2"><bold>Figure 2</bold></xref>) visually brings together text summaries, output data files, and accompanying visualizations. The interactive sortable and searchable gene, function, and profile tables, collapsible trees, sunburst hierarchical views of taxonomy and functional ontology, and other graphical representations, enable the effective interactive exploration, analysis, filtering, and intuitive navigation of complex metagenomic data (<xref ref-type="fig" rid="f3"><bold>Figure 3</bold></xref>).</p>
      <fig id="f2" position="float">
        <label>Figure 2</label>
        <caption>
          <p>MetaErg HTML result page visually links extensive analysis text summaries, result data files, and accompanying visualizations together.</p>
        </caption>
        <graphic xlink:href="fgene-10-00999-g002"/>
      </fig>
      <fig id="f3" position="float">
        <label>Figure 3</label>
        <caption>
          <p>A screenshot montage of MetaErg output showing an example of the interactive Pfam annotation profile table, a hierarchical metabolic process sunburst view, a taxonomic summary tree view, and a KEGG pathway map. In the KEGG pathway map, the KOs presented in the analyzed dataset were highlighted.</p>
        </caption>
        <graphic xlink:href="fgene-10-00999-g003"/>
      </fig>
      <p>The intermediate results, including those from feature predictions and similarity searches, are stored as files, which could be used to dig deeper into the data and validate the results later on. With the intermediate files in place, MetaErg will skip the steps used to generate them when the program is restarted with the same input parameters. This can greatly reduce the computational time when redoing the analysis.</p>
    </sec>
    <sec id="s2_7">
      <title>Generation of the Test Dataset</title>
      <p>The paired-end Illunima raw reads of three biological replicates of a mock community sample (<xref rid="B20" ref-type="bibr">Kleiner et al., 2017</xref>, NCBI SRA accession numbers ERR1877474, ERR1877474, and ERR1877476) were filtered using BBDuk from the BBTools suite (<xref rid="B7" ref-type="bibr">Bushnell, 2014</xref>). Briefly, each read was screened by reference and by kmer for Illumina adapters (options: tbo tpe k = 23 mink = 11 hdist = 1 ktrim = r) and for Phix (options: k = 31 hdist = 1) and quality trimmed and filtered (options: qtrim = rl trimq = 15 minlength = 30 entropy = 0.5). After cleaning, the remaining reads were merged using BBMerge with default settings. The resulting merged single-end reads and unmerged paired-end reads from three samples were co-assembled together using metaSpades (<xref rid="B27" ref-type="bibr">Nurk et al., 2017</xref>) with default settings. After assembling, contigs shorter than 500 bp were excluded from further analysis.</p>
      <p>Mapping of the quality-controlled reads from all three libraries back to the assembled contigs was preformed using BBMap with default settings. The depth coverage file “depth.txt” was generated using “jgi_summarize_bam_contig_depths” from MetaBat.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="s3">
    <title>Results</title>
    <p>To test MetaErg and determine the computational footprint, a MetaErg job was submitted to a Linux cluster node (56 threads, 256 GB RAM) with the assembled contigs from a mock community as the input. The mock community consisted of 25 species of <italic>Bacteria</italic>, 1 <italic>Archaeon</italic>, 1 <italic>Eukaryote</italic>, and 5 <italic>phages</italic> (<xref rid="B20" ref-type="bibr">Kleiner et al., 2017</xref>). Assembly with MetaSpades resulted in 4,576 contigs (N50 126,358 base pairs, 85,113,339 base pairs total). The MetaErg job took 2.12 h to complete. The total CPU time needed was 50.5 h. When prediction of signal peptides and transmembrane helixes was included (with options “–sp –tm”), the run time and CPU time increased to 3.7 and 56.2 h, respectively. The average memory usage was 3 GB with peaks up to 9.5 GB. The total disk space used for the analysis including the intermediate files was 6.1 GB and the total disk space used for the final results was 482 MB.</p>
    <p>The overall metagenome annotation predicted 20 CRISPR arrays, 878 tRNA genes, 70 rRNA genes (16S, 18S, 23S, 28S, 5S, 5.8S rRNA genes), and 80,407 ORFs. Of these, 48,723, 68,578, 22,001, 25,184, 475, and 437 ORFs were annotated with SwissProt, Pfam, TIGRFAM, FOAM, metabolic hmm, and casgene.hmm databases, respectively. Signal peptides were predicted for 1,480 ORFs and transmembrane helices were predicted for 18,766 ORFs. The relative abundances of taxa, functions, and pathways were nearly identical across all three biological replicates of the mock community.</p>
    <p>MetaBat binning of the contigs with default parameters produced 14 useful MAGs (&gt;70% completeness, &lt;5% contamination). MetaBat binned relatively few MAGs for this dataset, because the three available read sets were from replicate samples and were not useful for differential coverage based binning. The annotations for each MAG were extracted directly from the overall annotations using MetaErg’s utility scripts. The phylogenetic affiliations of MAGs were estimated according to the taxon assignments of ORFs and rRNA genes in the MAGs and visualized in the interactive HTML trees and sunburst hierarchical views. The HTML visualizations can help users visually validate the binning outcomes and identify chimeric MAGs or contamination with genes from other community members (<xref ref-type="fig" rid="f4"><bold>Figure 4</bold></xref>). Each gene from each MAG was assigned comprehensive information derived from different resources with different tools (<xref rid="T1" ref-type="table"><bold>Table 1</bold></xref>).</p>
    <fig id="f4" position="float">
      <label>Figure 4</label>
      <caption>
        <p>Taxonomy in hierarchical sunburst view. Each taxonomic rank is represented by one ring with the innermost circle representing the kingdom. From the inner to outer rings, the rings represent kingdom, phylum, class, order, family, genus, and species. The segmented areas on the ring are proportional to the relative abundance of the taxon. <bold>(A)</bold> Overall taxonomic distribution profile from all ORFs, which provides insight into the community taxonomic distribution as a whole; <bold>(B)</bold> An example of chimeric MAG, displaying contamination, and this MAG was 99.42% complete and 97.14% contaminated, as assessed by CheckM. The taxon classification profile was based on ORF taxonomic assignment from the MAG; <bold>(C)</bold> and <bold>(D)</bold> Examples of uncontaminated MAGs.</p>
      </caption>
      <graphic xlink:href="fgene-10-00999-g004"/>
    </fig>
    <table-wrap id="T1" position="float">
      <label>Table 1</label>
      <caption>
        <p>An example showing information associated with each protein coding gene after MetaErg analysis.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th valign="top" rowspan="1" colspan="1">TAG</th>
            <th valign="top" rowspan="1" colspan="1">Value</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td valign="top" rowspan="1" colspan="1">ID</td>
            <td valign="top" rowspan="1" colspan="1">mockEvenCell|17112</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">contigid</td>
            <td valign="top" rowspan="1" colspan="1">NODE_27_length_371703_cov_24.485093</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">allec_ids</td>
            <td valign="top" rowspan="1" colspan="1">7.1.1.-; 1.8.4.8</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">allko_ids</td>
            <td valign="top" rowspan="1" colspan="1">K00390; K00338;</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">allko_ontology</td>
            <td valign="top" rowspan="1" colspan="1">L1:18_Sulfur compounds metabolism;L2:Sulfur compounds cycle;L3:Sulfate reduction (assimilatory);L4:;</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">depth</td>
            <td valign="top" rowspan="1" colspan="1">82.0316;</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">foam_ecs</td>
            <td valign="top" rowspan="1" colspan="1">1.8.4.8;</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">foam_kos</td>
            <td valign="top" rowspan="1" colspan="1">K00390;</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">foam_target</td>
            <td valign="top" rowspan="1" colspan="1">db:FOAM-hmm_rel1a.hmm|HMMsoil748 63 117 evalue:2.5e-13 qcov:30.55 identity:40.00 score:41.9 seqT:47.9 name:KO:K00390_1.8.4.8;</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">genomedb_oc</td>
            <td valign="top" rowspan="1" colspan="1">d__Bacteria;p__Proteobacteria;c__Gammaproteobacteria;o__Betaproteobacteriales;f__Burkholderiaceae;g__Cupriavidus;</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">genomedb_target</td>
            <td valign="top" rowspan="1" colspan="1">db:genomedb|GCA_900185755.1|FYAX01000037.1_317 1 163 evalue:1.4e-89 qcov:100.00 identity:100.00;</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">pfam_desc</td>
            <td valign="top" rowspan="1" colspan="1">4Fe-4S binding domain;</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">pfam_id</td>
            <td valign="top" rowspan="1" colspan="1">Fer4;</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">pfam_target</td>
            <td valign="top" rowspan="1" colspan="1">db:Pfam-A.hmm|PF00037.27 61 80 evalue:2e-07 qcov:12.22 identity:55.00 score:24.1 seqT:53.6 name:Fer4; db:Pfam-A.hmm|PF00037.27 97 118 evalue:5.5e-11 qcov:13.44 identity:63.64 score:35.4 seqT:53.6 name:Fer4;</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">sport_desc</td>
            <td valign="top" rowspan="1" colspan="1">NADH-quinone oxidoreductase subunit I;</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">sprot_ec</td>
            <td valign="top" rowspan="1" colspan="1">7.1.1.-;</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">sport_go</td>
            <td valign="top" rowspan="1" colspan="1">GO:0005886;GO:0051539;GO:0005506;GO:0050136;GO:0048038;</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">sport_kos</td>
            <td valign="top" rowspan="1" colspan="1">K00338;</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">sport_target</td>
            <td valign="top" rowspan="1" colspan="1">db:uniprot_sprot|sp|Q1LPV5|NUOI_CUPMC 1 163 evalue:4.1e-65 qcov:100.00 identity:100.00;</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">tigrfam_go</td>
            <td valign="top" rowspan="1" colspan="1">GO:0050136;GO:0055114;</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">tigrfam_desc</td>
            <td valign="top" rowspan="1" colspan="1">NADH-quinone oxidoreductase, chain I;</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">tigrfam_id</td>
            <td valign="top" rowspan="1" colspan="1">NuoI;</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">tigrfam_mainrole</td>
            <td valign="top" rowspan="1" colspan="1">Energy metabolism;</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">tigrfam_sub1role</td>
            <td valign="top" rowspan="1" colspan="1">Electron transport;</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">tigrfam_target</td>
            <td valign="top" rowspan="1" colspan="1">db:TIGRFAMs.hmm|TIGR01971 20 141 evalue:2.1e-48 qcov:73.93 identity:52.46 score:152.8 seqT:153.0 name:TIGR01971;</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </sec>
  <sec sec-type="discussion" id="s4">
    <title>Discussion</title>
    <p>With MetaErg, we provide a standalone and fully automated metagenome and metaproteome annotation pipeline. Compared to other standalone annotation pipelines, such as Prokka (<xref rid="B31" ref-type="bibr">Seemann, 2014</xref>) and DFAST-core (<xref rid="B34" ref-type="bibr">Tanizawa et al., 2018</xref>), MetaErg requires much more time to run and requires more computational resources. However, these extra resources result in more comprehensive annotation and visualization. Taxonomic classification of each gene, provided by MetaErg, enables detection of potential assembly or binning artifacts, as shown in <xref ref-type="fig" rid="f4"><bold>Figure 4</bold></xref>. More comprehensive annotation enables better inferences about gene function for genes that are more dissimilar to validated reference genes. High level visualization of pathways, and integration of expression data, enables more effective navigation of the full complexity of a metagenome. Thus, MetaErg provides solutions to challenges specific to metagenomes, which come at a computational cost.</p>
    <p>Annotations are generated and visualized for the complete metagenome, as well as for each individual MAG. Depending on the research question, users can opt to only annotate a few selected MAGs. Alternatively, they could annotate the entire metagenome first and then use one of MetaErg’s utility scripts to extract annotations for each individual MAG. While the annotation of the complete metagenome provides insight into a community’s taxonomic composition and metabolic potential, analysis of an individual MAG presents this information for a single organism or population.</p>
    <p>Because of the size and density of information in metagenome analysis, exploration of the data presents an overwhelming task that often takes many years to complete (<xref rid="B9" ref-type="bibr">Devlin et al., 2018</xref>). To address that challenge, MetaErg produces annotation summary results in various formats. The interactive HTML interface brings all annotation results together in sortable and searchable tables, collapsible trees, and other graphic representations, enabling intuitive navigation of complex data.</p>
    <p>With typically massive metagenomic data, similarity-based functional analysis approaches usually suffer from excessive computation time. To address that, DIAMOND is used instead of BLASTP. Diamond is 500 to 20,000 times faster than Blast search tools with a similar degree of sensitivity. To overcome the computational bottleneck and to speed up the functional annotation process, the most time-consuming steps such as database searching in MetaErg are parallelized. Therefore, they run effectively on multicore processors.</p>
    <p>Due to the high diversity and large proportion of uncharacterized microbial taxa in most environmental habitats, many microorganisms from environmental samples have no close reference genomes available. While a blast-like tool can quickly identify very similar genes, more distantly related genes can be missed. A profile HMM-based strategy is better at finding more divergent matches and gains sensitivity by incorporating position-specific information into the alignment process and by quantifying variation at each sequence position (<xref rid="B33" ref-type="bibr">Skewes-Cox et al., 2014</xref>). MetaErg relies on both Blast and HMM databases (PFAM, TIGRAMs, Metabolic-hmm, casgenes.hmm, and FOAM). FOAM is a manually curated HMM database for identifying functional genes in environmental metagenomes and transcriptomes. Because FOAM was last updated in 2014, we are implementing the addition of UniRef as an alternative, for the next release of MetaErg. Gene annotations such as the EC number and KO number, currently provided by FOAM, could be retrieved from UniRef instead.</p>
    <p>SignalP and TMHMM are established signal peptide and transmembrane helix prediction tools. Phobius (<xref rid="B14" ref-type="bibr">Kall et al., 2004</xref>) is a combined transmembrane topology and signal peptide predictor. Phobius runs faster on the same dataset than SignalP and TMHMM. However, running Phobius on a 64-bit Linux system requires manually changing its source code before running, due to problems with the included decodeanhmm program. For that reason, we did not select Phobius as a dependency for MetaErg.</p>
    <p>Taxonomic classification of genes by similarity searches can be misleading because of the uneven representation of taxa in databases. This can lead to a bias towards highly sampled taxa (<xref rid="B23" ref-type="bibr">Kunin et al., 2008</xref>). In addition, with the growing size of the databases, searching all available sequence information becomes computationally challenging. To partially overcome this challenge and improve the classification of uncultured organisms, MetaErg classification databases were built based on GTDB, which provides a more even sampling across <italic>Bacteria</italic> and <italic>Archaea</italic>. Because microbial communities usually also comprise <italic>Eukaryotes</italic> and viruses, we have also added protein sequences of unicellular protozoa, fungi, plants (excluding <italic>Embryophyta</italic>), and viruses. Because MetaErg currently uses Prodigal for gene prediction, it is unable to correctly predict protein sequences of <italic>Eukaryotes</italic>. We are currently working on implementing workflows for better predictions of eukaryotic coding sequences, which will become part of the next version of MetaErg. Likewise, effective identification and analysis of viral contigs is currently still lacking and will become part of the next version.</p>
    <p>Although advances in metagenomics have enabled a better understanding of microbial phylogenetic and functional gene compositions in microbiomes, it is also desirable to know which genes are actually expressed. This could be visualized based on transcriptomics or proteomics data (<xref rid="B38" ref-type="bibr">White et al., 2016</xref>). Currently, MetaErg enables visualization of expression based on proteomics data only. Visualization of transcriptomics data is planned for a future release.</p>
    <p>In conclusion, MetaErg is an easy to use and robust metagenome analysis pipeline. It produces comprehensive analysis reports in various formats. The interactive visualizations help to ease the challenge in interpreting complex analysis results. MetaErg is fully open source and portable, available as a docker image, designed to run on moderately sized computational clusters. Its modular architecture enables addition of new functions. In the future, MetaErg will be expanded by adding new functionality focusing on identification and annotation of eukaryotic and viral MAGs, annotation and discovery of gene clusters encoding production of secondary metabolites, and visualization of transcriptomic data.</p>
  </sec>
  <sec sec-type="data-availability" id="s5">
    <title>Data Availability Statement</title>
    <p>Publicly available datasets were analyzed in this study. This data can be found here: <uri xlink:type="simple" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/?term=prjeb19901">https://www.ncbi.nlm.nih.gov/bioproject/?term=prjeb19901</uri>.</p>
  </sec>
  <sec id="s6">
    <title>Author Contributions</title>
    <p>MetaErg was conceived by XD and MS; XD implemented program with the input from MS; and XD and MS wrote the paper.</p>
  </sec>
  <sec sec-type="funding-information" id="s7">
    <title>Funding</title>
    <p>We acknowledge financial support from the Natural Sciences and Engineering Research Council of Canada (NSERC), the Canada Foundation for Innovation (CFI), the Canada First Research Excellence Fund (CFREF), Alberta Innovates, the Government of Alberta, Genome Canada, the University of Calgary, and the International Microbiome Center.</p>
  </sec>
  <sec id="s8">
    <title>Conflict of Interest</title>
    <p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>We thank Angela Kouris for proofreading this paper.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Armenteros</surname><given-names>J. J. A.</given-names></name><name><surname>Tsirigos</surname><given-names>K. D.</given-names></name><name><surname>Sønderby</surname><given-names>C. K.</given-names></name><name><surname>Petersen</surname><given-names>T. N.</given-names></name><name><surname>Winther</surname><given-names>O.</given-names></name><name><surname>Brunak</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2019</year>). <article-title>SignalP 5.0 improves signal peptide predictions using deep neural networks</article-title>. <source>Nat. Biotechnol.</source>
<volume>37</volume>, <fpage>420</fpage>–<lpage>423</lpage>. <pub-id pub-id-type="doi">10.1038/s41587-019-0036-z</pub-id>
<pub-id pub-id-type="pmid">30778233</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altschul</surname><given-names>S. F.</given-names></name><name><surname>Gish</surname><given-names>W.</given-names></name><name><surname>Miller</surname><given-names>W.</given-names></name><name><surname>Myers</surname><given-names>E. W.</given-names></name><name><surname>Lipman</surname><given-names>D. J.</given-names></name></person-group> (<year>1990</year>). <article-title>Basic local alignment search tool</article-title>. <source>J. Mol. Biol.</source>
<volume>215</volume>, <fpage>403</fpage>–<lpage>410</lpage>. <pub-id pub-id-type="doi">10.1016/S0022-2836(05)80360-2</pub-id>
<pub-id pub-id-type="pmid">2231712</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anantharaman</surname><given-names>K.</given-names></name><name><surname>Brown</surname><given-names>CT.</given-names></name><name><surname>Hug</surname><given-names>LA.</given-names></name><name><surname>Sharon</surname><given-names>I.</given-names></name><name><surname>Castelle</surname><given-names>CJ.</given-names></name><name><surname>Probst</surname><given-names>AJ.</given-names></name><etal/></person-group> (<year>2016</year>). <article-title>Thousands of microbial genomes shed light on interconnected biogeochemical processes in an aquifer system</article-title>. <source>Nat Commun.</source>
<volume>7</volume>:<fpage>13219</fpage>. <pub-id pub-id-type="doi">10.1038/ncomms13219.</pub-id>
<pub-id pub-id-type="pmid">27774985</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>BBairoch</surname><given-names>A.</given-names></name><name><surname>Apweiler</surname><given-names>R.</given-names></name></person-group> (<year>2000</year>). <article-title>The SWISS-PROT protein sequence database and its supplement TrEMBL in 2000</article-title>. <source>Nucleic Acids Res.</source>
<volume>28</volume> (<issue>1</issue>), <fpage>45</fpage>–<lpage>48</lpage>. <pub-id pub-id-type="doi">10.1093/nar/28.1.45</pub-id>
<pub-id pub-id-type="pmid">10592178</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buchfink</surname><given-names>B.</given-names></name><name><surname>Xie</surname><given-names>C.</given-names></name><name><surname>Huson</surname><given-names>D.H.</given-names></name></person-group> (<year>2014</year>). <article-title>Fast and sensitive protein alignment using DIAMOND</article-title>. <source>Nat. Methods</source>
<volume>12</volume> (<issue>59</issue>), <fpage>60</fpage>. <pub-id pub-id-type="doi">10.1038/nmeth.3176</pub-id>
</mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burstein</surname><given-names>D.</given-names></name><name><surname>Harrington</surname><given-names>L. B.</given-names></name><name><surname>Strutt</surname><given-names>S. C.</given-names></name><name><surname>Probst</surname><given-names>A. J.</given-names></name><name><surname>Anantharaman</surname><given-names>K.</given-names></name><name><surname>Thomas</surname><given-names>B. C.</given-names></name><etal/></person-group> (<year>2016</year>). <article-title>New CRISPR-Cas systems from uncultivated microbes</article-title>. <source>Nature</source>
<volume>542</volume> (<issue>7640</issue>), <fpage>237</fpage>–<lpage>241</lpage>. <pub-id pub-id-type="doi">10.1038/nature21059</pub-id>
<pub-id pub-id-type="pmid">28005056</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bushnell</surname><given-names>B.</given-names></name></person-group> (<year>2014</year>). <source>BBMap: a fast, accurate, splice-aware aligner</source>. (<publisher-loc>Berkeley, CA</publisher-loc>: <publisher-name>Ernest Orlando Lawrence Berkeley National Laboratory</publisher-name>).</mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>I. M. A.</given-names></name><name><surname>Markowitz</surname><given-names>V. M.</given-names></name><name><surname>Chu</surname><given-names>K.</given-names></name><name><surname>Palaniappan</surname><given-names>K.</given-names></name><name><surname>Szeto</surname><given-names>E.</given-names></name><name><surname>Pillay</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2017</year>). <article-title>IMG/M: integrated genome and metagenome comparative data analysis system</article-title>. <source>Nucleics Acids Res.</source>
<volume>45</volume>, <fpage>D507</fpage>–<lpage>D516</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkw929</pub-id>
</mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Devlin</surname><given-names>J. C.</given-names></name><name><surname>Battaglia</surname><given-names>T.</given-names></name><name><surname>Blaser</surname><given-names>M. J.</given-names></name><name><surname>Ruggles</surname><given-names>K. V.</given-names></name></person-group> (<year>2018</year>). <article-title>WHAM!: a web-based visualization suite for user-defined analysis of metagenomic shotgun sequencing data</article-title>. <source>BMC Genomics</source>
<volume>19</volume>, <fpage>493</fpage>. <pub-id pub-id-type="doi">10.1186/s12864-018-4870-z</pub-id>
<pub-id pub-id-type="pmid">29940835</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eddy</surname><given-names>S. R.</given-names></name></person-group> (<year>2011</year>). <article-title>Accelerated Profile HMM Searches</article-title>. <source>PLoS Comput. Biol.</source>
<volume>7</volume> (<issue>10</issue>), <elocation-id>e1002195</elocation-id>. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002195</pub-id>
<pub-id pub-id-type="pmid">22039361</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Finn</surname><given-names>R. D.</given-names></name><name><surname>Coggill</surname><given-names>P.</given-names></name><name><surname>Eberhardt</surname><given-names>R. Y.</given-names></name><name><surname>Eddy</surname><given-names>S. R.</given-names></name><name><surname>Mistry</surname><given-names>J.</given-names></name><name><surname>Mitchell</surname><given-names>A. L.</given-names></name><etal/></person-group> (<year>2014</year>). <article-title>Pfam: the protein families database : towards a more sustainable future</article-title>. <source>Nucleic Acids Res.</source>
<volume>44</volume>, <fpage>D279</fpage>–<lpage>D285</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkt1223</pub-id>
</mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haft</surname><given-names>D. H.</given-names></name><name><surname>Selengut</surname><given-names>J. D.</given-names></name><name><surname>Richter</surname><given-names>A. R.</given-names></name><name><surname>Harkins</surname><given-names>D.</given-names></name><name><surname>Basu</surname><given-names>M. K.</given-names></name><name><surname>Beck</surname><given-names>E.</given-names></name></person-group> (<year>2013</year>). <article-title>TIGRFAMs and Genome Properties in 2013</article-title>. <source>Nucleic Acids Res.</source>
<volume>41</volume>, <fpage>D387</fpage>–<lpage>D395</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gks1234</pub-id>
<pub-id pub-id-type="pmid">23197656</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hyatt</surname><given-names>D.</given-names></name><name><surname>Chen</surname><given-names>G. L.</given-names></name><name><surname>Locascio</surname><given-names>P. F.</given-names></name><name><surname>Land</surname><given-names>M. L.</given-names></name><name><surname>Larimer</surname><given-names>F. W.</given-names></name><name><surname>Hauser</surname><given-names>L. J.</given-names></name></person-group> (<year>2010</year>). <article-title>Prodigal: prokaryotic gene recognition and translation initiation site identification</article-title>. <source>BMC Bioinformatics</source>
<volume>11</volume>, <fpage>119</fpage>. <pub-id pub-id-type="doi">10.1186/1471-2105-11-119</pub-id>
<pub-id pub-id-type="pmid">20211023</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kall</surname><given-names>L.</given-names></name><name><surname>Krogh</surname><given-names>A.</given-names></name><name><surname>Sonnhammer</surname><given-names>E. L. L.</given-names></name></person-group> (<year>2004</year>). <article-title>A combined transmembrane topology and signal peptide prediction method</article-title>. <source>J. Mol. Biol.</source>
<volume>338</volume>, <fpage>1027</fpage>–<lpage>1036</lpage>. <pub-id pub-id-type="doi">10.1016/j.jmb.2004.03.016</pub-id>
<pub-id pub-id-type="pmid">15111065</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kalvari</surname><given-names>I.</given-names></name><name><surname>Argasinska</surname><given-names>J.</given-names></name><name><surname>Quinones-Olvera</surname><given-names>N.</given-names></name><name><surname>Nawrocki</surname><given-names>E. P.</given-names></name><name><surname>Rivas</surname><given-names>E.</given-names></name><name><surname>Eddy</surname><given-names>S. R.</given-names></name><etal/></person-group> (<year>2018</year>). <article-title>Rfam 13.0: shifting to a genome-centric resource for non-coding RNA families</article-title>. <source>Nucleic Acids Res.</source>
<volume>46</volume>, <fpage>D335</fpage>–<lpage>D342</lpage>, D1. <pub-id pub-id-type="doi">10.1093/nar/gkx1038</pub-id>
<pub-id pub-id-type="pmid">29112718</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kanehisa</surname><given-names>M.</given-names></name><name><surname>Goto</surname><given-names>S.</given-names></name></person-group> (<year>2000</year>). <article-title>KEGG: Kyoto Encyclopedia of Genes and Genomes</article-title>. <source>Nucleic Acids Res.</source>
<volume>28</volume> (<issue>1</issue>), <fpage>27</fpage>–<lpage>30</lpage>. <pub-id pub-id-type="doi">10.1093/nar/28.1.27</pub-id>
<pub-id pub-id-type="pmid">10592173</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kang</surname><given-names>D. D.</given-names></name><name><surname>Froula</surname><given-names>J.</given-names></name><name><surname>Egan</surname><given-names>R.</given-names></name><name><surname>Wang</surname><given-names>Z.</given-names></name></person-group> (<year>2015</year>). <article-title>MetaBAT, an efficient tool for accurately reconstructing single genomes from complex microbial communities</article-title>. <source>PeerJ</source>
<volume>3</volume>, <elocation-id>e1165</elocation-id>. <pub-id pub-id-type="doi">10.7717/peerj.1165</pub-id>
<pub-id pub-id-type="pmid">26336640</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karp</surname><given-names>P. D.</given-names></name><name><surname>Riley</surname><given-names>M.</given-names></name><name><surname>Paley</surname><given-names>S. M.</given-names></name><name><surname>Pellegrini-Toole</surname><given-names>A.</given-names></name></person-group> (<year>2002</year>). <article-title>The MetaCyc Database</article-title>. <source>Nucleic Acids Res.</source>
<volume>30</volume> (<issue>1</issue>), <fpage>59</fpage>–<lpage>61</lpage>. <pub-id pub-id-type="doi">10.1093/nar/30.1.59</pub-id>
<pub-id pub-id-type="pmid">11752254</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Keegan</surname><given-names>K. P.</given-names></name><name><surname>Glass</surname><given-names>E. M.</given-names></name><name><surname>Meyer</surname><given-names>F.</given-names></name></person-group> (<year>2016</year>). “<article-title>MG-RAST, a metagenomics service for analysis of microbial community structure and function</article-title>,” in <source>Microbial Environmental Genomics (MEG)</source>. Eds. <person-group person-group-type="editor"><name><surname>Martin</surname><given-names>F.</given-names></name><name><surname>Uroz</surname><given-names>S.</given-names></name></person-group> (<publisher-loc>New York, NY</publisher-loc>: <publisher-name>Humana Press</publisher-name>), <fpage>207</fpage>–<lpage>233</lpage>. <pub-id pub-id-type="doi">10.1007/978-1-4939-3369-3_13</pub-id>
</mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kleiner</surname><given-names>M.</given-names></name><name><surname>Thorson</surname><given-names>E.</given-names></name><name><surname>Sharp</surname><given-names>C. E.</given-names></name><name><surname>Dong</surname><given-names>X.</given-names></name><name><surname>Liu</surname><given-names>D.</given-names></name><name><surname>Li</surname><given-names>C.</given-names></name><etal/></person-group> (<year>2017</year>). <article-title>Assessing species biomass contributions in microbial communities <italic>via</italic> metaproteomics</article-title>. <source>Nat. Commun.</source>
<volume>8</volume> (<issue>1</issue>), <fpage>1558</fpage>. <pub-id pub-id-type="doi">10.1038/s41467-017-01544-x</pub-id>
<pub-id pub-id-type="pmid">29146960</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klimke</surname><given-names>W.</given-names></name><name><surname>Agarwala</surname><given-names>R.</given-names></name><name><surname>Badretdin</surname><given-names>A.</given-names></name><name><surname>Chetvernin</surname><given-names>S.</given-names></name><name><surname>Ciufo</surname><given-names>S.</given-names></name><name><surname>Fedorov</surname><given-names>B.</given-names></name><etal/></person-group> (<year>2009</year>). <article-title>The National Center for Biotechnology Information’s Protein Clusters Database</article-title>. <source>Nucleic Acids Res.</source>
<volume>37</volume>, <fpage>D216</fpage>–<lpage>D223</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkn734</pub-id>
<pub-id pub-id-type="pmid">18940865</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krogh</surname><given-names>A.</given-names></name><name><surname>Larsson</surname><given-names>B.</given-names></name><name><surname>von Heijne</surname><given-names>G.</given-names></name><name><surname>Sonnhammer</surname><given-names>E. L.</given-names></name></person-group> (<year>2001</year>). <article-title>Predicting transmembrane protein topology with a hidden Markov model: application to complete genomes</article-title>. <source>J. Mol. Biol.</source>
<volume>305</volume>, <fpage>567</fpage>–<lpage>580</lpage>. <pub-id pub-id-type="doi">10.1006/jmbi.2000.4315</pub-id>
<pub-id pub-id-type="pmid">11152613</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kunin</surname><given-names>V.</given-names></name><name><surname>Copeland</surname><given-names>A.</given-names></name><name><surname>Lapidus</surname><given-names>A.</given-names></name><name><surname>Mavromatis</surname><given-names>K.</given-names></name><name><surname>Hugenholtz</surname><given-names>P.</given-names></name></person-group> (<year>2008</year>). <article-title>A bioinformatician’s guide to metagenomics</article-title>. <source>Microbiol. Mol. Biol. Rev.</source>
<volume>72</volume>, <fpage>557</fpage>–<lpage>578</lpage>. <pub-id pub-id-type="doi">10.1128/MMBR.00009-08</pub-id>
<pub-id pub-id-type="pmid">19052320</pub-id></mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laslett</surname><given-names>D.</given-names></name><name><surname>Canback</surname><given-names>B.</given-names></name></person-group> (<year>2004</year>). <article-title>ARAGORN, a program to detect tRNA genes and tmRNA genes in nucleotide sequences</article-title>. <source>Nucleic Acids Res.</source>
<volume>32</volume>, <fpage>11</fpage>–<lpage>16</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkh152</pub-id>
<pub-id pub-id-type="pmid">14704338</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>P. E.</given-names></name><name><surname>Lo</surname><given-names>C. C.</given-names></name><name><surname>Anderson</surname><given-names>J. J.</given-names></name><name><surname>Davenport</surname><given-names>K. W.</given-names></name><name><surname>Bishop-Lilly</surname><given-names>K. A.</given-names></name><name><surname>Xu</surname><given-names>Y.</given-names></name><etal/></person-group> (<year>2017</year>). <article-title>Enabling the democratization of the genomics revolution with a fully integrated web-based bioinformatics platform</article-title>. <source>Nucleics Acids Res.</source>
<volume>45</volume> (<issue>1</issue>), <fpage>67</fpage>–<lpage>80</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkw1027</pub-id>
</mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mitchell</surname><given-names>A. L.</given-names></name><name><surname>Scheremetjew</surname><given-names>M.</given-names></name><name><surname>Denise</surname><given-names>H.</given-names></name><name><surname>Potter</surname><given-names>S.</given-names></name><name><surname>Tarkowska</surname><given-names>A.</given-names></name><name><surname>Qureshi</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2018</year>). <article-title>EBI Metagenomics in 2018: enriching the analysis of microbial communities, from sequence reads to assemblies</article-title>. <source>Nucleics Acids Res.</source>
<volume>46</volume>, <fpage>D526</fpage>–<lpage>D735</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkx967</pub-id>
</mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nurk</surname><given-names>S.</given-names></name><name><surname>Meleshko</surname><given-names>D.</given-names></name><name><surname>Korobeynikov</surname><given-names>A.</given-names></name><name><surname>Pevzner</surname><given-names>P. A.</given-names></name></person-group> (<year>2017</year>). <article-title>metaSPAdes: a new versatile metagenomic assembler</article-title>. <source>Genome Res.</source>
<volume>27</volume> (<issue>5</issue>), <fpage>824</fpage>–<lpage>834</lpage>. <pub-id pub-id-type="doi">10.1101/gr.213959.116</pub-id>
<pub-id pub-id-type="pmid">28298430</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parks</surname><given-names>D. H.</given-names></name><name><surname>Chuvochina</surname><given-names>M.</given-names></name><name><surname>Waite</surname><given-names>D. W.</given-names></name><name><surname>Rinke</surname><given-names>C.</given-names></name><name><surname>Skarshewski</surname><given-names>A.</given-names></name><name><surname>Chaumeil</surname><given-names>P. A.</given-names></name><etal/></person-group> (<year>2018</year>). <article-title>A standardized bacterial taxonomy based on genome phylogeny substantially revises the tree of life</article-title>. <source>Nat. Biotechnol.</source>
<volume>36</volume>, <fpage>996</fpage>–<lpage>1004</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.4229</pub-id>
<pub-id pub-id-type="pmid">30148503</pub-id></mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Prestat</surname><given-names>E.</given-names></name><name><surname>David</surname><given-names>M. M.</given-names></name><name><surname>Hultman</surname><given-names>J.</given-names></name><name><surname>Tas</surname><given-names>N.</given-names></name><name><surname>Lamendella</surname><given-names>R.</given-names></name><name><surname>Dvornik</surname><given-names>J.</given-names></name><etal/></person-group> (<year>2014</year>). <article-title>FOAM (Functional Ontology Assignments for Metagenomes): a Hidden Markov Model (HMM) database with environmental focus</article-title>. <source>Nucleic Acids Res.</source>
<volume>42</volume>:<elocation-id>e145</elocation-id> (<issue>19</issue>). <pub-id pub-id-type="doi">10.1093/nar/gku702</pub-id>
<pub-id pub-id-type="pmid">25260589</pub-id></mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quast</surname><given-names>C.</given-names></name><name><surname>Pruesse</surname><given-names>E.</given-names></name><name><surname>Yilmaz</surname><given-names>P.</given-names></name><name><surname>Gerken</surname><given-names>J.</given-names></name><name><surname>Schweer</surname><given-names>T.</given-names></name><name><surname>Yarza</surname><given-names>P.</given-names></name><etal/></person-group> (<year>2012</year>). <article-title>The SILVA ribosomal RNA gene database project: improved data processing and web-based tools</article-title>. <source>Nucleic Acids Res.</source>
<volume>41</volume> (<issue>Database issue</issue>), <fpage>D590</fpage>–<lpage>D596</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gks1219</pub-id>
<pub-id pub-id-type="pmid">23193283</pub-id></mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seemann</surname><given-names>T.</given-names></name></person-group> (<year>2014</year>). <article-title>Prokka: rapid prokaryotic genome annotation</article-title>. <source>Bioinformatics</source>
<volume>14</volume> (<issue>15</issue>), <fpage>2068</fpage>–<lpage>2069</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btu153</pub-id>
</mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="webpage"><person-group person-group-type="author"><name><surname>Skennerton</surname><given-names>C.</given-names></name></person-group> (<year>2016</year>). [27 May 2016]. <article-title>Minced—mining CRISPRs in environmental datasets</article-title>. <uri xlink:type="simple" xlink:href="https://github.com/ctSkennerton/minced">https://github.com/ctSkennerton/minced</uri>.</mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skewes-Cox</surname><given-names>P.</given-names></name><name><surname>Sharpton</surname><given-names>T. J.</given-names></name><name><surname>Pollard</surname><given-names>K. S.</given-names></name><name><surname>DeRisi</surname><given-names>J. L.</given-names></name></person-group> (<year>2014</year>). <article-title>Profile hidden Markov models for the detection of viruses within metagenomic sequence data</article-title>. <source>PLoS ONE</source>
<volume>9</volume>, <elocation-id>e105067</elocation-id>. <pub-id pub-id-type="doi">10.1371/journal.pone.0105067</pub-id>
<pub-id pub-id-type="pmid">25140992</pub-id></mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tanizawa</surname><given-names>Y.</given-names></name><name><surname>Fujisawa</surname><given-names>T.</given-names></name><name><surname>Nakamura</surname><given-names>Y.</given-names></name></person-group> (<year>2018</year>). <article-title>DFAST: a flexible prokaryotic genome annotation pipeline for faster genome publication</article-title>. <source>Bioinformatics</source>
<volume>34</volume> (<issue>6</issue>), <fpage>1037</fpage>–<lpage>1039</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btx713</pub-id>
<pub-id pub-id-type="pmid">29106469</pub-id></mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tatusova</surname><given-names>T.</given-names></name><name><surname>DiCuccio</surname><given-names>M.</given-names></name><name><surname>Badretdin</surname><given-names>A.</given-names></name><name><surname>Chetvernin</surname><given-names>V.</given-names></name><name><surname>Nawrocki</surname><given-names>E. P.</given-names></name><name><surname>Zaslavsky</surname><given-names>L.</given-names></name><etal/></person-group> (<year>2016</year>). <article-title>NCBI prokaryotic genome annotation pipeline</article-title>. <source>Nucleics Acids Res.</source>
<volume>44</volume> (<issue>14</issue>), <fpage>6614</fpage>–<lpage>6624</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkw569</pub-id>
</mixed-citation>
    </ref>
    <ref id="B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vallenet</surname><given-names>D.</given-names></name><name><surname>Calteau</surname><given-names>A.</given-names></name><name><surname>Cruveiller</surname><given-names>S.</given-names></name><name><surname>Gachet</surname><given-names>M.</given-names></name><name><surname>Lajus</surname><given-names>A.</given-names></name><name><surname>Josso</surname><given-names>A.</given-names></name><etal/></person-group> (<year>2017</year>). <article-title>MicroScope in 2017: an expanding and evolving integrated resource for community expertise of microbial genomes</article-title>. <source>Nucleics Acids Res.</source>
<volume>45</volume>, <fpage>D517</fpage>–<lpage>D528</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkw1101</pub-id>
</mixed-citation>
    </ref>
    <ref id="B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wheeler</surname><given-names>T. J.</given-names></name><name><surname>Eddy</surname><given-names>S. R.</given-names></name></person-group> (<year>2013</year>). <article-title>nhmmer: DNA homology search with profile HMMs</article-title>. <source>Bioinformatics</source>
<volume>29</volume>, <fpage>2487</fpage>–<lpage>2489</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btt403</pub-id>
<pub-id pub-id-type="pmid">23842809</pub-id></mixed-citation>
    </ref>
    <ref id="B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>White</surname><given-names>R. A.</given-names></name><name><surname>Callister</surname><given-names>S. J.</given-names></name><name><surname>Moore</surname><given-names>R. J.</given-names></name><name><surname>Baker</surname><given-names>E. S.</given-names></name><name><surname>Jansson</surname><given-names>J. K.</given-names></name></person-group> (<year>2016</year>). <article-title>The past, present and future of microbiome analyses</article-title>. <source>Nat. Protoc.</source>
<volume>11</volume>, <fpage>2049</fpage>–<lpage>2053</lpage> . <pub-id pub-id-type="doi">10.1038/nprot.2016.148</pub-id>
</mixed-citation>
    </ref>
    <ref id="B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ye</surname><given-names>Y.</given-names></name><name><surname>Doak</surname><given-names>T. G.</given-names></name></person-group> (<year>2009</year>). <article-title>A parsimony approach to biological pathway reconstruction/inference for genomes and metagenomes</article-title>. <source>PLoS Comput. Biol.</source>
<volume>5</volume>, <elocation-id>e1000465</elocation-id>. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000465</pub-id>
<pub-id pub-id-type="pmid">19680427</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
