<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Gigascience</journal-id>
    <journal-id journal-id-type="iso-abbrev">Gigascience</journal-id>
    <journal-id journal-id-type="publisher-id">gigascience</journal-id>
    <journal-title-group>
      <journal-title>GigaScience</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2047-217X</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8239664</article-id>
    <article-id pub-id-type="pmid">34184051</article-id>
    <article-id pub-id-type="doi">10.1093/gigascience/giab047</article-id>
    <article-id pub-id-type="publisher-id">giab047</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Technical Note</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00960</subject>
        <subject>AcademicSubjects/SCI02254</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>BIGwas: Single-command quality control and association testing for multi-cohort and biobank-scale GWAS/PheWAS data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7840-1160</contrib-id>
        <name>
          <surname>Kässens</surname>
          <given-names>Jan Christian</given-names>
        </name>
        <!--janchristian.kaessens@uksh.de-->
        <aff><institution>Institute of Clinical Molecular Biology, Christian-Albrechts-University of Kiel</institution>, Rosalind-Franklin-Str. 12, 24105 Kiel, <country country="DE">Germany</country></aff>
        <aff><institution>Haematology Lab Kiel, Klinik für Innere Medizin II, University Hospital Schleswig-Holstein</institution>, Langer Segen 8-10, 24105 Kiel, <country country="DE">Germany</country></aff>
        <xref rid="cor1" ref-type="corresp"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wienbrandt</surname>
          <given-names>Lars</given-names>
        </name>
        <aff><institution>Institute of Clinical Molecular Biology, Christian-Albrechts-University of Kiel</institution>, Rosalind-Franklin-Str. 12, 24105 Kiel, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4332-6110</contrib-id>
        <name>
          <surname>Ellinghaus</surname>
          <given-names>David</given-names>
        </name>
        <!--d.ellinghaus@ikmb.uni-kiel.de-->
        <aff><institution>Institute of Clinical Molecular Biology, Christian-Albrechts-University of Kiel</institution>, Rosalind-Franklin-Str. 12, 24105 Kiel, <country country="DE">Germany</country></aff>
        <aff><institution>Novo Nordisk Foundation Center for Protein Research</institution>, Disease Systems Biology, Faculty of Health and Medical Sciences, University of Copenhagen, Blegdamsvej 3b, 2200 Copenhagen, <country country="DK">Denmark</country></aff>
        <xref rid="cor2" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="cor1">Correspondence address. Jan Christian Kässens. E-mail: <email>janchristian.kaessens@uksh.de</email></corresp>
      <corresp id="cor2">Correspondence address. David Ellinghaus. E-mail: <email>d.ellinghaus@ikmb.uni-kiel.de</email></corresp>
    </author-notes>
    <pub-date pub-type="epub" iso-8601-date="2021-06-29">
      <day>29</day>
      <month>6</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>6</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>6</month>
      <year>2021</year>
    </pub-date>
    <volume>10</volume>
    <issue>6</issue>
    <elocation-id>giab047</elocation-id>
    <history>
      <date date-type="received">
        <day>08</day>
        <month>12</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>02</day>
        <month>4</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>09</day>
        <month>6</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press GigaScience.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab047.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="abs1">
        <title>Background</title>
        <p>Genome-wide association studies (GWAS) and phenome-wide association studies (PheWAS) involving 1 million GWAS samples from dozens of population-based biobanks present a considerable computational challenge and are carried out by large scientific groups under great expenditure of time and personnel. Automating these processes requires highly efficient and scalable methods and software, but so far there is no workflow solution to easily process 1 million GWAS samples.</p>
      </sec>
      <sec id="abs2">
        <title>Results</title>
        <p>Here we present BIGwas, a portable, fully automated quality control and association testing pipeline for large-scale binary and quantitative trait GWAS data provided by biobank resources. By using Nextflow workflow and Singularity software container technology, BIGwas performs resource-efficient and reproducible analyses on a local computer or any high-performance compute (HPC) system with just 1 command, with no need to manually install a software execution environment or various software packages. For a single-command GWAS analysis with 974,818 individuals and 92 million genetic markers, BIGwas takes ∼16 days on a small HPC system with only 7 compute nodes to perform a complete GWAS QC and association analysis protocol. Our dynamic parallelization approach enables shorter runtimes for large HPCs.</p>
      </sec>
      <sec id="abs3">
        <title>Conclusions</title>
        <p>Researchers without extensive bioinformatics knowledge and with few computer resources can use BIGwas to perform multi-cohort GWAS with 1 million GWAS samples and, if desired, use it to build their own (genome-wide) PheWAS resource. BIGwas is freely available for download from <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://github.com/ikmb/gwas-qc" ext-link-type="uri">http://github.com/ikmb/gwas-qc</ext-link> and <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://github.com/ikmb/gwas-assoc" ext-link-type="uri">http://github.com/ikmb/gwas-assoc</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group kwd-group-type="keywords">
      <kwd>GWAS</kwd>
      <kwd>PheWAS</kwd>
      <kwd>biobank</kwd>
      <kwd>quality control</kwd>
      <kwd>association testing</kwd>
      <kwd>pipeline</kwd>
      <kwd>Nextflow</kwd>
      <kwd>Singularity</kwd>
      <kwd>scalability</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>BMBF</institution>
            <institution-id institution-id-type="DOI">10.13039/501100002347</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>031L0165</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>DFG</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001659</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>EXC2167’</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="12"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="sec1">
    <title>Introduction</title>
    <p>Genome-wide association studies (GWAS), in which millions of genetic variants are tested across the genomes of study individuals to identify genotype-phenotype associations, have revolutionized the field of complex disease genetics over the past 10 years. Decreasing costs of genome-wide genotyping with single-nucleotide polymorphism (SNP) arrays allow routine collection of GWAS data from deeply phenotyped biobank population cohorts, where many clinical features can be assessed beyond disease status. For this reason, it is possible to conduct GWAS studies with &gt;1 million samples [<xref rid="bib1" ref-type="bibr">1</xref>] using GWAS data from large biobanks such as the UK Biobank (UKB) [<xref rid="bib2" ref-type="bibr">2</xref>] or the US Million Veterans Program [<xref rid="bib3" ref-type="bibr">3</xref>]. This further allows phenome-wide association studies (PheWAS) to be conducted to systematically study the effects of 1 or many genetic variants over a wide range of human phenotypes. GWAS/PheWAS analyses with &gt;1 million GWAS samples from dozens of biobanks enable, for example, rapid screening for target genes for therapeutic interventions for COVID-19 patients in the current pandemic [<xref rid="bib43_1624048014083" ref-type="bibr">4</xref>]. However, while efficient software pipelines, such as PheWeb [<xref rid="bib4" ref-type="bibr">5</xref>], for visualization, navigation, and sharing of results of large-scale GWAS and PheWAS projects have been developed recently, there are still no easily executable and reproducible software pipelines available for performing large-scale quality control (QC) and association tests on a large number of individual (large-scale) GWAS or PheWAS data sets with 1 million GWAS samples. In particular, parallel and consistent processing and analysis of dozens of individual GWAS cohorts in the context of a mega-GWAS analysis is enormously time-consuming and can quickly become unmanageable if processed manually.</p>
    <p>For basic GWAS QC and association analysis, software programs such as PLINK2 [<xref rid="bib5" ref-type="bibr">6</xref>] can efficiently process and analyse whole-genome genotype data. Owing to its broad functionality and efficient binary file format, PLINK2 is commonly used, along with self-written R and Bash scripts for visualization and further processing of files and results. To facilitate the execution and chaining of numerous PLINK commands and R programs, several data-processing packages for GWAS analysis have been developed in R [<xref rid="bib6" ref-type="bibr">7</xref>,<xref rid="bib7" ref-type="bibr">8</xref>] or other scripting languages [<xref rid="bib8" ref-type="bibr">9</xref>]. In addition, software environments such as RICOPILI [<xref rid="bib9" ref-type="bibr">10</xref>] or Odyssey [<xref rid="bib10" ref-type="bibr">11</xref>] have been developed with advanced online manuals that bundle many Unix, Awk, Perl, and/or PLINK2 commands for QC and association analysis. However, familiarization with these environments is usually time-consuming and is complicated by the fact that the user must perform a large number of installation steps for their own working environment and/or modify and manually execute a collection of Bash and R scripts in specific directories. Odyssey, for example, supports the use of software containers but lacks high-performance compute (HPC) support and thus the scalability for large GWAS data sets. Recently, the portable and reproducible GWAS QC and association testing software pipeline H3Agwas (currently version 3) has been developed by Baichoo and colleagues from the Pan-African community project H3ABioNet [<xref rid="bib11" ref-type="bibr">12</xref>], which takes the input and output data from various QC and association testing automatically through several computationally intensive processing steps. These workflows have been generated for processing small GWAS data sets but were not recommended for processing data sets with &gt;50,000 GWAS samples. To our knowledge, there is no portable (i.e., container-based) QC and association software pipeline that (i) can be executed with a single command without manual pre-installation, (ii) does not require reading and executing long online tutorials, and (iii) can efficiently and quickly process 1 million GWAS samples as provided by large-scale GWAS/PheWAS biobank projects.</p>
    <p>We developed BIGwas, a fast and efficient platform-independent software pipeline for QC and association testing of large-scale GWAS/PheWAS data sets, which automatically processes 1 million GWAS samples. By using Nextflow workflow technology  [<xref rid="bib14" ref-type="bibr">13</xref>] in combination with Singularity software container technology [<xref rid="bib15" ref-type="bibr">14</xref>] (Methods), BIGwas can be started with a single command (Fig. <xref rid="fig1" ref-type="fig">1</xref>), with no need to manually install a full software execution environment or various software packages. BIGwas implements a variety of best-practice QC and GWAS mega-analysis protocols (see Methods) developed by the Inflammatory Bowel Disease Genetics Consortium [<xref rid="bib16" ref-type="bibr">15–17</xref>] and the Severe Covid-19 GWAS Group [<xref rid="bib19" ref-type="bibr">18</xref>]. The development of our container-based and reproducible biobank-scale GWAS/PheWAS software pipeline was further motivated by current large-scale GWAS and PheWAS screening projects, such as the UKB GWAS/PheWAS project of Benjamin Neale and colleagues (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.nealelab.is/uk-biobank/" ext-link-type="uri">http://www.nealelab.is/uk-biobank/</ext-link>) or the Michigan Genomics PheWeb Initiative (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://pheweb.sph.umich.edu/about" ext-link-type="uri">http://pheweb.sph.umich.edu/about</ext-link>) in which GWAS analyses are performed for thousands of human traits with large GWAS data sets from UKB and the Michigan Genomics Initiative. The current PheWeb instance of the Michigan Genomics Initiative displays UKB summary statistics of 28 million genetic markers assessed across 1,403 binary traits for 408,961 white British participants [<xref rid="bib20" ref-type="bibr">19</xref>]. In these projects, the underlying QC and GWAS/PheWAS association analyses for thousands of traits run on large HPCs for several months or even years and are performed by large scientific working groups under great expenditure of time and personnel. To create a (genome-wide) PheWAS resource of this type, BIGwas can be used alongside the QC and mega-GWAS analysis capability to test for association with a wide variety of traits in parallel or sequentially (requiring only 1 single program call per trait on an HPC) when numerous different phenotype information is available for the same individuals.</p>
    <fig position="float" id="fig1">
      <label>Figure 1:</label>
      <caption>
        <p>Overview of the single-command quality control and association testing workflow of BIGwas. Multiple GWAS data sets in PLINK format from any genotyping platform can be used as input for the Quality Control (QC) Module. Both the QC Module and the Association Testing Module can be started and executed with a single command. The genotype output files of QC Module in VCF format can be used directly as input for genotype imputation programs such as the TOPMed Imputation Server [<xref rid="bib12" ref-type="bibr">20</xref>]. The VCF output files of the imputation process can be used directly as input for the Association Testing Module, which implements logistic/linear regression and mixed model association testing using PLINK [<xref rid="bib5" ref-type="bibr">6</xref>] and SAIGE [<xref rid="bib13" ref-type="bibr">21</xref>].</p>
      </caption>
      <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab047fig1" position="float"/>
    </fig>
    <p>BIGwas comprises 2 different modules, namely, the Quality Control (QC) Module and the Association Testing Module, that are part of a typical GWAS workflow (Fig. <xref rid="fig1" ref-type="fig">1</xref>). While the QC module uses user-supplied GWAS data sets in the widely adopted PLINK binary format, the Association Testing Module also allows input formats such as VCF (variant call format) that are usually delivered by genotype imputation servers, as with the TOPMed Imputation Server [<xref rid="bib12" ref-type="bibr">20</xref>]. We compared the performance of BIGwas with the H3Agwas Pipeline Version 3 in terms of runtime and functionality because H3Agwas is currently the only portable pipeline for reproducible GWAS that can be installed from a single source and started with just a few commands. To perform the benchmarks, we used both small (≤20,000 GWAS samples) as well as large GWAS data sets (≤1 million GWAS samples), including the current genotyped and imputed GWAS releases of UKB (September 2020) for COVID-19 case-control association analysis.</p>
  </sec>
  <sec sec-type="methods" id="sec2">
    <title>Methods</title>
    <sec id="sec2-1">
      <title>Quality control module</title>
      <p>The QC module works for binary as well as quantitative traits and is subdivided into 5 distinct phases: Pre-QC, SNP QC I, Sample QC, SNP QC II, and Final Analysis and Report Generation. For a QC based on quantitative traits, in the PLINK input Fam file, only the sixth column must be specified as a quantitative trait. In Pre-QC, an unlimited number of input GWAS data sets (batches) in PLINK format from different Affymetrix and Illumina platforms are, among other steps, matched with known variant databases from dbSNP and currently 140 Illumina/Affymetrix GWAS platforms and then brought to the same marker content. SNP QC I primarily filters variants on the basis of missingness and Hardy-Weinberg equilibrium (HWE; in controls only) across and within batches (i.e., genotype files or self-defined batches) as well as batches from a particular phenotype and the entire control group with a user-defined false discovery rate (FDR) threshold, allowing for differences in sample size between batches. The Sample QC removes samples based, among others, on missingness, increased or decreased heterozygosity rates, duplicate/relatedness testing (identity-by-state [IBS] and identity-by-descent [IBD] estimation), and population structure analysis/Tracy-Widom statistics, with or without projection on reference samples from HapMap and the 1000 Genomes Project. SNP QC II filtering steps include testing for differential missingness between phenotypes and controls, monomorphic sites, and significantly different allele frequencies of variants across the batches from a particular phenotype or the control group while correcting for population structure or ancestry via analysis of variance (ANOVA), with a user-defined FDR threshold. Finally, all information gathered throughout the QC pipeline is written to a single PDF report (see Fig. <xref rid="fig2" ref-type="fig">2</xref>). In principle, the QC module can be used for any European and non-European population. However, for the special case of an intended trans-ancestry GWAS study (e.g., to analyse GWAS samples of European, Asian, and African descent), we recommend that a separate QC be performed for each ethnic group.</p>
      <fig position="float" id="fig2">
        <label>Figure 2:</label>
        <caption>
          <p>Workflow graph of the Quality Control (QC) Module of BIGwas, with the default number of threads used in each process (for details see Methods). <italic toggle="yes">n</italic> denotes that the number of parallel jobs or threads automatically scales with the number of samples in the data set.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab047fig2" position="float"/>
      </fig>
    </sec>
    <sec id="sec2-2">
      <title>Pre-QC</title>
      <p>In large-scale consortium-based GWAS with dozens of GWAS input data sets collected from different gentoyping centers it is useful to apply SNP and sample QC metrics across and within genotyping batches for the identification of potential batch effects. For this task and the subsequent merging of data sets from the same genotyping platforms, all genetic variants are annotated in the same way. This includes the mapping to a genome build, the naming of variants as provided by the dbSNP databases, and the strand alignment. The Pre-QC phase brings all input data sets to a common annotation that is suitable for merging.</p>
      <sec id="sec2-2-1">
        <title>Individual annotations</title>
        <p>A batch affiliation can be defined independently from a single GWAS batch using the annotations file. In this file, separate batch identifiers can be assigned for the genotyping batch, country of origin, and diagnosis (if non-control). Each of these identifiers will be used in principal component (PC) plots, histograms, and ANOVA tests to identify batch effects within input data sets.</p>
      </sec>
      <sec id="sec2-2-2">
        <title>Assignment of variants to pseudo-autosomal regions</title>
        <p>The first step consists of checking and assigning variants to the pseudo-autosomal regions (PARs, which are inherited just like autosomal chromosomes) on chromosomes X and Y, as defined by genomic positions in the current genome builds. The genomic annotation of the PAR region has undergone a series of changes throughout different PLINK versions. In earlier versions, PLINK stored both PAR1 and PAR2 variants separate from the X (23) and Y (24) chromosomes, namely, in a virtual chromosome 25, while newer PLINK versions use alphanumerical chromosome codes such as PAR1 and PAR2. Because not every tool is aware of these changes, they are often mixed up in chromosomes 23, 24, 25, or all of them. The Pre-QC phase consistently moves both PAR1 and PAR2 variants back into chromosome 25 according to the coordinates published by the Genome Reference Consortium for GRCh37 [<xref rid="bib21" ref-type="bibr">22</xref>]; after the QC, chromosome 25 variants are moved back to chr23 for the generation of the separate imputation VCF input files because this is required by the TOPMed Imputation Server (see section on VCF output). If a data set presents heterozygous calls for males outside the PAR1/PAR2 regions and, hence, belongs to the non-PAR regions on chromosomes X or Y, heterozygous genotype calls for males are likely to be sequencing errors and will be set to “missing." The QC Module does not perform a check between self-reported and genetically determined biological sex based on chromosome X PLINK genotypes; we recommend using normalized signal intensities of SNPs on chromosome X as well as Y for this purpose.</p>
      </sec>
      <sec id="sec2-2-3">
        <title>Automatic chip type and variant annotation detection</title>
        <p>Because many GWAS platforms (microarray or chip type) have specific properties and exhibit potential biases, it is crucial for the QC to know the exact chip type from which the data set was generated. This step helps in identifying the chip type by matching chromosome IDs, variant IDs, base-pair positions, and alleles of variants from PLINK’s bim files against a set of currently 140 original GWAS platform content information files (called strand files) provided by Illumina and Affymetrix [<xref rid="bib22" ref-type="bibr">23</xref>]. The results of the chip detection step are expressed as match rates (in percentages) and can be used to verify not only the true chip type but also whether variant identifiers and/or the string information have already been manipulated by the user. Our current chip detection database contains 140 different chip types (including genome builds 37, 38, and partially 36), resulting in 415 chip versions that can be detected. The strand files are processed by a configurable number of threads (per default 2 threads only), where each thread processes a strand file as follows: first, every file entry (i.e., variant) of PLINK’s bim file is matched against the strand file using variant ID, positition, and alleles. After the final variant match, a composite match rate is calculated to assess how well a particular strand file (or chip type) matches the annotation in the bim file. After each string file is processed, the list of chip matches is sorted by a weighting formula, with <italic toggle="yes">m</italic> denoting the respective match rate:
<disp-formula><tex-math id="M1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{eqnarray*}
m_{\text {sort}} = m_{\text {ID}}\cdot m_{\text {pos}} \cdot \mathrm{max}\left \{ m_{\text {orig}\_ {\text {stand}}} , m_{\text {plus}\_ {\text {stand}}}\right \}.
\end{eqnarray*}$$\end{document}</tex-math></disp-formula></p>
        <p>It is often the case that variants are converted to the plus strand before QC. To make the match sorting robust, both the allele match rate for the original strand definitions and the allele match rate for the plus strand will be calculated. The strand files are then sorted by <italic toggle="yes">m</italic><sub>sort</sub> and can be used later for an optional genome build liftover process (non-hg19 data and liftover to hg19). If the bim files match the plus strand better than the original strand information, a note is displayed in the PDF report. For performance reasons, the detection software has been written in the Rust programming language and is also available as a separate application (see Section Availability of Source Code and Requirements).</p>
      </sec>
      <sec id="sec2-2-4">
        <title>Automatic genome build liftover of genomic coordinates</title>
        <p>Currently, the QC pipeline only supports data on genome build 19 (or GRCh37). If input data are in a different format, e.g., hg18 (GRCh36) or hg38 (GRCh38), the liftover step can be explicitly enabled to perform an automatic liftover to hg19. If the chip type is known beforehand or from the automatic chip type detection step (see above), a liftover request can be set in the data set configuration file. A genome build conversion is often accompanied by the loss of some variants when variants in the target build are split into ≥2 variants or merged into 1. This may cause unmappable or duplicate variants that will subsequently be removed from the data set. A warning will be displayed in the PDF report if a liftover is requested and more than a pre-defined number of variants are lost due to this step (defaults to 10 %).</p>
      </sec>
      <sec id="sec2-2-5">
        <title>Matching of variant identifiers with external databases</title>
        <p>Different GWAS platforms often use different variant identifiers for the same variants. In this step, variant identifiers from PLINK’s bim files are matched against a variant database containing identifiers of the Haplotype Reference Consortium (HRC) 1.1 reference panel [<xref rid="bib23" ref-type="bibr">24</xref>], the UK10k cohort [<xref rid="bib24" ref-type="bibr">25</xref>], the 1000 Genomes Phase 3 Project [<xref rid="bib25" ref-type="bibr">26</xref>], and the db150 variant database [<xref rid="bib26" ref-type="bibr">27</xref>]. If a single unique match is found, the respective variant name is retrieved and the original name replaced. In case the variant alleles match the strand complement of the reported alleles in the database, the variant is scheduled for strand alignment in a later step. Some genomic positions are covered by &gt;1 variant, i.e., deletions that span multiple positions and overlap with SNPs, so that it is not clear which variant is to be assigned. In these cases, the name is set to the chr:pos format, e.g., 1:554127. If no match could be found in the database, the original variant name is retained and prefixed with “unk_" to indicate that neither name, position, alleles, nor strand alignment could be verified, which is often the case if the content is custom chip content. Variants with different names but same position and same alleles are classified as duplicates and 1 of the duplicates is discarded afterwards.</p>
      </sec>
    </sec>
    <sec id="sec2-3">
      <title>SNP QC I</title>
      <p>During SNP QC I, the prepared data sets, which were pre-processed in parallel in the pre-QC phase, are merged into a single data set and filtered by missingness and HWE (in controls only) across all batches as well as single batches from a particular phenotype and the control group. DeFinetti diagrams [<xref rid="bib27" ref-type="bibr">28</xref>] are created before and after SNP QC I to verify the quality of variants visually.</p>
      <sec id="sec2-3-1">
        <title>Merge step</title>
        <p>If several input data sets have been defined, they are merged into a single PLINK data set. However, the samples will still be analysed taking into account the previously defined batches.</p>
      </sec>
      <sec id="sec2-3-2">
        <title>Missingness</title>
        <p>Variants with a high genotyping error rate or which are only present in a subset of the data sets may now be discarded on the basis of variant missingness. Variant missingness is calculcated across all batches as well as single batches. The default missing call rate thresholds are 0.1 and 0.02, respectively. If desired, these can be reconfigured by the user.</p>
      </sec>
      <sec id="sec2-3-3">
        <title>Tests for Hardy-Weinberg equilibrium</title>
        <p>HWE tests are performed for controls only in a case-control study (and for all individuals if a quantitative trait is to be considered). HWE tests are performed for all variants from the autosomes (chromosomes 1–22) and the PARs. For women, the complete chromosome X is also tested if available. Per default, variants deviating from HWE (with an FDR threshold of 10<sup>−5</sup> in controls per default) across the entire batch collection with at most 1 batch being removed or falling below the FDR threshold in 2 single control batches are excluded. Batch-wise <italic toggle="yes">P</italic>-values are reported to find variants that fail HWE, among others, in a single control batch (but not in other control batches), in ≥2 control batches, and in the whole collection of controls. Because this version of HWE testing is a computationally intensive task, the data set is divided into small pieces of 1,000 variants each, which are then processed in parallel if the surrounding compute environment allows it (e.g., on an HPC cluster). Diagrams are also generated showing how many variants are removed in each specific case; if desired, the user can adjust the threshold parameters using these diagrams.</p>
      </sec>
    </sec>
    <sec id="sec2-4">
      <title>Sample QC</title>
      <p>After SNP QC I, several sample QC measures will be calculated to identify samples showing a high variant missingness rate or an increased or decreased heterozygosity rate, to identify duplicate and related samples and to examine potential population substructure or batch effects by means of principal component analysis (PCA) and Tracy-Widom statistics, with reference samples from HapMap and the 1000 Genomes Project.</p>
      <sec id="sec2-4-1">
        <title>Individual missingness and heterozygosity</title>
        <p>In this step, a list of sample outliers is generated through a series of computations that determine the sample missingness of each data set and the sample-wise heterozygosity rates across all variants. For the former characteristic, the PLINK tool is run to generate a summary statistic of the genotyping rates per individual sample. Per default, samples that have a missing rate of ≥0.02 are removed. If desired, the user can adjust this threshold. The heterozygosity is determined with a second PLINK call, comparing the expected homozygosity rate with the observed homozygosity rate. Samples with a heterozygosity rate of ±5 × standard deviation are classified as outliers. A scatter plot of the proportion called missing (x-axis) against the proportion of SNPs called heterozygote (y-axis) for each individual in the study is generated.</p>
      </sec>
      <sec id="sec2-4-2">
        <title>Controlling for population stratification and other confounders</title>
        <p>The most common method for identifying (and subsequently removing) individuals with large-scale differences in ancestry is PCA. To resolve within-Europe relationships (the default) and to test for population stratification, all samples are projected onto PC axes generated from 4 intercontinental HapMap populations as well as 26 reference populations from the 1000 Genomes Project using FlashPCA [<xref rid="bib28" ref-type="bibr">29</xref>]. The distribution of cases and controls is displayed along the first 10 PCs stratified by phenotype. Individual GWAS samples (grey crosses) with values smaller than the median ±5 times the interquartile range (median ±5 × IQR; samples outside the red square in PCA plot) represent PCA outliers for the first 2 PCs and are automatically removed (the default; adjustable). All remaining samples (without PCA outliers) are projected onto PS axes generated from 26 reference populations from the 1000 Genomes Project again. Samples are also visualized without reference population samples using FlashPCA, with samples colored by batch code, and the distribution of cases and controls is displayed along the first 10 PCs stratified by phenotype. Tracy-Widom statistics [<xref rid="bib29" ref-type="bibr">30</xref>] are further computed with EIGENSOFT/EIGENSTRAT (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://scicrunch.org/resolver/RRID:SCR_001357" ext-link-type="uri">RRID:SCR_001357</ext-link>) [<xref rid="bib30" ref-type="bibr">31</xref>] to evaluate the statistical significance of each PC identified by PCA and to decide which top axes of variation are significant and should be used as covariates in association analyses. For each PCA, a set of independent (minor allele frequency [MAF] &gt;0.05) SNPs is calculated, excluding non-autosomes, variants in linkage disequilibrium (LD) (leaving no pairs with <italic toggle="yes">r</italic><sup>2</sup> &gt; 0.2, within 50-kb windows) or within the extended major histocompatibility complex (xMHC; chr6:25-34Mb), and 11 high-LD regions as described by Price et al. [<xref rid="bib31" ref-type="bibr">32</xref>]. PCA plots with and without A/T and G/C SNPs are created to reveal potential undetected strand problems.</p>
        <p>Population codes from the 1000 Genomes Project are as follows: African; Ad Mixed American; East Asian; EUR, European; SAS, South Asian; CHB, Han Chinese in Bejing, China; JPT, Japanese in Tokyo, Japan; CHS, Southern Han Chinese; CDX, Chinese Dai in Xishuangbanna, China; KHV, Kinh in Ho Chi Minh City, Vietnam; CEU, Utah Residents (CEPH) with Northern and Western Ancestry; TSI, Toscani in Italy; FIN, Finnish in Finland; GBR, British in England and Scotland; IBS, Iberian Population in Spain; YRI, Yoruba in Ibadan, Nigeria; LWK, Luhya in Webuye, Kenya; GWD, Gambia; MSL, Mende in Sierra Leone; ESN, Esan in Nigeria; ASW, Americans of African Ancestry in SW USA; ACB, African Caribbeans in Barbados; MXL, Mexican Ancestry from Los Angeles, CA, USA; PUR, Puerto Ricans from Puerto Rico; CLM, Colombians from Medellin, Colombia; PEL, Peruvians from Lima, Peru; GIH, Gujarati Indian from Houston, TX, USA; PJL, Punjabi from Lahore, Pakistan; BEB, Bengali from Bangladesh; STU, Sri Lankan Tamil from the UK; ITU, Indian Telugu from the UK.</p>
      </sec>
      <sec id="sec2-4-3">
        <title>Duplicate/relatedness detection</title>
        <p>For robust duplicate/relatedness testing (identity-by-state [IBS] and IBD estimation), we use the same set of independent variants, which was dynamically determined for PCA analysis (see above). Pairwise percentage IBD values were computed from a pruned subset of independent SNPs (see above) using PLINK. By definition, <inline-formula><tex-math id="M2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$P(\mathrm{IBD} = 0) + P(\mathrm{IBD} = 1) + P(\mathrm{IBD} = 2) = 1$\end{document}</tex-math></inline-formula>and <inline-formula><tex-math id="M3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{\pi }:= P(\mathrm{IBD} = 2) + 0.5 \cdot P(\mathrm{IBD} = 1)$\end{document}</tex-math></inline-formula> (proportion IBD). The expectation is that IBD = 1 for duplicates or monozygotic twins, IBD = 0.5 for first-degree relatives, IBD = 0.25 for second-degree relatives, and IBD = 0.125 for third-degree relatives. Owing to genotyping error, LD, and population structure, there is often some variation around these theoretical values and it is typical to remove 1 individual from each pair with an IBD value of &gt;0.1875, which is halfway between the expected IBD for third- and second-degree relatives. For these reasons an IBD value of &gt;0.98 identifies duplicates (adapted from [<xref rid="bib16" ref-type="bibr">15</xref>]). One individual (the one showing greater missingness) from each pair with <inline-formula><tex-math id="M4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{\pi }\gt 0.1875$\end{document}</tex-math></inline-formula> is flagged in output files or is removed.</p>
        <p>For kinship detection, by definition, every possible pair of samples is analysed. The expected runtime is therefore quadratic with respect to the number of samples. With recent data sets growing past 500,000 samples, such as the UKB Data Release [<xref rid="bib2" ref-type="bibr">2</xref>], this becomes a computationally intensive task, almost impossible to process on a single computer in an acceptable time frame. Our pipeline software automatically splits the workload and distributes the individual tasks to the available compute nodes in an HPC environment, if available, to process biobank-scale data. With the current, user-configurable scaling settings and assuming that all split jobs can be run in parallel, the kinship detection would only take as much time as a 2,000-sample data set would take, even for large sample databases.</p>
      </sec>
    </sec>
    <sec id="sec2-5">
      <title>SNP QC II</title>
      <p>After Sample QC, a few final SNP QC measures are calculated to identify variants where batches within a phenotype and the control group have different allele frequencies even after correction for potential population substructure and variants that show significantly different missingness between cases from the same phenotype and controls.</p>
      <sec id="sec2-5-1">
        <title>ANOVA Test</title>
        <p>Significantly different allele frequencies of variants across the batches from a particular phenotype or the control group due to batch effects can be detected via ANOVA that adjusts for potential population structure from PCA analysis. This tests for difference in the mean allele frequencies (after correcting for population stratification) across different batches from a particular disease or the control group. First, allele dosages are regressed against top PCs from PCA and residuals were obtained. <italic toggle="yes">P</italic>-values are calculated from the ANOVA between the residuals of the genotypes and the batches. The null hypothesis is that all groups from a particular disease or from the group are simply random samples of the same population. Variants that have significantly different allele frequencies across the batches (with allowing a single batch to be removed) within phenotypic sets with an FDR threshold of 0.01 (the default) are removed. Robust detection of outlier variants is only possible with the availability of several different batches for the same diagnosis. Hence, this step is only performed if there is ≥1 defined diagnosis with ≥5 batches.</p>
      </sec>
      <sec id="sec2-5-2">
        <title>Differential missingness</title>
        <p>Given a case/control phenotype, the task is to detect platform/batch differences between case and control genotype data that may lead to false-positive signals in association analysis. A Fisher exact test on case/control missing call counts at each variant will be performed. Any variant that comes up as highly significant under this test (<italic toggle="yes">P</italic> ≤ 10<sup>−15</sup> per default) should be treated with great caution and will be excluded.</p>
      </sec>
    </sec>
    <sec id="sec2-6">
      <title>Final analysis and report generation</title>
      <p>In this stage, the final quality controlled output has been generated as no more variants or samples will be removed on the basis of quality metrics. To visualize the changes resulting from the removal of variant and sample outliers, a summary based on several PCA plots is generated.</p>
      <sec id="sec2-6-1">
        <title>Variant call format output</title>
        <p>The quality controlled GWAS data set is also converted to VCF so that it can be used as input for genotype imputation and association testing tools. Data sets are converted to the VCF 4.2 format [<xref rid="bib32" ref-type="bibr">33</xref>] and split to chromosome-wise files as expected by many imputation tools such as the TOPMed Imputation Server [<xref rid="bib12" ref-type="bibr">20</xref>].</p>
      </sec>
      <sec id="sec2-6-2">
        <title>Automatic liftover to hg38 (optional)</title>
        <p>The final VCF files are currently based on genome build hg19. Services such as the TOPMed imputation server [<xref rid="bib12" ref-type="bibr">20</xref>] automatically convert VCF files to hg38, making it difficult to merge post-imputation data with pre-imputation data sets prepared in hg19. Optionally, the conversion to hg38 can be performed automatically by the pipeline using the UCSC liftOver Tools [<xref rid="bib33" ref-type="bibr">34</xref>]. Owing to licensing issues, the UCSC liftover tools [<xref rid="bib34" ref-type="bibr">35</xref>] are not directly included in our implementation but can be easily connected to our established UCSC liftover interface with a few steps. The same set of VCF files as for hg19 is generated in hg38 to facilitate the use of downstream imputation and association testing toolchains.</p>
      </sec>
      <sec id="sec2-6-3">
        <title>PDF report generation</title>
        <p>Many other pipeline tools that provide GWAS QC include a number of program log files and other logs from which the number and IDs of removed variants and samples must be extracted for a final report. This can be a laborious and error-prone process. In our software, we introduce the automatic generation of a sophisticated PDF report that visualizes all changes and analysis of input data sets in plots and tables within a well-structured, single PDF document. A large collection of figures and tables before and after the QC are arranged side by side to allow easy verification of the results. Using the Nextflow engine, all process executions are further recorded in a single trace file. Our reporting software parses this trace file into an “execution tree," where all generated files, such as log files, program output, and graphics, can be accessed directly by their task name. A collection of custom parsers then uses the execution tree to create a template in the LaTeX typesetting language, which is finally compiled into a PDF file. A working LaTeX installation is not required because all necessary software is included in the accompanied Singularity image.</p>
      </sec>
    </sec>
    <sec id="sec2-7">
      <title>Association testing module</title>
      <p>Association analysis in GWAS/PheWAS is used to identify variants and regions of the genome associated with the phenotype of interest or to examine variants of special interest for their impact on a large collection of phenotypes. The most used software tools for single-variant association analysis are PLINK [<xref rid="bib5" ref-type="bibr">6</xref>] and SAIGE [<xref rid="bib13" ref-type="bibr">21</xref>], among others. Logistic/linear regression as implemented in PLINK is the de facto gold standard for association analysis, with logistic/linear mixed models as implemented in SAIGE now being the new standard for biobank-scale GWAS and PheWAS. The Association Testing Module allows association analysis for binary and quantitative traits with PLINK and SAIGE on both imputed and non-imputed GWAS data sets on different genome builds, both with and without covariates, including chromosome X analysis, combined in a single command. For quantitative traits, the user has to set the parameter “-trait" to “quantitative” instead of “binary” (the default). In this case, PLINK as well as SAIGE will then automatically perform an association analysis for a quantitative trait. All processes, including conversion steps, are largely processed in parallel, so that each GWAS association analysis for each phenotype can be accomplished by a single run (see Fig. <xref rid="fig3" ref-type="fig">3</xref>).</p>
      <fig position="float" id="fig3">
        <label>Figure 3:</label>
        <caption>
          <p>Workflow graph of the Association Testing Module of BIGwas, with default number of threads used in each process (for details see Methods). For example, association analysis is parallelized over a fixed number of chromosomes (×24). <italic toggle="yes">m</italic> denotes that the number of threads linearly scales with the number of variants. PCA: principal component analysis; SPA: saddle point approximation to calibrate unbalanced case-control ratios (see Methods).</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab047fig3" position="float"/>
      </fig>
    </sec>
    <sec id="sec2-8">
      <title>Data preparation</title>
      <p>No further genotype data preparation step is required if the input data set, a set of chromosome-wise VCF files (optionally including chromsome X), is obtained either from the QC Module or from genotype imputation programs such as the TOPMed Imputation Server and contains dosage and/or genotype information. VCF files must have a DS tag for dosage data or a GT tag for genotyped data. If both are present, DS is chosen.</p>
    </sec>
    <sec id="sec2-9">
      <title>Sample selection, covariate preparation, and null model building for SAIGE</title>
      <p>To select a desired subset of samples for association analysis, an optional PLINK FAM file to update sex information and case-control status can be specified, and an optional covariate file if covariate adjustment is desired. In this case only the joint set of samples from the sample list of the VCF and the optional FAM file (and the optional covariate file) is used for model building (in SAIGE) and association analysis; no further modification of the VCF input files is necessary. For model building in SAIGE using saddle point approximation (SPA) [<xref rid="bib13" ref-type="bibr">21</xref>] to calibrate unbalanced case-control ratios, the null logistic/linear mixed model is fitted on the basis of a set of independent variants (see section Controlling for population stratification and other confounders, Methods), with all independent variants also having an imputation quality score of <italic toggle="yes">r</italic><sup>2</sup> ≥ 0.8 (threshold configurable). With the same set of independent variants PCA analysis is performed using FlashPCA2 [<xref rid="bib28" ref-type="bibr">29</xref>] to calculate top PCs (default n = 10) to adjust for potential population stratification.</p>
    </sec>
    <sec id="sec2-10">
      <title>PLINK association testing</title>
      <p>PLINK’s logistic/linear regression association module requires a custom text-based file with genotype dosage information (genotype probability format), which is generated on the fly from imputed or non-imputed VCF input files. Genotype dosage–based association analysis is conducted with the top PCs (default n = 10) from PCA and user-defined optional covariates from the covariate file. For chromosome X association analysis, haplotypic allele calls outside the PAR regions in males are converted to homozygous calls by doubling the haplotypic allele (assuming inactivation of large parts of 1 of the 2 female X chromosomes [<xref rid="bib35" ref-type="bibr">36</xref>]), and sex is used as a covariate for association testing of the non-PAR regions on chromosome X.</p>
    </sec>
    <sec id="sec2-11">
      <title>SAIGE association testing</title>
      <p>One of the main features of SAIGE is its ability to perform single-marker association testing for extremely unbalanced case-control ratios and rare variants [<xref rid="bib13" ref-type="bibr">21</xref>]. While SAIGE’s computational load is comparable to logistic or linear regression as performed by PLINK, SAIGE can directly read compressed VCF files typically generated from genotype imputation programs, including imputed dosage data and genotype-only calls, and further supports the memory-efficient BGEN format as used in the UK Biobank imputed data releases. SAIGE allows much finer control on parallelization by allowing the association analysis on specified genomic parts of a VCF/BGEN without the need to cut the file into smaller chunks. This technique saves not only runtime that would otherwise be consumed by splitting up VCF files but also large amounts of temporary file storage and I/O load. Because no extra computational load is required for splitting of chromosomal files, the scalability of how many jobs can be executed in parallel is only limited by the available computational resources, and the overhead is very low with respect to the chunk size of the genomic parts. Using only a subsample of all samples from VCF input files is not yet supported by SAIGE. For this reason, we have written a routine that automatically extracts a subsample from the VCF files based on a user-defined PLINK FAM file before starting the analysis with SAIGE. Association analysis with SAIGE (mixed-effect model + covariates) is conducted using the top PCs (default n = 10) from PCA and user-defined optional covariates from the covariate file. The same chromsome X analysis method used by PLINK is performed in SAIGE.</p>
    </sec>
    <sec id="sec2-12">
      <title>Compatibility with UK Biobank data</title>
      <p>The UKB’s latest GWAS data release contains, in addition to unimputed genotype data in PLINK format, pre-imputed data in the BGEN format instead of the much more common VCF format. However, most computational procedures of the Association Testing Module, especially the conversion routines that convert VCF files to PLINK’s genotype dosage format, heavily rely on the VCF format specification. BGEN, while much more efficient than VCF, is a binary format that is not designed to be processed by scripts and, as such, cannot directly be processed into PLINK’s genotype dosage format. Because the more common VCF format is a generic format used by biobanks and genotype imputation programs (TOPMed and Sanger Imputation server  [<xref rid="bib12" ref-type="bibr">20</xref>], among others) worldwide, we chose to drop BGEN support and therefore, in addition to SAIGE, can still keep PLINK as a de facto gold standard tool for regression-based association analysis in our association testing workflow.</p>
      <p>However, we included a set of scripts to perform SAIGE association testing on UKB BGEN files. This “pipeline” is a feature-reduced version that only performs the absolutely necessary steps to run SAIGE on the input data but uses the same fine-grained parallelization techniques as used in the SAIGE/PLINK VCF-based pipeline. External covariates, such as PCs, sex, and age, can be extracted from UKB sample information databases and supplied to the association testing process.</p>
    </sec>
    <sec id="sec2-13">
      <title>Implementation details</title>
      <p>We use the free and open-source Nextflow [<xref rid="bib14" ref-type="bibr">13</xref>] pipeline software for easy parallelization of processes, HPC-based development, and pipeline control. Singularity, a container format and software focused on scientific computation and reproducibility, is used to provide a single-command experience without the need to install an entire software execution environment of different software packages.</p>
    </sec>
    <sec id="sec2-14">
      <title>Nextflow</title>
      <p>While both the QC Control Module and the Association Testing Module are on the same level of runtime performance as comparable GWAS pipelines that analyse a smaller number of samples and variants (cf. Tables <xref rid="tbl2" ref-type="table">2</xref> and <xref rid="tbl3" ref-type="table">3</xref>), the real challenge of existing GWAS pipelines becomes apparent with larger data sets. For example, many QC and association testing tools use the duplicate/relatedness detection feature (see Methods) to remove related individuals or duplicate samples from the data set. Because every sample is tested against every other sample, the total runtime grows quadratically in relation to the number of samples; i.e., the time complexity is <inline-formula><tex-math id="M5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {O}(n^2)$\end{document}</tex-math></inline-formula>.</p>
      <p>Nextflow, a tool specifically designed to run bioinformatics applications, therefore provides a suitable environment to facilitate the parallelism of processes in all workflows. It extends the Unix pipes model with a fluent data descrition language (DSL), allowing the user to handle complex stream interactions easily. In our case, we use a dynamic job creation approach to automatically determine the number of parallel jobs required to perform an operation within a reasonable time frame. For example, in the duplicate/relatedness detection step, we use both PLINK’s “-parallel” mode and Nextflow’s job splitting feature to achieve fast processing of large input files. The same mechanism is also used for other computationally intensive operations, such as our “leave-one-batch-out Hardy-Weinberg test” or the SAIGE association testing procedure. Nextflow takes care of the creation, workspace separation, and merging of all jobs, avoids user-defined error-prone synchronization of all jobs, and oversees the merging of results from complex analysis pipelines. All the intermediate results produced during the pipeline execution are automatically tracked.</p>
      <p>Another major advantage of Nextflow is the already integrated handling and agnostic use of HPC cluster resources (i.e., it is able to work under different environments). With Nextflow, it is possible to write parallel and concurrent pipeline workflows without having knowledge (and thus knowing all dependencies) of a specific cluster environment, such as SGE, SLURM, or PBS/TORQUE. This makes it possible to provide pipelines for a wide range of HPC and non-HPC users. The deep integration of different storage solutions like ECS object storage or S3 buckets and container tools such as Docker and Singularity make Nextflow a first choice for a portable, widely available platform, with the only requirement of a working Java installation.</p>
    </sec>
    <sec id="sec2-15">
      <title>Singularity</title>
      <p>Our general Nextflow script code base is hosted on GitHub. However, the included pipeline scripts make heavy use of external tools, such as the well-known PLINK sofware  [<xref rid="bib5" ref-type="bibr">6</xref>] for GWAS data. Because each workflow is usually created with specific versions of tools in mind, it is often the case that developers need to install multiple versions of the same software and must take special care in managing them. Conda (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://scicrunch.org/resolver/RRID:SCR_018317" ext-link-type="uri">RRID:SCR_018317</ext-link>)  [<xref rid="bib36" ref-type="bibr">37</xref>] and Lmod [<xref rid="bib37" ref-type="bibr">38</xref>] assist in setting up the respective software environments, but the required tools must still be installed manually by the user.</p>
      <p>In our case we decided to prepare the execution environment, including an entire operating system, in a publicly hosted container image, including all specific program versions. This not only eliminates the burden and error-proneness of manually creating a new environment but also ensures that each user uses exactly the same program versions and therefore can reproduce any result with the same input, without any problems with deployment on different operating systems, user permissions, or configuration management.</p>
      <p>Another advantage of using an entire file system is the possibility not only to add programs as desired but also to include any file. We use these capabilities to provide ready-to-use Hapmap2 [<xref rid="bib38" ref-type="bibr">39</xref>] and 1000 Genomes Project [<xref rid="bib25" ref-type="bibr">26</xref>] data sets that serve as reference samples, e.g., for PCA, as well as a comprehensive but slim database of NCBI Reference SNP ID numbers [<xref rid="bib39" ref-type="bibr">40</xref>].</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec3">
    <title>Results</title>
    <sec id="sec3-1">
      <title>Benchmark settings</title>
      <p>In Table <xref rid="tbl1" ref-type="table">1</xref> we compare the features of the QC Module of BIGwas (for details see Methods) with the features of the QC module from the H3Agwas Pipeline Version 3, a portable and reproducible GWAS QC and association test software workflow developed by the pan-African community project H3ABioNet (see Introduction). The H3A QC module was developed to perform a robust and efficient QC workflow for &gt;30,000 DNA samples genotyped using a custom-designed African genotyping array as part of H3ABioNet [<xref rid="bib11" ref-type="bibr">12</xref>]. Because many similar features were implemented in both software pipelines (although there is no explicit support for multiple GWAS data sets [i.e., batches] in H3A QC), the runtime performance can be compared very well in a benchmark. We have not made a feature comparison for the association pipelines of BIGwas (for details see Methods) and H3A because the authors of the H3A Association Pipeline have made it clear that the purpose of the H3A Association Pipeline is to perform a very basic logistic/linear regression association analysis with PLINK [<xref rid="bib44_1624294185882" ref-type="bibr">41</xref>]. The use of linear mixed models for association testing is further supported but only for genotypes in PLINK format (and not imputed data in VCF format as delivered by genotype imputation servers) and without support for pre- or post-processing of input and output files. For this reason, we only compared the runtime of logistic/linear regression and mixed model testing with BIGwas (PLINK and SAIGE) versus logistic/linear regression with H3A (PLINK).</p>
      <table-wrap position="float" id="tbl1">
        <label>Table 1:</label>
        <caption>
          <p>Feature comparison between the QC Module of BIGwas and the H3A QC module of the H3Agwas Pipeline Version 3  [<xref rid="bib11" ref-type="bibr">12</xref>]</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Feature</th>
              <th rowspan="1" colspan="1">BIGwas QC</th>
              <th rowspan="1" colspan="1">H3A QC</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Duplicate Removal</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">RsID dbSNP Assignment</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✗</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">HWE Test</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">HWE Test (batch-wise leave-one-out)</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✗</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">IBD/Relatedness Check</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Missingness Check</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Heterozygosity Check</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">PCA Outlier Detection</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✗<xref rid="tnote-1624284613378" ref-type="table-fn"><sup>1</sup></xref></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Low-MAF Removal</td>
              <td rowspan="1" colspan="1">✗</td>
              <td rowspan="1" colspan="1">✓</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">PAR Check</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✗</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">VCF Output</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Genome Build Liftover</td>
              <td rowspan="1" colspan="1">Optional</td>
              <td rowspan="1" colspan="1">✗</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Dynamic Parallelization of Jobs</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✗<xref rid="tnote-1624284639705" ref-type="table-fn"><sup>2</sup></xref></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">PDF Report</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tnote-1624284613378">
            <label>1</label>
            <p>Principal component analysis (PCA) is calculated but ancestry outliers are not determined.</p>
          </fn>
          <fn id="tnote-1624284639705">
            <label>2</label>
            <p>Parallelization effort is manually configurable but does not automatically scale.</p>
          </fn>
          <fn id="req-162429452896642630">
            <p>For details see Methods. The QC Module of BIGwas performs, among other things, an automatic upscaling of job parallelization with respect to the number of samples and variants and allows an unlimited number of input GWAS data sets (i.e., batches) to be processed with a single command. HWE: Hardy-Weinberg equilibrium; MAF: minor allele frequency; PAR: pseudo-autosomal region; PCA: principal component analysis.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>We conducted benchmark tests on our HPC system with 68 computational nodes and 1,336 CPU cores in total, which enables highly parallel computing. However, because in a multi-user HPC system not all resources are usually available to a single user, and in order to demonstrate that BIGwas uses resources economically, for benchmarking we allowed the submission of a maximum of 150 jobs in parallel (corresponds to 7 compute nodes; configurable by the user) for testing both the QC Module and the Association Testing Module of BIGwas. For benchmarking H3A, we made no restrictions on HPC resources (thus allowing 1,336 jobs in parallel) to test the maximum performance of H3A. For each benchmark data set consisting of a different number of GWAS samples and genetic variants (Tables <xref rid="tbl2" ref-type="table">2</xref> and <xref rid="tbl3" ref-type="table">3</xref>), we used Nextflow’s built-in reporting function to determine the elapsed wall-clock time. Each runtime analysis was performed 3 times on an empty HPC cluster to account for potential fluctuations in HPC cluster performance.</p>
      <table-wrap position="float" id="tbl2">
        <label>Table 2:</label>
        <caption>
          <p>Runtime metrics of the QC module of BIGwas compared to the QC module of the H3Agwas Pipeline Version 3  [<xref rid="bib11" ref-type="bibr">12</xref>] for several different-sized GWAS data sets</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Sample No.</th>
              <th rowspan="1" colspan="1">Variant No.</th>
              <th rowspan="1" colspan="1">BIGwas Runtime</th>
              <th rowspan="1" colspan="1">H3A Runtime</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">200</td>
              <td rowspan="1" colspan="1">500</td>
              <td rowspan="1" colspan="1">6  min</td>
              <td rowspan="1" colspan="1">4  min</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">500</td>
              <td rowspan="1" colspan="1">1,000</td>
              <td rowspan="1" colspan="1">6  min</td>
              <td rowspan="1" colspan="1">7  min</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1,000</td>
              <td rowspan="1" colspan="1">5,000</td>
              <td rowspan="1" colspan="1">6  min</td>
              <td rowspan="1" colspan="1">9  min</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">5,000</td>
              <td rowspan="1" colspan="1">50,000</td>
              <td rowspan="1" colspan="1">8  min</td>
              <td rowspan="1" colspan="1">18  min</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">5,000</td>
              <td rowspan="1" colspan="1">250,000</td>
              <td rowspan="1" colspan="1">15  min</td>
              <td rowspan="1" colspan="1">35  min</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">10,000</td>
              <td rowspan="1" colspan="1">250,000</td>
              <td rowspan="1" colspan="1">15  min</td>
              <td rowspan="1" colspan="1">57  min</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">20,554</td>
              <td rowspan="1" colspan="1">700,078</td>
              <td rowspan="1" colspan="1">2  h 15  min</td>
              <td rowspan="1" colspan="1">8  h 57  min</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">488,292</td>
              <td rowspan="1" colspan="1">231,151</td>
              <td rowspan="1" colspan="1">3  d 1  h</td>
              <td rowspan="1" colspan="1">*</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">488,292</td>
              <td rowspan="1" colspan="1">803,113</td>
              <td rowspan="1" colspan="1">4  d 22  h</td>
              <td rowspan="1" colspan="1">*</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">976,584</td>
              <td rowspan="1" colspan="1">803,113</td>
              <td rowspan="1" colspan="1">6  d 12  h</td>
              <td rowspan="1" colspan="1">*</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="req-162429475915642630">
            <p>A GWAS input data set with 976,584 samples and 803,113 genetic variants (i.e., twice the size of the current UK Biobank GWAS data set) can be quality-controlled in &lt;7 days with 1 command of the BIGwas software, whereby only 150 jobs (configurable; equivalent to ∼7 compute nodes on our HPC cluster system) are used in parallel. *Runtime of H3A has exceeded the maximum time allocation of 10 days for the HPC system despite the possibility of using a maximum of 1,336 jobs in parallel.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap position="float" id="tbl3">
        <label>Table 3:</label>
        <caption>
          <p>Runtime metrics of the Association Testing Module of BIGwas (regression analysis with PLINK and mixed model analysis with SAIGE) compared to association testing module of the H3Agwas Pipeline Version 3 (regression analysis with PLINK) [<xref rid="bib11" ref-type="bibr">12</xref>] for several different-sized GWAS data sets</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Sample No.</th>
              <th rowspan="1" colspan="1">Variant No.</th>
              <th rowspan="1" colspan="1">BIGwas Runtime</th>
              <th rowspan="1" colspan="1">H3A Runtime</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">10,000</td>
              <td rowspan="1" colspan="1">250,000</td>
              <td rowspan="1" colspan="1">21  min</td>
              <td rowspan="1" colspan="1">8  min</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">10,000</td>
              <td rowspan="1" colspan="1">700,078</td>
              <td rowspan="1" colspan="1">54  min</td>
              <td rowspan="1" colspan="1">16  min</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">20,554</td>
              <td rowspan="1" colspan="1">700,078</td>
              <td rowspan="1" colspan="1">1  h 33  min</td>
              <td rowspan="1" colspan="1">1  h 23  min</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">5,480</td>
              <td rowspan="1" colspan="1">81,708,012</td>
              <td rowspan="1" colspan="1">14  h 26  min</td>
              <td rowspan="1" colspan="1">*</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">487,409</td>
              <td rowspan="1" colspan="1">92,775,302</td>
              <td rowspan="1" colspan="1">4  d 18  h</td>
              <td rowspan="1" colspan="1">*</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">974,818</td>
              <td rowspan="1" colspan="1">92,775,302</td>
              <td rowspan="1" colspan="1">9  d 14  h</td>
              <td rowspan="1" colspan="1">*</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="req-162429512510942630">
            <p>An imputed genome-wide input data set with almost 1 million samples and &gt;92 million genetic variants (i.e., twice the size of the imputed UKB GWAS data set) can be tested for association within 10 days with 1 command of the BIGwas software, whereby only 150 jobs (configurable; equivalent to ∼7 compute nodes on our HPC cluster system) are used in parallel. *H3A uses PLINK genotype files as input (but not imputed allele dosages).</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="sec3-2">
      <title>Benchmark results</title>
      <p>Table <xref rid="tbl2" ref-type="table">2</xref> shows runtime benchmarks of the QC Module of BIGwas (for details see Methods) compared to the QC module of the H3Agwas Pipeline Version 3. For comparison with H3A runtimes, we set configurable parameters, such as missingness thresholds, to similar values where possible and used the recommended commands for the respective benchmark data sets. Data sets in the upper part were subsampled from in-house GWAS data sets gentoyped using Illumina’s Global Screening (GSA) Array v1.0. In the lower part, unimputed Axiom Array data of 488,292 individuals of European ancestry from UKB were used (see Acknowledgements). The data set of 976,584 samples and 803,113 SNPs represents an artificially created GWAS data set (from the original COVID-19 UK Biobank unimputed GWAS data release, September 2020, with 1,485 COVID-19 cases and 486,807 controls), which was created by duplicating the number of samples from the UK Biobank data set.</p>
      <p>The theoretical algorithmic runtime complexity of the QC is quadratic with respect to the number of samples and linear with the number of variants <inline-formula><tex-math id="M6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {O}(n^2+m)$\end{document}</tex-math></inline-formula> because in IBD analysis each sample is checked against every other sample both in the H3A as well as BIGwas. The IBD calculation becomes the most time-consuming part from 5,000 samples upwards in H3A QC and leads to a preliminary termination of H3A QC for the UKB data set (Table  <xref rid="tbl2" ref-type="table">2</xref>). For 5,000 GWAS samples upwards, our implementation begins with a dynamic parallelization process (see Methods), i.e., scheduling (at maximum 150) jobs (configurable) to distribute the workload across multiple compute nodes in order to reduce the runtime (not shown) with respect to the number of samples. The number of additional jobs scales with the number of samples to keep the runtime for IBD analysis low (see processes marked with ×<italic toggle="yes">n</italic> in Fig. <xref rid="fig2" ref-type="fig">2</xref>); thus the runtime of BIGwas increases much slower than that of H3A. Algorithmic complexity in other time-consuming applications such as Hardy-Weinberg and ANOVA testing is generally linear in the number of variants, but we found it useful to also scale the number of parallel jobs or threads automatically with the number of samples (also marked with ×<italic toggle="yes">n</italic> in Fig. <xref rid="fig2" ref-type="fig">2</xref>). Our resource-efficient intra- and inter-node software implementation (see Methods) shows that BIGwas did not exceed the maximum number of 150 parallel jobs allowed by us in our benchmark and that BIGwas is able to analyse arbitrarily large GWAS input data sets with 1 million GWAS samples. Despite the possibility of using a maximum of 1,336 parallel jobs, H3A exceeded a runtime of 10 days for the UKB data set with 488,292 samples and a reduced set of 231,151 (LD pruned) variants (Table  <xref rid="tbl2" ref-type="table">2</xref>). Results of BIGwas are summarized in a PDF report (see Methods), and output files (on either genome build hg19 and/or hg38; configurable) can be used directly for association testing and/or as an input for genotype imputation services.</p>
      <p>Table <xref rid="tbl3" ref-type="table">3</xref> shows runtime benchmark results of the Association Testing Module of BIGwas (for details see Methods) compared to the association module of H3A. Data sets in the upper part were subsampled from in-house GWAS data sets gentoyped using Illumina’s Global Screening (GSA) Array v1.0. In the lower part, pre-imputed GSA data of 5,480 individuals as well as pre-imputed Axiom Array data of 487,409 individuals of European ancestry from UKB were used (see Acknowledgements). The data set of 974,818 samples and 92,775,302 SNPs represents an artificially created imputed GWAS data set (from the orginal COVID-19 UK Biobank imputed GWAS data release, September 2020, with 636 cases and 486,773 controls), which was created by duplicating the samples of the UKB data set. Association analysis included top 10 PCs from PCA, sex, age, sex*age, and age*age as covariates.</p>
      <p>The theoretical runtime of BIGwas increases linearly with the number of variants <inline-formula><tex-math id="M7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {O}(m)$\end{document}</tex-math></inline-formula>. The runtimes shown in Table <xref rid="tbl3" ref-type="table">3</xref> were achieved with a maximum number of parallel jobs of 150 for BIGwas, and with no restrictions on the number of parallel jobs for H3A (at maximum 1,336 jobs in parallel). By default, our pipeline module schedules 1 job for 5,000 genetic variants (marked with ×<italic toggle="yes">m</italic> in Fig. <xref rid="fig3" ref-type="fig">3</xref>) for the limited number of maximum 150 parallel jobs (configurable). Our resource-efficient intra- and inter-node software implementation (see Methods) enables BIGwas to analyse arbitrarily large GWAS input data sets with millions of GWAS samples and millions of imputed genetic variants. Although SAIGE and PLINK association testing in BIGwas is performed in parallel in 1 run of the Association Testing Module, the runtime of BIGwas is only slightly longer than that of H3A, which performs association testing with PLINK only, without pre- and post-processing of input and output files. Some new features have been implemented in the Association Testing Module of BIGwas, which are not covered by the original implementations of SAIGE and PLINK (see Methods): before association tests are performed, an on-the-fly sample filtering is conducted to exclude certain samples (e.g., based on a sample exclusion list; see Methods) or variants (e.g., based on the imputation score threshold <italic toggle="yes">r</italic><sup>2</sup>; see Methods) from PLINK or VCF input data sets, without the need to manually remove them first, which is usually a labor-intensive step for the user. In addition, an automated PCA (configurable) is integrated into SAIGE mixed-model association analysis, so that model fitting analysis and association testing (along with PCs from PCA and/or user-provided covariates) are performed in SAIGE in a single step; association testing for chromosome X is also automated for PLINK and SAIGE (see Methods). Association summary statistics output files as well as best-guess genotype calls in PLINK format are produced for different genome builds (hg19 and/or hg38; configurable).</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="sec4">
    <title>Discussion</title>
    <p>We have introduced BIGwas, a portable (i.e., Singularity container-based), fully automated GWAS QC and association pipeline in Nextflow that can be executed with a single command without manual installation by the user. BIGwas differs from existing GWAS data-processing packages in R in that it allows standardized, reproducible, and high-throughput processing of GWAS data sets with a single command, whereas existing GWAS R packages allow for more flexible processing, e.g., with respect to the order of processing steps. The current UKB GWAS release with 487,409 GWAS samples can be analysed with BIGwas within 8 days (4 days for QC and 4 days for association testing) on a small HPC with 7 compute nodes. For a GWAS data set with ≤1 million individuals BIGwas needs on average 16 days on an HPC with 7 compute nodes. Using our dynamic parallelization approach, shorter runtimes can be achieved with a larger HPC. For QC the theoretical runtime increases quadratically with the number of samples and linearly with the number of variants <inline-formula><tex-math id="M8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {O}(n^2+m)$\end{document}</tex-math></inline-formula>. For association testing the runtime increases linearly with the number of variants <inline-formula><tex-math id="M9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {O}(m)$\end{document}</tex-math></inline-formula>. As sample sizes in large GWAS/PheWAS biobank studies, e.g., for COVID-19 research [<xref rid="bib43_1624048014083" ref-type="bibr">4</xref>, have grown to millions of GWAS samples and GWAS data sets of this size are likely to be used more frequently in the future, the efficiency and ease of execution of BIGwas with a single command will become an important criterion for conducting GWAS/PheWAS studies.</p>
    <p>To enable a reproducible analysis of 1 million GWAS samples on any common compute platform, we have combined various code optimizations of our existing GWAS software with Nextflow workflow and Singularity container technology. Our Nextflow pipelines are inherently parallel and can be transparently scaled up or down, and they provide an abstraction layer between the logic of the pipeline and the execution layer (i.e., they can be executed on multiple platforms without changing the source code). With the Singularity container technology, we have packed all our Nextflow workflows, software, and libraries, as well as publicly available reference data, into a single Singularity container that runs on any standard computer platform without manual download or installation by the user.</p>
    <p>BIGwas implements a complete GWAS analysis protocol that was developed for large-scale GWAS studies of the Inflammatory Bowel Disease Genetics Consortium and the Severe Covid-19 GWAS Group [<xref rid="bib17" ref-type="bibr">16–18</xref>]. BIGwas is not yet suitable for GWAS analysis of family data or GWAS analysis across populations of worldwide ethnicities. To enable these analyses, extensions to our QC and the association testing pipelines or the use of alternative statistical methods may be required. In the future, we aim to test the usability of further genome-wide analysis approaches, such as gene-gene interaction tests, for use with Nextflow and Singularity technology.</p>
  </sec>
  <sec id="sec5">
    <title>Availability of Source Code and Requirements</title>
    <list list-type="bullet">
      <list-item>
        <p>Project name: IKMB GWAS QC and Association Testing Pipelines</p>
      </list-item>
      <list-item>
        <p>Project home page: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://github.com/ikmb/gwas-qc" ext-link-type="uri">http://github.com/ikmb/gwas-qc</ext-link> and <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://github.com/ikmb/gwas-assoc" ext-link-type="uri">http://github.com/ikmb/gwas-assoc</ext-link></p>
      </list-item>
      <list-item>
        <p>Operating system: Linux</p>
      </list-item>
      <list-item>
        <p>Programming language: Nextflow, Bash, Python, Perl, R, Rust</p>
      </list-item>
      <list-item>
        <p>Other requirements: Java 8 or higher, Singularity 3.4 or higher</p>
      </list-item>
      <list-item>
        <p>Bio.tools identifier: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://bio.tools/bigwas_qc_pipeline" ext-link-type="uri">https://bio.tools/bigwas_qc_pipeline</ext-link> and <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://bio.tools/bigwas_assoc_pipeline" ext-link-type="uri">https://bio.tools/bigwas_assoc_pipeline</ext-link></p>
      </list-item>
      <list-item>
        <p><ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://scicrunch.org/browse/resources/SCR_019240" ext-link-type="uri">RRID:SCR_019240</ext-link> and <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://scicrunch.org/browse/resources/SCR_019241" ext-link-type="uri">RRID:SCR_019241</ext-link></p>
      </list-item>
    </list>
    <p>This project makes use of several open source tools, namely, PLINK 1.9 [<xref rid="bib40" ref-type="bibr">42</xref>], PLINK 2 [<xref rid="bib5" ref-type="bibr">6</xref>], bcftools 1.10 from the HTSlib project [<xref rid="bib41" ref-type="bibr">43</xref>], FlashPCA 2.0 [<xref rid="bib28" ref-type="bibr">29</xref>], EIGENSTRAT 4.2 [<xref rid="bib30" ref-type="bibr">31</xref>], and SAIGE 0.42.1 [<xref rid="bib13" ref-type="bibr">21</xref>]. For the availability of source code, we refer to the respective publications. Several more native binaries were created and included for performance reasons. Their source codes are available as follows:</p>
    <list list-type="bullet">
      <list-item>
        <p>chipmatch, a tool to match PLINK’s BIM files against the Will Rayner strand database [<xref rid="bib22" ref-type="bibr">23</xref>]: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/ikmb/chipmatch" ext-link-type="uri">https://github.com/ikmb/chipmatch</ext-link></p>
      </list-item>
      <list-item>
        <p>genericplotter, a high-performance heat map plotting tool for almost arbitrary, very large data sets: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/ikmb/genericplotter" ext-link-type="uri">https://github.com/ikmb/genericplotter</ext-link></p>
      </list-item>
    </list>
    <p>UK Biobank (UKB) COVID-19 GWAS data release (September 2020): <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://biobank.ndph.ox.ac.uk/ukb/exinfo.cgi?src=COVID19" ext-link-type="uri">https://biobank.ndph.ox.ac.uk/ukb/exinfo.cgi?src=COVID19</ext-link></p>
  </sec>
  <sec sec-type="data-availability" id="sec6">
    <title>Data Availability</title>
    <p>Snapshots of the code and example data sets are available in the GigaDB repository [<xref rid="bib42" ref-type="bibr">44</xref>].</p>
    <p>The example data set is a subset of the 1000 Genomes Project [<xref rid="bib25" ref-type="bibr">26</xref>], using 2,504 samples with randomized sex and phenotype, and 50,000 randomly selected variants.</p>
  </sec>
  <sec id="h1content1624045323893">
    <title>Abbreviations</title>
    <p>ANOVA: analysis of variance; FDR: false discovery rate; GWAS: genome-wide association study; HPC: high-performance compute; HWE: Hardy-Weinberg equilibrium; IBD: identity-by-descent; IBS: identity-by-state; LD: linkage disequilibrium; MAF: minor allele frequency; NCBI: National Center for Biotechnology Information; PAR: pseudo-autosomal region; PheWAS: phenome-wide association studies; QC: quality control; SNP: single-nucleotide polymorphism; SPA: saddle point approximation; UCSC: University of California Santa Cruz; UKB: UK Biobank; VCF: variant call format.</p>
  </sec>
  <sec id="sec7">
    <title>Ethics Approval and Consent to Participate</title>
    <p>All participants provided written informed consent, and the study was approved by the ethics boards of the participating institutions (see Acknowledgements) in agreement with the Declaration of Helsinki principles.</p>
  </sec>
  <sec id="sec7-3">
    <title>Competing Interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec id="h1content1624297774285">
    <title>Funding</title>
    <p>This work was supported by the German Federal Ministry of Education and Research (BMBF) within the framework of the Computational Life Sciences funding concept (CompLS grant 031L0165) and iTREAT (grant 01ZX1902A). The study received infrastructure support from the DFG Cluster of Excellence 2167 “Precision Medicine in Chronic Inflammation (PMI)” (DFG Grant: “EXC2167’’), the DFG research unit “miTarget” (Projectnummer 426660215), and the PopGen Biobank (P2N 2016-101).</p>
  </sec>
  <sec id="sec7-4">
    <title>Authors' Contributions</title>
    <p>J.C.K.: Conceptualization, Methodology, Software, Benchmarks, Writing. L.W.: Software, Benchmarks, Writing, Visualization. D.E.: Conceptualization, Methodology, Software, Formal analysis, Data curation, Supervision, Writing.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>giab047_GIGA-D-20-00360_Original_Submission</label>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab047_giga-d-20-00360_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup2" position="float" content-type="local-data">
      <label>giab047_GIGA-D-20-00360_Revision_1</label>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab047_giga-d-20-00360_revision_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup3" position="float" content-type="local-data">
      <label>giab047_GIGA-D-20-00360_Revision_2</label>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab047_giga-d-20-00360_revision_2.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup4" position="float" content-type="local-data">
      <label>giab047_GIGA-D-20-00360_Revision_3</label>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab047_giga-d-20-00360_revision_3.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup5" position="float" content-type="local-data">
      <label>giab047_Response_to_Reviewer_Comments_Original_Submission</label>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab047_response_to_reviewer_comments_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup6" position="float" content-type="local-data">
      <label>giab047_Response_to_Reviewer_Comments_Revision_1</label>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab047_response_to_reviewer_comments_revision_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup7" position="float" content-type="local-data">
      <label>giab047_Response_to_Reviewer_Comments_Revision_2</label>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab047_response_to_reviewer_comments_revision_2.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup8" position="float" content-type="local-data">
      <label>giab047_Reviewer_1_Report_Original_Submission</label>
      <caption>
        <p>Shing Wan Choi -- 12/23/2020 Reviewed</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab047_reviewer_1_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup9" position="float" content-type="local-data">
      <label>giab047_Reviewer_1_Report_Revision_1</label>
      <caption>
        <p>Shing Wan Choi -- 4/20/2021 Reviewed</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab047_reviewer_1_report_revision_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup10" position="float" content-type="local-data">
      <label>giab047_Reviewer_2_Report_Original_Submission</label>
      <caption>
        <p>Cristian Pattaro -- 1/2/2021 Reviewed</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab047_reviewer_2_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>ACKNOWLEDGEMENTS</title>
    <p>The authors thank Andre Franke for helpful discussions regarding the evaluation of the UK Biobank data, Frauke Degenhardt for sharing R scripts for visualization of results from principal component analysis, and Florian Uellendahl-Werth and Mareike Wendorff for helpful discussions on R code optimization. Benchmarks and scalability tests have been conducted using the UK Biobank Resource (Project No. 61199, “Biobank-Scale Configurable Quality Control and Association Testing for GWAS”).</p>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="bib1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Evangelou</surname><given-names>E</given-names></string-name>, <string-name><surname>Warren</surname><given-names>HR</given-names></string-name>, <string-name><surname>Mosen-Ansorena</surname><given-names>D</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Genetic analysis of over 1 million people identifies 535 new loci associated with blood pressure traits</article-title>. <source>Nat Genet</source>. <year>2018</year>;<volume>50</volume>(<issue>10</issue>):<fpage>1412</fpage>–<lpage>25</lpage>.<pub-id pub-id-type="pmid">30224653</pub-id></mixed-citation>
    </ref>
    <ref id="bib2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sudlow</surname><given-names>C</given-names></string-name>, <string-name><surname>Gallacher</surname><given-names>J</given-names></string-name>, <string-name><surname>Allen</surname><given-names>N</given-names></string-name>, <etal>et al.</etal></person-group><article-title>UK Biobank: an open access resource for identifying the causes of a wide range of complex diseases of middle and old age</article-title>. <source>PLoS Med</source>. <year>2015</year>;<volume>12</volume>(<issue>3</issue>):<fpage>e1001779</fpage>.<pub-id pub-id-type="pmid">25826379</pub-id></mixed-citation>
    </ref>
    <ref id="bib3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Klarin</surname><given-names>D</given-names></string-name>, <string-name><surname>Damrauer</surname><given-names>SM</given-names></string-name>, <string-name><surname>Cho</surname><given-names>K</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Genetics of blood lipids among ~300, 000 multi-ethnic participants of the Million Veteran Program</article-title>. <source>Nat Genet</source>. <year>2018</year>;<volume>50</volume>(<issue>11</issue>):<fpage>1514</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">30275531</pub-id></mixed-citation>
    </ref>
    <ref id="bib43_1624048014083">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>The Covid-19 Host Genetics Initiative</collab></person-group>, <comment><ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.covid19hg.org/" ext-link-type="uri">https://www.covid19hg.org/</ext-link> Accessed 16 October 2020</comment></mixed-citation>
    </ref>
    <ref id="bib4">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Taliun</surname><given-names>SAG</given-names></string-name>, <string-name><surname>VandeHaar</surname><given-names>P</given-names></string-name>, <string-name><surname>Boughton</surname><given-names>AP</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Exploring and visualizing large-scale genetic associations by using PheWeb</article-title>. <source>Nat Genet</source>. <year>2020</year>;<volume>52</volume>(<issue>6</issue>):<fpage>550</fpage>–<lpage>2</lpage>.<pub-id pub-id-type="pmid">32504056</pub-id></mixed-citation>
    </ref>
    <ref id="bib5">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chang</surname><given-names>CC</given-names></string-name>, <string-name><surname>Chow</surname><given-names>CC</given-names></string-name>, <string-name><surname>Tellier</surname><given-names>LC</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Second-generation PLINK: rising to the challenge of larger and richer datasets</article-title>. <source>Gigascience</source>. <year>2015</year>;<volume>4</volume>(<issue>1</issue>):doi:<pub-id pub-id-type="doi">10.1186/s13742-015-0047-8</pub-id></mixed-citation>
    </ref>
    <ref id="bib6">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gogarten</surname><given-names>SM</given-names></string-name>, <string-name><surname>Bhangale</surname><given-names>T</given-names></string-name>, <string-name><surname>Conomos</surname><given-names>MP</given-names></string-name>, <etal>et al.</etal></person-group><article-title>GWASTools: an R/Bioconductor package for quality control and analysis of genome-wide association studies</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>(<issue>24</issue>):<fpage>3329</fpage>–<lpage>31</lpage>.<pub-id pub-id-type="pmid">23052040</pub-id></mixed-citation>
    </ref>
    <ref id="bib7">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van der Most</surname><given-names>PJ</given-names></string-name>, <string-name><surname>Vaez</surname><given-names>A</given-names></string-name>, <string-name><surname>Prins</surname><given-names>BP</given-names></string-name>, <etal>et al.</etal></person-group><article-title>QCGWAS: a flexible R package for automated quality control of genome-wide association results</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>(<issue>8</issue>):<fpage>1185</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">24395754</pub-id></mixed-citation>
    </ref>
    <ref id="bib8">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Perreault</surname><given-names>LPL</given-names></string-name>, <string-name><surname>Legault</surname><given-names>MA</given-names></string-name>, <string-name><surname>Asselin</surname><given-names>G</given-names></string-name>, <etal>et al.</etal></person-group><article-title>genipe: an automated genome-wide imputation pipeline with automatic reporting and statistical tools</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>(<issue>23</issue>):<fpage>3661</fpage>–<lpage>3</lpage>.<pub-id pub-id-type="pmid">27497439</pub-id></mixed-citation>
    </ref>
    <ref id="bib9">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lam</surname><given-names>M</given-names></string-name>, <string-name><surname>Awasthi</surname><given-names>S</given-names></string-name>, <string-name><surname>Watson</surname><given-names>HJ</given-names></string-name>, <etal>et al.</etal></person-group><article-title>RICOPILI: Rapid Imputation for COnsortias PIpeLIne</article-title>. <source>Bioinformatics</source>. <year>2020</year>;<volume>36</volume>(<issue>3</issue>):<fpage>930</fpage>–<lpage>3</lpage>.<pub-id pub-id-type="pmid">31393554</pub-id></mixed-citation>
    </ref>
    <ref id="bib10">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Eller</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Janga</surname><given-names>SC</given-names></string-name>, <string-name><surname>Walsh</surname><given-names>S</given-names></string-name></person-group>. <article-title>Odyssey: a semi-automated pipeline for phasing, imputation, and analysis of genome-wide genetic data</article-title>. <source>BMC Bioinformatics</source>. <year>2019</year>;<volume>20</volume>:<fpage>364</fpage>.<pub-id pub-id-type="pmid">31253090</pub-id></mixed-citation>
    </ref>
    <ref id="bib11">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baichoo</surname><given-names>S</given-names></string-name>, <string-name><surname>Souilmi</surname><given-names>Y</given-names></string-name>, <string-name><surname>Panji</surname><given-names>S</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Developing reproducible bioinformatics analysis workflows for heterogeneous computing environments to support African genomics</article-title>. <source>BMC Bioinformatics</source>. <year>2018</year>;<volume>19</volume>:<fpage>457</fpage>.<pub-id pub-id-type="pmid">30486782</pub-id></mixed-citation>
    </ref>
    <ref id="bib14">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tommaso</surname><given-names>PD</given-names></string-name>, <string-name><surname>Chatzou</surname><given-names>M</given-names></string-name>, <string-name><surname>Floden</surname><given-names>EW</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Nextflow enables reproducible computational workflows</article-title>. <source>Nat Biotechnol</source>. <year>2017</year>;<volume>35</volume>(<issue>4</issue>):<fpage>316</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">28398311</pub-id></mixed-citation>
    </ref>
    <ref id="bib15">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kurtzer</surname><given-names>GM</given-names></string-name>, <string-name><surname>Sochat</surname><given-names>V</given-names></string-name>, <string-name><surname>Bauer</surname><given-names>MW</given-names></string-name></person-group>. <article-title>Singularity: scientific containers for mobility of compute</article-title>. <source>PLoS One</source>. <year>2017</year>;<volume>12</volume>(<issue>5</issue>):<fpage>e0177459</fpage>.<pub-id pub-id-type="pmid">28494014</pub-id></mixed-citation>
    </ref>
    <ref id="bib16">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Anderson</surname><given-names>CA</given-names></string-name>, <string-name><surname>Pettersson</surname><given-names>FH</given-names></string-name>, <string-name><surname>Clarke</surname><given-names>GM</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Data quality control in genetic case-control association studies</article-title>. <source>Nat Protoc</source>. <year>2010</year>;<volume>5</volume>(<issue>9</issue>):<fpage>1564</fpage>–<lpage>73</lpage>.<pub-id pub-id-type="pmid">21085122</pub-id></mixed-citation>
    </ref>
    <ref id="bib17">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ellinghaus</surname><given-names>D</given-names></string-name>, <string-name><surname>Jostins</surname><given-names>L</given-names></string-name>, <string-name><surname>Spain</surname><given-names>SL</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Analysis of five chronic inflammatory diseases identifies 27 new associations and highlights disease-specific patterns at shared loci</article-title>. <source>Nat Genet</source>. <year>2016</year>;<volume>48</volume>(<issue>5</issue>):<fpage>510</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">26974007</pub-id></mixed-citation>
    </ref>
    <ref id="bib18">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>H</given-names></string-name>, <string-name><surname>Fang</surname><given-names>M</given-names></string-name>, <string-name><surname>Jostins</surname><given-names>L</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Fine-mapping inflammatory bowel disease loci to single-variant resolution</article-title>. <source>Nature</source>. <year>2017</year>;<volume>547</volume>(<issue>7662</issue>):<fpage>173</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">28658209</pub-id></mixed-citation>
    </ref>
    <ref id="bib19">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ellinghaus</surname><given-names>D</given-names></string-name>, <string-name><surname>Degenhardt</surname><given-names>F</given-names></string-name>, <string-name><surname>Bujanda</surname><given-names>L</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Genomewide association study of severe Covid-19 with respiratory failure</article-title>. <source>N Engl J Med</source>. <year>2020</year>;<volume>383</volume>(<issue>16</issue>):<fpage>1522</fpage>–<lpage>34</lpage>.<pub-id pub-id-type="pmid">32558485</pub-id></mixed-citation>
    </ref>
    <ref id="bib20">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhou</surname><given-names>W</given-names></string-name>, <string-name><surname>Nielsen</surname><given-names>JB</given-names></string-name>, <string-name><surname>Fritsche</surname><given-names>LG</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Efficiently controlling for case-control imbalance and sample relatedness in large-scale genetic association studies</article-title>. <source>Nat Genet</source>. <year>2018</year>;<volume>50</volume>(<issue>9</issue>):<fpage>1335</fpage>–<lpage>41</lpage>.<pub-id pub-id-type="pmid">30104761</pub-id></mixed-citation>
    </ref>
    <ref id="bib12">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Das</surname><given-names>S</given-names></string-name>, <string-name><surname>Forer</surname><given-names>L</given-names></string-name>, <string-name><surname>Schönherr</surname><given-names>S</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Next-generation genotype imputation service and methods</article-title>. <source>Nat Genet</source>. <year>2016</year>;<volume>48</volume>(<issue>10</issue>):<fpage>1284</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">27571263</pub-id></mixed-citation>
    </ref>
    <ref id="bib13">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhou</surname><given-names>W</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>Z</given-names></string-name>, <string-name><surname>Nielsen</surname><given-names>JB</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Scalable generalized linear mixed model for region-based association tests in large biobanks and cohorts</article-title>. <source>Nat Genet</source>. <year>2020</year>;<volume>52</volume>(<issue>6</issue>):<fpage>634</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">32424355</pub-id></mixed-citation>
    </ref>
    <ref id="bib21">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Church</surname><given-names>DM</given-names></string-name>, <string-name><surname>Schneider</surname><given-names>VA</given-names></string-name>, <string-name><surname>Graves</surname><given-names>T</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Modernizing reference genome assemblies</article-title>. <source>PLoS Biol</source>. <year>2011</year>;<volume>9</volume>(<issue>7</issue>):<fpage>e1001091</fpage>.<pub-id pub-id-type="pmid">21750661</pub-id></mixed-citation>
    </ref>
    <ref id="bib22">
      <label>23.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Rayner</surname><given-names>NW</given-names></string-name>, <string-name><surname>McCarthy</surname><given-names>MI</given-names></string-name></person-group>. <source>Development and use of a pipeline to generate strand and position information for common genotyping chips</source>; <year>2011</year>, <publisher-name>poster presented at ASHG 2011</publisher-name>, <publisher-loc>Montreal, Canada</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="bib23">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McCarthy</surname><given-names>S</given-names></string-name>, <string-name><surname>Das</surname><given-names>S</given-names></string-name>, <string-name><surname>Kretzschmar</surname><given-names>W</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A reference panel of 64, 976 haplotypes for genotype imputation</article-title>. <source>Nat Genet</source>. <year>2016</year>;<volume>48</volume>(<issue>10</issue>):<fpage>1279</fpage>–<lpage>83</lpage>.<pub-id pub-id-type="pmid">27548312</pub-id></mixed-citation>
    </ref>
    <ref id="bib24">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>The UK10K Consortium</collab>.</person-group><article-title>The UK10K project identifies rare variants in health and disease</article-title>. <source>Nature</source>. <year>2015</year>;<volume>526</volume>(<issue>7571</issue>):<fpage>82</fpage>–<lpage>90</lpage>.<pub-id pub-id-type="pmid">26367797</pub-id></mixed-citation>
    </ref>
    <ref id="bib25">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>The 1000 Genomes Project Consortium</collab>.</person-group><article-title>An integrated map of genetic variation from 1, 092 human genomes</article-title>. <source>Nature</source>. <year>2012</year>;<volume>491</volume>(<issue>7422</issue>):<fpage>56</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">23128226</pub-id></mixed-citation>
    </ref>
    <ref id="bib26">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sherry</surname><given-names>ST</given-names></string-name></person-group>. <article-title>dbSNP: the NCBI database of genetic variation</article-title>. <source>Nucleic Acids Res</source>. <year>2001</year>;<volume>29</volume>(<issue>1</issue>):<fpage>308</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">11125122</pub-id></mixed-citation>
    </ref>
    <ref id="bib27">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Goddard</surname><given-names>KAB</given-names></string-name>, <string-name><surname>Ziegler</surname><given-names>A</given-names></string-name>, <string-name><surname>Wellek</surname><given-names>S</given-names></string-name></person-group>. <article-title>Adapting the logical basis of tests for Hardy-Weinberg equilibrium to the real needs of association studies in human and medical genetics</article-title>. <source>Genet Epidemiol</source>. <year>2009</year>;<volume>33</volume>(<issue>7</issue>):<fpage>569</fpage>–<lpage>80</lpage>.<pub-id pub-id-type="pmid">19235187</pub-id></mixed-citation>
    </ref>
    <ref id="bib28">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abraham</surname><given-names>G</given-names></string-name>, <string-name><surname>Qiu</surname><given-names>Y</given-names></string-name>, <string-name><surname>Inouye</surname><given-names>M</given-names></string-name></person-group>. <article-title>FlashPCA2: principal component analysis of Biobank-scale genotype datasets</article-title>. <source>Bioinformatics</source>. <year>2017</year>;<volume>33</volume>(<issue>17</issue>):<fpage>2776</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">28475694</pub-id></mixed-citation>
    </ref>
    <ref id="bib29">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Patterson</surname><given-names>N</given-names></string-name>, <string-name><surname>Price</surname><given-names>AL</given-names></string-name>, <string-name><surname>Reich</surname><given-names>D</given-names></string-name></person-group>. <article-title>Population structure and eigenanalysis</article-title>. <source>PLoS Genet</source>. <year>2006</year>;<volume>2</volume>(<issue>12</issue>):<fpage>e190</fpage>.<pub-id pub-id-type="pmid">17194218</pub-id></mixed-citation>
    </ref>
    <ref id="bib30">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Price</surname><given-names>AL</given-names></string-name>, <string-name><surname>Patterson</surname><given-names>NJ</given-names></string-name>, <string-name><surname>Plenge</surname><given-names>RM</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Principal components analysis corrects for stratification in genome-wide association studies</article-title>. <source>Nat Genet</source>. <year>2006</year>;<volume>38</volume>(<issue>8</issue>):<fpage>904</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">16862161</pub-id></mixed-citation>
    </ref>
    <ref id="bib31">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Price</surname><given-names>AL</given-names></string-name>, <string-name><surname>Weale</surname><given-names>ME</given-names></string-name>, <string-name><surname>Patterson</surname><given-names>N</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Long-range LD can confound genome scans in admixed populations</article-title>. <source>Am J Hum Genet</source>. <year>2008</year>;<volume>83</volume>(<issue>1</issue>):<fpage>132</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">18606306</pub-id></mixed-citation>
    </ref>
    <ref id="bib32">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname><given-names>P</given-names></string-name>, <string-name><surname>Auton</surname><given-names>A</given-names></string-name>, <string-name><surname>Abecasis</surname><given-names>G</given-names></string-name>, <etal>et al.</etal></person-group><article-title>The variant call format and VCFtools</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>(<issue>15</issue>):<fpage>2156</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21653522</pub-id></mixed-citation>
    </ref>
    <ref id="bib33">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kuhn</surname><given-names>RM</given-names></string-name>, <string-name><surname>Haussler</surname><given-names>D</given-names></string-name>, <string-name><surname>Kent</surname><given-names>WJ</given-names></string-name></person-group>. <article-title>The UCSC Genome Browser and associated tools</article-title>. <source>Brief Bioinform</source>. <year>2012</year>;<volume>14</volume>(<issue>2</issue>):<fpage>144</fpage>–<lpage>61</lpage>.<pub-id pub-id-type="pmid">22908213</pub-id></mixed-citation>
    </ref>
    <ref id="bib34">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Haeussler</surname><given-names>M</given-names></string-name>, <string-name><surname>Zweig</surname><given-names>AS</given-names></string-name>, <string-name><surname>Tyner</surname><given-names>C</given-names></string-name>, <etal>et al.</etal></person-group><article-title>The UCSC Genome Browser database: 2019 update</article-title>. <source>Nucleic Acids Res</source>. <year>2018</year>;<volume>47</volume>(<issue>D1</issue>):<fpage>D853</fpage>–<lpage>8</lpage>.</mixed-citation>
    </ref>
    <ref id="bib35">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>König</surname><given-names>IR</given-names></string-name>, <string-name><surname>Loley</surname><given-names>C</given-names></string-name>, <string-name><surname>Erdmann</surname><given-names>J</given-names></string-name>, <etal>et al.</etal></person-group><article-title>How to include chromosome X in your genome-wide association study</article-title>. <source>Genet Epidemiol</source>. <year>2014</year>;<volume>38</volume>(<issue>2</issue>):<fpage>97</fpage>–<lpage>103</lpage>.<pub-id pub-id-type="pmid">24408308</pub-id></mixed-citation>
    </ref>
    <ref id="bib36">
      <label>37.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><collab>Continuum Analytics, Inc</collab>.</person-group><source>Package, dependency and environment management for any language—Python, R, Ruby, Lua, Scala, Java, JavaScript, C/ C++, FORTRAN, and more</source>; <year>2017</year>. <comment><ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://docs.conda.io/en/latest/" ext-link-type="uri">https://docs.conda.io/en/latest/</ext-link>. Accessed 16 October 2020</comment>.</mixed-citation>
    </ref>
    <ref id="bib37">
      <label>38.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>McLay</surname><given-names>R</given-names></string-name>, <string-name><surname>Schulz</surname><given-names>KW</given-names></string-name>, <string-name><surname>Barth</surname><given-names>WL</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Best practices for the deployment and management of production HPC clusters</article-title>. In: <source>SC '11: International Conference for High Performance Computing, Networking, Storage and Analysis, Seattle, WA</source>. <publisher-name>ACM</publisher-name>; <year>2011</year>:doi:<pub-id pub-id-type="doi">10.1145/2063348.2063360</pub-id>.</mixed-citation>
    </ref>
    <ref id="bib38">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>International HapMap</surname><given-names>Consortium</given-names></string-name>, <string-name><surname>Frazer</surname><given-names>KA</given-names></string-name>, <string-name><surname>Ballinger</surname><given-names>DG</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A second generation human haplotype map of over 3.1 million SNPs</article-title>. <source>Nature</source>. <year>2007</year>;<volume>449</volume>(<issue>7164</issue>):<fpage>851</fpage>–<lpage>61</lpage>.<pub-id pub-id-type="pmid">17943122</pub-id></mixed-citation>
    </ref>
    <ref id="bib39">
      <label>40.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Kitts</surname><given-names>A</given-names></string-name>, <string-name><surname>Sherry</surname><given-names>S</given-names></string-name></person-group>. <article-title>The Single Nucleotide Polymorphism Database (dbSNP) of nucleotide sequence variation</article-title>. In: <person-group person-group-type="editor"><string-name><surname>McEntyre</surname><given-names>J</given-names></string-name>, <string-name><surname>Ostell</surname><given-names>J</given-names></string-name></person-group>, eds. <source>The NCBI Handbook</source>. <publisher-loc>Bethesda, MD</publisher-loc>: <publisher-name>National Center for Biotechnology Information</publisher-name>; <year>2011</year>. <comment><ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.ncbi.nlm.nih.gov/books/NBK21088/" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/books/NBK21088/</ext-link></comment>.</mixed-citation>
    </ref>
    <ref id="bib44_1624294185882">
      <label>41.</label>
      <mixed-citation publication-type="journal"><source>GWAS Pipeline for H3Africa</source>, <comment><ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/h3abionet/h3agwas/" ext-link-type="uri">https://github.com/h3abionet/h3agwas/</ext-link>. Accessed 16 October 2020</comment></mixed-citation>
    </ref>
    <ref id="bib40">
      <label>42.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Purcell</surname><given-names>S</given-names></string-name>, <string-name><surname>Neale</surname><given-names>B</given-names></string-name>, <string-name><surname>Todd-Brown</surname><given-names>K</given-names></string-name>, <etal>et al.</etal></person-group><article-title>PLINK: A tool set for whole-genome association and population-based linkage analyses</article-title>. <source>Am J Hum Genet</source>. <year>2007</year>;<volume>81</volume>(<issue>3</issue>):<fpage>559</fpage>–<lpage>75</lpage>.<pub-id pub-id-type="pmid">17701901</pub-id></mixed-citation>
    </ref>
    <ref id="bib41">
      <label>43.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname><given-names>P</given-names></string-name>, <string-name><surname>Bonfield</surname><given-names>JK</given-names></string-name>, <string-name><surname>Liddle</surname><given-names>J</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Twelve years of SAMtools and BCFtools</article-title>. <source>Gigascience</source>. <year>2021</year>;<volume>10</volume>(<issue>2</issue>): doi:<pub-id pub-id-type="doi">10.1093/gigascience/giab008</pub-id>.</mixed-citation>
    </ref>
    <ref id="bib42">
      <label>44.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kässens</surname><given-names>J</given-names></string-name>, <string-name><surname>Wienbrandt</surname><given-names>L</given-names></string-name>, <string-name><surname>Ellinghaus</surname><given-names>D</given-names></string-name></person-group>. <article-title>Supporting data for “BIGwas: Single-command quality control and association testing for multi-cohort and biobank-scale GWAS/PheWAS data."</article-title>. <source>GigaScience Database</source>; <year>2021</year>. <pub-id pub-id-type="doi">10.5524/100895</pub-id>.</mixed-citation>
    </ref>
  </ref-list>
</back>
