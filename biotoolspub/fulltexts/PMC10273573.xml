<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10273573</article-id>
    <article-id pub-id-type="publisher-id">5230</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05230-2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>WormTensor: a clustering method for time-series whole-brain activity data from <italic>C. elegans</italic></article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Tsuyuzaki</surname>
          <given-names>Koki</given-names>
        </name>
        <address>
          <email>koki.tsuyuzaki@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yamamoto</surname>
          <given-names>Kentaro</given-names>
        </name>
        <address>
          <email>yamaken37.the.answer@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Toyoshima</surname>
          <given-names>Yu</given-names>
        </name>
        <address>
          <email>ytoyo@bs.s.u-tokyo.ac.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sato</surname>
          <given-names>Hirofumi</given-names>
        </name>
        <address>
          <email>hisato@bs.s.u-tokyo.ac.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kanamori</surname>
          <given-names>Manami</given-names>
        </name>
        <address>
          <email>mkanamori@bs.s.u-tokyo.ac.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Teramoto</surname>
          <given-names>Takayuki</given-names>
        </name>
        <address>
          <email>teramoto.takayuki.873@m.kyushu-u.ac.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ishihara</surname>
          <given-names>Takeshi</given-names>
        </name>
        <address>
          <email>takeiscb@kyushu-u.org</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Iino</surname>
          <given-names>Yuichi</given-names>
        </name>
        <address>
          <email>iino@bs.s.u-tokyo.ac.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Nikaido</surname>
          <given-names>Itoshi</given-names>
        </name>
        <address>
          <email>itoshi.nikaido@riken.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.508743.d</institution-id><institution-id institution-id-type="ISNI">0000 0004 7434 0753</institution-id><institution>Laboratory for Bioinformatics Research RIKEN Center for Biosystems Dynamics Research, </institution></institution-wrap>Wako, Saitama 351-0198 Japan </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.26999.3d</institution-id><institution-id institution-id-type="ISNI">0000 0001 2151 536X</institution-id><institution>Department of Biological Sciences, Graduate School of Science, </institution><institution>The University of Tokyo, </institution></institution-wrap>Bunkyo-ku, Tokyo, 113-0033 Japan </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.177174.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2242 4849</institution-id><institution>Department of Biology, Faculty of Sciences, </institution><institution>Kyushu University, </institution></institution-wrap>744, Motooka, Nishi-ku, Fukuoka, 819-0395 Japan </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.20515.33</institution-id><institution-id institution-id-type="ISNI">0000 0001 2369 4728</institution-id><institution>Bioinformatics Course, Master’s/Doctoral Program in Life Science Innovation (T-LSI), School of Integrative and Global Majors (SIGMA), </institution><institution>University of Tsukuba, </institution></institution-wrap>Wako, Saitama 351-0198 Japan </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.265073.5</institution-id><institution-id institution-id-type="ISNI">0000 0001 1014 9130</institution-id><institution>Department of Functional Genome Informatics, Division of Biological Data Science, Medical Research Institute, </institution><institution>Tokyo Medical and Dental University (TMDU), </institution></institution-wrap>Tokyo, 113-8510 Japan </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>254</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>3</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">In the field of neuroscience, neural modules and circuits that control biological functions have been found throughout entire neural networks. Correlations in neural activity can be used to identify such neural modules. Recent technological advances enable us to measure whole-brain neural activity with single-cell resolution in several species including <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Caenorhabditis\ elegans$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>h</mml:mi><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mspace width="4pt"/><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>g</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq1.gif"/></alternatives></inline-formula>. Because current neural activity data in <italic>C. elegans</italic> contain many missing data points, it is necessary to merge results from as many animals as possible to obtain more reliable functional modules.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">In this work, we developed a new time-series clustering method, WormTensor, to identify functional modules using whole-brain activity data from <italic>C. elegans</italic>. WormTensor uses a distance measure, modified shape-based distance to account for the lags and the mutual inhibition of cell–cell interactions and applies the tensor decomposition algorithm multi-view clustering based on matrix integration using the higher orthogonal iteration of tensors (HOOI) algorithm (MC-MI-HOOI), which can estimate both the weight to account for the reliability of data from each animal and the clusters that are common across animals.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">We applied the method to 24 individual <italic>C. elegans</italic> and successfully found some known functional modules. Compared with a widely used consensus clustering method to aggregate multiple clustering results, WormTensor showed higher silhouette coefficients. Our simulation also showed that WormTensor is robust to contamination from noisy data. WormTensor is freely available as an R/CRAN package <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/WormTensor">https://cran.r-project.org/web/packages/WormTensor</ext-link>.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05230-2.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>
        <italic>C. elegans</italic>
      </kwd>
      <kwd>NaCl stimuli</kwd>
      <kwd>Calcium imaging</kwd>
      <kwd>Neural activity</kwd>
      <kwd>Functional modules</kwd>
      <kwd>Tensor decomposition</kwd>
      <kwd>Weighting</kwd>
      <kwd>Consensus clustering</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001695</institution-id>
            <institution>Japan Science and Technology Corporation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>JPMJPR1945</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>The special postdoctoral researcher program at RIKEN</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001691</institution-id>
            <institution>Japan Society for the Promotion of Science</institution>
          </institution-wrap>
        </funding-source>
        <award-id>19K20406</award-id>
        <principal-award-recipient>
          <name>
            <surname>Tsuyuzaki</surname>
            <given-names>Koki</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par21">Nervous systems sense information from the external environment and produce appropriate response behaviors in living animals. Thus, sensory neurons respond to the environmental stimuli, and interneurons and motor neurons are activated in a manner dependent on the activity of the sensory neurons. These neurons showing correlated activities form a functional module, and many efforts have been made to identify such functional modules and understand their dynamics [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>].</p>
    <p id="Par22">The nematode <inline-formula id="IEq3"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Caenorhabditis\ elegans$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>h</mml:mi><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mspace width="4pt"/><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>g</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq3.gif"/></alternatives></inline-formula> is a model animal in behavioral neuroscience. <italic>C. elegans</italic> are known to migrate toward chemoattractants including sodium chloride (NaCl). This means that changes in NaCl concentration function as external stimuli for the nervous system, and such stimuli can be used to identify functional modules among neurons involved in the induced behavior. In addition, the nervous system of the nematode consists of 302 neurons whose name and connectivity have already been identified anatomically [<xref ref-type="bibr" rid="CR3">3</xref>]. The small and transparent body of <italic>C. elegans</italic> is suitable for measuring neural activity by calcium imaging [<xref ref-type="bibr" rid="CR4">4</xref>]. Furthermore, advanced molecular genetics techniques facilitate labeling each neuron in living animals [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. These features enable researchers to obtain functional modules in a comprehensive manner by measuring the whole-brain activity with single-cell resolution.</p>
    <p id="Par23">Several groups, including our own, have already obtained whole-brain activity data from nematodes with neuron identity information [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR10">10</xref>]. However, the obtained whole-brain activity data have several problems that impede the identification of functional modules. In the whole-brain activity data, some neurons are not detected or identified, and are excluded as missing values [<xref ref-type="bibr" rid="CR6">6</xref>]. The excluded neurons vary among individual animals, and more than half of the neurons are excluded in some experiments. In addition, neural networks show spontaneous and synchronized activities that mask information associated with external stimuli [<xref ref-type="bibr" rid="CR6">6</xref>]. These activities differ among individual animals, complicating direct comparisons of correlations in neural activities among individual animals. Thus, to find functional modules in whole-brain activity data, we need to resolve the problems of missing values and individual differences in neural states.</p>
    <p id="Par24">Here we present a method WormTensor to find functional modules that are common among individual animals in whole-brain activity data while allowing missing values. We apply the method to our whole-brain data from 24 animals and successfully identify known functional modules. WormTensor uses a distance measure called modified shape-based distance (mSBD) to account for time delay (lag) of cell-cell interactions. In addition, WormTensor uses a tensor decomposition called multi-view clustering based on matrix integration using the HOOI algorithm (MC-MI-HOOI) to detect clusters of cells common to multiple animals and weights for each animal simultaneously. WormTensor is freely available as an R/CRAN package <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/WormTensor">https://cran.r-project.org/web/packages/WormTensor</ext-link>.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>WormTensor showed high silhouette coefficients</title>
      <p id="Par25">To evaluate the effectivity of usage of mSBD and MC-MI-HOOI, we tested all the combinations of two distance measures (Euclidean distance and mSBD) and two clustering methods (<italic>cluster-based similarity partitioning algorithm</italic> (CSPA) [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>] and MC-MI-HOOI) (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). For the details, see the Material and Methods section.<fig id="Fig1"><label>Fig. 1</label><caption><p><bold>a</bold> Schematic of WormTensor. The neural activity data matrices measured for <italic>M</italic> animals are transformed into the distance matrices and the membership matrices (binary matrices). In the cluster-based similarity partitioning algorithm (CSPA), the consensus matrix is averaged over all the membership matrices and used for downstream clustering and visualization (t-distributed stochastic neighbor embedding (t-SNE) and uniform manifold approximation and projection (UMAP)). WormTensor, on the other hand, does not take the average, but regards the multiple membership matrices as a third-order tensor, applies tensor decomposition, and uses the computed <italic>K</italic> dimensional factor matrix U for downstream analysis. WormTensor also generates weight vector W, which contains the weights for data from each of the animals. <bold>b</bold> Neuronal activities of neurons with the same phase. In this case, the positive correlation coefficient between AVAR and RIMR is maximized when translating AVAR to the right by <inline-formula id="IEq4"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau = 35$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>35</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq4.gif"/></alternatives></inline-formula>. <bold>c</bold> Neuronal activities of neurons with reverse phases. In this case, the negative correlation coefficient between ASEL and ASER is minimized when translating ASEL to the right by <inline-formula id="IEq5"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau = 14$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>14</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq5.gif"/></alternatives></inline-formula>. mSBD handles both (<bold>b</bold>) and (<bold>c</bold>) cases in a unified manner by taking the absolute value of the correlation coefficient</p></caption><graphic xlink:href="12859_2023_5230_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par26">For all the combinations, we quantitatively evaluated the clustering results using silhouette coefficients [<xref ref-type="bibr" rid="CR13">13</xref>] (see Material and Methods). The values of silhouette coefficients were calculated in each cell of each animal to show how each cluster is aggregated compared to the other clusters. The averaged value of the silhouette coefficients of all the cells was calculated in each number of clusters (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). The values showed that, regardless of the number of clusters and the distance measures, MC-MI-HOOI was able to capture more aggregated clusters compared with CSPA. Additionally, mSBD further outperformed Euclidean distance, which suggests that there are lags of cell–cell interactions between neurons in <italic>C. elegans</italic>, and correcting for the shift-invariance contributes to detecting clusters that are repeated across animals.</p>
    </sec>
    <sec id="Sec4">
      <title>Estimation of the optimal number of clusters</title>
      <p id="Par27">Using the cellular labels listing the known functional modules (Additional files <xref rid="MOESM1" ref-type="media">1</xref> and <xref rid="MOESM2" ref-type="media">2</xref>), we found that the NaCl stimulus-related cells and principal component 1-related cells with positive coefficients (PC1_pos-related) cells were relatively easy to detect as clusters in many clustering methods. PC1_pos-related cells were heavily weighted in the first principal component of whole-brain activity data in a previous study [<xref ref-type="bibr" rid="CR8">8</xref>] and are involved in forward and backward locomotion of <italic>C. elegans</italic>.<fig id="Fig2"><label>Fig. 2</label><caption><p>Estimation of the number of clusters. The number of clusters was estimated by silhouette coefficients and prior knowledge about the movement of <italic>C. elegans</italic>. The cluster-based similarity partitioning algorithm (CSPA) and WormTensor with Euclidean distance and modified shape-based distance (mSBD) are performed with the number of clusters (2–20). <bold>a</bold> The <italic>x</italic>-axis represents the number of clusters, and the <italic>y</italic>-axis represents the average silhouette coefficient for all the cells for each number of clusters. <bold>b</bold> The silhouette coefficient for each cell in the optimal number of clusters</p></caption><graphic xlink:href="12859_2023_5230_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par28">NaCl- and PC1_pos-related cells could be differentiated without negative silhouette coefficients when WormTensor considered six clusters (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). Therefore, we regarded this value as the optimal number of clusters for WormTensor and used six clusters in further analysis. For MC-MI-HOOI with Euclidean distance and CSPA with mSBD, similar results were obtained when the number of clusters was 10 and 5, respectively. For CSPA with Euclidean distance, however, only PC1_pos-related cells were detected as a cluster. For the details of these clustering results, see Additional files <xref rid="MOESM2" ref-type="media">2</xref>, <xref rid="MOESM3" ref-type="media">3</xref>, <xref rid="MOESM4" ref-type="media">4</xref>, <xref rid="MOESM5" ref-type="media">5</xref>, <xref rid="MOESM6" ref-type="media">6</xref>, <xref rid="MOESM7" ref-type="media">7</xref> and <xref rid="MOESM8" ref-type="media">8</xref>).</p>
    </sec>
    <sec id="Sec5">
      <title>WormTensor detected NaCl stimulus-related and movement-related cells</title>
      <p id="Par29">Figure <xref rid="Fig3" ref-type="fig">3</xref> shows the UMAP plots for all the combinations of the distance measures and the clustering methods. As the plots of WormTensor (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d) and CSPA with mSBD (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c) show, NaCl stimulus-related cells (cluster <inline-formula id="IEq6"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#5$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mo>#</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq6.gif"/></alternatives></inline-formula> for WormTensor, <inline-formula id="IEq7"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#3$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mo>#</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq7.gif"/></alternatives></inline-formula> for CSPA with mSBD) and PC1_pos-related cells (cluster <inline-formula id="IEq8"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#6$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mo>#</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq8.gif"/></alternatives></inline-formula> for WormTensor, <inline-formula id="IEq9"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#4$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mo>#</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq9.gif"/></alternatives></inline-formula> for CSPA with mSBD) were separated as distinct clusters.</p>
      <p id="Par30">Using prior knowledge about the neuronal cells (Additional files <xref rid="MOESM1" ref-type="media">1</xref> and <xref rid="MOESM2" ref-type="media">2</xref>), we interpreted some clusters (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). For example, the cells that formed clusters are not clustered according to the neuron type, e.g., “Non-neuronal cells”, “Interneuron”, “Motor neuron”, and “Sensory neuron”, based on WormWiring annotation (<ext-link ext-link-type="uri" xlink:href="https://wormwiring.org">https://wormwiring.org</ext-link>) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). Rather, it showed a structure that followed the known functional modules, such as NaCl stimulus (cluster <inline-formula id="IEq10"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#5$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mo>#</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq10.gif"/></alternatives></inline-formula>), PC1_pos (cluster <inline-formula id="IEq11"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#6$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mo>#</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq11.gif"/></alternatives></inline-formula>), and principal component 1-related cells with negative coefficients (cluster <inline-formula id="IEq12"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#4$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mo>#</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq12.gif"/></alternatives></inline-formula>, PC1_neg [<xref ref-type="bibr" rid="CR8">8</xref>]) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). We assessed “consistency” between the clusters of WormTensor calculated from all the animals and the clusters calculated in each animal (see Materials and Methods). By using this measure, these three clusters were found to be reproducibly detected in the majority of animals (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c). For another presentation of the results of Figs. <xref rid="Fig3" ref-type="fig">3</xref> and <xref rid="Fig4" ref-type="fig">4</xref> with the t-SNE coordinates, see Additional files <xref rid="MOESM9" ref-type="media">9</xref> and <xref rid="MOESM10" ref-type="media">10</xref>.<fig id="Fig3"><label>Fig. 3</label><caption><p>Results of clustering with the optimal number of clusters utilizing t-distributed stochastic neighbor embedding (t-SNE) and uniform manifold approximation and projection (UMAP). <bold>a</bold> The clustering results of the cluster-based similarity partitioning algorithm (CSPA) with Euclidean distance. <bold>b</bold> The clustering results of multi-view clustering based on matrix integration using the HOOI algorithm (MC-MI-HOOI) with Euclidean distance. <bold>c</bold> The clustering results of CSPA with modified shape-based distance (mSBD). <bold>d</bold> The clustering results of WormTensor, utilizing MC-MI-HOOI with mSBD</p></caption><graphic xlink:href="12859_2023_5230_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par31">In addition to the three clusters above, another cluster was also annotated based on previous reports. We also evaluated whether a set of annotation terms is enriched within each cluster using the hypergeometric test and Benjamini-Hochberg method [<xref ref-type="bibr" rid="CR14">14</xref>] to correct for the multiple testing problem (Additional file <xref rid="MOESM11" ref-type="media">11</xref>).</p>
      <p id="Par32">According to this approach, for example, some PC2-related cells (these cells were heavily weighted in the second principal component of whole-brain activity data in the previous study [<xref ref-type="bibr" rid="CR8">8</xref>] that are involved in turning movement of <italic>C. elegans</italic>) were enriched in cluster <inline-formula id="IEq13"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#3$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mo>#</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq13.gif"/></alternatives></inline-formula> (Table <xref rid="Tab1" ref-type="table">1</xref>).<table-wrap id="Tab1"><label>Table 1</label><caption><p>Summary of the clustering results of WormTensor</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Cluster No.</th><th align="left">Our annotations</th><th align="left">Example cells</th></tr></thead><tbody><tr><td align="left">#1</td><td align="left">Unknown</td><td align="left">–</td></tr><tr><td align="left">#2</td><td align="left">PC2-related cells</td><td align="left">SMDVR, RIVL/R</td></tr><tr><td align="left">#3</td><td align="left">PC2-related cells</td><td align="left">AIBR, OLQDL/R, SMDVL</td></tr><tr><td align="left">#4</td><td align="left"><p>PC1_neg-related cells and some epidermal cells</p><p>(The number of identified cells is relatively low; see Fig. <xref rid="Fig4" ref-type="fig">4</xref>d)</p></td><td align="left">RIBL, RMED, RMEL/R, RMEV</td></tr><tr><td align="left">#5</td><td align="left">NaCl stimulus-related cells</td><td align="left">ASEL/R, AWBL, AWCL/R, BAGL/R</td></tr><tr><td align="left">#6</td><td align="left">PC1_pos-related cells</td><td align="left">AVAL/R, AVER, RIML/R, (AIBL)</td></tr></tbody></table></table-wrap><table-wrap id="Tab2"><label>Table 2</label><caption><p>Summary of the <italic>C. elegans</italic> animals used</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Animal no.</th><th align="left">No. of cells</th><th align="left">Frame/sec</th><th align="left">QC by visual inspection</th></tr></thead><tbody><tr><td align="left">#1</td><td char="." align="char">161</td><td char="." align="char">4.12</td><td align="left">PASS</td></tr><tr><td align="left">#2</td><td char="." align="char">182</td><td char="." align="char">5.72</td><td align="left">PASS</td></tr><tr><td align="left">#3</td><td char="." align="char">158</td><td char="." align="char">5.71</td><td align="left">WARNING (temporary abnormal waveform)</td></tr><tr><td align="left">#4</td><td char="." align="char">180</td><td char="." align="char">5.71</td><td align="left">PASS</td></tr><tr><td align="left">#5</td><td char="." align="char">197</td><td char="." align="char">5.71</td><td align="left">PASS</td></tr><tr><td align="left">#6</td><td char="." align="char">180</td><td char="." align="char">5.71</td><td align="left">PASS</td></tr><tr><td align="left">#7</td><td char="." align="char">196</td><td char="." align="char">5.72</td><td align="left">PASS</td></tr><tr><td align="left">#8</td><td char="." align="char">196</td><td char="." align="char">5.72</td><td align="left">WARNING (temporary abnormal waveform)</td></tr><tr><td align="left">#9</td><td char="." align="char">173</td><td char="." align="char">5.72</td><td align="left">PASS</td></tr><tr><td align="left">#10</td><td char="." align="char">191</td><td char="." align="char">5.71</td><td align="left">PASS</td></tr><tr><td align="left">#11</td><td char="." align="char">157</td><td char="." align="char">5.71</td><td align="left">PASS</td></tr><tr><td align="left">#12</td><td char="." align="char">168</td><td char="." align="char">5.71</td><td align="left">PASS</td></tr><tr><td align="left">#13</td><td char="." align="char">211</td><td char="." align="char">4.12</td><td align="left">PASS</td></tr><tr><td align="left">#14</td><td char="." align="char">231</td><td char="." align="char">3.73</td><td align="left">PASS</td></tr><tr><td align="left">#15</td><td char="." align="char">201</td><td char="." align="char">3.69</td><td align="left">PASS</td></tr><tr><td align="left">#16</td><td char="." align="char">198</td><td char="." align="char">3.69</td><td align="left">PASS</td></tr><tr><td align="left">#17</td><td char="." align="char">202</td><td char="." align="char">4.10</td><td align="left">PASS</td></tr><tr><td align="left">#18</td><td char="." align="char">214</td><td char="." align="char">4.05</td><td align="left">PASS</td></tr><tr><td align="left">#19</td><td char="." align="char">215</td><td char="." align="char">4.05</td><td align="left">PASS</td></tr><tr><td align="left">#20</td><td char="." align="char">203</td><td char="." align="char">4.04</td><td align="left">FAILURE (severe abnormal waveform)</td></tr><tr><td align="left">#21</td><td char="." align="char">216</td><td char="." align="char">4.04</td><td align="left">PASS</td></tr><tr><td align="left">#22</td><td char="." align="char">181</td><td char="." align="char">4.09</td><td align="left">PASS</td></tr><tr><td align="left">#23</td><td char="." align="char">207</td><td char="." align="char">4.08</td><td align="left">PASS</td></tr><tr><td align="left">#24</td><td char="." align="char">207</td><td char="." align="char">4.07</td><td align="left">PASS</td></tr><tr><td align="left">#25</td><td char="." align="char">156</td><td char="." align="char">4.04</td><td align="left">WARNING (temporary abnormal waveform)</td></tr><tr><td align="left">#26</td><td char="." align="char">196</td><td char="." align="char">4.06</td><td align="left">PASS</td></tr><tr><td align="left">#27</td><td char="." align="char">220</td><td char="." align="char">4.05</td><td align="left">PASS</td></tr><tr><td align="left">#28</td><td char="." align="char">207</td><td char="." align="char">3.99</td><td align="left">PASS</td></tr></tbody></table><table-wrap-foot><p>All neural activity values were measured for 6000 time frames</p></table-wrap-foot></table-wrap></p>
      <p id="Par33">While AIBL is a PC2-related cell, it is categorized in PC1_pos cluster. This is probably because AIBL is involved in PC2 as well as PC1_pos, as previously shown [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR15">15</xref>]. Likewise, AVBR, which is one of the PC1_neg-related cells categorized in PC2 cluster, might be involved in both PC1_neg and PC2, as some studies have suggested [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR16">16</xref>].</p>
      <p id="Par34">Although the NaCl stimulus and PC1_pos-related cells were detected by both WormTensor and CSPA with mSBD, WormTensor was more able to enrich a cluster with PC1_neg-related cells (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b and Additional file <xref rid="MOESM11" ref-type="media">11</xref>). In consideration of these results together with its high silhouette coefficient (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a), WormTensor was found to be the most suitable for capturing functional modules in <italic>C. elegans</italic> compared with the other methods tested in this study.</p>
    </sec>
    <sec id="Sec6">
      <title>WormTensor automatically assigned small weights to animals with a small number of identified cells and noisy data</title>
      <p id="Par35">Unlike CSPA, which assumes that all animals have common clusters, WormTensor is a model that allows differences among animals; in the optimization process, animals without common clusters are automatically evaluated with smaller weights. We further interpreted the weights of WormTensor. We investigated whether the datasets contain any covariates that are correlated with the weights and found at least three possible covariates as follows.<fig id="Fig4"><label>Fig. 4</label><caption><p>Results of WormTensor utilizing t-distributed stochastic neighbor embedding (t-SNE) and uniform manifold approximation and projection (UMAP). <bold>a</bold> Neuron type (based on WormWiring annotation). <bold>b</bold> The labels of movement in <italic>C. elegans</italic>. <bold>c</bold> Consistency between the results of hierarchical clustering in each animal and WormTensor. <bold>d</bold> The number of identified cells</p></caption><graphic xlink:href="12859_2023_5230_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par36">The first potential covariate is the total number of annotated cells in each animal (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a, black line). To evaluate whether this possible covariate is correlated with the weights in the result of WormTensor with 6 clusters, we performed the Cochran–Armitage trend test, and the <italic>p</italic>-value was <inline-formula id="IEq14"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5.60E-34$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mn>5.60</mml:mn><mml:mi>E</mml:mi><mml:mo>-</mml:mo><mml:mn>34</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq14.gif"/></alternatives></inline-formula>.</p>
      <p id="Par37">The second potential covariate is the similarity between the clustering results of WormTensor and the clustering results of individual animals (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a, red line). The similarity was quantified using the adjusted Rand index (ARI [<xref ref-type="bibr" rid="CR17">17</xref>]) between them, and the <italic>p</italic>-value of the Jonckheere–Terpstra trend test was <inline-formula id="IEq15"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$9.66E-4$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mn>9.66</mml:mn><mml:mi>E</mml:mi><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq15.gif"/></alternatives></inline-formula>.</p>
      <p id="Par38">Both of these tests were highly significant at the <inline-formula id="IEq16"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p &lt; 0.05$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq16.gif"/></alternatives></inline-formula> level and thus indicate decreasing trends in the number of identified cells and the similarity of clustering results according to the weights (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). We also investigated the results with different numbers of clusters (2–20) (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b) and found that the animals with small weights were generally assigned robustly small values independent of the number of clusters.<fig id="Fig5"><label>Fig. 5</label><caption><p>Interpretation of the weights of WormTensor. <bold>a</bold> The <italic>x</italic>-axis represents the animals sorted by their weights in WormTensor with the number of clusters set to 6. the left <italic>y</italic>-axis represents the adjusted Rand index (ARI) value between the result of clustering by WormTensor and Ward’s hierarchical clustering, and the right <italic>y</italic>-axis represents the number of identified cells. <bold>b</bold> The <italic>y</italic>-axis shows the weights of all the animals for different numbers of cluster (2–20) and the <italic>x</italic>-axis shows the animals sorted by their average weights with different numbers of clusters</p></caption><graphic xlink:href="12859_2023_5230_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par39">The third potential covariate is the noisiness of temporal patterns in data from each animal. In this work, the data matrices from three animals (<inline-formula id="IEq17"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#3$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mo>#</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq17.gif"/></alternatives></inline-formula>, <inline-formula id="IEq18"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#8$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mo>#</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq18.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq19"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#25$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mo>#</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq19.gif"/></alternatives></inline-formula>) that contained abnormal waveforms in all the cells regardless of cell type and were excluded from the analysis by prior quality control (QC) (Table <xref rid="Tab2" ref-type="table">2</xref>) were added to the WormTensor input individually. The weights for animals <inline-formula id="IEq20"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#3$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mo>#</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq20.gif"/></alternatives></inline-formula>, <inline-formula id="IEq21"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#8$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mo>#</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq21.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq22"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#25$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mo>#</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq22.gif"/></alternatives></inline-formula> were automatically reduced (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a–c), and similar results were obtained when all three animals were input into WormTensor at once (Fig. <xref rid="Fig6" ref-type="fig">6</xref>d).</p>
      <p id="Par40">We also added the data matrix from animal <inline-formula id="IEq23"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#20$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:mo>#</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq23.gif"/></alternatives></inline-formula>, whose temporal patterns were contaminated with extremely strong noise. For this animal, however, WormTensor’s effect of reducing weight for noisy data was modest (as it was ranked 8-th according to weight among all the animals, Additional file <xref rid="MOESM12" ref-type="media">12</xref>). Further examination revealed that animal <inline-formula id="IEq24"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#20$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:mo>#</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq24.gif"/></alternatives></inline-formula> had left the holding position of the microfluidic chip during imaging and moved outside of the field of view, which caused an abnormal fluorescence intensity change in all cells (Additional file <xref rid="MOESM12" ref-type="media">12</xref>). There are at least two possible explanations for the high weight despite the anomaly of the waveforms. First, the number of cells that could be tracked before the abnormal waves occurred was relatively large, so WormTensor estimated the weights to be high. Second, an outlier distance matrix may have been generated from animal <inline-formula id="IEq25"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#20$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mo>#</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq25.gif"/></alternatives></inline-formula> and optimization subsequently overfitted data from the animal.</p>
      <p id="Par41">Although the above covariates alone do not perfectly explain the weights, as all of the above covariates are related to data quality, the property of WormTensor that automatically reduces the weights for such unreliable animals’ datasets is expected to be useful from a QC perspective; even if some low-quality data is inadvertently included in the analysis, the weights may mitigate the negative effects to some extent. Of course, as weights alone do not perfectly eliminate low-quality datasets (e.g., animal <inline-formula id="IEq26"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#20$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mo>#</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq26.gif"/></alternatives></inline-formula>), it is also important to investigate the details of the data and to be aware of low-quality animals by visual inspection. To assist such efforts, we have implemented several visualization functions (see Implementation).</p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Discussion</title>
    <p id="Par42">In this analysis, we applied the WormTensor method to our whole-brain activity data from <italic>C. elegans</italic> and successfully obtained functional modules. In <italic>C. elegans</italic>, it is well known that most neurons do not have action potentials, and the neural activities instead change gradually. In addition, the temporal patterns of neural activities show positive and negative correlations with each other as well as lags of several lengths. Many biological dynamic systems, spanning intracellular signal transduction to animal behaviors, have similar features, and WormTensor should be suitable for extracting functional modules from temporal dynamics of such systems.<fig id="Fig6"><label>Fig. 6</label><caption><p>Robustness to noisy data addition. <bold>a</bold>–<bold>c</bold> The order of WormTensor weights of the animals when an additional noisy data matrix was added individually. <bold>d</bold> The order of WormTensor weights of the animals when three noisy data matrices were added at once. The arrows indicate the added noisy datasets</p></caption><graphic xlink:href="12859_2023_5230_Fig6_HTML" id="MO6"/></fig><fig id="Fig7"><label>Fig. 7</label><caption><p>Workflow of the WormTensor package. All the functions can be performed using R’s native pipe operation</p></caption><graphic xlink:href="12859_2023_5230_Fig7_HTML" id="MO7"/></fig></p>
    <p id="Par43">Because we did not set the upper and lower limits of the lag, it may be reasonably speculated many false positive pairs are clustered with extremely large (or small) <inline-formula id="IEq27"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\tau }$$\end{document}</tex-math><mml:math id="M52"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq27.gif"/></alternatives></inline-formula> values that are biologically meaningless. However, we concluded that such a bias is not severe in the clustering results. For details, see Additional file <xref rid="MOESM13" ref-type="media">13</xref>.</p>
    <p id="Par44">Because WormTensor uses mSBD, which treats correlation and anti-correlation equally by evaluating an absolute value function, one could suppose that PC1_pos and PC1_neg could be assigned a common cluster. However, we concluded that these two groups did not and should not be in the same cluster. For details, see Additional file <xref rid="MOESM14" ref-type="media">14</xref>.</p>
    <p id="Par45">Prior to the use of silhouette coefficients, we used various external and internal measures [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>] (all of those measures can be reproduced as functions inside WormTensor). However, for the present data, we chose not to use them, except for the silhouette coefficient per cell (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). For the details, see Additional file <xref rid="MOESM15" ref-type="media">15</xref>.</p>
    <p id="Par46">By analyzing the neuronal activity data as a tensor instead of a matrix, the memory usage is increased from <inline-formula id="IEq28"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}\left( N \times N\right)$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mfenced close=")" open="("><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq28.gif"/></alternatives></inline-formula> to <inline-formula id="IEq29"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}\left( N \times N\times M\right)$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mfenced close=")" open="("><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq29.gif"/></alternatives></inline-formula>, where <italic>N</italic> is the number of cells and <italic>M</italic> is the number of animals. Therefore, compared to matrix-based methods such as CSPA, WormTensor might be considered somewhat computationally disadvantageous. However, this is not much of a problem in realistic situations, that is, the number of somatic cells in <italic>C. elegans</italic> is approximately 1000 [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>], so the upper limit of <italic>N</italic> is fixed. Additionally, the data size does not become particularly large unless <italic>M</italic> is quite large (e.g., over 1000 animals).</p>
    <p id="Par47">We believe that the advantages of using tensor decomposition outweigh the above disadvantages; this approach not only improves silhouette coefficient compared to consensus clustering, as discussed in this work, but also allows for automatic estimation of weights. In data analysis that deals with multiple data sets (e.g., multiple individuals/multi-view/multi-modal/multi-omics data [<xref ref-type="bibr" rid="CR22">22</xref>–<xref ref-type="bibr" rid="CR26">26</xref>] and heterogeneous data fusion [<xref ref-type="bibr" rid="CR27">27</xref>]), data with large values, a large number of patterns, and large size may dominate in optimization, and multiple data may not be treated equally. Alternatively, it may be the case that data of low quality are excluded from optimization because merging them with equal weight would reduce the performance of the overall optimization. In either case, it is necessary to appropriately weigh the individual datasets during optimization. Hence, weighting is not a trivial issue.</p>
    <p id="Par48">Some ad hoc weighting approaches, such as using L2-norm [<xref ref-type="bibr" rid="CR23">23</xref>], the number of observed elements [<xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR29">29</xref>], variance [<xref ref-type="bibr" rid="CR25">25</xref>], the first eigenvalue [<xref ref-type="bibr" rid="CR24">24</xref>], and correlations with an external standard [<xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR30">30</xref>], can be used as the weight of each matrix/tensor, but it is unclear which approaches are appropriate. In contrast, in the tensor decomposition algorithm we used, the weights are not pre-set but are instead automatically estimated from the dataset. Therefore, there is no need to discuss the arbitrariness of the approaches described above. Moreover, based on the estimated weights, it can be appropriately used to investigate which animals were considered important or not. This ability is considered an excellent property for the purpose of QC.</p>
    <p id="Par49">From a different point of view, outlier animals with clusters that are not common among multiple animals might be biologically meaningful. Although the original purpose of WormTensor is to find clusters that are common among multiple animals and the weights can be interpreted as the degree of commonality, since a small weight means that the data of the animal is not similar to those of other animals, the weights could also assist the task of finding outlier animals in the data. After finding the outliers, some analytical methods can be individually applied to such animals and we can investigate the details.</p>
    <sec id="Sec8">
      <title>Comparison with other studies</title>
      <p id="Par50">Several methods have been applied to analyze whole-brain neural activity in <italic>C. elegans</italic>. A switching linear dynamical system (SLDS) provides a method to estimate discrete hidden states in time series data. The SLDS method has been applied to whole-brain neural activity to estimate the internal states of neural networks common across multiple animals and their transitions [<xref ref-type="bibr" rid="CR31">31</xref>]. Other reports have analyzed whole-brain neural activity using PCA [<xref ref-type="bibr" rid="CR8">8</xref>], ridge regression [<xref ref-type="bibr" rid="CR32">32</xref>], and maximum entropy models [<xref ref-type="bibr" rid="CR33">33</xref>], but these have only been applied to single animals.</p>
      <p id="Par51">Tensor decomposition has been applied to analyze large-scale neural activity data. For example, tensor component analysis decomposes the neural population recordings of mice into neuronal, temporal, and trial factors and is able to extract gradual changes in neural activity as learning progresses [<xref ref-type="bibr" rid="CR34">34</xref>]. As another example, the shifted CP method decomposes electroencephalography (EEG) data from human subjects as a spatiotemporal superposition of components with a fixed time course and correctly unmixes the spatiotemporal signals in the EEG data [<xref ref-type="bibr" rid="CR35">35</xref>]. Thus, tensor decomposition is useful for analyzing large-scale neural activity data.</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Conclusion</title>
    <p id="Par52">Our analysis showed that the differences among distance measures and clustering algorithms can influence the results of time-series clustering the neuronal activity of <italic>C. elegans</italic>. The combination of mSBD and MC-MI-HOOI maximized the silhouette coefficients compared to the other tested combinations of methods and also matched well with prior knowledge about <italic>C. elegans</italic> neural modules.</p>
    <p id="Par53">To create distance matrices, we used Euclidean distance and mSBD, with the latter contributing to the detection of specific clusters of cell populations such as PC1_neg- and PC2-related cells. This suggests that the features considered only in mSBD, such as correlations in both positive and negative directions and lags, are important for detecting functional modules from <italic>C. elegans</italic> neural activity data.</p>
    <p id="Par54">The data in this study included some missing values in all animals, and when we assessed the only intersection of those cells with no missing values, not a single cell remained. In addition, it is difficult to determine how to make a comprehensive judgment when analyzing the data for each animal because of the degree of missing data and the large differences among the animals. Therefore, dealing with missing values was essential in this analysis. In our study, by simply setting the missing cells to 0 at the stage of creating the membership matrices, we were able to proceed with the subsequent analysis and extract biologically meaningful patterns.</p>
    <p id="Par55">Compared with CSPA, which takes the average of multiple clustering results into a consensus matrix, we found that the use of MC-MI-HOOI has some advantages; it does not use the average of clustering results, and it automatically assigns a weight to each animal instead while allowing for individual differences. In this work, the latter approach was empirically advantageous to detect functional modules from <italic>C. elegans</italic> neural activity data.</p>
    <p id="Par56">Furthermore, the estimated weights are expected to be useful in other analyses; MC-MI-HOOI automatically avoids clustering results derived from noisy data by assigning small weights to the corresponding animals, and the weights themselves can reasonably be used for QC of data from animals.</p>
    <p id="Par57">All of the analyses including time-series clustering and visualizations performed in this work have been implemented as R functions available within the WormTensor R/CRAN package and can be freely reproduced with user data.</p>
  </sec>
  <sec id="Sec10">
    <title>Materials and methods</title>
    <sec id="Sec11">
      <title>Dataset</title>
      <p id="Par58">The whole-brain activity dataset of <italic>C. elegans</italic> strains JN3038 obtained by Toyoshima et al. [<xref ref-type="bibr" rid="CR6">6</xref>] was used in this study. Briefly, each adult animal was held in a custom microfluidic chip and repeatedly stimulated by switching the sodium chloride concentration between 50mM and 25mM every 30 seconds. The volumetric movie of the head region of the animal was recorded at approximately 5 volumes per second using customized spinning-disc confocal microscopy. Genetically encoded calcium indicator Yellow-Cameleon 2.60 [<xref ref-type="bibr" rid="CR36">36</xref>] was expressed in all neurons of the animals. For each neuron, the time-series of fluorescent intensities of yellow fluorescent protein (YFP) and cyan fluorescent protein (CFP) of Yellow-Cameleon were obtained from the volumetric movie. The intensity ratio of YFP over CFP indicates the calcium level (fluorescence resonance energy transfer; FRET [<xref ref-type="bibr" rid="CR36">36</xref>]) and was used as an index of neural activity. A median filter [<xref ref-type="bibr" rid="CR37">37</xref>] with an 11-time point window was applied to the ratio to remove noise. The outlier neurons were removed from the dataset if the filtered ratio of the neuron contained missing values, negative values, or values larger than 10. The filtered ratio was smoothed using a third-order Savitzky–Golay filter [<xref ref-type="bibr" rid="CR38">38</xref>, <xref ref-type="bibr" rid="CR39">39</xref>] with a 101-time-point window. Finally, the time-series of smoothed ratios were scaled by dividing them by the mean value and subtracting 1. Annotation of neuronal identity was performed based on the spatial expression patterns of cell-specific promoters (i.e., landmark fluorescence) in the JN3038 strain. The dataset contains several non-neuronal cells, including GLR glial cells, pharyngeal gland cells, and hypodermal cells. Because a hypodermal cell has multiple nuclei (i.e., syncytium) and our experimental setup can detect each nucleus, we labeled them with the original name starting with HYPL.</p>
      <p id="Par59">The time-series neural activity values obtained from each animal were stored as a cell <inline-formula id="IEq30"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M58"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq30.gif"/></alternatives></inline-formula> time matrix. The measurements were collected from 28 animals, 4 of which were removed by QC, and the remaining 24 animals were used for our analysis (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a and Table <xref rid="Tab2" ref-type="table">2</xref>). Here, 192 cells in the 24 animals for which the neural activity values were measured at least once were included in the analysis. All neural activity values were measured for 6, 000 frames and the sampling rate (frame/sec) ranges from 3.69 to 5.73 (Table <xref rid="Tab2" ref-type="table">2</xref>). The above data matrices were converted to distance matrices (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). In this work, we used two distance measures: Euclidean distance and modified shape-based distance (mSBD). We explain mSBD below.</p>
      <sec id="Sec12">
        <title>Modified shape-based distance</title>
        <p id="Par60">To consider the lags of cell–cell interactions between neurons, we used a shift-invariant distance measure called shape-based distance (SBD [<xref ref-type="bibr" rid="CR40">40</xref>]) with some modification. For two arbitrary time-series data <italic>x</italic> and <italic>y</italic> SBD is given as<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \textrm{SBD}\left( x,y\right) = 1 - \max _{\mathrm {\tau }}{\left( \frac{R_{\tau -m}\left( x, y\right) }{\sqrt{\textrm{R}_{0}\left( x,x\right) \textrm{R}_{0}\left( y,y\right) }}\right) }, \end{aligned}$$\end{document}</tex-math><mml:math id="M60" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>SBD</mml:mtext><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:munder><mml:mo movablelimits="true">max</mml:mo><mml:mi>τ</mml:mi></mml:munder><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>τ</mml:mi><mml:mo>-</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mfenced></mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mtext>R</mml:mtext><mml:mn>0</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mfenced><mml:msub><mml:mtext>R</mml:mtext><mml:mn>0</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mfenced></mml:mrow></mml:msqrt></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5230_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq31"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau \in \{1,2,...,2m-1\}$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq31.gif"/></alternatives></inline-formula> is lag when sliding <italic>x</italic> to the right and <italic>m</italic> is the length of <italic>x</italic> and <italic>y</italic>. <inline-formula id="IEq32"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\tau -m}\left( x, y\right)$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>τ</mml:mi><mml:mo>-</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq32.gif"/></alternatives></inline-formula> is the cross-correlation measure between <italic>x</italic> and <italic>y</italic> with lag <inline-formula id="IEq33"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M66"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq33.gif"/></alternatives></inline-formula>. <inline-formula id="IEq34"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\tau -m}\left( x, y\right)$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>τ</mml:mi><mml:mo>-</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq34.gif"/></alternatives></inline-formula>, <inline-formula id="IEq35"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}_{0}\left( x,x\right)$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:msub><mml:mtext>R</mml:mtext><mml:mn>0</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq35.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq36"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}_{0}\left( x,x\right)$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:msub><mml:mtext>R</mml:mtext><mml:mn>0</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq36.gif"/></alternatives></inline-formula> are calculated as the inner product between <italic>x</italic> and <italic>y</italic> with lag <inline-formula id="IEq37"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M74"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq37.gif"/></alternatives></inline-formula> as follows:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} R_{\tau }\left( x,y\right) = {\left\{ \begin{array}{ll} {\sum }_{l=1}^{m-k}{x_{l+\tau } \cdot y_{l}} &amp;{} \left( \tau \ge 0\right) \\ R_{-\tau }\left( y,x\right) &amp;{} \left( \tau &lt; 0\right) \end{array}\right. }. \end{aligned}$$\end{document}</tex-math><mml:math id="M76" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>τ</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfenced close=")" open="("><mml:mi>τ</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mfenced></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfenced close=")" open="("><mml:mi>τ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5230_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula> To achieve shift-invariance, cross-correlation keeps <italic>y</italic> static and slides <italic>x</italic> over <italic>y</italic> to compute their inner product for each shift <inline-formula id="IEq38"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M78"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq38.gif"/></alternatives></inline-formula> of <italic>x</italic>. When sliding <italic>x</italic>, only the elements of <italic>x</italic> and <italic>y</italic> that share time are used to calculate cross-correlation. To capture the negative correlation between neurons, we defined mSBD as<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\textrm{mSBD}}\left( x,y\right) = 1 - \max _{\tau }{\left( \textrm{abs}{\left( \frac{R_{s-m}\left( x, y\right) }{\sqrt{\textrm{R}_{0}\left( x,x\right) \textrm{R}_{0}\left( y,y\right) }}\right) }\right) }, \end{aligned}$$\end{document}</tex-math><mml:math id="M80" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>mSBD</mml:mtext><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:munder><mml:mo movablelimits="true">max</mml:mo><mml:mi>τ</mml:mi></mml:munder><mml:mfenced close=")" open="("><mml:mtext>abs</mml:mtext><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mfenced></mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mtext>R</mml:mtext><mml:mn>0</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mfenced><mml:msub><mml:mtext>R</mml:mtext><mml:mn>0</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mfenced></mml:mrow></mml:msqrt></mml:mfrac></mml:mfenced></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5230_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula> where the absolute value function <inline-formula id="IEq39"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$abs\left( \right)$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi><mml:mfenced close=")" open="("/></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq39.gif"/></alternatives></inline-formula> is included to search for the highest correlation. This makes it possible to handle the interactions between cell pairs with high positive correlation such as AVAR and RIMR (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b), and cell pairs with high negative correlation such as ASEL and ASER (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c), in a unified manner. This modification is based on mutual inhibition, in which the A-type and B-type command interneurons inhibit each other, resulting in a negative correlation between these neurons [<xref ref-type="bibr" rid="CR41">41</xref>].</p>
      </sec>
    </sec>
    <sec id="Sec13">
      <title>Membership matrices</title>
      <p id="Par61">For each distance matrix by mSBD (Eq. (<xref rid="Equ3" ref-type="disp-formula">3</xref>), hierarchical clustering (Ward’s method [<xref ref-type="bibr" rid="CR42">42</xref>]) with <italic>K</italic> clusters was applied, and based on the results, we obtained a binary matrix (membership matrix) (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). The membership matrix of the <italic>m</italic>-th animal is defined as follows:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \left[ S_{m}\right] _{i,j} = {\left\{ \begin{array}{ll} 1 &amp;{} \left( \text {if cell }i\text { and cell }j\text { belong to the same cluster}\right) \ \\ 0 &amp;{} \left( \text {otherwise}\right) \end{array}\right. }. \end{aligned}$$\end{document}</tex-math><mml:math id="M84" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mfenced close="]" open="["><mml:msub><mml:mi>S</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mfenced><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfenced close=")" open="("><mml:mtext>if cell</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>i</mml:mi><mml:mspace width="0.333333em"/><mml:mtext>and cell</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>j</mml:mi><mml:mspace width="0.333333em"/><mml:mtext>belong to the same cluster</mml:mtext></mml:mfenced><mml:mspace width="4pt"/></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfenced close=")" open="("><mml:mtext>otherwise</mml:mtext></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5230_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>If a cell was not identified in an animal, it was assumed that the cell did not belong to the same cluster as any of the other cells.</p>
    </sec>
    <sec id="Sec14">
      <title>Clustering</title>
      <sec id="Sec15">
        <title>Cluster-based similarity partitioning</title>
        <p id="Par62">Consensus clustering (or cluster ensembles) was performed on the membership matrices described above. Note that consensus clustering is the generic term for clustering algorithms that aggregate multiple results of clustering. In this work, we used CSPA, which is perhaps the simplest and most widely used consensus clustering algorithm [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>].</p>
        <p id="Par63">In CSPA, the consensus matrix <inline-formula id="IEq40"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S \in \mathbb {R}^{N \times N}$$\end{document}</tex-math><mml:math id="M86"><mml:mrow><mml:mi>S</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq40.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a) is calculated by averaging all the membership matrices as follows:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \left[ S\right] _{i,j} = \frac{1}{M}\sum _{m=1}^{M}{\left[ D_{m}\right] _{i,j}}. \end{aligned}$$\end{document}</tex-math><mml:math id="M88" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mfenced close="]" open="["><mml:mi>S</mml:mi></mml:mfenced><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>M</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:msub><mml:mfenced close="]" open="["><mml:msub><mml:mi>D</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mfenced><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5230_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>Here, <italic>S</italic> is then converted to a dissimilarity matrix by <inline-formula id="IEq41"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1-S$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq41.gif"/></alternatives></inline-formula> and used for further analysis such as clustering or dimensionality reduction by t-SNE and UMAP. For clustering, we used Ward’s hierarchical clustering with <italic>K</italic> clusters, which is the same number of clusters we set when we created the membership matrices above.</p>
      </sec>
      <sec id="Sec16">
        <title>WormTensor</title>
        <p id="Par64">WormTensor performs two main processes. First, it uses mSBD described above to account for the lags and the mutual inhibition of cell–cell interactions. Second, it uses tensor decomposition for clustering to weigh each animal without averaging among them. Unlike CSPA, which reduces multiple membership matrices into a matrix <italic>S</italic>, WormTensor stacks the <italic>M</italic> membership matrices in the depth direction (the 3-rd dimension) and creates a third-order tensor <inline-formula id="IEq42"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {X} \in \mathbb {R}^{N \times N \times M}$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mi mathvariant="script">X</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq42.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a).</p>
        <p id="Par65">In WormTensor, the tensor decomposition algorithm MC-MI-HOOI is applied to this tensor. MC-MI-HOOI performs decomposition as follows:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \left[ \mathcal {X}\right] _{::m} \approx w_{m} U G U^{T}. \end{aligned}$$\end{document}</tex-math><mml:math id="M94" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mfenced close="]" open="["><mml:mi mathvariant="script">X</mml:mi></mml:mfenced><mml:mrow><mml:mo>:</mml:mo><mml:mo>:</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mi>U</mml:mi><mml:mi>G</mml:mi><mml:msup><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5230_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>Alternatively, in the matrix/tensor form, this is formalized as<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \mathcal {X} \approx G \times _{1} U \times _{2} U \times _{3} W, \end{aligned}$$\end{document}</tex-math><mml:math id="M96" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">X</mml:mi><mml:mo>≈</mml:mo><mml:mi>G</mml:mi><mml:msub><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:mi>U</mml:mi><mml:msub><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mi>U</mml:mi><mml:msub><mml:mo>×</mml:mo><mml:mn>3</mml:mn></mml:msub><mml:mi>W</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5230_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq43"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U \in \mathbb {R}^{N \times K}$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:mi>U</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq43.gif"/></alternatives></inline-formula> is the factor matrix, <inline-formula id="IEq44"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G \in \mathbb {R}^{K \times K}$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:mi>G</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq44.gif"/></alternatives></inline-formula> is the core tensor (a diagonal matrix), each element <inline-formula id="IEq45"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{m}$$\end{document}</tex-math><mml:math id="M102"><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq45.gif"/></alternatives></inline-formula> of vector <inline-formula id="IEq46"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W \in \mathbb {R}^{M}$$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:mi>W</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>M</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq46.gif"/></alternatives></inline-formula> is the weight of <italic>m</italic>-th slice of <inline-formula id="IEq47"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {X}$$\end{document}</tex-math><mml:math id="M106"><mml:mi mathvariant="script">X</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq47.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq48"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times _{l}$$\end{document}</tex-math><mml:math id="M108"><mml:msub><mml:mo>×</mml:mo><mml:mi>l</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq48.gif"/></alternatives></inline-formula> is the mode-<italic>l</italic> product [<xref ref-type="bibr" rid="CR43">43</xref>].</p>
        <p id="Par66">To decompose <italic>U</italic>, <italic>G</italic>, and <italic>W</italic>, MC-MI-HOOI solves the following optimization problem:<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} \max _{U,w}{\Vert U^{T} \left( \sum _{k=1}^{K}{w_{k}} \left[ \mathcal {X}\right] _{::k} \right) U \Vert _{F}^{2}} \\ \text {s.t.} \, U^{T}U=I_{K},\, \Vert W \Vert _{F}^{2} = 1 \end{aligned}. \end{aligned}$$\end{document}</tex-math><mml:math id="M110" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munder><mml:mo movablelimits="true">max</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:mo stretchy="false">‖</mml:mo></mml:mrow><mml:msup><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mfenced close=")" open="("><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:msub><mml:mi>w</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mfenced close="]" open="["><mml:mi mathvariant="script">X</mml:mi></mml:mfenced><mml:mrow><mml:mo>:</mml:mo><mml:mo>:</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:msubsup><mml:mrow><mml:mi>U</mml:mi><mml:mo stretchy="false">‖</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mtext>s.t.</mml:mtext><mml:mspace width="0.166667em"/><mml:msup><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mrow><mml:mo stretchy="false">‖</mml:mo><mml:mi>W</mml:mi><mml:mo stretchy="false">‖</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5230_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>Alternatively, in the matrix/tensor form, this is formalized as<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} \max _{U,w}{\Vert \mathcal {X} \times _{1} U^{T} \times _{2} U^{T} \times _{3} W^{T}\Vert _{F}^{2}} \\ \text {s.t.} \, U^{T}U=I_{K},\, \Vert W \Vert _{F}^{2} = 1 \end{aligned}, \end{aligned}$$\end{document}</tex-math><mml:math id="M112" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munder><mml:mo movablelimits="true">max</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:mo stretchy="false">‖</mml:mo><mml:mi mathvariant="script">X</mml:mi></mml:mrow><mml:msub><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mo>×</mml:mo><mml:mn>3</mml:mn></mml:msub><mml:msup><mml:mi>W</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msubsup><mml:mrow><mml:mo stretchy="false">‖</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mtext>s.t.</mml:mtext><mml:mspace width="0.166667em"/><mml:msup><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mrow><mml:mo stretchy="false">‖</mml:mo><mml:mi>W</mml:mi><mml:mo stretchy="false">‖</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5230_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq49"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{K} \in \mathbb {R}^{K \times K}$$\end{document}</tex-math><mml:math id="M114"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq49.gif"/></alternatives></inline-formula> is the identity matrix of size <italic>K</italic>.</p>
        <p id="Par67">Because MC-MI-HOOI is a special case of <italic>higher orthogonal iteration of tensors</italic> (HOOI [<xref ref-type="bibr" rid="CR43">43</xref>]), which is an algorithm that is widely used to solve Tucker decomposition (<inline-formula id="IEq50"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {X} \approx G \times _{1} A_{1} \times _{2} A_{2} \times _{3} A_{3}$$\end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:mi mathvariant="script">X</mml:mi><mml:mo>≈</mml:mo><mml:mi>G</mml:mi><mml:msub><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mo>×</mml:mo><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq50.gif"/></alternatives></inline-formula>), we obtained <italic>U</italic> and <italic>W</italic> of MC-MI-HOOI via HOOI by setting the dimension of the depth factor matrix <inline-formula id="IEq51"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_{3}$$\end{document}</tex-math><mml:math id="M118"><mml:msub><mml:mi>A</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq51.gif"/></alternatives></inline-formula> to 1, assuming that the first and second factor matrices (<inline-formula id="IEq52"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_{1}$$\end{document}</tex-math><mml:math id="M120"><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq52.gif"/></alternatives></inline-formula> and <inline-formula id="IEq53"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_{2}$$\end{document}</tex-math><mml:math id="M122"><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq53.gif"/></alternatives></inline-formula>) are common. After HOOI converges, <italic>G</italic> is calculated as <inline-formula id="IEq54"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G = \mathcal {X} \times _{1} U^{T} \times _{2} U^{T} \times _{3} W^{T}$$\end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="script">X</mml:mi><mml:msub><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mo>×</mml:mo><mml:mn>3</mml:mn></mml:msub><mml:msup><mml:mi>W</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq54.gif"/></alternatives></inline-formula>.</p>
        <p id="Par68">After the optimization, <italic>U</italic> can be used for further analysis such as clustering or dimensional reduction by t-SNE and UMAP. To perform these analyzes, we first created the distance matrix of <italic>U</italic>. For clustering, we used Ward’s hierarchical clustering with <italic>K</italic> clusters, which is the same number of clusters we set when we created the membership matrices above.</p>
      </sec>
      <sec id="Sec17">
        <title>Silhouette coefficient</title>
        <p id="Par69">To estimate the number of clusters to be used by CSPA and WormTensor, we used the silhouette coefficient [<xref ref-type="bibr" rid="CR13">13</xref>]. To obtain the silhouette coefficient for a cell <italic>i</italic> belonging to a cluster <inline-formula id="IEq55"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{a}$$\end{document}</tex-math><mml:math id="M126"><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq55.gif"/></alternatives></inline-formula>, the average distance between cell <italic>i</italic> and the other cells in <inline-formula id="IEq56"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{a}$$\end{document}</tex-math><mml:math id="M128"><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq56.gif"/></alternatives></inline-formula>
<inline-formula id="IEq57"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a\left( i \right)$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:mi>a</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq57.gif"/></alternatives></inline-formula> is calculated as<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} a\left( i \right) = \frac{1}{|C_{a}|-1}\sum _{j \in C_{a}, i \ne j}{d\left( i,j\right) }, \end{aligned}$$\end{document}</tex-math><mml:math id="M132" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>a</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>d</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mfenced></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5230_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq58"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|C_{a}|$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq58.gif"/></alternatives></inline-formula> is the number of cluster members in <inline-formula id="IEq59"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{a}$$\end{document}</tex-math><mml:math id="M136"><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq59.gif"/></alternatives></inline-formula> and <inline-formula id="IEq60"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d\left( i,j\right)$$\end{document}</tex-math><mml:math id="M138"><mml:mrow><mml:mi>d</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq60.gif"/></alternatives></inline-formula> is the distance between cell <italic>i</italic> and cell <italic>j</italic>. Then, the minimum average distance between cell <italic>i</italic> and the other cells in <inline-formula id="IEq61"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{b} \left( C_{b} \ne C_{a}\right)$$\end{document}</tex-math><mml:math id="M140"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>C</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq61.gif"/></alternatives></inline-formula>
<inline-formula id="IEq62"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b\left( i \right)$$\end{document}</tex-math><mml:math id="M142"><mml:mrow><mml:mi>b</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq62.gif"/></alternatives></inline-formula> is calculated as follows:<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} b\left( i \right) = \min _{C_{b} \ne C_{a}}\frac{1}{|C_{b}|}\sum _{j \in C_{b}}{d\left( i,j\right) }. \end{aligned}$$\end{document}</tex-math><mml:math id="M144" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>b</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="true">min</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mi>d</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mfenced></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5230_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula>Finally, the silhouette coefficient for cell <italic>i</italic>
<inline-formula id="IEq63"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{s}\left( i \right)$$\end{document}</tex-math><mml:math id="M146"><mml:mrow><mml:mtext>s</mml:mtext><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq63.gif"/></alternatives></inline-formula> is obtained as follows:<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \textrm{s}\left( i \right) = \frac{b\left( i \right) - a\left( i \right) }{\max {\left\{ a\left( i \right) , b\left( i \right) \right\} }}. \end{aligned}$$\end{document}</tex-math><mml:math id="M148" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>s</mml:mtext><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>b</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:mi>a</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mo movablelimits="true">max</mml:mo><mml:mfenced close="}" open="{"><mml:mi>a</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5230_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula>The value spans <inline-formula id="IEq64"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-1$$\end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq64.gif"/></alternatives></inline-formula> to 1, and the closer the value is to 1, the more aggregated the cells are with those belonging to the same cluster as cell <italic>i</italic>. Conversely, a value close to <inline-formula id="IEq65"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-1$$\end{document}</tex-math><mml:math id="M152"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq65.gif"/></alternatives></inline-formula> means that there are cells belonging to other clusters in the neighborhood of cell <italic>i</italic>, which means that the clustering did not perform well.</p>
      </sec>
      <sec id="Sec18">
        <title>Consistency</title>
        <p id="Par70">To interpret the results of clustering by WormTensor and CSPA, we defined the consistency between the clusters of the merged animals (WormTensor or CSPA) and the clusters in each animal. We defined the consistency of cell <italic>i</italic> (<inline-formula id="IEq66"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{c}_{i}$$\end{document}</tex-math><mml:math id="M154"><mml:msub><mml:mtext>c</mml:mtext><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq66.gif"/></alternatives></inline-formula>) as<disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \textrm{c} \left( i \right) = {\left\{ \begin{array}{ll} {\sum }_{m=1}^{M}{\frac{|C_{\textrm{merged}} \cap C_{m}| - 1}{|C_{\textrm{merged}}| - 1}} &amp;{} (C_{\textrm{merged}} \ne C_{\textrm{m}})\\ 0 &amp;{} (C_{\textrm{merged}} = C_{\textrm{m}}), \end{array}\right. } \end{aligned}$$\end{document}</tex-math><mml:math id="M156" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>c</mml:mtext><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mtext>merged</mml:mtext></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mtext>merged</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mtext>merged</mml:mtext></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mtext>m</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mtext>merged</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mtext>m</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5230_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq67"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i \in C_{\textrm{merged}} \cap C_{m}$$\end{document}</tex-math><mml:math id="M158"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mtext>merged</mml:mtext></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq67.gif"/></alternatives></inline-formula>, <italic>M</italic> is the number of animals, <inline-formula id="IEq68"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{\textrm{merged}}$$\end{document}</tex-math><mml:math id="M160"><mml:msub><mml:mi>C</mml:mi><mml:mtext>merged</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq68.gif"/></alternatives></inline-formula> is the group of members of the cluster of the merged animals, and <inline-formula id="IEq69"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{\textrm{m}}$$\end{document}</tex-math><mml:math id="M162"><mml:msub><mml:mi>C</mml:mi><mml:mtext>m</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq69.gif"/></alternatives></inline-formula> is the group of members of the cluster of the <italic>m</italic>-th animal. The value of <inline-formula id="IEq70"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{c}_{i}$$\end{document}</tex-math><mml:math id="M164"><mml:msub><mml:mtext>c</mml:mtext><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq70.gif"/></alternatives></inline-formula> ranges from 0 to <italic>M</italic>.</p>
      </sec>
      <sec id="Sec19">
        <title>Adjusted rand index</title>
        <p id="Par71">To evaluate the similarity of the clustering results of WormTensor and the clustering results of individual animals, we utilized ARI [<xref ref-type="bibr" rid="CR17">17</xref>], which is an external validity index that is widely used to evaluate clustering results with known class labels.</p>
        <p id="Par72">Suppose that <italic>N</italic> cells are divided into <italic>K</italic> clusters by WormTensor such that <inline-formula id="IEq71"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C = \{C_{1}, C_{2},..., C_{K}\}$$\end{document}</tex-math><mml:math id="M166"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq71.gif"/></alternatives></inline-formula>. Likewise, suppose that <italic>N</italic> cells are divided into <inline-formula id="IEq72"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K'$$\end{document}</tex-math><mml:math id="M168"><mml:msup><mml:mi>K</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq72.gif"/></alternatives></inline-formula> clusters by Ward’s hierarchical clustering in an animal such that <inline-formula id="IEq73"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C' = \{C'_{1}, C'_{2},..., C'_{K'}\}$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:msup><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mn>1</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mn>2</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:msup><mml:mi>K</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>′</mml:mo></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq73.gif"/></alternatives></inline-formula>. From these two partitions, the Rand index (RI) is defined as a similarity measure between two partitions as<disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {{\textrm{RI}}} = \frac{ \left( a + d \right) }{ \left( a + b + c + d \right) }, \end{aligned}$$\end{document}</tex-math><mml:math id="M172" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>RI</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi></mml:mfenced><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi></mml:mfenced></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5230_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula>where <italic>a</italic> is the number of pairs within <italic>N</italic> cells that are in the same subset in <italic>C</italic> and in the same subset in <inline-formula id="IEq74"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C'$$\end{document}</tex-math><mml:math id="M174"><mml:msup><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq74.gif"/></alternatives></inline-formula>, <italic>b</italic> is the number of pairs within <italic>N</italic> cells that are in different subsets in <italic>C</italic> and in different subsets in <inline-formula id="IEq75"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C'$$\end{document}</tex-math><mml:math id="M176"><mml:msup><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq75.gif"/></alternatives></inline-formula>, <italic>c</italic> is the number of pairs within <italic>N</italic> cells that are in the same subset in <italic>C</italic> and in different subsets in <inline-formula id="IEq76"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C'$$\end{document}</tex-math><mml:math id="M178"><mml:msup><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq76.gif"/></alternatives></inline-formula>, and <italic>d</italic> is the number of pairs within <italic>N</italic> cells that are in different subsets in <italic>C</italic> and in the same subset in <inline-formula id="IEq77"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C'$$\end{document}</tex-math><mml:math id="M180"><mml:msup><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq77.gif"/></alternatives></inline-formula>.</p>
        <p id="Par73">ARI is an adjusted version of RI that corrects the bias towards RI increasing by chance.<disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\textrm{ARI}} = \frac{ {\textrm{RI}} - \textrm{E} \left( {\textrm{RI}} \right) }{ \max {\left( {\textrm{RI}}\right) } - \textrm{E} \left( {\textrm{RI}} \right) , } \end{aligned}$$\end{document}</tex-math><mml:math id="M182" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>ARI</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>RI</mml:mtext><mml:mo>-</mml:mo><mml:mtext>E</mml:mtext><mml:mfenced close=")" open="("><mml:mtext>RI</mml:mtext></mml:mfenced></mml:mrow><mml:mrow><mml:mo movablelimits="true">max</mml:mo><mml:mfenced close=")" open="("><mml:mtext>RI</mml:mtext></mml:mfenced><mml:mo>-</mml:mo><mml:mtext>E</mml:mtext><mml:mfenced close=")" open="("><mml:mtext>RI</mml:mtext></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5230_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq78"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{E} \left( {\textrm{RI}} \right)$$\end{document}</tex-math><mml:math id="M184"><mml:mrow><mml:mtext>E</mml:mtext><mml:mfenced close=")" open="("><mml:mtext>RI</mml:mtext></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq78.gif"/></alternatives></inline-formula> is the expected value of RI based on some probability distribution. In this work, we used the permutation model based on the generalized hypergeometric distribution [<xref ref-type="bibr" rid="CR17">17</xref>], which is the most widely used model for ARI. RI and ARI range from 0 to 1, with higher values indicating a better match between the WormTensor clustering results and the clustering results in each animal.</p>
      </sec>
    </sec>
    <sec id="Sec20">
      <title>Implementation</title>
      <p id="Par74">The WormTensor package is implemented in R and is made available through CRAN (<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org">https://cran.r-project.org</ext-link>) under the MIT license. WormTensor consists of seven R functions described below. <disp-quote><p id="Par75"><list list-type="bullet"><list-item><p id="Par76">worm_download() downloads the distance matrices used in this work from figshare; 28 animals’ data, including those of 24 used in this study and 4 noisy ones, are available (Table <xref rid="Tab2" ref-type="table">2</xref>).</p></list-item><list-item><p id="Par77">worm_distance() generates the distance matrices between cells for multiple animals from input time-series data matrices (cells <inline-formula id="IEq79"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M186"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq79.gif"/></alternatives></inline-formula> time) specified by users; mSBD, SBD, or Euclidean distance can be specified as the distance measure (default, mSBD).</p></list-item><list-item><p id="Par78">as_worm_tensor() instantiates a WormTensor object from the distance matrices, which are used in the following functions.</p></list-item><list-item><p id="Par79">worm_membership() creates a membership tensor from the results of clustering performed using the distance matrix of each animal.</p></list-item><list-item><p id="Par80">worm_clustering() performs clustering using the distance matrices above. MC-MI-HOOI and CSPA can be specified as the clustering algorithm (default, MC-MI-HOOI).</p></list-item><list-item><p id="Par81">worm_evaluate() evaluates the results of worm_clustering(). As internal validity indices [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>] without prior knowledge of the clusters, entropy, pseudo-F measure, and connectivity computations are implemented. As external validity indices [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>] using prior knowledge of the clusters, ARI, purity, and micro-averaged F-measure computations are implemented. The latter indices are optional, and only if the class label is specified, these indices are calculated.</p></list-item><list-item><p id="Par82">worm_visualize() visualizes the results of worm_clustering(). In addition, the number of identified cells and consistency are visualized as QC metrics. Only if some labels to interpret the clusters are specified (e.g., neuron type or neuron class), such labels are also visualized. Only if the algorithm of worm_clustering() is specified as MC-MI-HOOI, the relationship of the weights and the number of identified cells and ARI between the clustering result of each animal and the result of MC-MI-HOOI are visualized.</p></list-item></list></p></disp-quote></p>
      <p id="Par83">Inspired by the Tidyverse [<xref ref-type="bibr" rid="CR44">44</xref>], WormTensor also uses R’s native pipe operator to allow multiple R functions to be chained together and executed as one-liner code (Fig. <xref rid="Fig7" ref-type="fig">7</xref>).</p>
    </sec>
  </sec>
  <sec id="Sec21">
    <title>Availability and requirements</title>
    <sec id="Sec22">
      <title>R/CRAN package</title>
      <p id="Par84">
        <list list-type="bullet">
          <list-item>
            <p id="Par85">WormTensor: <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/WormTensor">https://cran.r-project.org/web/packages/WormTensor</ext-link></p>
          </list-item>
          <list-item>
            <p id="Par86">Operating system: Linux, Mac OS X, Windows</p>
          </list-item>
          <list-item>
            <p id="Par87">Programming language: R (v<inline-formula id="IEq80"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-$$\end{document}</tex-math><mml:math id="M188"><mml:mo>-</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq80.gif"/></alternatives></inline-formula>4.1.0 or higher)</p>
          </list-item>
          <list-item>
            <p id="Par88">License: MIT</p>
          </list-item>
          <list-item>
            <p id="Par89">Any restrictions to use by non-academics: For non-profit use only</p>
          </list-item>
        </list>
      </p>
    </sec>
    <sec id="Sec23">
      <title>Docker container of WormTensor</title>
      <p id="Par90">
        <list list-type="bullet">
          <list-item>
            <p id="Par91">WormTensor: <ext-link ext-link-type="uri" xlink:href="https://hub.docker.com/r/yamaken37/wormtensor">https://hub.docker.com/r/yamaken37/wormtensor</ext-link></p>
          </list-item>
        </list>
      </p>
    </sec>
    <sec id="Sec24">
      <title>Snakemake workflow</title>
      <p id="Par92">
        <list list-type="bullet">
          <list-item>
            <p id="Par93">WormTimeSeries (to fully reproduce the analyses in this study): <ext-link ext-link-type="uri" xlink:href="https://github.com/rikenbit/WormTimeSeries">https://github.com/rikenbit/WormTimeSeries</ext-link></p>
          </list-item>
          <list-item>
            <p id="Par94">Operating system: Linux, Mac OS X, Windows</p>
          </list-item>
          <list-item>
            <p id="Par95">Programming language: Python (v<inline-formula id="IEq81"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-$$\end{document}</tex-math><mml:math id="M190"><mml:mo>-</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq81.gif"/></alternatives></inline-formula>3.7.8 or higher), Snakemake (v<inline-formula id="IEq82"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-$$\end{document}</tex-math><mml:math id="M192"><mml:mo>-</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq82.gif"/></alternatives></inline-formula>6.0.5 or higher), Singularity (v<inline-formula id="IEq83"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-$$\end{document}</tex-math><mml:math id="M194"><mml:mo>-</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq83.gif"/></alternatives></inline-formula>3.8.0 or higher)</p>
          </list-item>
          <list-item>
            <p id="Par96">License: MIT</p>
          </list-item>
          <list-item>
            <p id="Par97">Any restrictions to use by non-academics: For non-profit use only</p>
          </list-item>
        </list>
      </p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec25">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5230_MOESM1_ESM.xlsx">
            <caption>
              <p><bold>Additional file 1.</bold> Cellular labels for interpreting the clustering results.CSV 10.73 KB, https://figshare.com/ndownloader/files/38554109.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2023_5230_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file 2.</bold> Cellular labels for interpreting the clustering results).XLSX 233.53 KB, https://figshare.com/ndownloader/files/38554106.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2023_5230_MOESM3_ESM.png">
            <caption>
              <p><bold>Additional file 3.</bold> WormTensor, the results of clusters + consistency + No. of cells.PNG 1.22 MB, https://figshare.com/ndownloader/files/36186645.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="12859_2023_5230_MOESM4_ESM.png">
            <caption>
              <p><bold>Additional file 4.</bold> WormTensor, neuron type + consistency + No. of cells.PNG 1.18 MB, https://figshare.com/ndownloader/files/36186651.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="12859_2023_5230_MOESM5_ESM.png">
            <caption>
              <p><bold>Additional file 5.</bold> WormTensor, class label + consistency + No. of cells.PNG 1.11 MB, https://figshare.com/ndownloader/files/36186669.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="12859_2023_5230_MOESM6_ESM.png">
            <caption>
              <p><bold>Additional file 6.</bold> MC-MI-HOOI with Euclidean distance, <italic>k</italic> = 10, the results of clusters + consistency + No. of cells.PNG 2.33 MB, https://figshare.com/ndownloader/files/36186681.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="12859_2023_5230_MOESM7_ESM.png">
            <caption>
              <p><bold>Additional file 7.</bold> MC-MI-HOOI with Euclidean distance, <italic>k</italic> = 10, neuron type + consistency + No. of cells.PNG 2.08 MB, https://figshare.com/ndownloader/files/36186693.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM8">
          <media xlink:href="12859_2023_5230_MOESM8_ESM.png">
            <caption>
              <p><bold>Additional file 8.</bold> MC-MI-HOOI with Euclidean distance, <italic>k</italic> = 10, class label + consistency + No. of cells.PNG 1.93 MB, https://figshare.com/ndownloader/files/36186714.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM9">
          <media xlink:href="12859_2023_5230_MOESM9_ESM.png">
            <caption>
              <p><bold>Additional file 9.</bold> Results of clustering with the optimal number of clusters. <bold>a</bold> The clustering results of CSPA with Euclidean distance. <bold>b</bold> The clustering results of MC-MI-HOOI with Euclidean distance. <bold>c</bold> The clustering results of CSPA with mSBD. <bold>d</bold> The clustering results of MC-MI-HOOI with mSBD.PNG 847.16 KB, https://figshare.com/ndownloader/files/36189936.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM10">
          <media xlink:href="12859_2023_5230_MOESM10_ESM.png">
            <caption>
              <p><bold>Additional file 10.</bold> Results of WormTensor. <bold>a</bold> Neuron type. <bold>b</bold> The labels of the movement of <italic>C. elegans</italic>. <bold>c</bold> Consistency between the results of hierarchical clustering in each animal and WormTensor. <bold>d</bold> The number of identified cells.PNG 869.43 KB, https://figshare.com/ndownloader/files/36189957.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM11">
          <media xlink:href="12859_2023_5230_MOESM11_ESM.xlsx">
            <caption>
              <p><bold>Additional file 11.</bold> Hypergeometric test p-values and FDR <italic>q</italic>-values of all the clustering methods with the optimal numbers of clusters.XLSX 19.08 KB, https://figshare.com/ndownloader/files/38554103.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM12">
          <media xlink:href="12859_2023_5230_MOESM12_ESM.png">
            <caption>
              <p><bold>Additional file 12.</bold><bold>a</bold> The order of WormTensor weights of the animals when animal 20 was added. <bold>b</bold> The order of WormTensor weights of the animals when four noisy datasets were added. <bold>c</bold> The abnormal waveforms of animal 20.PNG 416.57 KB, https://figshare.com/ndownloader/files/36619650.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM13">
          <media xlink:href="12859_2023_5230_MOESM13_ESM.pdf">
            <caption>
              <p><bold>Additional file 13.</bold> Relationship between the shift value and the maximum absolute correlation coefficient in mSBD.PDF 648.84 KB, https://figshare.com/ndownloader/files/38554100.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM14">
          <media xlink:href="12859_2023_5230_MOESM14_ESM.pdf">
            <caption>
              <p><bold>Additional file 14.</bold> Differences in the properties of PC1_pos- and PC1_neg-related cells.PDF 2.38 MB, https://figshare.com/ndownloader/files/38554097.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM15">
          <media xlink:href="12859_2023_5230_MOESM15_ESM.pdf">
            <caption>
              <p><bold>Additional file 15.</bold> Results for clustering evaluation measures other than silhouette coefficient.PDF 1.68 MB, https://figshare.com/ndownloader/files/38943455.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>
          <italic>C. elegans</italic>
        </term>
        <def>
          <p id="Par4">
            <inline-formula id="IEq2">
              <alternatives>
                <tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Caenorhabditis\ elegans$$\end{document}</tex-math>
                <mml:math id="M196">
                  <mml:mrow>
                    <mml:mi>C</mml:mi>
                    <mml:mi>a</mml:mi>
                    <mml:mi>e</mml:mi>
                    <mml:mi>n</mml:mi>
                    <mml:mi>o</mml:mi>
                    <mml:mi>r</mml:mi>
                    <mml:mi>h</mml:mi>
                    <mml:mi>a</mml:mi>
                    <mml:mi>b</mml:mi>
                    <mml:mi>d</mml:mi>
                    <mml:mi>i</mml:mi>
                    <mml:mi>t</mml:mi>
                    <mml:mi>i</mml:mi>
                    <mml:mi>s</mml:mi>
                    <mml:mspace width="4pt"/>
                    <mml:mi>e</mml:mi>
                    <mml:mi>l</mml:mi>
                    <mml:mi>e</mml:mi>
                    <mml:mi>g</mml:mi>
                    <mml:mi>a</mml:mi>
                    <mml:mi>n</mml:mi>
                    <mml:mi>s</mml:mi>
                  </mml:mrow>
                </mml:math>
                <inline-graphic xlink:href="12859_2023_5230_Article_IEq2.gif"/>
              </alternatives>
            </inline-formula>
          </p>
        </def>
      </def-item>
      <def-item>
        <term>SBD</term>
        <def>
          <p id="Par5">Shape-based distance</p>
        </def>
      </def-item>
      <def-item>
        <term>mSBD</term>
        <def>
          <p id="Par6">Modified shape-based distance</p>
        </def>
      </def-item>
      <def-item>
        <term>HOOI</term>
        <def>
          <p id="Par7">Higher orthogonal iteration of tensors</p>
        </def>
      </def-item>
      <def-item>
        <term>MC-MI-HOOI</term>
        <def>
          <p id="Par8">Multi-view clustering based on matrix integration using the HOOI algorithm</p>
        </def>
      </def-item>
      <def-item>
        <term>CSPA</term>
        <def>
          <p id="Par9">Cluster-based similarity partitioning algorithm</p>
        </def>
      </def-item>
      <def-item>
        <term>NaCl</term>
        <def>
          <p id="Par10">Sodium chloride</p>
        </def>
      </def-item>
      <def-item>
        <term>t-SNE</term>
        <def>
          <p id="Par11">T-distributed stochastic neighbor embedding</p>
        </def>
      </def-item>
      <def-item>
        <term>UMAP</term>
        <def>
          <p id="Par12">Uniform manifold approximation and projection</p>
        </def>
      </def-item>
      <def-item>
        <term>QC</term>
        <def>
          <p id="Par13">Quality control</p>
        </def>
      </def-item>
      <def-item>
        <term>TCA</term>
        <def>
          <p id="Par14">Tensor components analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>EEG</term>
        <def>
          <p id="Par15">Electro-encephalography</p>
        </def>
      </def-item>
      <def-item>
        <term>YFP</term>
        <def>
          <p id="Par16">Yellow fluorescent protein</p>
        </def>
      </def-item>
      <def-item>
        <term>CFP</term>
        <def>
          <p id="Par17">Cyan fluorescent protein</p>
        </def>
      </def-item>
      <def-item>
        <term>FRET</term>
        <def>
          <p id="Par18">Fluorescence resonance energy transfer</p>
        </def>
      </def-item>
      <def-item>
        <term>RI</term>
        <def>
          <p id="Par19">Rand index</p>
        </def>
      </def-item>
      <def-item>
        <term>ARI</term>
        <def>
          <p id="Par20">Adjusted rand index</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Mr. Akihiro Matsushima for assistance with the IT infrastructure for the data analysis. We are also grateful to all members of the Laboratory for Bioinformatics Research and RIKEN Center for Biosystems Dynamics Research for their helpful advice.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>KT and YT designed the study. KT designed and implemented the proposed algorithm. YT, HS, MK, TT, TI, and YI measured the neuronal activity data. KY performed all analyses and implemented the WormTensor package. All authors have read and approved the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by JST PRESTO Grant No. JPMJPR1945, the special postdoctoral researcher (SPDR) program at RIKEN, and JSPS KAKENHI Grant No. 19K20406.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All distance matrices analyzed during this study are included in this published article. The datasets of raw time series of neural activity will be available from a DOI (10.6084/m9.figshare.21968078) reserved for publication by Figshare.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par98">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par99">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par100">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bullmore</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sporns</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Complex brain networks: graph theoretical analysis of structural and functional systems</article-title>
        <source>Nat Rev Neurosci</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>3</issue>
        <fpage>186</fpage>
        <lpage>198</lpage>
        <pub-id pub-id-type="doi">10.1038/nrn2575</pub-id>
        <?supplied-pmid 19190637?>
        <pub-id pub-id-type="pmid">19190637</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sporns</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Betzel</surname>
            <given-names>RF</given-names>
          </name>
        </person-group>
        <article-title>Modular brain networks</article-title>
        <source>Annu Rev Psychol</source>
        <year>2016</year>
        <volume>67</volume>
        <fpage>613</fpage>
        <lpage>640</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-psych-122414-033634</pub-id>
        <?supplied-pmid 26393868?>
        <pub-id pub-id-type="pmid">26393868</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>White</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Southgate</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Thomson</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Brenner</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>The structure of the nervous system of the nematode <italic>Caenorhabditis elegans</italic></article-title>
        <source>Philos Trans R Soc B</source>
        <year>1986</year>
        <volume>314</volume>
        <issue>1165</issue>
        <fpage>1</fpage>
        <lpage>340</lpage>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kerr</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lev-Ram</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Baird</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Vincent</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tsien</surname>
            <given-names>RY</given-names>
          </name>
          <name>
            <surname>Schafer</surname>
            <given-names>WR</given-names>
          </name>
        </person-group>
        <article-title>Optical imaging of calcium transients in neurons and pharyngeal muscle of <italic>C. elegans</italic></article-title>
        <source>Neuron</source>
        <year>2000</year>
        <volume>26</volume>
        <issue>3</issue>
        <fpage>583</fpage>
        <lpage>594</lpage>
        <pub-id pub-id-type="doi">10.1016/S0896-6273(00)81196-4</pub-id>
        <?supplied-pmid 10896155?>
        <pub-id pub-id-type="pmid">10896155</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Toyoshima</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kanamori</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sato</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Jang</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Oe</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Murakami</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Teramoto</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Iwasaki</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ishihara</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yoshida</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Iino</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Neuron id dataset facilitates neuronal annotation for whole-brain activity imaging of <italic>C. elegans</italic></article-title>
        <source>BMC Biol</source>
        <year>2020</year>
        <volume>18</volume>
        <issue>30</issue>
        <fpage>1</fpage>
        <pub-id pub-id-type="pmid">31898513</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Toyoshima Y, Sato H, Nagata D, Kanamori M, Jang MS, Kuze K, Oe S, Teramoto T, Iwasaki Y, Yoshida R, Ishihara T, Iino Y. Deducing ensemble dynamics and information flow from the whole-brain imaging data. bioRxiv 2022</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yemini</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nejatbakhsh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Varol</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Mena</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Samuel</surname>
            <given-names>ADT</given-names>
          </name>
          <name>
            <surname>Paninski</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Venkatachalam</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Hobert</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Neuropal: a multicolor atlas for whole-brain neuronal identification in <italic>C. elegans</italic></article-title>
        <source>Cell</source>
        <year>2021</year>
        <volume>184</volume>
        <issue>1</issue>
        <fpage>272</fpage>
        <lpage>288</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2020.12.012</pub-id>
        <?supplied-pmid 33378642?>
        <pub-id pub-id-type="pmid">33378642</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kato</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kaplan</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Schrödel</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Skora</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lindsay</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Yemini</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lockery</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zimmer</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Global brain dynamics embed the motor command sequence of <italic>Caenorhabditis elegans</italic></article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>163</volume>
        <issue>3</issue>
        <fpage>656</fpage>
        <lpage>669</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.09.034</pub-id>
        <?supplied-pmid 26478179?>
        <pub-id pub-id-type="pmid">26478179</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Shipley</surname>
            <given-names>FB</given-names>
          </name>
          <name>
            <surname>Linder</surname>
            <given-names>AN</given-names>
          </name>
          <name>
            <surname>Plummer</surname>
            <given-names>GS</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Setru</surname>
            <given-names>SU</given-names>
          </name>
          <name>
            <surname>Shaevitz</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Leifer</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Whole-brain calcium imaging with cellular resolution in freely behaving <italic>Caenorhabditis elegans</italic></article-title>
        <source>PNAS</source>
        <year>2015</year>
        <volume>113</volume>
        <issue>8</issue>
        <fpage>1074</fpage>
        <lpage>1081</lpage>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Venkatachalam</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Mitchell</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tabone</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Florman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Greenwood</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chisholm</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Srinivasan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Alkema</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Samuel</surname>
            <given-names>AD</given-names>
          </name>
        </person-group>
        <article-title>Pan-neuronal imaging in roaming <italic>Caenorhabditis elegans</italic></article-title>
        <source>PNAS</source>
        <year>2016</year>
        <volume>113</volume>
        <issue>8</issue>
        <fpage>1082</fpage>
        <lpage>1088</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1507109113</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alexander</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Joydeep</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Cluster ensembles–a knowledge reuse framework for combining multiple partitions</article-title>
        <source>J Mach Learn Res</source>
        <year>2003</year>
        <volume>3</volume>
        <issue>35</issue>
        <fpage>583</fpage>
        <lpage>617</lpage>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>VY</given-names>
          </name>
          <name>
            <surname>Kirschner</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Schaub</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yiu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chandra</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Natarajan</surname>
            <given-names>KN</given-names>
          </name>
          <name>
            <surname>Reik</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Barahona</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Sc3: consensus clustering of single-cell RNA-seq data</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>5</issue>
        <fpage>483</fpage>
        <lpage>486</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4236</pub-id>
        <?supplied-pmid 28346451?>
        <pub-id pub-id-type="pmid">28346451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rousseeuw</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Silhouettes: a graphical aid to the interpretation and validation of cluster analysis</article-title>
        <source>J Comput Appl Math</source>
        <year>1987</year>
        <volume>20</volume>
        <fpage>53</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1016/0377-0427(87)90125-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>J Roy Stat Soc B</source>
        <year>1995</year>
        <volume>57</volume>
        <issue>1</issue>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gordus</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pokala</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Levy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Flavell</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Bargmann</surname>
            <given-names>CI</given-names>
          </name>
        </person-group>
        <article-title>Feedback from network states generates variability in a probabilistic olfactory circuit</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <issue>2</issue>
        <fpage>215</fpage>
        <lpage>227</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.02.018</pub-id>
        <?supplied-pmid 25772698?>
        <pub-id pub-id-type="pmid">25772698</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kawano</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Po</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Ryu</surname>
            <given-names>WS</given-names>
          </name>
          <name>
            <surname>Zhen</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>An imbalancing act: gap junctions reduce the backward motor circuit activity to bias <italic>C. elegans</italic> for forward locomotion</article-title>
        <source>Neuron</source>
        <year>2011</year>
        <volume>72</volume>
        <issue>4</issue>
        <fpage>572</fpage>
        <lpage>586</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuron.2011.09.005</pub-id>
        <?supplied-pmid 22099460?>
        <pub-id pub-id-type="pmid">22099460</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huber</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Arabie</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Comparing partitions</article-title>
        <source>J Classif</source>
        <year>1985</year>
        <volume>2</volume>
        <fpage>193</fpage>
        <lpage>218</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01908075</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Palacio-Niño J-O, Berzal F. Evaluation metrics for unsupervised learning algorithms. arXiv 2019</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Tomašev</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Radovanović</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <source>Clustering evaluation in high-dimensional data</source>
        <year>2016</year>
        <publisher-loc>New York City, US</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sulston</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Horvitz</surname>
            <given-names>HR</given-names>
          </name>
        </person-group>
        <article-title>Post-embryonic cell lineages of the nematode, <italic>Caenorhabditis elegans</italic></article-title>
        <source>Dev Biol</source>
        <year>1977</year>
        <volume>56</volume>
        <issue>1</issue>
        <fpage>110</fpage>
        <lpage>156</lpage>
        <pub-id pub-id-type="doi">10.1016/0012-1606(77)90158-0</pub-id>
        <?supplied-pmid 838129?>
        <pub-id pub-id-type="pmid">838129</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sulston</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Schierenberg</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Thomson</surname>
            <given-names>JN</given-names>
          </name>
        </person-group>
        <article-title>The embryonic cell lineage of the nematode <italic>Caenorhabditis elegans</italic></article-title>
        <source>Dev Biol</source>
        <year>1983</year>
        <volume>100</volume>
        <issue>1</issue>
        <fpage>64</fpage>
        <lpage>119</lpage>
        <pub-id pub-id-type="doi">10.1016/0012-1606(83)90201-4</pub-id>
        <?supplied-pmid 6684600?>
        <pub-id pub-id-type="pmid">6684600</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Glänzel</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Moor</surname>
            <given-names>BD</given-names>
          </name>
        </person-group>
        <article-title>Multiview partitioning via tensor methods</article-title>
        <source>IEEE Trans Knowl Data Eng</source>
        <year>2013</year>
        <volume>25</volume>
        <issue>5</issue>
        <fpage>1056</fpage>
        <lpage>1069</lpage>
        <pub-id pub-id-type="doi">10.1109/TKDE.2012.95</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Badea L. Extracting gene expression profiles common to colon and pancreatic adenocarcinoma using simultaneous nonnegative matrix factorization. In: Pacific symposium on biocomputing; 2008. p. 279–290</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sankaran</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>SP</given-names>
          </name>
        </person-group>
        <article-title>Multitable methods for microbiome data integration</article-title>
        <source>Front Genet</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>627</issue>
        <fpage>1</fpage>
        <pub-id pub-id-type="pmid">30804975</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Torshizi</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Duan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>A computational method for direct imputation of cell type-specific expression profiles and cellular compositions from bulk-tissue rna-seq in brain disorders</article-title>
        <source>NAR Genom Bioinform</source>
        <year>2021</year>
        <volume>3</volume>
        <issue>2</issue>
        <fpage>056</fpage>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dong</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Thennavan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Urrutia</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Perou</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Zou</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Scdc: bulk gene expression deconvolution by multiple single-cell rna sequencing references</article-title>
        <source>Brief Bioinform</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>416</fpage>
        <lpage>427</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbz166</pub-id>
        <?supplied-pmid 31925417?>
        <pub-id pub-id-type="pmid">31925417</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zitnik</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zupan</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Jumping across biomedical contexts using compressive data fusion</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>12</issue>
        <fpage>90</fpage>
        <lpage>100</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw247</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sorber</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Barel</surname>
            <given-names>MV</given-names>
          </name>
          <name>
            <surname>Lathauwer</surname>
            <given-names>LD</given-names>
          </name>
        </person-group>
        <article-title>Structured data fusion</article-title>
        <source>IEEE J Select Topics Signal Process</source>
        <year>2015</year>
        <volume>9</volume>
        <issue>4</issue>
        <fpage>586</fpage>
        <lpage>600</lpage>
        <pub-id pub-id-type="doi">10.1109/JSTSP.2015.2400415</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Kim H, Choo J, Kim J, Reddy CK, Park H. Simultaneous discovery of common and discriminative topics via joint nonnegative matrix factorization. In: Proceedings of the 21th ACM SIGKDD international conference on knowledge discovery and data mining; 2015. p. 567–576</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Samat</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Persello</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gamba</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Abuduwaili</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Supervised and semi-supervised multi-view canonical correlation analysis ensemble for heterogeneous domain adaptation in remote sensing image classification</article-title>
        <source>Remote Sens</source>
        <year>2017</year>
        <volume>9</volume>
        <issue>4</issue>
        <fpage>337</fpage>
        <pub-id pub-id-type="doi">10.3390/rs9040337</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Linderman S, Nichols A, Blei D, Zimmer M, Paninski L. Hierarchical recurrent state space models reveal discrete and continuous dynamics of neural activity in <italic>C. elegans</italic>. bioRxiv 2019.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hallinen</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Dempsey</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Scholz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Linder</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Randi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Sharma</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Shaevitz</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Leifer</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Decoding locomotion from population neural activity in moving <italic>C. elegans</italic></article-title>
        <source>Elife</source>
        <year>2021</year>
        <volume>10</volume>
        <fpage>66135</fpage>
        <pub-id pub-id-type="doi">10.7554/eLife.66135</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Randi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Leifer</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Bialek</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Searching for collective behavior in a small brain</article-title>
        <source>Phys Rev E</source>
        <year>2019</year>
        <volume>99</volume>
        <fpage>052418</fpage>
        <pub-id pub-id-type="doi">10.1103/PhysRevE.99.052418</pub-id>
        <?supplied-pmid 31212571?>
        <pub-id pub-id-type="pmid">31212571</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Williams</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Vyas</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ryu</surname>
            <given-names>SI</given-names>
          </name>
          <name>
            <surname>Shenoy</surname>
            <given-names>KV</given-names>
          </name>
          <name>
            <surname>Schnitzer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kolda</surname>
            <given-names>TG</given-names>
          </name>
          <name>
            <surname>Ganguli</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Unsupervised discovery of demixed, low-dimensional neural dynamics across multiple timescales through tensor component analysis</article-title>
        <source>Neuron</source>
        <year>2018</year>
        <volume>98</volume>
        <issue>6</issue>
        <fpage>1099</fpage>
        <lpage>1115</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuron.2018.05.015</pub-id>
        <?supplied-pmid 29887338?>
        <pub-id pub-id-type="pmid">29887338</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mørup</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hansen</surname>
            <given-names>LK</given-names>
          </name>
          <name>
            <surname>Arnfred</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Lim</surname>
            <given-names>LH</given-names>
          </name>
          <name>
            <surname>Madsen</surname>
            <given-names>KH</given-names>
          </name>
        </person-group>
        <article-title>Shift-invariant multilinear decomposition of neuroimaging data</article-title>
        <source>Neuroimage</source>
        <year>2008</year>
        <volume>42</volume>
        <issue>4</issue>
        <fpage>1439</fpage>
        <lpage>1450</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2008.05.062</pub-id>
        <?supplied-pmid 18625324?>
        <pub-id pub-id-type="pmid">18625324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nagai</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yamada</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tominaga</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ichikawa</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Miyawaki</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Expanded dynamic range of fluorescent indicators for ca2+ by circularly permuted yellow fluorescent proteins</article-title>
        <source>PNAS</source>
        <year>2004</year>
        <volume>101</volume>
        <issue>29</issue>
        <fpage>10554</fpage>
        <lpage>10559</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0400417101</pub-id>
        <?supplied-pmid 15247428?>
        <pub-id pub-id-type="pmid">15247428</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Pratt</surname>
            <given-names>WK</given-names>
          </name>
        </person-group>
        <source>Digital image processing</source>
        <year>2007</year>
        <edition>4</edition>
        <publisher-loc>New Jersey, US</publisher-loc>
        <publisher-name>Wiley-Interscience</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Orfanidis</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <source>Introduction to signal processing (prentice hall signal processing series)</source>
        <year>1995</year>
        <publisher-loc>New Jersey, US</publisher-loc>
        <publisher-name>Prentice Hall</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schafer</surname>
            <given-names>RW</given-names>
          </name>
        </person-group>
        <article-title>What is a Savitzky-Golay filter? [lecture notes]</article-title>
        <source>IEEE Signal Process Mag</source>
        <year>2011</year>
        <volume>28</volume>
        <issue>4</issue>
        <fpage>111</fpage>
        <lpage>117</lpage>
        <pub-id pub-id-type="doi">10.1109/MSP.2011.941097</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paparrizos</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gravano</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>K-shape: efficient and accurate clustering of time series</article-title>
        <source>SIGMOD’15</source>
        <year>2016</year>
        <volume>45</volume>
        <issue>1</issue>
        <fpage>69</fpage>
        <lpage>76</lpage>
        <pub-id pub-id-type="doi">10.1145/2949741.2949758</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tawano</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Po</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Ryu</surname>
            <given-names>WS</given-names>
          </name>
          <name>
            <surname>Zhen</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>An imbalancing act: gap junctions reduce the backward motor circuit activity to bias <italic>C. elegans</italic> for forward locomotion</article-title>
        <source>Neuron</source>
        <year>2011</year>
        <volume>72</volume>
        <issue>4</issue>
        <fpage>572</fpage>
        <lpage>586</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuron.2011.09.005</pub-id>
        <pub-id pub-id-type="pmid">22099460</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ward</surname>
            <given-names>JHJ</given-names>
          </name>
        </person-group>
        <article-title>Hierarchical grouping to optimize an objective function</article-title>
        <source>J Am Stat Assoc</source>
        <year>1963</year>
        <volume>58</volume>
        <fpage>236</fpage>
        <lpage>244</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1963.10500845</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Cichocki</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zdunek</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Phan</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Amari</surname>
            <given-names>S-I</given-names>
          </name>
        </person-group>
        <source>Nonnegative matrix and tensor factorizations: applications to exploratory multi-way data analysis and blind source separation</source>
        <year>2009</year>
        <publisher-loc>New Jersey, US</publisher-loc>
        <publisher-name>Wiley Online Library</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wickham</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Averick</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bryan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>McGowan</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>François</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Grolemund</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Henry</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hester</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kuhn</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pedersen</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Bache</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ooms</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Seidel</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Spinu</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Takahashi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Vaughan</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wilke</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Woo</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Yutani</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Welcome to the tidyverse</article-title>
        <source>J Open Source Softw</source>
        <year>2019</year>
        <volume>4</volume>
        <issue>43</issue>
        <fpage>1686</fpage>
        <pub-id pub-id-type="doi">10.21105/joss.01686</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10273573</article-id>
    <article-id pub-id-type="publisher-id">5230</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05230-2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>WormTensor: a clustering method for time-series whole-brain activity data from <italic>C. elegans</italic></article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Tsuyuzaki</surname>
          <given-names>Koki</given-names>
        </name>
        <address>
          <email>koki.tsuyuzaki@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yamamoto</surname>
          <given-names>Kentaro</given-names>
        </name>
        <address>
          <email>yamaken37.the.answer@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Toyoshima</surname>
          <given-names>Yu</given-names>
        </name>
        <address>
          <email>ytoyo@bs.s.u-tokyo.ac.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sato</surname>
          <given-names>Hirofumi</given-names>
        </name>
        <address>
          <email>hisato@bs.s.u-tokyo.ac.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kanamori</surname>
          <given-names>Manami</given-names>
        </name>
        <address>
          <email>mkanamori@bs.s.u-tokyo.ac.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Teramoto</surname>
          <given-names>Takayuki</given-names>
        </name>
        <address>
          <email>teramoto.takayuki.873@m.kyushu-u.ac.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ishihara</surname>
          <given-names>Takeshi</given-names>
        </name>
        <address>
          <email>takeiscb@kyushu-u.org</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Iino</surname>
          <given-names>Yuichi</given-names>
        </name>
        <address>
          <email>iino@bs.s.u-tokyo.ac.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Nikaido</surname>
          <given-names>Itoshi</given-names>
        </name>
        <address>
          <email>itoshi.nikaido@riken.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.508743.d</institution-id><institution-id institution-id-type="ISNI">0000 0004 7434 0753</institution-id><institution>Laboratory for Bioinformatics Research RIKEN Center for Biosystems Dynamics Research, </institution></institution-wrap>Wako, Saitama 351-0198 Japan </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.26999.3d</institution-id><institution-id institution-id-type="ISNI">0000 0001 2151 536X</institution-id><institution>Department of Biological Sciences, Graduate School of Science, </institution><institution>The University of Tokyo, </institution></institution-wrap>Bunkyo-ku, Tokyo, 113-0033 Japan </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.177174.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2242 4849</institution-id><institution>Department of Biology, Faculty of Sciences, </institution><institution>Kyushu University, </institution></institution-wrap>744, Motooka, Nishi-ku, Fukuoka, 819-0395 Japan </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.20515.33</institution-id><institution-id institution-id-type="ISNI">0000 0001 2369 4728</institution-id><institution>Bioinformatics Course, Master’s/Doctoral Program in Life Science Innovation (T-LSI), School of Integrative and Global Majors (SIGMA), </institution><institution>University of Tsukuba, </institution></institution-wrap>Wako, Saitama 351-0198 Japan </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.265073.5</institution-id><institution-id institution-id-type="ISNI">0000 0001 1014 9130</institution-id><institution>Department of Functional Genome Informatics, Division of Biological Data Science, Medical Research Institute, </institution><institution>Tokyo Medical and Dental University (TMDU), </institution></institution-wrap>Tokyo, 113-8510 Japan </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>254</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>3</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">In the field of neuroscience, neural modules and circuits that control biological functions have been found throughout entire neural networks. Correlations in neural activity can be used to identify such neural modules. Recent technological advances enable us to measure whole-brain neural activity with single-cell resolution in several species including <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Caenorhabditis\ elegans$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>h</mml:mi><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mspace width="4pt"/><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>g</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq1.gif"/></alternatives></inline-formula>. Because current neural activity data in <italic>C. elegans</italic> contain many missing data points, it is necessary to merge results from as many animals as possible to obtain more reliable functional modules.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">In this work, we developed a new time-series clustering method, WormTensor, to identify functional modules using whole-brain activity data from <italic>C. elegans</italic>. WormTensor uses a distance measure, modified shape-based distance to account for the lags and the mutual inhibition of cell–cell interactions and applies the tensor decomposition algorithm multi-view clustering based on matrix integration using the higher orthogonal iteration of tensors (HOOI) algorithm (MC-MI-HOOI), which can estimate both the weight to account for the reliability of data from each animal and the clusters that are common across animals.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">We applied the method to 24 individual <italic>C. elegans</italic> and successfully found some known functional modules. Compared with a widely used consensus clustering method to aggregate multiple clustering results, WormTensor showed higher silhouette coefficients. Our simulation also showed that WormTensor is robust to contamination from noisy data. WormTensor is freely available as an R/CRAN package <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/WormTensor">https://cran.r-project.org/web/packages/WormTensor</ext-link>.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05230-2.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>
        <italic>C. elegans</italic>
      </kwd>
      <kwd>NaCl stimuli</kwd>
      <kwd>Calcium imaging</kwd>
      <kwd>Neural activity</kwd>
      <kwd>Functional modules</kwd>
      <kwd>Tensor decomposition</kwd>
      <kwd>Weighting</kwd>
      <kwd>Consensus clustering</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001695</institution-id>
            <institution>Japan Science and Technology Corporation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>JPMJPR1945</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>The special postdoctoral researcher program at RIKEN</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001691</institution-id>
            <institution>Japan Society for the Promotion of Science</institution>
          </institution-wrap>
        </funding-source>
        <award-id>19K20406</award-id>
        <principal-award-recipient>
          <name>
            <surname>Tsuyuzaki</surname>
            <given-names>Koki</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par21">Nervous systems sense information from the external environment and produce appropriate response behaviors in living animals. Thus, sensory neurons respond to the environmental stimuli, and interneurons and motor neurons are activated in a manner dependent on the activity of the sensory neurons. These neurons showing correlated activities form a functional module, and many efforts have been made to identify such functional modules and understand their dynamics [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>].</p>
    <p id="Par22">The nematode <inline-formula id="IEq3"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Caenorhabditis\ elegans$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>h</mml:mi><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mspace width="4pt"/><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>g</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq3.gif"/></alternatives></inline-formula> is a model animal in behavioral neuroscience. <italic>C. elegans</italic> are known to migrate toward chemoattractants including sodium chloride (NaCl). This means that changes in NaCl concentration function as external stimuli for the nervous system, and such stimuli can be used to identify functional modules among neurons involved in the induced behavior. In addition, the nervous system of the nematode consists of 302 neurons whose name and connectivity have already been identified anatomically [<xref ref-type="bibr" rid="CR3">3</xref>]. The small and transparent body of <italic>C. elegans</italic> is suitable for measuring neural activity by calcium imaging [<xref ref-type="bibr" rid="CR4">4</xref>]. Furthermore, advanced molecular genetics techniques facilitate labeling each neuron in living animals [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. These features enable researchers to obtain functional modules in a comprehensive manner by measuring the whole-brain activity with single-cell resolution.</p>
    <p id="Par23">Several groups, including our own, have already obtained whole-brain activity data from nematodes with neuron identity information [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR10">10</xref>]. However, the obtained whole-brain activity data have several problems that impede the identification of functional modules. In the whole-brain activity data, some neurons are not detected or identified, and are excluded as missing values [<xref ref-type="bibr" rid="CR6">6</xref>]. The excluded neurons vary among individual animals, and more than half of the neurons are excluded in some experiments. In addition, neural networks show spontaneous and synchronized activities that mask information associated with external stimuli [<xref ref-type="bibr" rid="CR6">6</xref>]. These activities differ among individual animals, complicating direct comparisons of correlations in neural activities among individual animals. Thus, to find functional modules in whole-brain activity data, we need to resolve the problems of missing values and individual differences in neural states.</p>
    <p id="Par24">Here we present a method WormTensor to find functional modules that are common among individual animals in whole-brain activity data while allowing missing values. We apply the method to our whole-brain data from 24 animals and successfully identify known functional modules. WormTensor uses a distance measure called modified shape-based distance (mSBD) to account for time delay (lag) of cell-cell interactions. In addition, WormTensor uses a tensor decomposition called multi-view clustering based on matrix integration using the HOOI algorithm (MC-MI-HOOI) to detect clusters of cells common to multiple animals and weights for each animal simultaneously. WormTensor is freely available as an R/CRAN package <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/WormTensor">https://cran.r-project.org/web/packages/WormTensor</ext-link>.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>WormTensor showed high silhouette coefficients</title>
      <p id="Par25">To evaluate the effectivity of usage of mSBD and MC-MI-HOOI, we tested all the combinations of two distance measures (Euclidean distance and mSBD) and two clustering methods (<italic>cluster-based similarity partitioning algorithm</italic> (CSPA) [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>] and MC-MI-HOOI) (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). For the details, see the Material and Methods section.<fig id="Fig1"><label>Fig. 1</label><caption><p><bold>a</bold> Schematic of WormTensor. The neural activity data matrices measured for <italic>M</italic> animals are transformed into the distance matrices and the membership matrices (binary matrices). In the cluster-based similarity partitioning algorithm (CSPA), the consensus matrix is averaged over all the membership matrices and used for downstream clustering and visualization (t-distributed stochastic neighbor embedding (t-SNE) and uniform manifold approximation and projection (UMAP)). WormTensor, on the other hand, does not take the average, but regards the multiple membership matrices as a third-order tensor, applies tensor decomposition, and uses the computed <italic>K</italic> dimensional factor matrix U for downstream analysis. WormTensor also generates weight vector W, which contains the weights for data from each of the animals. <bold>b</bold> Neuronal activities of neurons with the same phase. In this case, the positive correlation coefficient between AVAR and RIMR is maximized when translating AVAR to the right by <inline-formula id="IEq4"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau = 35$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>35</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq4.gif"/></alternatives></inline-formula>. <bold>c</bold> Neuronal activities of neurons with reverse phases. In this case, the negative correlation coefficient between ASEL and ASER is minimized when translating ASEL to the right by <inline-formula id="IEq5"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau = 14$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>14</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq5.gif"/></alternatives></inline-formula>. mSBD handles both (<bold>b</bold>) and (<bold>c</bold>) cases in a unified manner by taking the absolute value of the correlation coefficient</p></caption><graphic xlink:href="12859_2023_5230_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par26">For all the combinations, we quantitatively evaluated the clustering results using silhouette coefficients [<xref ref-type="bibr" rid="CR13">13</xref>] (see Material and Methods). The values of silhouette coefficients were calculated in each cell of each animal to show how each cluster is aggregated compared to the other clusters. The averaged value of the silhouette coefficients of all the cells was calculated in each number of clusters (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). The values showed that, regardless of the number of clusters and the distance measures, MC-MI-HOOI was able to capture more aggregated clusters compared with CSPA. Additionally, mSBD further outperformed Euclidean distance, which suggests that there are lags of cell–cell interactions between neurons in <italic>C. elegans</italic>, and correcting for the shift-invariance contributes to detecting clusters that are repeated across animals.</p>
    </sec>
    <sec id="Sec4">
      <title>Estimation of the optimal number of clusters</title>
      <p id="Par27">Using the cellular labels listing the known functional modules (Additional files <xref rid="MOESM1" ref-type="media">1</xref> and <xref rid="MOESM2" ref-type="media">2</xref>), we found that the NaCl stimulus-related cells and principal component 1-related cells with positive coefficients (PC1_pos-related) cells were relatively easy to detect as clusters in many clustering methods. PC1_pos-related cells were heavily weighted in the first principal component of whole-brain activity data in a previous study [<xref ref-type="bibr" rid="CR8">8</xref>] and are involved in forward and backward locomotion of <italic>C. elegans</italic>.<fig id="Fig2"><label>Fig. 2</label><caption><p>Estimation of the number of clusters. The number of clusters was estimated by silhouette coefficients and prior knowledge about the movement of <italic>C. elegans</italic>. The cluster-based similarity partitioning algorithm (CSPA) and WormTensor with Euclidean distance and modified shape-based distance (mSBD) are performed with the number of clusters (2–20). <bold>a</bold> The <italic>x</italic>-axis represents the number of clusters, and the <italic>y</italic>-axis represents the average silhouette coefficient for all the cells for each number of clusters. <bold>b</bold> The silhouette coefficient for each cell in the optimal number of clusters</p></caption><graphic xlink:href="12859_2023_5230_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par28">NaCl- and PC1_pos-related cells could be differentiated without negative silhouette coefficients when WormTensor considered six clusters (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). Therefore, we regarded this value as the optimal number of clusters for WormTensor and used six clusters in further analysis. For MC-MI-HOOI with Euclidean distance and CSPA with mSBD, similar results were obtained when the number of clusters was 10 and 5, respectively. For CSPA with Euclidean distance, however, only PC1_pos-related cells were detected as a cluster. For the details of these clustering results, see Additional files <xref rid="MOESM2" ref-type="media">2</xref>, <xref rid="MOESM3" ref-type="media">3</xref>, <xref rid="MOESM4" ref-type="media">4</xref>, <xref rid="MOESM5" ref-type="media">5</xref>, <xref rid="MOESM6" ref-type="media">6</xref>, <xref rid="MOESM7" ref-type="media">7</xref> and <xref rid="MOESM8" ref-type="media">8</xref>).</p>
    </sec>
    <sec id="Sec5">
      <title>WormTensor detected NaCl stimulus-related and movement-related cells</title>
      <p id="Par29">Figure <xref rid="Fig3" ref-type="fig">3</xref> shows the UMAP plots for all the combinations of the distance measures and the clustering methods. As the plots of WormTensor (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d) and CSPA with mSBD (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c) show, NaCl stimulus-related cells (cluster <inline-formula id="IEq6"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#5$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mo>#</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq6.gif"/></alternatives></inline-formula> for WormTensor, <inline-formula id="IEq7"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#3$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mo>#</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq7.gif"/></alternatives></inline-formula> for CSPA with mSBD) and PC1_pos-related cells (cluster <inline-formula id="IEq8"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#6$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mo>#</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq8.gif"/></alternatives></inline-formula> for WormTensor, <inline-formula id="IEq9"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#4$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mo>#</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq9.gif"/></alternatives></inline-formula> for CSPA with mSBD) were separated as distinct clusters.</p>
      <p id="Par30">Using prior knowledge about the neuronal cells (Additional files <xref rid="MOESM1" ref-type="media">1</xref> and <xref rid="MOESM2" ref-type="media">2</xref>), we interpreted some clusters (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). For example, the cells that formed clusters are not clustered according to the neuron type, e.g., “Non-neuronal cells”, “Interneuron”, “Motor neuron”, and “Sensory neuron”, based on WormWiring annotation (<ext-link ext-link-type="uri" xlink:href="https://wormwiring.org">https://wormwiring.org</ext-link>) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). Rather, it showed a structure that followed the known functional modules, such as NaCl stimulus (cluster <inline-formula id="IEq10"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#5$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mo>#</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq10.gif"/></alternatives></inline-formula>), PC1_pos (cluster <inline-formula id="IEq11"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#6$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mo>#</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq11.gif"/></alternatives></inline-formula>), and principal component 1-related cells with negative coefficients (cluster <inline-formula id="IEq12"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#4$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mo>#</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq12.gif"/></alternatives></inline-formula>, PC1_neg [<xref ref-type="bibr" rid="CR8">8</xref>]) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). We assessed “consistency” between the clusters of WormTensor calculated from all the animals and the clusters calculated in each animal (see Materials and Methods). By using this measure, these three clusters were found to be reproducibly detected in the majority of animals (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c). For another presentation of the results of Figs. <xref rid="Fig3" ref-type="fig">3</xref> and <xref rid="Fig4" ref-type="fig">4</xref> with the t-SNE coordinates, see Additional files <xref rid="MOESM9" ref-type="media">9</xref> and <xref rid="MOESM10" ref-type="media">10</xref>.<fig id="Fig3"><label>Fig. 3</label><caption><p>Results of clustering with the optimal number of clusters utilizing t-distributed stochastic neighbor embedding (t-SNE) and uniform manifold approximation and projection (UMAP). <bold>a</bold> The clustering results of the cluster-based similarity partitioning algorithm (CSPA) with Euclidean distance. <bold>b</bold> The clustering results of multi-view clustering based on matrix integration using the HOOI algorithm (MC-MI-HOOI) with Euclidean distance. <bold>c</bold> The clustering results of CSPA with modified shape-based distance (mSBD). <bold>d</bold> The clustering results of WormTensor, utilizing MC-MI-HOOI with mSBD</p></caption><graphic xlink:href="12859_2023_5230_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par31">In addition to the three clusters above, another cluster was also annotated based on previous reports. We also evaluated whether a set of annotation terms is enriched within each cluster using the hypergeometric test and Benjamini-Hochberg method [<xref ref-type="bibr" rid="CR14">14</xref>] to correct for the multiple testing problem (Additional file <xref rid="MOESM11" ref-type="media">11</xref>).</p>
      <p id="Par32">According to this approach, for example, some PC2-related cells (these cells were heavily weighted in the second principal component of whole-brain activity data in the previous study [<xref ref-type="bibr" rid="CR8">8</xref>] that are involved in turning movement of <italic>C. elegans</italic>) were enriched in cluster <inline-formula id="IEq13"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#3$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mo>#</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq13.gif"/></alternatives></inline-formula> (Table <xref rid="Tab1" ref-type="table">1</xref>).<table-wrap id="Tab1"><label>Table 1</label><caption><p>Summary of the clustering results of WormTensor</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Cluster No.</th><th align="left">Our annotations</th><th align="left">Example cells</th></tr></thead><tbody><tr><td align="left">#1</td><td align="left">Unknown</td><td align="left">–</td></tr><tr><td align="left">#2</td><td align="left">PC2-related cells</td><td align="left">SMDVR, RIVL/R</td></tr><tr><td align="left">#3</td><td align="left">PC2-related cells</td><td align="left">AIBR, OLQDL/R, SMDVL</td></tr><tr><td align="left">#4</td><td align="left"><p>PC1_neg-related cells and some epidermal cells</p><p>(The number of identified cells is relatively low; see Fig. <xref rid="Fig4" ref-type="fig">4</xref>d)</p></td><td align="left">RIBL, RMED, RMEL/R, RMEV</td></tr><tr><td align="left">#5</td><td align="left">NaCl stimulus-related cells</td><td align="left">ASEL/R, AWBL, AWCL/R, BAGL/R</td></tr><tr><td align="left">#6</td><td align="left">PC1_pos-related cells</td><td align="left">AVAL/R, AVER, RIML/R, (AIBL)</td></tr></tbody></table></table-wrap><table-wrap id="Tab2"><label>Table 2</label><caption><p>Summary of the <italic>C. elegans</italic> animals used</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Animal no.</th><th align="left">No. of cells</th><th align="left">Frame/sec</th><th align="left">QC by visual inspection</th></tr></thead><tbody><tr><td align="left">#1</td><td char="." align="char">161</td><td char="." align="char">4.12</td><td align="left">PASS</td></tr><tr><td align="left">#2</td><td char="." align="char">182</td><td char="." align="char">5.72</td><td align="left">PASS</td></tr><tr><td align="left">#3</td><td char="." align="char">158</td><td char="." align="char">5.71</td><td align="left">WARNING (temporary abnormal waveform)</td></tr><tr><td align="left">#4</td><td char="." align="char">180</td><td char="." align="char">5.71</td><td align="left">PASS</td></tr><tr><td align="left">#5</td><td char="." align="char">197</td><td char="." align="char">5.71</td><td align="left">PASS</td></tr><tr><td align="left">#6</td><td char="." align="char">180</td><td char="." align="char">5.71</td><td align="left">PASS</td></tr><tr><td align="left">#7</td><td char="." align="char">196</td><td char="." align="char">5.72</td><td align="left">PASS</td></tr><tr><td align="left">#8</td><td char="." align="char">196</td><td char="." align="char">5.72</td><td align="left">WARNING (temporary abnormal waveform)</td></tr><tr><td align="left">#9</td><td char="." align="char">173</td><td char="." align="char">5.72</td><td align="left">PASS</td></tr><tr><td align="left">#10</td><td char="." align="char">191</td><td char="." align="char">5.71</td><td align="left">PASS</td></tr><tr><td align="left">#11</td><td char="." align="char">157</td><td char="." align="char">5.71</td><td align="left">PASS</td></tr><tr><td align="left">#12</td><td char="." align="char">168</td><td char="." align="char">5.71</td><td align="left">PASS</td></tr><tr><td align="left">#13</td><td char="." align="char">211</td><td char="." align="char">4.12</td><td align="left">PASS</td></tr><tr><td align="left">#14</td><td char="." align="char">231</td><td char="." align="char">3.73</td><td align="left">PASS</td></tr><tr><td align="left">#15</td><td char="." align="char">201</td><td char="." align="char">3.69</td><td align="left">PASS</td></tr><tr><td align="left">#16</td><td char="." align="char">198</td><td char="." align="char">3.69</td><td align="left">PASS</td></tr><tr><td align="left">#17</td><td char="." align="char">202</td><td char="." align="char">4.10</td><td align="left">PASS</td></tr><tr><td align="left">#18</td><td char="." align="char">214</td><td char="." align="char">4.05</td><td align="left">PASS</td></tr><tr><td align="left">#19</td><td char="." align="char">215</td><td char="." align="char">4.05</td><td align="left">PASS</td></tr><tr><td align="left">#20</td><td char="." align="char">203</td><td char="." align="char">4.04</td><td align="left">FAILURE (severe abnormal waveform)</td></tr><tr><td align="left">#21</td><td char="." align="char">216</td><td char="." align="char">4.04</td><td align="left">PASS</td></tr><tr><td align="left">#22</td><td char="." align="char">181</td><td char="." align="char">4.09</td><td align="left">PASS</td></tr><tr><td align="left">#23</td><td char="." align="char">207</td><td char="." align="char">4.08</td><td align="left">PASS</td></tr><tr><td align="left">#24</td><td char="." align="char">207</td><td char="." align="char">4.07</td><td align="left">PASS</td></tr><tr><td align="left">#25</td><td char="." align="char">156</td><td char="." align="char">4.04</td><td align="left">WARNING (temporary abnormal waveform)</td></tr><tr><td align="left">#26</td><td char="." align="char">196</td><td char="." align="char">4.06</td><td align="left">PASS</td></tr><tr><td align="left">#27</td><td char="." align="char">220</td><td char="." align="char">4.05</td><td align="left">PASS</td></tr><tr><td align="left">#28</td><td char="." align="char">207</td><td char="." align="char">3.99</td><td align="left">PASS</td></tr></tbody></table><table-wrap-foot><p>All neural activity values were measured for 6000 time frames</p></table-wrap-foot></table-wrap></p>
      <p id="Par33">While AIBL is a PC2-related cell, it is categorized in PC1_pos cluster. This is probably because AIBL is involved in PC2 as well as PC1_pos, as previously shown [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR15">15</xref>]. Likewise, AVBR, which is one of the PC1_neg-related cells categorized in PC2 cluster, might be involved in both PC1_neg and PC2, as some studies have suggested [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR16">16</xref>].</p>
      <p id="Par34">Although the NaCl stimulus and PC1_pos-related cells were detected by both WormTensor and CSPA with mSBD, WormTensor was more able to enrich a cluster with PC1_neg-related cells (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b and Additional file <xref rid="MOESM11" ref-type="media">11</xref>). In consideration of these results together with its high silhouette coefficient (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a), WormTensor was found to be the most suitable for capturing functional modules in <italic>C. elegans</italic> compared with the other methods tested in this study.</p>
    </sec>
    <sec id="Sec6">
      <title>WormTensor automatically assigned small weights to animals with a small number of identified cells and noisy data</title>
      <p id="Par35">Unlike CSPA, which assumes that all animals have common clusters, WormTensor is a model that allows differences among animals; in the optimization process, animals without common clusters are automatically evaluated with smaller weights. We further interpreted the weights of WormTensor. We investigated whether the datasets contain any covariates that are correlated with the weights and found at least three possible covariates as follows.<fig id="Fig4"><label>Fig. 4</label><caption><p>Results of WormTensor utilizing t-distributed stochastic neighbor embedding (t-SNE) and uniform manifold approximation and projection (UMAP). <bold>a</bold> Neuron type (based on WormWiring annotation). <bold>b</bold> The labels of movement in <italic>C. elegans</italic>. <bold>c</bold> Consistency between the results of hierarchical clustering in each animal and WormTensor. <bold>d</bold> The number of identified cells</p></caption><graphic xlink:href="12859_2023_5230_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par36">The first potential covariate is the total number of annotated cells in each animal (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a, black line). To evaluate whether this possible covariate is correlated with the weights in the result of WormTensor with 6 clusters, we performed the Cochran–Armitage trend test, and the <italic>p</italic>-value was <inline-formula id="IEq14"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5.60E-34$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mn>5.60</mml:mn><mml:mi>E</mml:mi><mml:mo>-</mml:mo><mml:mn>34</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq14.gif"/></alternatives></inline-formula>.</p>
      <p id="Par37">The second potential covariate is the similarity between the clustering results of WormTensor and the clustering results of individual animals (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a, red line). The similarity was quantified using the adjusted Rand index (ARI [<xref ref-type="bibr" rid="CR17">17</xref>]) between them, and the <italic>p</italic>-value of the Jonckheere–Terpstra trend test was <inline-formula id="IEq15"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$9.66E-4$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mn>9.66</mml:mn><mml:mi>E</mml:mi><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq15.gif"/></alternatives></inline-formula>.</p>
      <p id="Par38">Both of these tests were highly significant at the <inline-formula id="IEq16"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p &lt; 0.05$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq16.gif"/></alternatives></inline-formula> level and thus indicate decreasing trends in the number of identified cells and the similarity of clustering results according to the weights (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). We also investigated the results with different numbers of clusters (2–20) (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b) and found that the animals with small weights were generally assigned robustly small values independent of the number of clusters.<fig id="Fig5"><label>Fig. 5</label><caption><p>Interpretation of the weights of WormTensor. <bold>a</bold> The <italic>x</italic>-axis represents the animals sorted by their weights in WormTensor with the number of clusters set to 6. the left <italic>y</italic>-axis represents the adjusted Rand index (ARI) value between the result of clustering by WormTensor and Ward’s hierarchical clustering, and the right <italic>y</italic>-axis represents the number of identified cells. <bold>b</bold> The <italic>y</italic>-axis shows the weights of all the animals for different numbers of cluster (2–20) and the <italic>x</italic>-axis shows the animals sorted by their average weights with different numbers of clusters</p></caption><graphic xlink:href="12859_2023_5230_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par39">The third potential covariate is the noisiness of temporal patterns in data from each animal. In this work, the data matrices from three animals (<inline-formula id="IEq17"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#3$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mo>#</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq17.gif"/></alternatives></inline-formula>, <inline-formula id="IEq18"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#8$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mo>#</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq18.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq19"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#25$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mo>#</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq19.gif"/></alternatives></inline-formula>) that contained abnormal waveforms in all the cells regardless of cell type and were excluded from the analysis by prior quality control (QC) (Table <xref rid="Tab2" ref-type="table">2</xref>) were added to the WormTensor input individually. The weights for animals <inline-formula id="IEq20"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#3$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mo>#</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq20.gif"/></alternatives></inline-formula>, <inline-formula id="IEq21"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#8$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mo>#</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq21.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq22"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#25$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mo>#</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq22.gif"/></alternatives></inline-formula> were automatically reduced (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a–c), and similar results were obtained when all three animals were input into WormTensor at once (Fig. <xref rid="Fig6" ref-type="fig">6</xref>d).</p>
      <p id="Par40">We also added the data matrix from animal <inline-formula id="IEq23"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#20$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:mo>#</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq23.gif"/></alternatives></inline-formula>, whose temporal patterns were contaminated with extremely strong noise. For this animal, however, WormTensor’s effect of reducing weight for noisy data was modest (as it was ranked 8-th according to weight among all the animals, Additional file <xref rid="MOESM12" ref-type="media">12</xref>). Further examination revealed that animal <inline-formula id="IEq24"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#20$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:mo>#</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq24.gif"/></alternatives></inline-formula> had left the holding position of the microfluidic chip during imaging and moved outside of the field of view, which caused an abnormal fluorescence intensity change in all cells (Additional file <xref rid="MOESM12" ref-type="media">12</xref>). There are at least two possible explanations for the high weight despite the anomaly of the waveforms. First, the number of cells that could be tracked before the abnormal waves occurred was relatively large, so WormTensor estimated the weights to be high. Second, an outlier distance matrix may have been generated from animal <inline-formula id="IEq25"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#20$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mo>#</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq25.gif"/></alternatives></inline-formula> and optimization subsequently overfitted data from the animal.</p>
      <p id="Par41">Although the above covariates alone do not perfectly explain the weights, as all of the above covariates are related to data quality, the property of WormTensor that automatically reduces the weights for such unreliable animals’ datasets is expected to be useful from a QC perspective; even if some low-quality data is inadvertently included in the analysis, the weights may mitigate the negative effects to some extent. Of course, as weights alone do not perfectly eliminate low-quality datasets (e.g., animal <inline-formula id="IEq26"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\#20$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mo>#</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq26.gif"/></alternatives></inline-formula>), it is also important to investigate the details of the data and to be aware of low-quality animals by visual inspection. To assist such efforts, we have implemented several visualization functions (see Implementation).</p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Discussion</title>
    <p id="Par42">In this analysis, we applied the WormTensor method to our whole-brain activity data from <italic>C. elegans</italic> and successfully obtained functional modules. In <italic>C. elegans</italic>, it is well known that most neurons do not have action potentials, and the neural activities instead change gradually. In addition, the temporal patterns of neural activities show positive and negative correlations with each other as well as lags of several lengths. Many biological dynamic systems, spanning intracellular signal transduction to animal behaviors, have similar features, and WormTensor should be suitable for extracting functional modules from temporal dynamics of such systems.<fig id="Fig6"><label>Fig. 6</label><caption><p>Robustness to noisy data addition. <bold>a</bold>–<bold>c</bold> The order of WormTensor weights of the animals when an additional noisy data matrix was added individually. <bold>d</bold> The order of WormTensor weights of the animals when three noisy data matrices were added at once. The arrows indicate the added noisy datasets</p></caption><graphic xlink:href="12859_2023_5230_Fig6_HTML" id="MO6"/></fig><fig id="Fig7"><label>Fig. 7</label><caption><p>Workflow of the WormTensor package. All the functions can be performed using R’s native pipe operation</p></caption><graphic xlink:href="12859_2023_5230_Fig7_HTML" id="MO7"/></fig></p>
    <p id="Par43">Because we did not set the upper and lower limits of the lag, it may be reasonably speculated many false positive pairs are clustered with extremely large (or small) <inline-formula id="IEq27"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\tau }$$\end{document}</tex-math><mml:math id="M52"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq27.gif"/></alternatives></inline-formula> values that are biologically meaningless. However, we concluded that such a bias is not severe in the clustering results. For details, see Additional file <xref rid="MOESM13" ref-type="media">13</xref>.</p>
    <p id="Par44">Because WormTensor uses mSBD, which treats correlation and anti-correlation equally by evaluating an absolute value function, one could suppose that PC1_pos and PC1_neg could be assigned a common cluster. However, we concluded that these two groups did not and should not be in the same cluster. For details, see Additional file <xref rid="MOESM14" ref-type="media">14</xref>.</p>
    <p id="Par45">Prior to the use of silhouette coefficients, we used various external and internal measures [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>] (all of those measures can be reproduced as functions inside WormTensor). However, for the present data, we chose not to use them, except for the silhouette coefficient per cell (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). For the details, see Additional file <xref rid="MOESM15" ref-type="media">15</xref>.</p>
    <p id="Par46">By analyzing the neuronal activity data as a tensor instead of a matrix, the memory usage is increased from <inline-formula id="IEq28"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}\left( N \times N\right)$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mfenced close=")" open="("><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq28.gif"/></alternatives></inline-formula> to <inline-formula id="IEq29"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}\left( N \times N\times M\right)$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mfenced close=")" open="("><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq29.gif"/></alternatives></inline-formula>, where <italic>N</italic> is the number of cells and <italic>M</italic> is the number of animals. Therefore, compared to matrix-based methods such as CSPA, WormTensor might be considered somewhat computationally disadvantageous. However, this is not much of a problem in realistic situations, that is, the number of somatic cells in <italic>C. elegans</italic> is approximately 1000 [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>], so the upper limit of <italic>N</italic> is fixed. Additionally, the data size does not become particularly large unless <italic>M</italic> is quite large (e.g., over 1000 animals).</p>
    <p id="Par47">We believe that the advantages of using tensor decomposition outweigh the above disadvantages; this approach not only improves silhouette coefficient compared to consensus clustering, as discussed in this work, but also allows for automatic estimation of weights. In data analysis that deals with multiple data sets (e.g., multiple individuals/multi-view/multi-modal/multi-omics data [<xref ref-type="bibr" rid="CR22">22</xref>–<xref ref-type="bibr" rid="CR26">26</xref>] and heterogeneous data fusion [<xref ref-type="bibr" rid="CR27">27</xref>]), data with large values, a large number of patterns, and large size may dominate in optimization, and multiple data may not be treated equally. Alternatively, it may be the case that data of low quality are excluded from optimization because merging them with equal weight would reduce the performance of the overall optimization. In either case, it is necessary to appropriately weigh the individual datasets during optimization. Hence, weighting is not a trivial issue.</p>
    <p id="Par48">Some ad hoc weighting approaches, such as using L2-norm [<xref ref-type="bibr" rid="CR23">23</xref>], the number of observed elements [<xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR29">29</xref>], variance [<xref ref-type="bibr" rid="CR25">25</xref>], the first eigenvalue [<xref ref-type="bibr" rid="CR24">24</xref>], and correlations with an external standard [<xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR30">30</xref>], can be used as the weight of each matrix/tensor, but it is unclear which approaches are appropriate. In contrast, in the tensor decomposition algorithm we used, the weights are not pre-set but are instead automatically estimated from the dataset. Therefore, there is no need to discuss the arbitrariness of the approaches described above. Moreover, based on the estimated weights, it can be appropriately used to investigate which animals were considered important or not. This ability is considered an excellent property for the purpose of QC.</p>
    <p id="Par49">From a different point of view, outlier animals with clusters that are not common among multiple animals might be biologically meaningful. Although the original purpose of WormTensor is to find clusters that are common among multiple animals and the weights can be interpreted as the degree of commonality, since a small weight means that the data of the animal is not similar to those of other animals, the weights could also assist the task of finding outlier animals in the data. After finding the outliers, some analytical methods can be individually applied to such animals and we can investigate the details.</p>
    <sec id="Sec8">
      <title>Comparison with other studies</title>
      <p id="Par50">Several methods have been applied to analyze whole-brain neural activity in <italic>C. elegans</italic>. A switching linear dynamical system (SLDS) provides a method to estimate discrete hidden states in time series data. The SLDS method has been applied to whole-brain neural activity to estimate the internal states of neural networks common across multiple animals and their transitions [<xref ref-type="bibr" rid="CR31">31</xref>]. Other reports have analyzed whole-brain neural activity using PCA [<xref ref-type="bibr" rid="CR8">8</xref>], ridge regression [<xref ref-type="bibr" rid="CR32">32</xref>], and maximum entropy models [<xref ref-type="bibr" rid="CR33">33</xref>], but these have only been applied to single animals.</p>
      <p id="Par51">Tensor decomposition has been applied to analyze large-scale neural activity data. For example, tensor component analysis decomposes the neural population recordings of mice into neuronal, temporal, and trial factors and is able to extract gradual changes in neural activity as learning progresses [<xref ref-type="bibr" rid="CR34">34</xref>]. As another example, the shifted CP method decomposes electroencephalography (EEG) data from human subjects as a spatiotemporal superposition of components with a fixed time course and correctly unmixes the spatiotemporal signals in the EEG data [<xref ref-type="bibr" rid="CR35">35</xref>]. Thus, tensor decomposition is useful for analyzing large-scale neural activity data.</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Conclusion</title>
    <p id="Par52">Our analysis showed that the differences among distance measures and clustering algorithms can influence the results of time-series clustering the neuronal activity of <italic>C. elegans</italic>. The combination of mSBD and MC-MI-HOOI maximized the silhouette coefficients compared to the other tested combinations of methods and also matched well with prior knowledge about <italic>C. elegans</italic> neural modules.</p>
    <p id="Par53">To create distance matrices, we used Euclidean distance and mSBD, with the latter contributing to the detection of specific clusters of cell populations such as PC1_neg- and PC2-related cells. This suggests that the features considered only in mSBD, such as correlations in both positive and negative directions and lags, are important for detecting functional modules from <italic>C. elegans</italic> neural activity data.</p>
    <p id="Par54">The data in this study included some missing values in all animals, and when we assessed the only intersection of those cells with no missing values, not a single cell remained. In addition, it is difficult to determine how to make a comprehensive judgment when analyzing the data for each animal because of the degree of missing data and the large differences among the animals. Therefore, dealing with missing values was essential in this analysis. In our study, by simply setting the missing cells to 0 at the stage of creating the membership matrices, we were able to proceed with the subsequent analysis and extract biologically meaningful patterns.</p>
    <p id="Par55">Compared with CSPA, which takes the average of multiple clustering results into a consensus matrix, we found that the use of MC-MI-HOOI has some advantages; it does not use the average of clustering results, and it automatically assigns a weight to each animal instead while allowing for individual differences. In this work, the latter approach was empirically advantageous to detect functional modules from <italic>C. elegans</italic> neural activity data.</p>
    <p id="Par56">Furthermore, the estimated weights are expected to be useful in other analyses; MC-MI-HOOI automatically avoids clustering results derived from noisy data by assigning small weights to the corresponding animals, and the weights themselves can reasonably be used for QC of data from animals.</p>
    <p id="Par57">All of the analyses including time-series clustering and visualizations performed in this work have been implemented as R functions available within the WormTensor R/CRAN package and can be freely reproduced with user data.</p>
  </sec>
  <sec id="Sec10">
    <title>Materials and methods</title>
    <sec id="Sec11">
      <title>Dataset</title>
      <p id="Par58">The whole-brain activity dataset of <italic>C. elegans</italic> strains JN3038 obtained by Toyoshima et al. [<xref ref-type="bibr" rid="CR6">6</xref>] was used in this study. Briefly, each adult animal was held in a custom microfluidic chip and repeatedly stimulated by switching the sodium chloride concentration between 50mM and 25mM every 30 seconds. The volumetric movie of the head region of the animal was recorded at approximately 5 volumes per second using customized spinning-disc confocal microscopy. Genetically encoded calcium indicator Yellow-Cameleon 2.60 [<xref ref-type="bibr" rid="CR36">36</xref>] was expressed in all neurons of the animals. For each neuron, the time-series of fluorescent intensities of yellow fluorescent protein (YFP) and cyan fluorescent protein (CFP) of Yellow-Cameleon were obtained from the volumetric movie. The intensity ratio of YFP over CFP indicates the calcium level (fluorescence resonance energy transfer; FRET [<xref ref-type="bibr" rid="CR36">36</xref>]) and was used as an index of neural activity. A median filter [<xref ref-type="bibr" rid="CR37">37</xref>] with an 11-time point window was applied to the ratio to remove noise. The outlier neurons were removed from the dataset if the filtered ratio of the neuron contained missing values, negative values, or values larger than 10. The filtered ratio was smoothed using a third-order Savitzky–Golay filter [<xref ref-type="bibr" rid="CR38">38</xref>, <xref ref-type="bibr" rid="CR39">39</xref>] with a 101-time-point window. Finally, the time-series of smoothed ratios were scaled by dividing them by the mean value and subtracting 1. Annotation of neuronal identity was performed based on the spatial expression patterns of cell-specific promoters (i.e., landmark fluorescence) in the JN3038 strain. The dataset contains several non-neuronal cells, including GLR glial cells, pharyngeal gland cells, and hypodermal cells. Because a hypodermal cell has multiple nuclei (i.e., syncytium) and our experimental setup can detect each nucleus, we labeled them with the original name starting with HYPL.</p>
      <p id="Par59">The time-series neural activity values obtained from each animal were stored as a cell <inline-formula id="IEq30"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M58"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq30.gif"/></alternatives></inline-formula> time matrix. The measurements were collected from 28 animals, 4 of which were removed by QC, and the remaining 24 animals were used for our analysis (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a and Table <xref rid="Tab2" ref-type="table">2</xref>). Here, 192 cells in the 24 animals for which the neural activity values were measured at least once were included in the analysis. All neural activity values were measured for 6, 000 frames and the sampling rate (frame/sec) ranges from 3.69 to 5.73 (Table <xref rid="Tab2" ref-type="table">2</xref>). The above data matrices were converted to distance matrices (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). In this work, we used two distance measures: Euclidean distance and modified shape-based distance (mSBD). We explain mSBD below.</p>
      <sec id="Sec12">
        <title>Modified shape-based distance</title>
        <p id="Par60">To consider the lags of cell–cell interactions between neurons, we used a shift-invariant distance measure called shape-based distance (SBD [<xref ref-type="bibr" rid="CR40">40</xref>]) with some modification. For two arbitrary time-series data <italic>x</italic> and <italic>y</italic> SBD is given as<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \textrm{SBD}\left( x,y\right) = 1 - \max _{\mathrm {\tau }}{\left( \frac{R_{\tau -m}\left( x, y\right) }{\sqrt{\textrm{R}_{0}\left( x,x\right) \textrm{R}_{0}\left( y,y\right) }}\right) }, \end{aligned}$$\end{document}</tex-math><mml:math id="M60" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>SBD</mml:mtext><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:munder><mml:mo movablelimits="true">max</mml:mo><mml:mi>τ</mml:mi></mml:munder><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>τ</mml:mi><mml:mo>-</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mfenced></mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mtext>R</mml:mtext><mml:mn>0</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mfenced><mml:msub><mml:mtext>R</mml:mtext><mml:mn>0</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mfenced></mml:mrow></mml:msqrt></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5230_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq31"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau \in \{1,2,...,2m-1\}$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq31.gif"/></alternatives></inline-formula> is lag when sliding <italic>x</italic> to the right and <italic>m</italic> is the length of <italic>x</italic> and <italic>y</italic>. <inline-formula id="IEq32"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\tau -m}\left( x, y\right)$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>τ</mml:mi><mml:mo>-</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq32.gif"/></alternatives></inline-formula> is the cross-correlation measure between <italic>x</italic> and <italic>y</italic> with lag <inline-formula id="IEq33"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M66"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq33.gif"/></alternatives></inline-formula>. <inline-formula id="IEq34"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\tau -m}\left( x, y\right)$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>τ</mml:mi><mml:mo>-</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq34.gif"/></alternatives></inline-formula>, <inline-formula id="IEq35"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}_{0}\left( x,x\right)$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:msub><mml:mtext>R</mml:mtext><mml:mn>0</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq35.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq36"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}_{0}\left( x,x\right)$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:msub><mml:mtext>R</mml:mtext><mml:mn>0</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq36.gif"/></alternatives></inline-formula> are calculated as the inner product between <italic>x</italic> and <italic>y</italic> with lag <inline-formula id="IEq37"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M74"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq37.gif"/></alternatives></inline-formula> as follows:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} R_{\tau }\left( x,y\right) = {\left\{ \begin{array}{ll} {\sum }_{l=1}^{m-k}{x_{l+\tau } \cdot y_{l}} &amp;{} \left( \tau \ge 0\right) \\ R_{-\tau }\left( y,x\right) &amp;{} \left( \tau &lt; 0\right) \end{array}\right. }. \end{aligned}$$\end{document}</tex-math><mml:math id="M76" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>τ</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfenced close=")" open="("><mml:mi>τ</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mfenced></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfenced close=")" open="("><mml:mi>τ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5230_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula> To achieve shift-invariance, cross-correlation keeps <italic>y</italic> static and slides <italic>x</italic> over <italic>y</italic> to compute their inner product for each shift <inline-formula id="IEq38"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M78"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq38.gif"/></alternatives></inline-formula> of <italic>x</italic>. When sliding <italic>x</italic>, only the elements of <italic>x</italic> and <italic>y</italic> that share time are used to calculate cross-correlation. To capture the negative correlation between neurons, we defined mSBD as<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\textrm{mSBD}}\left( x,y\right) = 1 - \max _{\tau }{\left( \textrm{abs}{\left( \frac{R_{s-m}\left( x, y\right) }{\sqrt{\textrm{R}_{0}\left( x,x\right) \textrm{R}_{0}\left( y,y\right) }}\right) }\right) }, \end{aligned}$$\end{document}</tex-math><mml:math id="M80" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>mSBD</mml:mtext><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:munder><mml:mo movablelimits="true">max</mml:mo><mml:mi>τ</mml:mi></mml:munder><mml:mfenced close=")" open="("><mml:mtext>abs</mml:mtext><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mfenced></mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mtext>R</mml:mtext><mml:mn>0</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mfenced><mml:msub><mml:mtext>R</mml:mtext><mml:mn>0</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mfenced></mml:mrow></mml:msqrt></mml:mfrac></mml:mfenced></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5230_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula> where the absolute value function <inline-formula id="IEq39"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$abs\left( \right)$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi><mml:mfenced close=")" open="("/></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq39.gif"/></alternatives></inline-formula> is included to search for the highest correlation. This makes it possible to handle the interactions between cell pairs with high positive correlation such as AVAR and RIMR (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b), and cell pairs with high negative correlation such as ASEL and ASER (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c), in a unified manner. This modification is based on mutual inhibition, in which the A-type and B-type command interneurons inhibit each other, resulting in a negative correlation between these neurons [<xref ref-type="bibr" rid="CR41">41</xref>].</p>
      </sec>
    </sec>
    <sec id="Sec13">
      <title>Membership matrices</title>
      <p id="Par61">For each distance matrix by mSBD (Eq. (<xref rid="Equ3" ref-type="disp-formula">3</xref>), hierarchical clustering (Ward’s method [<xref ref-type="bibr" rid="CR42">42</xref>]) with <italic>K</italic> clusters was applied, and based on the results, we obtained a binary matrix (membership matrix) (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). The membership matrix of the <italic>m</italic>-th animal is defined as follows:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \left[ S_{m}\right] _{i,j} = {\left\{ \begin{array}{ll} 1 &amp;{} \left( \text {if cell }i\text { and cell }j\text { belong to the same cluster}\right) \ \\ 0 &amp;{} \left( \text {otherwise}\right) \end{array}\right. }. \end{aligned}$$\end{document}</tex-math><mml:math id="M84" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mfenced close="]" open="["><mml:msub><mml:mi>S</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mfenced><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfenced close=")" open="("><mml:mtext>if cell</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>i</mml:mi><mml:mspace width="0.333333em"/><mml:mtext>and cell</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>j</mml:mi><mml:mspace width="0.333333em"/><mml:mtext>belong to the same cluster</mml:mtext></mml:mfenced><mml:mspace width="4pt"/></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfenced close=")" open="("><mml:mtext>otherwise</mml:mtext></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5230_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>If a cell was not identified in an animal, it was assumed that the cell did not belong to the same cluster as any of the other cells.</p>
    </sec>
    <sec id="Sec14">
      <title>Clustering</title>
      <sec id="Sec15">
        <title>Cluster-based similarity partitioning</title>
        <p id="Par62">Consensus clustering (or cluster ensembles) was performed on the membership matrices described above. Note that consensus clustering is the generic term for clustering algorithms that aggregate multiple results of clustering. In this work, we used CSPA, which is perhaps the simplest and most widely used consensus clustering algorithm [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>].</p>
        <p id="Par63">In CSPA, the consensus matrix <inline-formula id="IEq40"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S \in \mathbb {R}^{N \times N}$$\end{document}</tex-math><mml:math id="M86"><mml:mrow><mml:mi>S</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq40.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a) is calculated by averaging all the membership matrices as follows:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \left[ S\right] _{i,j} = \frac{1}{M}\sum _{m=1}^{M}{\left[ D_{m}\right] _{i,j}}. \end{aligned}$$\end{document}</tex-math><mml:math id="M88" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mfenced close="]" open="["><mml:mi>S</mml:mi></mml:mfenced><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>M</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:msub><mml:mfenced close="]" open="["><mml:msub><mml:mi>D</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mfenced><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5230_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>Here, <italic>S</italic> is then converted to a dissimilarity matrix by <inline-formula id="IEq41"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1-S$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq41.gif"/></alternatives></inline-formula> and used for further analysis such as clustering or dimensionality reduction by t-SNE and UMAP. For clustering, we used Ward’s hierarchical clustering with <italic>K</italic> clusters, which is the same number of clusters we set when we created the membership matrices above.</p>
      </sec>
      <sec id="Sec16">
        <title>WormTensor</title>
        <p id="Par64">WormTensor performs two main processes. First, it uses mSBD described above to account for the lags and the mutual inhibition of cell–cell interactions. Second, it uses tensor decomposition for clustering to weigh each animal without averaging among them. Unlike CSPA, which reduces multiple membership matrices into a matrix <italic>S</italic>, WormTensor stacks the <italic>M</italic> membership matrices in the depth direction (the 3-rd dimension) and creates a third-order tensor <inline-formula id="IEq42"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {X} \in \mathbb {R}^{N \times N \times M}$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mi mathvariant="script">X</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq42.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a).</p>
        <p id="Par65">In WormTensor, the tensor decomposition algorithm MC-MI-HOOI is applied to this tensor. MC-MI-HOOI performs decomposition as follows:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \left[ \mathcal {X}\right] _{::m} \approx w_{m} U G U^{T}. \end{aligned}$$\end{document}</tex-math><mml:math id="M94" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mfenced close="]" open="["><mml:mi mathvariant="script">X</mml:mi></mml:mfenced><mml:mrow><mml:mo>:</mml:mo><mml:mo>:</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mi>U</mml:mi><mml:mi>G</mml:mi><mml:msup><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5230_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>Alternatively, in the matrix/tensor form, this is formalized as<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \mathcal {X} \approx G \times _{1} U \times _{2} U \times _{3} W, \end{aligned}$$\end{document}</tex-math><mml:math id="M96" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">X</mml:mi><mml:mo>≈</mml:mo><mml:mi>G</mml:mi><mml:msub><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:mi>U</mml:mi><mml:msub><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mi>U</mml:mi><mml:msub><mml:mo>×</mml:mo><mml:mn>3</mml:mn></mml:msub><mml:mi>W</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5230_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq43"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U \in \mathbb {R}^{N \times K}$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:mi>U</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq43.gif"/></alternatives></inline-formula> is the factor matrix, <inline-formula id="IEq44"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G \in \mathbb {R}^{K \times K}$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:mi>G</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq44.gif"/></alternatives></inline-formula> is the core tensor (a diagonal matrix), each element <inline-formula id="IEq45"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{m}$$\end{document}</tex-math><mml:math id="M102"><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq45.gif"/></alternatives></inline-formula> of vector <inline-formula id="IEq46"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W \in \mathbb {R}^{M}$$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:mi>W</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>M</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq46.gif"/></alternatives></inline-formula> is the weight of <italic>m</italic>-th slice of <inline-formula id="IEq47"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {X}$$\end{document}</tex-math><mml:math id="M106"><mml:mi mathvariant="script">X</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq47.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq48"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times _{l}$$\end{document}</tex-math><mml:math id="M108"><mml:msub><mml:mo>×</mml:mo><mml:mi>l</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq48.gif"/></alternatives></inline-formula> is the mode-<italic>l</italic> product [<xref ref-type="bibr" rid="CR43">43</xref>].</p>
        <p id="Par66">To decompose <italic>U</italic>, <italic>G</italic>, and <italic>W</italic>, MC-MI-HOOI solves the following optimization problem:<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} \max _{U,w}{\Vert U^{T} \left( \sum _{k=1}^{K}{w_{k}} \left[ \mathcal {X}\right] _{::k} \right) U \Vert _{F}^{2}} \\ \text {s.t.} \, U^{T}U=I_{K},\, \Vert W \Vert _{F}^{2} = 1 \end{aligned}. \end{aligned}$$\end{document}</tex-math><mml:math id="M110" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munder><mml:mo movablelimits="true">max</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:mo stretchy="false">‖</mml:mo></mml:mrow><mml:msup><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mfenced close=")" open="("><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:msub><mml:mi>w</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mfenced close="]" open="["><mml:mi mathvariant="script">X</mml:mi></mml:mfenced><mml:mrow><mml:mo>:</mml:mo><mml:mo>:</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:msubsup><mml:mrow><mml:mi>U</mml:mi><mml:mo stretchy="false">‖</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mtext>s.t.</mml:mtext><mml:mspace width="0.166667em"/><mml:msup><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mrow><mml:mo stretchy="false">‖</mml:mo><mml:mi>W</mml:mi><mml:mo stretchy="false">‖</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5230_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>Alternatively, in the matrix/tensor form, this is formalized as<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} \max _{U,w}{\Vert \mathcal {X} \times _{1} U^{T} \times _{2} U^{T} \times _{3} W^{T}\Vert _{F}^{2}} \\ \text {s.t.} \, U^{T}U=I_{K},\, \Vert W \Vert _{F}^{2} = 1 \end{aligned}, \end{aligned}$$\end{document}</tex-math><mml:math id="M112" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munder><mml:mo movablelimits="true">max</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:mo stretchy="false">‖</mml:mo><mml:mi mathvariant="script">X</mml:mi></mml:mrow><mml:msub><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mo>×</mml:mo><mml:mn>3</mml:mn></mml:msub><mml:msup><mml:mi>W</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msubsup><mml:mrow><mml:mo stretchy="false">‖</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mtext>s.t.</mml:mtext><mml:mspace width="0.166667em"/><mml:msup><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mrow><mml:mo stretchy="false">‖</mml:mo><mml:mi>W</mml:mi><mml:mo stretchy="false">‖</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5230_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq49"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{K} \in \mathbb {R}^{K \times K}$$\end{document}</tex-math><mml:math id="M114"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq49.gif"/></alternatives></inline-formula> is the identity matrix of size <italic>K</italic>.</p>
        <p id="Par67">Because MC-MI-HOOI is a special case of <italic>higher orthogonal iteration of tensors</italic> (HOOI [<xref ref-type="bibr" rid="CR43">43</xref>]), which is an algorithm that is widely used to solve Tucker decomposition (<inline-formula id="IEq50"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {X} \approx G \times _{1} A_{1} \times _{2} A_{2} \times _{3} A_{3}$$\end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:mi mathvariant="script">X</mml:mi><mml:mo>≈</mml:mo><mml:mi>G</mml:mi><mml:msub><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mo>×</mml:mo><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq50.gif"/></alternatives></inline-formula>), we obtained <italic>U</italic> and <italic>W</italic> of MC-MI-HOOI via HOOI by setting the dimension of the depth factor matrix <inline-formula id="IEq51"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_{3}$$\end{document}</tex-math><mml:math id="M118"><mml:msub><mml:mi>A</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq51.gif"/></alternatives></inline-formula> to 1, assuming that the first and second factor matrices (<inline-formula id="IEq52"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_{1}$$\end{document}</tex-math><mml:math id="M120"><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq52.gif"/></alternatives></inline-formula> and <inline-formula id="IEq53"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_{2}$$\end{document}</tex-math><mml:math id="M122"><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq53.gif"/></alternatives></inline-formula>) are common. After HOOI converges, <italic>G</italic> is calculated as <inline-formula id="IEq54"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G = \mathcal {X} \times _{1} U^{T} \times _{2} U^{T} \times _{3} W^{T}$$\end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="script">X</mml:mi><mml:msub><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mo>×</mml:mo><mml:mn>3</mml:mn></mml:msub><mml:msup><mml:mi>W</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq54.gif"/></alternatives></inline-formula>.</p>
        <p id="Par68">After the optimization, <italic>U</italic> can be used for further analysis such as clustering or dimensional reduction by t-SNE and UMAP. To perform these analyzes, we first created the distance matrix of <italic>U</italic>. For clustering, we used Ward’s hierarchical clustering with <italic>K</italic> clusters, which is the same number of clusters we set when we created the membership matrices above.</p>
      </sec>
      <sec id="Sec17">
        <title>Silhouette coefficient</title>
        <p id="Par69">To estimate the number of clusters to be used by CSPA and WormTensor, we used the silhouette coefficient [<xref ref-type="bibr" rid="CR13">13</xref>]. To obtain the silhouette coefficient for a cell <italic>i</italic> belonging to a cluster <inline-formula id="IEq55"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{a}$$\end{document}</tex-math><mml:math id="M126"><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq55.gif"/></alternatives></inline-formula>, the average distance between cell <italic>i</italic> and the other cells in <inline-formula id="IEq56"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{a}$$\end{document}</tex-math><mml:math id="M128"><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq56.gif"/></alternatives></inline-formula>
<inline-formula id="IEq57"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a\left( i \right)$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:mi>a</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq57.gif"/></alternatives></inline-formula> is calculated as<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} a\left( i \right) = \frac{1}{|C_{a}|-1}\sum _{j \in C_{a}, i \ne j}{d\left( i,j\right) }, \end{aligned}$$\end{document}</tex-math><mml:math id="M132" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>a</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>d</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mfenced></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5230_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq58"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|C_{a}|$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq58.gif"/></alternatives></inline-formula> is the number of cluster members in <inline-formula id="IEq59"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{a}$$\end{document}</tex-math><mml:math id="M136"><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq59.gif"/></alternatives></inline-formula> and <inline-formula id="IEq60"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d\left( i,j\right)$$\end{document}</tex-math><mml:math id="M138"><mml:mrow><mml:mi>d</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq60.gif"/></alternatives></inline-formula> is the distance between cell <italic>i</italic> and cell <italic>j</italic>. Then, the minimum average distance between cell <italic>i</italic> and the other cells in <inline-formula id="IEq61"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{b} \left( C_{b} \ne C_{a}\right)$$\end{document}</tex-math><mml:math id="M140"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>C</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq61.gif"/></alternatives></inline-formula>
<inline-formula id="IEq62"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b\left( i \right)$$\end{document}</tex-math><mml:math id="M142"><mml:mrow><mml:mi>b</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq62.gif"/></alternatives></inline-formula> is calculated as follows:<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} b\left( i \right) = \min _{C_{b} \ne C_{a}}\frac{1}{|C_{b}|}\sum _{j \in C_{b}}{d\left( i,j\right) }. \end{aligned}$$\end{document}</tex-math><mml:math id="M144" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>b</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="true">min</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mi>d</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mfenced></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5230_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula>Finally, the silhouette coefficient for cell <italic>i</italic>
<inline-formula id="IEq63"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{s}\left( i \right)$$\end{document}</tex-math><mml:math id="M146"><mml:mrow><mml:mtext>s</mml:mtext><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq63.gif"/></alternatives></inline-formula> is obtained as follows:<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \textrm{s}\left( i \right) = \frac{b\left( i \right) - a\left( i \right) }{\max {\left\{ a\left( i \right) , b\left( i \right) \right\} }}. \end{aligned}$$\end{document}</tex-math><mml:math id="M148" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>s</mml:mtext><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>b</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:mi>a</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mo movablelimits="true">max</mml:mo><mml:mfenced close="}" open="{"><mml:mi>a</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5230_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula>The value spans <inline-formula id="IEq64"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-1$$\end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq64.gif"/></alternatives></inline-formula> to 1, and the closer the value is to 1, the more aggregated the cells are with those belonging to the same cluster as cell <italic>i</italic>. Conversely, a value close to <inline-formula id="IEq65"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-1$$\end{document}</tex-math><mml:math id="M152"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq65.gif"/></alternatives></inline-formula> means that there are cells belonging to other clusters in the neighborhood of cell <italic>i</italic>, which means that the clustering did not perform well.</p>
      </sec>
      <sec id="Sec18">
        <title>Consistency</title>
        <p id="Par70">To interpret the results of clustering by WormTensor and CSPA, we defined the consistency between the clusters of the merged animals (WormTensor or CSPA) and the clusters in each animal. We defined the consistency of cell <italic>i</italic> (<inline-formula id="IEq66"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{c}_{i}$$\end{document}</tex-math><mml:math id="M154"><mml:msub><mml:mtext>c</mml:mtext><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq66.gif"/></alternatives></inline-formula>) as<disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \textrm{c} \left( i \right) = {\left\{ \begin{array}{ll} {\sum }_{m=1}^{M}{\frac{|C_{\textrm{merged}} \cap C_{m}| - 1}{|C_{\textrm{merged}}| - 1}} &amp;{} (C_{\textrm{merged}} \ne C_{\textrm{m}})\\ 0 &amp;{} (C_{\textrm{merged}} = C_{\textrm{m}}), \end{array}\right. } \end{aligned}$$\end{document}</tex-math><mml:math id="M156" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>c</mml:mtext><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mtext>merged</mml:mtext></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mtext>merged</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mtext>merged</mml:mtext></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mtext>m</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mtext>merged</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mtext>m</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5230_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq67"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i \in C_{\textrm{merged}} \cap C_{m}$$\end{document}</tex-math><mml:math id="M158"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mtext>merged</mml:mtext></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq67.gif"/></alternatives></inline-formula>, <italic>M</italic> is the number of animals, <inline-formula id="IEq68"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{\textrm{merged}}$$\end{document}</tex-math><mml:math id="M160"><mml:msub><mml:mi>C</mml:mi><mml:mtext>merged</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq68.gif"/></alternatives></inline-formula> is the group of members of the cluster of the merged animals, and <inline-formula id="IEq69"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{\textrm{m}}$$\end{document}</tex-math><mml:math id="M162"><mml:msub><mml:mi>C</mml:mi><mml:mtext>m</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq69.gif"/></alternatives></inline-formula> is the group of members of the cluster of the <italic>m</italic>-th animal. The value of <inline-formula id="IEq70"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{c}_{i}$$\end{document}</tex-math><mml:math id="M164"><mml:msub><mml:mtext>c</mml:mtext><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq70.gif"/></alternatives></inline-formula> ranges from 0 to <italic>M</italic>.</p>
      </sec>
      <sec id="Sec19">
        <title>Adjusted rand index</title>
        <p id="Par71">To evaluate the similarity of the clustering results of WormTensor and the clustering results of individual animals, we utilized ARI [<xref ref-type="bibr" rid="CR17">17</xref>], which is an external validity index that is widely used to evaluate clustering results with known class labels.</p>
        <p id="Par72">Suppose that <italic>N</italic> cells are divided into <italic>K</italic> clusters by WormTensor such that <inline-formula id="IEq71"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C = \{C_{1}, C_{2},..., C_{K}\}$$\end{document}</tex-math><mml:math id="M166"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq71.gif"/></alternatives></inline-formula>. Likewise, suppose that <italic>N</italic> cells are divided into <inline-formula id="IEq72"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K'$$\end{document}</tex-math><mml:math id="M168"><mml:msup><mml:mi>K</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq72.gif"/></alternatives></inline-formula> clusters by Ward’s hierarchical clustering in an animal such that <inline-formula id="IEq73"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C' = \{C'_{1}, C'_{2},..., C'_{K'}\}$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:msup><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mn>1</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mn>2</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:msup><mml:mi>K</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>′</mml:mo></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq73.gif"/></alternatives></inline-formula>. From these two partitions, the Rand index (RI) is defined as a similarity measure between two partitions as<disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {{\textrm{RI}}} = \frac{ \left( a + d \right) }{ \left( a + b + c + d \right) }, \end{aligned}$$\end{document}</tex-math><mml:math id="M172" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>RI</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi></mml:mfenced><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi></mml:mfenced></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5230_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula>where <italic>a</italic> is the number of pairs within <italic>N</italic> cells that are in the same subset in <italic>C</italic> and in the same subset in <inline-formula id="IEq74"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C'$$\end{document}</tex-math><mml:math id="M174"><mml:msup><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq74.gif"/></alternatives></inline-formula>, <italic>b</italic> is the number of pairs within <italic>N</italic> cells that are in different subsets in <italic>C</italic> and in different subsets in <inline-formula id="IEq75"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C'$$\end{document}</tex-math><mml:math id="M176"><mml:msup><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq75.gif"/></alternatives></inline-formula>, <italic>c</italic> is the number of pairs within <italic>N</italic> cells that are in the same subset in <italic>C</italic> and in different subsets in <inline-formula id="IEq76"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C'$$\end{document}</tex-math><mml:math id="M178"><mml:msup><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq76.gif"/></alternatives></inline-formula>, and <italic>d</italic> is the number of pairs within <italic>N</italic> cells that are in different subsets in <italic>C</italic> and in the same subset in <inline-formula id="IEq77"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C'$$\end{document}</tex-math><mml:math id="M180"><mml:msup><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq77.gif"/></alternatives></inline-formula>.</p>
        <p id="Par73">ARI is an adjusted version of RI that corrects the bias towards RI increasing by chance.<disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\textrm{ARI}} = \frac{ {\textrm{RI}} - \textrm{E} \left( {\textrm{RI}} \right) }{ \max {\left( {\textrm{RI}}\right) } - \textrm{E} \left( {\textrm{RI}} \right) , } \end{aligned}$$\end{document}</tex-math><mml:math id="M182" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>ARI</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>RI</mml:mtext><mml:mo>-</mml:mo><mml:mtext>E</mml:mtext><mml:mfenced close=")" open="("><mml:mtext>RI</mml:mtext></mml:mfenced></mml:mrow><mml:mrow><mml:mo movablelimits="true">max</mml:mo><mml:mfenced close=")" open="("><mml:mtext>RI</mml:mtext></mml:mfenced><mml:mo>-</mml:mo><mml:mtext>E</mml:mtext><mml:mfenced close=")" open="("><mml:mtext>RI</mml:mtext></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5230_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq78"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{E} \left( {\textrm{RI}} \right)$$\end{document}</tex-math><mml:math id="M184"><mml:mrow><mml:mtext>E</mml:mtext><mml:mfenced close=")" open="("><mml:mtext>RI</mml:mtext></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq78.gif"/></alternatives></inline-formula> is the expected value of RI based on some probability distribution. In this work, we used the permutation model based on the generalized hypergeometric distribution [<xref ref-type="bibr" rid="CR17">17</xref>], which is the most widely used model for ARI. RI and ARI range from 0 to 1, with higher values indicating a better match between the WormTensor clustering results and the clustering results in each animal.</p>
      </sec>
    </sec>
    <sec id="Sec20">
      <title>Implementation</title>
      <p id="Par74">The WormTensor package is implemented in R and is made available through CRAN (<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org">https://cran.r-project.org</ext-link>) under the MIT license. WormTensor consists of seven R functions described below. <disp-quote><p id="Par75"><list list-type="bullet"><list-item><p id="Par76">worm_download() downloads the distance matrices used in this work from figshare; 28 animals’ data, including those of 24 used in this study and 4 noisy ones, are available (Table <xref rid="Tab2" ref-type="table">2</xref>).</p></list-item><list-item><p id="Par77">worm_distance() generates the distance matrices between cells for multiple animals from input time-series data matrices (cells <inline-formula id="IEq79"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M186"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq79.gif"/></alternatives></inline-formula> time) specified by users; mSBD, SBD, or Euclidean distance can be specified as the distance measure (default, mSBD).</p></list-item><list-item><p id="Par78">as_worm_tensor() instantiates a WormTensor object from the distance matrices, which are used in the following functions.</p></list-item><list-item><p id="Par79">worm_membership() creates a membership tensor from the results of clustering performed using the distance matrix of each animal.</p></list-item><list-item><p id="Par80">worm_clustering() performs clustering using the distance matrices above. MC-MI-HOOI and CSPA can be specified as the clustering algorithm (default, MC-MI-HOOI).</p></list-item><list-item><p id="Par81">worm_evaluate() evaluates the results of worm_clustering(). As internal validity indices [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>] without prior knowledge of the clusters, entropy, pseudo-F measure, and connectivity computations are implemented. As external validity indices [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>] using prior knowledge of the clusters, ARI, purity, and micro-averaged F-measure computations are implemented. The latter indices are optional, and only if the class label is specified, these indices are calculated.</p></list-item><list-item><p id="Par82">worm_visualize() visualizes the results of worm_clustering(). In addition, the number of identified cells and consistency are visualized as QC metrics. Only if some labels to interpret the clusters are specified (e.g., neuron type or neuron class), such labels are also visualized. Only if the algorithm of worm_clustering() is specified as MC-MI-HOOI, the relationship of the weights and the number of identified cells and ARI between the clustering result of each animal and the result of MC-MI-HOOI are visualized.</p></list-item></list></p></disp-quote></p>
      <p id="Par83">Inspired by the Tidyverse [<xref ref-type="bibr" rid="CR44">44</xref>], WormTensor also uses R’s native pipe operator to allow multiple R functions to be chained together and executed as one-liner code (Fig. <xref rid="Fig7" ref-type="fig">7</xref>).</p>
    </sec>
  </sec>
  <sec id="Sec21">
    <title>Availability and requirements</title>
    <sec id="Sec22">
      <title>R/CRAN package</title>
      <p id="Par84">
        <list list-type="bullet">
          <list-item>
            <p id="Par85">WormTensor: <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/WormTensor">https://cran.r-project.org/web/packages/WormTensor</ext-link></p>
          </list-item>
          <list-item>
            <p id="Par86">Operating system: Linux, Mac OS X, Windows</p>
          </list-item>
          <list-item>
            <p id="Par87">Programming language: R (v<inline-formula id="IEq80"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-$$\end{document}</tex-math><mml:math id="M188"><mml:mo>-</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq80.gif"/></alternatives></inline-formula>4.1.0 or higher)</p>
          </list-item>
          <list-item>
            <p id="Par88">License: MIT</p>
          </list-item>
          <list-item>
            <p id="Par89">Any restrictions to use by non-academics: For non-profit use only</p>
          </list-item>
        </list>
      </p>
    </sec>
    <sec id="Sec23">
      <title>Docker container of WormTensor</title>
      <p id="Par90">
        <list list-type="bullet">
          <list-item>
            <p id="Par91">WormTensor: <ext-link ext-link-type="uri" xlink:href="https://hub.docker.com/r/yamaken37/wormtensor">https://hub.docker.com/r/yamaken37/wormtensor</ext-link></p>
          </list-item>
        </list>
      </p>
    </sec>
    <sec id="Sec24">
      <title>Snakemake workflow</title>
      <p id="Par92">
        <list list-type="bullet">
          <list-item>
            <p id="Par93">WormTimeSeries (to fully reproduce the analyses in this study): <ext-link ext-link-type="uri" xlink:href="https://github.com/rikenbit/WormTimeSeries">https://github.com/rikenbit/WormTimeSeries</ext-link></p>
          </list-item>
          <list-item>
            <p id="Par94">Operating system: Linux, Mac OS X, Windows</p>
          </list-item>
          <list-item>
            <p id="Par95">Programming language: Python (v<inline-formula id="IEq81"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-$$\end{document}</tex-math><mml:math id="M190"><mml:mo>-</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq81.gif"/></alternatives></inline-formula>3.7.8 or higher), Snakemake (v<inline-formula id="IEq82"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-$$\end{document}</tex-math><mml:math id="M192"><mml:mo>-</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq82.gif"/></alternatives></inline-formula>6.0.5 or higher), Singularity (v<inline-formula id="IEq83"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-$$\end{document}</tex-math><mml:math id="M194"><mml:mo>-</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5230_Article_IEq83.gif"/></alternatives></inline-formula>3.8.0 or higher)</p>
          </list-item>
          <list-item>
            <p id="Par96">License: MIT</p>
          </list-item>
          <list-item>
            <p id="Par97">Any restrictions to use by non-academics: For non-profit use only</p>
          </list-item>
        </list>
      </p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec25">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5230_MOESM1_ESM.xlsx">
            <caption>
              <p><bold>Additional file 1.</bold> Cellular labels for interpreting the clustering results.CSV 10.73 KB, https://figshare.com/ndownloader/files/38554109.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2023_5230_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file 2.</bold> Cellular labels for interpreting the clustering results).XLSX 233.53 KB, https://figshare.com/ndownloader/files/38554106.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2023_5230_MOESM3_ESM.png">
            <caption>
              <p><bold>Additional file 3.</bold> WormTensor, the results of clusters + consistency + No. of cells.PNG 1.22 MB, https://figshare.com/ndownloader/files/36186645.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="12859_2023_5230_MOESM4_ESM.png">
            <caption>
              <p><bold>Additional file 4.</bold> WormTensor, neuron type + consistency + No. of cells.PNG 1.18 MB, https://figshare.com/ndownloader/files/36186651.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="12859_2023_5230_MOESM5_ESM.png">
            <caption>
              <p><bold>Additional file 5.</bold> WormTensor, class label + consistency + No. of cells.PNG 1.11 MB, https://figshare.com/ndownloader/files/36186669.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="12859_2023_5230_MOESM6_ESM.png">
            <caption>
              <p><bold>Additional file 6.</bold> MC-MI-HOOI with Euclidean distance, <italic>k</italic> = 10, the results of clusters + consistency + No. of cells.PNG 2.33 MB, https://figshare.com/ndownloader/files/36186681.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="12859_2023_5230_MOESM7_ESM.png">
            <caption>
              <p><bold>Additional file 7.</bold> MC-MI-HOOI with Euclidean distance, <italic>k</italic> = 10, neuron type + consistency + No. of cells.PNG 2.08 MB, https://figshare.com/ndownloader/files/36186693.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM8">
          <media xlink:href="12859_2023_5230_MOESM8_ESM.png">
            <caption>
              <p><bold>Additional file 8.</bold> MC-MI-HOOI with Euclidean distance, <italic>k</italic> = 10, class label + consistency + No. of cells.PNG 1.93 MB, https://figshare.com/ndownloader/files/36186714.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM9">
          <media xlink:href="12859_2023_5230_MOESM9_ESM.png">
            <caption>
              <p><bold>Additional file 9.</bold> Results of clustering with the optimal number of clusters. <bold>a</bold> The clustering results of CSPA with Euclidean distance. <bold>b</bold> The clustering results of MC-MI-HOOI with Euclidean distance. <bold>c</bold> The clustering results of CSPA with mSBD. <bold>d</bold> The clustering results of MC-MI-HOOI with mSBD.PNG 847.16 KB, https://figshare.com/ndownloader/files/36189936.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM10">
          <media xlink:href="12859_2023_5230_MOESM10_ESM.png">
            <caption>
              <p><bold>Additional file 10.</bold> Results of WormTensor. <bold>a</bold> Neuron type. <bold>b</bold> The labels of the movement of <italic>C. elegans</italic>. <bold>c</bold> Consistency between the results of hierarchical clustering in each animal and WormTensor. <bold>d</bold> The number of identified cells.PNG 869.43 KB, https://figshare.com/ndownloader/files/36189957.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM11">
          <media xlink:href="12859_2023_5230_MOESM11_ESM.xlsx">
            <caption>
              <p><bold>Additional file 11.</bold> Hypergeometric test p-values and FDR <italic>q</italic>-values of all the clustering methods with the optimal numbers of clusters.XLSX 19.08 KB, https://figshare.com/ndownloader/files/38554103.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM12">
          <media xlink:href="12859_2023_5230_MOESM12_ESM.png">
            <caption>
              <p><bold>Additional file 12.</bold><bold>a</bold> The order of WormTensor weights of the animals when animal 20 was added. <bold>b</bold> The order of WormTensor weights of the animals when four noisy datasets were added. <bold>c</bold> The abnormal waveforms of animal 20.PNG 416.57 KB, https://figshare.com/ndownloader/files/36619650.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM13">
          <media xlink:href="12859_2023_5230_MOESM13_ESM.pdf">
            <caption>
              <p><bold>Additional file 13.</bold> Relationship between the shift value and the maximum absolute correlation coefficient in mSBD.PDF 648.84 KB, https://figshare.com/ndownloader/files/38554100.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM14">
          <media xlink:href="12859_2023_5230_MOESM14_ESM.pdf">
            <caption>
              <p><bold>Additional file 14.</bold> Differences in the properties of PC1_pos- and PC1_neg-related cells.PDF 2.38 MB, https://figshare.com/ndownloader/files/38554097.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM15">
          <media xlink:href="12859_2023_5230_MOESM15_ESM.pdf">
            <caption>
              <p><bold>Additional file 15.</bold> Results for clustering evaluation measures other than silhouette coefficient.PDF 1.68 MB, https://figshare.com/ndownloader/files/38943455.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>
          <italic>C. elegans</italic>
        </term>
        <def>
          <p id="Par4">
            <inline-formula id="IEq2">
              <alternatives>
                <tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Caenorhabditis\ elegans$$\end{document}</tex-math>
                <mml:math id="M196">
                  <mml:mrow>
                    <mml:mi>C</mml:mi>
                    <mml:mi>a</mml:mi>
                    <mml:mi>e</mml:mi>
                    <mml:mi>n</mml:mi>
                    <mml:mi>o</mml:mi>
                    <mml:mi>r</mml:mi>
                    <mml:mi>h</mml:mi>
                    <mml:mi>a</mml:mi>
                    <mml:mi>b</mml:mi>
                    <mml:mi>d</mml:mi>
                    <mml:mi>i</mml:mi>
                    <mml:mi>t</mml:mi>
                    <mml:mi>i</mml:mi>
                    <mml:mi>s</mml:mi>
                    <mml:mspace width="4pt"/>
                    <mml:mi>e</mml:mi>
                    <mml:mi>l</mml:mi>
                    <mml:mi>e</mml:mi>
                    <mml:mi>g</mml:mi>
                    <mml:mi>a</mml:mi>
                    <mml:mi>n</mml:mi>
                    <mml:mi>s</mml:mi>
                  </mml:mrow>
                </mml:math>
                <inline-graphic xlink:href="12859_2023_5230_Article_IEq2.gif"/>
              </alternatives>
            </inline-formula>
          </p>
        </def>
      </def-item>
      <def-item>
        <term>SBD</term>
        <def>
          <p id="Par5">Shape-based distance</p>
        </def>
      </def-item>
      <def-item>
        <term>mSBD</term>
        <def>
          <p id="Par6">Modified shape-based distance</p>
        </def>
      </def-item>
      <def-item>
        <term>HOOI</term>
        <def>
          <p id="Par7">Higher orthogonal iteration of tensors</p>
        </def>
      </def-item>
      <def-item>
        <term>MC-MI-HOOI</term>
        <def>
          <p id="Par8">Multi-view clustering based on matrix integration using the HOOI algorithm</p>
        </def>
      </def-item>
      <def-item>
        <term>CSPA</term>
        <def>
          <p id="Par9">Cluster-based similarity partitioning algorithm</p>
        </def>
      </def-item>
      <def-item>
        <term>NaCl</term>
        <def>
          <p id="Par10">Sodium chloride</p>
        </def>
      </def-item>
      <def-item>
        <term>t-SNE</term>
        <def>
          <p id="Par11">T-distributed stochastic neighbor embedding</p>
        </def>
      </def-item>
      <def-item>
        <term>UMAP</term>
        <def>
          <p id="Par12">Uniform manifold approximation and projection</p>
        </def>
      </def-item>
      <def-item>
        <term>QC</term>
        <def>
          <p id="Par13">Quality control</p>
        </def>
      </def-item>
      <def-item>
        <term>TCA</term>
        <def>
          <p id="Par14">Tensor components analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>EEG</term>
        <def>
          <p id="Par15">Electro-encephalography</p>
        </def>
      </def-item>
      <def-item>
        <term>YFP</term>
        <def>
          <p id="Par16">Yellow fluorescent protein</p>
        </def>
      </def-item>
      <def-item>
        <term>CFP</term>
        <def>
          <p id="Par17">Cyan fluorescent protein</p>
        </def>
      </def-item>
      <def-item>
        <term>FRET</term>
        <def>
          <p id="Par18">Fluorescence resonance energy transfer</p>
        </def>
      </def-item>
      <def-item>
        <term>RI</term>
        <def>
          <p id="Par19">Rand index</p>
        </def>
      </def-item>
      <def-item>
        <term>ARI</term>
        <def>
          <p id="Par20">Adjusted rand index</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Mr. Akihiro Matsushima for assistance with the IT infrastructure for the data analysis. We are also grateful to all members of the Laboratory for Bioinformatics Research and RIKEN Center for Biosystems Dynamics Research for their helpful advice.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>KT and YT designed the study. KT designed and implemented the proposed algorithm. YT, HS, MK, TT, TI, and YI measured the neuronal activity data. KY performed all analyses and implemented the WormTensor package. All authors have read and approved the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by JST PRESTO Grant No. JPMJPR1945, the special postdoctoral researcher (SPDR) program at RIKEN, and JSPS KAKENHI Grant No. 19K20406.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All distance matrices analyzed during this study are included in this published article. The datasets of raw time series of neural activity will be available from a DOI (10.6084/m9.figshare.21968078) reserved for publication by Figshare.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par98">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par99">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par100">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bullmore</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sporns</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Complex brain networks: graph theoretical analysis of structural and functional systems</article-title>
        <source>Nat Rev Neurosci</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>3</issue>
        <fpage>186</fpage>
        <lpage>198</lpage>
        <pub-id pub-id-type="doi">10.1038/nrn2575</pub-id>
        <?supplied-pmid 19190637?>
        <pub-id pub-id-type="pmid">19190637</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sporns</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Betzel</surname>
            <given-names>RF</given-names>
          </name>
        </person-group>
        <article-title>Modular brain networks</article-title>
        <source>Annu Rev Psychol</source>
        <year>2016</year>
        <volume>67</volume>
        <fpage>613</fpage>
        <lpage>640</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-psych-122414-033634</pub-id>
        <?supplied-pmid 26393868?>
        <pub-id pub-id-type="pmid">26393868</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>White</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Southgate</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Thomson</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Brenner</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>The structure of the nervous system of the nematode <italic>Caenorhabditis elegans</italic></article-title>
        <source>Philos Trans R Soc B</source>
        <year>1986</year>
        <volume>314</volume>
        <issue>1165</issue>
        <fpage>1</fpage>
        <lpage>340</lpage>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kerr</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lev-Ram</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Baird</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Vincent</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tsien</surname>
            <given-names>RY</given-names>
          </name>
          <name>
            <surname>Schafer</surname>
            <given-names>WR</given-names>
          </name>
        </person-group>
        <article-title>Optical imaging of calcium transients in neurons and pharyngeal muscle of <italic>C. elegans</italic></article-title>
        <source>Neuron</source>
        <year>2000</year>
        <volume>26</volume>
        <issue>3</issue>
        <fpage>583</fpage>
        <lpage>594</lpage>
        <pub-id pub-id-type="doi">10.1016/S0896-6273(00)81196-4</pub-id>
        <?supplied-pmid 10896155?>
        <pub-id pub-id-type="pmid">10896155</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Toyoshima</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kanamori</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sato</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Jang</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Oe</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Murakami</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Teramoto</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Iwasaki</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ishihara</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yoshida</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Iino</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Neuron id dataset facilitates neuronal annotation for whole-brain activity imaging of <italic>C. elegans</italic></article-title>
        <source>BMC Biol</source>
        <year>2020</year>
        <volume>18</volume>
        <issue>30</issue>
        <fpage>1</fpage>
        <pub-id pub-id-type="pmid">31898513</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Toyoshima Y, Sato H, Nagata D, Kanamori M, Jang MS, Kuze K, Oe S, Teramoto T, Iwasaki Y, Yoshida R, Ishihara T, Iino Y. Deducing ensemble dynamics and information flow from the whole-brain imaging data. bioRxiv 2022</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yemini</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nejatbakhsh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Varol</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Mena</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Samuel</surname>
            <given-names>ADT</given-names>
          </name>
          <name>
            <surname>Paninski</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Venkatachalam</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Hobert</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Neuropal: a multicolor atlas for whole-brain neuronal identification in <italic>C. elegans</italic></article-title>
        <source>Cell</source>
        <year>2021</year>
        <volume>184</volume>
        <issue>1</issue>
        <fpage>272</fpage>
        <lpage>288</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2020.12.012</pub-id>
        <?supplied-pmid 33378642?>
        <pub-id pub-id-type="pmid">33378642</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kato</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kaplan</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Schrödel</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Skora</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lindsay</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Yemini</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lockery</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zimmer</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Global brain dynamics embed the motor command sequence of <italic>Caenorhabditis elegans</italic></article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>163</volume>
        <issue>3</issue>
        <fpage>656</fpage>
        <lpage>669</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.09.034</pub-id>
        <?supplied-pmid 26478179?>
        <pub-id pub-id-type="pmid">26478179</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Shipley</surname>
            <given-names>FB</given-names>
          </name>
          <name>
            <surname>Linder</surname>
            <given-names>AN</given-names>
          </name>
          <name>
            <surname>Plummer</surname>
            <given-names>GS</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Setru</surname>
            <given-names>SU</given-names>
          </name>
          <name>
            <surname>Shaevitz</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Leifer</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Whole-brain calcium imaging with cellular resolution in freely behaving <italic>Caenorhabditis elegans</italic></article-title>
        <source>PNAS</source>
        <year>2015</year>
        <volume>113</volume>
        <issue>8</issue>
        <fpage>1074</fpage>
        <lpage>1081</lpage>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Venkatachalam</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Mitchell</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tabone</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Florman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Greenwood</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chisholm</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Srinivasan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Alkema</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Samuel</surname>
            <given-names>AD</given-names>
          </name>
        </person-group>
        <article-title>Pan-neuronal imaging in roaming <italic>Caenorhabditis elegans</italic></article-title>
        <source>PNAS</source>
        <year>2016</year>
        <volume>113</volume>
        <issue>8</issue>
        <fpage>1082</fpage>
        <lpage>1088</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1507109113</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alexander</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Joydeep</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Cluster ensembles–a knowledge reuse framework for combining multiple partitions</article-title>
        <source>J Mach Learn Res</source>
        <year>2003</year>
        <volume>3</volume>
        <issue>35</issue>
        <fpage>583</fpage>
        <lpage>617</lpage>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>VY</given-names>
          </name>
          <name>
            <surname>Kirschner</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Schaub</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yiu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chandra</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Natarajan</surname>
            <given-names>KN</given-names>
          </name>
          <name>
            <surname>Reik</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Barahona</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Sc3: consensus clustering of single-cell RNA-seq data</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>5</issue>
        <fpage>483</fpage>
        <lpage>486</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4236</pub-id>
        <?supplied-pmid 28346451?>
        <pub-id pub-id-type="pmid">28346451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rousseeuw</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Silhouettes: a graphical aid to the interpretation and validation of cluster analysis</article-title>
        <source>J Comput Appl Math</source>
        <year>1987</year>
        <volume>20</volume>
        <fpage>53</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1016/0377-0427(87)90125-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>J Roy Stat Soc B</source>
        <year>1995</year>
        <volume>57</volume>
        <issue>1</issue>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gordus</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pokala</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Levy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Flavell</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Bargmann</surname>
            <given-names>CI</given-names>
          </name>
        </person-group>
        <article-title>Feedback from network states generates variability in a probabilistic olfactory circuit</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <issue>2</issue>
        <fpage>215</fpage>
        <lpage>227</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.02.018</pub-id>
        <?supplied-pmid 25772698?>
        <pub-id pub-id-type="pmid">25772698</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kawano</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Po</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Ryu</surname>
            <given-names>WS</given-names>
          </name>
          <name>
            <surname>Zhen</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>An imbalancing act: gap junctions reduce the backward motor circuit activity to bias <italic>C. elegans</italic> for forward locomotion</article-title>
        <source>Neuron</source>
        <year>2011</year>
        <volume>72</volume>
        <issue>4</issue>
        <fpage>572</fpage>
        <lpage>586</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuron.2011.09.005</pub-id>
        <?supplied-pmid 22099460?>
        <pub-id pub-id-type="pmid">22099460</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huber</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Arabie</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Comparing partitions</article-title>
        <source>J Classif</source>
        <year>1985</year>
        <volume>2</volume>
        <fpage>193</fpage>
        <lpage>218</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01908075</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Palacio-Niño J-O, Berzal F. Evaluation metrics for unsupervised learning algorithms. arXiv 2019</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Tomašev</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Radovanović</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <source>Clustering evaluation in high-dimensional data</source>
        <year>2016</year>
        <publisher-loc>New York City, US</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sulston</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Horvitz</surname>
            <given-names>HR</given-names>
          </name>
        </person-group>
        <article-title>Post-embryonic cell lineages of the nematode, <italic>Caenorhabditis elegans</italic></article-title>
        <source>Dev Biol</source>
        <year>1977</year>
        <volume>56</volume>
        <issue>1</issue>
        <fpage>110</fpage>
        <lpage>156</lpage>
        <pub-id pub-id-type="doi">10.1016/0012-1606(77)90158-0</pub-id>
        <?supplied-pmid 838129?>
        <pub-id pub-id-type="pmid">838129</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sulston</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Schierenberg</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Thomson</surname>
            <given-names>JN</given-names>
          </name>
        </person-group>
        <article-title>The embryonic cell lineage of the nematode <italic>Caenorhabditis elegans</italic></article-title>
        <source>Dev Biol</source>
        <year>1983</year>
        <volume>100</volume>
        <issue>1</issue>
        <fpage>64</fpage>
        <lpage>119</lpage>
        <pub-id pub-id-type="doi">10.1016/0012-1606(83)90201-4</pub-id>
        <?supplied-pmid 6684600?>
        <pub-id pub-id-type="pmid">6684600</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Glänzel</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Moor</surname>
            <given-names>BD</given-names>
          </name>
        </person-group>
        <article-title>Multiview partitioning via tensor methods</article-title>
        <source>IEEE Trans Knowl Data Eng</source>
        <year>2013</year>
        <volume>25</volume>
        <issue>5</issue>
        <fpage>1056</fpage>
        <lpage>1069</lpage>
        <pub-id pub-id-type="doi">10.1109/TKDE.2012.95</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Badea L. Extracting gene expression profiles common to colon and pancreatic adenocarcinoma using simultaneous nonnegative matrix factorization. In: Pacific symposium on biocomputing; 2008. p. 279–290</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sankaran</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>SP</given-names>
          </name>
        </person-group>
        <article-title>Multitable methods for microbiome data integration</article-title>
        <source>Front Genet</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>627</issue>
        <fpage>1</fpage>
        <pub-id pub-id-type="pmid">30804975</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Torshizi</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Duan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>A computational method for direct imputation of cell type-specific expression profiles and cellular compositions from bulk-tissue rna-seq in brain disorders</article-title>
        <source>NAR Genom Bioinform</source>
        <year>2021</year>
        <volume>3</volume>
        <issue>2</issue>
        <fpage>056</fpage>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dong</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Thennavan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Urrutia</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Perou</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Zou</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Scdc: bulk gene expression deconvolution by multiple single-cell rna sequencing references</article-title>
        <source>Brief Bioinform</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>416</fpage>
        <lpage>427</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbz166</pub-id>
        <?supplied-pmid 31925417?>
        <pub-id pub-id-type="pmid">31925417</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zitnik</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zupan</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Jumping across biomedical contexts using compressive data fusion</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>12</issue>
        <fpage>90</fpage>
        <lpage>100</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw247</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sorber</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Barel</surname>
            <given-names>MV</given-names>
          </name>
          <name>
            <surname>Lathauwer</surname>
            <given-names>LD</given-names>
          </name>
        </person-group>
        <article-title>Structured data fusion</article-title>
        <source>IEEE J Select Topics Signal Process</source>
        <year>2015</year>
        <volume>9</volume>
        <issue>4</issue>
        <fpage>586</fpage>
        <lpage>600</lpage>
        <pub-id pub-id-type="doi">10.1109/JSTSP.2015.2400415</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Kim H, Choo J, Kim J, Reddy CK, Park H. Simultaneous discovery of common and discriminative topics via joint nonnegative matrix factorization. In: Proceedings of the 21th ACM SIGKDD international conference on knowledge discovery and data mining; 2015. p. 567–576</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Samat</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Persello</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gamba</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Abuduwaili</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Supervised and semi-supervised multi-view canonical correlation analysis ensemble for heterogeneous domain adaptation in remote sensing image classification</article-title>
        <source>Remote Sens</source>
        <year>2017</year>
        <volume>9</volume>
        <issue>4</issue>
        <fpage>337</fpage>
        <pub-id pub-id-type="doi">10.3390/rs9040337</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Linderman S, Nichols A, Blei D, Zimmer M, Paninski L. Hierarchical recurrent state space models reveal discrete and continuous dynamics of neural activity in <italic>C. elegans</italic>. bioRxiv 2019.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hallinen</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Dempsey</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Scholz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Linder</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Randi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Sharma</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Shaevitz</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Leifer</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Decoding locomotion from population neural activity in moving <italic>C. elegans</italic></article-title>
        <source>Elife</source>
        <year>2021</year>
        <volume>10</volume>
        <fpage>66135</fpage>
        <pub-id pub-id-type="doi">10.7554/eLife.66135</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Randi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Leifer</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Bialek</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Searching for collective behavior in a small brain</article-title>
        <source>Phys Rev E</source>
        <year>2019</year>
        <volume>99</volume>
        <fpage>052418</fpage>
        <pub-id pub-id-type="doi">10.1103/PhysRevE.99.052418</pub-id>
        <?supplied-pmid 31212571?>
        <pub-id pub-id-type="pmid">31212571</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Williams</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Vyas</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ryu</surname>
            <given-names>SI</given-names>
          </name>
          <name>
            <surname>Shenoy</surname>
            <given-names>KV</given-names>
          </name>
          <name>
            <surname>Schnitzer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kolda</surname>
            <given-names>TG</given-names>
          </name>
          <name>
            <surname>Ganguli</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Unsupervised discovery of demixed, low-dimensional neural dynamics across multiple timescales through tensor component analysis</article-title>
        <source>Neuron</source>
        <year>2018</year>
        <volume>98</volume>
        <issue>6</issue>
        <fpage>1099</fpage>
        <lpage>1115</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuron.2018.05.015</pub-id>
        <?supplied-pmid 29887338?>
        <pub-id pub-id-type="pmid">29887338</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mørup</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hansen</surname>
            <given-names>LK</given-names>
          </name>
          <name>
            <surname>Arnfred</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Lim</surname>
            <given-names>LH</given-names>
          </name>
          <name>
            <surname>Madsen</surname>
            <given-names>KH</given-names>
          </name>
        </person-group>
        <article-title>Shift-invariant multilinear decomposition of neuroimaging data</article-title>
        <source>Neuroimage</source>
        <year>2008</year>
        <volume>42</volume>
        <issue>4</issue>
        <fpage>1439</fpage>
        <lpage>1450</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2008.05.062</pub-id>
        <?supplied-pmid 18625324?>
        <pub-id pub-id-type="pmid">18625324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nagai</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yamada</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tominaga</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ichikawa</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Miyawaki</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Expanded dynamic range of fluorescent indicators for ca2+ by circularly permuted yellow fluorescent proteins</article-title>
        <source>PNAS</source>
        <year>2004</year>
        <volume>101</volume>
        <issue>29</issue>
        <fpage>10554</fpage>
        <lpage>10559</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0400417101</pub-id>
        <?supplied-pmid 15247428?>
        <pub-id pub-id-type="pmid">15247428</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Pratt</surname>
            <given-names>WK</given-names>
          </name>
        </person-group>
        <source>Digital image processing</source>
        <year>2007</year>
        <edition>4</edition>
        <publisher-loc>New Jersey, US</publisher-loc>
        <publisher-name>Wiley-Interscience</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Orfanidis</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <source>Introduction to signal processing (prentice hall signal processing series)</source>
        <year>1995</year>
        <publisher-loc>New Jersey, US</publisher-loc>
        <publisher-name>Prentice Hall</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schafer</surname>
            <given-names>RW</given-names>
          </name>
        </person-group>
        <article-title>What is a Savitzky-Golay filter? [lecture notes]</article-title>
        <source>IEEE Signal Process Mag</source>
        <year>2011</year>
        <volume>28</volume>
        <issue>4</issue>
        <fpage>111</fpage>
        <lpage>117</lpage>
        <pub-id pub-id-type="doi">10.1109/MSP.2011.941097</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paparrizos</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gravano</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>K-shape: efficient and accurate clustering of time series</article-title>
        <source>SIGMOD’15</source>
        <year>2016</year>
        <volume>45</volume>
        <issue>1</issue>
        <fpage>69</fpage>
        <lpage>76</lpage>
        <pub-id pub-id-type="doi">10.1145/2949741.2949758</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tawano</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Po</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Ryu</surname>
            <given-names>WS</given-names>
          </name>
          <name>
            <surname>Zhen</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>An imbalancing act: gap junctions reduce the backward motor circuit activity to bias <italic>C. elegans</italic> for forward locomotion</article-title>
        <source>Neuron</source>
        <year>2011</year>
        <volume>72</volume>
        <issue>4</issue>
        <fpage>572</fpage>
        <lpage>586</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuron.2011.09.005</pub-id>
        <pub-id pub-id-type="pmid">22099460</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ward</surname>
            <given-names>JHJ</given-names>
          </name>
        </person-group>
        <article-title>Hierarchical grouping to optimize an objective function</article-title>
        <source>J Am Stat Assoc</source>
        <year>1963</year>
        <volume>58</volume>
        <fpage>236</fpage>
        <lpage>244</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1963.10500845</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Cichocki</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zdunek</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Phan</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Amari</surname>
            <given-names>S-I</given-names>
          </name>
        </person-group>
        <source>Nonnegative matrix and tensor factorizations: applications to exploratory multi-way data analysis and blind source separation</source>
        <year>2009</year>
        <publisher-loc>New Jersey, US</publisher-loc>
        <publisher-name>Wiley Online Library</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wickham</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Averick</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bryan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>McGowan</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>François</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Grolemund</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Henry</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hester</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kuhn</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pedersen</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Bache</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ooms</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Seidel</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Spinu</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Takahashi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Vaughan</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wilke</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Woo</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Yutani</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Welcome to the tidyverse</article-title>
        <source>J Open Source Softw</source>
        <year>2019</year>
        <volume>4</volume>
        <issue>43</issue>
        <fpage>1686</fpage>
        <pub-id pub-id-type="doi">10.21105/joss.01686</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
