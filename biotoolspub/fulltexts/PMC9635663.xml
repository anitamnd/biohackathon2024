<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">G3 (Bethesda)</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genetics</journal-id>
    <journal-id journal-id-type="publisher-id">g3journal</journal-id>
    <journal-title-group>
      <journal-title>G3: Genes|Genomes|Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2160-1836</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9635663</article-id>
    <article-id pub-id-type="pmid">36161315</article-id>
    <article-id pub-id-type="doi">10.1093/g3journal/jkac233</article-id>
    <article-id pub-id-type="publisher-id">jkac233</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software and Data Resources</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01180</subject>
        <subject>AcademicSubjects/SCI01140</subject>
        <subject>AcademicSubjects/SCI00010</subject>
        <subject>AcademicSubjects/SCI00960</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PhaMMseqs: a new pipeline for constructing phage gene phamilies using MMseqs2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4407-0994</contrib-id>
        <name>
          <surname>Gauthier</surname>
          <given-names>Christian H</given-names>
        </name>
        <aff><institution>Department of Biological Sciences, University of Pittsburgh</institution>, Pittsburgh, PA 15260, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2162-562X</contrib-id>
        <name>
          <surname>Cresawn</surname>
          <given-names>Steven G</given-names>
        </name>
        <aff><institution>Department of Biology, James Madison University</institution>, Harrisonburg, VA 22807, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6705-6821</contrib-id>
        <name>
          <surname>Hatfull</surname>
          <given-names>Graham F</given-names>
        </name>
        <aff><institution>Department of Biological Sciences, University of Pittsburgh</institution>, Pittsburgh, PA 15260, <country country="US">USA</country></aff>
        <xref rid="jkac233-cor1" ref-type="corresp"/>
        <!--gfh@pitt.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Andrews</surname>
          <given-names>B</given-names>
        </name>
        <role>Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="jkac233-cor1">Corresponding author: Department of Biological Sciences, University of Pittsburgh, Pittsburgh, PA 15260, USA. Email: <email>gfh@pitt.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-09-26">
      <day>26</day>
      <month>9</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>26</day>
      <month>9</month>
      <year>2022</year>
    </pub-date>
    <volume>12</volume>
    <issue>11</issue>
    <elocation-id>jkac233</elocation-id>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>7</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>28</day>
        <month>9</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press on behalf of Genetics Society of America.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="jkac233.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>The diversity and mosaic architecture of phage genomes present challenges for whole-genome phylogenies and comparative genomics. There are no universally conserved core genes, ∼70% of phage genes are of unknown function, and phage genomes are replete with small (&lt;500 bp) open reading frames. Assembling sequence-related genes into “phamilies” (“phams”) based on amino acid sequence similarity simplifies comparative phage genomics and facilitates representations of phage genome mosaicism. With the rapid and substantial increase in the numbers of sequenced phage genomes, computationally efficient pham assembly is needed, together with strategies for including newly sequenced phage genomes. Here, we describe the Python package PhaMMseqs, which uses MMseqs2 for pham assembly, and we evaluate the key parameters for optimal pham assembly of sequence- and functionally related proteins. PhaMMseqs runs efficiently with only modest hardware requirements and integrates with the pdm_utils package for simple genome entry and export of datasets for evolutionary analyses and phage genome map construction.</p>
    </abstract>
    <kwd-group>
      <kwd>phage genomics</kwd>
      <kwd>bacteriophages</kwd>
      <kwd>comparative genomics</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>GM131729</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Howard Hughes Medical Institute</institution>
            <institution-id institution-id-type="DOI">10.13039/100000011</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>GT12053</award-id>
        <award-id>GT12054</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Bacteriophages (phages) are an enormous, genetically diverse population whose evolution likely spans billions of years (<xref rid="jkac233-B10" ref-type="bibr">Hendrix <italic toggle="yes">et al.</italic> 1999</xref>; <xref rid="jkac233-B9" ref-type="bibr">Hendrix 2002</xref>). A hallmark genomic feature is their pervasive mosaicism with related genes situated in different genomic contexts in otherwise unrelated phages (<xref rid="jkac233-B25" ref-type="bibr">Pedulla <italic toggle="yes">et al.</italic> 2003</xref>). This confounds simple phylogenetic representations, and phage diversity is sufficiently great that there are no universally conserved “core” genes (<xref rid="jkac233-B7" ref-type="bibr">Hatfull and Hendrix 2011</xref>); phages do not have the equivalent of bacterial 16S rRNA genes. Because horizontal exchange events giving rise to genomic mosaicism are prevalent, they are key factors in phage evolution together with ongoing variation at the nucleotide sequence level (<xref rid="jkac233-B19" ref-type="bibr">Lima-Mendez <italic toggle="yes">et al.</italic> 2008</xref>). Comparison of nucleotide divergence and rates of gene exchange reveals evolutionary patterns that differ with different hosts and phage lifestyles (<xref rid="jkac233-B22" ref-type="bibr">Mavrich and Hatfull 2017</xref>). However, this requires an assortment of phage genes into related groups, or “phamilies.”</p>
    <p>Assortment of phage genes into phamilies (phams) was initially described using Phamerator, which assembled phams (using amino acid sequences) with specific BLASTP and CLUSTALW parameters (<xref rid="jkac233-B2" ref-type="bibr">Cresawn <italic toggle="yes">et al.</italic> 2011</xref>). The extant target dataset was modest—80 mycobacteriophage genomes encompassing ∼800 genes—and was computationally manageable. The output of the pham dataset was useful for many downstream analyses and representations, including comparative genome maps using the Phamerator display functions (<xref rid="jkac233-B2" ref-type="bibr">Cresawn <italic toggle="yes">et al.</italic> 2011</xref>). As the number of phage genomes rapidly increased, the computational demands exceeded the capacity of BLASTP and CLUSTALW, and a revised Pham building system was developed using kClust and associated programs (<xref rid="jkac233-B26" ref-type="bibr">Pope <italic toggle="yes">et al.</italic> 2015</xref>). However, kClust (<xref rid="jkac233-B8" ref-type="bibr">Hauser <italic toggle="yes">et al.</italic> 2013</xref>) was soon deprecated and replaced by the more powerful MMseqs2 package (<xref rid="jkac233-B29" ref-type="bibr">Steinegger and Soding 2017</xref>).</p>
    <p>Here, we describe PhaMMseqs, a new pipeline for Pham assembly, using MMseqs2. Phage gene sequences are first translated into amino acid sequences, and PhaMMseqs uses MMseqs2 to first derive sequence profiles, followed by profile-sequence clustering to merge phams containing more remote homologs; Clustal Omega (<xref rid="jkac233-B28" ref-type="bibr">Sievers <italic toggle="yes">et al.</italic> 2011</xref>) is used to construct pham multiple sequence alignments (MSAs). PhaMMseqs can readily assemble Phams from large genome datasets (&gt;500,000 genes) on modest hardware and can be used in combination with database management utilities like pdm_utils (<xref rid="jkac233-B21" ref-type="bibr">Mavrich <italic toggle="yes">et al.</italic> 2021</xref>) for efficiently updating phams as the genome annotation landscape changes.</p>
  </sec>
  <sec>
    <title>Materials and methods</title>
    <sec>
      <title>PhaMMseqs programming</title>
      <p>PhaMMseqs was written in Python, is compatible with Python versions 3.7 and above, and uses Biopython (<xref rid="jkac233-B1" ref-type="bibr">Cock <italic toggle="yes">et al.</italic> 2009</xref>) to parse GenBank flat files and <ext-link xlink:href="MMseqs2" ext-link-type="DDBJ/EMBL/GenBank">MMseqs2</ext-link> (<xref rid="jkac233-B29" ref-type="bibr">Steinegger and Soding 2017</xref>) for pham assembly. Clustal Omega (<xref rid="jkac233-B28" ref-type="bibr">Sievers <italic toggle="yes">et al.</italic> 2011</xref>) is used optionally to compute MSAs. The PhaMMSeqs package is available at PyPI (<ext-link xlink:href="https://pypi.org/project/phammseqs/" ext-link-type="uri">https://pypi.org/project/phammseqs/</ext-link>) or GitHub (<ext-link xlink:href="https://github.com/chg60/PhaMMseqs.git" ext-link-type="uri">https://github.com/chg60/PhaMMseqs.git</ext-link>). MMseqs2 and Clustal Omega must be installed separately, using a package manager, such as Anaconda or compiled manually; PhaMMseqs installation and usage instructions are available in the GitHub repository. PhaMMseqs has also been incorporated into the <italic toggle="yes">pdm_utils</italic> package (<xref rid="jkac233-B21" ref-type="bibr">Mavrich <italic toggle="yes">et al.</italic> 2021</xref>) for creating and maintaining phage genome databases, replacing its “phamerate” pipeline (i.e. the prior system for pham assembly).</p>
    </sec>
    <sec>
      <title>Computing global alignments</title>
      <p>Phage gene sequences were translated into amino acid sequences using a standard genetic code (11: Bacterial, Archaeal and Plant Plastid) and Needleman–Wunsch global amino acid sequence alignments were computed using the PARASAIL library (<xref rid="jkac233-B3" ref-type="bibr">Daily 2016</xref>). Alignment scores were calculated between sequence pairs using the BLOSUM62 substitution matrix (<xref rid="jkac233-B11" ref-type="bibr">Henikoff and Henikoff 1992</xref>) with gap-opening and extension penalties of −11 and −1, respectively. Alignment statistics (identity, similarity, gap percentage, and length-normalized bitscore) for each sequence pair were cached to avoid recomputing alignments.</p>
    </sec>
    <sec>
      <title>Identifying false-positive pham members</title>
      <p>A gene present within a pham that should not be (i.e. a nonhomolog) is considered a false positive. To identify false positives, pairwise global alignments were first computed within each pham. A sequence was counted as a false positive if either of 2 conditions were met: (1) the gene’s length is less than 60% of the length of the longest pham member or (2) the gene’s best pairwise alignment within the pham is not significantly better than an alignment between unrelated gene pairs (length-normalized score threshold: 0.5 half-bits per column). The former identifies any gene whose homology is evidently nonglobal in scope, while the latter finds genes with dubious homology to the rest of the pham (see the<italic toggle="yes"> Methods</italic> in <italic toggle="yes">Supplementary Materials</italic> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref> for the establishment of these thresholds).</p>
    </sec>
    <sec>
      <title>Identifying false-negative pham members</title>
      <p>A gene expected to be present in a pham but which is absent is considered a false negative. To identify false-negative pham members, pairwise global alignments were computed within each pham, and the gene with the highest average similarity to all other genes was selected as the pham representative. BLASTP was used to identify genes in the complete dataset that are likely globally homologous to the pham representative (<italic toggle="yes">E</italic>-value 0.001, query coverage at least 60%, query length no less than 60% of subject length). Any such genes identified by BLASTP but not present in the pham were counted as false negatives.</p>
    </sec>
    <sec>
      <title>Determining and validating pham consensus functions</title>
      <p>For every pham, we identified the set of unique functional annotations ascribed to members of the pham and counted how many times each was used. Counts were manually adjusted to account for labeling inconsistencies (e.g. “terminase, large subunit,” “TerL,” “large terminase” all refer to the same function) and typographic errors within individual genome annotations. The most common function in each pham was used as its consensus function. For validation of consensus functions, pham MSAs were submitted to the Max Planck Institute’s HHpred server (<ext-link xlink:href="https://toolkit.tuebingen.mpg.de/tools/hhpred" ext-link-type="uri">https://toolkit.tuebingen.mpg.de/tools/hhpred</ext-link>), with the following 4 structural/domain databases selected for search: PDB_mmCIF70, PDB_mmCIF30, UniProt-SwissProt-viral70, and NCBI_ConservedDomains(CD). Top hits were manually evaluated for agreement with the annotated functions.</p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <sec>
      <title>PhaMMseqs workflow</title>
      <p>Understanding bacteriophage evolution requires comparative analysis of their gene organization and gene content, together with insights into gene function. The genomes are characteristically mosaic and the relationships span considerable timespans, with many genes of common origins no longer sharing recognizable nucleotide sequence similarity. A central component of this analysis is thus to arrange phage genes into groups (phamilies or phams) based on shared amino acid sequences, and the primary function of PhaMMseqs is to perform pham assembly, which it does by interfacing with the sequence–sequence and profile–sequence clustering pipelines of MMseqs2. The program workflow (<xref rid="jkac233-F1" ref-type="fig">Fig. 1a</xref>) proceeds as follows. Protein-coding sequences from one or more input files in FASTA or GenBank flat file format are collected and clustered with <ext-link xlink:href="MMseqs2" ext-link-type="DDBJ/EMBL/GenBank">MMseqs2</ext-link> according to user-specified or default parameters. Optionally, gene phamilies containing remote homologs can then be merged by a profile–sequence clustering step. Each resultant pham is written to an FASTA multiple sequence file, and pham MSAs can be optionally computed using a local installation of Clustal Omega. If each input file contains the genes from a single genome, 3 pangenome-style analyses can also be performed (<xref rid="jkac233-F1" ref-type="fig">Fig. 1a</xref>). The first scores the degree of conservation of each pham among input genomes, labeling each pham as containing “core,” “soft-core,” “shell,” or “cloud” genes according to the percentage of genomes (&gt;99%, &gt;95%, &gt;15%, or &gt;0%, respectively) encoding a gene assorted into that pham. The second follows Roary (<xref rid="jkac233-B24" ref-type="bibr">Page <italic toggle="yes">et al.</italic> 2015</xref>) and creates a comma-separated value file with pham-wise summary statistics and a presence–absence matrix indicating which (if any) genes from each genome are assorted into each pham. The last creates a tab-separated value file mapping each genome to the phams its genes have been assorted into and is useful for other tools that perform genome clustering based on shared phams.</p>
      <fig position="float" id="jkac233-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Pipelines for pham assembly and evaluation. a) Input FASTA or GenBank files are parsed for amino-acid sequences, which are clustered using sequence–sequence alignments by <ext-link xlink:href="PhaMMseqs" ext-link-type="DDBJ/EMBL/GenBank">PhaMMseqs</ext-link>; these are then further clustered using profile–sequence alignments. The command line argument “–skip-hmm” allows users to bypass profile–sequence clustering if desired. The resulting phams are written to FASTA multiple sequence files, and pham MSAs optionally computed with Clustal Omega if using the “–align-phams” argument. If each input file contains genes from a single genome, the “–pangenome” argument will produce Roary-inspired pham/genome summary files. The programmatic interface allows scripts or larger suites of tools (including the <italic toggle="yes">pdm_utils</italic> package for maintaining Phamerator databases) to directly interact with the pham assembly workflow without producing any unwanted output files. PhaMMseqs’s output files can be used for numerous downstream analyses. b) PhaMMseqs training workflow. Initial setup steps were implemented to avoid computationally expensive training tasks, and then several thousand sequence–sequence parameter sets were run to identify those with greatest sensitivity and minimal false positives. These parameters were used to build pham profiles, which were used with thousands of profile–sequence parameter sets to identify those assembling phams with greatest sensitivity and a false positive rate below 0.5%. The most sensitive parameter sets in both stages were selected as the default MMseqs2 parameters used by PhaMMseqs.</p>
        </caption>
        <graphic xlink:href="jkac233f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>MMseqs2 parameter selection and value optimization</title>
      <p>The performance of MMseqs2 can be carefully tuned by specifying values for any of dozens of parameters, some of which have more significant and/or intuitive impacts on clustering than others. We focused on 6 of these parameters that principally define how MMseqs2 finds homologous gene pairs and how it interprets the homology network into gene clusters: minimum sequence identity (–min-seq-id), coverage (-c), <italic toggle="yes">E</italic>-value (-e), sensitivity (-s; used to allow nonidentical k-mer matches to seed alignments), the number of cluster steps (–cluster-steps/–num-iterations), and the clustering algorithm itself (–cluster-mode). For each of these parameters, the value that PhaMMseqs uses by default was carefully optimized to maximize the sensitivity in grouping remote global homologs while avoiding domain-chaining (<xref rid="jkac233-B13" ref-type="bibr">Joseph and Durand 2009</xref>) and other false positives. Domain chaining is the act of grouping globally dissimilar proteins based on local homology (i.e. a shared domain) and reduces the effectiveness of phams as tools for exploring gene function or genome mosaicism. Our training dataset comprised 89,208 nonredundant amino-acid sequences (181,625 including identical sequences found in multiple genomes) derived from the annotations of 1,885 phages infecting 13 genera of Actinobacteria (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table 1</xref>), retrieved from PhagesDB (<xref rid="jkac233-B27" ref-type="bibr">Russell and Hatfull 2017</xref>).</p>
      <p>Parameter training was done in 2 stages by a pipeline we created to run PhaMMseqs across ranges of values for each parameter and evaluate the resultant phams for likely false positives and false negatives (<xref rid="jkac233-F1" ref-type="fig">Fig. 1b</xref>). In the first stage (<xref rid="jkac233-T1" ref-type="table">Table 1</xref>), we evaluated 2,025 parameter sets with the goal of building inclusive yet highly specific (i.e. avoiding non homologous members) phams that could be used as high-quality sequence profiles for more remote homology detection. For this stage, any parameter sets producing at least 1 pham with false positives were excluded, thus reducing noise that compromises the ability of a profile to find true remote homologs and increases the likelihood of accumulating false positives during profile-based clustering. In the second stage (<xref rid="jkac233-T2" ref-type="table">Table 2</xref>), we evaluated 1,890 profile-sequence clustering parameter sets using profiles built from the best first-stage parameters, and with the goals of maximizing sensitivity (i.e. maximal inclusion of homologs) and maintaining a low percentage of genes identified as false positives in their respective phams.</p>
      <table-wrap position="float" id="jkac233-T1">
        <label>Table 1.</label>
        <caption>
          <p>Parameters used in sequence–sequence clustering grid search.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Parameter name</th>
              <th align="center" rowspan="1" colspan="1">Values</th>
              <th align="center" rowspan="1" colspan="1">Brief description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">—cluster-mode</td>
              <td rowspan="1" colspan="1">0, 1, 2</td>
              <td rowspan="1" colspan="1">Clustering algorithm to use<xref rid="tblfn1" ref-type="table-fn"><sup>a</sup></xref></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">—cluster-steps</td>
              <td rowspan="1" colspan="1">1, 2, 3</td>
              <td rowspan="1" colspan="1">Number of cascaded clustering steps to do<xref rid="tblfn2" ref-type="table-fn"><sup>b</sup></xref></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">−s</td>
              <td rowspan="1" colspan="1">1, 4, 7</td>
              <td rowspan="1" colspan="1">Sensitivity<xref rid="tblfn3" ref-type="table-fn"><sup>c</sup></xref></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">—min-seq-id</td>
              <td rowspan="1" colspan="1">0.5, 0.45, 0.4, 0.35, 0.3</td>
              <td rowspan="1" colspan="1">Percent identity threshold</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">−c</td>
              <td rowspan="1" colspan="1">0.9, 0.85, 0.8, 0.75, 0.7</td>
              <td rowspan="1" colspan="1">Coverage threshold</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">−e</td>
              <td rowspan="1" colspan="1">1e−10, 1e−05, 1e−3</td>
              <td rowspan="1" colspan="1"><italic toggle="yes">E</italic>-value threshold</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <label>a</label>
            <p>Different algorithms are available to interpret the graph of pairwise edges into clusters. 0 = set cover, 1 = single-linkage (like blastclust), 2 = greedy-incremental (like CD-HIT). Details are in MMseqs2 manual.</p>
          </fn>
          <fn id="tblfn2">
            <label>b</label>
            <p>Performs clustering with strict parameters, then incrementally merges clusters by relaxing parameters down to the selected ones in these many steps.</p>
          </fn>
          <fn id="tblfn3">
            <label>c</label>
            <p>Higher sensitivity values allow less similar k-mers to count as matches that can seed an alignment.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap position="float" id="jkac233-T2">
        <label>Table 2.</label>
        <caption>
          <p>Parameters used in profile–sequence clustering grid search.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Parameter name</th>
              <th align="center" rowspan="1" colspan="1">Values</th>
              <th align="center" rowspan="1" colspan="1">Brief description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">—cluster-mode</td>
              <td rowspan="1" colspan="1">0, 1, 2</td>
              <td rowspan="1" colspan="1">Clustering algorithm to use<xref rid="tblfn4" ref-type="table-fn"><sup>a</sup></xref></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">—num-iterations</td>
              <td rowspan="1" colspan="1">1, 2, 3</td>
              <td rowspan="1" colspan="1">Number of iterations to do<xref rid="tblfn5" ref-type="table-fn"><sup>b</sup></xref></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">−s</td>
              <td rowspan="1" colspan="1">1, 4, 7</td>
              <td rowspan="1" colspan="1">Sensitivity<xref rid="tblfn6" ref-type="table-fn"><sup>c</sup></xref></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">—min-seq-id</td>
              <td rowspan="1" colspan="1">0.35, 0.3, 0.25, 0.2, 0.15</td>
              <td rowspan="1" colspan="1">Percent identity threshold</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">−c/—cov</td>
              <td rowspan="1" colspan="1">0.85, 0.8, 0.75, 0.7, 0.65, 0.6, 0.55</td>
              <td rowspan="1" colspan="1">Coverage threshold</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">−e/—e-profile</td>
              <td rowspan="1" colspan="1">1e−05, 1e−3</td>
              <td rowspan="1" colspan="1"><italic toggle="yes">E</italic>-value threshold</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn4">
            <label>a</label>
            <p>Different algorithms are available to interpret the graph of pairwise edges into clusters. 0 = set cover, 1 = single-linkage (like blastclust), 2 = greedy-incremental (like CD-HIT). Details are in MMseqs2 manual.</p>
          </fn>
          <fn id="tblfn5">
            <label>b</label>
            <p>Performs this many PSI-BLAST-like iterations of finding homologs and updating profiles before clustering.</p>
          </fn>
          <fn id="tblfn6">
            <label>c</label>
            <p>Higher sensitivity values allow less similar k-mers to count as matches that can seed an alignment.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>Sequence–sequence parameter optimization</title>
      <p>Of the 2,025 possible combinations of values given in <xref rid="jkac233-T1" ref-type="table">Table 1</xref>, only 1,099 produced phams containing no likely false positives. Of these, we selected the parameter set with the fewest false negatives as the default for sequence–sequence clustering. Analysis of these false-positive-free parameter sets was helpful for understanding how MMseqs2 performs with these datasets. The choice of the MMseqs2 parameter described as “sensitivity” strongly influences runtime (<xref rid="jkac233-F2" ref-type="fig">Fig. 2a</xref>), with runtime increasing superlinearly with sensitivity. Increasing MMseqs2 sensitivity also tends to reduce the number of phams (<xref rid="jkac233-F2" ref-type="fig">Fig. 2b</xref>) and false negatives (<xref rid="jkac233-F2" ref-type="fig">Fig. 2c</xref>), both indications that homologous sequences are being joined into phamilies. Percent identity and coverage thresholds have little impact on runtime (<xref rid="jkac233-F2" ref-type="fig">Fig. 2, d and g</xref>), but are important determinants of MMseqs2 sensitivity, with lower values for both parameters yielding significantly reduced number of false negatives, and likewise reduced number of phams (<xref rid="jkac233-F2" ref-type="fig">Fig. 2, e, f</xref> and <xref rid="jkac233-F2" ref-type="fig">h, i</xref>). Intuitively, these effects are likely to be additive, such that reducing percent identity and coverage thresholds simultaneously results in fewer phams and false negatives than lowering either threshold alone but may also result in introduction of false positives.</p>
      <fig position="float" id="jkac233-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>The impact of sensitivity, identity, and coverage on sequence–sequence clustering with MMseqs2. The runtime (in seconds), number of phams, and number of false negatives were plotted for each value of sensitivity (a–c), percent identity (d–f), and percent coverage (g–i) tested (see <italic toggle="yes">Materials and Methods</italic> for identification of false negatives). Sensitivity (-s) is used by MMseqs2 to scale the score threshold required to treat similar k-mers as match-states that can seed an alignment; higher values reduce the score threshold, theoretically resulting in the alignment and evaluation of less similar protein pairs. Percent identity (–min-seq-id) defines how similar a protein must be to a cluster representative in order to join that cluster, with lower values allowing less similar proteins to join a cluster. Percent coverage (-c) defines the proportion of query/target sequences that must be covered by an alignment in order for the proteins to cluster together. Parameter sets that produced any phams with false positives were omitted from this analysis.</p>
        </caption>
        <graphic xlink:href="jkac233f2" position="float"/>
      </fig>
      <p>Within the tested ranges of values, the <italic toggle="yes">E</italic>-value threshold and number of cluster steps appear not to significantly alter runtime, number of phams, or the number of false negatives (<xref rid="jkac233-F3" ref-type="fig">Fig. 3, a–f</xref>). The choice of cluster mode (clustering algorithm) has minimal impact on runtime (<xref rid="jkac233-F3" ref-type="fig">Fig. 3g</xref>) but is clearly important, because the majority (80%) of parameter sets using cluster mode 1 (single-linkage clustering) have at least 1 false-positive member, limiting its utility to much higher percent identity and coverage thresholds than can be used with the other 2 cluster modes. Cluster mode 2, which is similar to the CD-HIT algorithm (<xref rid="jkac233-B18" ref-type="bibr">Li and Godzik 2006</xref>), cluster genes in descending order of length, and appears to be the least sensitive, consistently producing more phams with more false negatives. Of the available cluster modes, we find that cluster mode 0 (“greedy incremental”; clusters genes in descending order of connectivity to other genes) makes the best tradeoff between sensitivity and false positivity.</p>
      <fig position="float" id="jkac233-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>The impact of <italic toggle="yes">E</italic>-value, cluster steps, and cluster mode on sequence–sequence clustering with MMseqs2. The runtime (in seconds), number of phams, and number of false negatives were plotted for each value of <italic toggle="yes">E</italic>-value (a–c), cluster steps (d–f), and cluster mode (g–i) tested (see <italic toggle="yes">Materials and Methods</italic> for identification of false negatives). <italic toggle="yes">E</italic>-value (-e) indicates the statistical significance of a particular alignment, accounting for the size and composition of both the database and the aligned proteins; smaller values are more significant. Cluster steps determine how many relaxing iterations MMseqs2 should perform before clustering at the indicated stringency. Cluster mode (values are not ordinal) selects which algorithm MMseqs2 uses to interpret the homology network into clusters: 0 = set cover, 1 = single-linkage, 2 = greedy-incremental (see MMseqs2 manual for details). Parameter sets that produced any phams with false positives were omitted from this analysis.</p>
        </caption>
        <graphic xlink:href="jkac233f3" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>Profile–sequence parameter optimization</title>
      <p>Of the 1,890 possible combinations of values given in <xref rid="jkac233-T2" ref-type="table">Table 2</xref>, only 902 assembled phams with an overall false positive rate below an arbitrarily chosen 0.5%. Analysis of these parameter sets largely recapitulates the trends observed during sequence–sequence clustering. Increasing values of sensitivity resulted in significantly increased runtimes, modest decreases in the number of phams and false negatives, and a slight increase in the number of false positives observed (<xref rid="jkac233-F4" ref-type="fig">Fig. 4, a–d</xref>). Percent identity has no significant impact on runtime or the incidence of false positives but is positively correlated with the number of phams and false negatives (<xref rid="jkac233-F4" ref-type="fig">Fig. 4, e–h</xref>). Coverage likewise has no discernable impact on overall runtime but plays a very strong role in the number of observed phams, false negatives, and false positives (<xref rid="jkac233-F4" ref-type="fig">Fig. 4, i–l</xref>).</p>
      <fig position="float" id="jkac233-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>The impact of sensitivity, identity, and coverage on profile–sequence clustering with MMseqs2. The runtime (in seconds), number of phams, number of false negatives, and false positive rate were plotted for each value of sensitivity (a–d), percent identity (e–h), and percent coverage (i–l) tested. False-positive rate was calculated as the number of genes determined to be false positives in their respective phams divided by the number of genes being clustered (see <italic toggle="yes">Materials and Methods</italic> for identification of false positives and negatives). Sensitivity (-s), percent identity (–min-seq-id), and percent coverage (-c) are as described in <xref rid="jkac233-F2" ref-type="fig">Fig. 2</xref>. Parameter sets producing false positives above a rate of 0.5% were omitted from this analysis.</p>
        </caption>
        <graphic xlink:href="jkac233f4" position="float"/>
      </fig>
      <p>As was expected but not observed during sequence–sequence clustering, the number of cluster steps did significantly impact runtime in profile–sequence clustering, with more steps resulting in longer runtimes (<xref rid="jkac233-F5" ref-type="fig">Fig. 5a</xref>). This is likely due to the cost of having to update profiles with each added step. No other significant effects were observed related to the number of cluster steps or the choice of <italic toggle="yes">E</italic>-value threshold (<xref rid="jkac233-F5" ref-type="fig">Fig. 5, b–h</xref>). As was observed in sequence–sequence clustering, the single linkage algorithm used in cluster mode 1 has an elevated false-positive rate (<xref rid="jkac233-F5" ref-type="fig">Fig. 5, i–l</xref>) that reduces its utility at low identity or coverage thresholds. Overall, cluster mode 2 appears less sensitive than the others, reflected in its reduced incidence of false positives and larger numbers of phams and false negatives. As in sequence–sequence clustering, we find cluster mode 0 to have the best overall performance.</p>
      <fig position="float" id="jkac233-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>The impact of <italic toggle="yes">E</italic>-value, cluster steps, and cluster mode on sequence–sequence clustering with MMseqs2. The runtime (in seconds), number of phams, number of false negatives, and false-positive rate were plotted for each value of <italic toggle="yes">E</italic>-value (a–d), cluster steps (e–h), and cluster mode (i–l) tested. False-positive rate was calculated as the number of genes determined to be false positives in their respective phams divided by the number of genes being clustered (see <italic toggle="yes">Materials and Methods</italic> for identification of false positives and negatives). <italic toggle="yes">E</italic>-value (-e), cluster steps, and cluster mode are as described in <xref rid="jkac233-F3" ref-type="fig">Fig. 3</xref>. Parameter sets producing false positives above a rate of 0.5% were omitted from this analysis</p>
        </caption>
        <graphic xlink:href="jkac233f5" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>Scalability of optimized parameters</title>
      <p>Using PhaMMseqs iteratively with the optimized parameters, we can assemble a redundant set of 181,625 training genes (which includes redundant gene copies excluded from the nonredundant training set) into 17,248 phams with a mean size of 10.53 genes in ∼3 min on a 2020 MacBook Pro with an 8-core M1 processor. The largest pham contains 946 genes, and there are 7,644 (44.3%) phams with only 1 gene (orphams). To test the scalability of the optimized MMseqs2 parameters, we downloaded all 4,380 complete phage annotations available in RefSeq (accessed 2021 August 29). The RefSeq (<xref rid="jkac233-B23" ref-type="bibr">O’Leary <italic toggle="yes">et al.</italic> 2016</xref>) phages comprise representative and reference genomes from each “species” of sequenced phage, thus these genomes are minimally redundant; these phages jointly encode 465,399 genes (345,410 nonredundant). Using the same device as before, these genes assemble into 90,644 phams (∼5.13 genes/pham) in roughly 22 min; the largest pham has 775 genes, and there are 50,804 (56.0%) orphams. The increase in runtime and number of phams and orphams are consistent with the substantial increase in diversity in RefSeq phages compared to the Actinobacteriophages initially trained on; nonetheless, the runtime is clearly not prohibitive even with readily available computational resources.</p>
    </sec>
    <sec>
      <title>Phams produced using optimized parameters are functionally consistent</title>
      <p>The default PhaMMseqs parameters were chosen in a manner that theoretically builds phams that are functionally consistent. We analyzed the 20 largest phams from the training and RefSeq datasets to determine the validity of this, as these typically are functionally well-defined and are vulnerable to the potential inclusion of false positives. For the training dataset, the 20 largest phams (<xref rid="jkac233-T3" ref-type="table">Table 3</xref>) contain a total of 11,198 genes, or roughly ∼6.2% of all genes. Most of these phams have a clear consensus function annotated; those that do not typically have a weak consensus function and a significant population of genes designated as “hypothetical protein.” MSAs for these 20 phams were manually inspected for signs of domain chaining or other obvious issues, as well as submitted to the MPI HHpred server (<xref rid="jkac233-B30" ref-type="bibr">Zimmermann <italic toggle="yes">et al.</italic> 2018</xref>) to validate the consensus function. No instances of domain chaining were observed, and we were encouraged to see 1 pham (rank 5 by size—terminase, large subunit) that includes both intein-containing and intein-free homologs, because inteins are not uncommon in phage genomes and can interrupt pham assembly (<xref rid="jkac233-B14" ref-type="bibr">Kelley <italic toggle="yes">et al.</italic> 2016</xref>). In addition, the best HHpred hits for each pham were congruent with the consensus annotated function. Extending this analysis to the top 50 largest phams is consistent with these conclusions (data not shown).</p>
      <table-wrap position="float" id="jkac233-T3">
        <label>Table 3.</label>
        <caption>
          <p>Consensus functions of the 20 largest phams in 1,885 Actinobacteriophages.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Rank</th>
              <th align="center" rowspan="1" colspan="1">No. of genes in pham</th>
              <th align="center" rowspan="1" colspan="1">Consensus function<xref rid="tblfn7" ref-type="table-fn"><sup>a</sup></xref></th>
              <th align="center" rowspan="1" colspan="1">Consensus proportion<xref rid="tblfn8" ref-type="table-fn"><sup>b</sup></xref> (%)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">946</td>
              <td rowspan="1" colspan="1">Minor tail protein</td>
              <td rowspan="1" colspan="1">92.3</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">932</td>
              <td rowspan="1" colspan="1">Lysin B</td>
              <td rowspan="1" colspan="1">95.9</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">3</td>
              <td rowspan="1" colspan="1">689</td>
              <td rowspan="1" colspan="1">DNA polymerase I</td>
              <td rowspan="1" colspan="1">95.6</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">4</td>
              <td rowspan="1" colspan="1">687</td>
              <td rowspan="1" colspan="1">Portal</td>
              <td rowspan="1" colspan="1">96.7</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">5</td>
              <td rowspan="1" colspan="1">653</td>
              <td rowspan="1" colspan="1">Terminase, large subunit</td>
              <td rowspan="1" colspan="1">96.5</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">6</td>
              <td rowspan="1" colspan="1">550</td>
              <td rowspan="1" colspan="1">Major capsid protein</td>
              <td rowspan="1" colspan="1">96.9</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">7</td>
              <td rowspan="1" colspan="1">548</td>
              <td rowspan="1" colspan="1">DNA helicase</td>
              <td rowspan="1" colspan="1">93.8</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">8</td>
              <td rowspan="1" colspan="1">540</td>
              <td rowspan="1" colspan="1">DNA primase</td>
              <td rowspan="1" colspan="1">94.1</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">9</td>
              <td rowspan="1" colspan="1">499</td>
              <td rowspan="1" colspan="1">Endonuclease VII</td>
              <td rowspan="1" colspan="1">93.0</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">10</td>
              <td rowspan="1" colspan="1">499</td>
              <td rowspan="1" colspan="1">Terminase, large subunit</td>
              <td rowspan="1" colspan="1">97.2</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">11</td>
              <td rowspan="1" colspan="1">498</td>
              <td rowspan="1" colspan="1">Hypothetical protein</td>
              <td rowspan="1" colspan="1">63.5<xref rid="tblfn9" ref-type="table-fn"><sup>c</sup></xref></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">12</td>
              <td rowspan="1" colspan="1">494</td>
              <td rowspan="1" colspan="1">Hypothetical protein</td>
              <td rowspan="1" colspan="1">63.3<xref rid="tblfn10" ref-type="table-fn"><sup>d</sup></xref></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">13</td>
              <td rowspan="1" colspan="1">493</td>
              <td rowspan="1" colspan="1">Minor tail protein</td>
              <td rowspan="1" colspan="1">91.9</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">14</td>
              <td rowspan="1" colspan="1">474</td>
              <td rowspan="1" colspan="1">Tail assembly chaperone</td>
              <td rowspan="1" colspan="1">96.4</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">15</td>
              <td rowspan="1" colspan="1">463</td>
              <td rowspan="1" colspan="1">Minor tail protein</td>
              <td rowspan="1" colspan="1">62.0<xref rid="tblfn11" ref-type="table-fn"><sup>e</sup></xref></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">16</td>
              <td rowspan="1" colspan="1">452</td>
              <td rowspan="1" colspan="1">Immunity repressor</td>
              <td rowspan="1" colspan="1">87.6</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">17</td>
              <td rowspan="1" colspan="1">446</td>
              <td rowspan="1" colspan="1">Head-to-tail connector</td>
              <td rowspan="1" colspan="1">58.5<xref rid="tblfn11" ref-type="table-fn"><sup>e</sup></xref></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">18</td>
              <td rowspan="1" colspan="1">445</td>
              <td rowspan="1" colspan="1">Head-to-tail connector</td>
              <td rowspan="1" colspan="1">54.8<xref rid="tblfn11" ref-type="table-fn"><sup>e</sup></xref></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">19</td>
              <td rowspan="1" colspan="1">445</td>
              <td rowspan="1" colspan="1">Hypothetical protein</td>
              <td rowspan="1" colspan="1">97.8</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">20</td>
              <td rowspan="1" colspan="1">445</td>
              <td rowspan="1" colspan="1">Scaffolding protein</td>
              <td rowspan="1" colspan="1">94.6</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn7">
            <label>a</label>
            <p>Consensus function annotated for members of the pham, manually corrected for synonymous labels and typographic errors.</p>
          </fn>
          <fn id="tblfn8">
            <label>b</label>
            <p>Percentage of genes in the pham that have been annotated as some variant of the consensus function.</p>
          </fn>
          <fn id="tblfn9">
            <label>c</label>
            <p>Most remaining genes are designated as minor tail protein.</p>
          </fn>
          <fn id="tblfn10">
            <label>d</label>
            <p>Most remaining genes are designated as head-to-tail connector.</p>
          </fn>
          <fn id="tblfn11">
            <label>e</label>
            <p>Most remaining genes are designated as hypothetical protein.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Commensurate with the increased diversity of the RefSeq dataset, the 20 largest phams (<xref rid="jkac233-T4" ref-type="table">Table 4</xref>) contain fewer genes both absolutely and proportionally to the size of the dataset (9,637 genes, ∼2.1% of genes). Again, most of these have clear consensus functions, and just 3 phams have a weak consensus diluted by a significant population of “hypothetical protein” or other nonspecific labels. Pham MSAs reveal no evidence of domain chaining, and the best HHpred hits recapitulate the consensus annotated functions for these phams.</p>
      <table-wrap position="float" id="jkac233-T4">
        <label>Table 4.</label>
        <caption>
          <p>Consensus functions of the 20 largest phams in 4,380 RefSeq phages.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Rank</th>
              <th align="center" rowspan="1" colspan="1">Number of genes</th>
              <th align="center" rowspan="1" colspan="1">Consensus function<xref rid="tblfn12" ref-type="table-fn"><sup>a</sup></xref></th>
              <th align="center" rowspan="1" colspan="1">Consensus proportion<xref rid="tblfn13" ref-type="table-fn"><sup>b</sup></xref> (%)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">775</td>
              <td rowspan="1" colspan="1">Minor tail protein</td>
              <td rowspan="1" colspan="1">91.4</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">682</td>
              <td rowspan="1" colspan="1">HNH endonuclease</td>
              <td rowspan="1" colspan="1">78.1<sup>c</sup></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">3</td>
              <td rowspan="1" colspan="1">620</td>
              <td rowspan="1" colspan="1">Portal</td>
              <td rowspan="1" colspan="1">96.0</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">4</td>
              <td rowspan="1" colspan="1">604</td>
              <td rowspan="1" colspan="1">Lysin B</td>
              <td rowspan="1" colspan="1">95.2</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">5</td>
              <td rowspan="1" colspan="1">541</td>
              <td rowspan="1" colspan="1">Ribonucleotide reductase</td>
              <td rowspan="1" colspan="1">94.8</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">6</td>
              <td rowspan="1" colspan="1">541</td>
              <td rowspan="1" colspan="1">Recombination endonuclease</td>
              <td rowspan="1" colspan="1">89.5</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">7</td>
              <td rowspan="1" colspan="1">503</td>
              <td rowspan="1" colspan="1">Lysozyme</td>
              <td rowspan="1" colspan="1">93.4</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">8</td>
              <td rowspan="1" colspan="1">485</td>
              <td rowspan="1" colspan="1">Terminase, large subunit</td>
              <td rowspan="1" colspan="1">95.1</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">9</td>
              <td rowspan="1" colspan="1">479</td>
              <td rowspan="1" colspan="1">DNA polymerase I</td>
              <td rowspan="1" colspan="1">95.2</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">10</td>
              <td rowspan="1" colspan="1">435</td>
              <td rowspan="1" colspan="1">Ribonucleotide reductase</td>
              <td rowspan="1" colspan="1">95.9</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">11</td>
              <td rowspan="1" colspan="1">416</td>
              <td rowspan="1" colspan="1">UvsW-like helicase</td>
              <td rowspan="1" colspan="1">92.8</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">12</td>
              <td rowspan="1" colspan="1">413</td>
              <td rowspan="1" colspan="1">Terminase, large subunit</td>
              <td rowspan="1" colspan="1">95.9</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">13</td>
              <td rowspan="1" colspan="1">409</td>
              <td rowspan="1" colspan="1">DNA helicase</td>
              <td rowspan="1" colspan="1">78.7<xref rid="tblfn14" ref-type="table-fn"><sup>c</sup></xref></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">14</td>
              <td rowspan="1" colspan="1">401</td>
              <td rowspan="1" colspan="1">DNA primase/helicase</td>
              <td rowspan="1" colspan="1">88.5</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">15</td>
              <td rowspan="1" colspan="1">396</td>
              <td rowspan="1" colspan="1">Terminase, large subunit</td>
              <td rowspan="1" colspan="1">95.0</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">16</td>
              <td rowspan="1" colspan="1">394</td>
              <td rowspan="1" colspan="1">dNMP kinase</td>
              <td rowspan="1" colspan="1">78.9<xref rid="tblfn14" ref-type="table-fn"><sup>c</sup></xref></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">17</td>
              <td rowspan="1" colspan="1">391</td>
              <td rowspan="1" colspan="1">Tail tube protein</td>
              <td rowspan="1" colspan="1">88.7</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">18</td>
              <td rowspan="1" colspan="1">387</td>
              <td rowspan="1" colspan="1">DnaB-like dsDNA helicase</td>
              <td rowspan="1" colspan="1">92.8</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">19</td>
              <td rowspan="1" colspan="1">384</td>
              <td rowspan="1" colspan="1">Major capsid protein</td>
              <td rowspan="1" colspan="1">93.8</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">20</td>
              <td rowspan="1" colspan="1">381</td>
              <td rowspan="1" colspan="1">Clamp loader</td>
              <td rowspan="1" colspan="1">88.7</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn12">
            <label>a</label>
            <p>Consensus function annotated for members of the pham, manually corrected for synonymous labels and typographic errors.</p>
          </fn>
          <fn id="tblfn13">
            <label>b</label>
            <p>Percentage of genes in the pham that have been annotated as some variant of the consensus function.</p>
          </fn>
          <fn id="tblfn14">
            <label>c</label>
            <p>Most remaining genes are designated as hypothetical proteins or have other nonspecific labels.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>Pham assembly is broadly useful for phage comparative genomics, and central to phage database resources used in integrated research-education programs such as PHIRE and SEA-PHAGES (<xref rid="jkac233-B12" ref-type="bibr">Jordan <italic toggle="yes">et al.</italic> 2014</xref>; <xref rid="jkac233-B5" ref-type="bibr">Hanauer <italic toggle="yes">et al.</italic> 2017</xref>; <xref rid="jkac233-B6" ref-type="bibr">Hatfull 2021</xref>). With rapid increases in the number of genomes available for analysis, rapid sequence comparison algorithms are needed, and we demonstrate here that MMseqs2 can be effectively used for pham assembly, both in terms of computational speed and capacity as well as the overall quality of assembled phams. Rapid and efficient pham assembly also facilitates comparative phage genomics including both within closely related lineages, and more broadly among more distantly related phages. We have evaluated PhaMMseqs on phage genomes, but it can be readily used with predicted prophages once extracted from bacterial genome sequences.</p>
    <p>Several other systems for organizing phage genes have been described, including ACLAME (<xref rid="jkac233-B17" ref-type="bibr">Leplae <italic toggle="yes">et al.</italic> 2004</xref>), POG (<xref rid="jkac233-B20" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2006</xref>; <xref rid="jkac233-B15" ref-type="bibr">Kristensen <italic toggle="yes">et al.</italic> 2011</xref>, <xref rid="jkac233-B16" ref-type="bibr">2013</xref>), and pVOG (<xref rid="jkac233-B4" ref-type="bibr">Grazziotin <italic toggle="yes">et al.</italic> 2017</xref>). However, some of these resources have not been regularly updated, compromising their overall utility. By incorporating PhaMMseqs into pdm_utils (<xref rid="jkac233-B21" ref-type="bibr">Mavrich <italic toggle="yes">et al.</italic> 2021</xref>), a suite of pipelines for managing phage datasets in different databases, rebuilding phams with newly sequenced genomes should be much simplified. PhaMMseqs also provides a much simpler interface for iterative pham assembly than deploying multiple steps directly with MMseqs2.</p>
    <p>Bacteriophage genomes have complex relationships, being pervasively mosaic, highly diverse, and replete with genes of unknown function. Moreover, the number of sequenced phage genomes is small relative to the extant population, and many genomes currently have no sequenced close relatives, and there are many genes without homologs in other phages (i.e. orphams). There are several features of phage genomes that can present challenges to pham assembly including the abundance of small genes, the presence of inteins within genes, and intragene mosaicism leading to multidomain proteins with complex evolutionary histories. Thus, even when optimized, pham assembly is expected to be imperfect, reflected by false-positive inclusion or false-negative rejection of genes into phamilies. In a few instances, we have observed some “pham-instability,” where a single set of clearly homologous genes are split into 2 phams. This is rarely observed with repeated assembles on the same hardware but can emerge with identical runs on different hardware (e.g. a MacBook Pro with M1 CPU vs a server with AMD Opteron 6376 dual CPU). We estimate such phams are rare (&lt;0.1%) and it is unclear which if any software innovations may help to eliminate these. Nonetheless, PhaMMseqs provides a rapid and efficient method for pham assembly with broad utility in phage genomics.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>jkac233_Supplementary_Data</label>
      <media xlink:href="jkac233_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgments</title>
    <p>The authors thank Travis Mavrich, David Hanauer, Johannes Söding, Martin Steinegger, and Milot Mirdita for their helpful discussions.</p>
  </ack>
  <sec sec-type="data-availability">
    <title>Data Availability</title>
    <p>The PhaMMseqs package is available at PyPI (<ext-link xlink:href="https://pypi.org/project/phammseqs/" ext-link-type="uri">https://pypi.org/project/phammseqs/</ext-link>) and GitHub (<ext-link xlink:href="https://github.com/chg60/PhaMMseqs.git" ext-link-type="uri">https://github.com/chg60/PhaMMseqs.git</ext-link>).</p>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplemental material</xref> is available at G3 online.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by grants from the National Institutes of Health (GM131729) to GFH and the Howard Hughes Medical Institute to GFH (GT12053) and SGC (GT12054).</p>
  </sec>
  <sec>
    <title>Conflicts of interest</title>
    <p>GFH receives research support from Janssen Inc. unrelated to this work and is a consultant for Janssen Inc. and Tessera Inc.</p>
  </sec>
  <ref-list id="ref1">
    <title>Literature cited</title>
    <ref id="jkac233-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cock</surname><given-names>PJA</given-names></string-name>, <string-name><surname>Antao</surname><given-names>T</given-names></string-name>, <string-name><surname>Chang</surname><given-names>JT</given-names></string-name>, <string-name><surname>Chapman</surname><given-names>BA</given-names></string-name>, <string-name><surname>Cox</surname><given-names>CJ</given-names></string-name>, <string-name><surname>Dalke</surname><given-names>A</given-names></string-name>, <string-name><surname>Friedberg</surname><given-names>I</given-names></string-name>, <string-name><surname>Hamelryck</surname><given-names>T</given-names></string-name>, <string-name><surname>Kauff</surname><given-names>F</given-names></string-name>, <string-name><surname>Wilczynski</surname><given-names>B</given-names></string-name></person-group>, <etal>et al</etal><article-title>Biopython: freely available Python tools for computational molecular biology and bioinformatics</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>(<issue>11</issue>):<fpage>1422</fpage>–<lpage>1423</lpage>.<pub-id pub-id-type="pmid">19304878</pub-id></mixed-citation>
    </ref>
    <ref id="jkac233-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cresawn</surname><given-names>SG</given-names></string-name>, <string-name><surname>Bogel</surname><given-names>M</given-names></string-name>, <string-name><surname>Day</surname><given-names>N</given-names></string-name>, <string-name><surname>Jacobs-Sera</surname><given-names>D</given-names></string-name>, <string-name><surname>Hendrix</surname><given-names>RW</given-names></string-name>, <string-name><surname>Hatfull</surname><given-names>GF.</given-names></string-name></person-group><article-title>Phamerator: a bioinformatic tool for comparative bacteriophage genomics</article-title>. <source>BMC Bioinformatics</source>. <year>2011</year>;<volume>12</volume>:<fpage>395</fpage>.<pub-id pub-id-type="pmid">21991981</pub-id></mixed-citation>
    </ref>
    <ref id="jkac233-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Daily</surname><given-names>J.</given-names></string-name></person-group><article-title>Parasail: SIMD C library for global, semi-global, and local pairwise sequence alignments</article-title>. <source>BMC Bioinformatics</source>. <year>2016</year>;<volume>17</volume>:<fpage>81</fpage>.<pub-id pub-id-type="pmid">26864881</pub-id></mixed-citation>
    </ref>
    <ref id="jkac233-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grazziotin</surname><given-names>AL</given-names></string-name>, <string-name><surname>Koonin</surname><given-names>EV</given-names></string-name>, <string-name><surname>Kristensen</surname><given-names>DM.</given-names></string-name></person-group><article-title>Prokaryotic Virus Orthologous Groups (pVOGs): a resource for comparative genomics and protein family annotation</article-title>. <source>Nucleic Acids Res</source>. <year>2017</year>;<volume>45</volume>(<issue>D1</issue>):<fpage>D491</fpage>–<lpage>D498</lpage>.<pub-id pub-id-type="pmid">27789703</pub-id></mixed-citation>
    </ref>
    <ref id="jkac233-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hanauer</surname><given-names>DI</given-names></string-name>, <string-name><surname>Graham</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Betancur</surname><given-names>L</given-names></string-name>, <string-name><surname>Bobrownicki</surname><given-names>A</given-names></string-name>, <string-name><surname>Cresawn</surname><given-names>SG</given-names></string-name>, <string-name><surname>Garlena</surname><given-names>RA</given-names></string-name>, <string-name><surname>Jacobs-Sera</surname><given-names>D</given-names></string-name>, <string-name><surname>Kaufmann</surname><given-names>N</given-names></string-name>, <string-name><surname>Pope</surname><given-names>WH</given-names></string-name>, <string-name><surname>Russell</surname><given-names>DA</given-names></string-name></person-group>, <etal>et al</etal>; <collab>SEA-PHAGES</collab>. <article-title>An inclusive Research Education Community (iREC): impact of the SEA-PHAGES program on research outcomes and student learning</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2017</year>;<volume>114</volume>(<issue>51</issue>):<fpage>13531</fpage>–<lpage>13536</lpage>.<pub-id pub-id-type="pmid">29208718</pub-id></mixed-citation>
    </ref>
    <ref id="jkac233-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hatfull</surname><given-names>GF.</given-names></string-name></person-group><article-title>Wildy Prize Lecture, 2020–2021: who wouldn’t want to discover a new virus?</article-title><source>Microbiology (Reading)</source>. <year>2021</year>;<volume>167</volume>(<issue>9</issue>):001094.</mixed-citation>
    </ref>
    <ref id="jkac233-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hatfull</surname><given-names>GF</given-names></string-name>, <string-name><surname>Hendrix</surname><given-names>RW.</given-names></string-name></person-group><article-title>Bacteriophages and their genomes</article-title>. <source>Curr Opin Virol</source>. <year>2011</year>;<volume>1</volume>(<issue>4</issue>):<fpage>298</fpage>–<lpage>303</lpage>.<pub-id pub-id-type="pmid">22034588</pub-id></mixed-citation>
    </ref>
    <ref id="jkac233-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hauser</surname><given-names>M</given-names></string-name>, <string-name><surname>Mayer</surname><given-names>CE</given-names></string-name>, <string-name><surname>Soding</surname><given-names>J.</given-names></string-name></person-group><article-title>kClust: fast and sensitive clustering of large protein sequence databases</article-title>. <source>BMC Bioinformatics</source>. <year>2013</year>;<volume>14</volume>:<fpage>248</fpage>.<pub-id pub-id-type="pmid">23945046</pub-id></mixed-citation>
    </ref>
    <ref id="jkac233-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hendrix</surname><given-names>RW.</given-names></string-name></person-group><article-title>Bacteriophages: evolution of the majority</article-title>. <source>Theor Popul Biol</source>. <year>2002</year>;<volume>61</volume>(<issue>4</issue>):<fpage>471</fpage>–<lpage>480</lpage>.<pub-id pub-id-type="pmid">12167366</pub-id></mixed-citation>
    </ref>
    <ref id="jkac233-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hendrix</surname><given-names>RW</given-names></string-name>, <string-name><surname>Smith</surname><given-names>MC</given-names></string-name>, <string-name><surname>Burns</surname><given-names>RN</given-names></string-name>, <string-name><surname>Ford</surname><given-names>ME</given-names></string-name>, <string-name><surname>Hatfull</surname><given-names>GF.</given-names></string-name></person-group><article-title>Evolutionary relationships among diverse bacteriophages and prophages: all the world’s a phage</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>1999</year>;<volume>96</volume>(<issue>5</issue>):<fpage>2192</fpage>–<lpage>2197</lpage>.<pub-id pub-id-type="pmid">10051617</pub-id></mixed-citation>
    </ref>
    <ref id="jkac233-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Henikoff</surname><given-names>S</given-names></string-name>, <string-name><surname>Henikoff</surname><given-names>JG.</given-names></string-name></person-group><article-title>Amino acid substitution matrices from protein blocks</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>1992</year>;<volume>89</volume>(<issue>22</issue>):<fpage>10915</fpage>–<lpage>10919</lpage>.<pub-id pub-id-type="pmid">1438297</pub-id></mixed-citation>
    </ref>
    <ref id="jkac233-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jordan</surname><given-names>TC</given-names></string-name>, <string-name><surname>Burnett</surname><given-names>SH</given-names></string-name>, <string-name><surname>Carson</surname><given-names>S</given-names></string-name>, <string-name><surname>Caruso</surname><given-names>SM</given-names></string-name>, <string-name><surname>Clase</surname><given-names>K</given-names></string-name>, <string-name><surname>DeJong</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Dennehy</surname><given-names>JJ</given-names></string-name>, <string-name><surname>Denver</surname><given-names>DR</given-names></string-name>, <string-name><surname>Dunbar</surname><given-names>D</given-names></string-name>, <string-name><surname>Elgin</surname><given-names>SCR</given-names></string-name></person-group>, <etal>et al</etal><article-title>A broadly implementable research course in phage discovery and genomics for first-year undergraduate students</article-title>. <source>mBio</source>. <year>2014</year>;<volume>5</volume>(<issue>1</issue>):<fpage>e01051-13</fpage>.<pub-id pub-id-type="pmid">24496795</pub-id></mixed-citation>
    </ref>
    <ref id="jkac233-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Joseph</surname><given-names>JM</given-names></string-name>, <string-name><surname>Durand</surname><given-names>D.</given-names></string-name></person-group><article-title>Family classification without domain chaining</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>(<issue>12</issue>):<fpage>i45</fpage>–<lpage>i53</lpage>.<pub-id pub-id-type="pmid">19478015</pub-id></mixed-citation>
    </ref>
    <ref id="jkac233-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kelley</surname><given-names>DS</given-names></string-name>, <string-name><surname>Lennon</surname><given-names>CW</given-names></string-name>, <string-name><surname>Sea</surname><given-names>P</given-names></string-name>, <string-name><surname>Belfort</surname><given-names>M</given-names></string-name>, <string-name><surname>Novikova</surname><given-names>O</given-names></string-name></person-group>; <collab>SEA-PHAGES</collab>. <article-title>Mycobacteriophages as incubators for intein dissemination and evolution</article-title>. <source>mBio</source>. <year>2016</year>;<volume>7</volume>(<issue>5</issue>):<fpage>e01537</fpage>–<lpage>16</lpage>.<pub-id pub-id-type="pmid">27703073</pub-id></mixed-citation>
    </ref>
    <ref id="jkac233-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kristensen</surname><given-names>DM</given-names></string-name>, <string-name><surname>Cai</surname><given-names>X</given-names></string-name>, <string-name><surname>Mushegian</surname><given-names>A.</given-names></string-name></person-group><article-title>Evolutionarily conserved orthologous families in phages are relatively rare in their prokaryotic hosts</article-title>. <source>J Bacteriol</source>. <year>2011</year>;<volume>193</volume>(<issue>8</issue>):<fpage>1806</fpage>–<lpage>1814</lpage>.<pub-id pub-id-type="pmid">21317336</pub-id></mixed-citation>
    </ref>
    <ref id="jkac233-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kristensen</surname><given-names>DM</given-names></string-name>, <string-name><surname>Waller</surname><given-names>AS</given-names></string-name>, <string-name><surname>Yamada</surname><given-names>T</given-names></string-name>, <string-name><surname>Bork</surname><given-names>P</given-names></string-name>, <string-name><surname>Mushegian</surname><given-names>AR</given-names></string-name>, <string-name><surname>Koonin</surname><given-names>EV.</given-names></string-name></person-group><article-title>Orthologous gene clusters and taxon signature genes for viruses of prokaryotes</article-title>. <source>J Bacteriol</source>. <year>2013</year>;<volume>195</volume>(<issue>5</issue>):<fpage>941</fpage>–<lpage>950</lpage>.<pub-id pub-id-type="pmid">23222723</pub-id></mixed-citation>
    </ref>
    <ref id="jkac233-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leplae</surname><given-names>R</given-names></string-name>, <string-name><surname>Hebrant</surname><given-names>A</given-names></string-name>, <string-name><surname>Wodak</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Toussaint</surname><given-names>A.</given-names></string-name></person-group><article-title>ACLAME: a CLAssification of Mobile genetic Elements</article-title>. <source>Nucleic Acids Res</source>. <year>2004</year>;<volume>32</volume>(<issue>Database issue</issue>):<fpage>D45</fpage>–<lpage>D49</lpage>.<pub-id pub-id-type="pmid">14681355</pub-id></mixed-citation>
    </ref>
    <ref id="jkac233-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>W</given-names></string-name>, <string-name><surname>Godzik</surname><given-names>A.</given-names></string-name></person-group><article-title>Cd-hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title>. <source>Bioinformatics</source>. <year>2006</year>;<volume>22</volume>(<issue>13</issue>):<fpage>1658</fpage>–<lpage>1659</lpage>.<pub-id pub-id-type="pmid">16731699</pub-id></mixed-citation>
    </ref>
    <ref id="jkac233-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lima-Mendez</surname><given-names>G</given-names></string-name>, <string-name><surname>Van Helden</surname><given-names>J</given-names></string-name>, <string-name><surname>Toussaint</surname><given-names>A</given-names></string-name>, <string-name><surname>Leplae</surname><given-names>R.</given-names></string-name></person-group><article-title>Reticulate representation of evolutionary and functional relationships between phage genomes</article-title>. <source>Mol Biol Evol</source>. <year>2008</year>;<volume>25</volume>(<issue>4</issue>):<fpage>762</fpage>–<lpage>777</lpage>.<pub-id pub-id-type="pmid">18234706</pub-id></mixed-citation>
    </ref>
    <ref id="jkac233-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>J</given-names></string-name>, <string-name><surname>Glazko</surname><given-names>G</given-names></string-name>, <string-name><surname>Mushegian</surname><given-names>A.</given-names></string-name></person-group><article-title>Protein repertoire of double-stranded DNA bacteriophages</article-title>. <source>Virus Res</source>. <year>2006</year>;<volume>117</volume>(<issue>1</issue>):<fpage>68</fpage>–<lpage>80</lpage>.<pub-id pub-id-type="pmid">16490276</pub-id></mixed-citation>
    </ref>
    <ref id="jkac233-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mavrich</surname><given-names>TN</given-names></string-name>, <string-name><surname>Gauthier</surname><given-names>C</given-names></string-name>, <string-name><surname>Abad</surname><given-names>L</given-names></string-name>, <string-name><surname>Bowman</surname><given-names>CA</given-names></string-name>, <string-name><surname>Cresawn</surname><given-names>SG</given-names></string-name>, <string-name><surname>Hatfull</surname><given-names>GF.</given-names></string-name></person-group><article-title>pdm_utils: a SEA-PHAGES MySQL phage database management toolkit</article-title>. <source>Bioinformatics</source>. <year>2021</year>;<volume>37</volume>(<issue>16</issue>):<fpage>2464</fpage>–<lpage>2466</lpage>.<pub-id pub-id-type="pmid">33226064</pub-id></mixed-citation>
    </ref>
    <ref id="jkac233-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mavrich</surname><given-names>TN</given-names></string-name>, <string-name><surname>Hatfull</surname><given-names>GF.</given-names></string-name></person-group><article-title>Bacteriophage evolution differs by host, lifestyle and genome</article-title>. <source>Nat Microbiol</source>. <year>2017</year>;<volume>2</volume>:<fpage>17112</fpage>.<pub-id pub-id-type="pmid">28692019</pub-id></mixed-citation>
    </ref>
    <ref id="jkac233-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>O’Leary</surname><given-names>NA</given-names></string-name>, <string-name><surname>Wright</surname><given-names>MW</given-names></string-name>, <string-name><surname>Brister</surname><given-names>JR</given-names></string-name>, <string-name><surname>Ciufo</surname><given-names>S</given-names></string-name>, <string-name><surname>Haddad</surname><given-names>D</given-names></string-name>, <string-name><surname>McVeigh</surname><given-names>R</given-names></string-name>, <string-name><surname>Rajput</surname><given-names>B</given-names></string-name>, <string-name><surname>Robbertse</surname><given-names>B</given-names></string-name>, <string-name><surname>Smith-White</surname><given-names>B</given-names></string-name>, <string-name><surname>Ako-Adjei</surname><given-names>D</given-names></string-name></person-group>, <etal>et al</etal><article-title>Reference sequence (RefSeq) database at NCBI: current status, taxonomic expansion, and functional annotation</article-title>. <source>Nucleic Acids Res</source>. <year>2016</year>;<volume>44</volume>(<issue>D1</issue>):<fpage>D733</fpage>–<lpage>D745</lpage>.<pub-id pub-id-type="pmid">26553804</pub-id></mixed-citation>
    </ref>
    <ref id="jkac233-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Page</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Cummins</surname><given-names>CA</given-names></string-name>, <string-name><surname>Hunt</surname><given-names>M</given-names></string-name>, <string-name><surname>Wong</surname><given-names>VK</given-names></string-name>, <string-name><surname>Reuter</surname><given-names>S</given-names></string-name>, <string-name><surname>Holden</surname><given-names>MTG</given-names></string-name>, <string-name><surname>Fookes</surname><given-names>M</given-names></string-name>, <string-name><surname>Falush</surname><given-names>D</given-names></string-name>, <string-name><surname>Keane</surname><given-names>JA</given-names></string-name>, <string-name><surname>Parkhill</surname><given-names>J</given-names></string-name></person-group>, <etal>et al</etal><article-title>Roary: rapid large-scale prokaryote pan genome analysis</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>(<issue>22</issue>):<fpage>3691</fpage>–<lpage>3693</lpage>.<pub-id pub-id-type="pmid">26198102</pub-id></mixed-citation>
    </ref>
    <ref id="jkac233-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pedulla</surname><given-names>ML</given-names></string-name>, <string-name><surname>Ford</surname><given-names>ME</given-names></string-name>, <string-name><surname>Houtz</surname><given-names>JM</given-names></string-name>, <string-name><surname>Karthikeyan</surname><given-names>T</given-names></string-name>, <string-name><surname>Wadsworth</surname><given-names>C</given-names></string-name>, <string-name><surname>Lewis</surname><given-names>JA</given-names></string-name>, <string-name><surname>Jacobs-Sera</surname><given-names>D</given-names></string-name>, <string-name><surname>Falbo</surname><given-names>J</given-names></string-name>, <string-name><surname>Gross</surname><given-names>J</given-names></string-name>, <string-name><surname>Pannunzio</surname><given-names>NR</given-names></string-name></person-group>, <etal>et al</etal><article-title>Origins of highly mosaic mycobacteriophage genomes</article-title>. <source>Cell</source>. <year>2003</year>;<volume>113</volume>(<issue>2</issue>):<fpage>171</fpage>–<lpage>182</lpage>.<pub-id pub-id-type="pmid">12705866</pub-id></mixed-citation>
    </ref>
    <ref id="jkac233-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pope</surname><given-names>WH</given-names></string-name>, <string-name><surname>Bowman</surname><given-names>CA</given-names></string-name>, <string-name><surname>Russell</surname><given-names>DA</given-names></string-name>, <string-name><surname>Jacobs-Sera</surname><given-names>D</given-names></string-name>, <string-name><surname>Asai</surname><given-names>DJ</given-names></string-name>, <string-name><surname>Cresawn</surname><given-names>SG</given-names></string-name>, <string-name><surname>Jacobs</surname><given-names>WR</given-names></string-name>, <string-name><surname>Hendrix</surname><given-names>RW</given-names></string-name>, <string-name><surname>Lawrence</surname><given-names>JG</given-names></string-name>, <string-name><surname>Hatfull</surname><given-names>GF</given-names></string-name></person-group>, <etal>et al</etal>; <collab>Mycobacterial Genetics Course</collab>. <article-title>Whole genome comparison of a large collection of mycobacteriophages reveals a continuum of phage genetic diversity</article-title>. <source>Elife</source>. <year>2015</year>;<volume>4</volume>:<fpage>e06416</fpage>.<pub-id pub-id-type="pmid">25919952</pub-id></mixed-citation>
    </ref>
    <ref id="jkac233-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Russell</surname><given-names>DA</given-names></string-name>, <string-name><surname>Hatfull</surname><given-names>GF.</given-names></string-name></person-group><article-title>PhagesDB: the actinobacteriophage database</article-title>. <source>Bioinformatics</source>. <year>2017</year>;<volume>33</volume>(<issue>5</issue>):<fpage>784</fpage>–<lpage>786</lpage>.<pub-id pub-id-type="pmid">28365761</pub-id></mixed-citation>
    </ref>
    <ref id="jkac233-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sievers</surname><given-names>F</given-names></string-name>, <string-name><surname>Wilm</surname><given-names>A</given-names></string-name>, <string-name><surname>Dineen</surname><given-names>D</given-names></string-name>, <string-name><surname>Gibson</surname><given-names>TJ</given-names></string-name>, <string-name><surname>Karplus</surname><given-names>K</given-names></string-name>, <string-name><surname>Li</surname><given-names>W</given-names></string-name>, <string-name><surname>Lopez</surname><given-names>R</given-names></string-name>, <string-name><surname>McWilliam</surname><given-names>H</given-names></string-name>, <string-name><surname>Remmert</surname><given-names>M</given-names></string-name>, <string-name><surname>Söding</surname><given-names>J</given-names></string-name></person-group>, <etal>et al</etal><article-title>Fast, scalable generation of high-quality protein multiple sequence alignments using Clustal Omega</article-title>. <source>Mol Syst Biol</source>. <year>2011</year>;<volume>7</volume>:<fpage>539</fpage>.<pub-id pub-id-type="pmid">21988835</pub-id></mixed-citation>
    </ref>
    <ref id="jkac233-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Steinegger</surname><given-names>M</given-names></string-name>, <string-name><surname>Soding</surname><given-names>J.</given-names></string-name></person-group><article-title>MMseqs2 enables sensitive protein sequence searching for the analysis of massive data sets</article-title>. <source>Nat Biotechnol</source>. <year>2017</year>;<volume>35</volume>(<issue>11</issue>):<fpage>1026</fpage>–<lpage>1028</lpage>.<pub-id pub-id-type="pmid">29035372</pub-id></mixed-citation>
    </ref>
    <ref id="jkac233-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zimmermann</surname><given-names>L</given-names></string-name>, <string-name><surname>Stephens</surname><given-names>A</given-names></string-name>, <string-name><surname>Nam</surname><given-names>S-Z</given-names></string-name>, <string-name><surname>Rau</surname><given-names>D</given-names></string-name>, <string-name><surname>Kübler</surname><given-names>J</given-names></string-name>, <string-name><surname>Lozajic</surname><given-names>M</given-names></string-name>, <string-name><surname>Gabler</surname><given-names>F</given-names></string-name>, <string-name><surname>Söding</surname><given-names>J</given-names></string-name>, <string-name><surname>Lupas</surname><given-names>AN</given-names></string-name>, <string-name><surname>Alva</surname><given-names>V</given-names></string-name></person-group>, <etal>et al</etal><article-title>A completely reimplemented MPI bioinformatics toolkit with a new HHpred server at its core</article-title>. <source>J Mol Biol</source>. <year>2018</year>;<volume>430</volume>(<issue>15</issue>):<fpage>2237</fpage>–<lpage>2243</lpage>.<pub-id pub-id-type="pmid">29258817</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
