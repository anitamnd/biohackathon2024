<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10088256</article-id>
    <article-id pub-id-type="publisher-id">2902</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-023-02902-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PhyloMed: a phylogeny-based test of mediation effect in microbiome</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Hong</surname>
          <given-names>Qilin</given-names>
        </name>
        <address>
          <email>qhong8@wisc.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Guanhua</given-names>
        </name>
        <address>
          <email>gchen25@wisc.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3802-8087</contrib-id>
        <name>
          <surname>Tang</surname>
          <given-names>Zheng-Zheng</given-names>
        </name>
        <address>
          <email>tang@biostat.wisc.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.14003.36</institution-id><institution-id institution-id-type="ISNI">0000 0001 2167 3675</institution-id><institution>Department of Biostatistics and Medical Informatics, </institution><institution>University of Wisconsin-Madison, </institution></institution-wrap>Madison, WI 53715 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>72</elocation-id>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>7</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>3</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Microbiome data from sequencing experiments contain the relative abundance of a large number of microbial taxa with their evolutionary relationships represented by a phylogenetic tree. The compositional and high-dimensional nature of the microbiome mediator challenges the validity of standard mediation analyses. We propose a phylogeny-based mediation analysis method called PhyloMed to address this challenge. Unlike existing methods that directly identify individual mediating taxa, PhyloMed discovers mediation signals by analyzing subcompositions defined on the phylogenic tree. PhyloMed produces well-calibrated mediation test <italic>p</italic>-values and yields substantially higher discovery power than existing methods.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13059-023-02902-3.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Composite null hypothesis</kwd>
      <kwd>Mediation analysis</kwd>
      <kwd>Microbiome</kwd>
      <kwd>Phylogenetic tree</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>NIH</institution>
        </funding-source>
        <award-id>R01GM140464</award-id>
        <principal-award-recipient>
          <name>
            <surname>Tang</surname>
            <given-names>Zheng-Zheng</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>NSF</institution>
        </funding-source>
        <award-id>DMS-2054346</award-id>
        <principal-award-recipient>
          <name>
            <surname>Chen</surname>
            <given-names>Guanhua</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100001395</institution-id>
            <institution>Wisconsin Alumni Research Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>Data Science Initiative Award</award-id>
        <principal-award-recipient>
          <name>
            <surname>Tang</surname>
            <given-names>Zheng-Zheng</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Center for Demography of Health and Aging, University of Wisconsin-Madison</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">Recent studies suggest that the human microbiome is emerging as a crucial mediator between treatments (or exposures) and health outcomes. For example, gut microbes are found to greatly influence the potency of immunotherapy and some chemotherapies with immunostimulatory functions in the treatments for cancer [<xref ref-type="bibr" rid="CR1">1</xref>]. Mediation analysis provides the statistical framework to investigate if a treatment or exposure affects an outcome through a mediator. The traditional meditation analysis studies the mediation effect of a single mediator [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>]. More recent developments have extended that to multiple and even high-dimensional mediators [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR8">8</xref>]. A causal interpretation of the mediation effect can be established based on the potential outcomes framework for causal inference [<xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR11">11</xref>].</p>
    <p id="Par3">Microbiome data from sequencing experiments contain the relative abundance of a large number of different microbes. The compositional and high-dimensional nature of the microbiome mediator poses a significant challenge to traditional mediation analyses. A typical amplicon sequencing study generates hundreds of microbial taxonomic units, such as operational taxonomic units (OTUs) [<xref ref-type="bibr" rid="CR12">12</xref>] and amplicon sequence variants (ASVs) [<xref ref-type="bibr" rid="CR13">13</xref>]. The abundance of each taxon is essentially measured in a fraction. We just know what percent of each taxon made up the total but cannot quantify the actual microbial load (i.e., absolute abundance). In differential abundance analysis, where microbial compositions are compared between samples, methods that do not account for compositionality can result in high false discovery rates [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR15">15</xref>]. Several composition-aware methods compare the ratio of taxa as the bias introduced by unknown microbial load cancels out after taking the ratios between taxa [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR16">16</xref>].</p>
    <p id="Par4">MedTest [<xref ref-type="bibr" rid="CR17">17</xref>] and MODIMA [<xref ref-type="bibr" rid="CR18">18</xref>] are two distance-based methods for testing the mediation effect of the entire microbial community. These methods summarize the microbial composition into between-sample distance matrices and construct the mediation test statistic using the distance matrices. Therefore, they are not designed to identify mediating taxa. The distance-based tests can achieve good power when many microbial taxa in the community mediate the treatment effect on the outcome. However, their power is limited when the number of mediating taxa is small. LDM-med [<xref ref-type="bibr" rid="CR19">19</xref>] tests the mediation effect at individual taxa using the relative abundance and combine test statistics across taxa to produce a global test. False discovery rate (FDR)-controlling procedures are applied to identify mediating taxa.</p>
    <p id="Par5">Other mediation analysis methods for microbiome data assume sparse mediation effects and estimate the effects via regularization [<xref ref-type="bibr" rid="CR20">20</xref>–<xref ref-type="bibr" rid="CR23">23</xref>]. They aim to select mediating taxa and some [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>] provide global tests of the overall mediation effect at the community level. These methods apply different treatments to handle compositional data. CMM [<xref ref-type="bibr" rid="CR20">20</xref>] uses the composition operators to define the mediation model with the parameters interpreted under the additive log-ratio transformation; microHIMA [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR23">23</xref>] uses the isometric log-ratio to transform the relative abundance to variables in the Euclidean space; SparseMCMM [<xref ref-type="bibr" rid="CR20">20</xref>] uses the Dirichlet regression to model microbial compositions. These methods also employ different mediation tests. CMM uses a Sobel-type test [<xref ref-type="bibr" rid="CR24">24</xref>]; microHIMA uses a joint-significance-type test [<xref ref-type="bibr" rid="CR25">25</xref>]; SparseMCMM includes two tests: one uses the overall mediation effect estimate as the test statistic and the other uses the sum of squares of the component-wise mediation effect estimates as the test statistic [<xref ref-type="bibr" rid="CR7">7</xref>], both of which have conservative control of type I error reported in the original paper [<xref ref-type="bibr" rid="CR21">21</xref>].</p>
    <p id="Par6">In this article, we develop a phylogeny-based mediation analysis method (PhyloMed) for the high-dimensional mediator of microbial composition. Microbial taxa are evolutionarily related and their relationship is represented by a phylogenetic tree. Incorporating phylogenetic information has been shown to improve the performance of various statistical analyses [<xref ref-type="bibr" rid="CR26">26</xref>–<xref ref-type="bibr" rid="CR28">28</xref>]. PhyloMed models the microbiome mediation effect through a cascade of independent local mediation models of subcompositions on the internal nodes of the phylogenetic tree. Figure <xref rid="Fig1" ref-type="fig">1</xref> shows an example of a simple rooted binary phylogenetic tree with 11 microbial taxa at leaf nodes and 10 internal nodes, representing the common ancestors of those taxa. The subcomposition on an internal node consists of the relative abundance aggregated at its two child nodes. For example, the highlighted <italic>j</italic>th internal node in Fig. <xref rid="Fig1" ref-type="fig">1</xref> has taxon 5 being its left child node and the most recent common ancestor of taxa 6 and 7 being its right child node. Therefore, the subcomposition defined on that internal node consists of <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(M_{j}, 1-M_{j})$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq1.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_{j} = \frac{v_5}{v_5 + v_6 + v_7}$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>v</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>7</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq2.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_5$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mi>v</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq3.gif"/></alternatives></inline-formula>, <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_6$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>v</mml:mi><mml:mn>6</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq4.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_7$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mi>v</mml:mi><mml:mn>7</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq5.gif"/></alternatives></inline-formula> are relative abundances of taxa 5, 6, and 7. As depicted in Fig. <xref rid="Fig1" ref-type="fig">1</xref> and detailed in the “<xref rid="Sec10" ref-type="sec">Methods</xref>” section, on each internal node of the phylogenetic tree, we propose to construct a local subcomposition mediation model using the log ratio of the abundance on the left and right child nodes (i.e., <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\log (\frac{M_j}{1-M_j})$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mo>log</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:msub><mml:mi>M</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq6.gif"/></alternatives></inline-formula>) as the mediator variable.<fig id="Fig1"><label>Fig. 1</label><caption><p>Example phylogenetic tree and causal path diagram of a local mediation model. The <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_1$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq7.gif"/></alternatives></inline-formula>-<inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_{11}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>v</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq8.gif"/></alternatives></inline-formula> are relative abundances of the taxa on leave nodes. PhyloMed considers subcompositions at every internal node of the phylogenetic tree and tests the mediation effect of the subcompositions</p></caption><graphic xlink:href="13059_2023_2902_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par7">We develop a testing procedure to ensure the PhyloMed local mediation test <italic>p</italic>-values are asymptotically mutually independent and uniformly distributed under the global null hypothesis that no mediation effect in any of the internal nodes (<xref rid="Sec10" ref-type="sec">Methods</xref>). We apply a FDR-controlling procedure to the local mediation <italic>p</italic>-values and identify mediating internal nodes. The descendants of an identified node represent a group of evolutionarily close taxa that potentially plays a mediating role. Furthermore, we can combine local mediation <italic>p</italic>-values over internal nodes to test the global mediation effect of the entire microbial community. In this article, we employed the Benjamini-Hochberg (BH) procedure [<xref ref-type="bibr" rid="CR29">29</xref>] in identifying mediating internal nodes and the harmonic mean <italic>p</italic>-value (HMP) combination method [<xref ref-type="bibr" rid="CR30">30</xref>] in the global mediation test.</p>
    <p id="Par8">PhyloMed models mediation effects in many subcompositions on the phylogenetic tree rather than in a full composition with many taxa at the low taxonomic rank. There are several advantages of working with subcomposition mediation models. First, it avoids the difficulty of jointly modeling a large number of microbial taxa. Second, the descendants of each internal node share a certain degree of evolutionary affinity and tend to have similar biological functions. Therefore, mediating taxa are likely to cluster on the tree, and PhyloMed can potentially enrich mediation signal and improve the power of mediation analysis. Third, as we explain next, the large number of independent subcomposition mediation models enables us to obtain well-calibrated mediation test <italic>p</italic>-values and boost discovery power.</p>
    <p id="Par9">In each local model of PhyloMed, we test the mediation effect of a subcomposition in the treatment-to-outcome pathway. The mediation effect is commonly expressed as a product of two parameters, the treatment-mediator association (<inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M18"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq9.gif"/></alternatives></inline-formula>) and the mediator-outcome association (<inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M20"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq10.gif"/></alternatives></inline-formula>) conditional on the treatment. The null hypothesis of no mediation effect is composite: either one of those associations is zero or both are zeros (<inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{00}: \alpha =\beta =0$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq11.gif"/></alternatives></inline-formula> or <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{10}: \alpha \ne 0, \beta =0$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mi>α</mml:mi><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq12.gif"/></alternatives></inline-formula> or <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{01}: \alpha =0, \beta \ne 0$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq13.gif"/></alternatives></inline-formula>). Traditional tests, such as the Sobel’s test [<xref ref-type="bibr" rid="CR24">24</xref>] and the joint significance test, are overly conservative and yield low power because they ignore the composite nature of the null hypothesis [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR31">31</xref>]. To address this problem, we estimate the proportions of different nulls (<inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{00}, H_{10}, H_{01}$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq14.gif"/></alternatives></inline-formula>) among all the local mediation models and obtain the subcomposition mediation test <italic>p</italic>-value using a mixture distribution with three components, each corresponding to one type of null hypothesis (<xref rid="Sec10" ref-type="sec">Methods</xref>). A large number of independent subcomposition mediation tests enables us to accurately estimate the proportions of different nulls. Therefore, the high-dimensionality of microbiome data becomes a blessing instead of a curse in PhyloMed.</p>
    <p id="Par10">One needs to be cautious about the separation of the treatment-mediator associational element and mediator-outcome associational element when interpreting the mediation signals identified from the microbiome data. The mediation effect at the ancestor taxon can be formed by aggregating lower-level taxa associated with only the treatment and lower-level taxa associated with only the outcome (i.e., the separation of two elements demonstrated in the last column of Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). Therefore, if we want to extend the interpretation of mediation signal (discovered by PhyloMed or any other methods) from the upper level to the lower level, we need to assume that at least one descendant at the lower level has inherent the mediation effect from the mediating ancestor (i.e., no complete separation of the two elements demonstrated in the third column of Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). In PhyloMed, we test the mediation effects at internal nodes but not at the leaf-level taxa. We show in the real data application a heuristic approach to investigate the mediation effect at few leaf-level taxa under the PhyloMed-identified internal nodes.</p>
    <p id="Par11">The separation of the two elements can occur even when we analyze taxa at one taxonomic level because of the compositional nature of the microbiome mediator. The relative abundances of all taxa are linked because of the unit-sum constraint of the proportions across taxa: changing the absolute abundance of one taxon would shift the relative abundance of all other taxa. Consequently, if a taxon is identified as a mediator using its relative abundance in the mediation model, the two elements contributing to the mediation signal may come from entirely different sets of taxa. To address compositionality, many methods assume the mediation signal is sparse and apply different transformations to the relative abundance. The mediation effects are defined and interpreted in the context of a particular treatment of the compositional data. We need the assumption of no complete separation of the two elements in absolute abundance if we want to extend the interpretion of the identified mediation signal to the absolute abundance level. This is probably a reason why many mediation methods for microbiome data focus more on hypothesis testing than estimation. The test results provide a scan of high-dimensional microbial composition and generate candidates for downstream validation studies and mechanistic experiments.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Simulation studies</title>
      <p id="Par12">We performed extensive simulation studies to evaluate the performance of PhyloMed under different settings. The simulation strategy is detailed in <xref rid="Sec10" ref-type="sec">Methods</xref>. In short, we used the top 100 most abundant OTUs and the phylogenetic tree from a real gut microbiome study [<xref ref-type="bibr" rid="CR32">32</xref>] as a basis. We considered the sample size of 50 or 200, a binary treatment variable that defines a treatment and a control group, and two types of outcome variables (continuous and binary). Association and mediation signals were added at the OTUs. We let <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}_\alpha$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq15.gif"/></alternatives></inline-formula> and <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}_\beta$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>β</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq16.gif"/></alternatives></inline-formula> denote the set of treatment-associated OTUs and outcome-associated OTUs, respectively. To perturb the abundance of a treatment-associated OTU, we added random counts to the subjects in the treatment or control group. To generate values of outcome, we used the log-contrast model [<xref ref-type="bibr" rid="CR33">33</xref>] with the outcome-associated OTUs as covariates. Under the null hypothesis of no mediation effect, the <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}_\alpha$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq17.gif"/></alternatives></inline-formula> and <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}_\beta$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>β</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq18.gif"/></alternatives></inline-formula> do not overlap, and we considered different mixtures of nulls by adjusting the OTUs in the two sets. Under the alternative, both sets contain the mediating OTUs. We varied the number of mediating OTUs and made them clustered on the tree or randomly scattered.</p>
      <sec id="Sec4">
        <title>PhyloMed controls type I error and improves power in the global mediation test of the microbial community</title>
        <p id="Par13">PhyloMed local mediation test statistic is constructed as the maximum of the treatment-mediator association test <italic>p</italic>-value and the mediator-outcome association test <italic>p</italic>-value (<xref rid="Sec10" ref-type="sec">Methods</xref>). We obtain these <italic>p</italic>-values via asymptotic approximation or permutation (<xref rid="Sec10" ref-type="sec">Methods</xref>) and refer to the corresponding PhyloMed result as PhyloMed.A and PhyloMed.P. We compared the performance of PhyloMed global mediation test with the global tests in MedTest [<xref ref-type="bibr" rid="CR17">17</xref>], MODIMA [<xref ref-type="bibr" rid="CR18">18</xref>], LDM-med [<xref ref-type="bibr" rid="CR19">19</xref>], and CMM [<xref ref-type="bibr" rid="CR20">20</xref>]. For the distance-based tests, we considered Aitchison, Bray-Curtis, Jaccard, weighted, and unweighted UniFrac distances. We reported the omnibus MedTest test over the five distances. As MODIMA does not provide an omnibus test, we reported the Bonferroni-corrected minimal <italic>p</italic>-values among the five distances. The CMM method is for the continuous outcome. We found that CMM often fails to converge when the sample size is smaller than the number of taxa. Therefore, the CMM result is only reported in the setting of continuous outcome and large sample size (<inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n=200$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq19.gif"/></alternatives></inline-formula>).</p>
        <p id="Par14">The control of the type I error is demonstrated by the quantile-quantile plots of <italic>p</italic>-values from different global tests under various null hypothesis settings (Fig. <xref rid="Fig2" ref-type="fig">2</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2). The PhyloMed global test yields <italic>p</italic>-values that are mostly aligned with the diagonal line suggesting that the test produces uniformly distributed <italic>p</italic>-values under the null hypothesis of no mediation effect. The empirical type I error of PhyloMed is much closer to the significance level than the other methods in all scenarios (Table <xref rid="Tab1" ref-type="table">1</xref>). The permutation version of PhyloMed (PhyloMed.P) controls type I error slightly better than the asymptotic version (PhyloMed.A) when the sample size is small (<inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n=50$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq20.gif"/></alternatives></inline-formula>). MedTest, MODIMA, and LDM-med tests are generally conservative. When all taxa are under <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{00}$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mi>H</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq21.gif"/></alternatives></inline-formula>, their conservativeness is worse than in other scenarios where some taxa are under <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{10}$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mi>H</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq22.gif"/></alternatives></inline-formula> or <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{01}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>H</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq23.gif"/></alternatives></inline-formula>. In contrast, the performance of the PhyloMed global test is less affected by the mixture proportions of different nulls. The CMM test is too liberal and results in many false positives in our simulation study.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Empirical type I error of different global mediation tests (significance level = 0.05). The<inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|\mathcal {S}_\alpha |$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq24.gif"/></alternatives></inline-formula>and<inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|\mathcal {S}_\beta |$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>β</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq25.gif"/></alternatives></inline-formula>denote the number of treatment-associated OTUs and outcome-associated OTUs, respectively. Different combinations of (<inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|\mathcal {S}_\alpha |$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq26.gif"/></alternatives></inline-formula>,<inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|\mathcal {S}_\beta |$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>β</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq27.gif"/></alternatives></inline-formula>) represent different mixtures of mediation nulls<inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{00}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mi>H</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq28.gif"/></alternatives></inline-formula>,<inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{10}$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mi>H</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq29.gif"/></alternatives></inline-formula>and<inline-formula id="IEq30"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{01}$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mi>H</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq30.gif"/></alternatives></inline-formula></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><italic>n</italic></th><th align="left"><inline-formula id="IEq31"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|\mathcal {S}_{\alpha }|$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq31.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq32"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|\mathcal {S}_{\beta }|$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>β</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq32.gif"/></alternatives></inline-formula></th><th align="left">PhyloMed.A</th><th align="left">PhyloMed.P</th><th align="left">MedTest</th><th align="left">MODIMA</th><th align="left">LDM-med</th><th align="left">CMM</th></tr></thead><tbody><tr><td align="left" colspan="9"><bold>Continuous outcome</bold></td></tr><tr><td align="left">50</td><td align="left">0</td><td align="left">0</td><td align="left">0.020</td><td align="left">0.028</td><td align="left">0.002</td><td align="left">0.002</td><td align="left">0.005</td><td align="left">-</td></tr><tr><td align="left">50</td><td align="left">3</td><td align="left">0</td><td align="left">0.021</td><td align="left">0.028</td><td align="left">0.013</td><td align="left">0.007</td><td align="left">0.006</td><td align="left">-</td></tr><tr><td align="left">50</td><td align="left">6</td><td align="left">0</td><td align="left">0.036</td><td align="left">0.042</td><td align="left">0.025</td><td align="left">0.009</td><td align="left">0.009</td><td align="left">-</td></tr><tr><td align="left">50</td><td align="left">0</td><td align="left">3</td><td align="left">0.021</td><td align="left">0.025</td><td align="left">0.003</td><td align="left">0.002</td><td align="left">0.009</td><td align="left">-</td></tr><tr><td align="left">50</td><td align="left">0</td><td align="left">6</td><td align="left">0.024</td><td align="left">0.028</td><td align="left">0.011</td><td align="left">0.003</td><td align="left">0.016</td><td align="left">-</td></tr><tr><td align="left">200</td><td align="left">0</td><td align="left">0</td><td align="left">0.022</td><td align="left">0.024</td><td align="left">0.001</td><td align="left">0.000</td><td align="left">0.002</td><td align="left">0.308</td></tr><tr><td align="left">200</td><td align="left">3</td><td align="left">0</td><td align="left">0.030</td><td align="left">0.032</td><td align="left">0.022</td><td align="left">0.008</td><td align="left">0.013</td><td align="left">0.495</td></tr><tr><td align="left">200</td><td align="left">6</td><td align="left">0</td><td align="left">0.035</td><td align="left">0.036</td><td align="left">0.032</td><td align="left">0.023</td><td align="left">0.015</td><td align="left">0.532</td></tr><tr><td align="left">200</td><td align="left">0</td><td align="left">3</td><td align="left">0.032</td><td align="left">0.034</td><td align="left">0.015</td><td align="left">0.006</td><td align="left">0.017</td><td align="left">0.210</td></tr><tr><td align="left">200</td><td align="left">0</td><td align="left">6</td><td align="left">0.040</td><td align="left">0.043</td><td align="left">0.028</td><td align="left">0.015</td><td align="left">0.021</td><td align="left">0.154</td></tr><tr><td align="left" colspan="9"><bold>Binary outcome</bold></td></tr><tr><td align="left">50</td><td align="left">0</td><td align="left">0</td><td align="left">0.017</td><td align="left">0.020</td><td align="left">0.000</td><td align="left">0.000</td><td align="left">0.004</td><td align="left">-</td></tr><tr><td align="left">50</td><td align="left">3</td><td align="left">0</td><td align="left">0.028</td><td align="left">0.033</td><td align="left">0.011</td><td align="left">0.002</td><td align="left">0.010</td><td align="left">-</td></tr><tr><td align="left">50</td><td align="left">6</td><td align="left">0</td><td align="left">0.029</td><td align="left">0.037</td><td align="left">0.023</td><td align="left">0.011</td><td align="left">0.012</td><td align="left">-</td></tr><tr><td align="left">50</td><td align="left">0</td><td align="left">3</td><td align="left">0.021</td><td align="left">0.031</td><td align="left">0.002</td><td align="left">0.000</td><td align="left">0.006</td><td align="left">-</td></tr><tr><td align="left">50</td><td align="left">0</td><td align="left">6</td><td align="left">0.018</td><td align="left">0.029</td><td align="left">0.004</td><td align="left">0.002</td><td align="left">0.007</td><td align="left">-</td></tr><tr><td align="left">200</td><td align="left">0</td><td align="left">0</td><td align="left">0.018</td><td align="left">0.021</td><td align="left">0.002</td><td align="left">0.000</td><td align="left">0.003</td><td align="left">-</td></tr><tr><td align="left">200</td><td align="left">3</td><td align="left">0</td><td align="left">0.043</td><td align="left">0.044</td><td align="left">0.025</td><td align="left">0.011</td><td align="left">0.009</td><td align="left">-</td></tr><tr><td align="left">200</td><td align="left">6</td><td align="left">0</td><td align="left">0.040</td><td align="left">0.040</td><td align="left">0.030</td><td align="left">0.016</td><td align="left">0.018</td><td align="left">-</td></tr><tr><td align="left">200</td><td align="left">0</td><td align="left">3</td><td align="left">0.024</td><td align="left">0.028</td><td align="left">0.008</td><td align="left">0.002</td><td align="left">0.005</td><td align="left">-</td></tr><tr><td align="left">200</td><td align="left">0</td><td align="left">6</td><td align="left">0.038</td><td align="left">0.045</td><td align="left">0.018</td><td align="left">0.007</td><td align="left">0.011</td><td align="left">-</td></tr></tbody></table></table-wrap></p>
        <p id="Par15">
          <fig id="Fig2">
            <label>Fig. 2</label>
            <caption>
              <p>Quantile-quantile plots of <italic>p</italic>-values from different global mediation tests in the simulation study for the continuous outcome. The observed <italic>p</italic>-values were compared to the expected quantiles generated by the uniform null distribution. The <inline-formula id="IEq33"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|\mathcal {S}_\alpha |$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq33.gif"/></alternatives></inline-formula> and <inline-formula id="IEq34"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|\mathcal {S}_\beta |$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>β</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq34.gif"/></alternatives></inline-formula> denote the number of treatment-associated OTUs and outcome-associated OTUs, respectively. Different combinations of (<inline-formula id="IEq35"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|\mathcal {S}_\alpha |$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq35.gif"/></alternatives></inline-formula>, <inline-formula id="IEq36"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|\mathcal {S}_\beta |$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>β</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq36.gif"/></alternatives></inline-formula>) represent different mixtures of mediation nulls <inline-formula id="IEq37"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{00}$$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mi>H</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq37.gif"/></alternatives></inline-formula>, <inline-formula id="IEq38"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{10}$$\end{document}</tex-math><mml:math id="M76"><mml:msub><mml:mi>H</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq38.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq39"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{01}$$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mi>H</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq39.gif"/></alternatives></inline-formula></p>
            </caption>
            <graphic xlink:href="13059_2023_2902_Fig2_HTML" id="MO2"/>
          </fig>
        </p>
        <p id="Par16">Figure <xref rid="Fig3" ref-type="fig">3</xref> displays the power results under the setting where the mediating OTUs are clustered on the tree. PhyloMed is more powerful than MedTest, MODIMA, and LDM-med. PhyloMed is also more powerful than CMM, even though CMM’s power is overestimated due to the inflation of its type I error. The power gain is because PhyloMed tests subcompositions on the ancestor nodes of mediating OTUs, at which mediation signals were condensed. Moreover, PhyloMed employs the mixture distribution in testing the subcomposition mediation effect, which is more efficient than traditional mediation tests. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3 displays the power results when including more OTUs in the simulation. In this case, all methods become less powerful, but the power of PhyloMed remains the highest. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4 displays the power results when the mediating OTUs are randomly scattered. PhyloMed still has a substantial power gain over other methods in most scenarios, especially when the mediation signal is sparse.<fig id="Fig3"><label>Fig. 3</label><caption><p>Power comparison of different global mediation tests when mediating OTUs are clustered on the tree</p></caption><graphic xlink:href="13059_2023_2902_Fig3_HTML" id="MO3"/></fig></p>
      </sec>
      <sec id="Sec5">
        <title>PhyloMed powerfully detects microbial subcompositions with mediation effects</title>
        <p id="Par17">We also evaluated the empirical FDR and power in identifying mediating nodes on the tree at the target FDR of 0.05. All the ancestor nodes of the mediating OTUs are mediating nodes. To evaluate power, we focused on the discovery rate of identifying the most recent common ancestor of the mediating OTUs because the signal on the upper-level ancestor nodes was diluted by the OTUs with no mediation effects and is difficult to detect by any method. Besides the mixture-distribution-based test implemented in PhyloMed, we employed the Sobel’s test and the joint significance test to obtain the <italic>p</italic>-value for testing the subcomposition mediation effect in each local model.</p>
        <p id="Par18">In detecting mediating nodes, the empirical FDR is controlled for all local mediation tests (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). We also evaluate the empirical FDR with varying mediation signal strength and density. The empirical FDR is controlled for all signal strength and density levels, even though BH controls the FDR at a more stringent level for stronger and denser signals (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5). Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2 shows the discovery rate of the most recent common ancestor of the mediating OTUs. PhyloMed has much higher power than the Sobel’s test and the joint significance test in identifying the mediating node.</p>
      </sec>
    </sec>
    <sec id="Sec6">
      <title>Application of PhyloMed to study the mediation of mouse cecal microbiome in the relationship between antibiotics treatment and body fat</title>
      <p id="Par19">We demonstrate the utility of PhyloMed by analyzing a cecal microbiome dataset from a randomized mouse experiment [<xref ref-type="bibr" rid="CR34">34</xref>]. The study randomly assigned mice to four types of antibiotics and a control group and evaluated the group difference in body fat percentage and cecal microbial composition. The mice in the antibiotics group have a higher average body fat percentage than those in the control group (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6). We are interested in investigating if the cecal microbiome mediates the effect of antibiotics on body fat. After removing samples with low sequencing depth, we had 48 samples (38 in antibiotics and 10 in controls). Due to the small sample size of this study, we included in the analysis the top 100 most abundant OTUs with at least 20% non-zero observations as potential mediators. These taxa make up 80% of the cecal microbial composition.</p>
      <p id="Par20">The PhyloMed global mediation test (PhyloMed.P) gives a <italic>p</italic>-value of 0.085. MedTest, MODIMA, and LDM-med global tests give <italic>p</italic>-values of 0.24, 1, and 0.42. PhyloMed also pinpoints two internal nodes with significant mediation effects on the phylogenetic tree while controlling FDR at 0.1. When we employed the Sobel’s test and the joint significance test in local models, the subcomposition mediation test <italic>p</italic>-values showed a pattern of deflation, suggesting low power (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b), and no mediating nodes were identified. We also applied LDM-med and microHIMA to identify mediating OTUs and no OTU was selected at FDR = 0.1.<fig id="Fig4"><label>Fig. 4</label><caption><p>Analysis of mouse cecal microbiome data. <bold>a</bold> Phylogenetic tree with the size of the circle at each internal node proportional to <inline-formula id="IEq40"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\log 10$$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:mo>-</mml:mo><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq40.gif"/></alternatives></inline-formula> (PhyloMed local mediation test <italic>p</italic>-value). The identified internal node with the minimum subcomposition mediation test <italic>p</italic>-value and the subtree under the node are highlighted in a blue rectangle. <bold>b</bold> Quantile-quantile plots of different subcomposition mediation test <italic>p</italic>-values across internal nodes. PhyloMed: proposed mixture-distribution-based test; JS: joint significance test; Sobel: Sobel’s test. <bold>c</bold> Associations of the subcomposition (in log-ratio) at the highlighted node in <bold>a</bold> with the treatment and the body fat percentage after adjusting for the treatment effect. <bold>d</bold> The highlighted subtree in <bold>a</bold>. Pair the OTU under the left child node to each of the five OTUs under the right child node. For the subcomposition of each pair, examine the treatment-subcomposition and subcomposition-outcome associations and report the maximum <italic>p</italic>-value of the two associations</p></caption><graphic xlink:href="13059_2023_2902_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par21">It is instructive to examine the internal node with the smallest PhyloMed local mediation <italic>p</italic>-value. This node has an OTU as its left child node and the most recent common ancestor of the other five OTUs as its right child node (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). The proportion of the abundance at the left child node to the right child node is significantly associated with the antibiotics treatment and the body fat (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c). The OTU descendants of the node are a group of evolutionarily close taxa that likely share similar biological functions and jointly contribute to the mechanism of antibiotics’ effect on body fat change.</p>
      <p id="Par22">We used a heuristic approach to explore what OTU descendants may contribute to the significant subcomposition mediation on that internal node. In particular, we constructed multiple subcompositions by pairing the OTU at the left child node with individual OTU descendants of the right child node and examined the treatment-subcomposition and subcomposition-outcome associations. All the (left OTU and right OTU) pairs exhibit evidence of mediation effect (the maximum <italic>p</italic>-values of the treatment-subcomposition and subcomposition-outcome associations for all the pairs are less than 0.05, see Fig. <xref rid="Fig4" ref-type="fig">4</xref>d). This result demonstrates that testing the mediation effect on the internal node of the phylogenetic tree can enrich mediation signals clustered on the tree and boost the power of mediation analysis.</p>
    </sec>
    <sec id="Sec7">
      <title>Application of PhyloMed to study the mediation of human gut microbiome in the relationship between fat intake and body mass index</title>
      <p id="Par23">We also applied PhyloMed to a human gut microbiome dataset from an observational study with a larger sample size [<xref ref-type="bibr" rid="CR35">35</xref>]. The study sequenced gut microbiome from fecal samples of 96 healthy subjects and collected their diet and health information. The subjects with higher fat intake generally have higher body mass index (BMI) values (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7). We used PhyloMed to investigate if the gut microbiome mediates the effect of fat intake on BMI increase. We used 395 OTUs that have at least 20% non-zero observations. These OTUs make up 79% of the microbial community composition. Total calorie intake was adjusted as a potential confounder in the mediation analysis.</p>
      <p id="Par24">The PhyloMed global mediation test (PhyloMed.P) gives a <italic>p</italic>-value of 0.047, indicating the gut microbial community plays a mediating role in the effect of fat intake on BMI increment. MedTest, MODIMA, and LDM-med global tests give <italic>p</italic>-values of 0.68, 0.27, and 1. PhyloMed identifies one internal node with significant mediation effects while controlling FDR at 0.1 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8). The left and right child nodes of the identified internal node are leaf nodes with two OTUs in the <italic>Lachnospiraceae</italic> family. It has been reported that members of the <italic>Lachnospiraceae</italic> family are associated with high-fat diets and diet-induced obesity [<xref ref-type="bibr" rid="CR36">36</xref>, <xref ref-type="bibr" rid="CR37">37</xref>]. Subjects with low fat intake and BMI show dramatically different proportions of the two OTUs compared to those with higher fat intake and BMI (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). The log-ratio abundance between the two OTUs is significantly associated with fat intake (<italic>p</italic>-value=<inline-formula id="IEq41"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5.9 \times 10^{-3}$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mn>5.9</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq41.gif"/></alternatives></inline-formula>) and BMI (<italic>p</italic>-value=<inline-formula id="IEq42"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2.2\times 10^{-3}$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mn>2.2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq42.gif"/></alternatives></inline-formula>). No mediating OTU was identified by LDM-med and microHIMA at FDR = 0.1. The analysis demonstrates that PhyloMed can detect the sparse mediation signal among a large number of taxa, which is often missed by other methods.<fig id="Fig5"><label>Fig. 5</label><caption><p>Scatter pie plot for the subcomposition at the identified internal node in human gut microbiome data analysis. Each point is a pie chart showing a subject’s subcomposition of the two OTUs under the identified internal node. The fat intake value (after adjusting for total calorie intake) is on the <italic>x</italic>-axis and the BMI value (after adjusting for fat intake and total calorie intake) is on the <italic>y</italic>-axis</p></caption><graphic xlink:href="13059_2023_2902_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Discussion</title>
    <p id="Par25">This article has introduced a new framework PhyloMed for testing the mediation effect in high-dimensional microbial composition. PhyloMed leverages the hierarchical phylogeny relationship among different microbial taxa to decompose the complex mediation model on the full microbial composition into multiple simple independent local mediation models on subcompositions. This tree-guided approach effectively enriches mediation signals that tend to cluster on the phylogenetic tree and boosts the power of the test for weak mediation effects among taxa. Moreover, PhyloMed accounts for the compositional nature of the relative abundance data and the composite mediation null hypothesis, resulting in well-calibrated <italic>p</italic>-values for testing local subcomposition mediation effects. Our simulation studies have shown that PhyloMed properly controls the type I error and has substantially higher power than existing methods. In addition, PhyloMed can pinpoint internal nodes at which the subcompositions have significant mediation effects. The cluster of descendant taxa under the identified node could serve as the top candidate mediating taxa for future biological validation.</p>
    <p id="Par26">Many <italic>p</italic>-value combination methods and FDR-controlling procedures can be applied to the local mediation <italic>p</italic>-values to test global mediation and identify mediating internal nodes. In this article, we adopt the HMP <italic>p</italic>-value combination method that is powerful to detect the sparse signal. If the mediation signal is dense (i.e., many taxa in the microbial community have mediation effects), alternative methods such as Fisher’s <italic>p</italic>-value combination method could be more powerful. In addition, advanced FDR methods [<xref ref-type="bibr" rid="CR38">38</xref>–<xref ref-type="bibr" rid="CR40">40</xref>] may yield better performance in detecting mediating subcompositions on the internal nodes if mediation hypotheses defined on the nearby nodes are more likely to be jointly true or false. Evaluating these different methods under the PhyloMed framework would be an interesting area for future research.</p>
    <p id="Par27">PhyloMed uses the observed proportion data and does not model the sampling variability of the read counts. A Binomial sampling layer could be added on top of each subcomposition model. However, the benefit of this practice may not outweigh the drawbacks. Although the mediation model can be changed without disrupting the PhyloMed testing procedure, it is not clear if the parameter we test still reflects the size of the causal mediation effect. Even if this is true, modeling the count data would increase the computation burden and may not readily improve the numerical performance of PhyloMed. We have considered replacing the log-ratio subcomposition model in PhyloMed with the Beta-binomial model [<xref ref-type="bibr" rid="CR41">41</xref>] and a distribution-free model for the composition count data [<xref ref-type="bibr" rid="CR27">27</xref>]. The resulting global mediation tests based on these two alternative mediator models do not yield a better type I error control (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3).</p>
    <p id="Par28">The assumption of no unmeasured confounding is critical in obtaining an unbiased estimate of the mediation effect and establishing the causal interpretation in mediation analysis. The correlation <inline-formula id="IEq43"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho$$\end{document}</tex-math><mml:math id="M86"><mml:mi>ρ</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq43.gif"/></alternatives></inline-formula> between the residuals of the mediator regression model and the outcome regression model is often used to quantify the magnitude of confounding bias on the mediation effect estimate with <inline-formula id="IEq44"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho = 0$$\end{document}</tex-math><mml:math id="M88"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq44.gif"/></alternatives></inline-formula> implying no confounding bias [<xref ref-type="bibr" rid="CR11">11</xref>]. Therefore, a common way to examine the sensitivity of finding to the violation of the assumption is to evaluate how the mediation effect estimate changes when <inline-formula id="IEq45"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|\rho |$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq45.gif"/></alternatives></inline-formula> deviates from zero [<xref ref-type="bibr" rid="CR11">11</xref>]. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S9 displays the sensitivity analysis results for the identified mediating nodes highlighted in Fig. <xref rid="Fig4" ref-type="fig">4</xref>a and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8 of the two real data analyses. The 90% confidence interval of the estimated mediation effect covers zero when <inline-formula id="IEq46"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|\rho |&gt;0.13$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0.13</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq46.gif"/></alternatives></inline-formula> in the mouse cecal study and <inline-formula id="IEq47"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|\rho |&gt;0.27$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0.27</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq47.gif"/></alternatives></inline-formula> in the human gut study, which means the sign and significance of the estimated mediation effect remain unchanged if <inline-formula id="IEq48"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|\rho |$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq48.gif"/></alternatives></inline-formula> is not beyond those values. In our analyses, the sample residual correlations at the identified nodes are very close to zero with the absolute value smaller than <inline-formula id="IEq49"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^{-16}$$\end{document}</tex-math><mml:math id="M98"><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq49.gif"/></alternatives></inline-formula>, suggesting that we probably do not have a strong confounding bias in our analyses.</p>
    <p id="Par29">Power can be affected if the phylogenetic tree is misspecified. For instance, if the mediation taxa are clustered on the true tree but more scattered on the misspecified tree, signals on the internal nodes may become less condensed and more challenging to detect. Our simulation study shows that PhyloMed is still more powerful than the competing methods when the taxa are randomly scattered on the tree (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4). If the phylogenetic tree is unavailable, PhyloMed can be applied to the taxonomy tree, which is almost always provided in microbiome data. Our R package has incorporated this option.</p>
    <p id="Par30">In this article, we focus on microbiome data from targeted amplicon sequencing rather than metagenomic sequencing. But the ideas of the method can be extended to metagenomics studies. For metagenomics data, multiple phylogenetic trees can be constructed, each based on sequencing data of a set of marker genes. The structures of these trees may differ from one another. One approach is to apply PhyloMed to the data derived from each marker gene and harmonize the results across different tree structures. This may increase the robustness against tree misspecification compared to the analysis using a single tree.</p>
  </sec>
  <sec id="Sec9">
    <title>Conclusions</title>
    <p id="Par31">Elucidating the causal role of the microbiome and identifying mediating microbial agents is an important step toward the development of strategies to manipulate the microbiome to augment desirable health outcomes. A growing number of microbiome studies in recent years have leveraged mediation analysis to discover the causal mediation effect of the microbiome. We develop PhyloMed to combat low statistical power in the microbiome mediation analysis, especially when the mediation signal is sparse and weak. PhyloMed framework builds upon a phylogeny-guided divide-and-conquer strategy to search for the mediation signals in high-dimensional microbial compositions. A new testing procedure is developed to solve the problem of conservativeness in testing the composite mediation null hypothesis. These features of PhyloMed are fundamentally different from existing methods and substantially boost the power of microbiome mediation tests. We envision that PhyloMed will accelerate the discovery of causal mediating microbes and facilitate biological interpretation in the context of phylogenetic trees. As a general methodology, PhyloMed can be applied to the mediation analysis of other high-dimensional compositional data. We have provided an efficient R package for the broad utility of the method.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>PhyloMed framework</title>
      <p id="Par32">We consider a random sample of <italic>n</italic> subjects measured on a set of OTUs. Suppose the OTUs are placed on the leaves of a rooted phylogenetic tree with <italic>J</italic> internal nodes. For subject <inline-formula id="IEq50"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i=1, \ldots , n$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq50.gif"/></alternatives></inline-formula>, we let <inline-formula id="IEq51"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(M_{ij}, 1-M_{ij})$$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq51.gif"/></alternatives></inline-formula> be the subcomposition at the <italic>j</italic>th internal node. In the PhyloMed framework, instead of having a single model on the composition of all leaf-level OTUs, we build a collection of independent local models, each of which is for a subcomposition on a particular internal node of the tree. This modeling approach is similar to a Polya tree process [<xref ref-type="bibr" rid="CR42">42</xref>] and has been adopted by several methods for microbiome differential abundance testing [<xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR43">43</xref>]. Despite the independence of the subcomposition <inline-formula id="IEq52"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_{ij}$$\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq52.gif"/></alternatives></inline-formula>’s over internal nodes, this modeling approach allows a rich dependence structure among leaf-level OTUs [<xref ref-type="bibr" rid="CR44">44</xref>].</p>
      <p id="Par33">We apply the log-ratio transformation to subcomposition and use the log-ratio variable (i.e., <inline-formula id="IEq53"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\log \left( \frac{M_{ij}}{1-M_{ij}}\right)$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq53.gif"/></alternatives></inline-formula>) as the mediator. We need to deal with zeros in the log-ratio transformation. In each local mediation model at an internal node, we remove subjects with both components of the subcomposition being zero as they carry no information on the subcomposition. We add 0.5 to the counts aggregated to the left and right child nodes for the remaining subjects. Although adding a small value (pseudocount) is a simple and commonly used practice to avoid zeros in log transformation [<xref ref-type="bibr" rid="CR45">45</xref>], the choice of pseudocount is arbitrary and there is no consensus on the optimal value. Studies have shown that the pseudocount approach can lead to biased normalization and the downstream data analysis can be sensitive to the choice of pseudocount [<xref ref-type="bibr" rid="CR46">46</xref>, <xref ref-type="bibr" rid="CR47">47</xref>]. We conducted the sensitivity analysis to study how the choice of pseudocount may affect the performance of PhyloMed. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4 shows the type I error and power results when we use the pseudocount of 0.1, 0.5, or 1. The type I error is controlled for all pseudocounts and the power is slightly higher with smaller pseudocount but the difference is negligible with the increased sample size. Results from real data analyses echo those in the simulation (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5). The PhyloMed global test <italic>p</italic>-values from the analysis of the mouse cecal data with the pseudocount of 0.1, 0.5, or 1 are 0.064, 0.085, 0.126. The human gut microbiome data has a larger sample size and the corresponding PhyloMed global test <italic>p</italic>-values are 0.049, 0.047, and 0.057. These results demonstrate that PhyloMed is generally not sensitive to the choice of pseudocount. Alternative zero-handling approaches without relying on the arbitrary choice of pseudocount can also be applied. The universally best approach is still an open problem in the field and requires further research.</p>
      <p id="Par34">For each subject <italic>i</italic>, we let <inline-formula id="IEq54"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_i$$\end{document}</tex-math><mml:math id="M108"><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq54.gif"/></alternatives></inline-formula> be the treatment variable, <inline-formula id="IEq55"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_i$$\end{document}</tex-math><mml:math id="M110"><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq55.gif"/></alternatives></inline-formula> be the outcome variable, and <inline-formula id="IEq56"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textbf{X}_i$$\end{document}</tex-math><mml:math id="M112"><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq56.gif"/></alternatives></inline-formula> be a set of confounders that may affect the treatment, mediator, and outcome. To represent the causal path diagram of the local mediation model at the <italic>j</italic>th internal node (Fig. <xref rid="Fig1" ref-type="fig">1</xref>), we apply the following regression models<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} E\left\{ \log \left( \frac{M_{ij}}{1-M_{ij}}\right) \right\} = \varvec{\alpha }^{\textrm{T}}_{jX} \textbf{X}_i + \alpha _j T_i, \end{aligned}$$\end{document}</tex-math><mml:math id="M114" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>E</mml:mi><mml:mfenced close="}" open="{"><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced></mml:mfenced><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jX</mml:mi></mml:mrow><mml:mtext>T</mml:mtext></mml:msubsup><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_2902_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} g\{E(Y_i)\} = \varvec{\beta }^{\textrm{T}}_{jX} \textbf{X}_i + \beta _{jT} T_i + \beta _{j} \log \left( \frac{M_{ij}}{1-M_{ij}}\right) . \end{aligned}$$\end{document}</tex-math><mml:math id="M116" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jX</mml:mi></mml:mrow><mml:mtext>T</mml:mtext></mml:msubsup><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi mathvariant="italic">jT</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_2902_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par35">We omit the intercept term in both models as it can be absorbed into <inline-formula id="IEq57"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textbf{X}_i$$\end{document}</tex-math><mml:math id="M118"><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq57.gif"/></alternatives></inline-formula>. Equation (<xref rid="Equ1" ref-type="disp-formula">1</xref>) represents a distribution-free linear regression model with the mean of the logit(<inline-formula id="IEq58"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_{ij}$$\end{document}</tex-math><mml:math id="M120"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq58.gif"/></alternatives></inline-formula>) depending on the treatment and confounders but the distribution of the subcomposition is not specified. Such a model is robust against the over-dispersion and outliers in the microbiome data. Equation (<xref rid="Equ2" ref-type="disp-formula">2</xref>) is a generalized linear regression with <inline-formula id="IEq59"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g\{\cdot \}$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq59.gif"/></alternatives></inline-formula> being the link function depending on the type of outcome. As <inline-formula id="IEq60"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_{ij}$$\end{document}</tex-math><mml:math id="M124"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq60.gif"/></alternatives></inline-formula>’s over internal nodes are independent, we can fit <italic>J</italic> low-dimensional models <inline-formula id="IEq61"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[Y_i \mid \textbf{X}_i, T_i, \text {logit}(M_{ij})]$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mtext>logit</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq61.gif"/></alternatives></inline-formula> as Eq. (<xref rid="Equ2" ref-type="disp-formula">2</xref>) as opposed to a large joint model <inline-formula id="IEq62"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[Y_i \mid \textbf{X}_i, T_i, \text {logit}(M_{i1}), \ldots , \text {logit}(M_{iJ})]$$\end{document}</tex-math><mml:math id="M128"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mtext>logit</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mtext>logit</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">iJ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq62.gif"/></alternatives></inline-formula> for the purpose of hypothesis testing.</p>
      <p id="Par36">The potential outcomes framework [<xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR11">11</xref>] has established a series of identifiability assumptions such that models (<xref rid="Equ1" ref-type="disp-formula">1</xref>) and (<xref rid="Equ2" ref-type="disp-formula">2</xref>) lead to quantification of the causal mediation effect. A rigorous definition of causal mediation using potential outcomes framework is provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note A.1 [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR48">48</xref>]. An extension of the model to allow for the treatment-mediator interaction is described in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note A.2.</p>
    </sec>
    <sec id="Sec12">
      <title>Composite null hypothesis tests in local mediation models</title>
      <p id="Par37">In each local mediation model, we are interested in testing whether the subcomposition at the <italic>j</italic>th internal node lies in the causal pathway from the treatment to the outcome. For both continuous and binary outcomes, the null and alternative hypotheses for this testing problem can be formulated as (details in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note A)<disp-formula id="Equ4"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} H^{j}_{0}: \alpha _j \beta _{j}=0 \quad {\textrm{vs}} \quad H^{j}_{a}: \alpha _j \beta _{j}\ne 0. \end{aligned}$$\end{document}</tex-math><mml:math id="M130" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:msubsup><mml:mo>:</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="1em"/><mml:mtext>vs</mml:mtext><mml:mspace width="1em"/><mml:msubsup><mml:mi>H</mml:mi><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>:</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_2902_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par38">The null hypothesis can be equivalently expressed as the union of three disjoint null hypotheses<disp-formula id="Equ5"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} H^{j}_{00}&amp;: \alpha _j = \beta _{j} = 0,\\ H^{j}_{10}&amp;: \alpha _j \ne 0, \beta _{j} = 0,\\ H^{j}_{01}&amp;: \alpha _j = 0, \beta _{j} \ne 0. \end{aligned}$$\end{document}</tex-math><mml:math id="M132" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>H</mml:mi><mml:mn>00</mml:mn><mml:mi>j</mml:mi></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>:</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msubsup><mml:mi>H</mml:mi><mml:mn>10</mml:mn><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>:</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msubsup><mml:mi>H</mml:mi><mml:mn>01</mml:mn><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>:</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_2902_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par39">The Sobel’s test [<xref ref-type="bibr" rid="CR24">24</xref>] and the joint significance test have been widely applied to test the mediation null hypothesis. Unfortunately, these tests have severely deflated type I error and lack power because they fail to take into account the composite nature of the null hypothesis [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR31">31</xref>].</p>
      <p id="Par40">To address this issue, several new mediation tests were recently developed. JT-comp [<xref ref-type="bibr" rid="CR49">49</xref>] assesses the product of two test statistics of exposure-mediator association and mediator-outcome association, the method proposed by Dai et al. [<xref ref-type="bibr" rid="CR50">50</xref>] assesses the maximum of the two test <italic>p</italic>-values, and DACT [<xref ref-type="bibr" rid="CR51">51</xref>] assesses a test statistic of a composite <italic>p</italic>-value. Dai’s method and DACT estimate the proportion of the three types of nulls and assess their test statistics under different nulls. DACT employs Efron’s empirical null inference framework [<xref ref-type="bibr" rid="CR52">52</xref>] to further calibrate the <italic>p</italic>-value. In light of these methods, we propose a new testing procedure that handles the composite null hypothesis and produces a well-controlled type I error for multiple local mediation tests. Let <inline-formula id="IEq63"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\alpha _j}$$\end{document}</tex-math><mml:math id="M134"><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq63.gif"/></alternatives></inline-formula> and <inline-formula id="IEq64"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\beta _j}$$\end{document}</tex-math><mml:math id="M136"><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq64.gif"/></alternatives></inline-formula> denote the <italic>p</italic>-values for testing <inline-formula id="IEq65"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _j=0$$\end{document}</tex-math><mml:math id="M138"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq65.gif"/></alternatives></inline-formula> and <inline-formula id="IEq66"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _{j}=0$$\end{document}</tex-math><mml:math id="M140"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq66.gif"/></alternatives></inline-formula>, respectively. The <inline-formula id="IEq67"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\alpha _j}$$\end{document}</tex-math><mml:math id="M142"><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq67.gif"/></alternatives></inline-formula> and <inline-formula id="IEq68"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\beta _j}$$\end{document}</tex-math><mml:math id="M144"><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq68.gif"/></alternatives></inline-formula> are asymptotically uniformly distributed under their respective null hypotheses (i.e., <inline-formula id="IEq69"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\alpha _j}$$\end{document}</tex-math><mml:math id="M146"><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq69.gif"/></alternatives></inline-formula> under <inline-formula id="IEq70"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _j=0$$\end{document}</tex-math><mml:math id="M148"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq70.gif"/></alternatives></inline-formula> and <inline-formula id="IEq71"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\beta _j}$$\end{document}</tex-math><mml:math id="M150"><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq71.gif"/></alternatives></inline-formula> under <inline-formula id="IEq72"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _j=0$$\end{document}</tex-math><mml:math id="M152"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq72.gif"/></alternatives></inline-formula>) and are independent under the no unmeasured confounding assumptions. In PhyloMed, we adopt score statistics and obtain the observed <italic>p</italic>-values <inline-formula id="IEq73"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\alpha _j}$$\end{document}</tex-math><mml:math id="M154"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq73.gif"/></alternatives></inline-formula> and <inline-formula id="IEq74"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\beta _j}$$\end{document}</tex-math><mml:math id="M156"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq74.gif"/></alternatives></inline-formula> based on the reference asymptotic distribution or permutation (details in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note B). The permutation <italic>p</italic>-value is more accurate than its asymptotic counterpart when the study sample size is small. We implement an adaptive procedure to efficiently and accurately obtain the permutation <italic>p</italic>-values (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note B.3) [<xref ref-type="bibr" rid="CR53">53</xref>].</p>
      <p id="Par41">We then define the mediation test statistic for <inline-formula id="IEq75"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H^j_0$$\end{document}</tex-math><mml:math id="M158"><mml:msubsup><mml:mi>H</mml:mi><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq75.gif"/></alternatives></inline-formula> as<disp-formula id="Equ6"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} P_{\max _j} = \max (P_{\alpha _j}, P_{\beta _j}). \end{aligned}$$\end{document}</tex-math><mml:math id="M160" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:mo movablelimits="true">max</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_2902_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par42">The joint significance test also takes <inline-formula id="IEq76"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\max _j}$$\end{document}</tex-math><mml:math id="M162"><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq76.gif"/></alternatives></inline-formula> as the mediation test statistic and determines statistical significance using the uniform distribution. In fact, <inline-formula id="IEq77"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\max _j}$$\end{document}</tex-math><mml:math id="M164"><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq77.gif"/></alternatives></inline-formula> follows a mixture distribution with three components, each of which corresponds to one type of null hypothesis <inline-formula id="IEq78"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H^j_{00}$$\end{document}</tex-math><mml:math id="M166"><mml:msubsup><mml:mi>H</mml:mi><mml:mn>00</mml:mn><mml:mi>j</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq78.gif"/></alternatives></inline-formula>, <inline-formula id="IEq79"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H^j_{10}$$\end{document}</tex-math><mml:math id="M168"><mml:msubsup><mml:mi>H</mml:mi><mml:mn>10</mml:mn><mml:mi>j</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq79.gif"/></alternatives></inline-formula>, or <inline-formula id="IEq80"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H^j_{01}$$\end{document}</tex-math><mml:math id="M170"><mml:msubsup><mml:mi>H</mml:mi><mml:mn>01</mml:mn><mml:mi>j</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq80.gif"/></alternatives></inline-formula>. Let <inline-formula id="IEq81"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\max _j}$$\end{document}</tex-math><mml:math id="M172"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq81.gif"/></alternatives></inline-formula> denote <inline-formula id="IEq82"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\max (p_{\alpha _j}, p_{\beta _j})$$\end{document}</tex-math><mml:math id="M174"><mml:mrow><mml:mo movablelimits="true">max</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq82.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq83"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _{00}$$\end{document}</tex-math><mml:math id="M176"><mml:msub><mml:mi>π</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq83.gif"/></alternatives></inline-formula>, <inline-formula id="IEq84"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _{10}$$\end{document}</tex-math><mml:math id="M178"><mml:msub><mml:mi>π</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq84.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq85"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _{01}$$\end{document}</tex-math><mml:math id="M180"><mml:msub><mml:mi>π</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq85.gif"/></alternatives></inline-formula> be the probabilities of the three null hypotheses among the <italic>J</italic> local mediation models defined on the tree. The <italic>p</italic>-value of the mediation test in the <italic>j</italic>th local model is given by<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;Pr(P_{\max _j} \le p_{\max _j}) \nonumber \\ =&amp;\pi _{00} Pr(P_{\alpha _j} \le p_{\max _j}, P_{\beta _j} \le p_{\max _j} \mid H^j_{00}) \nonumber \\&amp;+ \pi _{10} Pr(P_{\alpha _j} \le p_{\max _j}, P_{\beta _j} \le p_{\max _j} \mid H^j_{10}) + \pi _{01} Pr(P_{\alpha _j} \le p_{\max _j}, P_{\beta _j} \le p_{\max _j} \mid H^j_{01}) \nonumber \\ =&amp;\pi _{00} Pr(P_{\alpha _j} \le p_{\max _j} \mid \alpha _j = 0) Pr( P_{\beta _j} \le p_{\max _j} \mid \beta _j=0) \nonumber \\&amp;+ \pi _{10} Pr( P_{\beta _j} \le p_{\max _j} \mid \beta _j=0) Pr(P_{\alpha _j} \le p_{\max _j} \mid \alpha _j \ne 0) \nonumber \\&amp;+ \pi _{01} Pr(P_{\alpha _j} \le p_{\max _j} \mid \alpha _j = 0) Pr( P_{\beta _j} \le p_{\max _j} \mid \beta _j \ne 0) \nonumber \\ =&amp;\pi _{00} p^2_{\max _j} + \pi _{10} p_{\max _j} Pr(P_{\alpha _j} \le p_{\max _j} \mid \alpha _j \ne 0) + \pi _{01} p_{\max _j} Pr(P_{\beta _j} \le p_{\max _j} \mid \beta _j \ne 0). \end{aligned}$$\end{document}</tex-math><mml:math id="M182" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>∣</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mn>00</mml:mn><mml:mi>j</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>∣</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mn>10</mml:mn><mml:mi>j</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>∣</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mn>01</mml:mn><mml:mi>j</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:msubsup><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_2902_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par43">In this formula, we need to estimate three probabilities: <inline-formula id="IEq86"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _{00}$$\end{document}</tex-math><mml:math id="M184"><mml:msub><mml:mi>π</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq86.gif"/></alternatives></inline-formula>, <inline-formula id="IEq87"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _{10}$$\end{document}</tex-math><mml:math id="M186"><mml:msub><mml:mi>π</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq87.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq88"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _{01}$$\end{document}</tex-math><mml:math id="M188"><mml:msub><mml:mi>π</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq88.gif"/></alternatives></inline-formula>, and two power functions evaluated at <inline-formula id="IEq89"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\max _j}$$\end{document}</tex-math><mml:math id="M190"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq89.gif"/></alternatives></inline-formula>: <inline-formula id="IEq90"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Pr(P_{\alpha _j} \le p_{\max _j} \mid \alpha _j \ne 0)$$\end{document}</tex-math><mml:math id="M192"><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq90.gif"/></alternatives></inline-formula> and <inline-formula id="IEq91"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Pr(P_{\beta _j} \le p_{\max _j} \mid \beta _j \ne 0)$$\end{document}</tex-math><mml:math id="M194"><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq91.gif"/></alternatives></inline-formula>.</p>
      <p id="Par44">We first employ the method proposed by Jin and Cai [<xref ref-type="bibr" rid="CR54">54</xref>] to estimate <inline-formula id="IEq92"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\pi }_{0\bullet }$$\end{document}</tex-math><mml:math id="M196"><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>∙</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq92.gif"/></alternatives></inline-formula>, the proportion of null <inline-formula id="IEq93"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _j=0$$\end{document}</tex-math><mml:math id="M198"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq93.gif"/></alternatives></inline-formula>, using <inline-formula id="IEq94"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\alpha _j}$$\end{document}</tex-math><mml:math id="M200"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq94.gif"/></alternatives></inline-formula>’s in all <italic>J</italic> local mediation models. Specifically, we convert the <inline-formula id="IEq95"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\alpha _j}$$\end{document}</tex-math><mml:math id="M202"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq95.gif"/></alternatives></inline-formula> to <italic>Z</italic>-score <inline-formula id="IEq96"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z_{\alpha _j} = sign(\widehat{\alpha }_j) \times \Phi ^{-1}(1-p_{\alpha _j}/2),$$\end{document}</tex-math><mml:math id="M204"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq96.gif"/></alternatives></inline-formula> where <inline-formula id="IEq97"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$sign(\widehat{\alpha }_j)$$\end{document}</tex-math><mml:math id="M206"><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq97.gif"/></alternatives></inline-formula> is the sign of the <inline-formula id="IEq98"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _j$$\end{document}</tex-math><mml:math id="M208"><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq98.gif"/></alternatives></inline-formula> estimate and <inline-formula id="IEq99"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Phi ^{-1}(x)$$\end{document}</tex-math><mml:math id="M210"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq99.gif"/></alternatives></inline-formula> is the quantile function of the standard normal distribution. The empirical characteristic function and Fourier analysis are used to estimate the proportion of nulls. The empirical characteristic function is defined as<disp-formula id="Equ7"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \varphi _J(t; Z_{\alpha _1}, \ldots , Z_{\alpha _J}) = \frac{1}{J}\sum _{j=1}^J e^{itZ_{\alpha _j}}, \end{aligned}$$\end{document}</tex-math><mml:math id="M212" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>φ</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>J</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>J</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:munderover><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:msub><mml:mi>Z</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_2902_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq100"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i=\sqrt{-1}$$\end{document}</tex-math><mml:math id="M214"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msqrt></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq100.gif"/></alternatives></inline-formula>. The proportion of nulls can be consistently estimated as<disp-formula id="Equ8"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \widehat{\pi }_{0\bullet } = \inf _{\left\{ 0 \le t \le \sqrt{\log (J)}\right\} } \left[ \int _{-1}^{1} \left( 1-|\xi |\right) \left\{ {\textrm{Re}}(\varphi _J(t\xi ; Z_{\alpha _1}, \ldots , Z_{\alpha _J})) e^{t^2 \xi ^2/2}\right\} \, d\xi \right] , \end{aligned}$$\end{document}</tex-math><mml:math id="M216" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mn>0</mml:mn><mml:mo>∙</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="true">inf</mml:mo><mml:mfenced close="}" open="{"><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:msqrt><mml:mrow><mml:mo>log</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>J</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt></mml:mfenced></mml:munder><mml:mfenced close="]" open="["><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mfenced><mml:mfenced close="}" open="{"><mml:mtext>Re</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>φ</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mi>ξ</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>J</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msup><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>ξ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mfenced><mml:mspace width="0.166667em"/><mml:mi>d</mml:mi><mml:mi>ξ</mml:mi></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_2902_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq101"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textrm{Re}}(x)$$\end{document}</tex-math><mml:math id="M218"><mml:mrow><mml:mtext>Re</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq101.gif"/></alternatives></inline-formula> denotes the real part of a complex number <italic>x</italic>. Similarly, we can obtain <inline-formula id="IEq102"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\pi }_{\bullet 0}$$\end{document}</tex-math><mml:math id="M220"><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo>∙</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq102.gif"/></alternatives></inline-formula>, the estimated proportion of null <inline-formula id="IEq103"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _j=0$$\end{document}</tex-math><mml:math id="M222"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq103.gif"/></alternatives></inline-formula> using <inline-formula id="IEq104"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\beta _j}$$\end{document}</tex-math><mml:math id="M224"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq104.gif"/></alternatives></inline-formula>’s across all local models. Then, under <inline-formula id="IEq105"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_0^j$$\end{document}</tex-math><mml:math id="M226"><mml:msubsup><mml:mi>H</mml:mi><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq105.gif"/></alternatives></inline-formula>, the estimates of <inline-formula id="IEq106"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _{00}$$\end{document}</tex-math><mml:math id="M228"><mml:msub><mml:mi>π</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq106.gif"/></alternatives></inline-formula>, <inline-formula id="IEq107"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _{10}$$\end{document}</tex-math><mml:math id="M230"><mml:msub><mml:mi>π</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq107.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq108"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _{01}$$\end{document}</tex-math><mml:math id="M232"><mml:msub><mml:mi>π</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq108.gif"/></alternatives></inline-formula> are <inline-formula id="IEq109"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\pi }_{00}=\widehat{\pi }_{0\bullet }\widehat{\pi }_{\bullet 0}/\widehat{\pi }_0$$\end{document}</tex-math><mml:math id="M234"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>00</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mn>0</mml:mn><mml:mo>∙</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo>∙</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq109.gif"/></alternatives></inline-formula>, <inline-formula id="IEq110"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\pi }_{10}=(1-\widehat{\pi }_{0\bullet })\widehat{\pi }_{\bullet 0}/\widehat{\pi }_0$$\end{document}</tex-math><mml:math id="M236"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>10</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mn>0</mml:mn><mml:mo>∙</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo>∙</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq110.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq111"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\pi }_{01}=\widehat{\pi }_{0\bullet }(1-\widehat{\pi }_{\bullet 0})/\widehat{\pi }_0$$\end{document}</tex-math><mml:math id="M238"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>01</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mn>0</mml:mn><mml:mo>∙</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo>∙</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq111.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq112"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\pi }_0=\widehat{\pi }_{0\bullet } + \widehat{\pi }_{\bullet 0}-\widehat{\pi }_{0\bullet }\widehat{\pi }_{\bullet 0}$$\end{document}</tex-math><mml:math id="M240"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mn>0</mml:mn><mml:mo>∙</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo>∙</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mn>0</mml:mn><mml:mo>∙</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo>∙</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq112.gif"/></alternatives></inline-formula>.</p>
      <p id="Par45">We also consider an alternative approach to estimate (<inline-formula id="IEq113"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\pi }_{00}$$\end{document}</tex-math><mml:math id="M242"><mml:msub><mml:mi>π</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq113.gif"/></alternatives></inline-formula>, <inline-formula id="IEq114"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\pi }_{10}$$\end{document}</tex-math><mml:math id="M244"><mml:msub><mml:mi>π</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq114.gif"/></alternatives></inline-formula>, <inline-formula id="IEq115"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\pi }_{01}$$\end{document}</tex-math><mml:math id="M246"><mml:msub><mml:mi>π</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq115.gif"/></alternatives></inline-formula>). In particular, we apply the method of Jin and Cai [<xref ref-type="bibr" rid="CR54">54</xref>] to <inline-formula id="IEq116"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\max _j}$$\end{document}</tex-math><mml:math id="M248"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq116.gif"/></alternatives></inline-formula>’s across all local models to estimate the proportion of mediation null hypothesis (i.e., <inline-formula id="IEq117"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _0 = \pi _{00} + \pi _{10} + \pi _{01}$$\end{document}</tex-math><mml:math id="M250"><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq117.gif"/></alternatives></inline-formula>). We then estimate <inline-formula id="IEq118"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _{00}$$\end{document}</tex-math><mml:math id="M252"><mml:msub><mml:mi>π</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq118.gif"/></alternatives></inline-formula>, <inline-formula id="IEq119"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _{10}$$\end{document}</tex-math><mml:math id="M254"><mml:msub><mml:mi>π</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq119.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq120"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _{01}$$\end{document}</tex-math><mml:math id="M256"><mml:msub><mml:mi>π</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq120.gif"/></alternatives></inline-formula> as <inline-formula id="IEq121"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\pi }_{00}=(\widehat{\pi }_{0\bullet } +\widehat{\pi }_{\bullet 0}-\widehat{\pi }_{0})/\widehat{\pi }_{0}$$\end{document}</tex-math><mml:math id="M258"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>00</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mn>0</mml:mn><mml:mo>∙</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo>∙</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq121.gif"/></alternatives></inline-formula>, <inline-formula id="IEq122"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\pi }_{10}=(\widehat{\pi }_{0}-\widehat{\pi }_{0\bullet })/\widehat{\pi }_{0}$$\end{document}</tex-math><mml:math id="M260"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>10</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mn>0</mml:mn><mml:mo>∙</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq122.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq123"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\pi }_{01}=(\widehat{\pi }_{0}-\widehat{\pi }_{\bullet 0})/\widehat{\pi }_0$$\end{document}</tex-math><mml:math id="M262"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>01</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo>∙</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq123.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq124"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\pi }_{0\bullet }$$\end{document}</tex-math><mml:math id="M264"><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mn>0</mml:mn><mml:mo>∙</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq124.gif"/></alternatives></inline-formula> and <inline-formula id="IEq125"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\pi }_{\bullet 0}$$\end{document}</tex-math><mml:math id="M266"><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo>∙</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq125.gif"/></alternatives></inline-formula> are the same estimates as before. The key difference between the two approaches is in the estimate of the proportion of mediation null hypothesis (i.e., <inline-formula id="IEq126"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _{0}$$\end{document}</tex-math><mml:math id="M268"><mml:msub><mml:mi>π</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq126.gif"/></alternatives></inline-formula>). The first approach uses the product of two proportions <inline-formula id="IEq127"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\pi }_0 = 1-(1-\widehat{\pi }_{0\bullet })(1-\widehat{\pi }_{\bullet 0})$$\end{document}</tex-math><mml:math id="M270"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mn>0</mml:mn><mml:mo>∙</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo>∙</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq127.gif"/></alternatives></inline-formula>, and we refer to it as the “product” approach. The second approach directly estimate <inline-formula id="IEq128"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _0$$\end{document}</tex-math><mml:math id="M272"><mml:msub><mml:mi>π</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq128.gif"/></alternatives></inline-formula> using <inline-formula id="IEq129"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\max _j}$$\end{document}</tex-math><mml:math id="M274"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq129.gif"/></alternatives></inline-formula>, and we refer to it as the “maxp” approach. We evaluated the estimation bias and standard error of the two approaches in our simulation studies (“<xref rid="Sec10" ref-type="sec">Methods</xref>” section “<xref rid="Sec15" ref-type="sec">Simulation strategy</xref>”). The result shows that the two approaches are very similar (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6). Results presented in the main text are based on the “product” approach. Our R package has incorporated both options.</p>
      <p id="Par46">For the two power functions, we employ the nonparametric estimates based on the Grenander estimator of the <italic>p</italic>-value density [<xref ref-type="bibr" rid="CR55">55</xref>]. We show below the procedure for obtaining <inline-formula id="IEq130"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{Pr}(P_{\alpha _j} \le p_{\max _j} \mid \alpha _j \ne 0)$$\end{document}</tex-math><mml:math id="M276"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="italic">Pr</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq130.gif"/></alternatives></inline-formula>. Specifically, we use formula (9) in [<xref ref-type="bibr" rid="CR55">55</xref>] to compute the Grenander estimator of the decreasing density at every <inline-formula id="IEq131"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\alpha _j}$$\end{document}</tex-math><mml:math id="M278"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq131.gif"/></alternatives></inline-formula>, denoted by <inline-formula id="IEq132"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{f}(p_{\alpha _j})$$\end{document}</tex-math><mml:math id="M280"><mml:mrow><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq132.gif"/></alternatives></inline-formula>. Under <inline-formula id="IEq133"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_0^j$$\end{document}</tex-math><mml:math id="M282"><mml:msubsup><mml:mi>H</mml:mi><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq133.gif"/></alternatives></inline-formula>, <inline-formula id="IEq134"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\alpha _j}$$\end{document}</tex-math><mml:math id="M284"><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq134.gif"/></alternatives></inline-formula> follows a mixture distribution composed of the uniform distribution (under <inline-formula id="IEq135"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H^j_{00}$$\end{document}</tex-math><mml:math id="M286"><mml:msubsup><mml:mi>H</mml:mi><mml:mn>00</mml:mn><mml:mi>j</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq135.gif"/></alternatives></inline-formula> and <inline-formula id="IEq136"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H^j_{01}$$\end{document}</tex-math><mml:math id="M288"><mml:msubsup><mml:mi>H</mml:mi><mml:mn>01</mml:mn><mml:mi>j</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq136.gif"/></alternatives></inline-formula>) and the power function (under <inline-formula id="IEq137"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H^j_{10}$$\end{document}</tex-math><mml:math id="M290"><mml:msubsup><mml:mi>H</mml:mi><mml:mn>10</mml:mn><mml:mi>j</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq137.gif"/></alternatives></inline-formula>). Therefore, we can obtain the conditional density estimate <inline-formula id="IEq138"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{f}(p_{\alpha _j} | \alpha _j \ne 0)$$\end{document}</tex-math><mml:math id="M292"><mml:mrow><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq138.gif"/></alternatives></inline-formula> by solving the equation<disp-formula id="Equ9"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \widehat{f}(p_{\alpha _j}) = \widehat{\pi }_{10} \widehat{f}(p_{\alpha _j} \mid \alpha _j \ne 0) + \widehat{\pi }_{00} + \widehat{\pi }_{01}. \end{aligned}$$\end{document}</tex-math><mml:math id="M294" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>10</mml:mn></mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>00</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>01</mml:mn></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_2902_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par47">We can then estimate <inline-formula id="IEq139"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{Pr}(P_{\alpha _j} \le p_{\max _j} \mid \alpha _j \ne 0)$$\end{document}</tex-math><mml:math id="M296"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="italic">Pr</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq139.gif"/></alternatives></inline-formula> based on <inline-formula id="IEq140"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{f}(p_{\alpha _j} \mid \alpha _j \ne 0)$$\end{document}</tex-math><mml:math id="M298"><mml:mrow><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq140.gif"/></alternatives></inline-formula> at all observed <inline-formula id="IEq141"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\alpha _j}$$\end{document}</tex-math><mml:math id="M300"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq141.gif"/></alternatives></inline-formula>’s. We can obtain <inline-formula id="IEq142"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{Pr}(P_{\beta _j} \le p_{\max _j} \mid \beta _j \ne 0)$$\end{document}</tex-math><mml:math id="M302"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="italic">Pr</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq142.gif"/></alternatives></inline-formula> using a similar estimation procedure. Finally, the mediation test <italic>p</italic>-value at the <italic>j</italic>th node can be estimated as<disp-formula id="Equ10"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} p_j = \widehat{\pi }_{00} p^2_{\max _j} + \widehat{\pi }_{10} p_{\max _j} \widehat{Pr}(P_{\alpha _j} \le p_{\max _j} \mid \alpha _j \ne 0) + \widehat{\pi }_{01} p_{\max _j} \widehat{Pr}(P_{\beta _j} \le p_{\max _j} \mid \beta _j \ne 0). \end{aligned}$$\end{document}</tex-math><mml:math id="M304" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>00</mml:mn></mml:msub><mml:msubsup><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>10</mml:mn></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="italic">Pr</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>01</mml:mn></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="italic">Pr</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_2902_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par48">In our numerical studies, we compare this mixture-distribution-based mediation test with the Sobel’s test and the joint significance test (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note C).</p>
    </sec>
    <sec id="Sec13">
      <title>Mediating subcomposition detection</title>
      <p id="Par49">We deduce below that the mediation test statistics <inline-formula id="IEq143"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\max _j}$$\end{document}</tex-math><mml:math id="M306"><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq143.gif"/></alternatives></inline-formula>’s of internal nodes under <inline-formula id="IEq144"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H^j_0$$\end{document}</tex-math><mml:math id="M308"><mml:msubsup><mml:mi>H</mml:mi><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq144.gif"/></alternatives></inline-formula> (referred to as null internal nodes) are asymptotically mutually independent as the sample size goes to infinity.</p>
      <p id="Par50">Under <inline-formula id="IEq145"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H^j_0$$\end{document}</tex-math><mml:math id="M310"><mml:msubsup><mml:mi>H</mml:mi><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq145.gif"/></alternatives></inline-formula>, the two power function probabilities <inline-formula id="IEq146"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Pr(P_{\alpha _j} \le t_j \mid \alpha _j \ne 0)$$\end{document}</tex-math><mml:math id="M312"><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq146.gif"/></alternatives></inline-formula> and <inline-formula id="IEq147"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Pr(P_{\beta _j} \le t_j \mid \beta _j \ne 0)$$\end{document}</tex-math><mml:math id="M314"><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq147.gif"/></alternatives></inline-formula> converge to 1 for a constant <inline-formula id="IEq148"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_j$$\end{document}</tex-math><mml:math id="M316"><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq148.gif"/></alternatives></inline-formula> when the sample size goes to infinity. Therefore, based on formula (<xref rid="Equ3" ref-type="disp-formula">3</xref>), <inline-formula id="IEq149"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Pr(P_{\max _j} \le t_j)$$\end{document}</tex-math><mml:math id="M318"><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq149.gif"/></alternatives></inline-formula> can be approximated by <inline-formula id="IEq150"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _{00} Pr(P_{\alpha _j} \le t_j \mid \alpha _j = 0) Pr( P_{\beta _j} \le t_j \mid \beta _j=0) + \pi _{10} Pr( P_{\beta _j} \le t_j \mid \beta _j=0) + \pi _{01} Pr(P_{\alpha _j} \le t_j \mid \alpha _j = 0) = \pi _{00} t^2_{j} + \pi _{10} t_{j} + \pi _{01} t_{j}$$\end{document}</tex-math><mml:math id="M320"><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:msubsup><mml:mi>t</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq150.gif"/></alternatives></inline-formula>. Clearly, the formula only involves probabilities of <inline-formula id="IEq151"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\alpha _j}$$\end{document}</tex-math><mml:math id="M322"><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq151.gif"/></alternatives></inline-formula> and <inline-formula id="IEq152"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\beta _j}$$\end{document}</tex-math><mml:math id="M324"><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq152.gif"/></alternatives></inline-formula> under their respective nulls <inline-formula id="IEq153"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _j=0$$\end{document}</tex-math><mml:math id="M326"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq153.gif"/></alternatives></inline-formula> and <inline-formula id="IEq154"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _j=0$$\end{document}</tex-math><mml:math id="M328"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq154.gif"/></alternatives></inline-formula>. Indeed, the <italic>p</italic>-value under the null is stochastically larger than the <italic>p</italic>-value under the alternative. At the null internal node <italic>j</italic> (at least one of the <inline-formula id="IEq155"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _j$$\end{document}</tex-math><mml:math id="M330"><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq155.gif"/></alternatives></inline-formula> and <inline-formula id="IEq156"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _j$$\end{document}</tex-math><mml:math id="M332"><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq156.gif"/></alternatives></inline-formula> is zero), the <inline-formula id="IEq157"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\max _j}$$\end{document}</tex-math><mml:math id="M334"><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq157.gif"/></alternatives></inline-formula> converges to the <italic>p</italic>-value (<inline-formula id="IEq158"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\alpha _j}$$\end{document}</tex-math><mml:math id="M336"><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq158.gif"/></alternatives></inline-formula> or <inline-formula id="IEq159"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\beta _j}$$\end{document}</tex-math><mml:math id="M338"><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq159.gif"/></alternatives></inline-formula>) under the null (<inline-formula id="IEq160"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _j=0$$\end{document}</tex-math><mml:math id="M340"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq160.gif"/></alternatives></inline-formula> or <inline-formula id="IEq161"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _j=0$$\end{document}</tex-math><mml:math id="M342"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq161.gif"/></alternatives></inline-formula>) as the sample size goes to infinity. Moreover, <inline-formula id="IEq162"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\alpha _j}$$\end{document}</tex-math><mml:math id="M344"><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq162.gif"/></alternatives></inline-formula>’s are asymptotically independent over the nodes under <inline-formula id="IEq163"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _j = 0$$\end{document}</tex-math><mml:math id="M346"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq163.gif"/></alternatives></inline-formula> and <inline-formula id="IEq164"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\beta _j}$$\end{document}</tex-math><mml:math id="M348"><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq164.gif"/></alternatives></inline-formula>’s are asymptotically independent over the nodes under <inline-formula id="IEq165"><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _j = 0$$\end{document}</tex-math><mml:math id="M350"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq165.gif"/></alternatives></inline-formula> because subcompositions <inline-formula id="IEq166"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_j$$\end{document}</tex-math><mml:math id="M352"><mml:msub><mml:mi>M</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq166.gif"/></alternatives></inline-formula>’s over internal nodes are modeled as independent variables. Hence, <inline-formula id="IEq167"><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\max _j}$$\end{document}</tex-math><mml:math id="M354"><mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq167.gif"/></alternatives></inline-formula>’s over null internal nodes are also asymptotically independent.</p>
      <p id="Par51">When there is no mediating node in the tree (global mediation null setting), the (<inline-formula id="IEq168"><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\pi }_{00}$$\end{document}</tex-math><mml:math id="M356"><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>00</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq168.gif"/></alternatives></inline-formula>, <inline-formula id="IEq169"><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\pi }_{10}$$\end{document}</tex-math><mml:math id="M358"><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>10</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq169.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq170"><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\pi }_{01}$$\end{document}</tex-math><mml:math id="M360"><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>01</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq170.gif"/></alternatives></inline-formula>) converge to the true values and yield uniformly distributed mediation <italic>p</italic>-values under the large sample size. In the presence of mediating taxa, the <inline-formula id="IEq171"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\pi }_{00}$$\end{document}</tex-math><mml:math id="M362"><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>00</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq171.gif"/></alternatives></inline-formula> underestimates the true <inline-formula id="IEq172"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\pi }_{00}$$\end{document}</tex-math><mml:math id="M364"><mml:msub><mml:mi>π</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq172.gif"/></alternatives></inline-formula>, and the <inline-formula id="IEq173"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\pi }_{10}$$\end{document}</tex-math><mml:math id="M366"><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>10</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq173.gif"/></alternatives></inline-formula> and <inline-formula id="IEq174"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\pi }_{01}$$\end{document}</tex-math><mml:math id="M368"><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>01</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq174.gif"/></alternatives></inline-formula> overestimate their corresponding parameter values. This is because the estimate of the proportion of mediation null hypothesis (i.e., <inline-formula id="IEq175"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\pi }_0$$\end{document}</tex-math><mml:math id="M370"><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq175.gif"/></alternatives></inline-formula> estimated using “product” or “maxp” approach described in the last section) is inherently higher than the true value in the presence of mediating taxa, resulting in deflated <inline-formula id="IEq176"><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\pi }_{00}$$\end{document}</tex-math><mml:math id="M372"><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>00</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq176.gif"/></alternatives></inline-formula>. This has been demonstrated in the simulation where the bias of <inline-formula id="IEq177"><alternatives><tex-math id="M373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\pi }_{00}$$\end{document}</tex-math><mml:math id="M374"><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>00</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq177.gif"/></alternatives></inline-formula> is always negative under the settings <inline-formula id="IEq178"><alternatives><tex-math id="M375">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|S_{\alpha }|=|S_{\beta }|=3 \text { or } 6$$\end{document}</tex-math><mml:math id="M376"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>β</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mspace width="0.333333em"/><mml:mtext>or</mml:mtext><mml:mspace width="0.333333em"/><mml:mn>6</mml:mn></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq178.gif"/></alternatives></inline-formula> in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6. Consequently, the mediation test <italic>p</italic>-value at the null internal node is superuniform in the presence of mediating taxa because <inline-formula id="IEq179"><alternatives><tex-math id="M377">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\pi }_{00} t^2_{j} + \widehat{\pi }_{10} t_{j} + \widehat{\pi }_{01} t_{j} &lt; \pi _{00} t^2_{j} + \pi _{10} t_{j} + \pi _{01} t_{j}$$\end{document}</tex-math><mml:math id="M378"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>00</mml:mn></mml:msub><mml:msubsup><mml:mi>t</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>10</mml:mn></mml:msub><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>01</mml:mn></mml:msub><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:msubsup><mml:mi>t</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq179.gif"/></alternatives></inline-formula> when <inline-formula id="IEq180"><alternatives><tex-math id="M379">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\pi }_{00} &lt; \pi _{00}$$\end{document}</tex-math><mml:math id="M380"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>00</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq180.gif"/></alternatives></inline-formula>.</p>
      <p id="Par52">Given the properties of mediation <italic>p</italic>-values shown above, to control FDR in multiple testing, we can apply the standard BH procedure [<xref ref-type="bibr" rid="CR29">29</xref>] to identify a collection of nodes with significant mediation effects on the phylogenetic tree.</p>
    </sec>
    <sec id="Sec14">
      <title>Global mediation test</title>
      <p id="Par53">We can combine all subcomposition mediation test <italic>p</italic>-values to test the global mediation null hypothesis that there is no mediation effect in any of the internal nodes (i.e., <inline-formula id="IEq181"><alternatives><tex-math id="M381">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_0: \cap _{j=1}^J H^j_0$$\end{document}</tex-math><mml:math id="M382"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msubsup><mml:mo>∩</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:msubsup><mml:msubsup><mml:mi>H</mml:mi><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq181.gif"/></alternatives></inline-formula>). Here, we employ the HMP method [<xref ref-type="bibr" rid="CR30">30</xref>]. Specifically, the weighted harmonic mean of the subcomposition mediation test <italic>p</italic>-values <inline-formula id="IEq182"><alternatives><tex-math id="M383">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_1, \ldots , p_J$$\end{document}</tex-math><mml:math id="M384"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>J</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq182.gif"/></alternatives></inline-formula> is defined as<disp-formula id="Equ11"><alternatives><tex-math id="M385">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \mathring{p}=\frac{\sum ^J_{j=1}w_j}{\sum ^J_{j=1}w_jp_j}, \end{aligned}$$\end{document}</tex-math><mml:math id="M386" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>˚</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:msubsup><mml:msub><mml:mi>w</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:msubsup><mml:msub><mml:mi>w</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_2902_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq183"><alternatives><tex-math id="M387">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_j$$\end{document}</tex-math><mml:math id="M388"><mml:msub><mml:mi>w</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq183.gif"/></alternatives></inline-formula>’s are weights that sum to 1 and we set <inline-formula id="IEq184"><alternatives><tex-math id="M389">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_j = 1/J$$\end{document}</tex-math><mml:math id="M390"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq184.gif"/></alternatives></inline-formula> by default. The global test <italic>p</italic>-value can be obtained by calculating the tail probability from the <inline-formula id="IEq185"><alternatives><tex-math id="M391">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathring{p}$$\end{document}</tex-math><mml:math id="M392"><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>˚</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq185.gif"/></alternatives></inline-formula>’s null distribution approximation [<xref ref-type="bibr" rid="CR30">30</xref>].</p>
    </sec>
    <sec id="Sec15">
      <title>Simulation strategy</title>
      <p id="Par54">To resemble reality, we used a real microbiome dataset [<xref ref-type="bibr" rid="CR32">32</xref>] as a basis for the simulation. The data contained microbiome samples from 900 healthy subjects. We chose this dataset as our basis because of its large sample size. The data from a healthy cohort is representative of the distribution of microbiome without major perturbation. In each round of the simulation, we randomly sampled <inline-formula id="IEq186"><alternatives><tex-math id="M393">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n=50$$\end{document}</tex-math><mml:math id="M394"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq186.gif"/></alternatives></inline-formula> or 200 subjects out of the 900 and divided them into two equal-sized treatment and control groups (<inline-formula id="IEq187"><alternatives><tex-math id="M395">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_i = 1 {\quad \textrm{or}}\quad 0$$\end{document}</tex-math><mml:math id="M396"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mspace width="1em"/><mml:mtext>or</mml:mtext></mml:mrow><mml:mspace width="1em"/><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq187.gif"/></alternatives></inline-formula>). We used the top 100 most abundant OTUs and the associated phylogenetic tree with 99 internal nodes. Let <inline-formula id="IEq188"><alternatives><tex-math id="M397">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}_\alpha$$\end{document}</tex-math><mml:math id="M398"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq188.gif"/></alternatives></inline-formula> and <inline-formula id="IEq189"><alternatives><tex-math id="M399">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}_\beta$$\end{document}</tex-math><mml:math id="M400"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>β</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq189.gif"/></alternatives></inline-formula> denote the set of treatment-associated and outcome-associated OTUs, respectively, and <inline-formula id="IEq190"><alternatives><tex-math id="M401">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|\mathcal {S}|$$\end{document}</tex-math><mml:math id="M402"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq190.gif"/></alternatives></inline-formula> be the number of elements in <inline-formula id="IEq191"><alternatives><tex-math id="M403">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M404"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq191.gif"/></alternatives></inline-formula>. Under the null of no mediation effect, these two sets of OTUs do not overlap and we consider five combinations of <inline-formula id="IEq192"><alternatives><tex-math id="M405">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(|\mathcal {S}_\alpha |, |\mathcal {S}_\beta |)$$\end{document}</tex-math><mml:math id="M406"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>β</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq192.gif"/></alternatives></inline-formula> values: (0, 0), (3, 0), (6, 0), (0, 3), (0, 6). Different values represent different mixtures of nulls <inline-formula id="IEq193"><alternatives><tex-math id="M407">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{00}$$\end{document}</tex-math><mml:math id="M408"><mml:msub><mml:mi>H</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq193.gif"/></alternatives></inline-formula>, <inline-formula id="IEq194"><alternatives><tex-math id="M409">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{10}$$\end{document}</tex-math><mml:math id="M410"><mml:msub><mml:mi>H</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq194.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq195"><alternatives><tex-math id="M411">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{01}$$\end{document}</tex-math><mml:math id="M412"><mml:msub><mml:mi>H</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq195.gif"/></alternatives></inline-formula>: (0, 0) pertains to the setting where all local models are under <inline-formula id="IEq196"><alternatives><tex-math id="M413">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{00}$$\end{document}</tex-math><mml:math id="M414"><mml:msub><mml:mi>H</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq196.gif"/></alternatives></inline-formula>; <inline-formula id="IEq197"><alternatives><tex-math id="M415">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(3\ {\textrm{or}}\ 6, 0)$$\end{document}</tex-math><mml:math id="M416"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:mspace width="4pt"/><mml:mtext>or</mml:mtext><mml:mspace width="4pt"/><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq197.gif"/></alternatives></inline-formula> pertains to the setting where some local models are under <inline-formula id="IEq198"><alternatives><tex-math id="M417">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{00}$$\end{document}</tex-math><mml:math id="M418"><mml:msub><mml:mi>H</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq198.gif"/></alternatives></inline-formula> and others are under <inline-formula id="IEq199"><alternatives><tex-math id="M419">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{10}$$\end{document}</tex-math><mml:math id="M420"><mml:msub><mml:mi>H</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq199.gif"/></alternatives></inline-formula>; <inline-formula id="IEq200"><alternatives><tex-math id="M421">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(0, 3\ {\textrm{or}}\ 6)$$\end{document}</tex-math><mml:math id="M422"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mspace width="4pt"/><mml:mtext>or</mml:mtext><mml:mspace width="4pt"/><mml:mn>6</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq200.gif"/></alternatives></inline-formula> pertains to the setting where some local models are under <inline-formula id="IEq201"><alternatives><tex-math id="M423">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{00}$$\end{document}</tex-math><mml:math id="M424"><mml:msub><mml:mi>H</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq201.gif"/></alternatives></inline-formula> and others are under <inline-formula id="IEq202"><alternatives><tex-math id="M425">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{01}$$\end{document}</tex-math><mml:math id="M426"><mml:msub><mml:mi>H</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq202.gif"/></alternatives></inline-formula>. Under the alternative, we let <inline-formula id="IEq203"><alternatives><tex-math id="M427">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}_\alpha = \mathcal {S}_\beta$$\end{document}</tex-math><mml:math id="M428"><mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>β</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq203.gif"/></alternatives></inline-formula> and both sets index mediating OTUs that are associated with the treatment and the outcome. We considered 3 or 6 mediating taxa clustered on the tree. In the case of 3 mediating taxa, we randomly selected a clade with three descendant OTUs and assigned them as mediators. In the case of 6 mediating taxa, we randomly selected two clades with three descendant taxa in each and assigned the six OTUs as mediators. We generated 2000 simulated datasets for each setting.</p>
      <p id="Par55">To perturb the abundance of each treatment-associated OTU <inline-formula id="IEq204"><alternatives><tex-math id="M429">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k\in \mathcal {S}_\alpha$$\end{document}</tex-math><mml:math id="M430"><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq204.gif"/></alternatives></inline-formula>, we randomly decide if we change the abundance of the OTU in the treatment group or the control group with equal probability. For each subject <italic>i</italic> in the chosen group, we increased its abundance by adding a random count sampled from <inline-formula id="IEq205"><alternatives><tex-math id="M431">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Binomial(N_i, Af_k)$$\end{document}</tex-math><mml:math id="M432"><mml:mrow><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq205.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq206"><alternatives><tex-math id="M433">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_i$$\end{document}</tex-math><mml:math id="M434"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq206.gif"/></alternatives></inline-formula> is the sequencing depth of subject <italic>i</italic>, <inline-formula id="IEq207"><alternatives><tex-math id="M435">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_k$$\end{document}</tex-math><mml:math id="M436"><mml:msub><mml:mi>f</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq207.gif"/></alternatives></inline-formula> is the average observed proportion of OTU <italic>k</italic> across all the samples in the data, <italic>A</italic> controls the strength of the treatment-mediator association, and we set <inline-formula id="IEq208"><alternatives><tex-math id="M437">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A={0.5}$$\end{document}</tex-math><mml:math id="M438"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.5</mml:mn></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq208.gif"/></alternatives></inline-formula>. To simulate the outcome, we used the log-contrast regression model [<xref ref-type="bibr" rid="CR33">33</xref>] that imposes a zero-sum constraint on the association coefficients to account for the compositional nature of the covariates. In our simulation, we considered both continuous and binary outcomes. For the continuous outcome, we generated data from the linear log-contrast regression model<disp-formula id="Equ12"><alternatives><tex-math id="M439">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} Y_i = \beta _T T_i + \sum _{k\in \mathcal {S}_\beta } {\beta _k} \log (f_{ik}) + \epsilon _i, ~~ \text {subject to} \sum _{k\in \mathcal {S}_\beta } {\beta _k}=0, \end{aligned}$$\end{document}</tex-math><mml:math id="M440" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>β</mml:mi></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="3.33333pt"/><mml:mspace width="3.33333pt"/><mml:mtext>subject to</mml:mtext><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>β</mml:mi></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_2902_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq209"><alternatives><tex-math id="M441">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{ik}$$\end{document}</tex-math><mml:math id="M442"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq209.gif"/></alternatives></inline-formula> is the observed proportion of OTU <italic>k</italic> in subject <italic>i</italic> and <inline-formula id="IEq210"><alternatives><tex-math id="M443">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon _i$$\end{document}</tex-math><mml:math id="M444"><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq210.gif"/></alternatives></inline-formula> is the zero-mean normal error. For the binary outcome, we generated data from the logistic log-contrast regression model<disp-formula id="Equ13"><alternatives><tex-math id="M445">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \text {logit}\{Pr(Y_i=1)\} = \beta _T T_i + \sum _{k\in \mathcal {S}_\beta } {\beta _k} \log (f_{ik}), ~~ \text {subject to} \sum _{k\in \mathcal {S}_\beta } {\beta _k}=0. \end{aligned}$$\end{document}</tex-math><mml:math id="M446" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>logit</mml:mtext><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>β</mml:mi></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="3.33333pt"/><mml:mspace width="3.33333pt"/><mml:mtext>subject to</mml:mtext><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>β</mml:mi></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_2902_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par56">In these models, the coefficient <inline-formula id="IEq211"><alternatives><tex-math id="M447">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _T$$\end{document}</tex-math><mml:math id="M448"><mml:msub><mml:mi>β</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq211.gif"/></alternatives></inline-formula> was sampled from <italic>Uniform</italic>(0, 1) and <inline-formula id="IEq212"><alternatives><tex-math id="M449">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _k$$\end{document}</tex-math><mml:math id="M450"><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq212.gif"/></alternatives></inline-formula>’s were sampled from <italic>Uniform</italic>(0, <italic>B</italic>), where <italic>B</italic> controls the strength of the mediator-outcome association, and we set <inline-formula id="IEq213"><alternatives><tex-math id="M451">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B=0.5$$\end{document}</tex-math><mml:math id="M452"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq213.gif"/></alternatives></inline-formula>. The values of <inline-formula id="IEq214"><alternatives><tex-math id="M453">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _k$$\end{document}</tex-math><mml:math id="M454"><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq214.gif"/></alternatives></inline-formula>’s were centered such that the zero-sum constraint was satisfied.</p>
      <p id="Par57">Additional simulation study was performed to evaluate the power of the PhyloMed global test with more taxa (especially the rare taxa). We include all OTUs in the basis dataset (rather than the top 100 in the default setting). In each simulated data, we retained OTUs with at least one non-zero observation. With the sample size of 200, the median number of retained OTUs across replicates of simulation is 422.</p>
      <p id="Par58">To evaluate the performance of different methods when the mediation signals are denser and the mediating OTUs are randomly scattered rather than clustered on the tree, we conducted another set of simulations with the continuous outcome. Specifically, we considered 3, 6, and 15 randomly scattered mediating OTUs. We also lowered the mediation effect size by decreasing <italic>A</italic> to 0.001 to evaluate how PhyloMed performs under challenging cases.</p>
    </sec>
    <sec id="Sec16">
      <title>Software tools</title>
      <p id="Par59">MedTest: R package “MedTest” version 1.1, <ext-link ext-link-type="uri" xlink:href="https://github.com/jchen1981/MedTest">https://github.com/jchen1981/MedTest</ext-link></p>
      <p id="Par60">MODIMA: R script “modima.R”, <ext-link ext-link-type="uri" xlink:href="https://github.com/alekseyenko/MODIMA">https://github.com/alekseyenko/MODIMA</ext-link></p>
      <p id="Par61">LDM-med: R package “LDM” version 5.0, <ext-link ext-link-type="uri" xlink:href="https://github.com/yijuanhu/LDM">https://github.com/yijuanhu/LDM</ext-link></p>
      <p id="Par62">CMM: R package “ccmm” version 1.0 on CRAN</p>
      <p id="Par63">microHIMA: R package “HIMA” version 2.0.1, <ext-link ext-link-type="uri" xlink:href="https://github.com/YinanZheng/HIMA">https://github.com/YinanZheng/HIMA</ext-link></p>
      <p id="Par64">Sensitivity analysis: R package “mediation” version 4.5.0 on CRAN</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec17">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2023_2902_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1.</bold> Note A: Definition of mediation effect via potential outcomes framework and identifiability assumptions; Note B: Details on obtaining <inline-formula id="IEq215"><alternatives><tex-math id="M455">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\alpha}$$\end{document}</tex-math><mml:math id="M456"><mml:msub><mml:mi>p</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq215.gif"/></alternatives></inline-formula> and <inline-formula id="IEq216"><alternatives><tex-math id="M457">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\beta}$$\end{document}</tex-math><mml:math id="M458"><mml:msub><mml:mi>p</mml:mi><mml:mi>β</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2902_Article_IEq216.gif"/></alternatives></inline-formula>; Note C: Sobel’s test and joint significance test; Table S1-S6; Figure S1-S9.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2023_2902_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2.</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank editors and three anonymous reviewers for insightful comments and suggestions that helped improve the quality of the manuscript.</p>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par65">Kevin Pang was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
    <sec id="FPar2">
      <title>Review history</title>
      <p id="Par66">The review history is available as Additional file <xref rid="MOESM2" ref-type="media">2</xref>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>ZZT oversaw the study. The theory underlying PhyloMed was conceived of and developed by ZZT, with contributions from GC and QH. QH performed simulation studies, real data analyses and developed miMediation R package. ZZT wrote the first version of the manuscript. QH and GC also contributed to the writing. The authors read and approved the final manuscript.</p>
    <sec id="FPar3">
      <title>Authors’ Twitter handles</title>
      <p id="Par67">Twitter handles: @tangzz_lab (Zheng-Zheng Tang).</p>
    </sec>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the NIH grant R01GM140464, NSF grant DMS-2054346, University of Wisconsin-Madison Center for Demography of Health and Aging (CDHA) pilot grant, and Data Science Initiative Award provided by the University of Wisconsin-Madison Office of the Chancellor and the Vice Chancellor for Research and Graduate Education with funding from the Wisconsin Alumni Research Foundation.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The proposed method is implemented in the R package miMediation, publicly available at Github: <ext-link ext-link-type="uri" xlink:href="https://github.com/KiRinHong/miMediation">https://github.com/KiRinHong/miMediation</ext-link> [<xref ref-type="bibr" rid="CR56">56</xref>]. The scripts generating reported results are deposited at Zenodo: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.7443578">https://doi.org/10.5281/zenodo.7443578</ext-link> [<xref ref-type="bibr" rid="CR57">57</xref>]. Both repositories are licensed under the open-source GPL-3.0. The mouse cecal microbiome data are available at the NLM repository under the accession ID: BioProject 168618 [<xref ref-type="bibr" rid="CR34">34</xref>]. The human gut microbiome data are available at the Qiita repository under the accession ID: 1011 [<xref ref-type="bibr" rid="CR35">35</xref>].</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar4">
      <title>Ethics approval and consent to participate</title>
      <p id="Par68">Not applicable.</p>
    </notes>
    <notes id="FPar5">
      <title>Consent for publication</title>
      <p id="Par69">Not applicable.</p>
    </notes>
    <notes id="FPar6" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par70">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fessler</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Matson</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Gajewski</surname>
            <given-names>TF</given-names>
          </name>
        </person-group>
        <article-title>Exploring the emerging role of the microbiome in cancer immunotherapy</article-title>
        <source>J Immunother Cancer.</source>
        <year>2019</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>108</fpage>
        <pub-id pub-id-type="doi">10.1186/s40425-019-0574-4</pub-id>
        <?supplied-pmid 30995949?>
        <pub-id pub-id-type="pmid">30995949</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baron</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Kenny</surname>
            <given-names>DA</given-names>
          </name>
        </person-group>
        <article-title>The moderator-mediator variable distinction in social psychological research: Conceptual, strategic, and statistical considerations</article-title>
        <source>J Personal Soc Psychol.</source>
        <year>1986</year>
        <volume>51</volume>
        <issue>6</issue>
        <fpage>1173</fpage>
        <pub-id pub-id-type="doi">10.1037/0022-3514.51.6.1173</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">MacKinnon DP. Introduction to statistical mediation analysis. London, UK: Routledge; 2012.
</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>VanderWeele</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Vansteelandt</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Mediation analysis with multiple mediators</article-title>
        <source>Epidemiol Methods.</source>
        <year>2014</year>
        <volume>2</volume>
        <issue>1</issue>
        <fpage>95</fpage>
        <lpage>115</lpage>
        <pub-id pub-id-type="doi">10.1515/em-2012-0010</pub-id>
        <?supplied-pmid 25580377?>
        <pub-id pub-id-type="pmid">25580377</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Daniel</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>De Stavola</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Cousens</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Vansteelandt</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Causal mediation analysis with multiple mediators</article-title>
        <source>Biometrics.</source>
        <year>2015</year>
        <volume>71</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1111/biom.12248</pub-id>
        <?supplied-pmid 25351114?>
        <pub-id pub-id-type="pmid">25351114</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Joyce</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Yoon</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Estimating and testing high-dimensional mediation effects in epigenetic studies</article-title>
        <source>Bioinformatics.</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>20</issue>
        <fpage>3150</fpage>
        <lpage>3154</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw351</pub-id>
        <?supplied-pmid 27357171?>
        <pub-id pub-id-type="pmid">27357171</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>YT</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>WC</given-names>
          </name>
        </person-group>
        <article-title>Hypothesis test of mediation effect in causal mediation model with high-dimensional continuous mediators</article-title>
        <source>Biometrics.</source>
        <year>2016</year>
        <volume>72</volume>
        <issue>2</issue>
        <fpage>402</fpage>
        <lpage>413</lpage>
        <pub-id pub-id-type="doi">10.1111/biom.12421</pub-id>
        <?supplied-pmid 26414245?>
        <pub-id pub-id-type="pmid">26414245</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>YT</given-names>
          </name>
        </person-group>
        <article-title>Variance component tests of multivariate mediation effects under composite null hypotheses</article-title>
        <source>Biometrics.</source>
        <year>2019</year>
        <volume>75</volume>
        <issue>4</issue>
        <fpage>1191</fpage>
        <lpage>1204</lpage>
        <pub-id pub-id-type="doi">10.1111/biom.13073</pub-id>
        <?supplied-pmid 31009061?>
        <pub-id pub-id-type="pmid">31009061</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robins</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Greenland</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Identifiability and exchangeability for direct and indirect effects</article-title>
        <source>Epidemiology.</source>
        <year>1992</year>
        <volume>3</volume>
        <issue>2</issue>
        <fpage>143</fpage>
        <lpage>155</lpage>
        <pub-id pub-id-type="doi">10.1097/00001648-199203000-00013</pub-id>
        <?supplied-pmid 1576220?>
        <pub-id pub-id-type="pmid">1576220</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>VanderWeele</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Vansteelandt</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Conceptual issues concerning mediation, interventions and composition</article-title>
        <source>Stat Interface.</source>
        <year>2009</year>
        <volume>2</volume>
        <issue>4</issue>
        <fpage>457</fpage>
        <lpage>468</lpage>
        <pub-id pub-id-type="doi">10.4310/SII.2009.v2.n4.a7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Imai</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Keele</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yamamoto</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Identification, inference and sensitivity analysis for causal mediation effects</article-title>
        <source>Stat Sci.</source>
        <year>2010</year>
        <volume>25</volume>
        <issue>1</issue>
        <fpage>51</fpage>
        <lpage>71</lpage>
        <pub-id pub-id-type="doi">10.1214/10-STS321</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Caporaso</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Kuczynski</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Stombaugh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bittinger</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bushman</surname>
            <given-names>FD</given-names>
          </name>
          <name>
            <surname>Costello</surname>
            <given-names>EK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>QIIME allows analysis of high-throughput community sequencing data</article-title>
        <source>Nat Methods.</source>
        <year>2010</year>
        <volume>7</volume>
        <issue>5</issue>
        <fpage>335</fpage>
        <lpage>336</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.f.303</pub-id>
        <?supplied-pmid 20383131?>
        <pub-id pub-id-type="pmid">20383131</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Callahan</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>McMurdie</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Rosen</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>AJA</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>SP</given-names>
          </name>
        </person-group>
        <article-title>DADA2: high-resolution sample inference from Illumina amplicon data</article-title>
        <source>Nat Methods.</source>
        <year>2016</year>
        <volume>13</volume>
        <issue>7</issue>
        <fpage>581</fpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3869</pub-id>
        <?supplied-pmid 27214047?>
        <pub-id pub-id-type="pmid">27214047</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mandal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Van Treuren</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Eggesbø</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Peddada</surname>
            <given-names>SD</given-names>
          </name>
        </person-group>
        <article-title>Analysis of composition of microbiomes: a novel method for studying microbial composition</article-title>
        <source>Microb Ecol Health Dis.</source>
        <year>2015</year>
        <volume>26</volume>
        <issue>1</issue>
        <fpage>27663</fpage>
        <?supplied-pmid 26028277?>
        <pub-id pub-id-type="pmid">26028277</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hawinkel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mattiello</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Bijnens</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Thas</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>A broken promise: microbiome differential abundance methods do not control the false discovery rate</article-title>
        <source>Brief Bioinforma.</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>210</fpage>
        <lpage>221</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbx104</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morton</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Marotz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Washburne</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Silverman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zaramela</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>Edlund</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Establishing microbial composition measurement standards with reference frames</article-title>
        <source>Nat Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-10656-5</pub-id>
        <pub-id pub-id-type="pmid">30602773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A distance-based approach for testing the mediation effect of the human microbiome</article-title>
        <source>Bioinformatics.</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>11</issue>
        <fpage>1875</fpage>
        <lpage>1883</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty014</pub-id>
        <?supplied-pmid 29346509?>
        <pub-id pub-id-type="pmid">29346509</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hamidi</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wallace</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Alekseyenko</surname>
            <given-names>AV</given-names>
          </name>
        </person-group>
        <article-title>MODIMA, a Method for Multivariate Omnibus Distance Mediation Analysis, Allows for Integration of Multivariate Exposure-Mediator-Response Relationships</article-title>
        <source>Genes.</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>7</issue>
        <fpage>524</fpage>
        <pub-id pub-id-type="doi">10.3390/genes10070524</pub-id>
        <?supplied-pmid 31336807?>
        <pub-id pub-id-type="pmid">31336807</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yue</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>YJ</given-names>
          </name>
        </person-group>
        <article-title>A new approach to testing mediation of the microbiome at both the community and individual taxon levels</article-title>
        <source>Bioinformatics.</source>
        <year>2022</year>
        <volume>38</volume>
        <issue>12</issue>
        <fpage>3173</fpage>
        <lpage>3180</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btac310</pub-id>
        <?supplied-pmid 35512399?>
        <pub-id pub-id-type="pmid">35512399</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sohn</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Compositional mediation analysis for microbiome studies</article-title>
        <source>Ann Appl Stat.</source>
        <year>2019</year>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>661</fpage>
        <lpage>681</lpage>
        <pub-id pub-id-type="doi">10.1214/18-AOAS1210</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Blaser</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Estimating and testing the microbial causal mediation effect with high-dimensional and compositional microbiome data</article-title>
        <source>Bioinformatics.</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>2</issue>
        <fpage>347</fpage>
        <lpage>355</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz565</pub-id>
        <?supplied-pmid 31329243?>
        <pub-id pub-id-type="pmid">31329243</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Testing for mediation effect with application to human microbiome data</article-title>
        <source>Stat Biosci.</source>
        <year>2021</year>
        <volume>13</volume>
        <issue>2</issue>
        <fpage>313</fpage>
        <lpage>328</lpage>
        <pub-id pub-id-type="doi">10.1007/s12561-019-09253-3</pub-id>
        <?supplied-pmid 34093887?>
        <pub-id pub-id-type="pmid">34093887</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Mediation effect selection in high-dimensional and compositional microbiome data</article-title>
        <source>Stat Med.</source>
        <year>2021</year>
        <volume>40</volume>
        <issue>4</issue>
        <fpage>885</fpage>
        <lpage>896</lpage>
        <pub-id pub-id-type="doi">10.1002/sim.8808</pub-id>
        <?supplied-pmid 33205470?>
        <pub-id pub-id-type="pmid">33205470</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sobel</surname>
            <given-names>ME</given-names>
          </name>
        </person-group>
        <article-title>Asymptotic confidence intervals for indirect effects in structural equation models</article-title>
        <source>Sociol Methodol.</source>
        <year>1982</year>
        <volume>13</volume>
        <fpage>290</fpage>
        <lpage>312</lpage>
        <pub-id pub-id-type="doi">10.2307/270723</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>MacKinnon</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Lockwood</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>West</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Sheets</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>A comparison of methods to test mediation and other intervening variable effects</article-title>
        <source>Psychol Methods.</source>
        <year>2002</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>83</fpage>
        <pub-id pub-id-type="doi">10.1037/1082-989X.7.1.83</pub-id>
        <?supplied-pmid 11928892?>
        <pub-id pub-id-type="pmid">11928892</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Washburne</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Morton</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Sanders</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>McDonald</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Oliverio</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Methods for phylogenetic analysis of microbiome data</article-title>
        <source>Nat Microbiol.</source>
        <year>2018</year>
        <volume>3</volume>
        <issue>6</issue>
        <fpage>652</fpage>
        <lpage>661</lpage>
        <pub-id pub-id-type="doi">10.1038/s41564-018-0156-0</pub-id>
        <?supplied-pmid 29795540?>
        <pub-id pub-id-type="pmid">29795540</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>ZZ</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Alekseyenko</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A general framework for association analysis of microbial communities on a taxonomic tree</article-title>
        <source>Bioinformatics.</source>
        <year>2017</year>
        <volume>33</volume>
        <issue>9</issue>
        <fpage>1278</fpage>
        <lpage>1285</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw804</pub-id>
        <?supplied-pmid 28003264?>
        <pub-id pub-id-type="pmid">28003264</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A Dirichlet-tree multinomial regression model for associating dietary nutrients with gut microorganisms</article-title>
        <source>Biometrics.</source>
        <year>2017</year>
        <volume>73</volume>
        <issue>3</issue>
        <fpage>792</fpage>
        <lpage>801</lpage>
        <pub-id pub-id-type="doi">10.1111/biom.12654</pub-id>
        <?supplied-pmid 28112797?>
        <pub-id pub-id-type="pmid">28112797</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>J R Stat Soc Ser B (Methodol).</source>
        <year>1995</year>
        <volume>57</volume>
        <issue>1</issue>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilson</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>The harmonic mean p-value for combining dependent tests</article-title>
        <source>Proc Natl Acad Sci.</source>
        <year>2019</year>
        <volume>116</volume>
        <issue>4</issue>
        <fpage>1195</fpage>
        <lpage>1200</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1814092116</pub-id>
        <?supplied-pmid 30610179?>
        <pub-id pub-id-type="pmid">30610179</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barfield</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Just</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Vokonas</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Schwartz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Baccarelli</surname>
            <given-names>AA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Testing for the indirect effect under the null for genome-wide mediation analyses</article-title>
        <source>Genet Epidemiol.</source>
        <year>2017</year>
        <volume>41</volume>
        <issue>8</issue>
        <fpage>824</fpage>
        <lpage>833</lpage>
        <pub-id pub-id-type="doi">10.1002/gepi.22084</pub-id>
        <?supplied-pmid 29082545?>
        <pub-id pub-id-type="pmid">29082545</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeevi</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Korem</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zmora</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Israeli</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rothschild</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Weinberger</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Personalized nutrition by prediction of glycemic responses</article-title>
        <source>Cell.</source>
        <year>2015</year>
        <volume>163</volume>
        <issue>5</issue>
        <fpage>1079</fpage>
        <lpage>1094</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.11.001</pub-id>
        <?supplied-pmid 26590418?>
        <pub-id pub-id-type="pmid">26590418</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Variable selection in regression with compositional covariates</article-title>
        <source>Biometrika.</source>
        <year>2014</year>
        <volume>101</volume>
        <issue>4</issue>
        <fpage>785</fpage>
        <lpage>797</lpage>
        <pub-id pub-id-type="doi">10.1093/biomet/asu031</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cho</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Yamanishi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cox</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Methé</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Zavadil</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Antibiotics in early life alter the murine colonic microbiome and adiposity</article-title>
        <source>Nature.</source>
        <year>2012</year>
        <volume>488</volume>
        <issue>7413</issue>
        <fpage>621</fpage>
        <lpage>626</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11400</pub-id>
        <?supplied-pmid 22914093?>
        <pub-id pub-id-type="pmid">22914093</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hoffmann</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bittinger</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>YY</given-names>
          </name>
          <name>
            <surname>Keilbaugh</surname>
            <given-names>SA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Linking long-term dietary patterns with gut microbial enterotypes</article-title>
        <source>Science.</source>
        <year>2011</year>
        <volume>334</volume>
        <issue>6052</issue>
        <fpage>105</fpage>
        <lpage>108</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1208344</pub-id>
        <?supplied-pmid 21885731?>
        <pub-id pub-id-type="pmid">21885731</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Salonen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lahti</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Salojärvi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Holtrop</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Korpela</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Duncan</surname>
            <given-names>SH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Impact of diet and individual variation on intestinal microbiota composition and fermentation products in obese men</article-title>
        <source>ISME J.</source>
        <year>2014</year>
        <volume>8</volume>
        <issue>11</issue>
        <fpage>2218</fpage>
        <lpage>2230</lpage>
        <pub-id pub-id-type="doi">10.1038/ismej.2014.63</pub-id>
        <?supplied-pmid 24763370?>
        <pub-id pub-id-type="pmid">24763370</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kaliannan</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Hui</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gut microbiota mediates the protective effects of dietary capsaicin against chronic low-grade inflammation and associated obesity induced by high-fat diet</article-title>
        <source>MBio.</source>
        <year>2017</year>
        <volume>8</volume>
        <issue>3</issue>
        <fpage>e00470–17</fpage>
        <pub-id pub-id-type="doi">10.1128/mBio.00470-17</pub-id>
        <?supplied-pmid 28536285?>
        <pub-id pub-id-type="pmid">28536285</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Benjamini Y, Yekutieli D. Hierarchical FDR testing of trees of hypotheses. Technical report, Department of Statistics and Operations Research, Tel Aviv ...; 2003.</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Barber</surname>
            <given-names>RF</given-names>
          </name>
        </person-group>
        <article-title>Multiple testing with the structure-adaptive Benjamini-Hochberg algorithm</article-title>
        <source>J R Stat Soc Ser B (Stat Methodol).</source>
        <year>2019</year>
        <volume>81</volume>
        <issue>1</issue>
        <fpage>45</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1111/rssb.12298</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lei</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ramdas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fithian</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>A general interactive framework for false discovery rate control under structural constraints</article-title>
        <source>Biometrika.</source>
        <year>2021</year>
        <volume>108</volume>
        <issue>2</issue>
        <fpage>253</fpage>
        <lpage>267</lpage>
        <pub-id pub-id-type="doi">10.1093/biomet/asaa064</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>La Rosa</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Brooks</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Deych</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Boone</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Q</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Hypothesis testing and power calculations for taxonomic-based human microbiome data</article-title>
        <source>PloS ONE.</source>
        <year>2012</year>
        <volume>7</volume>
        <issue>12</issue>
        <fpage>e52078</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0052078</pub-id>
        <?supplied-pmid 23284876?>
        <pub-id pub-id-type="pmid">23284876</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lavine</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Some aspects of Polya tree distributions for statistical modelling</article-title>
        <source>Ann Stat.</source>
        <year>1992</year>
        <volume>20</volume>
        <issue>3</issue>
        <fpage>1222</fpage>
        <lpage>1235</lpage>
        <pub-id pub-id-type="doi">10.1214/aos/1176348767</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Nicolae</surname>
            <given-names>DL</given-names>
          </name>
        </person-group>
        <article-title>A phylogenetic scan test on a Dirichlet-tree multinomial model for microbiome data</article-title>
        <source>Ann Appl Stat.</source>
        <year>2018</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>26</lpage>
        <pub-id pub-id-type="doi">10.1214/17-AOAS1086</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dennis</surname>
            <given-names>SY</given-names>
            <suffix>III</suffix>
          </name>
        </person-group>
        <article-title>On the hyper-Dirichlet type 1 and hyper-Liouville distributions</article-title>
        <source>Commun Stat-Theory Methods.</source>
        <year>1991</year>
        <volume>20</volume>
        <issue>12</issue>
        <fpage>4069</fpage>
        <lpage>4081</lpage>
        <pub-id pub-id-type="doi">10.1080/03610929108830757</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Aitchison</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>The statistical analysis of compositional data</source>
        <year>1986</year>
        <publisher-loc>London</publisher-loc>
        <publisher-name>CRC Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Costea</surname>
            <given-names>PI</given-names>
          </name>
          <name>
            <surname>Zeller</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sunagawa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>A fair comparison</article-title>
        <source>Nat Methods.</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>4</issue>
        <fpage>359</fpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2897</pub-id>
        <?supplied-pmid 24681719?>
        <pub-id pub-id-type="pmid">24681719</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weiss</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>ZZ</given-names>
          </name>
          <name>
            <surname>Peddada</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Amir</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bittinger</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gonzalez</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Normalization and microbial differential abundance strategies depend upon data characteristics</article-title>
        <source>Microbiome.</source>
        <year>2017</year>
        <volume>5</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1186/s40168-017-0237-y</pub-id>
        <pub-id pub-id-type="pmid">28086968</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>VanderWeele</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Vansteelandt</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Odds ratios for mediation analysis for a dichotomous outcome</article-title>
        <source>Am J Epidemiol.</source>
        <year>2010</year>
        <volume>172</volume>
        <issue>12</issue>
        <fpage>1339</fpage>
        <lpage>1348</lpage>
        <pub-id pub-id-type="doi">10.1093/aje/kwq332</pub-id>
        <?supplied-pmid 21036955?>
        <pub-id pub-id-type="pmid">21036955</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>YT</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide analyses of sparse mediation effects under composite null hypotheses</article-title>
        <source>Ann Appl Stat.</source>
        <year>2019</year>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>60</fpage>
        <lpage>84</lpage>
        <pub-id pub-id-type="doi">10.1214/18-AOAS1181</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dai</surname>
            <given-names>JY</given-names>
          </name>
          <name>
            <surname>Stanford</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>LeBlanc</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A multiple-testing procedure for high-dimensional mediation hypotheses</article-title>
        <source>J Am Stat Assoc.</source>
        <year>2022</year>
        <volume>117</volume>
        <issue>537</issue>
        <fpage>198</fpage>
        <lpage>213</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.2020.1765785</pub-id>
        <?supplied-pmid 35400115?>
        <pub-id pub-id-type="pmid">35400115</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Barfield</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Schwartz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Baccarelli</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Large-scale hypothesis testing for causal mediation effects with applications in genome-wide epigenetic studies</article-title>
        <source>J Am Stat Assoc.</source>
        <year>2022</year>
        <volume>117</volume>
        <issue>537</issue>
        <fpage>67</fpage>
        <lpage>81</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.2021.1914634</pub-id>
        <?supplied-pmid 35989709?>
        <pub-id pub-id-type="pmid">35989709</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Large-scale simultaneous hypothesis testing: the choice of a null hypothesis</article-title>
        <source>J Am Stat Assoc.</source>
        <year>2004</year>
        <volume>99</volume>
        <issue>465</issue>
        <fpage>96</fpage>
        <lpage>104</lpage>
        <pub-id pub-id-type="doi">10.1198/016214504000000089</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Knijnenburg</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Wessels</surname>
            <given-names>LF</given-names>
          </name>
          <name>
            <surname>Reinders</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Shmulevich</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Fewer permutations, more accurate P-values</article-title>
        <source>Bioinformatics.</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>12</issue>
        <fpage>i161</fpage>
        <lpage>i168</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp211</pub-id>
        <?supplied-pmid 19477983?>
        <pub-id pub-id-type="pmid">19477983</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>TT</given-names>
          </name>
        </person-group>
        <article-title>Estimating the null and the proportion of nonnull effects in large-scale multiple comparisons</article-title>
        <source>J Am Stat Assoc.</source>
        <year>2007</year>
        <volume>102</volume>
        <issue>478</issue>
        <fpage>495</fpage>
        <lpage>506</lpage>
        <pub-id pub-id-type="doi">10.1198/016214507000000167</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langaas</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lindqvist</surname>
            <given-names>BH</given-names>
          </name>
          <name>
            <surname>Ferkingstad</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Estimating the proportion of true null hypotheses, with application to DNA microarray data</article-title>
        <source>J R Stat Soc Ser B (Stat Methodol).</source>
        <year>2005</year>
        <volume>67</volume>
        <issue>4</issue>
        <fpage>555</fpage>
        <lpage>572</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1467-9868.2005.00515.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <mixed-citation publication-type="other">Hong Q, Chen G, Tang ZZ. PhyloMed: a phylogeny-based test of mediation effect in microbiome. Github. 2022. <ext-link ext-link-type="uri" xlink:href="https://github.com/KiRinHong/miMediation">https://github.com/KiRinHong/miMediation</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <mixed-citation publication-type="other">Hong Q, Chen G, Tang ZZ. PhyloMed: a phylogeny-based test of mediation effect in microbiome. Zenodo. 2022. 10.5281/zenodo.7443578.</mixed-citation>
    </ref>
  </ref-list>
</back>
