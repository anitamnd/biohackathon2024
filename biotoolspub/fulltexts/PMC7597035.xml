<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7597035</article-id>
    <article-id pub-id-type="publisher-id">3830</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-020-03830-w</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CosinorPy: a python package for cosinor-based rhythmometry</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4600-1730</contrib-id>
        <name>
          <surname>Moškon</surname>
          <given-names>Miha</given-names>
        </name>
        <address>
          <email>miha.moskon@fri.uni-lj.si</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.8954.0</institution-id><institution-id institution-id-type="ISNI">0000 0001 0721 6013</institution-id><institution>Faculty of Computer and Information Science, </institution><institution>University of Ljubljana, </institution></institution-wrap>Večna pot 113, 1000 Ljubljana, Slovenia </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>10</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>10</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>485</elocation-id>
    <history>
      <date date-type="received">
        <day>3</day>
        <month>7</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>10</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Even though several computational methods for rhythmicity detection and analysis of biological data have been proposed in recent years, classical trigonometric regression based on cosinor still has several advantages over these methods and is still widely used. Different software packages for cosinor-based rhythmometry exist, but lack certain functionalities and require data in different, non-unified input formats.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We present CosinorPy, a Python implementation of cosinor-based methods for rhythmicity detection and analysis. CosinorPy merges and extends the functionalities of existing cosinor packages. It supports the analysis of rhythmic data using single- or multi-component cosinor models, automatic selection of the best model, population-mean cosinor regression, and differential rhythmicity assessment. Moreover, it implements functions that can be used in a design of experiments, a synthetic data generator, and import and export of data in different formats.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">CosinorPy is an easy-to-use Python package for straightforward detection and analysis of rhythmicity requiring minimal statistical knowledge, and produces publication-ready figures. Its code, examples, and documentation are available to download from <ext-link ext-link-type="uri" xlink:href="https://github.com/mmoskon/CosinorPy">https://github.com/mmoskon/CosinorPy</ext-link>. CosinorPy can be installed manually or by using pip, the package manager for Python packages. The implementation reported in this paper corresponds to the software release v1.1.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Cosinor</kwd>
      <kwd>Rhythmicity analysis</kwd>
      <kwd>Circadian analysis</kwd>
      <kwd>Regression</kwd>
      <kwd>Python</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004329</institution-id>
            <institution>Javna Agencija za Raziskovalno Dejavnost RS</institution>
          </institution-wrap>
        </funding-source>
        <award-id>P2-0359</award-id>
        <award-id>J1-9176</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004329</institution-id>
            <institution>Javna Agencija za Raziskovalno Dejavnost RS</institution>
          </institution-wrap>
        </funding-source>
        <award-id>J5-1798</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par13">Many biological processes display oscillations that are under the control of different biological clocks. For example, circadian clocks display daily oscillations, i.e., with a periodicity of approximately 24 h [<xref ref-type="bibr" rid="CR1">1</xref>], and may regulate nearly half of all genes in a genome of an organism [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>]. Disrupted circadian rhythms might have several health implications, such as cardiovascular diseases, diabetes, and immune deficiencies [<xref ref-type="bibr" rid="CR4">4</xref>]. Analysis of circadian data, especially in the combination with different -omics approaches, thus increases our understanding of disease occurrence and progression. A vast amount of research has been devoted to the analysis of circadian rhythms in recent years [<xref ref-type="bibr" rid="CR5">5</xref>]. We should as well strive towards the integration of such analyses into the clinical work for disease diagnostics, treatment, and prevention [<xref ref-type="bibr" rid="CR6">6</xref>].</p>
    <p id="Par14">Detection and analysis of rhythmicity requires designated computational approaches. These approaches are focused on the identification of rhythmic datasets that correspond to specific biological entities (e.g., genes) and evaluation of their rhythmicity parameters. Several non-parametric methods for circadian data analysis have been proposed recently, such as JTK CYCLE and its extensions [<xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR9">9</xref>] and RAIN [<xref ref-type="bibr" rid="CR10">10</xref>]. Even though non-parametric methods have several benefits, e.g., robustness to noise in the data, classical harmonic regression should still be used when rhythmicity parameters, such as oscillation amplitudes and acrophases, need to be evaluated, or when the noise in the data is non-Gaussian [<xref ref-type="bibr" rid="CR10">10</xref>]. Moreover, non-parametric methods often fail or do not perform well when data are (1) collected at irregular intervals, (2) without replicates, (3) unbalanced (i.e., more samples are collected at one time of a day compared to others), (4) full of outliers, and (5) very large. However, cosinor has been successfully applied even in such cases (see, e.g., [<xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR13">13</xref>]).</p>
    <p id="Par15">Cosinor presents a fundamental method for rhythmicity detection and analysis using cosine curve fitting [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR15">15</xref>]. It is based on a trigonometric regression model<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} y(t) = \sum _{i=1}^{N} \left( A_{i,1} \cdot \sin \left( \frac{t}{P/i} \cdot 2 \pi \right) \right. + \left. A_{i,2} \cdot \cos \left( \frac{t}{P/i} \cdot 2 \pi \right) \right) + M + e(t), \end{aligned}$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>y</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mfenced open="("><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mo>sin</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mi>t</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mfrac><mml:mo>·</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mfenced></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close=")"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mo>cos</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mi>t</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mfrac><mml:mo>·</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mfenced></mml:mfenced><mml:mo>+</mml:mo><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2020_3830_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <italic>t</italic> corresponds to the observed time points in the time series, <italic>N</italic> is the number of components in the model, namely number of cosine curves, and <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_{i,1}$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3830_Article_IEq1.gif"/></alternatives></inline-formula>, <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_{i,2}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3830_Article_IEq2.gif"/></alternatives></inline-formula>, <italic>C</italic> and <italic>P</italic> are the parameters of the model, with <italic>M</italic> being the MESOR (Midline Statistic Of Rhythm), <italic>P</italic> the period of the observed rhythm, and <italic>e</italic>(<italic>t</italic>) the error term [<xref ref-type="bibr" rid="CR15">15</xref>]. When the period is known the model can be converted to a linear regression model<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} y(t) = \sum _{i=1}^{N} \left( A_{i,1} \cdot x_{i,1} + A_{i,2} \cdot x_{i,2}\right) + M+e(t), \end{aligned}$$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>y</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mfenced close=")" open="("><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2020_3830_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq3"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{i,1} = \sin \left( \frac{t}{P/i} \cdot 2 \pi \right)$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>sin</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mi>t</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mfrac><mml:mo>·</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3830_Article_IEq3.gif"/></alternatives></inline-formula> and <inline-formula id="IEq4"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{i,2} = \cos \left( \frac{t}{P/i} \cdot 2 \pi \right)$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>cos</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mi>t</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mfrac><mml:mo>·</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3830_Article_IEq4.gif"/></alternatives></inline-formula>. When the period is not known, different periods within the feasible period ranges can be tested, or period detection methods such as periodograms, can be used for period estimation [<xref ref-type="bibr" rid="CR14">14</xref>].</p>
    <p id="Par16">Cosinor has been widely applied to the analysis of rhythmicity detection and evaluation of rhythmicity parameters in time series data. Different software packages for cosinor-based rhythmometry, such as cosinor [<xref ref-type="bibr" rid="CR16">16</xref>], cosinor2 [<xref ref-type="bibr" rid="CR17">17</xref>], and DiscoRhythm [<xref ref-type="bibr" rid="CR18">18</xref>], have been introduced in recent years. However, these packages lack certain functionalities, such as multi-component cosinor regression and analysis, and do not support automatic identification of the best regression model. Moreover, the user must format the input data for each of these tools in a different manner. Herein, we describe CosinorPy, a Python package that merges and extends the functionalities of existing software packages. CosinorPy can as well be used to generate synthetic data, and supports different input and output formats compatible with other software packages for rhythmicity detection and analysis. It provides all functionalities required for the analysis of rhythmic data from data import and preprocessing to removal of outliers, identification of oscillation periods, assessment of the most suitable models and their statistics, analysis of differential rhythmicity, and data plotting, reporting, and export. Moreover, it implements functions to estimate the required number of samples to obtain the results with a predefined statistical significance and can thus as well be used to guide experimental work [<xref ref-type="bibr" rid="CR19">19</xref>]. CosinorPy is currently the only cosinor package that is implemented in Python, which has become increasingly important in data science, as well as in the field of bioinformatics in recent years. A comparison of features of currently available cosinor-based software packages is provided in Table <xref rid="Tab1" ref-type="table">1</xref>.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Currently available software packages for rhythmicity detection and analysis based on cosinor method and its extensions</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Package</th><th align="left">Language</th><th align="left">Differential rhythmicity</th><th align="left">Linear regression</th><th align="left">Non-linear regression</th><th align="left">Multiple components</th><th align="left">Count data</th><th align="left">Population-mean</th><th align="left">Design of experiments</th><th align="left">References</th></tr></thead><tbody><tr><td align="left">CosinorPy</td><td align="left">Python</td><td align="left">Yes</td><td align="left">Yes</td><td align="left">Yes</td><td align="left">Yes</td><td align="left">Yes</td><td align="left">Yes</td><td align="left">Yes</td><td align="left"/></tr><tr><td align="left">Cosinor</td><td align="left">R</td><td align="left">Yes</td><td align="left">Yes</td><td align="left">No</td><td align="left">No</td><td align="left">No</td><td align="left">No</td><td align="left">No</td><td align="left">[<xref ref-type="bibr" rid="CR16">16</xref>]</td></tr><tr><td align="left">Cosinor2</td><td align="left">R</td><td align="left">Yes</td><td align="left">Yes</td><td align="left">No</td><td align="left">No</td><td align="left">No</td><td align="left">Yes</td><td align="left">No</td><td align="left">[<xref ref-type="bibr" rid="CR17">17</xref>]</td></tr><tr><td align="left">DiscoRhythm</td><td align="left">R</td><td align="left">No</td><td align="left">Yes</td><td align="left">No</td><td align="left">No</td><td align="left">No</td><td align="left">No</td><td align="left">No</td><td align="left">[<xref ref-type="bibr" rid="CR18">18</xref>]</td></tr><tr><td align="left">LimoRhyde</td><td align="left">R</td><td align="left">Yes</td><td align="left">Yes</td><td align="left">No</td><td align="left">No</td><td align="left">No</td><td align="left">No</td><td align="left">No</td><td align="left">[<xref ref-type="bibr" rid="CR22">22</xref>]</td></tr><tr><td align="left">CircaCompare</td><td align="left">R</td><td align="left">Yes</td><td align="left">No</td><td align="left">Yes</td><td align="left">No</td><td align="left">No</td><td align="left">No</td><td align="left">No</td><td align="left">[<xref ref-type="bibr" rid="CR23">23</xref>]</td></tr></tbody></table><table-wrap-foot><p><italic>Package</italic>: package name; <italic>language:</italic> the programming language that is used in a combination with a specific package; <italic>differential rhythmicity</italic>: support for the assessment of a differential rhythmicity among two groups of measurement; <italic>linear regression</italic> and <italic>non-linear regression</italic>: what kind of regression the package supports; <italic>multiple components</italic>: support for multi-component cosinor analysis; <italic>count data</italic>: support for count data analysis; <italic>population-mean</italic>: support for population-mean cosinor analysis; <italic>design of experiments</italic>: support for design of experiments to approximate the minimal number of required samples; <italic>reference</italic>: reference to the package</p></table-wrap-foot></table-wrap></p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par17">CosinorPy is implemented in Python and relies on the state-of-the-art Python packages for data management, scientific computing, visualisation, and statistical modelling, namely pandas, NumPy, SciPy, Matplotlib, and statsmodels. CosinorPy is comprised of three Python modules, namely file_parser, cosinor, and cosinor1. The file_parser module implements reading and writing of <italic>xlsx</italic> and <italic>csv</italic> files and generating synthetic data. The cosinor module implements the functionalities based on a single- or multi-component cosinor model that include model fitting, identification of the most suitable model, and analysis of differential rhythmicity. The cosinor1 module implements similar functionalities, which are adapted to a single-component cosinor model, and thus provide more exhaustive results and additional statistics such as the significance of acrophase shifts within the differential rhythmicity analysis. The implementation of specific functionalities within the package are described below. Thorough documentation of the package is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/mmoskon/CosinorPy/blob/master/docs/docs.md">https://github.com/mmoskon/CosinorPy/blob/master/docs/docs.md</ext-link>.</p>
    <sec id="Sec3">
      <title>Single-component cosinor</title>
      <p id="Par18">When the observed data can be accurately described with a single harmonic component, a single-component cosinor model can be used:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} y(t) = A_1 \cdot x_1 + A_2 \cdot x_2 + M + e(t). \end{aligned}$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>y</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2020_3830_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>Using this model, amplitude (<italic>A</italic>) and acrophase (<inline-formula id="IEq5"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi$$\end{document}</tex-math><mml:math id="M16"><mml:mi>ϕ</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3830_Article_IEq5.gif"/></alternatives></inline-formula>) can be estimated directly from the assessed parameter values as:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} A = \sqrt{A_1^2 + A_2^2} \end{aligned}$$\end{document}</tex-math><mml:math id="M18" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msubsup><mml:mi>A</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2020_3830_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>and<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \phi = {\left\{ \begin{array}{ll} - \arctan \left( \left| \frac{A_1}{A_2}\right| \right) &amp;{} A_1&gt; 0, A_2&gt; 0,\\ - \pi + \arctan \left( \left| \frac{A_1}{A_2}\right| \right) &amp;{} A_1&gt; 0, A_2&lt; 0,\\ - 2\pi + \arctan \left( \left| \frac{A_1}{A_2}\right| \right) &amp;{} A_1&lt; 0, A_2 &gt; 0,\\ - \pi - \arctan \left( \left| \frac{A_1}{A_2}\right| \right) &amp;{} A_1&lt;0, A_2 &lt; 0. \end{array}\right. } \end{aligned}$$\end{document}</tex-math><mml:math id="M20" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:mo>arctan</mml:mo><mml:mfenced close=")" open="("><mml:mfenced close="|" open="|"><mml:mfrac><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>-</mml:mo><mml:mi>π</mml:mi><mml:mo>+</mml:mo><mml:mo>arctan</mml:mo><mml:mfenced close=")" open="("><mml:mfenced close="|" open="|"><mml:mfrac><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>+</mml:mo><mml:mo>arctan</mml:mo><mml:mfenced close=")" open="("><mml:mfenced close="|" open="|"><mml:mfrac><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>-</mml:mo><mml:mi>π</mml:mi><mml:mo>-</mml:mo><mml:mo>arctan</mml:mo><mml:mfenced close=")" open="("><mml:mfenced close="|" open="|"><mml:mfrac><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2020_3830_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>The statistical significance of the model is assessed with an F-test on the basis of the model sum of squares and sum of square residuals [<xref ref-type="bibr" rid="CR15">15</xref>]. The significance of rhythmicity is evaluated with the zero amplitude test, which is as well based on the F-statistic [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR19">19</xref>]. Moreover, period and acrophase significance and confidence intervals are assessed directly from the model and its underlying data [<xref ref-type="bibr" rid="CR19">19</xref>]. The adequacy of the model can be assessed using different regression diagnostic tests. When replicates are available or when the measurements are performed for several periods, the goodness of fit of the model is evaluated with an F-test comparing the pure error and the lack of fit sum of squares [<xref ref-type="bibr" rid="CR15">15</xref>].</p>
      <p id="Par19">When collecting circadian data, experimentalists should follow specific guidelines to obtain statistically significant results [<xref ref-type="bibr" rid="CR20">20</xref>]. However, if certain requirements regarding the precision of the assessment of rhythmicity parameters, e.g. a maximal acceptable length of a confidence interval, can be specified in advance, we can approximate the minimal sample size necessary to achieve such precision [<xref ref-type="bibr" rid="CR19">19</xref>]. CosinorPy implements these functionalities and can thus be used as well during a design of experiments.</p>
    </sec>
    <sec id="Sec4">
      <title>Multi-component cosinor</title>
      <p id="Par20">When a single-component cosinor model is not able to describe our data satisfactorily, e.g., when the goodness of fit test rejects the model, a multi-component cosinor model can be considered [<xref ref-type="bibr" rid="CR15">15</xref>]. A multi-component cosinor model is able to describe more complex oscillatory dynamics, e.g. peak asymmetry or multiple peaks within one period, which cannot be described with a single harmonic component. Rhythmicity parameters cannot be calculated analytically from this model, but are evaluated from the fitted curve.</p>
      <p id="Par21">Additional components will always increase a model’s accuracy, but on the account of a reduced number of degrees of freedom. This might cause the over-fitting of a model to the observed data. Automatic selection of the best model regarding the number of components is performed using the extra sum-of-squares F-test:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} F = \frac{\frac{SSR_1 - SSR_2}{SSR_2}}{\frac{DoF_1 - DoF_2}{DoF_2}}, \end{aligned}$$\end{document}</tex-math><mml:math id="M22" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mfrac><mml:mrow><mml:mi>S</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mi>S</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>D</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mi>D</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2020_3830_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq6"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SSR_1$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mi>S</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3830_Article_IEq6.gif"/></alternatives></inline-formula> and <inline-formula id="IEq7"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SSR_2$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mi>S</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3830_Article_IEq7.gif"/></alternatives></inline-formula> present the sum of squared residuals (SSR) for a simpler and a more complex model, respectively, and where <inline-formula id="IEq8"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$DoF_1$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mi>D</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3830_Article_IEq8.gif"/></alternatives></inline-formula> and <inline-formula id="IEq9"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$DoF_2$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mi>D</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3830_Article_IEq9.gif"/></alternatives></inline-formula> present the degrees of freedom (DoF) of a simpler and a more complex model, respectively. The more complex model, i.e., the model with a smaller DoF, is selected as more appropriate when the obtained p-value is lower than a predefined threshold. Moreover, the model selection process can be guided with the goodness of fit measures as for a single-component cosinor model.</p>
      <p id="Par22">Additional advantage of our implementation of the multi-component cosinor regression is that it allows the user to fit a cosinor model to count data. Here, a generalised Poisson model with a logarithmic link can be used in a combination with a cosinor model to handle over- as well as under-dispersed data [<xref ref-type="bibr" rid="CR21">21</xref>]. Moreover, CosinorPy allows the user to as well select Poisson or negative-binomial models for the analysis of rhythmicity of count data.</p>
    </sec>
    <sec id="Sec5">
      <title>Population-mean models</title>
      <p id="Par23">When dealing with at least three individuals, and when each individual produces a series of dependant measurements which can be used to establish the individual’s cosinor model, a population-mean cosinor should be used [<xref ref-type="bibr" rid="CR15">15</xref>]. In this case a cosinor model is fitted to each individual. The response of the whole population is described and analysed as a mean of all individual cosinor models (population-mean cosinor). When using a single-component population-mean cosinor, confidence intervals of rhythmicity parameters are assessed as described in [<xref ref-type="bibr" rid="CR19">19</xref>]. Moreover, a p-value for the null hypothesis of the amplitude of oscillations being zero is evaluated with an F-test for a single-component population-mean cosinor as described in [<xref ref-type="bibr" rid="CR15">15</xref>]. The statistical significance and the goodness of fit of a single- or multi-component population-mean cosinor model are assessed in a similar way as for the basic cosinor models [<xref ref-type="bibr" rid="CR15">15</xref>].</p>
    </sec>
    <sec id="Sec6">
      <title>Analysis of differential rhythmicity</title>
      <p id="Par24">Cosinor models can be used to assess the difference in the rhythmic response of two groups of measurements. Each group either corresponds to a different variable (e.g., two different genes) or to the same variable in different conditions (e.g., the same gene before and after a perturbation). We are usually interested in amplitude changes and acrophase shifts between the groups. Several different methods, which we use in our implementation, have been proposed to assess these differences.</p>
      <p id="Par25">If the data describing both groups can be modelled with single-component cosinor models, a single-component cosinor can as well be used to assess the differential rhythmicity of these two groups. This model is implemented as<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} y(t) = \left( A_{1,a} + g \cdot A_{1,b}\right) \cdot x_1 + \left( A_{2,a} + g \cdot A_{2,b}\right) \cdot x_2 + M_a + g \cdot M_b + e(t), \end{aligned}$$\end{document}</tex-math><mml:math id="M32" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>y</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mo>·</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>·</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mo>·</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>·</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mo>·</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2020_3830_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where <italic>g</italic> equals 0 if the data belong to the group <italic>a</italic>, and 1 if the data belong to the group <italic>b</italic>. Based on the assessed parameter values, we can estimate the acrophases and amplitudes of each of the groups, as well as the differences between these values and their significance [<xref ref-type="bibr" rid="CR19">19</xref>]. Moreover, a population-mean single-component cosinor model is adapted to analyse the differential rhythmicity in a similar way [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR19">19</xref>].</p>
      <p id="Par26">LimoRhyde [<xref ref-type="bibr" rid="CR22">22</xref>] presents a similar approach that uses a cosinor model and can be adapted to use an arbitrary number of components in the following form<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}y(t) = \sum _{i=1}^{N} \left( \left( A_{i,1,a} + g \cdot A_{i,1,b}\cdot \right) \cdot x_{i,1} + \left( A_{i,2,a} + g \cdot A_{i,2,b}\right) \cdot x_{i,2}\right) + M_a + g \cdot M_b + e(t). \end{aligned}$$\end{document}</tex-math><mml:math id="M34" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>y</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mfenced close=")" open="("><mml:mfenced close=")" open="("><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mo>·</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo></mml:mfenced><mml:mo>·</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mo>·</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>·</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mo>·</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2020_3830_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>The significance of each parameter in this model is assessed using a T-test, where the null hypothesis is that a parameter equals zero. When this hypothesis is rejected for any of the rhythmicity parameters of the group <italic>b</italic>, namely <inline-formula id="IEq10"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_{i,1,b}$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3830_Article_IEq10.gif"/></alternatives></inline-formula> or <inline-formula id="IEq11"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_{i,2,b}$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3830_Article_IEq11.gif"/></alternatives></inline-formula>, these two groups should reflect differential rhythmicity. While a single-component cosinor can be used to assess the significance of acrophase shift and amplitude change, LimoRhyde is only able to assess whether the difference in rhythmicity between the groups is significant or not.</p>
      <p id="Par27">Non-linear regression might as well be used to evaluate the differential rhythmicity parameters and their confidence intervals as described in CircaCompare [<xref ref-type="bibr" rid="CR23">23</xref>]. This is implemented as the following model<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} y(t) = (A_a + A_b \cdot g) \cdot \cos \left( \frac{t}{P} \cdot 2\pi - (\phi _a + \phi _b \cdot g)\right) + M_a + M_b \cdot g + e(t), \end{aligned}$$\end{document}</tex-math><mml:math id="M40" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>y</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:mo>cos</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mi>t</mml:mi><mml:mi>P</mml:mi></mml:mfrac><mml:mo>·</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mi>g</mml:mi><mml:mo>+</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2020_3830_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq12"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_a$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mi>A</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3830_Article_IEq12.gif"/></alternatives></inline-formula>, <inline-formula id="IEq13"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi _a$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3830_Article_IEq13.gif"/></alternatives></inline-formula> and <inline-formula id="IEq14"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_a$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>M</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3830_Article_IEq14.gif"/></alternatives></inline-formula> present the amplitude, acrophase, and MESOR of the group <italic>a</italic>, respectively, and <inline-formula id="IEq15"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_a + A_b$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3830_Article_IEq15.gif"/></alternatives></inline-formula>, <inline-formula id="IEq16"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi _a + \phi _b$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3830_Article_IEq16.gif"/></alternatives></inline-formula> and <inline-formula id="IEq17"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_a + M_b$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3830_Article_IEq17.gif"/></alternatives></inline-formula> present the amplitude, acrophase, and MESOR of the group <italic>b</italic>, respectively. CosinorPy as well implements differential rhythmicity assessments based on non-linear regression. However, this approach does not provide any additional information to the approach described in Equation <xref rid="Equ7" ref-type="">7</xref>.</p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Results</title>
    <p id="Par28">We demonstrate the application of selected CosinorPy functionalities on two typical case studies using four groups of synthetically generated time series data with the attributes presented in Table <xref rid="Tab2" ref-type="table">2</xref>. The whole analysis is available as interactive Python notebooks (IPYNB) at <ext-link ext-link-type="uri" xlink:href="https://github.com/mmoskon/CosinorPy">https://github.com/mmoskon/CosinorPy</ext-link>.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Parameters for synthetically generated data</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Name</th><th align="left">Components</th><th align="left">Sampling time</th><th align="left">Sampling period</th><th align="left">Acrophase</th><th align="left">Noise amplitude</th></tr></thead><tbody><tr><td align="left">Test1</td><td align="left">1</td><td align="left">48 h</td><td align="left">2h</td><td align="left">0</td><td align="left">0.5</td></tr><tr><td align="left">Test2</td><td align="left">1</td><td align="left">48 h</td><td align="left">2h</td><td align="left"><inline-formula id="IEq18"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi$$\end{document}</tex-math><mml:math id="M54"><mml:mi>π</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3830_Article_IEq18.gif"/></alternatives></inline-formula></td><td align="left">0.5</td></tr><tr><td align="left">Test3</td><td align="left">3</td><td align="left">48 h</td><td align="left">1h</td><td align="left">0</td><td align="left">0.5</td></tr><tr><td align="left">Test4</td><td align="left">3</td><td align="left">48 h</td><td align="left">1h</td><td align="left"><inline-formula id="IEq19"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi$$\end{document}</tex-math><mml:math id="M56"><mml:mi>π</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3830_Article_IEq19.gif"/></alternatives></inline-formula></td><td align="left">0.5</td></tr></tbody></table><table-wrap-foot><p>Rhythmicity periods of the generated data were set to 24 h in all scenarios. Each scenario had three replicates.</p></table-wrap-foot></table-wrap></p>
    <sec id="Sec8">
      <title>Case study 1: independent measurements</title>
      <p id="Par29">
        <table-wrap id="Tab3">
          <label>Table 3</label>
          <caption>
            <p>Summary of the differential rhythmicity assessment for the first case study</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th align="left">Test</th>
                <th align="left"><italic>q</italic> amplitude change)</th>
                <th align="left"><italic>q</italic> acrophase shift)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left">Test1 vs. test2</td>
                <td align="left">0.372013</td>
                <td align="left">0</td>
              </tr>
              <tr>
                <td align="left">Test3 vs. test4</td>
                <td align="left">0.372013</td>
                <td align="left">0</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <p>The differential rhythmicity was assessed using a single-component cosinor. We are usually interested in the significance of amplitude changes, as well as acrophase shifts. When multiple tests are performed, CosinorPy adjusts the significance values using the false discovery rate (FDR) method (reported as <italic>q</italic>-values). The results here indicate that while the amplitude changes are not significant, acrophase shifts are (<inline-formula id="IEq20"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q &lt; 0.05$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:mi>q</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3830_Article_IEq20.gif"/></alternatives></inline-formula>)</p>
          </table-wrap-foot>
        </table-wrap>
      </p>
      <p id="Par30">In our first case study, we presume that the measurements in each group are independent. This scenario complies with a transcriptomics data analysis or an analysis of qPCR data. CosinorPy successfully identifies the most suitable model, namely a 1-component model in the first two scenarios and a 3-component model in the last two scenarios. If the rhythmicity period is not known, the user could as well use the automatic identification of the best fitting period together with the best fitting model, or could rely on the period values assessed using periodograms (see <ext-link ext-link-type="uri" xlink:href="https://github.com/mmoskon/CosinorPy/blob/master/demo_independent.ipynb">https://github.com/mmoskon/CosinorPy/blob/master/demo_independent.ipynb</ext-link>). Results obtained with the multi-component cosinor regression are presented in Fig. <xref rid="Fig1" ref-type="fig">1</xref>.</p>
      <p id="Par31">Even though a 3-component model is more appropriate for the last two scenarios, a good fit is obtained as well with a 1-component model with slightly higher SSR values than a 3-component model (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table 1 and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table 2). We thus opted to perform a differential rhythmicity analysis using a 1-component model to obtain more informative results, namely the significance of amplitude change and acrophase shift. CosinorPy is able to produce different plots visualising the difference between fits (see the upper part of Fig. <xref rid="Fig2" ref-type="fig">2</xref>), as well as acrophase shifts in a polar coordinate system (see the lower part of Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Moreover, results of the analysis are reported in a tabular form, i.e., as a pandas DataFrame, which can be easily stored to Excel or CSV format. These results are available in Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table 3 and summarised in Table <xref rid="Tab3" ref-type="table">3</xref>.<table-wrap id="Tab4"><label>Table 4</label><caption><p>Summary of the differential rhythmicity assessment for the second case study (population-mean cosinor)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Test</th><th align="left"><italic>q</italic> (amplitude change)</th><th align="left"><italic>q</italic> (acrophase shift)</th></tr></thead><tbody><tr><td align="left">Test1 vs. test2</td><td align="left">0.537841</td><td align="left">0.000036</td></tr><tr><td align="left">Test3 vs. test4</td><td align="left">0.544973</td><td align="left">0.000120</td></tr></tbody></table><table-wrap-foot><p>The differential rhythmicity was assessed using a single-component population-mean cosinor. When multiple tests are performed, CosinorPy adjusts the significance values using the false discovery rate (FDR) method (reported as <italic>q</italic>-values). The results of the analysis indicate that while the amplitude changes are not significant, acrophase shifts are (<inline-formula id="IEq21"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q &lt; 0.05$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:mi>q</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3830_Article_IEq21.gif"/></alternatives></inline-formula>)</p></table-wrap-foot></table-wrap></p>
      <p id="Par32">
        <fig id="Fig1">
          <label>Fig. 1</label>
          <caption>
            <p>Multi-component cosinor models obtained with the automatic identification of the best fitting models. 1-component models are selected for <italic>test1</italic> and <italic>test2</italic> and 3-component models for <italic>test3</italic> and <italic>test4</italic>. <italic>P</italic> values correspond to the statistical significance of each cosinor model. CosinorPy is able to produce publication-ready figures illustrating the fit of a cosinor model to time series data</p>
          </caption>
          <graphic xlink:href="12859_2020_3830_Fig1_HTML" id="MO10"/>
        </fig>
        <fig id="Fig2">
          <label>Fig. 2</label>
          <caption>
            <p>Differential rhythmicity analysis performed with the 1-component cosinor analysis. While the amplitudes are not changed significantly, acrophases differ significantly in both tests (see Table <xref rid="Tab3" ref-type="table">3</xref>). CosinorPy is able to produce publication-ready figures illustrating a comparative analysis of time series data (upper part of the figure), as well as an analysis of acrophase shifts (the lower part of the figure)</p>
          </caption>
          <graphic xlink:href="12859_2020_3830_Fig2_HTML" id="MO11"/>
        </fig>
        <fig id="Fig3">
          <label>Fig. 3</label>
          <caption>
            <p>Multi-component population-mean cosinor models obtained with the automatic identification of the best fitting models. 1-component models are selected for <italic>test1</italic> and <italic>test2</italic> and 3-component models for <italic>test3</italic> and <italic>test4</italic>. <italic>P</italic> values correspond to the statistical significance of each cosinor model. Black lines represent the cosinor models of each individual and red lines population-mean cosinor models</p>
          </caption>
          <graphic xlink:href="12859_2020_3830_Fig3_HTML" id="MO12"/>
        </fig>
      </p>
      <p id="Par33">The same data were used in a combination with the cosinor and cosinor2 R packages [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>] to validate the obtained results. These two packages support only single-component cosinor analyses. Moreover, the cosinor2 package builds upon the cosinor package, which unfortunately reports incorrect acrophase values [<xref ref-type="bibr" rid="CR17">17</xref>]. Even though the cosinor2 package provides a function to correct these values, their corresponding p-values are not updated accordingly. The analyses performed with the CosinorPy package produce the same results as cosinor and cosinor2 packages with the above mentioned exception (see Additional file <xref rid="MOESM7" ref-type="media">7</xref>: Table 7 and Additional file <xref rid="MOESM8" ref-type="media">8</xref>: Table 8).</p>
    </sec>
    <sec id="Sec9">
      <title>Case study 2: population-based measurements</title>
      <p id="Par34">In our second case study, we presume that measurements in each group belong to the same individual, which means that population-mean models should be used. This complies with, e.g., bioluminescence data, where the same cell is observed throughout the whole experiment. We can also refer to such measurements as dependent measurements.</p>
      <p id="Par35">We again use CosinorPy to identify the most suitable model, and assess the rhythmicity parameters and significance of periodicity in the data (see <ext-link ext-link-type="uri" xlink:href="https://github.com/mmoskon/CosinorPy/blob/master/demo_dependent.ipynb">https://github.com/mmoskon/CosinorPy/blob/master/demo_dependent.ipynb</ext-link>). As in the first case study, CosinorPy is able to identify the most suitable model for each dataset (see Fig. <xref rid="Fig3" ref-type="fig">3</xref>). Complete results of the fitting process are available as Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Table 4 and Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Table 5. We again opted to use a single-component cosinor to perform the comparison analysis. Results of this analysis are available in Additional file <xref rid="MOESM6" ref-type="media">6</xref>: Table 6 and summarised in Table <xref rid="Tab4" ref-type="table">4</xref>.</p>
      <p id="Par36">We validated the obtained results using the cosinor2 R package [<xref ref-type="bibr" rid="CR17">17</xref>]. The population-based tests implemented within this package do not rely on the cosinor R package. The reported acrophases and their corresponding p-values thus fully comply with the results obtained with the CosinorPy package (see Additional file <xref rid="MOESM9" ref-type="media">9</xref>: Table 9 and Additional file <xref rid="MOESM10" ref-type="media">10</xref>: Table 10).</p>
    </sec>
    <sec id="Sec10">
      <title>Case study 3: additional benefits of the multi-component cosinor</title>
      <p id="Par37">To additionally investigate the benefits of multi-component cosinor models we applied CosinorPy to a larger dataset downloaded from the JTK Cycle repository [<xref ref-type="bibr" rid="CR7">7</xref>]. We analysed these data with both, single-component cosinor, as well as multi-component cosinor models with up to three components (see <ext-link ext-link-type="uri" xlink:href="https://github.com/mmoskon/CosinorPy/blob/master/multi_vs_single.ipynb">https://github.com/mmoskon/CosinorPy/blob/master/multi_vs_single.ipynb</ext-link>). Among 250 measurements 95 measurement were identified to be circadian using multi-component cosinor models. Among these, 11 measurement were not identified to be circadian using a single-component cosinor model. In all these 11 cases data reflected multiple peaks within a 24-hour period, which cannot be fitted with a single-component model. Multiple peaks were successfully incorporated into multi-component models. However, in some of these cases the statistical significance was marginal, and additional data should be collected to confirm the circadian nature of observed measurements. In the future, large-scale analyses that were performed with single-component cosinor models in the past should be revised using multi-component cosinor models. This could enable us to detect additional rhythmic genes and would thus provide novel insights into circadian dynamics of selected genes.</p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Conclusion</title>
    <p id="Par38">CosinorPy provides all the functionalities required for a rhythmicity analysis of experimental data. Its features merge and extend the functionalities of existing cosinor-based software packages. These range from data import and pre-processing to identification of the most suitable models, evaluation of rhythmicity parameters and their significance, and assessment of differential rhythmicity between groups of measurements. Moreover, CosinorPy produces publication-ready figures, visualising the results of the fitting process as well as assessed parameter values, e.g., acrophase values in a polar coordinate system. With the vast scope of functionalities, as well as ease of use, the package presents an attractive alternative to other software packages for rhythmicity detection and analysis.
</p>
  </sec>
  <sec id="Sec12">
    <title>Availability and requirements</title>
    <p id="Par39">
      <list list-type="bullet">
        <list-item>
          <p id="Par40">Project name: CosinorPy</p>
        </list-item>
        <list-item>
          <p id="Par41">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/mmoskon/CosinorPy">https://github.com/mmoskon/CosinorPy</ext-link></p>
        </list-item>
        <list-item>
          <p id="Par42">Operating system(s): Platform independent</p>
        </list-item>
        <list-item>
          <p id="Par43">Programming language: Python</p>
        </list-item>
        <list-item>
          <p id="Par44">Other requirements: pandas, Matplotlib, NumPy, SciPy, statsmodels and openpyxl Python libraries</p>
        </list-item>
        <list-item>
          <p id="Par45">License: MIT license</p>
        </list-item>
        <list-item>
          <p id="Par46">Any restrictions to use by non-academics: none</p>
        </list-item>
      </list>
    </p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec13">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2020_3830_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1: Supplementary Table 1</bold>. Results of the fitting process for the first case study using 1-, 2- and 3-component cosinor models with the cosinor module. The results are presented in a CSV format as reported by CosinorPy.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2020_3830_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2: Supplementary Table 2</bold>. Results of the fitting process for the first case study using 1-component cosinor models with the cosinor1 module. The results are presented in a CSV format as reported by CosinorPy.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2020_3830_MOESM3_ESM.pdf">
            <caption>
              <p><bold>Additional file 3: Supplementary Table 3</bold>. Results of the comparison analysis for the first case study using 1-component cosinor models with the cosinor1 module. The results are presented in a CSV format as reported by CosinorPy.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="12859_2020_3830_MOESM4_ESM.pdf">
            <caption>
              <p><bold>Additional file 4: Supplementary Table 4</bold>. Results of the fitting process for the second case study using 1-, 2- and 3-component cosinor models with the cosinor module. The results are presented in a CSV format as reported by CosinorPy.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="12859_2020_3830_MOESM5_ESM.pdf">
            <caption>
              <p><bold>Additional file 5: Supplementary Table 5</bold>. Results of the fitting process for the second case study using 1-component cosinor models with the cosinor1 module. The results are presented in a CSV format as reported by CosinorPy.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="12859_2020_3830_MOESM6_ESM.pdf">
            <caption>
              <p><bold>Additional file 6: Supplementary Table 6</bold>. Results of the comparison analysis for the second case study using 1-component cosinor models with the cosinor1 module. The results are presented in a CSV format as reported by CosinorPy.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="12859_2020_3830_MOESM7_ESM.pdf">
            <caption>
              <p><bold>Additional file 7: Supplementary Table 7</bold>. Results of the fitting process for the first case study using cosinor and cosinor2 R packages.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM8">
          <media xlink:href="12859_2020_3830_MOESM8_ESM.pdf">
            <caption>
              <p><bold>Additional file 8: Supplementary Table 8</bold> Results of the comparison analysis for the first case study using cosinor and cosinor2 R packages.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM9">
          <media xlink:href="12859_2020_3830_MOESM9_ESM.pdf">
            <caption>
              <p><bold>Additional file 9: Supplementary Table 9</bold>. Results of the fitting process for the second case study using cosinor2 R package.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM10">
          <media xlink:href="12859_2020_3830_MOESM10_ESM.pdf">
            <caption>
              <p><bold>Additional file 10: Supplementary Table 10</bold>. Results of the comparison analysis for the second case study using cosinor2 R package.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>CSV</term>
        <def>
          <p id="Par4">Comma separated values</p>
        </def>
      </def-item>
      <def-item>
        <term>DoF</term>
        <def>
          <p id="Par5">Degrees of freedom</p>
        </def>
      </def-item>
      <def-item>
        <term>FDR</term>
        <def>
          <p id="Par6">False discovery rate</p>
        </def>
      </def-item>
      <def-item>
        <term>IPYNB</term>
        <def>
          <p id="Par7">Interactive python notebook</p>
        </def>
      </def-item>
      <def-item>
        <term>JTK</term>
        <def>
          <p id="Par8">Jonckheere–Terpstra–Kendall</p>
        </def>
      </def-item>
      <def-item>
        <term>MESOR</term>
        <def>
          <p id="Par9">Midline statistic of rhythm</p>
        </def>
      </def-item>
      <def-item>
        <term>qPCR</term>
        <def>
          <p id="Par10">Quantitative polymerase chain reaction</p>
        </def>
      </def-item>
      <def-item>
        <term>RAIN</term>
        <def>
          <p id="Par11">Rhythmicity analysis incorporating nonparametric methods</p>
        </def>
      </def-item>
      <def-item>
        <term>SSR</term>
        <def>
          <p id="Par12">Sum of squared residuals</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-020-03830-w.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>I would like to thank Dr. Urša Kovač and Dr. Damjana Rozman for their collaborative work on the analysis of circadian data, which also inspired the development of CosinorPy. I would as well like to thank Dr. Miha Mraz and his group members for their support, and Robert McKenzie for proofreading the paper.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>MM wrote and tested the code, performed the analyses and wrote the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding Information</title>
    <p>This work has been partially supported by the scientific-research program P2-0359, and by the basic research projects J1-9176 and J5-1798, all financed by the Slovenian Research Agency. The funding body had no role in the design of the study and collection, analysis, and interpretation of data nor in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All data generated or analysed during this study are included in this published article and its supplementary information files available at <ext-link ext-link-type="uri" xlink:href="https://github.com/mmoskon/CosinorPy">https://github.com/mmoskon/CosinorPy</ext-link>.</p>
  </notes>
  <notes id="FPar2">
    <title>Ethics approval and consent to participate</title>
    <p id="Par47">Not applicable.</p>
  </notes>
  <notes id="FPar3">
    <title>Consent for publication</title>
    <p id="Par48">Not applicable.</p>
  </notes>
  <notes id="FPar4" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par49">The author declares that he has no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">Ramsey KM, Affinati AH, Peek CB, Marcheva B, Hong HK, Bass J. Circadian measurements of sirtuin biology. In: Sirtuins. Berlin: Springer; 2013. p. 285–302.</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lahens</surname>
            <given-names>NF</given-names>
          </name>
          <name>
            <surname>Ballance</surname>
            <given-names>HI</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Hogenesch</surname>
            <given-names>JB</given-names>
          </name>
        </person-group>
        <article-title>A circadian gene expression atlas in mammals: implications for biology and medicine</article-title>
        <source>Proc Nat Acad Sci</source>
        <year>2014</year>
        <volume>111</volume>
        <issue>45</issue>
        <fpage>16219</fpage>
        <lpage>16224</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1408886111</pub-id>
        <pub-id pub-id-type="pmid">25349387</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andreani</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Itoh</surname>
            <given-names>TQ</given-names>
          </name>
          <name>
            <surname>Yildirim</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Hwangbo</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Allada</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Genetics of circadian rhythms</article-title>
        <source>Sleep Med Clin</source>
        <year>2015</year>
        <volume>10</volume>
        <issue>4</issue>
        <fpage>413</fpage>
        <lpage>421</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jsmc.2015.08.007</pub-id>
        <pub-id pub-id-type="pmid">26568119</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brainard</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gobel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Scott</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Koeppen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Eckle</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Health implications of disrupted circadian rhythms and the potential for daylight as therapy</article-title>
        <source>Anesthesiol</source>
        <year>2015</year>
        <volume>122</volume>
        <issue>5</issue>
        <fpage>1170</fpage>
        <lpage>1175</lpage>
        <pub-id pub-id-type="doi">10.1097/ALN.0000000000000596</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xie</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>New insights into the circadian rhythm and its related diseases</article-title>
        <source>Frontin Physiol</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>682</fpage>
        <pub-id pub-id-type="doi">10.3389/fphys.2019.00682</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Seifalian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hart</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Circadian rhythms: will it revolutionise the management of diseases?</article-title>
        <source>J Lifestyle Med</source>
        <year>2019</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <pub-id pub-id-type="doi">10.15280/jlm.2019.9.1.1</pub-id>
        <pub-id pub-id-type="pmid">30918828</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hughes</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Hogenesch</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Kornacker</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>JTK\_CYCLE: an efficient nonparametric algorithm for detecting rhythmic components in genome-scale data sets</article-title>
        <source>J Biol Rhythms</source>
        <year>2010</year>
        <volume>25</volume>
        <issue>5</issue>
        <fpage>372</fpage>
        <lpage>380</lpage>
        <pub-id pub-id-type="doi">10.1177/0748730410379711</pub-id>
        <pub-id pub-id-type="pmid">20876817</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hutchison</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Maienschein-Cline</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chiang</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Tabei</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Gudjonson</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bahroos</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improved statistical methods enable greater sensitivity in rhythm detection for genome-wide data</article-title>
        <source>PLoS Comput Biol</source>
        <year>2015</year>
        <volume>11</volume>
        <issue>3</issue>
        <fpage>e1004094</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004094</pub-id>
        <pub-id pub-id-type="pmid">25793520</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hutchison</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Allada</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Dinner</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>Bootstrapping and empirical bayes methods improve rhythm detection in sparsely sampled data</article-title>
        <source>J Biol Rhythms</source>
        <year>2018</year>
        <volume>33</volume>
        <issue>4</issue>
        <fpage>339</fpage>
        <lpage>349</lpage>
        <pub-id pub-id-type="doi">10.1177/0748730418789536</pub-id>
        <pub-id pub-id-type="pmid">30101659</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thaben</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Westermark</surname>
            <given-names>PO</given-names>
          </name>
        </person-group>
        <article-title>Detecting rhythms in time series with rain</article-title>
        <source>J Biol Rhythms</source>
        <year>2014</year>
        <volume>29</volume>
        <issue>6</issue>
        <fpage>391</fpage>
        <lpage>400</lpage>
        <pub-id pub-id-type="doi">10.1177/0748730414553029</pub-id>
        <pub-id pub-id-type="pmid">25326247</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anafi</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Francey</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Hogenesch</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>CYCLOPS reveals human transcriptional rhythms in health and disease</article-title>
        <source>Proc Nat Acad Sci</source>
        <year>2017</year>
        <volume>114</volume>
        <issue>20</issue>
        <fpage>5312</fpage>
        <lpage>5317</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1619320114</pub-id>
        <pub-id pub-id-type="pmid">28439010</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Ruben MD, Wu G, Smith DF, Schmidt RE, Francey LJ, Lee YY, et al. A database of tissue-specific rhythmically expressed human genes has potential applications in circadian medicine. Sci Transl Med. 2018;10(458).</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruben</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Francey</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>EB</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>AS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A large-scale study reveals 24-h operational rhythms in hospital treatment</article-title>
        <source>Proc Nat Acad Sci</source>
        <year>2019</year>
        <volume>116</volume>
        <issue>42</issue>
        <fpage>20953</fpage>
        <lpage>20958</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1909557116</pub-id>
        <pub-id pub-id-type="pmid">31575744</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Refinetti</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cornélissen</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Halberg</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Procedures for numerical analysis of circadian rhythms</article-title>
        <source>Biol Rhythm Res</source>
        <year>2007</year>
        <volume>38</volume>
        <issue>4</issue>
        <fpage>275</fpage>
        <lpage>325</lpage>
        <pub-id pub-id-type="doi">10.1080/09291010600903692</pub-id>
        <pub-id pub-id-type="pmid">23710111</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cornelissen</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Cosinor-based rhythmometry</article-title>
        <source>Theoret Biol Med Modell</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>16</fpage>
        <pub-id pub-id-type="doi">10.1186/1742-4682-11-16</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Sachs M. Cosinor: tools for estimating and predicting the cosinor model; 2014. R package version 1.1. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=cosinor">https://CRAN.R-project.org/package=cosinor</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Mutak A. Cosinor2: Extended tools for cosinor analysis of rhythms; 2018. R package version 0.2.1. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=cosinor2">https://CRAN.R-project.org/package=cosinor2</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Carlucci M, Kriščiūnas A, Li H, Gibas P, Koncevičius K, Petronis A, et al. DiscoRhythm: an easy-to-use web application and R package for discovering rhythmicity. Bioinformatics. 2019.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bingham</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Arbogast</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Guillaume</surname>
            <given-names>GC</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Halberg</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Inferential statistical methods for estimating and comparing cosinor parameters</article-title>
        <source>Chronobiologia.</source>
        <year>1982</year>
        <volume>9</volume>
        <issue>4</issue>
        <fpage>397</fpage>
        <lpage>439</lpage>
        <pub-id pub-id-type="pmid">7168995</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hughes</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Abruzzi</surname>
            <given-names>KC</given-names>
          </name>
          <name>
            <surname>Allada</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Anafi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Arpat</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Asher</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Guidelines for genome-scale analysis of biological rhythms</article-title>
        <source>J Biol Rhythms</source>
        <year>2017</year>
        <volume>32</volume>
        <issue>5</issue>
        <fpage>380</fpage>
        <lpage>393</lpage>
        <pub-id pub-id-type="doi">10.1177/0748730417728663</pub-id>
        <pub-id pub-id-type="pmid">29098954</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Ismail N, Jemain AA. Handling overdispersion with negative binomial and generalized poisson regression models. In: Casualty actuarial society forum. vol. 2007. Citeseer; 2007. p. 103–58.</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Singer</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Hughey</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>LimoRhyde: a flexible approach for differential analysis of rhythmic transcriptome data</article-title>
        <source>J Biol Rhythms</source>
        <year>2019</year>
        <volume>34</volume>
        <issue>1</issue>
        <fpage>5</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1177/0748730418813785</pub-id>
        <pub-id pub-id-type="pmid">30472909</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parsons</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Parsons</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Garner</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Oster</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Rawashdeh</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>CircaCompare: a method to estimate and statistically support differences in mesor, amplitude, and phase, between circadian rhythms</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>4</issue>
        <fpage>1208</fpage>
        <lpage>1212</lpage>
        <pub-id pub-id-type="pmid">31588519</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
