<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5447239</article-id>
    <article-id pub-id-type="pmid">28108445</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btx025</article-id>
    <article-id pub-id-type="publisher-id">btx025</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Phylogenetics</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Multi-rate Poisson tree processes for single-locus species delimitation under maximum likelihood and Markov chain Monte Carlo</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Kapli</surname>
          <given-names>P</given-names>
        </name>
        <xref ref-type="aff" rid="btx025-aff1">1</xref>
        <xref ref-type="corresp" rid="btx025-cor1"/>
        <!--<email>paschalia.kapli@h-its.org</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lutteropp</surname>
          <given-names>S</given-names>
        </name>
        <xref ref-type="aff" rid="btx025-aff1">1</xref>
        <xref ref-type="aff" rid="btx025-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>J</given-names>
        </name>
        <xref ref-type="aff" rid="btx025-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kobert</surname>
          <given-names>K</given-names>
        </name>
        <xref ref-type="aff" rid="btx025-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pavlidis</surname>
          <given-names>P</given-names>
        </name>
        <xref ref-type="aff" rid="btx025-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stamatakis</surname>
          <given-names>A</given-names>
        </name>
        <xref ref-type="aff" rid="btx025-aff1">1</xref>
        <xref ref-type="aff" rid="btx025-aff2">2</xref>
        <xref ref-type="corresp" rid="btx025-cor1"/>
        <!--<email>alexandros.stamatakis@h-its.org</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Flouri</surname>
          <given-names>T</given-names>
        </name>
        <xref ref-type="aff" rid="btx025-aff1">1</xref>
        <xref ref-type="aff" rid="btx025-aff2">2</xref>
        <xref ref-type="corresp" rid="btx025-cor1"/>
        <!--<email>tomas.flouri@h-its.org</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Valencia</surname>
          <given-names>Alfonso</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btx025-aff1"><label>1</label>The Exelixis Lab, Scientific Computing Group, Heidelberg Institute for Theoretical Studies, Heidelberg, Germany</aff>
    <aff id="btx025-aff2"><label>2</label>Department of Informatics, Institute of Theoretical Informatics, Karlsruhe Institute of Technology, Karlsruhe, Germany</aff>
    <aff id="btx025-aff3"><label>3</label>Foundation for Research and Technology, Hellas Institute of Computer Science GR, Heraklion, Crete, Greece</aff>
    <author-notes>
      <corresp id="btx025-cor1">To whom correspondence should be addressed. Email: <email>paschalia.kapli@h-its.org</email> or <email>alexandros.stamatakis@h-its.org</email> or <email>tomas.flouri@h-its.org</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>6</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-01-20">
      <day>20</day>
      <month>1</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>1</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>33</volume>
    <issue>11</issue>
    <fpage>1630</fpage>
    <lpage>1638</lpage>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>7</month>
        <year>2016</year>
      </date>
      <date date-type="rev-recd">
        <day>27</day>
        <month>12</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>1</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="cc-by">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btx025.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="SA1">
        <title>Motivation</title>
        <p>In recent years, molecular species delimitation has become a routine approach for quantifying and classifying biodiversity. Barcoding methods are of particular importance in large-scale surveys as they promote fast species discovery and biodiversity estimates. Among those, distance-based methods are the most common choice as they scale well with large datasets; however, they are sensitive to similarity threshold parameters and they ignore evolutionary relationships. The recently introduced “Poisson Tree Processes” (PTP) method is a phylogeny-aware approach that does not rely on such thresholds. Yet, two weaknesses of PTP impact its accuracy and practicality when applied to large datasets; it does not account for divergent intraspecific variation and is slow for a large number of sequences.</p>
      </sec>
      <sec id="SA2">
        <title>Results</title>
        <p>We introduce the multi-rate PTP (mPTP), an improved method that alleviates the theoretical and technical shortcomings of PTP. It incorporates different levels of intraspecific genetic diversity deriving from differences in either the evolutionary history or sampling of each species. Results on empirical data suggest that mPTP is superior to PTP and popular distance-based methods as it, consistently yields more accurate delimitations with respect to the taxonomy (i.e., identifies more taxonomic species, infers species numbers closer to the taxonomy). Moreover, mPTP does not require any similarity threshold as input. The novel dynamic programming algorithm attains a speedup of at least five orders of magnitude compared to PTP, allowing it to delimit species in large (meta-) barcoding data. In addition, Markov Chain Monte Carlo sampling provides a comprehensive evaluation of the inferred delimitation in just a few seconds for millions of steps, independently of tree size.</p>
      </sec>
      <sec id="SA3">
        <title>Availability and Implementation</title>
        <p>mPTP is implemented in C and is available for download at <ext-link ext-link-type="uri" xlink:href="http://github.com/Pas-Kapli/mptp">http://github.com/Pas-Kapli/mptp</ext-link> under the GNU Affero 3 license. A web-service is available at <ext-link ext-link-type="uri" xlink:href="http://mptp.h-its.org">http://mptp.h-its.org</ext-link>.</p>
      </sec>
      <sec id="SA4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">European Commission</named-content>
          <named-content content-type="funder-identifier">10.13039/501100000780</named-content>
        </funding-source>
        <award-id>625057</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Species are fundamental units of life and form the most common basis of comparison in evolutionary studies. Therefore, species delimitation is a critical task in systematic studies with potential implications in all subfields of biology that involve evolutionary relationships. In line with the species concept of <xref rid="btx025-B11" ref-type="bibr">De Queiroz (2007)</xref> and the integrative taxonomy approach (<xref rid="btx025-B10" ref-type="bibr">Dayrat, 2005</xref>), a reliable identification of a new species involves data from multiple sources (e.g., ecology, morphology, evolutionary history). Such an approach is necessary for meticulous comparative evolutionary studies but is tremendously difficult to apply, if at all possible, in large biodiversity studies (e.g., vast barcoding, environmental, microbial samples). In such studies, researchers use alternative units of comparison that are easier to delimit [Molecular Operational Taxonomic Units (<xref rid="btx025-B7" ref-type="bibr">Blaxter <italic>et al.</italic>, 2005</xref>), Recognizable Taxonomic Units (<xref rid="btx025-B31" ref-type="bibr">Oliver and Beattie, 1993</xref>)] rather than going through the cumbersome task of delimiting and describing full species. The correspondence of these units to real species remains ambiguous (<xref rid="btx025-B9" ref-type="bibr">Casiraghi <italic>et al.</italic>, 2010</xref>), especially in the absence of additional information. However, they are practical for biodiversity and <italic>β</italic>-diversity estimates (<xref rid="btx025-B43" ref-type="bibr">Valentini <italic>et al.</italic>, 2009</xref>).</p>
    <p>With the introduction of DNA-barcoding (<xref rid="btx025-B20" ref-type="bibr">Hebert <italic>et al.</italic>, 2003</xref>) and the advances in coalescent models (<xref rid="btx025-B15" ref-type="bibr">Fujisawa and Barraclough, 2013</xref>; <xref rid="btx025-B46" ref-type="bibr">Yang and Rannala, 2014</xref>), genetic data became the most popular data source for delimiting species. Several algorithms and implementations exist for this purpose, most of which are inspired by the phylogenetic species concept (<xref rid="btx025-B15" ref-type="bibr">Fujisawa and Barraclough, 2013</xref>; <xref rid="btx025-B46" ref-type="bibr">Yang and Rannala, 2014</xref>; <xref rid="btx025-B48" ref-type="bibr">Zhang <italic>et al.</italic>, 2013</xref>) and the DNA barcoding concept (<xref rid="btx025-B18" ref-type="bibr">Hao <italic>et al.</italic>, 2011</xref>; <xref rid="btx025-B13" ref-type="bibr">Edgar, 2010</xref>; <xref rid="btx025-B33" ref-type="bibr">Puillandre <italic>et al.</italic>, 2012</xref>). These methods address different research questions (<xref rid="btx025-B9" ref-type="bibr">Casiraghi <italic>et al.</italic>, 2010</xref>); thus, the user needs to assess several factors before choosing the most appropriate method for a particular study. The “species-tree” approaches rely on multiple genetic loci (<xref rid="btx025-B23" ref-type="bibr">Jones <italic>et al.</italic>, 2015</xref>; <xref rid="btx025-B46" ref-type="bibr">Yang and Rannala, 2014</xref>) and account for potential species-tree/gene-tree incongruence (<xref rid="btx025-B26" ref-type="bibr">Maddison, 1997</xref>). Such methods are the most appropriate when the goal is to perform taxonomic revisions. However, most current implementations (<xref rid="btx025-B23" ref-type="bibr">Jones <italic>et al.</italic>, 2015</xref>; <xref rid="btx025-B46" ref-type="bibr">Yang and Rannala, 2014</xref>) are computationally demanding and can only be applied to small datasets of closely related taxa, becoming impractical with a growing number of samples and/or loci [see <xref rid="btx025-B16" ref-type="bibr">Fujisawa <italic>et al.</italic> (2016)</xref> for a recently introduced faster method]. Large-scale biodiversity (meta-) barcoding studies comprise hundreds or even thousands of samples of high evolutionary divergence. The goal of such studies often is to obtain β-diversity estimates (comparative studies of different treatments, ecological factors, etc.) or a rough estimate of the biodiversity for a given sample. Hence, a researcher may use distance-based methods (<xref rid="btx025-B13" ref-type="bibr">Edgar, 2010</xref>; <xref rid="btx025-B18" ref-type="bibr">Hao <italic>et al.</italic>, 2011</xref>; <xref rid="btx025-B33" ref-type="bibr">Puillandre <italic>et al.</italic>, 2012</xref>) that scale well on large datasets with respect to run times. However, these methods ignore the evolutionary relationships of the involved taxa and rely on not necessarily biologically meaningful <italic>ad hoc</italic> sequence similarity thresholds. Moreover, they are restricted to single-locus data, which reduces the accuracy of the delimitation (<xref rid="btx025-B12" ref-type="bibr">Dupuis <italic>et al.</italic>, 2012</xref>).</p>
    <p>The General Mixed Yule Coalescent (GMYC; <xref rid="btx025-B15" ref-type="bibr">Fujisawa and Barraclough, 2013</xref>; <xref rid="btx025-B32" ref-type="bibr">Pons <italic>et al.</italic>, 2006</xref>) and the recently introduced Poisson Tree Processes (PTP; <xref rid="btx025-B48" ref-type="bibr">Zhang <italic>et al.</italic>, 2013</xref>) are two similar models that bridge the gap between “species-tree” and distance-based methods. While GMYC and PTP are also restricted to single loci, they do take the evolutionary relationships of the sequences into account. Since, at the same time, they are computationally inexpensive they can be deployed for analyzing large (meta-)barcoding samples. The GMYC method (<xref rid="btx025-B15" ref-type="bibr">Fujisawa and Barraclough, 2013</xref>) uses a speciation (<xref rid="btx025-B47" ref-type="bibr">Yule, 1925</xref>) and a neutral coalescent model (<xref rid="btx025-B22" ref-type="bibr">Hudson, 1990</xref>). It strives to maximize the likelihood score by separating/classifying the branches of an ultrametric tree (in units of absolute or relative ages) into two processes; within and between species. In contrast to GMYC, PTP models the branching processes based on the number of accumulated expected substitutions between subsequent speciation events. PTP tries to determine the transition point from a between- to a within-species process by assuming that a two parameter model—one parameter for the speciation and one for the coalescent process—best fits the data. The underlying assumption is that each substitution has a small probability of generating a branching event. Within species, branching events will be frequent whereas among species they will be more sparse. The probability of observing <italic>n</italic> speciations for <italic>k</italic> substitutions follows a Poisson process and therefore, the number of substitutions until the next speciation event can be modeled via an exponential distribution (<xref rid="btx025-B48" ref-type="bibr">Zhang <italic>et al.</italic>, 2013</xref>). Given that PTP directly uses substitutions, it does not require an ultrametric input tree, the inference of which can be time consuming and error prone. Thus, PTP often yields more accurate delimitations than GMYC (<xref rid="btx025-B41" ref-type="bibr">Tang <italic>et al.</italic>, 2014</xref>).</p>
    <p>Here, we introduce a new algorithm and an improved model as well as implementation of PTP that alleviates previous shortcomings of the method. The initial PTP assumes one exponential distribution for the speciation events and only one for the coalescent events, across all species in the phylogeny. While the speciation rate can be assumed to be constant among closely related species, the intraspecific coalescent rate and consequently the genetic diversity may vary significantly even among sister species. This divergence in intraspecific variation can be attributed to factors such as population size and structure, population bottlenecks, selection, life cycle and mating systems (see <xref rid="btx025-B4" ref-type="bibr">Bazin et al. (2006)</xref> for further details). Additionally, sampling bias may also be responsible for observing different levels of intraspecific genetic diversity and it is already known to decrease the accuracy of PTP (<xref rid="btx025-B48" ref-type="bibr">Zhang <italic>et al.</italic>, 2013</xref>). To incorporate the potential divergence in intraspecific diversity, we propose the novel multi-rate PTP (mPTP) model. In contrast to PTP, it fits the branching events of <italic>each</italic> delimited species to a <italic>distinct</italic> exponential distribution. Thereby it can better accommodate the sampling- and population-specific characteristics of a broader range of empirical datasets. In addition, we develop and present a novel, dynamic-programming algorithm for the mPTP model. The implementation is several orders of magnitude faster than the original PTP and yields more accurate delimitations (almost instantly) on large datasets comprising thousands of taxa. Note that, the original PTP requires days of computation time to analyze such datasets. Finally, we provide a <italic>Markov chain Monte Carlo</italic> (MCMC) sampling approach that allows for inferring delimitation support values.</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <p>The mPTP method takes as input a binary, rooted phylogenetic tree inferred with software such as RAxML (<xref rid="btx025-B39" ref-type="bibr">Stamatakis, 2014</xref>) or MrBayes (<xref rid="btx025-B37" ref-type="bibr">Ronquist <italic>et al.</italic>, 2012</xref>). Such software often infer unrooted trees; therefore, mPTP provides the option to root the input tree prior to the analysis either (a) implicitly on its longest terminal branch or (b) explicitly by providing an outgroup. In this section, we introduce the basic notation that is used throughout the manuscript, and provide a detailed description of the mPTP algorithm including the MCMC sampling method.</p>
    <p>A binary rooted tree <inline-formula id="IE1"><mml:math id="MM1"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is a connected acyclic graph where <italic>V</italic> is the set of nodes and <italic>E</italic> the set of branches (or <italic>edges</italic>), such that <inline-formula id="IE2"><mml:math id="MM2"><mml:mrow><mml:mi>E</mml:mi><mml:mo>⊂</mml:mo><mml:mi>V</mml:mi><mml:mo>×</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula>. Each <italic>inner node u</italic> has a <italic>degree</italic> (number of branches for which <italic>u</italic> is an end-point) of 3 with the exception of the root node which has degree 2, while <italic>leaves</italic> (or <italic>tips</italic>) have degree 1. We use the notation <inline-formula id="IE3"><mml:math id="MM3"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> to denote a branch with end-points <inline-formula id="IE4"><mml:math id="MM4"><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE5"><mml:math id="MM5"><mml:mrow><mml:mo>ℓ</mml:mo><mml:mo>:</mml:mo><mml:mi>V</mml:mi><mml:mo>×</mml:mo><mml:mi>V</mml:mi><mml:mo>→</mml:mo><mml:mo>ℝ</mml:mo></mml:mrow></mml:math></inline-formula> to denote the associated branch length. Finally, we use <italic>T<sub>u</sub></italic> to denote the subtree rooted at node <italic>u</italic>.</p>
    <sec>
      <title>2.1 mPTP heuristic algorithm</title>
      <p>Let <inline-formula id="IE6"><mml:math id="MM6"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> be a binary rooted phylogenetic tree with root node <italic>r</italic>. The optimization problem in the original PTP is to find a connected subgraph <inline-formula id="IE7"><mml:math id="MM7"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of <italic>T</italic>, where <inline-formula id="IE8"><mml:math id="MM8"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>⊆</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>⊆</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> such that (a) <italic>G</italic> is a binary tree, and (b) the likelihood of i.i.d branch lengths <italic>E<sub>s</sub></italic> and <inline-formula id="IE9"><mml:math id="MM9"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mi mathvariant="normal">∖</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> fitting two distinct exponential distributions is maximized. Formally, we are interested in maximizing the likelihood
<disp-formula id="E1"><label>(1)</label><mml:math id="MM10"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>ℓ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>c</mml:mi></mml:msub><mml:mo>ℓ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE10"><mml:math id="MM11"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mo>ℓ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE11"><mml:math id="MM12"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mo>ℓ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> are maximum-likelihood (ML) estimates for the rate parameters.</p>
      <p>In the mPTP, we are interested in fitting the branch lengths of <italic>each</italic> maximal subtree of <italic>T</italic> (each species delimited in <italic>T</italic>) formed by branches from <italic>E<sub>c</sub></italic> to a <italic>distinct</italic> exponential distribution. Let <inline-formula id="IE12"><mml:math id="MM13"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> be the <italic>maximal</italic> subtrees of <italic>T</italic> formed exclusively by branches from <italic>E<sub>c</sub></italic> such that <inline-formula id="IE13"><mml:math id="MM14"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">⊔</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and no pair <italic>i</italic>, <italic>j</italic> exists for which <inline-formula id="IE14"><mml:math id="MM15"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mo>∅</mml:mo></mml:mrow></mml:math></inline-formula>. The task in mPTP is to maximize the likelihood
<disp-formula id="E2"><label>(2)</label><mml:math id="MM16"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>ℓ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>ℓ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE15"><mml:math id="MM17"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mo>ℓ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> for <inline-formula id="IE16"><mml:math id="MM18"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula>. We refer to the <italic>k</italic> maximal subtree root nodes as <italic>coalescent roots</italic>.</p>
      <p>Whether a polynomial-time algorithm exists to solve the two problems remains an open question. We assume that the problem is hard, and thus, we propose a greedy, dynamic-programming (DP) algorithm to solve it.</p>
      <p>The algorithm visits all inner nodes of <italic>T</italic> in a bottom-up post-order traversal. For each node <italic>u</italic>, the DP computes an array of <inline-formula id="IE17"><mml:math id="MM19"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> scores, where <italic>E<sub>u</sub></italic> is the set of branches of subtree <italic>T<sub>u</sub></italic>. Entry <inline-formula id="IE18"><mml:math id="MM20"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> assumes that <italic>T<sub>u</sub></italic> contains <italic>i</italic> speciation branches. For the case <italic>i</italic> = 0, <italic>T<sub>u</sub></italic> is part of <italic>a</italic> coalescent process, while for <inline-formula id="IE19"><mml:math id="MM21"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula>, <italic>T<sub>u</sub></italic> is part of <italic>the</italic> single speciation process. Each entry <italic>i</italic> &gt; 0 contains the maximization of <xref ref-type="disp-formula" rid="E2">Equation (2)</xref>, by considering only (i) the branches of subtree <italic>T<sub>u</sub></italic> and (ii) the set <italic>S</italic> of branches of <italic>T</italic> that have at least one end-point on the path from the root <italic>r</italic> to <italic>u</italic>. For this subset of branches, the speciation process consists of exactly <inline-formula id="IE20"><mml:math id="MM22"><mml:mrow><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> branches, and we only consider the coalescent processes inside <italic>T<sub>u</sub></italic>. We restrict ourselves to the set of branches <italic>S</italic> since it is infeasible to test all possible groupings of branches outside of <italic>T<sub>u</sub></italic>. For any <italic>i</italic> &gt; 0, it holds that the edges from <italic>u</italic> leading to its child nodes <italic>v</italic> and <italic>w</italic> belong to the speciation process, and, therefore, <italic>S</italic> is the smallest set of edges which, by definition, must be part of the speciation process.</p>
      <p><xref ref-type="fig" rid="btx025-F1">Figure 1</xref> illustrates the algorithm for a triplet of nodes <italic>u</italic>, <italic>v</italic>, <italic>w</italic>, and marks the set <italic>S</italic> with dashed lines. Entry 0 represents the null-model for <italic>T<sub>u</sub></italic>, that is, all branches of <italic>T<sub>u</sub></italic> belong to the coalescent process [or, equivalently, to the speciation process, as the two cases can not be distinguished by the (m)PTP model]. The score (maximization of <xref ref-type="disp-formula" rid="E2">Equation (2)</xref>) for entry <inline-formula id="IE21"><mml:math id="MM23"><mml:mrow><mml:mi>i</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> is computed from the information stored in the array entries <italic>j</italic> and <italic>k</italic> of the two child nodes <italic>v</italic> and <italic>w</italic>, by considering all combinations of <italic>j</italic> and <italic>k</italic> such that <inline-formula id="IE22"><mml:math id="MM24"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> (plus two accounts for the two outgoing edges of <italic>u</italic>). Not all array entries are necessarily valid. For instance, entry <italic>i</italic> = 1 may be invalid given that node <italic>u</italic> has two out-going branches in the speciation process. Each entry <italic>i</italic> at node <italic>u</italic> stores the computed score, the sum of the speciation branch lengths <inline-formula id="IE23"><mml:math id="MM25"><mml:mrow><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> within <italic>T<sub>u</sub></italic>, the product <inline-formula id="IE24"><mml:math id="MM26"><mml:mrow><mml:msubsup><mml:mi>L</mml:mi><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> of likelihoods of coalescent processes inside <italic>T<sub>u</sub></italic>, and pointers for storing which entries <italic>j</italic> and <italic>k</italic> were chosen for calculating a specific entry <italic>i</italic>. The first term of <xref ref-type="disp-formula" rid="E2">Equation (2)</xref> (coalescent process) is the product of <inline-formula id="IE25"><mml:math id="MM27"><mml:mrow><mml:msubsup><mml:mi>L</mml:mi><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE26"><mml:math id="MM28"><mml:mrow><mml:msubsup><mml:mi>L</mml:mi><mml:mi>w</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, while the second term (speciation process) is computed from the sums <inline-formula id="IE27"><mml:math id="MM29"><mml:mrow><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE28"><mml:math id="MM30"><mml:mrow><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>w</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and the sum of branch lengths from <italic>S</italic>. We store the score and child node entry indices for the combination of <italic>j</italic> and <italic>k</italic> that maximize the score.</p>
      <fig id="btx025-F1" orientation="portrait" position="float">
        <label>Fig. 1.</label>
        <caption>
          <p>Visual representation of the mPTP dynamic programming algorithm. Each entry <italic>i</italic> at node <italic>u</italic> is computed from information stored at entries <italic>j</italic> and <italic>k</italic> of child nodes <italic>v</italic> and <italic>w</italic>, for all <italic>j</italic> and <italic>k</italic> such that <inline-formula id="IE29"><mml:math id="MM31"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>. The dashed branches denote the smallest set <italic>S</italic> of branches which, by definition, must be part of the speciation process, irrespective of the resolution of other subtrees outside <italic>T<sub>u</sub></italic></p>
        </caption>
        <graphic xlink:href="btx025f1"/>
      </fig>
      <p>Once the root node of <italic>T</italic> is processed, we have the likelihood values of exactly <inline-formula id="IE30"><mml:math id="MM32"><mml:mrow><mml:mo>|</mml:mo><mml:mi>E</mml:mi><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> delimitations, one of which corresponds to the null-model (<inline-formula id="IE31"><mml:math id="MM33"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>). We select the entry <italic>i</italic> that minimizes the <italic>Akaike Information Criterion</italic> score corrected for small sample size (<inline-formula id="IE32"><mml:math id="MM34"><mml:mrow><mml:msub><mml:mrow><mml:mtext>AIC</mml:mtext></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>; <xref rid="btx025-B28" ref-type="bibr">McQuarrie and Tsai, 1998</xref>). This way we penalize over-splitting caused by the increasing number of parameters (<inline-formula id="IE33"><mml:math id="MM35"><mml:mrow><mml:msub><mml:mo>λ</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>). A lower <inline-formula id="IE34"><mml:math id="MM36"><mml:mrow><mml:msub><mml:mrow><mml:mtext>AIC</mml:mtext></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> value corresponds to a model which better explains the data. Once the best <inline-formula id="IE35"><mml:math id="MM37"><mml:mrow><mml:msub><mml:mrow><mml:mtext>AIC</mml:mtext></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> corrected entry <italic>i</italic> at the root has been determined, we perform a backtracking procedure using the stored child node pointers to retrieve the coalescent roots and hence obtain the species delimitation. The average asymptotic run-time complexity of the method is <inline-formula id="IE36"><mml:math id="MM38"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with a worst-case of <inline-formula id="IE37"><mml:math id="MM39"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <italic>n</italic> is the number of nodes in <italic>T</italic> (for the proofs see Paragraph 1, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material SI</xref>).</p>
    </sec>
    <sec>
      <title>2.2 MCMC sampling</title>
      <p>One way to assess the confidence of the best-scoring delimitation is to iterate through the finite set Ω of all possible delimitations, and compute a support value for every node <italic>u</italic> of the tree. This value is the sum of Akaike weights (<xref rid="btx025-B1" ref-type="bibr">Akaike, 1978</xref>; <xref rid="btx025-B8" ref-type="bibr">Burnham and Anderson, 2002</xref>) for all delimitations where <italic>u</italic> is part of the speciation process. Since this is infeasible for large trees, we deploy a discrete-time MCMC approach to approximate the probability distribution <italic>π</italic> on Ω that assigns an Akaike weight to each possible delimitation. Hence, by sampling according to the distribution <italic>π</italic>, we are able to approximate the support value for each node of the tree. At each step, we propose a new delimitation by designating a set of coalescent roots and compute its score. We denote the current delimitation as <italic>θ</italic> and the proposed delimitation, after applying a move to <italic>θ</italic>, as <inline-formula id="IE38"><mml:math id="MM40"><mml:mrow><mml:mo>θ</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>. We use the acceptance ratio
<disp-formula id="E3"><mml:math id="MM41"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>L</mml:mi><mml:mi>c</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>θ</mml:mo><mml:mo>′</mml:mo><mml:mo>→</mml:mo><mml:mo>θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>θ</mml:mo><mml:mo>→</mml:mo><mml:mo>θ</mml:mo><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
to decide whether to keep the proposed delimitation <inline-formula id="IE39"><mml:math id="MM42"><mml:mrow><mml:mo>θ</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> or not. We assume that all delimitations are equally probable, and, therefore we use a uniform prior (cancelled out). If <inline-formula id="IE40"><mml:math id="MM43"><mml:mrow><mml:mo>α</mml:mo><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, we accept the delimitation, otherwise we accept it with probability <italic>α</italic>. The term <inline-formula id="IE41"><mml:math id="MM44"><mml:mrow><mml:msubsup><mml:mi>L</mml:mi><mml:mi>c</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>/</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the ratio of the <inline-formula id="IE42"><mml:math id="MM45"><mml:mrow><mml:msub><mml:mrow><mml:mtext>AIC</mml:mtext></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>-corrected likelihood values of <inline-formula id="IE43"><mml:math id="MM46"><mml:mrow><mml:mo>θ</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> over <italic>θ</italic>, and <inline-formula id="IE44"><mml:math id="MM47"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>→</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the transition probability from one delimitation, <italic>x</italic>, to any other delimitation <italic>y</italic>. Given <italic>θ</italic>, we propose <inline-formula id="IE45"><mml:math id="MM48"><mml:mrow><mml:mo>θ</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> by applying one of two possible moves with equal probability. One of the two moves selects a coalescent process at random and splits it into two new coalescent processes, by placing its root node (and its two out-going branches) into the speciation process. The other type of move performs the reverse; a randomly selected node <italic>u</italic>, whose two child nodes are coalescent roots, is removed from the speciation process, effectively merging the two coalescent processes into a new one. The method’s run-time is linear to the number of MCMC steps and independent of the tree size. A full description of the MCMC algorithm appears in Paragraph 3 of <xref ref-type="supplementary-material" rid="sup1">Supplementary Material SI</xref>.</p>
      <p>It is considered good practice that MCMC results are accompanied by a critical convergence assessment. Arguably, a good way of accomplishing this is to compare samples obtained from independent MCMC runs. We use the average standard deviation of delimitation support values (ASDDSV) for quantifying the similarity among such samples. Inspired by the average standard deviation of split frequencies (ASDSF) technique from phylogenetic inference (<xref rid="btx025-B37" ref-type="bibr">Ronquist <italic>et al.</italic>, 2012</xref>), we calculate the ASDDSV by averaging the standard deviation of per-node delimitation support values across multiple independent MCMC runs that explore the delimitation space. Each such MCMC run starts from a randomly generated delimitation. Similarly to ASDSF, ASDDSV approaches zero as runs converge to the same distribution of delimitations.</p>
      <p>ASDDSV is useful for monitoring that runs converge to the same distribution. To further assess the agreement between the sampled delimitations and the best scoring delimitation on large datasets, where visual inspection is impractical, we introduce the <italic>average support value</italic> (ASV), that is,
<disp-formula id="E4"><mml:math id="MM49"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>V<sub>T</sub></italic> is the set of tip nodes within the speciation process, <italic>V<sub>R</sub></italic> is the set of coalescent roots, and <italic>f</italic>(<italic>u</italic>) the support value of node <italic>u</italic>. The closer ASV is to one, the better the support values agree with the ML delimitation.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Experimental setup</title>
    <p>For the evaluation of mPTP, we use empirical datasets that comprise a number of varying parameters (substitution rate, geographic range, genetic diversity etc.), which often occur in practice and are difficult to reproduce with simulations. We retrieved all datasets from the Barcode of Life Database (BOLD, <ext-link ext-link-type="uri" xlink:href="http://www.boldsystems.org/">http://www.boldsystems.org/</ext-link>), the largest barcode library for eukaryotes. For each of the datasets, we inferred the putative species with mPTP and four other methods that model speciation on the basis of genetic distance (including the original PTP method), and assess their accuracy with respect to the current taxonomy (available in BOLD). Finally, we avoided comparisons with time-based delimitation methods (<xref rid="btx025-B15" ref-type="bibr">Fujisawa and Barraclough, 2013</xref>; <xref rid="btx025-B23" ref-type="bibr">Jones <italic>et al.</italic>, 2015</xref>; <xref rid="btx025-B46" ref-type="bibr">Yang and Rannala, 2014</xref>) which are time consuming and heavily dependent on the factorization accuracy of branch lengths into time and evolutionary rate.</p>
    <sec>
      <title>3.1 Empirical datasets</title>
      <p>We retrieved 24 empirical genus level datasets (<xref rid="btx025-T1" ref-type="table">Table 1</xref>) that cover six of the most species rich animal Phyla in BOLD (Arthropoda, Annelida, Chordata, Echinodermata, Platyhelminthes and Cnidaria). This allows us to evaluate the efficiency of mPTP given a wide range of organisms with diverse biological traits and evolutionary histories. The majority of datasets (14 out of 24 datasets) belong to the Arthropoda which is the most species-rich animal group, and the most common group PTP has been applied to so far (in 61 out of 110 citations). Within Arthropoda, we mainly focus on insects (8 out 14 datasets), which represents over 90% of all animals. The rest of the empirical datasets spans the remaining five phyla.
<table-wrap id="btx025-T1" orientation="portrait" position="float"><label>Table 1.</label><caption><p>Main characteristics of empirical test datasets</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col valign="top" align="left" span="1"/><col valign="top" align="left" span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/></colgroup><thead><tr><th rowspan="1" colspan="1">Genus</th><th rowspan="1" colspan="1">Phylum</th><th rowspan="1" colspan="1">NSp</th><th rowspan="1" colspan="1">NMSp</th><th rowspan="1" colspan="1">NSeq</th><th rowspan="1" colspan="1">AL</th><th rowspan="1" colspan="1">APD (%)</th></tr></thead><tbody><tr><td rowspan="1" colspan="1"><italic>Amynthas</italic></td><td rowspan="1" colspan="1">Annelida</td><td rowspan="1" colspan="1">43</td><td rowspan="1" colspan="1">28</td><td rowspan="1" colspan="1">265</td><td rowspan="1" colspan="1">1539</td><td rowspan="1" colspan="1">16.7</td></tr><tr><td rowspan="1" colspan="1"><italic>Phyllotreta</italic></td><td rowspan="1" colspan="1">Arthropoda</td><td rowspan="1" colspan="1">16</td><td rowspan="1" colspan="1">14</td><td rowspan="1" colspan="1">195</td><td rowspan="1" colspan="1">659</td><td rowspan="1" colspan="1">11.8</td></tr><tr><td rowspan="1" colspan="1"><italic>Atheta</italic></td><td rowspan="1" colspan="1">Arthropoda</td><td rowspan="1" colspan="1">84</td><td rowspan="1" colspan="1">60</td><td rowspan="1" colspan="1">399</td><td rowspan="1" colspan="1">1076</td><td rowspan="1" colspan="1">14.2</td></tr><tr><td rowspan="1" colspan="1"><italic>Philodromus</italic></td><td rowspan="1" colspan="1">Arthropoda</td><td rowspan="1" colspan="1">15</td><td rowspan="1" colspan="1">11</td><td rowspan="1" colspan="1">493</td><td rowspan="1" colspan="1">713</td><td rowspan="1" colspan="1">10.2</td></tr><tr><td rowspan="1" colspan="1"><italic>Digrammia</italic></td><td rowspan="1" colspan="1">Arthropoda</td><td rowspan="1" colspan="1">20</td><td rowspan="1" colspan="1">17</td><td rowspan="1" colspan="1">286</td><td rowspan="1" colspan="1">659</td><td rowspan="1" colspan="1">6.2</td></tr><tr><td rowspan="1" colspan="1"><italic>Carabus</italic></td><td rowspan="1" colspan="1">Arthropoda</td><td rowspan="1" colspan="1">49</td><td rowspan="1" colspan="1">34</td><td rowspan="1" colspan="1">514</td><td rowspan="1" colspan="1">880</td><td rowspan="1" colspan="1">11.5</td></tr><tr><td rowspan="1" colspan="1"><italic>Bembidion</italic></td><td rowspan="1" colspan="1">Arthropoda</td><td rowspan="1" colspan="1">97</td><td rowspan="1" colspan="1">80</td><td rowspan="1" colspan="1">532</td><td rowspan="1" colspan="1">1495</td><td rowspan="1" colspan="1">12.9</td></tr><tr><td rowspan="1" colspan="1"><italic>Calcinus</italic></td><td rowspan="1" colspan="1">Arthropoda</td><td rowspan="1" colspan="1">29</td><td rowspan="1" colspan="1">24</td><td rowspan="1" colspan="1">641</td><td rowspan="1" colspan="1">679</td><td rowspan="1" colspan="1">16.6</td></tr><tr><td rowspan="1" colspan="1"><italic>Xysticus</italic></td><td rowspan="1" colspan="1">Arthropoda</td><td rowspan="1" colspan="1">35</td><td rowspan="1" colspan="1">33</td><td rowspan="1" colspan="1">861</td><td rowspan="1" colspan="1">1238</td><td rowspan="1" colspan="1">8.9</td></tr><tr><td rowspan="1" colspan="1"><italic>Gammarus</italic></td><td rowspan="1" colspan="1">Arthropoda</td><td rowspan="1" colspan="1">53</td><td rowspan="1" colspan="1">27</td><td rowspan="1" colspan="1">755</td><td rowspan="1" colspan="1">1082</td><td rowspan="1" colspan="1">21.4</td></tr><tr><td rowspan="1" colspan="1"><italic>Clubiona</italic></td><td rowspan="1" colspan="1">Arthropoda</td><td rowspan="1" colspan="1">35</td><td rowspan="1" colspan="1">32</td><td rowspan="1" colspan="1">1127</td><td rowspan="1" colspan="1">1256</td><td rowspan="1" colspan="1">8.4</td></tr><tr><td rowspan="1" colspan="1"><italic>Culicoides</italic></td><td rowspan="1" colspan="1">Arthropoda</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">76</td><td rowspan="1" colspan="1">1252</td><td rowspan="1" colspan="1">1485</td><td rowspan="1" colspan="1">17.5</td></tr><tr><td rowspan="1" colspan="1"><italic>Balanus</italic></td><td rowspan="1" colspan="1">Arthropoda</td><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">1775</td><td rowspan="1" colspan="1">1548</td><td rowspan="1" colspan="1">2.3</td></tr><tr><td rowspan="1" colspan="1"><italic>Drosophila</italic></td><td rowspan="1" colspan="1">Arthropoda</td><td rowspan="1" colspan="1">148</td><td rowspan="1" colspan="1">109</td><td rowspan="1" colspan="1">2303</td><td rowspan="1" colspan="1">1589</td><td rowspan="1" colspan="1">11.2</td></tr><tr><td rowspan="1" colspan="1"><italic>Anopheles</italic></td><td rowspan="1" colspan="1">Arthropoda</td><td rowspan="1" colspan="1">121</td><td rowspan="1" colspan="1">68</td><td rowspan="1" colspan="1">2741</td><td rowspan="1" colspan="1">1544</td><td rowspan="1" colspan="1">10.5</td></tr><tr><td rowspan="1" colspan="1"><italic>Anolis</italic></td><td rowspan="1" colspan="1">Chordata</td><td rowspan="1" colspan="1">41</td><td rowspan="1" colspan="1">35</td><td rowspan="1" colspan="1">181</td><td rowspan="1" colspan="1">709</td><td rowspan="1" colspan="1">18.9</td></tr><tr><td rowspan="1" colspan="1"><italic>Coryphopterus</italic></td><td rowspan="1" colspan="1">Chordata</td><td rowspan="1" colspan="1">12</td><td rowspan="1" colspan="1">10</td><td rowspan="1" colspan="1">282</td><td rowspan="1" colspan="1">658</td><td rowspan="1" colspan="1">14.7</td></tr><tr><td rowspan="1" colspan="1"><italic>Myotis</italic></td><td rowspan="1" colspan="1">Chordata</td><td rowspan="1" colspan="1">54</td><td rowspan="1" colspan="1">37</td><td rowspan="1" colspan="1">789</td><td rowspan="1" colspan="1">1542</td><td rowspan="1" colspan="1">11.7</td></tr><tr><td rowspan="1" colspan="1"><italic>Cyanea</italic></td><td rowspan="1" colspan="1">Cnidaria</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">92</td><td rowspan="1" colspan="1">1002</td><td rowspan="1" colspan="1">12.7</td></tr><tr><td rowspan="1" colspan="1"><italic>Ophiura</italic></td><td rowspan="1" colspan="1">Echinodermata</td><td rowspan="1" colspan="1">13</td><td rowspan="1" colspan="1">8</td><td rowspan="1" colspan="1">75</td><td rowspan="1" colspan="1">1605</td><td rowspan="1" colspan="1">16.8</td></tr><tr><td rowspan="1" colspan="1"><italic>Holothuria</italic></td><td rowspan="1" colspan="1">Echinodermata</td><td rowspan="1" colspan="1">18</td><td rowspan="1" colspan="1">12</td><td rowspan="1" colspan="1">355</td><td rowspan="1" colspan="1">1553</td><td rowspan="1" colspan="1">13.6</td></tr><tr><td rowspan="1" colspan="1"><italic>Mopalia</italic></td><td rowspan="1" colspan="1">Mollusca</td><td rowspan="1" colspan="1">20</td><td rowspan="1" colspan="1">11</td><td rowspan="1" colspan="1">304</td><td rowspan="1" colspan="1">708</td><td rowspan="1" colspan="1">10.9</td></tr><tr><td rowspan="1" colspan="1"><italic>Rhagada</italic></td><td rowspan="1" colspan="1">Mollusca</td><td rowspan="1" colspan="1">24</td><td rowspan="1" colspan="1">12</td><td rowspan="1" colspan="1">686</td><td rowspan="1" colspan="1">675</td><td rowspan="1" colspan="1">11.1</td></tr><tr><td rowspan="1" colspan="1"><italic>Echinococcus</italic></td><td rowspan="1" colspan="1">Platyhelminthes</td><td rowspan="1" colspan="1">7</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">316</td><td rowspan="1" colspan="1">1608</td><td rowspan="1" colspan="1">5.1</td></tr></tbody></table><table-wrap-foot><fn id="tblfn1"><p>NSp, number of species; NMSp, number of monophyletic species; NSeq, number of sequences; AL, alignment length; APD, average P-distance.</p></fn></table-wrap-foot></table-wrap></p>
      <p>All datasets comprise the 5′ end of the common animal barcoding gene “Cytochrome Oxidase subunit I” (COI-5P) (<xref rid="btx025-B20" ref-type="bibr">Hebert <italic>et al.</italic>, 2003</xref>). The number of taxonomic species in the 24 datasets ranged from four (<italic>Balanus</italic>) to 148 (<italic>Drosophila</italic>), while the number of sequences from 75 (<italic>Ophiura</italic>) to 2741 (<italic>Anopheles</italic>). The number of sequences per species ranged between two and the extreme case of 1763 for <italic>Balanus glandula</italic>, reflecting situations where some species might be readily and others rarely available. Finally, the geographical distribution of the datasets also varied from the global scale (e.g., <italic>Anopheles</italic> and <italic>Drosophila</italic>) to the local scale (e.g., the <italic>Anolis</italic> samples originate from the islands and surrounding shores of the Caribbean sea).</p>
    </sec>
    <sec>
      <title>3.2 Putative species delimitation</title>
      <p>The sequence files obtained from the BOLD database were preprocessed to remove three factors that interfere with the assessment of the delimitation methods. First, the efficiency of each method is measured by comparing the delimited to the taxonomic species (see Section 3.3). Therefore, it was necessary to remove sequences of ambiguous taxonomic assignment. Second, we removed duplicate sequences, using the “-f c” option of RAxML version 8.1.17 (<xref rid="btx025-B39" ref-type="bibr">Stamatakis, 2014</xref>), to avoid unnecessary computations. Finally, for all methods that infer the shifting point among speciation and coalescent based on the data (e.g., <xref rid="btx025-B33" ref-type="bibr">Puillandre <italic>et al.</italic>, 2012</xref>), it is important to assume adequate representation of both processes. Therefore, we removed singleton species that could be a potential source of error in this framework (i.e. the lack of multiple sequences per species will inevitably decrease the distinctiveness of the two evolutionary processes and consequently the identification of the shifting point from one to the other).</p>
      <p>For each dataset, we inferred putative species using the two PTP models and we compared the results to three popular and well-established distance-based methods; ABGD (<xref rid="btx025-B33" ref-type="bibr">Puillandre <italic>et al.</italic>, 2012</xref>), Usearch (<xref rid="btx025-B13" ref-type="bibr">Edgar, 2010</xref>) and Crop (<xref rid="btx025-B18" ref-type="bibr">Hao <italic>et al.</italic>, 2011</xref>). The input format of the data and parameters differ among the five methods. The two PTP versions require a rooted phylogenetic tree. Therefore, we used Mafft v7.123 (<xref rid="btx025-B24" ref-type="bibr">Katoh and Standley, 2013</xref>) to align the sequences of each dataset, and subsequently RAxML under the default algorithm and the GTR + Γ model, to infer an ML tree. To root each tree, we chose outgroup taxa based on previously published phylogenies. For the genera without such prior phylogenetic knowledge, we selected a representative species of a genus belonging to the same family or tribe given the taxonomy in BOLD (NCBI Accession Numbers of the ingroup and the outgroup sequences are provided in <xref ref-type="supplementary-material" rid="sup1">Supplementary Material SII</xref>). Moreover, we implemented a method that identifies and ignores branches that result from identical sequences, during the delimitation process (for more details see Section 2 and <xref ref-type="fig" rid="btx025-F1">Figs 1</xref> and <xref ref-type="fig" rid="btx025-F2">2</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material SI</xref>).</p>
      <fig id="btx025-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p>Average performance over all datasets of the five delimitation methods (mPTP, PTP, Usearch, Crop and ABGD) for the (A) number of species, (B) <italic>F</italic>-scores and (C) number of RTS</p>
        </caption>
        <graphic xlink:href="btx025f2"/>
      </fig>
      <p>For mPTP, we further assessed the confidence of the ML solution using MCMC sampling. For each dataset, we executed ten MCMC runs of <inline-formula id="IE46"><mml:math id="MM50"><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mn>7</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> steps, each starting from an initial random delimitation. We assess whether the independent runs have converged by calculating the ASDDSV. To obtain an overall support for the ML estimate, we computed the mean ASV over all 10 independent runs.</p>
      <p>For each of the remaining three methods (ABGD, Usearch and Crop), we optimized a set of performance-critical parameters and chose the delimitation that recovered the highest number of taxonomic species. ABGD requires two parameters: (i) the prior limit to intraspecific diversity (<italic>P</italic>) and (ii) a proxy for the minimum barcoding gap among the inter- and intraspecific genetic distances (<italic>X</italic>). We ran ABGD with the aligned sequences and 400 parameter combinations. For <italic>P</italic>, we sampled 100 values from the range <inline-formula id="IE47"><mml:math id="MM51"><mml:mrow><mml:mo>〈</mml:mo><mml:mn>0.001</mml:mn><mml:mo>,</mml:mo><mml:mn>0.1</mml:mn><mml:mo>〉</mml:mo></mml:mrow></mml:math></inline-formula> and for <italic>X</italic> we used the four values 0.05, 0.1, 0.15 and 0.2. The only critical parameter for Usearch is the fractional identity threshold (<italic>id</italic>) which defines the minimum similarity for the sequences of each cluster. We performed 50 consecutive runs, increasing the <italic>id</italic> value by 0.01 starting with 0.5. Finally, for Crop, we tried four combinations of the <italic>l</italic> and <italic>u</italic> parameters that correspond to similarity thresholds of 1%, 2%, 3%, and 5% as suggested by the authors (<ext-link ext-link-type="uri" xlink:href="http://code.google.com/p/crop-tingchenlab/">http://code.google.com/p/crop-tingchenlab/</ext-link>). Another critical parameter for Crop is <italic>z</italic>, which specifies the maximum number of sequences to consider after the so-called initial “split and merge”. We set <italic>z</italic> to 100 which is considered a reasonable value for full-length barcoding genes.</p>
    </sec>
    <sec>
      <title>3.3 Comparison of delimitation methods</title>
      <p>The evaluation of the five methods is based on three measures. First, the percentage of recovered taxonomic species (RTS), that is, the percentage of delimited species that match the “true species”. We consider the taxonomic species retrieved from BOLD to be the “true species”, and we deem the performance of the algorithm better when the number of matches to the taxonomic species is higher. Since we do not have the expertise to evaluate the taxonomy of each dataset, we could not assess the accuracy of each individual delimitation. However, by assuming that the closer a delimitation is to the current taxonomy the higher the probability to correspond to the real species, we gain some insight as to the relative accuracy among the different methods. The second measure is the <italic>F</italic>-score, also known as <italic>F</italic>-measure or <italic>F</italic>1-score (<xref rid="btx025-B36" ref-type="bibr">Rijsbergen, 1979</xref>), that is, the harmonic mean of <italic>precision</italic> and <italic>recall</italic>. In species delimitation, <italic>precision</italic> denotes the fraction of clustered sequences belonging to a single taxonomic species. The <italic>recall</italic> describes the fraction of sequences of a species that are clustered together. The <italic>F</italic>-score improves when decreasing (i) the number of species which are split into more than one groups and (ii) the number of taxonomic species lumped together into one group. The <italic>F</italic>-score ranges from 0 to 1, where 1 indicates a perfect agreement among two delimitations. Finally, the third measure is simply the number of delimited species.</p>
      <p>The accuracy of either PTP model in recovering the true species depends on whether these taxa form monophyletic clades. Thus, for PTP and mPTP, we also compare their performance by applying the above measures for monophyletic taxonomic species only. Additionally, we quantify how the percentage of monophyletic species correlates to the percentage of RTS for the five delimitation methods we test. Finally, we test whether the most complex model (mPTP) fits the data significantly better than the simpler one (PTP), by performing a Likelihood Ratio Test (LRT). The LRT comparison among PTP and mPTP is only possible when their likelihood scores are calculated on identical delimitations, in which case the PTP is nested in the mPTP delimitation. Such a comparison informs us whether the additional parameters in mPTP improve significantly the likelihood of the delimitation.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Results</title>
    <p>We analyzed a total of 17 219 COI sequences. The alignment length ranged from 658 bp to 1620 bp, while the proportion of variable nucleotides, measured by average P-Distance (MEGA v5.2; <xref rid="btx025-B40" ref-type="bibr">Tamura <italic>et al.</italic>, 2011</xref>) for each dataset, varied from 2.3% (<italic>Balanus</italic>) to 21.4% (<italic>Gammarus</italic>). <xref rid="btx025-T1" ref-type="table">Table 1</xref> presents the fraction of monophyletic taxonomic species in the phylogenies for each dataset. The fraction ranges from only 51% in <italic>Gammarus</italic>, the most variable of the datasets, to 94% (<italic>Xysticus</italic>). Out of the 400 combinations of parameters tested for ABGD, two recovered the highest number of species, with <italic>P</italic> = 0.010235 and <italic>X</italic> = 0.1 or 0.05. For Usearch, the delimitation that maximized the number of RTS was with the threshold value of <italic>id</italic> = 0.97. Finally, the best-scoring parameter combination for Crop (<italic>l</italic> = 1.0 and <italic>u</italic> = 1.5) corresponds to the 3% similarity threshold. <xref rid="btx025-T2" ref-type="table">Table 2</xref> presents the efficiency of the five delimitation methods for five of the datasets using three measures: percentage of RTS, <italic>F</italic>-score and number of species. A complete list of results for all 24 datasets is given in paragraph 4.1 in <xref ref-type="supplementary-material" rid="sup1">Supplementary Material SI</xref>. Overall, mPTP and ABGD scored best in terms of RTS percentage (59% and 57% on an average, respectively) and <italic>F</italic>-scores (0.828 and 0.819, respectively) compared with the other three methods (PTP: RTS = 53%, <italic>F</italic>-score = 0.776, Usearch: RTS = 53%, <italic>F</italic>-score = 0.79, Crop: RTS = 52%, <italic>F</italic>-score = 0.791) (<xref ref-type="fig" rid="btx025-F2">Fig. 2</xref>). The striking difference between the five methods is in the number of delimited species. The novel mPTP method delimited a total of 1190 species which is the closest to the total number of taxonomic species (1041). In contrast, PTP inferred 2048 species which is almost twice this number. The other three methods yielded more conservative species numbers compared to PTP (Usearch: 1671, Crop: 1663, ABGD: 1412) that are, however, still notably higher than the mPTP estimates (<xref ref-type="fig" rid="btx025-F2">Fig. 2</xref>). In terms of likelihood, when we compared mPTP with PTP for a fixed delimitation, mPTP was always yielding at least as good scores as the PTP but higher in most cases (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S3 in Supplement I</xref>). Based on the LRT results the increase in the likelihood was significant in all datasets except three for which both models resulted in identical or very similar scores.
<table-wrap id="btx025-T2" orientation="portrait" position="float"><label>Table 2.</label><caption><p>Percentage of RTS, <italic>F</italic>-scores and number of delimited species for the five delimitation methods (mPTP, PTP, Usearch, Crop and ABGD) for five of the empirical datasets</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col valign="top" align="left" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="center" span="1"/></colgroup><thead><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">mPTP</th><th rowspan="1" colspan="1">PTP</th><th rowspan="1" colspan="1">Usearch</th><th rowspan="1" colspan="1">Crop</th><th rowspan="1" colspan="1">ABGD</th></tr></thead><tbody><tr><td rowspan="1" colspan="1">Genus</td><td colspan="5" align="center" rowspan="1"><bold><underline>RTS (%)</underline></bold></td></tr><tr><td rowspan="1" colspan="1"><italic>Amynthas</italic></td><td rowspan="1" colspan="1">51</td><td rowspan="1" colspan="1">40</td><td rowspan="1" colspan="1">44</td><td rowspan="1" colspan="1">40</td><td rowspan="1" colspan="1">44</td></tr><tr><td rowspan="1" colspan="1"><italic>Anopheles</italic></td><td rowspan="1" colspan="1">41</td><td rowspan="1" colspan="1">39</td><td rowspan="1" colspan="1">30</td><td rowspan="1" colspan="1">31</td><td rowspan="1" colspan="1">40</td></tr><tr><td rowspan="1" colspan="1"><italic>Atheta</italic></td><td rowspan="1" colspan="1">64</td><td rowspan="1" colspan="1">60</td><td rowspan="1" colspan="1">57</td><td rowspan="1" colspan="1">55</td><td rowspan="1" colspan="1">60</td></tr><tr><td rowspan="1" colspan="1"><italic>Drosophila</italic></td><td rowspan="1" colspan="1">47</td><td rowspan="1" colspan="1">51</td><td rowspan="1" colspan="1">41</td><td rowspan="1" colspan="1">34</td><td rowspan="1" colspan="1">53</td></tr><tr><td rowspan="1" colspan="1"><italic>Philodromus</italic></td><td rowspan="1" colspan="1">60</td><td rowspan="1" colspan="1">27</td><td rowspan="1" colspan="1">47</td><td rowspan="1" colspan="1">53</td><td rowspan="1" colspan="1">47</td></tr><tr><td rowspan="1" colspan="1"/><td colspan="5" align="center" rowspan="1"><bold><underline>F-score</underline></bold></td></tr><tr><td rowspan="1" colspan="1">Amynthas</td><td rowspan="1" colspan="1">0.784</td><td rowspan="1" colspan="1">0.638</td><td rowspan="1" colspan="1">0.649</td><td rowspan="1" colspan="1">0.674</td><td rowspan="1" colspan="1">0.673</td></tr><tr><td rowspan="1" colspan="1"><italic>Anopheles</italic></td><td rowspan="1" colspan="1">0.787</td><td rowspan="1" colspan="1">0.704</td><td rowspan="1" colspan="1">0.730</td><td rowspan="1" colspan="1">0.681</td><td rowspan="1" colspan="1">0.730</td></tr><tr><td rowspan="1" colspan="1"><italic>Atheta</italic></td><td rowspan="1" colspan="1">0.839</td><td rowspan="1" colspan="1">0.844</td><td rowspan="1" colspan="1">0.836</td><td rowspan="1" colspan="1">0.832</td><td rowspan="1" colspan="1">0.850</td></tr><tr><td rowspan="1" colspan="1"><italic>Drosophila</italic></td><td rowspan="1" colspan="1">0.728</td><td rowspan="1" colspan="1">0.559</td><td rowspan="1" colspan="1">0.747</td><td rowspan="1" colspan="1">0.729</td><td rowspan="1" colspan="1">0.765</td></tr><tr><td rowspan="1" colspan="1"><italic>Philodromus</italic></td><td rowspan="1" colspan="1">0.882</td><td rowspan="1" colspan="1">0.717</td><td rowspan="1" colspan="1">0.812</td><td rowspan="1" colspan="1">0.852</td><td rowspan="1" colspan="1">0.828</td></tr><tr><td rowspan="1" colspan="1"/><td colspan="5" align="center" rowspan="1"><bold><underline>Number of species</underline></bold></td></tr><tr><td rowspan="1" colspan="1"><italic>Amynthas</italic></td><td rowspan="1" colspan="1">64</td><td rowspan="1" colspan="1">104</td><td rowspan="1" colspan="1">95</td><td rowspan="1" colspan="1">91</td><td rowspan="1" colspan="1">90</td></tr><tr><td rowspan="1" colspan="1"><italic>Anopheles</italic></td><td rowspan="1" colspan="1">126</td><td rowspan="1" colspan="1">218</td><td rowspan="1" colspan="1">193</td><td rowspan="1" colspan="1">154</td><td rowspan="1" colspan="1">118</td></tr><tr><td rowspan="1" colspan="1"><italic>Atheta</italic></td><td rowspan="1" colspan="1">85</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">95</td><td rowspan="1" colspan="1">95</td><td rowspan="1" colspan="1">91</td></tr><tr><td rowspan="1" colspan="1"><italic>Drosophila</italic></td><td rowspan="1" colspan="1">139</td><td rowspan="1" colspan="1">444</td><td rowspan="1" colspan="1">183</td><td rowspan="1" colspan="1">217</td><td rowspan="1" colspan="1">157</td></tr><tr><td rowspan="1" colspan="1"><italic>Philodromus</italic></td><td rowspan="1" colspan="1">21</td><td rowspan="1" colspan="1">38</td><td rowspan="1" colspan="1">26</td><td rowspan="1" colspan="1">20</td><td rowspan="1" colspan="1">24</td></tr></tbody></table></table-wrap></p>
    <p>When considering only monophyletic species, as one might expect, the recovery percentage increases substantially for both PTP models (82% and 72% on an average for mPTP and PTP, respectively). Similarly, the accuracy of the delimitations is substantially higher for the monophyletic taxonomic species (average <italic>F</italic>-score 0.945 and 0.853 for mPTP and PTP, respectively). These results indicate that polyphyly (we use the term polyphyly in referring to both paraphyly and polyphyly <italic>sensu</italic>, <xref rid="btx025-B17" ref-type="bibr">Funk and Omland, 2003</xref>) is a major contributing factor when taxonomic species are not recovered (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S2 in Supplement I</xref>). In particular, the RTS percentage of either PTP model is highly correlated with the percentage of monophyletic species in a dataset (<xref ref-type="fig" rid="btx025-F3">Fig. 3</xref>). The Pearson coefficient indicates that the correlation is stronger among the species recovered with mPTP (<inline-formula id="IE48"><mml:math id="MM52"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.75</mml:mn></mml:mrow></mml:math></inline-formula>, <italic>P</italic> value = 2.642e−05) than with PTP (<inline-formula id="IE49"><mml:math id="MM53"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.62</mml:mn></mml:mrow></mml:math></inline-formula>, <italic>P</italic> value = 0.001218). The correlation is also positive for the other three methods (<italic>r<sub>ABGD</sub></italic> = 0.63/<italic>P</italic> value = 0.0009327, <italic>r<sub>Usearch</sub></italic> = 0.5/<italic>P</italic> value = 0.01294, <italic>r<sub>Crop</sub></italic> = 0.63/<italic>P</italic> value = 0.0009421) and comparable with PTP but smaller than for mPTP. Similarly, the slope of the regression line was greater for mPTP than for the other methods, indicating a steeper linear relationship between the two variables (<xref ref-type="fig" rid="btx025-F3">Fig. 3</xref>).</p>
    <fig id="btx025-F3" orientation="portrait" position="float">
      <label>Fig. 3.</label>
      <caption>
        <p>For each method, we fit a regression line to the points of correspondence of the percentage of monophyletic species (<italic>x</italic>-axis) to the percentage of RTS (<italic>y</italic>-axis). The Pearson coefficient (<italic>r</italic>) is given for each correlation in the corresponding color</p>
      </caption>
      <graphic xlink:href="btx025f3"/>
    </fig>
    <p>Regarding the confidence of the mPTP delimitations, all independent MCMC runs appear to converge with an ASDDSV below 0.01 for all datasets, except for <italic>Drosophila</italic> (one of the largest datasets), for which the ASDDSV was 0.048, but still in the acceptable range for assuming convergence (<xref rid="btx025-B37" ref-type="bibr">Ronquist <italic>et al.</italic>, 2012</xref>). The ASV with respect to the ML delimitation was very high for all datasets, ranging from 72% (<italic>Phyllotreta</italic>) to 100% (<italic>Balanus</italic>), indicating that the data support well the ML solution (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S3 in Supplement I</xref>). The accumulated running time for all 10 independent runs (executed sequentially on an Intel Core i7-4500U CPU @ 1.80GHz) was less than 50 s on average across all datasets, which corresponds to <inline-formula id="IE50"><mml:math id="MM54"><mml:mrow><mml:mo>∼</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> s per run. For a thorough run-time comparison between PTP and mPTP (including the ML method), refer to Paragraph 4.2 in <xref ref-type="supplementary-material" rid="sup1">Supplementary Material SI</xref>.</p>
  </sec>
  <sec>
    <title>5 Discussion</title>
    <p>Molecular species delimitation has caused mixed reactions within the scientific community, from those highly enthusiastic about its potential to accelerate biodiversity cataloging (<xref rid="btx025-B5" ref-type="bibr">Blaxter, 2003</xref>; <xref rid="btx025-B6" ref-type="bibr">Blaxter and Floyd, 2003</xref>) to those very critical about its role in shaping modern systematics (<xref rid="btx025-B3" ref-type="bibr">Bauer <italic>et al.</italic>, 2010</xref>; <xref rid="btx025-B45" ref-type="bibr">Will <italic>et al.</italic>, 2005</xref>). The main argument between the two conflicting sides is whether molecular delimitation on its own is sufficient to justify taxonomic rearrangements (<xref rid="btx025-B45" ref-type="bibr">Will <italic>et al.</italic>, 2005</xref>). Integrative taxonomy alleviates this conflict as it, by definition, requires multiple levels of evidence taking into account various biodiversity characteristics of an organism to accept potential taxonomic changes. Within this framework, and in line with the independently evolving species concept (<xref rid="btx025-B11" ref-type="bibr">De Queiroz, 2007</xref>) and the phylogenetic species concept, molecular species delimitation using DNA-barcoding serves as an excellent tool in modern taxonomy (<xref rid="btx025-B42" ref-type="bibr">Tautz <italic>et al.</italic>, 2003</xref>; <xref rid="btx025-B44" ref-type="bibr">Vogler and Monaghan, 2007</xref>). It can be easily applied to a large range of organisms regardless of their life stage, gender or prior taxonomic knowledge, by a broad range of researchers. In addition, barcoding genes are easily amplified from small tissue samples even from poorly preserved historical samples (<xref rid="btx025-B2" ref-type="bibr">Austin and Melville, 2006</xref>). Furthermore, such an approach might represent the only feasible approach in biodiversity surveys, as they often comprise a large number of species, many of which might be unknown or not easily accessible. Hence, collecting ecological or morphological traits is often simply not feasible. For historical samples or samples from inaccessible areas (e.g., deep seas, deserts) barcoding methods are equally important, since the collection of life history traits might be similarly challenging. This and previous studies (<xref rid="btx025-B29" ref-type="bibr">Monaghan <italic>et al.</italic>, 2009</xref>; <xref rid="btx025-B14" ref-type="bibr">Esselstyn <italic>et al.</italic>, 2012</xref>; <xref rid="btx025-B35" ref-type="bibr">Ratnasingham and Hebert, 2013</xref>; <xref rid="btx025-B41" ref-type="bibr">Tang <italic>et al.</italic>, 2014</xref>) suggest that single-locus barcoding methods provide meaningful clusters, close to taxonomically acknowledged species. This makes them useful for approximate species estimation studies or when more thorough systematic research is practically impossible.</p>
    <sec>
      <title>5.1 (m)PTP</title>
      <p>The molecular systematics of the example taxa vary from well-studied [e.g., <italic>Anopheles</italic> (<xref rid="btx025-B19" ref-type="bibr">Harbach and Kitching, 2016</xref>), <italic>Drosophila</italic> (<xref rid="btx025-B30" ref-type="bibr">Obbard <italic>et al.</italic>, 2012</xref>)] to scarcely studied (e.g., <italic>Xysticus</italic>, <italic>Clubiona</italic>). They further differ in the number of species, number of sequences per species, geographic ranges, and nucleotide divergences. Despite these differences, mPTP outperforms PTP and yields substantially smaller putative species numbers as well as delimitations that are closer to the current taxonomy. The assumption of mPTP that per-species branch lengths can be fit to distinct exponential distributions increases flexibility and adjustability to more realistic datasets. The divergence of intraspecific diversity patterns may either be due to population traits and processes (<xref rid="btx025-B4" ref-type="bibr">Bazin <italic>et al.</italic>, 2006</xref>) or the uneven sampling of the species (e.g., a highly sampled species from a single location compared to a species represented by one sample from multiple locations). The latter is known to decrease PTP accuracy (<xref rid="btx025-B48" ref-type="bibr">Zhang <italic>et al.</italic>, 2013</xref>).</p>
      <p>The accuracy of (m)PTP strongly correlates with the proportion of monophyletic species in the underlying phylogeny. Polyphyletic species will either be delimited into smaller groups or delimited with other, nested species. Therefore, the recovery rate of taxonomic species is significantly higher when only considering the monophyletic species in each dataset. Among the 24 datasets, the number of monophyletic species ranged from 51% to 94%. Thus, the lack of monophyly is the primary contributing factor for not recovering taxonomic species with either PTP model. The average observed monophyly in our arthropod (76.4%) and the remaining invertebrate (64.7%) datasets corresponds well to available estimates for the same groups (73.5% and 61.4%, respectively) based on a large number of empirical studies (<xref rid="btx025-B17" ref-type="bibr">Funk and Omland, 2003</xref>). The same study reports that the most common reasons for polyphyly are inaccurate taxonomy, incomplete lineage sorting, and retrogressive hybridization (<xref rid="btx025-B17" ref-type="bibr">Funk and Omland, 2003</xref>; <xref rid="btx025-B27" ref-type="bibr">McKay and Zink, 2010</xref>). All three effects could apply to the selected datasets. Nevertheless, only the latter two are relevant to the efficiency of the algorithm <italic>per se</italic>, while the accuracy of the taxonomy is only relevant when it is used as a reference measure. Polyphyletic species affect both PTP versions in the same way. The reason for the improved delimitation accuracy of mPTP over PTP on monophyletic species is that the former accommodates different degrees of intraspecific genetic diversity within a phylogeny.</p>
      <sec>
        <title>5.1.1 MCMC sampling</title>
        <p>The drawback of an ML approach is that it only provides a point estimate and no information on model uncertainty. The confidence about a given solution has a substantial impact in drawing reasonable conclusions. Therefore, we provide an MCMC method for assessing the plausibility of the ML solution. In phylogenies comprising hundreds of taxa, it is hard to obtain an overall support for a particular delimitation hypothesis by visual inspection of the tree. To alleviate this problem, at the end of an MCMC run we calculate the ASV for the ML solution. In our experiments, the ML delimitations were highly supported by the ASVs for all datasets, pointing towards a unimodal likelihood surface for our model (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S3 in Supplement I</xref>). Low ASVs may be interpreted as low confidence for the given delimitation scheme, either because another (multi-modal likelihood surface) or no delimitation scheme (flat-likelihood surface) is well supported. This also indicates a poor fit of the data to the model. The execution times of the MCMC sampling are almost negligible, regardless of tree size, and, therefore, we can thoroughly sample the delimitation space even for phylogenies comprising thousands of taxa. For the large phylogenies of our study (i.e., <italic>Drosophila</italic>, <italic>Anopheles</italic>), the PTP implementation required over 30 h for the ML optimization alone, and would require days or even months for the estimation of support values. Instead, mPTP required less than a minute for both the ML optimization and the support value estimation.</p>
      </sec>
    </sec>
    <sec>
      <title>5.2 Distance-based methods</title>
      <p>Distance-based methods are easy to apply to large datasets as they need minimal preprocessing effort and computational time. Their major weakness is that they require either a threshold value or a combination of parameters associated with the threshold value, the sampling effort, or the search strategy. Empirical data show that certain similarity cut-offs (2–3%) correspond well to the species boundaries of several taxonomic groups (<xref rid="btx025-B20" ref-type="bibr">Hebert <italic>et al.</italic>, 2003</xref>, <xref rid="btx025-B21" ref-type="bibr">Hebert <italic>et al.</italic>, 2004</xref>; ; <xref rid="btx025-B38" ref-type="bibr">Smith <italic>et al.</italic>, 2005</xref>); however, these values are often far from optimal (<xref rid="btx025-B25" ref-type="bibr">Lin <italic>et al.</italic>, 2015</xref>). Selecting these parameters is not intuitive and they may only be evaluated <italic>a posteriori</italic> based on the expectations of the researcher. Furthermore, the empirical knowledge for threshold settings is tightly associated with barcoding genes, and it may not be as useful for other marker genes. Here, we optimized the parameters for three of the most popular distance methods (ABGD, Crop and Usearch) based on the RTS percentage. Despite our substantial effort to use optimal parameters for the given data, our results show that, on an average, mPTP performs better with respect to <italic>F</italic>-scores and RTS percentage. At the same time, it also delimited notably fewer species. ABGD accuracy was the closest to mPTP, while PTP, CROP, and Usearch performed notably worse. Besides accuracy, the greatest advantage of mPTP is that it consistently yields more accurate results without requiring the user to optimize any parameters/thresholds. Finally, in contrast to (m)PTP, distance methods ignore evolutionary relationships. Hence, there is no direct relation between monophyletic species and delimitation accuracy in similarity based tools. However, polyphyly often reflects recent speciation while reciprocal monophyly indicates that significant time since speciation has passed. Consequently, the barcoding gap should be less pronounced in datasets of recently diverged species. This justifies that the RTS fraction improves with the number of monophyletic species.</p>
    </sec>
  </sec>
  <sec>
    <title>6 Conclusions</title>
    <p>We presented mPTP, a novel approach for single-locus delimitation that consistently provides faster and more accurate species estimates than PTP and other popular delimitation methods. As PTP, mPTP is mainly designed for analyzing barcoding loci, but can potentially also be applied to entire organelle phylogenies (e.g. mitochondria, <xref rid="btx025-B34" ref-type="bibr">Qin <italic>et al.</italic>, 2015</xref>). In contrast to methods based on sequence similarity, mPTP does not require any similarity threshold or other user-defined parameter as input. The limitations of mPTP are associated with processes that cannot be detected in either single-gene phylogenies (incomplete lineage sorting, hybridization) or in recent speciation events. The novel dynamic programming delimitation algorithm reduces computation time to a minimum and allows for almost instantaneous species delimitation on phylogenies with thousands of taxa. The MCMC sampling provides support values for the delimited species based on millions (or even billions) of MCMC generations in just a few seconds on a modern computer. The mPTP tool is available both, as a standalone package, and as a web service.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="btx025_supp.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgement</title>
    <p>The authors gratefully acknowledge the support of the Klaus Tschira Foundation.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by European Commission under the 7th Framework Programme [FP7-PEOPLE-2013-IEF EVOGREN (625057) to P.P.]</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="btx025-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Akaike</surname><given-names>H.</given-names></name></person-group> (<year>1978</year>) 
<article-title>A Bayesian analysis of the minimum AIC procedure</article-title>. <source>Ann. Inst. Stat. Math</source>., <volume>30</volume>, <fpage>9</fpage>–<lpage>14</lpage>.</mixed-citation>
    </ref>
    <ref id="btx025-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Austin</surname><given-names>J.J.</given-names></name>, <name name-style="western"><surname>Melville</surname><given-names>J.</given-names></name></person-group> (<year>2006</year>) 
<article-title>Incorporating historical museum specimens into molecular systematic and conservation genetics research</article-title>. <source>Mol. Ecol. Notes</source>, <volume>6</volume>, <fpage>1089</fpage>–<lpage>1092</lpage>.</mixed-citation>
    </ref>
    <ref id="btx025-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bauer</surname><given-names>A.M.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>). 
<article-title>Availability of new Bayesian-delimited gecko names and the importance of character-based species descriptions</article-title>. <source>Proc. R. Soc. Lond. B: Biol. Sci</source>., <volume>278</volume>, <fpage>490</fpage>–<lpage>492</lpage>.</mixed-citation>
    </ref>
    <ref id="btx025-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bazin</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2006</year>) 
<article-title>Population size does not influence mitochondrial genetic diversity in animals</article-title>. <source>Science</source>, <volume>312</volume>, <fpage>570</fpage>–<lpage>572</lpage>.<pub-id pub-id-type="pmid">16645093</pub-id></mixed-citation>
    </ref>
    <ref id="btx025-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Blaxter</surname><given-names>M.</given-names></name></person-group> (<year>2003</year>) 
<article-title>Molecular systematics: counting angels with DNA</article-title>. <source>Nature</source>, <volume>421</volume>, <fpage>122</fpage>–<lpage>124</lpage>.<pub-id pub-id-type="pmid">12520286</pub-id></mixed-citation>
    </ref>
    <ref id="btx025-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Blaxter</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Floyd</surname><given-names>R.</given-names></name></person-group> (<year>2003</year>) 
<article-title>Molecular taxonomics for biodiversity surveys: already a reality</article-title>. <source>Trends Ecol. Evol</source>., <volume>18</volume>, <fpage>268</fpage>–<lpage>269</lpage>.</mixed-citation>
    </ref>
    <ref id="btx025-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Blaxter</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2005</year>) 
<article-title>Defining operational taxonomic units using DNA barcode data</article-title>. <source>Phil. Trans. R. Soc. B: Biol. Sci</source>., <volume>360</volume>, <fpage>1935</fpage>–<lpage>1943</lpage>.</mixed-citation>
    </ref>
    <ref id="btx025-B8">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Burnham</surname><given-names>K.</given-names></name>, <name name-style="western"><surname>Anderson</surname><given-names>D.</given-names></name></person-group> (<year>2002</year>). <source>Model Selection and MultiModel Inference: A Practical Information-Theoretic Approach</source>. 
<publisher-name>Springer</publisher-name>, 
<publisher-loc>New York</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btx025-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Casiraghi</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>DNA barcoding: a six-question tour to improve users’ awareness about the method</article-title>. <source>Brief. Bioinform</source>., <volume>11</volume>, <fpage>440</fpage>–<lpage>453</lpage>.<pub-id pub-id-type="pmid">20156987</pub-id></mixed-citation>
    </ref>
    <ref id="btx025-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dayrat</surname><given-names>B.</given-names></name></person-group> (<year>2005</year>) 
<article-title>Towards integrative taxonomy</article-title>. <source>Biol. J. Linnean Soc</source>., <volume>85</volume>, <fpage>407</fpage>–<lpage>415</lpage>.</mixed-citation>
    </ref>
    <ref id="btx025-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>De Queiroz</surname><given-names>K.</given-names></name></person-group> (<year>2007</year>) 
<article-title>Species concepts and species delimitation</article-title>. <source>Syst. Biol</source>., <volume>56</volume>, <fpage>879</fpage>–<lpage>886</lpage>.<pub-id pub-id-type="pmid">18027281</pub-id></mixed-citation>
    </ref>
    <ref id="btx025-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dupuis</surname><given-names>J.R.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Multi-locus species delimitation in closely related animals and fungi: one marker is not enough</article-title>. <source>Mol. Ecol</source>., <volume>21</volume>, <fpage>4422</fpage>–<lpage>4436</lpage>.<pub-id pub-id-type="pmid">22891635</pub-id></mixed-citation>
    </ref>
    <ref id="btx025-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Edgar</surname><given-names>R.C.</given-names></name></person-group> (<year>2010</year>) 
<article-title>Search and clustering orders of magnitude faster than BLAST</article-title>. <source>Bioinformatics</source>, <volume>26</volume>, <fpage>2460</fpage>–<lpage>2461</lpage>.<pub-id pub-id-type="pmid">20709691</pub-id></mixed-citation>
    </ref>
    <ref id="btx025-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Esselstyn</surname><given-names>J.A.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>). 
<article-title>Single-locus species delimitation: a test of the mixed Yule–coalescent model, with an empirical application to Philippine round-leaf bats</article-title>. <source>Proc. R. Soc. Lond. B: Biol. Sci</source>. doi:10.1098/rspb.2012.0705.</mixed-citation>
    </ref>
    <ref id="btx025-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fujisawa</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Barraclough</surname><given-names>T.G.</given-names></name></person-group> (<year>2013</year>) 
<article-title>Delimiting species using single-locus data and the generalized mixed Yule coalescent approach: a revised method and evaluation on simulated data sets</article-title>. <source>Syst. Biol</source>., <volume>62</volume>, <fpage>707</fpage>–<lpage>724</lpage>.<pub-id pub-id-type="pmid">23681854</pub-id></mixed-citation>
    </ref>
    <ref id="btx025-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fujisawa</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>A rapid and scalable method for multilocus species delimitation using Bayesian model comparison and rooted triplets</article-title>. <source>Syst. Biol</source>., <volume>65</volume>, <fpage>759</fpage>–<lpage>771</lpage>.<pub-id pub-id-type="pmid">27055648</pub-id></mixed-citation>
    </ref>
    <ref id="btx025-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Funk</surname><given-names>D.J.</given-names></name>, <name name-style="western"><surname>Omland</surname><given-names>K.E.</given-names></name></person-group> (<year>2003</year>) 
<article-title>Species-level paraphyly and polyphyly: frequency, causes, and consequences, with insights from animal mitochondrial DNA</article-title>. <source>Annu. Rev. Ecol. Evol. Syst</source>., <volume>34</volume>, <fpage>397</fpage>–<lpage>423</lpage>.</mixed-citation>
    </ref>
    <ref id="btx025-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hao</surname><given-names>X.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Clustering 16S rRNA for OTU prediction: a method of unsupervised Bayesian clustering</article-title>. <source>Bioinformatics</source>, <volume>27</volume>, <fpage>611</fpage>–<lpage>618</lpage>.<pub-id pub-id-type="pmid">21233169</pub-id></mixed-citation>
    </ref>
    <ref id="btx025-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Harbach</surname><given-names>R.E.</given-names></name>, <name name-style="western"><surname>Kitching</surname><given-names>I.J.</given-names></name></person-group> (<year>2016</year>) 
<article-title>The phylogeny of Anophelinae revisited: inferences about the origin and classification of Anopheles (Diptera: Culicidae)</article-title>. <source>Zool. Scr</source>., <volume>45</volume>, <fpage>34</fpage>–<lpage>47</lpage>.</mixed-citation>
    </ref>
    <ref id="btx025-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hebert</surname><given-names>P.D.</given-names></name></person-group><etal>et al</etal> (<year>2003</year>) 
<article-title>Biological identifications through DNA barcodes</article-title>. <source>Proc. R. Soc. Lond. B: Biol. Sci</source>., <volume>270</volume>, <fpage>313</fpage>–<lpage>321</lpage>.</mixed-citation>
    </ref>
    <ref id="btx025-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hebert</surname><given-names>P.D.</given-names></name></person-group><etal>et al</etal> (<year>2004</year>) 
<article-title>Identification of birds through DNA barcodes</article-title>. <source>PLoS Biol</source>., <volume>2</volume>, <fpage>1657</fpage>–<lpage>1663</lpage>.</mixed-citation>
    </ref>
    <ref id="btx025-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hudson</surname><given-names>R.R.</given-names></name></person-group> (<year>1990</year>) 
<article-title>Gene genealogies and the coalescent process</article-title>. <source>Oxford Surv. Evol. Biol</source>., <volume>7</volume>, <fpage>44.</fpage></mixed-citation>
    </ref>
    <ref id="btx025-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jones</surname><given-names>G.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>DISSECT: an assignment-free Bayesian discovery method for species delimitation under the multispecies coalescent</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>991</fpage>–<lpage>998</lpage>.<pub-id pub-id-type="pmid">25422051</pub-id></mixed-citation>
    </ref>
    <ref id="btx025-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Katoh</surname><given-names>K.</given-names></name>, <name name-style="western"><surname>Standley</surname><given-names>D.M.</given-names></name></person-group> (<year>2013</year>) 
<article-title>MAFFT multiple sequence alignment software version 7: improvements in performance and usability</article-title>. <source>Mol. Biol. Evol</source>., <volume>30</volume>, <fpage>772</fpage>–<lpage>780</lpage>.<pub-id pub-id-type="pmid">23329690</pub-id></mixed-citation>
    </ref>
    <ref id="btx025-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lin</surname><given-names>X.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Exploring Genetic Divergence in a Species-Rich Insect Genus Using 2790 DNA Barcodes</article-title>. <source>PLoS ONE</source>, <volume>10</volume>, <fpage>1</fpage>–<lpage>24</lpage>.</mixed-citation>
    </ref>
    <ref id="btx025-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Maddison</surname><given-names>W.P.</given-names></name></person-group> (<year>1997</year>) 
<article-title>Gene trees in species trees</article-title>. <source>Syst. Biol</source>., <volume>46</volume>, <fpage>523</fpage>–<lpage>536</lpage>.</mixed-citation>
    </ref>
    <ref id="btx025-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>McKay</surname><given-names>B.D.</given-names></name>, <name name-style="western"><surname>Zink</surname><given-names>R.M.</given-names></name></person-group> (<year>2010</year>) 
<article-title>The causes of mitochondrial DNA gene tree paraphyly in birds</article-title>. <source>Mol. Phylogenet. Evol</source>., <volume>54</volume>, <fpage>647</fpage>–<lpage>650</lpage>.<pub-id pub-id-type="pmid">19716428</pub-id></mixed-citation>
    </ref>
    <ref id="btx025-B28">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>McQuarrie</surname><given-names>A.D.</given-names></name>, <name name-style="western"><surname>Tsai</surname><given-names>C.L.</given-names></name></person-group> (<year>1998</year>). <source>Regression and Time Series Model Selection</source>.: 
<publisher-name>World Scientific</publisher-name>, 
<publisher-loc>Singapore</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btx025-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Monaghan</surname><given-names>M.T.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Accelerated species inventory on Madagascar using coalescent-based models of species delineation</article-title>. <source>Syst. Biol</source>., <volume>58</volume>, <fpage>298</fpage>–<lpage>311</lpage>.<pub-id pub-id-type="pmid">20525585</pub-id></mixed-citation>
    </ref>
    <ref id="btx025-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Obbard</surname><given-names>D.J.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Estimating divergence dates and substitution rates in the Drosophila phylogeny</article-title>. <source>Mol. Biol. Evol.</source>, page mss150.</mixed-citation>
    </ref>
    <ref id="btx025-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Oliver</surname><given-names>I.</given-names></name>, <name name-style="western"><surname>Beattie</surname><given-names>A.J.</given-names></name></person-group> (<year>1993</year>) 
<article-title>A possible method for the rapid assessment of biodiversity</article-title>. <source>Conserv. Biol</source>., <volume>7</volume>, <fpage>562</fpage>–<lpage>568</lpage>.</mixed-citation>
    </ref>
    <ref id="btx025-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pons</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2006</year>) 
<article-title>Sequence-based species delimitation for the DNA taxonomy of undescribed insects</article-title>. <source>Syst. Biol</source>., <volume>55</volume>, <fpage>595</fpage>–<lpage>609</lpage>.<pub-id pub-id-type="pmid">16967577</pub-id></mixed-citation>
    </ref>
    <ref id="btx025-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Puillandre</surname><given-names>N.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>ABGD, Automatic Barcode Gap Discovery for primary species delimitation</article-title>. <source>Mol. Ecol</source>., <volume>21</volume>, <fpage>1864</fpage>–<lpage>1877</lpage>.<pub-id pub-id-type="pmid">21883587</pub-id></mixed-citation>
    </ref>
    <ref id="btx025-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Qin</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Mitochondrial phylogenomics and genetic relationships of closely related pine moth (Lasiocampidae: Dendrolimus) species in China, using whole mitochondrial genomes</article-title>. <source>BMC Genomics</source>, <volume>16</volume>, <fpage>1.</fpage><pub-id pub-id-type="pmid">25553907</pub-id></mixed-citation>
    </ref>
    <ref id="btx025-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ratnasingham</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Hebert</surname><given-names>P.D.</given-names></name></person-group> (<year>2013</year>) 
<article-title>A DNA-based registry for all animal species: The Barcode Index Number (BIN) System</article-title>. <source>PloS One</source>, <volume>8</volume>, <fpage>e66213.</fpage><pub-id pub-id-type="pmid">23861743</pub-id></mixed-citation>
    </ref>
    <ref id="btx025-B36">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Rijsbergen</surname><given-names>C.J.V.</given-names></name></person-group> (<year>1979</year>). <source>Information Retrieval</source>, <edition>2nd edn.</edition><publisher-name>Butterworth-Heinemann</publisher-name>, 
<publisher-loc>Newton, MA, USA</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btx025-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ronquist</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>MrBayes 3.2: efficient Bayesian phylogenetic inference and model choice across a large model space</article-title>. <source>Systematic Biology</source>, <volume>61</volume>, <fpage>539</fpage>–<lpage>542</lpage>.<pub-id pub-id-type="pmid">22357727</pub-id></mixed-citation>
    </ref>
    <ref id="btx025-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Smith</surname><given-names>M.A.</given-names></name></person-group><etal>et al</etal> (<year>2005</year>) 
<article-title>DNA barcoding for effective biodiversity assessment of a hyperdiverse arthropod group: the ants of Madagascar</article-title>. <source>Philos. Trans. R. Soc. B: Biol. Sci</source>., <volume>360</volume>, <fpage>1825</fpage>–<lpage>1834</lpage>.</mixed-citation>
    </ref>
    <ref id="btx025-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Stamatakis</surname><given-names>A.</given-names></name></person-group> (<year>2014</year>) 
<article-title>RAxML version 8: a tool for phylogenetic analysis and post-analysis of large phylogenies</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>1312</fpage>–<lpage>1313</lpage>.<pub-id pub-id-type="pmid">24451623</pub-id></mixed-citation>
    </ref>
    <ref id="btx025-B40">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Tamura</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) <source>MEGA 5: Molecular Evolutionary Genetics Analysis</source>. 
<publisher-name>Center for Evolutionary Functional Genomics: The Biodesign Institute</publisher-name>, 
<publisher-loc>Tempe, AZ</publisher-loc>, pp. <fpage>85287</fpage>–<lpage>85301</lpage></mixed-citation>
    </ref>
    <ref id="btx025-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tang</surname><given-names>C.Q.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Effects of phylogenetic reconstruction method on the robustness of species delimitation using single-locus data</article-title>. <source>Methods Ecol. Evol</source>., <volume>5</volume>, <fpage>1086</fpage>–<lpage>1094</lpage>.<pub-id pub-id-type="pmid">25821577</pub-id></mixed-citation>
    </ref>
    <ref id="btx025-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tautz</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2003</year>) 
<article-title>A plea for DNA taxonomy</article-title>. <source>Trends Ecol. Evol</source>., <volume>18</volume>, <fpage>70</fpage>–<lpage>74</lpage>.</mixed-citation>
    </ref>
    <ref id="btx025-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Valentini</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>DNA barcoding for ecologists</article-title>. <source>Trends Ecol. Evol</source>., <volume>24</volume>, <fpage>110</fpage>–<lpage>117</lpage>.<pub-id pub-id-type="pmid">19100655</pub-id></mixed-citation>
    </ref>
    <ref id="btx025-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Vogler</surname><given-names>A.P.</given-names></name>, <name name-style="western"><surname>Monaghan</surname><given-names>M.T.</given-names></name></person-group> (<year>2007</year>) 
<article-title>Recent advances in DNA taxonomy</article-title>. <source>J. Zool. Syst. Evol. Res</source>., <volume>45</volume>, <fpage>1</fpage>–<lpage>10</lpage>.</mixed-citation>
    </ref>
    <ref id="btx025-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Will</surname><given-names>K.W.</given-names></name></person-group><etal>et al</etal> (<year>2005</year>) 
<article-title>The perils of DNA barcoding and the need for integrative taxonomy</article-title>. <source>Syst. Biol</source>., <volume>54</volume>, <fpage>844</fpage>–<lpage>851</lpage>.<pub-id pub-id-type="pmid">16243769</pub-id></mixed-citation>
    </ref>
    <ref id="btx025-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>Z.</given-names></name>, <name name-style="western"><surname>Rannala</surname><given-names>B.</given-names></name></person-group> (<year>2014</year>) 
<article-title>Unguided species delimitation using DNA sequence data from multiple loci</article-title>. <source>Mol. Biol. Evol</source>., <volume>31</volume>, <fpage>3125</fpage>–<lpage>3135</lpage>.<pub-id pub-id-type="pmid">25274273</pub-id></mixed-citation>
    </ref>
    <ref id="btx025-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yule</surname><given-names>G.U.</given-names></name></person-group> (<year>1925</year>) 
<article-title>A mathematical theory of evolution, based on the conclusions of Dr. J. C. Willis, F.R.S</article-title>. <source>Philos. Trans. R. Soc. Lond.. Ser. B: Containing Papers of a Biological Character</source>, <volume>213</volume>, <fpage>21</fpage>–<lpage>87</lpage>.</mixed-citation>
    </ref>
    <ref id="btx025-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>A general species delimitation method with applications to phylogenetic placements</article-title>. <source>Bioinformatics</source>, <volume>29</volume>, <fpage>2869</fpage>–<lpage>2876</lpage>.<pub-id pub-id-type="pmid">23990417</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
