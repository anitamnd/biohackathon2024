<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">NPJ Syst Biol Appl</journal-id>
    <journal-id journal-id-type="iso-abbrev">NPJ Syst Biol Appl</journal-id>
    <journal-title-group>
      <journal-title>NPJ Systems Biology and Applications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2056-7189</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10516955</article-id>
    <article-id pub-id-type="pmid">37736766</article-id>
    <article-id pub-id-type="publisher-id">299</article-id>
    <article-id pub-id-type="doi">10.1038/s41540-023-00299-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>BioNetGMMFit: estimating parameters of a BioNetGen model from time-stamped snapshots of single cells</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8370-7738</contrib-id>
        <name>
          <surname>Wu</surname>
          <given-names>John</given-names>
        </name>
        <address>
          <email>wu.4427@osu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stewart</surname>
          <given-names>William C. L.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jayaprakash</surname>
          <given-names>Ciriyam</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Das</surname>
          <given-names>Jayajit</given-names>
        </name>
        <address>
          <email>jayajit.das@nationwidechildrens.org</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00rs6vg23</institution-id><institution-id institution-id-type="GRID">grid.261331.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 2285 7943</institution-id><institution>Department of Computer Science, </institution><institution>The Ohio State University, </institution></institution-wrap>281 W Lane Ave, Columbus, OH 43210 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/003rfsp33</institution-id><institution-id institution-id-type="GRID">grid.240344.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 0392 3476</institution-id><institution>Steve and Cindy Rasmussen Institute for Genomics, </institution><institution>The Abigail Wexner Research Institute, Nationwide Children’s Hospital, </institution></institution-wrap>700 Children’s Drive, Columbus, OH 43205 USA </aff>
      <aff id="Aff3"><label>3</label>GIG Statistical Consulting LLC, Columbus, OH 43210 USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00rs6vg23</institution-id><institution-id institution-id-type="GRID">grid.261331.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 2285 7943</institution-id><institution>Department of Physics, </institution><institution>The Ohio State University, </institution></institution-wrap>191 W Woodruff Ave, Columbus, OH 43210 USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00rs6vg23</institution-id><institution-id institution-id-type="GRID">grid.261331.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 2285 7943</institution-id><institution>Departments of Pediatrics, Biomedical Informatics, Pelotonia Institute of Immuno-Oncology, College of Medicine, and Biophysics Program, </institution><institution>The Ohio State University, </institution></institution-wrap>370 W 9th Ave, Columbus, OH 43210 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>22</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>9</volume>
    <elocation-id>46</elocation-id>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>7</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Mechanistic models are commonly employed to describe signaling and gene regulatory kinetics in single cells and cell populations. Recent advances in single-cell technologies have produced multidimensional datasets where snapshots of copy numbers (or abundances) of a large number of proteins and mRNA are measured across time in single cells. The availability of such datasets presents an attractive scenario where mechanistic models are validated against experiments, and estimated model parameters enable quantitative predictions of signaling or gene regulatory kinetics. To empower the systems biology community to easily estimate parameters accurately from multidimensional single-cell data, we have merged a widely used rule-based modeling software package BioNetGen, which provides a user-friendly way to code for mechanistic models describing biochemical reactions, and the recently introduced CyGMM, that uses cell-to-cell differences to improve parameter estimation for such networks, into a single software package: BioNetGMMFit. BioNetGMMFit provides parameter estimates of the model, supplied by the user in the BioNetGen markup language (BNGL), which yield the best fit for the observed single-cell, time-stamped data of cellular components. Furthermore, for more precise estimates, our software generates confidence intervals around each model parameter. BioNetGMMFit is capable of fitting datasets of increasing cell population sizes for any mechanistic model specified in the BioNetGen markup language. By streamlining the process of developing mechanistic models for large single-cell datasets, BioNetGMMFit provides an easily-accessible modeling framework designed for scale and the broader biochemical signaling community.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Software</kwd>
      <kwd>Time series</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>This work is supported by the NIH (U.S) awards R01-AI 143740 and R01-AI 146581 to JD, and by the Research Institute at the Nationwide Children’s Hospital</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>This work is supported by the NIH awards R01-AI 143740 and R01-AI 146581 to JD, and by the Research Institute at the Nationwide Children’s Hospital</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature Limited 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par2">Recent advancements in single-cell technologies have allowed for the measurement of cell-to-cell differences in mRNA/protein abundances<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref></sup>. These differences enable the evaluation of means and higher-order moments (e.g., variances and covariances), which can be utilized to improve the estimation of model parameters. One potential strategy, which is especially useful in our case where the probability distribution for the data (i.e., the likelihood) is unknown, is to estimate model parameters by minimizing the differences between sample moments and their corresponding predicted moments computed from in silico models. However, it is not obvious how any set of moment differences should be summarized, especially since sample moments (and hence moment differences) can vary considerably in single-cell data. The Generalized Method of Moments (GMM), widely used in econometrics<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR5">5</xref></sup> and described in greater detail below, provides a systematic approach to incorporate means and higher-order moments in parameter estimation<sup><xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR7">7</xref></sup>. Within GMM, the moment differences are combined into a single measure of cost (i.e., distance) using a system of weights that efficiently accounts for fluctuations across sample moments (see A.1 GMM Primer for more details). In practice, to find parameter values that minimize the GMM cost, one usually needs an optimization algorithm such as gradient-descent<sup><xref ref-type="bibr" rid="CR8">8</xref></sup> or stochastic algorithms, such as simulated annealing<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> or parallel tempering<sup><xref ref-type="bibr" rid="CR10">10</xref>,<xref ref-type="bibr" rid="CR11">11</xref></sup>. In recent years, a class of meta-heuristic optimization algorithms, such as Particle Swarm Optimization (PSO) that do not require the calculation of gradients and can be easily parallelized has been developed (see refs. <sup><xref ref-type="bibr" rid="CR12">12</xref>,<xref ref-type="bibr" rid="CR13">13</xref></sup> for a pedagogical review).</p>
    <p id="Par3">Rule-based modeling approaches, such as BioNetGen<sup><xref ref-type="bibr" rid="CR14">14</xref></sup> and libRoadRunner<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>, have been developed to address combinatorial complexity in modeling biochemical reactions in signaling and gene regulatory networks<sup><xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup>. These approaches provide a user-friendly way to construct models. Estimating model parameters, such as reaction rates, is crucial for improving model predictions and quantifying underlying mechanisms described by the model using experimental measurements. With the emergence of software packages such as PyBioNetFit<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, parameter estimation from rule-based models using bulk measurements of selected proteins (e.g., average or total protein abundances observed over time) has become possible.</p>
    <p id="Par4">We introduce BioNetGMMFit, a software tool that uses GMM to improve parameter estimation in BioNetGen models by exploiting the additional information in single-cell snapshot data. This tool requires users to supply a BioNetGen model .bngl file, time-stamped snapshot abundance data files, and run configuration files. BioNetGMMFit utilizes the GMM analysis of time-stamped protein abundances, as implemented in CyGMM<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>, to estimate the parameters of the BioNetGen model, provide confidence intervals, predict moments at future times, and report the minimum cost (i.e., the distance between the sample moments and the moments predicted by the model using the GMM estimate of the parameters). While GMM can be used in conjunction with a wide variety of optimization routines, we use PSO to optimize our cost function because it does not require gradient calculations, scales well with higher-dimensional search spaces, has a relatively short run time, and is easily parallelized on a compute cluster. In addition, users can tune the PSO hyperparameters, which can affect the optimization’s efficiency and accuracy. As such, in addition to being written in C++, BioNetGMMFit is scalable with increasing data sizes on high-performance computing clusters. BioNetGMMFit is also available through Docker as C++ compilation varies across different operating systems. However, for improved performance, BioNetGMMFit can be compiled as a C++ executable through cmake and has been tested on Linux operating systems.</p>
    <p id="Par5">The manuscript is organized as follows. In the Software Description section, we provide detailed information on the implementation and use of BioNetGMMFit. Next, in the “Results section”, we present three examples of modeling single-cell data where we apply BioNetGMMFit and compare it with existing software tools. Finally, we offer our conclusions, and discuss future directions and limitations in “Discussion”.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <p id="Par6">We applied BioNetGMMFit to simulated datasets generated by models with known ground truth parameters to provide a reference point to evaluate its robustness, efficacy, and versatility. Specifically, we apply BioNetGMMFit to three simulated datasets, where each dataset is generated from a different model. Furthermore, we showcase the software’s functionality, which includes (1) facilitating estimation of model parameters from different combinations of moments for any rule-based model, (2) fixing subsets of model parameters both for simulation and estimation, and (3) forecasting moments at future time points. For each simulated dataset, we generated two sets of initial conditions from lognormal distributions as they have been observed across a variety of single-cell systems<sup><xref ref-type="bibr" rid="CR19">19</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>. To mimic the experimental constraint that “X” cannot be used to generate the observed snapshot data “Y” at time <italic>t</italic>, we generate another set of unobserved initial conditions that are used to obtain “Y” by evolving the BioNetGen models with ground truth parameters. This feature of simulating data with BioNetGen models when given a set of initial conditions is built into BioNetGMMFit. Figure <xref rid="Fig1" ref-type="fig">1</xref> provides a diagram of this process.<fig id="Fig1"><label>Fig. 1</label><caption><title>Data generation process.</title><p>A fundamental constraint of time-stamped CyTOF data is that in order to measure a cell, it must be sacrificed. Therefore, in physical experiments, the initial conditions of cells observed at time <italic>t</italic> and <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${t}^{{\prime} }$$\end{document}</tex-math><mml:math id="M2"><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41540_2023_299_Article_IEq1.gif"/></alternatives></inline-formula> are unknown. Similarly, cells observed at time <italic>t</italic><sub>0</sub>, cannot be observed at future times <italic>t</italic> and <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${t}^{{\prime} }$$\end{document}</tex-math><mml:math id="M4"><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41540_2023_299_Article_IEq2.gif"/></alternatives></inline-formula>. Here, we refer to such initial conditions and future states (shown in yellow) as “unavailable”. By contrast, parameter estimation only makes use of the “observed” data shown in green. Note that the “unavailable” data marked with an asterisk (*) must be generated in order to simulate data obtained from CyTOF experiments. In particular, one must simulate the initial conditions of all cells so that disjoint subsets of cells can be evolved to future times of interest. For ease of exposition, the subset index is not shown. We use the X and Y labels here in order to remain consistent with the inputs defined in Fig. <xref rid="Fig10" ref-type="fig">10</xref>.</p></caption><graphic xlink:href="41540_2023_299_Fig1_HTML" id="d32e361"/></fig></p>
    <p id="Par7">For more information on the simulated datasets themselves, please see the GitHub page (<ext-link ext-link-type="uri" xlink:href="https://github.com/jhnwu3/BioNetGMMFit/tree/main/example">https://github.com/jhnwu3/BioNetGMMFit/tree/main/example</ext-link>) in their respective “X” and “Y” directories.</p>
    <sec id="Sec3">
      <title>A biochemical reaction system with first-order reactions</title>
      <p id="Par8">Here, we investigate and show that BioNetGMMFit can successfully reproduce the ground truth model parameters for a system of first-order reactions model where six molecular species are arranged in a linear architecture and react via first-order biochemical reactions as illustrated by the reaction network in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. The reaction system can represent or can be generalized to represent a variety of sequential cell signaling processes such as phosphorylation of adaptor proteins such as DAP12 or Fc<italic>ϵ</italic>R1<italic>γ</italic> in NK cells<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> which are phosphorylated by Src family kinases or series of chemical modifications in signaling proteins in membrane-proximal signaling events in T cells<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. We successfully estimate all 6 parameters of the model and showcase one of BioNetGMMFit’s important features: the ability to estimate parameters using different moments. We note that one advantage of GMM (see <xref rid="MOESM1" ref-type="media">Supplementary Material)</xref> is that it allows for the use of any number of moments in its objective function. BioNetGMMFit allows the choice of fitting three different combinations of moments of across a dataset: (1) first moments (means), (2) first (means) and second moments (variances), as well as (3) first (means), second (variances), and mixed moments (covariances) as shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>.<fig id="Fig2"><label>Fig. 2</label><caption><title>First-order reaction model.</title><p>On the left, X<sub>1</sub> through X<sub>6</sub> represent protein species in a system of reactions where <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathop{\longrightarrow }\limits^{\theta }$$\end{document}</tex-math><mml:math id="M6"><mml:mover accent="true"><mml:mrow><mml:mo>→</mml:mo></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mover></mml:math><inline-graphic xlink:href="41540_2023_299_Article_IEq3.gif"/></alternatives></inline-formula> represents a reaction in which species X<sub><italic>i</italic></sub> is changed into Click to show the PDF X<sub><italic>j</italic></sub> at the rate given by the corresponding <italic>θ</italic>. BioNetGMMFit is used to estimate the set of <italic>θ</italic>’s. Below the system of reactions, its BioNetGen reaction rules are displayed; these need to be defined and input to BioNetGMMFit to estimate the <italic>θ</italic>’s. Note that we use k’s instead of <italic>θ</italic>’s to define model parameters in BNGL. The table on the right contains the ground truth values.</p></caption><graphic xlink:href="41540_2023_299_Fig2_HTML" id="d32e442"/></fig><fig id="Fig3"><label>Fig. 3</label><caption><title>Parameter estimates using different combinations of moments in the first-order reaction model.</title><p>The left column (<bold>A</bold>) contains 95% confidence intervals of parameter estimates obtained using only the means of the snapshot data at time <italic>t</italic> = 1.5 (top panel) and the comparison of the predicted means and the actual (observed) means (bottom panel). The middle column (<bold>B</bold>) contains analogous results by fitting the means and variances. Note the change in the scale of the values of the moments when the variance is included. The last column (<bold>C</bold>) on the right are the results obtained by fitting all the first, second, and mixed moments or more specifically all 6 means, 6 variances, and 15 covariances of the 6 proteins. This illustrates the flexibility available to the user to choose different subsets of moments for parameter estimation. In the analysis, the initial conditions and the simulated observed conditions at time <italic>t</italic> = 1.5 both contained 10,000 cells each.</p></caption><graphic xlink:href="41540_2023_299_Fig3_HTML" id="d32e466"/></fig></p>
      <p id="Par9">A key strength of this flexibility of moment choice in the cost function is the ability to adapt to different problem requirements. For instance, inclusion of higher-order moments tends to improve parameter estimation in this first-order reaction model as shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>, whereas the usage of variances and covariances in its fitting routine produces the tightest confidence intervals around its parameter estimates.</p>
    </sec>
    <sec id="Sec4">
      <title>Model for Msn2-induced transcription in yeast</title>
      <p id="Par10">Next, as mechanistic models often incorporate some form of nonlinearity, we show that we can successfully perform parameter estimation for a nonlinear gene regulatory model involved in stress response in yeast<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>. This is a simplified version of a commonly occurring gene regulatory motif in yeast. One of the key regulators of the stress response is the transcription factor Msn2 which resides in the cytoplasm in the resting state and is dephosphorylated in response to stress. Upon phosphorylation, Msn2 translocates to the nucleus, binds to stress-responsive elements (STRE), and induces gene expression of response proteins. The model is illustrated in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. This example explores a scenario where certain model parameters need to be fixed. Here we fixed two parameters, the death rate <italic>p</italic><sub><italic>d</italic></sub> and the birth rate <italic>p</italic><sub><italic>b</italic></sub> of the protein species <italic>P</italic>, reducing the total number of parameters to be estimated to four. The BioNetGen rules describing the model and the ground truth parameter values used to generate the synthetic data are shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. We analyzed its simulated observed snapshot data at time points 0, 1, and 5 min in its parameter estimation.<fig id="Fig4"><label>Fig. 4</label><caption><title>Msn2 transcription model.</title><p>Model reaction network is shown on the left with its corresponding BioNetGen reaction rules defined below it. Ground truth model parameters and which ones have been fixed are shown in the table on the right. In this case, non-fixed model parameters labeled by “n” are estimated.</p></caption><graphic xlink:href="41540_2023_299_Fig4_HTML" id="d32e509"/></fig></p>
      <p id="Par11">The parameter estimation results for the Msn2 transcription model are presented in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. Although the moment fits for both time points are not perfect, with an underfitted variance for one of the species, the confidence intervals around the estimated parameters fully encompass the ground truth parameters, indicating that BioNetGMMFit is capable of handling parameter estimation for nonlinear models.<fig id="Fig5"><label>Fig. 5</label><caption><title>Msn2 transcription model outputs.</title><p>Model parameter estimate with confidence intervals on the left were generated by the moment fits for two different simulated observed time points, <italic>t</italic> = 1 and <italic>t</italic> = 5 min, on the right. In this case, 95% confidence intervals of parameter estimates shown on the left include the ground truth parameter values. Please note that the middle two x-tick marks, pb and pd are not estimated and are held constant. Using simulated data for the 5 species (i.e D, T<sub>2</sub>, m, etc.) in the ground truth model, 5 means, 5 variances, and 10 covariances across two time points were obtained and used for parameter estimation. All snapshot data used in the analysis contained 10,000 cells.</p></caption><graphic xlink:href="41540_2023_299_Fig5_HTML" id="d32e531"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Vav1 activation kinetics in NK cells</title>
      <p id="Par12">As the final example, we consider a simplified model early time biochemical signaling kinetics (Fig. <xref rid="Fig6" ref-type="fig">6</xref>) in mouse Natural Killer (NK) cells<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> to illustrate a case where identifiability issues prevent BioNetGMMFit from capturing the ground truth model parameters. The model describes the phosphorylation of a key signaling protein Vav1 by the kinase Syk bound to activating receptor–ligand complex and the dephosphorylation of phosphorylated Vav1 by the phosphatase SHP1 bound to the inhibitory receptor–ligand complex. The nonlinear biochemical reactions in the model are akin to the zero-order ultrasensitivity model proposed by Goldbeter and Koshland<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>. We assume the abundances for the proteins Syk, Vav1, Syk-Vav1, SHP1, SHP1-pVav1, and pVav1 are measured at any time <italic>t</italic>.<fig id="Fig6"><label>Fig. 6</label><caption><title>Vav1 activation model.</title><p>The reaction network displayed on the left represents a simplified version of the phosphorylation-dephosphorylation kinetics of Vav1 in mouse NK cells. The corresponding reaction rules in BioNetGen are shown below. All the parameters, the set of rate constants {<italic>θ</italic><sub><italic>j</italic></sub>} or k<sub><italic>j</italic></sub> in the .bngl file and their ground truth values on the right are estimated using BioNetGMMFit.</p></caption><graphic xlink:href="41540_2023_299_Fig6_HTML" id="d32e568"/></fig></p>
      <p id="Par13">Following parameter estimation, we predict first, second, and mixed moments. The comparisons between the predictions and the simulated observed moments at different time points are shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref>. The three slopes shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref>, each near unity, indicate good agreement between the predicted moments (i.e., means, variances, and covariances) and the observed moments at each time point. Furthermore, using the model parameters estimated by BioNetGMMFit, we can <italic>forecast</italic> moments (i.e., predict moments) at times well outside of the given observational range (Fig. <xref rid="Fig7" ref-type="fig">7)</xref>. The nonlinear Vav1 activation model also presents a case where hyperparameter tuning is needed to generate more accurate parameter estimates. For instance, in Fig. <xref rid="Fig7" ref-type="fig">7</xref>, increasing the number of particles and steps in the PSO routine improves the parameter estimates (i.e., brought them closer to the simulated ground truth). Despite improved estimates, this scenario illustrates a parameter estimation problem where other parameter estimates exist that minimize the objective function. Figure <xref rid="Fig7" ref-type="fig">7</xref> shows that although the moment fits are excellent, and the predictions closely match the observed and future unobserved data, the parameter estimates for k<sub>2</sub> and k<sub>5</sub> are unable to capture the ground truth values, even with a tuned hyperparameter configuration of 1500 particles and 150 steps of PSO. In the subsection below, we provide further insights into the challenges of parameter estimation in rule-based models.<fig id="Fig7"><label>Fig. 7</label><caption><title>Results for the Vav1 activation model.</title><p>The ground truth parameter values shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref> are estimated by BioNetGMMFit using data from the ground truth model at <italic>t</italic> = 0.5 and <italic>t</italic> = 2. In total, 5000 cells at each time point were used in the analysis. The panels in the left column show the predicted moments calculated with estimated parameters plotted against the observed moments calculated using the ground truth model at various time points. The top figure shows the comparison at one of the input time points while the bottom two graphs are the “forecast” moments at <italic>t</italic> = 10 and <italic>t</italic> = 40. This shows that such parameter estimates can predict values at time points well into the future. The parameter estimates were derived from configuration 6 Protein A. Please see Supplementary Figure <xref rid="MOESM1" ref-type="media">11</xref> in the <xref rid="MOESM1" ref-type="media">Supplementary Material</xref> for more information on the PSO hyperparameter configurations used. On the right, we show improvements in estimates by tuning PSO hyperparameters and show parameter estimates for two different hyperparameter configurations. All the moment comparison plots in the left column were generated with parameter estimated obtained using PSO with 1500 particles and 150 steps. Note that the time units for this simulated dataset are arbitrary since BioNetGMMFit does not have units built into its plotting function. However, phosphorylation reactions as defined by the network in Fig. <xref rid="Fig6" ref-type="fig">6</xref> occur on the time scale of seconds.</p></caption><graphic xlink:href="41540_2023_299_Fig7_HTML" id="d32e627"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>Practical concerns in estimation</title>
      <p id="Par14">As seen from the Vav1 activation model, cost functions for ODE models often possess multiple local minima and/or flat regions with small curvatures<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>, that typically make estimation (i.e., the task of finding the best parameter values) challenging for any method. Although PSO mitigates these optimization problems to some extent, depending on the computational constraints, BioNetGMMFit does not fully address the difficulties of such irregular cost functions, e.g., BioNetGMMFit can still yield estimates that reflect a local, rather than the global, minimum. One such example is shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref> where only 150 particles and 25 steps were used for parameter estimation of the simulated Vav1 activation model. We intentionally chose a limited number of particles and steps to examine what could happen in a computationally constrained environment. As one might expect, the estimates for some paremeters were not close to their corresponding ground truth values; however (perhaps surprisingly), the estimates were able to accurately predict the observed first, second, and cross moments at later times as shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref>. However, when the number of particles and steps used are increased tenfold, parameter estimates are much closer to the ground truth, although prediction improves only slightly. Moreover, this dramatic improvement in estimation and a slight improvement in prediction demand higher computational costs as shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">12</xref> where there is a drastic increase in run time from configuration “6 Protein Time Points Set A” to “6 Protein Time Points Set A Extreme” in Supplementary Fig. <xref rid="MOESM1" ref-type="media">12</xref>. As such, this raises an interesting question of “How much should one care about obtaining the best possible parameter estimates (as shown with <italic>k</italic><sub>4</sub> in Fig. <xref rid="Fig7" ref-type="fig">7</xref> for example), especially when computational resources may be limited and/or when the primary interest of the analysis may be prediction, not estimation?” Furthermore, despite the potential for dramatic improvement in estimation, there is no guarantee that one will realize the desired improvement simply by using more particles and/or steps.</p>
      <p id="Par15">We acknowledge the previous work of Sethna et al.<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>, which used information theory to characterize parameter identifiability issues and model sloppiness; and the work of Sorger et al.<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>, which used a Bayesian approach to compare competing models in the presence of partial identifiability. Although BioNetGMMFit is not designed to directly address those issues, our software does give users the ability to inspect a given model for identifiability concerns by constructing pairwise contour plots of the high-dimensional cost (aka objective) function. For each contour plot the x and y axes correspond to a pair of distinct rate constants. For example, pairwise contour plots can be generated for the nonlinear Vav1 activation model, where local minima were virtually indistinguishable from the ground truth, resulting in parameter estimates that were different from the ground truth (see Fig. <xref rid="Fig7" ref-type="fig">7)</xref>. By creating pairwise contour plots for k<sub>2</sub> (or <italic>θ</italic><sub>2</sub>) and k<sub>5</sub>, where PSO was unable to discern the ground truth values (see Fig. <xref rid="Fig8" ref-type="fig">8</xref>), a striped pattern on the log-cost contour plot reveals a region of unidentifiability. In contrast, the well-estimated first-order reaction model has a convex log-cost shape (see Fig. <xref rid="Fig8" ref-type="fig">8</xref>).<fig id="Fig8"><label>Fig. 8</label><caption><title>Contour plots for identifiability.</title><p>Contour plots of the landscape of the cost function are shown as a function of k<sub>2</sub> on the <italic>x</italic> axis and k<sub>5</sub> on the <italic>y</italic> axis with all other model parameters held constant at the ground truth. The left contour plot is a pairwise contour plot of the fully “identifiable” first-order reaction system where a steeply convex cost landscape surrounds the ground truth parameters at the bottom left. The right pairwise contour plot is of the nonlinear Vav1 activation model where a nonconvex cost landscape results in the parameter estimates shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref>. Note the big difference in the scale of the color values for the two plots. The color bar is of the log-GMM cost that is derived by BioNetGMMFit with 6 means, 6 variances, and 15 covariances in its calculation.</p></caption><graphic xlink:href="41540_2023_299_Fig8_HTML" id="d32e705"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>Comparison with other software tools</title>
      <p id="Par16">By combining the best aspects of CyGMM and BioNetGen, BioNetGMMFit provides several noteworthy features for the analysis of single-cell time-stamped cytometry data that complements the currently available parameter estimation software suite (i.e PyBioNetFit<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, Statistical Model Checking (SMC)<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>, COPASI<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>). In particular, BioNetGMMFit offers the ability to efficiently analyze single-cell trajectories for a large number ( &gt; 1000) of cells, predict higher-order moments at future times, and simulate parameter estimation tasks with ground truth parameters. We detail the full capabilities and limitations of BioNetGMMFit below as well as how it compares to other pre-existing parameter estimation software packages. A brief summary of the software-related differences are shown in Fig. <xref rid="Fig9" ref-type="fig">9</xref>.<fig id="Fig9"><label>Fig. 9</label><caption><title>Comparison of BioNetGMMFit features.</title><p>Bulk measurements refer to measurements in which one obtains a single observed value for each species of reactants, at each time point. The observed value may be the mean or total abundance of the species at that time point. In contrast, single-cell measurements yield copy numbers or concentrations of each species for thousands of cells at each time point. This leads to what we refer to as initial abundance noise. The letter “y” indicates that the feature is available and “n” implies that the software is not designed to do it.</p></caption><graphic xlink:href="41540_2023_299_Fig9_HTML" id="d32e732"/></fig></p>
      <sec id="Sec8">
        <title>Dealing efficiently with cell-specific initial conditions</title>
        <p id="Par17">BioNetGMMFit accurately and efficiently estimate BioNetGen model parameters from cytometry snapshot data observed across many single-cell trajectories. It employs the same sophisticated minimization procedure as CyGMM<sup><xref ref-type="bibr" rid="CR7">7</xref></sup> to estimate parameters from the analysis of higher-order moments. To the best of our knowledge, existing software are not designed to account for large variances in initial conditions. Thus, they have difficulty performing parameter estimation efficiently where (1) initial abundance noise is known to play a role and (2) the data consists of large numbers of different single cells (where each cell has its own set of trajectories).</p>
        <p id="Par18">For example, when the estimation depends on the analysis of data from a large number of single cells (as opposed to bulk measurements averaged over cells), existing software is either not designed to handle such data<sup><xref ref-type="bibr" rid="CR18">18</xref>,<xref ref-type="bibr" rid="CR28">28</xref></sup>, or is less user-friendly, or is computationally inefficient<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>. In many cases, when attempting to perform parameter estimation across a combination of moment statistics, inefficiencies related to file input and output occur. For instance, in using BioNetGen’s simulator, each cell has its own BioNetGen file containing a bulk measurement such as average protein abundances. Therefore, to perform parameter estimation across a combination of different measurements (i.e., means, variances, and covariances) with BioNetGen only<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>, the user must repeatedly read from multiple data files in its parameter estimation. In PyBioNetFit<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, only a single set of cell conditions per time point are used for parameter estimation. Our method allows users to input easily several time-stamped snapshot files containing abundance data from thousands of cells and store them directly in memory for quick simulations. See Supplementary Fig. <xref rid="MOESM1" ref-type="media">10</xref> below for each dataset’s cell count used for parameter estimation. While the comparison is not exact as the models and objective function (i.e BioNetGMMFit’s incorporation of higher-order moments) analyzed were different, we show that we can attain run-time performance comparable to that of PyBioNetFit<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. In the analysis of the Vav1 activation model in Fig. <xref rid="Fig6" ref-type="fig">6</xref> with 5000 single cells, the run time was ~1.9 h on a 16-core processor for 30 repeated parameter estimates, which is in the range of run time using the SBML simulator in PyBioNetFit for a similar number of cores<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. To provide some context on run time, we compare with a method such as SMC<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>: while again the comparisons are not exact as the methods and models are different, our run times are comparable to their 4.2 h for parameter estimation. Due to C++ parallelization with OpenMP, our software is capable of linearly scaling with increasing cell count, thereby reducing run times for large numbers of cells. Supplementary Fig. <xref rid="MOESM1" ref-type="media">12</xref> provides run-time details concerning the number of cells and model parameters.</p>
      </sec>
      <sec id="Sec9">
        <title>Estimating with higher-order moments</title>
        <p id="Par19">Due to their design intended for bulk measurements, existing software such as PyBioNetFit<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, COPASI<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>, and PyPesto (from the PETab suite)<sup><xref ref-type="bibr" rid="CR30">30</xref></sup> for rule-based parameter estimation are not specifically designed to fit higher moments. While possible to do a plethora of file input and output to generate multiple parameter distributions per set of initial conditions and generate moment statistics using PyBioNetFit or BioNetGen, for a large number of cells, parameter estimation becomes very user-unfriendly and computationally taxing. In contrast, BioNetGMMFit directly supports three levels of analysis corresponding to using an increasing number of moments. First, one can choose to estimate parameters using only the means (i.e., first moments). Second, one can use both means and variances or third, use means, variances, and covariances. Results for moments with different levels of fitting are shown with its different columns in Fig. <xref rid="Fig3" ref-type="fig">3</xref>.</p>
        <p id="Par20">Other more mature softwares such as COPASI<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> offer a wide variety of other features such as an executable graphical user interface, the ability to export ODEs from these rule-based languages, as well as the support of a wide range of optimization routines. For optimization routines involving smaller and simpler (i.e., linear instead of nonlinear) models where large initial abundance noise is not of concern, it is preferable to use COPASI<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>, PyBioNetFit<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, and PyPesto<sup><xref ref-type="bibr" rid="CR30">30</xref></sup> due to the availability of less computationally expensive gradient-based optimization routines. However, in such simple parameter estimation tasks, BioNetGMMFit performs functionally the same due to its flexibility of cost functions where the user can simply choose to use only the observed first moments.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec10" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par21">We present a new software: BioNetGMMFit, that greatly enhances a researcher’s ability to explore a wide range of mechanistic models while using higher-order moments to leverage the information in single-cell data. In particular, BioNetGMMFit provides accurate estimation of model parameters, and reports valid confidence intervals for each estimated parameter as well. Furthermore, BioNetGMMFit can easily handle data observed across multiple time points, and it can predict protein abundances at future times. A key feature of BioNetGMMFit, which benefits from its integration with libRoadRunner’s simulators, is its ability to easily simulate protein abundances at scale (i.e., across multiple time points, across many single cells, and under a wide variety of different biochemical signaling models). Moreover, because such simulations can now easily be carried out at scale, the ability to tune hyperparameters has become a much more accessible task.</p>
    <p id="Par22">Hyperparameter tuning involves selecting the optimal set of hyperparameters of the optimization routine to achieve the best parameter estimates that minimize the cost function and enable optimal prediction from one’s model. For example, in the case of PSO, there are five hyperparameters to tune, including the number of particles, the number of steps, and three coefficients that affect how the particle swarm moves in the space of model parameters. To address this challenge, we use a simulated reference point of the “optimal” or ground truth parameters for a BioNetGen model, which can provide insights into the performance of an optimization routine’s hyperparameter configuration. A practical way of determining a suitable set of hyperparameters when analyzing experimental data is as follows. If one wishes to fit a model to the data, one can simulate a ground truth version of the model separately and adjust the hyperparameters so that BioNetGMMFit estimates the ground truth values to desired accuracy. Then, one can use these newfound hyperparameters to fit the model to the experimental data.</p>
    <sec id="Sec11">
      <title>Limitations of BioNetGMMFit</title>
      <p id="Par23">BioNetGMMFit is currently limited to parameter estimation for well-mixed mechanistic models describing deterministic and stochastic kinetics. Unlike PyBioNetFit<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, other forms of simulation such as NFsim<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> and spatial modeling<sup><xref ref-type="bibr" rid="CR32">32</xref>,<xref ref-type="bibr" rid="CR33">33</xref></sup> are not supported. Furthermore, BioNetGMMFit does not support any optimization algorithms other than PSO. In addition, the lack of Python support may make it difficult to integrate it with pre-existing workflows that rely heavily on Python. While there exists a C++ static binary that has been tested on Ubuntu Linux, compilation with libRoadRunner C++ libraries can be a nontrivial process on other Linux distributions. Thus, BioNetGMMFit is most readily accessible through Docker, which although accessible across all major operating systems, still requires the use of third-party virtualization software. These software weaknesses will need to be addressed in future iterations of the software.</p>
    </sec>
  </sec>
  <sec id="Sec12">
    <title>Methods</title>
    <sec id="Sec13">
      <title>Software inputs</title>
      <p id="Par24">To illustrate in detail how one might use BioNetGMMFit, a parameter estimation task with an experimental CD8+ T-cell dataset was performed. As shown in Fig. <xref rid="Fig10" ref-type="fig">10</xref>, BioNetGMMFit reads input data from several sources, including (i<sub>1</sub>) a directory containing a CSV file with initial protein abundances (X) and a directory containing CSV files with observed protein abundances at different time snapshots (Y); (i<sub>2</sub>) a time steps CSV file that contains the times at which the data of interest are observed (note that the data of interest may be a subset of the full data); (i<sub>3</sub>) a .bngl (BioNetGen) file that describes the mechanistic model capable of executing deterministic or stochastic kinetics; and (i<sub>4</sub>) a BioNetGMMFit hyperparameter configuration file that enables various features, such as generating time-series snapshot data from the BioNetGen model or changing the number of particles and steps of the PSO routine. A general overview of the BioNetGMMFit workflow is illustrated in Fig. <xref rid="Fig11" ref-type="fig">11</xref>.<fig id="Fig10"><label>Fig. 10</label><caption><title>BioNetGMMFit inputs and outputs.</title><p>The inputs and outputs to the program BioNetGMMFit (yellow box) are displayed. The green boxes, labeled with the letter “i'', are the inputs to the program. The two boxes included in i<sub>1</sub> represent the input directories: X contains the initial conditions for the model and Y, all the observed snapshot data at different time points that must be passed to BioNetGMMFit. The box i<sub>2</sub> is the time steps file that contains all the specified time points at which the concentrations are evaluated, by evolving the model given the initial conditions. i<sub>3</sub> represents the model defined in BioNetGen containing the parameters to be estimated. The BioNetGen model (defined in BNGL) is used to evolve the initial conditions in X to fit the observed moments computed from the data in Y. i<sub>4</sub> is the configuration file that contains the hyperparameters of the PSO (i.e the number of particles, steps, and PSO weights) that need to be defined by the user for the parameter estimation task. The orange boxes indicate outputs and are labeled by “o''. BioNetGMMFit produces two explicit outputs, o<sub>1</sub>, the parameter estimates of the BioNetGen model and o<sub>2</sub>, the corresponding time-evolved moments. The moments in o<sub>2</sub> are generated using the parameter estimates that minimize the GMM cost between the observed moments and predicted moments. Lastly, the user can choose to forecast future trajectories of moments in o<sub>3</sub>.</p></caption><graphic xlink:href="41540_2023_299_Fig10_HTML" id="d32e892"/></fig><fig id="Fig11"><label>Fig. 11</label><caption><title>BioNetGMMFit workflow.</title><p>All “i’’’s and “o’’’s correspond to the same inputs and outputs defined in Fig. <xref rid="Fig10" ref-type="fig">10</xref>. In this figure, we depict the steps needed to run BioNetGMMFit relating back to the inputs and outputs of Fig. <xref rid="Fig10" ref-type="fig">10</xref>. To begin, the snapshot data of interest must be loaded by first organizing all .csv files into their corresponding initial conditions (X) and observed conditions (Y) directories, and then these (X) and (Y) directories (i<sub>1</sub>) must be specified to BioNetGMMFit. The black points in the data boxplot figure represents the outlier of the dataset (specifically CD8+ T-cell dataset). Next, the user must define the time points that correspond to each of the snapshot files by creating and specifying a times.csv file (i<sub>2</sub>). Once all of the data are defined, the user must define and specify the BioNetGen model of interest (i<sub>3</sub>) to BioNetGMMFit. The last input required is the hyperparameters configuration file where the user must define all of the necessary parameters for a parameter estimation run, specifically related to the PSO algorithm that will be used to estimate the BioNetGen model parameters. Once all necessary inputs (i<sub>1</sub>, i<sub>2</sub>, i<sub>3</sub>, and i<sub>4</sub>) are defined, BioNetGMMFit will run its parameter estimation routine with GMM and PSO, returning parameter estimates (o<sub>1</sub>) (and confidence intervals if there are multiple replicate runs of PSO) as well as a <italic>o</italic><italic>b</italic><italic>s</italic><italic>e</italic><italic>r</italic><italic>v</italic><italic>e</italic><italic>d</italic> = <italic>p</italic><italic>r</italic><italic>e</italic><italic>d</italic><italic>i</italic><italic>c</italic><italic>t</italic><italic>e</italic><italic>d</italic> line where observed moment values are on the <italic>y</italic> axis and predicted moments (o<sub>2</sub>) generated from the estimated model parameter on the x axis. Please note that the observed moments are calculated from the abundance data supplied by i<sub>1</sub>, and similarly the predicted moments are computed from the evolved abundances generated by simulating each initial sample with the BioNetGen model. Finally, while optional, users of BioNetGMMFit can predict moments of future time points (o<sub>3</sub>) of the BioNetGen model. Please refer to the <xref rid="MOESM1" ref-type="media">Supplementary Material</xref> for a more in-depth tutorial on how to use the command line version of BioNetGMMFit illustrated with the CD8+ T-cell dataset.</p></caption><graphic xlink:href="41540_2023_299_Fig11_HTML" id="d32e975"/></fig></p>
      <p id="Par25">When working with directories of data files, only one CSV data file is read from directory X to establish the initial set of protein abundances. Meanwhile, directory Y may contain multiple CSV files for each time step being analyzed. These data files are arranged such that each row contains the observations (i.e., protein abundances) from an individual (or single) cell. To ensure that protein abundances or concentrations are nonnegative, any single-cell data containing negative protein values at a given time is removed before performing parameter estimation in BioNetGMMFit. Such a preprocessing step reduces the necessary steps the user must take to properly use BioNetGMMFit, as negative values are commonly generated in CyTOF datasets during a processing step that spreads out zero readings in CyTOF measurements<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>.</p>
    </sec>
    <sec id="Sec14">
      <title>Working example</title>
      <p id="Par26">As an example, we will use a signaling kinetic model involving four proteins to analyze a CD8+ T-cell CyTOF dataset. One biological question of interest that can be addressed with such data is to quantify the rate of the signal propagation between a pair of signaling proteins and study how the rates depend on the developmental state of the immune cell (e.g., naive vs memory CD8+ T cell). We applied BioNetGMMFit to describe signaling kinetics in CD8+ T cells stimulated by CD3 and CD28 antibodies where binding of the antibodies induce phosphorylation of the transmembrane CD3<italic>ζ</italic> chains which further lead to phosphorylation of the adaptor protein SLP76, MAPK kinase Erk and the ribosomal protein S6 following pCD3<italic>ζ</italic> → pSLP76 → pErk → pS6<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>. We model the phosphorylation reactions shown above by first-order reactions. There are many intermediate biochemical reactions involved within the phosphorylation steps shown above and we assume the rates of the first-order reactions effectively capture the effect of those intermediate reactions. The phosphorylated protein species also go through degradation/ubiquitylation processes which are also approximated by first-order decay reactions. In addition, pCD3<italic>ζ</italic> is assumed to be produced at a constant rate due to the signaling process. The model contains five rate constants, <italic>θ</italic><sub>1</sub>, ⋅ ⋅ ⋅ , <italic>θ</italic><sub>5</sub>, which we estimate using BioNetGMMFit. BioNetGMMFit also plots confidence intervals as well as the observed and estimated moments as shown in Fig. <xref rid="Fig12" ref-type="fig">12</xref>. The underlying datasets used in this parameter estimation task of the CD8+ T cells are from (<ext-link ext-link-type="uri" xlink:href="https://dpeerlab.github.io/dpeerlab-website/dremi-data.html">https://dpeerlab.github.io/dpeerlab-website/dremi-data.html</ext-link>) <sup><xref ref-type="bibr" rid="CR35">35</xref></sup>. From this dataset, one can compute time trajectories of the protein moments, means, variances, and covariances (see Fig. <xref rid="Fig12" ref-type="fig">12)</xref>. To make the presentation simple, we will only analyze trajectories at two time points: 1 min and 2 min. In this case, 719 cells were measured at time point 1 in and 653 cells were measured at time point 2 min. Again, as shown in Fig. <xref rid="Fig12" ref-type="fig">12</xref>, mechanistic model reaction rules are defined in the .bngl file where they are then converted into an SBML file using BioNetGen’s writeSBML() function as BioNetGen does not support its own C++ API. Using libRoadRunner’s C++ API<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>, BioNetGMMFit converts this SBML file into a roadrunner object that is capable of simulating the defined model to user-specified time intervals. While there are many other reaction network simulators such as PySB<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>, COPASI<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>, and AMICI<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>, libRoadRunner was primarily chosen for its speed and ease of customizability due to its function as a C++ API rather than a standalone software package.<fig id="Fig12"><label>Fig. 12</label><caption><title>CD8+ T-cell example.</title><p>The input and output results for fitting the CD8+ T-cell CyTOF dataset are shown. The panel labels (i<sub>1</sub>), (i<sub>3</sub>), (o<sub>1</sub>), and (o<sub>2</sub>) correspond to those in Fig. <xref rid="Fig10" ref-type="fig">10</xref>. Panel (i<sub>1</sub>) in Fig. 12 shows the sample means, variances, and covariances of CD8+ T-cell proteins calculated by BioNetGMMFit for the observed time points of snapshot data (supplied in the files i<sub>1</sub> and i<sub>2</sub>). These are used for parameter estimation as part of the GMM procedure. (More information on GMM can be found in the <xref rid="MOESM1" ref-type="media">Supplementary Material</xref>.) Panel (i<sub>3</sub>) displays the reaction network and its corresponding reaction rules in the .bngl file. Each reaction rule represents a reaction within the model and has a parameter (rate constant) associated with it (e.g., k1). Using the observed moments (i<sub>1</sub> panels) BioNetGMMFit uses PSO and GMM to estimate parameters of the model. (o<sub>1</sub>) and (o<sub>2</sub>) illustrate the results for a case where BioNetGMMFit performs 30 PSO estimates and produces a set of confidence intervals as well as a plot of the least GMM cost fit between the observed moments and predicted moments. The fit is performed with 4 protein means, 4 protein variances, and 6 protein covariances. Please note that the user is responsible for the consistency of units units in the input data since BioNetGMMFit uses the input value without ascribing about measurement units. For the CD8+ T-cell data used above, the input data were of the magnitude of fluorescence.</p></caption><graphic xlink:href="41540_2023_299_Fig12_HTML" id="d32e1080"/></fig></p>
      <p id="Par27">Once the model is defined, the hyperparameters configuration file supplies the PSO hyperparameters (i.e., the number of particles, steps, and PSO coefficients) used for parameter estimation. For more information on the configuration file, a table of parameters is provided in the documentation on the GitHub page and in the <xref rid="MOESM1" ref-type="media">Supplementary Material</xref>. To estimate parameters within the BioNetGen model, PSO minimizes the GMM-weighted square Euclidean distances of lower and higher-order moments between the observed and model-simulated data<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. Upon PSO convergence, estimates are provided, and confidence intervals are computed.</p>
      <p id="Par28">The plots of parameter estimates and moment fits provide additional insights into the fit of the mechanistic model. In Fig. <xref rid="Fig12" ref-type="fig">12</xref>, for example, the confidence intervals around the parameter estimates reveal the ranges of possible values for each model parameter and their relative magnitudes. The estimation shows that the rates of production of pCD3<italic>ζ</italic> and of pS6 induced by pErk are the two dominant signaling reactions that occur at the early times (1–2 min) when CD8+ T cells are stimulated. This result is consistent with related conclusions in ref. <sup><xref ref-type="bibr" rid="CR35">35</xref></sup> obtained using information theory. Nonetheless, models are imperfect, and their fits may be poor. To assess the model fit in such cases, we can refer to the “Fit of Predicted Moments” plot in Fig. <xref rid="Fig12" ref-type="fig">12</xref>. This plot shows that the estimated model fails to accurately fit one of the protein’s variances, as indicated by a variance dot biased below the perfect fit line, indicating that further modifications in the model are needed to better fit the data. Such moment plots are essential for evaluating the parameter estimation and model fits that may be difficult to observe with only mean or bulk abundance differences.</p>
      <p id="Par29">BioNetGMMFit is currently available as a docker image for ease of portability across different operating systems, a compilable executable for those requiring high-performance computing capabilities (<ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/7733865">https://zenodo.org/record/7733865</ext-link>), and as a web demo (<ext-link ext-link-type="uri" xlink:href="https://bngmm.nchigm.org/">https://bngmm.nchigm.org/</ext-link>). Further details on how to use and compile BioNetGMMFit are available on the GitHub page (<ext-link ext-link-type="uri" xlink:href="https://github.com/jhnwu3/BioNetGMMFit">https://github.com/jhnwu3/BioNetGMMFit</ext-link>), and a comprehensive tutorial on using BioNetGMMFit can be found in the <xref rid="MOESM1" ref-type="media">Supplementary Material</xref>.</p>
    </sec>
    <sec id="Sec15">
      <title>Reporting summary</title>
      <p id="Par30">Further information on research design is available in the <xref rid="MOESM2" ref-type="media">Nature Research Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec16">
      <title>Supplementary information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41540_2023_299_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Material - BioNetGMMFit</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41540_2023_299_MOESM2_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41540-023-00299-0.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>Special thanks to Dr. Jim Faeder, Dr. Ali Sinan, and Dr. Lucian Smith for their advice in the development of this software. This work is supported by the NIH awards R01-AI 143740 and R01-AI 146581 to J.D., and by the Research Institute at the Nationwide Children’s Hospital.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>Every author contributed to the writing and approval of this manuscript. J.W. and W.C.L.S. contributed to the software development and design of BioNetGMMFit.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The dataset(s) supporting the conclusions of this article is(are) available in the BioNetGMMFit/example repository [<ext-link ext-link-type="uri" xlink:href="https://github.com/jhnwu3/BioNetGMMFit/tree/main/example">https://github.com/jhnwu3/BioNetGMMFit/tree/main/example</ext-link>]. Project name: BioNetGMMFit; Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/jhnwu3/BioNetGMMFit">https://github.com/jhnwu3/BioNetGMMFit</ext-link>; Archived version: N/A; Operating system(s): Platform independent through Docker; Programming language: C/C++; Other requirements: Docker, if Compiling see GitHub; License: MIT License; Any restrictions to use by non-academics: N/A; Other Locations of Access: <ext-link ext-link-type="uri" xlink:href="https://hub.docker.com/repository/docker/jhnwu3/bngmm/general">https://hub.docker.com/repository/docker/jhnwu3/bngmm/general</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/7733865">https://zenodo.org/record/7733865</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://bngmm.nchigm.org/">https://bngmm.nchigm.org/</ext-link>. Experimental CD8+ T-cell data can be found at <ext-link ext-link-type="uri" xlink:href="https://dpeerlab.github.io/dpeerlab-website/dremi-data.html">https://dpeerlab.github.io/dpeerlab-website/dremi-data.html</ext-link>.</p>
  </notes>
  <notes id="FPar1" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par31">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Spitzer</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Nolan</surname>
            <given-names>GP</given-names>
          </name>
        </person-group>
        <article-title>Mass cytometry: single cells, many features</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>165</volume>
        <fpage>780</fpage>
        <lpage>791</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2016.04.019</pub-id>
        <?supplied-pmid 27153492?>
        <pub-id pub-id-type="pmid">27153492</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Papalexi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Single-cell rna sequencing to explore immune cell heterogeneity</article-title>
        <source>Nat. Rev. Immunol.</source>
        <year>2018</year>
        <volume>18</volume>
        <fpage>35</fpage>
        <lpage>45</lpage>
        <pub-id pub-id-type="doi">10.1038/nri.2017.76</pub-id>
        <?supplied-pmid 28787399?>
        <pub-id pub-id-type="pmid">28787399</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saeys</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Van Gassen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lambrecht</surname>
            <given-names>BN</given-names>
          </name>
        </person-group>
        <article-title>Computational flow cytometry: helping to make sense of high-dimensional immunology data</article-title>
        <source>Nat. Rev. Immunol.</source>
        <year>2016</year>
        <volume>16</volume>
        <fpage>449</fpage>
        <lpage>462</lpage>
        <pub-id pub-id-type="doi">10.1038/nri.2016.56</pub-id>
        <?supplied-pmid 27320317?>
        <pub-id pub-id-type="pmid">27320317</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hansen</surname>
            <given-names>LP</given-names>
          </name>
        </person-group>
        <article-title>Large sample properties of generalized method of moments estimators</article-title>
        <source>Econometrica</source>
        <year>1982</year>
        <volume>50</volume>
        <fpage>1029</fpage>
        <lpage>1054</lpage>
        <pub-id pub-id-type="doi">10.2307/1912775</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Hall, A. R. <italic>Generalized Method of Moments</italic> (OUP Oxford, Great Clarendon St, Oxford OX2 6DP, 2004).</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lück</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wolf</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Generalized method of moments for estimating parameters of stochastic reaction networks</article-title>
        <source>BMC Syst. Biol.</source>
        <year>2016</year>
        <volume>10</volume>
        <fpage>98</fpage>
        <pub-id pub-id-type="doi">10.1186/s12918-016-0342-8</pub-id>
        <?supplied-pmid 27769280?>
        <pub-id pub-id-type="pmid">27769280</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Wu, J., Stewart, W., Jayaprakash, C. &amp; Das, J. Generalized method of moments improves parameter estimation in biochemical signaling models of time-stamped single-cell snapshot data. Preprint at <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/early/2022/03/19/2022.03.17.484491">https://www.biorxiv.org/content/early/2022/03/19/2022.03.17.484491</ext-link> (2022).</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Ruder, S. An overview of gradient descent optimization algorithms. Preprint at <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1609.04747">https://arxiv.org/abs/1609.04747</ext-link> (2017).</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kirkpatrick</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gelatt</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Vecchi</surname>
            <given-names>MP</given-names>
          </name>
        </person-group>
        <article-title>Optimization by simulated annealing</article-title>
        <source>Science</source>
        <year>1983</year>
        <volume>220</volume>
        <fpage>671</fpage>
        <lpage>680</lpage>
        <pub-id pub-id-type="doi">10.1126/science.220.4598.671</pub-id>
        <?supplied-pmid 17813860?>
        <pub-id pub-id-type="pmid">17813860</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sambridge</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A Parallel Tempering algorithm for probabilistic sampling and multimodal optimization</article-title>
        <source>Geophys. J. Int.</source>
        <year>2013</year>
        <volume>196</volume>
        <fpage>357</fpage>
        <lpage>374</lpage>
        <pub-id pub-id-type="doi">10.1093/gji/ggt342</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thomas</surname>
            <given-names>BR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BioNetFit: a fitting tool compatible with BioNetGen, NFsim and distributed computing environments</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>32</volume>
        <fpage>798</fpage>
        <lpage>800</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv655</pub-id>
        <?supplied-pmid 26556387?>
        <pub-id pub-id-type="pmid">26556387</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Freitas, D., Lopes, L. G. &amp; Morgado-Dias, F. Particle swarm optimisation: a historical review up to the current developments. <italic>Entropy</italic><bold>22</bold>, 362 (2020).</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Poli</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kennedy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Blackwell</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Particle swarm optimization</article-title>
        <source>Swarm Intell.</source>
        <year>2007</year>
        <volume>1</volume>
        <fpage>33</fpage>
        <lpage>57</lpage>
        <pub-id pub-id-type="doi">10.1007/s11721-007-0002-0</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harris</surname>
            <given-names>LA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BioNetGen 2.2: advances in rule-based modeling</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>3366</fpage>
        <lpage>3368</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw469</pub-id>
        <?supplied-pmid 27402907?>
        <pub-id pub-id-type="pmid">27402907</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Somogyi</surname>
            <given-names>ET</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>libRoadRunner: a high performance SBML simulation and analysis library</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>3315</fpage>
        <lpage>3321</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv363</pub-id>
        <?supplied-pmid 26085503?>
        <pub-id pub-id-type="pmid">26085503</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goldstein</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Faeder</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Hlavacek</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Mathematical and computational models of immune-receptor signalling</article-title>
        <source>Nat. Rev. Immunol.</source>
        <year>2004</year>
        <volume>4</volume>
        <fpage>445</fpage>
        <lpage>456</lpage>
        <pub-id pub-id-type="doi">10.1038/nri1374</pub-id>
        <?supplied-pmid 15173833?>
        <pub-id pub-id-type="pmid">15173833</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loskot</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Atitey</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Mihaylova</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive review of models and methods for inferences in Bio-Chemical reaction networks</article-title>
        <source>Front. Genet.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>549</fpage>
        <pub-id pub-id-type="doi">10.3389/fgene.2019.00549</pub-id>
        <?supplied-pmid 31258548?>
        <pub-id pub-id-type="pmid">31258548</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mitra</surname>
            <given-names>ED</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pybionetfit and the biological property specification language</article-title>
        <source>iScience</source>
        <year>2019</year>
        <volume>19</volume>
        <fpage>1012</fpage>
        <lpage>1036</lpage>
        <pub-id pub-id-type="doi">10.1016/j.isci.2019.08.045</pub-id>
        <?supplied-pmid 31522114?>
        <pub-id pub-id-type="pmid">31522114</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>King</surname>
            <given-names>RD</given-names>
          </name>
        </person-group>
        <article-title>An investigation into the population abundance distribution of mRNAs, proteins, and metabolites in biological systems</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2020</fpage>
        <lpage>2027</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp360</pub-id>
        <?supplied-pmid 19535531?>
        <pub-id pub-id-type="pmid">19535531</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bengtsson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ståhlberg</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rorsman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kubista</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Gene expression profiling in single cells from the pancreatic islets of Langerhans reveals lognormal distribution of mRNA levels</article-title>
        <source>Genome Res.</source>
        <year>2005</year>
        <volume>15</volume>
        <fpage>1388</fpage>
        <lpage>1392</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.3820805</pub-id>
        <?supplied-pmid 16204192?>
        <pub-id pub-id-type="pmid">16204192</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lanier</surname>
            <given-names>LL</given-names>
          </name>
        </person-group>
        <article-title>Up on the tightrope: natural killer cell activation and inhibition</article-title>
        <source>Nat. Immunol.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>495</fpage>
        <lpage>502</lpage>
        <pub-id pub-id-type="doi">10.1038/ni1581</pub-id>
        <?supplied-pmid 18425106?>
        <pub-id pub-id-type="pmid">18425106</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McKeithan</surname>
            <given-names>TW</given-names>
          </name>
        </person-group>
        <article-title>Kinetic proofreading in t-cell receptor signal transduction</article-title>
        <source>Proc. Natl. Acad. Sci. USA</source>
        <year>1995</year>
        <volume>92</volume>
        <fpage>5042</fpage>
        <lpage>5046</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.92.11.5042</pub-id>
        <?supplied-pmid 7761445?>
        <pub-id pub-id-type="pmid">7761445</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hao</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>O’Shea</surname>
            <given-names>EK</given-names>
          </name>
        </person-group>
        <article-title>Signal-dependent dynamics of transcription factor translocation controls gene expression</article-title>
        <source>Nat. Struct. Mol. Biol.</source>
        <year>2012</year>
        <volume>19</volume>
        <fpage>31</fpage>
        <lpage>39</lpage>
        <pub-id pub-id-type="doi">10.1038/nsmb.2192</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Das</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Activation or tolerance of natural killer cells is modulated by ligand quality in a nonmonotonic manner</article-title>
        <source>Biophys. J.</source>
        <year>2010</year>
        <volume>99</volume>
        <fpage>2028</fpage>
        <lpage>2037</lpage>
        <pub-id pub-id-type="doi">10.1016/j.bpj.2010.07.061</pub-id>
        <?supplied-pmid 20923636?>
        <pub-id pub-id-type="pmid">20923636</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goldbeter</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Koshland</surname>
            <given-names>DE</given-names>
          </name>
        </person-group>
        <article-title>An amplified sensitivity arising from covalent modification in biological systems</article-title>
        <source>Proc. Natl. Acad. Sci. USA</source>
        <year>1981</year>
        <volume>78</volume>
        <fpage>6840</fpage>
        <lpage>6844</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.78.11.6840</pub-id>
        <?supplied-pmid 6947258?>
        <pub-id pub-id-type="pmid">6947258</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Transtrum</surname>
            <given-names>MK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Perspective: Sloppiness and emergent theories in physics, biology, and beyond</article-title>
        <source>J. Chem. Phys.</source>
        <year>2015</year>
        <volume>143</volume>
        <fpage>010901</fpage>
        <pub-id pub-id-type="doi">10.1063/1.4923066</pub-id>
        <?supplied-pmid 26156455?>
        <pub-id pub-id-type="pmid">26156455</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eydgahi</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Properties of cell death models calibrated and compared using Bayesian approaches</article-title>
        <source>Mol. Syst. Biol.</source>
        <year>2013</year>
        <volume>9</volume>
        <fpage>644</fpage>
        <pub-id pub-id-type="doi">10.1038/msb.2012.69</pub-id>
        <?supplied-pmid 23385484?>
        <pub-id pub-id-type="pmid">23385484</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Liu, B. &amp; Faeder, J. R. Parameter estimation of rule-based models using statistical model checking. 2016 IEEE International Conference on Bioinformatics and Biomedicine. 1453–1459 (2016).</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoops</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>COPASI—a complex pathway simulator</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>3067</fpage>
        <lpage>3074</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl485</pub-id>
        <?supplied-pmid 17032683?>
        <pub-id pub-id-type="pmid">17032683</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmiester</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PEtab—interoperable specification of parameter estimation problems in systems biology</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2021</year>
        <volume>17</volume>
        <fpage>e1008646</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1008646</pub-id>
        <?supplied-pmid 33497393?>
        <pub-id pub-id-type="pmid">33497393</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sneddon</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Faeder</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Emonet</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Efficient modeling, simulation and coarse-graining of biological complexity with NFsim</article-title>
        <source>Nat. Methods</source>
        <year>2011</year>
        <volume>8</volume>
        <fpage>177</fpage>
        <lpage>183</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1546</pub-id>
        <?supplied-pmid 21186362?>
        <pub-id pub-id-type="pmid">21186362</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grewal</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Das</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Spatially resolved in silico modeling of nkg2d signaling kinetics suggests a key role of nkg2d and vav1 co-clustering in generating natural killer cell activation</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2022</year>
        <volume>18</volume>
        <fpage>1</fpage>
        <lpage>33</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1010114</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Konstorum</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vella</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Adler</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Laubenbacher</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>Addressing current challenges in cancer immunotherapy with mathematical and computational modelling</article-title>
        <source>J. R. Soc. Interface</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>20170150</fpage>
        <pub-id pub-id-type="doi">10.1098/rsif.2017.0150</pub-id>
        <?supplied-pmid 28659410?>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Papoutsoglou</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Challenges in the multivariate analysis of mass cytometry data: the effect of randomization</article-title>
        <source>Cytometry A</source>
        <year>2019</year>
        <volume>95</volume>
        <fpage>1178</fpage>
        <lpage>1190</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.23908</pub-id>
        <?supplied-pmid 31692248?>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krishnaswamy</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Conditional density-based analysis of T cell signaling in single-cell data</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>346</volume>
        <fpage>1250689</fpage>
        <pub-id pub-id-type="doi">10.1126/science.1250689</pub-id>
        <?supplied-pmid 25342659?>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lopez</surname>
            <given-names>CF</given-names>
          </name>
          <name>
            <surname>Muhlich</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Bachman</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Sorger</surname>
            <given-names>PK</given-names>
          </name>
        </person-group>
        <article-title>Programming biological models in python using PySB</article-title>
        <source>Mol. Syst. Biol.</source>
        <year>2013</year>
        <volume>9</volume>
        <fpage>646</fpage>
        <pub-id pub-id-type="doi">10.1038/msb.2013.1</pub-id>
        <?supplied-pmid 23423320?>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fröhlich</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>AMICI: high-performance sensitivity analysis for large ordinary differential equation models</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>37</volume>
        <fpage>3676</fpage>
        <lpage>3677</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btab227</pub-id>
        <?supplied-pmid 33821950?>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">NPJ Syst Biol Appl</journal-id>
    <journal-id journal-id-type="iso-abbrev">NPJ Syst Biol Appl</journal-id>
    <journal-title-group>
      <journal-title>NPJ Systems Biology and Applications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2056-7189</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10516955</article-id>
    <article-id pub-id-type="pmid">37736766</article-id>
    <article-id pub-id-type="publisher-id">299</article-id>
    <article-id pub-id-type="doi">10.1038/s41540-023-00299-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>BioNetGMMFit: estimating parameters of a BioNetGen model from time-stamped snapshots of single cells</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8370-7738</contrib-id>
        <name>
          <surname>Wu</surname>
          <given-names>John</given-names>
        </name>
        <address>
          <email>wu.4427@osu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stewart</surname>
          <given-names>William C. L.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jayaprakash</surname>
          <given-names>Ciriyam</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Das</surname>
          <given-names>Jayajit</given-names>
        </name>
        <address>
          <email>jayajit.das@nationwidechildrens.org</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00rs6vg23</institution-id><institution-id institution-id-type="GRID">grid.261331.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 2285 7943</institution-id><institution>Department of Computer Science, </institution><institution>The Ohio State University, </institution></institution-wrap>281 W Lane Ave, Columbus, OH 43210 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/003rfsp33</institution-id><institution-id institution-id-type="GRID">grid.240344.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 0392 3476</institution-id><institution>Steve and Cindy Rasmussen Institute for Genomics, </institution><institution>The Abigail Wexner Research Institute, Nationwide Children’s Hospital, </institution></institution-wrap>700 Children’s Drive, Columbus, OH 43205 USA </aff>
      <aff id="Aff3"><label>3</label>GIG Statistical Consulting LLC, Columbus, OH 43210 USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00rs6vg23</institution-id><institution-id institution-id-type="GRID">grid.261331.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 2285 7943</institution-id><institution>Department of Physics, </institution><institution>The Ohio State University, </institution></institution-wrap>191 W Woodruff Ave, Columbus, OH 43210 USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00rs6vg23</institution-id><institution-id institution-id-type="GRID">grid.261331.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 2285 7943</institution-id><institution>Departments of Pediatrics, Biomedical Informatics, Pelotonia Institute of Immuno-Oncology, College of Medicine, and Biophysics Program, </institution><institution>The Ohio State University, </institution></institution-wrap>370 W 9th Ave, Columbus, OH 43210 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>22</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>9</volume>
    <elocation-id>46</elocation-id>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>7</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Mechanistic models are commonly employed to describe signaling and gene regulatory kinetics in single cells and cell populations. Recent advances in single-cell technologies have produced multidimensional datasets where snapshots of copy numbers (or abundances) of a large number of proteins and mRNA are measured across time in single cells. The availability of such datasets presents an attractive scenario where mechanistic models are validated against experiments, and estimated model parameters enable quantitative predictions of signaling or gene regulatory kinetics. To empower the systems biology community to easily estimate parameters accurately from multidimensional single-cell data, we have merged a widely used rule-based modeling software package BioNetGen, which provides a user-friendly way to code for mechanistic models describing biochemical reactions, and the recently introduced CyGMM, that uses cell-to-cell differences to improve parameter estimation for such networks, into a single software package: BioNetGMMFit. BioNetGMMFit provides parameter estimates of the model, supplied by the user in the BioNetGen markup language (BNGL), which yield the best fit for the observed single-cell, time-stamped data of cellular components. Furthermore, for more precise estimates, our software generates confidence intervals around each model parameter. BioNetGMMFit is capable of fitting datasets of increasing cell population sizes for any mechanistic model specified in the BioNetGen markup language. By streamlining the process of developing mechanistic models for large single-cell datasets, BioNetGMMFit provides an easily-accessible modeling framework designed for scale and the broader biochemical signaling community.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Software</kwd>
      <kwd>Time series</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>This work is supported by the NIH (U.S) awards R01-AI 143740 and R01-AI 146581 to JD, and by the Research Institute at the Nationwide Children’s Hospital</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>This work is supported by the NIH awards R01-AI 143740 and R01-AI 146581 to JD, and by the Research Institute at the Nationwide Children’s Hospital</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature Limited 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par2">Recent advancements in single-cell technologies have allowed for the measurement of cell-to-cell differences in mRNA/protein abundances<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref></sup>. These differences enable the evaluation of means and higher-order moments (e.g., variances and covariances), which can be utilized to improve the estimation of model parameters. One potential strategy, which is especially useful in our case where the probability distribution for the data (i.e., the likelihood) is unknown, is to estimate model parameters by minimizing the differences between sample moments and their corresponding predicted moments computed from in silico models. However, it is not obvious how any set of moment differences should be summarized, especially since sample moments (and hence moment differences) can vary considerably in single-cell data. The Generalized Method of Moments (GMM), widely used in econometrics<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR5">5</xref></sup> and described in greater detail below, provides a systematic approach to incorporate means and higher-order moments in parameter estimation<sup><xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR7">7</xref></sup>. Within GMM, the moment differences are combined into a single measure of cost (i.e., distance) using a system of weights that efficiently accounts for fluctuations across sample moments (see A.1 GMM Primer for more details). In practice, to find parameter values that minimize the GMM cost, one usually needs an optimization algorithm such as gradient-descent<sup><xref ref-type="bibr" rid="CR8">8</xref></sup> or stochastic algorithms, such as simulated annealing<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> or parallel tempering<sup><xref ref-type="bibr" rid="CR10">10</xref>,<xref ref-type="bibr" rid="CR11">11</xref></sup>. In recent years, a class of meta-heuristic optimization algorithms, such as Particle Swarm Optimization (PSO) that do not require the calculation of gradients and can be easily parallelized has been developed (see refs. <sup><xref ref-type="bibr" rid="CR12">12</xref>,<xref ref-type="bibr" rid="CR13">13</xref></sup> for a pedagogical review).</p>
    <p id="Par3">Rule-based modeling approaches, such as BioNetGen<sup><xref ref-type="bibr" rid="CR14">14</xref></sup> and libRoadRunner<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>, have been developed to address combinatorial complexity in modeling biochemical reactions in signaling and gene regulatory networks<sup><xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup>. These approaches provide a user-friendly way to construct models. Estimating model parameters, such as reaction rates, is crucial for improving model predictions and quantifying underlying mechanisms described by the model using experimental measurements. With the emergence of software packages such as PyBioNetFit<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, parameter estimation from rule-based models using bulk measurements of selected proteins (e.g., average or total protein abundances observed over time) has become possible.</p>
    <p id="Par4">We introduce BioNetGMMFit, a software tool that uses GMM to improve parameter estimation in BioNetGen models by exploiting the additional information in single-cell snapshot data. This tool requires users to supply a BioNetGen model .bngl file, time-stamped snapshot abundance data files, and run configuration files. BioNetGMMFit utilizes the GMM analysis of time-stamped protein abundances, as implemented in CyGMM<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>, to estimate the parameters of the BioNetGen model, provide confidence intervals, predict moments at future times, and report the minimum cost (i.e., the distance between the sample moments and the moments predicted by the model using the GMM estimate of the parameters). While GMM can be used in conjunction with a wide variety of optimization routines, we use PSO to optimize our cost function because it does not require gradient calculations, scales well with higher-dimensional search spaces, has a relatively short run time, and is easily parallelized on a compute cluster. In addition, users can tune the PSO hyperparameters, which can affect the optimization’s efficiency and accuracy. As such, in addition to being written in C++, BioNetGMMFit is scalable with increasing data sizes on high-performance computing clusters. BioNetGMMFit is also available through Docker as C++ compilation varies across different operating systems. However, for improved performance, BioNetGMMFit can be compiled as a C++ executable through cmake and has been tested on Linux operating systems.</p>
    <p id="Par5">The manuscript is organized as follows. In the Software Description section, we provide detailed information on the implementation and use of BioNetGMMFit. Next, in the “Results section”, we present three examples of modeling single-cell data where we apply BioNetGMMFit and compare it with existing software tools. Finally, we offer our conclusions, and discuss future directions and limitations in “Discussion”.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <p id="Par6">We applied BioNetGMMFit to simulated datasets generated by models with known ground truth parameters to provide a reference point to evaluate its robustness, efficacy, and versatility. Specifically, we apply BioNetGMMFit to three simulated datasets, where each dataset is generated from a different model. Furthermore, we showcase the software’s functionality, which includes (1) facilitating estimation of model parameters from different combinations of moments for any rule-based model, (2) fixing subsets of model parameters both for simulation and estimation, and (3) forecasting moments at future time points. For each simulated dataset, we generated two sets of initial conditions from lognormal distributions as they have been observed across a variety of single-cell systems<sup><xref ref-type="bibr" rid="CR19">19</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>. To mimic the experimental constraint that “X” cannot be used to generate the observed snapshot data “Y” at time <italic>t</italic>, we generate another set of unobserved initial conditions that are used to obtain “Y” by evolving the BioNetGen models with ground truth parameters. This feature of simulating data with BioNetGen models when given a set of initial conditions is built into BioNetGMMFit. Figure <xref rid="Fig1" ref-type="fig">1</xref> provides a diagram of this process.<fig id="Fig1"><label>Fig. 1</label><caption><title>Data generation process.</title><p>A fundamental constraint of time-stamped CyTOF data is that in order to measure a cell, it must be sacrificed. Therefore, in physical experiments, the initial conditions of cells observed at time <italic>t</italic> and <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${t}^{{\prime} }$$\end{document}</tex-math><mml:math id="M2"><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41540_2023_299_Article_IEq1.gif"/></alternatives></inline-formula> are unknown. Similarly, cells observed at time <italic>t</italic><sub>0</sub>, cannot be observed at future times <italic>t</italic> and <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${t}^{{\prime} }$$\end{document}</tex-math><mml:math id="M4"><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41540_2023_299_Article_IEq2.gif"/></alternatives></inline-formula>. Here, we refer to such initial conditions and future states (shown in yellow) as “unavailable”. By contrast, parameter estimation only makes use of the “observed” data shown in green. Note that the “unavailable” data marked with an asterisk (*) must be generated in order to simulate data obtained from CyTOF experiments. In particular, one must simulate the initial conditions of all cells so that disjoint subsets of cells can be evolved to future times of interest. For ease of exposition, the subset index is not shown. We use the X and Y labels here in order to remain consistent with the inputs defined in Fig. <xref rid="Fig10" ref-type="fig">10</xref>.</p></caption><graphic xlink:href="41540_2023_299_Fig1_HTML" id="d32e361"/></fig></p>
    <p id="Par7">For more information on the simulated datasets themselves, please see the GitHub page (<ext-link ext-link-type="uri" xlink:href="https://github.com/jhnwu3/BioNetGMMFit/tree/main/example">https://github.com/jhnwu3/BioNetGMMFit/tree/main/example</ext-link>) in their respective “X” and “Y” directories.</p>
    <sec id="Sec3">
      <title>A biochemical reaction system with first-order reactions</title>
      <p id="Par8">Here, we investigate and show that BioNetGMMFit can successfully reproduce the ground truth model parameters for a system of first-order reactions model where six molecular species are arranged in a linear architecture and react via first-order biochemical reactions as illustrated by the reaction network in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. The reaction system can represent or can be generalized to represent a variety of sequential cell signaling processes such as phosphorylation of adaptor proteins such as DAP12 or Fc<italic>ϵ</italic>R1<italic>γ</italic> in NK cells<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> which are phosphorylated by Src family kinases or series of chemical modifications in signaling proteins in membrane-proximal signaling events in T cells<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. We successfully estimate all 6 parameters of the model and showcase one of BioNetGMMFit’s important features: the ability to estimate parameters using different moments. We note that one advantage of GMM (see <xref rid="MOESM1" ref-type="media">Supplementary Material)</xref> is that it allows for the use of any number of moments in its objective function. BioNetGMMFit allows the choice of fitting three different combinations of moments of across a dataset: (1) first moments (means), (2) first (means) and second moments (variances), as well as (3) first (means), second (variances), and mixed moments (covariances) as shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>.<fig id="Fig2"><label>Fig. 2</label><caption><title>First-order reaction model.</title><p>On the left, X<sub>1</sub> through X<sub>6</sub> represent protein species in a system of reactions where <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathop{\longrightarrow }\limits^{\theta }$$\end{document}</tex-math><mml:math id="M6"><mml:mover accent="true"><mml:mrow><mml:mo>→</mml:mo></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mover></mml:math><inline-graphic xlink:href="41540_2023_299_Article_IEq3.gif"/></alternatives></inline-formula> represents a reaction in which species X<sub><italic>i</italic></sub> is changed into Click to show the PDF X<sub><italic>j</italic></sub> at the rate given by the corresponding <italic>θ</italic>. BioNetGMMFit is used to estimate the set of <italic>θ</italic>’s. Below the system of reactions, its BioNetGen reaction rules are displayed; these need to be defined and input to BioNetGMMFit to estimate the <italic>θ</italic>’s. Note that we use k’s instead of <italic>θ</italic>’s to define model parameters in BNGL. The table on the right contains the ground truth values.</p></caption><graphic xlink:href="41540_2023_299_Fig2_HTML" id="d32e442"/></fig><fig id="Fig3"><label>Fig. 3</label><caption><title>Parameter estimates using different combinations of moments in the first-order reaction model.</title><p>The left column (<bold>A</bold>) contains 95% confidence intervals of parameter estimates obtained using only the means of the snapshot data at time <italic>t</italic> = 1.5 (top panel) and the comparison of the predicted means and the actual (observed) means (bottom panel). The middle column (<bold>B</bold>) contains analogous results by fitting the means and variances. Note the change in the scale of the values of the moments when the variance is included. The last column (<bold>C</bold>) on the right are the results obtained by fitting all the first, second, and mixed moments or more specifically all 6 means, 6 variances, and 15 covariances of the 6 proteins. This illustrates the flexibility available to the user to choose different subsets of moments for parameter estimation. In the analysis, the initial conditions and the simulated observed conditions at time <italic>t</italic> = 1.5 both contained 10,000 cells each.</p></caption><graphic xlink:href="41540_2023_299_Fig3_HTML" id="d32e466"/></fig></p>
      <p id="Par9">A key strength of this flexibility of moment choice in the cost function is the ability to adapt to different problem requirements. For instance, inclusion of higher-order moments tends to improve parameter estimation in this first-order reaction model as shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>, whereas the usage of variances and covariances in its fitting routine produces the tightest confidence intervals around its parameter estimates.</p>
    </sec>
    <sec id="Sec4">
      <title>Model for Msn2-induced transcription in yeast</title>
      <p id="Par10">Next, as mechanistic models often incorporate some form of nonlinearity, we show that we can successfully perform parameter estimation for a nonlinear gene regulatory model involved in stress response in yeast<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>. This is a simplified version of a commonly occurring gene regulatory motif in yeast. One of the key regulators of the stress response is the transcription factor Msn2 which resides in the cytoplasm in the resting state and is dephosphorylated in response to stress. Upon phosphorylation, Msn2 translocates to the nucleus, binds to stress-responsive elements (STRE), and induces gene expression of response proteins. The model is illustrated in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. This example explores a scenario where certain model parameters need to be fixed. Here we fixed two parameters, the death rate <italic>p</italic><sub><italic>d</italic></sub> and the birth rate <italic>p</italic><sub><italic>b</italic></sub> of the protein species <italic>P</italic>, reducing the total number of parameters to be estimated to four. The BioNetGen rules describing the model and the ground truth parameter values used to generate the synthetic data are shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. We analyzed its simulated observed snapshot data at time points 0, 1, and 5 min in its parameter estimation.<fig id="Fig4"><label>Fig. 4</label><caption><title>Msn2 transcription model.</title><p>Model reaction network is shown on the left with its corresponding BioNetGen reaction rules defined below it. Ground truth model parameters and which ones have been fixed are shown in the table on the right. In this case, non-fixed model parameters labeled by “n” are estimated.</p></caption><graphic xlink:href="41540_2023_299_Fig4_HTML" id="d32e509"/></fig></p>
      <p id="Par11">The parameter estimation results for the Msn2 transcription model are presented in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. Although the moment fits for both time points are not perfect, with an underfitted variance for one of the species, the confidence intervals around the estimated parameters fully encompass the ground truth parameters, indicating that BioNetGMMFit is capable of handling parameter estimation for nonlinear models.<fig id="Fig5"><label>Fig. 5</label><caption><title>Msn2 transcription model outputs.</title><p>Model parameter estimate with confidence intervals on the left were generated by the moment fits for two different simulated observed time points, <italic>t</italic> = 1 and <italic>t</italic> = 5 min, on the right. In this case, 95% confidence intervals of parameter estimates shown on the left include the ground truth parameter values. Please note that the middle two x-tick marks, pb and pd are not estimated and are held constant. Using simulated data for the 5 species (i.e D, T<sub>2</sub>, m, etc.) in the ground truth model, 5 means, 5 variances, and 10 covariances across two time points were obtained and used for parameter estimation. All snapshot data used in the analysis contained 10,000 cells.</p></caption><graphic xlink:href="41540_2023_299_Fig5_HTML" id="d32e531"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Vav1 activation kinetics in NK cells</title>
      <p id="Par12">As the final example, we consider a simplified model early time biochemical signaling kinetics (Fig. <xref rid="Fig6" ref-type="fig">6</xref>) in mouse Natural Killer (NK) cells<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> to illustrate a case where identifiability issues prevent BioNetGMMFit from capturing the ground truth model parameters. The model describes the phosphorylation of a key signaling protein Vav1 by the kinase Syk bound to activating receptor–ligand complex and the dephosphorylation of phosphorylated Vav1 by the phosphatase SHP1 bound to the inhibitory receptor–ligand complex. The nonlinear biochemical reactions in the model are akin to the zero-order ultrasensitivity model proposed by Goldbeter and Koshland<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>. We assume the abundances for the proteins Syk, Vav1, Syk-Vav1, SHP1, SHP1-pVav1, and pVav1 are measured at any time <italic>t</italic>.<fig id="Fig6"><label>Fig. 6</label><caption><title>Vav1 activation model.</title><p>The reaction network displayed on the left represents a simplified version of the phosphorylation-dephosphorylation kinetics of Vav1 in mouse NK cells. The corresponding reaction rules in BioNetGen are shown below. All the parameters, the set of rate constants {<italic>θ</italic><sub><italic>j</italic></sub>} or k<sub><italic>j</italic></sub> in the .bngl file and their ground truth values on the right are estimated using BioNetGMMFit.</p></caption><graphic xlink:href="41540_2023_299_Fig6_HTML" id="d32e568"/></fig></p>
      <p id="Par13">Following parameter estimation, we predict first, second, and mixed moments. The comparisons between the predictions and the simulated observed moments at different time points are shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref>. The three slopes shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref>, each near unity, indicate good agreement between the predicted moments (i.e., means, variances, and covariances) and the observed moments at each time point. Furthermore, using the model parameters estimated by BioNetGMMFit, we can <italic>forecast</italic> moments (i.e., predict moments) at times well outside of the given observational range (Fig. <xref rid="Fig7" ref-type="fig">7)</xref>. The nonlinear Vav1 activation model also presents a case where hyperparameter tuning is needed to generate more accurate parameter estimates. For instance, in Fig. <xref rid="Fig7" ref-type="fig">7</xref>, increasing the number of particles and steps in the PSO routine improves the parameter estimates (i.e., brought them closer to the simulated ground truth). Despite improved estimates, this scenario illustrates a parameter estimation problem where other parameter estimates exist that minimize the objective function. Figure <xref rid="Fig7" ref-type="fig">7</xref> shows that although the moment fits are excellent, and the predictions closely match the observed and future unobserved data, the parameter estimates for k<sub>2</sub> and k<sub>5</sub> are unable to capture the ground truth values, even with a tuned hyperparameter configuration of 1500 particles and 150 steps of PSO. In the subsection below, we provide further insights into the challenges of parameter estimation in rule-based models.<fig id="Fig7"><label>Fig. 7</label><caption><title>Results for the Vav1 activation model.</title><p>The ground truth parameter values shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref> are estimated by BioNetGMMFit using data from the ground truth model at <italic>t</italic> = 0.5 and <italic>t</italic> = 2. In total, 5000 cells at each time point were used in the analysis. The panels in the left column show the predicted moments calculated with estimated parameters plotted against the observed moments calculated using the ground truth model at various time points. The top figure shows the comparison at one of the input time points while the bottom two graphs are the “forecast” moments at <italic>t</italic> = 10 and <italic>t</italic> = 40. This shows that such parameter estimates can predict values at time points well into the future. The parameter estimates were derived from configuration 6 Protein A. Please see Supplementary Figure <xref rid="MOESM1" ref-type="media">11</xref> in the <xref rid="MOESM1" ref-type="media">Supplementary Material</xref> for more information on the PSO hyperparameter configurations used. On the right, we show improvements in estimates by tuning PSO hyperparameters and show parameter estimates for two different hyperparameter configurations. All the moment comparison plots in the left column were generated with parameter estimated obtained using PSO with 1500 particles and 150 steps. Note that the time units for this simulated dataset are arbitrary since BioNetGMMFit does not have units built into its plotting function. However, phosphorylation reactions as defined by the network in Fig. <xref rid="Fig6" ref-type="fig">6</xref> occur on the time scale of seconds.</p></caption><graphic xlink:href="41540_2023_299_Fig7_HTML" id="d32e627"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>Practical concerns in estimation</title>
      <p id="Par14">As seen from the Vav1 activation model, cost functions for ODE models often possess multiple local minima and/or flat regions with small curvatures<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>, that typically make estimation (i.e., the task of finding the best parameter values) challenging for any method. Although PSO mitigates these optimization problems to some extent, depending on the computational constraints, BioNetGMMFit does not fully address the difficulties of such irregular cost functions, e.g., BioNetGMMFit can still yield estimates that reflect a local, rather than the global, minimum. One such example is shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref> where only 150 particles and 25 steps were used for parameter estimation of the simulated Vav1 activation model. We intentionally chose a limited number of particles and steps to examine what could happen in a computationally constrained environment. As one might expect, the estimates for some paremeters were not close to their corresponding ground truth values; however (perhaps surprisingly), the estimates were able to accurately predict the observed first, second, and cross moments at later times as shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref>. However, when the number of particles and steps used are increased tenfold, parameter estimates are much closer to the ground truth, although prediction improves only slightly. Moreover, this dramatic improvement in estimation and a slight improvement in prediction demand higher computational costs as shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">12</xref> where there is a drastic increase in run time from configuration “6 Protein Time Points Set A” to “6 Protein Time Points Set A Extreme” in Supplementary Fig. <xref rid="MOESM1" ref-type="media">12</xref>. As such, this raises an interesting question of “How much should one care about obtaining the best possible parameter estimates (as shown with <italic>k</italic><sub>4</sub> in Fig. <xref rid="Fig7" ref-type="fig">7</xref> for example), especially when computational resources may be limited and/or when the primary interest of the analysis may be prediction, not estimation?” Furthermore, despite the potential for dramatic improvement in estimation, there is no guarantee that one will realize the desired improvement simply by using more particles and/or steps.</p>
      <p id="Par15">We acknowledge the previous work of Sethna et al.<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>, which used information theory to characterize parameter identifiability issues and model sloppiness; and the work of Sorger et al.<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>, which used a Bayesian approach to compare competing models in the presence of partial identifiability. Although BioNetGMMFit is not designed to directly address those issues, our software does give users the ability to inspect a given model for identifiability concerns by constructing pairwise contour plots of the high-dimensional cost (aka objective) function. For each contour plot the x and y axes correspond to a pair of distinct rate constants. For example, pairwise contour plots can be generated for the nonlinear Vav1 activation model, where local minima were virtually indistinguishable from the ground truth, resulting in parameter estimates that were different from the ground truth (see Fig. <xref rid="Fig7" ref-type="fig">7)</xref>. By creating pairwise contour plots for k<sub>2</sub> (or <italic>θ</italic><sub>2</sub>) and k<sub>5</sub>, where PSO was unable to discern the ground truth values (see Fig. <xref rid="Fig8" ref-type="fig">8</xref>), a striped pattern on the log-cost contour plot reveals a region of unidentifiability. In contrast, the well-estimated first-order reaction model has a convex log-cost shape (see Fig. <xref rid="Fig8" ref-type="fig">8</xref>).<fig id="Fig8"><label>Fig. 8</label><caption><title>Contour plots for identifiability.</title><p>Contour plots of the landscape of the cost function are shown as a function of k<sub>2</sub> on the <italic>x</italic> axis and k<sub>5</sub> on the <italic>y</italic> axis with all other model parameters held constant at the ground truth. The left contour plot is a pairwise contour plot of the fully “identifiable” first-order reaction system where a steeply convex cost landscape surrounds the ground truth parameters at the bottom left. The right pairwise contour plot is of the nonlinear Vav1 activation model where a nonconvex cost landscape results in the parameter estimates shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref>. Note the big difference in the scale of the color values for the two plots. The color bar is of the log-GMM cost that is derived by BioNetGMMFit with 6 means, 6 variances, and 15 covariances in its calculation.</p></caption><graphic xlink:href="41540_2023_299_Fig8_HTML" id="d32e705"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>Comparison with other software tools</title>
      <p id="Par16">By combining the best aspects of CyGMM and BioNetGen, BioNetGMMFit provides several noteworthy features for the analysis of single-cell time-stamped cytometry data that complements the currently available parameter estimation software suite (i.e PyBioNetFit<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, Statistical Model Checking (SMC)<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>, COPASI<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>). In particular, BioNetGMMFit offers the ability to efficiently analyze single-cell trajectories for a large number ( &gt; 1000) of cells, predict higher-order moments at future times, and simulate parameter estimation tasks with ground truth parameters. We detail the full capabilities and limitations of BioNetGMMFit below as well as how it compares to other pre-existing parameter estimation software packages. A brief summary of the software-related differences are shown in Fig. <xref rid="Fig9" ref-type="fig">9</xref>.<fig id="Fig9"><label>Fig. 9</label><caption><title>Comparison of BioNetGMMFit features.</title><p>Bulk measurements refer to measurements in which one obtains a single observed value for each species of reactants, at each time point. The observed value may be the mean or total abundance of the species at that time point. In contrast, single-cell measurements yield copy numbers or concentrations of each species for thousands of cells at each time point. This leads to what we refer to as initial abundance noise. The letter “y” indicates that the feature is available and “n” implies that the software is not designed to do it.</p></caption><graphic xlink:href="41540_2023_299_Fig9_HTML" id="d32e732"/></fig></p>
      <sec id="Sec8">
        <title>Dealing efficiently with cell-specific initial conditions</title>
        <p id="Par17">BioNetGMMFit accurately and efficiently estimate BioNetGen model parameters from cytometry snapshot data observed across many single-cell trajectories. It employs the same sophisticated minimization procedure as CyGMM<sup><xref ref-type="bibr" rid="CR7">7</xref></sup> to estimate parameters from the analysis of higher-order moments. To the best of our knowledge, existing software are not designed to account for large variances in initial conditions. Thus, they have difficulty performing parameter estimation efficiently where (1) initial abundance noise is known to play a role and (2) the data consists of large numbers of different single cells (where each cell has its own set of trajectories).</p>
        <p id="Par18">For example, when the estimation depends on the analysis of data from a large number of single cells (as opposed to bulk measurements averaged over cells), existing software is either not designed to handle such data<sup><xref ref-type="bibr" rid="CR18">18</xref>,<xref ref-type="bibr" rid="CR28">28</xref></sup>, or is less user-friendly, or is computationally inefficient<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>. In many cases, when attempting to perform parameter estimation across a combination of moment statistics, inefficiencies related to file input and output occur. For instance, in using BioNetGen’s simulator, each cell has its own BioNetGen file containing a bulk measurement such as average protein abundances. Therefore, to perform parameter estimation across a combination of different measurements (i.e., means, variances, and covariances) with BioNetGen only<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>, the user must repeatedly read from multiple data files in its parameter estimation. In PyBioNetFit<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, only a single set of cell conditions per time point are used for parameter estimation. Our method allows users to input easily several time-stamped snapshot files containing abundance data from thousands of cells and store them directly in memory for quick simulations. See Supplementary Fig. <xref rid="MOESM1" ref-type="media">10</xref> below for each dataset’s cell count used for parameter estimation. While the comparison is not exact as the models and objective function (i.e BioNetGMMFit’s incorporation of higher-order moments) analyzed were different, we show that we can attain run-time performance comparable to that of PyBioNetFit<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. In the analysis of the Vav1 activation model in Fig. <xref rid="Fig6" ref-type="fig">6</xref> with 5000 single cells, the run time was ~1.9 h on a 16-core processor for 30 repeated parameter estimates, which is in the range of run time using the SBML simulator in PyBioNetFit for a similar number of cores<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. To provide some context on run time, we compare with a method such as SMC<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>: while again the comparisons are not exact as the methods and models are different, our run times are comparable to their 4.2 h for parameter estimation. Due to C++ parallelization with OpenMP, our software is capable of linearly scaling with increasing cell count, thereby reducing run times for large numbers of cells. Supplementary Fig. <xref rid="MOESM1" ref-type="media">12</xref> provides run-time details concerning the number of cells and model parameters.</p>
      </sec>
      <sec id="Sec9">
        <title>Estimating with higher-order moments</title>
        <p id="Par19">Due to their design intended for bulk measurements, existing software such as PyBioNetFit<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, COPASI<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>, and PyPesto (from the PETab suite)<sup><xref ref-type="bibr" rid="CR30">30</xref></sup> for rule-based parameter estimation are not specifically designed to fit higher moments. While possible to do a plethora of file input and output to generate multiple parameter distributions per set of initial conditions and generate moment statistics using PyBioNetFit or BioNetGen, for a large number of cells, parameter estimation becomes very user-unfriendly and computationally taxing. In contrast, BioNetGMMFit directly supports three levels of analysis corresponding to using an increasing number of moments. First, one can choose to estimate parameters using only the means (i.e., first moments). Second, one can use both means and variances or third, use means, variances, and covariances. Results for moments with different levels of fitting are shown with its different columns in Fig. <xref rid="Fig3" ref-type="fig">3</xref>.</p>
        <p id="Par20">Other more mature softwares such as COPASI<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> offer a wide variety of other features such as an executable graphical user interface, the ability to export ODEs from these rule-based languages, as well as the support of a wide range of optimization routines. For optimization routines involving smaller and simpler (i.e., linear instead of nonlinear) models where large initial abundance noise is not of concern, it is preferable to use COPASI<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>, PyBioNetFit<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, and PyPesto<sup><xref ref-type="bibr" rid="CR30">30</xref></sup> due to the availability of less computationally expensive gradient-based optimization routines. However, in such simple parameter estimation tasks, BioNetGMMFit performs functionally the same due to its flexibility of cost functions where the user can simply choose to use only the observed first moments.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec10" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par21">We present a new software: BioNetGMMFit, that greatly enhances a researcher’s ability to explore a wide range of mechanistic models while using higher-order moments to leverage the information in single-cell data. In particular, BioNetGMMFit provides accurate estimation of model parameters, and reports valid confidence intervals for each estimated parameter as well. Furthermore, BioNetGMMFit can easily handle data observed across multiple time points, and it can predict protein abundances at future times. A key feature of BioNetGMMFit, which benefits from its integration with libRoadRunner’s simulators, is its ability to easily simulate protein abundances at scale (i.e., across multiple time points, across many single cells, and under a wide variety of different biochemical signaling models). Moreover, because such simulations can now easily be carried out at scale, the ability to tune hyperparameters has become a much more accessible task.</p>
    <p id="Par22">Hyperparameter tuning involves selecting the optimal set of hyperparameters of the optimization routine to achieve the best parameter estimates that minimize the cost function and enable optimal prediction from one’s model. For example, in the case of PSO, there are five hyperparameters to tune, including the number of particles, the number of steps, and three coefficients that affect how the particle swarm moves in the space of model parameters. To address this challenge, we use a simulated reference point of the “optimal” or ground truth parameters for a BioNetGen model, which can provide insights into the performance of an optimization routine’s hyperparameter configuration. A practical way of determining a suitable set of hyperparameters when analyzing experimental data is as follows. If one wishes to fit a model to the data, one can simulate a ground truth version of the model separately and adjust the hyperparameters so that BioNetGMMFit estimates the ground truth values to desired accuracy. Then, one can use these newfound hyperparameters to fit the model to the experimental data.</p>
    <sec id="Sec11">
      <title>Limitations of BioNetGMMFit</title>
      <p id="Par23">BioNetGMMFit is currently limited to parameter estimation for well-mixed mechanistic models describing deterministic and stochastic kinetics. Unlike PyBioNetFit<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, other forms of simulation such as NFsim<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> and spatial modeling<sup><xref ref-type="bibr" rid="CR32">32</xref>,<xref ref-type="bibr" rid="CR33">33</xref></sup> are not supported. Furthermore, BioNetGMMFit does not support any optimization algorithms other than PSO. In addition, the lack of Python support may make it difficult to integrate it with pre-existing workflows that rely heavily on Python. While there exists a C++ static binary that has been tested on Ubuntu Linux, compilation with libRoadRunner C++ libraries can be a nontrivial process on other Linux distributions. Thus, BioNetGMMFit is most readily accessible through Docker, which although accessible across all major operating systems, still requires the use of third-party virtualization software. These software weaknesses will need to be addressed in future iterations of the software.</p>
    </sec>
  </sec>
  <sec id="Sec12">
    <title>Methods</title>
    <sec id="Sec13">
      <title>Software inputs</title>
      <p id="Par24">To illustrate in detail how one might use BioNetGMMFit, a parameter estimation task with an experimental CD8+ T-cell dataset was performed. As shown in Fig. <xref rid="Fig10" ref-type="fig">10</xref>, BioNetGMMFit reads input data from several sources, including (i<sub>1</sub>) a directory containing a CSV file with initial protein abundances (X) and a directory containing CSV files with observed protein abundances at different time snapshots (Y); (i<sub>2</sub>) a time steps CSV file that contains the times at which the data of interest are observed (note that the data of interest may be a subset of the full data); (i<sub>3</sub>) a .bngl (BioNetGen) file that describes the mechanistic model capable of executing deterministic or stochastic kinetics; and (i<sub>4</sub>) a BioNetGMMFit hyperparameter configuration file that enables various features, such as generating time-series snapshot data from the BioNetGen model or changing the number of particles and steps of the PSO routine. A general overview of the BioNetGMMFit workflow is illustrated in Fig. <xref rid="Fig11" ref-type="fig">11</xref>.<fig id="Fig10"><label>Fig. 10</label><caption><title>BioNetGMMFit inputs and outputs.</title><p>The inputs and outputs to the program BioNetGMMFit (yellow box) are displayed. The green boxes, labeled with the letter “i'', are the inputs to the program. The two boxes included in i<sub>1</sub> represent the input directories: X contains the initial conditions for the model and Y, all the observed snapshot data at different time points that must be passed to BioNetGMMFit. The box i<sub>2</sub> is the time steps file that contains all the specified time points at which the concentrations are evaluated, by evolving the model given the initial conditions. i<sub>3</sub> represents the model defined in BioNetGen containing the parameters to be estimated. The BioNetGen model (defined in BNGL) is used to evolve the initial conditions in X to fit the observed moments computed from the data in Y. i<sub>4</sub> is the configuration file that contains the hyperparameters of the PSO (i.e the number of particles, steps, and PSO weights) that need to be defined by the user for the parameter estimation task. The orange boxes indicate outputs and are labeled by “o''. BioNetGMMFit produces two explicit outputs, o<sub>1</sub>, the parameter estimates of the BioNetGen model and o<sub>2</sub>, the corresponding time-evolved moments. The moments in o<sub>2</sub> are generated using the parameter estimates that minimize the GMM cost between the observed moments and predicted moments. Lastly, the user can choose to forecast future trajectories of moments in o<sub>3</sub>.</p></caption><graphic xlink:href="41540_2023_299_Fig10_HTML" id="d32e892"/></fig><fig id="Fig11"><label>Fig. 11</label><caption><title>BioNetGMMFit workflow.</title><p>All “i’’’s and “o’’’s correspond to the same inputs and outputs defined in Fig. <xref rid="Fig10" ref-type="fig">10</xref>. In this figure, we depict the steps needed to run BioNetGMMFit relating back to the inputs and outputs of Fig. <xref rid="Fig10" ref-type="fig">10</xref>. To begin, the snapshot data of interest must be loaded by first organizing all .csv files into their corresponding initial conditions (X) and observed conditions (Y) directories, and then these (X) and (Y) directories (i<sub>1</sub>) must be specified to BioNetGMMFit. The black points in the data boxplot figure represents the outlier of the dataset (specifically CD8+ T-cell dataset). Next, the user must define the time points that correspond to each of the snapshot files by creating and specifying a times.csv file (i<sub>2</sub>). Once all of the data are defined, the user must define and specify the BioNetGen model of interest (i<sub>3</sub>) to BioNetGMMFit. The last input required is the hyperparameters configuration file where the user must define all of the necessary parameters for a parameter estimation run, specifically related to the PSO algorithm that will be used to estimate the BioNetGen model parameters. Once all necessary inputs (i<sub>1</sub>, i<sub>2</sub>, i<sub>3</sub>, and i<sub>4</sub>) are defined, BioNetGMMFit will run its parameter estimation routine with GMM and PSO, returning parameter estimates (o<sub>1</sub>) (and confidence intervals if there are multiple replicate runs of PSO) as well as a <italic>o</italic><italic>b</italic><italic>s</italic><italic>e</italic><italic>r</italic><italic>v</italic><italic>e</italic><italic>d</italic> = <italic>p</italic><italic>r</italic><italic>e</italic><italic>d</italic><italic>i</italic><italic>c</italic><italic>t</italic><italic>e</italic><italic>d</italic> line where observed moment values are on the <italic>y</italic> axis and predicted moments (o<sub>2</sub>) generated from the estimated model parameter on the x axis. Please note that the observed moments are calculated from the abundance data supplied by i<sub>1</sub>, and similarly the predicted moments are computed from the evolved abundances generated by simulating each initial sample with the BioNetGen model. Finally, while optional, users of BioNetGMMFit can predict moments of future time points (o<sub>3</sub>) of the BioNetGen model. Please refer to the <xref rid="MOESM1" ref-type="media">Supplementary Material</xref> for a more in-depth tutorial on how to use the command line version of BioNetGMMFit illustrated with the CD8+ T-cell dataset.</p></caption><graphic xlink:href="41540_2023_299_Fig11_HTML" id="d32e975"/></fig></p>
      <p id="Par25">When working with directories of data files, only one CSV data file is read from directory X to establish the initial set of protein abundances. Meanwhile, directory Y may contain multiple CSV files for each time step being analyzed. These data files are arranged such that each row contains the observations (i.e., protein abundances) from an individual (or single) cell. To ensure that protein abundances or concentrations are nonnegative, any single-cell data containing negative protein values at a given time is removed before performing parameter estimation in BioNetGMMFit. Such a preprocessing step reduces the necessary steps the user must take to properly use BioNetGMMFit, as negative values are commonly generated in CyTOF datasets during a processing step that spreads out zero readings in CyTOF measurements<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>.</p>
    </sec>
    <sec id="Sec14">
      <title>Working example</title>
      <p id="Par26">As an example, we will use a signaling kinetic model involving four proteins to analyze a CD8+ T-cell CyTOF dataset. One biological question of interest that can be addressed with such data is to quantify the rate of the signal propagation between a pair of signaling proteins and study how the rates depend on the developmental state of the immune cell (e.g., naive vs memory CD8+ T cell). We applied BioNetGMMFit to describe signaling kinetics in CD8+ T cells stimulated by CD3 and CD28 antibodies where binding of the antibodies induce phosphorylation of the transmembrane CD3<italic>ζ</italic> chains which further lead to phosphorylation of the adaptor protein SLP76, MAPK kinase Erk and the ribosomal protein S6 following pCD3<italic>ζ</italic> → pSLP76 → pErk → pS6<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>. We model the phosphorylation reactions shown above by first-order reactions. There are many intermediate biochemical reactions involved within the phosphorylation steps shown above and we assume the rates of the first-order reactions effectively capture the effect of those intermediate reactions. The phosphorylated protein species also go through degradation/ubiquitylation processes which are also approximated by first-order decay reactions. In addition, pCD3<italic>ζ</italic> is assumed to be produced at a constant rate due to the signaling process. The model contains five rate constants, <italic>θ</italic><sub>1</sub>, ⋅ ⋅ ⋅ , <italic>θ</italic><sub>5</sub>, which we estimate using BioNetGMMFit. BioNetGMMFit also plots confidence intervals as well as the observed and estimated moments as shown in Fig. <xref rid="Fig12" ref-type="fig">12</xref>. The underlying datasets used in this parameter estimation task of the CD8+ T cells are from (<ext-link ext-link-type="uri" xlink:href="https://dpeerlab.github.io/dpeerlab-website/dremi-data.html">https://dpeerlab.github.io/dpeerlab-website/dremi-data.html</ext-link>) <sup><xref ref-type="bibr" rid="CR35">35</xref></sup>. From this dataset, one can compute time trajectories of the protein moments, means, variances, and covariances (see Fig. <xref rid="Fig12" ref-type="fig">12)</xref>. To make the presentation simple, we will only analyze trajectories at two time points: 1 min and 2 min. In this case, 719 cells were measured at time point 1 in and 653 cells were measured at time point 2 min. Again, as shown in Fig. <xref rid="Fig12" ref-type="fig">12</xref>, mechanistic model reaction rules are defined in the .bngl file where they are then converted into an SBML file using BioNetGen’s writeSBML() function as BioNetGen does not support its own C++ API. Using libRoadRunner’s C++ API<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>, BioNetGMMFit converts this SBML file into a roadrunner object that is capable of simulating the defined model to user-specified time intervals. While there are many other reaction network simulators such as PySB<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>, COPASI<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>, and AMICI<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>, libRoadRunner was primarily chosen for its speed and ease of customizability due to its function as a C++ API rather than a standalone software package.<fig id="Fig12"><label>Fig. 12</label><caption><title>CD8+ T-cell example.</title><p>The input and output results for fitting the CD8+ T-cell CyTOF dataset are shown. The panel labels (i<sub>1</sub>), (i<sub>3</sub>), (o<sub>1</sub>), and (o<sub>2</sub>) correspond to those in Fig. <xref rid="Fig10" ref-type="fig">10</xref>. Panel (i<sub>1</sub>) in Fig. 12 shows the sample means, variances, and covariances of CD8+ T-cell proteins calculated by BioNetGMMFit for the observed time points of snapshot data (supplied in the files i<sub>1</sub> and i<sub>2</sub>). These are used for parameter estimation as part of the GMM procedure. (More information on GMM can be found in the <xref rid="MOESM1" ref-type="media">Supplementary Material</xref>.) Panel (i<sub>3</sub>) displays the reaction network and its corresponding reaction rules in the .bngl file. Each reaction rule represents a reaction within the model and has a parameter (rate constant) associated with it (e.g., k1). Using the observed moments (i<sub>1</sub> panels) BioNetGMMFit uses PSO and GMM to estimate parameters of the model. (o<sub>1</sub>) and (o<sub>2</sub>) illustrate the results for a case where BioNetGMMFit performs 30 PSO estimates and produces a set of confidence intervals as well as a plot of the least GMM cost fit between the observed moments and predicted moments. The fit is performed with 4 protein means, 4 protein variances, and 6 protein covariances. Please note that the user is responsible for the consistency of units units in the input data since BioNetGMMFit uses the input value without ascribing about measurement units. For the CD8+ T-cell data used above, the input data were of the magnitude of fluorescence.</p></caption><graphic xlink:href="41540_2023_299_Fig12_HTML" id="d32e1080"/></fig></p>
      <p id="Par27">Once the model is defined, the hyperparameters configuration file supplies the PSO hyperparameters (i.e., the number of particles, steps, and PSO coefficients) used for parameter estimation. For more information on the configuration file, a table of parameters is provided in the documentation on the GitHub page and in the <xref rid="MOESM1" ref-type="media">Supplementary Material</xref>. To estimate parameters within the BioNetGen model, PSO minimizes the GMM-weighted square Euclidean distances of lower and higher-order moments between the observed and model-simulated data<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. Upon PSO convergence, estimates are provided, and confidence intervals are computed.</p>
      <p id="Par28">The plots of parameter estimates and moment fits provide additional insights into the fit of the mechanistic model. In Fig. <xref rid="Fig12" ref-type="fig">12</xref>, for example, the confidence intervals around the parameter estimates reveal the ranges of possible values for each model parameter and their relative magnitudes. The estimation shows that the rates of production of pCD3<italic>ζ</italic> and of pS6 induced by pErk are the two dominant signaling reactions that occur at the early times (1–2 min) when CD8+ T cells are stimulated. This result is consistent with related conclusions in ref. <sup><xref ref-type="bibr" rid="CR35">35</xref></sup> obtained using information theory. Nonetheless, models are imperfect, and their fits may be poor. To assess the model fit in such cases, we can refer to the “Fit of Predicted Moments” plot in Fig. <xref rid="Fig12" ref-type="fig">12</xref>. This plot shows that the estimated model fails to accurately fit one of the protein’s variances, as indicated by a variance dot biased below the perfect fit line, indicating that further modifications in the model are needed to better fit the data. Such moment plots are essential for evaluating the parameter estimation and model fits that may be difficult to observe with only mean or bulk abundance differences.</p>
      <p id="Par29">BioNetGMMFit is currently available as a docker image for ease of portability across different operating systems, a compilable executable for those requiring high-performance computing capabilities (<ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/7733865">https://zenodo.org/record/7733865</ext-link>), and as a web demo (<ext-link ext-link-type="uri" xlink:href="https://bngmm.nchigm.org/">https://bngmm.nchigm.org/</ext-link>). Further details on how to use and compile BioNetGMMFit are available on the GitHub page (<ext-link ext-link-type="uri" xlink:href="https://github.com/jhnwu3/BioNetGMMFit">https://github.com/jhnwu3/BioNetGMMFit</ext-link>), and a comprehensive tutorial on using BioNetGMMFit can be found in the <xref rid="MOESM1" ref-type="media">Supplementary Material</xref>.</p>
    </sec>
    <sec id="Sec15">
      <title>Reporting summary</title>
      <p id="Par30">Further information on research design is available in the <xref rid="MOESM2" ref-type="media">Nature Research Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec16">
      <title>Supplementary information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41540_2023_299_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Material - BioNetGMMFit</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41540_2023_299_MOESM2_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41540-023-00299-0.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>Special thanks to Dr. Jim Faeder, Dr. Ali Sinan, and Dr. Lucian Smith for their advice in the development of this software. This work is supported by the NIH awards R01-AI 143740 and R01-AI 146581 to J.D., and by the Research Institute at the Nationwide Children’s Hospital.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>Every author contributed to the writing and approval of this manuscript. J.W. and W.C.L.S. contributed to the software development and design of BioNetGMMFit.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The dataset(s) supporting the conclusions of this article is(are) available in the BioNetGMMFit/example repository [<ext-link ext-link-type="uri" xlink:href="https://github.com/jhnwu3/BioNetGMMFit/tree/main/example">https://github.com/jhnwu3/BioNetGMMFit/tree/main/example</ext-link>]. Project name: BioNetGMMFit; Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/jhnwu3/BioNetGMMFit">https://github.com/jhnwu3/BioNetGMMFit</ext-link>; Archived version: N/A; Operating system(s): Platform independent through Docker; Programming language: C/C++; Other requirements: Docker, if Compiling see GitHub; License: MIT License; Any restrictions to use by non-academics: N/A; Other Locations of Access: <ext-link ext-link-type="uri" xlink:href="https://hub.docker.com/repository/docker/jhnwu3/bngmm/general">https://hub.docker.com/repository/docker/jhnwu3/bngmm/general</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/7733865">https://zenodo.org/record/7733865</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://bngmm.nchigm.org/">https://bngmm.nchigm.org/</ext-link>. Experimental CD8+ T-cell data can be found at <ext-link ext-link-type="uri" xlink:href="https://dpeerlab.github.io/dpeerlab-website/dremi-data.html">https://dpeerlab.github.io/dpeerlab-website/dremi-data.html</ext-link>.</p>
  </notes>
  <notes id="FPar1" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par31">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Spitzer</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Nolan</surname>
            <given-names>GP</given-names>
          </name>
        </person-group>
        <article-title>Mass cytometry: single cells, many features</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>165</volume>
        <fpage>780</fpage>
        <lpage>791</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2016.04.019</pub-id>
        <?supplied-pmid 27153492?>
        <pub-id pub-id-type="pmid">27153492</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Papalexi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Single-cell rna sequencing to explore immune cell heterogeneity</article-title>
        <source>Nat. Rev. Immunol.</source>
        <year>2018</year>
        <volume>18</volume>
        <fpage>35</fpage>
        <lpage>45</lpage>
        <pub-id pub-id-type="doi">10.1038/nri.2017.76</pub-id>
        <?supplied-pmid 28787399?>
        <pub-id pub-id-type="pmid">28787399</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saeys</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Van Gassen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lambrecht</surname>
            <given-names>BN</given-names>
          </name>
        </person-group>
        <article-title>Computational flow cytometry: helping to make sense of high-dimensional immunology data</article-title>
        <source>Nat. Rev. Immunol.</source>
        <year>2016</year>
        <volume>16</volume>
        <fpage>449</fpage>
        <lpage>462</lpage>
        <pub-id pub-id-type="doi">10.1038/nri.2016.56</pub-id>
        <?supplied-pmid 27320317?>
        <pub-id pub-id-type="pmid">27320317</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hansen</surname>
            <given-names>LP</given-names>
          </name>
        </person-group>
        <article-title>Large sample properties of generalized method of moments estimators</article-title>
        <source>Econometrica</source>
        <year>1982</year>
        <volume>50</volume>
        <fpage>1029</fpage>
        <lpage>1054</lpage>
        <pub-id pub-id-type="doi">10.2307/1912775</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Hall, A. R. <italic>Generalized Method of Moments</italic> (OUP Oxford, Great Clarendon St, Oxford OX2 6DP, 2004).</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lück</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wolf</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Generalized method of moments for estimating parameters of stochastic reaction networks</article-title>
        <source>BMC Syst. Biol.</source>
        <year>2016</year>
        <volume>10</volume>
        <fpage>98</fpage>
        <pub-id pub-id-type="doi">10.1186/s12918-016-0342-8</pub-id>
        <?supplied-pmid 27769280?>
        <pub-id pub-id-type="pmid">27769280</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Wu, J., Stewart, W., Jayaprakash, C. &amp; Das, J. Generalized method of moments improves parameter estimation in biochemical signaling models of time-stamped single-cell snapshot data. Preprint at <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/early/2022/03/19/2022.03.17.484491">https://www.biorxiv.org/content/early/2022/03/19/2022.03.17.484491</ext-link> (2022).</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Ruder, S. An overview of gradient descent optimization algorithms. Preprint at <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1609.04747">https://arxiv.org/abs/1609.04747</ext-link> (2017).</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kirkpatrick</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gelatt</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Vecchi</surname>
            <given-names>MP</given-names>
          </name>
        </person-group>
        <article-title>Optimization by simulated annealing</article-title>
        <source>Science</source>
        <year>1983</year>
        <volume>220</volume>
        <fpage>671</fpage>
        <lpage>680</lpage>
        <pub-id pub-id-type="doi">10.1126/science.220.4598.671</pub-id>
        <?supplied-pmid 17813860?>
        <pub-id pub-id-type="pmid">17813860</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sambridge</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A Parallel Tempering algorithm for probabilistic sampling and multimodal optimization</article-title>
        <source>Geophys. J. Int.</source>
        <year>2013</year>
        <volume>196</volume>
        <fpage>357</fpage>
        <lpage>374</lpage>
        <pub-id pub-id-type="doi">10.1093/gji/ggt342</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thomas</surname>
            <given-names>BR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BioNetFit: a fitting tool compatible with BioNetGen, NFsim and distributed computing environments</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>32</volume>
        <fpage>798</fpage>
        <lpage>800</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv655</pub-id>
        <?supplied-pmid 26556387?>
        <pub-id pub-id-type="pmid">26556387</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Freitas, D., Lopes, L. G. &amp; Morgado-Dias, F. Particle swarm optimisation: a historical review up to the current developments. <italic>Entropy</italic><bold>22</bold>, 362 (2020).</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Poli</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kennedy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Blackwell</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Particle swarm optimization</article-title>
        <source>Swarm Intell.</source>
        <year>2007</year>
        <volume>1</volume>
        <fpage>33</fpage>
        <lpage>57</lpage>
        <pub-id pub-id-type="doi">10.1007/s11721-007-0002-0</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harris</surname>
            <given-names>LA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BioNetGen 2.2: advances in rule-based modeling</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>3366</fpage>
        <lpage>3368</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw469</pub-id>
        <?supplied-pmid 27402907?>
        <pub-id pub-id-type="pmid">27402907</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Somogyi</surname>
            <given-names>ET</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>libRoadRunner: a high performance SBML simulation and analysis library</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>3315</fpage>
        <lpage>3321</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv363</pub-id>
        <?supplied-pmid 26085503?>
        <pub-id pub-id-type="pmid">26085503</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goldstein</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Faeder</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Hlavacek</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Mathematical and computational models of immune-receptor signalling</article-title>
        <source>Nat. Rev. Immunol.</source>
        <year>2004</year>
        <volume>4</volume>
        <fpage>445</fpage>
        <lpage>456</lpage>
        <pub-id pub-id-type="doi">10.1038/nri1374</pub-id>
        <?supplied-pmid 15173833?>
        <pub-id pub-id-type="pmid">15173833</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loskot</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Atitey</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Mihaylova</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive review of models and methods for inferences in Bio-Chemical reaction networks</article-title>
        <source>Front. Genet.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>549</fpage>
        <pub-id pub-id-type="doi">10.3389/fgene.2019.00549</pub-id>
        <?supplied-pmid 31258548?>
        <pub-id pub-id-type="pmid">31258548</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mitra</surname>
            <given-names>ED</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pybionetfit and the biological property specification language</article-title>
        <source>iScience</source>
        <year>2019</year>
        <volume>19</volume>
        <fpage>1012</fpage>
        <lpage>1036</lpage>
        <pub-id pub-id-type="doi">10.1016/j.isci.2019.08.045</pub-id>
        <?supplied-pmid 31522114?>
        <pub-id pub-id-type="pmid">31522114</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>King</surname>
            <given-names>RD</given-names>
          </name>
        </person-group>
        <article-title>An investigation into the population abundance distribution of mRNAs, proteins, and metabolites in biological systems</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2020</fpage>
        <lpage>2027</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp360</pub-id>
        <?supplied-pmid 19535531?>
        <pub-id pub-id-type="pmid">19535531</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bengtsson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ståhlberg</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rorsman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kubista</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Gene expression profiling in single cells from the pancreatic islets of Langerhans reveals lognormal distribution of mRNA levels</article-title>
        <source>Genome Res.</source>
        <year>2005</year>
        <volume>15</volume>
        <fpage>1388</fpage>
        <lpage>1392</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.3820805</pub-id>
        <?supplied-pmid 16204192?>
        <pub-id pub-id-type="pmid">16204192</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lanier</surname>
            <given-names>LL</given-names>
          </name>
        </person-group>
        <article-title>Up on the tightrope: natural killer cell activation and inhibition</article-title>
        <source>Nat. Immunol.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>495</fpage>
        <lpage>502</lpage>
        <pub-id pub-id-type="doi">10.1038/ni1581</pub-id>
        <?supplied-pmid 18425106?>
        <pub-id pub-id-type="pmid">18425106</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McKeithan</surname>
            <given-names>TW</given-names>
          </name>
        </person-group>
        <article-title>Kinetic proofreading in t-cell receptor signal transduction</article-title>
        <source>Proc. Natl. Acad. Sci. USA</source>
        <year>1995</year>
        <volume>92</volume>
        <fpage>5042</fpage>
        <lpage>5046</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.92.11.5042</pub-id>
        <?supplied-pmid 7761445?>
        <pub-id pub-id-type="pmid">7761445</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hao</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>O’Shea</surname>
            <given-names>EK</given-names>
          </name>
        </person-group>
        <article-title>Signal-dependent dynamics of transcription factor translocation controls gene expression</article-title>
        <source>Nat. Struct. Mol. Biol.</source>
        <year>2012</year>
        <volume>19</volume>
        <fpage>31</fpage>
        <lpage>39</lpage>
        <pub-id pub-id-type="doi">10.1038/nsmb.2192</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Das</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Activation or tolerance of natural killer cells is modulated by ligand quality in a nonmonotonic manner</article-title>
        <source>Biophys. J.</source>
        <year>2010</year>
        <volume>99</volume>
        <fpage>2028</fpage>
        <lpage>2037</lpage>
        <pub-id pub-id-type="doi">10.1016/j.bpj.2010.07.061</pub-id>
        <?supplied-pmid 20923636?>
        <pub-id pub-id-type="pmid">20923636</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goldbeter</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Koshland</surname>
            <given-names>DE</given-names>
          </name>
        </person-group>
        <article-title>An amplified sensitivity arising from covalent modification in biological systems</article-title>
        <source>Proc. Natl. Acad. Sci. USA</source>
        <year>1981</year>
        <volume>78</volume>
        <fpage>6840</fpage>
        <lpage>6844</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.78.11.6840</pub-id>
        <?supplied-pmid 6947258?>
        <pub-id pub-id-type="pmid">6947258</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Transtrum</surname>
            <given-names>MK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Perspective: Sloppiness and emergent theories in physics, biology, and beyond</article-title>
        <source>J. Chem. Phys.</source>
        <year>2015</year>
        <volume>143</volume>
        <fpage>010901</fpage>
        <pub-id pub-id-type="doi">10.1063/1.4923066</pub-id>
        <?supplied-pmid 26156455?>
        <pub-id pub-id-type="pmid">26156455</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eydgahi</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Properties of cell death models calibrated and compared using Bayesian approaches</article-title>
        <source>Mol. Syst. Biol.</source>
        <year>2013</year>
        <volume>9</volume>
        <fpage>644</fpage>
        <pub-id pub-id-type="doi">10.1038/msb.2012.69</pub-id>
        <?supplied-pmid 23385484?>
        <pub-id pub-id-type="pmid">23385484</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Liu, B. &amp; Faeder, J. R. Parameter estimation of rule-based models using statistical model checking. 2016 IEEE International Conference on Bioinformatics and Biomedicine. 1453–1459 (2016).</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoops</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>COPASI—a complex pathway simulator</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>3067</fpage>
        <lpage>3074</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl485</pub-id>
        <?supplied-pmid 17032683?>
        <pub-id pub-id-type="pmid">17032683</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmiester</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PEtab—interoperable specification of parameter estimation problems in systems biology</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2021</year>
        <volume>17</volume>
        <fpage>e1008646</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1008646</pub-id>
        <?supplied-pmid 33497393?>
        <pub-id pub-id-type="pmid">33497393</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sneddon</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Faeder</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Emonet</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Efficient modeling, simulation and coarse-graining of biological complexity with NFsim</article-title>
        <source>Nat. Methods</source>
        <year>2011</year>
        <volume>8</volume>
        <fpage>177</fpage>
        <lpage>183</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1546</pub-id>
        <?supplied-pmid 21186362?>
        <pub-id pub-id-type="pmid">21186362</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grewal</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Das</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Spatially resolved in silico modeling of nkg2d signaling kinetics suggests a key role of nkg2d and vav1 co-clustering in generating natural killer cell activation</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2022</year>
        <volume>18</volume>
        <fpage>1</fpage>
        <lpage>33</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1010114</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Konstorum</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vella</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Adler</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Laubenbacher</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>Addressing current challenges in cancer immunotherapy with mathematical and computational modelling</article-title>
        <source>J. R. Soc. Interface</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>20170150</fpage>
        <pub-id pub-id-type="doi">10.1098/rsif.2017.0150</pub-id>
        <?supplied-pmid 28659410?>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Papoutsoglou</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Challenges in the multivariate analysis of mass cytometry data: the effect of randomization</article-title>
        <source>Cytometry A</source>
        <year>2019</year>
        <volume>95</volume>
        <fpage>1178</fpage>
        <lpage>1190</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.23908</pub-id>
        <?supplied-pmid 31692248?>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krishnaswamy</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Conditional density-based analysis of T cell signaling in single-cell data</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>346</volume>
        <fpage>1250689</fpage>
        <pub-id pub-id-type="doi">10.1126/science.1250689</pub-id>
        <?supplied-pmid 25342659?>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lopez</surname>
            <given-names>CF</given-names>
          </name>
          <name>
            <surname>Muhlich</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Bachman</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Sorger</surname>
            <given-names>PK</given-names>
          </name>
        </person-group>
        <article-title>Programming biological models in python using PySB</article-title>
        <source>Mol. Syst. Biol.</source>
        <year>2013</year>
        <volume>9</volume>
        <fpage>646</fpage>
        <pub-id pub-id-type="doi">10.1038/msb.2013.1</pub-id>
        <?supplied-pmid 23423320?>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fröhlich</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>AMICI: high-performance sensitivity analysis for large ordinary differential equation models</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>37</volume>
        <fpage>3676</fpage>
        <lpage>3677</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btab227</pub-id>
        <?supplied-pmid 33821950?>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">NPJ Syst Biol Appl</journal-id>
    <journal-id journal-id-type="iso-abbrev">NPJ Syst Biol Appl</journal-id>
    <journal-title-group>
      <journal-title>NPJ Systems Biology and Applications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2056-7189</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10516955</article-id>
    <article-id pub-id-type="pmid">37736766</article-id>
    <article-id pub-id-type="publisher-id">299</article-id>
    <article-id pub-id-type="doi">10.1038/s41540-023-00299-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>BioNetGMMFit: estimating parameters of a BioNetGen model from time-stamped snapshots of single cells</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8370-7738</contrib-id>
        <name>
          <surname>Wu</surname>
          <given-names>John</given-names>
        </name>
        <address>
          <email>wu.4427@osu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stewart</surname>
          <given-names>William C. L.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jayaprakash</surname>
          <given-names>Ciriyam</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Das</surname>
          <given-names>Jayajit</given-names>
        </name>
        <address>
          <email>jayajit.das@nationwidechildrens.org</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00rs6vg23</institution-id><institution-id institution-id-type="GRID">grid.261331.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 2285 7943</institution-id><institution>Department of Computer Science, </institution><institution>The Ohio State University, </institution></institution-wrap>281 W Lane Ave, Columbus, OH 43210 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/003rfsp33</institution-id><institution-id institution-id-type="GRID">grid.240344.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 0392 3476</institution-id><institution>Steve and Cindy Rasmussen Institute for Genomics, </institution><institution>The Abigail Wexner Research Institute, Nationwide Children’s Hospital, </institution></institution-wrap>700 Children’s Drive, Columbus, OH 43205 USA </aff>
      <aff id="Aff3"><label>3</label>GIG Statistical Consulting LLC, Columbus, OH 43210 USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00rs6vg23</institution-id><institution-id institution-id-type="GRID">grid.261331.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 2285 7943</institution-id><institution>Department of Physics, </institution><institution>The Ohio State University, </institution></institution-wrap>191 W Woodruff Ave, Columbus, OH 43210 USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00rs6vg23</institution-id><institution-id institution-id-type="GRID">grid.261331.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 2285 7943</institution-id><institution>Departments of Pediatrics, Biomedical Informatics, Pelotonia Institute of Immuno-Oncology, College of Medicine, and Biophysics Program, </institution><institution>The Ohio State University, </institution></institution-wrap>370 W 9th Ave, Columbus, OH 43210 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>22</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>9</volume>
    <elocation-id>46</elocation-id>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>7</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Mechanistic models are commonly employed to describe signaling and gene regulatory kinetics in single cells and cell populations. Recent advances in single-cell technologies have produced multidimensional datasets where snapshots of copy numbers (or abundances) of a large number of proteins and mRNA are measured across time in single cells. The availability of such datasets presents an attractive scenario where mechanistic models are validated against experiments, and estimated model parameters enable quantitative predictions of signaling or gene regulatory kinetics. To empower the systems biology community to easily estimate parameters accurately from multidimensional single-cell data, we have merged a widely used rule-based modeling software package BioNetGen, which provides a user-friendly way to code for mechanistic models describing biochemical reactions, and the recently introduced CyGMM, that uses cell-to-cell differences to improve parameter estimation for such networks, into a single software package: BioNetGMMFit. BioNetGMMFit provides parameter estimates of the model, supplied by the user in the BioNetGen markup language (BNGL), which yield the best fit for the observed single-cell, time-stamped data of cellular components. Furthermore, for more precise estimates, our software generates confidence intervals around each model parameter. BioNetGMMFit is capable of fitting datasets of increasing cell population sizes for any mechanistic model specified in the BioNetGen markup language. By streamlining the process of developing mechanistic models for large single-cell datasets, BioNetGMMFit provides an easily-accessible modeling framework designed for scale and the broader biochemical signaling community.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Software</kwd>
      <kwd>Time series</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>This work is supported by the NIH (U.S) awards R01-AI 143740 and R01-AI 146581 to JD, and by the Research Institute at the Nationwide Children’s Hospital</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>This work is supported by the NIH awards R01-AI 143740 and R01-AI 146581 to JD, and by the Research Institute at the Nationwide Children’s Hospital</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature Limited 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par2">Recent advancements in single-cell technologies have allowed for the measurement of cell-to-cell differences in mRNA/protein abundances<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref></sup>. These differences enable the evaluation of means and higher-order moments (e.g., variances and covariances), which can be utilized to improve the estimation of model parameters. One potential strategy, which is especially useful in our case where the probability distribution for the data (i.e., the likelihood) is unknown, is to estimate model parameters by minimizing the differences between sample moments and their corresponding predicted moments computed from in silico models. However, it is not obvious how any set of moment differences should be summarized, especially since sample moments (and hence moment differences) can vary considerably in single-cell data. The Generalized Method of Moments (GMM), widely used in econometrics<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR5">5</xref></sup> and described in greater detail below, provides a systematic approach to incorporate means and higher-order moments in parameter estimation<sup><xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR7">7</xref></sup>. Within GMM, the moment differences are combined into a single measure of cost (i.e., distance) using a system of weights that efficiently accounts for fluctuations across sample moments (see A.1 GMM Primer for more details). In practice, to find parameter values that minimize the GMM cost, one usually needs an optimization algorithm such as gradient-descent<sup><xref ref-type="bibr" rid="CR8">8</xref></sup> or stochastic algorithms, such as simulated annealing<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> or parallel tempering<sup><xref ref-type="bibr" rid="CR10">10</xref>,<xref ref-type="bibr" rid="CR11">11</xref></sup>. In recent years, a class of meta-heuristic optimization algorithms, such as Particle Swarm Optimization (PSO) that do not require the calculation of gradients and can be easily parallelized has been developed (see refs. <sup><xref ref-type="bibr" rid="CR12">12</xref>,<xref ref-type="bibr" rid="CR13">13</xref></sup> for a pedagogical review).</p>
    <p id="Par3">Rule-based modeling approaches, such as BioNetGen<sup><xref ref-type="bibr" rid="CR14">14</xref></sup> and libRoadRunner<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>, have been developed to address combinatorial complexity in modeling biochemical reactions in signaling and gene regulatory networks<sup><xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup>. These approaches provide a user-friendly way to construct models. Estimating model parameters, such as reaction rates, is crucial for improving model predictions and quantifying underlying mechanisms described by the model using experimental measurements. With the emergence of software packages such as PyBioNetFit<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, parameter estimation from rule-based models using bulk measurements of selected proteins (e.g., average or total protein abundances observed over time) has become possible.</p>
    <p id="Par4">We introduce BioNetGMMFit, a software tool that uses GMM to improve parameter estimation in BioNetGen models by exploiting the additional information in single-cell snapshot data. This tool requires users to supply a BioNetGen model .bngl file, time-stamped snapshot abundance data files, and run configuration files. BioNetGMMFit utilizes the GMM analysis of time-stamped protein abundances, as implemented in CyGMM<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>, to estimate the parameters of the BioNetGen model, provide confidence intervals, predict moments at future times, and report the minimum cost (i.e., the distance between the sample moments and the moments predicted by the model using the GMM estimate of the parameters). While GMM can be used in conjunction with a wide variety of optimization routines, we use PSO to optimize our cost function because it does not require gradient calculations, scales well with higher-dimensional search spaces, has a relatively short run time, and is easily parallelized on a compute cluster. In addition, users can tune the PSO hyperparameters, which can affect the optimization’s efficiency and accuracy. As such, in addition to being written in C++, BioNetGMMFit is scalable with increasing data sizes on high-performance computing clusters. BioNetGMMFit is also available through Docker as C++ compilation varies across different operating systems. However, for improved performance, BioNetGMMFit can be compiled as a C++ executable through cmake and has been tested on Linux operating systems.</p>
    <p id="Par5">The manuscript is organized as follows. In the Software Description section, we provide detailed information on the implementation and use of BioNetGMMFit. Next, in the “Results section”, we present three examples of modeling single-cell data where we apply BioNetGMMFit and compare it with existing software tools. Finally, we offer our conclusions, and discuss future directions and limitations in “Discussion”.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <p id="Par6">We applied BioNetGMMFit to simulated datasets generated by models with known ground truth parameters to provide a reference point to evaluate its robustness, efficacy, and versatility. Specifically, we apply BioNetGMMFit to three simulated datasets, where each dataset is generated from a different model. Furthermore, we showcase the software’s functionality, which includes (1) facilitating estimation of model parameters from different combinations of moments for any rule-based model, (2) fixing subsets of model parameters both for simulation and estimation, and (3) forecasting moments at future time points. For each simulated dataset, we generated two sets of initial conditions from lognormal distributions as they have been observed across a variety of single-cell systems<sup><xref ref-type="bibr" rid="CR19">19</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>. To mimic the experimental constraint that “X” cannot be used to generate the observed snapshot data “Y” at time <italic>t</italic>, we generate another set of unobserved initial conditions that are used to obtain “Y” by evolving the BioNetGen models with ground truth parameters. This feature of simulating data with BioNetGen models when given a set of initial conditions is built into BioNetGMMFit. Figure <xref rid="Fig1" ref-type="fig">1</xref> provides a diagram of this process.<fig id="Fig1"><label>Fig. 1</label><caption><title>Data generation process.</title><p>A fundamental constraint of time-stamped CyTOF data is that in order to measure a cell, it must be sacrificed. Therefore, in physical experiments, the initial conditions of cells observed at time <italic>t</italic> and <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${t}^{{\prime} }$$\end{document}</tex-math><mml:math id="M2"><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41540_2023_299_Article_IEq1.gif"/></alternatives></inline-formula> are unknown. Similarly, cells observed at time <italic>t</italic><sub>0</sub>, cannot be observed at future times <italic>t</italic> and <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${t}^{{\prime} }$$\end{document}</tex-math><mml:math id="M4"><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41540_2023_299_Article_IEq2.gif"/></alternatives></inline-formula>. Here, we refer to such initial conditions and future states (shown in yellow) as “unavailable”. By contrast, parameter estimation only makes use of the “observed” data shown in green. Note that the “unavailable” data marked with an asterisk (*) must be generated in order to simulate data obtained from CyTOF experiments. In particular, one must simulate the initial conditions of all cells so that disjoint subsets of cells can be evolved to future times of interest. For ease of exposition, the subset index is not shown. We use the X and Y labels here in order to remain consistent with the inputs defined in Fig. <xref rid="Fig10" ref-type="fig">10</xref>.</p></caption><graphic xlink:href="41540_2023_299_Fig1_HTML" id="d32e361"/></fig></p>
    <p id="Par7">For more information on the simulated datasets themselves, please see the GitHub page (<ext-link ext-link-type="uri" xlink:href="https://github.com/jhnwu3/BioNetGMMFit/tree/main/example">https://github.com/jhnwu3/BioNetGMMFit/tree/main/example</ext-link>) in their respective “X” and “Y” directories.</p>
    <sec id="Sec3">
      <title>A biochemical reaction system with first-order reactions</title>
      <p id="Par8">Here, we investigate and show that BioNetGMMFit can successfully reproduce the ground truth model parameters for a system of first-order reactions model where six molecular species are arranged in a linear architecture and react via first-order biochemical reactions as illustrated by the reaction network in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. The reaction system can represent or can be generalized to represent a variety of sequential cell signaling processes such as phosphorylation of adaptor proteins such as DAP12 or Fc<italic>ϵ</italic>R1<italic>γ</italic> in NK cells<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> which are phosphorylated by Src family kinases or series of chemical modifications in signaling proteins in membrane-proximal signaling events in T cells<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. We successfully estimate all 6 parameters of the model and showcase one of BioNetGMMFit’s important features: the ability to estimate parameters using different moments. We note that one advantage of GMM (see <xref rid="MOESM1" ref-type="media">Supplementary Material)</xref> is that it allows for the use of any number of moments in its objective function. BioNetGMMFit allows the choice of fitting three different combinations of moments of across a dataset: (1) first moments (means), (2) first (means) and second moments (variances), as well as (3) first (means), second (variances), and mixed moments (covariances) as shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>.<fig id="Fig2"><label>Fig. 2</label><caption><title>First-order reaction model.</title><p>On the left, X<sub>1</sub> through X<sub>6</sub> represent protein species in a system of reactions where <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathop{\longrightarrow }\limits^{\theta }$$\end{document}</tex-math><mml:math id="M6"><mml:mover accent="true"><mml:mrow><mml:mo>→</mml:mo></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mover></mml:math><inline-graphic xlink:href="41540_2023_299_Article_IEq3.gif"/></alternatives></inline-formula> represents a reaction in which species X<sub><italic>i</italic></sub> is changed into Click to show the PDF X<sub><italic>j</italic></sub> at the rate given by the corresponding <italic>θ</italic>. BioNetGMMFit is used to estimate the set of <italic>θ</italic>’s. Below the system of reactions, its BioNetGen reaction rules are displayed; these need to be defined and input to BioNetGMMFit to estimate the <italic>θ</italic>’s. Note that we use k’s instead of <italic>θ</italic>’s to define model parameters in BNGL. The table on the right contains the ground truth values.</p></caption><graphic xlink:href="41540_2023_299_Fig2_HTML" id="d32e442"/></fig><fig id="Fig3"><label>Fig. 3</label><caption><title>Parameter estimates using different combinations of moments in the first-order reaction model.</title><p>The left column (<bold>A</bold>) contains 95% confidence intervals of parameter estimates obtained using only the means of the snapshot data at time <italic>t</italic> = 1.5 (top panel) and the comparison of the predicted means and the actual (observed) means (bottom panel). The middle column (<bold>B</bold>) contains analogous results by fitting the means and variances. Note the change in the scale of the values of the moments when the variance is included. The last column (<bold>C</bold>) on the right are the results obtained by fitting all the first, second, and mixed moments or more specifically all 6 means, 6 variances, and 15 covariances of the 6 proteins. This illustrates the flexibility available to the user to choose different subsets of moments for parameter estimation. In the analysis, the initial conditions and the simulated observed conditions at time <italic>t</italic> = 1.5 both contained 10,000 cells each.</p></caption><graphic xlink:href="41540_2023_299_Fig3_HTML" id="d32e466"/></fig></p>
      <p id="Par9">A key strength of this flexibility of moment choice in the cost function is the ability to adapt to different problem requirements. For instance, inclusion of higher-order moments tends to improve parameter estimation in this first-order reaction model as shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>, whereas the usage of variances and covariances in its fitting routine produces the tightest confidence intervals around its parameter estimates.</p>
    </sec>
    <sec id="Sec4">
      <title>Model for Msn2-induced transcription in yeast</title>
      <p id="Par10">Next, as mechanistic models often incorporate some form of nonlinearity, we show that we can successfully perform parameter estimation for a nonlinear gene regulatory model involved in stress response in yeast<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>. This is a simplified version of a commonly occurring gene regulatory motif in yeast. One of the key regulators of the stress response is the transcription factor Msn2 which resides in the cytoplasm in the resting state and is dephosphorylated in response to stress. Upon phosphorylation, Msn2 translocates to the nucleus, binds to stress-responsive elements (STRE), and induces gene expression of response proteins. The model is illustrated in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. This example explores a scenario where certain model parameters need to be fixed. Here we fixed two parameters, the death rate <italic>p</italic><sub><italic>d</italic></sub> and the birth rate <italic>p</italic><sub><italic>b</italic></sub> of the protein species <italic>P</italic>, reducing the total number of parameters to be estimated to four. The BioNetGen rules describing the model and the ground truth parameter values used to generate the synthetic data are shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. We analyzed its simulated observed snapshot data at time points 0, 1, and 5 min in its parameter estimation.<fig id="Fig4"><label>Fig. 4</label><caption><title>Msn2 transcription model.</title><p>Model reaction network is shown on the left with its corresponding BioNetGen reaction rules defined below it. Ground truth model parameters and which ones have been fixed are shown in the table on the right. In this case, non-fixed model parameters labeled by “n” are estimated.</p></caption><graphic xlink:href="41540_2023_299_Fig4_HTML" id="d32e509"/></fig></p>
      <p id="Par11">The parameter estimation results for the Msn2 transcription model are presented in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. Although the moment fits for both time points are not perfect, with an underfitted variance for one of the species, the confidence intervals around the estimated parameters fully encompass the ground truth parameters, indicating that BioNetGMMFit is capable of handling parameter estimation for nonlinear models.<fig id="Fig5"><label>Fig. 5</label><caption><title>Msn2 transcription model outputs.</title><p>Model parameter estimate with confidence intervals on the left were generated by the moment fits for two different simulated observed time points, <italic>t</italic> = 1 and <italic>t</italic> = 5 min, on the right. In this case, 95% confidence intervals of parameter estimates shown on the left include the ground truth parameter values. Please note that the middle two x-tick marks, pb and pd are not estimated and are held constant. Using simulated data for the 5 species (i.e D, T<sub>2</sub>, m, etc.) in the ground truth model, 5 means, 5 variances, and 10 covariances across two time points were obtained and used for parameter estimation. All snapshot data used in the analysis contained 10,000 cells.</p></caption><graphic xlink:href="41540_2023_299_Fig5_HTML" id="d32e531"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Vav1 activation kinetics in NK cells</title>
      <p id="Par12">As the final example, we consider a simplified model early time biochemical signaling kinetics (Fig. <xref rid="Fig6" ref-type="fig">6</xref>) in mouse Natural Killer (NK) cells<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> to illustrate a case where identifiability issues prevent BioNetGMMFit from capturing the ground truth model parameters. The model describes the phosphorylation of a key signaling protein Vav1 by the kinase Syk bound to activating receptor–ligand complex and the dephosphorylation of phosphorylated Vav1 by the phosphatase SHP1 bound to the inhibitory receptor–ligand complex. The nonlinear biochemical reactions in the model are akin to the zero-order ultrasensitivity model proposed by Goldbeter and Koshland<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>. We assume the abundances for the proteins Syk, Vav1, Syk-Vav1, SHP1, SHP1-pVav1, and pVav1 are measured at any time <italic>t</italic>.<fig id="Fig6"><label>Fig. 6</label><caption><title>Vav1 activation model.</title><p>The reaction network displayed on the left represents a simplified version of the phosphorylation-dephosphorylation kinetics of Vav1 in mouse NK cells. The corresponding reaction rules in BioNetGen are shown below. All the parameters, the set of rate constants {<italic>θ</italic><sub><italic>j</italic></sub>} or k<sub><italic>j</italic></sub> in the .bngl file and their ground truth values on the right are estimated using BioNetGMMFit.</p></caption><graphic xlink:href="41540_2023_299_Fig6_HTML" id="d32e568"/></fig></p>
      <p id="Par13">Following parameter estimation, we predict first, second, and mixed moments. The comparisons between the predictions and the simulated observed moments at different time points are shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref>. The three slopes shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref>, each near unity, indicate good agreement between the predicted moments (i.e., means, variances, and covariances) and the observed moments at each time point. Furthermore, using the model parameters estimated by BioNetGMMFit, we can <italic>forecast</italic> moments (i.e., predict moments) at times well outside of the given observational range (Fig. <xref rid="Fig7" ref-type="fig">7)</xref>. The nonlinear Vav1 activation model also presents a case where hyperparameter tuning is needed to generate more accurate parameter estimates. For instance, in Fig. <xref rid="Fig7" ref-type="fig">7</xref>, increasing the number of particles and steps in the PSO routine improves the parameter estimates (i.e., brought them closer to the simulated ground truth). Despite improved estimates, this scenario illustrates a parameter estimation problem where other parameter estimates exist that minimize the objective function. Figure <xref rid="Fig7" ref-type="fig">7</xref> shows that although the moment fits are excellent, and the predictions closely match the observed and future unobserved data, the parameter estimates for k<sub>2</sub> and k<sub>5</sub> are unable to capture the ground truth values, even with a tuned hyperparameter configuration of 1500 particles and 150 steps of PSO. In the subsection below, we provide further insights into the challenges of parameter estimation in rule-based models.<fig id="Fig7"><label>Fig. 7</label><caption><title>Results for the Vav1 activation model.</title><p>The ground truth parameter values shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref> are estimated by BioNetGMMFit using data from the ground truth model at <italic>t</italic> = 0.5 and <italic>t</italic> = 2. In total, 5000 cells at each time point were used in the analysis. The panels in the left column show the predicted moments calculated with estimated parameters plotted against the observed moments calculated using the ground truth model at various time points. The top figure shows the comparison at one of the input time points while the bottom two graphs are the “forecast” moments at <italic>t</italic> = 10 and <italic>t</italic> = 40. This shows that such parameter estimates can predict values at time points well into the future. The parameter estimates were derived from configuration 6 Protein A. Please see Supplementary Figure <xref rid="MOESM1" ref-type="media">11</xref> in the <xref rid="MOESM1" ref-type="media">Supplementary Material</xref> for more information on the PSO hyperparameter configurations used. On the right, we show improvements in estimates by tuning PSO hyperparameters and show parameter estimates for two different hyperparameter configurations. All the moment comparison plots in the left column were generated with parameter estimated obtained using PSO with 1500 particles and 150 steps. Note that the time units for this simulated dataset are arbitrary since BioNetGMMFit does not have units built into its plotting function. However, phosphorylation reactions as defined by the network in Fig. <xref rid="Fig6" ref-type="fig">6</xref> occur on the time scale of seconds.</p></caption><graphic xlink:href="41540_2023_299_Fig7_HTML" id="d32e627"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>Practical concerns in estimation</title>
      <p id="Par14">As seen from the Vav1 activation model, cost functions for ODE models often possess multiple local minima and/or flat regions with small curvatures<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>, that typically make estimation (i.e., the task of finding the best parameter values) challenging for any method. Although PSO mitigates these optimization problems to some extent, depending on the computational constraints, BioNetGMMFit does not fully address the difficulties of such irregular cost functions, e.g., BioNetGMMFit can still yield estimates that reflect a local, rather than the global, minimum. One such example is shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref> where only 150 particles and 25 steps were used for parameter estimation of the simulated Vav1 activation model. We intentionally chose a limited number of particles and steps to examine what could happen in a computationally constrained environment. As one might expect, the estimates for some paremeters were not close to their corresponding ground truth values; however (perhaps surprisingly), the estimates were able to accurately predict the observed first, second, and cross moments at later times as shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref>. However, when the number of particles and steps used are increased tenfold, parameter estimates are much closer to the ground truth, although prediction improves only slightly. Moreover, this dramatic improvement in estimation and a slight improvement in prediction demand higher computational costs as shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">12</xref> where there is a drastic increase in run time from configuration “6 Protein Time Points Set A” to “6 Protein Time Points Set A Extreme” in Supplementary Fig. <xref rid="MOESM1" ref-type="media">12</xref>. As such, this raises an interesting question of “How much should one care about obtaining the best possible parameter estimates (as shown with <italic>k</italic><sub>4</sub> in Fig. <xref rid="Fig7" ref-type="fig">7</xref> for example), especially when computational resources may be limited and/or when the primary interest of the analysis may be prediction, not estimation?” Furthermore, despite the potential for dramatic improvement in estimation, there is no guarantee that one will realize the desired improvement simply by using more particles and/or steps.</p>
      <p id="Par15">We acknowledge the previous work of Sethna et al.<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>, which used information theory to characterize parameter identifiability issues and model sloppiness; and the work of Sorger et al.<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>, which used a Bayesian approach to compare competing models in the presence of partial identifiability. Although BioNetGMMFit is not designed to directly address those issues, our software does give users the ability to inspect a given model for identifiability concerns by constructing pairwise contour plots of the high-dimensional cost (aka objective) function. For each contour plot the x and y axes correspond to a pair of distinct rate constants. For example, pairwise contour plots can be generated for the nonlinear Vav1 activation model, where local minima were virtually indistinguishable from the ground truth, resulting in parameter estimates that were different from the ground truth (see Fig. <xref rid="Fig7" ref-type="fig">7)</xref>. By creating pairwise contour plots for k<sub>2</sub> (or <italic>θ</italic><sub>2</sub>) and k<sub>5</sub>, where PSO was unable to discern the ground truth values (see Fig. <xref rid="Fig8" ref-type="fig">8</xref>), a striped pattern on the log-cost contour plot reveals a region of unidentifiability. In contrast, the well-estimated first-order reaction model has a convex log-cost shape (see Fig. <xref rid="Fig8" ref-type="fig">8</xref>).<fig id="Fig8"><label>Fig. 8</label><caption><title>Contour plots for identifiability.</title><p>Contour plots of the landscape of the cost function are shown as a function of k<sub>2</sub> on the <italic>x</italic> axis and k<sub>5</sub> on the <italic>y</italic> axis with all other model parameters held constant at the ground truth. The left contour plot is a pairwise contour plot of the fully “identifiable” first-order reaction system where a steeply convex cost landscape surrounds the ground truth parameters at the bottom left. The right pairwise contour plot is of the nonlinear Vav1 activation model where a nonconvex cost landscape results in the parameter estimates shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref>. Note the big difference in the scale of the color values for the two plots. The color bar is of the log-GMM cost that is derived by BioNetGMMFit with 6 means, 6 variances, and 15 covariances in its calculation.</p></caption><graphic xlink:href="41540_2023_299_Fig8_HTML" id="d32e705"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>Comparison with other software tools</title>
      <p id="Par16">By combining the best aspects of CyGMM and BioNetGen, BioNetGMMFit provides several noteworthy features for the analysis of single-cell time-stamped cytometry data that complements the currently available parameter estimation software suite (i.e PyBioNetFit<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, Statistical Model Checking (SMC)<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>, COPASI<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>). In particular, BioNetGMMFit offers the ability to efficiently analyze single-cell trajectories for a large number ( &gt; 1000) of cells, predict higher-order moments at future times, and simulate parameter estimation tasks with ground truth parameters. We detail the full capabilities and limitations of BioNetGMMFit below as well as how it compares to other pre-existing parameter estimation software packages. A brief summary of the software-related differences are shown in Fig. <xref rid="Fig9" ref-type="fig">9</xref>.<fig id="Fig9"><label>Fig. 9</label><caption><title>Comparison of BioNetGMMFit features.</title><p>Bulk measurements refer to measurements in which one obtains a single observed value for each species of reactants, at each time point. The observed value may be the mean or total abundance of the species at that time point. In contrast, single-cell measurements yield copy numbers or concentrations of each species for thousands of cells at each time point. This leads to what we refer to as initial abundance noise. The letter “y” indicates that the feature is available and “n” implies that the software is not designed to do it.</p></caption><graphic xlink:href="41540_2023_299_Fig9_HTML" id="d32e732"/></fig></p>
      <sec id="Sec8">
        <title>Dealing efficiently with cell-specific initial conditions</title>
        <p id="Par17">BioNetGMMFit accurately and efficiently estimate BioNetGen model parameters from cytometry snapshot data observed across many single-cell trajectories. It employs the same sophisticated minimization procedure as CyGMM<sup><xref ref-type="bibr" rid="CR7">7</xref></sup> to estimate parameters from the analysis of higher-order moments. To the best of our knowledge, existing software are not designed to account for large variances in initial conditions. Thus, they have difficulty performing parameter estimation efficiently where (1) initial abundance noise is known to play a role and (2) the data consists of large numbers of different single cells (where each cell has its own set of trajectories).</p>
        <p id="Par18">For example, when the estimation depends on the analysis of data from a large number of single cells (as opposed to bulk measurements averaged over cells), existing software is either not designed to handle such data<sup><xref ref-type="bibr" rid="CR18">18</xref>,<xref ref-type="bibr" rid="CR28">28</xref></sup>, or is less user-friendly, or is computationally inefficient<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>. In many cases, when attempting to perform parameter estimation across a combination of moment statistics, inefficiencies related to file input and output occur. For instance, in using BioNetGen’s simulator, each cell has its own BioNetGen file containing a bulk measurement such as average protein abundances. Therefore, to perform parameter estimation across a combination of different measurements (i.e., means, variances, and covariances) with BioNetGen only<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>, the user must repeatedly read from multiple data files in its parameter estimation. In PyBioNetFit<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, only a single set of cell conditions per time point are used for parameter estimation. Our method allows users to input easily several time-stamped snapshot files containing abundance data from thousands of cells and store them directly in memory for quick simulations. See Supplementary Fig. <xref rid="MOESM1" ref-type="media">10</xref> below for each dataset’s cell count used for parameter estimation. While the comparison is not exact as the models and objective function (i.e BioNetGMMFit’s incorporation of higher-order moments) analyzed were different, we show that we can attain run-time performance comparable to that of PyBioNetFit<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. In the analysis of the Vav1 activation model in Fig. <xref rid="Fig6" ref-type="fig">6</xref> with 5000 single cells, the run time was ~1.9 h on a 16-core processor for 30 repeated parameter estimates, which is in the range of run time using the SBML simulator in PyBioNetFit for a similar number of cores<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. To provide some context on run time, we compare with a method such as SMC<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>: while again the comparisons are not exact as the methods and models are different, our run times are comparable to their 4.2 h for parameter estimation. Due to C++ parallelization with OpenMP, our software is capable of linearly scaling with increasing cell count, thereby reducing run times for large numbers of cells. Supplementary Fig. <xref rid="MOESM1" ref-type="media">12</xref> provides run-time details concerning the number of cells and model parameters.</p>
      </sec>
      <sec id="Sec9">
        <title>Estimating with higher-order moments</title>
        <p id="Par19">Due to their design intended for bulk measurements, existing software such as PyBioNetFit<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, COPASI<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>, and PyPesto (from the PETab suite)<sup><xref ref-type="bibr" rid="CR30">30</xref></sup> for rule-based parameter estimation are not specifically designed to fit higher moments. While possible to do a plethora of file input and output to generate multiple parameter distributions per set of initial conditions and generate moment statistics using PyBioNetFit or BioNetGen, for a large number of cells, parameter estimation becomes very user-unfriendly and computationally taxing. In contrast, BioNetGMMFit directly supports three levels of analysis corresponding to using an increasing number of moments. First, one can choose to estimate parameters using only the means (i.e., first moments). Second, one can use both means and variances or third, use means, variances, and covariances. Results for moments with different levels of fitting are shown with its different columns in Fig. <xref rid="Fig3" ref-type="fig">3</xref>.</p>
        <p id="Par20">Other more mature softwares such as COPASI<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> offer a wide variety of other features such as an executable graphical user interface, the ability to export ODEs from these rule-based languages, as well as the support of a wide range of optimization routines. For optimization routines involving smaller and simpler (i.e., linear instead of nonlinear) models where large initial abundance noise is not of concern, it is preferable to use COPASI<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>, PyBioNetFit<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, and PyPesto<sup><xref ref-type="bibr" rid="CR30">30</xref></sup> due to the availability of less computationally expensive gradient-based optimization routines. However, in such simple parameter estimation tasks, BioNetGMMFit performs functionally the same due to its flexibility of cost functions where the user can simply choose to use only the observed first moments.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec10" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par21">We present a new software: BioNetGMMFit, that greatly enhances a researcher’s ability to explore a wide range of mechanistic models while using higher-order moments to leverage the information in single-cell data. In particular, BioNetGMMFit provides accurate estimation of model parameters, and reports valid confidence intervals for each estimated parameter as well. Furthermore, BioNetGMMFit can easily handle data observed across multiple time points, and it can predict protein abundances at future times. A key feature of BioNetGMMFit, which benefits from its integration with libRoadRunner’s simulators, is its ability to easily simulate protein abundances at scale (i.e., across multiple time points, across many single cells, and under a wide variety of different biochemical signaling models). Moreover, because such simulations can now easily be carried out at scale, the ability to tune hyperparameters has become a much more accessible task.</p>
    <p id="Par22">Hyperparameter tuning involves selecting the optimal set of hyperparameters of the optimization routine to achieve the best parameter estimates that minimize the cost function and enable optimal prediction from one’s model. For example, in the case of PSO, there are five hyperparameters to tune, including the number of particles, the number of steps, and three coefficients that affect how the particle swarm moves in the space of model parameters. To address this challenge, we use a simulated reference point of the “optimal” or ground truth parameters for a BioNetGen model, which can provide insights into the performance of an optimization routine’s hyperparameter configuration. A practical way of determining a suitable set of hyperparameters when analyzing experimental data is as follows. If one wishes to fit a model to the data, one can simulate a ground truth version of the model separately and adjust the hyperparameters so that BioNetGMMFit estimates the ground truth values to desired accuracy. Then, one can use these newfound hyperparameters to fit the model to the experimental data.</p>
    <sec id="Sec11">
      <title>Limitations of BioNetGMMFit</title>
      <p id="Par23">BioNetGMMFit is currently limited to parameter estimation for well-mixed mechanistic models describing deterministic and stochastic kinetics. Unlike PyBioNetFit<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, other forms of simulation such as NFsim<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> and spatial modeling<sup><xref ref-type="bibr" rid="CR32">32</xref>,<xref ref-type="bibr" rid="CR33">33</xref></sup> are not supported. Furthermore, BioNetGMMFit does not support any optimization algorithms other than PSO. In addition, the lack of Python support may make it difficult to integrate it with pre-existing workflows that rely heavily on Python. While there exists a C++ static binary that has been tested on Ubuntu Linux, compilation with libRoadRunner C++ libraries can be a nontrivial process on other Linux distributions. Thus, BioNetGMMFit is most readily accessible through Docker, which although accessible across all major operating systems, still requires the use of third-party virtualization software. These software weaknesses will need to be addressed in future iterations of the software.</p>
    </sec>
  </sec>
  <sec id="Sec12">
    <title>Methods</title>
    <sec id="Sec13">
      <title>Software inputs</title>
      <p id="Par24">To illustrate in detail how one might use BioNetGMMFit, a parameter estimation task with an experimental CD8+ T-cell dataset was performed. As shown in Fig. <xref rid="Fig10" ref-type="fig">10</xref>, BioNetGMMFit reads input data from several sources, including (i<sub>1</sub>) a directory containing a CSV file with initial protein abundances (X) and a directory containing CSV files with observed protein abundances at different time snapshots (Y); (i<sub>2</sub>) a time steps CSV file that contains the times at which the data of interest are observed (note that the data of interest may be a subset of the full data); (i<sub>3</sub>) a .bngl (BioNetGen) file that describes the mechanistic model capable of executing deterministic or stochastic kinetics; and (i<sub>4</sub>) a BioNetGMMFit hyperparameter configuration file that enables various features, such as generating time-series snapshot data from the BioNetGen model or changing the number of particles and steps of the PSO routine. A general overview of the BioNetGMMFit workflow is illustrated in Fig. <xref rid="Fig11" ref-type="fig">11</xref>.<fig id="Fig10"><label>Fig. 10</label><caption><title>BioNetGMMFit inputs and outputs.</title><p>The inputs and outputs to the program BioNetGMMFit (yellow box) are displayed. The green boxes, labeled with the letter “i'', are the inputs to the program. The two boxes included in i<sub>1</sub> represent the input directories: X contains the initial conditions for the model and Y, all the observed snapshot data at different time points that must be passed to BioNetGMMFit. The box i<sub>2</sub> is the time steps file that contains all the specified time points at which the concentrations are evaluated, by evolving the model given the initial conditions. i<sub>3</sub> represents the model defined in BioNetGen containing the parameters to be estimated. The BioNetGen model (defined in BNGL) is used to evolve the initial conditions in X to fit the observed moments computed from the data in Y. i<sub>4</sub> is the configuration file that contains the hyperparameters of the PSO (i.e the number of particles, steps, and PSO weights) that need to be defined by the user for the parameter estimation task. The orange boxes indicate outputs and are labeled by “o''. BioNetGMMFit produces two explicit outputs, o<sub>1</sub>, the parameter estimates of the BioNetGen model and o<sub>2</sub>, the corresponding time-evolved moments. The moments in o<sub>2</sub> are generated using the parameter estimates that minimize the GMM cost between the observed moments and predicted moments. Lastly, the user can choose to forecast future trajectories of moments in o<sub>3</sub>.</p></caption><graphic xlink:href="41540_2023_299_Fig10_HTML" id="d32e892"/></fig><fig id="Fig11"><label>Fig. 11</label><caption><title>BioNetGMMFit workflow.</title><p>All “i’’’s and “o’’’s correspond to the same inputs and outputs defined in Fig. <xref rid="Fig10" ref-type="fig">10</xref>. In this figure, we depict the steps needed to run BioNetGMMFit relating back to the inputs and outputs of Fig. <xref rid="Fig10" ref-type="fig">10</xref>. To begin, the snapshot data of interest must be loaded by first organizing all .csv files into their corresponding initial conditions (X) and observed conditions (Y) directories, and then these (X) and (Y) directories (i<sub>1</sub>) must be specified to BioNetGMMFit. The black points in the data boxplot figure represents the outlier of the dataset (specifically CD8+ T-cell dataset). Next, the user must define the time points that correspond to each of the snapshot files by creating and specifying a times.csv file (i<sub>2</sub>). Once all of the data are defined, the user must define and specify the BioNetGen model of interest (i<sub>3</sub>) to BioNetGMMFit. The last input required is the hyperparameters configuration file where the user must define all of the necessary parameters for a parameter estimation run, specifically related to the PSO algorithm that will be used to estimate the BioNetGen model parameters. Once all necessary inputs (i<sub>1</sub>, i<sub>2</sub>, i<sub>3</sub>, and i<sub>4</sub>) are defined, BioNetGMMFit will run its parameter estimation routine with GMM and PSO, returning parameter estimates (o<sub>1</sub>) (and confidence intervals if there are multiple replicate runs of PSO) as well as a <italic>o</italic><italic>b</italic><italic>s</italic><italic>e</italic><italic>r</italic><italic>v</italic><italic>e</italic><italic>d</italic> = <italic>p</italic><italic>r</italic><italic>e</italic><italic>d</italic><italic>i</italic><italic>c</italic><italic>t</italic><italic>e</italic><italic>d</italic> line where observed moment values are on the <italic>y</italic> axis and predicted moments (o<sub>2</sub>) generated from the estimated model parameter on the x axis. Please note that the observed moments are calculated from the abundance data supplied by i<sub>1</sub>, and similarly the predicted moments are computed from the evolved abundances generated by simulating each initial sample with the BioNetGen model. Finally, while optional, users of BioNetGMMFit can predict moments of future time points (o<sub>3</sub>) of the BioNetGen model. Please refer to the <xref rid="MOESM1" ref-type="media">Supplementary Material</xref> for a more in-depth tutorial on how to use the command line version of BioNetGMMFit illustrated with the CD8+ T-cell dataset.</p></caption><graphic xlink:href="41540_2023_299_Fig11_HTML" id="d32e975"/></fig></p>
      <p id="Par25">When working with directories of data files, only one CSV data file is read from directory X to establish the initial set of protein abundances. Meanwhile, directory Y may contain multiple CSV files for each time step being analyzed. These data files are arranged such that each row contains the observations (i.e., protein abundances) from an individual (or single) cell. To ensure that protein abundances or concentrations are nonnegative, any single-cell data containing negative protein values at a given time is removed before performing parameter estimation in BioNetGMMFit. Such a preprocessing step reduces the necessary steps the user must take to properly use BioNetGMMFit, as negative values are commonly generated in CyTOF datasets during a processing step that spreads out zero readings in CyTOF measurements<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>.</p>
    </sec>
    <sec id="Sec14">
      <title>Working example</title>
      <p id="Par26">As an example, we will use a signaling kinetic model involving four proteins to analyze a CD8+ T-cell CyTOF dataset. One biological question of interest that can be addressed with such data is to quantify the rate of the signal propagation between a pair of signaling proteins and study how the rates depend on the developmental state of the immune cell (e.g., naive vs memory CD8+ T cell). We applied BioNetGMMFit to describe signaling kinetics in CD8+ T cells stimulated by CD3 and CD28 antibodies where binding of the antibodies induce phosphorylation of the transmembrane CD3<italic>ζ</italic> chains which further lead to phosphorylation of the adaptor protein SLP76, MAPK kinase Erk and the ribosomal protein S6 following pCD3<italic>ζ</italic> → pSLP76 → pErk → pS6<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>. We model the phosphorylation reactions shown above by first-order reactions. There are many intermediate biochemical reactions involved within the phosphorylation steps shown above and we assume the rates of the first-order reactions effectively capture the effect of those intermediate reactions. The phosphorylated protein species also go through degradation/ubiquitylation processes which are also approximated by first-order decay reactions. In addition, pCD3<italic>ζ</italic> is assumed to be produced at a constant rate due to the signaling process. The model contains five rate constants, <italic>θ</italic><sub>1</sub>, ⋅ ⋅ ⋅ , <italic>θ</italic><sub>5</sub>, which we estimate using BioNetGMMFit. BioNetGMMFit also plots confidence intervals as well as the observed and estimated moments as shown in Fig. <xref rid="Fig12" ref-type="fig">12</xref>. The underlying datasets used in this parameter estimation task of the CD8+ T cells are from (<ext-link ext-link-type="uri" xlink:href="https://dpeerlab.github.io/dpeerlab-website/dremi-data.html">https://dpeerlab.github.io/dpeerlab-website/dremi-data.html</ext-link>) <sup><xref ref-type="bibr" rid="CR35">35</xref></sup>. From this dataset, one can compute time trajectories of the protein moments, means, variances, and covariances (see Fig. <xref rid="Fig12" ref-type="fig">12)</xref>. To make the presentation simple, we will only analyze trajectories at two time points: 1 min and 2 min. In this case, 719 cells were measured at time point 1 in and 653 cells were measured at time point 2 min. Again, as shown in Fig. <xref rid="Fig12" ref-type="fig">12</xref>, mechanistic model reaction rules are defined in the .bngl file where they are then converted into an SBML file using BioNetGen’s writeSBML() function as BioNetGen does not support its own C++ API. Using libRoadRunner’s C++ API<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>, BioNetGMMFit converts this SBML file into a roadrunner object that is capable of simulating the defined model to user-specified time intervals. While there are many other reaction network simulators such as PySB<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>, COPASI<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>, and AMICI<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>, libRoadRunner was primarily chosen for its speed and ease of customizability due to its function as a C++ API rather than a standalone software package.<fig id="Fig12"><label>Fig. 12</label><caption><title>CD8+ T-cell example.</title><p>The input and output results for fitting the CD8+ T-cell CyTOF dataset are shown. The panel labels (i<sub>1</sub>), (i<sub>3</sub>), (o<sub>1</sub>), and (o<sub>2</sub>) correspond to those in Fig. <xref rid="Fig10" ref-type="fig">10</xref>. Panel (i<sub>1</sub>) in Fig. 12 shows the sample means, variances, and covariances of CD8+ T-cell proteins calculated by BioNetGMMFit for the observed time points of snapshot data (supplied in the files i<sub>1</sub> and i<sub>2</sub>). These are used for parameter estimation as part of the GMM procedure. (More information on GMM can be found in the <xref rid="MOESM1" ref-type="media">Supplementary Material</xref>.) Panel (i<sub>3</sub>) displays the reaction network and its corresponding reaction rules in the .bngl file. Each reaction rule represents a reaction within the model and has a parameter (rate constant) associated with it (e.g., k1). Using the observed moments (i<sub>1</sub> panels) BioNetGMMFit uses PSO and GMM to estimate parameters of the model. (o<sub>1</sub>) and (o<sub>2</sub>) illustrate the results for a case where BioNetGMMFit performs 30 PSO estimates and produces a set of confidence intervals as well as a plot of the least GMM cost fit between the observed moments and predicted moments. The fit is performed with 4 protein means, 4 protein variances, and 6 protein covariances. Please note that the user is responsible for the consistency of units units in the input data since BioNetGMMFit uses the input value without ascribing about measurement units. For the CD8+ T-cell data used above, the input data were of the magnitude of fluorescence.</p></caption><graphic xlink:href="41540_2023_299_Fig12_HTML" id="d32e1080"/></fig></p>
      <p id="Par27">Once the model is defined, the hyperparameters configuration file supplies the PSO hyperparameters (i.e., the number of particles, steps, and PSO coefficients) used for parameter estimation. For more information on the configuration file, a table of parameters is provided in the documentation on the GitHub page and in the <xref rid="MOESM1" ref-type="media">Supplementary Material</xref>. To estimate parameters within the BioNetGen model, PSO minimizes the GMM-weighted square Euclidean distances of lower and higher-order moments between the observed and model-simulated data<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. Upon PSO convergence, estimates are provided, and confidence intervals are computed.</p>
      <p id="Par28">The plots of parameter estimates and moment fits provide additional insights into the fit of the mechanistic model. In Fig. <xref rid="Fig12" ref-type="fig">12</xref>, for example, the confidence intervals around the parameter estimates reveal the ranges of possible values for each model parameter and their relative magnitudes. The estimation shows that the rates of production of pCD3<italic>ζ</italic> and of pS6 induced by pErk are the two dominant signaling reactions that occur at the early times (1–2 min) when CD8+ T cells are stimulated. This result is consistent with related conclusions in ref. <sup><xref ref-type="bibr" rid="CR35">35</xref></sup> obtained using information theory. Nonetheless, models are imperfect, and their fits may be poor. To assess the model fit in such cases, we can refer to the “Fit of Predicted Moments” plot in Fig. <xref rid="Fig12" ref-type="fig">12</xref>. This plot shows that the estimated model fails to accurately fit one of the protein’s variances, as indicated by a variance dot biased below the perfect fit line, indicating that further modifications in the model are needed to better fit the data. Such moment plots are essential for evaluating the parameter estimation and model fits that may be difficult to observe with only mean or bulk abundance differences.</p>
      <p id="Par29">BioNetGMMFit is currently available as a docker image for ease of portability across different operating systems, a compilable executable for those requiring high-performance computing capabilities (<ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/7733865">https://zenodo.org/record/7733865</ext-link>), and as a web demo (<ext-link ext-link-type="uri" xlink:href="https://bngmm.nchigm.org/">https://bngmm.nchigm.org/</ext-link>). Further details on how to use and compile BioNetGMMFit are available on the GitHub page (<ext-link ext-link-type="uri" xlink:href="https://github.com/jhnwu3/BioNetGMMFit">https://github.com/jhnwu3/BioNetGMMFit</ext-link>), and a comprehensive tutorial on using BioNetGMMFit can be found in the <xref rid="MOESM1" ref-type="media">Supplementary Material</xref>.</p>
    </sec>
    <sec id="Sec15">
      <title>Reporting summary</title>
      <p id="Par30">Further information on research design is available in the <xref rid="MOESM2" ref-type="media">Nature Research Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec16">
      <title>Supplementary information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41540_2023_299_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Material - BioNetGMMFit</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41540_2023_299_MOESM2_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41540-023-00299-0.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>Special thanks to Dr. Jim Faeder, Dr. Ali Sinan, and Dr. Lucian Smith for their advice in the development of this software. This work is supported by the NIH awards R01-AI 143740 and R01-AI 146581 to J.D., and by the Research Institute at the Nationwide Children’s Hospital.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>Every author contributed to the writing and approval of this manuscript. J.W. and W.C.L.S. contributed to the software development and design of BioNetGMMFit.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The dataset(s) supporting the conclusions of this article is(are) available in the BioNetGMMFit/example repository [<ext-link ext-link-type="uri" xlink:href="https://github.com/jhnwu3/BioNetGMMFit/tree/main/example">https://github.com/jhnwu3/BioNetGMMFit/tree/main/example</ext-link>]. Project name: BioNetGMMFit; Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/jhnwu3/BioNetGMMFit">https://github.com/jhnwu3/BioNetGMMFit</ext-link>; Archived version: N/A; Operating system(s): Platform independent through Docker; Programming language: C/C++; Other requirements: Docker, if Compiling see GitHub; License: MIT License; Any restrictions to use by non-academics: N/A; Other Locations of Access: <ext-link ext-link-type="uri" xlink:href="https://hub.docker.com/repository/docker/jhnwu3/bngmm/general">https://hub.docker.com/repository/docker/jhnwu3/bngmm/general</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/7733865">https://zenodo.org/record/7733865</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://bngmm.nchigm.org/">https://bngmm.nchigm.org/</ext-link>. Experimental CD8+ T-cell data can be found at <ext-link ext-link-type="uri" xlink:href="https://dpeerlab.github.io/dpeerlab-website/dremi-data.html">https://dpeerlab.github.io/dpeerlab-website/dremi-data.html</ext-link>.</p>
  </notes>
  <notes id="FPar1" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par31">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Spitzer</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Nolan</surname>
            <given-names>GP</given-names>
          </name>
        </person-group>
        <article-title>Mass cytometry: single cells, many features</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>165</volume>
        <fpage>780</fpage>
        <lpage>791</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2016.04.019</pub-id>
        <?supplied-pmid 27153492?>
        <pub-id pub-id-type="pmid">27153492</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Papalexi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Single-cell rna sequencing to explore immune cell heterogeneity</article-title>
        <source>Nat. Rev. Immunol.</source>
        <year>2018</year>
        <volume>18</volume>
        <fpage>35</fpage>
        <lpage>45</lpage>
        <pub-id pub-id-type="doi">10.1038/nri.2017.76</pub-id>
        <?supplied-pmid 28787399?>
        <pub-id pub-id-type="pmid">28787399</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saeys</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Van Gassen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lambrecht</surname>
            <given-names>BN</given-names>
          </name>
        </person-group>
        <article-title>Computational flow cytometry: helping to make sense of high-dimensional immunology data</article-title>
        <source>Nat. Rev. Immunol.</source>
        <year>2016</year>
        <volume>16</volume>
        <fpage>449</fpage>
        <lpage>462</lpage>
        <pub-id pub-id-type="doi">10.1038/nri.2016.56</pub-id>
        <?supplied-pmid 27320317?>
        <pub-id pub-id-type="pmid">27320317</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hansen</surname>
            <given-names>LP</given-names>
          </name>
        </person-group>
        <article-title>Large sample properties of generalized method of moments estimators</article-title>
        <source>Econometrica</source>
        <year>1982</year>
        <volume>50</volume>
        <fpage>1029</fpage>
        <lpage>1054</lpage>
        <pub-id pub-id-type="doi">10.2307/1912775</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Hall, A. R. <italic>Generalized Method of Moments</italic> (OUP Oxford, Great Clarendon St, Oxford OX2 6DP, 2004).</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lück</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wolf</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Generalized method of moments for estimating parameters of stochastic reaction networks</article-title>
        <source>BMC Syst. Biol.</source>
        <year>2016</year>
        <volume>10</volume>
        <fpage>98</fpage>
        <pub-id pub-id-type="doi">10.1186/s12918-016-0342-8</pub-id>
        <?supplied-pmid 27769280?>
        <pub-id pub-id-type="pmid">27769280</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Wu, J., Stewart, W., Jayaprakash, C. &amp; Das, J. Generalized method of moments improves parameter estimation in biochemical signaling models of time-stamped single-cell snapshot data. Preprint at <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/early/2022/03/19/2022.03.17.484491">https://www.biorxiv.org/content/early/2022/03/19/2022.03.17.484491</ext-link> (2022).</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Ruder, S. An overview of gradient descent optimization algorithms. Preprint at <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1609.04747">https://arxiv.org/abs/1609.04747</ext-link> (2017).</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kirkpatrick</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gelatt</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Vecchi</surname>
            <given-names>MP</given-names>
          </name>
        </person-group>
        <article-title>Optimization by simulated annealing</article-title>
        <source>Science</source>
        <year>1983</year>
        <volume>220</volume>
        <fpage>671</fpage>
        <lpage>680</lpage>
        <pub-id pub-id-type="doi">10.1126/science.220.4598.671</pub-id>
        <?supplied-pmid 17813860?>
        <pub-id pub-id-type="pmid">17813860</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sambridge</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A Parallel Tempering algorithm for probabilistic sampling and multimodal optimization</article-title>
        <source>Geophys. J. Int.</source>
        <year>2013</year>
        <volume>196</volume>
        <fpage>357</fpage>
        <lpage>374</lpage>
        <pub-id pub-id-type="doi">10.1093/gji/ggt342</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thomas</surname>
            <given-names>BR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BioNetFit: a fitting tool compatible with BioNetGen, NFsim and distributed computing environments</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>32</volume>
        <fpage>798</fpage>
        <lpage>800</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv655</pub-id>
        <?supplied-pmid 26556387?>
        <pub-id pub-id-type="pmid">26556387</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Freitas, D., Lopes, L. G. &amp; Morgado-Dias, F. Particle swarm optimisation: a historical review up to the current developments. <italic>Entropy</italic><bold>22</bold>, 362 (2020).</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Poli</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kennedy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Blackwell</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Particle swarm optimization</article-title>
        <source>Swarm Intell.</source>
        <year>2007</year>
        <volume>1</volume>
        <fpage>33</fpage>
        <lpage>57</lpage>
        <pub-id pub-id-type="doi">10.1007/s11721-007-0002-0</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harris</surname>
            <given-names>LA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BioNetGen 2.2: advances in rule-based modeling</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>3366</fpage>
        <lpage>3368</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw469</pub-id>
        <?supplied-pmid 27402907?>
        <pub-id pub-id-type="pmid">27402907</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Somogyi</surname>
            <given-names>ET</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>libRoadRunner: a high performance SBML simulation and analysis library</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>3315</fpage>
        <lpage>3321</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv363</pub-id>
        <?supplied-pmid 26085503?>
        <pub-id pub-id-type="pmid">26085503</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goldstein</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Faeder</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Hlavacek</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Mathematical and computational models of immune-receptor signalling</article-title>
        <source>Nat. Rev. Immunol.</source>
        <year>2004</year>
        <volume>4</volume>
        <fpage>445</fpage>
        <lpage>456</lpage>
        <pub-id pub-id-type="doi">10.1038/nri1374</pub-id>
        <?supplied-pmid 15173833?>
        <pub-id pub-id-type="pmid">15173833</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loskot</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Atitey</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Mihaylova</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive review of models and methods for inferences in Bio-Chemical reaction networks</article-title>
        <source>Front. Genet.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>549</fpage>
        <pub-id pub-id-type="doi">10.3389/fgene.2019.00549</pub-id>
        <?supplied-pmid 31258548?>
        <pub-id pub-id-type="pmid">31258548</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mitra</surname>
            <given-names>ED</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pybionetfit and the biological property specification language</article-title>
        <source>iScience</source>
        <year>2019</year>
        <volume>19</volume>
        <fpage>1012</fpage>
        <lpage>1036</lpage>
        <pub-id pub-id-type="doi">10.1016/j.isci.2019.08.045</pub-id>
        <?supplied-pmid 31522114?>
        <pub-id pub-id-type="pmid">31522114</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>King</surname>
            <given-names>RD</given-names>
          </name>
        </person-group>
        <article-title>An investigation into the population abundance distribution of mRNAs, proteins, and metabolites in biological systems</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2020</fpage>
        <lpage>2027</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp360</pub-id>
        <?supplied-pmid 19535531?>
        <pub-id pub-id-type="pmid">19535531</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bengtsson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ståhlberg</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rorsman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kubista</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Gene expression profiling in single cells from the pancreatic islets of Langerhans reveals lognormal distribution of mRNA levels</article-title>
        <source>Genome Res.</source>
        <year>2005</year>
        <volume>15</volume>
        <fpage>1388</fpage>
        <lpage>1392</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.3820805</pub-id>
        <?supplied-pmid 16204192?>
        <pub-id pub-id-type="pmid">16204192</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lanier</surname>
            <given-names>LL</given-names>
          </name>
        </person-group>
        <article-title>Up on the tightrope: natural killer cell activation and inhibition</article-title>
        <source>Nat. Immunol.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>495</fpage>
        <lpage>502</lpage>
        <pub-id pub-id-type="doi">10.1038/ni1581</pub-id>
        <?supplied-pmid 18425106?>
        <pub-id pub-id-type="pmid">18425106</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McKeithan</surname>
            <given-names>TW</given-names>
          </name>
        </person-group>
        <article-title>Kinetic proofreading in t-cell receptor signal transduction</article-title>
        <source>Proc. Natl. Acad. Sci. USA</source>
        <year>1995</year>
        <volume>92</volume>
        <fpage>5042</fpage>
        <lpage>5046</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.92.11.5042</pub-id>
        <?supplied-pmid 7761445?>
        <pub-id pub-id-type="pmid">7761445</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hao</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>O’Shea</surname>
            <given-names>EK</given-names>
          </name>
        </person-group>
        <article-title>Signal-dependent dynamics of transcription factor translocation controls gene expression</article-title>
        <source>Nat. Struct. Mol. Biol.</source>
        <year>2012</year>
        <volume>19</volume>
        <fpage>31</fpage>
        <lpage>39</lpage>
        <pub-id pub-id-type="doi">10.1038/nsmb.2192</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Das</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Activation or tolerance of natural killer cells is modulated by ligand quality in a nonmonotonic manner</article-title>
        <source>Biophys. J.</source>
        <year>2010</year>
        <volume>99</volume>
        <fpage>2028</fpage>
        <lpage>2037</lpage>
        <pub-id pub-id-type="doi">10.1016/j.bpj.2010.07.061</pub-id>
        <?supplied-pmid 20923636?>
        <pub-id pub-id-type="pmid">20923636</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goldbeter</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Koshland</surname>
            <given-names>DE</given-names>
          </name>
        </person-group>
        <article-title>An amplified sensitivity arising from covalent modification in biological systems</article-title>
        <source>Proc. Natl. Acad. Sci. USA</source>
        <year>1981</year>
        <volume>78</volume>
        <fpage>6840</fpage>
        <lpage>6844</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.78.11.6840</pub-id>
        <?supplied-pmid 6947258?>
        <pub-id pub-id-type="pmid">6947258</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Transtrum</surname>
            <given-names>MK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Perspective: Sloppiness and emergent theories in physics, biology, and beyond</article-title>
        <source>J. Chem. Phys.</source>
        <year>2015</year>
        <volume>143</volume>
        <fpage>010901</fpage>
        <pub-id pub-id-type="doi">10.1063/1.4923066</pub-id>
        <?supplied-pmid 26156455?>
        <pub-id pub-id-type="pmid">26156455</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eydgahi</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Properties of cell death models calibrated and compared using Bayesian approaches</article-title>
        <source>Mol. Syst. Biol.</source>
        <year>2013</year>
        <volume>9</volume>
        <fpage>644</fpage>
        <pub-id pub-id-type="doi">10.1038/msb.2012.69</pub-id>
        <?supplied-pmid 23385484?>
        <pub-id pub-id-type="pmid">23385484</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Liu, B. &amp; Faeder, J. R. Parameter estimation of rule-based models using statistical model checking. 2016 IEEE International Conference on Bioinformatics and Biomedicine. 1453–1459 (2016).</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoops</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>COPASI—a complex pathway simulator</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>3067</fpage>
        <lpage>3074</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl485</pub-id>
        <?supplied-pmid 17032683?>
        <pub-id pub-id-type="pmid">17032683</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmiester</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PEtab—interoperable specification of parameter estimation problems in systems biology</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2021</year>
        <volume>17</volume>
        <fpage>e1008646</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1008646</pub-id>
        <?supplied-pmid 33497393?>
        <pub-id pub-id-type="pmid">33497393</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sneddon</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Faeder</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Emonet</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Efficient modeling, simulation and coarse-graining of biological complexity with NFsim</article-title>
        <source>Nat. Methods</source>
        <year>2011</year>
        <volume>8</volume>
        <fpage>177</fpage>
        <lpage>183</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1546</pub-id>
        <?supplied-pmid 21186362?>
        <pub-id pub-id-type="pmid">21186362</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grewal</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Das</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Spatially resolved in silico modeling of nkg2d signaling kinetics suggests a key role of nkg2d and vav1 co-clustering in generating natural killer cell activation</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2022</year>
        <volume>18</volume>
        <fpage>1</fpage>
        <lpage>33</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1010114</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Konstorum</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vella</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Adler</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Laubenbacher</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>Addressing current challenges in cancer immunotherapy with mathematical and computational modelling</article-title>
        <source>J. R. Soc. Interface</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>20170150</fpage>
        <pub-id pub-id-type="doi">10.1098/rsif.2017.0150</pub-id>
        <?supplied-pmid 28659410?>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Papoutsoglou</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Challenges in the multivariate analysis of mass cytometry data: the effect of randomization</article-title>
        <source>Cytometry A</source>
        <year>2019</year>
        <volume>95</volume>
        <fpage>1178</fpage>
        <lpage>1190</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.23908</pub-id>
        <?supplied-pmid 31692248?>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krishnaswamy</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Conditional density-based analysis of T cell signaling in single-cell data</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>346</volume>
        <fpage>1250689</fpage>
        <pub-id pub-id-type="doi">10.1126/science.1250689</pub-id>
        <?supplied-pmid 25342659?>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lopez</surname>
            <given-names>CF</given-names>
          </name>
          <name>
            <surname>Muhlich</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Bachman</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Sorger</surname>
            <given-names>PK</given-names>
          </name>
        </person-group>
        <article-title>Programming biological models in python using PySB</article-title>
        <source>Mol. Syst. Biol.</source>
        <year>2013</year>
        <volume>9</volume>
        <fpage>646</fpage>
        <pub-id pub-id-type="doi">10.1038/msb.2013.1</pub-id>
        <?supplied-pmid 23423320?>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fröhlich</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>AMICI: high-performance sensitivity analysis for large ordinary differential equation models</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>37</volume>
        <fpage>3676</fpage>
        <lpage>3677</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btab227</pub-id>
        <?supplied-pmid 33821950?>
      </element-citation>
    </ref>
  </ref-list>
</back>
