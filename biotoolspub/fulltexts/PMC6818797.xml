<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput. Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">ploscomp</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6818797</article-id>
    <article-id pub-id-type="pmid">31622328</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007411</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-19-00688</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Alignment</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Macromolecular Structure Analysis</subject>
            <subj-group>
              <subject>Protein Structure</subject>
              <subj-group>
                <subject>Protein Structure Comparison</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Proteins</subject>
            <subj-group>
              <subject>Protein Structure</subject>
              <subj-group>
                <subject>Protein Structure Comparison</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Algebra</subject>
            <subj-group>
              <subject>Linear Algebra</subject>
              <subj-group>
                <subject>Eigenvectors</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Computational Techniques</subject>
          <subj-group>
            <subject>Split-Decomposition Method</subject>
            <subj-group>
              <subject>Multiple Alignment Calculation</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Macromolecular Structure Analysis</subject>
            <subj-group>
              <subject>Protein Structure</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Proteins</subject>
            <subj-group>
              <subject>Protein Structure</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Macromolecular Structure Analysis</subject>
            <subj-group>
              <subject>Protein Structure</subject>
              <subj-group>
                <subject>Protein Structure Prediction</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Proteins</subject>
            <subj-group>
              <subject>Protein Structure</subject>
              <subj-group>
                <subject>Protein Structure Prediction</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Biological Databases</subject>
            <subj-group>
              <subject>Protein Structure Databases</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Macromolecular Structure Analysis</subject>
            <subj-group>
              <subject>Protein Structure</subject>
              <subj-group>
                <subject>Protein Structure Databases</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Proteins</subject>
            <subj-group>
              <subject>Protein Structure</subject>
              <subj-group>
                <subject>Protein Structure Databases</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Algebra</subject>
            <subj-group>
              <subject>Linear Algebra</subject>
              <subj-group>
                <subject>Eigenvalues</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Detecting distant-homology protein structures by aligning deep neural-network based contact maps</article-title>
      <alt-title alt-title-type="running-head">Fold-recognition through contact map alignments</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2984-9003</contrib-id>
        <name>
          <surname>Zheng</surname>
          <given-names>Wei</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wuyun</surname>
          <given-names>Qiqige</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Yang</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3432-1497</contrib-id>
        <name>
          <surname>Mortuza</surname>
          <given-names>S. M.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-7290-1324</contrib-id>
        <name>
          <surname>Zhang</surname>
          <given-names>Chengxin</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-6402-734X</contrib-id>
        <name>
          <surname>Pearce</surname>
          <given-names>Robin</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ruan</surname>
          <given-names>Jishou</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2739-1916</contrib-id>
        <name>
          <surname>Zhang</surname>
          <given-names>Yang</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff005">
          <sup>5</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Computational Medicine and Bioinformatics, University of Michigan, Ann Arbor, MI, United States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>College of Mathematical Sciences and LPMC, Nankai University, Tianjin, PR China</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Computer Science and Engineering Department, Michigan State University, East Lansing, MI, United States of America</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>State Key Laboratory of Medicinal Chemical Biology, Nankai University, Tianjin, PR China</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Department of Biological Chemistry, University of Michigan, Ann Arbor, MI, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Deane</surname>
          <given-names>Charlotte M</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Oxford, UNITED KINGDOM</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>zhng@umich.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <volume>15</volume>
    <issue>10</issue>
    <elocation-id>e1007411</elocation-id>
    <history>
      <date date-type="received">
        <day>2</day>
        <month>5</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>9</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2019 Zheng et al</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Zheng et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1007411.pdf"/>
    <abstract>
      <p>Accurate prediction of atomic-level protein structure is important for annotating the biological functions of protein molecules and for designing new compounds to regulate the functions. Template-based modeling (TBM), which aims to construct structural models by copying and refining the structural frameworks of other known proteins, remains the most accurate method for protein structure prediction. Due to the difficulty in recognizing distant-homology templates, however, the accuracy of TBM decreases rapidly when the evolutionary relationship between the query and template vanishes. In this study, we propose a new method, CEthreader, which first predicts residue-residue contacts by coupling evolutionary precision matrices with deep residual convolutional neural-networks. The predicted contact maps are then integrated with sequence profile alignments to recognize structural templates from the PDB. The method was tested on two independent benchmark sets consisting collectively of 1,153 non-homologous protein targets, where CEthreader detected 176% or 36% more correct templates with a TM-score &gt;0.5 than the best state-of-the-art profile- or contact-based threading methods, respectively, for the Hard targets that lacked homologous templates. Moreover, CEthreader was able to identify 114% or 20% more correct templates with the same Fold as the query, after excluding structures from the same SCOPe Superfamily, than the best profile- or contact-based threading methods. Detailed analyses show that the major advantage of CEthreader lies in the efficient coupling of contact maps with profile alignments, which helps recognize global fold of protein structures when the homologous relationship between the query and template is weak. These results demonstrate an efficient new strategy to combine <italic>ab initio</italic> contact map prediction with profile alignments to significantly improve the accuracy of template-based structure prediction, especially for distant-homology proteins.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Despite decades of effort in computational method development, template-based modeling (TBM) still remains the most reliable approach to high-resolution protein structure prediction. Previous studies have shown that the PDB library is complete for single-domain proteins and TBM is in principle sufficient to solve the structure prediction problem if the most similar structure in the PDB could be reliably identified and used as template for model reconstruction. But in reality, the success of TBM depends on the availability of closely-homologous templates, where its accuracy and reliability decrease sharply when the evolutionary relationship between query and template becomes more distant. We developed a new threading approach, CEthreader, which allows for dynamic programing alignments of predicted contact-maps through eigen-decomposition. The large-scale benchmark tests show that the coupling of contact map with profile and secondary structure alignments through the proposed protocol can significantly improve the accuracy of template recognition for distantly-homologous protein targets.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution>National Institute of General Medical Sciences</institution>
        </funding-source>
        <award-id>GM083107</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2739-1916</contrib-id>
          <name>
            <surname>Zhang</surname>
            <given-names>Yang</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution>National Institute of General Medical Sciences</institution>
        </funding-source>
        <award-id>GM116960</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2739-1916</contrib-id>
          <name>
            <surname>Zhang</surname>
            <given-names>Yang</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution>National Institute of Allergy and Infectious Diseases</institution>
        </funding-source>
        <award-id>AI134678</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2739-1916</contrib-id>
          <name>
            <surname>Zhang</surname>
            <given-names>Yang</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution>National Science Foundation</institution>
        </funding-source>
        <award-id>DBI1564756</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2739-1916</contrib-id>
          <name>
            <surname>Zhang</surname>
            <given-names>Yang</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>The work was supported in part by the National Institute of General Medical Sciences [GM083107, GM116960 to Y.Z.], National Institute of Allergy and Infectious Diseases [AI134678 to Y.Z.], and the National Science Foundation [DBI1564756, IIS1901191 to Y.Z.]. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="6"/>
      <table-count count="2"/>
      <page-count count="27"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2019-10-29</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All relevant data are within the manuscript and its Supporting Information files.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All relevant data are within the manuscript and its Supporting Information files.</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic>PLoS Computational Biology</italic> Methods paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Given the rapidly increasing gap between the number of known protein sequences and the number of known structures, the demand for high-resolution, computer-based protein structure prediction has risen dramatically [<xref rid="pcbi.1007411.ref001" ref-type="bibr">1</xref>,<xref rid="pcbi.1007411.ref002" ref-type="bibr">2</xref>]. While various advanced approaches have been proposed over the last few decades [<xref rid="pcbi.1007411.ref003" ref-type="bibr">3</xref>–<xref rid="pcbi.1007411.ref008" ref-type="bibr">8</xref>], template-based modeling (TBM), which is designed to construct structural models using templates of similar folds collected from the Protein Data Bank (PDB), remains still the most accurate and reliable protein structure prediction method [<xref rid="pcbi.1007411.ref009" ref-type="bibr">9</xref>,<xref rid="pcbi.1007411.ref010" ref-type="bibr">10</xref>]. The core procedure in TBM is the identification of correct templates, where the accuracy of template recognition and alignment essentially determines the accuracy of the final TBM models. In an effort to recognize structure templates that have similar folds to the query, a variety of threading methods with different alignment scores and searching schemes have been developed in order to match the query sequence and template structures [<xref rid="pcbi.1007411.ref008" ref-type="bibr">8</xref>,<xref rid="pcbi.1007411.ref011" ref-type="bibr">11</xref>–<xref rid="pcbi.1007411.ref014" ref-type="bibr">14</xref>]. The success of these methods is, however, often limited to the targets that have closely-homologous templates in the PDB. When the evolutionary relationship between the query and template is more distant, typically when the sequence identity is below 30% [<xref rid="pcbi.1007411.ref015" ref-type="bibr">15</xref>], the query-template alignment accuracy sharply declines. Thus, although there is evidence that the PDB library is complete and sufficient to solve the protein structure prediction problem [<xref rid="pcbi.1007411.ref016" ref-type="bibr">16</xref>], modeling of distantly-homologous proteins using TBM remains a major challenge in the field.</p>
    <p>Recently, sequence-based contact prediction between residue pairs using co-evolution [<xref rid="pcbi.1007411.ref017" ref-type="bibr">17</xref>–<xref rid="pcbi.1007411.ref020" ref-type="bibr">20</xref>] and machine learning [<xref rid="pcbi.1007411.ref021" ref-type="bibr">21</xref>–<xref rid="pcbi.1007411.ref025" ref-type="bibr">25</xref>] has shown considerable promise for improving the modeling accuracy of distantly- and non-homologous proteins. The major advantage associated with contact-based modeling of protein structures is that correct contact maps, even those with a small fraction of coverage, can significantly reduce the conformational space needed to be searched during the folding simulations, while helping identify the global folds of proteins with complicated topologies. However, the contact map information cannot be directly used in threading, since the query-template alignments in most threading methods are built on dynamic programming or hidden Markov models that require single-body potentials, while contact map information is inherently two-body.</p>
    <p>Several efforts have been previously made to incorporate pair-wise contacts into dynamic programming and subsequent threading alignments [<xref rid="pcbi.1007411.ref012" ref-type="bibr">12</xref>,<xref rid="pcbi.1007411.ref013" ref-type="bibr">13</xref>,<xref rid="pcbi.1007411.ref026" ref-type="bibr">26</xref>,<xref rid="pcbi.1007411.ref027" ref-type="bibr">27</xref>]. For instance, PROSPECT introduced a contact term, associated with a uniform background probability, into its scoring function. Due to the lack of specificity, however, the contact potential utilized in this method is fairly noisy and the improvement from contacts is limited. Additionally, the method uses a Divide-and-Conquer algorithm for the alignment searching procedure that is computationally expensive. Another early attempt is PROSPECTOR [<xref rid="pcbi.1007411.ref012" ref-type="bibr">12</xref>,<xref rid="pcbi.1007411.ref026" ref-type="bibr">26</xref>], which uses a “partly-thawed” approach that evaluates the contact potential based on the previous rounds of alignment iterations; the solutions obtained by this method are, however, not exact. In a recent effort, map_align [<xref rid="pcbi.1007411.ref027" ref-type="bibr">27</xref>] proposed an iterative double dynamic programming algorithm that aligns contact maps. Nevertheless, this program cannot provide exact solutions as the results rely on the initial estimation of the similarity matrix, which is not always optimal.</p>
    <p>Since direct alignment of contact maps is challenging, several other attempts [<xref rid="pcbi.1007411.ref028" ref-type="bibr">28</xref>–<xref rid="pcbi.1007411.ref033" ref-type="bibr">33</xref>] have been made to solve the contact map alignment problem using the eigen-decomposition strategy. For example, inspired by a previous study by Galaktionov and Marshalland [<xref rid="pcbi.1007411.ref034" ref-type="bibr">34</xref>], EIGAs [<xref rid="pcbi.1007411.ref028" ref-type="bibr">28</xref>] performs eigen-decomposition of a protein’s contact map, with each residue of the protein assigned one of the eigenvalues which has the closest angle between the corresponding eigenvector and that residue. Here, the angle is related to the coordinates of the eigenvector. The contact map of two structures can then be aligned by dynamic programming, where the alignment score for aligning a pair of residues is the absolute difference between the two eigenvalues associated with the two residues. While the neglect of the eigenvectors by this method allows for fast structure alignment, it can lead to suboptimal alignment accuracy. Therefore, an extended version, EIGA [<xref rid="pcbi.1007411.ref029" ref-type="bibr">29</xref>], was proposed based on the spectral methodology that starts from the initial alignment output by EIGAs. The alignment is then iteratively refined by multiple rounds of dynamic programming. In each iteration, the protein pair is aligned based on the eigenvalue-weighted eigenvector elements assigned to the residues, and the alignment is then used to update the assignment of the residue’s eigenvalue-weighted eigenvector element. Although EIGA utilizes more information than EIGAs in order to obtain more accurate alignments, it heavily relies on the quality of the initial alignments generated by EIGAs. SABERTOOTH [<xref rid="pcbi.1007411.ref030" ref-type="bibr">30</xref>] is another protein structural alignment method based on the first principal eigenvector of the contact matrix. Since this method only uses one-dimension of the contact eigenvector, which may result in much of the information encoded in a contact map being lost, the alignment accuracy can be poor. Similarly, Al-Eigen [<xref rid="pcbi.1007411.ref031" ref-type="bibr">31</xref>] approximates contact maps by using the top eigenvectors generated by eigen-decomposition, and determines the similarity between two contact maps by global alignment of the principal eigenvectors. While all of these methods show promise for structure alignment guided by eigen-decomposed contact maps, they cannot be directly used for threading, where the native contact map of the query protein is unknown.</p>
    <p>Recently, some methodologies have been extended specifically for threading. For instance, SABERTOOTH [<xref rid="pcbi.1007411.ref032" ref-type="bibr">32</xref>] was extended for sequence alignment, where the principal eigenvector of a protein is predicted by a neural-network whose input feature is the Position-Specific Scoring Matrix (PSSM) generated by PSI-BLAST [<xref rid="pcbi.1007411.ref035" ref-type="bibr">35</xref>], with the alignment approach identical to the former version of SABERTOOTH. More recently, EigenTHREADER [<xref rid="pcbi.1007411.ref033" ref-type="bibr">33</xref>] was developed to extend Al-Eigen to enable threading by predicting a protein’s contact map starting from its sequence, and then searching a library composed of contact maps for known structures. While these methods can perform threading based on predicted contact maps, they do not consider other linear features such as sequence profiles and secondary structure information, which can be used to further improve the alignment accuracy.</p>
    <p>In this study, we propose a new contact-based threading method, called CEthreader (Contact Eigenvector-based threader), which first creates contact map predictions using deep residual neural-network training. The contact map matrix is then represented by the cross product of single-body eigenvectors through the eigen-decomposition technique, following the idea of Al-Eigen [<xref rid="pcbi.1007411.ref031" ref-type="bibr">31</xref>]. Finally, extensive contact-based alignment searching, built on a newly developed dot-product scoring function used to align contact eigenvectors, is performed through dynamic programming. In addition to the contact maps, multiple inherent features, including secondary structure prediction and sequence profiles, are incorporated to further enhance the alignment accuracy (see the flowchart in <bold><xref ref-type="fig" rid="pcbi.1007411.g001">Fig 1</xref></bold>). Multiple large-scale benchmark tests were conducted to carefully examine the strengths, weaknesses and potential of the new contact-based threading approach. Comparison of CEthreader to start-of-the-art contact- and profile-based threading algorithms and pure contact- or template-guided folding approaches demonstrated the significant advantages associated with using our composite contact and profile-guided threading approach for distant-homology fold-recognition and modeling. The CEthreader online server and standalone package are freely available at <ext-link ext-link-type="uri" xlink:href="https://zhanglab.ccmb.med.umich.edu/CEthreader">https://zhanglab.ccmb.med.umich.edu/CEthreader</ext-link>.</p>
    <fig id="pcbi.1007411.g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pcbi.1007411.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <title>CEthreader flowchart.</title>
        <p>The pipeline consists of four major steps: contact map prediction, contact matrix eigen-decomposition, database searching and contact score-guided template selection.</p>
      </caption>
      <graphic xlink:href="pcbi.1007411.g001"/>
    </fig>
  </sec>
  <sec sec-type="results" id="sec002">
    <title>Results</title>
    <sec id="sec003">
      <title>Construction of the template library and benchmark datasets</title>
      <p>Two libraries of non-redundant protein structure templates were collected to test CEthreader. The first was taken from the I-TASSER threading template library [<xref rid="pcbi.1007411.ref005" ref-type="bibr">5</xref>], which consists of 51,376 single-domain structures with a sequence identity cutoff of 70% (see <ext-link ext-link-type="uri" xlink:href="https://zhanglab.ccmb.med.umich.edu/library/">https://zhanglab.ccmb.med.umich.edu/library/</ext-link>). The second library was collected from SCOPe [<xref rid="pcbi.1007411.ref036" ref-type="bibr">36</xref>], which consists of 23,000 single-domain structures after filtering the redundant entries at the 95% sequence identity cutoff.</p>
      <p>The threading methods were examined using two benchmark protein sets. The first (Set-I) consisted of 614 non-redundant protein domains taken from the PDB that satisfied the following criteria: (<italic>i</italic>) pair-wise sequence identity is &lt;30% to any other selected protein in Set-I; (<italic>ii</italic>) each protein had at least one template with a TM-score &gt;0.5 as identified by TM-align [<xref rid="pcbi.1007411.ref037" ref-type="bibr">37</xref>] structural alignment search through the I-TASSER template library [<xref rid="pcbi.1007411.ref005" ref-type="bibr">5</xref>]. Based on LOMETS [<xref rid="pcbi.1007411.ref038" ref-type="bibr">38</xref>], which categorizes proteins as Easy or Hard threading targets depending on the significance scores of multiple threading programs, this dataset contained 403 Easy targets (for which at least one program in LOMETS had a significant template hit) and 211 Hard targets (for which no program in LOMETS had a significant hit).</p>
      <p>The second benchmark set (Set-II) was taken from the SCOPe database and constructed in two steps. First, we retrieved 5,497 structures from the SCOPe that satisfied the following requirements: (<italic>i</italic>) pair-wise sequence identity is &lt;95% to any other selected protein in Set-II; (<italic>ii</italic>) structure came from a Fold group that contained at least two Superfamilies. Next, we randomly selected one representative target from each Superfamily, which resulted in 539 targets from 116 Fold groups. Based on LOMETS, this set contained 379 Easy and 160 Hard targets.</p>
      <p>In both datasets, any protein that shared the same Superfamily with or had a sequence identity &gt;30% to the CEthreader training proteins was excluded. In addition, proteins that had a sequence identity &gt;40% to any protein in the ResPRE training set were excluded from both datasets. This slightly relaxed sequence identity cutoff to the ResPRE training set is mainly due to the fact that the ResPRE training set is large, including about 5,600 high-resolution protein structures in order to facilitate effective deep learning training, and the use of the same cutoff of 30% could result in an insufficient number of threadable structures in both benchmark datasets. For example, there were 614 protein targets in Benchmark Set-I when using a 40% sequence identity cutoff; however, using a 30% sequence identity cutoff would have reduced the number of targets in Benchmark Set-I to 239.</p>
    </sec>
    <sec id="sec004">
      <title>Benchmark test on CEthreader</title>
      <p>CEthreader was first tested on the 614 proteins in Benchmark Set-I, each of which was threaded through the I-TASSER template library, where any homologous templates with a sequence identity &gt;30% to the query were excluded.</p>
      <sec id="sec005">
        <title>Effect of component scores on CEthreader alignment</title>
        <p>While sequence profile information derived from multiple sequence alignments (MSAs) for query and template proteins has been effectively used to detect homologous templates in many threading methods [<xref rid="pcbi.1007411.ref008" ref-type="bibr">8</xref>,<xref rid="pcbi.1007411.ref014" ref-type="bibr">14</xref>], it is often less effective for proteins that lack templates with closely-homologous sequences. Here, we explore the possibility of using contact map information (<italic>S</italic><sub><italic>cm</italic></sub> in <bold><xref ref-type="disp-formula" rid="pcbi.1007411.e007">Eq 5</xref></bold>in <bold>METHODS</bold>) to enhance the ability to recognize distant-homology templates. To examine the impact of the different components of the CEthreader scoring function on the accuracy of template identification, we list in <bold><xref ref-type="fig" rid="pcbi.1007411.g002">Fig 2A</xref></bold> the average TM-scores of the first templates identified by using <italic>S</italic><sub><italic>cm</italic></sub> (contact map information only), <italic>S</italic><sub><italic>ss</italic>+<italic>prof</italic></sub> (profile and secondary structure information), or <italic>S</italic><sub><italic>cm</italic>+<italic>ss</italic>+<italic>prof</italic></sub> as the scoring function. First, the data show that contact-based threading using <italic>S</italic><sub><italic>cm</italic></sub> alone can identify better quality templates for Hard targets than traditional profile and secondary structure-based alignments, where the average first template TM-score for <italic>S</italic><sub><italic>cm</italic></sub> was 0.439 and 71 out of the 211 Hard targets had templates with TM-scores &gt;0.5, as compared to an average first template TM-score of 0.284 and 19 targets with correctly identified templates for <italic>S</italic><sub><italic>ss</italic>+<italic>prof</italic></sub> (see more TM-score and RMSD comparisons in <bold><xref ref-type="supplementary-material" rid="pcbi.1007411.s006">S1 Table</xref></bold>). The poor performance by the latter method can be attributed to the fact that profile-profile alignments rely on the evolutionary relationship between the query and templates, which is much less accurate here as homologous templates have been excluded; meanwhile, the number of homologous sequences is low for the Hard targets (~227, on average) which further reduces the reliability of the profile-based alignments. On the other hand, ResPRE [<xref rid="pcbi.1007411.ref039" ref-type="bibr">39</xref>], a deep-learning-based contact map predictor (see <bold><xref ref-type="sec" rid="sec014">METHODS</xref></bold>), can generate contact predictions with reasonable accuracy even for targets with few homologous sequences, thus helping capture the global structural similarity between the query and templates in the absence of a reliable profile match.</p>
        <fig id="pcbi.1007411.g002" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1007411.g002</object-id>
          <label>Fig 2</label>
          <caption>
            <title>Performance of CEtheader on Benchmark Set-I, which was collected from the I-TASSER database.</title>
            <p>TM-score and <italic>N</italic><sub><italic>st</italic></sub> (number of targets with first template TM-scores &gt;0.5) histograms for CEthreader using three different scoring functions on the 211 Hard targets (A) and 403 Easy targets (B). (C) The TM-score of the first template identified by CEthreader as a function of the logarithm of the MSA <italic>Neff</italic> value, where three scoring functions- <italic>S</italic><sub><italic>ss</italic>+<italic>prof</italic></sub> (green points), <italic>S</italic><sub><italic>cm</italic></sub> (blue points) and <italic>S</italic><sub><italic>cm+ss</italic>+<italic>prof</italic></sub> (red points)- were used by CEthreader. Linear regression was used to fit the correlation relationship between TM-score and MSA <italic>Neff</italic> value for the three scoring functions, where the fitted relationships for <italic>S</italic><sub><italic>ss</italic>+<italic>prof</italic></sub> (green line), <italic>S</italic><sub><italic>cm</italic></sub> (blue line) and <italic>S</italic><sub><italic>cm+ss</italic>+<italic>prof</italic></sub> (red line) are y = 0.242+0.042x, y = 0.317+0.039x, and y = 0.361+0.036x, respectively.</p>
          </caption>
          <graphic xlink:href="pcbi.1007411.g002"/>
        </fig>
        <p>When the <italic>S</italic><sub><italic>cm</italic>+<italic>ss</italic>+<italic>prof</italic></sub> score was used, the average TM-score of the first identified templates increased to 0.453, which was 3.2% (or 59.5%) higher than that obtained by contact-based threading using <italic>S</italic><sub><italic>cm</italic></sub> (or profile and secondary structure-based threading using <italic>S</italic><sub><italic>ss</italic>+<italic>prof</italic></sub>), with a <italic>p</italic>-value of 2.3E-03 (or 7.8E-30) calculated using the Wilcoxon signed-rank test. Accordingly, the number of targets whose templates were correctly identified (TM-score &gt;0.5) using <italic>S</italic><sub><italic>cm+ss</italic>+<italic>prof</italic></sub> was 80, which was higher than the number identified by either individual scoring function <italic>S</italic><sub><italic>cm</italic></sub> (71) or <italic>S</italic><sub><italic>ss</italic>+<italic>prof</italic></sub> (19). The data suggest that the combined scoring function helps to accurately align the query proteins to their templates and to identify correct templates more effectively than the scoring functions that were solely based on contact or profile and secondary structure information alone.</p>
        <p>In <bold><xref ref-type="fig" rid="pcbi.1007411.g002">Fig 2B</xref></bold>, we also list the threading results for the 403 Easy targets that had homologous templates in the PDB. Although profile alignments have been proven to be highly efficient at detecting closely-homologous templates, the results show that contact map information can still help enhance the alignment accuracy for the selected Easy targets. This is demonstrated by the fact that the average TM-score of the first templates identified by CEthreader using <italic>S</italic><sub><italic>cm</italic>+<italic>ss</italic>+<italic>prof</italic></sub> (0.687) was about 4.7% higher than the corresponding templates detected using <italic>S</italic><sub><italic>ss</italic>+<italic>prof</italic></sub> (0.656) with a <italic>p</italic>-value of 1.1E-15, where the number of targets whose templates were correctly identified by the former (365) was also higher than the latter (347). When considering each of the 614 test targets together, the average TM-score of the first templates detected by <italic>S</italic><sub><italic>cm</italic>+<italic>ss</italic>+<italic>prof</italic></sub> (0.607) was 15% higher than the average TM-score of the first templates identified by <italic>S</italic><sub><italic>ss</italic>+<italic>prof</italic></sub> (0.528), which corresponds to a <italic>p</italic>-value of 2.1E-45; these data suggest that CEthreader can significantly improve the alignment accuracy and the number of correctly identified templates for both Hard and Easy targets.</p>
        <p>Here, it is worthy of noting that the performance of our <italic>S</italic><sub><italic>ss</italic>+<italic>prof</italic></sub> score was slightly worse than that of the state-of-the-art secondary structure and profile-based method, HHsearch [<xref rid="pcbi.1007411.ref008" ref-type="bibr">8</xref>], for both Hard (TM-score = 0.284 vs TM-score = 0.314) and Easy targets (TM-score = 0.656 vs TM-score = 0.682, see more comparisons with other programs in <bold><xref ref-type="supplementary-material" rid="pcbi.1007411.s007">S2 Table</xref></bold>, which will be discussed later, where our <italic>S</italic><sub><italic>ss</italic>+<italic>prof</italic></sub> score is called PPA). Even though the non-contact-based components (secondary structure and profile matching) do not produce as accurate results as HHsearch, the performance of the full CEthreader algorithm, which couples the non-contact-based components (secondary structure and profile matching) with the contact-based component (contact eigenvector matching), is significantly better than all other methods, underscoring the importance of contact information to the CEthreader method (<bold><xref ref-type="supplementary-material" rid="pcbi.1007411.s007">S2 Table</xref></bold>).</p>
        <p>In <bold><xref ref-type="fig" rid="pcbi.1007411.g002">Fig 2C</xref></bold>, we further examined the effective number of homologous sequences, <italic>Neff</italic> (defined in <bold>Eq. S1</bold> in <bold><xref ref-type="supplementary-material" rid="pcbi.1007411.s001">S1 Text</xref></bold>), which is required for each scoring function to identify good templates with TM-scores &gt;0.5. The figure lists the TM-scores of the first templates identified by CEthreader using different scoring functions (<italic>S</italic><sub><italic>ss</italic>+<italic>prof</italic></sub>, <italic>S</italic><sub><italic>cm</italic></sub> and <italic>S</italic><sub><italic>cm</italic>+<italic>ss</italic>+<italic>prof</italic></sub>) versus the logarithm of the MSA <italic>Neff</italic> values. Despite the large variations, we use linear regression to fit the correlation relationship between the template TM-score and the logarithm of the <italic>Neff</italic> value for the three scoring functions. The intersection points between the fitted lines and the TM-score = 0.5 horizontal line can be considered as an approximate cutoff to determine what <italic>Neff</italic> values are required for each scoring function to identify good templates. It was found that threading with the <italic>S</italic><sub><italic>ss</italic>+<italic>prof</italic></sub> scoring function has the highest dependency on the MSA <italic>Neff</italic> value with a cutoff of 2<sup>6.14</sup> (≈64), which means that on average the <italic>S</italic><sub><italic>ss</italic>+<italic>prof</italic></sub> scoring function may detect good templates only when the <italic>Neff</italic> is &gt;64. On the other hand, the <italic>S</italic><sub><italic>cm</italic></sub> scoring function, which only uses contact information to guide the threading alignments, has a relaxed <italic>Neff</italic> cutoff of 2<sup>4.69</sup>. The combination of both scores, <italic>S</italic><sub><italic>cm</italic>+<italic>ss</italic>+<italic>prof</italic></sub>, has the widest applicability since it can identify good templates for targets with the lowest <italic>Neff</italic> values (only &gt;2<sup>3.86</sup>). These data suggest that CEthreader has the ability to identify good templates for targets whose MSAs have relatively few effective sequences, thereby extending the applicability and usefulness of CEthreader, especially for Hard targets.</p>
      </sec>
      <sec id="sec006">
        <title>Why does the combination of contacts with profile and secondary structure work?</title>
        <p>To examine the effectiveness and rational of the combined scoring function for fold-recognition, we present in <bold><xref ref-type="fig" rid="pcbi.1007411.g003">Fig 3A</xref></bold> a Venn diagram of fold-recognition results using the three scoring functions, <italic>S</italic><sub><italic>cm</italic></sub>, <italic>S</italic><sub><italic>ss</italic>+<italic>prof</italic></sub> and <italic>S</italic><sub><italic>cm</italic>+<italic>ss</italic>+<italic>prof</italic></sub>, on the selected Hard targets. We found that the 80 targets whose templates were correctly detected by <italic>S</italic><sub><italic>cm</italic>+<italic>ss</italic>+<italic>prof</italic></sub> with a TM-score &gt;0.5 were not a simple overlap of the 71 targets found using <italic>S</italic><sub><italic>cm</italic></sub> and the 19 targets found using <italic>S</italic><sub><italic>ss</italic>+<italic>prof</italic></sub>. Instead, the composite scoring function helped detect correct templates for 21 new targets that were not identified using either contact or profile and secondary structure-based threading search alone.</p>
        <fig id="pcbi.1007411.g003" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1007411.g003</object-id>
          <label>Fig 3</label>
          <caption>
            <title>Performance of CEtheader on the 211 Hard targets in Benchmark Set-I from the I-TASSER database.</title>
            <p>(A) Venn diagram for the number of targets with first template TM-scores &gt;0.5 using different scoring functions. (B) Overlay of the CEthreader template (left panel) and MODELLER models (right panel) on the native structure from the RuvB Holliday junction branch migration motor (PDB ID: 1in4A1), where two scoring functions- <italic>S</italic><sub><italic>ss</italic>+<italic>prof</italic></sub> and <italic>S</italic><sub><italic>cm</italic>+<italic>ss</italic>+<italic>prof</italic></sub> - were used by CEthreader. (C) Query-template alignments using different scoring functions for 1in4A1, where H1-4 and E1-2 are secondary structure segments assigned from the native PDB structure. (D) Overlay of the query (open circles) and template (closed circles) contact maps obtained using <italic>S</italic><sub><italic>ss</italic>+<italic>prof</italic></sub> (left panel) or <italic>S</italic><sub><italic>cm</italic>+<italic>ss</italic>+<italic>prof</italic></sub> (right panel), where helix, strand and loop regions are marked with purple, green and grey characters along the sequences. (E) Contribution of profile- (yellow) and contact-based (black) scores to the CEthreader alignments when using <italic>S</italic><sub><italic>ss</italic>+<italic>prof</italic></sub> (left) or <italic>S</italic><sub><italic>cm</italic>+<italic>ss</italic>+<italic>prof</italic></sub> (right).</p>
          </caption>
          <graphic xlink:href="pcbi.1007411.g003"/>
        </fig>
        <p>In <bold><xref ref-type="fig" rid="pcbi.1007411.g003">Fig 3B</xref></bold> (Left panel), we present a representative example from the RuvB Holliday junction branch migration motor (PDB ID: 1in4A1), for which the templates identified using <italic>S</italic><sub><italic>ss</italic>+<italic>prof</italic></sub> and <italic>S</italic><sub><italic>cm</italic>+<italic>ss</italic>+<italic>prof</italic></sub> are superimposed onto the native structure separately. The match based on profile and secondary structure resulted in an incorrect alignment shift starting from the third helix region (H3), where the resulting alignment gap is shown in <bold><xref ref-type="fig" rid="pcbi.1007411.g003">Fig 3C</xref></bold> and highlighted with a circle in <bold><xref ref-type="fig" rid="pcbi.1007411.g003">Fig 3B</xref></bold>. Under the pressure of enforcing contact map matching between the query and template, however, the correct alignment was restored when using <italic>S</italic><sub><italic>cm</italic>+<italic>ss</italic>+<italic>prof</italic></sub>, where each of the four helix regions of the template was correctly aligned to the query. This improvement can be clearly seen in <bold><xref ref-type="fig" rid="pcbi.1007411.g003">Fig 3D</xref></bold>, where the gap region corresponds to the mis-match between the query and template contact maps (Left panel), which is removed after considering the contact match score (<italic>S</italic><sub><italic>cm</italic></sub>) (Right panel). As a result, the TM-score of the template identified using <italic>S</italic><sub><italic>ss</italic>+<italic>prof</italic></sub> was 0.46, which was considerably lower than that by <italic>S</italic><sub><italic>cm</italic>+<italic>ss</italic>+<italic>prof</italic></sub> (0.61). This example highlights the usefulness of coupling contact maps with profile and secondary structure information to improve the alignment accuracy even when the same template is identified. The Right panel of <bold><xref ref-type="fig" rid="pcbi.1007411.g003">Fig 3B</xref></bold> displays the superposition of the native structure with the full-length models constructed by MODELLER [<xref rid="pcbi.1007411.ref004" ref-type="bibr">4</xref>] based on the template alignments, where the model built from the <italic>S</italic><sub><italic>ss</italic>+<italic>prof</italic></sub> template alignment (with a model TM-score = 0.53) contains a long loop between two strands (E1 and E2) due to the alignment shift at H3. On the other hand, the use of <italic>S</italic><sub><italic>cm</italic>+<italic>ss</italic>+<italic>prof</italic></sub> leads to a better full-length model along each of the secondary structure regions with an improved TM-score (= 0.68).</p>
        <p>In <bold><xref ref-type="fig" rid="pcbi.1007411.g003">Fig 3E</xref></bold>, we quantitatively analyze the contribution of profile and contact information to the query-template alignment for 1in4A1. We observed that the profile score was positive in the H1 and H2 regions for both the query and template due to the conservation of amino-acid composition, as evident from their profiles (see the top left panel of <bold><xref ref-type="fig" rid="pcbi.1007411.g003">Fig 3E</xref></bold>). As a result, the profile match is dominant when aligning the H1 and H2 regions of the query and template, and hence contact information does not have a significant effect on the alignment of these regions. However, the profile score is highly negative when the H3 region of the query is aligned to that of the template due to their different amino acid compositions in this region (see top-right panel of <bold><xref ref-type="fig" rid="pcbi.1007411.g003">Fig 3E</xref></bold>). Hence, the dynamic programming algorithm tends to add gaps in this region to maximize the final score of the profile-guided alignment. On the other hand, the contact information is highly conserved in the H3 region (positive score in the aligned H3 region), and thus the net score in this region has a positive contribution to the final score. Nevertheless, it is noteworthy that the overall profile information is reliable for this example, since approximately 1,000 homologous sequences were obtained for both the query and template sequences using PSI-BLAST [<xref rid="pcbi.1007411.ref035" ref-type="bibr">35</xref>] with an <italic>E</italic>-value cutoff of 0.01. This particular example highlights the importance of profile information when aligning regions where the amino acid composition is conserved, while also showing how contact map prediction can help fix the alignment errors along the regions where the profiles for the query and template do not match.</p>
        <p>Furthermore, we conducted an analysis to examine whether and how the performance of CEthreader varies based on the relative difficulty of identifying templates for the Hard targets, where the latter is quantitatively assessed by the structural similarity between the target and the best possible template identified by TM-align [<xref rid="pcbi.1007411.ref037" ref-type="bibr">37</xref>] from the PDB. As shown in <bold><xref ref-type="supplementary-material" rid="pcbi.1007411.s014">S1 Fig</xref></bold>, we found that as the TM-score between the target and the best template increased, the performance of CEthreader-detected templates (with both the best structural alignment and the CEthreader alignments) generally increases, meaning that the performance of CEthreader does have a weak but positive correlation with the similarity between the target and templates. Nevertheless, the TM-scores of CEthreader-identified templates were uniformly around 0.14 units lower than those of the best possible templates for the 211 Hard targets. When comparing the alignment results on the same template, the alignment quality of CEthreader, in terms of TM-score, was around 0.06 units lower than that produced by the structure alignment program, TM-align. These data show that there are considerable room for CEthreader improvement in both template detection and alignment construction.</p>
      </sec>
      <sec id="sec007">
        <title>Reduction of time complexity using a hybrid threading approach</title>
        <p>We use eigen-decomposition to convert the two-body contact map potential into a single-body potential, where the accuracy of the contact matrix representation increases with an increased number of eigenvectors (see <bold><xref ref-type="sec" rid="sec014">METHODS</xref></bold>). However, the time cost also increases rapidly when more eigenvectors are taken into account when aligning the query-template contacts, because a total of 2<sup><italic>K</italic></sup> possible alignments must be enumerated when considering <italic>K</italic> eigenvectors so that the sign of every involved eigenvector can be decided. This is particularly an issue when threading through a large size database. For example, when we set <italic>K</italic> = 7, the average time required to thread a query sequence of 200 residues through our database of 51,376 templates is ~130 hours. In order to reduce the time cost while maintaining the alignment accuracy, we implement a hybrid threading approach that combines both greedy and enumerative searching strategies.</p>
        <p>First, we use a greedy searching strategy to scan the whole database with a small <italic>K</italic> (= 2) and rank all the templates based on <italic>CMOq = O</italic>(<italic>CM</italic><sup><italic>Q</italic></sup>, <italic>CM</italic><sup><italic>T</italic></sup>)/<italic>N</italic>(<italic>CM</italic><sup><italic>Q</italic></sup>), where <italic>N</italic>(<italic>CM</italic><sup><italic>Q</italic></sup>) is the number of contacts used by CEthreader and O(<italic>CM</italic><sup><italic>Q</italic></sup>,<italic>CM</italic><sup><italic>T</italic></sup>) is the number of overlapped contacts between the aligned regions of the query and template proteins. For each query-template pair, this greedy strategy attempts to invert the signs of each eigenvector in turn, starting with the eigenvector associated with the largest eigenvalue. Once a sign inversion is set, this process is performed for the rest of the eigenvectors until all <italic>K</italic> signs are set. This greedy algorithm performs only 2<sup><italic>K</italic></sup> alignments, which significantly reduces the time complexity when compared to the enumerative searching strategy where all 2<sup><italic>K</italic></sup> alignments must be performed. Next, based on the ranking results in the first step, we select the top 1,000 templates for the query sequence and re-rank these templates using an enumerative searching strategy with a cumulative total of 7 eigenvectors. Although 254 (2<sup>1</sup>+2<sup>2</sup>+2<sup>3</sup>+2<sup>4</sup>+2<sup>5</sup>+2<sup>6</sup>+2<sup>7</sup> = 254) alignments are performed for each template, the number of templates is significantly reduced, which means all of the query-template alignments can be conducted with a reasonable cost and an average CPU time of ~2 hours.</p>
        <p><bold><xref ref-type="supplementary-material" rid="pcbi.1007411.s015">S2 Fig</xref></bold> in the SI shows the performance of CEthreader on the 211 Hard targets using different searching strategies and different numbers of eigenvectors. When only one eigenvector was used in the first step, the greedy searching strategy could detect correct templates for 57 targets, and the average time cost was ~1.4 hours. After further optimization based on the enumerative searching of the top 1,000 templates, the number of correct templates increased to 77. When two eigenvectors were used in the first step, correct templates for 68 targets could be identified by the greedy searching algorithm with an average time cost of ~2.4 hours, and correct templates were recognized for 79 targets in the second step of searching. Although the performance based on greedy searching increased with an increase in the number of eigenvectors, the final performance based on the hybrid searching strategy did not change much. In fact, the number of correct templates identified after implementing our greedy heuristic was very close to the number found after ~130 hours of enumerative searching through the whole template library of 51,376 proteins based on a cumulative total of 7 eigenvectors. Therefore, the hybrid searching strategy with only 2 eigenvectors used during the greedy searching step achieves reliable performance but with significantly reduced time complexity.</p>
      </sec>
    </sec>
    <sec id="sec008">
      <title>Comparison of CEthreader to other state-of-the-art threading approaches</title>
      <p>To further examine the impact of contact map information on threading, we compare the performance of CEthreader to other state-of-the-art profile- and contact-based threading programs. The comparisons were made on our two benchmark sets (Set-I and Set-II), where each target from Set-I and Set-II were searched through either the I-TASSER template database or the SCOPe database, respectively.</p>
      <sec id="sec009">
        <title>Test on Benchmark Set-I: Ability to recognize the most accurate templates</title>
        <p><bold><xref rid="pcbi.1007411.t001" ref-type="table">Table 1</xref></bold>shows the CEthreader threading results in comparison to eight state-of-the-art threading programs. The results were obtained by threading the 211 Hard targets in Set-I through the I-TASSER template library, where all templates that had a sequence identity &gt;30% to the query sequence were excluded. The data show that the average TM-score of the identified templates by CEthreader was 0.453, which was at least 9% or 45% higher than the average TM-scores by other contact-based methods or profile-based methods, respectively. The contact-based methods included: map_align (0.414) and EigenThreader (0.413), while the profile-based methods included: HHsearch (0.313) and MUSTER (0.304) [<xref rid="pcbi.1007411.ref014" ref-type="bibr">14</xref>]. The TM-score comparisons between CEthreader and the other methods were also statistically significant as per the Wilcoxon signed-rank tests which had <italic>p</italic>-values &lt;4.4E-06 for all of the comparisons. The table also shows that CEthreader could identify correct templates for 80 out of the 211 Hard targets, which was 1.35 times higher than the next best contact-based methods and 2.76 times higher than the next best profile-based method. The average RMSD by CEthreader was also lower than that of other programs, including the ones (HHsearch, SAM-T99 [<xref rid="pcbi.1007411.ref040" ref-type="bibr">40</xref>] and FFAS [<xref rid="pcbi.1007411.ref041" ref-type="bibr">41</xref>]) with significantly lower alignment coverage, which resulted in the higher TM-score.</p>
        <table-wrap id="pcbi.1007411.t001" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1007411.t001</object-id>
          <label>Table 1</label>
          <caption>
            <title>Performance of different threading methods on the 211 Hard targets from Benchmark Set-I.</title>
            <p><italic>P</italic>-values were calculated between the CEthreader alignment TM-scores and other methods’ TM-scores using one-sided Wilcoxon signed-rank tests. Coverage is equal to the number of aligned residues divided by the length of the query sequence. <italic>N</italic><sub><italic>st</italic></sub> represents the number of targets with an identified template whose TM-score was &gt;0.5.</p>
          </caption>
          <alternatives>
            <graphic id="pcbi.1007411.t001g" xlink:href="pcbi.1007411.t001"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="justify" rowspan="1" colspan="1">Methods</th>
                  <th align="center" rowspan="1" colspan="1">TM-score</th>
                  <th align="center" rowspan="1" colspan="1"><italic>p</italic>-value</th>
                  <th align="center" rowspan="1" colspan="1">RMSD (Å)</th>
                  <th align="center" rowspan="1" colspan="1">Coverage</th>
                  <th align="center" rowspan="1" colspan="1">
                    <italic>N</italic>
                    <sub>
                      <italic>st</italic>
                    </sub>
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="justify" rowspan="1" colspan="1">CEthreader</td>
                  <td align="center" rowspan="1" colspan="1">0.453</td>
                  <td align="center" rowspan="1" colspan="1">-</td>
                  <td align="center" rowspan="1" colspan="1">9.53</td>
                  <td align="center" rowspan="1" colspan="1">0.875</td>
                  <td align="center" rowspan="1" colspan="1">80</td>
                </tr>
                <tr>
                  <td align="justify" rowspan="1" colspan="1">map_align</td>
                  <td align="center" rowspan="1" colspan="1">0.414</td>
                  <td align="center" rowspan="1" colspan="1">4.39E-06</td>
                  <td align="center" rowspan="1" colspan="1">11.48</td>
                  <td align="center" rowspan="1" colspan="1">0.896</td>
                  <td align="center" rowspan="1" colspan="1">59</td>
                </tr>
                <tr>
                  <td align="justify" rowspan="1" colspan="1">EigenThreader</td>
                  <td align="center" rowspan="1" colspan="1">0.413</td>
                  <td align="center" rowspan="1" colspan="1">1.31E-09</td>
                  <td align="center" rowspan="1" colspan="1">10.15</td>
                  <td align="center" rowspan="1" colspan="1">0.850</td>
                  <td align="center" rowspan="1" colspan="1">49</td>
                </tr>
                <tr>
                  <td align="justify" rowspan="1" colspan="1">HHsearch</td>
                  <td align="center" rowspan="1" colspan="1">0.313</td>
                  <td align="center" rowspan="1" colspan="1">2.13E-24</td>
                  <td align="center" rowspan="1" colspan="1">10.92</td>
                  <td align="center" rowspan="1" colspan="1">0.654</td>
                  <td align="center" rowspan="1" colspan="1">29</td>
                </tr>
                <tr>
                  <td align="justify" rowspan="1" colspan="1">MUSTER</td>
                  <td align="center" rowspan="1" colspan="1">0.304</td>
                  <td align="center" rowspan="1" colspan="1">5.02E-28</td>
                  <td align="center" rowspan="1" colspan="1">13.94</td>
                  <td align="center" rowspan="1" colspan="1">0.869</td>
                  <td align="center" rowspan="1" colspan="1">23</td>
                </tr>
                <tr>
                  <td align="justify" rowspan="1" colspan="1">PPA</td>
                  <td align="center" rowspan="1" colspan="1">0.284</td>
                  <td align="center" rowspan="1" colspan="1">7.75E-30</td>
                  <td align="center" rowspan="1" colspan="1">14.78</td>
                  <td align="center" rowspan="1" colspan="1">0.832</td>
                  <td align="center" rowspan="1" colspan="1">19</td>
                </tr>
                <tr>
                  <td align="justify" rowspan="1" colspan="1">PROSPECT2</td>
                  <td align="center" rowspan="1" colspan="1">0.261</td>
                  <td align="center" rowspan="1" colspan="1">2.52E-35</td>
                  <td align="center" rowspan="1" colspan="1">16.63</td>
                  <td align="center" rowspan="1" colspan="1">0.915</td>
                  <td align="center" rowspan="1" colspan="1">10</td>
                </tr>
                <tr>
                  <td align="justify" rowspan="1" colspan="1">SAM-T99</td>
                  <td align="center" rowspan="1" colspan="1">0.208</td>
                  <td align="center" rowspan="1" colspan="1">1.04E-34</td>
                  <td align="center" rowspan="1" colspan="1">11.17</td>
                  <td align="center" rowspan="1" colspan="1">0.528</td>
                  <td align="center" rowspan="1" colspan="1">10</td>
                </tr>
                <tr>
                  <td align="justify" rowspan="1" colspan="1">FFAS</td>
                  <td align="center" rowspan="1" colspan="1">0.189</td>
                  <td align="center" rowspan="1" colspan="1">1.25E-35</td>
                  <td align="center" rowspan="1" colspan="1">14.39</td>
                  <td align="center" rowspan="1" colspan="1">0.674</td>
                  <td align="center" rowspan="1" colspan="1">7</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
        <p>The elevated performance of CEthreader compared to other state-of-the-art methods can again be attributed to the combination of the complementary structure (contact maps) and profile information, while other excellent profile-based programs, such as HHsearch and MUSTER, use profile and single-body local structural information (such as secondary structure), which are not sufficient to detect correct templates for many Hard targets. More importantly, by carefully coupling the profile information, CEthreader performs significantly better than other contact-based methods, such as map_align and EigenThreader, which rely solely on contact information to guide threading.</p>
        <p>Furthermore, although CEthreader was primarily developed for threading Hard targets, the alignments compare favorably with other profile-based threading programs for the 403 Easy targets, with a <italic>p</italic>-value &lt;2.2E-03 relative to the best of the profile-based programs and &lt;3.2E-23 to the best of the contact-based programs (see <bold><xref ref-type="supplementary-material" rid="pcbi.1007411.s007">S2 Table</xref></bold>). Note that without the use of profile information, other contact-based methods, such as map_align and EigenThreader, perform worse than profile-based methods (HHsearch, MUSTER, and PPA) on the Easy targets. The head-to-head comparisons between CEthreader and EigenThreader or map_align can be found in <bold><xref ref-type="supplementary-material" rid="pcbi.1007411.s016">S3 Fig</xref></bold>.</p>
        <p>As discussed above, we have used a sequence identity cutoff 40% (instead of the &lt;30% cutoff enforced between Set-I and the CEthreader training set) to filter proteins in Benchmark Set-I homologous to the ResPRE training dataset. In order to justify the reasonability of selecting the 40% sequence identity cutoff, we divided Benchmark Set-I with its 614 targets into two subsets: the first subset includes 239 targets with sequence identities &lt;30% to the ResPRE training set, and the second contains 375 targets with sequence identities between 30% and 40% to the ResPRE training set. <bold><xref ref-type="supplementary-material" rid="pcbi.1007411.s008">S3 Table</xref></bold> shows that CEthreader is still the best performing threading method compared to other profile- and contact-based methods for both of the subsets, which is consistent with the results for the entire Benchmark Set-I as shown in <bold>Tables <xref rid="pcbi.1007411.t001" ref-type="table">1</xref></bold>and <bold><xref ref-type="supplementary-material" rid="pcbi.1007411.s007">S2</xref></bold>, even though the results for the subset with sequence identities <italic>≥</italic>30% are slightly better than those for the subset with sequence identities &lt;30%.</p>
      </sec>
      <sec id="sec010">
        <title>Test on Benchmark Set-II: Ability to recognize folds in different Superfamilies</title>
        <p>Despite filtering out templates with high sequence identities to the target proteins (&gt;30%), templates identified in Benchmark Set-I may still have evolutionary relationships to the target proteins. Meanwhile, the distribution of the evolutionary distances between the query sequences and templates is highly uneven and varies from case-to-case. To conduct a more rigorous quantitative assessment of the ability of each threading program to recognize different levels of distantly-homologous templates, we performed a second test using Benchmark Set-II, which was collected from the SCOPe database. SCOPe is organized using a stringent hierarchy of protein structures, ranging from Class, Fold, Superfamily to Family, with members in a lower level of hierarchy having a closer evolutionary and structural similarity.</p>
        <p><bold><xref rid="pcbi.1007411.t002" ref-type="table">Table 2</xref></bold>summarizes the results for five state-of-the-art threading programs for which all templates within the same Superfamily as the query were excluded. The average TM-score of the first templates identified by CEthreader from the SCOPe database was 0.483, which was significantly higher than that by the next best contact-based method, i.e., map_align (0.464), or profile-based method, i.e., HHsearch (0.301), with Wilcoxon signed-rank <italic>p</italic>-values &lt;5.0E-05. Out of the 539 targets, CEthreader detected templates with the same Fold as the query in 323 cases, resulting in a SCOPe Fold-recognition success rate of 59.9%; this is much higher than the success rate of EigenThreader (50.3%) or HHsearch (28%). These data show that CEthreader has a stronger ability to detect templates with similar Folds even in the absence of a Superfamily-level homologous relationship to the query. In the lower panel of <bold><xref rid="pcbi.1007411.t002" ref-type="table">Table 2</xref></bold>, the query proteins are categorized as Easy (379 targets) or Hard (160 targets) based on their LOMETS classification, where similar trends in TM-score and success rate are observed for both Easy and Hard targets.</p>
        <table-wrap id="pcbi.1007411.t002" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1007411.t002</object-id>
          <label>Table 2</label>
          <caption>
            <title>Threading results obtained by different methods for the 539 proteins from Benchmark Set-II.</title>
            <p><italic>P</italic>-values were calculated between the CEthreader alignment TM-scores and other methods’ TM-scores using one-sided Wilcoxon signed-rank tests; <italic>N</italic><sub><italic>ST</italic></sub> represents the number of targets with a first identified template whose TM-score was &gt;0.5; the success rate is equal to the fraction of targets whose Folds were correctly recognized, i.e., the first identified template had the same Fold as the query.</p>
          </caption>
          <alternatives>
            <graphic id="pcbi.1007411.t002g" xlink:href="pcbi.1007411.t002"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="left" rowspan="1" colspan="1"/>
                  <th align="left" rowspan="1" colspan="1">Methods</th>
                  <th align="center" rowspan="1" colspan="1">TM-score</th>
                  <th align="center" rowspan="1" colspan="1"><italic>p</italic>-value</th>
                  <th align="center" rowspan="1" colspan="1">
                    <italic>N</italic>
                    <sub>
                      <italic>ST</italic>
                    </sub>
                  </th>
                  <th align="center" rowspan="1" colspan="1">Success rate</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="center" rowspan="5" colspan="1">All<break/>(539)</td>
                  <td align="left" rowspan="1" colspan="1">CEthreader</td>
                  <td align="center" rowspan="1" colspan="1">0.483</td>
                  <td align="center" rowspan="1" colspan="1">-</td>
                  <td align="center" rowspan="1" colspan="1">323</td>
                  <td align="center" rowspan="1" colspan="1">59.9%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">map_align</td>
                  <td align="center" rowspan="1" colspan="1">0.464</td>
                  <td align="center" rowspan="1" colspan="1">4.99E-05</td>
                  <td align="center" rowspan="1" colspan="1">261</td>
                  <td align="center" rowspan="1" colspan="1">48.4%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">EigenThreader</td>
                  <td align="center" rowspan="1" colspan="1">0.450</td>
                  <td align="center" rowspan="1" colspan="1">1.31E-21</td>
                  <td align="center" rowspan="1" colspan="1">271</td>
                  <td align="center" rowspan="1" colspan="1">50.3%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">HHsearch</td>
                  <td align="center" rowspan="1" colspan="1">0.301</td>
                  <td align="center" rowspan="1" colspan="1">2.84E-79</td>
                  <td align="center" rowspan="1" colspan="1">151</td>
                  <td align="center" rowspan="1" colspan="1">28.0%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MUSTER</td>
                  <td align="center" rowspan="1" colspan="1">0.285</td>
                  <td align="center" rowspan="1" colspan="1">6.57E-85</td>
                  <td align="center" rowspan="1" colspan="1">99</td>
                  <td align="center" rowspan="1" colspan="1">18.4%</td>
                </tr>
                <tr>
                  <td align="center" rowspan="5" colspan="1">Easy<break/>(379)</td>
                  <td align="left" rowspan="1" colspan="1">CEthreader</td>
                  <td align="center" rowspan="1" colspan="1">0.493</td>
                  <td align="center" rowspan="1" colspan="1">-</td>
                  <td align="center" rowspan="1" colspan="1">228</td>
                  <td align="center" rowspan="1" colspan="1">60.2%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">map_align</td>
                  <td align="center" rowspan="1" colspan="1">0.478</td>
                  <td align="center" rowspan="1" colspan="1">5.62E-03</td>
                  <td align="center" rowspan="1" colspan="1">195</td>
                  <td align="center" rowspan="1" colspan="1">51.5%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">EigenThreader</td>
                  <td align="center" rowspan="1" colspan="1">0.462</td>
                  <td align="center" rowspan="1" colspan="1">6.43E-16</td>
                  <td align="center" rowspan="1" colspan="1">199</td>
                  <td align="center" rowspan="1" colspan="1">52.5%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">HHsearch</td>
                  <td align="center" rowspan="1" colspan="1">0.326</td>
                  <td align="center" rowspan="1" colspan="1">1.18E-55</td>
                  <td align="center" rowspan="1" colspan="1">119</td>
                  <td align="center" rowspan="1" colspan="1">31.4%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MUSTER</td>
                  <td align="center" rowspan="1" colspan="1">0.304</td>
                  <td align="center" rowspan="1" colspan="1">2.68E-61</td>
                  <td align="center" rowspan="1" colspan="1">80</td>
                  <td align="center" rowspan="1" colspan="1">21.1%</td>
                </tr>
                <tr>
                  <td align="center" rowspan="5" colspan="1">Hard<break/>(160)</td>
                  <td align="left" rowspan="1" colspan="1">CEthreader</td>
                  <td align="center" rowspan="1" colspan="1">0.459</td>
                  <td align="center" rowspan="1" colspan="1">-</td>
                  <td align="center" rowspan="1" colspan="1">95</td>
                  <td align="center" rowspan="1" colspan="1">59.4%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">map_align</td>
                  <td align="center" rowspan="1" colspan="1">0.431</td>
                  <td align="center" rowspan="1" colspan="1">7.65E-04</td>
                  <td align="center" rowspan="1" colspan="1">66</td>
                  <td align="center" rowspan="1" colspan="1">41.3%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">EigenThreader</td>
                  <td align="center" rowspan="1" colspan="1">0.422</td>
                  <td align="center" rowspan="1" colspan="1">2.26E-07</td>
                  <td align="center" rowspan="1" colspan="1">72</td>
                  <td align="center" rowspan="1" colspan="1">45.0%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">HHsearch</td>
                  <td align="center" rowspan="1" colspan="1">0.242</td>
                  <td align="center" rowspan="1" colspan="1">1.65E-25</td>
                  <td align="center" rowspan="1" colspan="1">32</td>
                  <td align="center" rowspan="1" colspan="1">20.0%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MUSTER</td>
                  <td align="center" rowspan="1" colspan="1">0.241</td>
                  <td align="center" rowspan="1" colspan="1">8.37E-26</td>
                  <td align="center" rowspan="1" colspan="1">19</td>
                  <td align="center" rowspan="1" colspan="1">11.9%</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
        <p><bold><xref ref-type="fig" rid="pcbi.1007411.g004">Fig 4</xref></bold>shows a more detailed illustration of the ability of CEthreader and HHsearch to detect non-homologous templates from Fold groups of different sizes. In the outer circle of <bold><xref ref-type="fig" rid="pcbi.1007411.g004">Fig 4A</xref></bold>, there are 39 Fold groups with each containing at least 4 Superfamilies, where 29 groups were threadable by both CEthreader and HHsearch, 8 other groups were threadable only by CEthreader, and none of the groups were threadable by HHsearch but not by CEthreader. Here, "threadable" refers to cases for which the identified template and query proteins share the same Fold. For the 29 cases, both CEthreader and HHsearch demonstrated good performance at recognizing Folds with a high number of Superfamilies. On the other hand, recognition of Folds became more challenging when the number of Superfamilies in a Fold group was smaller, as statistically there was a lower chance of recognizing the correct template. In <bold><xref ref-type="fig" rid="pcbi.1007411.g004">Fig 4B</xref></bold>, we list 77 Fold groups in the SCOPe set that had ≤ 3 Superfamilies, where 39 of them could not be detected by either CEthreader or HHsearch. There were, however, 26 Fold groups where CEthreader identified a higher number of correct templates (with the same Fold) than HHsearch, while HHsearch did so only in 5 Fold groups. Overall, as shown in <bold><xref ref-type="supplementary-material" rid="pcbi.1007411.s004">S4 Table</xref></bold> CEthreader detected correct templates in the same Fold group as the query in 72 cases, while HHsearch did so in 44 cases out of the 116 Fold groups, which were selected after excluding the Superfamily-level homologs.</p>
        <fig id="pcbi.1007411.g004" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1007411.g004</object-id>
          <label>Fig 4</label>
          <caption>
            <title>Performance of CEthreader and HHsearch on Benchmark Set-II, which was collected from the SCOPe database.</title>
            <p>(A) The ability of CEthreader and HHsearch to recognize Folds from 39 large Fold groups with ≥4 Superfamilies. The size of a pie chart is proportional to the number of Superfamilies in the Fold group. The area of the sectors of each pie chart in the Outer circle is proportional to the number of correct hits by each different method, while that in the Inner circle represents the portion of Superfamilies hit (blue) or not hit (white) by CEtheader. A dotted line connects two Folds if the average TM-score between them is &gt;0.4. (B) Same as (A) but for 77 small Fold groups with 2 or 3 Superfamilies. The Inner disc shows a representative example from d2hq9b_ as indicated by the red circle in the SCOPe tree, where the first templates by CEthreader (blue) and HHsearch (yellow) are superimposed on the native (red) separately. (C) Venn diagram for the number of targets with the correct Fold detected by CEthreader, HHsearch, and MUSTER on all 539 Benchmark Set-II proteins. (D) TM-score difference between CEthreader and HHsearch (ΔTM-score) versus ResPRE contact prediction accuracy (CMOacc) and the number of effective sequences in the MSAs (<italic>Neff</italic>) for 116 Hard targets from (A) and (B). Stars indicate that the TM-score difference between CEthreader and HHsearch is statistically significant as determined by Wilcoxon signed-rank tests. (E, F) Overlay of the predicted contact map and the contact map of the templates identified by CEthreader or HHsearch for the example from d2db7b_. The lower right corner shows the structure superposition of the templates (blue) and the native (red), while the upper left corner shows the query-template alignments with connected lines marking contacts between two residues.</p>
          </caption>
          <graphic xlink:href="pcbi.1007411.g004"/>
        </fig>
        <p>In the inner disc of <bold><xref ref-type="fig" rid="pcbi.1007411.g004">Fig 4A</xref></bold>, we further analyze the evolutionary connection between different Folds in the SCOPe database in order to investigate what types of Folds are recognizable by CEthreader. For this purpose, a dotted edge is drawn between two Folds if the average TM-score between the Folds was &gt;0.4, where Folds were clustered based on the edges using Walktrap [<xref rid="pcbi.1007411.ref042" ref-type="bibr">42</xref>] (<bold><xref ref-type="supplementary-material" rid="pcbi.1007411.s010">S5 Table</xref></bold>). Here, the TM-score cutoff of 0.4 was chosen as multiple Fold groups could be formed with no singleton cluster at this cutoff. For the 39 Folds with ≥4 Superfamilies, the four clusters approximately corresponded to the four Classes of Folds, i.e., α-, β-, α+β, and α/β proteins. The figure shows that CEthreader tends to have better performance for Folds of smaller degree (less edges) and/or larger size (more Superfamilies), especially for those in large clusters. For example, in the blue region of the inner disc that corresponds to the α-protein Class, CEthreader failed to detect Folds a.2 and a.8 that had both large degree and small size, while it showed excellent performance in identifying Folds a.24 and a.118, both of which were of small degree and large size, and Fold a.102, which was of small degree. Since Folds with larger sizes comprise more Superfamilies, it is easier for CEtheader to detect a correct Fold. Additionally, Folds with smaller degree have fewer neighbors that are structurally similar to the Fold, thus there is a lower chance of mis-identifying the templates from other Folds by CEthreader, which utilizes structural information to identify templates.</p>
        <p>In order to better illustrate the enhanced ability of CEthreader compared to HHsearch to recognize correct Folds, we present in the inner disc of <bold><xref ref-type="fig" rid="pcbi.1007411.g004">Fig 4B</xref></bold> an example from a fad-binding protein (SCOPe ID: d2hq9b_). When all templates with the same SCOPe Family to the query were excluded, both CEthreader and HHsearch could detect templates from the correct Fold group as highlighted by the yellow (for HHsearch) and green (for both CEthreader and HHsearch) circles in <bold><xref ref-type="fig" rid="pcbi.1007411.g004">Fig 4B</xref></bold>. When the templates with the same Superfamily to the query were excluded, however, CEthreader could still detect the top-ranked template (SCOPe ID: d2rdea2) with the same Fold (b.45) and a TM-score of 0.57 to the query, but HHsearch’s top-ranked template (SCOPe ID: d3d2la_) was from a different Fold (c.66) that had a TM-score of 0.14 to the query. This example illustrates the enhanced ability of CEthreader to detect distantly-homologous templates.</p>
        <p>As a summary, we present in <bold><xref ref-type="fig" rid="pcbi.1007411.g004">Fig 4C</xref></bold> a Venn diagram for the number of cases for which the correct Fold was detected by CEthreader, HHsearch and MUSTER for all 539 targets in Set-II. It shows that the overlap between HHsearch and MUSTER was high, where 88% of targets whose Fold were correctly identified by MUSTER were also detected by HHsearch, probably due to the fact that both methods are built on the same principle of profile-profile alignment. On the other hand, due to the utilization of contact maps, CEthreader had a relatively lower overlap with HHsearch and MUSTER, where there were 185 cases (57%) whose Folds were correctly identified by CEthreader but not by HHsearch or MUSTER. Since CEthreader also adopts profile alignment information, most of the Folds successfully recognized by MUSTER and HHsearch were also recognized by CEthreader, which again demonstrates the advantages of using the composite profile- and contact map-based scoring function for threading alignment.</p>
      </sec>
      <sec id="sec011">
        <title>Test on Benchmark Set-II: Impact of contact map accuracy on Fold-recognition</title>
        <p>To specifically examine the potential of contact-based threading, we collected a subset of 102 modelable proteins from the 160 Hard targets in Benchmark Set-II, each of which had at least one template with TM-score &gt;0.5 as identified by searching the SCOPe library using TM-align. In total, TM-align identified 15,440 templates with TM-scores &gt;0.5 for the 102 selected proteins, with around 150 templates for each query protein. <bold><xref ref-type="fig" rid="pcbi.1007411.g004">Fig 4D</xref></bold> shows the difference in average TM-scores between CEthreader and HHsearch query-template alignments (ΔTM-score) for the 102 proteins, as a function of contact prediction accuracy, <italic>CMOacc</italic> = <italic>O</italic>(<italic>CM</italic><sup><italic>pred</italic></sup>,<italic>CM</italic><sup><italic>native</italic></sup>)/<italic>N</italic>(<italic>CM</italic><sup><italic>native</italic></sup>), where <italic>N</italic>(<italic>CM</italic><sup><italic>native</italic></sup>) is the number of contacts in the native structure and <italic>O</italic>(<italic>CM</italic><sup><italic>pred</italic></sup>,<italic>CM</italic><sup><italic>native</italic></sup>) is the number of overlapped contacts between the native and the top <italic>N</italic>(<italic>CM</italic><sup><italic>native</italic></sup>) predicted contacts.</p>
        <p>The data show a modest but obvious correlation between the improvement of CEthreader over HHsearch and the <italic>CMOacc</italic> values. For example, the average <italic>Δ</italic>TM-score = 0.087 for the targets with <italic>CMOacc</italic> &gt;0.5, while <italic>Δ</italic>TM-score = 0.073 for the targets with <italic>CMOacc</italic> below 0.5. There was also a correlation between <italic>Δ</italic>TM-score and the effective number of homologous sequences, <italic>Neff</italic>, where <italic>Δ</italic>TM-score = 0.092 (or 0.081) for targets with Neff &gt; 128 (or &lt; 128). This is understandable because the contact prediction in ResPRE was based on training using multiple sequence alignments [<xref rid="pcbi.1007411.ref043" ref-type="bibr">43</xref>], where a higher <italic>Neff</italic> corresponds to a more complete sequence profile and therefore can result in, on average, better contact map prediction accuracy. Overall, <italic>Δ</italic>TM-score was &gt;0 for 98 and &lt;0 for 4 out of the 102 Hard targets. In 83 cases, the TM-score by CEthreader was significantly higher (with <italic>p</italic>-values &lt; 0.05) than that by HHsearch, while HHsearch only had a significantly higher TM-score in 3 cases (see stars marked in <bold><xref ref-type="fig" rid="pcbi.1007411.g004">Fig 4D</xref></bold>). Here, the <italic>p</italic>-values were calculated using Wilcoxon signed-rank tests for all of the ~150 templates for each target.</p>
        <p>In <bold>Fig <xref ref-type="fig" rid="pcbi.1007411.g004">4E</xref></bold> and <bold><xref ref-type="fig" rid="pcbi.1007411.g004">4F</xref></bold>, we present an example from the hypothetical protein MS0332 (SCOPe ID: d2db7b_) to illustrate the impact of contact map prediction on threading results. For this target, both CEthreader and HHsearch identified the Cyanobacterial Photosystem I protein (SCOPe ID: d1jb0l_) as the top template. The query had a four-helix bundle fold, but HHsearch could only align the C-terminal helix of the query (helix H2) to the C-terminal helix of the template (helix H3) based on profile and secondary structure information, which resulted in a low TM-score (= 0.3) compared to the native. On the other hand, utilizing the contacts predicted by ResPRE between the residues in helices H1 and H2, CEthreader correctly aligned all four helices between the query and template by maximizing the overlap between the contact maps of the query and template structures, which resulted in a query-template alignment with a TM-score of 0.615. This example again demonstrates how the predicted contact map information helps correctly align two proteins that do not share any homologous relationship.</p>
      </sec>
    </sec>
    <sec id="sec012">
      <title>CEthreader goes beyond simple contact map prediction</title>
      <p>The core of the CEthreader development involves the integration of contact maps with profile and secondary structure information to improve the threading alignment accuracy. Based on our former benchmark tests, the combination of contact maps with the profile and secondary structure features can help CEthreader to generate significantly better template alignments than the methods built on either profile or contact map alignment. To further examine their impact on the full-length homologous model constructions, <bold><xref ref-type="supplementary-material" rid="pcbi.1007411.s011">S6 Table</xref></bold> listed a summary of the TM-score and RMSD of the full-length models constructed by MODELLER based on the template alignments generated by CEthreader and other profile- and contact-based threading algorithms for the proteins in Benchmark Set-I. It was observed that the TM-scores of the first models generated by CEthreader/MODELLER are 0.708 and 0.476 for Easy and Hard targets, respectively, which were significantly higher than the corresponding average TM-scores for models built by EigenThreader/MODELLER (0.656 and 0.449) or HHsearch/MODELLER (0.698 and 0.330), with <italic>p</italic>-values &lt;4.42E-05 for all cases. These data suggest that CEthreader helps improve the template alignments and full-length model construction for both Easy and Hard targets.</p>
      <p>To further improve the modeling quality, we coupled the CEthreader threading alignments with the predicted contact map information using a recently developed contact-guided structural assembly pipeline, C-I-TASSER [<xref rid="pcbi.1007411.ref044" ref-type="bibr">44</xref>], to build full-length structural models. The C-I-TASSER folding engine is based on the classical template-based modeling approach, I-TASSER [<xref rid="pcbi.1007411.ref005" ref-type="bibr">5</xref>], but with a new energy term to account for the contact-map restraints from the deep neural network predictions (see <bold><xref ref-type="sec" rid="sec014">METHODS</xref></bold>). The CEthreader/C-I-TASSER folding engine was modified here to use the top five ranked CEthreader templates and the ResPRE contacts as restraints. In <bold><xref ref-type="supplementary-material" rid="pcbi.1007411.s012">S7 Table</xref>,</bold> we presented a comparison between the full-length models constructed by the C-I-TASSER and the models generated by the pure template-based modeling tool, I-TASSER, starting from the same top five CEthreader templates for all 614 targets in Benchmark Set-I. As a control, we also listed the results from the models built by the Crystallography &amp; NMR System (CNS) program [<xref rid="pcbi.1007411.ref045" ref-type="bibr">45</xref>], utilizing the same set of predicted contacts from ResPRE. For the 211 Hard and 403 Easy targets, the TM-scores of the first full-length models generated by the pure template-based structural assembly approach, CEthreader/I-TASSER, were 20.2% and 39.2% higher than that by ResPRE/CNS, respectively; which partly reflects the advantage of model construction using contact-guided threading templates over that using only predicted contact maps. When using CEthreader/C-I-TASSER, the TM-scores of the first models were further increased by 1.8% (41.7%) and 13.5% (36.5%) for Easy and Hard targets, respectively, compared to that by the CEthreader/I-TASSER (ResPRE/CNS) pipelines. The result illustrates how the synergistic interplay between contact-guided threading and contact-map predictions can overcome the weaknesses of both pure threading-based modeling and pure contact-based modeling methods.</p>
      <p>In <bold><xref ref-type="fig" rid="pcbi.1007411.g005">Fig 5</xref></bold>, we presented the modeling results for the ARF guanine-nucleotide exchange factor 1 (PDB ID: 1re0B), which is an α-protein consisting of 10 helices. For this target, ResPRE accurately predicted the contact map with a <italic>CMOacc</italic> of 0.915 (<bold><xref ref-type="fig" rid="pcbi.1007411.g005">Fig 5A</xref></bold>). Using the predicted contacts, CEthreader identified a template, 1xszA3 (<bold><xref ref-type="fig" rid="pcbi.1007411.g005">Fig 5B</xref></bold>), that fully covered the C-terminus of the target with a local TM-score of 0.808 (normalized by the length of the template) and a <italic>CMOq</italic> of 0.335, but had the N-terminal region completed missed. Despite the fact that the local alignment quality of the template was good, due to the low alignment coverage (59%), the full-length model generated by CEthreader/I-TASSER had a near random coil conformation in the N-terminus region, resulting in a relatively low overall TM-score of 0.578 (<bold><xref ref-type="fig" rid="pcbi.1007411.g005">Fig 5C</xref></bold>). These data show that template-based modeling approaches lose much of their accuracy in gap regions where the aligned template information is absent. On the other hand, since the predicted contact map overlapped well with the native contact map for the entire protein (<bold><xref ref-type="fig" rid="pcbi.1007411.g005">Fig 5D</xref></bold>), ResPRE/CNS constructed a full-length model with a slightly improved TM-score of 0.637 (<bold><xref ref-type="fig" rid="pcbi.1007411.g005">Fig 5E</xref></bold>). However, ResPRE/CNS utilized restraints from all of the predicted contacts (95% true positive contacts and 93% false positive contacts), where the false positive contact between residue 85 and 124 (black box in <bold><xref ref-type="fig" rid="pcbi.1007411.g005">Fig 5D</xref></bold>) drew helix H6 close to helix H8 in the C-terminus (<bold><xref ref-type="fig" rid="pcbi.1007411.g005">Fig 5E</xref> sub-figure</bold>) during the CNS simulation. This caused the position to shift away from that found in the experimental structure and produced even more false positive contacts in the C-terminus of the final CNS model. Therefore, when only considering the C-terminus region, the TM-score of the ResPRE/CNS model was much lower than that of the CEthreader/I-TASSER model (0.477 vs 0.833). This analysis shows that pure contact-based modeling is still not as accurate as template-based modeling when high quality templates can be identified. In the CEthreader/C-I-TASSER pipeline, since both contact-map and threading template were considered in the structural assembly simulations, the final model had a reasonable accuracy on both N- and C-terminal regions (<bold><xref ref-type="fig" rid="pcbi.1007411.g005">Fig 5F</xref></bold>), which resulted in a full-length model with a much higher TM-score (0.792) than that by either CEthreader/I-TASSER (0.578) or ResPRE/CNS pipelines (0.637). This example highlights again the advantage of contact-map and threading template combinations in structural assembly simulations, in particular for the cases when low-coverage templates are identified, where contact map predictions can be used to help model the threading-unaligned regions.</p>
      <fig id="pcbi.1007411.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007411.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Modeling results for the ARF guanine-nucleotide exchange factor 1 (PDB ID: 1re0B).</title>
          <p>(A) Overlay of contact maps for the native query (gray circles), ResPRE-predicted contacts (red circles), CEthreader detected template (blue circles), and CEthreader/I-TASSER model (cyan circles). (B) The structure superposition of the templates (blue) and the native (gray). (C) The structure superposition of the CEthreader/I-TASSER model (cyan) and the native (gray). (D) Overlay of contact maps for the native query (gray circles), ResPRE-predicted contacts (red circles), overlapped contacts between the ResPRE prediction and the CEthreader detected template (blue circles), the ResPRE/CNS model (pink circles), and the CEthreader/C-I-TASSER model (green circles). (E) The structure superposition of the ResPRE/CNS model (pink) and the native (gray). (F) The structure superposition of the CEthreader/C-I-TASSER model (green) and the native (gray).</p>
        </caption>
        <graphic xlink:href="pcbi.1007411.g005"/>
      </fig>
      <p>After predicting the final structure models of a target, it is important to estimate the accuracy of the models, e.g., determining whether a target was correctly folded (TM-score of the model ≥0.5) or not (TM-score &lt;0.5). In <bold>Fig <xref ref-type="fig" rid="pcbi.1007411.g006">6A</xref></bold> and <bold><xref ref-type="fig" rid="pcbi.1007411.g006">6B</xref></bold>, we examined the correlations of the TM-score of the first C-I-TASSER model with two metrics of the C-I-TASSER C-score (defined in <bold><xref ref-type="disp-formula" rid="pcbi.1007411.e013">Eq 8</xref></bold>in <bold>METHODS</bold>) and the threading Z-score (<bold><xref ref-type="disp-formula" rid="pcbi.1007411.e012">Eq 7</xref></bold>). It was shown that the Pearson correlation coefficient (PCC) between TM-score and C-score (0.800) was much higher than that between TM-score and Z-score (0.579). If we selected a C-score cutoff of -0.18 to estimate the fold of final models, it would result in a maximum Matthews correlation coefficient (MCC) of 0.600, which was also much higher than the maximum MCC achieved by the threading Z-score (0.463). Here, it is noted that <bold><xref ref-type="fig" rid="pcbi.1007411.g006">Fig 6B</xref></bold> presented the TM-score of the C-I-TASSER models which might have only indirection relation with the threading Z-scores. To avoid the bias, we presented in <bold><xref ref-type="fig" rid="pcbi.1007411.g006">Fig 6C</xref></bold> the correlation data between the TM-score of the first threading template and the Z-score, where the PCC and the maximum MCC for the threading templates were 0.647 and 0.558, which were still lower than that from C-score/TM-score correlations (0.800 and 0.600). These results suggest that the C-score values by combining contact map, threading and MC simulation information should provide more accurate estimation on the final model quality compared to the widely threading Z-score.</p>
      <fig id="pcbi.1007411.g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007411.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>Accuracy estimation of predicted models using different score functions.</title>
          <p>(A) TM-score of the first C-I-TASSER model versus C-score defined by <bold><xref ref-type="disp-formula" rid="pcbi.1007411.e013">Eq (8)</xref></bold>. (B) TM-score of the first C-I-TASSER model versus CEthreder threading Z-score defined by <bold><xref ref-type="disp-formula" rid="pcbi.1007411.e012">Eq (7)</xref></bold>. (C) TM-score of the first threading template by CEthreader versus the Z-score. Blue circles and red crosses represent Easy and Hard targets respectively. The dashed vertical lines mark the score cutoffs that result in the maximum MCC value for distinguishing models with correct (TM-score &gt;0.5) and incorrect (TM-score &lt;0.5) folds, where values given in the sections indicate the number of points in each of the sections.</p>
        </caption>
        <graphic xlink:href="pcbi.1007411.g006"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec013">
    <title>Discussion</title>
    <p>In this study, we developed a new contact-guided threading approach, CEthreader, with the aim of significantly improving template-based structure modeling and fold-recognition for distant-homology proteins. The method first deduces residue-residue contact maps from multiple sequence alignments by integrating precision matrices with deep residual convolutional neural-network training. The predicted contact maps are then converted into single-body eigenvector products through eigen-decomposition, which enables the utilization of two-body contacts to guide the alignment construction and template selection using the Needleman-Wunch dynamic programming algorithm [<xref rid="pcbi.1007411.ref046" ref-type="bibr">46</xref>].</p>
    <p>CEthreader was tested on two large-scale benchmark sets containing 614 non-redundant protein structures collected from the PDB and 539 domains selected from different families in the SCOPe database [<xref rid="pcbi.1007411.ref036" ref-type="bibr">36</xref>]. For the Hard proteins from Set-I that lacked homologous templates, CEthreader could detect the first-ranked templates with an average TM-score of 0.453, which was 9% or 45% higher than the best start-of-the-art threading approaches based exclusively on contact maps (map_align) or profiles (HHsearch), respectively, after excluding all templates with a sequence identity &gt;30% to the query. Additionally, the number of correct templates with TM-scores &gt;0.5 detected by CEthreader was 36% or 176% higher than the number identified by map_align or HHsearch. For Benchmark Set-II, CEthreader successfully recognized templates with the same SCOPe Fold as the query in 323 cases after excluding homologous templates in the same Superfamily, which was 20% or 114% higher than the number identified by EigenThreader or HHsearch, respectively. The detailed data analyses show that the major advantage of CEthreader lies in the utilization of contact map information in threading, which helps recognize the similarity between the global folds of the query and templates during the alignment procedure, even when the evolutionary relationship between them is weak; this is essential for modeling the structures of distant-homology proteins.</p>
    <p>CEthreader was also compared to other profile- and contact-based threading methods for full-length 3D model constructions. Using the CEthreader alignments, MODELLER constructed full-length models with TM-scores &gt;0.5 for 476 out of the 614 Benchmark Set-I proteins, which was 14% or 18% higher than the number of correct models built using either EigenThreader or HHsearch alignments, respectively. The performance of CEthreader-based template modeling can be further improved by coupling the template information with the predicted contact maps in the structural assembly simulations, for which the models constructed by CEthreader/C-I-TASSER demonstrated significantly higher TM-scores and folding success rates than those produced by CEthreader/I-TASSER or ResPRE/CNS. The data suggests that the interplay of contact-guided threading with predicted contact maps can further improve protein structure modeling and makes the CEthreader/C-I-TASSER approach go far beyond model reconstruction strategies built purely on contact map prediction or template recognition.</p>
    <p>Despite the ability of CEthreader to recognize distant-homology templates, there is still room for further improvement. Currently, only positive eigenvalues have been considered in the eigen-decomposition process, which may result in a loss of information for some targets due to the omission of negative eigenvalues that are often important for precisely recovering the contact map matrix. Based on the statistics of the results of the Benchmark Set-I, for a typical protein, 47% of the eigenvalues are positive and 53% are negative (i.e., for a protein with 50 residues, there usually exist at least 23 positive eigenvalues) when performing eigen-decomposition utilizing native contact maps. Therefore, the inclusion of both positive and negative eigenvalues, which although may increase the implementation time of the program, should help further improve the contact-guided threading accuracy.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec014">
    <title>Methods</title>
    <p>CEthreader is a fold-recognition algorithm to identify similar-fold structures from the PDB under the guidance of predicted contact maps. The core part of the algorithm consists of contact map prediction, eigen-decomposition of the contact matrix, and contact-guided template search and selection, where the flowchart of the pipeline is depicted in <bold><xref ref-type="fig" rid="pcbi.1007411.g001">Fig 1</xref></bold>.</p>
    <sec id="sec015">
      <title>Contact map prediction and the selection of residue-residue contacts</title>
      <p>The contact map for a query sequence (with C<sub>β</sub>-C<sub>β</sub> distances &lt;8 Å) is predicted using the ResPRE method, which couples evolutionary precision matrices with deep residual neural networks [<xref rid="pcbi.1007411.ref043" ref-type="bibr">43</xref>]. Precision matrices are generated by ridge estimation of the inverse covariance matrix of the multiple sequence alignment, which is represented by an <italic>L</italic>×<italic>L</italic>×21×21 array of evolutionary couplings for a protein with <italic>L</italic> residues and <italic>L</italic>×<italic>L</italic> residue pairs. For each residue pair, the 21×21 coupling matrix is fed directly to the deep residual network (ResNet) [<xref rid="pcbi.1007411.ref047" ref-type="bibr">47</xref>], which is composed of 22 residual blocks where each block adds an identity map of the input to the output of the feedforward neural networks. ResPRE was trained using the Adam optimization algorithm [<xref rid="pcbi.1007411.ref048" ref-type="bibr">48</xref>] under the supervision of binary cross entropy loss and is implemented in PyTorch [<xref rid="pcbi.1007411.ref049" ref-type="bibr">49</xref>].</p>
      <p>The ResPRE predicted contacts with sequence separation ≥5 are selected and used by CEthreader, where residue pairs located at the same helix with a separation of 4 are also considered in order to enhance helix alignment. The top <italic>N</italic>(= ∑<sub>cr∈{<italic>long</italic>,<italic>medium</italic>,<italic>short</italic>}</sub><italic>σ</italic><sub><italic>cr</italic></sub><italic>L</italic>) predicted residue pairs, which are ranked by their confidence scores of prediction, are selected to form the final contact map, where <italic>cr</italic> refers to the <italic>long</italic>-, <italic>medium</italic>- and <italic>short</italic>-range contacts with sequence separation |<italic>i</italic>−<italic>j</italic>| ≥ 24, 23 ≥ |<italic>i</italic>−<italic>j</italic>| ≥ 12, and |<italic>i</italic>−<italic>j</italic>| ≤ 11, respectively. The parameters <italic>σ</italic><sub><italic>cr</italic></sub> were determined by maximizing the TM-score of CEthreader on a set of 905 training protein-pairs; these pairs were selected from the all-to-all alignments by TM-align [<xref rid="pcbi.1007411.ref037" ref-type="bibr">37</xref>] from a set of 335 non-redundant domains in SCOPe, where the TM-scores were roughly evenly-distributed in the range [0.5~0.95], i.e., with 241, 205, 190, 181 and 88 pairs with TM-scores in the range 0.5~0.6, 0.6~0.7, 0.7~0.8, 0.8~0.9 and 0.9~0.95, respectively. As shown in <bold><xref ref-type="supplementary-material" rid="pcbi.1007411.s017">S4A Fig</xref></bold>, the average TM-score of the CEthreader alignments is sensitive to <italic>σ</italic><sub><italic>cr</italic></sub>, where the maximum value occurs near <italic>σ</italic><sub><italic>sum</italic></sub> = 2.51 (= ∑<sub><italic>cr</italic></sub>
<italic>σ</italic><sub><italic>cr</italic></sub> = 1.79+0.41+0.31), although the fraction of aligned contacts, <italic>CMOq</italic>, decreases monotonously with <italic>σ</italic><sub><italic>sum</italic></sub> (<bold><xref ref-type="supplementary-material" rid="pcbi.1007411.s017">S4B Fig</xref></bold>). In <bold><xref ref-type="supplementary-material" rid="pcbi.1007411.s017">S4C Fig</xref></bold>, we present the correlation data between the number of short, medium and long-range contacts and protein length calculated from 9,896 non-redundant SCOPe domains, where the linear regression with the fitted parameters coincides well with the experimental structure data.</p>
      <p>In <bold><xref ref-type="supplementary-material" rid="pcbi.1007411.s013">S8 Table</xref></bold>, we list the performance of CEthreader on 905 training protein-pairs using contact maps from 18 different predictors. Although CEthreader was trained on the ResPRE contact maps, the data shows a strong correlation between the alignment performance and the accuracy of the contact map prediction from all different predictors. On average, ResPRE has the highest accuracy (84.6%) which also results in the highest TM-score (0.633) and <italic>CMOq</italic> (0.480) values used by CEthreader for the 905 training proteins.</p>
    </sec>
    <sec id="sec016">
      <title>Eigen-decomposition of the contact maps</title>
      <p>Contact maps can be represented by an <italic>L</italic>×<italic>L</italic> symmetric binary matrix, <bold><italic>M</italic></bold>, in which residue pairs in contacts are designated as 1 and non-contacting pairs are set to 0. Based on the eigen-decomposition theory [<xref rid="pcbi.1007411.ref050" ref-type="bibr">50</xref>], we can infer that
<disp-formula id="pcbi.1007411.e001"><alternatives><graphic xlink:href="pcbi.1007411.e001.jpg" id="pcbi.1007411.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:msub><mml:mi>λ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mo>*</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">→</mml:mo></mml:mover></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives><label>(1)</label></disp-formula>
where <italic>λ</italic><sub><italic>k</italic></sub> represents the <italic>k</italic>-th eigenvalue of <bold><italic>M</italic></bold>, and <inline-formula id="pcbi.1007411.e002"><alternatives><graphic xlink:href="pcbi.1007411.e002.jpg" id="pcbi.1007411.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> is the corresponding eigenvector. Since the contribution of each eigenvector depends on the absolute magnitude of the eigenvalue in <bold><xref ref-type="disp-formula" rid="pcbi.1007411.e001">Eq (1)</xref></bold>, we reorder the eigenvalues in descending order (<inline-formula id="pcbi.1007411.e003"><alternatives><graphic xlink:href="pcbi.1007411.e003.jpg" id="pcbi.1007411.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:mo>≥</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>), where the contact map can be approximated by considering only the largest <italic>K</italic> positive eigenvalues and associated eigenvectors:
<disp-formula id="pcbi.1007411.e004"><alternatives><graphic xlink:href="pcbi.1007411.e004.jpg" id="pcbi.1007411.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi><mml:mo>≈</mml:mo><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:msub><mml:mi>λ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mo>*</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">→</mml:mo></mml:mover></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives><label>(2)</label></disp-formula></p>
      <p>Here, we do not consider the negative eigenvalues because it introduces complex numbers into the following computation.</p>
      <p>Based on <bold><xref ref-type="disp-formula" rid="pcbi.1007411.e004">Eq (2)</xref></bold>, any pair of contacts between residues <italic>i</italic> and <italic>j</italic> can be written as
<disp-formula id="pcbi.1007411.e005"><alternatives><graphic xlink:href="pcbi.1007411.e005.jpg" id="pcbi.1007411.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msqrt><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msqrt><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:mrow></mml:msqrt><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>*</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msqrt><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msqrt><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:mrow></mml:msqrt><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives><label>(3)</label></disp-formula></p>
      <p>In this way, the contact profiles of the <italic>i</italic>- and <italic>j</italic>-th residues are described by the vectors of
<disp-formula id="pcbi.1007411.e006"><alternatives><graphic xlink:href="pcbi.1007411.e006.jpg" id="pcbi.1007411.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msqrt><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msqrt><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msqrt><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msqrt><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msqrt><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msqrt><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives><label>(4)</label></disp-formula></p>
      <p>This representation of contact maps using single-body profiles allows the integration of contact map information into a dynamic program alignment algorithm for fold-recognition (see <bold><xref ref-type="supplementary-material" rid="pcbi.1007411.s002">S2 Text</xref></bold> and <bold><xref ref-type="supplementary-material" rid="pcbi.1007411.s018">S5 Fig</xref></bold>in the SI for more details). In CEthreader, we set <italic>K</italic> = 7 as a trade-off between accuracy and speed for the alignment procedure (see <bold><xref ref-type="supplementary-material" rid="pcbi.1007411.s003">S3 Text</xref></bold> and <bold><xref ref-type="supplementary-material" rid="pcbi.1007411.s019">S6 Fig</xref></bold>).</p>
    </sec>
    <sec id="sec017">
      <title>Contact-guided fold-recognition</title>
      <p>The fold-recognition in CEthreader is performed by threading the query sequence through a non-redundant structure set taken from the PDB library. The contact-guided alignment score for aligning the <italic>i-</italic>th residue of the query with the <italic>j-</italic>th residue of the template protein is represented by
<disp-formula id="pcbi.1007411.e007"><alternatives><graphic xlink:href="pcbi.1007411.e007.jpg" id="pcbi.1007411.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math></alternatives><label>(5)</label></disp-formula></p>
      <p>Here, the first term accounts for the contact map match between the query and template by (<bold><xref ref-type="supplementary-material" rid="pcbi.1007411.s004">S4 Text</xref></bold> and <bold><xref ref-type="supplementary-material" rid="pcbi.1007411.s020">S7 Fig</xref></bold> in SI):
<disp-formula id="pcbi.1007411.e008"><alternatives><graphic xlink:href="pcbi.1007411.e008.jpg" id="pcbi.1007411.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mo>⋅</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mrow><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">→</mml:mo></mml:mover></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mspace width="0.5em"/><mml:mtext>if</mml:mtext><mml:mspace width="0.5em"/><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">→</mml:mo></mml:mover></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>≠</mml:mo><mml:mover accent="true"><mml:mn>0</mml:mn><mml:mo>⇀</mml:mo></mml:mover><mml:mspace width="0.25em"/><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.25em"/><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">→</mml:mo></mml:mover></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>≠</mml:mo><mml:mover accent="true"><mml:mn>0</mml:mn><mml:mo>⇀</mml:mo></mml:mover></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mspace width="0.5em"/><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">→</mml:mo></mml:mover></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">→</mml:mo></mml:mover></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mn>0</mml:mn><mml:mo>⇀</mml:mo></mml:mover></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives><label>(6)</label></disp-formula>
where <inline-formula id="pcbi.1007411.e009"><alternatives><graphic xlink:href="pcbi.1007411.e009.jpg" id="pcbi.1007411.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1007411.e010"><alternatives><graphic xlink:href="pcbi.1007411.e010.jpg" id="pcbi.1007411.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> are the contact eigenvectors for the <italic>i-</italic>th residue of the query and the <italic>j-</italic>th residue of the template as defined by <bold><xref ref-type="disp-formula" rid="pcbi.1007411.e006">Eq (4)</xref></bold>. This term helps to align the residues pairs from the query and template that have similar contact eigenvectors, and therefore enhances the match between the global contact maps of the two proteins (see <bold><xref ref-type="supplementary-material" rid="pcbi.1007411.s021">S8 Fig</xref></bold>). There are several previous studies trying to use a cosine function or a standard inner dot product function [<xref rid="pcbi.1007411.ref028" ref-type="bibr">28</xref>,<xref rid="pcbi.1007411.ref029" ref-type="bibr">29</xref>,<xref rid="pcbi.1007411.ref031" ref-type="bibr">31</xref>,<xref rid="pcbi.1007411.ref033" ref-type="bibr">33</xref>] as the scoring function when aligning the contact eigenvectors. However, cosine functions only consider the angle between two contact eigenvectors and ignore their lengths, which is suboptimal as both angle and length are important when deciding the similarity between two contact eigenvectors. Moreover, although the inner dot product function considers the lengths of the contact eigenvectors, it increases the contribution of the lengths of the contact eigenvectors when one of them is dramatically bigger than the other (see discussion in <bold><xref ref-type="supplementary-material" rid="pcbi.1007411.s004">S4 Text</xref></bold>). Indeed, based on our tests on the 905 query-template pairs (<bold><xref ref-type="supplementary-material" rid="pcbi.1007411.s013">S8 Table</xref></bold>), the scoring function defined by <bold><xref ref-type="disp-formula" rid="pcbi.1007411.e008">Eq (6)</xref></bold> performs significantly better than the inner dot product-based scoring function in terms of query-template alignment TM-scores and CMOq values.</p>
      <p>The second and third terms, <italic>S</italic><sub><italic>prof</italic></sub>(<italic>i</italic>,<italic>j</italic>) and <italic>S</italic><sub><italic>ss</italic></sub>(<italic>i</italic>,<italic>j</italic>), in <bold><xref ref-type="disp-formula" rid="pcbi.1007411.e007">Eq (5)</xref></bold>, which are explained in <bold><xref ref-type="supplementary-material" rid="pcbi.1007411.s005">S5 Text</xref>,</bold> take into account the sequence profile-to-profile and secondary structure alignment scores between the <italic>i-</italic>th residue of the query and the <italic>j-</italic>th residue of the template. The weighting parameters are <italic>w</italic><sub>1</sub> = 0.5, <italic>w</italic><sub>2</sub> = 0.4, <italic>w</italic><sub>3</sub> = 0.1, and <italic>w</italic><sub>4</sub> = 0.1, which were determined by maximizing the alignment TM-score for the 905 training protein-pairs described above.</p>
      <p>The Needleman-Wunsch (NW) dynamic programming algorithm [<xref rid="pcbi.1007411.ref046" ref-type="bibr">46</xref>] is used to align two protein sequences, where an affine penalty scheme is utilized. For an <italic>l</italic> residue gap the gap penalty, <italic>G</italic> is determined by <italic>G</italic> = <italic>g</italic><sub><italic>o</italic></sub> + <italic>g</italic><sub><italic>e</italic></sub><italic>l</italic>, where <italic>g</italic><sub>o,e</sub> = <italic>w</italic><sub>1</sub><italic>g</italic><sub><italic>o</italic>,<italic>e</italic></sub>(<italic>cm</italic>)+<italic>w</italic><sub>2</sub><italic>g</italic><sub><italic>o</italic>,<italic>e</italic></sub>(<italic>prof</italic>)+<italic>w</italic><sub>3</sub><italic>g</italic><sub><italic>o</italic>,<italic>e</italic></sub>(<italic>ss</italic>) with <italic>g</italic><sub><italic>o</italic></sub>(<italic>cm</italic>) = <italic>g</italic><sub><italic>o</italic></sub>(<italic>prof</italic>) = <italic>g</italic><sub><italic>o</italic></sub>(<italic>ss</italic>) = −1.0, <italic>g</italic><sub><italic>e</italic></sub>(<italic>cm</italic>) = <italic>g</italic><sub><italic>e</italic></sub>(<italic>prof</italic>) = <italic>g</italic><sub><italic>e</italic></sub>(<italic>ss</italic>) = −0.1 and <italic>g</italic><sub><italic>e</italic></sub>(<italic>ss</italic>) = −0.077. These parameters were determined by optimizing the alignment performance on the 905 training protein pairs (see <bold><xref ref-type="supplementary-material" rid="pcbi.1007411.s005">S5 Text</xref></bold>). The gap penalty is used only for residues in the middle of the query and template sequences, and no penalty is applied to the terminal ends. Since changing the sign of ν<sub><italic>i</italic>,<italic>k</italic></sub> and ν<sub><italic>j</italic>,<italic>k</italic></sub> simultaneously gives the same <italic>M</italic><sub><italic>i</italic>,<italic>j</italic></sub> in <bold><xref ref-type="disp-formula" rid="pcbi.1007411.e005">Eq (3)</xref></bold>, for a given eigen solution, there are 2<sup><italic>K</italic></sup> different vectors all satisfying the eigen-decomposition equation. Thus, CEthreader needs to calculate <inline-formula id="pcbi.1007411.e011"><alternatives><graphic xlink:href="pcbi.1007411.e011.jpg" id="pcbi.1007411.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> alignments for one query-template pair, where the alignment with the highest alignment score is selected.</p>
      <p>In order to select the best alignment, <italic>CMOq </italic>is used to rank all the templates. Additionally, we can compute the Z-score based on <italic>CMOq</italic> to assess the quality of the template alignments with respect to the average, and further distinguish between good and bad templates. The Z-score is calculated by
<disp-formula id="pcbi.1007411.e012"><alternatives><graphic xlink:href="pcbi.1007411.e012.jpg" id="pcbi.1007411.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:mrow><mml:mtext>Z</mml:mtext><mml:mo>−</mml:mo><mml:mtext>score</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>C</mml:mi><mml:mi>M</mml:mi><mml:mi>O</mml:mi><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mi>M</mml:mi><mml:mi>O</mml:mi><mml:mi>q</mml:mi></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>σ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mi>M</mml:mi><mml:mi>O</mml:mi><mml:mi>q</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives><label>(7)</label></disp-formula>
where <italic>CMOq</italic>(<italic>i</italic>) is the <italic>CMOq</italic> of the <italic>i</italic>-th template, and 〈<italic>CMOq</italic>〉 and <italic>σ</italic>(<italic>CMOq</italic>) are the average <italic>CMOq</italic> and standard deviation, respectively, across all templates for CEthreader.</p>
    </sec>
    <sec id="sec018">
      <title>Structure assembly simulations based on an interplay of threading and contact map predictions</title>
      <p>C-I-TASSER [<xref rid="pcbi.1007411.ref044" ref-type="bibr">44</xref>] (Contact-guided Iterative Threading ASSEmbly Refinement) is a fully-automated structure prediction pipeline that was used in 13<sup>th</sup> community-wide Critical Assessment of Structure Prediction (CASP13) experiment. It is built on the I-TASSER [<xref rid="pcbi.1007411.ref005" ref-type="bibr">5</xref>] pipeline, but uses contact map information to enhance the accuracy of protein structure prediction. For a residue pair (<italic>i</italic> and <italic>j</italic>) that is predicted to be in contact, the restraint is added to the inherent I-TASSER potential by
<disp-formula id="pcbi.1007411.e013"><alternatives><graphic xlink:href="pcbi.1007411.e013.jpg" id="pcbi.1007411.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>8</mml:mn><mml:mi>Å</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>8</mml:mn><mml:mo>+</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>8</mml:mn></mml:mfrac><mml:mi>π</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mn>8</mml:mn><mml:mi>Å</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:mn>80</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>80</mml:mn><mml:mo>−</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mi>π</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>D</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mn>80</mml:mn><mml:mi>Å</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>80</mml:mn><mml:mi>Å</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives><label>(8)</label></disp-formula>
where <italic>U</italic><sub><italic>ij</italic></sub> is the contact probability between residue pair <italic>i</italic> and <italic>j</italic> predicted by ResPRE, <italic>d</italic><sub><italic>ij</italic></sub> is the C<sub>β</sub>-C<sub>β</sub> distance between residue <italic>i</italic> and <italic>j</italic> in the simulation decoys, and <italic>D</italic> = 16 Å.</p>
      <p>Following the simulations, the decoys from the simulation trajectories are clustered by SPICKER [<xref rid="pcbi.1007411.ref051" ref-type="bibr">51</xref>], where the conformations that are closest to cluster centroids are selected and refined by FG-MD [<xref rid="pcbi.1007411.ref052" ref-type="bibr">52</xref>] to generate the final top 5 structure models. The accuracies of the C-I-TASSER models are estimated through the confidence score (or C-score) which is calculated by
<disp-formula id="pcbi.1007411.e014"><alternatives><graphic xlink:href="pcbi.1007411.e014.jpg" id="pcbi.1007411.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:mrow><mml:mtext>C</mml:mtext><mml:mo>−</mml:mo><mml:mtext>score</mml:mtext><mml:mo>=</mml:mo><mml:mtext>ln</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mi>M</mml:mi><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mtext>Z</mml:mtext><mml:mo>−</mml:mo><mml:mtext>score</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:msup><mml:mi>M</mml:mi><mml:mi>Q</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:msup><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:msup><mml:mi>M</mml:mi><mml:mi>Q</mml:mi></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives><label>(9)</label></disp-formula>
where <italic>M</italic> is the number of structure conformations in the SPICKER cluster; <italic>M</italic><sub><italic>tot</italic></sub> is the total number of C-I-TASSER structure decoys used for clustering; 〈<italic>RMSD</italic>〉 is the average RMSD of the decoys to the cluster centroid; Z – score(1) is the highest Z-score of the templates identified by CEthreader and <italic>Z</italic><sub>0</sub> = 6.8 is the corresponding Z-score cutoff for distinguishing between good and bad templates, which was determined based on the training dataset; <italic>N</italic>(<italic>CM</italic><sup>Q</sup>) is the number of contacts used by CEthreader and <italic>O</italic>(<italic>CM</italic><sup><italic>Q</italic></sup>, <italic>CM</italic><sup><italic>M</italic></sup>) is the sum of probabilities provided by ResPRE for the overlapped contacts between the query and structure models.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="sec019">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pcbi.1007411.s001">
      <label>S1 Text</label>
      <caption>
        <title>The normalized number of effective sequences in an MSA.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007411.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007411.s002">
      <label>S2 Text</label>
      <caption>
        <title>Eigen-decomposition of a contact-map.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007411.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007411.s003">
      <label>S3 Text</label>
      <caption>
        <title>Optimization of the number of eigenvectors used by CEthreader.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007411.s003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007411.s004">
      <label>S4 Text</label>
      <caption>
        <title>Optimization of the scoring function used for aligning contact maps.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007411.s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007411.s005">
      <label>S5 Text</label>
      <caption>
        <title>Optimization of the component scores used to match the secondary structure and sequence profiles of two proteins.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007411.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007411.s006">
      <label>S1 Table</label>
      <caption>
        <title>Summary of the threading alignments produced by CEthreader for the 614 test proteins in Benchmark Set-I.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007411.s006.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007411.s007">
      <label>S2 Table</label>
      <caption>
        <title>Threading results by different methods for the 403 Easy targets from Benchmark Set-I.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007411.s007.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007411.s008">
      <label>S3 Table</label>
      <caption>
        <title>Threading results for different methods using Benchmark Set-I separated based on sequence identity to the ResPRE training set.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007411.s008.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007411.s009">
      <label>S4 Table</label>
      <caption>
        <title>Fold-recognition performance of CEthreader, HHsearch and MUSTER for 116 Fold families in Benchmark Set-II.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007411.s009.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007411.s010">
      <label>S5 Table</label>
      <caption>
        <title>List of fold pairs in benchmark set-II with an average TM-score &gt;0.4.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007411.s010.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007411.s011">
      <label>S6 Table</label>
      <caption>
        <title>Summary of models built by MODELLER based on different threading methods for all 614 proteins in Benchmark Set-I.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007411.s011.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007411.s012">
      <label>S7 Table</label>
      <caption>
        <title>Summary of models built by CEthreader/C-I-TASSER, CEthreader/I-TASSER and ResPRE/CNS for all 614 proteins in Benchmark Set-I.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007411.s012.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007411.s013">
      <label>S8 Table</label>
      <caption>
        <title>CEthreader threading alignment results for the 905 query-template pairs using native contact maps or contact maps predicted using 18 different contact predictors.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007411.s013.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007411.s014">
      <label>S1 Fig</label>
      <caption>
        <title>CEthreader template information for 211 Hard targets from Benchmark Set-I.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007411.s014.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007411.s015">
      <label>S2 Fig</label>
      <caption>
        <title>CEthreader performance and time-cost using different numbers of eigenvectors in the greedy search step.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007411.s015.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007411.s016">
      <label>S3 Fig</label>
      <caption>
        <title>Comparison of CEthreader’s performance to map_align and EigenThreader on Benchmark Set-I.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007411.s016.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007411.s017">
      <label>S4 Fig</label>
      <caption>
        <title>Optimization of the number of predicted contacts to be used by CEthreader.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007411.s017.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007411.s018">
      <label>S5 Fig</label>
      <caption>
        <title>The diagrammatic illustration of eigen-decomposition of a contact-map.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007411.s018.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007411.s019">
      <label>S6 Fig</label>
      <caption>
        <title>Optimization of the number of eigenvectors used by CEthreader.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007411.s019.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007411.s020">
      <label>S7 Fig</label>
      <caption>
        <title>Optimization of the contact map matching score <italic>S</italic><sub><italic>cm</italic></sub>.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007411.s020.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007411.s021">
      <label>S8 Fig</label>
      <caption>
        <title>Illustration that alignment of contact eigenvectors between query and template sequences results in the match of global contact maps for the two sequences.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007411.s021.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>The CEthreader training process was implemented in the computing resource of the Extreme Science and Engineering Discovery Environment (XSEDE), which is supported by the National Science Foundation [ACI1548562].</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1007411.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Baker</surname><given-names>D</given-names></name>, <name><surname>Sali</surname><given-names>A</given-names></name> (<year>2001</year>) <article-title>Protein structure prediction and structural genomics</article-title>. <source>Science</source>
<volume>294</volume>: <fpage>93</fpage>–<lpage>96</lpage>. <pub-id pub-id-type="doi">10.1126/science.1065659</pub-id>
<?supplied-pmid 11588250?><pub-id pub-id-type="pmid">11588250</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>Y</given-names></name> (<year>2009</year>) <article-title>Protein structure prediction: when is it useful?</article-title>
<source>Curr Opin Struct Biol</source>
<volume>19</volume>: <fpage>145</fpage>–<lpage>155</lpage>. <pub-id pub-id-type="doi">10.1016/j.sbi.2009.02.005</pub-id>
<?supplied-pmid 19327982?><pub-id pub-id-type="pmid">19327982</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Simons</surname><given-names>KT</given-names></name>, <name><surname>Kooperberg</surname><given-names>C</given-names></name>, <name><surname>Huang</surname><given-names>E</given-names></name>, <name><surname>Baker</surname><given-names>D</given-names></name> (<year>1997</year>) <article-title>Assembly of protein tertiary structures from fragments with similar local sequences using simulated annealing and Bayesian scoring functions</article-title>. <source>J Mol Biol</source>
<volume>268</volume>: <fpage>209</fpage>–<lpage>225</lpage>. <pub-id pub-id-type="doi">10.1006/jmbi.1997.0959</pub-id>
<?supplied-pmid 9149153?><pub-id pub-id-type="pmid">9149153</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Sali</surname><given-names>A</given-names></name>, <name><surname>Blundell</surname><given-names>TL</given-names></name> (<year>1993</year>) <article-title>Comparative protein modelling by satisfaction of spatial restraints</article-title>. <source>J Mol Biol</source>
<volume>234</volume>: <fpage>779</fpage>–<lpage>815</lpage>. <pub-id pub-id-type="doi">10.1006/jmbi.1993.1626</pub-id>
<?supplied-pmid 8254673?><pub-id pub-id-type="pmid">8254673</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Yang</surname><given-names>J</given-names></name>, <name><surname>Yan</surname><given-names>R</given-names></name>, <name><surname>Roy</surname><given-names>A</given-names></name>, <name><surname>Xu</surname><given-names>D</given-names></name>, <name><surname>Poisson</surname><given-names>J</given-names></name>, <etal>et al</etal> (<year>2015</year>) <article-title>The I-TASSER Suite: protein structure and function prediction</article-title>. <source>Nature Methods</source>
<volume>12</volume>: <fpage>7</fpage>–<lpage>8</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.3213</pub-id>
<?supplied-pmid 25549265?><pub-id pub-id-type="pmid">25549265</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Xu</surname><given-names>D</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name> (<year>2012</year>) <article-title>Ab initio protein structure assembly using continuous structure fragments and optimized knowledge-based force field</article-title>. <source>Proteins</source>
<volume>80</volume>: <fpage>1715</fpage>–<lpage>1735</lpage>. <pub-id pub-id-type="doi">10.1002/prot.24065</pub-id>
<?supplied-pmid 22411565?><pub-id pub-id-type="pmid">22411565</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Kelley</surname><given-names>LA</given-names></name>, <name><surname>Mezulis</surname><given-names>S</given-names></name>, <name><surname>Yates</surname><given-names>CM</given-names></name>, <name><surname>Wass</surname><given-names>MN</given-names></name>, <name><surname>Sternberg</surname><given-names>MJ</given-names></name> (<year>2015</year>) <article-title>The Phyre2 web portal for protein modeling, prediction and analysis</article-title>. <source>Nat Protoc</source>
<volume>10</volume>: <fpage>845</fpage>–<lpage>858</lpage>. <pub-id pub-id-type="doi">10.1038/nprot.2015.053</pub-id>
<?supplied-pmid 25950237?><pub-id pub-id-type="pmid">25950237</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Söding</surname><given-names>J</given-names></name> (<year>2005</year>) <article-title>Protein homology detection by HMM–HMM comparison</article-title>. <source>Bioinformatics</source>
<volume>21</volume>: <fpage>951</fpage>–<lpage>960</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bti125</pub-id>
<?supplied-pmid 15531603?><pub-id pub-id-type="pmid">15531603</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref009">
      <label>9</label>
      <mixed-citation publication-type="book"><name><surname>Dunbrack</surname><given-names>R</given-names></name>. <source>Template-based modeling assessment in CASP11</source>; <year>2014</year>; <publisher-loc>Riviera Maya, Mexico</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Kryshtafovych</surname><given-names>A</given-names></name>, <name><surname>Monastyrskyy</surname><given-names>B</given-names></name>, <name><surname>Fidelis</surname><given-names>K</given-names></name>, <name><surname>Moult</surname><given-names>J</given-names></name>, <name><surname>Schwede</surname><given-names>T</given-names></name>, <etal>et al</etal> (<year>2018</year>) <article-title>Evaluation of the template-based modeling in CASP12</article-title>. <source>Proteins</source>
<volume>86</volume>
<issue>Suppl 1</issue>: <fpage>321</fpage>–<lpage>334</lpage>.<pub-id pub-id-type="pmid">29159950</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Bowie</surname><given-names>JU</given-names></name>, <name><surname>Luthy</surname><given-names>R</given-names></name>, <name><surname>Eisenberg</surname><given-names>D</given-names></name> (<year>1991</year>) <article-title>A method to identify protein sequences that fold into a known three-dimensional structure</article-title>. <source>Science</source>
<volume>253</volume>: <fpage>164</fpage>–<lpage>170</lpage>. <pub-id pub-id-type="doi">10.1126/science.1853201</pub-id>
<?supplied-pmid 1853201?><pub-id pub-id-type="pmid">1853201</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Skolnick</surname><given-names>J</given-names></name>, <name><surname>Kihara</surname><given-names>D</given-names></name> (<year>2001</year>) <article-title>Defrosting the frozen approximation: PROSPECTOR—A new approach to threading</article-title>. <source>Proteins: Structure, Function, and Bioinformatics</source>
<volume>42</volume>: <fpage>319</fpage>–<lpage>331</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Xu</surname><given-names>Y</given-names></name>, <name><surname>Xu</surname><given-names>D</given-names></name> (<year>2000</year>) <article-title>Protein threading using PROSPECT: Design and evaluation</article-title>. <source>Proteins: Structure, Function, and Bioinformatics</source>
<volume>40</volume>: <fpage>343</fpage>–<lpage>354</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Wu</surname><given-names>S</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name> (<year>2008</year>) <article-title>MUSTER: Improving protein sequence profile–profile alignments by using multiple sources of structure information</article-title>. <source>Proteins: Structure, Function, and Bioinformatics</source>
<volume>72</volume>: <fpage>547</fpage>–<lpage>556</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Rost</surname><given-names>B</given-names></name> (<year>1999</year>) <article-title>Twilight zone of protein sequence alignments</article-title>. <source>Protein Eng</source>
<volume>12</volume>: <fpage>85</fpage>–<lpage>94</lpage>. <pub-id pub-id-type="doi">10.1093/protein/12.2.85</pub-id>
<?supplied-pmid 10195279?><pub-id pub-id-type="pmid">10195279</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>Y</given-names></name>, <name><surname>Skolnick</surname><given-names>J</given-names></name> (<year>2005</year>) <article-title>The protein structure prediction problem could be solved using the current PDB library</article-title>. <source>Proc Natl Acad Sci USA</source>
<volume>102</volume>: <fpage>1029</fpage>–<lpage>1034</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.0407152101</pub-id>
<?supplied-pmid 15653774?><pub-id pub-id-type="pmid">15653774</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Jones</surname><given-names>DT</given-names></name>, <name><surname>Buchan</surname><given-names>DWA</given-names></name>, <name><surname>Cozzetto</surname><given-names>D</given-names></name>, <name><surname>Pontil</surname><given-names>M</given-names></name> (<year>2012</year>) <article-title>PSICOV: Precise structural contact prediction using sparse inverse covariance estimation on large multiple sequence alignments</article-title>. <source>Bioinformatics</source>
<volume>28</volume> (<issue>2</issue>): <fpage>184</fpage>–<lpage>190</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btr638</pub-id>
<?supplied-pmid 22101153?><pub-id pub-id-type="pmid">22101153</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Seemayer</surname><given-names>S</given-names></name>, <name><surname>Gruber</surname><given-names>M</given-names></name>, <name><surname>Söding</surname><given-names>J</given-names></name> (<year>2014</year>) <article-title>CCMpred—fast and precise prediction of protein residue–residue contacts from correlated mutations</article-title>. <source>Bioinformatics</source>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Kamisetty</surname><given-names>H</given-names></name>, <name><surname>Ovchinnikov</surname><given-names>S</given-names></name>, <name><surname>Baker</surname><given-names>D</given-names></name> (<year>2013</year>) <article-title>Assessing the utility of coevolution-based residue-residue contact predictions in a sequence- and structure-rich era</article-title>. <source>Proc Natl Acad Sci U S A</source>
<volume>110</volume>: <fpage>15674</fpage>–<lpage>15679</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1314045110</pub-id>
<?supplied-pmid 24009338?><pub-id pub-id-type="pmid">24009338</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Magnus</surname><given-names>E</given-names></name>, <name><surname>Cecilia</surname><given-names>L</given-names></name>, <name><surname>Yueheng</surname><given-names>L</given-names></name>, <name><surname>Martin</surname><given-names>W</given-names></name>, <name><surname>Erik</surname><given-names>A</given-names></name> (<year>2013</year>) <article-title>Improved contact prediction in proteins: using pseudolikelihoods to infer Potts models</article-title>. <source>Phys Rev E Stat Nonlin Soft Matter Phys</source>
<volume>87</volume>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Jones</surname><given-names>DT</given-names></name>, <name><surname>Singh</surname><given-names>T</given-names></name>, <name><surname>Kosciolek</surname><given-names>T</given-names></name>, <name><surname>Tetchner</surname><given-names>S</given-names></name> (<year>2015</year>) <article-title>MetaPSICOV: Combining coevolution methods for accurate prediction of contacts and long range hydrogen bonding in proteins</article-title>. <source>Bioinformatics</source>
<volume>31</volume> (<issue>7</issue>): <fpage>999</fpage>–<lpage>1006</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btu791</pub-id>
<?supplied-pmid 25431331?><pub-id pub-id-type="pmid">25431331</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Skwark</surname><given-names>MJ</given-names></name>, <name><surname>Raimondi</surname><given-names>D</given-names></name>, <name><surname>Michel</surname><given-names>M</given-names></name>, <name><surname>Elofsson</surname><given-names>A</given-names></name> (<year>2014</year>) <article-title>Improved Contact Predictions Using the Recognition of Protein Like Contact Patterns</article-title>. <source>PLoS Comput Biol</source>
<volume>10</volume>: <fpage>e1003889</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pcbi.1003889</pub-id>
<?supplied-pmid 25375897?><pub-id pub-id-type="pmid">25375897</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Wu</surname><given-names>S</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name> (<year>2008</year>) <article-title>A comprehensive assessment of sequence-based and template-based methods for protein contact prediction</article-title>. <source>Bioinformatics</source>
<volume>24</volume>: <fpage>924</fpage>–<lpage>931</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btn069</pub-id>
<?supplied-pmid 18296462?><pub-id pub-id-type="pmid">18296462</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>He</surname><given-names>B</given-names></name>, <name><surname>Mortuza</surname><given-names>SM</given-names></name>, <name><surname>Wang</surname><given-names>Y</given-names></name>, <name><surname>Shen</surname><given-names>HB</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name> (<year>2017</year>) <article-title>NeBcon: protein contact map prediction using neural network training coupled with naive Bayes classifiers</article-title>. <source>Bioinformatics</source>
<volume>33</volume>: <fpage>2296</fpage>–<lpage>2306</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btx164</pub-id>
<?supplied-pmid 28369334?><pub-id pub-id-type="pmid">28369334</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>S</given-names></name>, <name><surname>Sun</surname><given-names>S</given-names></name>, <name><surname>Li</surname><given-names>Z</given-names></name>, <name><surname>Zhang</surname><given-names>R</given-names></name>, <name><surname>Xu</surname><given-names>J</given-names></name> (<year>2017</year>) <article-title>Accurate De Novo Prediction of Protein Contact Map by Ultra-Deep Learning Model</article-title>. <source>PLoS Comput Biol</source>
<volume>13</volume>: <fpage>e1005324</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pcbi.1005324</pub-id>
<?supplied-pmid 28056090?><pub-id pub-id-type="pmid">28056090</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Skolnick</surname><given-names>J</given-names></name>, <name><surname>Kihara</surname><given-names>D</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name> (<year>2004</year>) <article-title>Development and large scale benchmark testing of the PROSPECTOR_3 threading algorithm</article-title>. <source>Proteins: Structure, Function, and Bioinformatics</source>
<volume>56</volume>: <fpage>502</fpage>–<lpage>518</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Ovchinnikov</surname><given-names>S</given-names></name>, <name><surname>Park</surname><given-names>H</given-names></name>, <name><surname>Varghese</surname><given-names>N</given-names></name>, <name><surname>Huang </surname><given-names>P-S</given-names></name>, <name><surname>Pavlopoulos</surname><given-names>GA</given-names></name>, <etal>et al</etal> (<year>2017</year>) <article-title>Protein structure determination using metagenome sequence data</article-title>. <source>Science</source>
<volume>355</volume>: <fpage>294</fpage>
<pub-id pub-id-type="doi">10.1126/science.aah4043</pub-id>
<?supplied-pmid 28104891?><pub-id pub-id-type="pmid">28104891</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref028">
      <label>28</label>
      <mixed-citation publication-type="book"><name><surname>Shibberu</surname><given-names>Y</given-names></name>, <name><surname>Holder</surname><given-names>A</given-names></name>, <name><surname>Lutz</surname><given-names>K</given-names></name>. <source>Fast Protein Structure Alignment</source>. In: <name><surname>Borodovsky</surname><given-names>M</given-names></name>, <name><surname>Gogarten</surname><given-names>JP</given-names></name>, <name><surname>Przytycka</surname><given-names>TM</given-names></name>, <name><surname>Rajasekaran</surname><given-names>S</given-names></name>, editors; <year>2010</year> 2010//; <publisher-loc>Berlin, Heidelberg</publisher-loc>
<publisher-name>Springer Berlin Heidelberg</publisher-name> pp. <fpage>152</fpage>–<lpage>165</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Shibberu</surname><given-names>Y</given-names></name>, <name><surname>Holder</surname><given-names>A</given-names></name> (<year>2011</year>) <article-title>A Spectral Approach to Protein Structure Alignment</article-title>. <source>IEEE/ACM Transactions on Computational Biology and Bioinformatics</source>
<volume>8</volume>: <fpage>867</fpage>–<lpage>875</lpage>. <pub-id pub-id-type="doi">10.1109/TCBB.2011.24</pub-id>
<?supplied-pmid 21301031?><pub-id pub-id-type="pmid">21301031</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Teichert</surname><given-names>F</given-names></name>, <name><surname>Bastolla</surname><given-names>U</given-names></name>, <name><surname>Porto</surname><given-names>M</given-names></name> (<year>2007</year>) <article-title>SABERTOOTH: protein structural alignment based on a vectorial structure representation</article-title>. <source>BMC Bioinformatics</source>
<volume>8</volume>: <fpage>425</fpage>
<pub-id pub-id-type="doi">10.1186/1471-2105-8-425</pub-id>
<?supplied-pmid 17974011?><pub-id pub-id-type="pmid">17974011</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Di Lena</surname><given-names>P</given-names></name>, <name><surname>Fariselli</surname><given-names>P</given-names></name>, <name><surname>Margara</surname><given-names>L</given-names></name>, <name><surname>Vassura</surname><given-names>M</given-names></name>, <name><surname>Casadio</surname><given-names>R</given-names></name> (<year>2010</year>) <article-title>Fast overlapping of protein contact maps by alignment of eigenvectors</article-title>. <source>Bioinformatics</source>
<volume>26</volume>: <fpage>2250</fpage>–<lpage>2258</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btq402</pub-id>
<?supplied-pmid 20610612?><pub-id pub-id-type="pmid">20610612</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Teichert</surname><given-names>F</given-names></name>, <name><surname>Minning</surname><given-names>J</given-names></name>, <name><surname>Bastolla</surname><given-names>U</given-names></name>, <name><surname>Porto</surname><given-names>M</given-names></name> (<year>2010</year>) <article-title>High quality protein sequence alignment by combining structural profile prediction and profile alignment using SABERTOOTH</article-title>. <source>BMC Bioinformatics</source>
<volume>11</volume>: <fpage>251</fpage>
<pub-id pub-id-type="doi">10.1186/1471-2105-11-251</pub-id>
<?supplied-pmid 20470364?><pub-id pub-id-type="pmid">20470364</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Buchan</surname><given-names>DWA</given-names></name>, <name><surname>Jones</surname><given-names>DT</given-names></name> (<year>2017</year>) <article-title>EigenTHREADER: analogous protein fold recognition by efficient contact map threading</article-title>. <source>Bioinformatics</source>
<volume>33</volume>: <fpage>2684</fpage>–<lpage>2690</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btx217</pub-id>
<?supplied-pmid 28419258?><pub-id pub-id-type="pmid">28419258</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref034">
      <label>34</label>
      <mixed-citation publication-type="other">Galaktionov SS, Marshall GR (1996) Prediction of protein structure in terms of intraglobular contacts: 1d to 2d to 3d. Fourth International Conference on Computational Biology, Intelligent Systems for Molecular Biology ‘96, St Louis, Missouri, USA.</mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Altschul</surname><given-names>SF</given-names></name>, <name><surname>Gish</surname><given-names>W</given-names></name>, <name><surname>Miller</surname><given-names>W</given-names></name>, <name><surname>Myers</surname><given-names>EW</given-names></name>, <name><surname>Lipman</surname><given-names>DJ</given-names></name> (<year>1990</year>) <article-title>Basic local alignment search tool</article-title>. <source>Journal of Molecular Biology</source>
<volume>215</volume>: <fpage>403</fpage>–<lpage>410</lpage>. <pub-id pub-id-type="doi">10.1016/S0022-2836(05)80360-2</pub-id>
<?supplied-pmid 2231712?><pub-id pub-id-type="pmid">2231712</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Chandonia</surname><given-names>JM</given-names></name>, <name><surname>Fox</surname><given-names>NK</given-names></name>, <name><surname>Brenner</surname><given-names>SE</given-names></name> (<year>2017</year>) <article-title>SCOPe: Manual Curation and Artifact Removal in the Structural Classification of Proteins—extended Database</article-title>. <source>J Mol Biol</source>
<volume>429</volume>: <fpage>348</fpage>–<lpage>355</lpage>. <pub-id pub-id-type="doi">10.1016/j.jmb.2016.11.023</pub-id>
<?supplied-pmid 27914894?><pub-id pub-id-type="pmid">27914894</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>Y</given-names></name>, <name><surname>Skolnick</surname><given-names>J</given-names></name> (<year>2005</year>) <article-title>TM-align: a protein structure alignment algorithm based on the TM-score</article-title>. <source>Nucleic Acids Res</source>
<volume>33</volume>: <fpage>2302</fpage>–<lpage>2309</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gki524</pub-id>
<?supplied-pmid 15849316?><pub-id pub-id-type="pmid">15849316</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Wu</surname><given-names>ST</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name> (<year>2007</year>) <article-title>LOMETS: A local meta-threading-server for protein structure prediction</article-title>. <source>Nucl Acids Res</source>
<volume>35</volume>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>Y</given-names></name>, <name><surname>Hu</surname><given-names>J</given-names></name>, <name><surname>Zhang</surname><given-names>C</given-names></name>, <name><surname>Yu</surname><given-names>D-J</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name> (<year>2019</year>) <article-title>ResPRE: high-accuracy protein contact prediction by coupling precision matrix with deep residual neural networks</article-title>. <source>Bioinformatics</source>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Madera</surname><given-names>M</given-names></name> (<year>2008</year>) <article-title>Profile Comparer: a program for scoring and aligning profile hidden Markov models</article-title>. <source>Bioinformatics</source>
<volume>24</volume>: <fpage>2630</fpage>–<lpage>2631</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btn504</pub-id>
<?supplied-pmid 18845584?><pub-id pub-id-type="pmid">18845584</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Jaroszewski</surname><given-names>L</given-names></name>, <name><surname>Rychlewski</surname><given-names>L</given-names></name>, <name><surname>Li</surname><given-names>Z</given-names></name>, <name><surname>Li</surname><given-names>W</given-names></name>, <name><surname>Godzik</surname><given-names>A</given-names></name> (<year>2005</year>) <article-title>FFAS03: a server for profile–profile sequence alignments</article-title>. <source>Nucleic Acids Research</source>
<volume>33</volume>: <fpage>W284</fpage>–<lpage>W288</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gki418</pub-id>
<?supplied-pmid 15980471?><pub-id pub-id-type="pmid">15980471</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref042">
      <label>42</label>
      <mixed-citation publication-type="other">Pons P, Latapy M (2005) Computing Communities in Large Networks Using Random Walks. In: Yolum p, Güngör T, Gürgen F, Özturan C, editors. Computer and Information Sciences—ISCIS 2005: 20th International Symposium, Istanbul, Turkey, October 26–28, 2005 Proceedings. Berlin, Heidelberg: Springer Berlin Heidelberg. pp. 284–293.</mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>Y</given-names></name>, <name><surname>Hu</surname><given-names>J</given-names></name>, <name><surname>Zhang</surname><given-names>C</given-names></name>, <name><surname>Yu</surname><given-names>D</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name> (<year>2019</year>) <article-title>ResPRE: high-accuracy protein contact prediction by coupling precision matrix with deep residual neural networks</article-title>. <source>Bioinformatics</source>: in press.</mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Zheng</surname><given-names>W</given-names></name>, <name><surname>Li</surname><given-names>Y</given-names></name>, <name><surname>Zhang</surname><given-names>C</given-names></name>, <name><surname>Pearce</surname><given-names>R</given-names></name>, <name><surname>Mortuza</surname><given-names>SM</given-names></name>, <etal>et al</etal> (<year>2019</year>) <article-title>Deep-learning contact-map guided protein structure prediction in CASP13</article-title>. <source>Proteins</source>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Brunger</surname><given-names>AT</given-names></name>, <name><surname>Adams</surname><given-names>PD</given-names></name>, <name><surname>Clore</surname><given-names>GM</given-names></name>, <name><surname>DeLano</surname><given-names>WL</given-names></name>, <name><surname>Gros</surname><given-names>P</given-names></name>, <etal>et al</etal> (<year>1998</year>) <article-title>Crystallography &amp; NMR System: A New Software Suite for Macromolecular Structure Determination</article-title>. <source>Acta Crystallographica Section D</source>
<volume>54</volume>: <fpage>905</fpage>–<lpage>921</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Needleman</surname><given-names>SB</given-names></name>, <name><surname>Wunsch</surname><given-names>CD</given-names></name> (<year>1970</year>) <article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins</article-title>. <source>J Mol Biol</source>
<volume>48</volume>: <fpage>443</fpage>–<lpage>453</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2836(70)90057-4</pub-id>
<?supplied-pmid 5420325?><pub-id pub-id-type="pmid">5420325</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>He</surname><given-names>K</given-names></name>, <name><surname>Zhang</surname><given-names>X</given-names></name>, <name><surname>Ren</surname><given-names>S</given-names></name>, <name><surname>Sun</surname><given-names>J</given-names></name>. <source>Deep residual learning for image recognition</source>; <year>2016</year> pp. <fpage>770</fpage>–<lpage>778</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref048">
      <label>48</label>
      <mixed-citation publication-type="other">Kingma DP, Ba J (2014) Adam: A method for stochastic optimization. arXiv preprint arXiv:14126980.</mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref049">
      <label>49</label>
      <mixed-citation publication-type="other">Paszke A, Gross S, Chintala S, Chanan G, Yang E, et al. (2017) Automatic differentiation in PyTorch.</mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref050">
      <label>50</label>
      <mixed-citation publication-type="book"><name><surname>Bronshtein</surname><given-names>IN</given-names></name>, <name><surname>Semendyayev</surname><given-names>KA</given-names></name>, <name><surname>Musiol</surname><given-names>G</given-names></name>, <name><surname>Muehlig</surname><given-names>H</given-names></name>, editors (<year>2003</year>) <source>Handbook of Mathematics</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Springer</publisher-name>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref051">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>Y</given-names></name>, <name><surname>Skolnick</surname><given-names>J</given-names></name> (<year>2004</year>) <article-title>SPICKER: A clustering approach to identify near-native protein folds</article-title>. <source>Journal of Computational Chemistry</source>
<volume>25</volume>: <fpage>865</fpage>–<lpage>871</lpage>. <pub-id pub-id-type="doi">10.1002/jcc.20011</pub-id>
<?supplied-pmid 15011258?><pub-id pub-id-type="pmid">15011258</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007411.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>J</given-names></name>, <name><surname>Liang</surname><given-names>Y</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name> (<year>2011</year>) <article-title>Atomic-Level Protein Structure Refinement Using Fragment-Guided Molecular Dynamics Conformation Sampling</article-title>. <source>Structure</source>
<volume>19</volume>: <fpage>1784</fpage>–<lpage>1795</lpage>. <pub-id pub-id-type="doi">10.1016/j.str.2011.09.022</pub-id>
<?supplied-pmid 22153501?><pub-id pub-id-type="pmid">22153501</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
