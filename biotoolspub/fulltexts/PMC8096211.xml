<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8096211</article-id>
    <article-id pub-id-type="pmid">33511407</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkab010</article-id>
    <article-id pub-id-type="publisher-id">gkab010</article-id>
    <article-categories>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00010</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>Narese/7</subject>
        <subject>Narese/24</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Methods Online</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A benchmark and an algorithm for detecting germline transposon insertions and measuring <italic>de novo</italic> transposon insertion frequencies</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Yu</surname>
          <given-names>Tianxiong</given-names>
        </name>
        <aff><institution>Department of Thoracic Surgery, Clinical Translational Research Center, Shanghai Pulmonary Hospital, The School of Life Sciences and Technology, Tongji University</institution>, Shanghai 200092, <country country="CN">China</country></aff>
        <aff><institution>Program in Bioinformatics and Integrative Biology, University of Massachusetts Medical School</institution>, Worcester, MA 01605, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huang</surname>
          <given-names>Xiao</given-names>
        </name>
        <aff><institution>Department of Thoracic Surgery, Clinical Translational Research Center, Shanghai Pulmonary Hospital, The School of Life Sciences and Technology, Tongji University</institution>, Shanghai 200092, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dou</surname>
          <given-names>Shengqian</given-names>
        </name>
        <aff><institution>State Key Laboratory of Protein and Plant Gene Research, Center for Bioinformatics, School of Life Sciences and Peking-Tsinghua Center for Life Sciences, Peking University</institution>, Beijing 100871, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tang</surname>
          <given-names>Xiaolu</given-names>
        </name>
        <aff><institution>State Key Laboratory of Protein and Plant Gene Research, Center for Bioinformatics, School of Life Sciences and Peking-Tsinghua Center for Life Sciences, Peking University</institution>, Beijing 100871, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Luo</surname>
          <given-names>Shiqi</given-names>
        </name>
        <aff><institution>State Key Laboratory of Protein and Plant Gene Research, Center for Bioinformatics, School of Life Sciences and Peking-Tsinghua Center for Life Sciences, Peking University</institution>, Beijing 100871, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Theurkauf</surname>
          <given-names>William E</given-names>
        </name>
        <!--<email>william.theurkauf@umassmed.edu</email>-->
        <aff><institution>Program in Molecular Medicine, University of Massachusetts Medical School</institution>, Worcester, MA 01605, <country country="US">USA</country></aff>
        <xref ref-type="corresp" rid="COR2"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4409-1667</contrib-id>
        <name>
          <surname>Lu</surname>
          <given-names>Jian</given-names>
        </name>
        <!--<email>luj@pku.edu.cn</email>-->
        <aff><institution>State Key Laboratory of Protein and Plant Gene Research, Center for Bioinformatics, School of Life Sciences and Peking-Tsinghua Center for Life Sciences, Peking University</institution>, Beijing 100871, <country country="CN">China</country></aff>
        <xref ref-type="corresp" rid="COR3"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3032-7966</contrib-id>
        <name>
          <surname>Weng</surname>
          <given-names>Zhiping</given-names>
        </name>
        <!--<email>zhiping.weng@umassmed.edu</email>-->
        <aff><institution>Department of Thoracic Surgery, Clinical Translational Research Center, Shanghai Pulmonary Hospital, The School of Life Sciences and Technology, Tongji University</institution>, Shanghai 200092, <country country="CN">China</country></aff>
        <aff><institution>Program in Bioinformatics and Integrative Biology, University of Massachusetts Medical School</institution>, Worcester, MA 01605, <country country="US">USA</country></aff>
        <xref ref-type="corresp" rid="COR1"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Tel: +1 508 856 8866; Email: <email>zhiping.weng@umassmed.edu</email></corresp>
      <corresp id="COR2">Correspondence may also be addressed to William E. Theurkauf. Email: <email>william.theurkauf@umassmed.edu</email></corresp>
      <corresp id="COR3">Correspondence may also be addressed to Jian Lu. Email: <email>luj@pku.edu.cn</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>07</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-01-28">
      <day>28</day>
      <month>1</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>1</month>
      <year>2021</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>49</volume>
    <issue>8</issue>
    <fpage>e44</fpage>
    <lpage>e44</lpage>
    <history>
      <date date-type="accepted">
        <day>06</day>
        <month>1</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>28</day>
        <month>12</month>
        <year>2020</year>
      </date>
      <date date-type="received">
        <day>23</day>
        <month>6</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press on behalf of Nucleic Acids Research.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="gkab010.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Transposons are genomic parasites, and their new insertions can cause instability and spur the evolution of their host genomes. Rapid accumulation of short-read whole-genome sequencing data provides a great opportunity for studying new transposon insertions and their impacts on the host genome. Although many algorithms are available for detecting transposon insertions, the task remains challenging and existing tools are not designed for identifying <italic>de novo</italic> insertions. Here, we present a new benchmark fly dataset based on PacBio long-read sequencing and a new method TEMP2 for detecting germline insertions and measuring <italic>de novo</italic> ‘singleton’ insertion frequencies in eukaryotic genomes. TEMP2 achieves high sensitivity and precision for detecting germline insertions when compared with existing tools using both simulated data in fly and experimental data in fly and human. Furthermore, TEMP2 can accurately assess the frequencies of <italic>de novo</italic> transposon insertions even with high levels of chimeric reads in simulated datasets; such chimeric reads often occur during the construction of short-read sequencing libraries. By applying TEMP2 to published data on hybrid dysgenic flies inflicted by de-repressed <italic>P-elements</italic>, we confirmed the continuous new insertions of <italic>P-elements</italic> in dysgenic offspring before they regain piRNAs for <italic>P-element</italic> repression. TEMP2 is freely available at Github: <ext-link ext-link-type="uri" xlink:href="https://github.com/weng-lab/TEMP2">https://github.com/weng-lab/TEMP2</ext-link>.</p>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Chinese National Natural Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>31871296</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>HD078253</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="16"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>INTRODUCTION</title>
    <p>First discovered in the maze, transposons are mobile genetic elements that constitute up to 85% of metazoan genomes (<xref rid="B1" ref-type="bibr">1</xref>). Although transposons are often regarded as junk DNA, they play important roles in genomic variation and evolution (<xref rid="B2" ref-type="bibr">2–4</xref>). The movement of transposons often leads to genome instability and diseases, including infertility and cancer (<xref rid="B5" ref-type="bibr">5–8</xref>). Therefore, it is of great interest to annotate transposon insertion profiles in different cell types, during development, in disease states, or across individuals in a population. However, accurate detection of transposon insertions remains a challenge due to the highly repetitive sequences of transposons. Furthermore, short-read sequencing libraries contain chimeric reads, which are difficult to distinguish from the reads originating from low-frequency new transposon insertions (<xref rid="B9" ref-type="bibr">9</xref>).</p>
    <p>Many algorithms have been developed to detect transposon insertions, including ERVcaller, MELT, RetroSeq, RelocaTE2 and TEMP, with TEMP being developed by us previously (<xref rid="B10" ref-type="bibr">10–15</xref>). All of these algorithms identify transposon insertions using the same strategy—clustering discordant read-pairs, which have one read mapping to the reference genome and the other read mapping to a transposon consensus sequence. These algorithms perform similarly well in detecting typical transposon insertions, and the differences between them lie in the ability to filter out false-positive predictions and to identify atypical insertions, those of low frequencies and those from short or homologous transposons. MELT, which was developed as part of the 1000 Genomes Project, carefully identifies discordant and split read-pairs for transposon detection. (Split read-pairs map to just one location of the genome but the 5′-end of one read is soft-clipped.) It is able to detect transposon insertions in low sequencing-depth data, but it also makes many false-positive predictions. ERVcaller and TEMP are stricter at assessing discordant and split read-pairs, which leads to higher precision. RetroSeq and TEMP are primarily designed for long transposons and are not suitable for detecting insertions of short transposons. Each of these tools works well on specific datasets or on specific transposons, but it is unclear whether they work well across a broad range of datasets and on all transposons; this is because there are few benchmark datasets for algorithm comparison. Moreover, the existing tools do not have the functionality to identify <italic>de novo</italic> transpositions, which occur in a single generation and reflect on-going transposon activity.</p>
    <p>This paper makes two contributions. First, we present a new software TEMP2, which combines the best components of existing algorithms for detecting germline transposon insertions and applies thorough filtering steps to reduce false-discovery predictions while maintaining a high sensitivity. TEMP2 has a new functionality of estimating the rate of <italic>de novo</italic> transposon insertions, taking advantage of the knowledge that discordant read-pairs that truly originate from recent transposon insertions should be enriched in the ends of full-length transposons. Second, we performed PacBio long-read sequencing and Illumila short-read sequencing in <italic>Drosophila melanogaster</italic> and curated a set of transposon insertions using the PacBio data. These two datasets should be useful for benchmarking the performance of algorithms for detecting transposon insertions. Evaluated using the aforementioned state-of-the-art transposon algorithms on simulated data in flies, our PacBio-Illumina fly data, and human data from the 1000 Genomes Project, TEMP2 showed the best overall performance regarding sensitivity, precision, frequency accuracy, breakpoint accuracy, and transposon-end accuracy. We applied TEMP2 to estimate <italic>de novo</italic> insertion rates in simulated and hybrid dysgenic fly data, revealing the on-going transposon activities while these flies recover from the initial deficiency in piRNA production and transposon derepression. TEMP2 is freely available at Github: <ext-link ext-link-type="uri" xlink:href="https://github.com/weng-lab/TEMP2">https://github.com/weng-lab/TEMP2</ext-link>.</p>
  </sec>
  <sec sec-type="materials|methods" id="SEC2">
    <title>MATERIALS AND METHODS</title>
    <sec id="SEC2-1">
      <title>The TEMP2 pipeline</title>
      <p>The overall pipeline of TEMP2 is shown in Figure <xref ref-type="fig" rid="F1">1</xref>, containing three steps described as follows.</p>
      <fig id="F1" orientation="portrait" position="float">
        <label>Figure 1.</label>
        <caption>
          <p>Diagrams depicting how TEMP2 detects new germline and <italic>de novo</italic> transposon insertions. (<bold>A</bold>) Detection of new transposon insertions. The method contains three steps: alignment, clustering/classifying, and filtering. Paired-end reads are depicted as pairs of boxes each connected by a short horizontal line: open boxes for unmapped reads and colored boxes for mapped reads. The reference genome is represented as a blue line while a transposon element (TE) as a red line. The portion of a read mapped to the reference genome is marked in blue and the portion of the read mapped to a transposon is marked in red. Properly mapped read-pairs are connected by solid lines while discordant read-pairs are connected by dashed lines. Transposon-supporting read-pairs that are anchored at the same genomic locus (defined as within 95% of the fragment length of the sequencing library) are clustered. A 1p1 cluster is supported by multiple read-pairs with at least one read-pair on each side of the transposon insertion, a 2p cluster is supported by two or more read-pairs, but only on one side of the insertion, and unclustered read-pairs are singletons. (<bold>B</bold>) Estimation of the total number of <italic>de novo</italic> insertions of a transposon family. All raw reads (empty boxes) and singleton reads as defined in A. (colored boxes) are aligned to the consensus sequence of each transposon family. According to where in the consensus the reads map, they are classified as end-mapping reads and center-mapping reads (see Materials and Methods). The total number of <italic>de novo</italic> insertions of a transposon family is defined as the difference between the actual number of end-mapping singleton reads and the expected number of end-mapping chimera reads, with the latter estimated using center-mapping singleton reads and all reads.</p>
        </caption>
        <graphic xlink:href="gkab010fig1"/>
      </fig>
      <p>The first step of TEMP2 is mapping reads to the reference genome using the bwa mem algorithm (<xref rid="B16" ref-type="bibr">16</xref>) with the following command: bwa mem -T 20 -Y. Two types of read-pairs are then extracted from the mapping results: (i) discordantly mapped read-pairs for which one read is uniquely mapped to the reference genome while the other read is unmappable or mapped to multiple locations in the genome (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1</xref>; read-pairs #1–#8, #13–#36, and #41–#56); (ii) split read-pairs that are properly mapped to just one location of the genome but the 5′-end of one read is soft-clipped (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1</xref>; read-pairs #9–#12 and #37–#40). The unmappable, multiply mapped reads, and split reads are then aligned to transposon consensus sequences using bwa mem, and the read-pairs that can be mapped to transposons are considered as reads that can support transposon insertions.</p>
      <p>The second step of TEMP2 is clustering and classifying. Two transposon-supporting reads are placed into the same cluster if they satisfy either of the following two conditions: (i) they map to the same side of a transposon insertion and the distance between their mapped locations in the genome is smaller than the 95% quantile of the fragment length of the sequencing library, or (ii) they map to the opposite sides of a transposon insertion and their distance is smaller than twice the 95% quantile of the fragment length of the sequencing library. We then determine the breakpoints of an insertion using the soft-clipping site of split reads. If no split reads are available, we set the average coordinate of the 3′-ends of the supporting reads (Figure <xref ref-type="fig" rid="F1">1A</xref>) as the breakpoint. All insertions supported by read clusters are classified into three types according to their genomic location and read count: 1p1 (one-plus-one) insertions are supported by read-pairs on both sides of the insertion; 2p (two-plus) insertions are supported by two or more read-pairs but these reads all come from one side of the insertion; and <italic>de novo</italic> insertions are supported by only one (i.e. singleton) read-pair. TEMP2 considers 1p1 and 2p insertions as germline insertions that are passed on to the next generation and uses singleton read-pairs to estimate the level of <italic>de novo</italic> insertions, which include the insertions into somatic genomes or the insertions into the germline genomes that do not lead to offspring. TEMP2 also allows users to set an insertion-frequency threshold for classifying whether an insertion is <italic>de novo</italic>, which is necessary when the sequencing library is constructed from a small number of cells because in such cases <italic>de novo</italic> insertions may be supported by multiple reads due to PCR amplification of the small amount of starting DNA.</p>
      <p>The third step of TEMP2 is filtering. Three types of filtering are applied to remove false-positive insertions. First, TEMP2 discards insertions by a transposon into a location in the genome that is annotated to contain a copy of the same transposons, because the discordant reads that support such insertions are likely due to sequence alignment errors. Furthermore, we place these insertion positions on a blacklist to filter out other insertions detected at the same genomic positions, which often come from transposons in the same family, again, suggesting alignment errors. Second, TEMP2 estimates the sequencing depth in the genomic region around each candidate insertion and compares it with the average sequencing depth across the whole genome. The number of mapped genome-sequencing reads that fall in a genomic window follows a bimodal distribution with one mode around the average coverage and the other mode much higher than five times the average coverage (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S2A</xref>). Specifically, in our Illumina sequencing data, 0.226% genomic windows had 5× or more reads than the overall genome coverage (27.1×). Thus, we filtered out the insertions located in genomic regions with 5× or higher sequencing depths. Third, TEMP2 merges the insertions at exactly the same genomic position—the vast majority of these insertions are from related transposon subfamilies—and assigns all supporting reads to the insertion with the most supporting reads. We conducted these three filtering steps immediately after calling potential transposon insertions to minimize the number of insertions and insertion-containing genomic regions that we need to examine, reducing TEMP2’s runtime.</p>
      <p>After identifying germline transposon insertions, TEMP2 also estimates the frequency for each transposon insertion. Properly mapped unsplit read-pairs crossing more than 20 bp of an insertion breakpoint are defined as reference read-pairs. The frequency of each transposon insertion is estimated using the equation below:<disp-formula><tex-math id="M1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}{\rm insertion}\ {\rm frequency} = \frac {{\rm supporting}\ {\rm reads}} {( {{\rm supporting}\ {\rm reads}\ + \ {\rm reference}\ {\rm reads}\ \times \ 2})}\end{equation*}$$\end{document}</tex-math></disp-formula></p>
      <p>TEMP2 estimates the overall level of <italic>de novo</italic> transposon insertions for each transposon family in the whole genome using transposon-supporting singleton reads; however, TEMP2 does not make predictions on transposon insertions at individual loci. To detect <italic>de novo</italic> insertions, TEMP2 must guard against the chimera reads introduced during library construction, which are often singletons. Chimera reads should map to all locations in a transposon consensus sequence uniformly, while singleton reads that support transposon insertions should be enriched in the two ends of the transposon consensus sequence, as far into the interior of the consensus sequence as the fragment length of the sequencing library would allow. Thus, we can use singleton reads that map to the center region (the consensus sequence minus the two ends) to estimate the number of chimeric reads. TEMP2 determines the fragment lengths for all the read-pairs that map entirely to a unique location in the reference genome and then defines the end of a transposon as the 95th percentile fragment length minus 25 nts. The number of <italic>de novo</italic> insertions of a transposon family can be inferred by the difference between the number of end-mapping singleton reads and the number of center-mapping singleton reads; thus, the overall level of <italic>de novo</italic> insertions of a transposon family is:<disp-formula><tex-math id="M2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}{\rm singleton\ end\ reads} - {\rm singleton\ center\ reads}\, \left( \frac {{\rm all\ end\ reads}} {{\rm all\ center\ reads}}\right )\end{equation*}$$\end{document}</tex-math></disp-formula></p>
      <p>TEMP2 outputs a confidence score (ranging from 0–100%) for each transposon family that equals one minus our estimated overall rate of chimera reads for this transposon family. <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S2B</xref> uses two example transposons to illustrate how TEMP2 estimates <italic>de novo</italic> insertion frequencies. Using our Illumina sequencing data, TEMP2 estimates that <italic>roo</italic> does not have a higher than the background level of <italic>de novo</italic> insertions because its total number of singleton end–reads does not exceed the expected number of singleton end–reads, while <italic>Tirant</italic> is estimated to have 43 <italic>de novo</italic> insertions.</p>
      <p>In a typical application when a sufficiently large number of cells (thousands or more) is used in the starting material to prepare the sequencing library, TEMP2 only considers singleton insertions as potential <italic>de novo</italic> insertions to estimate the genome-wide <italic>de novo</italic> insertion rate. In the rare cases when a limited number of genomes (hundreds or less) is used in the starting material, TEMP2 will not just consider singleton insertions, but will instead ask the user to provide the number of genomes in the starting material and then automatically set the insertion frequency threshold to be two times the theoretical frequency of <italic>de novo</italic> insertions for distinguishing potential <italic>de novo</italic> insertions from germline insertions.</p>
      <p>To account for the cases of truncated <italic>de novo</italic> insertions such as 5′ truncated L1 elements (<xref rid="B15" ref-type="bibr">15</xref>,<xref rid="B17" ref-type="bibr">17</xref>,<xref rid="B18" ref-type="bibr">18</xref>), TEMP2 can also classify singleton reads that map to the two ends of fragmented transposons as insertion-supporting reads (using the ‘-T’ option), if there are enough reads (by default three or more reads at each end) to support these fragmented transposons elsewhere in the genome. Such fragmented transposons are used together with full-length transposons in the same family for computing end-mapping reads and center-mapping reads in the above equation for computing the overall rate of <italic>de novo</italic> insertions.</p>
    </sec>
    <sec id="SEC2-2">
      <title>Simulated data</title>
      <p>To benchmark the performance of TEMP2 and other transposon-detection methods, a set of Illumina sequencing data was simulated (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S3</xref> for a summary). We simulated genomes with 400 new germline transposon insertions at different frequencies (0.25, 0.5, 0.75 and 1) and insertion lengths as follows. We first constructed 10 000 reference genomes (dm6) and then inserted 90 full-length transposons (randomly picked) and 10 partial-length transposons (6 <italic>I-element</italic>, 2 <italic>Doc</italic>, 2 <italic>F-element</italic>) into the same coordinates of 2500, 5000 or 7500 of the 10 000 reference genomes one by one. We also simulated 10 000 genomes with 20 somatic transposon insertions each. We inserted eight full-length <italic>297</italic>, four full-length <italic>copia</italic>, three full-length <italic>Tirant</italic>, two partial-length <italic>Doc</italic>, one full-length <italic>17.6</italic>, one full-length <italic>F-element</italic> and one full-length <italic>blood</italic>, hence 20 transposons in total, into different coordinates of the 10 000 simulated genomes one by one. Low mappability regions were excluded when inserting transposons.</p>
      <p>Illumina read-pairs were then simulated using the ART algorithm (version 2.5.1) with parameters -ss HS25 -p -l 100 (read length) -m 450 (fragment size) -s 10 -na (<xref rid="B19" ref-type="bibr">19</xref>). For each of the 10 000 simulated genomes, we simulated Illumina read-pairs at 0.0001×, 0.0002×, 0.0003×, 0.0004×, 0.0005×, 0.001×, 0.002×, 0.003×, 0.004× and 0.005× genome coverage by adding parameter -f. In total, Illumina read-pairs at the sequencing depth of 1–50× genome coverage for 10 000 simulated genomes were generated for each genome set. Not that by 1–50× genome coverage, we mean that the total number of nucleotides that mapped to the reference genome was at 1–50× the genome length. Two additional datasets with different percentages of chimera read-pairs (0.05% and 0.5%) were generated by combining two random reads into one read-pair.</p>
    </sec>
    <sec id="SEC2-3">
      <title>PacBio and Illumina whole-genome sequencing of <italic>Drosophila</italic></title>
      <p>For PacBio sequencing, the female virgin flies (ISO-1 strain, ∼180 individuals for each of two samples) were collected and starved for 1.5 h and flash-frozen in liquid nitrogen. Genomic DNA was extracted and purified with standard procedures. The DNA library preparation for PacBio sequencing was performed by following the PacBio protocol called ‘procedure &amp; checklist of 20 kb template preparation using the BluePippin size-selection system’. Briefly, the DNA was sheared by a Covaris g-TUBE device and purified using AMPure PB beads. The fragmented DNA was subject to DNA damage repairing and ligated with adapters. Then purified ligation products were size-selected using the BluePippin Size Selection system. After annealing and binding of SMRTbell templates and preparation for MagBead loading, the two libraries were run on the PacBio RS II and Sequel system in NextOmics (Wuhan, China), respectively. The sequencing results for each sample contained two SMART cells.</p>
      <p>For Illumina short-read sequencing, the whole bodies of 3–5-day-old female virgin flies (ISO-1 strain, ∼25 individuals) were collected and used for DNA extraction. DNA quality was assessed by OD260/OD280 with Nanodrop and agarose gel electrophoresis. The library for Illumina sequencing was prepared as follows: (i) fragmentation with Covaris ultrasonicator, (ii) end-repair and phosphorylation of the 5′ ends, (iii) A-tailing of the 3′ ends, (iv) ligation of adapters, (v) 12 cycles of PCR to enrich for the ligated product. Sequencing was done with the Illumina HiSeq-2500 sequencer (run type: paired-end; read length: 125 nt) in Novogene (Tianjin, China).</p>
    </sec>
    <sec id="SEC2-4">
      <title>Build a benchmark of transposon insertions using PacBio sequencing data</title>
      <p>PacBio sequencing data were transformed to the FASTA format and then aligned to the dm6 genome using the Minimap2 algorithm (version 2.16) with parameters -x map-pb –MD (<xref rid="B20" ref-type="bibr">20</xref>). The mapping result was then provided to the Sniffles algorithm for structural variation detection with parameters -l 300 -s 1 (<xref rid="B21" ref-type="bibr">21</xref>). Only insertions longer than 300-bp were retained for further analysis because the shortest transposon in <italic>D. melanogaster</italic> is <italic>Stalker3</italic>, which is 372-nt in full length. The sequences of insertions were extracted and aligned to transposon consensus sequences using Minimap2 again to define new transposon insertions. A new transposon insertion is considered valid if both of the following conditions are satisfied: (i) the aligned length is longer than half of the insertion (ii) the alignment starts within 500-nt of the 5′-end of the insertion and ends within 500-nt of the 3′-end of the insertion. Transposon insertions within 50 bp were merged, and insertions with more than one supporting read were retained and considered as germline transposon insertions. Breakpoints of the insertions were set to the insertion sites that were supported by the most reads. The 5′-end and 3′-end of each inserted transposon were also annotated. To estimate insertion frequencies, genome-mapping PacBio reads around each breakpoint were tallied. Reads that cross a breakpoint for at least 50 bps were defined as reference reads, and reads split within 50 bp of the breakpoint were defined as supporting reads. Some PacBio reads were long enough to split in both the 5′-end and the 3′-end of an insertion, and these reads were counted as two supporting reads. The insertion frequencies were then estimated using the same equation as TEMP2:<disp-formula><tex-math id="M3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}{\rm{insertion\ frequency\ }} = \frac {{\rm{\ supporting\ reads\ }}} {\left( {{\rm{supporting\ reads\ }} + {\rm{\ reference\ reads\ }} \times {\rm{\ }}2} \right)}\end{equation*}$$\end{document}</tex-math></disp-formula></p>
      <p>We then manually inspected each of the 405 transposon insertions detected using the PacBio data. Among these 405 insertions, 73 were located in an annotated copy of the same transposon in the reference genome. We visualized the PacBio raw reads supporting each insertion using the IGV browser (v2.7.2) to examine detailed alignments (<xref rid="B22" ref-type="bibr">22</xref>). Furthermore, we manually aligned each inserted sequence back to the transposon consensus sequence. For 11 high-frequency insertions supported by many PacBio reads, the insertion sites made by the supporting PacBio reads were typically at exactly the same location of the reference genome or within a few base-pairs of each other, indicating that these are true insertions. For the remaining 62 insertions, a portion of the supporting PacBio read could not align to the reference genome due to high sequencing errors in the portion. However, when we manually aligned the portion back to the transposon consensus sequence, more than half of the portion could be aligned. Furthermore, their supporting PacBio reads point to positions in the reference genome that were far from one another (hundreds to thousands of base pairs away), suggesting alignment errors. We deemed these insertions false positives. We further examined whether the 332 PacBio-detected insertions that were not in a copy of the same transposon could be supported by any Illumina reads. We first aligned Illumina reads to the reference genome via bwa mem using default parameters and then identified discordantly mapped read-pairs from the ± 500 bp region flanking each of the 332 insertions. We aligned these discordant read-pairs to transposon consensus sequences via bwa mem using default parameters. If there was at least one discordant read-pair that could align to the inserted transposon, we deemed the insertion supported by Illumina reads.</p>
    </sec>
    <sec id="SEC2-5">
      <title>Algorithm comparison</title>
      <p>The main differences between the algorithms assessed by us are listed in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S4</xref>. Algorithms were benchmarked on three sets of short-read whole-genome sequencing data: simulated <italic>D. melanogaster</italic> data, experimental <italic>D. melanogaster</italic> data we produced, and human data in the NA12878 lymphoblastoid cell line downloaded from the 1000 Genomes Project.</p>
      <p>For simulated and <italic>D. melanogaster</italic> data, default parameters for each algorithm were used. To achieve a fair comparison of the algorithms, the same cutoff of transposon-supporting reads were used for each of the algorithms (five reads). Sum of squared residue (SSR) was defined as the sum of errors of estimated <italic>de novo</italic> insertion rate across all transposons including the transposons with 0 simulated insertions:<disp-formula><tex-math id="M4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{eqnarray*}\mathop \sum \limits_{i\ = \ 1}^n {({\rm estimated\ }de\ novo{\ \rm insertion\ number\ per\ genome}}\nonumber\\ - {\rm{simulated\ }}de\ novo{\rm{\ insertion\ number\ per\ genome})^2}\end{eqnarray*}$$\end{document}</tex-math></disp-formula></p>
      <p>The SSRs were 0.3 for TEMP2 and 24.75 for TEMP (Figure <xref ref-type="fig" rid="F2">2F</xref>). When we considered only those seven transposons with non-zero simulated insertions, SSRs were 0.3 for TEMP2 and 17.69 for TEMP. The transposon library of <italic>D. melanogaster</italic> was downloaded from Flybase (<xref rid="B23" ref-type="bibr">23</xref>). Transposon insertions in the reference genome (dm6) were annotated using RepeatMasker with parameters -s -no_is -norna -nolow -e ncbi -cutoff 255 -div 40 -frag 20000 (<xref rid="B24" ref-type="bibr">24</xref>).</p>
      <fig id="F2" orientation="portrait" position="float">
        <label>Figure 2.</label>
        <caption>
          <p>The performance of TEMP2 on simulated datasets. Simulated Illumina read-pairs at different sequencing depth (1–50× genome coverage) were used for comparing the performance of TEMP2, TEMP, ERVcaller, MELT, RetroSeq and RelocaTE2 (in red, blue, green, yellow, purple and gray respectively). Panels A–D, germline insertions. Panels E-F, somatic insertions. Except for panel E, for which three levels of chimera read-pairs were tested, the datasets with 0.05% chimera read-pairs were used for all other panels. (<bold>A</bold>) Performance of TEMP2 and other transposon-detection methods in detecting transposon insertions. Three panels of line plots depict the sensitivity, precision, and F1 score of detecting germline transposon insertions, respectively, as a function of sequencing depth. (<bold>B</bold>) Accuracies of TEMP2, TEMP and RetroSeq in estimating transposon-insertion frequencies. Line plots show the average error of estimated frequencies of germline transposon insertions as a function of sequencing depth. (<bold>C</bold>) Accuracies of TEMP2 and other transposon-detection methods in identifying the breakpoints in the reference genome. Line plots show the average distance between detected and simulated breakpoints of new germline transposon insertions. (<bold>D</bold>) Accuracies of TEMP2 and two other transposon-insertion methods in predicting the ends of inserted transposons. Line plots show the average distance between detected and simulated transposon ends of new germline insertions. (<bold>E</bold>) Accuracies of TEMP2 and TEMP in estimating somatic transposon insertion numbers. Line plots show the sum of squared residuals (SSR) of estimated somatic insertion numbers for all transposon subfamilies. Simulated data with 0%, 0.05%, and 0.5% chimera were tested and the results are displayed as solid, dashed and dot-dashed lines respectively. This panel and panel F are benchmarked using simulated <italic>de novo</italic> insertions from six full-length transposons and one fragmented transposon (<italic>Doc</italic>). (<bold>F</bold>) Accuracies of TEMP2 and TEMP in estimating somatic transposon insertion numbers; the sequencing depth was set to 20×. Scatterplots compare simulated and estimated insertion numbers. Each dot denotes a transposon subfamily, and the 8 transposon subfamilies with simulated somatic insertions are in black while the other transposon subfamilies are in gray.</p>
        </caption>
        <graphic xlink:href="gkab010fig2"/>
      </fig>
      <p>We downloaded the .cram or .bam file of NA12878 low-depth and high-depth data from the 1000 Genomes Project. Although TEMP2 can directly work with these files, we wanted to ensure that the same parameters were used for genome mapping, so we extracted raw reads from these files using samtools (<xref rid="B25" ref-type="bibr">25</xref>) and then aligned the reads to hg38 using bwa mem with parameters ‘-T 20 -Y’ (<xref rid="B16" ref-type="bibr">16</xref>). Default parameters for ERVcaller, MELT, RetroSeq were used to analyze the NA12878 data. We allowed 10% sequence divergence for TEMP2 and TEMP when aligning reads to transposon consensus sequences, the same for MELT. To achieve a fair comparison of the algorithms, the same cutoff of transposon-supporting reads were used for each of the algorithms (3 for low-depth data and 10 for high-depth data). The transposon library, which contains Alu, SVA, and LINE1 consensus sequences, was downloaded from the MELT package (<xref rid="B10" ref-type="bibr">10</xref>). The reference insertion annotation of Alu, SVA, and LINE1 was also downloaded from the MELT package.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>RESULTS</title>
    <sec id="SEC3-1">
      <title>Design and Implementation of TEMP2</title>
      <p>TEMP2 is a complete redesign of our previous algorithm TEMP (<xref rid="B26" ref-type="bibr">26</xref>), which identifies transposon insertions using paired-end short reads. TEMP uses three steps to detect transposon insertions: alignment, clustering-classifying, and filtering. In TEMP2, we improved each of the steps to achieve higher accuracy in identifying germline transposon insertions and added a new module in TEMP2 for estimating the level of <italic>de novo</italic> transposon insertions (see Materials and Methods).</p>
      <p>TEMP2 has improved upon TEMP in all three steps (Figure <xref ref-type="fig" rid="F1">1A</xref>). In the first alignment step, discordant read-pairs, of which one read uniquely maps to the genome and the other maps entirely (unsplit) or partially (split) to distant transposon copies, are identified as possibly supporting a new transposon insertion in the genome (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1</xref>). TEMP only considers the unsplit reads, while TEMP2 additionally includes the split reads if their non-transposon mapping portions properly map to the genome, i.e. in the same orientation and within a distance cutoff defined as the 95th percentile of the fragment length of the sequencing library (see Materials and Methods). In the second clustering-classifying step, supporting reads are clustered, and the insertions supported by the read clusters are classified by genomic location and read count. Like TEMP, TEMP2 classifies insertions into three types: 1p1, supported by read-pairs on both sides of the insertion; 2p, supported by two or more read-pairs but on only one side of the insertion; and singletons, supported by only one read-pair. Going beyond TEMP’s classification, TEMP2 further deems 1p1 and 2p insertions as germline insertions but examines singleton read-pairs for estimating the genome-wide level of <italic>de novo</italic> transposition for each transposon family (a new module described next). In the third filtering step, some insertions are filtered out if they are likely false positives. Like TEMP, TEMP2 discards insertions of a transposon into an annotated copy of the same transposon in the genome because the supporting discordant reads are likely misaligned to this annotated copy due to the variations among the copies of the same transposon. TEMP2 further filters out insertions in regions that have 5× or higher sequencing depth (Materials and Methods). Such regions are determined for each specific dataset and likely reflect the incompleteness of the reference genome with respect to the genome that corresponds to the sample being assayed. Moreover, we observed that some genomic positions contained insertions from multiple transposons, and the vast majority of these insertions were from related transposon subfamilies. We observed this phenomenon even in simulated data where no TE subfamilies were simulated to be inserted in the same locus and at roughly the same frequency in our Illumina sequencing data as in the simulated data. These insertions are caused by ambiguous mapping of reads to related transposon subfamilies. Thus, TEMP2 merges the insertions at exactly the same genomic position and assigns all supporting reads to the transposon with the most supporting reads.</p>
      <p>We developed a new module in TEMP2 to estimate the overall level of <italic>de novo</italic> insertions for each transposon family. Such <italic>de novo</italic> insertions can be in somatic cells or in the germ cells that do not develop into the next generation of individuals. The identification of <italic>de novo</italic> insertions is challenging; they are often present in only one cell or a few cells derived from a single progenitor, and therefore present at very low frequencies and dispersed throughout the genome, and thus represented by single read-pairs in the library. As a result, it is difficult to distinguish discordant reads supporting real <italic>de novo</italic> insertions from chimeric reads introduced during sequencing library construction (<xref rid="B9" ref-type="bibr">9</xref>). However, new transposon insertions have terminal repeats that are in a fixed orientation relative to the junction of inserted transposons with genomic sequence, and short supporting read-pairs should only align to the ends of transposons, and have the correct orientation (Figure <xref ref-type="fig" rid="F1">1B</xref>). We, therefore, used read-pairs mapping to the two ends of a transposon (defined as the 95th percentile of fragment length of the library minus 25 nucleotides or nts, see Materials and Methods) to estimate <italic>de novo</italic> insertions, and assume that read-pairs that map to the center of the transposon are chimeric reads. Thus, TEMP2 defines the total number of <italic>de novo</italic> insertions of a transposon as the difference between the number of end-mapping singleton reads and the expected level of chimeric reads, which is estimated from experimentally defined reads mapping to the center of the same transposon family (Figure <xref ref-type="fig" rid="F1">1B</xref>).</p>
    </sec>
    <sec id="SEC3-2">
      <title>Performance assessment using simulated datasets</title>
      <p>We generated a series of simulated datasets to compare the performance of TEMP2 and several other transposon-detection algorithms. We first simulated 10 000 <italic>Drosophila melanogaster</italic> genomes by inserting germline and somatic transposons (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S3</xref>; <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>; see Materials and Methods), with each germline insertion at the same position across all the genomes while somatic insertions at different locations among the genomes. To evaluate the accuracy of insertion frequency estimations by the algorithms, germline insertions were simulated with frequencies from 0.25 to 1, i.e. 25% to 100% of the 10 000 genomes would contain an insertion. We also generated 10% of the insertions as transposon fragments to evaluate the accuracy in predicting full-length insertions (see Materials and Methods). Finally, we simulated Illumina read-pairs at different sequencing depths (1–50× genome coverage) with different levels of chimera read-pairs (0%, 0.05% and 0.5%) from the 10 000 simulated <italic>Drosophila</italic> genomes with the short-read simulation tool ART (<xref rid="B19" ref-type="bibr">19</xref>).</p>
      <p>We evaluated the performance of TEMP2, TEMP and four other transposon-detection algorithms: ERVcaller, MELT, RetroSeq and RelocaTE2 (<xref rid="B10" ref-type="bibr">10</xref>,<xref rid="B26" ref-type="bibr">26–29</xref>) with five metrics for detecting germline transposon insertions: sensitivity and precision in detecting insertions, accuracy in estimating insertion frequencies, accuracy in identifying the breakpoints in the reference genome, and accuracy in predicting the two ends of inserted transposons. All six algorithms report the number of supporting reads for each detected transposon insertion, but they apply different filtering to decide on the final predicted insertions. To achieve a fair comparison of the algorithms, we performed the assessment using the same cutoff of supporting reads for all the algorithms. We evaluated the performance of the algorithms as a function of the total sequencing depth because all algorithms performed better at higher sequencing depths. Figure <xref ref-type="fig" rid="F2">2</xref> shows the results at five or more supporting reads and 0.05% chimera read-pairs; we also tested the cutoff of three or four supporting reads and 0% or 0.5% chimera read-pairs and reached the same conclusion (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S2</xref>).</p>
      <p>TEMP2, TEMP and ERVcaller achieved higher sensitivity and precision than the other three algorithms in detecting germline transposon insertions across 1–50× sequencing depths (Figure <xref ref-type="fig" rid="F2">2A</xref>). At the typical 20× sequencing depth, TEMP2 (sensitivity 99.8% and precision 100%) and TEMP (100% and 96.2%) showed the highest sensitivity and precision, followed by ERVcaller (94.3% and 98.4%), RetroSeq (97.5% and 74.9%), MELT (91% and 72.4%), and RelocaTE2 (12.3% and 80.3%). TEMP2 maintains perfect precision throughout the sequencing depths. ERVcaller applies several filtering steps, which may explain its steadily high precision (<xref rid="B27" ref-type="bibr">27</xref>).</p>
      <p>We compared the accuracy in estimating insertion frequencies for the three algorithms that provide such an estimation: TEMP2 and TEMP output insertion frequencies directly, and RetroSeq outputs the number of transposon-supporting reads and reference reads which can be used to estimate insertion frequencies (see Materials and Methods). The error in estimating insertion frequencies went down with increasing sequencing depth for all three methods (Figure <xref ref-type="fig" rid="F2">2B</xref>; <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S4A</xref>), and TEMP2 shows the lowest error (average error = 0.048 at 20× sequencing depth).</p>
      <p>The breakpoints in the reference genome correspond to the locations where transposon insertions occurred. We quantified the accuracy in breakpoint identification using the average distance between simulated breakpoints and the breakpoints identified by each algorithm (Figure <xref ref-type="fig" rid="F2">2C</xref>). TEMP2, MELT and RelocaTE2 identified accurate breakpoints. The average distance was less than ten base-pairs (bp) for TEMP2 at sequencing depths higher than 3×.</p>
      <p>New transposon insertions are expected to be full length, but they degenerate over time and most copies in the genome are fragments. We measured the accuracy in predicting the ends of inserted transposons by calculating the average distance between detected and simulated transposon ends (Figure <xref ref-type="fig" rid="F2">2D</xref>). Only TEMP2, MELT and ERVcaller predict the ends of each inserted transposon. TEMP2 achieves small distances across the sequencing depths tested, while MELT and ERVcaller performed well only at high sequencing depths (&gt;20×).</p>
      <p>We then assessed the performance of TEMP2 in estimating the level of <italic>de novo</italic> transposon insertions. Although the singleton reads reported by TEMP can be used to estimate de novo insertions, other algorithms do not provide this functionality, possibly because the other algorithms treat singleton reads as unreliable information that is difficult to distinguish from chimera artifacts. We, therefore, compared TEMP2 with TEMP. We calculated the sum of squared residuals (SSR) between the detected and simulated somatic insertion numbers per genome, with the simulation performed at a series of sequencing depths and three different percentages of chimera read-pairs. TEMP2 achieved substantially lower SSR than TEMP, 0.3 versus 24.75 at 20× sequencing depth with 0.05% chimeric reads; furthermore, TEMP2’s SSR remained low at 0.5% chimera reads, while TEMP’s SSR was substantially higher at a higher chimera rate. We also performed the comparison for each transposon subfamily, and the somatic insertion numbers predicted by TEMP2 were nearly perfectly correlated with the simulated insertion numbers (Figure <xref ref-type="fig" rid="F2">2F</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S4B</xref>, left panel, <italic>r</italic> = 0.998; <italic>P</italic>-value &lt; 2.2 × 10<sup>−16</sup>) while TEMP estimated significantly higher levels of <italic>de novo</italic> insertions than the simulated levels due to chimeric reads (Figure <xref ref-type="fig" rid="F2">2F</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S4B</xref>, right panel; Wilcoxon signed-rank test <italic>P</italic>-value &lt; 2.2 × 10<sup>−16</sup>).</p>
      <p>Finally, we compared the runtime of the six algorithms using eight threads and 32GB memory (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S4C</xref>). As expected, the run time was positively correlated with the sequencing depth of the dataset. For determining germline insertions, TEMP2 runs the fastest among the six algorithms we benchmarked, followed by TEMP, Retroseq, ERVcaller, MELT, and RelocaTE2. For estimating <italic>de novo</italic> insertion numbers, TEMP2 spent 15.6 minutes on the dataset with 20× coverage of the <italic>Drosophila</italic> genome and 0.05% chimera read-pairs, comparable to the other algorithms which only detect germline insertions.</p>
      <p>In summary, in comparison with five other algorithms, TEMP2 shows the best performance in sensitivity and precision of detecting germline transposon insertions, further showing the lowest errors in estimating insertion frequencies, identifying the breakpoints in the host genome, and predicting the ends of inserted transposons. Additionally, TEMP2 can accurately estimate the total number of <italic>de novo</italic> transposon insertions, but the other algorithms lack this functionality. TEMP2 is the fastest among the six algorithms we examined.</p>
    </sec>
    <sec id="SEC3-3">
      <title>A curated benchmark dataset of transposon insertions using PacBio and Illumina sequencing in <italic>Drosophila melanogaster</italic></title>
      <p>To benchmark the performance of transposon detection algorithms, we performed high-depth PacBio long-read (171× genome coverage) and Illumina short-read sequencing of <italic>Drosophila melanogaster</italic> (see Materials and Methods). In both Illumina and PacBio sequencing, we used the ISO-1 strain of <italic>D. melanogaster</italic>, which was inbred and sequenced to assemble the reference fly genome, to exclude the potential effect of heterozygous transposon insertions in transposon detection (<xref rid="B30" ref-type="bibr">30</xref>,<xref rid="B31" ref-type="bibr">31</xref>). The two sequencing libraries were built separately, using ∼25 female virgins for Illumina sequencing and ∼180 female virgins for PacBio sequencing. The PacBio sequencing reads were long enough to span entire transposons; therefore, they can be used to construct a benchmark of transposon insertions (see Materials and Methods). In total, we detected 405 transposon insertions that were not in the reference fly genome, along with their insertion frequencies quantified using the PacBio data (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S3</xref>), and these insertions were then subject to further analysis and manual curation to arrive at a gold-standard set of insertions (Figure <xref ref-type="fig" rid="F3">3A</xref>).</p>
      <fig id="F3" orientation="portrait" position="float">
        <label>Figure 3.</label>
        <caption>
          <p>Constructing a benchmark set of transposon insertions using PacBio and Illumina sequencing data. (<bold>A</bold>) 405 transposon insertions detected by PacBio sequencing. A pie chart depicts the classification of 405 PacBio-detected transposon insertions into 148 insertions supported by Illumina reads (red), 62 false-positive insertions into a copy of the same transposon (gray), 11 manually-verified insertions into a copy of the same transposon (brown), and 184 insertions not supported by Illumina reads (blue). (<bold>B</bold>) Insertions supported by Illumina reads have more PacBio supporting reads and higher frequencies. Violin plots compare the number of PacBio-supporting reads (top) and insertion frequencies estimated by PacBio reads (bottom) for 148 insertions supported by Illumina reads (red) and 184 insertions not supported by Illumina reads (blue) as defined in A.</p>
        </caption>
        <graphic xlink:href="gkab010fig3"/>
      </fig>
      <p>Among these 405 insertions, 73 insertions were from a transposon into an annotated copy of the same transposon in the reference genome. Among these, 54 insertions were supported by one PacBio read each, and manual curation revealed that these insertions were due to sequencing errors in the PacBio reads because the inserted fragment could map back to the same transposon, albeit with mismatches. The other 19 insertions were supported by multiple PacBio reads; however, manual inspection revealed that eight of them were false positives as well for a similar reason. The remaining 11 insertions appeared to be real (Figure <xref ref-type="fig" rid="F3">3A</xref>).</p>
      <p>We examined the remaining 332 insertions for support by Illumina reads (see Materials and Methods), and 148 insertions had support while the remaining 184 insertions did not (Figure <xref ref-type="fig" rid="F3">3A</xref>). The 184 insertions not supported by Illumina reads had substantially fewer supporting PacBio reads then the 148 insertions supported by Illumina reads (Figure <xref ref-type="fig" rid="F3">3B</xref>, top panel)—114 of these 184 insertions were supported by only one PacBio read each, suggesting that they occurred only in one genome used to prepare the PacBio library. Furthermore, these two sets of insertions differ significantly in their insertion frequencies estimated by PacBio reads (Figure <xref ref-type="fig" rid="F3">3B</xref>, bottom panel; <italic>P</italic>-value &lt; 2.2 × 10<sup>−16</sup>). Thus, the 184 insertions not supported by Illumina reads were likely insertions in a small subset of the genomes and, as a result, not replicated in the sample used to prepare the Illumina sequencing library. Thus, as a benchmark for testing algorithms that would use the Illumina reads as the input, we only included the 148 insertions that were supported by Illumina reads. We did not include in the benchmark the aforementioned 11 insertions into an annotated copy of the same transposon, because we could not use Illumina reads to verify them—full-length copies of the transposon elsewhere in the genome would produce Illumina reads to map to these locations. Furthermore, none of the algorithms tested could identify these 11 insertions.</p>
      <p>More than half (<italic>n</italic> = 83) of the 148 Illumina-supported insertions contained more than 80% of the full-length consensus sequences of their transposons (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S3</xref>), suggesting that these insertions resulted from recent transpositions. Among the remaining 65 insertions, 27 were shorter than 20% of their consensus sequences; these are fragments of ancient insertions that have since degenerated.</p>
    </sec>
    <sec id="SEC3-4">
      <title>Detection of germline insertions in <italic>Drosophila melanogaster</italic></title>
      <p>We used the 148 PacBio-detected, Illumina-supported transposon insertions as a benchmark to test TEMP2 and the other algorithms, which were provided the Illumina short-read sequencing data at 29× genome coverage. The four algorithms that achieved the highest sensitivities—MELT, TEMP2, TEMP and ERVcaller (95.3–91.2%; Figure <xref ref-type="fig" rid="F4">4A</xref>)—differed in their precisions: TEMP2 achieved 79.2% precision, MELT had low precision (28.3%), while TEMP and ERVcaller were in between (60.2% and 62.2%), and accordingly, TEMP2 achieved the highest F1 score of 0.854 (Figure <xref ref-type="fig" rid="F4">4A</xref>). We further compared the algorithms using three other metrics. Among the three algorithms that report insertion frequency, TEMP2 achieved the lowest average error of 0.072 (Figure <xref ref-type="fig" rid="F4">4B</xref>), judged by the insertion frequencies determined using the PacBio data (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S3</xref>). TEMP2 also detected the breakpoints accurately for the largest number of insertions (<italic>n</italic> = 129, 94.2% of the 137 insertions it predicted; Figure <xref ref-type="fig" rid="F4">4C</xref>). Among the three algorithms that predict the ends of inserted transposons, TEMP2 and MELT achieved lower errors than ERVcaller (Figure <xref ref-type="fig" rid="F4">4D</xref>). In summary, TEMP2 outperformed the other five algorithms overall judged by the 148 transposon insertions.</p>
      <fig id="F4" orientation="portrait" position="float">
        <label>Figure 4.</label>
        <caption>
          <p>The performance of TEMP2 on experimental data in <italic>D. melanogaster</italic>. Genomic sequencing data from <italic>D. melanogaster</italic> at 29× sequencing depth were used for comparing the performance of TEMP2, TEMP, ERVcaller, MELT, RetroSeq and RelocaTE2 (in red, blue, green, yellow, purple, and gray respectively). (<bold>A</bold>) Performance of detecting transposon insertions. Three panels of bar plots depict the sensitivity, precision and F1 score of detecting germline transposon insertions, respectively. (<bold>B</bold>) Average errors of estimating transposon-insertion frequencies. Bar plots show the average error of estimated frequencies of germline transposon insertions. (<bold>C</bold>) Accuracies of identifying breakpoints in the reference genome. Bar plots show the number of germline transposon insertions (breakpoints) called by TEMP2 and other transposon-detection methods, with accurately detected breakpoints in dark blue and inaccurately detected ones in gray. (<bold>D</bold>) Accuracies in predicting the ends of inserted transposons. Bar plots show the median distance between detected and actual transposon ends of new germline insertions.</p>
        </caption>
        <graphic xlink:href="gkab010fig4"/>
      </fig>
    </sec>
    <sec id="SEC3-5">
      <title>Detection of germline insertions in human NA12878 cells</title>
      <p>We further assessed the accuracy of TEMP2 and the other algorithms in detecting germline insertions in human lymphoblastoid cells, using two Illumina-sequencing datasets from the NA12878 donor in the 1000 Genome Project—one with low sequencing depth (5.7× genome coverage; 101-nt paired-end reads) and the other one with high sequencing depth (60× genome coverage; 250-nt paired-end reads). Note that these two datasets resulted from two distinct sequencing libraries that differed in fragment length (382 ± 36 nt for the low-depth dataset and 430 ± 154 nt for the high-depth dataset). We used the 893 validated germline transposon insertions as the gold standard, downloaded from a previous benchmark study for comparing transposon-detection algorithms (<xref rid="B32" ref-type="bibr">32</xref>). Most of these insertions (833 of 893; 93.3%) were Alu elements, and a full-length Alu element is 280-nucleotide long (<xref rid="B33" ref-type="bibr">33</xref>,<xref rid="B34" ref-type="bibr">34</xref>).</p>
      <p>TEMP2 and MELT performed equally well for the low-depth dataset (F1 score = 0.758 and 0.757; Figure <xref ref-type="fig" rid="F5">5A</xref>). MELT was developed as a part of the 1000 Genomes Project for annotating transposon insertions, and it was trained on these datasets, consistent with its good performance. TEMP2 identified 761 of the 893 (85.2%) transposon insertions from the low-depth data at a 68.2% precision (Figure <xref ref-type="fig" rid="F5">5A</xref>). MELT achieved a slightly lower sensitivity of 84.1% and a slightly higher precision of 68.9%. ERVcaller was worse (80.4% sensitivity and 53.6% precision), followed by RetroSeq and TEMP (Figure <xref ref-type="fig" rid="F5">5A</xref>). TEMP was originally developed for detecting transposons in <italic>Drosophila</italic>, which are mostly longer than 1,000 nucleotides at full length; as a result, TEMP missed most of the short Alu elements in the NA12878 dataset. RelocaTE2 was omitted from the comparison because it did not finish after running for a week.</p>
      <fig id="F5" orientation="portrait" position="float">
        <label>Figure 5.</label>
        <caption>
          <p>The performance of TEMP2 on NA12878 data from the 1000 Genomes Project. Genomic sequencing data sets of the NA12878 cell line at low (5.7×; panel <bold>A</bold>) and high (38.6×; panel <bold>B</bold>) sequencing depths were used for comparing the performance of TEMP2, TEMP, ERVcaller, MELT, and RetroSeq (in red, blue, green, yellow, and purple, respectively), in detecting germline transposon insertions. In each sub-figure, Three panels of bar plots depict sensitivity, precision and F1 score of detecting germline transposon insertions, respectively.</p>
        </caption>
        <graphic xlink:href="gkab010fig5"/>
      </fig>
      <p>TEMP2 was slightly worse for the high-depth dataset (F1 score = 0.750) than for the low-depth dataset, with the decrease coming from the precision (Figure <xref ref-type="fig" rid="F5">5B</xref>). MELT showed a bigger decrease in performance (F1 = 0.711) than TEMP2, also with precision taking the hit (Figure <xref ref-type="fig" rid="F5">5B</xref>). ERVcaller achieved a higher sensitivity for the high-depth dataset than for the low-depth dataset (93.3% versus 80.4%), but a greater decrease in precision (53.6–36.6%; Figure <xref ref-type="fig" rid="F5">5B</xref>). RetroSeq and TEMP showed worse sensitivity and precision on the high-depth dataset. Since the high-depth dataset had a longer read length (pairs of 250-nt reads) than the low-depth dataset (pairs of 101-nt reads) and most insertions were Alu elements, which are only 280-nt long at full length, some of the Alu insertions were entirely contained in the read-pairs. To investigate the impact of sequencing depth and read length, we downsampled the high-depth dataset to mimic the short-depth dataset—87 million pairs of randomly sampled read with each read clipped at its 3′-end to 101-nt long, resulting in 5.7× genome coverage (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S5A</xref>). Now RetroSeq performed similarly to what it did for the low-depth dataset, although TEMP mainly improved its precision. Without clipping the reads, which corresponded to a 14.1× genome coverage, RetroSeq and TEMP did worse than when the reads were clipped (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S5B</xref>), confirming that these two methods have difficulty in finding the insertions of short transposons when the reads are long.</p>
      <p>In summary, TEMP2 and MELT showed the best performance on identifying short-transposon insertions in human lymphoblastoid cells, and they performed reliably well on two datasets with different sequencing depths, read lengths, and fragment lengths.</p>
    </sec>
    <sec id="SEC3-6">
      <title>Detection of <italic>de novo</italic> transposon insertions in hybrid-dysgenic flies</title>
      <p>To assess TEMP2’s newly developed ability to estimate the total number of <italic>de novo</italic> transposon insertions, we applied it to our previously published Illumina-sequencing dataset on the dissected ovaries of <italic>Drosophila melanogaster</italic> dysgenic hybrids (<xref rid="B35" ref-type="bibr">35</xref>). The sequenced samples included a wild-type strain <italic>Harwich</italic> (<italic>Har</italic>), a lab strain <italic>white 1</italic> (<italic>w<sup>1</sup></italic>), first-generation progeny (F1) from crossing <italic>Har</italic> males with <italic>w<sup>1</sup></italic> females (<italic>wH</italic>, two samples were prepared, from 2–4-day females and 21-day females, respectively), and second-generation progeny (F2) from crossing <italic>w<sup>1</sup></italic> males with F1 females (<italic>wHw</italic>, one sample was prepared, from 21-day females). <italic>Har</italic> possesses <italic>P-elements</italic> in its germline genome, which are not present in the lab strain <italic>w<sup>1</sup></italic>. F1 flies lack maternal piRNAs targeting paternal <italic>P-elements</italic>, which results in <italic>P-element</italic> activation, genome instability, and sterility. Surviving F1 females recover partial fertility as they age, producing <italic>P-element</italic>-targeting piRNAs <italic>de novo</italic>, and F2 females are fertile (<xref rid="B35" ref-type="bibr">35</xref>). Thus, TEMP2 can be used to assess the number of transposon insertions in these fly ovaries that were not passed on to the next generation.</p>
      <p>TEMP2 identified 166 <italic>P-element</italic> germline insertions with at least five supporting reads in <italic>Har</italic> ovaries, and 118 of them were also detected in 2–4-day F1 flies, typically with halved frequencies, in accordance with Mendelian genetics (Figure <xref ref-type="fig" rid="F6">6A</xref>). We then estimated the <italic>P-element</italic> insertion numbers in <italic>w<sup>1</sup></italic>, <italic>Har</italic>, 2–4-days F1, 21-days F1 and 21-days F2 files that were not passed on to the next generation. Although <italic>Har</italic> flies possessed the largest number of <italic>P-elements</italic> in their germline genome, they showed very few <italic>P-element</italic>-mapping singleton reads, consistent with their possession of <italic>P-element</italic>-targeting piRNAs. In contrast, F1 flies had large numbers of <italic>P-element</italic>-mapping singleton reads, more in 21-day flies than in 2–4-day flies (Figure <xref ref-type="fig" rid="F6">6B</xref>), suggesting that <italic>P-elements</italic> were actively transposing in these flies without the repression by the piRNAs that target them. Note that the numbers of singleton reads that map to the interior region of the <italic>P-element</italic> consensus sequence in these four samples were roughly the same, as would be expected for chimeric reads that result from library construction (Figure <xref ref-type="fig" rid="F6">6B</xref>). We further estimated the average number of <italic>de novo P-element</italic> insertions per genome (Figure <xref ref-type="fig" rid="F6">6C</xref>), and we arrived at ∼1 insertion per genome in <italic>Har</italic> flies and ∼3 insertions per genome in 2–4-day F1 flies, increasing to ∼8 per genome in 21-day F1 flies and falling back down to ∼4 insertions per genome in 21-day F2 flies. These estimates are consistent with the reestablishment of <italic>P-element</italic>-targeting piRNAs in hybrid-dysgenic flies (<xref rid="B35" ref-type="bibr">35</xref>).</p>
      <fig id="F6" orientation="portrait" position="float">
        <label>Figure 6.</label>
        <caption>
          <p>The performance of TEMP2 on the <italic>D. melanogaster</italic> P-M dysgenic datasets. (<bold>A</bold>) Germline frequencies of <italic>P-elements</italic> in F1 flies follow Mendelian genetics. These 2–4-day-old F1 flies were born to <italic>Harwich</italic> (<italic>Har</italic>) fathers who harbored germline <italic>P-elements</italic> and <italic>w<sup>1</sup></italic> mothers who did not. The scatter plot compares the frequencies of germline <italic>P-element</italic> insertions in the <italic>Har</italic> flies vs. those in the F1 flies. Each dot denotes a <italic>P-element</italic> insertion supported by at least five reads in <italic>Har</italic> flies. The <italic>P-element</italic> insertions that were detected in F1 flies are in red while the undetected insertions are in gray. An <italic>x</italic> = <italic>y</italic> diagonal line is included as a reference, and a red line indicates the Loess regression of the red points, whose slope is about 0.5. (<bold>B</bold>) <italic>P-elements</italic> are actively transposing in F1 flies. Profiles show the numbers of singleton read-pairs that support <italic>P-element</italic> insertions in <italic>Har</italic>, 2–4-day F1, 21-day F1 and 21-day F2 (<italic>wHw</italic>) fli<italic>es</italic>. The portions of reads in insertion-supporting read-pairs that mapped to the sense (antisense) strand of the P-element consensus sequence are tallied to make the blue (red) curve (see Materials and Methods for details). The two ends of <italic>P-element</italic> are highlighted in light blue and light orange. Two black lines indicate all raw reads mapped to the <italic>P-element</italic> consensus sequence (sense and antisense, respectively), which were used to perform normalization while estimating <italic>de novo P-element</italic> insertions. (<bold>C</bold>) Estimated numbers of <italic>de novo P-element</italic> insertions per genome in P–M dysgenic datasets. Bar plots show the numbers of <italic>de novo P-element</italic> insertions per genome in <italic>w<sup>1</sup></italic>, <italic>Har</italic>, 2–4-day F1, 21-day F1 flies and 21-day F2 (<italic>wHw</italic>) flies.</p>
        </caption>
        <graphic xlink:href="gkab010fig6"/>
      </fig>
      <p>Our previous study used TEMP and identified many new insertions for most of the residential transposon families in F1 and F2 flies, i.e. insertions not in their parents. Notably, <italic>roo</italic> appeared to be even more active than <italic>P-element</italic> (<xref rid="B35" ref-type="bibr">35</xref>). Roughly 40% of the new insertion reads detected by TEMP were singleton reads, which were likely chimeric reads, while the remaining 60% of new insertion reads formed 1p1 and 2p insertions and were unlikely chimeric reads (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S6A</xref>). Using TEMP2, we largely reproduced the results on ‘new’ 1p1 and 2p insertions that were not in parental samples, including the high numbers of insertion reads for <italic>roo</italic> (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S6B</xref>). TEMP2 verified that these 1p1 and 2p ‘new’ insertions are supported by multiple reads and hence are not likely derived from chimera. About half of the ‘new’ 1p1 and 2p insertions (46.3% and 49.3% in 2–4-day and 21-day F1 flies, respectively) are inserted in the same genomic positions between the two populations of F1 flies, suggesting that these insertions already existed in the parental flies but were undetected by the sequencing data (and TEMP2). These ‘new’ germline insertions are of low frequencies (median = 0.098 and 0.111 in the 2–4-day and 21-day <italic>wH</italic> flies, respectively), even though they are supported by multiple reads, and they are difficult to detect in parental strains. Furthermore, TEMP2 removed the singleton reads that were likely chimeric reads (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S6B</xref>) and estimated much lower numbers of <italic>de novo</italic> insertions for residential transposons (one insertion per transposon family per genome) than for <italic>P-element</italic> (3–8 insertions per genome, <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S6C</xref>). Nevertheless, due to the large number of residential transposon families in the fly genome (over 100), these transposons can still exert a toll on the germline genome.</p>
    </sec>
    <sec id="SEC3-7">
      <title>Bias at transposon insertion sites detected in Illumina libraries</title>
      <p>When we compared Illumina and PacBio data for detecting germline transposon insertions (Figure <xref ref-type="fig" rid="F4">4</xref>), we noticed that some transposon insertions were supported by different numbers of Illumina reads at the two ends (Figure <xref ref-type="fig" rid="F7">7A</xref>), but PacBio reads around these transposon insertions were evenly distributed. To investigate the potential bias of Illumina library construction and sequencing, we compared 5′-supporting reads and 3′-supporting reads for each transposon insertion that was supported by five or more reads in at least one of the dysgenic-hybrid fly datasets (<xref rid="B35" ref-type="bibr">35</xref>). We consistently observed more 5′-supporting reads than 3′-supporting reads for some transposon families (e.g. <italic>Doc</italic> and <italic>F-element</italic>) but more 5′-supporting reads than 3′-supporting reads for other transposon families (e.g. <italic>mdg1</italic>), although most transposon families (e.g. <italic>roo</italic>) have similar numbers of 5′- and 3′-supporting reads (Figure <xref ref-type="fig" rid="F7">7A</xref>, <xref ref-type="fig" rid="F7">B</xref>), and this bias is consistently observed at individual insertion sites (Figure <xref ref-type="fig" rid="F7">7C</xref>). We analyzed two more Illumina datasets from an independent study (<xref rid="B36" ref-type="bibr">36</xref>), and the results confirmed these patterns (Figure <xref ref-type="fig" rid="F7">7B</xref>).</p>
      <fig id="F7" orientation="portrait" position="float">
        <label>Figure 7.</label>
        <caption>
          <p>Sequence coverage bias at the genomic regions flanking inserted transposons. (<bold>A</bold>) Low read coverage at the 3′ flanking regions of <italic>Doc</italic> and <italic>F-element</italic> transposons and the 5′ flanking regions of the <italic>mdg1</italic> transposon at their insertion sites. Read coverage profiles in the ±1 kb window centered on the breakpoints of new <italic>Doc</italic>, <italic>F-element</italic>, <italic>roo</italic>, and <italic>mdg1</italic> insertions. <italic>Doc</italic> and <italic>F-element</italic> (in blue) show many more reads at its 5′ flanking genomic regions than its 3′ flanking genomic regions, while <italic>mdg1</italic> (in red) shows the opposite trend. Some transposons, like <italic>roo</italic> (in white), show no bias in read coverage. (<bold>B</bold>) Biases of the sequence coverage flanking inserted transposons. Heatmap depicts the sequence coverage bias for fly transposons of eight Illumina datasets from three different sources. Transposons with at least one germline insertion detected in at least one of the eight datasets were included, 57 transposons in total. The blue to red color spectrum indicates 5′ to 3′ coverage bias, with white corresponding to no bias. Transposons that do not have sufficient supporting reads in a particular dataset are in gray. (<bold>C</bold>) Bias at the 3′-ends of <italic>Doc</italic> and <italic>F-element</italic> insertions and the 5′-end of <italic>mdg1</italic> insertions. Heatmaps depict the read coverage in the flanking regions of <italic>Doc, F-element</italic>, and <italic>mdg1</italic> insertions, with each row indicating one insertion. All 31 <italic>Doc</italic> insertions, 51 <italic>F-element</italic> insertions, and 20 <italic>mdg1</italic> insertions in the <italic>Har</italic> dataset are included. (<bold>D</bold>) The sequence coverage bias flanking inserted transposons is correlated with the CG content at the transposons’ two ends. Scatterplot compares the CG content of the first and last 40 nucleotides for each of the 57 transposons in B, colored accordingly by sequence coverage bias. (<bold>E</bold>) Two ends of several example transposons reveal their different CG contents. The first and last 40 nucleotides of the consensus sequences of seven 5′-biased transposons, one 3′-biased transposon and three unbiased transposons. Cs and Gs are in orange while As and Ts are in dark blue. Poly-ATs are enriched at the 3′-ends of <italic>Doc</italic>, <italic>Copia</italic>, <italic>I-element</italic>, <italic>F-element</italic>, <italic>jockey</italic>, <italic>Juan</italic> and <italic>Ivk</italic>, but at the 5′-end of <italic>mdg1</italic>.</p>
        </caption>
        <graphic xlink:href="gkab010fig7"/>
      </fig>
      <p>Five of seven transposon families with biased supporting reads (<italic>Doc</italic>, <italic>I-element</italic>, <italic>F-element</italic>, <italic>jockey</italic>, and <italic>Juan</italic>) belong to LINE elements, which have AT-rich 3′-ends (<xref rid="B37" ref-type="bibr">37</xref>,<xref rid="B38" ref-type="bibr">38</xref>). This observation motivated us to compute the CG content (percentage of C and G nucleotides) at the two ends of the transposon families and, indeed, the families with the most bias toward 5′-supporting reads tend to have the highest GC-content at the 5′-end while lowest GC-content at the 3′-end (Figure <xref ref-type="fig" rid="F7">7D</xref>, <xref ref-type="fig" rid="F7">E</xref>). Interestingly, there are few transposons with higher GC-content at their 3′-end than their 5′-end. <italic>mdg1</italic>, which has a 3′-end bias in supporting reads (Figure <xref ref-type="fig" rid="F7">7A</xref>), has low GC-content at both ends, although slightly lower at its 5′-end than its 3′-end. The imbalance in supporting reads could result from library construction or Illumina sequencing; previous studies have reported dependence of sequencing coverage on CG contents (<xref rid="B39" ref-type="bibr">39–41</xref>). The imbalance could affect the accuracy of estimating insertion frequencies and even insertion detection when the read depth is low.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>DISCUSSION</title>
    <p>Transposons are one of the major forces driving the evolution of Metazoan genomes. However, the identification of new transposon insertions remains a challenge due to the repetitive nature of their sequences and the imperfectness of genome assemblies. Although long-read sequencing techniques such as PacBio can produce reads that are long enough to span an entire transposon insertion, such techniques are costly and do not produce sufficient numbers of reads for estimating insertion frequencies or detection of <italic>de novo</italic> insertions. The rapid accumulation of short-read whole-genome sequencing has provided ample opportunities and challenges for computational algorithms designed to detect transposon insertions in a wide variety of samples. Responding to these opportunities and challenges, we performed PacBio and Illumina sequencing on <italic>Drosophila</italic> and used the data to build a benchmark of transposon insertions, which can be used as a benchmark to test transposon detection algorithms. The long reads of our PacBio sequencing data can also be used by future studies for predicting complex transposon insertions in <italic>Drosophila melanogaster</italic>.</p>
    <p>We further present a designed TEMP2 algorithm, which can accurately identify germline insertions, estimate their frequencies, and pinpoint their breakpoints. We compared TEMP2 with several state-of-the-art algorithms using simulated data, our benchmark in <italic>Drosophila</italic>, and a set of human transposons curated by the 1000 Genomes Project, and TEMP2 performed competitively in all these comparisons. Furthermore, TEMP2 has the newly developed capability of estimating the level of low-frequency transposon insertions generated from recent activity, which can be applied to distinguish inherited from <italic>de novo</italic> transposon insertions.</p>
    <p>There are several challenges for identifying transposon insertions, and we designed TEMP2 to tackle these challenges. First, it is difficult to identify transposon insertions into repetitive regions of the genome, especially regions that already have an annotated insertion of the same transposon or of a transposon in the same family. The sequence mapping algorithm bwa mem identifies many ‘discordant’ reads at such regions, yet these reads likely originate from somewhere else in the genome with another copy of the transposon. We thus filter out all transposon insertions that likely result from such alignment artifacts. Second, we examine the overlapping insertions of different transposons in a region and only retain the insertions with the most supporting reads. This is again designed to guard against alignment artifacts in highly repetitive regions. This is why MELT performs well in the human dataset but poorly in the <italic>Drosophila</italic> dataset because MELT does not distinguish homologous transposons. In the human data, the three assessed transposons, LINE1, SVA and ALU, are highly divergent; however, in flies, many of the transposons are homologous, and these homologous transposons introduced a lot of false-positive insertions when MELT was used for transposon detection. Third, chimeric reads are prevalent in short-read sequencing libraries. To minimize false positives caused by chimeric reads in identifying <italic>de novo</italic> transposon insertions, we take advantage of the fact that <italic>bona fide</italic> transposon-supporting reads must map to the two ends of most transposons and cannot reach the transposon interior, due to short fragment length. Third, the identification of short transposons poses unique challenges. For example, a full-length Alu element is 280-nt long, which is shorter than the fragment length of the high-depth Illumina libraries (mean = 700 nt, estimated by fully mapped reads). As a result, an Alu element could be contained in a read-pair. TEMP2 combines clipped and unclipped discordant reads in the same cluster to detect insertions of short transposons.</p>
    <p>The results of our simulated data indicate that sequencing depths higher than 10× genome coverage are sufficient for most algorithms, and TEMP2 performs well even at 5× genome coverage (Figure <xref ref-type="fig" rid="F2">2</xref>). Indeed, TEMP2’s performance on the 5.7× human dataset was comparable with the 60× human dataset, although its sensitivity decreased when the 60× dataset was downsampled to 14× (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S5</xref>). A higher sequencing depth typically leads to a higher sensitivity but for some algorithms leads to a lower precision, although this does not seem to be the case for TEMP2 (Figure <xref ref-type="fig" rid="F2">2</xref>; comparing Figure <xref ref-type="fig" rid="F4">4</xref> with <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S5</xref>). Thus, we recommend a sequencing depth in the 10–30× range as a cost-effective middle ground.</p>
    <p>Many algorithms use unbalanced 5′ and 3′ supporting reads as a criterion for filtering out insertion predictions, e.g. TEMP, ERVcaller and MELT (<xref rid="B10" ref-type="bibr">10</xref>,<xref rid="B26" ref-type="bibr">26</xref>,<xref rid="B27" ref-type="bibr">27</xref>). However, we found that some <italic>Drosophila</italic> transposons have highly unbalanced supporting reads at their two ends. This may be caused by the differential CG contents at the two ends of a transposon. For example, the LINE family of <italic>Drosophila</italic> transposons tend to have low CG content at their 3′-ends, which correspond to fewer supporting reads. Therefore, a filtering criterion based on unbalanced supporting reads would miss real insertions for such transposons.</p>
    <p>Our analysis of hybrid dysgenic fly data confirmed the active transposition of <italic>P-element</italic> in F1 flies resulting from the cross between <italic>Har</italic> males, which have <italic>P-elements</italic> in their genome, and <italic>w<sup>1</sup></italic> females, which don’t. We estimated that, due to the lack of maternal piRNAs targeting <italic>P-elements</italic>, F1 flies gained about 3 new <italic>P-element</italic> insertions per genome in their first 2–4 days and about five new <italic>P-element</italic> insertions per genome in their first 21 days, when piRNAs targeting <italic>P-elements</italic> are regenerated. In the F2 generation, when the piRNAs targeting <italic>P-elements</italic> have been replenished, the new <italic>P-element</italic> insertions went back down to three per genome (Figure <xref ref-type="fig" rid="F5">5</xref>). This new capability of TEMP2 for analyzing transposon movement can be applied to other data involving mutants that derepress transposons and infections by viruses that integrate them into the host genome (<xref rid="B42" ref-type="bibr">42</xref>).</p>
    <p>TEMP2 has two limitations in estimating <italic>de novo</italic> transposon insertions. First, TEMP2 cannot distinguish low-frequency germline insertions from <italic>de novo</italic> insertions, when it is used to analyze a pool of genomes. For sequencing data on individual genomes, such as human or mouse, the frequencies of germline insertions are either 0.5 or 1 with the exception of the genomic regions with copy number variations. However, in pooled sequencing where the genomes of multiple individuals are included in the library construction, such as the fly ovary data we analyzed, low frequent transpositions can be misassigned as somatic transpositions, especially when the read coverage is low. With the rapid improvement of single-cell sequencing technologies, we hope to integrate single-cell data with bulk data to better characterize transposon insertions in future work (<xref rid="B43" ref-type="bibr">43</xref>). Second, TEMP2 cannot estimate the <italic>de novo</italic> insertion rate for short transposons such as Alu elements. TEMP2 needs center-mapping reads to estimate the false-discovery rate of transposon-supporting singleton reads; however, it is not possible to define the center for transposons whose lengths are shorter than the fragment lengths of the sequencing library.</p>
    <p>In summary, TEMP2 is a new method for identifying transposon insertions in short-read genomic DNA sequencing data. It combines the good features of existing algorithms and adds new features for eliminating false-positive predictions while maintaining high sensitivity. It performs stably in low sequencing depth and varying read length and works well for all sizes of transposons. TEMP2 was tested on both simulated and experimental data and showed overall better performance in a number of metrics than start-of-the-art methods. Its new capability of detecting <italic>de novo</italic> transposon insertions should find novel uses in studying the movements of active mobile genomic elements.</p>
  </sec>
  <sec sec-type="data-availability" id="SEC5">
    <title>DATA AVAILABILITY</title>
    <p>All simulated data were deposited in <ext-link ext-link-type="uri" xlink:href="https://publications.wenglab.org/TEMP2/download/">https://publications.wenglab.org/TEMP2/download/</ext-link>. TEMP2 is freely available at Github: <ext-link ext-link-type="uri" xlink:href="https://github.com/weng-lab/TEMP2">https://github.com/weng-lab/TEMP2</ext-link>. All deep-sequencing data generated in this study were deposited in the Sequence Read Archive (SRA) under accession number PRJNA636174.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>gkab010_Supplemental_Files</label>
      <media xlink:href="gkab010_supplemental_files.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ACK1">
    <title>ACKNOWLEDGEMENTS</title>
    <p>We thank the members of Weng lab for their critical comments. We also thank the NAR reviewers for making insightful suggestions.</p>
    <p><italic>Author contributions</italic>: T.Y. and Z.W. conceived the project. S.D., X.T., S.L. performed the experiments. T.Y. wrote the code and performed the testing of TEMP2. X.H. tested other algorithms. T.Y. curated the benchmarks and performed data analysis. T.Y., W.E.T., J.L. and Z.W. wrote the manuscript. All authors made edits to the paper.</p>
  </ack>
  <sec id="SEC6">
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link ext-link-type="uri" xlink:href="https://academic.oup.com/nar/article-lookup/doi/10.1093/nar/gkab010#supplementary-data">Supplementary Data</ext-link> are available at NAR Online.</p>
  </sec>
  <sec id="SEC7">
    <title>FUNDING</title>
    <p>Chinese National Natural Science Foundation [31871296]; National Institutes of Health [HD078253]. Funding for open access charge: Chinese National Natural Science Foundation [31871296].</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <ref-list id="REF1">
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>C.R.L.</given-names></string-name>, <string-name><surname>Burns</surname><given-names>K.H.</given-names></string-name>, <string-name><surname>Boeke</surname><given-names>J.D</given-names></string-name></person-group><article-title>Active transposition in genomes</article-title>. <source>Annu. Rev. Genet.</source><year>2012</year>; <volume>46</volume>:<fpage>651</fpage>–<lpage>675</lpage>.<pub-id pub-id-type="pmid">23145912</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Britten</surname><given-names>R.J.</given-names></string-name></person-group><article-title>Transposable element insertions have strongly affected human evolution</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A.</source><year>2010</year>; <volume>107</volume>:<fpage>19945</fpage>–<lpage>19948</lpage>.<pub-id pub-id-type="pmid">21041622</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hedges</surname><given-names>D.J.</given-names></string-name>, <string-name><surname>Belancio</surname><given-names>V.P.</given-names></string-name></person-group><article-title>Restless genomes humans as a model organism for understanding host-retrotransposable element dynamics</article-title>. <source>Adv. Genet.</source><year>2011</year>; <volume>73</volume>:<fpage>219</fpage>–<lpage>262</lpage>.<pub-id pub-id-type="pmid">21310298</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bennetzen</surname><given-names>J.L.</given-names></string-name></person-group><article-title>Transposable element contributions to plant gene and genome evolution</article-title>. <source>Plant Mol. Biol.</source><year>2000</year>; <volume>42</volume>:<fpage>251</fpage>–<lpage>269</lpage>.<pub-id pub-id-type="pmid">10688140</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Belancio</surname><given-names>V.P.</given-names></string-name>, <string-name><surname>Hedges</surname><given-names>D.J.</given-names></string-name>, <string-name><surname>Deininger</surname><given-names>P.</given-names></string-name></person-group><article-title>Mammalian non-LTR retrotransposons: for better or worse, in sickness and in health</article-title>. <source>Genome Res.</source><year>2008</year>; <volume>18</volume>:<fpage>343</fpage>–<lpage>358</lpage>.<pub-id pub-id-type="pmid">18256243</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Iskow</surname><given-names>R.C.</given-names></string-name>, <string-name><surname>McCabe</surname><given-names>M.T.</given-names></string-name>, <string-name><surname>Mills</surname><given-names>R.E.</given-names></string-name>, <string-name><surname>Torene</surname><given-names>S.</given-names></string-name>, <string-name><surname>Pittard</surname><given-names>W.S.</given-names></string-name>, <string-name><surname>Neuwald</surname><given-names>A.F.</given-names></string-name>, <string-name><surname>Van Meir</surname><given-names>E.G.</given-names></string-name>, <string-name><surname>Vertino</surname><given-names>P.M.</given-names></string-name>, <string-name><surname>Devine</surname><given-names>S.E.</given-names></string-name></person-group><article-title>Natural mutagenesis of human genomes by endogenous retrotransposons</article-title>. <source>Cell</source>. <year>2010</year>; <volume>141</volume>:<fpage>1253</fpage>–<lpage>1261</lpage>.<pub-id pub-id-type="pmid">20603005</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shukla</surname><given-names>R.</given-names></string-name>, <string-name><surname>Upton</surname><given-names>K.R.</given-names></string-name>, <string-name><surname>Muñoz-Lopez</surname><given-names>M.</given-names></string-name>, <string-name><surname>Gerhardt</surname><given-names>D.J.</given-names></string-name>, <string-name><surname>Fisher</surname><given-names>M.E.</given-names></string-name>, <string-name><surname>Nguyen</surname><given-names>T.</given-names></string-name>, <string-name><surname>Brennan</surname><given-names>P.M.</given-names></string-name>, <string-name><surname>Baillie</surname><given-names>J.K.</given-names></string-name>, <string-name><surname>Collino</surname><given-names>A.</given-names></string-name>, <string-name><surname>Ghisletti</surname><given-names>S.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Endogenous retrotransposition activates oncogenic pathways in hepatocellular carcinoma</article-title>. <source>Cell</source>. <year>2013</year>; <volume>153</volume>:<fpage>101</fpage>–<lpage>111</lpage>.<pub-id pub-id-type="pmid">23540693</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Solyom</surname><given-names>S.</given-names></string-name>, <string-name><surname>Kazazian</surname><given-names>H.H.</given-names><suffix>Jr</suffix></string-name></person-group><article-title>Mobile elements in the human genome: implications for disease</article-title>. <source>Genome Med</source>. <year>2012</year>; <volume>4</volume>:<fpage>12</fpage>.<pub-id pub-id-type="pmid">22364178</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Treiber</surname><given-names>C.D.</given-names></string-name>, <string-name><surname>Waddell</surname><given-names>S.</given-names></string-name></person-group><article-title>Resolving the prevalence of somatic transposition in Drosophila</article-title>. <source>eLife</source>. <year>2017</year>; <volume>6</volume>:<fpage>e28297</fpage>.<pub-id pub-id-type="pmid">28742021</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gardner</surname><given-names>E.J.</given-names></string-name>, <string-name><surname>Lam</surname><given-names>V.K.</given-names></string-name>, <string-name><surname>Harris</surname><given-names>D.N.</given-names></string-name>, <string-name><surname>Chuang</surname><given-names>N.T.</given-names></string-name>, <string-name><surname>Scott</surname><given-names>E.C.</given-names></string-name>, <string-name><surname>Pittard</surname><given-names>W.S.</given-names></string-name>, <string-name><surname>Mills</surname><given-names>R.E.</given-names></string-name><collab>1000 Genomes Project Consortium and Devine, S.E.</collab></person-group><article-title>The mobile element Locator tool (MELT): population-scale mobile element discovery and biology</article-title>. <source>Genome Res.</source><year>2017</year>; <volume>27</volume>:<fpage>1916</fpage>–<lpage>1929</lpage>.<pub-id pub-id-type="pmid">28855259</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Keane</surname><given-names>T.M.</given-names></string-name>, <string-name><surname>Wong</surname><given-names>K.</given-names></string-name>, <string-name><surname>Adams</surname><given-names>D.J.</given-names></string-name></person-group><article-title>RetroSeq: transposable element discovery from next-generation sequencing data</article-title>. <source>Bioinformatics</source>. <year>2013</year>; <volume>29</volume>:<fpage>389</fpage>–<lpage>390</lpage>.<pub-id pub-id-type="pmid">23233656</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>J.</given-names></string-name>, <string-name><surname>Wrightsman</surname><given-names>T.R.</given-names></string-name>, <string-name><surname>Wessler</surname><given-names>S.R.</given-names></string-name>, <string-name><surname>Stajich</surname><given-names>J.E.</given-names></string-name></person-group><article-title>RelocaTE2: a high resolution transposable element insertion site mapping tool for population resequencing</article-title>. <source>PeerJ</source>. <year>2017</year>; <volume>5</volume>:<fpage>e2942</fpage>.<pub-id pub-id-type="pmid">28149701</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhuang</surname><given-names>J.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>J.</given-names></string-name>, <string-name><surname>Theurkauf</surname><given-names>W.</given-names></string-name>, <string-name><surname>Weng</surname><given-names>Z.</given-names></string-name></person-group><article-title>TEMP: a computational method for analyzing transposable element polymorphism in populations</article-title>. <source>Nucleic Acids Res.</source><year>2014</year>; <volume>42</volume>:<fpage>6826</fpage>–<lpage>6838</lpage>.<pub-id pub-id-type="pmid">24753423</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>X.</given-names></string-name>, <string-name><surname>Li</surname><given-names>D</given-names></string-name></person-group><article-title>ERVcaller: identifying polymorphic endogenous retrovirus and other transposable element insertions using whole-genome sequencing data</article-title>. <source>Bioinformatics</source>. <year>2019</year>; <volume>35</volume>:<fpage>3913</fpage>–<lpage>3922</lpage>.<pub-id pub-id-type="pmid">30895294</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Goerner-Potvin</surname><given-names>P.</given-names></string-name>, <string-name><surname>Bourque</surname><given-names>G.</given-names></string-name></person-group><article-title>Computational tools to unmask transposable elements</article-title>. <source>Nat. Rev. Genet.</source><year>2018</year>; <volume>19</volume>:<fpage>688</fpage>–<lpage>704</lpage>.<pub-id pub-id-type="pmid">30232369</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>H.</given-names></string-name>, <string-name><surname>Durbin</surname><given-names>R.</given-names></string-name></person-group><article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source>. <year>2009</year>; <volume>25</volume>:<fpage>1754</fpage>–<lpage>1760</lpage>.<pub-id pub-id-type="pmid">19451168</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tang</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Steranka</surname><given-names>J.P.</given-names></string-name>, <string-name><surname>Ma</surname><given-names>S.</given-names></string-name>, <string-name><surname>Grivainis</surname><given-names>M.</given-names></string-name>, <string-name><surname>Rodić</surname><given-names>N.</given-names></string-name>, <string-name><surname>Huang</surname><given-names>C.R.L.</given-names></string-name>, <string-name><surname>Shih</surname><given-names>I.-M.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>T.-L.</given-names></string-name>, <string-name><surname>Boeke</surname><given-names>J.D.</given-names></string-name>, <string-name><surname>Fenyö</surname><given-names>D.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Human transposon insertion profiling: Analysis, visualization and identification of somatic LINE-1 insertions in ovarian cancer</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A.</source><year>2017</year>; <volume>114</volume>:<fpage>E733</fpage>–<lpage>E740</lpage>.<pub-id pub-id-type="pmid">28096347</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Burns</surname><given-names>K.H.</given-names></string-name>, <string-name><surname>Boeke</surname><given-names>J.D.</given-names></string-name></person-group><article-title>Human transposon tectonics</article-title>. <source>Cell</source>. <year>2012</year>; <volume>149</volume>:<fpage>740</fpage>–<lpage>752</lpage>.<pub-id pub-id-type="pmid">22579280</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>W.</given-names></string-name>, <string-name><surname>Li</surname><given-names>L.</given-names></string-name>, <string-name><surname>Myers</surname><given-names>J.R.</given-names></string-name>, <string-name><surname>Marth</surname><given-names>G.T.</given-names></string-name></person-group><article-title>ART: a next-generation sequencing read simulator</article-title>. <source>Bioinformatics</source>. <year>2012</year>; <volume>28</volume>:<fpage>593</fpage>–<lpage>594</lpage>.<pub-id pub-id-type="pmid">22199392</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>H.</given-names></string-name></person-group><article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>. <source>Bioinformatics</source>. <year>2018</year>; <volume>34</volume>:<fpage>3094</fpage>–<lpage>3100</lpage>.<pub-id pub-id-type="pmid">29750242</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sedlazeck</surname><given-names>F.J.</given-names></string-name>, <string-name><surname>Rescheneder</surname><given-names>P.</given-names></string-name>, <string-name><surname>Smolka</surname><given-names>M.</given-names></string-name>, <string-name><surname>Fang</surname><given-names>H.</given-names></string-name>, <string-name><surname>Nattestad</surname><given-names>M.</given-names></string-name>, <string-name><surname>von Haeseler</surname><given-names>A.</given-names></string-name>, <string-name><surname>Schatz</surname><given-names>M.C.</given-names></string-name></person-group><article-title>Accurate detection of complex structural variations using single-molecule sequencing</article-title>. <source>Nat. Methods</source>. <year>2018</year>; <volume>15</volume>:<fpage>461</fpage>–<lpage>468</lpage>.<pub-id pub-id-type="pmid">29713083</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robinson</surname><given-names>J.T.</given-names></string-name>, <string-name><surname>Thorvaldsdóttir</surname><given-names>H.</given-names></string-name>, <string-name><surname>Winckler</surname><given-names>W.</given-names></string-name>, <string-name><surname>Guttman</surname><given-names>M.</given-names></string-name>, <string-name><surname>Lander</surname><given-names>E.S.</given-names></string-name>, <string-name><surname>Getz</surname><given-names>G.</given-names></string-name>, <string-name><surname>Mesirov</surname><given-names>J.P.</given-names></string-name></person-group><article-title>Integrative genomics viewer</article-title>. <source>Nat. Biotechnol.</source><year>2011</year>; <volume>29</volume>:<fpage>24</fpage>–<lpage>26</lpage>.<pub-id pub-id-type="pmid">21221095</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Thurmond</surname><given-names>J.</given-names></string-name>, <string-name><surname>Goodman</surname><given-names>J.L.</given-names></string-name>, <string-name><surname>Strelets</surname><given-names>V.B.</given-names></string-name>, <string-name><surname>Attrill</surname><given-names>H.</given-names></string-name>, <string-name><surname>Gramates</surname><given-names>L.S.</given-names></string-name>, <string-name><surname>Marygold</surname><given-names>S.J.</given-names></string-name>, <string-name><surname>Matthews</surname><given-names>B.B.</given-names></string-name>, <string-name><surname>Millburn</surname><given-names>G.</given-names></string-name>, <string-name><surname>Antonazzo</surname><given-names>G.</given-names></string-name>, <string-name><surname>Trovisco</surname><given-names>V.</given-names></string-name><etal>et al</etal>.</person-group><article-title>FlyBase 2.0: the next generation</article-title>. <source>Nucleic Acids Res.</source><year>2019</year>; <volume>47</volume>:<fpage>D759</fpage>–<lpage>D765</lpage>.<pub-id pub-id-type="pmid">30364959</pub-id></mixed-citation>
    </ref>
    <ref id="B24">
      <label>24.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Smit</surname><given-names>A.F.A.</given-names></string-name>, <string-name><surname>Hubley</surname><given-names>R.</given-names></string-name>, <string-name><surname>Green</surname><given-names>P.</given-names></string-name></person-group><article-title>RepeatMasker Open-4.0</article-title>. <year>2013-2015</year>; <uri xlink:href="http://www.repeatmasker.org/">http://www.repeatmasker.org</uri>.</mixed-citation>
    </ref>
    <ref id="B25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>H.</given-names></string-name>, <string-name><surname>Handsaker</surname><given-names>B.</given-names></string-name>, <string-name><surname>Wysoker</surname><given-names>A.</given-names></string-name>, <string-name><surname>Fennell</surname><given-names>T.</given-names></string-name>, <string-name><surname>Ruan</surname><given-names>J.</given-names></string-name>, <string-name><surname>Homer</surname><given-names>N.</given-names></string-name>, <string-name><surname>Marth</surname><given-names>G.</given-names></string-name>, <string-name><surname>Abecasis</surname><given-names>G.</given-names></string-name>, <string-name><surname>Durbin</surname><given-names>R.</given-names></string-name><collab>1000 Genome Project Data Processing Subgroup</collab></person-group><article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source>. <year>2009</year>; <volume>25</volume>:<fpage>2078</fpage>–<lpage>2079</lpage>.<pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="B26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhuang</surname><given-names>J.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>J.</given-names></string-name>, <string-name><surname>Theurkauf</surname><given-names>W.</given-names></string-name>, <string-name><surname>Weng</surname><given-names>Z.</given-names></string-name></person-group><article-title>TEMP: a computational method for analyzing transposable element polymorphism in populations</article-title>. <source>Nucleic Acids Res.</source><year>2014</year>; <volume>42</volume>:<fpage>6826</fpage>–<lpage>6838</lpage>.<pub-id pub-id-type="pmid">24753423</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>X.</given-names></string-name>, <string-name><surname>Li</surname><given-names>D</given-names></string-name></person-group><article-title>ERVcaller: identifying polymorphic endogenous retrovirus and other transposable element insertions using whole-genome sequencing data</article-title>. <source>Bioinformatics</source>. <year>2019</year>; <volume>35</volume>:<fpage>3913</fpage>–<lpage>3922</lpage>.<pub-id pub-id-type="pmid">30895294</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Keane</surname><given-names>T.M.</given-names></string-name>, <string-name><surname>Wong</surname><given-names>K.</given-names></string-name>, <string-name><surname>Adams</surname><given-names>D.J.</given-names></string-name></person-group><article-title>RetroSeq: transposable element discovery from next-generation sequencing data</article-title>. <source>Bioinformatics</source>. <year>2013</year>; <volume>29</volume>:<fpage>389</fpage>–<lpage>390</lpage>.<pub-id pub-id-type="pmid">23233656</pub-id></mixed-citation>
    </ref>
    <ref id="B29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>J.</given-names></string-name>, <string-name><surname>Wrightsman</surname><given-names>T.R.</given-names></string-name>, <string-name><surname>Wessler</surname><given-names>S.R.</given-names></string-name>, <string-name><surname>Stajich</surname><given-names>J.E.</given-names></string-name></person-group><article-title>RelocaTE2: a high resolution transposable element insertion site mapping tool for population resequencing</article-title>. <source>PeerJ</source>. <year>2017</year>; <volume>5</volume>:<fpage>e2942</fpage>.<pub-id pub-id-type="pmid">28149701</pub-id></mixed-citation>
    </ref>
    <ref id="B30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hoskins</surname><given-names>R.A.</given-names></string-name>, <string-name><surname>Carlson</surname><given-names>J.W.</given-names></string-name>, <string-name><surname>Wan</surname><given-names>K.H.</given-names></string-name>, <string-name><surname>Park</surname><given-names>S.</given-names></string-name>, <string-name><surname>Mendez</surname><given-names>I.</given-names></string-name>, <string-name><surname>Galle</surname><given-names>S.E.</given-names></string-name>, <string-name><surname>Booth</surname><given-names>B.W.</given-names></string-name>, <string-name><surname>Pfeiffer</surname><given-names>B.D.</given-names></string-name>, <string-name><surname>George</surname><given-names>R.A.</given-names></string-name>, <string-name><surname>Svirskas</surname><given-names>R.</given-names></string-name><etal>et al</etal>.</person-group><article-title>The Release 6 reference sequence of the Drosophila melanogaster genome</article-title>. <source>Genome Res.</source><year>2015</year>; <volume>25</volume>:<fpage>445</fpage>–<lpage>458</lpage>.<pub-id pub-id-type="pmid">25589440</pub-id></mixed-citation>
    </ref>
    <ref id="B31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>dos Santos</surname><given-names>G.</given-names></string-name>, <string-name><surname>Schroeder</surname><given-names>A.J.</given-names></string-name>, <string-name><surname>Goodman</surname><given-names>J.L.</given-names></string-name>, <string-name><surname>Strelets</surname><given-names>V.B.</given-names></string-name>, <string-name><surname>Crosby</surname><given-names>M.A.</given-names></string-name>, <string-name><surname>Thurmond</surname><given-names>J.</given-names></string-name>, <string-name><surname>Emmert</surname><given-names>D.B.</given-names></string-name>, <string-name><surname>Gelbart</surname><given-names>W.M.</given-names></string-name><collab>FlyBase Consortium</collab></person-group><article-title>FlyBase: introduction of the Drosophila melanogaster Release 6 reference genome assembly and large-scale migration of genome annotations</article-title>. <source>Nucleic Acids Res.</source><year>2015</year>; <volume>43</volume>:<fpage>D690</fpage>–<lpage>D697</lpage>.<pub-id pub-id-type="pmid">25398896</pub-id></mixed-citation>
    </ref>
    <ref id="B32">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rishishwar</surname><given-names>L.</given-names></string-name>, <string-name><surname>Mariño-Ramírez</surname><given-names>L.</given-names></string-name>, <string-name><surname>Jordan</surname><given-names>I.K.</given-names></string-name></person-group><article-title>Benchmarking computational tools for polymorphic transposable element detection</article-title>. <source>Brief. Bioinform.</source><year>2017</year>; <volume>18</volume>:<fpage>908</fpage>–<lpage>918</lpage>.<pub-id pub-id-type="pmid">27524380</pub-id></mixed-citation>
    </ref>
    <ref id="B33">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kriegs</surname><given-names>J.O.</given-names></string-name>, <string-name><surname>Churakov</surname><given-names>G.</given-names></string-name>, <string-name><surname>Jurka</surname><given-names>J.</given-names></string-name>, <string-name><surname>Brosius</surname><given-names>J.</given-names></string-name>, <string-name><surname>Schmitz</surname><given-names>J.</given-names></string-name></person-group><article-title>Evolutionary history of 7SL RNA-derived SINEs in supraprimates</article-title>. <source>Trends Genet.</source><year>2007</year>; <volume>23</volume>:<fpage>158</fpage>–<lpage>161</lpage>.<pub-id pub-id-type="pmid">17307271</pub-id></mixed-citation>
    </ref>
    <ref id="B34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Deininger</surname><given-names>P.L.</given-names></string-name>, <string-name><surname>Moran</surname><given-names>J.V.</given-names></string-name>, <string-name><surname>Batzer</surname><given-names>M.A.</given-names></string-name>, <string-name><surname>Kazazian</surname><given-names>H.H.</given-names><suffix>Jr</suffix></string-name></person-group><article-title>Mobile elements and mammalian genome evolution</article-title>. <source>Curr. Opin. Genet. Dev.</source><year>2003</year>; <volume>13</volume>:<fpage>651</fpage>–<lpage>658</lpage>.<pub-id pub-id-type="pmid">14638329</pub-id></mixed-citation>
    </ref>
    <ref id="B35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Khurana</surname><given-names>J.S.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>J.</given-names></string-name>, <string-name><surname>Xu</surname><given-names>J.</given-names></string-name>, <string-name><surname>Koppetsch</surname><given-names>B.S.</given-names></string-name>, <string-name><surname>Thomson</surname><given-names>T.C.</given-names></string-name>, <string-name><surname>Nowosielska</surname><given-names>A.</given-names></string-name>, <string-name><surname>Li</surname><given-names>C.</given-names></string-name>, <string-name><surname>Zamore</surname><given-names>P.D.</given-names></string-name>, <string-name><surname>Weng</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Theurkauf</surname><given-names>W.E.</given-names></string-name></person-group><article-title>Adaptation to P element transposon invasion in Drosophila melanogaster</article-title>. <source>Cell</source>. <year>2011</year>; <volume>147</volume>:<fpage>1551</fpage>–<lpage>1563</lpage>.<pub-id pub-id-type="pmid">22196730</pub-id></mixed-citation>
    </ref>
    <ref id="B36">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Armstrong</surname><given-names>R.L.</given-names></string-name>, <string-name><surname>Penke</surname><given-names>T.J.R.</given-names></string-name>, <string-name><surname>Chao</surname><given-names>S.K.</given-names></string-name>, <string-name><surname>Gentile</surname><given-names>G.M.</given-names></string-name>, <string-name><surname>Strahl</surname><given-names>B.D.</given-names></string-name>, <string-name><surname>Matera</surname><given-names>A.G.</given-names></string-name>, <string-name><surname>McKay</surname><given-names>D.J.</given-names></string-name>, <string-name><surname>Duronio</surname><given-names>R.J</given-names></string-name></person-group><article-title>H3K9 promotes under-replication of pericentromeric heterochromatin in drosophila salivary gland polytene chromosomes</article-title>. <source>Genes</source>. <year>2019</year>; <volume>10</volume>:<fpage>93</fpage>.</mixed-citation>
    </ref>
    <ref id="B37">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kajikawa</surname><given-names>M.</given-names></string-name>, <string-name><surname>Okada</surname><given-names>N.</given-names></string-name></person-group><article-title>LINEs mobilize SINEs in the Eel through a shared 3′ sequence</article-title>. <source>Cell</source>. <year>2002</year>; <volume>111</volume>:<fpage>433</fpage>–<lpage>444</lpage>.<pub-id pub-id-type="pmid">12419252</pub-id></mixed-citation>
    </ref>
    <ref id="B38">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chambeyron</surname><given-names>S.</given-names></string-name>, <string-name><surname>Bucheton</surname><given-names>A.</given-names></string-name>, <string-name><surname>Busseau</surname><given-names>I.</given-names></string-name></person-group><article-title>Tandem UAA repeats at the 3′-End of the transcript are essential for the precise initiation of reverse transcription of the I factor indrosophila melanogaster</article-title>. <source>J. Biol. Chem.</source><year>2002</year>; <volume>277</volume>:<fpage>17877</fpage>–<lpage>17882</lpage>.<pub-id pub-id-type="pmid">11882661</pub-id></mixed-citation>
    </ref>
    <ref id="B39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sims</surname><given-names>D.</given-names></string-name>, <string-name><surname>Sudbery</surname><given-names>I.</given-names></string-name>, <string-name><surname>Ilott</surname><given-names>N.E.</given-names></string-name>, <string-name><surname>Heger</surname><given-names>A.</given-names></string-name>, <string-name><surname>Ponting</surname><given-names>C.P.</given-names></string-name></person-group><article-title>Sequencing depth and coverage: key considerations in genomic analyses</article-title>. <source>Nat. Rev. Genet.</source><year>2014</year>; <volume>15</volume>:<fpage>121</fpage>–<lpage>132</lpage>.<pub-id pub-id-type="pmid">24434847</pub-id></mixed-citation>
    </ref>
    <ref id="B40">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nakamura</surname><given-names>K.</given-names></string-name>, <string-name><surname>Oshima</surname><given-names>T.</given-names></string-name>, <string-name><surname>Morimoto</surname><given-names>T.</given-names></string-name>, <string-name><surname>Ikeda</surname><given-names>S.</given-names></string-name>, <string-name><surname>Yoshikawa</surname><given-names>H.</given-names></string-name>, <string-name><surname>Shiwa</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Ishikawa</surname><given-names>S.</given-names></string-name>, <string-name><surname>Linak</surname><given-names>M.C.</given-names></string-name>, <string-name><surname>Hirai</surname><given-names>A.</given-names></string-name>, <string-name><surname>Takahashi</surname><given-names>H.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Sequence-specific error profile of Illumina sequencers</article-title>. <source>Nucleic Acids Res.</source><year>2011</year>; <volume>39</volume>:<fpage>e90</fpage>.<pub-id pub-id-type="pmid">21576222</pub-id></mixed-citation>
    </ref>
    <ref id="B41">
      <label>41.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Benjamini</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Speed</surname><given-names>T.P.</given-names></string-name></person-group><article-title>Summarizing and correcting the GC content bias in high-throughput sequencing</article-title>. <source>Nucleic Acids Res.</source><year>2012</year>; <volume>40</volume>:<fpage>e72</fpage>.<pub-id pub-id-type="pmid">22323520</pub-id></mixed-citation>
    </ref>
    <ref id="B42">
      <label>42.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yu</surname><given-names>T.</given-names></string-name>, <string-name><surname>Koppetsch</surname><given-names>B.S.</given-names></string-name>, <string-name><surname>Pagliarani</surname><given-names>S.</given-names></string-name>, <string-name><surname>Johnston</surname><given-names>S.</given-names></string-name>, <string-name><surname>Silverstein</surname><given-names>N.J.</given-names></string-name>, <string-name><surname>Luban</surname><given-names>J.</given-names></string-name>, <string-name><surname>Chappell</surname><given-names>K.</given-names></string-name>, <string-name><surname>Weng</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Theurkauf</surname><given-names>W.E.</given-names></string-name></person-group><article-title>The piRNA response to retroviral invasion of the Koala genome</article-title>. <source>Cell</source>. <year>2019</year>; <volume>179</volume>:<fpage>632</fpage>–<lpage>643</lpage>.<pub-id pub-id-type="pmid">31607510</pub-id></mixed-citation>
    </ref>
    <ref id="B43">
      <label>43.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Evrony</surname><given-names>G.D.</given-names></string-name>, <string-name><surname>Lee</surname><given-names>E.</given-names></string-name>, <string-name><surname>Park</surname><given-names>P.J.</given-names></string-name>, <string-name><surname>Walsh</surname><given-names>C.A.</given-names></string-name></person-group><article-title>Resolving rates of mutation in the brain using single-neuron genomics</article-title>. <source>Elife</source>. <year>2016</year>; <volume>5</volume>:<fpage>e12966</fpage>.<pub-id pub-id-type="pmid">26901440</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
