<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle pcbi.1011001.r001?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10174551</article-id>
    <article-id pub-id-type="pmid">37126495</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-22-00907</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011001</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Metagenomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Neural Networks</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Neural Networks</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Sequencing Techniques</subject>
              <subj-group>
                <subject>Genome Sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Sequencing Techniques</subject>
            <subj-group>
              <subject>Genome Sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Mathematical and Statistical Techniques</subject>
          <subj-group>
            <subject>Mathematical Functions</subject>
            <subj-group>
              <subject>Convolution</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Bacteriology</subject>
            <subj-group>
              <subject>Bacterial Genetics</subject>
              <subj-group>
                <subject>Bacterial Genomics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Microbial Genetics</subject>
            <subj-group>
              <subject>Bacterial Genetics</subject>
              <subj-group>
                <subject>Bacterial Genomics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Microbial Genomics</subject>
              <subj-group>
                <subject>Bacterial Genomics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Microbial Genomics</subject>
            <subj-group>
              <subject>Bacterial Genomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Biological Databases</subject>
            <subj-group>
              <subject>Genomic Databases</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Genomic Databases</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Genomic Databases</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ResMiCo: Increasing the quality of metagenome-assembled genomes with deep learning</article-title>
      <alt-title alt-title-type="running-head">ResMiCo: Increasing the quality of metagenome-assembled genomes with deep learning</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Mineeva</surname>
          <given-names>Olga</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="econtrib001" ref-type="author-notes">
          <sup>‡</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Danciu</surname>
          <given-names>Daniel</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="econtrib001" ref-type="author-notes">
          <sup>‡</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schölkopf</surname>
          <given-names>Bernhard</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ley</surname>
          <given-names>Ruth E.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <xref rid="aff005" ref-type="aff">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Rätsch</surname>
          <given-names>Gunnar</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
        <xref rid="aff006" ref-type="aff">
          <sup>6</sup>
        </xref>
        <xref rid="aff007" ref-type="aff">
          <sup>7</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7424-5276</contrib-id>
        <name>
          <surname>Youngblut</surname>
          <given-names>Nicholas D.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff005" ref-type="aff">
          <sup>5</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Computer Science, ETH Zürich, Zürich, Switzerland</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of Empirical Inference, Max Planck Institute for Intelligent Systems, Tübingen, Germany</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Swiss Institute for Bioinformatics, Lausanne, Switzerland</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>ETH AI center, ETH Zürich, Zürich, Switzerland</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Department of Microbiome Science, Max Planck Institute for Biology, Tübingen, Germany</addr-line>
    </aff>
    <aff id="aff006">
      <label>6</label>
      <addr-line>Department of Biology, ETH Zürich, Zürich, Switzerland</addr-line>
    </aff>
    <aff id="aff007">
      <label>7</label>
      <addr-line>Medical Informatics Unit, Zürich University Hospital, Zürich, Switzerland</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Coelho</surname>
          <given-names>Luis Pedro</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Fudan University, CHINA</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="other" id="econtrib001">
        <p>‡ These authors share first authorship on this work.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>gunnar.raetsch@inf.ethz.ch</email> (GR); <email>nyoungblut@tuebingen.mpg.de</email> (NDY)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <volume>19</volume>
    <issue>5</issue>
    <elocation-id>e1011001</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>6</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>6</day>
        <month>3</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2023 Mineeva et al</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Mineeva et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1011001.pdf"/>
    <abstract>
      <p>The number of published metagenome assemblies is rapidly growing due to advances in sequencing technologies. However, sequencing errors, variable coverage, repetitive genomic regions, and other factors can produce misassemblies, which are challenging to detect for taxonomically novel genomic data. Assembly errors can affect all downstream analyses of the assemblies. Accuracy for the state of the art in reference-free misassembly prediction does not exceed an AUPRC of 0.57, and it is not clear how well these models generalize to real-world data. Here, we present the Residual neural network for Misassembled Contig identification (ResMiCo), a deep learning approach for reference-free identification of misassembled contigs. To develop ResMiCo, we first generated a training dataset of unprecedented size and complexity that can be used for further benchmarking and developments in the field. Through rigorous validation, we show that ResMiCo is substantially more accurate than the state of the art, and the model is robust to novel taxonomic diversity and varying assembly methods. ResMiCo estimated 7% misassembled contigs per metagenome across multiple real-world datasets. We demonstrate how ResMiCo can be used to optimize metagenome assembly hyperparameters to improve accuracy, instead of optimizing solely for contiguity. The accuracy, robustness, and ease-of-use of ResMiCo make the tool suitable for general quality control of metagenome assemblies and assembly methodology optimization.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Metagenome assembly quality is fundamental to all downstream analyses of such data. The number of metagenome assemblies, especially metagenome-assembled genomes (MAGs), is rapidly increasing, but tools to assess the quality of these assemblies lack the accuracy needed for robust quality control. Moreover, existing models have been trained on datasets lacking complexity and realism, which may limit their generalization to novel data. Due to the limitations of existing models, most studies forgo such approaches and instead rely on CheckM to assess assembly quality, an approach that only utilizes a small portion of all genomic information and does not identify specific misassemblies. We harnessed existing large genomic datasets and high-performance computing to produce a training dataset of unprecedented size and complexity and thereby trained a deep learning model for predicting misassemblies that can robustly generalize to novel taxonomy and varying assembly methodologies.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100003006</institution-id>
            <institution>Eidgenössische Technische Hochschule Zürich</institution>
          </institution-wrap>
        </funding-source>
        <principal-award-recipient>
          <name>
            <surname>Mineeva</surname>
            <given-names>Olga</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100018385</institution-id>
            <institution>Max-Planck-Förderstiftung</institution>
          </institution-wrap>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7424-5276</contrib-id>
          <name>
            <surname>Youngblut</surname>
            <given-names>Nicholas D.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution>Eidgenössische Technische Hochschule Strategic Focus Area - Personalized Health and Related Technologies</institution>
        </funding-source>
        <award-id>project #106</award-id>
        <principal-award-recipient>
          <name>
            <surname>Danciu</surname>
            <given-names>Daniel</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This work was supported by Eidgenössische Technische Hochschule Zürich core funding (OM, DD, and GR), the Max Planck Institute (NDY, REL, and BS), and the Eidgenössische Technische Hochschule Strategic Focus Area - Personalized Health and Related Technologies (project #106 to DD). OM was also supported by the Max Planck ETH Center for Learning Systems. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript. OM, DD, and GR received a salary from the Eidgenössische Technische Hochschule Zürich; NDY, REL, and BS received a salary from the Max Planck Institute.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="6"/>
      <table-count count="3"/>
      <page-count count="20"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2023-05-11</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>Resmico is publicly available at <ext-link xlink:href="https://github.com/leylabmpi/ResMiCo" ext-link-type="uri">https://github.com/leylabmpi/ResMiCo</ext-link>. The computationally intensive feature extraction library was written in C++, and the data simulation pipeline was implemented using Snakemake <ext-link xlink:href="https://doi.org/10.1093/bioinformatics/bts480" ext-link-type="uri">https://doi.org/10.1093/bioinformatics/bts480</ext-link> [<xref rid="pcbi.1011001.ref047" ref-type="bibr">47</xref>]. The deep learning model was built using Tensorflow <ext-link xlink:href="http://download.tensorflow.org/paper/whitepaper2015.pdf" ext-link-type="uri">http://download.tensorflow.org/paper/whitepaper2015.pdf</ext-link> [<xref rid="pcbi.1011001.ref048" ref-type="bibr">48</xref>]. MGSIM is available at <ext-link xlink:href="https://github.com/nick-youngblut/MGSIM" ext-link-type="uri">https://github.com/nick-youngblut/MGSIM</ext-link>. Due to the size of the n9k-train and n9k-novel datasets, these data has been deposited on the MPI for Biology FTP server and can be downloaded with tools such as wget or curl through the following link: <ext-link xlink:href="http://ftp.tue.mpg.de/ebio/projects/ResMiCo/" ext-link-type="uri">http://ftp.tue.mpg.de/ebio/projects/ResMiCo/</ext-link>. The authors are committed to ensuring the perpetual public accessibility of these data.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>Resmico is publicly available at <ext-link xlink:href="https://github.com/leylabmpi/ResMiCo" ext-link-type="uri">https://github.com/leylabmpi/ResMiCo</ext-link>. The computationally intensive feature extraction library was written in C++, and the data simulation pipeline was implemented using Snakemake <ext-link xlink:href="https://doi.org/10.1093/bioinformatics/bts480" ext-link-type="uri">https://doi.org/10.1093/bioinformatics/bts480</ext-link> [<xref rid="pcbi.1011001.ref047" ref-type="bibr">47</xref>]. The deep learning model was built using Tensorflow <ext-link xlink:href="http://download.tensorflow.org/paper/whitepaper2015.pdf" ext-link-type="uri">http://download.tensorflow.org/paper/whitepaper2015.pdf</ext-link> [<xref rid="pcbi.1011001.ref048" ref-type="bibr">48</xref>]. MGSIM is available at <ext-link xlink:href="https://github.com/nick-youngblut/MGSIM" ext-link-type="uri">https://github.com/nick-youngblut/MGSIM</ext-link>. Due to the size of the n9k-train and n9k-novel datasets, these data has been deposited on the MPI for Biology FTP server and can be downloaded with tools such as wget or curl through the following link: <ext-link xlink:href="http://ftp.tue.mpg.de/ebio/projects/ResMiCo/" ext-link-type="uri">http://ftp.tue.mpg.de/ebio/projects/ResMiCo/</ext-link>. The authors are committed to ensuring the perpetual public accessibility of these data.</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic toggle="yes">PLOS Computational Biology</italic> Methods paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Metagenome sequencing is rapidly increasing in popularity due to the lowering costs of sequencing and simplified library construction methods [<xref rid="pcbi.1011001.ref001" ref-type="bibr">1</xref>, <xref rid="pcbi.1011001.ref002" ref-type="bibr">2</xref>]. At the same time, improvements in metagenome assembly tools [<xref rid="pcbi.1011001.ref003" ref-type="bibr">3</xref>, <xref rid="pcbi.1011001.ref004" ref-type="bibr">4</xref>] and high-performance computing resources have increased the feasibility of large-scale metagenome assemblies on 1000s of samples [<xref rid="pcbi.1011001.ref005" ref-type="bibr">5</xref>–<xref rid="pcbi.1011001.ref007" ref-type="bibr">7</xref>]. The contiguous sequences (contigs) generated via metagenome assembly can be analyzed directly for such tasks as creating gene catalogs [<xref rid="pcbi.1011001.ref008" ref-type="bibr">8</xref>, <xref rid="pcbi.1011001.ref009" ref-type="bibr">9</xref>], or binning approaches can be used to cluster the contigs into metagenome-assembled genomes (MAGs) that can be used for various comparative genomics applications [<xref rid="pcbi.1011001.ref010" ref-type="bibr">10</xref>].</p>
    <p>These advances have given rise to vast genome assembly databases, such as the Unified Human Gastrointestinal Genome (UHGG) [<xref rid="pcbi.1011001.ref011" ref-type="bibr">11</xref>], in which MAGs account for 70% of the species. As another example, the Genome Taxonomy Database (GTDB) expanded from approximately 32,000 species to nearly 50,000 in less than one year [<xref rid="pcbi.1011001.ref012" ref-type="bibr">12</xref>, <xref rid="pcbi.1011001.ref013" ref-type="bibr">13</xref>], largely due to the proliferation of MAGs. Given the low-throughput nature of isolating Bacteria and Archaea for independent genome sequencing [<xref rid="pcbi.1011001.ref011" ref-type="bibr">11</xref>], metagenome assembly approaches will likely continue to dominate.</p>
    <p>The correct assembly of metagenomes is challenging due to several factors, including sequencing errors, high taxonomic diversity often comprising 1000s of species, uneven coverage, and repetitive genomic regions [<xref rid="pcbi.1011001.ref014" ref-type="bibr">14</xref>]. All of these factors contribute to misassemblies, with the most common being structural variations, relocations, translocations, and inversions [<xref rid="pcbi.1011001.ref015" ref-type="bibr">15</xref>]. Long read sequence data can mitigate some of these issues [<xref rid="pcbi.1011001.ref014" ref-type="bibr">14</xref>, <xref rid="pcbi.1011001.ref016" ref-type="bibr">16</xref>], but the expense relative to short read sequencing generally prevents one from obtaining sufficient sequence coverage for complex communities [<xref rid="pcbi.1011001.ref017" ref-type="bibr">17</xref>]. While assembly contiguity can be assessed easily by calculating such metrics as N50, assessing assembly accuracy is considerably more challenging due to a few major causes. First, due to a lack of very closely related taxa with genome regions (nearly) identical to the query, contigs cannot simply be mapped to references in order to assess accuracy. Second, reference-free tools that predict misassemblies have generally been trained and validated on small, homogeneous datasets in the past, which raises the question of their robustness to novel data (e.g., novel taxa or assembly methods). Indeed, Mineeva and colleagues showed that existing tools generally performed poorly on a large, heterogeneous dataset [<xref rid="pcbi.1011001.ref018" ref-type="bibr">18</xref>]. The authors’ novel deep learning approach, DeepMAsED, amply outperformed the state of the art and was relatively robust to taxonomic novelty, achieving an AUPRC score of 0.57 on a novel genome dataset; still, there remained substantial room for improvement in model accuracy and also a robust validation on complex datasets spanning the heterogeneity of existing metagenomes from complex communities. Indeed, Lei and colleagues developed metaMIC, a reference-free machine learning (ML) model for predicting misassemblies in metagenome assemblies [<xref rid="pcbi.1011001.ref019" ref-type="bibr">19</xref>], and showed that DeepMAsED’s performance was inferior to metaMIC’s; however, only few methodological details were provided on the validation approach.</p>
    <p>We present <underline>Res</underline>idual Neural Network for <underline>Mi</underline>sassembled <underline>Co</underline>ntigs Identification (ResMiCo), a novel approach for reference-free identification of misassembled contigs in metagenome assemblies. ResMiCo is a deep convolutional neural network with skip connections between non-adjacent layers. Similar architectures have proven to be highly successful when trained on large datasets from various fields [<xref rid="pcbi.1011001.ref020" ref-type="bibr">20</xref>, <xref rid="pcbi.1011001.ref021" ref-type="bibr">21</xref>]. We utilize a novel high throughput pipeline to generate complex and realistic training data covering much of the possible parameter space (e.g., varying data richness, sequencing depth, sequencing error rate, community diversities, and metagenome assembly methods). Through extensive evaluation, we show that the model outperforms the existing state of the art and is robust to metagenome data heterogeneity, including taxonomic novelty and metagenome assembly parameters. ResMiCo is also robust to alternative data simulation approaches, as shown when applied to the Critical Assessment Metagenome Interpretation (CAMI) datasets. We show that using ResMiCo to filter putative genomes reduces the number of misassembled contigs by a factor of four. We also apply ResMiCo to a large collection of metagenomes from published studies and show that 7% ± 5.7 (s.d.) of contigs per metagenome are misassembled. Lastly, we show that ResMiCo can be used to optimize metagenome assembler parameters for accuracy without the need for simulated or mock-community metagenome datasets.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and methods</title>
    <sec id="sec003">
      <title>Simulated data</title>
      <p>We used synthetic datasets for initial model training and testing. The data simulation methodology, depicted in <xref rid="pcbi.1011001.g001" ref-type="fig">Fig 1</xref>, builds on, and significantly expands on our previous work [<xref rid="pcbi.1011001.ref018" ref-type="bibr">18</xref>]. Reference bacterial and archaeal genomes were selected from Release 202 of the Genome Taxonomy Database (GTDB) [<xref rid="pcbi.1011001.ref022" ref-type="bibr">22</xref>]. Metagenomes were simulated from publicly available reference genomes via MGSIM (<ext-link xlink:href="https://github.com/nick-youngblut/MGSIM" ext-link-type="uri">https://github.com/nick-youngblut/MGSIM</ext-link>). Simulation parameters varied in all combinations of i) community richness, ii) community abundance distribution, iii) reference genomes selected from the total pool, iv) read length, v) insert size distribution (i.e., the distance in between the forward and reverse read pair), vi) sequencer error profile, vii) sequencing depth, and viii) metagenome assembler (<xref rid="pcbi.1011001.t001" ref-type="table">Table 1</xref>). The abundance distribution of each community was modeled as a log-normal distribution. We varied parameter <italic toggle="yes">σ</italic> to produce differing levels of evenness of relative abundances. Community richness was altered by random sub-sampling from the pool of reference genomes available in the training or test split. The ART [<xref rid="pcbi.1011001.ref023" ref-type="bibr">23</xref>] read simulator was used to generate paired-end Illumina reads of length 100 or 150 using either the default “Illumina HiSeq 2500” error profile or the “HiSeq2500L150R1/2” error profile used in CAMISIM [<xref rid="pcbi.1011001.ref024" ref-type="bibr">24</xref>]. Four paired-end read insert size distributions were simulated via the ART parameter settings (see “Insert size” in <xref rid="pcbi.1011001.t001" ref-type="table">Table 1</xref>). We included multiple simulation replicates, in which the community and read simulation parameters were held constant, but each replicate differed via randomization of the genome sub-sampling within each simulation. The reads from each community were assembled independently with metaSPAdes [<xref rid="pcbi.1011001.ref003" ref-type="bibr">3</xref>] and MEGAHIT [<xref rid="pcbi.1011001.ref004" ref-type="bibr">4</xref>].</p>
      <fig position="float" id="pcbi.1011001.g001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011001.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>The ResMiCo simulation and training pipeline.</title>
          <p>(A) Select reference genomes from the Genome Taxonomy Database (GTDB) at various abundances; (B) Simulate reads for the selected genomes using ART-Illumina; (C) Assemble reads into contigs using MEGAHIT and metaSPAdes; (D) Align reads back to the assembled contigs using Bowtie2, then extract features such as coverage, number of single-nucleotide variants (SNVs), mean alignment score, etc., for each contig using the given alignments; (E) Compute labels for each contig by aligning against the reference genomes using MetaQUAST; (F) For each contig, select a random section (that contains a breakpoint if the contig is misassembled), pad to the network’s input length if necessary, and feed the data into the ResMiCo model. Steps (D) and (E) are independent and can be parallelized.</p>
        </caption>
        <graphic xlink:href="pcbi.1011001.g001" position="float"/>
      </fig>
      <p>MetaQUAST [<xref rid="pcbi.1011001.ref015" ref-type="bibr">15</xref>] was used to identify truly misassembled contigs based on mapping all contigs to the reference genomes used for the simulations. The MetaQUAST-identified contig misassembly labels (“extensive misassembly”) were used as ground truth. The extensive misassembly label includes relocations, inversions, translocations and interspecies translocations. We also extracted MetaQUAST-identified breakpoint positions in the misassembled contigs.</p>
      <table-wrap position="float" id="pcbi.1011001.t001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011001.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Parameter values used in the simulation pipeline.</title>
          <p>The training dataset <italic toggle="yes">n9k-train</italic> was generated using all 1440 parameter combinations for the insert size distribution with mean = 270 &amp; sd = 50 and mean = 190 &amp; sd = 75. For the “mean = 350 &amp; sd = 75” insert size distribution, 3 replicates for the “HiSeq 2500 L150R1/2” error profile and one replicate for the “HiSeq 2500 error” profile were generated (960 parameter combinations). For the “mean = 450 &amp; sd = 120” insert size distribution, we used all parameters combinations, but only with the “HiSeq 2500 L150R1/2” error profile (720 parameter combinations). In total, we created 4560 samples. The parameter grid was not uniformly sampled due to the resource limitations. The test dataset <italic toggle="yes">n9k-novel</italic> contains one simulation replicate with the “HiSeq 2500” error profile, and using one (mean = 270 &amp; sd = 50) insert size, which resulted in 240 parameter combinations.</p>
        </caption>
        <alternatives>
          <graphic xlink:href="pcbi.1011001.t001" id="pcbi.1011001.t001g" position="float"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1">Parameter</th>
                <th align="center" rowspan="1" colspan="1">Values</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Community richness</td>
                <td align="left" rowspan="1" colspan="1">50, 1000, 3000, 5000 genomes</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Genome abundance</td>
                <td align="left" rowspan="1" colspan="1">Lognormal with <italic toggle="yes">μ</italic> = 10 and <italic toggle="yes">σ</italic> ∈ {0.5, 1, 2}</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Replicates</td>
                <td align="left" rowspan="1" colspan="1">3 random selections of reference genomes</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Read length</td>
                <td align="left" rowspan="1" colspan="1">100, 150 bps</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Insert size</td>
                <td align="left" rowspan="1" colspan="1">mean &amp; sd ∈ {190&amp;75, 270&amp;50, 350&amp;75, 450&amp;120}</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Error profile</td>
                <td align="left" rowspan="1" colspan="1">HiSeq 2500, HiSeq 2500 L150R1/2 [<xref rid="pcbi.1011001.ref024" ref-type="bibr">24</xref>]</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Sequencing depth</td>
                <td align="left" rowspan="1" colspan="1">0.5m, 2m, 8m, 12m, 20m</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Assembler</td>
                <td align="left" rowspan="1" colspan="1">MEGAHIT, MetaSPAdes</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>For initial model training and testing, we utilized a pool of 18,000 reference genomes selected from Release 202 of the Genome Taxonomy Database (GTDB). The pool was split at the family taxonomic level so that all genomes in the test dataset belonged to families not present in the training dataset. The resulting split was even, with 9000 genomes used for both training and testing. To reduce bias toward particular species, at most 50 genomes per species were included in the reference genome pool, with genomes selected at random. The pool was also filtered by CheckM-estimated completeness (≥ 90%) and contamination (≤ 5%). Other filtering criteria included: i) only “high” MIMAG quality, ii) no single-cell genome assemblies, iii) ≤ 500 contigs, iv) a genome size of ≤ 15 mbp, and v) a mean contig length of ≥ 10 kbp. We randomly subsampled reads mapped to each contig to a maximum mean contig coverage of 20. At this coverage level, assemblies of reasonable quality can be produced, and subsampling helps prevent out-of-distribution issues when applying ResMiCo to datasets with substantially higher sequencing depth than in our training dataset.</p>
      <p>To create features for model training and testing, we mapped reads to the contigs from the corresponding synthetic metagenome via Bowtie2 [<xref rid="pcbi.1011001.ref025" ref-type="bibr">25</xref>], and the resulting alignment data was used to generate per contig position features, as listed in Table A in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>.</p>
      <p>We refer to the training dataset as <italic toggle="yes">n9k-train</italic> and to the test dataset, which consists of genomes novel at a family taxonomic level, as <italic toggle="yes">n9k-novel</italic>. All combinations of the metagenome simulation parameters produced a training dataset of 4560 metagenomes and 80M contigs (<xref rid="pcbi.1011001.t001" ref-type="table">Table 1</xref>). We were limited to 1.3T of available space on our HPC cluster, so we had to randomly subset <italic toggle="yes">n9k-train</italic> to 3000 metagenomes, comprising 52M contigs (<xref rid="pcbi.1011001.t002" ref-type="table">Table 2</xref>). The test set (<italic toggle="yes">n9k-novel</italic>) was generated using the subset of parameters and one simulation replicate to save computational time (<xref rid="pcbi.1011001.t001" ref-type="table">Table 1</xref>). We also created a test dataset with higher intra-species diversity (33.3 ± 115) versus <italic toggle="yes">n9k-novel</italic> (2.4 ± 13.7), which we named <italic toggle="yes">n2k-novel-intra-species</italic>. We used only 2000 reference genomes in order to include enough families with a high number of intra-species genome diversity, but still include only families novel relative to the train dataset (as with <italic toggle="yes">n9k-novel</italic>). The simulation parameters for <italic toggle="yes">n2k-novel-intra-species</italic> were consistent with <italic toggle="yes">n9k-train</italic>, except i) only 50 and 1000 genomes for richness, ii) one simulation replicate, iii) one insert size distribution (mean = 270, sd = 50), and iv) sequencing depths of 2M, 8M, and 12M read pairs.</p>
      <table-wrap position="float" id="pcbi.1011001.t002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011001.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>A summary of the five synthetic datasets used for training and evaluating ResMiCo.</title>
          <p>The <italic toggle="yes">n9k-train</italic> and <italic toggle="yes">n9k-novel</italic> datasets were generated using our pipeline, all other datasets were created from CAMI reads. The <italic toggle="yes">n9k-train</italic> dataset was used for training and validation, while all other datasets were used for testing. Misassemblies are reported as a percent of the total number of contigs in the dataset. Misassemblies length is the sum of misassembled contig lengths divided by the total number of bases.</p>
        </caption>
        <alternatives>
          <graphic xlink:href="pcbi.1011001.t002" id="pcbi.1011001.t002g" position="float"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1"/>
                <th align="left" rowspan="1" colspan="1">n9k-train</th>
                <th align="left" rowspan="1" colspan="1">n9k-novel</th>
                <th align="left" rowspan="1" colspan="1">gut</th>
                <th align="left" rowspan="1" colspan="1">skin</th>
                <th align="left" rowspan="1" colspan="1">oral</th>
                <th align="left" rowspan="1" colspan="1">marine</th>
                <th align="left" rowspan="1" colspan="1">plant</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Contigs</td>
                <td align="left" rowspan="1" colspan="1">52.5M</td>
                <td align="left" rowspan="1" colspan="1">6.8M</td>
                <td align="left" rowspan="1" colspan="1">0.44M</td>
                <td align="left" rowspan="1" colspan="1">0.32M</td>
                <td align="left" rowspan="1" colspan="1">.41M</td>
                <td align="left" rowspan="1" colspan="1">1.0</td>
                <td align="left" rowspan="1" colspan="1">1.0</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Bases</td>
                <td align="left" rowspan="1" colspan="1">159B</td>
                <td align="left" rowspan="1" colspan="1">19.7B</td>
                <td align="left" rowspan="1" colspan="1">1.5B</td>
                <td align="left" rowspan="1" colspan="1">890M</td>
                <td align="left" rowspan="1" colspan="1">1.5B</td>
                <td align="left" rowspan="1" colspan="1">2.3B</td>
                <td align="left" rowspan="1" colspan="1">3.4B</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Average Coverage</td>
                <td align="left" rowspan="1" colspan="1">12.6</td>
                <td align="left" rowspan="1" colspan="1">10.2</td>
                <td align="left" rowspan="1" colspan="1">16.9</td>
                <td align="left" rowspan="1" colspan="1">15.7</td>
                <td align="left" rowspan="1" colspan="1">16.3</td>
                <td align="left" rowspan="1" colspan="1">14.1</td>
                <td align="left" rowspan="1" colspan="1">16.7</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Misassemblies</td>
                <td align="left" rowspan="1" colspan="1">3.41%</td>
                <td align="left" rowspan="1" colspan="1">4.0%</td>
                <td align="left" rowspan="1" colspan="1">1.2%</td>
                <td align="left" rowspan="1" colspan="1">1.72%</td>
                <td align="left" rowspan="1" colspan="1">1.74%</td>
                <td align="left" rowspan="1" colspan="1">2.66%</td>
                <td align="left" rowspan="1" colspan="1">2.43%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Misassemblies length</td>
                <td align="left" rowspan="1" colspan="1">3.69%</td>
                <td align="left" rowspan="1" colspan="1">4.26%</td>
                <td align="left" rowspan="1" colspan="1">3.82%</td>
                <td align="left" rowspan="1" colspan="1">3.06%</td>
                <td align="left" rowspan="1" colspan="1">3.20%</td>
                <td align="left" rowspan="1" colspan="1">3.29%</td>
                <td align="left" rowspan="1" colspan="1">6.70%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Median Contig length</td>
                <td align="left" rowspan="1" colspan="1">1530</td>
                <td align="left" rowspan="1" colspan="1">1510</td>
                <td align="left" rowspan="1" colspan="1">1473</td>
                <td align="left" rowspan="1" colspan="1">1394</td>
                <td align="left" rowspan="1" colspan="1">1455</td>
                <td align="left" rowspan="1" colspan="1">1349</td>
                <td align="left" rowspan="1" colspan="1">1427</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
    </sec>
    <sec id="sec004">
      <title>CAMI simulated metagenomes</title>
      <p>To benchmark ResMiCo’s performance in a new setting, we downloaded the paired-end reads of the Critical Assessment of Metagenome Interpretation (CAMI) human skin, human oral, human gut, plant-associated, and marine assembly challenges [<xref rid="pcbi.1011001.ref026" ref-type="bibr">26</xref>]. As with the <italic toggle="yes">n9k-train</italic> dataset, we assembled the reads via metaSPAdes and MEGAHIT, and identified true misassemblies via MetaQUAST based on the reference genomes in each of the 5 datasets. As shown in <xref rid="pcbi.1011001.t002" ref-type="table">Table 2</xref>, the number of misassembled contigs in the CAMI datasets is ∼50% lower, while coverage is ∼50% higher relative to the <italic toggle="yes">n9k-train</italic> dataset. The breakpoint locations for misassembled contigs follow a nearly identical distribution for all datasets, with more breakpoints clustered towards the ends (Fig A in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>).</p>
    </sec>
    <sec id="sec005">
      <title>Published, real-world metagenomes</title>
      <p>We evaluated ResMiCo on 7 published metagenome datasets: <italic toggle="yes">UHGG</italic> [<xref rid="pcbi.1011001.ref011" ref-type="bibr">11</xref>], <italic toggle="yes">TwinsUK</italic> [<xref rid="pcbi.1011001.ref027" ref-type="bibr">27</xref>], <italic toggle="yes">Animal-gut</italic> [<xref rid="pcbi.1011001.ref028" ref-type="bibr">28</xref>], <italic toggle="yes">Pinnell2019</italic> [<xref rid="pcbi.1011001.ref029" ref-type="bibr">29</xref>], <italic toggle="yes">Mantri2021</italic> [<xref rid="pcbi.1011001.ref030" ref-type="bibr">30</xref>], <italic toggle="yes">MarineMetagenomeDB</italic> [<xref rid="pcbi.1011001.ref031" ref-type="bibr">31</xref>], and <italic toggle="yes">TerrestrialMetagenomeDB</italic> [<xref rid="pcbi.1011001.ref032" ref-type="bibr">32</xref>] (<xref rid="pcbi.1011001.s002" ref-type="supplementary-material">S1 Table</xref>). The <italic toggle="yes">UHGG</italic> consisted of randomly selected metagenomes associated with the UHGG MAG collection. <italic toggle="yes">TwinsUK</italic> consisted of human gut metagenomes from adults in the TwinsUK cohort [<xref rid="pcbi.1011001.ref027" ref-type="bibr">27</xref>], while the <italic toggle="yes">Animal-gut</italic> comprised gut metagenomes from a broad taxonomic diversity of vertebrates [<xref rid="pcbi.1011001.ref028" ref-type="bibr">28</xref>].<italic toggle="yes">Pinnell2019</italic> and <italic toggle="yes">Mantri2021</italic> consisted of benthic and soil microbial community metagenomes, respectively. <italic toggle="yes">MarineMetagenomeDB</italic> and <italic toggle="yes">TerrestrialMetagenomeDB</italic> consisted of a selection of metagenomes from each respective database. The following filtering criteria were applied prior to metagenome selection: i) ≥ 1e6 and ≤ 80e6 reads, ii) maximum read lengths of ≤ 150bp, and iii) ≥ 10 samples in the study, and for the UHGG: iv) ≥ 10 and ≤ 300 MAGs associated with the metagenome.</p>
      <p>We also evaluated ResMiCo on 2 mock community datasets: BMock12 [<xref rid="pcbi.1011001.ref033" ref-type="bibr">33</xref>] and MBARC-26 [<xref rid="pcbi.1011001.ref034" ref-type="bibr">34</xref>]. We subsampled each metagenome to 2M read pairs in order to evaluate a sequencing depth on par with existing real-world metagenomes [<xref rid="pcbi.1011001.ref035" ref-type="bibr">35</xref>, <xref rid="pcbi.1011001.ref036" ref-type="bibr">36</xref>]. Representative genomes were downloaded from JGI IMG and Genbank for BMock12 and MBARC-26, respectively. These representatives were used in conjunction with MetaQUAST to identify true misassemblies.</p>
      <p>Metagenome read data processing was done as described in Youngblut and colleagues [<xref rid="pcbi.1011001.ref028" ref-type="bibr">28</xref>]. Briefly, reads were validated with fqtools [<xref rid="pcbi.1011001.ref037" ref-type="bibr">37</xref>]. Adapters were trimmed with Skewer [<xref rid="pcbi.1011001.ref038" ref-type="bibr">38</xref>]. The “bbduk” command from bbtools (<ext-link xlink:href="https://sourceforge.net/projects/bbmap/" ext-link-type="uri">https://sourceforge.net/projects/bbmap/</ext-link>) was used to trim and filter reads based on Phred scores. The “bbmap” command from bbtools was used to filter reads mapping to the hg19 human genome assembly. Read quality reports for each step of the pipeline were generated and visualised with FastQC and MultiQC, respectively (<ext-link xlink:href="https://www.bioinformatics.babraham.ac.uk/" ext-link-type="uri">https://www.bioinformatics.babraham.ac.uk/</ext-link>, [<xref rid="pcbi.1011001.ref039" ref-type="bibr">39</xref>]). Metagenomes were assembled via metaSPAdes with default parameters, and contigs &lt; 1000bp were removed. We did not also assemble the metagenomes with MEGAHIT, given the extra computational expense and methods complexity of evaluating both assemblers for each dataset, along the improved accuracy of metaSPAdes versus MEGAHIT [<xref rid="pcbi.1011001.ref003" ref-type="bibr">3</xref>]. Read mapping and ResMiCo feature generation were conducted as done for the simulation datasets.</p>
    </sec>
    <sec id="sec006">
      <title>Data preprocessing</title>
      <p>Count features were normalized by coverage (the number of reads mapped to the position) such that they are in the 0–1 range. For numerical features, we pre-computed mean and standard deviations using all contigs in the <italic toggle="yes">n9k-train</italic> dataset and saved these values. For all datasetes, we standardized numerical features to set the mean to zero and the variance to one using values computed on the training set. Missing values were replaced by zero (the new mean). We summarize the preprocessing applied to each feature in Table A in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>.</p>
      <p>Since we observed that ResMiCo did not generalize well to insert size distributions substantially deviating from the training dataset (Table E in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>), we excluded metagenomes for which the 0.05 and 0.95 quantiles of the mean insert size distribution lay outside the 0.02 and 0.98 quantiles of the mean insert size distribution of the <italic toggle="yes">n9k-train</italic> dataset, which are equal to 117 and 493, respectively.</p>
    </sec>
    <sec id="sec007">
      <title>Model and training</title>
      <sec id="sec008">
        <title>Architecture</title>
        <p>The ResMiCo neural network (NN) architecture is shown in <xref rid="pcbi.1011001.g002" ref-type="fig">Fig 2</xref>. It belongs to a class of deep convolutional residual neural networks. Residual connections enable deeper (more layers) neural networks and more efficient training compared to convolutional NNs [<xref rid="pcbi.1011001.ref020" ref-type="bibr">20</xref>]. Deeper models can capture more complex patterns spread over larger inputs. The main building unit, depicted at the bottom of the figure, is the residual block, consisting of two batch-normalized-convolutions [<xref rid="pcbi.1011001.ref040" ref-type="bibr">40</xref>] with a ReLu activation. The input of the residual block is connected with the output by simple element-wise addition. Since convolutions are not padded, the last 2*(<italic toggle="yes">K</italic> − 1) positions in the residual input, where <italic toggle="yes">K</italic> is the convolution kernel size, are cut off to match the output size. When the residual block is downsampling the data (by using a stride of <italic toggle="yes">S</italic> = 2 in the first convolution), the residual input is downsampled with a <italic toggle="yes">K</italic> = 1 convolution of an identical stride.</p>
        <fig position="float" id="pcbi.1011001.g002">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1011001.g002</object-id>
          <label>Fig 2</label>
          <caption>
            <title>ResMiCo architecture.</title>
            <p>The input is first passed through multiple convolutional layers; then the convolved result is masked to eliminate the effect of padding and passed through an average pooling layer, followed by two fully connected layers of sizes 128 × 50 and 50 × 1. The convolutional part consists of a simple convolution, followed by four residual groups (RG) with 2, 5, 5, and 2 residual blocks, respectively. The bottom of the figure depicts the structure of a residual block with a given number of features (F), kernel size (K), and stride (S). The first convolution in RG2, RG3, and RG4 halves the input size (using a stride of S = 2) and doubles the number of filters, gradually from 16 to 128. B denotes the batch size, and M represents the maximum contig length. The “14” in “BxMx14” represents the number of the selected features in the input to the neural network. Overall, ResMiCo has 562,573 parameters, of which 559,441 are trainable.</p>
          </caption>
          <graphic xlink:href="pcbi.1011001.g002" position="float"/>
        </fig>
        <p>Residual blocks with the same number of filters and identical output shapes are grouped into <italic toggle="yes">residual groups</italic>. ResMiCo has 4 residual groups, with the center groups consisting of 5 residual blocks each, while the outside groups contain 2 residual blocks. Each of the last three residual groups starts with a convolution that doubles the number of filters and halves the input size using a stride <italic toggle="yes">S</italic> = 2. All layers use a ReLU activation, except for the last fully connected layer, which uses a sigmoid activation. The output of the convolutional layers is summarized along the spatial axis via global average pooling, resulting in an output shape that depends only on the number of filters in the last convolutional layer (128 in our case) rather than on the contig length, thus allowing ResMiCo to handle contigs of variable length. Contigs in a batch are padded to the longest length, and the effects of padding are neutralized by creating a mask that is fed to the global average pooling layer. The resulting 128 features of the global average pooling are fed into the final two layers: a fully connected layer with 50 neurons and a one-neuron output layer with a sigmoid activation function.</p>
      </sec>
      <sec id="sec009">
        <title>Training</title>
        <p>The model was trained on the <italic toggle="yes">n9k-train</italic> training dataset for 50 epochs. One <italic toggle="yes">epoch</italic> is one pass of the entire training dataset through the algorithm. All misassembled contigs were used as positive training examples. In contrast, we randomly selected a 10% subset at every training epoch for the over-represented class of correctly assembled contigs, thus artificially increasing the positive sample rate to 24%. This helped to balance the dataset and reduce the computational load during training. For contigs shorter than 20,000 base-pairs, the entire contig is selected and zero-padded to the maximum batch length. For misassembled contigs longer than 20,000 base-pairs, a random 20,000 base-pair interval around each breakpoint (as identified by MetaQUAST) was selected. For long contigs with no misassemblies, a random 20,000 base-pair interval is selected.</p>
        <p>During model training, the binary cross-entropy loss between the target and predicted output was minimized by an Adam optimizer [<xref rid="pcbi.1011001.ref041" ref-type="bibr">41</xref>]. We used a batch size of 200 and an initial learning rate of 0.0001 with exponential decay of 0.8 when plateauing at evaluation. Gradients were clipped to a norm of 1 and a value of 0.5.</p>
      </sec>
      <sec id="sec010">
        <title>Model selection</title>
        <p>We used 10% of the <italic toggle="yes">n9k-train</italic> dataset as a validation set for model selection (<italic toggle="yes">n9k-valid</italic>). AUPRC on the validation set was computed every second epoch; if the score improved, a corresponding model was saved. The ResMiCo model described in this section achieved the highest AUPRC on the <italic toggle="yes">n9k-valid</italic> dataset at Epoch 46. The list of optimized hyperparameters and the attempted values are provided in Table B in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>.</p>
      </sec>
      <sec id="sec011">
        <title>Feature selection</title>
        <p>Since ResMiCo uses a larger number of features than both DeepMAsED and metaMIC, it is important to understand the amount that each feature, particularly features unique to ResMiCo, contributes to model predictions. Borrowed from game theory, Shapley values provide a principled way of explaining the predictions of machine learning models. We approximated the Shapley values using the Deep Shap (SHAP) algorithm [<xref rid="pcbi.1011001.ref042" ref-type="bibr">42</xref>], a refined version of DeepLIFT [<xref rid="pcbi.1011001.ref043" ref-type="bibr">43</xref>].</p>
        <p>In order to be able to compute SHAP coefficients, we had to make some adjustments to ResMiCo’s architecture: the input size was fixed, the padding was not masked, and the global average pooling layer was replaced by local pooling with a window covering the whole length. SHAP requires as input background samples as well as samples for which the predictions will be explained. We randomly sampled 200 contigs for the background and 200 contigs for explanations (100 correctly assembled and 100 misassembled) from the <italic toggle="yes">n9k-novel</italic> dataset. In Fig L in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>, we show that SHAP led to the same conclusions when using subsets of the 200 contigs, suggesting 200 is sufficient for this analysis.</p>
        <p><xref rid="pcbi.1011001.g003" ref-type="fig">Fig 3</xref> shows features ranked by their importance. For comparison, we also marked features present in the ResMiCo pipeline that were used by metaMIC and DeepMAsED. Feature names are explained in Table A in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>. The top 14 features were selected as input to the ResMiCo model. We included at least one feature of each kind: mapping quality, alignment score, etc. Limiting the number of features resulted in significantly reduced training time.</p>
        <fig position="float" id="pcbi.1011001.g003">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1011001.g003</object-id>
          <label>Fig 3</label>
          <caption>
            <title>Feature ranked by their importance.</title>
            <p>The lighter color marks features used by the ResMiCo model. We denote features used by DeepMAsED and metaMIC with a star outline and filled star, respectively. <monospace specific-use="no-wrap">mapq</monospace> and <monospace specific-use="no-wrap">al_score</monospace> are mapping quality and alignment score, as defined by Bowtie2. <monospace specific-use="no-wrap">num_snp</monospace> is the number of SNVs among aligned reads relative to the reference. <monospace specific-use="no-wrap">num_query_[ATGC]</monospace> is the base composition of aligned reads at the target position. <monospace specific-use="no-wrap">num_orphan</monospace> is the number of aligned reads in which only one of the pairs aligns properly. <monospace specific-use="no-wrap">num_proper</monospace> is the number of read pairs that align properly, as defined by Bowtie2. <monospace specific-use="no-wrap">num_proper_snp</monospace> is properly aligned reads with a SNV relative to the reference at the target position. <monospace specific-use="no-wrap">ref_base</monospace> is the reference base <monospace specific-use="no-wrap">[ATGC]</monospace> at the target position. Error bars correspond to the stdev computed over 5 runs.</p>
          </caption>
          <graphic xlink:href="pcbi.1011001.g003" position="float"/>
        </fig>
      </sec>
      <sec id="sec012">
        <title>Predictions</title>
        <p>To predict the misassembly probability for contigs longer than 20,000 base pairs, we split the contig into chunks of 20,000 base pairs, with a stride (overlap) of 500 bases in order to mitigate problems when the breakpoint is located at the very end of a chunk and two consecutive chunks individually appear as correctly assembled contigs. The prediction for the contig was obtained by selecting the maximum score across all chunks. For contigs shorter than 20,000 base pairs, the entire contig is given as input.</p>
      </sec>
    </sec>
    <sec id="sec013">
      <title>Comparison to the state of the art</title>
      <p>We analyzed the performance of our proposed model in relation to the following existing methods:</p>
      <list list-type="bullet">
        <list-item>
          <p>metaMIC [<xref rid="pcbi.1011001.ref044" ref-type="bibr">44</xref>]—applied with default parameters, except the minimum contig length was reduced from 5 kbp to 1 kbp, in order to test on the same data as the other methods;</p>
        </list-item>
        <list-item>
          <p>DeepMAsED [<xref rid="pcbi.1011001.ref018" ref-type="bibr">18</xref>]—we followed the feature generation scheme and the trained model provided by the authors;</p>
        </list-item>
        <list-item>
          <p>ALE [<xref rid="pcbi.1011001.ref045" ref-type="bibr">45</xref>]—we aggregated four positional sub-scores that ALE outputs (depth, place, insert, and k-mer log-likelihoods) with the same thresholds defined in [<xref rid="pcbi.1011001.ref018" ref-type="bibr">18</xref>]. The contig misassembly probability is computed as the number of positions with the sub-score below the threshold divided by contig length;</p>
        </list-item>
        <list-item>
          <p>Random—we assigned a random misassembly probability to each contig. This results in a horizontal line on a precision-recall curve plot with a precision equal to the prevalence of misassemblies in the dataset.</p>
        </list-item>
      </list>
      <p>Since all datasets suffer from a class imbalance in the detriment of positive samples (misassembled contigs, <xref rid="pcbi.1011001.t002" ref-type="table">Table 2</xref>), we selected the area under the precision-recall curve (AUPRC) as a metric to measure performance, rather than the area under the receiver operator curve (AUROC) [<xref rid="pcbi.1011001.ref046" ref-type="bibr">46</xref>]. However, AUPRC is not invariant to the prevalence of positive samples, so we used AUROC to compare the model’s performance across datasets with different percentages of positive samples.</p>
    </sec>
    <sec id="sec014">
      <title>Benchmarking ResMiCo resource requirements</title>
      <p>We benchmarked ResMiCo with direct comparisons between utilizing one CPU versus one GPU. On the CAMI gut dataset, ResMiCo was &gt; 2x faster with a GPU versus a CPU (108 ± 0.7 versus 38.7 ± 10.3 contigs per second). While a GPU is substantially faster than a CPU, one could still process nearly 140,000 contigs in 1 hour with a single CPU. Nonetheless, we note that multiple GPUs are recommended for training the model on large datasets, given that training on CPUs would not be feasible for large datasets, as in this work.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec015">
    <title>Results</title>
    <sec id="sec016">
      <title>ResMiCo outperforms existing models and is robust to metagenome novelty</title>
      <p>We first tested all models against the <italic toggle="yes">n9k-novel</italic> dataset, which consisted of family-level taxonomically novel genomes relative to any in the training dataset. ResMiCo outperformed DeepMAsED, ALE, and metaMIC by a large margin, with an AUPRC of 0.76 versus 0.25 for DeepMAsED, the second-best performing model (<xref rid="pcbi.1011001.g004" ref-type="fig">Fig 4A</xref>). Note that DeepMAsED’s AUPRC score dropped from 0.57 (reported in [<xref rid="pcbi.1011001.ref018" ref-type="bibr">18</xref>]) to 0.25 due to a higher variability within the <italic toggle="yes">n9k-novel</italic> test set. Importantly, ResMiCo’s AUPRC did not substantially differ between the training validation (0.73) and the <italic toggle="yes">n9k-novel</italic> dataset (0.76), thereby demonstrating that the model is robust to taxonomic novelty. ResMiCo’s AUPRC score typically varied from 0.6 to 0.8 across the various simulation parameter combinations (Fig H in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>). The most challenging settings for ResMiCo were a low community richness and a low sequencing depth. We also found that the contig length distribution explained much of the variability in ResMiCo model performance. For the simulations with a median contig length longer than 2000bp, the AUPRC was between 0.4 and 0.6 (Fig E in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>). In terms of misassembly type, ResMiCo performance was lowest for inversions (Fig G in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>).</p>
      <fig position="float" id="pcbi.1011001.g004">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011001.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>ResMiCo performance evaluation.</title>
          <p>Precision-recall curves and the corresponding AUPRC scores for ResMiCo and four baseline methods (metaMIC, DeepMAsED, ALE, Random) applied on the (A) <italic toggle="yes">nk9-novel</italic>, (B) CAMI gut, (C) CAMI oral, and (D) CAMI skin datasets. (E) Receiver operating characteristic curve and the corresponding AUROC scores for ResMiCo applied on five datasets: <italic toggle="yes">n9k-train</italic> (validation set only), <italic toggle="yes">nk9-novel</italic>, and three CAMI datasets.</p>
        </caption>
        <graphic xlink:href="pcbi.1011001.g004" position="float"/>
      </fig>
      <p>We simulated another test dataset (<italic toggle="yes">n2k-novel-intraspecies</italic>) with more genomes per species (33.3 ± 115) versus <italic toggle="yes">n9k-novel</italic> (2.4 ± 13.7). ResMiCo performance on <italic toggle="yes">n2k-novel-intraspecies</italic> declined relative to <italic toggle="yes">n9k-novel</italic> (AUPRC = 0.487, AUROC = 0.955), which was likely due to an increase in inter-genome translocations among closely related taxa. Still, ResMiCo greatly outperformed the closest competitor: metaMIC (AUPRC = 0.080, AUROC = 0.805).</p>
      <p>We next evaluated ResMiCo on the CAMI gut, oral, and skin metagenome datasets, which are commonly used simulation datasets for the evaluation of metagenomics analysis tools. The CAMI datasets differed substantially from <italic toggle="yes">n9k-train</italic> and <italic toggle="yes">n9k-novel</italic> in regards to coverage (sequencing depth) and class imbalance (percent misassemblies) (<xref rid="pcbi.1011001.t002" ref-type="table">Table 2</xref>). Moreover, reference genomes used for the <italic toggle="yes">n9k-train</italic> and <italic toggle="yes">n9k-novel</italic> datasets were selected from the entire GTDB, while the CAMI datasets consisted of biome-specific reference genomes [<xref rid="pcbi.1011001.ref024" ref-type="bibr">24</xref>]. Regardless of these differences, ResMiCo’s performance remained largely unaffected, and the model still clearly outperformed all competitors (<xref rid="pcbi.1011001.g004" ref-type="fig">Fig 4B, 4C and 4D</xref>). Given that the 5 synthetic datasets differ substantially in true positive rates (<xref rid="pcbi.1011001.t002" ref-type="table">Table 2</xref>), we computed the AUROC score, which is unaffected by such differences. <xref rid="pcbi.1011001.g004" ref-type="fig">Fig 4E</xref> shows that the AUROC remains relatively constant across the <italic toggle="yes">n9k-train</italic> validation, <italic toggle="yes">n9k-novel</italic>, and the CAMI datasets.</p>
      <p>We also evaluated ResMiCo on two CAMI datasets that simulate non-human biomes: <italic toggle="yes">CAMI-marine</italic> and <italic toggle="yes">CAMI-plant-associated</italic>. The performance of ResMiCo was comparable to the human-associated CAMI datasets (<italic toggle="yes">CAMI-marine</italic>: AUPRC = 0.831, AUROC = 0.990; <italic toggle="yes">CAMI-plant-associated</italic>: AUPRC = 0.611, AUROC = 0.965), suggesting that ResMiCo can generalize to metagenomes from highly varying biomes.</p>
      <p>Lastly, we assessed 2 mock community datasets: BMock12 [<xref rid="pcbi.1011001.ref033" ref-type="bibr">33</xref>] and MBARC-26 [<xref rid="pcbi.1011001.ref034" ref-type="bibr">34</xref>]. While existing mock communities are orders of magnitude lower in richness than complex communities, such as soil or mammalian gut microbiomes, and usually completely lack intra-species genomic diversity, mock communities do provide the best available real-world, ground-truth datasets. ResMiCo performance was in line with our expectations based on our simulations of low community richness (Fig H and I in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>), with an AUPRC of 0.475 and an AUROC of 0.951 when averaged across the 2 datasets (Table H in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>). These findings demonstrate that ResMiCo can generalize well to real-world metagenomic data.</p>
    </sec>
    <sec id="sec017">
      <title>Improvement of assembly quality after filtering ResMiCo-identified misassemblies</title>
      <p>A primary function of ResMiCo is to identify misassembled contigs so that they can be removed from the assembly. To illustrate the effects of such filtering, we discarded contigs in <italic toggle="yes">n9k-novel</italic> with a ResMiCo score of &gt;0.8, which corresponds to a recall and precision of 0.72 and 0.65, respectively. Given that truly misassemblied contigs are known for the <italic toggle="yes">n9k-novel</italic> dataset, we could measure the true error rate before and after filtering. Filtering according to ResMiCo scores resulted in a reduction of the true error rate from 4% to 1% while keeping the contiguity metrics virtually unmodified (<xref rid="pcbi.1011001.t003" ref-type="table">Table 3</xref>).</p>
      <table-wrap position="float" id="pcbi.1011001.t003">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011001.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title>Low-quality contig filtering.</title>
          <p>Statistics before and after filtering low-quality contigs with the ResMiCo model applied on the <italic toggle="yes">n9k-novel</italic> test set. The ResMiCo score threshold was set to &gt;0.8. Misassemblies length is the sum of misassembled contig lengths divided by the total number of bases.</p>
        </caption>
        <alternatives>
          <graphic xlink:href="pcbi.1011001.t003" id="pcbi.1011001.t003g" position="float"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Dataset</th>
                <th align="left" rowspan="1" colspan="1">True error rate</th>
                <th align="left" rowspan="1" colspan="1">Misassemblies length</th>
                <th align="left" rowspan="1" colspan="1">N contigs</th>
                <th align="left" rowspan="1" colspan="1">N50</th>
                <th align="left" rowspan="1" colspan="1">Mean length</th>
                <th align="left" rowspan="1" colspan="1">Median length</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Original</td>
                <td align="char" char="." rowspan="1" colspan="1">4.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">4.3%</td>
                <td align="right" rowspan="1" colspan="1">6779977</td>
                <td align="right" rowspan="1" colspan="1">3919</td>
                <td align="right" rowspan="1" colspan="1">2911</td>
                <td align="right" rowspan="1" colspan="1">1510</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ResMiCo</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>1.2%</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>1.8%</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">6474434</td>
                <td align="right" rowspan="1" colspan="1">3917</td>
                <td align="right" rowspan="1" colspan="1">2914</td>
                <td align="right" rowspan="1" colspan="1">1522</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>We also evaluated whether the MetaQUAST-defined “genome fraction” (the percentage of aligned bases in the reference genome) substantially declined as a result of filtering ResMiCo-identified misassemblies. For both the <italic toggle="yes">CAMI-gut</italic> and <italic toggle="yes">CAMI-marine</italic> datasets, the genome fraction did not substantially change after filtering (Wilcox, <italic toggle="yes">P</italic> ≥ 0.66; Fig K in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>).</p>
    </sec>
    <sec id="sec018">
      <title>Assembly optimization based on ResMiCo-identified error rates</title>
      <p>Since ResMiCo generates a score for each contig, we could use the number of contigs with a score above a certain threshold to estimate the misassembly rate of a given contig set (we used &gt;0.8 in our experiments). The estimated misassembly rate could then be used to optimize metagenome assembler parameters (e.g., k-mer lengths) for real metagenomes, which lack ground-truth data. Assembler hyperparameters are generally optimized simply based on total contiguity (e.g., N50) or possibly via CheckM after binning contigs into MAGs. However, such methods do not directly assess contig assembly accuracy. In order to use ResMiCo for this application, model performance must be robust to assembler hyperparameter settings outside of the training distribution.</p>
      <p>We tested ResMiCo’s performance as an oracle for assembler performance by simulating datasets in a similar fashion as <italic toggle="yes">n9k-novel</italic>, but with 6 different k-mer length hyperparameter settings for both MEGAHIT and metaSPAdes (see <xref rid="sec002" ref-type="sec">Methods</xref>). For each of the 6 k-mer length combinations, we generated akin to <italic toggle="yes">n9k-novel</italic> but utilized only 2 community richness (50 and 3000) and 2 sequencing depth (2M and 8M) settings. The rest of the simulation parameters were fixed: genome abundance distribution with <italic toggle="yes">σ</italic> = 1, read lengths of 150 bps, insert size distribution of mean = 270 &amp; sd = 50, and the “HiSeq 2500 error” error profile. The percentage of actual misassembled contigs differed from &lt;1% to 30% depending on the assembler and the chosen k-mer set applied on the same set reads (<xref rid="pcbi.1011001.g005" ref-type="fig">Fig 5</xref>). We then compared the percentage of misassembled contigs with the percentage estimated by ResMiCo for each of the four community richness/sequencing depth combinations (6 k-mer sets per combination).</p>
      <fig position="float" id="pcbi.1011001.g005">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011001.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Misassembly (error) rate produced by MEGAHIT and metaSPAdes assemblers with six different k-mer sets.</title>
          <p>k-mer set names denote the k-mer lengths used for the assembly. (A) ResMiCo-identified error rate (y-axis) correlates with the true error rate. (B) N50 size and the true error rate are orthogonal measures of the metagenome quality.</p>
        </caption>
        <graphic xlink:href="pcbi.1011001.g005" position="float"/>
      </fig>
      <p>ResMiCo was able to accurately rank the assemblies by misassembly rate for all four simulation parameter combinations, achieving a Pearson correlation of 0.9. (<xref rid="pcbi.1011001.g005" ref-type="fig">Fig 5A</xref>). While ResMiCo has a tendency to overestimate the misassembly rate with a selected prediction threshold, and the ratio between predicted and true misassembly rate depends on sample richness and sequencing depth (Fig J in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>), the ranking remained consistent in all considered scenarios. At the same time, for the most well-assembled metagenomes (low richness and high sequencing depth), we observed a correlation of 0.9 between N50 and true error rate (<xref rid="pcbi.1011001.g005" ref-type="fig">Fig 5B</xref>), which suggests that the high contiguity achieved together with high misassembly error rate. However this relationship does not hold for the samples simulated with other parameters, making possible to search for assembler parameters that produce good quality in terms of contiguity and error rate simultaneously. Consequently, we propose that ResMiCo can be used to rank assembler parameters for real-world metagenome data and identify parameters leading to the lowest misassembly rate.</p>
    </sec>
    <sec id="sec019">
      <title>Latent space visualization</title>
      <p>To get an intuition on how ResMiCo internally represents data, we studied the output of the global average pooling layer. At that point, the input data is mapped into a 128-dimensional space. We used UMAP [<xref rid="pcbi.1011001.ref049" ref-type="bibr">49</xref>] with default parameters to project the embeddings into a two-dimensional space. UMAP was fitted on the <italic toggle="yes">n9k-train</italic>, <italic toggle="yes">n9k-novel</italic>, and <italic toggle="yes">CAMI-gut</italic> datasets. We used 10,000 randomly sampled contigs from each of the three datasets.</p>
      <p>The latent space visualization indicates that <italic toggle="yes">n9k-train</italic> has more variability (due to the extensive set of parameters used in the simulations) than <italic toggle="yes">CAMI-gut</italic>, which is concentrated in a small subspace, while misassembled contigs from both datasets are generally clustered together (<xref rid="pcbi.1011001.g006" ref-type="fig">Fig 6A and 6B</xref>). Note that since ResMiCo has two fully connected layers following the visualized global average pooling, the two classes are not expected to be completely separable at this stage. Both community richness and average contig coverage strongly partition the latent space (<xref rid="pcbi.1011001.g006" ref-type="fig">Fig 6C and 6D</xref>).</p>
      <fig position="float" id="pcbi.1011001.g006">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011001.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>Contig embeddings learned by ResMiCo, projected using UMAP.</title>
          <p>The first row shows (A) all contig embeddings and (B) misassembled contig embeddings for the <italic toggle="yes">n9k-train</italic>, the <italic toggle="yes">n9k-novel</italic>, and the <italic toggle="yes">CAMI. gut</italic> datasets. In the second row, contigs from the <italic toggle="yes">n9k-train</italic> dataset are colored (C) by the richness of the simulated community they originated from and (D) by their average coverage.</p>
        </caption>
        <graphic xlink:href="pcbi.1011001.g006" position="float"/>
      </fig>
    </sec>
    <sec id="sec020">
      <title>ResMiCo detects a 3–12% misassembly rate in real-world metagenomes</title>
      <p>We applied ResMiCo to published gut metagenome datasets from multiple studies in order to assess the prevalence of misassembled contigs in publicly available metagenomic data. We utilized three datasets of gut samples: <italic toggle="yes">UHGG</italic>, <italic toggle="yes">TwinsUK</italic>, and <italic toggle="yes">Animal-gut</italic>. <italic toggle="yes">UHGG</italic> consisted of a random subset of gut metagenomes associated with MAGs in the UHGG database, while <italic toggle="yes">TwinsUK</italic> and <italic toggle="yes">Animal-gut</italic> consisted of gut metagenomes from westernized adults and a broad taxonomic diversity of vertebrates, respectively (see <xref rid="sec002" ref-type="sec">Materials and methods</xref>). We also utilized 2 marine meatgenome datasets (<italic toggle="yes">Pinnell2019</italic> and <italic toggle="yes">MarineMetagenomeDB</italic>) and 2 from soil (<italic toggle="yes">Mantri2021</italic> and <italic toggle="yes">TerrestrialMetagenomeDB</italic>).</p>
      <p>ResMiCo detected an average of 3.4%, 6%, and 8.8% misassembled contigs across all metagenome assemblies in the vertebrate-associated datasets: <italic toggle="yes">TwinsUK</italic>, <italic toggle="yes">Animal-gut</italic>, and <italic toggle="yes">UHGG</italic>, respectively. The marine and soil datasets contained more misassemblies (<italic toggle="yes">MarineMetagenomeDB</italic>: 8.3%, <italic toggle="yes">Mantri2021</italic>: 11.5%, <italic toggle="yes">Pinnell2019</italic>: 8.6%, and <italic toggle="yes">TerrestrialMetagenomeDB</italic>: 12.5%). Overall, we evaluated 8,235,502 contigs, of which 6% are misassembled according to ResMiCo’s predictions (≥ 0.8).</p>
      <p>We provide an estimated the misassembly rate for each metagenome in <xref rid="pcbi.1011001.s002" ref-type="supplementary-material">S1 Table</xref>. Averaged across all metagenomes, the misasssembly rate was 7% ± 5.7 (sd). The high variability among samples and datasets suggests that sample-specific factors (e.g., community taxonomic complexity or variability among NGS library preparations) can substantially influence misassembly rates. Note that we did not apply ResMiCo on the minority of metagenomes that failed to meet our inclusion criteria (see the <xref rid="sec002" ref-type="sec">Materials and methods</xref>).</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec021">
    <title>Discussion</title>
    <p>We addressed the problem of reference-free metagenome quality evaluation by developing ResMiCo, a deep residual neural network that enables accurate misassembled contig identification. ResMiCo provides an efficient data generation pipeline (see Text G in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>), which transforms raw reads and contigs into positional features that are utilized by a residual neural network to predict if a given contig was misassembled. The ResMiCo model was trained and tested on datasets of unprecedented size and complexity (<italic toggle="yes">n9k-train</italic> and <italic toggle="yes">n9k-novel</italic> contain 210 Gbps of assembled contigs), which we have made freely available as a resource for further model development and benchmarking (see <xref rid="sec002" ref-type="sec">Materials and methods</xref>). These datasets can be expanded, or new datasets can be generated with ResMiCo’s dataset simulation pipeline, which allows for straightforward, efficient data generation on high-performance computing systems.</p>
    <p>ResMiCo achieved a 0.76 AUPRC score on the taxonomically novel holdout test set (<italic toggle="yes">n9k-novel</italic>), which is an exceptional improvement over the state of the art (<xref rid="pcbi.1011001.g004" ref-type="fig">Fig 4A</xref>). The robustness of ResMiCo to family-level taxonomic novelty clearly demonstrates that it can be applied to metagenomes that include substantial taxonomic novelty, such as gut microbiomes from poorly studied animal species [<xref rid="pcbi.1011001.ref028" ref-type="bibr">28</xref>].</p>
    <p>When tested on the 3 human and 2 non-human CAMI datasets, ResMiCo showed similarly high performance and again substantially outperformed the state of the art (see <xref rid="sec015" ref-type="sec">Results</xref> and <xref rid="pcbi.1011001.g004" ref-type="fig">Fig 4B, 4C and 4D</xref>). These results show that ResMiCo can generalize to third-party, biome-specific datasets, despite our use of a biome-agnostic training dataset consisting of genomes randomly selected from the entire GTDB.</p>
    <p>ResMiCo is primarily designed to increase the quality of existing assemblies, and we demonstrated that filtering out contigs with high scores from the holdout test set resulted in a fourfold decrease in the true error rate without a substantial decline in contiguity (<xref rid="pcbi.1011001.t003" ref-type="table">Table 3</xref>).</p>
    <p>When applied to the real-world metagenome datasets, ResMiCo detected 7% ± 5.7 (sd) misassembled contigs per metagenome. This estimate is substantially higher than the 1% misassembly rate previously estimated via DeepMAsED [<xref rid="pcbi.1011001.ref018" ref-type="bibr">18</xref>], which may be due to differences in model accuracy and the increased number and variety of real-world metagenomes used for our estimation.</p>
    <p>We also show that ResMiCo can be applied to select assembler parameters corresponding to the best assembly accuracy for a given unlabeled dataset (<xref rid="pcbi.1011001.g005" ref-type="fig">Fig 5</xref>). Researchers can thus optimize assembler parameters for obtaining high accuracy on their specific real-world metagenomes without relying on benchmarks from simulated datasets [<xref rid="pcbi.1011001.ref024" ref-type="bibr">24</xref>].</p>
    <p>ResMiCo’s vastly improved performance relative to other reference-free misassembly detection methods is likely due to three main factors. First, ResMiCo was trained on a very large and varied dataset. Even after re-implementing the <italic toggle="yes">samtools pileup</italic> algorithm to gain a 10x speed improvement, generating the <italic toggle="yes">n9k-train</italic> dataset required nearly 40,000 CPU hours to produce all 4,560 simulation parameter combinations (<xref rid="pcbi.1011001.t001" ref-type="table">Table 1</xref>). For model training, we used 52.5M contigs that total 159 Gbps. In contrast, the DeepMAsED training dataset is 100x smaller, while no such training dataset information is available for metaMIC [<xref rid="pcbi.1011001.ref044" ref-type="bibr">44</xref>]. The UMAP projections of the contig embeddings for the <italic toggle="yes">n9k-train</italic>, the <italic toggle="yes">n9k-novel</italic>, and the <italic toggle="yes">CAMI-gut</italic> datasets (<xref rid="pcbi.1011001.g006" ref-type="fig">Fig 6A</xref>) show that ResMiCo’s training data comprises a substantial portion of the input space. Second, ResMiCo was trained on a larger number of carefully selected features; although ResMiCo uses only the top 14 features in <xref rid="pcbi.1011001.g003" ref-type="fig">Fig 3</xref>, we generated and tested a total of 23 features (Table A in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>) before selecting the 14 best performing ones. In comparison, DeepMAsED used 8 features for training, while metaMIC used 4 types of features, and as we have shown, both models failed to identify the features most relevant to misassembly detection. Third, introducing residual blocks, combined with the larger dataset, allowed us to train a deeper convolutional model, which has been shown to have better performance relative to traditional, shallower CNNs [<xref rid="pcbi.1011001.ref020" ref-type="bibr">20</xref>]. Long range (up to 20,000 bp) signal from raw positional features is transformed by the residual blocks, such that ResMiCo is able to internally detect a breakpoint (Fig B in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>) and identify misassembled contigs based on the strength of this signal.</p>
    <p>While our extensive evaluations showed that ResMiCo is robust to many sources of dataset novelty, we did find that the model is sensitive to the mean insert size distribution (Table E in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>). Therefore, prior to evaluation, we removed all metagenomes falling substantially outside of the <italic toggle="yes">n9k-train</italic> insert size distribution. While filtering by insert size may lead to a biased selection of real-world metagenomes, Illumina sequencing libraries often vary substantially in fragment length and subsequently insert size distribution, even within the same sequencing run. Such variation can result from inaccuracies in DNA quantification and reagent aliquoting. ResMiCo automatically detects if the insert size distributions of the evaluated data differ substantially from those during training and warns users that results may be less accurate. If needed, researchers can simulate more training data that includes the desired insert size range with the ResMiCo simulation pipeline.</p>
    <p>Improving performance robustness across changing distributions, sometimes termed out-of-distribution (o.o.d.) generalization [<xref rid="pcbi.1011001.ref050" ref-type="bibr">50</xref>–<xref rid="pcbi.1011001.ref052" ref-type="bibr">52</xref>], could be an interesting direction for follow-up work. While deep learning has produced impressive results in a range of domains, its reliance on independent and identically distributed (i.i.d.) training data can be a problem [<xref rid="pcbi.1011001.ref053" ref-type="bibr">53</xref>–<xref rid="pcbi.1011001.ref055" ref-type="bibr">55</xref>]. Although a range of attempts exist to improve o.o.d. generalization, empirical risk minimization still is the method of choice in practice [<xref rid="pcbi.1011001.ref056" ref-type="bibr">56</xref>, <xref rid="pcbi.1011001.ref057" ref-type="bibr">57</xref>], especially when used with a dataset of maximal diversity, as done in our study.</p>
    <p>Besides improving o.o.d., there are some other areas for further improvement. First, more research is needed to evaluate the quality of contigs assembled from error-prone long reads (e.g., Oxford Nanopore). Second, it is worth investigating if ResMiCo can be adapted to indicate the location of breakpoints in misassembled contigs. Third, rather than using binary labels, ResMiCo could be trained on misassembly type (e.g., inversion or translocation) to provide more detailed predictions. Fourth, while we did train on a very broad selection of genomes from across the bacterial and archaeal tree of life, future training and evaluation could be expanded to include eukaryotes and viruses.</p>
    <p>In summary, ResMiCo is a major advancement in the challenge of reference-free metagenome quality assessment. Existing methods addressing this problem have not been widely used, likely due to concerns regarding whether such approaches can generalize to real-world datasets. Our extensive testing shows that ResMiCo generalizes well across a large parameter space that includes taxonomy, community abundances, and many sequencing parameters. Wide adoption of ResMiCo could substantially improve metagenome assembly quality for individual studies and databases, which is critical for obtaining accurate biological insights from metagenomic data.</p>
  </sec>
  <sec id="sec022" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1011001.s001" position="float" content-type="local-data">
      <label>S1 Text</label>
      <caption>
        <p>Fig A. Breakpoint locations for misassemblies identified by MetaQUAST (treated as ground-truth in this work). Fig B. Feature maps for four <italic toggle="yes">n9k-novel</italic> misassembled contigs. Fig C. Feature maps from the last layer before global pooling for four <italic toggle="yes">n9k-novel</italic> correctly assembled contigs. Fig D. The contig length distribution and ResMiCo performance on contigs of different lengths. Fig E. AUPRC that ResMiCo achieves on 240 subsets (differing simulation parameters) of the <italic toggle="yes">n9k-novel</italic>. Fig F. Distribution of errors found by MetaQUAST in the <italic toggle="yes">n9k-novel</italic> test dataset. Fig G. ResMiCo scores for misassembled contigs grouped by assembly error type. Fig H. ResMiCo performance measured by AUPRC on contigs from the datasets with various simulation parameters (<italic toggle="yes">n9k-novel</italic>). Fig I. ResMiCo performance measured by AUROC on contigs from the datasets with various simulation parameters (<italic toggle="yes">n9k-novel</italic>). Fig J. Number of misassemblies found by ResMiCo divided by the true number of misassemblies in the datasets with various simulation parameters (<italic toggle="yes">n9k-novel</italic>). Fig K. Genome fraction measured on (A) CAMI gut and (B) CAMI marine datasets before and after filtering misassembled according to ResMiCo contigs. Fig L. Features ranked by their importance. Table A. The full list of positional features computed by ResMiCo pipeline. Table B. Hyperparameters tested for ResMiCo architecture. Table C. Effect of down sampling reads on the ResMiCo predictions. Table D. Contig length cut-off effect on the ResMiCo predictions. Table E. ResMiCo performance on test data varying by the <italic toggle="yes">mean</italic> of the insert size distribution. Table F. ResMiCo performance on the test sets with variable <italic toggle="yes">stdev</italic> of the insert size distribution. Table G. The insert size distribution statistics across synthetic and real-world datasets used in this work. Table H. ResMiCo performance on two mock real-world datasets. Text A: ResMiCo’s embeddings highlight breakpoint locations. Text B: ResMiCo performance by assembly error type. Text C: NN achitecture selection. Text D: Effect of the length cut-off and the read down-sampling on ResMiCo predictions. Text E: ResMiCo sensitivity to changes in insert size distribution. Text F: Clustering of misassemblies. Text G: Optimizing data generation performance.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1011001.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011001.s002" position="float" content-type="local-data">
      <label>S1 Table</label>
      <caption>
        <title>ResMiCo estimates the prevalence of misassembled contigs in publicly available metagenomic data.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011001.s002.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011001.s003" position="float" content-type="local-data">
      <label>S2 Table</label>
      <caption>
        <title>Characteristics of clusters of misassembled contigs from the <italic toggle="yes">n9k-novel</italic> dataset.</title>
        <p>See more details about clustering in Text F in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011001.s003.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1011001.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Gaio</surname><given-names>D</given-names></name>, <name><surname>Anantanawat</surname><given-names>K</given-names></name>, <name><surname>To</surname><given-names>J</given-names></name>, <name><surname>Liu</surname><given-names>M</given-names></name>, <name><surname>Monahan</surname><given-names>L</given-names></name>, <name><surname>Darling</surname><given-names>AE</given-names></name>. <article-title>Hackflex: low cost Illumina Nextera Flex sequencing library construction</article-title>. <source>bioRxiv</source>. <year>2021</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Hennig</surname><given-names>BP</given-names></name>, <name><surname>Velten</surname><given-names>L</given-names></name>, <name><surname>Racke</surname><given-names>I</given-names></name>, <name><surname>Tu</surname><given-names>CS</given-names></name>, <name><surname>Thoms</surname><given-names>M</given-names></name>, <name><surname>Rybin</surname><given-names>V</given-names></name>, <etal>et al</etal>. <article-title>Large-Scale Low-Cost NGS Library Preparation Using a Robust Tn5 Purification and Tagmentation Protocol</article-title>. <source>G3 Genes—Genomes—Genetics</source>. <year>2018</year>;<volume>8</volume>(<issue>1</issue>):<fpage>79</fpage>–<lpage>89</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1534/g3.117.300257</pub-id><?supplied-pmid 29118030?><pub-id pub-id-type="pmid">29118030</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Nurk</surname><given-names>S</given-names></name>, <name><surname>Meleshko</surname><given-names>D</given-names></name>, <name><surname>Korobeynikov</surname><given-names>A</given-names></name>, <name><surname>Pevzner</surname><given-names>PA</given-names></name>. <article-title>metaSPAdes: a new versatile metagenomic assembler</article-title>. <source>Genome research</source>. <year>2017</year>;<volume>27</volume>(<issue>5</issue>):<fpage>824</fpage>–<lpage>834</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1101/gr.213959.116</pub-id><?supplied-pmid 28298430?><pub-id pub-id-type="pmid">28298430</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>D</given-names></name>, <name><surname>Liu</surname><given-names>CM</given-names></name>, <name><surname>Luo</surname><given-names>R</given-names></name>, <name><surname>Sadakane</surname><given-names>K</given-names></name>, <name><surname>Lam</surname><given-names>TW</given-names></name>. <article-title>MEGAHIT: an ultra-fast single-node solution for large and complex metagenomics assembly via succinct de Bruijn graph</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>(<issue>10</issue>):<fpage>1674</fpage>–<lpage>1676</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btv033</pub-id><?supplied-pmid 25609793?><pub-id pub-id-type="pmid">25609793</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Nayfach</surname><given-names>S</given-names></name>, <name><surname>Shi</surname><given-names>ZJ</given-names></name>, <name><surname>Seshadri</surname><given-names>R</given-names></name>, <name><surname>Pollard</surname><given-names>KS</given-names></name>, <name><surname>Kyrpides</surname><given-names>NC</given-names></name>. <article-title>New insights from uncultivated genomes of the global human gut microbiome</article-title>. <source>Nature</source>. <year>2019</year>;<volume>568</volume>(<issue>7753</issue>):<fpage>505</fpage>–<lpage>510</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41586-019-1058-x</pub-id><?supplied-pmid 30867587?><pub-id pub-id-type="pmid">30867587</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Almeida</surname><given-names>A</given-names></name>, <name><surname>Mitchell</surname><given-names>AL</given-names></name>, <name><surname>Boland</surname><given-names>M</given-names></name>, <name><surname>Forster</surname><given-names>SC</given-names></name>, <name><surname>Gloor</surname><given-names>GB</given-names></name>, <name><surname>Tarkowska</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>A new genomic blueprint of the human gut microbiota</article-title>. <source>Nature</source>. <year>2019</year>;<volume>568</volume>(<issue>7753</issue>):<fpage>499</fpage>–<lpage>504</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41586-019-0965-1</pub-id><?supplied-pmid 30745586?><pub-id pub-id-type="pmid">30745586</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Pasolli</surname><given-names>E</given-names></name>, <name><surname>Asnicar</surname><given-names>F</given-names></name>, <name><surname>Manara</surname><given-names>S</given-names></name>, <name><surname>Zolfo</surname><given-names>M</given-names></name>, <name><surname>Karcher</surname><given-names>N</given-names></name>, <name><surname>Armanini</surname><given-names>F</given-names></name>, <etal>et al</etal>. <article-title>Extensive unexplored human microbiome diversity revealed by over 150,000 genomes from metagenomes spanning age, geography, and lifestyle</article-title>. <source>Cell</source>. <year>2019</year>;<volume>176</volume>(<issue>3</issue>):<fpage>649</fpage>–<lpage>662</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2019.01.001</pub-id><?supplied-pmid 30661755?><pub-id pub-id-type="pmid">30661755</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Qin</surname><given-names>J</given-names></name>, <name><surname>Li</surname><given-names>R</given-names></name>, <name><surname>Raes</surname><given-names>J</given-names></name>, <name><surname>Arumugam</surname><given-names>M</given-names></name>, <name><surname>Burgdorf</surname><given-names>KS</given-names></name>, <name><surname>Manichanh</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>A human gut microbial gene catalogue established by metagenomic sequencing</article-title>. <source>nature</source>. <year>2010</year>;<volume>464</volume>(<issue>7285</issue>):<fpage>59</fpage>–<lpage>65</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature08821</pub-id><?supplied-pmid 20203603?><pub-id pub-id-type="pmid">20203603</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Xiao</surname><given-names>L</given-names></name>, <name><surname>Feng</surname><given-names>Q</given-names></name>, <name><surname>Liang</surname><given-names>S</given-names></name>, <name><surname>Sonne</surname><given-names>SB</given-names></name>, <name><surname>Xia</surname><given-names>Z</given-names></name>, <name><surname>Qiu</surname><given-names>X</given-names></name>, <etal>et al</etal>. <article-title>A catalog of the mouse gut metagenome</article-title>. <source>Nature biotechnology</source>. <year>2015</year>;<volume>33</volume>(<issue>10</issue>):<fpage>1103</fpage>–<lpage>1108</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nbt.3353</pub-id><?supplied-pmid 26414350?><pub-id pub-id-type="pmid">26414350</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Breitwieser</surname><given-names>FP</given-names></name>, <name><surname>Lu</surname><given-names>J</given-names></name>, <name><surname>Salzberg</surname><given-names>SL</given-names></name>. <article-title>A review of methods and databases for metagenomic classification and assembly</article-title>. <source>Briefings in bioinformatics</source>. <year>2019</year>;<volume>20</volume>(<issue>4</issue>):<fpage>1125</fpage>–<lpage>1136</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bib/bbx120</pub-id><?supplied-pmid 29028872?><pub-id pub-id-type="pmid">29028872</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Almeida</surname><given-names>A</given-names></name>, <name><surname>Nayfach</surname><given-names>S</given-names></name>, <name><surname>Boland</surname><given-names>M</given-names></name>, <name><surname>Strozzi</surname><given-names>F</given-names></name>, <name><surname>Beracochea</surname><given-names>M</given-names></name>, <name><surname>Shi</surname><given-names>ZJ</given-names></name>, <etal>et al</etal>. <article-title>A unified catalog of 204,938 reference genomes from the human gut microbiome</article-title>. <source>Nature biotechnology</source>. <year>2021</year>;<volume>39</volume>(<issue>1</issue>):<fpage>105</fpage>–<lpage>114</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41587-020-0603-3</pub-id><?supplied-pmid 32690973?><pub-id pub-id-type="pmid">32690973</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Parks</surname><given-names>DH</given-names></name>, <name><surname>Chuvochina</surname><given-names>M</given-names></name>, <name><surname>Waite</surname><given-names>DW</given-names></name>, <name><surname>Rinke</surname><given-names>C</given-names></name>, <name><surname>Skarshewski</surname><given-names>A</given-names></name>, <name><surname>Chaumeil</surname><given-names>PA</given-names></name>, <etal>et al</etal>. <article-title>A standardized bacterial taxonomy based on genome phylogeny substantially revises the tree of life</article-title>. <source>Nature biotechnology</source>. <year>2018</year>;<volume>36</volume>(<issue>10</issue>):<fpage>996</fpage>–<lpage>1004</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nbt.4229</pub-id><?supplied-pmid 30148503?><pub-id pub-id-type="pmid">30148503</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Youngblut</surname><given-names>ND</given-names></name>, <name><surname>Ley</surname><given-names>RE</given-names></name>. <article-title>Struo2: efficient metagenome profiling database construction for ever-expanding microbial genome datasets</article-title>. <source>PeerJ</source>. <year>2021</year>;<volume>9</volume>:<fpage>e12198</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.7717/peerj.12198</pub-id><?supplied-pmid 34616633?><pub-id pub-id-type="pmid">34616633</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Lapidus</surname><given-names>AL</given-names></name>, <name><surname>Korobeynikov</surname><given-names>AI</given-names></name>. <article-title>Metagenomic data assembly–the way of decoding unknown microorganisms</article-title>. <source>Frontiers in Microbiology</source>. <year>2021</year>;<volume>12</volume>:<fpage>653</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3389/fmicb.2021.613791</pub-id><?supplied-pmid 33833738?><pub-id pub-id-type="pmid">33833738</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Mikheenko</surname><given-names>A</given-names></name>, <name><surname>Saveliev</surname><given-names>V</given-names></name>, <name><surname>Gurevich</surname><given-names>A</given-names></name>. <article-title>MetaQUAST: evaluation of metagenome assemblies</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>(<issue>7</issue>):<fpage>1088</fpage>–<lpage>1090</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btv697</pub-id><?supplied-pmid 26614127?><pub-id pub-id-type="pmid">26614127</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Koren</surname><given-names>S</given-names></name>, <name><surname>Phillippy</surname><given-names>AM</given-names></name>. <article-title>One chromosome, one contig: complete microbial genomes from long-read sequencing and assembly</article-title>. <source>Current opinion in microbiology</source>. <year>2015</year>;<volume>23</volume>:<fpage>110</fpage>–<lpage>120</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.mib.2014.11.014</pub-id><?supplied-pmid 25461581?><pub-id pub-id-type="pmid">25461581</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Ayling</surname><given-names>M</given-names></name>, <name><surname>Clark</surname><given-names>MD</given-names></name>, <name><surname>Leggett</surname><given-names>RM</given-names></name>. <article-title>New approaches for metagenome assembly with short reads</article-title>. <source>Briefings in bioinformatics</source>. <year>2020</year>;<volume>21</volume>(<issue>2</issue>):<fpage>584</fpage>–<lpage>594</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bib/bbz020</pub-id><?supplied-pmid 30815668?><pub-id pub-id-type="pmid">30815668</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Mineeva</surname><given-names>O</given-names></name>, <name><surname>Rojas-Carulla</surname><given-names>M</given-names></name>, <name><surname>Ley</surname><given-names>RE</given-names></name>, <name><surname>Schölkopf</surname><given-names>B</given-names></name>, <name><surname>Youngblut</surname><given-names>ND</given-names></name>. <article-title>DeepMAsED: evaluating the quality of metagenomic assemblies</article-title>. <source>Bioinformatics</source>. <year>2020</year>;<volume>36</volume>(<issue>10</issue>):<fpage>3011</fpage>–<lpage>3017</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btaa124</pub-id><?supplied-pmid 32096824?><pub-id pub-id-type="pmid">32096824</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Lai</surname><given-names>S</given-names></name>, <name><surname>Pan</surname><given-names>S</given-names></name>, <name><surname>Coelho</surname><given-names>LP</given-names></name>, <name><surname>Chen</surname><given-names>WH</given-names></name>, <name><surname>Zhao</surname><given-names>XM</given-names></name>. <article-title>metaMIC: reference-free Misassembly Identification and Correction of de novo metagenomic assemblies</article-title>. <source>bioRxiv</source>. <year>2021</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref020">
      <label>20</label>
      <mixed-citation publication-type="other">He K, Zhang X, Ren S, Sun J. Deep residual learning for image recognition. In: Proceedings of the IEEE conference on computer vision and pattern recognition; 2016. p. 770–778.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Jaganathan</surname><given-names>K</given-names></name>, <name><surname>Kyriazopoulou Panagiotopoulou</surname><given-names>S</given-names></name>, <name><surname>McRae</surname><given-names>JF</given-names></name>, <name><surname>Darbandi</surname><given-names>SF</given-names></name>, <name><surname>Knowles</surname><given-names>D</given-names></name>, <name><surname>Li</surname><given-names>YI</given-names></name>, <etal>et al</etal>. <article-title>Predicting Splicing from Primary Sequence with Deep Learning</article-title>. <source>Cell</source>. <year>2019</year>;<volume>176</volume>(<issue>3</issue>):<fpage>535</fpage>–<lpage>548.e24</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2018.12.015</pub-id><?supplied-pmid 30661751?><pub-id pub-id-type="pmid">30661751</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Parks</surname><given-names>DH</given-names></name>, <name><surname>Chuvochina</surname><given-names>M</given-names></name>, <name><surname>Waite</surname><given-names>DW</given-names></name>, <name><surname>Rinke</surname><given-names>C</given-names></name>, <name><surname>Skarshewski</surname><given-names>A</given-names></name>, <name><surname>Chaumeil</surname><given-names>PA</given-names></name>, <etal>et al</etal>. <article-title>A standardized bacterial taxonomy based on genome phylogeny substantially revises the tree of life</article-title>. <source>Nat Biotechnol</source>. <year>2018</year>;<volume>36</volume>(<issue>10</issue>):<fpage>996</fpage>–<lpage>1004</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nbt.4229</pub-id><?supplied-pmid 30148503?><pub-id pub-id-type="pmid">30148503</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Huang</surname><given-names>W</given-names></name>, <name><surname>Li</surname><given-names>L</given-names></name>, <name><surname>Myers</surname><given-names>JR</given-names></name>, <name><surname>Marth</surname><given-names>GT</given-names></name>. <article-title>ART: a next-generation sequencing read simulator</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>(<issue>4</issue>):<fpage>593</fpage>–<lpage>594</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btr708</pub-id><?supplied-pmid 22199392?><pub-id pub-id-type="pmid">22199392</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Fritz</surname><given-names>A</given-names></name>, <name><surname>Hofmann</surname><given-names>P</given-names></name>, <name><surname>Majda</surname><given-names>S</given-names></name>, <name><surname>Dahms</surname><given-names>E</given-names></name>, <name><surname>Dröge</surname><given-names>J</given-names></name>, <name><surname>Fiedler</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>CAMISIM: simulating metagenomes and microbial communities</article-title>. <source>Microbiome</source>. <year>2019</year>;<volume>7</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>12</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s40168-019-0633-6</pub-id><?supplied-pmid 30736849?><pub-id pub-id-type="pmid">30606251</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Langmead</surname><given-names>B</given-names></name>, <name><surname>Salzberg</surname><given-names>SL</given-names></name>. <article-title>Fast gapped-read alignment with Bowtie 2</article-title>. <source>Nat Methods</source>. <year>2012</year>;<volume>9</volume>(<issue>4</issue>):<fpage>357</fpage>–<lpage>359</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id><?supplied-pmid 22388286?><pub-id pub-id-type="pmid">22388286</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Sczyrba</surname><given-names>A</given-names></name>, <name><surname>Hofmann</surname><given-names>P</given-names></name>, <name><surname>Belmann</surname><given-names>P</given-names></name>, <name><surname>Koslicki</surname><given-names>D</given-names></name>, <name><surname>Janssen</surname><given-names>S</given-names></name>, <name><surname>Dröge</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Critical assessment of metagenome interpretation—a benchmark of metagenomics software</article-title>. <source>Nature methods</source>. <year>2017</year>;<volume>14</volume>(<issue>11</issue>):<fpage>1063</fpage>–<lpage>1071</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nmeth.4458</pub-id><?supplied-pmid 28967888?><pub-id pub-id-type="pmid">28967888</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>de la Cuesta-Zuluaga</surname><given-names>J</given-names></name>, <name><surname>Spector</surname><given-names>TD</given-names></name>, <name><surname>Youngblut</surname><given-names>ND</given-names></name>, <name><surname>Ley</surname><given-names>RE</given-names></name>, <name><surname>Bordenstein</surname><given-names>S</given-names></name>. <article-title>Genomic Insights into Adaptations of Trimethylamine-Utilizing Methanogens to Diverse Habitats, Including the Human Gut</article-title>. <source>mSystems</source>. <year>2021</year>;<volume>6</volume>(<issue>1</issue>):<fpage>e00939</fpage>–<lpage>20</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1128/mSystems.00939-20</pub-id><?supplied-pmid 33563787?><pub-id pub-id-type="pmid">33563787</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Youngblut</surname><given-names>ND</given-names></name>, <name><surname>De la Cuesta-Zuluaga</surname><given-names>J</given-names></name>, <name><surname>Reischer</surname><given-names>GH</given-names></name>, <name><surname>Dauser</surname><given-names>S</given-names></name>, <name><surname>Schuster</surname><given-names>N</given-names></name>, <name><surname>Walzer</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Large-scale metagenome assembly reveals novel animal-associated microbial genomes, biosynthetic gene clusters, and other genetic diversity</article-title>. <source>Msystems</source>. <year>2020</year>;<volume>5</volume>(<issue>6</issue>):<fpage>e01045</fpage>–<lpage>20</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1128/mSystems.01045-20</pub-id><?supplied-pmid 33144315?><pub-id pub-id-type="pmid">33144315</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Pinnell</surname><given-names>LJ</given-names></name>, <name><surname>Turner</surname><given-names>JW</given-names></name>. <article-title>Shotgun Metagenomics Reveals the Benthic Microbial Community Response to Plastic and Bioplastic in a Coastal Marine Environment</article-title>. <source>Frontiers in Microbiology</source>. <year>2019</year>;<volume>10</volume>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3389/fmicb.2019.01252</pub-id><?supplied-pmid 31231339?><pub-id pub-id-type="pmid">31231339</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Mantri</surname><given-names>SS</given-names></name>, <name><surname>Negri</surname><given-names>T</given-names></name>, <name><surname>Sales-Ortells</surname><given-names>H</given-names></name>, <name><surname>Angelov</surname><given-names>A</given-names></name>, <name><surname>Peter</surname><given-names>S</given-names></name>, <name><surname>Neidhardt</surname><given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Metagenomic Sequencing of Multiple Soil Horizons and Sites in Close Vicinity Revealed Novel Secondary Metabolite Diversity</article-title>. <source>mSystems</source>. <year>2021</year>;<volume>6</volume>(<issue>5</issue>):<fpage>e01018</fpage>–<lpage>21</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1128/mSystems.01018-21</pub-id><?supplied-pmid 34636675?><pub-id pub-id-type="pmid">34636675</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Nata’ala</surname><given-names>MK</given-names></name>, <name><surname>Avila Santos</surname><given-names>AP</given-names></name>, <name><surname>Coelho Kasmanas</surname><given-names>J</given-names></name>, <name><surname>Bartholomäus</surname><given-names>A</given-names></name>, <name><surname>Saraiva</surname><given-names>JP</given-names></name>, <name><surname>Godinho Silva</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>MarineMetagenomeDB: a public repository for curated and standardized metadata for marine metagenomes</article-title>. <source>Environ Microbiome</source>. <year>2022</year>;<volume>17</volume>(<issue>1</issue>):<fpage>57</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s40793-022-00449-7</pub-id><?supplied-pmid 36401317?><pub-id pub-id-type="pmid">36401317</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Corrêa</surname><given-names>FB</given-names></name>, <name><surname>Saraiva</surname><given-names>JP</given-names></name>, <name><surname>Stadler</surname><given-names>PF</given-names></name>, <name><surname>da Rocha</surname><given-names>UN</given-names></name>. <article-title>TerrestrialMetagenomeDB: a public repository of curated and standardized metadata for terrestrial metagenomes</article-title>. <source>Nucleic Acids Research</source>. <year>2019</year>;<volume>48</volume>(<issue>D1</issue>):<fpage>D626</fpage>–<lpage>D632</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Sevim</surname><given-names>V</given-names></name>, <name><surname>Lee</surname><given-names>J</given-names></name>, <name><surname>Egan</surname><given-names>R</given-names></name>, <name><surname>Clum</surname><given-names>A</given-names></name>, <name><surname>Hundley</surname><given-names>H</given-names></name>, <name><surname>Lee</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Shotgun metagenome data of a defined mock community using Oxford Nanopore, PacBio and Illumina technologies</article-title>. <source>Sci Data</source>. <year>2019</year>;<volume>6</volume>(<issue>1</issue>):<fpage>285</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41597-019-0287-z</pub-id><?supplied-pmid 31772173?><pub-id pub-id-type="pmid">31772173</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Singer</surname><given-names>E</given-names></name>, <name><surname>Andreopoulos</surname><given-names>B</given-names></name>, <name><surname>Bowers</surname><given-names>RM</given-names></name>, <name><surname>Lee</surname><given-names>J</given-names></name>, <name><surname>Deshpande</surname><given-names>S</given-names></name>, <name><surname>Chiniquy</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Next generation sequencing data of a defined microbial mock community</article-title>. <source>Sci Data</source>. <year>2016</year>;<volume>3</volume>:<fpage>160081</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/sdata.2016.81</pub-id><?supplied-pmid 27673566?><pub-id pub-id-type="pmid">27673566</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Jo</surname><given-names>J</given-names></name>, <name><surname>Oh</surname><given-names>J</given-names></name>, <name><surname>Park</surname><given-names>C</given-names></name>. <article-title>Microbial community analysis using high-throughput sequencing technology: a beginner’s guide for microbiologists</article-title>. <source>J Microbiol</source>. <year>2020</year>;<volume>58</volume>(<issue>3</issue>):<fpage>176</fpage>–<lpage>192</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s12275-020-9525-5</pub-id><?supplied-pmid 32108314?><pub-id pub-id-type="pmid">32108314</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Hillmann</surname><given-names>B</given-names></name>, <name><surname>Al-Ghalith</surname><given-names>GA</given-names></name>, <name><surname>Shields-Cutler</surname><given-names>RR</given-names></name>, <name><surname>Zhu</surname><given-names>Q</given-names></name>, <name><surname>Gohl</surname><given-names>DM</given-names></name>, <name><surname>Beckman</surname><given-names>KB</given-names></name>, <etal>et al</etal>. <article-title>Evaluating the Information Content of Shallow Shotgun Metagenomics</article-title>. <source>mSystems</source>. <year>2018</year>;<volume>3</volume>(<issue>6</issue>). <comment>doi: </comment><pub-id pub-id-type="doi">10.1128/mSystems.00069-18</pub-id><?supplied-pmid 30443602?><pub-id pub-id-type="pmid">30443602</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Droop</surname><given-names>AP</given-names></name>. <article-title>fqtools: an efficient software suite for modern FASTQ file manipulation</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>(<issue>12</issue>):<fpage>1883</fpage>–<lpage>1884</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btw088</pub-id><?supplied-pmid 27153699?><pub-id pub-id-type="pmid">27153699</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Jiang</surname><given-names>H</given-names></name>, <name><surname>Lei</surname><given-names>R</given-names></name>, <name><surname>Ding</surname><given-names>SW</given-names></name>, <name><surname>Zhu</surname><given-names>S</given-names></name>. <article-title>Skewer: a fast and accurate adapter trimmer for next-generation sequencing paired-end reads</article-title>. <source>BMC Bioinformatics</source>. <year>2014</year>;<volume>15</volume>:<fpage>182</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-2105-15-182</pub-id><?supplied-pmid 24925680?><pub-id pub-id-type="pmid">24925680</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Ewels</surname><given-names>P</given-names></name>, <name><surname>Magnusson</surname><given-names>M</given-names></name>, <name><surname>Lundin</surname><given-names>S</given-names></name>, <name><surname>Käller</surname><given-names>M</given-names></name>. <article-title>MultiQC: summarize analysis results for multiple tools and samples in a single report</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>(<issue>19</issue>):<fpage>3047</fpage>–<lpage>3048</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btw354</pub-id><?supplied-pmid 27312411?><pub-id pub-id-type="pmid">27312411</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Ioffe</surname><given-names>S</given-names></name>, <name><surname>Szegedy</surname><given-names>C</given-names></name>. <source>Batch Normalization: Accelerating Deep Network Training by Reducing Internal Covariate Shift</source>. <year>2015</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Kingma</surname><given-names>DP</given-names></name>, <name><surname>Ba</surname><given-names>J</given-names></name>. <source>Adam: A Method for Stochastic Optimization</source>. <year>2014</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref042">
      <label>42</label>
      <mixed-citation publication-type="book"><name><surname>Lundberg</surname><given-names>SM</given-names></name>, <name><surname>Lee</surname><given-names>SI</given-names></name>. <part-title>A Unified Approach to Interpreting Model Predictions</part-title>. In: <name><surname>Guyon</surname><given-names>I</given-names></name>, <name><surname>Luxburg</surname><given-names>UV</given-names></name>, <name><surname>Bengio</surname><given-names>S</given-names></name>, <name><surname>Wallach</surname><given-names>H</given-names></name>, <name><surname>Fergus</surname><given-names>R</given-names></name>, <name><surname>Vishwanathan</surname><given-names>S</given-names></name>, <etal>et al</etal>., editors. <source>Advances in Neural Information Processing Systems</source>. vol. <volume>30</volume>. <publisher-name>Curran Associates, Inc</publisher-name>.; <year>2017</year>. Available from: <ext-link xlink:href="https://proceedings.neurips.cc/paper/2017/file/8a20a8621978632d76c43dfd28b67767-Paper.pdf" ext-link-type="uri">https://proceedings.neurips.cc/paper/2017/file/8a20a8621978632d76c43dfd28b67767-Paper.pdf</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Shrikumar</surname><given-names>A</given-names></name>, <name><surname>Greenside</surname><given-names>P</given-names></name>, <name><surname>Kundaje</surname><given-names>A</given-names></name>. <source>Learning Important Features Through Propagating Activation Differences</source>. <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Lai</surname><given-names>S</given-names></name>, <name><surname>Pan</surname><given-names>S</given-names></name>, <name><surname>Coelho</surname><given-names>LP</given-names></name>, <name><surname>Chen</surname><given-names>WH</given-names></name>, <name><surname>Zhao</surname><given-names>XM</given-names></name>. <source>metaMIC: reference-free Misassembly Identification and Correction of de novo metagenomic assemblies</source>; <year>2021</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Clark</surname><given-names>SC</given-names></name>, <name><surname>Egan</surname><given-names>R</given-names></name>, <name><surname>Frazier</surname><given-names>PI</given-names></name>, <name><surname>Wang</surname><given-names>Z</given-names></name>. <article-title>ALE: a generic assembly likelihood evaluation framework for assessing the accuracy of genome and metagenome assemblies</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>(<issue>4</issue>):<fpage>435</fpage>–<lpage>443</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bts723</pub-id><?supplied-pmid 23303509?><pub-id pub-id-type="pmid">23303509</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Branco</surname><given-names>P</given-names></name>, <name><surname>Torgo</surname><given-names>L</given-names></name>, <name><surname>Ribeiro</surname><given-names>RP</given-names></name>. <article-title>A survey of predictive modeling on imbalanced domains</article-title>. <source>ACM Computing Surveys (CSUR)</source>. <year>2016</year>;<volume>49</volume>(<issue>2</issue>):<fpage>1</fpage>–<lpage>50</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1145/2907070</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Köster</surname><given-names>J</given-names></name>, <name><surname>Rahmann</surname><given-names>S</given-names></name>. <article-title>Snakemake—a scalable bioinformatics workflow engine</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>(<issue>19</issue>):<fpage>2520</fpage>–<lpage>2522</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bts480</pub-id><?supplied-pmid 22908215?><pub-id pub-id-type="pmid">22908215</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Abadi</surname><given-names>M</given-names></name>, <name><surname>Agarwal</surname><given-names>A</given-names></name>, <name><surname>Barham</surname><given-names>P</given-names></name>, <name><surname>Brevdo</surname><given-names>E</given-names></name>, <name><surname>Chen</surname><given-names>Z</given-names></name>, <name><surname>Citro</surname><given-names>C</given-names></name>, <etal>et al</etal>. <source>TensorFlow: Large-Scale Machine Learning on Heterogeneous Systems</source>; <year>2015</year>. Available from: <ext-link xlink:href="https://www.tensorflow.org/" ext-link-type="uri">https://www.tensorflow.org/</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>McInnes</surname><given-names>L</given-names></name>, <name><surname>Healy</surname><given-names>J</given-names></name>, <name><surname>Melville</surname><given-names>J</given-names></name>. <source>UMAP: Uniform Manifold Approximation and Projection for Dimension Reduction</source>. <year>2018</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref050">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Azulay</surname><given-names>A</given-names></name>, <name><surname>Weiss</surname><given-names>Y</given-names></name>. <article-title>Why Do Deep Convolutional Networks Generalize so Poorly to Small Image Transformations?</article-title><source>JMLR</source>. <year>2019</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref051">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Schott</surname><given-names>L</given-names></name>, <name><surname>von Kügelgen</surname><given-names>J</given-names></name>, <name><surname>Träuble</surname><given-names>F</given-names></name>, <name><surname>Gehler</surname><given-names>P</given-names></name>, <name><surname>Russell</surname><given-names>C</given-names></name>, <name><surname>Bethge</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Visual Representation Learning Does Not Generalize Strongly within the Same Domain</article-title>. In: <source>ICLR</source>; <year>2022</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Hendrycks</surname><given-names>D</given-names></name>, <name><surname>Basart</surname><given-names>S</given-names></name>, <name><surname>Mu</surname><given-names>N</given-names></name>, <name><surname>Kadavath</surname><given-names>S</given-names></name>, <name><surname>Wang</surname><given-names>F</given-names></name>, <name><surname>Dorundo</surname><given-names>E</given-names></name>, <etal>et al</etal>. <article-title>The Many Faces of Robustness: A Critical Analysis of Out-of-distribution Generalization</article-title>. In: <source>ICCV</source>; <year>2021</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref053">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Ben-David</surname><given-names>S</given-names></name>, <name><surname>Blitzer</surname><given-names>J</given-names></name>, <name><surname>Crammer</surname><given-names>K</given-names></name>, <name><surname>Pereira</surname><given-names>F</given-names></name>. <article-title>Analysis of representations for domain adaptation</article-title>. In: <source>Advances in neural information processing systems</source>; <year>2007</year>. p. <fpage>137</fpage>–<lpage>144</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref054">
      <label>54</label>
      <mixed-citation publication-type="journal"><name><surname>Schoelkopf</surname><given-names>B</given-names></name>. <article-title>Artificial intelligence: Learning to see and act</article-title>. <source>Nature</source>. <year>2015</year>;<volume>518</volume>(<issue>7540</issue>):<fpage>486</fpage>–<lpage>487</lpage>.<pub-id pub-id-type="pmid">25719660</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref055">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>Beery</surname><given-names>S</given-names></name>, <name><surname>Van Horn</surname><given-names>G</given-names></name>, <name><surname>Perona</surname><given-names>P</given-names></name>. <article-title>Recognition in Terra Incognita</article-title>. In: <source>ECCV</source>; <year>2018</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref056">
      <label>56</label>
      <mixed-citation publication-type="journal"><name><surname>Gulrajani</surname><given-names>I</given-names></name>, <name><surname>Lopez-Paz</surname><given-names>D</given-names></name>. <article-title>In Search of Lost Domain Generalization</article-title>. In: <source>ICLR</source>; <year>2021</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref057">
      <label>57</label>
      <mixed-citation publication-type="journal"><name><surname>Miller</surname><given-names>JP</given-names></name>, <name><surname>Taori</surname><given-names>R</given-names></name>, <name><surname>Raghunathan</surname><given-names>A</given-names></name>, <name><surname>Sagawa</surname><given-names>S</given-names></name>, <name><surname>Koh</surname><given-names>PW</given-names></name>, <name><surname>Shankar</surname><given-names>V</given-names></name>, <etal>et al</etal>. <article-title>Accuracy on the Line: on the Strong Correlation Between Out-of-Distribution and In-Distribution Generalization</article-title>. In: <source>ICML</source>; <year>2021</year>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="aggregated-review-documents" id="pcbi.1011001.r001" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011001.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Noble</surname>
          <given-names>William Stafford</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Coelho</surname>
          <given-names>Luis Pedro</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2023 Noble, Coelho</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Noble, Coelho</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1011001" id="rel-obj001" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">24 Aug 2022</named-content>
    </p>
    <p>Dear Dr. Youngblut,</p>
    <p>Thank you very much for submitting your manuscript "ResMiCo: increasing the quality of metagenome-assembled genomes with deep learning" for consideration at PLOS Computational Biology.</p>
    <p>As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. In light of the reviews (below this email), we would like to invite the resubmission of a significantly-revised version that takes into account the reviewers' comments.</p>
    <p>The reviewers all agree that the methods are an improvement over the state-of-the-art and that the tool could potentially be widely used, but raise several important points related to both unclear presentation and whether some of the conclusions are sufficiently supported. Of particular interest to us are the concerns related to the evaluation on real data: the suggestion of reviewer #3 to test ResMiCo on data with a known standard seems very reasonable; similarly, the comment of reviewer #1 that only human gut samples are used should be addressed (ideally by including additional benchmarks).</p>
    <p>We cannot make any decision about publication until we have seen the revised manuscript and your response to the reviewers' comments. Your revised manuscript is also likely to be sent to reviewers for further evaluation.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Please prepare and submit your revised manuscript within 60 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. Please note that revised manuscripts received after the 60-day due date may require evaluation and peer review similar to newly submitted manuscripts.</p>
    <p>Thank you again for your submission. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Luis Pedro Coelho</p>
    <p>Academic Editor</p>
    <p>PLOS Computational Biology</p>
    <p>William Noble</p>
    <p>Section Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>The reviewers all agree that the methods are an improvement over the state-of-the-art and that the tool could potentially be widely used, but raise several important points related to both unclear presentation and whether some of the conclusions are sufficiently supported. Of particular interest to us are the concerns related to the evaluation on real data: the suggestion of reviewer #3 to test ResMiCo on data with a known standard seems very reasonable; similarly, the comment of reviewer #1 that only human gut samples are used should be addressed (ideally by including additional benchmarks).</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: The review is uploaded as an attachment.</p>
    <p>Reviewer #2: This paper addresses the major challenge of evaluating contigs misassembly from the metagenomic reads without reference requirements. The proposed system, ResMico, utilizes a novel deep convolutional neural network with skip connections between non-adjacent layers. The authors have performed extensive evaluations through simulated datasets representing variously plausible microbial communities and sequencing parameters utilizing reference bacterial and archaeal genomes from the Genome Taxonomy Database. They showed the superior performance (accuracy and robustness) of ResMico compared to the existing methods, including DeepMAsDB, the tool previously developed by the authors’ group. They further showcased ResMiCo’s ability to detect an average of 4.7% error rate of contigs/metagenome in a large collection of gut metagenomes. The paper presents a tool with significant utility in metagenomics research. It is generally well-written; however, some technical aspects could be better explained.</p>
    <p>1) The Residual block structure was used in ResMiCo. However, more detailed descriptions are needed to clarify the rationale for using it, and how the number of RGs was determined. Please also indicate in the Fig.2 caption that 14 represents the number of the selected features in the input to the neural network.</p>
    <p>2) P9: Clarify why MetaSPAdes (but not MEGAHIT) was used for assembling the published, real-world metagenomes.</p>
    <p>3) P12: the number of contigs used in the feature importance evaluation seems relatively small: 200 contigs randomly selected from the correct and incorrect. There is a concern if the size is sufficiently large for a good assessment of the importance. Could you discuss further on this?</p>
    <p>4) P15: Using UMAP to examine how data were represented by ResMiCo is a good idea. However, as we know, UMAP only allows a visual inspection. I wonder if clustering the misassembled contigs would generate additional insights on the type of misassemblies in the data and if ResMiCo makes more mistakes in classification for any kind of misassembles represented by some cluster.</p>
    <p>Reviewer #3: In this paper, the authors present ResMiCo, a deep convolutional neural network that is trained to identify misassembled contigs in a reference-free manner, from metagenome assemblies. While metagenome assemblies are rapidly accumulating, the quality of the assemblies can still be much improved in many cases. In this respect, it is critical to identify and correct misassembled contigs from existing metagenomes. As per results, ResMiCo outperforms prior methods *greatly*. While this is very positive, we have remained not yet fully convinced in terms of the experiments that support the idea of superiority. In the following some major comments.</p>
    <p>* In lines 285-286, ”This filtering resulted in a reduction of the true error rate from 4% to 1% while keeping the contiguity metrics virtually unmodified.” How exactly do you estimate the error rate?</p>
    <p>* In Metaquast, how does Genome fraction change after filtering out misassembled contigs?</p>
    <p>* It would be clearly favorable to evaluate the method on real data that have a standard reference. Suggestions are: the Bmock12 data set in Volkan Sevim’s work treating shotgun metagenome data reflecting a mock community, sequenced using Oxford Nanopore, PacBio and Illumina technologies. Another dataset is the NWCs (natural whey culture) data set in Vincent Somerville’s “Long-read based de novo assembly of low-complexity metagenome samples results in finished genomes and reveals insights into strain diversity and an active phage system.” In both works, short reads and standard references are provided, where the latter was generated using hybrid assembly methods.</p>
    <p>* Please provide Genome Fraction as an evaluation category generated by Metaquast. Since metagenomes often contain various strains referring to identical species, it is important to have a look at how Genome Fraction is affected. For example, loosing contigs from particular strains -- indicated by a drop in Genome Fraction -- would imply undesired biases.</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>Reviewer #3: No</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link xlink:href="https://pacev2.apexcovantage.com/" ext-link-type="uri">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email>figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5" ext-link-type="uri">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
    <supplementary-material id="pcbi.1011001.s004" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">renamed_4c385.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1011001.s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pcbi.1011001.r002">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011001.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1011001" id="rel-obj002" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">5 Dec 2022</named-content>
    </p>
    <supplementary-material id="pcbi.1011001.s005" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">response_to_reviewers.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1011001.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="aggregated-review-documents" id="pcbi.1011001.r003" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011001.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Noble</surname>
          <given-names>William Stafford</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Coelho</surname>
          <given-names>Luis Pedro</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2023 Noble, Coelho</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Noble, Coelho</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1011001" id="rel-obj003" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">9 Jan 2023</named-content>
    </p>
    <p>Dear Dr. Youngblut,</p>
    <p>Thank you very much for submitting your manuscript "ResMiCo: increasing the quality of metagenome-assembled genomes with deep learning" for consideration at PLOS Computational Biology.</p>
    <p>As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. In light of the reviews (below this email), we would like to invite the resubmission of a significantly-revised version that takes into account the reviewers' comments.</p>
    <p>We ask that the authors address the remaining concerns of reviewer #3.</p>
    <p>We cannot make any decision about publication until we have seen the revised manuscript and your response to the reviewers' comments. Your revised manuscript is also likely to be sent to reviewers for further evaluation.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Please prepare and submit your revised manuscript within 60 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. Please note that revised manuscripts received after the 60-day due date may require evaluation and peer review similar to newly submitted manuscripts.</p>
    <p>Thank you again for your submission. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Luis Pedro Coelho</p>
    <p>Academic Editor</p>
    <p>PLOS Computational Biology</p>
    <p>William Noble</p>
    <p>Section Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>We ask that the authors address the remaining concerns of reviewer #3.</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: Thanks to the authors for addressing all of my concerns and comments from the first review in the revised manuscript. I have no remaining questions and wish the tool will be well maintained and developed continuously in the future.</p>
    <p>Reviewer #2: All my comments and suggestions have been satisfactorily addressed.</p>
    <p>Reviewer #3: I disagree with the authors on not running the method on mock communities. While these mock communities are not *real-world* data, they are *real* data, and provide -- as widely accepted by the community -- a basic test that a method does not perform in an erratic manner when being confronted with real data. (thanks for listing the communities, but I am aware of everything you mention in your response anyway)</p>
    <p>So, please run your method on mock communities, or convince me otherwise that it does not behave in mistaken ways when confronted with *real* data. (there was no mentioning in the response that you had done this; and I sometimes had the feeling that there was some confusion about the difference between *real-world* and *real* data).</p>
    <p>Thank you very much.</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>Reviewer #3: No</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link xlink:href="https://pacev2.apexcovantage.com/" ext-link-type="uri">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email>figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5" ext-link-type="uri">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pcbi.1011001.r004">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011001.r004</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 1</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1011001" id="rel-obj004" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">21 Feb 2023</named-content>
    </p>
    <supplementary-material id="pcbi.1011001.s006" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">response_to_reviewers.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1011001.s006.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pcbi.1011001.r005" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011001.r005</article-id>
    <title-group>
      <article-title>Decision Letter 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Noble</surname>
          <given-names>William Stafford</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Coelho</surname>
          <given-names>Luis Pedro</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2023 Noble, Coelho</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Noble, Coelho</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1011001" id="rel-obj005" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">6 Mar 2023</named-content>
    </p>
    <p>Dear Dr. Youngblut,</p>
    <p>We are pleased to inform you that your manuscript 'ResMiCo: increasing the quality of metagenome-assembled genomes with deep learning' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Luis Pedro Coelho</p>
    <p>Academic Editor</p>
    <p>PLOS Computational Biology</p>
    <p>William Noble</p>
    <p>Section Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pcbi.1011001.r006" specific-use="acceptance-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011001.r006</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Noble</surname>
          <given-names>William Stafford</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Coelho</surname>
          <given-names>Luis Pedro</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2023 Noble, Coelho</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Noble, Coelho</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1011001" id="rel-obj006" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">19 Apr 2023</named-content>
    </p>
    <p>PCOMPBIOL-D-22-00907R2 </p>
    <p>ResMiCo: increasing the quality of metagenome-assembled genomes with deep learning</p>
    <p>Dear Dr Youngblut,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Anita Estes</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link xlink:href="http://ploscompbiol.org" ext-link-type="uri">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle pcbi.1011001.r001?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10174551</article-id>
    <article-id pub-id-type="pmid">37126495</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-22-00907</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011001</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Metagenomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Neural Networks</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Neural Networks</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Sequencing Techniques</subject>
              <subj-group>
                <subject>Genome Sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Sequencing Techniques</subject>
            <subj-group>
              <subject>Genome Sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Mathematical and Statistical Techniques</subject>
          <subj-group>
            <subject>Mathematical Functions</subject>
            <subj-group>
              <subject>Convolution</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Bacteriology</subject>
            <subj-group>
              <subject>Bacterial Genetics</subject>
              <subj-group>
                <subject>Bacterial Genomics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Microbial Genetics</subject>
            <subj-group>
              <subject>Bacterial Genetics</subject>
              <subj-group>
                <subject>Bacterial Genomics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Microbial Genomics</subject>
              <subj-group>
                <subject>Bacterial Genomics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Microbial Genomics</subject>
            <subj-group>
              <subject>Bacterial Genomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Biological Databases</subject>
            <subj-group>
              <subject>Genomic Databases</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Genomic Databases</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Genomic Databases</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ResMiCo: Increasing the quality of metagenome-assembled genomes with deep learning</article-title>
      <alt-title alt-title-type="running-head">ResMiCo: Increasing the quality of metagenome-assembled genomes with deep learning</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Mineeva</surname>
          <given-names>Olga</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="econtrib001" ref-type="author-notes">
          <sup>‡</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Danciu</surname>
          <given-names>Daniel</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="econtrib001" ref-type="author-notes">
          <sup>‡</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schölkopf</surname>
          <given-names>Bernhard</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ley</surname>
          <given-names>Ruth E.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <xref rid="aff005" ref-type="aff">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Rätsch</surname>
          <given-names>Gunnar</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
        <xref rid="aff006" ref-type="aff">
          <sup>6</sup>
        </xref>
        <xref rid="aff007" ref-type="aff">
          <sup>7</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7424-5276</contrib-id>
        <name>
          <surname>Youngblut</surname>
          <given-names>Nicholas D.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff005" ref-type="aff">
          <sup>5</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Computer Science, ETH Zürich, Zürich, Switzerland</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of Empirical Inference, Max Planck Institute for Intelligent Systems, Tübingen, Germany</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Swiss Institute for Bioinformatics, Lausanne, Switzerland</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>ETH AI center, ETH Zürich, Zürich, Switzerland</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Department of Microbiome Science, Max Planck Institute for Biology, Tübingen, Germany</addr-line>
    </aff>
    <aff id="aff006">
      <label>6</label>
      <addr-line>Department of Biology, ETH Zürich, Zürich, Switzerland</addr-line>
    </aff>
    <aff id="aff007">
      <label>7</label>
      <addr-line>Medical Informatics Unit, Zürich University Hospital, Zürich, Switzerland</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Coelho</surname>
          <given-names>Luis Pedro</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Fudan University, CHINA</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="other" id="econtrib001">
        <p>‡ These authors share first authorship on this work.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>gunnar.raetsch@inf.ethz.ch</email> (GR); <email>nyoungblut@tuebingen.mpg.de</email> (NDY)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <volume>19</volume>
    <issue>5</issue>
    <elocation-id>e1011001</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>6</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>6</day>
        <month>3</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2023 Mineeva et al</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Mineeva et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1011001.pdf"/>
    <abstract>
      <p>The number of published metagenome assemblies is rapidly growing due to advances in sequencing technologies. However, sequencing errors, variable coverage, repetitive genomic regions, and other factors can produce misassemblies, which are challenging to detect for taxonomically novel genomic data. Assembly errors can affect all downstream analyses of the assemblies. Accuracy for the state of the art in reference-free misassembly prediction does not exceed an AUPRC of 0.57, and it is not clear how well these models generalize to real-world data. Here, we present the Residual neural network for Misassembled Contig identification (ResMiCo), a deep learning approach for reference-free identification of misassembled contigs. To develop ResMiCo, we first generated a training dataset of unprecedented size and complexity that can be used for further benchmarking and developments in the field. Through rigorous validation, we show that ResMiCo is substantially more accurate than the state of the art, and the model is robust to novel taxonomic diversity and varying assembly methods. ResMiCo estimated 7% misassembled contigs per metagenome across multiple real-world datasets. We demonstrate how ResMiCo can be used to optimize metagenome assembly hyperparameters to improve accuracy, instead of optimizing solely for contiguity. The accuracy, robustness, and ease-of-use of ResMiCo make the tool suitable for general quality control of metagenome assemblies and assembly methodology optimization.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Metagenome assembly quality is fundamental to all downstream analyses of such data. The number of metagenome assemblies, especially metagenome-assembled genomes (MAGs), is rapidly increasing, but tools to assess the quality of these assemblies lack the accuracy needed for robust quality control. Moreover, existing models have been trained on datasets lacking complexity and realism, which may limit their generalization to novel data. Due to the limitations of existing models, most studies forgo such approaches and instead rely on CheckM to assess assembly quality, an approach that only utilizes a small portion of all genomic information and does not identify specific misassemblies. We harnessed existing large genomic datasets and high-performance computing to produce a training dataset of unprecedented size and complexity and thereby trained a deep learning model for predicting misassemblies that can robustly generalize to novel taxonomy and varying assembly methodologies.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100003006</institution-id>
            <institution>Eidgenössische Technische Hochschule Zürich</institution>
          </institution-wrap>
        </funding-source>
        <principal-award-recipient>
          <name>
            <surname>Mineeva</surname>
            <given-names>Olga</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100018385</institution-id>
            <institution>Max-Planck-Förderstiftung</institution>
          </institution-wrap>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7424-5276</contrib-id>
          <name>
            <surname>Youngblut</surname>
            <given-names>Nicholas D.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution>Eidgenössische Technische Hochschule Strategic Focus Area - Personalized Health and Related Technologies</institution>
        </funding-source>
        <award-id>project #106</award-id>
        <principal-award-recipient>
          <name>
            <surname>Danciu</surname>
            <given-names>Daniel</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This work was supported by Eidgenössische Technische Hochschule Zürich core funding (OM, DD, and GR), the Max Planck Institute (NDY, REL, and BS), and the Eidgenössische Technische Hochschule Strategic Focus Area - Personalized Health and Related Technologies (project #106 to DD). OM was also supported by the Max Planck ETH Center for Learning Systems. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript. OM, DD, and GR received a salary from the Eidgenössische Technische Hochschule Zürich; NDY, REL, and BS received a salary from the Max Planck Institute.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="6"/>
      <table-count count="3"/>
      <page-count count="20"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2023-05-11</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>Resmico is publicly available at <ext-link xlink:href="https://github.com/leylabmpi/ResMiCo" ext-link-type="uri">https://github.com/leylabmpi/ResMiCo</ext-link>. The computationally intensive feature extraction library was written in C++, and the data simulation pipeline was implemented using Snakemake <ext-link xlink:href="https://doi.org/10.1093/bioinformatics/bts480" ext-link-type="uri">https://doi.org/10.1093/bioinformatics/bts480</ext-link> [<xref rid="pcbi.1011001.ref047" ref-type="bibr">47</xref>]. The deep learning model was built using Tensorflow <ext-link xlink:href="http://download.tensorflow.org/paper/whitepaper2015.pdf" ext-link-type="uri">http://download.tensorflow.org/paper/whitepaper2015.pdf</ext-link> [<xref rid="pcbi.1011001.ref048" ref-type="bibr">48</xref>]. MGSIM is available at <ext-link xlink:href="https://github.com/nick-youngblut/MGSIM" ext-link-type="uri">https://github.com/nick-youngblut/MGSIM</ext-link>. Due to the size of the n9k-train and n9k-novel datasets, these data has been deposited on the MPI for Biology FTP server and can be downloaded with tools such as wget or curl through the following link: <ext-link xlink:href="http://ftp.tue.mpg.de/ebio/projects/ResMiCo/" ext-link-type="uri">http://ftp.tue.mpg.de/ebio/projects/ResMiCo/</ext-link>. The authors are committed to ensuring the perpetual public accessibility of these data.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>Resmico is publicly available at <ext-link xlink:href="https://github.com/leylabmpi/ResMiCo" ext-link-type="uri">https://github.com/leylabmpi/ResMiCo</ext-link>. The computationally intensive feature extraction library was written in C++, and the data simulation pipeline was implemented using Snakemake <ext-link xlink:href="https://doi.org/10.1093/bioinformatics/bts480" ext-link-type="uri">https://doi.org/10.1093/bioinformatics/bts480</ext-link> [<xref rid="pcbi.1011001.ref047" ref-type="bibr">47</xref>]. The deep learning model was built using Tensorflow <ext-link xlink:href="http://download.tensorflow.org/paper/whitepaper2015.pdf" ext-link-type="uri">http://download.tensorflow.org/paper/whitepaper2015.pdf</ext-link> [<xref rid="pcbi.1011001.ref048" ref-type="bibr">48</xref>]. MGSIM is available at <ext-link xlink:href="https://github.com/nick-youngblut/MGSIM" ext-link-type="uri">https://github.com/nick-youngblut/MGSIM</ext-link>. Due to the size of the n9k-train and n9k-novel datasets, these data has been deposited on the MPI for Biology FTP server and can be downloaded with tools such as wget or curl through the following link: <ext-link xlink:href="http://ftp.tue.mpg.de/ebio/projects/ResMiCo/" ext-link-type="uri">http://ftp.tue.mpg.de/ebio/projects/ResMiCo/</ext-link>. The authors are committed to ensuring the perpetual public accessibility of these data.</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic toggle="yes">PLOS Computational Biology</italic> Methods paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Metagenome sequencing is rapidly increasing in popularity due to the lowering costs of sequencing and simplified library construction methods [<xref rid="pcbi.1011001.ref001" ref-type="bibr">1</xref>, <xref rid="pcbi.1011001.ref002" ref-type="bibr">2</xref>]. At the same time, improvements in metagenome assembly tools [<xref rid="pcbi.1011001.ref003" ref-type="bibr">3</xref>, <xref rid="pcbi.1011001.ref004" ref-type="bibr">4</xref>] and high-performance computing resources have increased the feasibility of large-scale metagenome assemblies on 1000s of samples [<xref rid="pcbi.1011001.ref005" ref-type="bibr">5</xref>–<xref rid="pcbi.1011001.ref007" ref-type="bibr">7</xref>]. The contiguous sequences (contigs) generated via metagenome assembly can be analyzed directly for such tasks as creating gene catalogs [<xref rid="pcbi.1011001.ref008" ref-type="bibr">8</xref>, <xref rid="pcbi.1011001.ref009" ref-type="bibr">9</xref>], or binning approaches can be used to cluster the contigs into metagenome-assembled genomes (MAGs) that can be used for various comparative genomics applications [<xref rid="pcbi.1011001.ref010" ref-type="bibr">10</xref>].</p>
    <p>These advances have given rise to vast genome assembly databases, such as the Unified Human Gastrointestinal Genome (UHGG) [<xref rid="pcbi.1011001.ref011" ref-type="bibr">11</xref>], in which MAGs account for 70% of the species. As another example, the Genome Taxonomy Database (GTDB) expanded from approximately 32,000 species to nearly 50,000 in less than one year [<xref rid="pcbi.1011001.ref012" ref-type="bibr">12</xref>, <xref rid="pcbi.1011001.ref013" ref-type="bibr">13</xref>], largely due to the proliferation of MAGs. Given the low-throughput nature of isolating Bacteria and Archaea for independent genome sequencing [<xref rid="pcbi.1011001.ref011" ref-type="bibr">11</xref>], metagenome assembly approaches will likely continue to dominate.</p>
    <p>The correct assembly of metagenomes is challenging due to several factors, including sequencing errors, high taxonomic diversity often comprising 1000s of species, uneven coverage, and repetitive genomic regions [<xref rid="pcbi.1011001.ref014" ref-type="bibr">14</xref>]. All of these factors contribute to misassemblies, with the most common being structural variations, relocations, translocations, and inversions [<xref rid="pcbi.1011001.ref015" ref-type="bibr">15</xref>]. Long read sequence data can mitigate some of these issues [<xref rid="pcbi.1011001.ref014" ref-type="bibr">14</xref>, <xref rid="pcbi.1011001.ref016" ref-type="bibr">16</xref>], but the expense relative to short read sequencing generally prevents one from obtaining sufficient sequence coverage for complex communities [<xref rid="pcbi.1011001.ref017" ref-type="bibr">17</xref>]. While assembly contiguity can be assessed easily by calculating such metrics as N50, assessing assembly accuracy is considerably more challenging due to a few major causes. First, due to a lack of very closely related taxa with genome regions (nearly) identical to the query, contigs cannot simply be mapped to references in order to assess accuracy. Second, reference-free tools that predict misassemblies have generally been trained and validated on small, homogeneous datasets in the past, which raises the question of their robustness to novel data (e.g., novel taxa or assembly methods). Indeed, Mineeva and colleagues showed that existing tools generally performed poorly on a large, heterogeneous dataset [<xref rid="pcbi.1011001.ref018" ref-type="bibr">18</xref>]. The authors’ novel deep learning approach, DeepMAsED, amply outperformed the state of the art and was relatively robust to taxonomic novelty, achieving an AUPRC score of 0.57 on a novel genome dataset; still, there remained substantial room for improvement in model accuracy and also a robust validation on complex datasets spanning the heterogeneity of existing metagenomes from complex communities. Indeed, Lei and colleagues developed metaMIC, a reference-free machine learning (ML) model for predicting misassemblies in metagenome assemblies [<xref rid="pcbi.1011001.ref019" ref-type="bibr">19</xref>], and showed that DeepMAsED’s performance was inferior to metaMIC’s; however, only few methodological details were provided on the validation approach.</p>
    <p>We present <underline>Res</underline>idual Neural Network for <underline>Mi</underline>sassembled <underline>Co</underline>ntigs Identification (ResMiCo), a novel approach for reference-free identification of misassembled contigs in metagenome assemblies. ResMiCo is a deep convolutional neural network with skip connections between non-adjacent layers. Similar architectures have proven to be highly successful when trained on large datasets from various fields [<xref rid="pcbi.1011001.ref020" ref-type="bibr">20</xref>, <xref rid="pcbi.1011001.ref021" ref-type="bibr">21</xref>]. We utilize a novel high throughput pipeline to generate complex and realistic training data covering much of the possible parameter space (e.g., varying data richness, sequencing depth, sequencing error rate, community diversities, and metagenome assembly methods). Through extensive evaluation, we show that the model outperforms the existing state of the art and is robust to metagenome data heterogeneity, including taxonomic novelty and metagenome assembly parameters. ResMiCo is also robust to alternative data simulation approaches, as shown when applied to the Critical Assessment Metagenome Interpretation (CAMI) datasets. We show that using ResMiCo to filter putative genomes reduces the number of misassembled contigs by a factor of four. We also apply ResMiCo to a large collection of metagenomes from published studies and show that 7% ± 5.7 (s.d.) of contigs per metagenome are misassembled. Lastly, we show that ResMiCo can be used to optimize metagenome assembler parameters for accuracy without the need for simulated or mock-community metagenome datasets.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and methods</title>
    <sec id="sec003">
      <title>Simulated data</title>
      <p>We used synthetic datasets for initial model training and testing. The data simulation methodology, depicted in <xref rid="pcbi.1011001.g001" ref-type="fig">Fig 1</xref>, builds on, and significantly expands on our previous work [<xref rid="pcbi.1011001.ref018" ref-type="bibr">18</xref>]. Reference bacterial and archaeal genomes were selected from Release 202 of the Genome Taxonomy Database (GTDB) [<xref rid="pcbi.1011001.ref022" ref-type="bibr">22</xref>]. Metagenomes were simulated from publicly available reference genomes via MGSIM (<ext-link xlink:href="https://github.com/nick-youngblut/MGSIM" ext-link-type="uri">https://github.com/nick-youngblut/MGSIM</ext-link>). Simulation parameters varied in all combinations of i) community richness, ii) community abundance distribution, iii) reference genomes selected from the total pool, iv) read length, v) insert size distribution (i.e., the distance in between the forward and reverse read pair), vi) sequencer error profile, vii) sequencing depth, and viii) metagenome assembler (<xref rid="pcbi.1011001.t001" ref-type="table">Table 1</xref>). The abundance distribution of each community was modeled as a log-normal distribution. We varied parameter <italic toggle="yes">σ</italic> to produce differing levels of evenness of relative abundances. Community richness was altered by random sub-sampling from the pool of reference genomes available in the training or test split. The ART [<xref rid="pcbi.1011001.ref023" ref-type="bibr">23</xref>] read simulator was used to generate paired-end Illumina reads of length 100 or 150 using either the default “Illumina HiSeq 2500” error profile or the “HiSeq2500L150R1/2” error profile used in CAMISIM [<xref rid="pcbi.1011001.ref024" ref-type="bibr">24</xref>]. Four paired-end read insert size distributions were simulated via the ART parameter settings (see “Insert size” in <xref rid="pcbi.1011001.t001" ref-type="table">Table 1</xref>). We included multiple simulation replicates, in which the community and read simulation parameters were held constant, but each replicate differed via randomization of the genome sub-sampling within each simulation. The reads from each community were assembled independently with metaSPAdes [<xref rid="pcbi.1011001.ref003" ref-type="bibr">3</xref>] and MEGAHIT [<xref rid="pcbi.1011001.ref004" ref-type="bibr">4</xref>].</p>
      <fig position="float" id="pcbi.1011001.g001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011001.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>The ResMiCo simulation and training pipeline.</title>
          <p>(A) Select reference genomes from the Genome Taxonomy Database (GTDB) at various abundances; (B) Simulate reads for the selected genomes using ART-Illumina; (C) Assemble reads into contigs using MEGAHIT and metaSPAdes; (D) Align reads back to the assembled contigs using Bowtie2, then extract features such as coverage, number of single-nucleotide variants (SNVs), mean alignment score, etc., for each contig using the given alignments; (E) Compute labels for each contig by aligning against the reference genomes using MetaQUAST; (F) For each contig, select a random section (that contains a breakpoint if the contig is misassembled), pad to the network’s input length if necessary, and feed the data into the ResMiCo model. Steps (D) and (E) are independent and can be parallelized.</p>
        </caption>
        <graphic xlink:href="pcbi.1011001.g001" position="float"/>
      </fig>
      <p>MetaQUAST [<xref rid="pcbi.1011001.ref015" ref-type="bibr">15</xref>] was used to identify truly misassembled contigs based on mapping all contigs to the reference genomes used for the simulations. The MetaQUAST-identified contig misassembly labels (“extensive misassembly”) were used as ground truth. The extensive misassembly label includes relocations, inversions, translocations and interspecies translocations. We also extracted MetaQUAST-identified breakpoint positions in the misassembled contigs.</p>
      <table-wrap position="float" id="pcbi.1011001.t001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011001.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Parameter values used in the simulation pipeline.</title>
          <p>The training dataset <italic toggle="yes">n9k-train</italic> was generated using all 1440 parameter combinations for the insert size distribution with mean = 270 &amp; sd = 50 and mean = 190 &amp; sd = 75. For the “mean = 350 &amp; sd = 75” insert size distribution, 3 replicates for the “HiSeq 2500 L150R1/2” error profile and one replicate for the “HiSeq 2500 error” profile were generated (960 parameter combinations). For the “mean = 450 &amp; sd = 120” insert size distribution, we used all parameters combinations, but only with the “HiSeq 2500 L150R1/2” error profile (720 parameter combinations). In total, we created 4560 samples. The parameter grid was not uniformly sampled due to the resource limitations. The test dataset <italic toggle="yes">n9k-novel</italic> contains one simulation replicate with the “HiSeq 2500” error profile, and using one (mean = 270 &amp; sd = 50) insert size, which resulted in 240 parameter combinations.</p>
        </caption>
        <alternatives>
          <graphic xlink:href="pcbi.1011001.t001" id="pcbi.1011001.t001g" position="float"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1">Parameter</th>
                <th align="center" rowspan="1" colspan="1">Values</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Community richness</td>
                <td align="left" rowspan="1" colspan="1">50, 1000, 3000, 5000 genomes</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Genome abundance</td>
                <td align="left" rowspan="1" colspan="1">Lognormal with <italic toggle="yes">μ</italic> = 10 and <italic toggle="yes">σ</italic> ∈ {0.5, 1, 2}</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Replicates</td>
                <td align="left" rowspan="1" colspan="1">3 random selections of reference genomes</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Read length</td>
                <td align="left" rowspan="1" colspan="1">100, 150 bps</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Insert size</td>
                <td align="left" rowspan="1" colspan="1">mean &amp; sd ∈ {190&amp;75, 270&amp;50, 350&amp;75, 450&amp;120}</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Error profile</td>
                <td align="left" rowspan="1" colspan="1">HiSeq 2500, HiSeq 2500 L150R1/2 [<xref rid="pcbi.1011001.ref024" ref-type="bibr">24</xref>]</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Sequencing depth</td>
                <td align="left" rowspan="1" colspan="1">0.5m, 2m, 8m, 12m, 20m</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Assembler</td>
                <td align="left" rowspan="1" colspan="1">MEGAHIT, MetaSPAdes</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>For initial model training and testing, we utilized a pool of 18,000 reference genomes selected from Release 202 of the Genome Taxonomy Database (GTDB). The pool was split at the family taxonomic level so that all genomes in the test dataset belonged to families not present in the training dataset. The resulting split was even, with 9000 genomes used for both training and testing. To reduce bias toward particular species, at most 50 genomes per species were included in the reference genome pool, with genomes selected at random. The pool was also filtered by CheckM-estimated completeness (≥ 90%) and contamination (≤ 5%). Other filtering criteria included: i) only “high” MIMAG quality, ii) no single-cell genome assemblies, iii) ≤ 500 contigs, iv) a genome size of ≤ 15 mbp, and v) a mean contig length of ≥ 10 kbp. We randomly subsampled reads mapped to each contig to a maximum mean contig coverage of 20. At this coverage level, assemblies of reasonable quality can be produced, and subsampling helps prevent out-of-distribution issues when applying ResMiCo to datasets with substantially higher sequencing depth than in our training dataset.</p>
      <p>To create features for model training and testing, we mapped reads to the contigs from the corresponding synthetic metagenome via Bowtie2 [<xref rid="pcbi.1011001.ref025" ref-type="bibr">25</xref>], and the resulting alignment data was used to generate per contig position features, as listed in Table A in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>.</p>
      <p>We refer to the training dataset as <italic toggle="yes">n9k-train</italic> and to the test dataset, which consists of genomes novel at a family taxonomic level, as <italic toggle="yes">n9k-novel</italic>. All combinations of the metagenome simulation parameters produced a training dataset of 4560 metagenomes and 80M contigs (<xref rid="pcbi.1011001.t001" ref-type="table">Table 1</xref>). We were limited to 1.3T of available space on our HPC cluster, so we had to randomly subset <italic toggle="yes">n9k-train</italic> to 3000 metagenomes, comprising 52M contigs (<xref rid="pcbi.1011001.t002" ref-type="table">Table 2</xref>). The test set (<italic toggle="yes">n9k-novel</italic>) was generated using the subset of parameters and one simulation replicate to save computational time (<xref rid="pcbi.1011001.t001" ref-type="table">Table 1</xref>). We also created a test dataset with higher intra-species diversity (33.3 ± 115) versus <italic toggle="yes">n9k-novel</italic> (2.4 ± 13.7), which we named <italic toggle="yes">n2k-novel-intra-species</italic>. We used only 2000 reference genomes in order to include enough families with a high number of intra-species genome diversity, but still include only families novel relative to the train dataset (as with <italic toggle="yes">n9k-novel</italic>). The simulation parameters for <italic toggle="yes">n2k-novel-intra-species</italic> were consistent with <italic toggle="yes">n9k-train</italic>, except i) only 50 and 1000 genomes for richness, ii) one simulation replicate, iii) one insert size distribution (mean = 270, sd = 50), and iv) sequencing depths of 2M, 8M, and 12M read pairs.</p>
      <table-wrap position="float" id="pcbi.1011001.t002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011001.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>A summary of the five synthetic datasets used for training and evaluating ResMiCo.</title>
          <p>The <italic toggle="yes">n9k-train</italic> and <italic toggle="yes">n9k-novel</italic> datasets were generated using our pipeline, all other datasets were created from CAMI reads. The <italic toggle="yes">n9k-train</italic> dataset was used for training and validation, while all other datasets were used for testing. Misassemblies are reported as a percent of the total number of contigs in the dataset. Misassemblies length is the sum of misassembled contig lengths divided by the total number of bases.</p>
        </caption>
        <alternatives>
          <graphic xlink:href="pcbi.1011001.t002" id="pcbi.1011001.t002g" position="float"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1"/>
                <th align="left" rowspan="1" colspan="1">n9k-train</th>
                <th align="left" rowspan="1" colspan="1">n9k-novel</th>
                <th align="left" rowspan="1" colspan="1">gut</th>
                <th align="left" rowspan="1" colspan="1">skin</th>
                <th align="left" rowspan="1" colspan="1">oral</th>
                <th align="left" rowspan="1" colspan="1">marine</th>
                <th align="left" rowspan="1" colspan="1">plant</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Contigs</td>
                <td align="left" rowspan="1" colspan="1">52.5M</td>
                <td align="left" rowspan="1" colspan="1">6.8M</td>
                <td align="left" rowspan="1" colspan="1">0.44M</td>
                <td align="left" rowspan="1" colspan="1">0.32M</td>
                <td align="left" rowspan="1" colspan="1">.41M</td>
                <td align="left" rowspan="1" colspan="1">1.0</td>
                <td align="left" rowspan="1" colspan="1">1.0</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Bases</td>
                <td align="left" rowspan="1" colspan="1">159B</td>
                <td align="left" rowspan="1" colspan="1">19.7B</td>
                <td align="left" rowspan="1" colspan="1">1.5B</td>
                <td align="left" rowspan="1" colspan="1">890M</td>
                <td align="left" rowspan="1" colspan="1">1.5B</td>
                <td align="left" rowspan="1" colspan="1">2.3B</td>
                <td align="left" rowspan="1" colspan="1">3.4B</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Average Coverage</td>
                <td align="left" rowspan="1" colspan="1">12.6</td>
                <td align="left" rowspan="1" colspan="1">10.2</td>
                <td align="left" rowspan="1" colspan="1">16.9</td>
                <td align="left" rowspan="1" colspan="1">15.7</td>
                <td align="left" rowspan="1" colspan="1">16.3</td>
                <td align="left" rowspan="1" colspan="1">14.1</td>
                <td align="left" rowspan="1" colspan="1">16.7</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Misassemblies</td>
                <td align="left" rowspan="1" colspan="1">3.41%</td>
                <td align="left" rowspan="1" colspan="1">4.0%</td>
                <td align="left" rowspan="1" colspan="1">1.2%</td>
                <td align="left" rowspan="1" colspan="1">1.72%</td>
                <td align="left" rowspan="1" colspan="1">1.74%</td>
                <td align="left" rowspan="1" colspan="1">2.66%</td>
                <td align="left" rowspan="1" colspan="1">2.43%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Misassemblies length</td>
                <td align="left" rowspan="1" colspan="1">3.69%</td>
                <td align="left" rowspan="1" colspan="1">4.26%</td>
                <td align="left" rowspan="1" colspan="1">3.82%</td>
                <td align="left" rowspan="1" colspan="1">3.06%</td>
                <td align="left" rowspan="1" colspan="1">3.20%</td>
                <td align="left" rowspan="1" colspan="1">3.29%</td>
                <td align="left" rowspan="1" colspan="1">6.70%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Median Contig length</td>
                <td align="left" rowspan="1" colspan="1">1530</td>
                <td align="left" rowspan="1" colspan="1">1510</td>
                <td align="left" rowspan="1" colspan="1">1473</td>
                <td align="left" rowspan="1" colspan="1">1394</td>
                <td align="left" rowspan="1" colspan="1">1455</td>
                <td align="left" rowspan="1" colspan="1">1349</td>
                <td align="left" rowspan="1" colspan="1">1427</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
    </sec>
    <sec id="sec004">
      <title>CAMI simulated metagenomes</title>
      <p>To benchmark ResMiCo’s performance in a new setting, we downloaded the paired-end reads of the Critical Assessment of Metagenome Interpretation (CAMI) human skin, human oral, human gut, plant-associated, and marine assembly challenges [<xref rid="pcbi.1011001.ref026" ref-type="bibr">26</xref>]. As with the <italic toggle="yes">n9k-train</italic> dataset, we assembled the reads via metaSPAdes and MEGAHIT, and identified true misassemblies via MetaQUAST based on the reference genomes in each of the 5 datasets. As shown in <xref rid="pcbi.1011001.t002" ref-type="table">Table 2</xref>, the number of misassembled contigs in the CAMI datasets is ∼50% lower, while coverage is ∼50% higher relative to the <italic toggle="yes">n9k-train</italic> dataset. The breakpoint locations for misassembled contigs follow a nearly identical distribution for all datasets, with more breakpoints clustered towards the ends (Fig A in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>).</p>
    </sec>
    <sec id="sec005">
      <title>Published, real-world metagenomes</title>
      <p>We evaluated ResMiCo on 7 published metagenome datasets: <italic toggle="yes">UHGG</italic> [<xref rid="pcbi.1011001.ref011" ref-type="bibr">11</xref>], <italic toggle="yes">TwinsUK</italic> [<xref rid="pcbi.1011001.ref027" ref-type="bibr">27</xref>], <italic toggle="yes">Animal-gut</italic> [<xref rid="pcbi.1011001.ref028" ref-type="bibr">28</xref>], <italic toggle="yes">Pinnell2019</italic> [<xref rid="pcbi.1011001.ref029" ref-type="bibr">29</xref>], <italic toggle="yes">Mantri2021</italic> [<xref rid="pcbi.1011001.ref030" ref-type="bibr">30</xref>], <italic toggle="yes">MarineMetagenomeDB</italic> [<xref rid="pcbi.1011001.ref031" ref-type="bibr">31</xref>], and <italic toggle="yes">TerrestrialMetagenomeDB</italic> [<xref rid="pcbi.1011001.ref032" ref-type="bibr">32</xref>] (<xref rid="pcbi.1011001.s002" ref-type="supplementary-material">S1 Table</xref>). The <italic toggle="yes">UHGG</italic> consisted of randomly selected metagenomes associated with the UHGG MAG collection. <italic toggle="yes">TwinsUK</italic> consisted of human gut metagenomes from adults in the TwinsUK cohort [<xref rid="pcbi.1011001.ref027" ref-type="bibr">27</xref>], while the <italic toggle="yes">Animal-gut</italic> comprised gut metagenomes from a broad taxonomic diversity of vertebrates [<xref rid="pcbi.1011001.ref028" ref-type="bibr">28</xref>].<italic toggle="yes">Pinnell2019</italic> and <italic toggle="yes">Mantri2021</italic> consisted of benthic and soil microbial community metagenomes, respectively. <italic toggle="yes">MarineMetagenomeDB</italic> and <italic toggle="yes">TerrestrialMetagenomeDB</italic> consisted of a selection of metagenomes from each respective database. The following filtering criteria were applied prior to metagenome selection: i) ≥ 1e6 and ≤ 80e6 reads, ii) maximum read lengths of ≤ 150bp, and iii) ≥ 10 samples in the study, and for the UHGG: iv) ≥ 10 and ≤ 300 MAGs associated with the metagenome.</p>
      <p>We also evaluated ResMiCo on 2 mock community datasets: BMock12 [<xref rid="pcbi.1011001.ref033" ref-type="bibr">33</xref>] and MBARC-26 [<xref rid="pcbi.1011001.ref034" ref-type="bibr">34</xref>]. We subsampled each metagenome to 2M read pairs in order to evaluate a sequencing depth on par with existing real-world metagenomes [<xref rid="pcbi.1011001.ref035" ref-type="bibr">35</xref>, <xref rid="pcbi.1011001.ref036" ref-type="bibr">36</xref>]. Representative genomes were downloaded from JGI IMG and Genbank for BMock12 and MBARC-26, respectively. These representatives were used in conjunction with MetaQUAST to identify true misassemblies.</p>
      <p>Metagenome read data processing was done as described in Youngblut and colleagues [<xref rid="pcbi.1011001.ref028" ref-type="bibr">28</xref>]. Briefly, reads were validated with fqtools [<xref rid="pcbi.1011001.ref037" ref-type="bibr">37</xref>]. Adapters were trimmed with Skewer [<xref rid="pcbi.1011001.ref038" ref-type="bibr">38</xref>]. The “bbduk” command from bbtools (<ext-link xlink:href="https://sourceforge.net/projects/bbmap/" ext-link-type="uri">https://sourceforge.net/projects/bbmap/</ext-link>) was used to trim and filter reads based on Phred scores. The “bbmap” command from bbtools was used to filter reads mapping to the hg19 human genome assembly. Read quality reports for each step of the pipeline were generated and visualised with FastQC and MultiQC, respectively (<ext-link xlink:href="https://www.bioinformatics.babraham.ac.uk/" ext-link-type="uri">https://www.bioinformatics.babraham.ac.uk/</ext-link>, [<xref rid="pcbi.1011001.ref039" ref-type="bibr">39</xref>]). Metagenomes were assembled via metaSPAdes with default parameters, and contigs &lt; 1000bp were removed. We did not also assemble the metagenomes with MEGAHIT, given the extra computational expense and methods complexity of evaluating both assemblers for each dataset, along the improved accuracy of metaSPAdes versus MEGAHIT [<xref rid="pcbi.1011001.ref003" ref-type="bibr">3</xref>]. Read mapping and ResMiCo feature generation were conducted as done for the simulation datasets.</p>
    </sec>
    <sec id="sec006">
      <title>Data preprocessing</title>
      <p>Count features were normalized by coverage (the number of reads mapped to the position) such that they are in the 0–1 range. For numerical features, we pre-computed mean and standard deviations using all contigs in the <italic toggle="yes">n9k-train</italic> dataset and saved these values. For all datasetes, we standardized numerical features to set the mean to zero and the variance to one using values computed on the training set. Missing values were replaced by zero (the new mean). We summarize the preprocessing applied to each feature in Table A in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>.</p>
      <p>Since we observed that ResMiCo did not generalize well to insert size distributions substantially deviating from the training dataset (Table E in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>), we excluded metagenomes for which the 0.05 and 0.95 quantiles of the mean insert size distribution lay outside the 0.02 and 0.98 quantiles of the mean insert size distribution of the <italic toggle="yes">n9k-train</italic> dataset, which are equal to 117 and 493, respectively.</p>
    </sec>
    <sec id="sec007">
      <title>Model and training</title>
      <sec id="sec008">
        <title>Architecture</title>
        <p>The ResMiCo neural network (NN) architecture is shown in <xref rid="pcbi.1011001.g002" ref-type="fig">Fig 2</xref>. It belongs to a class of deep convolutional residual neural networks. Residual connections enable deeper (more layers) neural networks and more efficient training compared to convolutional NNs [<xref rid="pcbi.1011001.ref020" ref-type="bibr">20</xref>]. Deeper models can capture more complex patterns spread over larger inputs. The main building unit, depicted at the bottom of the figure, is the residual block, consisting of two batch-normalized-convolutions [<xref rid="pcbi.1011001.ref040" ref-type="bibr">40</xref>] with a ReLu activation. The input of the residual block is connected with the output by simple element-wise addition. Since convolutions are not padded, the last 2*(<italic toggle="yes">K</italic> − 1) positions in the residual input, where <italic toggle="yes">K</italic> is the convolution kernel size, are cut off to match the output size. When the residual block is downsampling the data (by using a stride of <italic toggle="yes">S</italic> = 2 in the first convolution), the residual input is downsampled with a <italic toggle="yes">K</italic> = 1 convolution of an identical stride.</p>
        <fig position="float" id="pcbi.1011001.g002">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1011001.g002</object-id>
          <label>Fig 2</label>
          <caption>
            <title>ResMiCo architecture.</title>
            <p>The input is first passed through multiple convolutional layers; then the convolved result is masked to eliminate the effect of padding and passed through an average pooling layer, followed by two fully connected layers of sizes 128 × 50 and 50 × 1. The convolutional part consists of a simple convolution, followed by four residual groups (RG) with 2, 5, 5, and 2 residual blocks, respectively. The bottom of the figure depicts the structure of a residual block with a given number of features (F), kernel size (K), and stride (S). The first convolution in RG2, RG3, and RG4 halves the input size (using a stride of S = 2) and doubles the number of filters, gradually from 16 to 128. B denotes the batch size, and M represents the maximum contig length. The “14” in “BxMx14” represents the number of the selected features in the input to the neural network. Overall, ResMiCo has 562,573 parameters, of which 559,441 are trainable.</p>
          </caption>
          <graphic xlink:href="pcbi.1011001.g002" position="float"/>
        </fig>
        <p>Residual blocks with the same number of filters and identical output shapes are grouped into <italic toggle="yes">residual groups</italic>. ResMiCo has 4 residual groups, with the center groups consisting of 5 residual blocks each, while the outside groups contain 2 residual blocks. Each of the last three residual groups starts with a convolution that doubles the number of filters and halves the input size using a stride <italic toggle="yes">S</italic> = 2. All layers use a ReLU activation, except for the last fully connected layer, which uses a sigmoid activation. The output of the convolutional layers is summarized along the spatial axis via global average pooling, resulting in an output shape that depends only on the number of filters in the last convolutional layer (128 in our case) rather than on the contig length, thus allowing ResMiCo to handle contigs of variable length. Contigs in a batch are padded to the longest length, and the effects of padding are neutralized by creating a mask that is fed to the global average pooling layer. The resulting 128 features of the global average pooling are fed into the final two layers: a fully connected layer with 50 neurons and a one-neuron output layer with a sigmoid activation function.</p>
      </sec>
      <sec id="sec009">
        <title>Training</title>
        <p>The model was trained on the <italic toggle="yes">n9k-train</italic> training dataset for 50 epochs. One <italic toggle="yes">epoch</italic> is one pass of the entire training dataset through the algorithm. All misassembled contigs were used as positive training examples. In contrast, we randomly selected a 10% subset at every training epoch for the over-represented class of correctly assembled contigs, thus artificially increasing the positive sample rate to 24%. This helped to balance the dataset and reduce the computational load during training. For contigs shorter than 20,000 base-pairs, the entire contig is selected and zero-padded to the maximum batch length. For misassembled contigs longer than 20,000 base-pairs, a random 20,000 base-pair interval around each breakpoint (as identified by MetaQUAST) was selected. For long contigs with no misassemblies, a random 20,000 base-pair interval is selected.</p>
        <p>During model training, the binary cross-entropy loss between the target and predicted output was minimized by an Adam optimizer [<xref rid="pcbi.1011001.ref041" ref-type="bibr">41</xref>]. We used a batch size of 200 and an initial learning rate of 0.0001 with exponential decay of 0.8 when plateauing at evaluation. Gradients were clipped to a norm of 1 and a value of 0.5.</p>
      </sec>
      <sec id="sec010">
        <title>Model selection</title>
        <p>We used 10% of the <italic toggle="yes">n9k-train</italic> dataset as a validation set for model selection (<italic toggle="yes">n9k-valid</italic>). AUPRC on the validation set was computed every second epoch; if the score improved, a corresponding model was saved. The ResMiCo model described in this section achieved the highest AUPRC on the <italic toggle="yes">n9k-valid</italic> dataset at Epoch 46. The list of optimized hyperparameters and the attempted values are provided in Table B in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>.</p>
      </sec>
      <sec id="sec011">
        <title>Feature selection</title>
        <p>Since ResMiCo uses a larger number of features than both DeepMAsED and metaMIC, it is important to understand the amount that each feature, particularly features unique to ResMiCo, contributes to model predictions. Borrowed from game theory, Shapley values provide a principled way of explaining the predictions of machine learning models. We approximated the Shapley values using the Deep Shap (SHAP) algorithm [<xref rid="pcbi.1011001.ref042" ref-type="bibr">42</xref>], a refined version of DeepLIFT [<xref rid="pcbi.1011001.ref043" ref-type="bibr">43</xref>].</p>
        <p>In order to be able to compute SHAP coefficients, we had to make some adjustments to ResMiCo’s architecture: the input size was fixed, the padding was not masked, and the global average pooling layer was replaced by local pooling with a window covering the whole length. SHAP requires as input background samples as well as samples for which the predictions will be explained. We randomly sampled 200 contigs for the background and 200 contigs for explanations (100 correctly assembled and 100 misassembled) from the <italic toggle="yes">n9k-novel</italic> dataset. In Fig L in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>, we show that SHAP led to the same conclusions when using subsets of the 200 contigs, suggesting 200 is sufficient for this analysis.</p>
        <p><xref rid="pcbi.1011001.g003" ref-type="fig">Fig 3</xref> shows features ranked by their importance. For comparison, we also marked features present in the ResMiCo pipeline that were used by metaMIC and DeepMAsED. Feature names are explained in Table A in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>. The top 14 features were selected as input to the ResMiCo model. We included at least one feature of each kind: mapping quality, alignment score, etc. Limiting the number of features resulted in significantly reduced training time.</p>
        <fig position="float" id="pcbi.1011001.g003">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1011001.g003</object-id>
          <label>Fig 3</label>
          <caption>
            <title>Feature ranked by their importance.</title>
            <p>The lighter color marks features used by the ResMiCo model. We denote features used by DeepMAsED and metaMIC with a star outline and filled star, respectively. <monospace specific-use="no-wrap">mapq</monospace> and <monospace specific-use="no-wrap">al_score</monospace> are mapping quality and alignment score, as defined by Bowtie2. <monospace specific-use="no-wrap">num_snp</monospace> is the number of SNVs among aligned reads relative to the reference. <monospace specific-use="no-wrap">num_query_[ATGC]</monospace> is the base composition of aligned reads at the target position. <monospace specific-use="no-wrap">num_orphan</monospace> is the number of aligned reads in which only one of the pairs aligns properly. <monospace specific-use="no-wrap">num_proper</monospace> is the number of read pairs that align properly, as defined by Bowtie2. <monospace specific-use="no-wrap">num_proper_snp</monospace> is properly aligned reads with a SNV relative to the reference at the target position. <monospace specific-use="no-wrap">ref_base</monospace> is the reference base <monospace specific-use="no-wrap">[ATGC]</monospace> at the target position. Error bars correspond to the stdev computed over 5 runs.</p>
          </caption>
          <graphic xlink:href="pcbi.1011001.g003" position="float"/>
        </fig>
      </sec>
      <sec id="sec012">
        <title>Predictions</title>
        <p>To predict the misassembly probability for contigs longer than 20,000 base pairs, we split the contig into chunks of 20,000 base pairs, with a stride (overlap) of 500 bases in order to mitigate problems when the breakpoint is located at the very end of a chunk and two consecutive chunks individually appear as correctly assembled contigs. The prediction for the contig was obtained by selecting the maximum score across all chunks. For contigs shorter than 20,000 base pairs, the entire contig is given as input.</p>
      </sec>
    </sec>
    <sec id="sec013">
      <title>Comparison to the state of the art</title>
      <p>We analyzed the performance of our proposed model in relation to the following existing methods:</p>
      <list list-type="bullet">
        <list-item>
          <p>metaMIC [<xref rid="pcbi.1011001.ref044" ref-type="bibr">44</xref>]—applied with default parameters, except the minimum contig length was reduced from 5 kbp to 1 kbp, in order to test on the same data as the other methods;</p>
        </list-item>
        <list-item>
          <p>DeepMAsED [<xref rid="pcbi.1011001.ref018" ref-type="bibr">18</xref>]—we followed the feature generation scheme and the trained model provided by the authors;</p>
        </list-item>
        <list-item>
          <p>ALE [<xref rid="pcbi.1011001.ref045" ref-type="bibr">45</xref>]—we aggregated four positional sub-scores that ALE outputs (depth, place, insert, and k-mer log-likelihoods) with the same thresholds defined in [<xref rid="pcbi.1011001.ref018" ref-type="bibr">18</xref>]. The contig misassembly probability is computed as the number of positions with the sub-score below the threshold divided by contig length;</p>
        </list-item>
        <list-item>
          <p>Random—we assigned a random misassembly probability to each contig. This results in a horizontal line on a precision-recall curve plot with a precision equal to the prevalence of misassemblies in the dataset.</p>
        </list-item>
      </list>
      <p>Since all datasets suffer from a class imbalance in the detriment of positive samples (misassembled contigs, <xref rid="pcbi.1011001.t002" ref-type="table">Table 2</xref>), we selected the area under the precision-recall curve (AUPRC) as a metric to measure performance, rather than the area under the receiver operator curve (AUROC) [<xref rid="pcbi.1011001.ref046" ref-type="bibr">46</xref>]. However, AUPRC is not invariant to the prevalence of positive samples, so we used AUROC to compare the model’s performance across datasets with different percentages of positive samples.</p>
    </sec>
    <sec id="sec014">
      <title>Benchmarking ResMiCo resource requirements</title>
      <p>We benchmarked ResMiCo with direct comparisons between utilizing one CPU versus one GPU. On the CAMI gut dataset, ResMiCo was &gt; 2x faster with a GPU versus a CPU (108 ± 0.7 versus 38.7 ± 10.3 contigs per second). While a GPU is substantially faster than a CPU, one could still process nearly 140,000 contigs in 1 hour with a single CPU. Nonetheless, we note that multiple GPUs are recommended for training the model on large datasets, given that training on CPUs would not be feasible for large datasets, as in this work.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec015">
    <title>Results</title>
    <sec id="sec016">
      <title>ResMiCo outperforms existing models and is robust to metagenome novelty</title>
      <p>We first tested all models against the <italic toggle="yes">n9k-novel</italic> dataset, which consisted of family-level taxonomically novel genomes relative to any in the training dataset. ResMiCo outperformed DeepMAsED, ALE, and metaMIC by a large margin, with an AUPRC of 0.76 versus 0.25 for DeepMAsED, the second-best performing model (<xref rid="pcbi.1011001.g004" ref-type="fig">Fig 4A</xref>). Note that DeepMAsED’s AUPRC score dropped from 0.57 (reported in [<xref rid="pcbi.1011001.ref018" ref-type="bibr">18</xref>]) to 0.25 due to a higher variability within the <italic toggle="yes">n9k-novel</italic> test set. Importantly, ResMiCo’s AUPRC did not substantially differ between the training validation (0.73) and the <italic toggle="yes">n9k-novel</italic> dataset (0.76), thereby demonstrating that the model is robust to taxonomic novelty. ResMiCo’s AUPRC score typically varied from 0.6 to 0.8 across the various simulation parameter combinations (Fig H in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>). The most challenging settings for ResMiCo were a low community richness and a low sequencing depth. We also found that the contig length distribution explained much of the variability in ResMiCo model performance. For the simulations with a median contig length longer than 2000bp, the AUPRC was between 0.4 and 0.6 (Fig E in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>). In terms of misassembly type, ResMiCo performance was lowest for inversions (Fig G in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>).</p>
      <fig position="float" id="pcbi.1011001.g004">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011001.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>ResMiCo performance evaluation.</title>
          <p>Precision-recall curves and the corresponding AUPRC scores for ResMiCo and four baseline methods (metaMIC, DeepMAsED, ALE, Random) applied on the (A) <italic toggle="yes">nk9-novel</italic>, (B) CAMI gut, (C) CAMI oral, and (D) CAMI skin datasets. (E) Receiver operating characteristic curve and the corresponding AUROC scores for ResMiCo applied on five datasets: <italic toggle="yes">n9k-train</italic> (validation set only), <italic toggle="yes">nk9-novel</italic>, and three CAMI datasets.</p>
        </caption>
        <graphic xlink:href="pcbi.1011001.g004" position="float"/>
      </fig>
      <p>We simulated another test dataset (<italic toggle="yes">n2k-novel-intraspecies</italic>) with more genomes per species (33.3 ± 115) versus <italic toggle="yes">n9k-novel</italic> (2.4 ± 13.7). ResMiCo performance on <italic toggle="yes">n2k-novel-intraspecies</italic> declined relative to <italic toggle="yes">n9k-novel</italic> (AUPRC = 0.487, AUROC = 0.955), which was likely due to an increase in inter-genome translocations among closely related taxa. Still, ResMiCo greatly outperformed the closest competitor: metaMIC (AUPRC = 0.080, AUROC = 0.805).</p>
      <p>We next evaluated ResMiCo on the CAMI gut, oral, and skin metagenome datasets, which are commonly used simulation datasets for the evaluation of metagenomics analysis tools. The CAMI datasets differed substantially from <italic toggle="yes">n9k-train</italic> and <italic toggle="yes">n9k-novel</italic> in regards to coverage (sequencing depth) and class imbalance (percent misassemblies) (<xref rid="pcbi.1011001.t002" ref-type="table">Table 2</xref>). Moreover, reference genomes used for the <italic toggle="yes">n9k-train</italic> and <italic toggle="yes">n9k-novel</italic> datasets were selected from the entire GTDB, while the CAMI datasets consisted of biome-specific reference genomes [<xref rid="pcbi.1011001.ref024" ref-type="bibr">24</xref>]. Regardless of these differences, ResMiCo’s performance remained largely unaffected, and the model still clearly outperformed all competitors (<xref rid="pcbi.1011001.g004" ref-type="fig">Fig 4B, 4C and 4D</xref>). Given that the 5 synthetic datasets differ substantially in true positive rates (<xref rid="pcbi.1011001.t002" ref-type="table">Table 2</xref>), we computed the AUROC score, which is unaffected by such differences. <xref rid="pcbi.1011001.g004" ref-type="fig">Fig 4E</xref> shows that the AUROC remains relatively constant across the <italic toggle="yes">n9k-train</italic> validation, <italic toggle="yes">n9k-novel</italic>, and the CAMI datasets.</p>
      <p>We also evaluated ResMiCo on two CAMI datasets that simulate non-human biomes: <italic toggle="yes">CAMI-marine</italic> and <italic toggle="yes">CAMI-plant-associated</italic>. The performance of ResMiCo was comparable to the human-associated CAMI datasets (<italic toggle="yes">CAMI-marine</italic>: AUPRC = 0.831, AUROC = 0.990; <italic toggle="yes">CAMI-plant-associated</italic>: AUPRC = 0.611, AUROC = 0.965), suggesting that ResMiCo can generalize to metagenomes from highly varying biomes.</p>
      <p>Lastly, we assessed 2 mock community datasets: BMock12 [<xref rid="pcbi.1011001.ref033" ref-type="bibr">33</xref>] and MBARC-26 [<xref rid="pcbi.1011001.ref034" ref-type="bibr">34</xref>]. While existing mock communities are orders of magnitude lower in richness than complex communities, such as soil or mammalian gut microbiomes, and usually completely lack intra-species genomic diversity, mock communities do provide the best available real-world, ground-truth datasets. ResMiCo performance was in line with our expectations based on our simulations of low community richness (Fig H and I in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>), with an AUPRC of 0.475 and an AUROC of 0.951 when averaged across the 2 datasets (Table H in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>). These findings demonstrate that ResMiCo can generalize well to real-world metagenomic data.</p>
    </sec>
    <sec id="sec017">
      <title>Improvement of assembly quality after filtering ResMiCo-identified misassemblies</title>
      <p>A primary function of ResMiCo is to identify misassembled contigs so that they can be removed from the assembly. To illustrate the effects of such filtering, we discarded contigs in <italic toggle="yes">n9k-novel</italic> with a ResMiCo score of &gt;0.8, which corresponds to a recall and precision of 0.72 and 0.65, respectively. Given that truly misassemblied contigs are known for the <italic toggle="yes">n9k-novel</italic> dataset, we could measure the true error rate before and after filtering. Filtering according to ResMiCo scores resulted in a reduction of the true error rate from 4% to 1% while keeping the contiguity metrics virtually unmodified (<xref rid="pcbi.1011001.t003" ref-type="table">Table 3</xref>).</p>
      <table-wrap position="float" id="pcbi.1011001.t003">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011001.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title>Low-quality contig filtering.</title>
          <p>Statistics before and after filtering low-quality contigs with the ResMiCo model applied on the <italic toggle="yes">n9k-novel</italic> test set. The ResMiCo score threshold was set to &gt;0.8. Misassemblies length is the sum of misassembled contig lengths divided by the total number of bases.</p>
        </caption>
        <alternatives>
          <graphic xlink:href="pcbi.1011001.t003" id="pcbi.1011001.t003g" position="float"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Dataset</th>
                <th align="left" rowspan="1" colspan="1">True error rate</th>
                <th align="left" rowspan="1" colspan="1">Misassemblies length</th>
                <th align="left" rowspan="1" colspan="1">N contigs</th>
                <th align="left" rowspan="1" colspan="1">N50</th>
                <th align="left" rowspan="1" colspan="1">Mean length</th>
                <th align="left" rowspan="1" colspan="1">Median length</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Original</td>
                <td align="char" char="." rowspan="1" colspan="1">4.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">4.3%</td>
                <td align="right" rowspan="1" colspan="1">6779977</td>
                <td align="right" rowspan="1" colspan="1">3919</td>
                <td align="right" rowspan="1" colspan="1">2911</td>
                <td align="right" rowspan="1" colspan="1">1510</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ResMiCo</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>1.2%</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>1.8%</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">6474434</td>
                <td align="right" rowspan="1" colspan="1">3917</td>
                <td align="right" rowspan="1" colspan="1">2914</td>
                <td align="right" rowspan="1" colspan="1">1522</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>We also evaluated whether the MetaQUAST-defined “genome fraction” (the percentage of aligned bases in the reference genome) substantially declined as a result of filtering ResMiCo-identified misassemblies. For both the <italic toggle="yes">CAMI-gut</italic> and <italic toggle="yes">CAMI-marine</italic> datasets, the genome fraction did not substantially change after filtering (Wilcox, <italic toggle="yes">P</italic> ≥ 0.66; Fig K in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>).</p>
    </sec>
    <sec id="sec018">
      <title>Assembly optimization based on ResMiCo-identified error rates</title>
      <p>Since ResMiCo generates a score for each contig, we could use the number of contigs with a score above a certain threshold to estimate the misassembly rate of a given contig set (we used &gt;0.8 in our experiments). The estimated misassembly rate could then be used to optimize metagenome assembler parameters (e.g., k-mer lengths) for real metagenomes, which lack ground-truth data. Assembler hyperparameters are generally optimized simply based on total contiguity (e.g., N50) or possibly via CheckM after binning contigs into MAGs. However, such methods do not directly assess contig assembly accuracy. In order to use ResMiCo for this application, model performance must be robust to assembler hyperparameter settings outside of the training distribution.</p>
      <p>We tested ResMiCo’s performance as an oracle for assembler performance by simulating datasets in a similar fashion as <italic toggle="yes">n9k-novel</italic>, but with 6 different k-mer length hyperparameter settings for both MEGAHIT and metaSPAdes (see <xref rid="sec002" ref-type="sec">Methods</xref>). For each of the 6 k-mer length combinations, we generated akin to <italic toggle="yes">n9k-novel</italic> but utilized only 2 community richness (50 and 3000) and 2 sequencing depth (2M and 8M) settings. The rest of the simulation parameters were fixed: genome abundance distribution with <italic toggle="yes">σ</italic> = 1, read lengths of 150 bps, insert size distribution of mean = 270 &amp; sd = 50, and the “HiSeq 2500 error” error profile. The percentage of actual misassembled contigs differed from &lt;1% to 30% depending on the assembler and the chosen k-mer set applied on the same set reads (<xref rid="pcbi.1011001.g005" ref-type="fig">Fig 5</xref>). We then compared the percentage of misassembled contigs with the percentage estimated by ResMiCo for each of the four community richness/sequencing depth combinations (6 k-mer sets per combination).</p>
      <fig position="float" id="pcbi.1011001.g005">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011001.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Misassembly (error) rate produced by MEGAHIT and metaSPAdes assemblers with six different k-mer sets.</title>
          <p>k-mer set names denote the k-mer lengths used for the assembly. (A) ResMiCo-identified error rate (y-axis) correlates with the true error rate. (B) N50 size and the true error rate are orthogonal measures of the metagenome quality.</p>
        </caption>
        <graphic xlink:href="pcbi.1011001.g005" position="float"/>
      </fig>
      <p>ResMiCo was able to accurately rank the assemblies by misassembly rate for all four simulation parameter combinations, achieving a Pearson correlation of 0.9. (<xref rid="pcbi.1011001.g005" ref-type="fig">Fig 5A</xref>). While ResMiCo has a tendency to overestimate the misassembly rate with a selected prediction threshold, and the ratio between predicted and true misassembly rate depends on sample richness and sequencing depth (Fig J in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>), the ranking remained consistent in all considered scenarios. At the same time, for the most well-assembled metagenomes (low richness and high sequencing depth), we observed a correlation of 0.9 between N50 and true error rate (<xref rid="pcbi.1011001.g005" ref-type="fig">Fig 5B</xref>), which suggests that the high contiguity achieved together with high misassembly error rate. However this relationship does not hold for the samples simulated with other parameters, making possible to search for assembler parameters that produce good quality in terms of contiguity and error rate simultaneously. Consequently, we propose that ResMiCo can be used to rank assembler parameters for real-world metagenome data and identify parameters leading to the lowest misassembly rate.</p>
    </sec>
    <sec id="sec019">
      <title>Latent space visualization</title>
      <p>To get an intuition on how ResMiCo internally represents data, we studied the output of the global average pooling layer. At that point, the input data is mapped into a 128-dimensional space. We used UMAP [<xref rid="pcbi.1011001.ref049" ref-type="bibr">49</xref>] with default parameters to project the embeddings into a two-dimensional space. UMAP was fitted on the <italic toggle="yes">n9k-train</italic>, <italic toggle="yes">n9k-novel</italic>, and <italic toggle="yes">CAMI-gut</italic> datasets. We used 10,000 randomly sampled contigs from each of the three datasets.</p>
      <p>The latent space visualization indicates that <italic toggle="yes">n9k-train</italic> has more variability (due to the extensive set of parameters used in the simulations) than <italic toggle="yes">CAMI-gut</italic>, which is concentrated in a small subspace, while misassembled contigs from both datasets are generally clustered together (<xref rid="pcbi.1011001.g006" ref-type="fig">Fig 6A and 6B</xref>). Note that since ResMiCo has two fully connected layers following the visualized global average pooling, the two classes are not expected to be completely separable at this stage. Both community richness and average contig coverage strongly partition the latent space (<xref rid="pcbi.1011001.g006" ref-type="fig">Fig 6C and 6D</xref>).</p>
      <fig position="float" id="pcbi.1011001.g006">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011001.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>Contig embeddings learned by ResMiCo, projected using UMAP.</title>
          <p>The first row shows (A) all contig embeddings and (B) misassembled contig embeddings for the <italic toggle="yes">n9k-train</italic>, the <italic toggle="yes">n9k-novel</italic>, and the <italic toggle="yes">CAMI. gut</italic> datasets. In the second row, contigs from the <italic toggle="yes">n9k-train</italic> dataset are colored (C) by the richness of the simulated community they originated from and (D) by their average coverage.</p>
        </caption>
        <graphic xlink:href="pcbi.1011001.g006" position="float"/>
      </fig>
    </sec>
    <sec id="sec020">
      <title>ResMiCo detects a 3–12% misassembly rate in real-world metagenomes</title>
      <p>We applied ResMiCo to published gut metagenome datasets from multiple studies in order to assess the prevalence of misassembled contigs in publicly available metagenomic data. We utilized three datasets of gut samples: <italic toggle="yes">UHGG</italic>, <italic toggle="yes">TwinsUK</italic>, and <italic toggle="yes">Animal-gut</italic>. <italic toggle="yes">UHGG</italic> consisted of a random subset of gut metagenomes associated with MAGs in the UHGG database, while <italic toggle="yes">TwinsUK</italic> and <italic toggle="yes">Animal-gut</italic> consisted of gut metagenomes from westernized adults and a broad taxonomic diversity of vertebrates, respectively (see <xref rid="sec002" ref-type="sec">Materials and methods</xref>). We also utilized 2 marine meatgenome datasets (<italic toggle="yes">Pinnell2019</italic> and <italic toggle="yes">MarineMetagenomeDB</italic>) and 2 from soil (<italic toggle="yes">Mantri2021</italic> and <italic toggle="yes">TerrestrialMetagenomeDB</italic>).</p>
      <p>ResMiCo detected an average of 3.4%, 6%, and 8.8% misassembled contigs across all metagenome assemblies in the vertebrate-associated datasets: <italic toggle="yes">TwinsUK</italic>, <italic toggle="yes">Animal-gut</italic>, and <italic toggle="yes">UHGG</italic>, respectively. The marine and soil datasets contained more misassemblies (<italic toggle="yes">MarineMetagenomeDB</italic>: 8.3%, <italic toggle="yes">Mantri2021</italic>: 11.5%, <italic toggle="yes">Pinnell2019</italic>: 8.6%, and <italic toggle="yes">TerrestrialMetagenomeDB</italic>: 12.5%). Overall, we evaluated 8,235,502 contigs, of which 6% are misassembled according to ResMiCo’s predictions (≥ 0.8).</p>
      <p>We provide an estimated the misassembly rate for each metagenome in <xref rid="pcbi.1011001.s002" ref-type="supplementary-material">S1 Table</xref>. Averaged across all metagenomes, the misasssembly rate was 7% ± 5.7 (sd). The high variability among samples and datasets suggests that sample-specific factors (e.g., community taxonomic complexity or variability among NGS library preparations) can substantially influence misassembly rates. Note that we did not apply ResMiCo on the minority of metagenomes that failed to meet our inclusion criteria (see the <xref rid="sec002" ref-type="sec">Materials and methods</xref>).</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec021">
    <title>Discussion</title>
    <p>We addressed the problem of reference-free metagenome quality evaluation by developing ResMiCo, a deep residual neural network that enables accurate misassembled contig identification. ResMiCo provides an efficient data generation pipeline (see Text G in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>), which transforms raw reads and contigs into positional features that are utilized by a residual neural network to predict if a given contig was misassembled. The ResMiCo model was trained and tested on datasets of unprecedented size and complexity (<italic toggle="yes">n9k-train</italic> and <italic toggle="yes">n9k-novel</italic> contain 210 Gbps of assembled contigs), which we have made freely available as a resource for further model development and benchmarking (see <xref rid="sec002" ref-type="sec">Materials and methods</xref>). These datasets can be expanded, or new datasets can be generated with ResMiCo’s dataset simulation pipeline, which allows for straightforward, efficient data generation on high-performance computing systems.</p>
    <p>ResMiCo achieved a 0.76 AUPRC score on the taxonomically novel holdout test set (<italic toggle="yes">n9k-novel</italic>), which is an exceptional improvement over the state of the art (<xref rid="pcbi.1011001.g004" ref-type="fig">Fig 4A</xref>). The robustness of ResMiCo to family-level taxonomic novelty clearly demonstrates that it can be applied to metagenomes that include substantial taxonomic novelty, such as gut microbiomes from poorly studied animal species [<xref rid="pcbi.1011001.ref028" ref-type="bibr">28</xref>].</p>
    <p>When tested on the 3 human and 2 non-human CAMI datasets, ResMiCo showed similarly high performance and again substantially outperformed the state of the art (see <xref rid="sec015" ref-type="sec">Results</xref> and <xref rid="pcbi.1011001.g004" ref-type="fig">Fig 4B, 4C and 4D</xref>). These results show that ResMiCo can generalize to third-party, biome-specific datasets, despite our use of a biome-agnostic training dataset consisting of genomes randomly selected from the entire GTDB.</p>
    <p>ResMiCo is primarily designed to increase the quality of existing assemblies, and we demonstrated that filtering out contigs with high scores from the holdout test set resulted in a fourfold decrease in the true error rate without a substantial decline in contiguity (<xref rid="pcbi.1011001.t003" ref-type="table">Table 3</xref>).</p>
    <p>When applied to the real-world metagenome datasets, ResMiCo detected 7% ± 5.7 (sd) misassembled contigs per metagenome. This estimate is substantially higher than the 1% misassembly rate previously estimated via DeepMAsED [<xref rid="pcbi.1011001.ref018" ref-type="bibr">18</xref>], which may be due to differences in model accuracy and the increased number and variety of real-world metagenomes used for our estimation.</p>
    <p>We also show that ResMiCo can be applied to select assembler parameters corresponding to the best assembly accuracy for a given unlabeled dataset (<xref rid="pcbi.1011001.g005" ref-type="fig">Fig 5</xref>). Researchers can thus optimize assembler parameters for obtaining high accuracy on their specific real-world metagenomes without relying on benchmarks from simulated datasets [<xref rid="pcbi.1011001.ref024" ref-type="bibr">24</xref>].</p>
    <p>ResMiCo’s vastly improved performance relative to other reference-free misassembly detection methods is likely due to three main factors. First, ResMiCo was trained on a very large and varied dataset. Even after re-implementing the <italic toggle="yes">samtools pileup</italic> algorithm to gain a 10x speed improvement, generating the <italic toggle="yes">n9k-train</italic> dataset required nearly 40,000 CPU hours to produce all 4,560 simulation parameter combinations (<xref rid="pcbi.1011001.t001" ref-type="table">Table 1</xref>). For model training, we used 52.5M contigs that total 159 Gbps. In contrast, the DeepMAsED training dataset is 100x smaller, while no such training dataset information is available for metaMIC [<xref rid="pcbi.1011001.ref044" ref-type="bibr">44</xref>]. The UMAP projections of the contig embeddings for the <italic toggle="yes">n9k-train</italic>, the <italic toggle="yes">n9k-novel</italic>, and the <italic toggle="yes">CAMI-gut</italic> datasets (<xref rid="pcbi.1011001.g006" ref-type="fig">Fig 6A</xref>) show that ResMiCo’s training data comprises a substantial portion of the input space. Second, ResMiCo was trained on a larger number of carefully selected features; although ResMiCo uses only the top 14 features in <xref rid="pcbi.1011001.g003" ref-type="fig">Fig 3</xref>, we generated and tested a total of 23 features (Table A in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>) before selecting the 14 best performing ones. In comparison, DeepMAsED used 8 features for training, while metaMIC used 4 types of features, and as we have shown, both models failed to identify the features most relevant to misassembly detection. Third, introducing residual blocks, combined with the larger dataset, allowed us to train a deeper convolutional model, which has been shown to have better performance relative to traditional, shallower CNNs [<xref rid="pcbi.1011001.ref020" ref-type="bibr">20</xref>]. Long range (up to 20,000 bp) signal from raw positional features is transformed by the residual blocks, such that ResMiCo is able to internally detect a breakpoint (Fig B in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>) and identify misassembled contigs based on the strength of this signal.</p>
    <p>While our extensive evaluations showed that ResMiCo is robust to many sources of dataset novelty, we did find that the model is sensitive to the mean insert size distribution (Table E in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>). Therefore, prior to evaluation, we removed all metagenomes falling substantially outside of the <italic toggle="yes">n9k-train</italic> insert size distribution. While filtering by insert size may lead to a biased selection of real-world metagenomes, Illumina sequencing libraries often vary substantially in fragment length and subsequently insert size distribution, even within the same sequencing run. Such variation can result from inaccuracies in DNA quantification and reagent aliquoting. ResMiCo automatically detects if the insert size distributions of the evaluated data differ substantially from those during training and warns users that results may be less accurate. If needed, researchers can simulate more training data that includes the desired insert size range with the ResMiCo simulation pipeline.</p>
    <p>Improving performance robustness across changing distributions, sometimes termed out-of-distribution (o.o.d.) generalization [<xref rid="pcbi.1011001.ref050" ref-type="bibr">50</xref>–<xref rid="pcbi.1011001.ref052" ref-type="bibr">52</xref>], could be an interesting direction for follow-up work. While deep learning has produced impressive results in a range of domains, its reliance on independent and identically distributed (i.i.d.) training data can be a problem [<xref rid="pcbi.1011001.ref053" ref-type="bibr">53</xref>–<xref rid="pcbi.1011001.ref055" ref-type="bibr">55</xref>]. Although a range of attempts exist to improve o.o.d. generalization, empirical risk minimization still is the method of choice in practice [<xref rid="pcbi.1011001.ref056" ref-type="bibr">56</xref>, <xref rid="pcbi.1011001.ref057" ref-type="bibr">57</xref>], especially when used with a dataset of maximal diversity, as done in our study.</p>
    <p>Besides improving o.o.d., there are some other areas for further improvement. First, more research is needed to evaluate the quality of contigs assembled from error-prone long reads (e.g., Oxford Nanopore). Second, it is worth investigating if ResMiCo can be adapted to indicate the location of breakpoints in misassembled contigs. Third, rather than using binary labels, ResMiCo could be trained on misassembly type (e.g., inversion or translocation) to provide more detailed predictions. Fourth, while we did train on a very broad selection of genomes from across the bacterial and archaeal tree of life, future training and evaluation could be expanded to include eukaryotes and viruses.</p>
    <p>In summary, ResMiCo is a major advancement in the challenge of reference-free metagenome quality assessment. Existing methods addressing this problem have not been widely used, likely due to concerns regarding whether such approaches can generalize to real-world datasets. Our extensive testing shows that ResMiCo generalizes well across a large parameter space that includes taxonomy, community abundances, and many sequencing parameters. Wide adoption of ResMiCo could substantially improve metagenome assembly quality for individual studies and databases, which is critical for obtaining accurate biological insights from metagenomic data.</p>
  </sec>
  <sec id="sec022" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1011001.s001" position="float" content-type="local-data">
      <label>S1 Text</label>
      <caption>
        <p>Fig A. Breakpoint locations for misassemblies identified by MetaQUAST (treated as ground-truth in this work). Fig B. Feature maps for four <italic toggle="yes">n9k-novel</italic> misassembled contigs. Fig C. Feature maps from the last layer before global pooling for four <italic toggle="yes">n9k-novel</italic> correctly assembled contigs. Fig D. The contig length distribution and ResMiCo performance on contigs of different lengths. Fig E. AUPRC that ResMiCo achieves on 240 subsets (differing simulation parameters) of the <italic toggle="yes">n9k-novel</italic>. Fig F. Distribution of errors found by MetaQUAST in the <italic toggle="yes">n9k-novel</italic> test dataset. Fig G. ResMiCo scores for misassembled contigs grouped by assembly error type. Fig H. ResMiCo performance measured by AUPRC on contigs from the datasets with various simulation parameters (<italic toggle="yes">n9k-novel</italic>). Fig I. ResMiCo performance measured by AUROC on contigs from the datasets with various simulation parameters (<italic toggle="yes">n9k-novel</italic>). Fig J. Number of misassemblies found by ResMiCo divided by the true number of misassemblies in the datasets with various simulation parameters (<italic toggle="yes">n9k-novel</italic>). Fig K. Genome fraction measured on (A) CAMI gut and (B) CAMI marine datasets before and after filtering misassembled according to ResMiCo contigs. Fig L. Features ranked by their importance. Table A. The full list of positional features computed by ResMiCo pipeline. Table B. Hyperparameters tested for ResMiCo architecture. Table C. Effect of down sampling reads on the ResMiCo predictions. Table D. Contig length cut-off effect on the ResMiCo predictions. Table E. ResMiCo performance on test data varying by the <italic toggle="yes">mean</italic> of the insert size distribution. Table F. ResMiCo performance on the test sets with variable <italic toggle="yes">stdev</italic> of the insert size distribution. Table G. The insert size distribution statistics across synthetic and real-world datasets used in this work. Table H. ResMiCo performance on two mock real-world datasets. Text A: ResMiCo’s embeddings highlight breakpoint locations. Text B: ResMiCo performance by assembly error type. Text C: NN achitecture selection. Text D: Effect of the length cut-off and the read down-sampling on ResMiCo predictions. Text E: ResMiCo sensitivity to changes in insert size distribution. Text F: Clustering of misassemblies. Text G: Optimizing data generation performance.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1011001.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011001.s002" position="float" content-type="local-data">
      <label>S1 Table</label>
      <caption>
        <title>ResMiCo estimates the prevalence of misassembled contigs in publicly available metagenomic data.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011001.s002.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011001.s003" position="float" content-type="local-data">
      <label>S2 Table</label>
      <caption>
        <title>Characteristics of clusters of misassembled contigs from the <italic toggle="yes">n9k-novel</italic> dataset.</title>
        <p>See more details about clustering in Text F in <xref rid="pcbi.1011001.s001" ref-type="supplementary-material">S1 Text</xref>.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011001.s003.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1011001.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Gaio</surname><given-names>D</given-names></name>, <name><surname>Anantanawat</surname><given-names>K</given-names></name>, <name><surname>To</surname><given-names>J</given-names></name>, <name><surname>Liu</surname><given-names>M</given-names></name>, <name><surname>Monahan</surname><given-names>L</given-names></name>, <name><surname>Darling</surname><given-names>AE</given-names></name>. <article-title>Hackflex: low cost Illumina Nextera Flex sequencing library construction</article-title>. <source>bioRxiv</source>. <year>2021</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Hennig</surname><given-names>BP</given-names></name>, <name><surname>Velten</surname><given-names>L</given-names></name>, <name><surname>Racke</surname><given-names>I</given-names></name>, <name><surname>Tu</surname><given-names>CS</given-names></name>, <name><surname>Thoms</surname><given-names>M</given-names></name>, <name><surname>Rybin</surname><given-names>V</given-names></name>, <etal>et al</etal>. <article-title>Large-Scale Low-Cost NGS Library Preparation Using a Robust Tn5 Purification and Tagmentation Protocol</article-title>. <source>G3 Genes—Genomes—Genetics</source>. <year>2018</year>;<volume>8</volume>(<issue>1</issue>):<fpage>79</fpage>–<lpage>89</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1534/g3.117.300257</pub-id><?supplied-pmid 29118030?><pub-id pub-id-type="pmid">29118030</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Nurk</surname><given-names>S</given-names></name>, <name><surname>Meleshko</surname><given-names>D</given-names></name>, <name><surname>Korobeynikov</surname><given-names>A</given-names></name>, <name><surname>Pevzner</surname><given-names>PA</given-names></name>. <article-title>metaSPAdes: a new versatile metagenomic assembler</article-title>. <source>Genome research</source>. <year>2017</year>;<volume>27</volume>(<issue>5</issue>):<fpage>824</fpage>–<lpage>834</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1101/gr.213959.116</pub-id><?supplied-pmid 28298430?><pub-id pub-id-type="pmid">28298430</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>D</given-names></name>, <name><surname>Liu</surname><given-names>CM</given-names></name>, <name><surname>Luo</surname><given-names>R</given-names></name>, <name><surname>Sadakane</surname><given-names>K</given-names></name>, <name><surname>Lam</surname><given-names>TW</given-names></name>. <article-title>MEGAHIT: an ultra-fast single-node solution for large and complex metagenomics assembly via succinct de Bruijn graph</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>(<issue>10</issue>):<fpage>1674</fpage>–<lpage>1676</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btv033</pub-id><?supplied-pmid 25609793?><pub-id pub-id-type="pmid">25609793</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Nayfach</surname><given-names>S</given-names></name>, <name><surname>Shi</surname><given-names>ZJ</given-names></name>, <name><surname>Seshadri</surname><given-names>R</given-names></name>, <name><surname>Pollard</surname><given-names>KS</given-names></name>, <name><surname>Kyrpides</surname><given-names>NC</given-names></name>. <article-title>New insights from uncultivated genomes of the global human gut microbiome</article-title>. <source>Nature</source>. <year>2019</year>;<volume>568</volume>(<issue>7753</issue>):<fpage>505</fpage>–<lpage>510</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41586-019-1058-x</pub-id><?supplied-pmid 30867587?><pub-id pub-id-type="pmid">30867587</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Almeida</surname><given-names>A</given-names></name>, <name><surname>Mitchell</surname><given-names>AL</given-names></name>, <name><surname>Boland</surname><given-names>M</given-names></name>, <name><surname>Forster</surname><given-names>SC</given-names></name>, <name><surname>Gloor</surname><given-names>GB</given-names></name>, <name><surname>Tarkowska</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>A new genomic blueprint of the human gut microbiota</article-title>. <source>Nature</source>. <year>2019</year>;<volume>568</volume>(<issue>7753</issue>):<fpage>499</fpage>–<lpage>504</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41586-019-0965-1</pub-id><?supplied-pmid 30745586?><pub-id pub-id-type="pmid">30745586</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Pasolli</surname><given-names>E</given-names></name>, <name><surname>Asnicar</surname><given-names>F</given-names></name>, <name><surname>Manara</surname><given-names>S</given-names></name>, <name><surname>Zolfo</surname><given-names>M</given-names></name>, <name><surname>Karcher</surname><given-names>N</given-names></name>, <name><surname>Armanini</surname><given-names>F</given-names></name>, <etal>et al</etal>. <article-title>Extensive unexplored human microbiome diversity revealed by over 150,000 genomes from metagenomes spanning age, geography, and lifestyle</article-title>. <source>Cell</source>. <year>2019</year>;<volume>176</volume>(<issue>3</issue>):<fpage>649</fpage>–<lpage>662</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2019.01.001</pub-id><?supplied-pmid 30661755?><pub-id pub-id-type="pmid">30661755</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Qin</surname><given-names>J</given-names></name>, <name><surname>Li</surname><given-names>R</given-names></name>, <name><surname>Raes</surname><given-names>J</given-names></name>, <name><surname>Arumugam</surname><given-names>M</given-names></name>, <name><surname>Burgdorf</surname><given-names>KS</given-names></name>, <name><surname>Manichanh</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>A human gut microbial gene catalogue established by metagenomic sequencing</article-title>. <source>nature</source>. <year>2010</year>;<volume>464</volume>(<issue>7285</issue>):<fpage>59</fpage>–<lpage>65</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature08821</pub-id><?supplied-pmid 20203603?><pub-id pub-id-type="pmid">20203603</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Xiao</surname><given-names>L</given-names></name>, <name><surname>Feng</surname><given-names>Q</given-names></name>, <name><surname>Liang</surname><given-names>S</given-names></name>, <name><surname>Sonne</surname><given-names>SB</given-names></name>, <name><surname>Xia</surname><given-names>Z</given-names></name>, <name><surname>Qiu</surname><given-names>X</given-names></name>, <etal>et al</etal>. <article-title>A catalog of the mouse gut metagenome</article-title>. <source>Nature biotechnology</source>. <year>2015</year>;<volume>33</volume>(<issue>10</issue>):<fpage>1103</fpage>–<lpage>1108</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nbt.3353</pub-id><?supplied-pmid 26414350?><pub-id pub-id-type="pmid">26414350</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Breitwieser</surname><given-names>FP</given-names></name>, <name><surname>Lu</surname><given-names>J</given-names></name>, <name><surname>Salzberg</surname><given-names>SL</given-names></name>. <article-title>A review of methods and databases for metagenomic classification and assembly</article-title>. <source>Briefings in bioinformatics</source>. <year>2019</year>;<volume>20</volume>(<issue>4</issue>):<fpage>1125</fpage>–<lpage>1136</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bib/bbx120</pub-id><?supplied-pmid 29028872?><pub-id pub-id-type="pmid">29028872</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Almeida</surname><given-names>A</given-names></name>, <name><surname>Nayfach</surname><given-names>S</given-names></name>, <name><surname>Boland</surname><given-names>M</given-names></name>, <name><surname>Strozzi</surname><given-names>F</given-names></name>, <name><surname>Beracochea</surname><given-names>M</given-names></name>, <name><surname>Shi</surname><given-names>ZJ</given-names></name>, <etal>et al</etal>. <article-title>A unified catalog of 204,938 reference genomes from the human gut microbiome</article-title>. <source>Nature biotechnology</source>. <year>2021</year>;<volume>39</volume>(<issue>1</issue>):<fpage>105</fpage>–<lpage>114</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41587-020-0603-3</pub-id><?supplied-pmid 32690973?><pub-id pub-id-type="pmid">32690973</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Parks</surname><given-names>DH</given-names></name>, <name><surname>Chuvochina</surname><given-names>M</given-names></name>, <name><surname>Waite</surname><given-names>DW</given-names></name>, <name><surname>Rinke</surname><given-names>C</given-names></name>, <name><surname>Skarshewski</surname><given-names>A</given-names></name>, <name><surname>Chaumeil</surname><given-names>PA</given-names></name>, <etal>et al</etal>. <article-title>A standardized bacterial taxonomy based on genome phylogeny substantially revises the tree of life</article-title>. <source>Nature biotechnology</source>. <year>2018</year>;<volume>36</volume>(<issue>10</issue>):<fpage>996</fpage>–<lpage>1004</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nbt.4229</pub-id><?supplied-pmid 30148503?><pub-id pub-id-type="pmid">30148503</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Youngblut</surname><given-names>ND</given-names></name>, <name><surname>Ley</surname><given-names>RE</given-names></name>. <article-title>Struo2: efficient metagenome profiling database construction for ever-expanding microbial genome datasets</article-title>. <source>PeerJ</source>. <year>2021</year>;<volume>9</volume>:<fpage>e12198</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.7717/peerj.12198</pub-id><?supplied-pmid 34616633?><pub-id pub-id-type="pmid">34616633</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Lapidus</surname><given-names>AL</given-names></name>, <name><surname>Korobeynikov</surname><given-names>AI</given-names></name>. <article-title>Metagenomic data assembly–the way of decoding unknown microorganisms</article-title>. <source>Frontiers in Microbiology</source>. <year>2021</year>;<volume>12</volume>:<fpage>653</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3389/fmicb.2021.613791</pub-id><?supplied-pmid 33833738?><pub-id pub-id-type="pmid">33833738</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Mikheenko</surname><given-names>A</given-names></name>, <name><surname>Saveliev</surname><given-names>V</given-names></name>, <name><surname>Gurevich</surname><given-names>A</given-names></name>. <article-title>MetaQUAST: evaluation of metagenome assemblies</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>(<issue>7</issue>):<fpage>1088</fpage>–<lpage>1090</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btv697</pub-id><?supplied-pmid 26614127?><pub-id pub-id-type="pmid">26614127</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Koren</surname><given-names>S</given-names></name>, <name><surname>Phillippy</surname><given-names>AM</given-names></name>. <article-title>One chromosome, one contig: complete microbial genomes from long-read sequencing and assembly</article-title>. <source>Current opinion in microbiology</source>. <year>2015</year>;<volume>23</volume>:<fpage>110</fpage>–<lpage>120</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.mib.2014.11.014</pub-id><?supplied-pmid 25461581?><pub-id pub-id-type="pmid">25461581</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Ayling</surname><given-names>M</given-names></name>, <name><surname>Clark</surname><given-names>MD</given-names></name>, <name><surname>Leggett</surname><given-names>RM</given-names></name>. <article-title>New approaches for metagenome assembly with short reads</article-title>. <source>Briefings in bioinformatics</source>. <year>2020</year>;<volume>21</volume>(<issue>2</issue>):<fpage>584</fpage>–<lpage>594</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bib/bbz020</pub-id><?supplied-pmid 30815668?><pub-id pub-id-type="pmid">30815668</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Mineeva</surname><given-names>O</given-names></name>, <name><surname>Rojas-Carulla</surname><given-names>M</given-names></name>, <name><surname>Ley</surname><given-names>RE</given-names></name>, <name><surname>Schölkopf</surname><given-names>B</given-names></name>, <name><surname>Youngblut</surname><given-names>ND</given-names></name>. <article-title>DeepMAsED: evaluating the quality of metagenomic assemblies</article-title>. <source>Bioinformatics</source>. <year>2020</year>;<volume>36</volume>(<issue>10</issue>):<fpage>3011</fpage>–<lpage>3017</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btaa124</pub-id><?supplied-pmid 32096824?><pub-id pub-id-type="pmid">32096824</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Lai</surname><given-names>S</given-names></name>, <name><surname>Pan</surname><given-names>S</given-names></name>, <name><surname>Coelho</surname><given-names>LP</given-names></name>, <name><surname>Chen</surname><given-names>WH</given-names></name>, <name><surname>Zhao</surname><given-names>XM</given-names></name>. <article-title>metaMIC: reference-free Misassembly Identification and Correction of de novo metagenomic assemblies</article-title>. <source>bioRxiv</source>. <year>2021</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref020">
      <label>20</label>
      <mixed-citation publication-type="other">He K, Zhang X, Ren S, Sun J. Deep residual learning for image recognition. In: Proceedings of the IEEE conference on computer vision and pattern recognition; 2016. p. 770–778.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Jaganathan</surname><given-names>K</given-names></name>, <name><surname>Kyriazopoulou Panagiotopoulou</surname><given-names>S</given-names></name>, <name><surname>McRae</surname><given-names>JF</given-names></name>, <name><surname>Darbandi</surname><given-names>SF</given-names></name>, <name><surname>Knowles</surname><given-names>D</given-names></name>, <name><surname>Li</surname><given-names>YI</given-names></name>, <etal>et al</etal>. <article-title>Predicting Splicing from Primary Sequence with Deep Learning</article-title>. <source>Cell</source>. <year>2019</year>;<volume>176</volume>(<issue>3</issue>):<fpage>535</fpage>–<lpage>548.e24</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2018.12.015</pub-id><?supplied-pmid 30661751?><pub-id pub-id-type="pmid">30661751</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Parks</surname><given-names>DH</given-names></name>, <name><surname>Chuvochina</surname><given-names>M</given-names></name>, <name><surname>Waite</surname><given-names>DW</given-names></name>, <name><surname>Rinke</surname><given-names>C</given-names></name>, <name><surname>Skarshewski</surname><given-names>A</given-names></name>, <name><surname>Chaumeil</surname><given-names>PA</given-names></name>, <etal>et al</etal>. <article-title>A standardized bacterial taxonomy based on genome phylogeny substantially revises the tree of life</article-title>. <source>Nat Biotechnol</source>. <year>2018</year>;<volume>36</volume>(<issue>10</issue>):<fpage>996</fpage>–<lpage>1004</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nbt.4229</pub-id><?supplied-pmid 30148503?><pub-id pub-id-type="pmid">30148503</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Huang</surname><given-names>W</given-names></name>, <name><surname>Li</surname><given-names>L</given-names></name>, <name><surname>Myers</surname><given-names>JR</given-names></name>, <name><surname>Marth</surname><given-names>GT</given-names></name>. <article-title>ART: a next-generation sequencing read simulator</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>(<issue>4</issue>):<fpage>593</fpage>–<lpage>594</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btr708</pub-id><?supplied-pmid 22199392?><pub-id pub-id-type="pmid">22199392</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Fritz</surname><given-names>A</given-names></name>, <name><surname>Hofmann</surname><given-names>P</given-names></name>, <name><surname>Majda</surname><given-names>S</given-names></name>, <name><surname>Dahms</surname><given-names>E</given-names></name>, <name><surname>Dröge</surname><given-names>J</given-names></name>, <name><surname>Fiedler</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>CAMISIM: simulating metagenomes and microbial communities</article-title>. <source>Microbiome</source>. <year>2019</year>;<volume>7</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>12</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s40168-019-0633-6</pub-id><?supplied-pmid 30736849?><pub-id pub-id-type="pmid">30606251</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Langmead</surname><given-names>B</given-names></name>, <name><surname>Salzberg</surname><given-names>SL</given-names></name>. <article-title>Fast gapped-read alignment with Bowtie 2</article-title>. <source>Nat Methods</source>. <year>2012</year>;<volume>9</volume>(<issue>4</issue>):<fpage>357</fpage>–<lpage>359</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id><?supplied-pmid 22388286?><pub-id pub-id-type="pmid">22388286</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Sczyrba</surname><given-names>A</given-names></name>, <name><surname>Hofmann</surname><given-names>P</given-names></name>, <name><surname>Belmann</surname><given-names>P</given-names></name>, <name><surname>Koslicki</surname><given-names>D</given-names></name>, <name><surname>Janssen</surname><given-names>S</given-names></name>, <name><surname>Dröge</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Critical assessment of metagenome interpretation—a benchmark of metagenomics software</article-title>. <source>Nature methods</source>. <year>2017</year>;<volume>14</volume>(<issue>11</issue>):<fpage>1063</fpage>–<lpage>1071</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nmeth.4458</pub-id><?supplied-pmid 28967888?><pub-id pub-id-type="pmid">28967888</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>de la Cuesta-Zuluaga</surname><given-names>J</given-names></name>, <name><surname>Spector</surname><given-names>TD</given-names></name>, <name><surname>Youngblut</surname><given-names>ND</given-names></name>, <name><surname>Ley</surname><given-names>RE</given-names></name>, <name><surname>Bordenstein</surname><given-names>S</given-names></name>. <article-title>Genomic Insights into Adaptations of Trimethylamine-Utilizing Methanogens to Diverse Habitats, Including the Human Gut</article-title>. <source>mSystems</source>. <year>2021</year>;<volume>6</volume>(<issue>1</issue>):<fpage>e00939</fpage>–<lpage>20</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1128/mSystems.00939-20</pub-id><?supplied-pmid 33563787?><pub-id pub-id-type="pmid">33563787</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Youngblut</surname><given-names>ND</given-names></name>, <name><surname>De la Cuesta-Zuluaga</surname><given-names>J</given-names></name>, <name><surname>Reischer</surname><given-names>GH</given-names></name>, <name><surname>Dauser</surname><given-names>S</given-names></name>, <name><surname>Schuster</surname><given-names>N</given-names></name>, <name><surname>Walzer</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Large-scale metagenome assembly reveals novel animal-associated microbial genomes, biosynthetic gene clusters, and other genetic diversity</article-title>. <source>Msystems</source>. <year>2020</year>;<volume>5</volume>(<issue>6</issue>):<fpage>e01045</fpage>–<lpage>20</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1128/mSystems.01045-20</pub-id><?supplied-pmid 33144315?><pub-id pub-id-type="pmid">33144315</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Pinnell</surname><given-names>LJ</given-names></name>, <name><surname>Turner</surname><given-names>JW</given-names></name>. <article-title>Shotgun Metagenomics Reveals the Benthic Microbial Community Response to Plastic and Bioplastic in a Coastal Marine Environment</article-title>. <source>Frontiers in Microbiology</source>. <year>2019</year>;<volume>10</volume>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3389/fmicb.2019.01252</pub-id><?supplied-pmid 31231339?><pub-id pub-id-type="pmid">31231339</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Mantri</surname><given-names>SS</given-names></name>, <name><surname>Negri</surname><given-names>T</given-names></name>, <name><surname>Sales-Ortells</surname><given-names>H</given-names></name>, <name><surname>Angelov</surname><given-names>A</given-names></name>, <name><surname>Peter</surname><given-names>S</given-names></name>, <name><surname>Neidhardt</surname><given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Metagenomic Sequencing of Multiple Soil Horizons and Sites in Close Vicinity Revealed Novel Secondary Metabolite Diversity</article-title>. <source>mSystems</source>. <year>2021</year>;<volume>6</volume>(<issue>5</issue>):<fpage>e01018</fpage>–<lpage>21</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1128/mSystems.01018-21</pub-id><?supplied-pmid 34636675?><pub-id pub-id-type="pmid">34636675</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Nata’ala</surname><given-names>MK</given-names></name>, <name><surname>Avila Santos</surname><given-names>AP</given-names></name>, <name><surname>Coelho Kasmanas</surname><given-names>J</given-names></name>, <name><surname>Bartholomäus</surname><given-names>A</given-names></name>, <name><surname>Saraiva</surname><given-names>JP</given-names></name>, <name><surname>Godinho Silva</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>MarineMetagenomeDB: a public repository for curated and standardized metadata for marine metagenomes</article-title>. <source>Environ Microbiome</source>. <year>2022</year>;<volume>17</volume>(<issue>1</issue>):<fpage>57</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s40793-022-00449-7</pub-id><?supplied-pmid 36401317?><pub-id pub-id-type="pmid">36401317</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Corrêa</surname><given-names>FB</given-names></name>, <name><surname>Saraiva</surname><given-names>JP</given-names></name>, <name><surname>Stadler</surname><given-names>PF</given-names></name>, <name><surname>da Rocha</surname><given-names>UN</given-names></name>. <article-title>TerrestrialMetagenomeDB: a public repository of curated and standardized metadata for terrestrial metagenomes</article-title>. <source>Nucleic Acids Research</source>. <year>2019</year>;<volume>48</volume>(<issue>D1</issue>):<fpage>D626</fpage>–<lpage>D632</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Sevim</surname><given-names>V</given-names></name>, <name><surname>Lee</surname><given-names>J</given-names></name>, <name><surname>Egan</surname><given-names>R</given-names></name>, <name><surname>Clum</surname><given-names>A</given-names></name>, <name><surname>Hundley</surname><given-names>H</given-names></name>, <name><surname>Lee</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Shotgun metagenome data of a defined mock community using Oxford Nanopore, PacBio and Illumina technologies</article-title>. <source>Sci Data</source>. <year>2019</year>;<volume>6</volume>(<issue>1</issue>):<fpage>285</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41597-019-0287-z</pub-id><?supplied-pmid 31772173?><pub-id pub-id-type="pmid">31772173</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Singer</surname><given-names>E</given-names></name>, <name><surname>Andreopoulos</surname><given-names>B</given-names></name>, <name><surname>Bowers</surname><given-names>RM</given-names></name>, <name><surname>Lee</surname><given-names>J</given-names></name>, <name><surname>Deshpande</surname><given-names>S</given-names></name>, <name><surname>Chiniquy</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Next generation sequencing data of a defined microbial mock community</article-title>. <source>Sci Data</source>. <year>2016</year>;<volume>3</volume>:<fpage>160081</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/sdata.2016.81</pub-id><?supplied-pmid 27673566?><pub-id pub-id-type="pmid">27673566</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Jo</surname><given-names>J</given-names></name>, <name><surname>Oh</surname><given-names>J</given-names></name>, <name><surname>Park</surname><given-names>C</given-names></name>. <article-title>Microbial community analysis using high-throughput sequencing technology: a beginner’s guide for microbiologists</article-title>. <source>J Microbiol</source>. <year>2020</year>;<volume>58</volume>(<issue>3</issue>):<fpage>176</fpage>–<lpage>192</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s12275-020-9525-5</pub-id><?supplied-pmid 32108314?><pub-id pub-id-type="pmid">32108314</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Hillmann</surname><given-names>B</given-names></name>, <name><surname>Al-Ghalith</surname><given-names>GA</given-names></name>, <name><surname>Shields-Cutler</surname><given-names>RR</given-names></name>, <name><surname>Zhu</surname><given-names>Q</given-names></name>, <name><surname>Gohl</surname><given-names>DM</given-names></name>, <name><surname>Beckman</surname><given-names>KB</given-names></name>, <etal>et al</etal>. <article-title>Evaluating the Information Content of Shallow Shotgun Metagenomics</article-title>. <source>mSystems</source>. <year>2018</year>;<volume>3</volume>(<issue>6</issue>). <comment>doi: </comment><pub-id pub-id-type="doi">10.1128/mSystems.00069-18</pub-id><?supplied-pmid 30443602?><pub-id pub-id-type="pmid">30443602</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Droop</surname><given-names>AP</given-names></name>. <article-title>fqtools: an efficient software suite for modern FASTQ file manipulation</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>(<issue>12</issue>):<fpage>1883</fpage>–<lpage>1884</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btw088</pub-id><?supplied-pmid 27153699?><pub-id pub-id-type="pmid">27153699</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Jiang</surname><given-names>H</given-names></name>, <name><surname>Lei</surname><given-names>R</given-names></name>, <name><surname>Ding</surname><given-names>SW</given-names></name>, <name><surname>Zhu</surname><given-names>S</given-names></name>. <article-title>Skewer: a fast and accurate adapter trimmer for next-generation sequencing paired-end reads</article-title>. <source>BMC Bioinformatics</source>. <year>2014</year>;<volume>15</volume>:<fpage>182</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-2105-15-182</pub-id><?supplied-pmid 24925680?><pub-id pub-id-type="pmid">24925680</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Ewels</surname><given-names>P</given-names></name>, <name><surname>Magnusson</surname><given-names>M</given-names></name>, <name><surname>Lundin</surname><given-names>S</given-names></name>, <name><surname>Käller</surname><given-names>M</given-names></name>. <article-title>MultiQC: summarize analysis results for multiple tools and samples in a single report</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>(<issue>19</issue>):<fpage>3047</fpage>–<lpage>3048</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btw354</pub-id><?supplied-pmid 27312411?><pub-id pub-id-type="pmid">27312411</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Ioffe</surname><given-names>S</given-names></name>, <name><surname>Szegedy</surname><given-names>C</given-names></name>. <source>Batch Normalization: Accelerating Deep Network Training by Reducing Internal Covariate Shift</source>. <year>2015</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Kingma</surname><given-names>DP</given-names></name>, <name><surname>Ba</surname><given-names>J</given-names></name>. <source>Adam: A Method for Stochastic Optimization</source>. <year>2014</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref042">
      <label>42</label>
      <mixed-citation publication-type="book"><name><surname>Lundberg</surname><given-names>SM</given-names></name>, <name><surname>Lee</surname><given-names>SI</given-names></name>. <part-title>A Unified Approach to Interpreting Model Predictions</part-title>. In: <name><surname>Guyon</surname><given-names>I</given-names></name>, <name><surname>Luxburg</surname><given-names>UV</given-names></name>, <name><surname>Bengio</surname><given-names>S</given-names></name>, <name><surname>Wallach</surname><given-names>H</given-names></name>, <name><surname>Fergus</surname><given-names>R</given-names></name>, <name><surname>Vishwanathan</surname><given-names>S</given-names></name>, <etal>et al</etal>., editors. <source>Advances in Neural Information Processing Systems</source>. vol. <volume>30</volume>. <publisher-name>Curran Associates, Inc</publisher-name>.; <year>2017</year>. Available from: <ext-link xlink:href="https://proceedings.neurips.cc/paper/2017/file/8a20a8621978632d76c43dfd28b67767-Paper.pdf" ext-link-type="uri">https://proceedings.neurips.cc/paper/2017/file/8a20a8621978632d76c43dfd28b67767-Paper.pdf</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Shrikumar</surname><given-names>A</given-names></name>, <name><surname>Greenside</surname><given-names>P</given-names></name>, <name><surname>Kundaje</surname><given-names>A</given-names></name>. <source>Learning Important Features Through Propagating Activation Differences</source>. <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Lai</surname><given-names>S</given-names></name>, <name><surname>Pan</surname><given-names>S</given-names></name>, <name><surname>Coelho</surname><given-names>LP</given-names></name>, <name><surname>Chen</surname><given-names>WH</given-names></name>, <name><surname>Zhao</surname><given-names>XM</given-names></name>. <source>metaMIC: reference-free Misassembly Identification and Correction of de novo metagenomic assemblies</source>; <year>2021</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Clark</surname><given-names>SC</given-names></name>, <name><surname>Egan</surname><given-names>R</given-names></name>, <name><surname>Frazier</surname><given-names>PI</given-names></name>, <name><surname>Wang</surname><given-names>Z</given-names></name>. <article-title>ALE: a generic assembly likelihood evaluation framework for assessing the accuracy of genome and metagenome assemblies</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>(<issue>4</issue>):<fpage>435</fpage>–<lpage>443</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bts723</pub-id><?supplied-pmid 23303509?><pub-id pub-id-type="pmid">23303509</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Branco</surname><given-names>P</given-names></name>, <name><surname>Torgo</surname><given-names>L</given-names></name>, <name><surname>Ribeiro</surname><given-names>RP</given-names></name>. <article-title>A survey of predictive modeling on imbalanced domains</article-title>. <source>ACM Computing Surveys (CSUR)</source>. <year>2016</year>;<volume>49</volume>(<issue>2</issue>):<fpage>1</fpage>–<lpage>50</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1145/2907070</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Köster</surname><given-names>J</given-names></name>, <name><surname>Rahmann</surname><given-names>S</given-names></name>. <article-title>Snakemake—a scalable bioinformatics workflow engine</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>(<issue>19</issue>):<fpage>2520</fpage>–<lpage>2522</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bts480</pub-id><?supplied-pmid 22908215?><pub-id pub-id-type="pmid">22908215</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Abadi</surname><given-names>M</given-names></name>, <name><surname>Agarwal</surname><given-names>A</given-names></name>, <name><surname>Barham</surname><given-names>P</given-names></name>, <name><surname>Brevdo</surname><given-names>E</given-names></name>, <name><surname>Chen</surname><given-names>Z</given-names></name>, <name><surname>Citro</surname><given-names>C</given-names></name>, <etal>et al</etal>. <source>TensorFlow: Large-Scale Machine Learning on Heterogeneous Systems</source>; <year>2015</year>. Available from: <ext-link xlink:href="https://www.tensorflow.org/" ext-link-type="uri">https://www.tensorflow.org/</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>McInnes</surname><given-names>L</given-names></name>, <name><surname>Healy</surname><given-names>J</given-names></name>, <name><surname>Melville</surname><given-names>J</given-names></name>. <source>UMAP: Uniform Manifold Approximation and Projection for Dimension Reduction</source>. <year>2018</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref050">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Azulay</surname><given-names>A</given-names></name>, <name><surname>Weiss</surname><given-names>Y</given-names></name>. <article-title>Why Do Deep Convolutional Networks Generalize so Poorly to Small Image Transformations?</article-title><source>JMLR</source>. <year>2019</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref051">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Schott</surname><given-names>L</given-names></name>, <name><surname>von Kügelgen</surname><given-names>J</given-names></name>, <name><surname>Träuble</surname><given-names>F</given-names></name>, <name><surname>Gehler</surname><given-names>P</given-names></name>, <name><surname>Russell</surname><given-names>C</given-names></name>, <name><surname>Bethge</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Visual Representation Learning Does Not Generalize Strongly within the Same Domain</article-title>. In: <source>ICLR</source>; <year>2022</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Hendrycks</surname><given-names>D</given-names></name>, <name><surname>Basart</surname><given-names>S</given-names></name>, <name><surname>Mu</surname><given-names>N</given-names></name>, <name><surname>Kadavath</surname><given-names>S</given-names></name>, <name><surname>Wang</surname><given-names>F</given-names></name>, <name><surname>Dorundo</surname><given-names>E</given-names></name>, <etal>et al</etal>. <article-title>The Many Faces of Robustness: A Critical Analysis of Out-of-distribution Generalization</article-title>. In: <source>ICCV</source>; <year>2021</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref053">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Ben-David</surname><given-names>S</given-names></name>, <name><surname>Blitzer</surname><given-names>J</given-names></name>, <name><surname>Crammer</surname><given-names>K</given-names></name>, <name><surname>Pereira</surname><given-names>F</given-names></name>. <article-title>Analysis of representations for domain adaptation</article-title>. In: <source>Advances in neural information processing systems</source>; <year>2007</year>. p. <fpage>137</fpage>–<lpage>144</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref054">
      <label>54</label>
      <mixed-citation publication-type="journal"><name><surname>Schoelkopf</surname><given-names>B</given-names></name>. <article-title>Artificial intelligence: Learning to see and act</article-title>. <source>Nature</source>. <year>2015</year>;<volume>518</volume>(<issue>7540</issue>):<fpage>486</fpage>–<lpage>487</lpage>.<pub-id pub-id-type="pmid">25719660</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref055">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>Beery</surname><given-names>S</given-names></name>, <name><surname>Van Horn</surname><given-names>G</given-names></name>, <name><surname>Perona</surname><given-names>P</given-names></name>. <article-title>Recognition in Terra Incognita</article-title>. In: <source>ECCV</source>; <year>2018</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref056">
      <label>56</label>
      <mixed-citation publication-type="journal"><name><surname>Gulrajani</surname><given-names>I</given-names></name>, <name><surname>Lopez-Paz</surname><given-names>D</given-names></name>. <article-title>In Search of Lost Domain Generalization</article-title>. In: <source>ICLR</source>; <year>2021</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011001.ref057">
      <label>57</label>
      <mixed-citation publication-type="journal"><name><surname>Miller</surname><given-names>JP</given-names></name>, <name><surname>Taori</surname><given-names>R</given-names></name>, <name><surname>Raghunathan</surname><given-names>A</given-names></name>, <name><surname>Sagawa</surname><given-names>S</given-names></name>, <name><surname>Koh</surname><given-names>PW</given-names></name>, <name><surname>Shankar</surname><given-names>V</given-names></name>, <etal>et al</etal>. <article-title>Accuracy on the Line: on the Strong Correlation Between Out-of-Distribution and In-Distribution Generalization</article-title>. In: <source>ICML</source>; <year>2021</year>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="aggregated-review-documents" id="pcbi.1011001.r001" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011001.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Noble</surname>
          <given-names>William Stafford</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Coelho</surname>
          <given-names>Luis Pedro</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2023 Noble, Coelho</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Noble, Coelho</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1011001" id="rel-obj001" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">24 Aug 2022</named-content>
    </p>
    <p>Dear Dr. Youngblut,</p>
    <p>Thank you very much for submitting your manuscript "ResMiCo: increasing the quality of metagenome-assembled genomes with deep learning" for consideration at PLOS Computational Biology.</p>
    <p>As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. In light of the reviews (below this email), we would like to invite the resubmission of a significantly-revised version that takes into account the reviewers' comments.</p>
    <p>The reviewers all agree that the methods are an improvement over the state-of-the-art and that the tool could potentially be widely used, but raise several important points related to both unclear presentation and whether some of the conclusions are sufficiently supported. Of particular interest to us are the concerns related to the evaluation on real data: the suggestion of reviewer #3 to test ResMiCo on data with a known standard seems very reasonable; similarly, the comment of reviewer #1 that only human gut samples are used should be addressed (ideally by including additional benchmarks).</p>
    <p>We cannot make any decision about publication until we have seen the revised manuscript and your response to the reviewers' comments. Your revised manuscript is also likely to be sent to reviewers for further evaluation.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Please prepare and submit your revised manuscript within 60 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. Please note that revised manuscripts received after the 60-day due date may require evaluation and peer review similar to newly submitted manuscripts.</p>
    <p>Thank you again for your submission. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Luis Pedro Coelho</p>
    <p>Academic Editor</p>
    <p>PLOS Computational Biology</p>
    <p>William Noble</p>
    <p>Section Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>The reviewers all agree that the methods are an improvement over the state-of-the-art and that the tool could potentially be widely used, but raise several important points related to both unclear presentation and whether some of the conclusions are sufficiently supported. Of particular interest to us are the concerns related to the evaluation on real data: the suggestion of reviewer #3 to test ResMiCo on data with a known standard seems very reasonable; similarly, the comment of reviewer #1 that only human gut samples are used should be addressed (ideally by including additional benchmarks).</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: The review is uploaded as an attachment.</p>
    <p>Reviewer #2: This paper addresses the major challenge of evaluating contigs misassembly from the metagenomic reads without reference requirements. The proposed system, ResMico, utilizes a novel deep convolutional neural network with skip connections between non-adjacent layers. The authors have performed extensive evaluations through simulated datasets representing variously plausible microbial communities and sequencing parameters utilizing reference bacterial and archaeal genomes from the Genome Taxonomy Database. They showed the superior performance (accuracy and robustness) of ResMico compared to the existing methods, including DeepMAsDB, the tool previously developed by the authors’ group. They further showcased ResMiCo’s ability to detect an average of 4.7% error rate of contigs/metagenome in a large collection of gut metagenomes. The paper presents a tool with significant utility in metagenomics research. It is generally well-written; however, some technical aspects could be better explained.</p>
    <p>1) The Residual block structure was used in ResMiCo. However, more detailed descriptions are needed to clarify the rationale for using it, and how the number of RGs was determined. Please also indicate in the Fig.2 caption that 14 represents the number of the selected features in the input to the neural network.</p>
    <p>2) P9: Clarify why MetaSPAdes (but not MEGAHIT) was used for assembling the published, real-world metagenomes.</p>
    <p>3) P12: the number of contigs used in the feature importance evaluation seems relatively small: 200 contigs randomly selected from the correct and incorrect. There is a concern if the size is sufficiently large for a good assessment of the importance. Could you discuss further on this?</p>
    <p>4) P15: Using UMAP to examine how data were represented by ResMiCo is a good idea. However, as we know, UMAP only allows a visual inspection. I wonder if clustering the misassembled contigs would generate additional insights on the type of misassemblies in the data and if ResMiCo makes more mistakes in classification for any kind of misassembles represented by some cluster.</p>
    <p>Reviewer #3: In this paper, the authors present ResMiCo, a deep convolutional neural network that is trained to identify misassembled contigs in a reference-free manner, from metagenome assemblies. While metagenome assemblies are rapidly accumulating, the quality of the assemblies can still be much improved in many cases. In this respect, it is critical to identify and correct misassembled contigs from existing metagenomes. As per results, ResMiCo outperforms prior methods *greatly*. While this is very positive, we have remained not yet fully convinced in terms of the experiments that support the idea of superiority. In the following some major comments.</p>
    <p>* In lines 285-286, ”This filtering resulted in a reduction of the true error rate from 4% to 1% while keeping the contiguity metrics virtually unmodified.” How exactly do you estimate the error rate?</p>
    <p>* In Metaquast, how does Genome fraction change after filtering out misassembled contigs?</p>
    <p>* It would be clearly favorable to evaluate the method on real data that have a standard reference. Suggestions are: the Bmock12 data set in Volkan Sevim’s work treating shotgun metagenome data reflecting a mock community, sequenced using Oxford Nanopore, PacBio and Illumina technologies. Another dataset is the NWCs (natural whey culture) data set in Vincent Somerville’s “Long-read based de novo assembly of low-complexity metagenome samples results in finished genomes and reveals insights into strain diversity and an active phage system.” In both works, short reads and standard references are provided, where the latter was generated using hybrid assembly methods.</p>
    <p>* Please provide Genome Fraction as an evaluation category generated by Metaquast. Since metagenomes often contain various strains referring to identical species, it is important to have a look at how Genome Fraction is affected. For example, loosing contigs from particular strains -- indicated by a drop in Genome Fraction -- would imply undesired biases.</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>Reviewer #3: No</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link xlink:href="https://pacev2.apexcovantage.com/" ext-link-type="uri">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email>figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5" ext-link-type="uri">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
    <supplementary-material id="pcbi.1011001.s004" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">renamed_4c385.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1011001.s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pcbi.1011001.r002">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011001.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1011001" id="rel-obj002" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">5 Dec 2022</named-content>
    </p>
    <supplementary-material id="pcbi.1011001.s005" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">response_to_reviewers.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1011001.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="aggregated-review-documents" id="pcbi.1011001.r003" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011001.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Noble</surname>
          <given-names>William Stafford</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Coelho</surname>
          <given-names>Luis Pedro</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2023 Noble, Coelho</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Noble, Coelho</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1011001" id="rel-obj003" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">9 Jan 2023</named-content>
    </p>
    <p>Dear Dr. Youngblut,</p>
    <p>Thank you very much for submitting your manuscript "ResMiCo: increasing the quality of metagenome-assembled genomes with deep learning" for consideration at PLOS Computational Biology.</p>
    <p>As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. In light of the reviews (below this email), we would like to invite the resubmission of a significantly-revised version that takes into account the reviewers' comments.</p>
    <p>We ask that the authors address the remaining concerns of reviewer #3.</p>
    <p>We cannot make any decision about publication until we have seen the revised manuscript and your response to the reviewers' comments. Your revised manuscript is also likely to be sent to reviewers for further evaluation.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Please prepare and submit your revised manuscript within 60 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. Please note that revised manuscripts received after the 60-day due date may require evaluation and peer review similar to newly submitted manuscripts.</p>
    <p>Thank you again for your submission. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Luis Pedro Coelho</p>
    <p>Academic Editor</p>
    <p>PLOS Computational Biology</p>
    <p>William Noble</p>
    <p>Section Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>We ask that the authors address the remaining concerns of reviewer #3.</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: Thanks to the authors for addressing all of my concerns and comments from the first review in the revised manuscript. I have no remaining questions and wish the tool will be well maintained and developed continuously in the future.</p>
    <p>Reviewer #2: All my comments and suggestions have been satisfactorily addressed.</p>
    <p>Reviewer #3: I disagree with the authors on not running the method on mock communities. While these mock communities are not *real-world* data, they are *real* data, and provide -- as widely accepted by the community -- a basic test that a method does not perform in an erratic manner when being confronted with real data. (thanks for listing the communities, but I am aware of everything you mention in your response anyway)</p>
    <p>So, please run your method on mock communities, or convince me otherwise that it does not behave in mistaken ways when confronted with *real* data. (there was no mentioning in the response that you had done this; and I sometimes had the feeling that there was some confusion about the difference between *real-world* and *real* data).</p>
    <p>Thank you very much.</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>Reviewer #3: No</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link xlink:href="https://pacev2.apexcovantage.com/" ext-link-type="uri">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email>figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5" ext-link-type="uri">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pcbi.1011001.r004">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011001.r004</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 1</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1011001" id="rel-obj004" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">21 Feb 2023</named-content>
    </p>
    <supplementary-material id="pcbi.1011001.s006" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">response_to_reviewers.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1011001.s006.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pcbi.1011001.r005" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011001.r005</article-id>
    <title-group>
      <article-title>Decision Letter 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Noble</surname>
          <given-names>William Stafford</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Coelho</surname>
          <given-names>Luis Pedro</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2023 Noble, Coelho</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Noble, Coelho</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1011001" id="rel-obj005" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">6 Mar 2023</named-content>
    </p>
    <p>Dear Dr. Youngblut,</p>
    <p>We are pleased to inform you that your manuscript 'ResMiCo: increasing the quality of metagenome-assembled genomes with deep learning' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Luis Pedro Coelho</p>
    <p>Academic Editor</p>
    <p>PLOS Computational Biology</p>
    <p>William Noble</p>
    <p>Section Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pcbi.1011001.r006" specific-use="acceptance-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011001.r006</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Noble</surname>
          <given-names>William Stafford</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Coelho</surname>
          <given-names>Luis Pedro</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2023 Noble, Coelho</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Noble, Coelho</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1011001" id="rel-obj006" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">19 Apr 2023</named-content>
    </p>
    <p>PCOMPBIOL-D-22-00907R2 </p>
    <p>ResMiCo: increasing the quality of metagenome-assembled genomes with deep learning</p>
    <p>Dear Dr Youngblut,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Anita Estes</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link xlink:href="http://ploscompbiol.org" ext-link-type="uri">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
