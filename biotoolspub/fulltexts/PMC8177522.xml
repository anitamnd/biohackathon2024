<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS One</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8177522</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-20-32975</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0252431</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Bioassays and Physiological Analysis</subject>
          <subj-group>
            <subject>Electrophysiological Techniques</subject>
            <subj-group>
              <subject>Brain Electrophysiology</subject>
              <subj-group>
                <subject>Electroencephalography</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Physiology</subject>
          <subj-group>
            <subject>Electrophysiology</subject>
            <subj-group>
              <subject>Neurophysiology</subject>
              <subj-group>
                <subject>Brain Electrophysiology</subject>
                <subj-group>
                  <subject>Electroencephalography</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Neurophysiology</subject>
            <subj-group>
              <subject>Brain Electrophysiology</subject>
              <subj-group>
                <subject>Electroencephalography</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Brain Mapping</subject>
            <subj-group>
              <subject>Electroencephalography</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Clinical Medicine</subject>
          <subj-group>
            <subject>Clinical Neurophysiology</subject>
            <subj-group>
              <subject>Electroencephalography</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Imaging Techniques</subject>
          <subj-group>
            <subject>Neuroimaging</subject>
            <subj-group>
              <subject>Electroencephalography</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Neuroimaging</subject>
            <subj-group>
              <subject>Electroencephalography</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Finite Element Analysis</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Computer Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Computer Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Computer Software</subject>
            <subj-group>
              <subject>Open Source Software</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Computer Software</subject>
            <subj-group>
              <subject>Open Source Software</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Science Policy</subject>
        <subj-group>
          <subject>Open Science</subject>
          <subj-group>
            <subject>Open Source Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Programming Languages</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Programming Languages</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Nervous System</subject>
            <subj-group>
              <subject>Central Nervous System</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Nervous System</subject>
            <subj-group>
              <subject>Central Nervous System</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Physiology</subject>
          <subj-group>
            <subject>Electrophysiology</subject>
            <subj-group>
              <subject>Membrane Potential</subject>
              <subj-group>
                <subject>Evoked Potentials</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Physiology</subject>
          <subj-group>
            <subject>Electrophysiology</subject>
            <subj-group>
              <subject>Neurophysiology</subject>
              <subj-group>
                <subject>Evoked Potentials</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Neurophysiology</subject>
            <subj-group>
              <subject>Evoked Potentials</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DUNEuro—A software toolbox for forward modeling in bioelectromagnetism</article-title>
      <alt-title alt-title-type="running-head">The DUNEuro software toolbox</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2402-5275</contrib-id>
        <name>
          <surname>Schrader</surname>
          <given-names>Sophie</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Westhoff</surname>
          <given-names>Andreas</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8339-0355</contrib-id>
        <name>
          <surname>Piastra</surname>
          <given-names>Maria Carla</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Miinalainen</surname>
          <given-names>Tuuli</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff005" ref-type="aff">
          <sup>5</sup>
        </xref>
        <xref rid="aff006" ref-type="aff">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pursiainen</surname>
          <given-names>Sampsa</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff005" ref-type="aff">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vorwerk</surname>
          <given-names>Johannes</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff007" ref-type="aff">
          <sup>7</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Brinck</surname>
          <given-names>Heinrich</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wolters</surname>
          <given-names>Carsten H.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff008" ref-type="aff">
          <sup>8</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Engwer</surname>
          <given-names>Christian</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Institute for Biomagnetism and Biosignalanalysis, University of Münster, Munster, Germany</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Applied Mathematics: Institute for Analysis and Numerics, University of Münster, Munster, Germany</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Institute for Bioinformatics and Chemoinformatics, Westphalian University of Applied Sciences, Gelsenkirchen, Germany</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Radboud University Nijmegen Medical Centre, Donders Institute for Brain, Cognition and Behaviour, Nijmegen, The Netherlands</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Computing Sciences, Tampere University, Tampere, Finland</addr-line>
    </aff>
    <aff id="aff006">
      <label>6</label>
      <addr-line>Department of Applied Physics, University of Eastern Finland, Kuopio, Finland</addr-line>
    </aff>
    <aff id="aff007">
      <label>7</label>
      <addr-line>Institute of Electrical and Biomedical Engineering, UMIT - Private University for Health Sciences, Medical Informatics and Technology, Hall in Tyrol, Austria</addr-line>
    </aff>
    <aff id="aff008">
      <label>8</label>
      <addr-line>Otto Creutzfeldt Center for Cognitive and Behavioral Neuroscience, University of Münster, Munster, Germany</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Papadelis</surname>
          <given-names>Christos</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Cook Children’s Medical Center, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>christian.engwer@uni-muenster.de</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>4</day>
      <month>6</month>
      <year>2021</year>
    </pub-date>
    <volume>16</volume>
    <issue>6</issue>
    <elocation-id>e0252431</elocation-id>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>10</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>5</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2021 Schrader et al</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Schrader et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri xmlns:xlink="http://www.w3.org/1999/xlink" content-type="pdf" xlink:href="pone.0252431.pdf"/>
    <abstract>
      <p>Accurate and efficient source analysis in electro- and magnetoencephalography using sophisticated realistic head geometries requires advanced numerical approaches. This paper presents DUNEuro, a free and open-source C++ software toolbox for the numerical computation of forward solutions in bioelectromagnetism. Building upon the DUNE framework, it provides implementations of modern fitted and unfitted finite element methods to efficiently solve the forward problems of electro- and magnetoencephalography. The user can choose between a variety of different source models that are implemented. The software’s aim is to provide interfaces that are extendable and easy-to-use. In order to enable a closer integration into existing analysis pipelines, interfaces to Python and MATLAB are provided. The practical use is demonstrated by a source analysis example of somatosensory evoked potentials using a realistic six-compartment head model. Detailed installation instructions and example scripts using spherical and realistic head models are appended.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001659</institution-id>
            <institution>Deutsche Forschungsgemeinschaft</institution>
          </institution-wrap>
        </funding-source>
        <award-id>EXC 1003-194347757</award-id>
        <principal-award-recipient>
          <name>
            <surname>Engwer</surname>
            <given-names>Christian</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001659</institution-id>
            <institution>Deutsche Forschungsgemeinschaft</institution>
          </institution-wrap>
        </funding-source>
        <award-id>EXC 1003-194347757</award-id>
        <principal-award-recipient>
          <name>
            <surname>Westhoff</surname>
            <given-names>Andreas</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001659</institution-id>
            <institution>Deutsche Forschungsgemeinschaft</institution>
          </institution-wrap>
        </funding-source>
        <award-id>EXC 2044-390685587</award-id>
        <principal-award-recipient>
          <name>
            <surname>Engwer</surname>
            <given-names>Christian</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100002341</institution-id>
            <institution>Academy of Finland</institution>
          </institution-wrap>
        </funding-source>
        <award-id>336792</award-id>
        <principal-award-recipient>
          <name>
            <surname>Pursiainen</surname>
            <given-names>Sampsa</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award005">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001659</institution-id>
            <institution>Deutsche Forschungsgemeinschaft</institution>
          </institution-wrap>
        </funding-source>
        <award-id>WO1425/7-1</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2402-5275</contrib-id>
          <name>
            <surname>Schrader</surname>
            <given-names>Sophie</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award006">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001659</institution-id>
            <institution>Deutsche Forschungsgemeinschaft</institution>
          </institution-wrap>
        </funding-source>
        <award-id>WO1425/7-1</award-id>
        <principal-award-recipient>
          <name>
            <surname>Wolters</surname>
            <given-names>Carsten H.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award007">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001659</institution-id>
            <institution>Deutsche Forschungsgemeinschaft</institution>
          </institution-wrap>
        </funding-source>
        <award-id>WO1425/5-2</award-id>
        <principal-award-recipient>
          <name>
            <surname>Wolters</surname>
            <given-names>Carsten H.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award008">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100007601</institution-id>
            <institution>Horizon 2020</institution>
          </institution-wrap>
        </funding-source>
        <award-id>641652,</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8339-0355</contrib-id>
          <name>
            <surname>Piastra</surname>
            <given-names>Maria Carla</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award009">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100007601</institution-id>
            <institution>Horizon 2020</institution>
          </institution-wrap>
        </funding-source>
        <award-id>641652,</award-id>
        <principal-award-recipient>
          <name>
            <surname>Wolters</surname>
            <given-names>Carsten H.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award010">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100002341</institution-id>
            <institution>Academy of Finland</institution>
          </institution-wrap>
        </funding-source>
        <award-id>305055</award-id>
        <principal-award-recipient>
          <name>
            <surname>Pursiainen</surname>
            <given-names>Sampsa</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award011">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100002341</institution-id>
            <institution>Academy of Finland</institution>
          </institution-wrap>
        </funding-source>
        <award-id>305055</award-id>
        <principal-award-recipient>
          <name>
            <surname>Miinalainen</surname>
            <given-names>Tuuli</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award012">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100002341</institution-id>
            <institution>Academy of Finland</institution>
          </institution-wrap>
        </funding-source>
        <award-id>334465</award-id>
        <principal-award-recipient>
          <name>
            <surname>Pursiainen</surname>
            <given-names>Sampsa</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award013">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100002341</institution-id>
            <institution>Academy of Finland</institution>
          </institution-wrap>
        </funding-source>
        <award-id>326668</award-id>
        <principal-award-recipient>
          <name>
            <surname>Pursiainen</surname>
            <given-names>Sampsa</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award014">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100002341</institution-id>
            <institution>Academy of Finland</institution>
          </institution-wrap>
        </funding-source>
        <award-id>344712</award-id>
        <principal-award-recipient>
          <name>
            <surname>Pursiainen</surname>
            <given-names>Sampsa</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award015">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001655</institution-id>
            <institution>Deutscher Akademischer Austauschdienst</institution>
          </institution-wrap>
        </funding-source>
        <award-id>57405052</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2402-5275</contrib-id>
          <name>
            <surname>Schrader</surname>
            <given-names>Sophie</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award016">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001655</institution-id>
            <institution>Deutscher Akademischer Austauschdienst</institution>
          </institution-wrap>
        </funding-source>
        <award-id>57405052</award-id>
        <principal-award-recipient>
          <name>
            <surname>Wolters</surname>
            <given-names>Carsten H.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award017">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100002341</institution-id>
            <institution>Academy of Finland</institution>
          </institution-wrap>
        </funding-source>
        <award-id>317165</award-id>
        <principal-award-recipient>
          <name>
            <surname>Pursiainen</surname>
            <given-names>Sampsa</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award018">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001655</institution-id>
            <institution>Deutscher Akademischer Austauschdienst</institution>
          </institution-wrap>
        </funding-source>
        <award-id>57523877</award-id>
        <principal-award-recipient>
          <name>
            <surname>Wolters</surname>
            <given-names>Carsten H.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award019">
        <funding-source>
          <institution>Austrian Wissenschaftsfonds (FWF)</institution>
        </funding-source>
        <award-id>project I 3790-B27 (https://www.fwf.ac.at/en)</award-id>
        <principal-award-recipient>
          <name>
            <surname>Vorwerk</surname>
            <given-names>Johannes</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>A.W. and C.E. were funded by the DFG (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.dfg.de/en" ext-link-type="uri">https://www.dfg.de/en</ext-link>) through the Cluster of Excellence “Cells in Motion” (EXC 1003-194347757), and C.E. additionally by the Cluster of Excellence “Mathematics Münster: Dynamics - Geometry - Structure” (EXC 2044-390685587). S.S. and C.H.W. were supported by the DFG through project WO1425/7-1 and C.H.W. additionally by the DFG priority program SPP1665, project WO1425/5-2. M.C.P. and C.H.W. were supported by EU project ChildBrain (Marie Curie Innovative Training Networks, grant agreement 641652, <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.childbrain.eu" ext-link-type="uri">http://www.childbrain.eu</ext-link>). S.P. and T.M. were supported by the Academy of Finland (AoF) key project (305055), T.M. by the tenure track funding by Tampere University, and S.P. by the Centre of Excellence in Inverse Modelling and Imaging (AoF 336792), bilateral (Münster-Tampere) mobility funding (AoF 326668), and ERA-NET PerMed project PerEpi (AoF 344712), see <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.aka.fi/en/" ext-link-type="uri">https://www.aka.fi/en/</ext-link>. S.S., C.H.W. and S.P. were additionally supported by a bilateral (Münster-Tampere) researcher exhange project by DAAD (57405052) and AoF (317165) and C.H.W. and S.P. by its successor by DAAD (57523877) and AoF (334465), see <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.daad.de/en" ext-link-type="uri">https://www.daad.de/en</ext-link> and <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.aka.fi/en" ext-link-type="uri">https://www.aka.fi/en</ext-link>. J.V. was supported by the Austrian Wissenschaftsfonds (FWF), project I 3790-B27 (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.fwf.ac.at/en" ext-link-type="uri">https://www.fwf.ac.at/en</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="6"/>
      <table-count count="2"/>
      <page-count count="21"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All relevant data are either within the paper and its <xref rid="sec014" ref-type="sec">Supporting information</xref> files or available from the zenodo database (DOI: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://doi.org/10.5281/zenodo.3888381" ext-link-type="uri">10.5281/zenodo.3888381</ext-link>).</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All relevant data are either within the paper and its <xref rid="sec014" ref-type="sec">Supporting information</xref> files or available from the zenodo database (DOI: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://doi.org/10.5281/zenodo.3888381" ext-link-type="uri">10.5281/zenodo.3888381</ext-link>).</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>We present <italic toggle="yes">DUNEuro</italic>, an open-source software toolbox for the numerical computation of forward solutions in bioelectromagnetism. Its main focus is to provide an extendable and easy-to-use framework for using various finite element method (FEM) implementations for different neuroscientific applications, such as the electroencephalography (EEG) or magnetoencephalography (MEG) forward problems [<xref rid="pone.0252431.ref001" ref-type="bibr">1</xref>–<xref rid="pone.0252431.ref003" ref-type="bibr">3</xref>].</p>
    <p>Forward solutions are a crucial component for accurate EEG and MEG source analysis results. Various methods for these computations have been suggested besides the finite element method (FEM), e.g., the boundary element method (BEM) [<xref rid="pone.0252431.ref004" ref-type="bibr">4</xref>–<xref rid="pone.0252431.ref006" ref-type="bibr">6</xref>], the finite volume method (FVM) [<xref rid="pone.0252431.ref007" ref-type="bibr">7</xref>] and the finite difference method (FDM) [<xref rid="pone.0252431.ref008" ref-type="bibr">8</xref>–<xref rid="pone.0252431.ref010" ref-type="bibr">10</xref>]. Our software focuses on FEM discretizations, which are able to cope with anisotropic tissue as well as complex geometries and have been widely used in EEG/MEG forward and inverse analysis [<xref rid="pone.0252431.ref011" ref-type="bibr">11</xref>–<xref rid="pone.0252431.ref014" ref-type="bibr">14</xref>]. Besides the standard Lagrangian Continuous Galerkin (CG-)FEM, modern FEM variants include the Discontinuous Galerkin method (DG-FEM) and the Unfitted Discontinuous Galerkin method (UDG-FEM). DG-FEM shows higher accuracies in low-resolution scenarios in which a thin skull layer may produce physically inaccurate discretizations [<xref rid="pone.0252431.ref015" ref-type="bibr">15</xref>, <xref rid="pone.0252431.ref016" ref-type="bibr">16</xref>]. UDG-FEM does not require the generation of volumetric meshes but relies on an implicit description of the tissue layers via level-sets [<xref rid="pone.0252431.ref017" ref-type="bibr">17</xref>, <xref rid="pone.0252431.ref018" ref-type="bibr">18</xref>]. In addition to FEM discretizations, there are various approaches to numerically treat the singular source term in the EEG forward problem. The approaches currently supported by DUNEuro include the St. Venant, the partial integration, the Whitney and the subtraction source models [<xref rid="pone.0252431.ref015" ref-type="bibr">15</xref>–<xref rid="pone.0252431.ref020" ref-type="bibr">20</xref>]. While the above-mentioned publications use DUNEuro for numerical calculations, their focus lies on mathematical derivations, studies on numerical convergence to the (quasi-)analytical solutions in spherical head volume conductor models as well as comparisons to existing methods such as CG-FEM. Based on these findings, this paper is intended to focus on the underlying software-related aspects in order to make the presented methods more accessible to the neuroscience community.</p>
    <p>The goal of DUNEuro is to provide an open-source software toolbox offering sophisticated FEM discretizations as well as various source modeling approaches with convenient features for users as well as developers. From a user perspective, it is important that the toolbox is accessible and easy to use. Therefore, the interface of DUNEuro is designed in a way that different methods, such as discretization schemes, can be easily exchanged by passing different parameters as input. Additionally, DUNEuro provides interfaces to Python and MATLAB so that the user is not exposed to the high complexity of a C++ finite element code and the forward solutions can easily be embedded in an already existing analysis pipeline. As input, DUNEuro requires a head volume conductor model, sensor characteristics (sensor locations and for MEG additionally the direction in which the magnetic field is measured), as well as a set of dipole locations and moments, i.e., the source space. As output, DUNEuro provides accurate forward solutions for different applications like source analysis or the optimization of sensor configurations in brain stimulation. From a developer point of view, the DUNEuro toolbox is easily extendable. Different finite element methods share several subcomponents, such as the representation of the computational domain or the solver of the linear system. To facilitate the implementation of different discretization schemes or the extension of already existing approaches, DUNEuro is therefore designed to bundle different implementations and enable code reuse. Although DUNEuro currently supports only EEG and MEG forward solutions, transcranial electric and magnetic stimulations (TES/TMS), which are mathematically closely related due to Helmholtz reciprocity [<xref rid="pone.0252431.ref021" ref-type="bibr">21</xref>–<xref rid="pone.0252431.ref023" ref-type="bibr">23</xref>], are currently being integrated. Additionally, our toolbox makes use of components and benefits from existing maintenance and testing infrastructure as a module of the large DUNE framework, as described in more detail below.</p>
    <p>In order to perform analysis of EEG or MEG data, different open-source software packages offer tools to implement a complete processing pipeline such as the MATLAB-based toolboxes FieldTrip [<xref rid="pone.0252431.ref024" ref-type="bibr">24</xref>], Brainstorm [<xref rid="pone.0252431.ref025" ref-type="bibr">25</xref>] and Zeffiro [<xref rid="pone.0252431.ref026" ref-type="bibr">26</xref>], the Python-based toolboxes MNE-Python [<xref rid="pone.0252431.ref027" ref-type="bibr">27</xref>], FEMfuns [<xref rid="pone.0252431.ref028" ref-type="bibr">28</xref>] or the C++ code MNE [<xref rid="pone.0252431.ref029" ref-type="bibr">29</xref>]. The toolbox SimBio (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.mrt.uni-jena.de/simbio" ext-link-type="uri">https://www.mrt.uni-jena.de/simbio</ext-link>) offers a broad range for forward and inverse methods for EEG and MEG analysis. Recently, the EEG FEM forward modeling using the St. Venant source model has been integrated into FieldTrip [<xref rid="pone.0252431.ref030" ref-type="bibr">30</xref>]. With respect to the finite element method, only first-order Lagrangian elements are fully implemented in SimBio. Due to its structure, extending the code to support different discretization schemes would be error-prone and time-consuming. In addition, there are well-tested and established general purpose software toolboxes for finite element computations.</p>
    <p>One existing library for finite element computations is DUNE, the <italic toggle="yes">Distributed and Unified Numerics Environment</italic> (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.dune-project.org" ext-link-type="uri">http://www.dune-project.org</ext-link>). More precisely, it is a general purpose open-source C++ library for solving partial differential equations using mesh-based methods [<xref rid="pone.0252431.ref031" ref-type="bibr">31</xref>]. It is extendable by offering a modular structure and providing abstract interfaces and separation between data structures and algorithms. Due to the modular structure, a user of DUNE only has to use those modules that are needed for a specific computation. At the core of the DUNE library is an abstract definition of a grid interface [<xref rid="pone.0252431.ref032" ref-type="bibr">32</xref>, <xref rid="pone.0252431.ref033" ref-type="bibr">33</xref>]. Using the abstract interface allows writing reusable code that is independent of the concrete implementation of the grid or the type of the grids elements. This way, the identical code can be used in multiple spatial dimensions and for tetrahedral, hexahedral or other element types. DUNEuro builds upon several existing DUNE modules such as the <monospace>dune-uggrid</monospace> module [<xref rid="pone.0252431.ref034" ref-type="bibr">34</xref>] and the <monospace>dune-pdelab</monospace> module [<xref rid="pone.0252431.ref035" ref-type="bibr">35</xref>].</p>
    <p>Currently, the DUNEuro toolbox is developed and used on Linux operating systems. The software is made available under the GPL open-source license and can be downloaded from the GitLab repository (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://gitlab.dune-project.org/duneuro" ext-link-type="uri">https://gitlab.dune-project.org/duneuro</ext-link>), which is also linked from the DUNEuro homepage (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.duneuro.org" ext-link-type="uri">http://www.duneuro.org</ext-link>), see also <xref rid="pone.0252431.s001" ref-type="supplementary-material">S1 Appendix</xref> for detailed installation instructions. The GitLab repository also contains a Wiki (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://gitlab.dune-project.org/duneuro/duneuro/-/wikis" ext-link-type="uri">https://gitlab.dune-project.org/duneuro/duneuro/-/wikis</ext-link>) with detailed documentation of the user interface including a description of parameters for using different FEM and source models.</p>
    <p>In the following, we first give a short summary on the background of solving the EEG and MEG forward problems with finite element methods. This is followed by a general description of the structure and design of the toolbox, its use of existing frameworks for solving partial differential equations and its main concepts of different interfaces used within the library. Afterwards, we will describe a method for localizing elements within a tessellation based on a global coordinate. The interaction of a user with DUNEuro is done through bindings with a scripting language, which will be presented in the following section. Subsequently, we demonstrate how DUNEuro can be embedded in a complete analysis pipeline by calculating forward solutions which are then used for source analysis on EEG data obtained from a somatosensory experiment. Finally, a short summary and outlook is given. For detailed installation instructions of the DUNEuro toolbox, see <xref rid="pone.0252431.s001" ref-type="supplementary-material">S1 Appendix</xref>. In <xref rid="pone.0252431.s002" ref-type="supplementary-material">S2 Appendix</xref>, several example data sets and scripts in Python and MATLAB are provided and explained in detail.</p>
  </sec>
  <sec sec-type="intro" id="sec002">
    <title>Background</title>
    <p>In this section we present the background for solving the EEG and MEG forward problems with finite element methods.</p>
    <sec id="sec003">
      <title>The EEG forward problem</title>
      <p>The aim of the EEG forward problem is to compute the electric potential <italic toggle="yes">u</italic> in the head domain <inline-formula id="pone.0252431.e001"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.e001.jpg" id="pone.0252431.e001g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" display="inline" overflow="scroll"><mml:mrow><mml:mo>Ω</mml:mo><mml:mo>⊂</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> [<xref rid="pone.0252431.ref001" ref-type="bibr">1</xref>–<xref rid="pone.0252431.ref003" ref-type="bibr">3</xref>]. It can be formulated using Poisson’s equation:
<disp-formula id="pone.0252431.e002"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.e002.jpg" id="pone.0252431.e002g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>∇</mml:mo><mml:mo>⋅</mml:mo><mml:mi>σ</mml:mi><mml:mo>∇</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>∇</mml:mo><mml:mo>⋅</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>in</mml:mtext><mml:mspace width="4pt"/><mml:mo>Ω</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:mi>σ</mml:mi><mml:mo>∇</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mspace width="2pt"/><mml:mi>n</mml:mi></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>on</mml:mtext><mml:mspace width="4pt"/><mml:mo>∂</mml:mo><mml:mo>Ω</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula>
where <inline-formula id="pone.0252431.e003"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.e003.jpg" id="pone.0252431.e003g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" display="inline" overflow="scroll"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>:</mml:mo><mml:mo>Ω</mml:mo><mml:mo>↦</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> denotes the symmetric and positive definite conductivity tensor, <italic toggle="yes">j</italic><sup><italic toggle="yes">p</italic></sup> denotes the primary current density and <italic toggle="yes">n</italic> denotes the unit outer normal on the head surface ∂Ω. The current source is usually modeled as a current dipole at a position <italic toggle="yes">x</italic><sub>dp</sub> ∈ Ω with the dipole moment <inline-formula id="pone.0252431.e004"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.e004.jpg" id="pone.0252431.e004g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" display="inline" overflow="scroll"><mml:mrow><mml:mi>q</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. With the use of the delta distribution <inline-formula id="pone.0252431.e005"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.e005.jpg" id="pone.0252431.e005g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" display="inline" overflow="scroll"><mml:msub><mml:mi>δ</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mtext>dp</mml:mtext></mml:msub></mml:msub></mml:math></alternatives></inline-formula> centered at <italic toggle="yes">x</italic><sub>dp</sub>, the current dipole leads to the source term
<disp-formula id="pone.0252431.e006"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.e006.jpg" id="pone.0252431.e006g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>∇</mml:mo><mml:mo>·</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:mo>·</mml:mo><mml:mo>∇</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mtext>dp</mml:mtext></mml:msub></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
    </sec>
    <sec id="sec004">
      <title>Finite element methods for the EEG forward problem</title>
      <p>Several finite element methods have been proposed to solve the EEG forward problem. A common basis for these methods is the tesselation of the head domain Ω. The domain is partitioned into a set of elements of simple shape, such as tetrahedrons or hexahedrons. Depending on the concrete method, certain regularity assumptions are imposed on the tesselation, such as not containing hanging nodes. For details on the precise definition of a tesselation we refer to [<xref rid="pone.0252431.ref036" ref-type="bibr">36</xref>]. In the following, we will denote a tesselation of Ω by <inline-formula id="pone.0252431.e007"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.e007.jpg" id="pone.0252431.e007g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mo>Ω</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Here, <inline-formula id="pone.0252431.e008"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.e008.jpg" id="pone.0252431.e008g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" display="inline" overflow="scroll"><mml:mrow><mml:mi>h</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> denotes the maximal diameter of a mesh element.</p>
      <p>Instead of searching for a solution in the infinite-dimensional function space in which the EEG forward problem 1 is posed, the finite element method relies on the construction of a finite-dimensional subspace in which the problem is discretized. Therefore, the potential <italic toggle="yes">u</italic> in <xref rid="pone.0252431.e002" ref-type="disp-formula">1</xref> is approximated by a discrete representation denoted <italic toggle="yes">u</italic><sub><italic toggle="yes">h</italic></sub>, which is defined on <inline-formula id="pone.0252431.e009"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.e009.jpg" id="pone.0252431.e009g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mo>Ω</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. One main difference between several finite element methods is the choice of this discrete representation <italic toggle="yes">u</italic><sub><italic toggle="yes">h</italic></sub> for the potential and the formulation of the discrete representation of Poisson’s equation. We will not present the mathematical rigorous definition of the different methods but refer to the respective publications that introduced the methods for solving the EEG forward problem. The conforming finite element method using Lagrangian elements represents the potential as a continuous, piecewise polynomial function [<xref rid="pone.0252431.ref012" ref-type="bibr">12</xref>–<xref rid="pone.0252431.ref014" ref-type="bibr">14</xref>, <xref rid="pone.0252431.ref037" ref-type="bibr">37</xref>–<xref rid="pone.0252431.ref045" ref-type="bibr">45</xref>]. For the discretization of the equation, the classical weak formulation is used directly. In contrast, the discontinuous Galerkin method does not enforce the continuity of the potential in its function definition but instead incorporates the continuity weakly through the use of a modified weak formulation [<xref rid="pone.0252431.ref015" ref-type="bibr">15</xref>]. Using this approach, the solution gains continuity of fluxes on the discrete level. Another approach, although currently not yet supported in DUNEuro, is the mixed finite element method (Mixed-FEM). To obtain the Mixed-FEM formulation, additional unknown variables are introduced, in the case of the EEG forward problem the electric current <italic toggle="yes">j</italic>. Thereby, the second-order Poisson <xref rid="pone.0252431.e002" ref-type="disp-formula">Eq 1</xref> is transformed into a system of first-order equations with both the electric potential <italic toggle="yes">u</italic> and the electric current <italic toggle="yes">j</italic> as unknowns. As a consequence of this discretization, the Mixed-FEM is current preserving, in contrast to the CG-FEM. A theoretical derivation of the Mixed-FEM approach for EEG forward simulations is provided in [<xref rid="pone.0252431.ref046" ref-type="bibr">46</xref>].</p>
      <p>The finite element methods described above have in common that they use a tesselation which resolves the computational domain Ω. Recently, two finite element methods have been introduced for solving the EEG forward problem that instead use a tesselation of an auxiliary domain <inline-formula id="pone.0252431.e010"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.e010.jpg" id="pone.0252431.e010g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mo>Ω</mml:mo><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> which is independent of Ω. The conformity of the solution to the domain Ω is incorporated weakly by modifying the discrete weak formulation. The CutFEM method uses a function representation that is continuous on each isotropically homogenized tissue compartment [<xref rid="pone.0252431.ref018" ref-type="bibr">18</xref>, <xref rid="pone.0252431.ref047" ref-type="bibr">47</xref>]. The unfitted discontinuous Galerkin method additionally transfers the continuity constraint within each subdomain to the weak formulation [<xref rid="pone.0252431.ref017" ref-type="bibr">17</xref>, <xref rid="pone.0252431.ref048" ref-type="bibr">48</xref>].</p>
      <p>Due to the difference in representing the discrete function and the different properties of these representations, different strategies for discretizing the dipolar source term have to be taken into account. In general, it is unclear how to evaluate the derivative of the delta distribution in <xref rid="pone.0252431.e002" ref-type="disp-formula">1</xref>. Several different approaches for the various finite element methods have been proposed in the literature to handle this singularity. For the conforming finite element methods, the partial integration approach [<xref rid="pone.0252431.ref014" ref-type="bibr">14</xref>, <xref rid="pone.0252431.ref049" ref-type="bibr">49</xref>], the St. Venant approach [<xref rid="pone.0252431.ref011" ref-type="bibr">11</xref>, <xref rid="pone.0252431.ref038" ref-type="bibr">38</xref>, <xref rid="pone.0252431.ref050" ref-type="bibr">50</xref>, <xref rid="pone.0252431.ref051" ref-type="bibr">51</xref>], the full and projected subtraction approach [<xref rid="pone.0252431.ref003" ref-type="bibr">3</xref>, <xref rid="pone.0252431.ref040" ref-type="bibr">40</xref>, <xref rid="pone.0252431.ref041" ref-type="bibr">41</xref>, <xref rid="pone.0252431.ref052" ref-type="bibr">52</xref>] and the Whitney approach [<xref rid="pone.0252431.ref020" ref-type="bibr">20</xref>, <xref rid="pone.0252431.ref039" ref-type="bibr">39</xref>, <xref rid="pone.0252431.ref053" ref-type="bibr">53</xref>–<xref rid="pone.0252431.ref055" ref-type="bibr">55</xref>] have been introduced. Similar approaches have been presented for the discontinuous Galerkin method, however their exact formulations differ, due to the different discretization approach. These approaches are the partial integration approach [<xref rid="pone.0252431.ref056" ref-type="bibr">56</xref>], the St. Venant approach [<xref rid="pone.0252431.ref018" ref-type="bibr">18</xref>] and the full and localized subtraction approach [<xref rid="pone.0252431.ref015" ref-type="bibr">15</xref>, <xref rid="pone.0252431.ref018" ref-type="bibr">18</xref>]. For the unfitted finite element methods both the partial integration approach and different variants of the St. Venant approach have been adopted [<xref rid="pone.0252431.ref017" ref-type="bibr">17</xref>, <xref rid="pone.0252431.ref018" ref-type="bibr">18</xref>].</p>
      <p>A list of source models currently supported by DUNEuro for different FEM discretizations is provided in <xref rid="pone.0252431.t001" ref-type="table">Table 1</xref>.</p>
      <table-wrap position="float" id="pone.0252431.t001">
        <object-id pub-id-type="doi">10.1371/journal.pone.0252431.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Overview of source models currently supported for EEG/MEG by DUNEuro for different FEM discretization schemes.</title>
        </caption>
        <alternatives>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.t001" id="pone.0252431.t001g" position="float"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" colspan="2" rowspan="2"/>
                <th align="center" colspan="4" rowspan="1">Source models</th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1">Partial integration [<xref rid="pone.0252431.ref054" ref-type="bibr">54</xref>]</th>
                <th align="center" rowspan="1" colspan="1">St. Venant [<xref rid="pone.0252431.ref054" ref-type="bibr">54</xref>]</th>
                <th align="center" rowspan="1" colspan="1">Subtraction [<xref rid="pone.0252431.ref003" ref-type="bibr">3</xref>, <xref rid="pone.0252431.ref052" ref-type="bibr">52</xref>]</th>
                <th align="center" rowspan="1" colspan="1">Whitney <xref rid="t001fn001" ref-type="table-fn"><sup>1</sup></xref> [<xref rid="pone.0252431.ref020" ref-type="bibr">20</xref>]</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="3" colspan="1">
                  <bold>FEM</bold>
                </td>
                <td align="center" rowspan="1" colspan="1"><bold>CG</bold> [<xref rid="pone.0252431.ref011" ref-type="bibr">11</xref>]</td>
                <td align="left" rowspan="1" colspan="1">EEG/MEG</td>
                <td align="left" rowspan="1" colspan="1">EEG/MEG</td>
                <td align="left" rowspan="1" colspan="1">EEG/MEG</td>
                <td align="left" rowspan="1" colspan="1">EEG/MEG</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1"><bold>DG</bold> [<xref rid="pone.0252431.ref015" ref-type="bibr">15</xref>, <xref rid="pone.0252431.ref016" ref-type="bibr">16</xref>]</td>
                <td align="left" rowspan="1" colspan="1">EEG/MEG<xref rid="t001fn002" ref-type="table-fn"><sup>2</sup></xref></td>
                <td align="left" rowspan="1" colspan="1">-</td>
                <td align="left" rowspan="1" colspan="1">EEG/MEG<xref rid="t001fn002" ref-type="table-fn"><sup>2</sup></xref></td>
                <td align="left" rowspan="1" colspan="1">-</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1"><bold>UDG</bold> [<xref rid="pone.0252431.ref017" ref-type="bibr">17</xref>]</td>
                <td align="left" rowspan="1" colspan="1">EEG</td>
                <td align="left" rowspan="1" colspan="1">-</td>
                <td align="left" rowspan="1" colspan="1">EEG</td>
                <td align="left" rowspan="1" colspan="1">-</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t001fn001">
            <p><sup><bold>1</bold></sup> The Whitney source model is currently only implemented for tetrahedral meshes.</p>
          </fn>
          <fn id="t001fn002">
            <p><sup><bold>2</bold></sup> In the MEG implementation, the numerical flux for the secondary magnetic field for DG-FEM is currently only implemented for hexahedral meshes.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>In general, source models can be divided into direct and indirect approaches. Direct source models include the partial integration, St. Venant and Whitney approaches. Their idea is to approximate the dipolar source term of the EEG forward problem by a monopole distribution in the vicinity of the source location, see [<xref rid="pone.0252431.ref020" ref-type="bibr">20</xref>, <xref rid="pone.0252431.ref038" ref-type="bibr">38</xref>, <xref rid="pone.0252431.ref054" ref-type="bibr">54</xref>]. The subtraction source model adopts a different approach and deals with the singular source term indirectly. It relies on the assumption that there exists a small area around the source location where the conductivity is constant, denoted by <italic toggle="yes">σ</italic><sub>∞</sub>. The potential and the conductivity can then be split into two contributions, a singularity contribution and a correction part: <italic toggle="yes">u</italic> = <italic toggle="yes">u</italic><sub>∞</sub> + <italic toggle="yes">u</italic><sub><italic toggle="yes">corr</italic></sub>, and <italic toggle="yes">σ</italic> = <italic toggle="yes">σ</italic><sub>∞</sub> + <italic toggle="yes">σ</italic><sub><italic toggle="yes">corr</italic></sub>. While <italic toggle="yes">u</italic><sub>∞</sub> can be computed analytically, the insertion of the above decomposition into the EEG forward problem results in a Poisson equation for the correction potential. This equation can be solved numerically to compute <italic toggle="yes">u</italic><sub><italic toggle="yes">corr</italic></sub> which can then be added to <italic toggle="yes">u</italic><sub>∞</sub> for the complete potential, see [<xref rid="pone.0252431.ref003" ref-type="bibr">3</xref>, <xref rid="pone.0252431.ref052" ref-type="bibr">52</xref>].</p>
      <p>The discretization of the EEG forward problem using FEM leads to a system <italic toggle="yes">Ax</italic> = <italic toggle="yes">b</italic> to be solved for <inline-formula id="pone.0252431.e011"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.e011.jpg" id="pone.0252431.e011g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" display="inline" overflow="scroll"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pone.0252431.e012"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.e012.jpg" id="pone.0252431.e012g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" display="inline" overflow="scroll"><mml:mrow><mml:mi>A</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> denotes the <italic toggle="yes">stiffness matrix</italic>. The right-hand side vector <inline-formula id="pone.0252431.e013"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.e013.jpg" id="pone.0252431.e013g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" display="inline" overflow="scroll"><mml:mrow><mml:mi>b</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> represents the source term and depends on the respective source modeling approach. In order to speed up the computation of the solution to the EEG forward problem, we first note that for the computation of a lead field matrix, it is not necessary to know the potential in the interior of the domain Ω, but only the evaluation at the sensor positions on the boundary. For a given source, this leads to a potential vector <inline-formula id="pone.0252431.e014"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.e014.jpg" id="pone.0252431.e014g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pone.0252431.e015"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.e015.jpg" id="pone.0252431.e015g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15" display="inline" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> denotes the number of sensors. Given a solution <inline-formula id="pone.0252431.e016"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.e016.jpg" id="pone.0252431.e016g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M16" display="inline" overflow="scroll"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, the evaluation can be represented by a linear map <inline-formula id="pone.0252431.e017"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.e017.jpg" id="pone.0252431.e017g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M17" display="inline" overflow="scroll"><mml:mrow><mml:mi>R</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> as <inline-formula id="pone.0252431.e018"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.e018.jpg" id="pone.0252431.e018g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M18" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. Inserting <italic toggle="yes">x</italic> = <italic toggle="yes">A</italic><sup>−1</sup><italic toggle="yes">b</italic> and defining <italic toggle="yes">T</italic> ≔ <italic toggle="yes">RA</italic><sup>−1</sup> results in <inline-formula id="pone.0252431.e019"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.e019.jpg" id="pone.0252431.e019g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M19" display="inline" overflow="scroll"><mml:mrow><mml:mi>T</mml:mi><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>. This means, once <italic toggle="yes">T</italic> is known, the EEG forward problem can be solved by computing the right-hand side vector <italic toggle="yes">b</italic> and performing a matrix-vector multiplication. The matrix <inline-formula id="pone.0252431.e020"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.e020.jpg" id="pone.0252431.e020g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M20" display="inline" overflow="scroll"><mml:mrow><mml:mi>T</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is called the (EEG) <italic toggle="yes">transfer matrix</italic>. By exploiting the symmetry of the discrete operator <italic toggle="yes">A</italic>, the transfer matrix can be computed row-wise by solving <italic toggle="yes">AT</italic><sup><italic toggle="yes">t</italic></sup> = <italic toggle="yes">R</italic><sup><italic toggle="yes">t</italic></sup> using the <italic toggle="yes">p</italic> rows of <italic toggle="yes">R</italic> as the right-hand sides. Thus, for the computation of the transfer matrix, the linear system has to be solved once for every sensor location [<xref rid="pone.0252431.ref012" ref-type="bibr">12</xref>, <xref rid="pone.0252431.ref014" ref-type="bibr">14</xref>, <xref rid="pone.0252431.ref057" ref-type="bibr">57</xref>].</p>
    </sec>
    <sec id="sec005">
      <title>MEG</title>
      <p>The solution of the MEG forward problem directly follows from the solution of the respective EEG forward problem via the law of Biot-Savart [<xref rid="pone.0252431.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0252431.ref058" ref-type="bibr">58</xref>]. For a current distribution <italic toggle="yes">j</italic>, the magnetic field B at a position <inline-formula id="pone.0252431.e021"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.e021.jpg" id="pone.0252431.e021g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M21" display="inline" overflow="scroll"><mml:mrow><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is computed via
<disp-formula id="pone.0252431.e022"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.e022.jpg" id="pone.0252431.e022g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M22" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>B</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>μ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mn>4</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mo>∫</mml:mo><mml:mo>Ω</mml:mo></mml:msub><mml:mi>j</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mo>‖</mml:mo><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo>‖</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:mfrac><mml:mtext>d</mml:mtext><mml:mi>x</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
where × denotes the three-dimensional cross product and <italic toggle="yes">μ</italic><sub>0</sub> the permeability of free space.</p>
      <p>By splitting the current distribution <italic toggle="yes">j</italic> into the primary current <italic toggle="yes">j</italic><sup><italic toggle="yes">p</italic></sup> and secondary current <italic toggle="yes">j</italic><sup><italic toggle="yes">s</italic></sup> = −<italic toggle="yes">σ</italic>∇<italic toggle="yes">u</italic>, the magnetic field B in <xref rid="pone.0252431.e022" ref-type="disp-formula">Eq (2)</xref> can be divided into the primary magnetic field <italic toggle="yes">B</italic><sup><italic toggle="yes">p</italic></sup> and the secondary magnetic field <italic toggle="yes">B</italic><sup><italic toggle="yes">s</italic></sup>. While there is an analytical expression for <italic toggle="yes">B</italic><sup><italic toggle="yes">p</italic></sup> [<xref rid="pone.0252431.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0252431.ref058" ref-type="bibr">58</xref>], in order to compute <italic toggle="yes">B</italic><sup><italic toggle="yes">s</italic></sup> the integral expression
<disp-formula id="pone.0252431.e023"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.e023.jpg" id="pone.0252431.e023g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M23" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mo>∫</mml:mo><mml:mo>Ω</mml:mo></mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∇</mml:mo><mml:mi>u</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mo>‖</mml:mo><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo>‖</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:mfrac><mml:mtext>d</mml:mtext><mml:mi>x</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
needs to be computed numerically. For the standard continuous Galerkin method (CG-FEM) this integral can be directly evaluated using the discrete representation of the potential <italic toggle="yes">u</italic><sub><italic toggle="yes">h</italic></sub>. Results for the MEG approach for the discontinuous Galerkin method (DG-FEM) in [<xref rid="pone.0252431.ref016" ref-type="bibr">16</xref>] indicate that a direct usage of <italic toggle="yes">σ</italic>∇<italic toggle="yes">u</italic><sub><italic toggle="yes">h</italic></sub> leads to suboptimal accuracies. Instead, the numerical flux of the discontinuous Galerkin method should be used, see [<xref rid="pone.0252431.ref016" ref-type="bibr">16</xref>, <xref rid="pone.0252431.ref019" ref-type="bibr">19</xref>]. Similarly to the EEG case, a transfer matrix can be derived which allows computing <italic toggle="yes">B</italic><sup><italic toggle="yes">s</italic></sup> at the sensors with a matrix-vector multiplication, instead of solving the EEG forward problem and computing the integral subsequently, see [<xref rid="pone.0252431.ref019" ref-type="bibr">19</xref>, <xref rid="pone.0252431.ref057" ref-type="bibr">57</xref>]. Note that when using the subtraction approach, the resulting solution does not include the contributions of the singularity potential [<xref rid="pone.0252431.ref016" ref-type="bibr">16</xref>].</p>
    </sec>
  </sec>
  <sec id="sec006">
    <title>Software structure and design</title>
    <p>DUNEuro relies on the DUNE software toolbox which offers functionality such as grid implementations, function space discretizations and solvers. In this section, the dependency of the DUNEuro toolbox on the DUNE modules is explained in more detail. In addition, core concepts of the internal structure of our software are presented. These include the so-called driver interface which is the core user interface for the MATLAB and Python bindings. Additionally, the implementations of different solvers and source models are explained. Besides presenting the software design of these subcomponents, examples are given to highlight the extendibility of our software by giving examples on how to implement new features. Subsequently, we will describe an algorithm for localizing elements within a tessellation based on a global coordinate.</p>
    <sec id="sec007">
      <title>DUNEuro and the DUNE framework</title>
      <p>DUNE is an open-source C++ toolbox providing various functionality related to the numeric solution of partial differential equations [<xref rid="pone.0252431.ref059" ref-type="bibr">59</xref>]. It comprises different modules that offer well-defined distinct features as a separate entity but may depend on each other. Each separate module can be downloaded and installed, the program <italic toggle="yes">dunecontrol</italic> manages this process and the module dependencies. A list of DUNE modules that DUNEuro depends on as well as a short description of their functionality is provided in <xref rid="pone.0252431.t002" ref-type="table">Table 2</xref>.</p>
      <table-wrap position="float" id="pone.0252431.t002">
        <object-id pub-id-type="doi">10.1371/journal.pone.0252431.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Overview of DUNE and DUNEuro modules.</title>
        </caption>
        <alternatives>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.t002" id="pone.0252431.t002g" position="float"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" style="border-bottom-width:thick" rowspan="1" colspan="1">Module</th>
                <th align="left" style="border-bottom-width:thick" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>dune-common</monospace>
                </td>
                <td align="left" rowspan="1" colspan="1">common infrastructure</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>dune-geometry</monospace>
                </td>
                <td align="left" rowspan="1" colspan="1">grid elements and quadrature</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>dune-istl</monospace>
                </td>
                <td align="left" rowspan="1" colspan="1">sparse linear algebra</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>dune-localfunctions</monospace>
                </td>
                <td align="left" rowspan="1" colspan="1">local finite element spaces</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>dune-grid</monospace>
                </td>
                <td align="left" rowspan="1" colspan="1">grid interface</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>dune-uggrid</monospace>
                </td>
                <td align="left" rowspan="1" colspan="1">unstructured grids</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>dune-typetree</monospace>
                </td>
                <td align="left" rowspan="1" colspan="1">tree data structures</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>dune-functions</monospace>
                </td>
                <td align="left" rowspan="1" colspan="1">functions and function space bases</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>dune-pdelab</monospace>
                </td>
                <td align="left" rowspan="1" colspan="1">finite element assemblers and solvers</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><monospace>dune-udg</monospace> (opt.)</td>
                <td align="left" rowspan="1" colspan="1">unfitted discretizations</td>
              </tr>
              <tr>
                <td align="left" style="border-bottom-width:thick" rowspan="1" colspan="1"><monospace>dune-tpmc</monospace> (opt.)</td>
                <td align="left" style="border-bottom-width:thick" rowspan="1" colspan="1">marching cubes/simplex algorithm</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>duneuro</monospace>
                </td>
                <td align="left" rowspan="1" colspan="1">discretization of bioelectromagnetic equations</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><monospace>duneuro-matlab</monospace> (opt.)</td>
                <td align="left" rowspan="1" colspan="1">MATLAB interface</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><monospace>duneuro-py</monospace> (opt.)</td>
                <td align="left" rowspan="1" colspan="1">Python interface</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t002fn001">
            <p>The description of the DUNE modules is based on [<xref rid="pone.0252431.ref059" ref-type="bibr">59</xref>], for further details, see also [<xref rid="pone.0252431.ref032" ref-type="bibr">32</xref>–<xref rid="pone.0252431.ref034" ref-type="bibr">34</xref>, <xref rid="pone.0252431.ref048" ref-type="bibr">48</xref>].</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>DUNEuro relies on several DUNE modules. The main functionality is provided by the core modules <monospace>dune-common</monospace>, <monospace>dune-geometry</monospace>, <monospace>dune-istl</monospace>, <monospace>dune-localfunctions</monospace> and <monospace>dune-grid</monospace>. For representing geometry-conforming tetrahedral and hexahedral meshes, we use the grid implementations provided by the <monospace>dune-uggrid</monospace> module [<xref rid="pone.0252431.ref034" ref-type="bibr">34</xref>]. The discretization of the partial differential equation makes use of the <monospace>dune-pdelab</monospace> module [<xref rid="pone.0252431.ref035" ref-type="bibr">35</xref>] that offers different discretization schemes along with appropriate finite elements allowing a rapid prototyping of new models. This module offers abstractions for the concept of a function space on a grid or for the linear operator used in the discretization. The implementation of the unfitted discontinuous Galerkin method is provided in the <monospace>dune-udg</monospace> module [<xref rid="pone.0252431.ref060" ref-type="bibr">60</xref>]. One component of the unfitted finite element methods is the integration over implicitly defined domains, which is performed using the C++ library tpmc (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://github.com/tpmc" ext-link-type="uri">http://github.com/tpmc</ext-link>). Both libraries, <monospace>dune-udg</monospace> and <monospace>dune-tpmc</monospace>, are optional in case unfitted methods are applied. For the MATLAB or Python bindings of DUNEuro, the respective modules <monospace>duneuro-matlab</monospace> and <monospace>duneuro-py</monospace> can be installed in addition to the <monospace>duneuro</monospace> module itself. The compiled libraries can then be used to integrate the functionality of DUNEuro in any Python or MATLAB pipeline. Detailed step-by-step instructions on how to download and install these modules are provided in <xref rid="pone.0252431.s001" ref-type="supplementary-material">S1 Appendix</xref>.</p>
    </sec>
    <sec id="sec008">
      <title>The EEG-MEG driver interface</title>
      <p>As described above, there are several different discretization schemes available for solving the EEG forward problem and each scheme provides different source models. The finite element methods presented here can be split into two different categories: the <italic toggle="yes">fitted</italic> and <italic toggle="yes">unfitted</italic> discretization methods. The fitted category refers to a discretization method that uses a grid whose geometry is fitted to the model geometry. The basis of this approach is a <monospace>VolumeConductor</monospace> class that stores the grid along with the conductivity tensor of each grid element. Currently, there are two different fitted discretization schemes implemented in DUNEuro: the conforming Galerkin (CG-FEM) and the discontinuous Galerkin (DG-FEM) finite element methods [<xref rid="pone.0252431.ref015" ref-type="bibr">15</xref>, <xref rid="pone.0252431.ref016" ref-type="bibr">16</xref>, <xref rid="pone.0252431.ref061" ref-type="bibr">61</xref>]. Methods that also fall into this category but are not yet available are mixed finite element methods [<xref rid="pone.0252431.ref046" ref-type="bibr">46</xref>] or finite volume schemes. The unfitted category refers to a discretization method that uses a grid which is independent of the model geometry and employs the model geometry weakly. The model geometry is provided implicitly via level-set functions and considered in the weak formulation. Currently, the unfitted discontinuous Galerkin (UDG) method is implemented as a discretization scheme in the unfitted category [<xref rid="pone.0252431.ref017" ref-type="bibr">17</xref>].</p>
      <p>From the user perspective of a software framework, it should be simple and intuitive to change from a fitted to an unfitted discretization or between different discretization schemes within each category. For example, switching from CG-FEM to DG-FEM should not require fundamental changes in the user code. A further consideration when designing the interface of the software is the way the user will interact with it. As described in more detail below, we want to provide bindings to programming languages a potential user is already familiar with, such as Python or MATLAB. In order to simplify both, the overall user interface and the process of creating such bindings, we define a single coarse grained interface class to interact with the internal toolbox. This interface class is called the <monospace>MEEGDriverInterface</monospace>. It describes the general concepts of solving EEG and MEG forward problems. Each of the two discretization categories is implemented by its own driver class, the <monospace>FittedMEEGDriver</monospace> and the <monospace>UnfittedMEEGDriver</monospace>, respectively. <xref rid="pone.0252431.g001" ref-type="fig">Fig 1</xref> shows a general diagram of the <monospace>MEEGDriverInterface</monospace>. For each category, the implementation of the discretization scheme is provided via two template parameters: a <monospace>Solver</monospace> and a <monospace>SourceModelFactory</monospace>. The purpose of the solver class is to bundle the handling of the stiffness matrix and the solution of the resulting linear system. The source model factory will construct source models whose purpose is the assembly of the right-hand side. Both the solver and the source model factory are further described below. The user of the toolbox will not directly interact with the implementation of the drivers, but only with the driver interface class.</p>
      <fig position="float" id="pone.0252431.g001">
        <object-id pub-id-type="doi">10.1371/journal.pone.0252431.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>DUNEuro driver interface diagram.</title>
          <p>Diagram showing the structure of the driver interface and its implementations. The <monospace>SourceModelFactory</monospace> is abbreviated as <monospace>SMF</monospace>.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.g001" position="float"/>
      </fig>
    </sec>
    <sec id="sec009">
      <title>The solver and the source model factory</title>
      <p>The purpose of the solver class is the assembly of the stiffness matrix and the solution of the linear system. It contains the discretization scheme as well as the necessary function spaces for representing discrete functions. The main interface method is a <monospace>solve</monospace> method which, given a right-hand side vector, solves Poisson’s equation and returns the discrete solution. Several forward problems in bioelectromagnetism, e.g., the EEG forward problem, electric [<xref rid="pone.0252431.ref023" ref-type="bibr">23</xref>, <xref rid="pone.0252431.ref062" ref-type="bibr">62</xref>] or magnetic stimulations [<xref rid="pone.0252431.ref063" ref-type="bibr">63</xref>, <xref rid="pone.0252431.ref064" ref-type="bibr">64</xref>] or the computation of a transfer matrix, mainly differ with respect to the right-hand side of the linear system. The solver class can thus be reused for any such purpose. By using a single solver class, the stiffness matrix has to be assembled only once and can be reused for further purposes. As the different discretization schemes differ in the way the matrix is stored, e.g., with respect to the blocking scheme of the matrix entries, this information is hidden from the interface. The purpose of the source model factory is to construct the different source models dynamically based on a configuration provided by the user. All source models provide a common interface which is described below.</p>
      <p>We will illustrate the extendibility with respect to the discretization scheme using the example of a mixed finite element method [<xref rid="pone.0252431.ref046" ref-type="bibr">46</xref>]. Mixed-FEM is based on a first-order representation of Poisson’s equation and employs unknowns for both the potential and the electric current. It derives a weak formulation and uses scalar and vector-valued finite elements on a geometry-conforming grid as a discretization. It thus falls into the category of fitted discretization schemes. In order to use the described <monospace>FittedMEEGDriver</monospace>, one needs to provide two components: a <monospace>MixedFEMSolver</monospace> and a <monospace>MixedFEMSourceModelFactory</monospace>. The <monospace>MixedFEMSolver</monospace> contains the discretization of the stiffness matrix as well as the definition to solve the resulting linear system. The implementation of such a solver class is heavily based on the <monospace>dune-pdelab</monospace> module which contains, for example, the implementations of the local basis functions. The <monospace>MixedFEMSourceModelFactory</monospace> offers a method to create different source models for the Mixed-FEM approach, whose purpose is then to assemble the right-hand side vector for a given source position. In [<xref rid="pone.0252431.ref046" ref-type="bibr">46</xref>], two different source models have been presented: a <italic toggle="yes">direct approach</italic> and a <italic toggle="yes">projected approach</italic>. Finally, one has to provide means to evaluate a discrete solution at electrode positions along with the resulting right-hand side of the transfer matrix approach. Once the above-mentioned software components related to the solver and source models for the Mixed-FEM approach are implemented, the features of the driver, e.g., computing a transfer matrix or solving the EEG forward problem, are available.</p>
      <p>The common task of source models can be stated as: given a dipole position and a dipole moment, assemble the right-hand side vector. This right-hand side vector will then be passed on to the respective solver class described above. As there is still research ongoing and new source models are being developed, it should be easy to provide an additional source model without substantial modifications of the existing code. In addition, it should be possible to choose the source model at runtime, both for investigating the effects of different source models as well as ruling out the source model as a source of errors. Some source models, such as the subtraction approach, do not provide a right-hand side for the full potential, but need to apply an additional post-processing step to the resulting solution in order to obtain the full potential. For the subtraction approach, this post-processing step consists of adding the singularity potential <italic toggle="yes">u</italic><sub>∞</sub> to the correction potential <italic toggle="yes">u</italic><sub><italic toggle="yes">corr</italic></sub>. As this post-processing step depends on the type of the source model and the user should have the option to turn off the post-processing, it is provided as a method of the source model interface. <xref rid="pone.0252431.g002" ref-type="fig">Fig 2</xref> shows a diagram of the general <monospace>SourceModelInterface</monospace> along with its implementations.</p>
      <fig position="float" id="pone.0252431.g002">
        <object-id pub-id-type="doi">10.1371/journal.pone.0252431.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>DUNEuro source model interface diagram.</title>
          <p>The structure of the source model interface and its implementations.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.g002" position="float"/>
      </fig>
      <p>When applying the transfer matrix, i.e., multiplying the transfer matrix <italic toggle="yes">T</italic> with the right-hand side vector <italic toggle="yes">b</italic>, the computational complexity depends on the number of non-zero entries in <italic toggle="yes">b</italic>. A main advantage of the direct source models such as the partial integration approach or the St. Venant approach is the sparsity of the right-hand side with only a few non-zero entries in <italic toggle="yes">b</italic>, typically independent of the mesh resolution. Indirect source models such as the subtraction approach, on the other hand, lead to a dense right-hand side vector. As a result, two different data types, i.e., sparse and dense vector containers are used to store the right-hand side vectors in order to reduce computation time for the direct approaches. In order to be able to handle both types for the right-hand side, the vector type is provided as a template parameter of the source model interface.</p>
      <p>We will illustrate the extendibility with respect to the source models on the example of a modified subtraction approach for CG-FEM. In [<xref rid="pone.0252431.ref018" ref-type="bibr">18</xref>], a modification of the subtraction approach has been presented: the <italic toggle="yes">localized subtraction approach</italic>. It restricts the contribution of the singularity part of the potential to a patch around the source location. As the functions within a DG-FEM discretization can be discontinuous, they can directly capture the jump occurring at the boundary of the patch. For a CG-FEM discretization, such jumps can not be directly resolved and thus the localization scheme has to be modified. Instead of using a restriction of the singularity contribution to the patch, one can multiply the singularity contribution with a function that linearly interpolates within an interface zone of the patch between the singularity potential and zero. A source model implementing this localized subtraction approach would provide a class fulfilling the source model interface. Within the <monospace>bind</monospace> method in <xref rid="pone.0252431.g002" ref-type="fig">Fig 2</xref>, the local patch would be created and the linear interpolation in the interface zone could be constructed. The implementation of the <monospace>assembleRightHandSide</monospace> method contains the integration of the different model terms, resulting in the right-hand side. The <monospace>postProcess</monospace> method adds the singularity potential to the correction potential on the local patch.</p>
    </sec>
    <sec id="sec010">
      <title>Element localization</title>
      <p>A common subtask when assembling the right-hand side for a given dipole is the localization of the mesh element containing the dipole. For a sparse source model, this is especially relevant, as the time of assembling the right-hand side is usually constant, once the dipole element has been found. The complexity of the right-hand side assembly thus strongly depends on the complexity of the method that is used for finding the dipole element. The most straightforward approach is given by a linear search among the mesh elements. Assuming an ordering of the mesh elements, we evaluate for each element of the mesh if it contains the dipole position. Once the result of the evaluation is positive, we return this element. This algorithm has an average and worst-case complexity of <inline-formula id="pone.0252431.e024"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.e024.jpg" id="pone.0252431.e024g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M24" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where <italic toggle="yes">n</italic><sub><italic toggle="yes">m</italic></sub> denotes the number of the mesh elements.</p>
      <p>A first step to speed up the localization can be found by using geometric information when iterating the mesh elements instead of using a fixed ordering [<xref rid="pone.0252431.ref065" ref-type="bibr">65</xref>]. The method presented here is called <italic toggle="yes">edge-hopping</italic>:
<list list-type="order"><list-item><p>Start at a given mesh element and iterate over all faces of the current element.</p></list-item><list-item><p>Compute the relative position of the dipole location and the hyperplane induced by the face center and its outer normal.</p></list-item><list-item><p>If the dipole lies in normal direction, continue the search at step 1 with the neighboring element if such an element exists.</p></list-item><list-item><p>If the face has no neighboring element, the dipole lies outside of the mesh or the mesh is not convex. Terminate the search.</p></list-item><list-item><p>If the dipole lies in the opposite direction, continue at step 2 with the evaluation of the next face.</p></list-item><list-item><p>If the dipole lies on the inside of all faces of the current element, the dipole element has been found.</p></list-item></list></p>
      <p>A requirement of the edge-hopping method is the convexity of the mesh, that is usually only fulfilled by the multi-layer sphere models, and not by the realistically shaped head models. However, as the algorithm monotonously moves closer to the dipole element, we only need convexity of the mesh in a sphere around the dipole location and the starting point of the iteration. As the considered sources lie in the gray matter compartment, that is completely enclosed by the skin, we can easily find such a sphere around the source locations if the starting location is close to the source position. In order to find an element that is close to the source location, we insert the element centers into a <italic toggle="yes">k-d Tree</italic>, that is a data structure to efficiently perform nearest-neighbor searches [<xref rid="pone.0252431.ref066" ref-type="bibr">66</xref>]. It does so by recursively splitting the set of element centers along the Cartesian directions. Even though the center of the element which is closest to the dipole location does not have to belong to the element containing the dipole, it can be assumed to be close to the desired element. It thus offers an efficient starting point for the edge-hopping algorithm.</p>
    </sec>
  </sec>
  <sec id="sec011">
    <title>Interface to scripting languages</title>
    <p>In this section we describe the interaction of a user with the DUNEuro library. In general, a common approach is to provide a compiled binary executable that the user is able to call directly. This executable would then load the data provided by the user from the hard disk, perform the desired computation and write the computed result back to the hard disk. As different users might want to perform different sets of computations, the computations to be performed can be configured by the user, either through command line parameters or through a configuration file. An advantage of this approach is its very simple and straightforward usage, similar to any other executable on the operating system. There is no need for additional packages or additional software and the executable can be used directly by the user. However, the computation of the solution to the forward problems is usually only a small part in a longer pipeline for source analysis. This pipeline usually consists of the data measurements and pre-processing steps and the forward solution is part of an inverse estimation process. When using the library directly in an executable, one has to provide methods for reading any input data as well as writing out the resulting output. Similarly, the configuration has to be transferred to the executable by the user. As a consequence, the functionality of DUNEuro is currently not provided as an executable.</p>
    <p>Instead, a different approach was adopted by offering bindings to scripting languages, i.e., MATLAB (The Math Works Inc., Natick, Massachusetts, United States; <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.mathworks.com" ext-link-type="uri">https://www.mathworks.com</ext-link>) and Python (Python Software Foundation, <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.python.org" ext-link-type="uri">https://www.python.org</ext-link>). For both languages there are already existing software frameworks for processing EEG and MEG data [<xref rid="pone.0252431.ref024" ref-type="bibr">24</xref>–<xref rid="pone.0252431.ref027" ref-type="bibr">27</xref>]. Thus, by providing direct bindings one can include the forward modeling approach directly into an existing analysis pipeline. An example for a similar integration is presented in [<xref rid="pone.0252431.ref030" ref-type="bibr">30</xref>], where the authors introduce a pipeline for performing EEG source analysis using the conforming finite element method together with the classical St. Venant source model. The forward models are implemented using the SimBio software (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.mrt.uni-jena.de/simbio" ext-link-type="uri">https://www.mrt.uni-jena.de/simbio</ext-link>) and integrated into the MATLAB-based FieldTrip-toolbox [<xref rid="pone.0252431.ref024" ref-type="bibr">24</xref>].</p>
    <p>DUNEuro builds upon several existing modules of the software toolbox DUNE and the core functionality is provided by the C++ module <monospace>duneuro</monospace>. Bindings to the MATLAB and Python scripting languages are provided in separate modules: <monospace>duneuro-py</monospace> and <monospace>duneuro-matlab</monospace>, respectively. A structural overview of DUNEuro and its interface modules with respect to DUNE, external software and downstream libraries is illustrated in <xref rid="pone.0252431.g003" ref-type="fig">Fig 3</xref>. The purpose of both modules is to translate the input data given as data structures in the respective programming language and translate them into the C++ counterparts. For some cases, this translation can be performed without copying any data, which is especially relevant for large matrices such as the transfer matrix. An example of the driver construction in a Python script is shown in Listing 1. The configuration of the discretization is provided as a Python dictionary. One possible option to define the head volume conductor model is via an input file for the mesh, e.g., using the gmsh file extension .msh (see <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://gmsh.info" ext-link-type="uri">https://gmsh.info</ext-link>) in combination with a plain text file containing the isotropic conductivity values. Alternatively, the mesh can also be provided directly by specifying the vertices, elements, tissue labels and conductivity tensors. An overview of different options and parameters to pass the volume conductor in case of fitted and unfitted FEM discretizations is provided in the GitLab Wiki. A detailed description of input and output parameters for the functionality provided by the driver interface is also provided. See also <xref rid="pone.0252431.s002" ref-type="supplementary-material">S2 Appendix</xref> for example data and scripts. Note that the discretization method, in this case <monospace>cg</monospace>, is provided as a parameter in the configuration. By changing it to <monospace>dg</monospace> and adding the necessary additional parameters such as the penalty parameter <italic toggle="yes">η</italic>, one can directly use the discontinuous Galerkin method through the same interface. Thus, once a user is able to use the DUNEuro library for any discretization method, a switch to a different discretization method can be directly performed. Listing 2 shows the same construction of the driver object as in Listing 1 using the MATLAB interface. The general structure of the MATLAB script is similar to the Python script. The main differences are the use of MATLAB syntax and the replacement of the Python dictionary by a MATLAB structure array. Even though the wrapper code for creating the driver object is different, both scripting languages interface the C++ library and use the same code base.</p>
    <fig position="float" id="pone.0252431.g003">
      <object-id pub-id-type="doi">10.1371/journal.pone.0252431.g003</object-id>
      <label>Fig 3</label>
      <caption>
        <title>Modular structure.</title>
        <p>Relation of the DUNEuro modules with respect to DUNE, external software and downstream libraries.</p>
      </caption>
      <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.g003" position="float"/>
    </fig>
    <p><bold>Listing 1</bold>. Example Python script for creating an <monospace>MEEGDriver</monospace>.</p>
    <p specific-use="line">import duneuropy as dp</p>
    <p specific-use="line">config = {</p>
    <p specific-use="line">‘type’: ‘fitted’,</p>
    <p specific-use="line">‘solver_type’: ‘cg’,</p>
    <p specific-use="line">‘element_type’: ‘tetrahedron’,</p>
    <p specific-use="line">‘volume_conductor’: {</p>
    <p specific-use="line">‘grid.filename’: ‘path/to/grid.msh’,</p>
    <p specific-use="line">‘tensors.filename’: ‘path/to/tensors.dat’</p>
    <p specific-use="line">}</p>
    <p specific-use="line">}</p>
    <p specific-use="line">driver = dp.MEEGDriver3d(config)</p>
    <p><bold>Listing 2</bold>. Example MATLAB script for creating an <monospace>MEEGDriver</monospace>.</p>
    <p specific-use="line">cfg = [];</p>
    <p specific-use="line">cfg.type = ‘fitted’;</p>
    <p specific-use="line">cfg.solver_type = ‘cg’;</p>
    <p specific-use="line">cfg.element_type = ‘tetrahedron’;</p>
    <p specific-use="line">cfg.volume_conductor.grid.filename = ‘path/to/grid.msh’;</p>
    <p specific-use="line">cfg.volume_conductor.tensors.filename = ‘path/to/tensors.dat’;</p>
    <p specific-use="line">driver = duneuro_meeg(cfg);</p>
  </sec>
  <sec id="sec012">
    <title>Example: Source analysis of somatosensory evoked potentials</title>
    <p>As a practical example how forward solutions (in this case UDG-FEM) computed with DUNEuro can be embedded in an entire source localization pipeline, we reconstruct the P20/N20 peak of somatosensory evoked potentials in the primary somatosensory cortex. A right-handed, 49 years old, male volunteer participated in a somatosensory evoked potential (SEP) EEG recording of an electric stimulation of the right median nerve, available from [<xref rid="pone.0252431.ref067" ref-type="bibr">67</xref>]. The participant had no history of psychiatric or neurological disorders and had given written informed consent before the experiment. All procedures had been approved by the ethics committee of the University of Erlangen, Faculty of Medicine on 10.05.2011 (Ref. No. 4453). The EEG was measured using 74 electrodes, whose positions where digitized using a Polhemus device (FASTRAK, Polhemus Incorporated, Colchester, Vermont, USA). The medianus stimulation was done in supine position in order to reduce modeling errors due to brain movement, because the corresponding MRI for head volume conductor modeling was also measured in supine position [<xref rid="pone.0252431.ref068" ref-type="bibr">68</xref>]. In total, 1200 stimuli were applied, the inter-stimulus interval was randomized in the range of 350 ms to 450 ms. The EEG data was preprocessed using FieldTrip [<xref rid="pone.0252431.ref024" ref-type="bibr">24</xref>] with a band-pass filter from 20 Hz to 250 Hz and notch-filters at 50 Hz and harmonics to reduce power-line noise. After removing one bad channel (P7) the remaining trials where averaged to produce the evoked potential data. <xref rid="pone.0252431.g004" ref-type="fig">Fig 4</xref> shows a butterfly plot of the resulting time series of the averaged potentials as well as a topography plot of the potential measured at the electrodes at the peak of the P20 component at the time point of 25.8 ms due to the time delay until the stimulus arrives at the median nerve. The first milliseconds show the stimulation artifact. At about 5.8 ms, the action potential is on the median nerve and starts traveling up to produce 20 ms later at 25.8 ms the P20 component.</p>
    <fig position="float" id="pone.0252431.g004">
      <object-id pub-id-type="doi">10.1371/journal.pone.0252431.g004</object-id>
      <label>Fig 4</label>
      <caption>
        <title>Practical application: Preprocessing.</title>
        <p>Left: Butterfly plot of the somatosensory evoked potentials. The vertical red line indicates the 25.8 ms time point. Right: topography plot of the averaged potential at the electrodes for <italic toggle="yes">t</italic> = 25.8 ms.</p>
      </caption>
      <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.g004" position="float"/>
    </fig>
    <p>Using a 3 T MRI scanner (Siemens Medical Solutions, Erlangen, Germany), T1-weighted and T2-weighted MRI sequences were measured. Based on these MR images, a six-compartment voxel segmentation has been constructed, distinguishing between skin, skull compacta, skull spongiosa, cerebrospinal fluid, gray matter and white matter using SPM12 (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.fil.ion.ucl.ac.uk/spm/software/spm12" ext-link-type="uri">http://www.fil.ion.ucl.ac.uk/spm/software/spm12</ext-link>) via FieldTrip [<xref rid="pone.0252431.ref024" ref-type="bibr">24</xref>], FSL [<xref rid="pone.0252431.ref069" ref-type="bibr">69</xref>] and internal MATLAB routines. We extracted surfaces from this voxel segmentation to distinguish between the different tissue compartments. To smooth the surfaces while maintaining the available information from the voxel segmentation, we applied an anti aliasing algorithm created for binary voxel images presented in [<xref rid="pone.0252431.ref070" ref-type="bibr">70</xref>]. The resulting smoothed surfaces are represented as level-set functions and are available from [<xref rid="pone.0252431.ref067" ref-type="bibr">67</xref>]. The digitized electrodes were registered to the head surface using landmark-based rigid parametric registration. Especially in occipital and inferior regions, due to the lying position of the subject during MRI measurement, the gray matter compartment touches the inner skull surface, which also motivates the use of unfitted FEM [<xref rid="pone.0252431.ref071" ref-type="bibr">71</xref>]. From <xref rid="pone.0252431.g004" ref-type="fig">Fig 4</xref> we see a clear dipolar pattern in the topography plot. To estimate the location of the dipole, we performed a single dipole deviation scan using a normal constraint for dipole orientation on the source space, i.e., a set of source locations within the gray matter compartment [<xref rid="pone.0252431.ref058" ref-type="bibr">58</xref>]. The source space was created using a weighted sum of level-set functions for gray and white matter as <italic toggle="yes">α</italic>Φ<sub>wm</sub> + (1 − <italic toggle="yes">α</italic>)Φ<sub>gm</sub> with <italic toggle="yes">α</italic> = 0.8. Like the levels-sets for white and gray matter, the resulting level-set for the source space is then given as a three-dimensional array of signed-distance values. This level-set function was discretized using the marching cubes algorithm presented in [<xref rid="pone.0252431.ref072" ref-type="bibr">72</xref>], which resulted in 256 134 source locations. For each location, we computed the dipole orientation normal to the surface of the source space. <xref rid="pone.0252431.g005" ref-type="fig">Fig 5</xref> shows the skin, skull and gray matter surfaces and the electrode positions as well as the source space that was used in the example computation.</p>
    <fig position="float" id="pone.0252431.g005">
      <object-id pub-id-type="doi">10.1371/journal.pone.0252431.g005</object-id>
      <label>Fig 5</label>
      <caption>
        <title>Practical application: Realistic head model.</title>
        <p>Left: skin, skull and gray matter surfaces of the six-compartment isotropic head model along with the electrode montage used in the practical example. Right: source space relative to the electrode positions.</p>
      </caption>
      <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.g005" position="float"/>
    </fig>
    <p>Using the level-set functions, we constructed an unfitted FEM head model and computed the EEG transfer matrix for all electrode positions using the presented DUNEuro toolbox. With this transfer matrix, we computed the EEG forward solution for all dipole positions with the fixed orientation and unit strength using the partial integration source model [<xref rid="pone.0252431.ref014" ref-type="bibr">14</xref>, <xref rid="pone.0252431.ref056" ref-type="bibr">56</xref>]. The optimal strength <italic toggle="yes">s</italic> with respect to a given measurement <inline-formula id="pone.0252431.e025"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.e025.jpg" id="pone.0252431.e025g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M25" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> for a dipole with the leadfield <inline-formula id="pone.0252431.e026"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.e026.jpg" id="pone.0252431.e026g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M26" display="inline" overflow="scroll"><mml:mrow><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pone.0252431.e027"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.e027.jpg" id="pone.0252431.e027g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M27" display="inline" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> denotes the number of sensors, can be obtained by minimizing ‖<italic toggle="yes">ls</italic> − <italic toggle="yes">m</italic>‖<sub>2</sub> over <italic toggle="yes">s</italic>. The resulting optimal strength for reproducing the measured data can be computed by multiplying the pseudo-inverse of <italic toggle="yes">l</italic> with the measurement vector <italic toggle="yes">m</italic>. As <italic toggle="yes">l</italic> consists of a single column due to the fixed dipole orientation, this reduces to
<disp-formula id="pone.0252431.e028"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.e028.jpg" id="pone.0252431.e028g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M28" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mo form="prefix" movablelimits="true">max</mml:mo><mml:mo>(</mml:mo><mml:mfrac><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>⟩</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mi>l</mml:mi><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mfrac><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
    <p>The maximum with 0 is used in order to restrict the solution along the respective positive normal direction because the P20/N20 component is assumed to be located in Brodmann area 3b of the somatosensory SI cortex pointing out of the cortex to produce a frontal positivity [<xref rid="pone.0252431.ref073" ref-type="bibr">73</xref>, <xref rid="pone.0252431.ref074" ref-type="bibr">74</xref>]. This strength is embedded into the goodness of fit (GOF) measure that is defined as
<disp-formula id="pone.0252431.e029"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.e029.jpg" id="pone.0252431.e029g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M29" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo form="prefix">GOF</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mi>m</mml:mi><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
and measures the ability of the numerical solution to reproduce the measured data. If the data can be exactly reproduced, the GOF has a value of 1. In the case of a single dipole deviation scan this includes how well the data can be represented as a single dipole. Former results have shown that the single dipole source model is appropriate for the reconstruction of the early somatosensory response [<xref rid="pone.0252431.ref073" ref-type="bibr">73</xref>–<xref rid="pone.0252431.ref076" ref-type="bibr">76</xref>].</p>
    <p>The source of the P20/N20 response was reconstructed in the primary somatosensory cortex in the wall of the post-central gyrus with a GOF of 0.962 and with a mainly tangential orientation, which reproduces findings of [<xref rid="pone.0252431.ref073" ref-type="bibr">73</xref>–<xref rid="pone.0252431.ref076" ref-type="bibr">76</xref>]. <xref rid="pone.0252431.g006" ref-type="fig">Fig 6</xref> shows the source embedded in the source space and the distribution of the GOF measure on a realistic and an inflated model of the source space. We see that the GOF measure is higher for source locations on the gyral walls with a tangentially oriented normal vector and that the higher values are located close to the central sulcus. Overall, the GOF measure shows a smooth distribution in these areas while being sensitive to orientation changes.</p>
    <fig position="float" id="pone.0252431.g006">
      <object-id pub-id-type="doi">10.1371/journal.pone.0252431.g006</object-id>
      <label>Fig 6</label>
      <caption>
        <title>Practical application: Source reconstruction.</title>
        <p>Left: Reconstructed source (red) of the P20 component and its location within the source space. Middle: Distribution of the GOF measure on the source space. A darker color indicates a higher GOF. Right: GOF measure on an inflated model of the source space.</p>
      </caption>
      <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.g006" position="float"/>
    </fig>
  </sec>
  <sec id="sec013">
    <title>Summary and outlook</title>
    <p>In this paper we presented the DUNEuro software, a toolbox for solving forward problems in bioelectromagnetism. We provided a general description of the toolbox as well as detailed information about the main concepts. Short examples showed the extendibility of the different subcomponents. We presented a method to efficiently localize positions within a given mesh and described bindings of the library to scripting languages. Finally, the practical usability of the library was demonstrated by a source analysis of experimental data of a somatosensory stimulation.</p>
    <p>The DUNEuro toolbox offers a flexible and efficient way to solve the EEG/MEG forward problems numerically using modern FEM approaches. There are several open goals regarding the software implementation. Foremost, a direct comparison with existing tools for computing forward solutions for EEG and MEG, such as the SimBio toolbox, is currently performed [<xref rid="pone.0252431.ref077" ref-type="bibr">77</xref>]. Similar to the latter toolbox, a closer integration into existing EEG/MEG source analysis frameworks [<xref rid="pone.0252431.ref024" ref-type="bibr">24</xref>–<xref rid="pone.0252431.ref027" ref-type="bibr">27</xref>] would further facilitate its usability. An integration into the Brainstorm toolbox [<xref rid="pone.0252431.ref025" ref-type="bibr">25</xref>], for instance, is currently under development (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://neuroimage.usc.edu/brainstorm/Tutorials/Duneuro" ext-link-type="uri">https://neuroimage.usc.edu/brainstorm/Tutorials/Duneuro</ext-link>) [<xref rid="pone.0252431.ref078" ref-type="bibr">78</xref>]. This would then also allow to evaluate the advantages and disadvantages of the new FEM methods that are now available through the DUNEuro code in practical applications. Additionally, this integration would offer the use of DUNEuro for different inverse approaches. This would also allow the reconstruction of a complete localized time course of the somatosensory responses using forward solutions of DUNEuro as well as comparisons of these source analysis results to other methods (e.g., BEM). Several other forward problems, e.g., electric or magnetic brain stimulations whose mathematical formulations are closely related to the EEG/MEG forward problems due to Helmholtz reciprocity [<xref rid="pone.0252431.ref021" ref-type="bibr">21</xref>–<xref rid="pone.0252431.ref023" ref-type="bibr">23</xref>] are already partly implemented, but their support should be improved and evaluated. Of special interest would then be a connection to optimization procedures for transcranial direct current stimulation [<xref rid="pone.0252431.ref023" ref-type="bibr">23</xref>, <xref rid="pone.0252431.ref079" ref-type="bibr">79</xref>, <xref rid="pone.0252431.ref080" ref-type="bibr">80</xref>]. Even though DUNEuro already relies on the testing infrastructure of the DUNE framework, further work on a complete testing framework using continuous integration is necessary in order to improve the stability of the code base and ensure the reliability of the results even under future modifications. As DUNEuro is further developed and used, the documentation of its features and user interfaces is steadily extended.</p>
  </sec>
  <sec id="sec014" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pone.0252431.s001" mimetype="application/zip" position="float" content-type="local-data">
      <label>S1 Appendix</label>
      <caption>
        <title>Installation instructions.</title>
        <p>A detailed description is provided how to install the DUNEuro software toolbox. The DUNE and DUNEuro modules are downloaded using an auxiliary bash script and option files are provided which are used in the compilation process.</p>
        <p>(ZIP)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.s001.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pone.0252431.s002" mimetype="application/zip" position="float" content-type="local-data">
      <label>S2 Appendix</label>
      <caption>
        <title>Example data and scripts.</title>
        <p>Example scripts in Python and MATLAB are provided to give an overview of the numerous features DUNEuro offers. For the volume conductor head model, different spherical four-compartment models and two different realistic six-compartment head models are used. A detailed description is given that lists all provided data files and scripts and explains the different steps for an EEG forward calculation using DUNEuro. Different FEM discretizations, source models, and solution approaches (direct or via the transfer matrix approach) are used and explained in detail.</p>
        <p>(ZIP)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pone.0252431.s002.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank Andreas Wollbrink for technical assistance and his valuable advice for the experiment and Karin Wilken, Hildegard Deitermann and Ute Trompeter for their help with the EEG/MRI data collection.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0252431.ref001">
      <label>1</label>
      <mixed-citation publication-type="book"><name><surname>Brette</surname><given-names>R</given-names></name>, <name><surname>Destexhe</surname><given-names>A</given-names></name>. <source>Handbook of neural activity measurement</source>. <publisher-name>Cambridge University Press</publisher-name>; <year>2012</year>.</mixed-citation>
    </ref>
    <ref id="pone.0252431.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Hallez</surname><given-names>H</given-names></name>, <name><surname>Vanrumste</surname><given-names>B</given-names></name>, <name><surname>Grech</surname><given-names>R</given-names></name>, <name><surname>Muscat</surname><given-names>J</given-names></name>, <name><surname>De Clercq</surname><given-names>W</given-names></name>, <name><surname>Vergult</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Review on solving the forward problem in EEG source analysis</article-title>. <source>Journal of neuroengineering and rehabilitation</source>. <year>2007</year>;<volume>4</volume>(<issue>1</issue>):<fpage>46</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1743-0003-4-46</pub-id><?supplied-pmid 18053144?><pub-id pub-id-type="pmid">18053144</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Wolters</surname><given-names>C</given-names></name>, <name><surname>Köstler</surname><given-names>H</given-names></name>, <name><surname>Möller</surname><given-names>C</given-names></name>, <name><surname>Härdtlein</surname><given-names>J</given-names></name>, <name><surname>Grasedyck</surname><given-names>L</given-names></name>, <name><surname>Hackbusch</surname><given-names>W</given-names></name>. <article-title>Numerical Mathematics of the Subtraction Method for the Modeling of a Current Dipole in EEG Source Reconstruction Using Finite Element Head Models</article-title>. <source>SIAM Journal on Scientific Computing</source>. <year>2007</year>;<volume>30</volume>(<issue>1</issue>):<fpage>24</fpage>–<lpage>45</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1137/060659053</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Gramfort</surname><given-names>A</given-names></name>, <name><surname>Papadopoulo</surname><given-names>T</given-names></name>, <name><surname>Olivi</surname><given-names>E</given-names></name>, <name><surname>Clerc</surname><given-names>M</given-names></name>. <article-title>Forward field computation with OpenMEEG</article-title>. <source>Computational intelligence and neuroscience</source>. <year>2011</year>;<volume>2011</volume>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1155/2011/923703</pub-id><?supplied-pmid 21437231?><pub-id pub-id-type="pmid">21437231</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Stenroos</surname><given-names>M</given-names></name>, <name><surname>Sarvas</surname><given-names>J</given-names></name>. <article-title>Bioelectromagnetic forward problem: isolated source approach revis (it) ed</article-title>. <source>Physics in Medicine &amp; Biology</source>. <year>2012</year>;<volume>57</volume>(<issue>11</issue>):<fpage>3517</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1088/0031-9155/57/11/3517</pub-id><?supplied-pmid 22581305?><pub-id pub-id-type="pmid">22581305</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Htet</surname><given-names>AT</given-names></name>, <name><surname>Saturnino</surname><given-names>GB</given-names></name>, <name><surname>Burnham</surname><given-names>EH</given-names></name>, <name><surname>Noetscher</surname><given-names>GM</given-names></name>, <name><surname>Nummenmaa</surname><given-names>A</given-names></name>, <name><surname>Makarov</surname><given-names>SN</given-names></name>. <article-title>Comparative performance of the finite element method and the boundary element fast multipole method for problems mimicking transcranial magnetic stimulation (TMS)</article-title>. <source>Journal of Neural Engineering</source>. <year>2019</year>;<volume>16</volume>(<issue>2</issue>):<fpage>024001</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1088/1741-2552/aafbb9</pub-id><?supplied-pmid 30605893?><pub-id pub-id-type="pmid">30605893</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref007">
      <label>7</label>
      <mixed-citation publication-type="other">Cook MJ, Koles ZJ. A high-resolution anisotropic finite-volume head model for EEG source analysis. In: Engineering in Medicine and Biology Society, 2006. EMBS’06. 28th Annual International Conference of the IEEE. IEEE; 2006. p. 4536–4539.</mixed-citation>
    </ref>
    <ref id="pone.0252431.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Montes-Restrepo</surname><given-names>V</given-names></name>, <name><surname>van Mierlo</surname><given-names>P</given-names></name>, <name><surname>Strobbe</surname><given-names>G</given-names></name>, <name><surname>Staelens</surname><given-names>S</given-names></name>, <name><surname>Vandenberghe</surname><given-names>S</given-names></name>, <name><surname>Hallez</surname><given-names>H</given-names></name>. <article-title>Influence of skull modeling approaches on EEG source localization</article-title>. <source>Brain topography</source>. <year>2014</year>;<volume>27</volume>(<issue>1</issue>):<fpage>95</fpage>–<lpage>111</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s10548-013-0313-y</pub-id><?supplied-pmid 24002699?><pub-id pub-id-type="pmid">24002699</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Vatta</surname><given-names>F</given-names></name>, <name><surname>Meneghini</surname><given-names>F</given-names></name>, <name><surname>Esposito</surname><given-names>F</given-names></name>, <name><surname>Mininel</surname><given-names>S</given-names></name>, <name><surname>Di Salle</surname><given-names>F</given-names></name>. <article-title>Solving the forward problem in EEG source analysis by spherical and fdm head modeling: a comparative analysis-biomed 2009</article-title>. <source>Biomedical sciences instrumentation</source>. <year>2009</year>;<volume>45</volume>:<fpage>382</fpage>–<lpage>388</lpage>. <?supplied-pmid 19369793?><pub-id pub-id-type="pmid">19369793</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Cuartas Morales</surname><given-names>E</given-names></name>, <name><surname>Acosta-Medina</surname><given-names>CD</given-names></name>, <name><surname>Castellanos-Domínguez</surname><given-names>G</given-names></name>, <name><surname>Mantini</surname><given-names>D</given-names></name>. <article-title>A Finite-Difference Solution for the EEG Forward Problem in Inhomogeneous Anisotropic Media</article-title>. <source>Brain Topography</source>. <year>2019</year>;<volume>32</volume>(<issue>2</issue>):<fpage>229</fpage>–<lpage>239</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s10548-018-0683-2</pub-id><?supplied-pmid 30341590?><pub-id pub-id-type="pmid">30341590</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Vorwerk</surname><given-names>J</given-names></name>, <name><surname>Cho</surname><given-names>JH</given-names></name>, <name><surname>Rampp</surname><given-names>S</given-names></name>, <name><surname>Hamer</surname><given-names>H</given-names></name>, <name><surname>Knösche</surname><given-names>TR</given-names></name>, <name><surname>Wolters</surname><given-names>CH</given-names></name>. <article-title>A guideline for head volume conductor modeling in EEG and MEG</article-title>. <source>NeuroImage</source>. <year>2014</year>;<volume>100</volume>:<fpage>590</fpage>–<lpage>607</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.neuroimage.2014.06.040</pub-id><?supplied-pmid 24971512?><pub-id pub-id-type="pmid">24971512</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Gençer</surname><given-names>NG</given-names></name>, <name><surname>Acar</surname><given-names>CE</given-names></name>. <article-title>Sensitivity of EEG and MEG measurements to tissue conductivity</article-title>. <source>Physics in Medicine &amp; Biology</source>. <year>2004</year>;<volume>49</volume>(<issue>5</issue>):<fpage>701</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1088/0031-9155/49/5/004</pub-id><?supplied-pmid 15070197?><pub-id pub-id-type="pmid">15070197</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Schimpf</surname><given-names>PH</given-names></name>, <name><surname>Ramon</surname><given-names>C</given-names></name>, <name><surname>Haueisen</surname><given-names>J</given-names></name>. <article-title>Dipole models for the EEG and MEG</article-title>. <source>IEEE Transactions on Biomedical Engineering</source>. <year>2002</year>;<volume>49</volume>(<issue>5</issue>):<fpage>409</fpage>–<lpage>418</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/10.995679</pub-id><?supplied-pmid 12002172?><pub-id pub-id-type="pmid">12002172</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Weinstein</surname><given-names>D</given-names></name>, <name><surname>Zhukov</surname><given-names>L</given-names></name>, <name><surname>Johnson</surname><given-names>C</given-names></name>. <article-title>Lead-field bases for electroencephalography source imaging</article-title>. <source>Annals of biomedical engineering</source>. <year>2000</year>;<volume>28</volume>(<issue>9</issue>):<fpage>1059</fpage>–<lpage>1065</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1114/1.1310220</pub-id><?supplied-pmid 11132189?><pub-id pub-id-type="pmid">11132189</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Engwer</surname><given-names>C</given-names></name>, <name><surname>Vorwerk</surname><given-names>J</given-names></name>, <name><surname>Ludewig</surname><given-names>J</given-names></name>, <name><surname>Wolters</surname><given-names>CH</given-names></name>. <article-title>A Discontinuous Galerkin Method to Solve the EEG Forward Problem Using the Subtraction Approach</article-title>. <source>SIAM Journal on Scientific Computing</source>. <year>2017</year>;<volume>39</volume>(<issue>1</issue>):<fpage>B138</fpage>–<lpage>B164</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1137/15M1048392</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Piastra</surname><given-names>MC</given-names></name>, <name><surname>Nüßing</surname><given-names>A</given-names></name>, <name><surname>Vorwerk</surname><given-names>J</given-names></name>, <name><surname>Bornfleth</surname><given-names>H</given-names></name>, <name><surname>Oostenveld</surname><given-names>R</given-names></name>, <name><surname>Engwer</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>The Discontinuous Galerkin Finite Element Method for Solving the MEG and the Combined MEG/EEG Forward Problem</article-title>. <source>Frontiers in Neuroscience</source>. <year>2018</year>;<volume>12</volume>:<fpage>30</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3389/fnins.2018.00030</pub-id><?supplied-pmid 29456487?><pub-id pub-id-type="pmid">29456487</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Nüßing</surname><given-names>A</given-names></name>, <name><surname>Wolters</surname><given-names>CH</given-names></name>, <name><surname>Brinck</surname><given-names>H</given-names></name>, <name><surname>Engwer</surname><given-names>C</given-names></name>. <article-title>The Unfitted Discontinuous Galerkin Method for Solving the EEG Forward Problem</article-title>. <source>IEEE Transactions on Biomedical Engineering</source>. <year>2016</year>;<volume>63</volume>(<issue>12</issue>):<fpage>2564</fpage>–<lpage>2575</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/TBME.2016.2590740</pub-id><pub-id pub-id-type="pmid">27416584</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref018">
      <label>18</label>
      <mixed-citation publication-type="other">Nüßing A. Fitted and Unfitted Finite Element Methods for Solving the EEG Forward Problem [Ph.D. thesis]. Westfälische Wilhelms-Universität Münster; 2018. Available from: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://nbn-resolving.de/urn:nbn:de:hbz:6-67139436770" ext-link-type="uri">http://nbn-resolving.de/urn:nbn:de:hbz:6-67139436770</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0252431.ref019">
      <label>19</label>
      <mixed-citation publication-type="other">Piastra MC. New finite element methods for solving the MEG and the combined MEG/EEG forward problem [Ph.D. thesis]. Westfälische Wilhelms-Universität Münster; 2019. Available from: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://nbn-resolving.de/urn:nbn:de:hbz:6-53199662090" ext-link-type="uri">http://nbn-resolving.de/urn:nbn:de:hbz:6-53199662090</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0252431.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Miinalainen</surname><given-names>T</given-names></name>, <name><surname>Rezaei</surname><given-names>A</given-names></name>, <name><surname>Us</surname><given-names>D</given-names></name>, <name><surname>Nüßing</surname><given-names>A</given-names></name>, <name><surname>Engwer</surname><given-names>C</given-names></name>, <name><surname>Wolters</surname><given-names>CH</given-names></name>, <etal>et al</etal>. <article-title>A realistic, accurate and fast source modeling approach for the EEG forward problem</article-title>. <source>NeuroImage</source>. <year>2019</year>;<volume>184</volume>:<fpage>56</fpage>–<lpage>67</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.neuroimage.2018.08.054</pub-id><?supplied-pmid 30165251?><pub-id pub-id-type="pmid">30165251</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Vallaghé</surname><given-names>S</given-names></name>, <name><surname>Papadopoulo</surname><given-names>T</given-names></name>, <name><surname>Clerc</surname><given-names>M</given-names></name>. <article-title>The adjoint method for general EEG and MEG sensor-based lead field equations</article-title>. <source>Physics in Medicine &amp; Biology</source>. <year>2008</year>;<volume>54</volume>(<issue>1</issue>):<fpage>135</fpage>. <?supplied-pmid 19075359?><pub-id pub-id-type="pmid">19075359</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Nolte</surname><given-names>G</given-names></name>. <article-title>The magnetic lead field theorem in the quasi-static approximation and its use for magnetoencephalography forward calculation in realistic volume conductors</article-title>. <source>Physics in Medicine and Biology</source>. <year>2003</year>;<volume>48</volume>(<issue>22</issue>):<fpage>3637</fpage>–<lpage>3652</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1088/0031-9155/48/22/002</pub-id><?supplied-pmid 14680264?><pub-id pub-id-type="pmid">14680264</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Wagner</surname><given-names>S</given-names></name>, <name><surname>Burger</surname><given-names>M</given-names></name>, <name><surname>Wolters</surname><given-names>CH</given-names></name>. <article-title>An optimization approach for well-targeted transcranial direct current stimulation</article-title>. <source>SIAM Journal on Applied Mathematics</source>. <year>2016</year>;<volume>76</volume>(<issue>6</issue>):<fpage>2154</fpage>–<lpage>2174</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1137/15M1026481</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Oostenveld</surname><given-names>R</given-names></name>, <name><surname>Fries</surname><given-names>P</given-names></name>, <name><surname>Maris</surname><given-names>E</given-names></name>, <name><surname>Schoffelen</surname><given-names>JM</given-names></name>. <article-title>FieldTrip: open source software for advanced analysis of MEG, EEG, and invasive electrophysiological data</article-title>. <source>Computational intelligence and neuroscience</source>. <year>2011</year>;<volume>2011</volume>:<fpage>1</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1155/2011/156869</pub-id><?supplied-pmid 21253357?><pub-id pub-id-type="pmid">21837235</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Tadel</surname><given-names>F</given-names></name>, <name><surname>Baillet</surname><given-names>S</given-names></name>, <name><surname>Mosher</surname><given-names>JC</given-names></name>, <name><surname>Pantazis</surname><given-names>D</given-names></name>, <name><surname>Leahy</surname><given-names>RM</given-names></name>. <article-title>Brainstorm: a user-friendly application for MEG/EEG analysis</article-title>. <source>Computational intelligence and neuroscience</source>. <year>2011</year>;<volume>2011</volume>:<fpage>8</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1155/2011/879716</pub-id><?supplied-pmid 21584256?><pub-id pub-id-type="pmid">21584256</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>He</surname><given-names>Q</given-names></name>, <name><surname>Rezaei</surname><given-names>A</given-names></name>, <name><surname>Pursiainen</surname><given-names>S</given-names></name>. <article-title>Zeffiro User Interface for Electromagnetic Brain Imaging: a GPU Accelerated FEM Tool for Forward and Inverse Computations in Matlab</article-title>. <source>Neuroinformatics</source>. <year>2020</year>;<volume>18</volume>:<fpage>237</fpage>–<lpage>250</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s12021-019-09436-9</pub-id><?supplied-pmid 31598847?><pub-id pub-id-type="pmid">31598847</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Gramfort</surname><given-names>A</given-names></name>, <name><surname>Luessi</surname><given-names>M</given-names></name>, <name><surname>Larson</surname><given-names>E</given-names></name>, <name><surname>Engemann</surname><given-names>DA</given-names></name>, <name><surname>Strohmeier</surname><given-names>D</given-names></name>, <name><surname>Brodbeck</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>MEG and EEG data analysis with MNE-Python</article-title>. <source>Frontiers in neuroscience</source>. <year>2013</year>;<volume>7</volume>:<fpage>267</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3389/fnins.2013.00267</pub-id><?supplied-pmid 24431986?><pub-id pub-id-type="pmid">24431986</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Vermaas</surname><given-names>M</given-names></name>, <name><surname>Piastra</surname><given-names>M</given-names></name>, <name><surname>Oostendorp</surname><given-names>T</given-names></name>, <name><surname>Ramsey</surname><given-names>N</given-names></name>, <name><surname>Tiesinga</surname><given-names>P</given-names></name>. <article-title>FEMfuns: A Volume Conduction Modeling Pipeline that Includes Resistive, Capacitive or Dispersive Tissue and Electrodes</article-title>. <source>Neuroinformatics</source>. <year>2020</year>;<volume>18</volume>(<issue>4</issue>):<fpage>569</fpage>–<lpage>580</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s12021-020-09458-8</pub-id><?supplied-pmid 32306231?><pub-id pub-id-type="pmid">32306231</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Gramfort</surname><given-names>A</given-names></name>, <name><surname>Luessi</surname><given-names>M</given-names></name>, <name><surname>Larson</surname><given-names>E</given-names></name>, <name><surname>Engemann</surname><given-names>DA</given-names></name>, <name><surname>Strohmeier</surname><given-names>D</given-names></name>, <name><surname>Brodbeck</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>MNE software for processing MEG and EEG data</article-title>. <source>NeuroImage</source>. <year>2014</year>;<volume>86</volume>:<fpage>446</fpage>—<lpage>460</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.neuroimage.2013.10.027</pub-id><?supplied-pmid 24161808?><pub-id pub-id-type="pmid">24161808</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Vorwerk</surname><given-names>J</given-names></name>, <name><surname>Oostenveld</surname><given-names>R</given-names></name>, <name><surname>Piastra</surname><given-names>MC</given-names></name>, <name><surname>Magyari</surname><given-names>L</given-names></name>, <name><surname>Wolters</surname><given-names>CH</given-names></name>. <article-title>The FieldTrip-SimBio pipeline for EEG forward solutions</article-title>. <source>BioMedical Engineering OnLine</source>. <year>2018</year>;<volume>17</volume>(<issue>1</issue>):<fpage>37</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s12938-018-0463-y</pub-id><?supplied-pmid 29580236?><pub-id pub-id-type="pmid">29580236</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Bastian</surname><given-names>P</given-names></name>, <name><surname>Blatt</surname><given-names>M</given-names></name>, <name><surname>Dedner</surname><given-names>A</given-names></name>, <name><surname>Dreier</surname><given-names>NA</given-names></name>, <name><surname>Engwer</surname><given-names>C</given-names></name>, <name><surname>Fritze</surname><given-names>R</given-names></name>, <etal>et al</etal>. <article-title>The Dune framework: Basic concepts and recent developments</article-title>. <source>Computers &amp; Mathematics with Applications</source>. <year>2020</year>;Forthcoming.</mixed-citation>
    </ref>
    <ref id="pone.0252431.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Bastian</surname><given-names>P</given-names></name>, <name><surname>Blatt</surname><given-names>M</given-names></name>, <name><surname>Dedner</surname><given-names>A</given-names></name>, <name><surname>Engwer</surname><given-names>C</given-names></name>, <name><surname>Klöfkorn</surname><given-names>R</given-names></name>, <name><surname>Ohlberger</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>A generic grid interface for parallel and adaptive scientific computing. Part I: abstract framework</article-title>. <source>Computing</source>. <year>2008</year>;<volume>82</volume>(<issue>2-3</issue>):<fpage>103</fpage>–<lpage>119</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s00607-008-0004-9</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Bastian</surname><given-names>P</given-names></name>, <name><surname>Blatt</surname><given-names>M</given-names></name>, <name><surname>Dedner</surname><given-names>A</given-names></name>, <name><surname>Engwer</surname><given-names>C</given-names></name>, <name><surname>Klöfkorn</surname><given-names>R</given-names></name>, <name><surname>Kornhuber</surname><given-names>R</given-names></name>, <etal>et al</etal>. <article-title>A generic grid interface for parallel and adaptive scientific computing. Part II: implementation and tests in DUNE</article-title>. <source>Computing</source>. <year>2008</year>;<volume>82</volume>(<issue>2-3</issue>):<fpage>121</fpage>–<lpage>138</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s00607-008-0004-9</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Bastian</surname><given-names>P</given-names></name>, <name><surname>Birken</surname><given-names>K</given-names></name>, <name><surname>Johannsen</surname><given-names>K</given-names></name>, <name><surname>Lang</surname><given-names>S</given-names></name>, <name><surname>Neuß</surname><given-names>N</given-names></name>, <name><surname>Rentz-Reichert</surname><given-names>H</given-names></name>, <etal>et al</etal>. <article-title>UG–a flexible software toolbox for solving partial differential equations</article-title>. <source>Computing and Visualization in Science</source>. <year>1997</year>;<volume>1</volume>(<issue>1</issue>):<fpage>27</fpage>–<lpage>40</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s007910050003</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Bastian</surname><given-names>P</given-names></name>, <name><surname>Heimann</surname><given-names>F</given-names></name>, <name><surname>Marnach</surname><given-names>S</given-names></name>. <article-title>Generic implementation of finite element methods in the distributed and unified numerics environment (DUNE)</article-title>. <source>Kybernetika</source>. <year>2010</year>;<volume>46</volume>(<issue>2</issue>):<fpage>294</fpage>–<lpage>315</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0252431.ref036">
      <label>36</label>
      <mixed-citation publication-type="book"><name><surname>Brenner</surname><given-names>S</given-names></name>, <name><surname>Scott</surname><given-names>R</given-names></name>. <source>The mathematical theory of finite element methods</source>. <volume>vol. 15</volume>. <publisher-name>Springer Science &amp; Business Media</publisher-name>; <year>2007</year>.</mixed-citation>
    </ref>
    <ref id="pone.0252431.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Lew</surname><given-names>S</given-names></name>, <name><surname>Wolters</surname><given-names>C</given-names></name>, <name><surname>Dierkes</surname><given-names>T</given-names></name>, <name><surname>Röer</surname><given-names>C</given-names></name>, <name><surname>MacLeod</surname><given-names>R</given-names></name>. <article-title>Accuracy and run-time comparison for different potential approaches and iterative solvers in finite element method based EEG source analysis</article-title>. <source>Applied Numerical Mathematics</source>. <year>2009</year>;<volume>59</volume>(<issue>8</issue>):<fpage>1970</fpage>–<lpage>1988</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.apnum.2009.02.006</pub-id><?supplied-pmid 20161462?><pub-id pub-id-type="pmid">20161462</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Medani</surname><given-names>T</given-names></name>, <name><surname>Lautru</surname><given-names>D</given-names></name>, <name><surname>Schwartz</surname><given-names>D</given-names></name>, <name><surname>Ren</surname><given-names>Z</given-names></name>, <name><surname>Sou</surname><given-names>G</given-names></name>. <article-title>FEM method for the EEG forward problem and improvement based on modification of the saint venant’s method</article-title>. <source>Progress In Electromagnetics Research</source>. <year>2015</year>;<volume>153</volume>:<fpage>11</fpage>–<lpage>22</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.2528/PIER15050102</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Pursiainen</surname><given-names>S</given-names></name>, <name><surname>Sorrentino</surname><given-names>A</given-names></name>, <name><surname>Campi</surname><given-names>C</given-names></name>, <name><surname>Piana</surname><given-names>M</given-names></name>. <article-title>Forward simulation and inverse dipole localization with the lowest order Raviart—Thomas elements for electroencephalography</article-title>. <source>Inverse Problems</source>. <year>2011</year>;<volume>27</volume>(<issue>4</issue>):<fpage>045003</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1088/0266-5611/27/4/045003</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref040">
      <label>40</label>
      <mixed-citation publication-type="other">Beltrachini L. A finite element solution of the forward problem in EEG for multipolar sources. IEEE Transactions on Neural Systems and Rehabilitation Engineering. 2018.</mixed-citation>
    </ref>
    <ref id="pone.0252431.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Beltrachini</surname><given-names>L</given-names></name>. <article-title>Sensitivity of the projected subtraction approach to mesh degeneracies and its impact on the forward problem in EEG</article-title>. <source>IEEE Transactions on Biomedical Engineering</source>. <year>2019</year>;<volume>66</volume>(<issue>1</issue>):<fpage>273</fpage>–<lpage>282</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/TBME.2018.2828336</pub-id><?supplied-pmid 29993440?><pub-id pub-id-type="pmid">29993440</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Acar</surname><given-names>ZA</given-names></name>, <name><surname>Acar</surname><given-names>CE</given-names></name>, <name><surname>Makeig</surname><given-names>S</given-names></name>. <article-title>Simultaneous head tissue conductivity and EEG source location estimation</article-title>. <source>NeuroImage</source>. <year>2016</year>;<volume>124</volume>:<fpage>168</fpage>–<lpage>180</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.neuroimage.2015.08.032</pub-id><?supplied-pmid 26302675?><pub-id pub-id-type="pmid">26302675</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Marin</surname><given-names>G</given-names></name>, <name><surname>Guerin</surname><given-names>C</given-names></name>, <name><surname>Baillet</surname><given-names>S</given-names></name>, <name><surname>Garnero</surname><given-names>L</given-names></name>, <name><surname>Meunier</surname><given-names>G</given-names></name>. <article-title>Influence of skull anisotropy for the forward and inverse problem in EEG: simulation studies using FEM on realistic head models</article-title>. <source>Human brain mapping</source>. <year>1998</year>;<volume>6</volume>(<issue>4</issue>):<fpage>250</fpage>–<lpage>269</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/(SICI)1097-0193(1998)6:4&lt;250::AID-HBM5&gt;3.0.CO;2-2</pub-id><?supplied-pmid 9704264?><pub-id pub-id-type="pmid">9704264</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Van Uitert</surname><given-names>R</given-names></name>, <name><surname>Johnson</surname><given-names>C</given-names></name>, <name><surname>Zhukov</surname><given-names>L</given-names></name>. <article-title>Influence of head tissue conductivity in forward and inverse magnetoencephalographic simulations using realistic head models</article-title>. <source>IEEE Transactions on Biomedical Engineering</source>. <year>2004</year>;<volume>51</volume>(<issue>12</issue>):<fpage>2129</fpage>–<lpage>2137</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/TBME.2004.836490</pub-id><?supplied-pmid 15605860?><pub-id pub-id-type="pmid">15605860</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Vallaghé</surname><given-names>S</given-names></name>, <name><surname>Papadopoulo</surname><given-names>T</given-names></name>. <article-title>A trilinear immersed finite element method for solving the electroencephalography forward problem</article-title>. <source>SIAM Journal on Scientific Computing</source>. <year>2010</year>;<volume>32</volume>(<issue>4</issue>):<fpage>2379</fpage>–<lpage>2394</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1137/09075038X</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Vorwerk</surname><given-names>J</given-names></name>, <name><surname>Engwer</surname><given-names>C</given-names></name>, <name><surname>Pursiainen</surname><given-names>S</given-names></name>, <name><surname>Wolters</surname><given-names>CH</given-names></name>. <article-title>A mixed finite element method to solve the EEG forward problem</article-title>. <source>IEEE transactions on medical imaging</source>. <year>2017</year>;<volume>36</volume>(<issue>4</issue>):<fpage>930</fpage>–<lpage>941</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/TMI.2016.2624634</pub-id><?supplied-pmid 27831869?><pub-id pub-id-type="pmid">27831869</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Burman</surname><given-names>E</given-names></name>, <name><surname>Claus</surname><given-names>S</given-names></name>, <name><surname>Hansbo</surname><given-names>P</given-names></name>, <name><surname>Larson</surname><given-names>MG</given-names></name>, <name><surname>Massing</surname><given-names>A</given-names></name>. <article-title>CutFEM: Discretizing Geometry and Partial Differential Equations</article-title>. <source>International Journal for Numerical Methods in Engineering</source>. <year>2015</year>;<volume>104</volume>(<issue>7</issue>):<fpage>472</fpage>–<lpage>501</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/nme.4823</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Bastian</surname><given-names>P</given-names></name>, <name><surname>Engwer</surname><given-names>C</given-names></name>. <article-title>An unfitted finite element method using discontinuous Galerkin</article-title>. <source>Int J Numer Methods Eng</source>. <year>2009</year>;<volume>79</volume>(<issue>12</issue>):<fpage>1557</fpage>–<lpage>1576</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/nme.2631</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Yan</surname><given-names>Y</given-names></name>, <name><surname>Nunez</surname><given-names>P</given-names></name>, <name><surname>Hart</surname><given-names>R</given-names></name>. <article-title>Finite-element model of the human head: scalp potentials due to dipole sources</article-title>. <source>Medical and Biological Engineering and Computing</source>. <year>1991</year>;<volume>29</volume>(<issue>5</issue>):<fpage>475</fpage>–<lpage>481</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/BF02442317</pub-id><?supplied-pmid 1817208?><pub-id pub-id-type="pmid">1817208</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref050">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Wolters</surname><given-names>CH</given-names></name>, <name><surname>Anwander</surname><given-names>A</given-names></name>, <name><surname>Berti</surname><given-names>G</given-names></name>, <name><surname>Hartmann</surname><given-names>U</given-names></name>. <article-title>Geometry-Adapted Hexahedral Meshes Improve Accuracy of Finite-Element-Method-Based EEG Source Analysis</article-title>. <source>IEEE Transactions on Biomedical Engineering</source>. <year>2007</year>;<volume>54</volume>(<issue>8</issue>):<fpage>1446</fpage>–<lpage>1453</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/TBME.2007.890736</pub-id><?supplied-pmid 17694865?><pub-id pub-id-type="pmid">17694865</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref051">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Vorwerk</surname><given-names>J</given-names></name>, <name><surname>Hanrath</surname><given-names>A</given-names></name>, <name><surname>Wolters</surname><given-names>CH</given-names></name>, <name><surname>Grasedyck</surname><given-names>L</given-names></name>. <article-title>The multipole approach for EEG forward modeling using the finite element method</article-title>. <source>NeuroImage</source>. <year>2019</year>;<volume>201</volume>:<fpage>116039</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.neuroimage.2019.116039</pub-id><?supplied-pmid 31369809?><pub-id pub-id-type="pmid">31369809</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Drechsler</surname><given-names>F</given-names></name>, <name><surname>Wolters</surname><given-names>CH</given-names></name>, <name><surname>Dierkes</surname><given-names>T</given-names></name>, <name><surname>Si</surname><given-names>H</given-names></name>, <name><surname>Grasedyck</surname><given-names>L</given-names></name>. <article-title>A Full Subtraction Approach for Finite Element Method Based Source Analysis Using Constrained Delaunay Tetrahedralisation</article-title>. <source>NeuroImage</source>. <year>2009</year>;<volume>46</volume>(<issue>4</issue>):<fpage>1055</fpage>–<lpage>1065</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.neuroimage.2009.02.024</pub-id><?supplied-pmid 19264145?><pub-id pub-id-type="pmid">19264145</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref053">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Tanzer</surname><given-names>IO</given-names></name>, <name><surname>Järvenpää</surname><given-names>S</given-names></name>, <name><surname>Nenonen</surname><given-names>J</given-names></name>, <name><surname>Somersalo</surname><given-names>E</given-names></name>. <article-title>Representation of bioelectric current sources using Whitney elements in the finite element method</article-title>. <source>Physics in Medicine and Biology</source>. <year>2005</year>;<volume>50</volume>(<issue>13</issue>):<fpage>3023</fpage>–<lpage>3039</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1088/0031-9155/50/13/004</pub-id><?supplied-pmid 15972978?><pub-id pub-id-type="pmid">15972978</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref054">
      <label>54</label>
      <mixed-citation publication-type="journal"><name><surname>Bauer</surname><given-names>M</given-names></name>, <name><surname>Pursiainen</surname><given-names>S</given-names></name>, <name><surname>Vorwerk</surname><given-names>J</given-names></name>, <name><surname>Köstler</surname><given-names>H</given-names></name>, <name><surname>Wolters</surname><given-names>CH</given-names></name>. <article-title>Comparison study for Whitney (Raviart–Thomas)-type source models in finite-element-method-based EEG forward modeling</article-title>. <source>IEEE Transactions on Biomedical Engineering</source>. <year>2015</year>;<volume>62</volume>(<issue>11</issue>):<fpage>2648</fpage>–<lpage>2656</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/TBME.2015.2439282</pub-id><?supplied-pmid 26054057?><pub-id pub-id-type="pmid">26054057</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref055">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>Pursiainen</surname><given-names>S</given-names></name>, <name><surname>Vorwerk</surname><given-names>J</given-names></name>, <name><surname>Wolters</surname><given-names>CH</given-names></name>. <article-title>Electroencephalography (EEG) forward modeling via H (div) finite element sources with focal interpolation</article-title>. <source>Physics in Medicine &amp; Biology</source>. <year>2016</year>;<volume>61</volume>(<issue>24</issue>):<fpage>8502</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1088/0031-9155/61/24/8502</pub-id><?supplied-pmid 27845929?><pub-id pub-id-type="pmid">27845929</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref056">
      <label>56</label>
      <mixed-citation publication-type="other">Vorwerk J. New finite element methods to solve the EEG/MEG forward problem [Ph.D. thesis]. Westfälische Wilhelms-Universität Münster; 2016.</mixed-citation>
    </ref>
    <ref id="pone.0252431.ref057">
      <label>57</label>
      <mixed-citation publication-type="journal"><name><surname>Wolters</surname><given-names>CH</given-names></name>, <name><surname>Grasedyck</surname><given-names>L</given-names></name>, <name><surname>Hackbusch</surname><given-names>W</given-names></name>. <article-title>Efficient computation of lead field bases and influence matrix for the FEM-based EEG and MEG inverse problem</article-title>. <source>Inverse problems</source>. <year>2004</year>;<volume>20</volume>(<issue>4</issue>):<fpage>1099</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1088/0266-5611/20/4/007</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref058">
      <label>58</label>
      <mixed-citation publication-type="journal"><name><surname>Hämäläinen</surname><given-names>M</given-names></name>, <name><surname>Hari</surname><given-names>R</given-names></name>, <name><surname>Ilmoniemi</surname><given-names>RJ</given-names></name>, <name><surname>Knuutila</surname><given-names>J</given-names></name>, <name><surname>Lounasmaa</surname><given-names>OV</given-names></name>. <article-title>Magnetoencephalography—theory, instrumentation, and applications to noninvasive studies of the working human brain</article-title>. <source>Reviews of modern Physics</source>. <year>1993</year>;<volume>65</volume>(<issue>2</issue>):<fpage>413</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1103/RevModPhys.65.413</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref059">
      <label>59</label>
      <mixed-citation publication-type="book"><name><surname>Sander</surname><given-names>O</given-names></name>. <source>DUNE—The Distributed and Unified Numerics Environment</source>. <publisher-name>Springer</publisher-name>, <publisher-loc>Cham</publisher-loc>; <year>2020</year>.</mixed-citation>
    </ref>
    <ref id="pone.0252431.ref060">
      <label>60</label>
      <mixed-citation publication-type="book"><name><surname>Engwer</surname><given-names>C</given-names></name>, <name><surname>Heimann</surname><given-names>F</given-names></name>. <chapter-title>Dune-udg: A cut-cell framework for unfitted discontinuous galerkin methods</chapter-title>. In: <source>Advances in DUNE</source>. <publisher-name>Springer</publisher-name>; <year>2012</year>. p. <fpage>89</fpage>–<lpage>100</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0252431.ref061">
      <label>61</label>
      <mixed-citation publication-type="journal"><name><surname>Piastra</surname><given-names>MC</given-names></name>, <name><surname>Nüßing</surname><given-names>A</given-names></name>, <name><surname>Vorwerk</surname><given-names>J</given-names></name>, <name><surname>Clerc</surname><given-names>M</given-names></name>, <name><surname>Engwer</surname><given-names>C</given-names></name>, <name><surname>Wolters</surname><given-names>CH</given-names></name>. <article-title>A Comprehensive Study on EEG and MEG Sensitivity to Cortical and Subcortical Sources</article-title>. <source>Human Brain Mapping</source>. <year>2020</year>; p. Forthcoming. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/hbm.25272</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref062">
      <label>62</label>
      <mixed-citation publication-type="journal"><name><surname>Opitz</surname><given-names>A</given-names></name>, <name><surname>Paulus</surname><given-names>W</given-names></name>, <name><surname>Will</surname><given-names>S</given-names></name>, <name><surname>Antunes</surname><given-names>A</given-names></name>, <name><surname>Thielscher</surname><given-names>A</given-names></name>. <article-title>Determinants of the electric field during transcranial direct current stimulation</article-title>. <source>NeuroImage</source>. <year>2015</year>;<volume>109</volume>:<fpage>140</fpage>—<lpage>150</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.neuroimage.2015.01.033</pub-id><?supplied-pmid 25613437?><pub-id pub-id-type="pmid">25613437</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref063">
      <label>63</label>
      <mixed-citation publication-type="journal"><name><surname>Opitz</surname><given-names>A</given-names></name>, <name><surname>Windhoff</surname><given-names>M</given-names></name>, <name><surname>Heidemann</surname><given-names>RM</given-names></name>, <name><surname>Turner</surname><given-names>R</given-names></name>, <name><surname>Thielscher</surname><given-names>A</given-names></name>. <article-title>How the brain tissue shapes the electric field induced by transcranial magnetic stimulation</article-title>. <source>NeuroImage</source>. <year>2011</year>;<volume>58</volume>(<issue>3</issue>):<fpage>849</fpage>—<lpage>859</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.neuroimage.2011.06.069</pub-id><?supplied-pmid 21749927?><pub-id pub-id-type="pmid">21749927</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref064">
      <label>64</label>
      <mixed-citation publication-type="journal"><name><surname>Janssen</surname><given-names>AM</given-names></name>, <name><surname>Rampersad</surname><given-names>SM</given-names></name>, <name><surname>Lucka</surname><given-names>F</given-names></name>, <name><surname>Lanfer</surname><given-names>B</given-names></name>, <name><surname>Lew</surname><given-names>S</given-names></name>, <name><surname>Aydin</surname><given-names>Ü</given-names></name>, <etal>et al</etal>. <article-title>The influence of sulcus width on simulated electric fields induced by transcranial magnetic stimulation</article-title>. <source>Phys Med Biol</source>. <year>2013</year>;<volume>58</volume>(<issue>14</issue>):<fpage>4881</fpage>–<lpage>4896</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1088/0031-9155/58/14/4881</pub-id><?supplied-pmid 23787706?><pub-id pub-id-type="pmid">23787706</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref065">
      <label>65</label>
      <mixed-citation publication-type="book"><name><surname>Brown</surname><given-names>PJ</given-names></name>, <name><surname>Faigle</surname><given-names>CT</given-names></name>. <source>A robust efficient algorithm for point location in triangulations</source>. <publisher-name>University of Cambridge, Computer Laboratory</publisher-name>; <year>1997</year>.</mixed-citation>
    </ref>
    <ref id="pone.0252431.ref066">
      <label>66</label>
      <mixed-citation publication-type="journal"><name><surname>Bentley</surname><given-names>JL</given-names></name>. <article-title>Multidimensional binary search trees used for associative searching</article-title>. <source>Communications of the ACM</source>. <year>1975</year>;<volume>18</volume>(<issue>9</issue>):<fpage>509</fpage>–<lpage>517</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1145/361002.361007</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref067">
      <label>67</label>
      <mixed-citation publication-type="other">Piastra MC, Schrader S, Nüßing A, Antonakakis M, Medani T, Wollbrink A, et al. The WWU DUNEuro reference data set for combined EEG/MEG source analysis; 2020. Available from: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://zenodo.org/record/3888381" ext-link-type="uri">https://zenodo.org/record/3888381</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0252431.ref068">
      <label>68</label>
      <mixed-citation publication-type="journal"><name><surname>Rice</surname><given-names>JK</given-names></name>, <name><surname>Rorden</surname><given-names>C</given-names></name>, <name><surname>Little</surname><given-names>JS</given-names></name>, <name><surname>Parra</surname><given-names>LC</given-names></name>. <article-title>Subject position affects EEG magnitudes</article-title>. <source>NeuroImage</source>. <year>2013</year>;<volume>64</volume>:<fpage>476</fpage>–<lpage>484</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.neuroimage.2012.09.041</pub-id><?supplied-pmid 23006805?><pub-id pub-id-type="pmid">23006805</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref069">
      <label>69</label>
      <mixed-citation publication-type="journal"><name><surname>Jenkinson</surname><given-names>M</given-names></name>, <name><surname>Beckmann</surname><given-names>C</given-names></name>, <name><surname>Behrens</surname><given-names>T</given-names></name>, <name><surname>Woolrich</surname><given-names>M</given-names></name>, <name><surname>Smith</surname><given-names>S</given-names></name>. <article-title>FSL</article-title>. <source>NeuroImage</source>. <year>2012</year>;<volume>62</volume>(<issue>2</issue>):<fpage>782</fpage>–<lpage>790</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.neuroimage.2011.09.015</pub-id><?supplied-pmid 21979382?><pub-id pub-id-type="pmid">21979382</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref070">
      <label>70</label>
      <mixed-citation publication-type="other">Whitaker RT. Reducing aliasing artifacts in iso-surfaces of binary volumes. In: Proceedings of the 2000 IEEE symposium on Volume visualization. ACM; 2000. p. 23–32.</mixed-citation>
    </ref>
    <ref id="pone.0252431.ref071">
      <label>71</label>
      <mixed-citation publication-type="other">Erdbrügger TR. CutFEM forward modeling for geometries withtouching surfaces in bioelectromagnetism [Master’s thesis]. Westfälische Wilhelms-Universität Münster; 2021. Available from: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.sci.utah.edu/~wolters/PaperWolters/2021/MasterErdbruegger.pdf" ext-link-type="uri">http://www.sci.utah.edu/~wolters/PaperWolters/2021/MasterErdbruegger.pdf</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0252431.ref072">
      <label>72</label>
      <mixed-citation publication-type="journal"><name><surname>Engwer</surname><given-names>C</given-names></name>, <name><surname>Nüßing</surname><given-names>A</given-names></name>. <article-title>Geometric Reconstruction of Implicitly Defined Surfaces and Domains with Topological Guarantees</article-title>. <source>ACM Transactions on Mathematical Software (TOMS)</source>. <year>2017</year>;<volume>44</volume>(<issue>2</issue>):<fpage>14</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1145/3104989</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref073">
      <label>73</label>
      <mixed-citation publication-type="journal"><name><surname>Aydin</surname><given-names>Ü</given-names></name>, <name><surname>Vorwerk</surname><given-names>J</given-names></name>, <name><surname>Küpper</surname><given-names>P</given-names></name>, <name><surname>Heers</surname><given-names>M</given-names></name>, <name><surname>Kugel</surname><given-names>H</given-names></name>, <name><surname>Galka</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Combining EEG and MEG for the reconstruction of epileptic activity using a calibrated realistic volume conductor model</article-title>. <source>PLoS One</source>. <year>2014</year>;<volume>9</volume>(<issue>3</issue>):<fpage>e93154</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0093154</pub-id><?supplied-pmid 24671208?><pub-id pub-id-type="pmid">24671208</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref074">
      <label>74</label>
      <mixed-citation publication-type="journal"><name><surname>Antonakakis</surname><given-names>M</given-names></name>, <name><surname>Schrader</surname><given-names>S</given-names></name>, <name><surname>Aydin</surname><given-names>Ü</given-names></name>, <name><surname>Khan</surname><given-names>A</given-names></name>, <name><surname>Gross</surname><given-names>J</given-names></name>, <name><surname>Zervakis</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Inter-Subject Variability of Skull Conductivity and Thickness in Calibrated Realistic Head Models</article-title>. <source>NeuroImage</source>. <year>2020</year>;<volume>223</volume>:<fpage>117353</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.neuroimage.2020.117353</pub-id><?supplied-pmid 32919058?><pub-id pub-id-type="pmid">32919058</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref075">
      <label>75</label>
      <mixed-citation publication-type="journal"><name><surname>Allison</surname><given-names>T</given-names></name>, <name><surname>McCarthy</surname><given-names>G</given-names></name>, <name><surname>Wood</surname><given-names>CC</given-names></name>, <name><surname>Jones</surname><given-names>SJ</given-names></name>. <article-title>Potentials evoked in human and monkey cerebral cortex by stimulation of the median nerve: a review of scalp and intracranial recordings</article-title>. <source>Brain</source>. <year>1991</year>;<volume>114</volume>(<issue>6</issue>):<fpage>2465</fpage>–<lpage>2503</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/brain/114.6.2465</pub-id><?supplied-pmid 1782527?><pub-id pub-id-type="pmid">1782527</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref076">
      <label>76</label>
      <mixed-citation publication-type="journal"><name><surname>Nakamura</surname><given-names>A</given-names></name>, <name><surname>Yamada</surname><given-names>T</given-names></name>, <name><surname>Goto</surname><given-names>A</given-names></name>, <name><surname>Kato</surname><given-names>T</given-names></name>, <name><surname>Ito</surname><given-names>K</given-names></name>, <name><surname>Abe</surname><given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Somatosensory homunculus as drawn by MEG</article-title>. <source>Neuroimage</source>. <year>1998</year>;<volume>7</volume>(<issue>4</issue>):<fpage>377</fpage>–<lpage>386</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1006/nimg.1998.0332</pub-id><?supplied-pmid 9626677?><pub-id pub-id-type="pmid">9626677</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref077">
      <label>77</label>
      <mixed-citation publication-type="other">Dachwitz A. Accurate Methods to Compute the MEG Forward Problem [Master’s thesis]. Westfälische Wilhelms-Universität Münster; 2019. Available from: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.sci.utah.edu/~wolters/PaperWolters/2019/MasterDachwitz.pdf" ext-link-type="uri">http://www.sci.utah.edu/~wolters/PaperWolters/2019/MasterDachwitz.pdf</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0252431.ref078">
      <label>78</label>
      <mixed-citation publication-type="book"><name><surname>Medani</surname><given-names>T</given-names></name>, <name><surname>Garcia-Prieto</surname><given-names>J</given-names></name>, <name><surname>Tadel</surname><given-names>F</given-names></name>, <name><surname>Schrader</surname><given-names>S</given-names></name>, <name><surname>Antonakakis</surname><given-names>M</given-names></name>, <name><surname>Joshi</surname><given-names>A</given-names></name>, <etal>et al</etal>. <chapter-title>Realistic head modeling of electromagnetic brain activity: an integrated Brainstorm-DUNEuro pipeline from MRI data to the FEM solutions</chapter-title>. In: <source>Medical Imaging 2021: Physics of Medical Imaging</source>. <volume>vol. 11595</volume>. <publisher-name>International Society for Optics and Photonics. SPIE</publisher-name>; <year>2021</year>. p. <fpage>1369</fpage>—<lpage>1376</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0252431.ref079">
      <label>79</label>
      <mixed-citation publication-type="journal"><name><surname>Dmochowski</surname><given-names>JP</given-names></name>, <name><surname>Datta</surname><given-names>A</given-names></name>, <name><surname>Bikson</surname><given-names>M</given-names></name>, <name><surname>Su</surname><given-names>Y</given-names></name>, <name><surname>Parra</surname><given-names>LC</given-names></name>. <article-title>Optimized multi-electrode stimulation increases focality and intensity at target</article-title>. <source>Journal of neural engineering</source>. <year>2011</year>;<volume>8</volume>(<issue>4</issue>):<fpage>046011</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1088/1741-2560/8/4/046011</pub-id><?supplied-pmid 21659696?><pub-id pub-id-type="pmid">21659696</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0252431.ref080">
      <label>80</label>
      <mixed-citation publication-type="other">Khan A, Antonakakis M, Vogenauer N, Wollbrink A, Suntrup-Krüger S, Schneider T, et al. Constrained maximum intensity optimized multi-electrode tDCS targeting of human somatosensory network. In: 41st Annual Internatio-nal Conference of the IEEE Engineering in Medicine and Biology Society (EMBC); 2019. p. 5894–5897.</mixed-citation>
    </ref>
  </ref-list>
</back>
