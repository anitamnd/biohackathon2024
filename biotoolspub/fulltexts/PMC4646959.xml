<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Genet</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Genet</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Genet.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1664-8021</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4646959</article-id>
    <article-id pub-id-type="doi">10.3389/fgene.2015.00329</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Genetics</subject>
        <subj-group>
          <subject>Original Research</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>riboFrame: An Improved Method for Microbial Taxonomy Profiling from Non-Targeted Metagenomics</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ramazzotti</surname>
          <given-names>Matteo</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="author-notes" rid="fn001">
          <sup>*</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/251895/overview"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Berná</surname>
          <given-names>Luisa</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/266309/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Donati</surname>
          <given-names>Claudio</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/265658/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cavalieri</surname>
          <given-names>Duccio</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
        <xref ref-type="author-notes" rid="fn001">
          <sup>*</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/266940/overview"/>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <sup>1</sup>
      <institution>Dipartimento di Scienze Biomediche Sperimentali e Cliniche, Università degli Studi di Firenze</institution>
      <country>Firenze, Italy</country>
    </aff>
    <aff id="aff2">
      <sup>2</sup>
      <institution>Unidad de Biología Molecular, Institut Pasteur de Montevideo</institution>
      <country>Montevideo, Uruguay</country>
    </aff>
    <aff id="aff3">
      <sup>3</sup>
      <institution>Centre for Research and Innovation, Fondazione Edmund Mach</institution>
      <country>San Michele all’Adige, Italy</country>
    </aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p>Edited by: <italic>Alejandro Sanchez-Flores, Universidad Nacional Autonoma de Mexico, Mexico</italic></p>
      </fn>
      <fn fn-type="edited-by">
        <p>Reviewed by: <italic>Philippe Rocca-Serra, Oxford e-Research Centre, UK; Cuncong Zhong, J. Craig Venter Institute, USA</italic></p>
      </fn>
      <corresp id="fn001">*Correspondence: <italic>Matteo Ramazzotti, <email xlink:type="simple">matteo.ramazzotti@unifi.it</email>; Duccio Cavalieri, <email xlink:type="simple">duccio.cavalieri@unifi.it</email></italic></corresp>
      <fn fn-type="other" id="fn002">
        <p>This article was submitted to Bioinformatics and Computational Biology, a section of the journal Frontiers in Genetics</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>11</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2015</year>
    </pub-date>
    <volume>6</volume>
    <elocation-id>329</elocation-id>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>7</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>10</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2015 Ramazzotti, Berná, Donati and Cavalieri.</copyright-statement>
      <copyright-year>2015</copyright-year>
      <copyright-holder>Ramazzotti, Berná, Donati and Cavalieri</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) or licensor are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Non-targeted metagenomics offers the unprecedented possibility of simultaneously investigate the microbial profile and the genetic capabilities of a sample by a direct analysis of its entire DNA content. The assessment of the microbial taxonomic composition is frequently obtained by mapping reads to genomic databases that, although growing, are still limited and biased. Here we present riboFrame, a novel procedure for microbial profiling based on the identification and classification of 16S rDNA sequences in non-targeted metagenomics datasets. Reads overlapping the 16S rDNA genes are identified using Hidden Markov Models and a taxonomic assignment is obtained by naïve Bayesian classification. All reads identified as ribosomal are coherently positioned in the 16S rDNA gene, allowing the use of the topology of the gene (i.e., the secondary structure and the location of variable regions) to guide the abundance analysis. We tested and verified the effectiveness of our method on simulated ribosomal data, on simulated metagenomes and on a real dataset. riboFrame exploits the taxonomic potentialities of the 16S rDNA gene in the context of non-targeted metagenomics, giving an accurate perspective on the microbial profile in metagenomic samples.</p>
    </abstract>
    <kwd-group>
      <kwd>16S rDNA gene</kwd>
      <kwd>community profiling</kwd>
      <kwd>metagenomics</kwd>
      <kwd>non-targeted approach</kwd>
      <kwd>short reads</kwd>
      <kwd>variable region</kwd>
    </kwd-group>
    <counts>
      <fig-count count="4"/>
      <table-count count="4"/>
      <equation-count count="0"/>
      <ref-count count="28"/>
      <page-count count="12"/>
      <word-count count="0"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>Introduction</title>
    <p>Recent years have witnessed the application of next generation sequencing (NGS) technologies to microbial community analyses, providing for the first time information on the taxonomic composition of microbial communities from a variety of different environments, the most noticeable being the human body.</p>
    <p>The consolidated strategy for microbial profiling is to apply NGS on target regions of the 16S rDNA gene, the reference molecular marker for prokaryotes (<xref rid="B28" ref-type="bibr">Woese and Fox, 1977</xref>; <xref rid="B6" ref-type="bibr">De Filippo et al., 2010</xref>). Despite their power, it has recently been shown that targeted approaches might introduce sequencing artifacts, due to unbalanced amplification (<xref rid="B10" ref-type="bibr">Engelbrektson et al., 2010</xref>) or the formation of chimeric amplicons (<xref rid="B12" ref-type="bibr">Haas et al., 2011</xref>) or biases due to the inability of the universal primers to evenly amplify the 16S variable regions at all taxonomic ranks (<xref rid="B13" ref-type="bibr">Hamady and Knight, 2009</xref>). In addition, a further source of bias is introduced by the limited read length of NGS technologies that does not allow sequencing of the full 16S rDNA gene (<xref rid="B4" ref-type="bibr">Conlan et al., 2012</xref>).</p>
    <p>Non-targeted metagenomics uses NGS techniques to sequence the whole genome content of an environmental sample and therefore does not depend on prior target selection (<xref rid="B23" ref-type="bibr">Riesenfeld et al., 2004</xref>; <xref rid="B7" ref-type="bibr">De Filippo et al., 2012</xref>; <xref rid="B5" ref-type="bibr">Dark, 2013</xref>). Such techniques are less affected by amplification biases, since they generally rely on less PCR cycles with perfect universal primers. Despite this, highly divergent GC content of the inserts may inherently show a different amplification efficiency, so recent amplification-free protocols or other modifications have been proposed. Although the primary use of non-targeted approaches is the profiling of the metabolic potential of microbial communities, they can also be used to assess relative species abundance using heuristic searches against reference genomes or other sequence databanks such as the NCBI non-redundant database (<xref rid="B25" ref-type="bibr">Segata et al., 2012</xref>; <xref rid="B15" ref-type="bibr">Huson and Weber, 2013</xref>). However, genome sequence databanks are based on a limited, although growing, number of organisms for which a genome has been entirely sequenced, giving an inherent bias to microbial profiling. A second drawback is that often genome information for unknown or novel genes is incomplete or error prone, due to the limitations in several of the sequence assembly tools available for large-scale NGS data (<xref rid="B26" ref-type="bibr">Vázquez-Castellanos et al., 2014</xref>).</p>
    <p>Recently, several tools have been developed to identify ribosome-associated reads in non-targeted metagenomic samples, exploiting the constantly increasing coverage of the entire microbial kingdom provided by 16S rDNA databanks such as RDP (<xref rid="B3" ref-type="bibr">Cole et al., 2013</xref>), GreenGenes (<xref rid="B8" ref-type="bibr">DeSantis et al., 2006</xref>) or SILVA (<xref rid="B21" ref-type="bibr">Quast et al., 2012</xref>). These tools use profile stochastic context-free grammars (<xref rid="B20" ref-type="bibr">Nawrocki et al., 2009</xref>), Burrows–Wheeler indexing (<xref rid="B17" ref-type="bibr">Li and Durbin, 2010</xref>), BLAST-like heuristics or hidden Markov models (<xref rid="B14" ref-type="bibr">Hartmann et al., 2010</xref>; <xref rid="B16" ref-type="bibr">Lee et al., 2011</xref>). The main aim of these algorithms is to identify reads of ribosomal origin and remove them from metagenomics datasets, in order to facilitate the functional analysis of the remaining reads. No explicit use of these ribosomal reads is generally implemented or suggested.</p>
    <p>A new tool named EMIRGE was developed (<xref rid="B18" ref-type="bibr">Miller et al., 2011</xref>) with the aim of reconstructing full-length 16S rDNA genes from metagenomes using recruitment and avoiding assembly (being the assembly of the 16S rDNA gene inherently difficult because it contains highly conserved regions mixed to extremely variable regions). Ribosomal reads are recruited by mapping on a 16S gene dataset and then the mapping is iteratively refined with Bayesian expectation-maximization, until full-length 16S genes have been associated to a set of reads. However, this approach heavily relies on the accuracy and completeness of the reference databases and therefore risks to converge to fairly uncharacterized genes, with limited significant improvement of the resolution of taxonomic profiling.</p>
    <p>In this work, we introduce riboFrame, a novel method that combines optimized read recruitment with naïve Bayesian classification to provide an automatic, database-free system for microbial abundance analysis in non-targeted (so only marginally biased) metagenomics datasets. Our tool efficiently identifies ribosomal reads from metagenomic datasets and associates them to a position onto the 16S rDNA genes, leaving the user with the possibility to select the different regions of the 16S gene to be used for the taxonomic characterization of the sample. Since riboFrame does not attempt to reconstruct full-length sequences of the 16S rDNA genes, the taxonomic profiling obtained from the different variable regions can be studied separately and compared, giving the opportunity to use non-targeted metagenomic dataset as pre-screening for more focused targeted approaches. The method has been applied on simulated and real datasets demonstrating that riboFrame is a fast, efficient and intuitive tool that provides an accurate, 16S-based microbial taxonomy characterization from non-targeted metagenomic data.</p>
  </sec>
  <sec sec-type="materials|methods" id="s1">
    <title>Materials and Methods</title>
    <sec>
      <title>Description of the riboFrame Procedures</title>
      <p>The riboFrame pipeline is composed of two perl scripts (riboTrap and riboMap) and two widely used programs. The final goal is to map Illumina short reads on the 16S gene and then target rank abundance estimates from otherwise non-targeted metagenomic sequencing.</p>
      <p>As depicted in <bold>Figure <xref ref-type="fig" rid="F1">1</xref></bold>, the riboFrame pipeline starts after raw Illumina data have been pre-processed for quality control and the procedure involved four steps that will be hereinafter described.</p>
      <fig id="F1" position="float">
        <label>FIGURE 1</label>
        <caption>
          <p><bold>Scheme of the riboFrame.</bold> After QC of next generation sequencing (NGS) reads, the hmmsearch (HMMER3) is used to identify 16S ribosomal reads in both bacteria and archaea, using HMMs developed in rRNAselector (step 1). The riboTrap program then filters out incongruent assignments and de-replicate multiple assignments in order to create a set of accurate 16S reads supplemented with positional information (step 2). 16S reads are then classified using RDPclassifier to obtain a full domain to genus classification (step 3). The riboMap program eventually filters reads according to rules specified by the user, with a flexible and intuitive scheme, and performs the final rank abundance analyses (step 4). For a detailed description see the section “Materials and Methods – Description of the riboFrame Procedures.”</p>
        </caption>
        <graphic xlink:href="fgene-06-00329-g001"/>
      </fig>
      <list list-type="simple">
        <list-item>
          <label>(1)</label>
          <p>Identification. The hmmsearch command from the HMMER3 package (<xref rid="B9" ref-type="bibr">Eddy, 2011</xref>) is issued separately on reads files (single end or paired end) using the HMMs for 16S rDNA gene of bacteria and archaea developed in the rRNAselector (<xref rid="B16" ref-type="bibr">Lee et al., 2011</xref>) project. The <italic>E</italic>-value threshold is set to 1E-5, according to specifications in rRNAselector, all other parameters are left to their default values. The program emits, for each file, several tables with identifiers of reads associated to 16S rDNA and, among others, the position of matching on the model.</p>
        </list-item>
        <list-item>
          <label>(2)</label>
          <p>Preparation. The riboTrap script elaborates the results of hmmsearch, performing a quality control (minimal length, multiple assignment, coherent strand positioning, <italic>E</italic>-value) and preparing non-redundant fasta-formatted files for further processing. Fasta headers are reformatted to include the position of the read in the 16S model. riboTrap also measures the coverage of the 16S gene achieved by the extracted reads and optionally creates coverage plots using functions from the graphics package of the R statistical environment.</p>
        </list-item>
        <list-item>
          <label>(3)</label>
          <p>Taxonomic assignment. A classification is performed on the 16S ribosomal reads using the local version of RDPclassifier (current version 2.10.1) from the Ribosomal Database Project (<xref rid="B27" ref-type="bibr">Wang et al., 2007</xref>) that emits, for each read, a full domain-to-genus classification with bootstrap-based confidence values for each called taxonomic rank.</p>
        </list-item>
        <list-item>
          <label>(4)</label>
          <p>Selection/abundance analysis. The riboMap script elaborates the output of RDPclassifier and, according to user criteria and targets, builds abundance calculations for each taxonomic rank (optionally creating barplots for immediate evaluation of the results). User criteria include thresholds for assignment confidence and for abundance levels. A scoring scheme have been introduced to avoid over-fitting in case of paired end data. For single end data, each read receives a weight of 1. In case of paired end reads, the increase of abundance is weighted at each specific rank: if just one pair is recruited as ribosomal, it is considered a singleton and weighted 1 as in single pair. If both pairs have been recruited as ribosomal, their weight is decreased to 0.5 so that their combined weight is 1 only if they converge to the same assignment. It should be underlined that the possibility of having both reads recruited as ribosomal is a rare event since the 16S rDNA gene length (around 1500 bp) cannot easily accommodate the full length covered by the two reads of 100 bp considering the insert size that frequently averages to 4–500 bp (for a total length of ∼6–700 bp). Variable region targeting is the main feature of riboTrap and is implemented in riboMap. By default, the program considers belonging of a given region a read that contains or is contained in that region, although options are given to alter region boundaries of specific, user defined, amounts (see <bold>Supplementary Figure <xref ref-type="supplementary-material" rid="SM1">S1</xref></bold>). The position of variable regions have been hard-coded in the script and can be referenced simply with VX (with X in the 1–9 range) or with position ranges, and a flexible syntax has been thought to facilitate user selection. Once the selection is done, reads outside the target regions are discarded and those in the target are used to compute the abundances at the various ranks using the scoring scheme explained above. Optionally, abundance plots are emitted as well as a coverage plot to verify the efficacy of the targeting.</p>
        </list-item>
      </list>
      <p>All the steps indicated above have a processing time that scales linearly with the number of reads and use very little memory. hmmsearch can be parallelized to take full advantage of multi-core processors or other parallelization strategies. This, coupled to the little memory consumption, makes the riboFrame approach very rapid, efficient in resources and and easily scalable. All the experiments described in this work were produced and analyzed on a Lenovo T420 Laptop equipped with an Intel<sup>®</sup> Core<sup>TM</sup> i7-2620M CPU at 2.70 GHz and 8 Gb 1333 MHz RAM.</p>
      <p>The riboFrame scripts, manuals and detailed instructions are freely available at the riboFrame Project website<sup><xref ref-type="fn" rid="fn01">1</xref></sup> or at github (with repository name “matteoramazzotti/riboFrame”).</p>
      <p>See supplementary information for a table reporting all the accession codes for the datasets used in this work.</p>
    </sec>
    <sec>
      <title>Simulation of Ribosomal Reads</title>
      <p>A dataset of 16S genes for Bacteria and Archaea was obtained from the RDP database in unaligned GenBank format. The files were processed to create associations between individual sequences and complete lineage of the organisms. A perl script (available from the riboFrame websites) was used to randomly extract 100 bp regions from species (strains) belonging to all genera. For creating the “Full” dataset, one read for each species (strains) associated to a genus was extracted, for the “Curated” dataset 100 species per genus were randomly chosen.</p>
    </sec>
    <sec>
      <title>Simulation of Metagenomics Reads</title>
      <p>Metagenomics datasets were created using MetaSim (<xref rid="B22" ref-type="bibr">Richter et al., 2008</xref>) fed by all NCBI microbial complete genomes and NCBI taxonomy. The taxonomic profile for species selection was arbitrarily built to maintain a proportion between bacteria and archaea of about 10:1. We also filtered organisms to ensure that a full taxonomic classification could be given to each species according to the Bergey’s taxonomic outline (<xref rid="B27" ref-type="bibr">Wang et al., 2007</xref>) used by RDPclassifier. The number of genera actually represented in the reads resulted to be 307 and their proportions reflect that of completely sequenced microbial genomes.</p>
      <p>Three 100 bp paired-end reads set consisting of 2, 4, and 10 millions of reads (termed 1, 2 and 5 M, respectively) were created using an Illumina-specific read error model from Plantagora<sup><xref ref-type="fn" rid="fn02">2</xref></sup>. Each read was mapped on the corresponding genome to determine if it was extracted from a ribosomal operon, so that we could build a testing ground for riboTrap evaluation.</p>
    </sec>
    <sec>
      <title>Preparation of the Datasets from Human Microbiome Project</title>
      <p>From HMPDACC site, we selected a case study, the stool sample SRS011061, for which the pyrosequencing reads for the 16S V1–V3 region (SRX020621, 9019 reads and SRX020603, 6864 reads) and V3–V5 region (SRX0200622, 8888 reads and SRX020602, 8422 reads), and the pre-processed Illumina paired-ends reads (sample SRS011061 61478987 reads for pair 1, 28606567 reads for pair 2) were downloaded from NBI SRA and HMPDACC, respectively. Both 16S reads and Illumina reads were downloaded as datasets pre-processed according to Human Microbiome Project (HMP) guidelines (please consult the 16S_SOP.pdf and ReadProcessing_SOP.pdf documents available at <ext-link ext-link-type="uri" xlink:href="http://hmpdacc.org">hmpdacc.org</ext-link> for further details). We then joined the reads targeting the same region to create two main sequence set, namely V1–V3 (14670 reads) and V3–V5 (14734 reads). Their taxonomic classification of pyrosequencing reads was obtained with RDPclassifier (<xref rid="B27" ref-type="bibr">Wang et al., 2007</xref>) with a confidence threshold of 80% and an abundance calculation at the different taxonomic ranks was performed. Illumina reads were processed with our riboFrame method, targeting the V1–V3 and V3–V5 regions in order to create results comparable with those obtained with the pyrosequencing experiments.</p>
    </sec>
    <sec>
      <title>Configuration of Other 16S Ribosomal Read Extractors</title>
      <p>For Infernal, we obtained calibrated covariance models from RFAM (<xref rid="B11" ref-type="bibr">Gardner et al., 2010</xref>) for the 16S gene of bacteria (RF00177) and archaea (RF01959), we then used the Infernal cmscan command for the actual read recruitment with an <italic>E</italic>-value cutoff of 10<sup>-5</sup> (i.e., the same threshold used in hmmsearch). For V-Xtractor we used default values (including the suggested SSU HMM-specific <italic>E</italic>-values) and we considered as “extracted” all reads that had matches in at least one of the HMMs spanning the flanks of the variable regions, despite their length. For metaxa we used default values (but we excluded pre-clustering with MAFFT) and we considered as of ribosomal origin also sequences attributed to mitochondria and chloroplasts. In all cases, for comparison purposes, we used just 1 CPU core to test the speed of the algorithms, but it should be underlined that all methods can be run in multi-core systems. For EMIRGE, both paired-ends reads of the HMP sample SRS011061 were used using -l 100 -i 300 -s 100 as command line parameters and the SILVA database provided with the program (indexed with Bowtie, according to EMIRGE manual.) as a reference. The abundance was eventually extracted from the “Prior” field of each sequence identifier after the last iteration.</p>
    </sec>
  </sec>
  <sec>
    <title>Results</title>
    <sec>
      <title>Description of the riboFrame Pipeline</title>
      <p>The riboFrame pipeline (<bold>Figure <xref ref-type="fig" rid="F1">1</xref></bold>) builds upon HMMER (<xref rid="B9" ref-type="bibr">Eddy, 2011</xref>), the most efficient HMM-driven engine for sequence search and RDPclassifier, the reference naïve Bayesian classifier for metagenomics (<xref rid="B27" ref-type="bibr">Wang et al., 2007</xref>). The procedure starts with the HMMER3 hmmsearch program that, trained with several models of the 16S gene of bacteria and archaea based on curated databases of sequences of 16S rDNA genes aligned using secondary structure models (<xref rid="B16" ref-type="bibr">Lee et al., 2011</xref>), captures ribosomal reads from the mass of reads from Illumina metagenomic sequencing. The riboTrap program extracts the ribosomal reads that are then classified (from domain to genus level) using RDPclassifier that emits for each identified rank a bootstrap-based confidence value between 0 and 1.</p>
      <p>The second part of the pipeline, riboMap, takes advantage of the localization of the ribosomal reads in the 16S rDNA gene (the topology) integrated by the confidence score from Bayesian classification to optionally include/exclude specific regions (both constant or variable, see <bold>Supplementary Figure <xref ref-type="supplementary-material" rid="SM1">S1</xref></bold>) or low accuracy predictions, creating in the end a domain to genus abundance analysis.</p>
      <p>The coverage of the 16S rDNA gene after region selection can be optionally checked by coverage plots (<bold>Figure <xref ref-type="fig" rid="F2">2</xref></bold>) produced by riboTrap, that allows to evaluate whether a sufficient number of reads are available for classification.</p>
      <fig id="F2" position="float">
        <label>FIGURE 2</label>
        <caption>
          <p><bold>Coverage of the 16S gene achieved with reads form the Human Microbiome Project (HMP) sample SRS011061 extracted with HMM and topology-annotated by riboTrap.</bold> The trace represent the cumulative coverage for both paired-end reads after riboTrap processing. Shaded areas identify variable regions that are labeled form V1–V9 in the upper horizontal axis.</p>
        </caption>
        <graphic xlink:href="fgene-06-00329-g002"/>
      </fig>
    </sec>
    <sec>
      <title>Testing Ribosomal Recruitment with Ribosomal Reads Set</title>
      <p>One of the key points to be evaluated concerns the efficiency of recovering ribosomal reads from the pool of non-targeted reads. To assess this aspect we designed two different strategies based on the random extraction of 100 bp reads from the sequences of the 16S genes present in the RDP database (<xref rid="B3" ref-type="bibr">Cole et al., 2013</xref>). The RDP database was filtered to include only high quality sequences from prokaryotes that could be unambiguously annotated to the genus rank by the RDPclassifier program according to the Bergey’s Taxonomic Outline of the Prokaryotes (<xref rid="B27" ref-type="bibr">Wang et al., 2007</xref>), resulting in a diversity of 1767 bacterial and 103 archeal genera.</p>
      <p>Two different sets of reads were extracted. The first set (named “Random”) contained one read per gene of all species assigned to each genus (347174 reads) and was intended to exhaustively explore the recruitment capability of riboFrame. The second, more uniform set (named “Curated”), contained 100 reads per genus selected randomly from sequences classified by RDPclassifier with 100% confidence at the genus level (187000 reads) and was designed to further evaluate the accuracy of the taxonomic classification obtained by riboFrame.</p>
      <p>We then evaluated the efficiency of HMMER to align those reads against the 16S HMM for archaea and bacteria (<xref rid="B16" ref-type="bibr">Lee et al., 2011</xref>). 308676 reads (88.92%) and 182686 reads (97.69%) were identified as ribosomal for the “Random” and the “Curated” set, respectively (see <bold>Table <xref ref-type="table" rid="T1">1</xref></bold>). This 3–11% loss was found to involve reads located nearby position 200 (using the <italic>Escherichia coli</italic> 16S gene as a reference, see <bold>Supplementary Figure <xref ref-type="supplementary-material" rid="SM1">S2A</xref></bold>), possibly indicating that this region (encompassing variable regions 1 and 2) of the HMMs is less accurate or intrinsically more variable. In the “Curated” set we also found that more than 90% of genera had at least 90% reads correctly identified as ribosomal (<bold>Supplementary Figure <xref ref-type="supplementary-material" rid="SM1">S2B</xref></bold>), with only slightly reduced performances in the “Random” dataset. No evident signs of biases were present at any taxonomic rank (data not shown) confirming the efficacy of our detection strategy independently from the underlying taxonomic structure. We then proceeded with the classification of the reads with RDPclassifier, according to the riboFrame pipeline. As shown in <bold>Table <xref ref-type="table" rid="T2">2</xref></bold>, we found that the amount of reads classifiable with a 0.8 bootstrap confidence was ∼40%, a percentage closely related to the proportion of the full 16S rDNA gene that is included in the variable V1–V9 regions (i.e., the ones with the highest taxonomic information content), and that the accuracy of the classification was 90.17% on 74110 reads at the genus level (97.38% on 112049 reads at the family level) for the “Curated” dataset and 92.76% on 143287 reads at the genus level (97.10% on 112094 reads at the family level) for the “Random” dataset. These results confirmed that riboFrame can use reads as short as 100 bp to provide a reliable estimate of the taxonomic structure of metagenomic datasets.</p>
      <table-wrap id="T1" position="float">
        <label>Table 1</label>
        <caption>
          <p>Result of the extraction of ribosomal reads from the simulated datasets “Random” and “Curated.”</p>
        </caption>
        <table frame="hsides" rules="groups" cellspacing="5" cellpadding="5">
          <thead>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
              <th valign="top" align="center" rowspan="1" colspan="1">Random</th>
              <th valign="top" align="center" rowspan="1" colspan="1">Curated</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Original # reads</td>
              <td valign="top" align="center" rowspan="1" colspan="1">347174</td>
              <td valign="top" align="center" rowspan="1" colspan="1">187000</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Extracted by HMM</td>
              <td valign="top" align="center" rowspan="1" colspan="1">308686 (88.91%)</td>
              <td valign="top" align="center" rowspan="1" colspan="1">182687 (97.69%)</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Missed</td>
              <td valign="top" align="center" rowspan="1" colspan="1">38488 (11.09%)</td>
              <td valign="top" align="center" rowspan="1" colspan="1">4313 (2.31%)</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <table-wrap id="T2" position="float">
        <label>Table 2</label>
        <caption>
          <p>Results of the evaluation of riboFrame with true ribosomal reads.</p>
        </caption>
        <table frame="hsides" rules="groups" cellspacing="5" cellpadding="5">
          <thead>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
              <th valign="top" align="left" rowspan="1" colspan="1">Rank</th>
              <th valign="top" align="center" rowspan="1" colspan="1">% Correct</th>
              <th valign="top" align="center" rowspan="1" colspan="1">% Wrong</th>
              <th valign="top" align="center" rowspan="1" colspan="1"># Reads</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td valign="middle" align="center" rowspan="7" colspan="1">Curated</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Domain</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">179965</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Phylum</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.91</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.09</td>
              <td valign="top" align="center" rowspan="1" colspan="1">166673</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Class</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.62</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.38</td>
              <td valign="top" align="center" rowspan="1" colspan="1">156945</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Order</td>
              <td valign="top" align="center" rowspan="1" colspan="1">98.92</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.08</td>
              <td valign="top" align="center" rowspan="1" colspan="1">137750</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Family</td>
              <td valign="top" align="center" rowspan="1" colspan="1">97.38</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2.62</td>
              <td valign="top" align="center" rowspan="1" colspan="1">112094</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Genus</td>
              <td valign="top" align="center" rowspan="1" colspan="1">90.17</td>
              <td valign="top" align="center" rowspan="1" colspan="1">9.83</td>
              <td valign="top" align="center" rowspan="1" colspan="1">74110</td>
            </tr>
            <tr>
              <td valign="top" align="left" colspan="5" rowspan="1">
                <hr/>
              </td>
            </tr>
            <tr>
              <td valign="middle" align="center" rowspan="7" colspan="1">Random</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Domain</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">305417</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Phylum</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.97</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.03</td>
              <td valign="top" align="center" rowspan="1" colspan="1">293269</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Class</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.88</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.12</td>
              <td valign="top" align="center" rowspan="1" colspan="1">283741</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Order</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.14</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.86</td>
              <td valign="top" align="center" rowspan="1" colspan="1">248281</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Family</td>
              <td valign="top" align="center" rowspan="1" colspan="1">97.1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2.9</td>
              <td valign="top" align="center" rowspan="1" colspan="1">193589</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Genus</td>
              <td valign="top" align="center" rowspan="1" colspan="1">92.76</td>
              <td valign="top" align="center" rowspan="1" colspan="1">7.24</td>
              <td valign="top" align="center" rowspan="1" colspan="1">143287</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <attrib>
            <italic>After ribosomal reads recruitment, riboTrap is used to assign topology to reads and create 16S reads subsets. Such reads are classified with RDPClassifier and compared with the true taxonomy associated to each read. In this case, prediction accuracy is set to 0.8.</italic>
          </attrib>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>riboFrame Testing on Simulated Metagenomics Datasets</title>
      <p>In order to evaluate the overall performance and accuracy of the riboFrame pipeline we used the MetaSim software (<xref rid="B22" ref-type="bibr">Richter et al., 2008</xref>) to build three simulated paired-end metagenomics datasets with increasing size (2, 4, and 10 millions of reads, hereinafter 1, 2, and 5 M, respectively) and a common underlying taxonomic structure containing 1496 species from 307 genera.</p>
      <p>As shown in <bold>Table <xref ref-type="table" rid="T3">3</xref></bold>, the initial ribosomal reads screening with HMMER resulted in the detection of 3229, 6248, and 15532 ribosomal reads from the 1, 2, and 5 M dataset, respectively. The observed fraction of ribosomal reads in the pools was 0.15%, in agreement with a grand average estimation of ribosomal DNA proportion in the genomes of prokaryotes (data extracted from the NCBI Genome Database). The average extraction speed of 16S-associated reads was around 2 min 44 s per million of reads (using 4 CPU cores). We obtained, on average, a ∼90% sensitivity and a &gt; 99% specificity for ribosomal reads. Extracted reads were then classified with RDPclassifier and reads in variable regions were isolated with riboFrame (see the coverage plot for the three datasets in <bold>Supplementary Figure <xref ref-type="supplementary-material" rid="SM1">S3</xref></bold>). We found that the percent of reads assigned to the correct genus in the three datasets was (on average) 87% at a confidence level of 0.5 (on 30% of the total number of reads) and 95% at a confidence level of 0.8 (on 11.5% of the total number of reads).</p>
      <table-wrap id="T3" position="float">
        <label>Table 3</label>
        <caption>
          <p>Results of the evaluation of riboFrame with simulated metagenomics datasets.</p>
        </caption>
        <table frame="hsides" rules="groups" cellspacing="5" cellpadding="5">
          <thead>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
              <th valign="top" align="center" colspan="4" rowspan="1">Thr 0.5</th>
              <th valign="top" align="center" colspan="4" rowspan="1">Thr 0.8</th>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
              <th valign="top" align="center" colspan="4" rowspan="1">
                <hr/>
              </th>
              <th valign="top" align="center" colspan="4" rowspan="1">
                <hr/>
              </th>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
              <th valign="top" align="center" rowspan="1" colspan="1">Good</th>
              <th valign="top" align="center" rowspan="1" colspan="1">Error</th>
              <th valign="top" align="center" rowspan="1" colspan="1">Reads</th>
              <th valign="top" align="center" rowspan="1" colspan="1">Reads%</th>
              <th valign="top" align="center" rowspan="1" colspan="1">Good</th>
              <th valign="top" align="center" rowspan="1" colspan="1">Error</th>
              <th valign="top" align="center" rowspan="1" colspan="1">Reads</th>
              <th valign="top" align="center" rowspan="1" colspan="1">Reads%</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td valign="middle" align="center" rowspan="7" colspan="1">1M: 3228 reads</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Domain</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.97</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">3209</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100.00</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.97</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">3202</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100.00</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Phylum</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.59</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.37</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2943</td>
              <td valign="top" align="center" rowspan="1" colspan="1">91.71</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.95</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1994</td>
              <td valign="top" align="center" rowspan="1" colspan="1">62.27</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Class</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.69</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.27</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2568</td>
              <td valign="top" align="center" rowspan="1" colspan="1">80.02</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.93</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1467</td>
              <td valign="top" align="center" rowspan="1" colspan="1">45.82</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Order</td>
              <td valign="top" align="center" rowspan="1" colspan="1">97.83</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2.11</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1985</td>
              <td valign="top" align="center" rowspan="1" colspan="1">61.86</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.57</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.32</td>
              <td valign="top" align="center" rowspan="1" colspan="1">935</td>
              <td valign="top" align="center" rowspan="1" colspan="1">29.20</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Family</td>
              <td valign="top" align="center" rowspan="1" colspan="1">94.14</td>
              <td valign="top" align="center" rowspan="1" colspan="1">5.8</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1517</td>
              <td valign="top" align="center" rowspan="1" colspan="1">47.27</td>
              <td valign="top" align="center" rowspan="1" colspan="1">98.09</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.77</td>
              <td valign="top" align="center" rowspan="1" colspan="1">678</td>
              <td valign="top" align="center" rowspan="1" colspan="1">21.17</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Genus</td>
              <td valign="top" align="center" rowspan="1" colspan="1">88.25</td>
              <td valign="top" align="center" rowspan="1" colspan="1">11.64</td>
              <td valign="top" align="center" rowspan="1" colspan="1">944</td>
              <td valign="top" align="center" rowspan="1" colspan="1">29.42</td>
              <td valign="top" align="center" rowspan="1" colspan="1">95.57</td>
              <td valign="top" align="center" rowspan="1" colspan="1">4.16</td>
              <td valign="top" align="center" rowspan="1" colspan="1">360</td>
              <td valign="top" align="center" rowspan="1" colspan="1">11.24</td>
            </tr>
            <tr>
              <td valign="top" align="left" colspan="10" rowspan="1">
                <hr/>
              </td>
            </tr>
            <tr>
              <td valign="middle" align="center" rowspan="7" colspan="1">2M: 6247 reads</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Domain</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.95</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.03</td>
              <td valign="top" align="center" rowspan="1" colspan="1">6227</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100.00</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.97</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.02</td>
              <td valign="top" align="center" rowspan="1" colspan="1">6206</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100.00</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Phylum</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.75</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.23</td>
              <td valign="top" align="center" rowspan="1" colspan="1">5711</td>
              <td valign="top" align="center" rowspan="1" colspan="1">91.71</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.95</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.03</td>
              <td valign="top" align="center" rowspan="1" colspan="1">3833</td>
              <td valign="top" align="center" rowspan="1" colspan="1">61.76</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Class</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.6</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.38</td>
              <td valign="top" align="center" rowspan="1" colspan="1">5005</td>
              <td valign="top" align="center" rowspan="1" colspan="1">80.38</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.97</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2872</td>
              <td valign="top" align="center" rowspan="1" colspan="1">46.28</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Order</td>
              <td valign="top" align="center" rowspan="1" colspan="1">98.38</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.6</td>
              <td valign="top" align="center" rowspan="1" colspan="1">3940</td>
              <td valign="top" align="center" rowspan="1" colspan="1">63.27</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.84</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.11</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1867</td>
              <td valign="top" align="center" rowspan="1" colspan="1">30.08</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">family</td>
              <td valign="top" align="center" rowspan="1" colspan="1">94.62</td>
              <td valign="top" align="center" rowspan="1" colspan="1">5.35</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2992</td>
              <td valign="top" align="center" rowspan="1" colspan="1">48.05</td>
              <td valign="top" align="center" rowspan="1" colspan="1">98.54</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.39</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1367</td>
              <td valign="top" align="center" rowspan="1" colspan="1">22.03</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Genus</td>
              <td valign="top" align="center" rowspan="1" colspan="1">88.03</td>
              <td valign="top" align="center" rowspan="1" colspan="1">11.92</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1895</td>
              <td valign="top" align="center" rowspan="1" colspan="1">30.43</td>
              <td valign="top" align="center" rowspan="1" colspan="1">95.99</td>
              <td valign="top" align="center" rowspan="1" colspan="1">3.87</td>
              <td valign="top" align="center" rowspan="1" colspan="1">722</td>
              <td valign="top" align="center" rowspan="1" colspan="1">11.63</td>
            </tr>
            <tr>
              <td valign="top" align="left" colspan="10" rowspan="1">
                <hr/>
              </td>
            </tr>
            <tr>
              <td valign="middle" align="center" rowspan="7" colspan="1">5M: 15531 reads</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Domain</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.98</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.01</td>
              <td valign="top" align="center" rowspan="1" colspan="1">15462</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100.00</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.99</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.01</td>
              <td valign="top" align="center" rowspan="1" colspan="1">15427</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100.00</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Phylum</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.69</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.3</td>
              <td valign="top" align="center" rowspan="1" colspan="1">14185</td>
              <td valign="top" align="center" rowspan="1" colspan="1">91.74</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.97</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.02</td>
              <td valign="top" align="center" rowspan="1" colspan="1">9626</td>
              <td valign="top" align="center" rowspan="1" colspan="1">62.40</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Class</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.6</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.4</td>
              <td valign="top" align="center" rowspan="1" colspan="1">12381</td>
              <td valign="top" align="center" rowspan="1" colspan="1">80.07</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.99</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">6994</td>
              <td valign="top" align="center" rowspan="1" colspan="1">45.34</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Order</td>
              <td valign="top" align="center" rowspan="1" colspan="1">98.16</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.83</td>
              <td valign="top" align="center" rowspan="1" colspan="1">9558</td>
              <td valign="top" align="center" rowspan="1" colspan="1">61.82</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.65</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.33</td>
              <td valign="top" align="center" rowspan="1" colspan="1">4558</td>
              <td valign="top" align="center" rowspan="1" colspan="1">29.55</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Family</td>
              <td valign="top" align="center" rowspan="1" colspan="1">94.01</td>
              <td valign="top" align="center" rowspan="1" colspan="1">5.98</td>
              <td valign="top" align="center" rowspan="1" colspan="1">7158</td>
              <td valign="top" align="center" rowspan="1" colspan="1">46.29</td>
              <td valign="top" align="center" rowspan="1" colspan="1">98.25</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.72</td>
              <td valign="top" align="center" rowspan="1" colspan="1">3318</td>
              <td valign="top" align="center" rowspan="1" colspan="1">21.51</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Genus</td>
              <td valign="top" align="center" rowspan="1" colspan="1">86.6</td>
              <td valign="top" align="center" rowspan="1" colspan="1">13.38</td>
              <td valign="top" align="center" rowspan="1" colspan="1">4551</td>
              <td valign="top" align="center" rowspan="1" colspan="1">29.43</td>
              <td valign="top" align="center" rowspan="1" colspan="1">93.69</td>
              <td valign="top" align="center" rowspan="1" colspan="1">6.25</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1742</td>
              <td valign="top" align="center" rowspan="1" colspan="1">11.29</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec>
      <title>A Real Life Metagenomics Dataset from HMP</title>
      <p>The performances of riboFrame were further evaluated using publicly available data from the HMP that, for many samples, provides Illumina-based metagenomics paired to microbial profiling with amplicon-based pyrosequencing. These data allow to correlate the taxonomic assignment and abundance estimates obtained from 16S amplicon based metagenomics to the results of methods, like riboFrame, based on non-targeted metagenomics. We selected a sample with known high complexity (SRS011061, a stool sample, since gut is widely accepted as one of the most diverse and rich habitat within the human body), for which the 16S profiling based on the V1–V3 and V3–V5 variable regions of the 16S rDNA gene, as well as Illumina non-targeted metagenomics data were available. We then used riboFrame to build microbial profiles from the latter and then compared the results with the former.</p>
    </sec>
    <sec>
      <title>riboTrap-processed Metagenomic Reads are in Agreement with 16S Targeted Pyrosequencing</title>
      <p>The hmmsearch/riboTrap procedure extracted a total of 63262 reads identified as belonging to the 16S gene from the pool of Illumina-based meatgenomics reads. The plot in <bold>Figure <xref ref-type="fig" rid="F2">2</xref></bold> shows good coverage of the target regions V1–V3 and V3–V5, suggesting that reads overlapping these regions can provide an accurate taxonomic profile of this sample. Ribosomal reads were then classified with RDPclassifier. riboMap identified 17691 reads overlapping the V1–V3 region and 23519 overlapping the V3–V5 region. The rank abundance analysis at 0.8 confidence threshold (shown in <bold>Figure <xref ref-type="fig" rid="F3">3</xref></bold>) demonstrated that, although differences existed, an excellent correlation was present at the genus level, the lower rank reachable with RDPclassifier, in the two regions. The correlation coefficient of abundance percent at the genus level in Illumina riboFrame-processed vs. pyrosequencing reads was 0.971 for the V1–V3 region and 0.942 for the V3–V5 region, confirming that riboFrame processing of non-targeted Illumina reads gives results comparable to those obtained with targeted pyrosequencing. As expected, ranks higher than genus resulted in much closer agreement between the two techniques (see <bold>Supplementary Figure <xref ref-type="supplementary-material" rid="SM1">S4</xref></bold>).</p>
      <fig id="F3" position="float">
        <label>FIGURE 3</label>
        <caption>
          <p><bold>Comparison of microbial profiling between riboFrame and 16S rDNA pyrosequencing on HMP sample SRS011061.</bold><bold>(Top)</bold> Barplots of genus-level abundance calculation on two 16S regions targeted by Illumina sequencing after the riboFrame processing. Left and right columns present results from 16S rDNA variable regions V1–V3 and V3–V5, respectively. Only genera accounting for at least 1% of the total classifiable reads are shown. <bold>(Bottom)</bold> Scatterplot depicting the full range of abundances % obtained with pyrosequencing (<italic>x</italic>-axis) and with riboFrame-processed Illumina reads (<italic>y</italic>-axis), along with a linear best fitting line (dashed). The Pearson correlation coefficient (R) of the two dataset is also present.</p>
        </caption>
        <graphic xlink:href="fgene-06-00329-g003"/>
      </fig>
    </sec>
    <sec>
      <title>Read Length and Confidence in Taxonomic Assignment</title>
      <p>In order to evaluate the performance of short reads in microbial classification with the naïve Bayesian methods, we first analyzed how read length affected the confidence of assignments at the different taxonomic ranks. For each rank, and at each read length, we analyzed the three central quartiles to ensure a correct quantification and representation (see the plots in <bold>Supplementary Figure <xref ref-type="supplementary-material" rid="SM1">S5</xref></bold>). As expected, at the domain level most reads can be assigned with high confidence (&gt;=0.8) even in reads as short as 60 bp (the minimal size imposed by QC-filters). The phylum-, order- and family level assignment showed a decrease of performances with a reasonable limit to 90 bp. As expected, at the genus level assignment was supported only for reads of maximum length, justifying the filter-by-length option offered by the riboTrap script of the riboFrame pipeline.</p>
      <p>To further evaluate the impact of the accuracy confidence limits on the number of reads identified as ribosomal and used in taxonomic classification, we next investigated how the number of accepted reads varied as a function of the increase in confidence score at the different taxonomic ranks. The data reported in <bold>Supplementary Figure <xref ref-type="supplementary-material" rid="SM1">S6</xref></bold> clearly show that at the family level, more than 60% of the reads have confidence score &gt;=0.8 while at the genus level the percent decreases to about 45%, a relatively high proportion taking into account that the length of the reads varied from 60 to 100 bp.</p>
    </sec>
    <sec>
      <title>Independent Evaluation of the 16S Variable Regions</title>
      <p>The previous analyses on read length did not take into account the fact that confidence is expected to vary along the 16S gene due to the presence of variable (highly informative, poorly conserved) and constant regions (less informative, highly conserved). We then took full advantage of the riboMap capability of inspecting different regions separately. We evaluated the distribution of RDPclassifier confidence scores at the genus rank in the nine variable regions, using a tolerance (i.e., the possibility of enlarging the window for reads recruitment, riboMap “tol” option) of 20% of the variable region length. As shown in <bold>Supplementary Figure S7</bold>, the regions V3–V5 are characterized by a higher proportion of high confidence scores (&gt;=0.8). A large body of literature indicates that different variable regions have different performances and biases toward certain groups of prokaryotes (<xref rid="B2" ref-type="bibr">Chakravorty et al., 2007</xref>). These results suggest that the V3 and V5 regions have superior classification ability with respect to others, at least in this sample and for the exemplification purposes of this analysis.</p>
      <p>We next evaluated how the taxonomic profiles changed using the different variable regions. We configured riboMap to include reads located in each variable regions separately with a tolerance (see above) of 20% and a confidence score higher than 0.8. We then studied the five most abundant taxonomy assignments for each rank. The results of the abundance analysis are shown in <bold>Figure <xref ref-type="fig" rid="F4">4</xref></bold>. Taken together, these results confirm that different regions have different abilities in identifying specific groups of bacteria, reinforcing the idea that an accurate selection of variable regions should be performed before amplicon-based sequencing experiments, especially in the case of studies specifically focused on specific classes of organisms.</p>
      <fig id="F4" position="float">
        <label>FIGURE 4</label>
        <caption>
          <p><bold>Taxonomic profiles of the HMP sample SRS011061 obtained with the nine variable regions independently.</bold> The top row shows a table with counts of accepted reads at the various taxonomic ranks in the different regions <bold>(left)</bold>, and a summary barplot showing the same information <bold>(right)</bold>. The following panels shows data obtained by considering only the five most abundant assignments for the different regions at the different taxonomic ranks.</p>
        </caption>
        <graphic xlink:href="fgene-06-00329-g004"/>
      </fig>
    </sec>
    <sec>
      <title>Comparison with Existing Tools</title>
      <p>In order to evaluate the performances of the extraction procedure we used the “Curated” dataset (187000 reads) for a comparative test against three previously published systems for identifying ribosomal reads, i.e., Infernal (<xref rid="B20" ref-type="bibr">Nawrocki et al., 2009</xref>), based on profile stochastic context-free grammars, metaxa (<xref rid="B1" ref-type="bibr">Bengtsson et al., 2011</xref>) and V-Xtractor (<xref rid="B14" ref-type="bibr">Hartmann et al., 2010</xref>), both HMM-driven systems. Since these tools are only designed to identify ribosomal associated reads in metagenomic datasets, but do not provide tools for taxonomic profiling, we compare the performances only for the identification step. Moreover, for comparison purposes (and to ensure the feasibility of our approach on average personal computers) the tests were performed on 1 CPU core. Default parameters were used for all programs.</p>
      <p>As shown in <bold>Table <xref ref-type="table" rid="T4">4</xref></bold>, V-Xtractor took more than 810 min to complete the extraction of reads and failed to recruit 1.52% ribosomal reads. Metaxa took 525 min and missed 15.20% of the ribosomal reads. Infernal took 2870 min and missed 1.14% of the ribosomal reads. Hmmsearch, optimized for riboFrame, completed the analysis in 30 min, missing 2.31% of the ribosomal reads. These results show that the riboFrame strategy is fast compared to other methods on large metagenomic datasets without significant loss of sensitivity.</p>
      <table-wrap id="T4" position="float">
        <label>Table 4</label>
        <caption>
          <p>Result of the extraction of ribosomal reads from the “Curated” ribosomal reads set (187000 reads) by various extractors.</p>
        </caption>
        <table frame="hsides" rules="groups" cellspacing="5" cellpadding="5">
          <thead>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
              <th valign="top" align="center" rowspan="1" colspan="1">Recruited</th>
              <th valign="top" align="left" rowspan="1" colspan="1">Error%</th>
              <th valign="top" align="left" rowspan="1" colspan="1">Time (min)<sup>∗∗</sup></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">riboFrame<sup>∗</sup></td>
              <td valign="top" align="center" rowspan="1" colspan="1">182687</td>
              <td valign="top" align="right" rowspan="1" colspan="1">2.31</td>
              <td valign="top" align="center" rowspan="1" colspan="1">30</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Infernal</td>
              <td valign="top" align="center" rowspan="1" colspan="1">184861</td>
              <td valign="top" align="right" rowspan="1" colspan="1">1.14</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2860</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">V-Xtractor</td>
              <td valign="top" align="center" rowspan="1" colspan="1">184161</td>
              <td valign="top" align="right" rowspan="1" colspan="1">1.52</td>
              <td valign="top" align="center" rowspan="1" colspan="1">810</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Metaxa</td>
              <td valign="top" align="center" rowspan="1" colspan="1">159632</td>
              <td valign="top" align="right" rowspan="1" colspan="1">15.20</td>
              <td valign="top" align="center" rowspan="1" colspan="1">525</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <attrib>
            <italic><sup>∗</sup>riboFrame uses HMMER hmmsearch as extractor.</italic>
          </attrib>
          <attrib>
            <italic><sup>∗∗</sup>Normalized to 1 CPU core of a Lenovo T420 laptop equipped with and Intel<sup>®</sup> Core<sup>TM</sup> i7-2620M CPU at 2.70 GHz and 8 Gb 1333 MHz RAM.</italic>
          </attrib>
        </table-wrap-foot>
      </table-wrap>
      <p>We then compared the performances of riboFrame to EMIRGE, that estimates the taxonomic structure of metagenomic samples from non-targeted sequencing via reconstruction of the full length 16S rDNA gene using reads recruitment and an expectation-maximization algorithm. EMIRGE took about 150 h to complete the analysis on our sample data set, using the SILVA-derived 16S database provided with the EMIRGE program as a reference. For comparison purposes, the resulting abundance table was compared with abundances obtained from pyrosequencing and riboFrame on the 16S rDNA V3–V5 regions. A shown in <bold>Supplementary Figure S8A</bold> the large majority (&gt;76%) of assignments converged to uncultured bacterial species (classified at the genus level at best), indicating that on our HMP dataset the advantage provided by the extremely time consuming assembly of the full 16S rDNA gene accomplished by EMIRGE to increase the classification resolution of metagenomic samples is limited. At higher ranks ranging from phylum to genus (see genus and family level classification in <bold>Supplementary Figure S8B</bold>), the estimated abundances were fairly similar to those obtained with riboFrame in a fraction of EMIRGE computational time.</p>
    </sec>
  </sec>
  <sec>
    <title>Discussion</title>
    <p>In this work we developed and evaluated a method for the microbial profiling of metagenomic samples via classification of 16S-derived reads recruited without explicit reference databases and selected based on their positioning (topology) on the 16S gene. The tool we developed, riboFrame, was designed to identify and position ribosomal reads among the huge number of short reads typical of Illumina-based metagenomic projects and to then proceed with taxonomic classification targeting variable regions of the 16S rDNA gene. The predicted abundances at the different ranks were in agreement with the results obtained from 16S amplicon pyrosequencing, especially if considering abundances above 1–2%. Other HMP samples were also tested, obtaining basically super-imposable results that in all cases confirmed the large agreement between riboFrame derived abundances and those obtained with targeted pyrosequencing (data not shown).</p>
    <p>The strategy adopted by riboFrame gives the possibility of deciding <italic>a posteriori</italic> the target region to be used for taxonomic classification. riboFrame provides an accurate taxonomic profiling of datasets produced with the target of characterizing the functional profile of microbial communities, allowing the simultaneous determination of the two in a single experiment. Additionally, using the throughput and multiplexing possibilities of Illumina-based technologies, this tool can be used in all cases when amplicon-based sequencing projects need and unbiased pre-screening of the diversity in the sample before deciding the region to address for taxonomic profiling, since it is known that different regions of the 16S gene have different taxonomic classification potentials and some are more adequate than others for specific families of bacteria present in different environments (<xref rid="B2" ref-type="bibr">Chakravorty et al., 2007</xref>).</p>
    <p>Our analysis on the taxonomic accuracy of 100 bp reads using the naïve Bayesian classifier showed that this size is sufficient to reach a confident genus assignment only in less than half of the reads. One may argue that this is a major limit of our approach based on short reads. Nevertheless, the sampling capacity of Illumina-based metagenomics proved to be sufficient to describe the microbial profile at the genus level, the lowest rank reachable by the Bayesian method. Considering that the increase of read length is one of the most demanding needs for NGS and that all companies have already improved their technologies to achieve this goal, we strongly believe that our method will be of great relevance also in a near future.</p>
    <p>Increasing read length can only increase the number of reads confidently classified at the genus level but does not allow a higher taxonomic resolution (e.g., down to the species level). It has been reported that only full-length genes can be used to push characterization to the species level (<xref rid="B24" ref-type="bibr">Schloss et al., 2009</xref>). In fact, the scanning with heuristic methods of 16S rDNA databanks, that contain fully annotated species as well as a larger number of completely unknown species, frequently converges into the latter category, reducing the theoretical possibility of reaching a strain or even species-level resolution. We showed that this kind of issues also affects the most advanced 16S rDNA gene reconstruction method, EMIRGE, that characterized our HMP-derived sample as a population mainly composed of uncultured bacterial species. Being such uncultured bacteria classified at the genus level at best, it is evident that strain-level resolution cannot be achieved effectively using short metagenomics reads and, from this perspective, a genus level characterization can be achieved much more efficiently using the approached we used in riboFrame.</p>
    <p>One of the most crucial aspects of the riboFrame data processing is the decoupling of the ribosomal reads from a database-derived source. Our choice of using 16S rDNA HMMs, calibrated to the <italic>E. coli</italic> positions and trained on secondary structure-aware sequence alignments of 16S genes, has two advantages. The first is the coherence in positioning the matching reads on the 16S gene model. This, coupled to the existing information about the position of the variable regions, allows to confidently select reads potentially relevant for taxonomic classification. The second is that we highly reduce errors or ambiguous assignments due to the small size of Illumina reads (around 100 bp), that currently represents a limit for recruiters based on heuristic search. In fact, recruiters may fail to accurately identify the correct source due to the similarity in constant regions among different microbes and to the observation that a single microbe can contain multiple ribosomal operons with different length and composition. It is instead established (and confirmed in this work) that a 100 bp length is sufficient for genus-level assignment with naïve Bayesian classification, thus reinforcing the validity of our strategy.</p>
    <p>Several methods have been developed to estimate taxonomy from metagenomics experiments. However, current procedures have inherent limitations that will not likely be solved in the near future. Coding sequence-based methods are still limited by the relatively small (although growing) number of reference microbial genomes. Methods relying on reference 16S rDNA data banks have the opposite drawback of identifying as best hits a majority of uncultured and unknown organisms, a fact that limits their theoretical capability of reaching deep levels of taxonomic resolution. On the contrary, although limited in the taxonomic resolution, Bayesian methods for taxonomy assignment trained on the distribution of <italic>k</italic>-mers of 7–8 bp offer fast assignment based on a robust statistics and provide a bootstrap-based confidence easy to interpret, more broadly applicable and with higher general validity. It is worth stressing that the RDPclassifier we used was trained on full-length 16S rDNA genes. As noticed before (<xref rid="B19" ref-type="bibr">Mizrahi-Man et al., 2013</xref>), a retraining of the Bayesian methods with shorter reads offers some advantages in accuracy. Although we did not explicitly take into account such aspects, riboFrame can be easily adapted to accept formats different from that of RDPclassifier or HMMER, the most noticeable example being Infernal for reads recruitment and classify.seqs function in mothur for taxonomic assignment (<xref rid="B24" ref-type="bibr">Schloss et al., 2009</xref>).</p>
    <p>One on the most important innovations introduced by riboFrame is the possibility of evaluating the classification performances of different regions across the 16S rDNA gene. At the phylum level we observed that the three most abundant bacterial phyla (with abundance filtered to be higher than 2%) i.e., Bacteroidetes, Firmicutes, and Proteobacteria were conserved with little (&lt;10%) variations in the proportions. It is worth noticing the opposite trends of abundances between Bacteroidetes and Firmicutes across regions that seem to indicate that V1 and V9 regions tend to erroneously classify the latter as the former. The proportions proved to be more variable for less abundant phyla (abundance lower than 1%, that was already established to be below the sensitivity threshold usually applied in microbial profiling) with Verrucomicrobia and Actinobacteria absent from the top five list in the V7 region, the latter also absent in the V1, V2, and V4 regions. At the order rank the most abundant assignments were Bacteroidales, Clostridiales, and Burkoleriales, with the same trends described at the phylum level. At the class rank Bacteroidia, Clostridia and Betaproteobacteria contributed most to the profile, with Verrucomicrobia absent in the V2, V3, and V7 regions, Bacilli absent in the V3, V7, Actinoacteria and Gammaproteobacteria only detectable at low levels in the V7 and V9 and in the V3 and V7 regions, respectively. At the family level we found that that the Bacteroidia class is represented as equally composed by Porphyromonadales and Bacteroidaceae, with a good agreement across variable regions. It is interesting to notice here that the top five list did not include Alcaligenaceae in regions V2, V7, and V8 and that Lachnospiraceae were only in the list of V2, V7, and V8. Finally, at the genus level Bacteroides and Parabacteroides and Alistipes were the most abundant with good agreement across regions. Curiously, the <italic>Parasutterella</italic> genus was not in the top five list of V7 region, the <italic>Faecalibacterium</italic> was not in the list of V4, V5, and V9 regions and the <italic>Oscillibacter</italic> genus was only in the list of the V7 and V9 regions.</p>
    <p>The most noticeable “caveat” in using the riboFrame method is represented by the possible reduced number of reads recruited as ribosomal by the HMM-based search. This may in fact cause a down-sampling error and, accordingly, a decrease in the accuracy of the abundance analysis. Although in our experience the number of Illumina reads from a typical metagenomics project gives a sufficient number of 16S rDNA associated reads, reducing the number of reads (e.g., by multiplexing/barcoding) may hamper the performance of our approach. To allow the user to evaluate this point, riboTrap provides a coverage plot showing how many reads cover the 16S gene after recruitment. Such coverage plots are important snapshots to evaluate the efficiency of the metagenomics sampling of the 16S ribosomal gene and are intended to assist the user in deciding whether to proceed or not with the taxonomy assignment. In addition, riboMap reports the number of reads selected after imposing thresholds in confidence and length, so the user can easily control the sampling depth of the analysis and decide about the trustfulness of the abundance analysis.</p>
    <p>The pipeline we introduced, riboFrame, is a rapid, flexible and intuitive method to identify, select and map ribosomal reads onto the 16S ribosomal gene with the aim of performing taxonomic classification. The possibility given by riboFrame of addressing <italic>post hoc</italic> the region to be analyzed allows the comparison of the taxonomic performance of different variable regions.</p>
    <p>The riboFrame approach proved to be fast and effective on simulated datasets. More importantly, the application of our method to a public dataset of targeted 16S and Illumina data showed a substantial concordance on genus assignment between microbial composition assessed through pyrosequencing and Illumina sequencing.</p>
    <p>riboFrame represents the first attempt to create a tool for dissecting and evaluating the potentiality of a direct, 16S based taxonomic classification of short reads applied to non-targeted metagenomics.</p>
  </sec>
  <sec>
    <title>Author Contributions</title>
    <p>MR conceived the algorithms, wrote the codes, tested the results and drafted the manuscript. LB tested the algorithms, did the alpha testing and critically revised the manuscript. CD contributed to optimize the algorithms and to draft the manuscript. DC conceived the algorithms and did critical assessment of the work.</p>
  </sec>
  <sec>
    <title>Conflict of Interest Statement</title>
    <p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
  </sec>
</body>
<back>
  <fn-group>
    <fn fn-type="financial-disclosure">
      <p><bold>Funding.</bold> This work was supported by FP7 Integrative project SYBARIS (242220) and Ente Cassa di Risparmio di Firenze.</p>
    </fn>
  </fn-group>
  <ack>
    <p>The authors wish to thank Pietro Liò from the University of Cambridge, UK and the European Molecular Biology Organization (EMBO) for supporting MR (ASTF 0075-2010).</p>
  </ack>
  <fn-group>
    <fn id="fn01">
      <label>1</label>
      <p>
        <ext-link ext-link-type="uri" xlink:href="http://bioserver2.sbsc.unifi.it/bioinfo/riboframe.html">bioserver2.sbsc.unifi.it/bioinfo/riboframe.html</ext-link>
      </p>
    </fn>
    <fn id="fn02">
      <label>2</label>
      <p>
        <ext-link ext-link-type="uri" xlink:href="http://www.plantagora.org">www.plantagora.org</ext-link>
      </p>
    </fn>
  </fn-group>
  <sec sec-type="supplementary material">
    <title>Supplementary Material</title>
    <p>The Supplementary Material for this article can be found online at: <ext-link ext-link-type="uri" xlink:href="http://journal.frontiersin.org/article/10.3389/fgene.2015.00329">http://journal.frontiersin.org/article/10.3389/fgene.2015.00329</ext-link></p>
    <supplementary-material content-type="local-data" id="SM1">
      <media xlink:href="Supplemental_Data.PDF">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bengtsson</surname><given-names>J.</given-names></name><name><surname>Eriksson</surname><given-names>K. M.</given-names></name><name><surname>Hartmann</surname><given-names>M.</given-names></name><name><surname>Wang</surname><given-names>Z.</given-names></name><name><surname>Shenoy</surname><given-names>B. D.</given-names></name><name><surname>Grelet</surname><given-names>G. A.</given-names></name><etal/></person-group> (<year>2011</year>). <article-title>Metaxa: a software tool for automated detection and discrimination among ribosomal small subunit (12S/16S/18S) sequences of archaea, bacteria, eukaryotes, mitochondria, and chloroplasts in metagenomes and environmental sequencing datasets.</article-title>
<source><italic>Antonie Van Leeuwenhoek</italic></source>
<volume>100</volume>
<fpage>471</fpage>–<lpage>475</lpage>. <pub-id pub-id-type="doi">10.1007/s10482-011-9598-6</pub-id><pub-id pub-id-type="pmid">21674231</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chakravorty</surname><given-names>S.</given-names></name><name><surname>Helb</surname><given-names>D.</given-names></name><name><surname>Burday</surname><given-names>M.</given-names></name><name><surname>Connell</surname><given-names>N.</given-names></name><name><surname>Alland</surname><given-names>D.</given-names></name></person-group> (<year>2007</year>). <article-title>A detailed analysis of 16S ribosomal RNA gene segments for the diagnosis of pathogenic bacteria.</article-title>
<source><italic>J. Microbiol. Methods</italic></source>
<volume>69</volume>
<fpage>330</fpage>–<lpage>339</lpage>. <pub-id pub-id-type="doi">10.1016/j.mimet.2007.02.005</pub-id><pub-id pub-id-type="pmid">17391789</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cole</surname><given-names>J. R.</given-names></name><name><surname>Wang</surname><given-names>Q.</given-names></name><name><surname>Fish</surname><given-names>J. A.</given-names></name><name><surname>Chai</surname><given-names>B.</given-names></name><name><surname>McGarrell</surname><given-names>D. M.</given-names></name><name><surname>Sun</surname><given-names>Y.</given-names></name><etal/></person-group> (<year>2013</year>). <article-title>Ribosomal Database Project: data and tools for high throughput rRNA analysis.</article-title>
<source><italic>Nucleic Acids Res.</italic></source>
<volume>42</volume>
<fpage>D633</fpage>–<lpage>D642</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkt1244</pub-id><pub-id pub-id-type="pmid">24288368</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Conlan</surname><given-names>S.</given-names></name><name><surname>Kong</surname><given-names>H. H.</given-names></name><name><surname>Segre</surname><given-names>J. A.</given-names></name></person-group> (<year>2012</year>). <article-title>Species-level analysis of DNA sequence data from the NIH Human Microbiome Project.</article-title>
<source><italic>PLoS ONE</italic></source>
<volume>7</volume>:<issue>e47075</issue>
<pub-id pub-id-type="doi">10.1371/journal.pone.0047075</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dark</surname><given-names>M. J.</given-names></name></person-group> (<year>2013</year>). <article-title>Whole-genome sequencing in bacteriology: state of the art.</article-title>
<source><italic>Infect. Drug Resist.</italic></source>
<volume>6</volume>
<fpage>115</fpage>–<lpage>123</lpage>. <pub-id pub-id-type="doi">10.2147/IDR.S35710</pub-id><pub-id pub-id-type="pmid">24143115</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Filippo</surname><given-names>C.</given-names></name><name><surname>Cavalieri</surname><given-names>D.</given-names></name><name><surname>Di Paola</surname><given-names>M.</given-names></name><name><surname>Ramazzotti</surname><given-names>M.</given-names></name><name><surname>Poullet</surname><given-names>J. B.</given-names></name><name><surname>Massart</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2010</year>). <article-title>Impact of diet in shaping gut microbiota revealed by a comparative study in children from Europe and rural Africa.</article-title>
<source><italic>Proc. Natl. Acad. Sci. U.S.A.</italic></source>
<volume>107</volume>
<fpage>14691</fpage>–<lpage>14696</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1005963107</pub-id><pub-id pub-id-type="pmid">20679230</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Filippo</surname><given-names>C.</given-names></name><name><surname>Ramazzotti</surname><given-names>M.</given-names></name><name><surname>Fontana</surname><given-names>P.</given-names></name><name><surname>Cavalieri</surname><given-names>D.</given-names></name></person-group> (<year>2012</year>). <article-title>Bioinformatic approaches for functional annotation and pathway inference in metagenomics data.</article-title>
<source><italic>Brief. Bioinform.</italic></source>
<volume>13</volume>
<fpage>696</fpage>–<lpage>710</lpage>. <pub-id pub-id-type="doi">10.1093/bib/bbs070</pub-id><pub-id pub-id-type="pmid">23175748</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>DeSantis</surname><given-names>T. Z.</given-names></name><name><surname>Hugenholtz</surname><given-names>P.</given-names></name><name><surname>Larsen</surname><given-names>N.</given-names></name><name><surname>Rojas</surname><given-names>M.</given-names></name><name><surname>Brodie</surname><given-names>E. L.</given-names></name><name><surname>Keller</surname><given-names>K.</given-names></name><etal/></person-group> (<year>2006</year>). <article-title>Greengenes, a chimera-checked 16S rRNA gene database and workbench compatible with ARB.</article-title>
<source><italic>Appl. Environ. Microbiol.</italic></source>
<volume>72</volume>
<fpage>5069</fpage>–<lpage>5072</lpage>. <pub-id pub-id-type="doi">10.1128/AEM.03006-05</pub-id><pub-id pub-id-type="pmid">16820507</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eddy</surname><given-names>S. R.</given-names></name></person-group> (<year>2011</year>). <article-title>Accelerated Profile HMM Searches.</article-title>
<source><italic>PLoS Comput. Biol.</italic></source>
<volume>7</volume>:<issue>e1002195</issue>
<pub-id pub-id-type="doi">10.1371/journal.pcbi.1002195</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Engelbrektson</surname><given-names>A.</given-names></name><name><surname>Kunin</surname><given-names>V.</given-names></name><name><surname>Wrighton</surname><given-names>K. C.</given-names></name><name><surname>Zvenigorodsky</surname><given-names>N.</given-names></name><name><surname>Chen</surname><given-names>F.</given-names></name><name><surname>Ochman</surname><given-names>H.</given-names></name><etal/></person-group> (<year>2010</year>). <article-title>Experimental factors affecting PCR-based estimates of microbial species richness and evenness.</article-title>
<source><italic>ISME J.</italic></source>
<volume>4</volume>
<fpage>642</fpage>–<lpage>647</lpage>. <pub-id pub-id-type="doi">10.1038/ismej.2009.153</pub-id><pub-id pub-id-type="pmid">20090784</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gardner</surname><given-names>P. P.</given-names></name><name><surname>Daub</surname><given-names>J.</given-names></name><name><surname>Tate</surname><given-names>J.</given-names></name><name><surname>Moore</surname><given-names>B. L.</given-names></name><name><surname>Osuch</surname><given-names>I. H.</given-names></name><name><surname>Griffiths-Jones</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2010</year>). <article-title>Rfam: wikipedia, clans and the “decimal” release.</article-title>
<source><italic>Nucleic Acids Res.</italic></source>
<volume>39</volume>
<fpage>D141</fpage>–<lpage>D145</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkq1129</pub-id><pub-id pub-id-type="pmid">21062808</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haas</surname><given-names>B. J.</given-names></name><name><surname>Gevers</surname><given-names>D.</given-names></name><name><surname>Earl</surname><given-names>A. M.</given-names></name><name><surname>Feldgarden</surname><given-names>M.</given-names></name><name><surname>Ward</surname><given-names>D. V.</given-names></name><name><surname>Giannoukos</surname><given-names>G.</given-names></name><etal/></person-group> (<year>2011</year>). <article-title>Chimeric 16S rRNA sequence formation and detection in Sanger and 454-pyrosequenced PCR amplicons.</article-title>
<source><italic>Genome Res.</italic></source>
<volume>21</volume>
<fpage>494</fpage>–<lpage>504</lpage>. <pub-id pub-id-type="doi">10.1101/gr.112730.110</pub-id><pub-id pub-id-type="pmid">21212162</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hamady</surname><given-names>M.</given-names></name><name><surname>Knight</surname><given-names>R.</given-names></name></person-group> (<year>2009</year>). <article-title>Microbial community profiling for human microbiome projects: tools, techniques, and challenges.</article-title>
<source><italic>Genome Res.</italic></source>
<volume>19</volume>
<fpage>1141</fpage>–<lpage>1152</lpage>. <pub-id pub-id-type="doi">10.1101/gr.085464.108</pub-id><pub-id pub-id-type="pmid">19383763</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hartmann</surname><given-names>M.</given-names></name><name><surname>Howes</surname><given-names>C. G.</given-names></name><name><surname>Abarenkov</surname><given-names>K.</given-names></name><name><surname>Mohn</surname><given-names>W. W.</given-names></name><name><surname>Nilsson</surname><given-names>R. H.</given-names></name></person-group> (<year>2010</year>). <article-title>V-Xtractor: an open-source, high-throughput software tool to identify and extract hypervariable regions of small subunit (16S/18S) ribosomal RNA gene sequences.</article-title>
<source><italic>J. Microbiol. Methods</italic></source>
<volume>83</volume>
<fpage>250</fpage>–<lpage>253</lpage>. <pub-id pub-id-type="doi">10.1016/j.mimet.2010.08.008</pub-id><pub-id pub-id-type="pmid">20804791</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huson</surname><given-names>D. H.</given-names></name><name><surname>Weber</surname><given-names>N.</given-names></name></person-group> (<year>2013</year>). <article-title>Microbial community analysis using MEGAN.</article-title>
<source><italic>Methods Enzymol.</italic></source>
<volume>531</volume>
<fpage>465</fpage>–<lpage>485</lpage>. <pub-id pub-id-type="doi">10.1016/j.mimet.2010.08.008</pub-id><pub-id pub-id-type="pmid">24060133</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>J. H.</given-names></name><name><surname>Yi</surname><given-names>H.</given-names></name><name><surname>Chun</surname><given-names>J.</given-names></name></person-group> (<year>2011</year>). <article-title>rRNASelector: a computer program for selecting ribosomal RNA encoding sequences from metagenomic and metatranscriptomic shotgun libraries.</article-title>
<source><italic>J. Microbiol.</italic></source>
<volume>49</volume>
<fpage>689</fpage>–<lpage>691</lpage>. <pub-id pub-id-type="doi">10.1007/s12275-011-1213-z</pub-id><pub-id pub-id-type="pmid">21887657</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H.</given-names></name><name><surname>Durbin</surname><given-names>R.</given-names></name></person-group> (<year>2010</year>). <article-title>Fast and accurate long-read alignment with Burrows-Wheeler transform.</article-title>
<source><italic>Bioinformatics</italic></source>
<volume>26</volume>
<fpage>589</fpage>–<lpage>595</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp698</pub-id><pub-id pub-id-type="pmid">20080505</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miller</surname><given-names>C. S.</given-names></name><name><surname>Baker</surname><given-names>B. J.</given-names></name><name><surname>Thomas</surname><given-names>B. C.</given-names></name><name><surname>Singer</surname><given-names>S. W.</given-names></name><name><surname>Banfield</surname><given-names>J. F.</given-names></name></person-group> (<year>2011</year>). <article-title>EMIRGE: reconstruction of full-length ribosomal genes from microbial community short read sequencing data.</article-title>
<source><italic>Genome Biol.</italic></source>
<volume>12</volume>
<issue>R44</issue>
<pub-id pub-id-type="doi">10.1186/gb-2011-12-5-r44</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mizrahi-Man</surname><given-names>O.</given-names></name><name><surname>Davenport</surname><given-names>E. R.</given-names></name><name><surname>Gilad</surname><given-names>Y.</given-names></name></person-group> (<year>2013</year>). <article-title>Taxonomic classification of bacterial 16S rRNA genes using short sequencing reads: evaluation of effective study designs.</article-title>
<source><italic>PLoS ONE</italic></source>
<volume>8</volume>:<issue>e53608</issue>
<pub-id pub-id-type="doi">10.1371/journal.pone.0053608</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nawrocki</surname><given-names>E. P.</given-names></name><name><surname>Kolbe</surname><given-names>D. L.</given-names></name><name><surname>Eddy</surname><given-names>S. R.</given-names></name></person-group> (<year>2009</year>). <article-title>Infernal 1.0: inference of RNA alignments.</article-title>
<source><italic>Bioinformatics</italic></source>
<volume>25</volume>
<fpage>1335</fpage>–<lpage>1337</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp157</pub-id><pub-id pub-id-type="pmid">19307242</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quast</surname><given-names>C.</given-names></name><name><surname>Pruesse</surname><given-names>E.</given-names></name><name><surname>Yilmaz</surname><given-names>P.</given-names></name><name><surname>Gerken</surname><given-names>J.</given-names></name><name><surname>Schweer</surname><given-names>T.</given-names></name><name><surname>Yarza</surname><given-names>P.</given-names></name><etal/></person-group> (<year>2012</year>). <article-title>The SILVA ribosomal RNA gene database project: improved data processing and web-based tools.</article-title>
<source><italic>Nucleic Acids Res.</italic></source>
<volume>41</volume>
<fpage>D590</fpage>–<lpage>D596</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gks1219</pub-id><pub-id pub-id-type="pmid">23193283</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Richter</surname><given-names>D. C.</given-names></name><name><surname>Ott</surname><given-names>F.</given-names></name><name><surname>Auch</surname><given-names>A. F.</given-names></name><name><surname>Schmid</surname><given-names>R.</given-names></name><name><surname>Huson</surname><given-names>D. H.</given-names></name></person-group> (<year>2008</year>). <article-title>MetaSim: a sequencing simulator for genomics and metagenomics.</article-title>
<source><italic>PLoS ONE</italic></source>
<volume>3</volume>:<issue>e3373</issue>
<pub-id pub-id-type="doi">10.1371/journal.pone.0003373</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Riesenfeld</surname><given-names>C. S.</given-names></name><name><surname>Schloss</surname><given-names>P. D.</given-names></name><name><surname>Handelsman</surname><given-names>J.</given-names></name></person-group> (<year>2004</year>). <article-title>Metagenomics: genomic analysis of microbial communities.</article-title>
<source><italic>Annu. Rev. Genet.</italic></source>
<volume>38</volume>
<fpage>525</fpage>–<lpage>552</lpage>. <pub-id pub-id-type="doi">10.1146/annurev.genet.38.072902.091216</pub-id><pub-id pub-id-type="pmid">15568985</pub-id></mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schloss</surname><given-names>P. D.</given-names></name><name><surname>Westcott</surname><given-names>S. L.</given-names></name><name><surname>Ryabin</surname><given-names>T.</given-names></name><name><surname>Hall</surname><given-names>J. R.</given-names></name><name><surname>Hartmann</surname><given-names>M.</given-names></name><name><surname>Hollister</surname><given-names>E. B.</given-names></name><etal/></person-group> (<year>2009</year>). <article-title>Introducing mothur: open-source, platform-independent, community-supported software for describing and comparing microbial communities.</article-title>
<source><italic>Appl. Environ. Microbiol.</italic></source>
<volume>75</volume>
<fpage>7537</fpage>–<lpage>7541</lpage>. <pub-id pub-id-type="doi">10.1128/AEM.01541-09</pub-id><pub-id pub-id-type="pmid">19801464</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Segata</surname><given-names>N.</given-names></name><name><surname>Waldron</surname><given-names>L.</given-names></name><name><surname>Ballarini</surname><given-names>A.</given-names></name><name><surname>Narasimhan</surname><given-names>V.</given-names></name><name><surname>Jousson</surname><given-names>O.</given-names></name><name><surname>Huttenhower</surname><given-names>C.</given-names></name></person-group> (<year>2012</year>). <article-title>Metagenomic microbial community profiling using unique clade-specific marker genes.</article-title>
<source><italic>Nat. Methods</italic></source>
<volume>9</volume>
<fpage>811</fpage>–<lpage>814</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.2066</pub-id><pub-id pub-id-type="pmid">22688413</pub-id></mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vázquez-Castellanos</surname><given-names>J. F.</given-names></name><name><surname>García-López</surname><given-names>R.</given-names></name><name><surname>Pérez-Brocal</surname><given-names>V.</given-names></name><name><surname>Pignatelli</surname><given-names>M.</given-names></name><name><surname>Moya</surname><given-names>A.</given-names></name></person-group> (<year>2014</year>). <article-title>Comparison of different assembly and annotation tools on analysis of simulated viral metagenomic communities in the gut.</article-title>
<source><italic>BMC Genomics</italic></source>
<volume>15</volume>:<issue>37</issue>
<pub-id pub-id-type="doi">10.1186/1471-2164-15-37</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Q.</given-names></name><name><surname>Garrity</surname><given-names>G. M.</given-names></name><name><surname>Tiedje</surname><given-names>J. M.</given-names></name><name><surname>Cole</surname><given-names>J. R.</given-names></name></person-group> (<year>2007</year>). <article-title>Naive Bayesian classifier for rapid assignment of rRNA sequences into the new bacterial taxonomy.</article-title>
<source><italic>Appl. Environ. Microbiol.</italic></source>
<volume>73</volume>
<fpage>5261</fpage>–<lpage>5267</lpage>. <pub-id pub-id-type="doi">10.1128/AEM.00062-07</pub-id><pub-id pub-id-type="pmid">17586664</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Woese</surname><given-names>C. R.</given-names></name><name><surname>Fox</surname><given-names>G. E.</given-names></name></person-group> (<year>1977</year>). <article-title>Phylogenetic structure of the prokaryotic domain: the primary kingdoms.</article-title>
<source><italic>Proc. Natl. Acad. Sci. U.S.A.</italic></source>
<volume>74</volume>
<fpage>5088</fpage>–<lpage>5090</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.74.11.5088</pub-id><pub-id pub-id-type="pmid">270744</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
