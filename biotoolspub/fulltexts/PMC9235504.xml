<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9235504</article-id>
    <article-id pub-id-type="pmid">35758807</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac220</article-id>
    <article-id pub-id-type="publisher-id">btac220</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>ISCB/Ismb 2022</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Regulatory and Functional Genomics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MOJITOO: a fast and universal method for integration of multimodal single-cell data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Cheng</surname>
          <given-names>Mingbo</given-names>
        </name>
        <aff><institution>Institute for Computational Genomics, Joint Research Center for Computational Biomedicine, RWTH Aachen University Medical School</institution>, 52074 Aachen, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Zhijian</given-names>
        </name>
        <aff><institution>Institute for Computational Genomics, Joint Research Center for Computational Biomedicine, RWTH Aachen University Medical School</institution>, 52074 Aachen, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2890-8697</contrib-id>
        <name>
          <surname>Costa</surname>
          <given-names>Ivan G</given-names>
        </name>
        <xref rid="btac220-cor1" ref-type="corresp"/>
        <aff><institution>Institute for Computational Genomics, Joint Research Center for Computational Biomedicine, RWTH Aachen University Medical School</institution>, 52074 Aachen, <country country="DE">Germany</country></aff>
        <!--ivan.costa@rwth-aachen.de-->
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btac220-cor1">To whom correspondence should be addressed. E-mail: <email>ivan.costa@rwth-aachen.de</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>7</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-06-27">
      <day>27</day>
      <month>6</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>6</month>
      <year>2022</year>
    </pub-date>
    <volume>38</volume>
    <issue>Suppl 1</issue>
    <issue-title>ISCB ISMB 2022 Proceedings</issue-title>
    <fpage>i282</fpage>
    <lpage>i289</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac220.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The advent of multi-modal single-cell sequencing techniques have shed new light on molecular mechanisms by simultaneously inspecting transcriptomes, epigenomes and proteomes of the same cell. However, to date, the existing computational approaches for integration of multimodal single-cell data are either computationally expensive, require the delineation of parameters or can only be applied to particular modalities.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here we present a single-cell multi-modal integration method, named <bold>M</bold>ulti-m<bold>O</bold>dal <bold>J</bold>oint <bold>I</bold>ntegra<bold>T</bold>ion of c<bold>O</bold>mp<bold>O</bold>nents (MOJITOO). MOJITOO uses canonical correlation analysis for a fast and parameter free detection of a shared representation of cells from multimodal single-cell data. Moreover, estimated canonical components can be used for interpretation, i.e. association of modality-specific molecular features with the latent space. We evaluate MOJITOO using bi- and tri-modal single-cell datasets and show that MOJITOO outperforms existing methods regarding computational requirements, preservation of original latent spaces and clustering.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The software, code and data for benchmarking are available at <ext-link xlink:href="https://github.com/CostaLab/MOJITOO" ext-link-type="uri">https://github.com/CostaLab/MOJITOO</ext-link> and <ext-link xlink:href="https://doi.org/10.5281/zenodo.6348128" ext-link-type="uri">https://doi.org/10.5281/zenodo.6348128</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>German Research Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001659</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>GE 2811/3-2</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>German Ministry of Education and Science</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>BMBF</institution>
            <institution-id institution-id-type="DOI">10.13039/501100002347</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The technological advances of high-throughput single-cell sequencing enable us to characterize cellular heterogeneity of complex tissues for distinct molecular players of cells such as transcripts, proteins and chromatin (<xref rid="btac220-B9" ref-type="bibr">Efremova and Teichmann, 2020</xref>). The advent of multimodal technologies allow us to simultaneously measure two or more modalities at the same cells, i.e. RNA and open chromatin (<xref rid="btac220-B3631751" ref-type="bibr">Hu<italic toggle="yes"> et al.</italic>, 2020;</xref>  <xref rid="btac220-B7" ref-type="bibr">Cao <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btac220-B21" ref-type="bibr">Ma <italic toggle="yes">et al.</italic>, 2020</xref>); RNA and protein (<xref rid="btac220-B28" ref-type="bibr">Stoeckius <italic toggle="yes">et al.</italic>, 2017</xref>); and RNA, open chromatin and protein (<xref rid="btac220-B22" ref-type="bibr">Mimitou <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac220-B32" ref-type="bibr">Swanson <italic toggle="yes">et al.</italic>, 2021</xref>). These methods allow us to access how genetic information is associated at distinct molecular levels, i.e. the effect of DNA accessibility changes on gene expression or the expression of genes to proteins. However, data produced by each modality has quite distinct characteristics regarding their numerical values (e.g. low counts for open chromatin and variable count values for RNA and proteins levels), dimensionality (dozens for proteins, tens of thousands for genes, hundreds of thousands for open chromatin) and levels of data sparsity (<xref rid="btac220-B3" ref-type="bibr">Argelaguet <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac220-B20" ref-type="bibr">Li <italic toggle="yes">et al.</italic>, 2021</xref>). These make the integrative analysis of multi-modal data a challenging task.</p>
    <p>Here, we are interested in the problem of estimating a shared latent space from parallel multiomic approaches, where two or more modalities are measured in the same cells. A few methods have been proposed for this problem. These follow two main frameworks: metric learning and latent variable learning. Weighted nearest neighbors (WNN) (<xref rid="btac220-B12" ref-type="bibr">Hao <italic toggle="yes">et al.</italic>, 2021</xref>)) and Schema (<xref rid="btac220-B27" ref-type="bibr">Singh <italic toggle="yes">et al.</italic>, 2021</xref>) explore, respectively, nearest neighbors and quadratic programming to estimate a single distance matrix representing the integrated multimodal data. Both approaches explore efficient algorithms, but do not explicitly provide models associating molecular features to the ‘latent space’. MOFA (<xref rid="btac220-B2" ref-type="bibr">Argelaguet <italic toggle="yes">et al.</italic>, 2020</xref>), scAI (<xref rid="btac220-B16" ref-type="bibr">Jin <italic toggle="yes">et al.</italic>, 2020</xref>), totalVI (<xref rid="btac220-B10" ref-type="bibr">Gayoso <italic toggle="yes">et al.</italic>, 2021</xref>) and LIGER (<xref rid="btac220-B6052098" ref-type="bibr">Kriebel and Welch, 2022</xref>) explore distinct methods for matrix factorization and estimation of shared latent spaces between modalities. Moreover, estimated matrices can be used for model interpretation, i.e. decomposed matrices can be used to associate molecular features with the latent space. Overall, these methods have a large number of free parameters including the size of the latent space (or rank of the low dimensional matrices). These methods require the optimization of the size of the latent space, which in turn increases computational costs. Of note, the main application of LIGER is the integration of experiments within a modality (<xref rid="btac220-B34" ref-type="bibr">Welch <italic toggle="yes">et al.</italic>, 2019</xref>). The data integration evaluated here refers to a latter version of LIGER (<xref rid="btac220-B6052098" ref-type="bibr">Kriebel and Welch, 2022</xref>), which can only be used for two modalities and a subset of the molecular features need to be common in both modalities. Also, the implementation of some methods (totalVI (<xref rid="btac220-B10" ref-type="bibr">Gayoso <italic toggle="yes">et al.</italic>, 2021</xref>) and scAI (<xref rid="btac220-B16" ref-type="bibr">Jin <italic toggle="yes">et al.</italic>, 2020</xref>)) only allow integration of particular modalities (i.e. scRNA-seq and protein abundance for totalVI; scRNA-seq and scATAC-seq for scAI).</p>
    <p>Two recent works have explored canonical correlation analysis (CCA) for problems close to the one addressed here. Symphony (<xref rid="btac220-B17" ref-type="bibr">Kang <italic toggle="yes">et al.</italic>, 2021</xref>), which has as main objective to build reference single-cell atlas, used CCA to obtain a joint space in a case study with CITE-seq data. However, this approach does not support more than two modalities and was not evaluated concerning its interpretability or computational requirements. DIABLO (<xref rid="btac220-B26" ref-type="bibr">Singh <italic toggle="yes">et al.</italic>, 2019</xref>) extends generalized canonical analysis for integration of bulk multi-modal datasets with respect to different phenotypes. It requires class labels for the samples, which are used for feature selection. However, such class labels are usually not provided in single-cell multi-modal datasets, as explored here.</p>
  </sec>
  <sec>
    <title>2 Approach</title>
    <p>Here, we propose <bold>M</bold>ulti-m<bold>O</bold>dal <bold>J</bold>oint <bold>I</bold>ntegra<bold>T</bold>ion of c<bold>O</bold>mp<bold>O</bold>nents (MOJITOO), an efficient method that is based on CCA to learn a shared latent space for any single-cell multimodal data protocol. The canonical components can be interpreted as factors and be used to characterize feature relevance by relating features across modalities (<xref rid="btac220-F1" ref-type="fig">Fig. 1</xref>). In contrast to matrix factorization methods, MOJITOO does not require the definition of parameters such as the rank of the matrix. Furthermore, it provides an approach to estimate the size of the latent space after a single execution of CCA. MOJITOO is provided as an R package and is compatible with common single-cell pipelines for RNA, proteins (Seurat; <xref rid="btac220-B12" ref-type="bibr">Hao <italic toggle="yes">et al.</italic>, 2021</xref>) and ATAC modalities (Signac; <xref rid="btac220-B30" ref-type="bibr">Stuart <italic toggle="yes">et al.</italic>, 2021</xref>). MOJITOO builds upon a simple CCA procedure presented in a case study in Symphony (<xref rid="btac220-B17" ref-type="bibr">Kang <italic toggle="yes">et al.</italic>, 2021</xref>) and differs from DIABLO (<xref rid="btac220-B26" ref-type="bibr">Singh <italic toggle="yes">et al.</italic>, 2019</xref>), as it does not require labels for data integration.</p>
    <fig position="float" id="btac220-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Schematic MOJITOO. (<bold>A</bold>) MOJITOO receives as input two (or more) dimensional reduced matrices, where each matrix represents a particular molecular modality describing the same cells. In this example, we assume RNA and open chromatin (as measured by ATAC-seq) modalities are given. The main idea of MOJITOO is to use Canonical Correlation Analysis to find a set of canonical vectors <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">ATAC</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">RNA</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. Exploring a geometrical interpretation of CCA, MOJITOO finds canonical vectors such that the cosine similarity between latent dimensions in <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">RNA</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">ATAC</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is maximized. A final representation <italic toggle="yes">Z</italic> can be obtained by adding the modality-specific latent spaces. In the example, we show vectorial representations of two cells (<italic toggle="yes">a</italic> and <italic toggle="yes">b</italic>) in both original and latent spaces. (<bold>B</bold>) An association between original features for each modality (<inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">RNA</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">ATAC</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) can be obtained by multiplying original data representation per modality (<inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">RNA</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">ATAC</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) with the shared latent space <italic toggle="yes">Z</italic></p>
      </caption>
      <graphic xlink:href="btac220f1" position="float"/>
    </fig>
    <p>We evaluate MOJITOO and competing methods (WNN, MOFA, scAI, LIGER, Schema, DIABLO, Symphony) in two bi-modal datasets with RNA and protein measurements (<xref rid="btac220-B6" ref-type="bibr">Buus <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac220-B30" ref-type="bibr">Stuart <italic toggle="yes">et al.</italic>, 2021</xref>), two bi-modal datasets with RNA and ATAC-seq measurements (<xref rid="btac220-B21" ref-type="bibr">Ma <italic toggle="yes">et al.</italic>, 2020</xref>) and two tri-modal datasets with RNA, proteins and ATAC-seq measurements (<xref rid="btac220-B22" ref-type="bibr">Mimitou <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac220-B32" ref-type="bibr">Swanson <italic toggle="yes">et al.</italic>, 2021</xref>) in regards to their ability to recover a shared latent space. The latent spaces are then evaluated with measures regarding the accuracy of clustering (adjusted Rand index), distance (silhouette score) and structure preservation, i.e. relation between shared space and original space of individual modalities (<xref rid="btac220-B7687042" ref-type="bibr">Jain<italic toggle="yes"> et al.</italic>, 2021</xref>). Altogether, results show a superior performance of MOJITOO in both computational requirements and accuracy of estimated latent spaces. Moreover, we illustrate how estimated canonical components can be used to interpret the underlying single-cell data.</p>
  </sec>
  <sec>
    <title>3 Materials and methods</title>
    <sec>
      <title>3.1 MOJITOO</title>
      <p>MOJITOO takes as input a set of matrices from <italic toggle="yes">m</italic> modalities:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">X</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>}</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> represents the data of a particular single-cell modality, <italic toggle="yes">n</italic> represents the number of cells and <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> represents the number of features in modality <italic toggle="yes">i</italic>. Here, we focus on multimodal data, where the cells are the same across matrices and there is no direct relation between the features of the distinct modalities.</p>
      <sec>
        <label>3.1.1</label>
        <title>Reducing the dimension for each modality</title>
        <p>We first obtain a dimension reduced matrix for each modality independently using a modality-specific approach:
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> represents the low-dimensional matrix for modality <italic toggle="yes">i</italic>, <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> represents the number of dimensions and <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> represents the specific dimension reduction method for this modality. MOJITOO uses latent semantic indexing (LSI) for scATAC-seq and principal component analysis (PCA) for other modalities, as is usual in the literature (<xref rid="btac220-B11" ref-type="bibr">Granja <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac220-B12" ref-type="bibr">Hao <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac220-B30" ref-type="bibr">Stuart <italic toggle="yes">et al.</italic>, 2021</xref>). The rational behind the use of dimension reduction is two-fold. First, low-dimensional matrices reduce the computing time of the CCA analysis without impacting accuracy for a minimum number of dimensions. Moreover, it allows to work directly on batch-corrected data, which is usually represented in a low-dimensional space (<xref rid="btac220-B12" ref-type="bibr">Hao <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac220-B18" ref-type="bibr">Korsunsky <italic toggle="yes">et al.</italic>, 2019</xref>). Of note, batch correction is recommended previous to MOJITOO, whenever the data are affected by batch effects.</p>
      </sec>
      <sec>
        <label>3.1.2</label>
        <title>Learning a shared space with canonical correlation analysis with two modalities</title>
        <p>MOJITOO aims to learn a shared latent space <italic toggle="yes">Z</italic> from the set of low dimensional matrices <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">Y</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>
 <disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mtext>MOJITOO</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> represents the cells, <italic toggle="yes">n</italic> is the number of cells and <italic toggle="yes">k</italic> is the dimension of this latent space. When <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mi mathvariant="script">Y</mml:mi></mml:math></inline-formula> has two modalities, we first use CCA (This notation is based on a geometrical interpretation of CCA.) to project the matrices <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> to vectors <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>:
<disp-formula id="E4"><label>(4)</label><mml:math id="M4" display="block" overflow="scroll"><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> represent canonical components (CC). The vectors <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> can be obtained by solving the following optimization problem:
<disp-formula id="E5"><label>(5)</label><mml:math id="M5" display="block" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mtext>arg max</mml:mtext><mml:mo> </mml:mo><mml:mtext>cos</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> represent the first canonical weight vectors, and <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mtext>cos</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the cosine similarity between two vectors <italic toggle="yes">a</italic> and <italic toggle="yes">b</italic> defined by:
<disp-formula id="E6"><label>(6)</label><mml:math id="M6" display="block" overflow="scroll"><mml:mrow><mml:mtext>cos</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>a</mml:mi><mml:mo>.</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>a</mml:mi><mml:mo>|</mml:mo><mml:mo>.</mml:mo><mml:mo>|</mml:mo><mml:mi>b</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p>This is repeated <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mi>min</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> times, such that new canonical vectors are orthogonal to previously estimated vectors. These provide the matrices:
<disp-formula id="E7"><label>(7)</label><mml:math id="M7" display="block" overflow="scroll"><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p>
        <p>These can be used to estimate the modality transformed space as
<disp-formula id="E8"><label>(8)</label><mml:math id="M8" display="block" overflow="scroll"><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p>
        <p>A unique latent space is obtained as
<disp-formula id="E9"><label>(9)</label><mml:math id="M9" display="block" overflow="scroll"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <italic toggle="yes">k</italic> is the number of canonical variables retained.</p>
        <p>To further remove the noise from the latent space <italic toggle="yes">Z</italic>, we only keep highly correlated canonical components <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> by measuring the Pearson correlation and using a Student’s <italic toggle="yes">t</italic>-test for significance. The <italic toggle="yes">P</italic>-values are then corrected using Benjamini Hochberg (BH) (<xref rid="btac220-B4" ref-type="bibr">Benjamini and Hochberg, 1995</xref>) and only canonical components with adjusted <italic toggle="yes">P</italic>-values &lt;0.05 are retained.</p>
        <p>MOJITOO uses an algorithm based on generalized eigenvector decomposition (<xref rid="btac220-B24" ref-type="bibr">Ramsay and Silverman, 1997</xref>) to estimate the canonical components. MOJITOO has a time complexity of <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">max</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>×</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for computing covariance matrices and <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>min</mml:mi><mml:mo>{</mml:mo><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>}</mml:mo><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for the eigenvector decomposition. As <italic toggle="yes">n</italic> (number of cells) is usually 100 times larger than <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> (number of reduced dimensions in <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) the first term dominates the complexity.</p>
        <p>Of note, CCA is one of the several steps in the integration algorithm of an earlier version of Seurat (<xref rid="btac220-B5" ref-type="bibr">Butler <italic toggle="yes">et al.</italic>, 2018</xref>). This had the objective to integrate distinct scRNA-seq experiments and CCA was performed in the common gene space, i.e. on transposed <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> matrices and the objective was to find matching cells.</p>
      </sec>
      <sec>
        <label>3.1.3</label>
        <title>Learning a shared space for multiple modalities</title>
        <p>For the case that <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mi mathvariant="script">Y</mml:mi></mml:math></inline-formula> has more than two modalities, we perform the pairwise integration of modalities starting with the pair with highest dimensionality. The result of this CCA is then used for integration with the next modality. See Algorithm 1 for a brief description, which receives a set of matrices <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> with increasing dimensions <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>≥</mml:mo><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> as input. This heuristic algorithm was adopted to avoid the high computational costs of multiple CCA, which grows exponentially with the number of modalities.</p>
        <p>
          <boxed-text id="btac220-BOX1" position="float">
            <label>Algorithm 1</label>
            <caption>
              <p>Multimodal MOJITOO Algorithm</p>
            </caption>
            <p><bold> procedure</bold> MOJITOO(<inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>)
<disp-formula id="E9a"><mml:math id="M10" display="block" overflow="scroll"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>i</mml:mi><mml:mo>←</mml:mo><mml:mn>2</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>←</mml:mo><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
            <p><bold> while</bold>  <inline-formula id="IE41"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>  <bold>do</bold>
 <disp-formula id="E9b"><mml:math id="M11" display="block" overflow="scroll"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>←</mml:mo><mml:mi mathvariant="italic">CCA</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>←</mml:mo><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>←</mml:mo><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>Z</mml:mi><mml:mo>←</mml:mo><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
            <p> <inline-formula id="IE43"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>←</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> ▹ only consider significantly correlated dimension
<disp-formula id="E9c"><mml:math id="M12" display="block" overflow="scroll"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>←</mml:mo><mml:mi>Z</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>i</mml:mi><mml:mo>←</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
            <p>  <bold>end while</bold></p>
            <p>  <bold>return</bold> <italic toggle="yes">Z</italic></p>
            <p> <bold>end procedure</bold></p>
            <p>
              <bold>end</bold>
            </p>
          </boxed-text>
        </p>
      </sec>
      <sec>
        <label>3.1.4</label>
        <title>Association of molecular features with latent space</title>
        <p>We can use the estimated latent spaces to associate molecular features to the latent space <italic toggle="yes">Z</italic>. For example, let <inline-formula id="IE45"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">RNA</mml:mi></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> be the gene expression matrix and <inline-formula id="IE46"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">ATAC</mml:mi></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> be the peak matrix, where <italic toggle="yes">n</italic> is the number of cells, <italic toggle="yes">s</italic> is the number of genes and <italic toggle="yes">t</italic> is the number of peaks. We can obtain a feature associating molecular features to the latent space by
<disp-formula id="E10"><label>(10)</label><mml:math id="M13" display="block" overflow="scroll"><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">RNA</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">RNA</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>·</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">ATAC</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">ATAC</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>·</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE47"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">RNA</mml:mi></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>×</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE48"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">ATAC</mml:mi></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>×</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. The <italic toggle="yes">i</italic>th column of matrix <inline-formula id="IE49"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">RNA</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> represent the scores of features in the <italic toggle="yes">i</italic>th canonical component.</p>
      </sec>
    </sec>
    <sec>
      <title>3.2 Datasets</title>
      <p>We make use of public multimodal datasets with two or tri-modalities in our evaluation. The first dataset is single-cell CITE-seq data which measures single-cell RNA and surface proteins simultaneously. The human bone marrow mononuclear cells (BM-CITE) dataset contains full transcriptomes and 25 surface proteins for over 30 672 cells annotated in 27 cell types (<xref rid="btac220-B30" ref-type="bibr">Stuart <italic toggle="yes">et al.</italic>, 2021</xref>). This data were obtained with the ‘LoadData(“bmcite”)’ command from package SeuratData. Next, we applied the pre-processing pipeline. Another CITE-seq data used were the human peripheral blood mononuclear cells from lung (LUNG-CITE) (<xref rid="btac220-B6" ref-type="bibr">Buus <italic toggle="yes">et al.</italic>, 2021</xref>) with 52 surface proteins. It contains 10 470 cells annotated in 22 cell types. This data were obtained from <ext-link xlink:href="https://archive.softwareheritage.org/browse/revision/1c7fcabb18a1971dc4d6e29bc3ed4f6f36b2361f/" ext-link-type="uri">here</ext-link>.</p>
      <p>The next dataset contains human peripheral blood mononuclear cells (PBMC-multiome) generated by the 10× multiome technology to measure gene expression (scRNA-seq) and chromatin accessibility (scATAC-seq) on the same cells. This data contains 11 787 cells with 13 cell types annotated by 10× Genomics. We use the scRNA-seq and scATAC-seq count matrices as provided by 10× genomics after processing with the cellranger pipeline obtained from the <ext-link xlink:href="https://www.10xgenomics.com/resources/datasets/pbmc-from-a-healthy-donor-granulocytes-removed-through-cell-sorting-10-k-1-standard-1-0-0" ext-link-type="uri">here</ext-link>. We also use a dataset based on the SHARE-seq protocol measuring gene expression and chromatin accessibility of mouse skin cells (SKIN-SHARE) (<xref rid="btac220-B21" ref-type="bibr">Ma <italic toggle="yes">et al.</italic>, 2020</xref>). This data contains 34 774 cells, which are annotated as 23 cell types. We obtain the skin scRNA-seq and scATAC-seq counts and fragments files from the Gene Expression Omnibus under accession number (<ext-link xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE140203" ext-link-type="uri">GSE140203</ext-link>).</p>
      <p>A tri-modal dataset of human PBMCs is measured with the DOGMA-seq protocol (<xref rid="btac220-B22" ref-type="bibr">Mimitou <italic toggle="yes">et al.</italic>, 2021</xref>). This provides RNA, ATAC and epitope sequencing of the same cells (PBMC-DOGMA). We use data under low-loss lysis condition, which contains 13 763 cells in 27 cell types. We download count matrices as provided by the authors <ext-link xlink:href="https://osf.io/6kr4v/" ext-link-type="uri">here</ext-link>. A second tri-modal dataset is based on human PBMCs measured with the TEA-seq protocol (<xref rid="btac220-B32" ref-type="bibr">Swanson <italic toggle="yes">et al.</italic>, 2021</xref>). It contains transcripts, epitopes and chromatin accessibility of 25 517 PBMCs grouped into 12 cell types (PBMC-TEA). For this dataset, we obtain original matrices and combine data from distinct wells from GEO (GSE158013). For scATAC-seq, we obtain an integrated matrix by combing peaks (allowing an extension of 250 bps). We finally intersect all barcodes from scRNA-seq, protein and scATAC-seq to obtain matrices in the same cell space. Characteristics of each of the six datasets are described in <xref rid="btac220-T1" ref-type="table">Table 1</xref>.</p>
      <table-wrap position="float" id="btac220-T1">
        <label>Table 1.</label>
        <caption>
          <p>Major characteristics of multiomics datasets</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Dataset</th>
              <th rowspan="1" colspan="1">Protocol</th>
              <th rowspan="1" colspan="1">Species</th>
              <th rowspan="1" colspan="1">Organ</th>
              <th rowspan="1" colspan="1">Modalities</th>
              <th rowspan="1" colspan="1">No. of cells</th>
              <th rowspan="1" colspan="1">No. of cell types</th>
              <th rowspan="1" colspan="1">No. of features (gene/peak/protein)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">BM-CITE</td>
              <td rowspan="1" colspan="1">CITE-seq</td>
              <td rowspan="1" colspan="1">Human</td>
              <td rowspan="1" colspan="1">Bone Marrow</td>
              <td rowspan="1" colspan="1">RNA/protein</td>
              <td rowspan="1" colspan="1">30 672</td>
              <td rowspan="1" colspan="1">27</td>
              <td rowspan="1" colspan="1">17 009/—/25</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">LUNG-CITE</td>
              <td rowspan="1" colspan="1">CITE-seq</td>
              <td rowspan="1" colspan="1">Human</td>
              <td rowspan="1" colspan="1">PBMC&amp;Lung</td>
              <td rowspan="1" colspan="1">RNA/protein</td>
              <td rowspan="1" colspan="1">10 470</td>
              <td rowspan="1" colspan="1">22</td>
              <td rowspan="1" colspan="1">33 514/—/52</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">PBMC-Multiome</td>
              <td rowspan="1" colspan="1">Multiome</td>
              <td rowspan="1" colspan="1">Human</td>
              <td rowspan="1" colspan="1">PBMC</td>
              <td rowspan="1" colspan="1">RNA/ATAC</td>
              <td rowspan="1" colspan="1">11 787</td>
              <td rowspan="1" colspan="1">13</td>
              <td rowspan="1" colspan="1">36 610/108 377/—</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Skin-SHARE</td>
              <td rowspan="1" colspan="1">SHARE-seq</td>
              <td rowspan="1" colspan="1">Mouse</td>
              <td rowspan="1" colspan="1">Skin</td>
              <td rowspan="1" colspan="1">RNA/ATAC</td>
              <td rowspan="1" colspan="1">34 774</td>
              <td rowspan="1" colspan="1">23</td>
              <td rowspan="1" colspan="1">23 296/344 592/—</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">PBMC-TEA</td>
              <td rowspan="1" colspan="1">TEA-seq</td>
              <td rowspan="1" colspan="1">Human</td>
              <td rowspan="1" colspan="1">PBMC</td>
              <td rowspan="1" colspan="1">RNA/ATAC/epitope</td>
              <td rowspan="1" colspan="1">25 517</td>
              <td rowspan="1" colspan="1">12</td>
              <td rowspan="1" colspan="1">36 601/128 853/47</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">PBMC-DOGMA</td>
              <td rowspan="1" colspan="1">DOGMA-seq</td>
              <td rowspan="1" colspan="1">Human</td>
              <td rowspan="1" colspan="1">PBMC</td>
              <td rowspan="1" colspan="1">RNA/ATAC/protein</td>
              <td rowspan="1" colspan="1">13 763</td>
              <td rowspan="1" colspan="1">27</td>
              <td rowspan="1" colspan="1">36 495/68 963/210</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <sec>
        <label>3.2.1</label>
        <title>Processing of single-cell sequencing data</title>
        <p>We perform a uniform pre-processing of all previously datasets starting from their count matrices. For scRNA-seq matrices, we adopt the standard Seurat 4 <ext-link xlink:href="https://satijalab.org/seurat/articles/pbmc3k_tutorial.html" ext-link-type="uri">pipeline</ext-link>. First, we log normalize the data by calling the function NormalizeData with default parameters. Next we use FindVariableFeatures to find top 3000 variable features and run ScaleData. Finally, we use RunPCA to perform dimension reduction (<xref rid="btac220-B12" ref-type="bibr">Hao <italic toggle="yes">et al.</italic>, 2021</xref>) by keeping the first 50 PCs. For scATAC-seq, we adopt the standard pipeline from <ext-link xlink:href="https://satijalab.org/signac/articles/pbmc_vignette.html" ext-link-type="uri">Signac</ext-link> (<xref rid="btac220-B30" ref-type="bibr">Stuart <italic toggle="yes">et al.</italic>, 2021</xref>). We first run TF-IDF (term frequency—inverse document frequency) on the peaks. Next, we use RunSVD on the top features calculated by function FindTopFeatures with parameter min.cutoff = ‘q0’, which provides an LSI dimension reduced matrix. We keep the first 50 dimensions, but we discard the first dimension as this is highly correlated to the number of fragments. For protein/epitopes, we adopt the standard Seurat 4 <ext-link xlink:href="https://satijalab.org/seurat/articles/multimodal_vignette.html" ext-link-type="uri">pipeline</ext-link> (<xref rid="btac220-B12" ref-type="bibr">Hao <italic toggle="yes">et al.</italic>, 2021</xref>). In short, we call NormalizeData with parameters normalization.method = ‘CLR’ and margin = 2 followed by ScaleData and RunPCA with 30 PCs using default parameters.</p>
        <p>PBMC-DOGMA is the only dataset evaluated here with two biological conditions (stimulated and unstimulated). To address the presence of batch, we apply the harmony integration (<xref rid="btac220-B18" ref-type="bibr">Korsunsky <italic toggle="yes">et al.</italic>, 2019</xref>) for RNA-seq and epitope data independently to integrate control and stimulated samples. For scATAC-seq, integration is performed by ignoring the first LSI dimension, which has a high correlation with the stimulation. MOJITOO results with and without batch correction are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref>. We provide these input matrices to MOJITOO, WNN, MOFA, DIABLO and Symphony. Other competing methods provide their own functionalities for normalization and dimension reduction, which are used accordingly (see below). Time and memory requirements of pre-processing data are considered for the benchmarking of the respective method.</p>
      </sec>
    </sec>
    <sec>
      <title>3.3 Benchmarking of integration methods</title>
      <p>We use three distinct metrics to measure the accuracy of the methods. The structure score measures the similarity between two latent space structures (<xref rid="btac220-B7687042" ref-type="bibr">Jain<italic toggle="yes"> et al.</italic>, 2021</xref>). It is based on the Pearson correlation of the pairwise Euclidean distance estimated on the shared (<italic toggle="yes">Z</italic>) and latent spaces (<inline-formula id="IE50"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) for each individual modality. This score indicates how well the shared space is related to the modality and the average values indicate how well integration worked. This metric is also employed by Schema (<xref rid="btac220-B27" ref-type="bibr">Singh <italic toggle="yes">et al.</italic>, 2021</xref>). We also evaluate the metrics concerning their distance representation using the silhouette score (<xref rid="btac220-B25" ref-type="bibr">Rousseeuw, 1987</xref>). For this, we use the labels as provided by the cluster of the respective dataset. We evaluate the use of Euclidean distance as ‘distance’ for the silhouette score. Finally, we evaluate the performance of methods regarding clustering. We perform Louvain clustering with varying resolution (parameter from 0.1 to 2.0) and estimate the adjusted Rand index (ARI) using cell labels (<xref rid="btac220-B14" ref-type="bibr">Hubert and Arabie, 1985</xref>).</p>
    </sec>
    <sec>
      <title>3.4 Execution of competing methods</title>
      <sec>
        <title>3.4.1 MOFA</title>
        <p>MOFA+ (<xref rid="btac220-B2" ref-type="bibr">Argelaguet <italic toggle="yes">et al.</italic>, 2020</xref>) uses Bayesian group factor analysis and variational inference to decompose individual modalities simultaneously by estimating a common latent factor matrix <italic toggle="yes">Z</italic>, as well as the weights for the transformation of the modalities to the latent space. MOFA+ includes a procedure to determine the optimal number of factors (dimension of the latent space) and has several hyper parameters for model regularization, detection of number of factors and learning rates. We execute MOFA with default parameters and followed their recommendations <ext-link xlink:href="https://raw.githack.com/bioFAM/MOFA2_tutorials/master/R_tutorials/10x_scRNA_scATAC.html" ext-link-type="uri">tutorial</ext-link> for the analysis of all data. However, we provide now PCA/LSI reductions as input for MOFA, as this improved its computational time (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>), as well the clustering performance on MOFA’s latent space (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>).</p>
      </sec>
      <sec>
        <title>3.4.2 Schema</title>
        <p>Schema (<xref rid="btac220-B27" ref-type="bibr">Singh <italic toggle="yes">et al.</italic>, 2021</xref>) explores metrics learning to re-weigh modality features through maximizing the agreement with other modalities. Specifically, it utilizes quadratic programming (QP) to learn a scaling transformation <italic toggle="yes">u</italic> for the primary matrix <italic toggle="yes">X</italic> such that pairwise distances of the transformation <inline-formula id="IE51"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mrow><mml:mi>u</mml:mi><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (where <inline-formula id="IE52"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mo>*</mml:mo></mml:math></inline-formula> is coordinate-wise multiplication, for each <inline-formula id="IE53"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula>) are highly correlated in other modalities. Schema has two main parameters: minimum desired correlation and number of random pairs. We run Schema using default parameters as in <ext-link xlink:href="https://schema-multimodal.readthedocs.io/en/latest/recipes/index.html" ext-link-type="uri">schema tutorial</ext-link>.</p>
      </sec>
      <sec>
        <title>3.4.3 Seurat4 WNN</title>
        <p>Weighted nearest neighbor (WNN) (<xref rid="btac220-B12" ref-type="bibr">Hao <italic toggle="yes">et al.</italic>, 2021</xref>) constructs single unified representation across multiple modalities. It first creates k-nearest neighbor (KNN) graphs for each modality based on the latent representation of each feature matrix. Next, it calculates affinities using the exponential kernel between a cell and the average NN for each modality. The latter is used to weigh cells. WNN has two major free parameters: the number of neighbors and scaling factor of the neighborhood kernel. We execute WNN, which is part of Seurat4, using default parameters. WNN does not provide a shared latent space, but we can use the weighted nearest neighbors graph to build a distance matrix that can be used in all benchmarking evaluations.</p>
      </sec>
      <sec>
        <title>3.4.4 scAI</title>
        <p>scAI simultaneously decomposes transcriptomic and epigenomic data into multiple biologically relevant factors (<xref rid="btac220-B8" ref-type="bibr">Clark <italic toggle="yes">et al.</italic>, 2018</xref>). Its framework is similar to MOFA, but it can only cope with two modalities at a time. scAI uses a stability method to define the rank (size of the latent space) and has three main free parameters used for model regularization. We execute scAI in only bi-modal with RNA and ATAC-seq datasets with default parameters.</p>
      </sec>
      <sec>
        <title>3.4.5 LIGER</title>
        <p>LIGER (<xref rid="btac220-B34" ref-type="bibr">Welch <italic toggle="yes">et al.</italic>, 2019</xref>), which is based on non-negative matrix factorization, was originally proposed for data integration whenever modalities are in the same feature space. A newer variant of LIGER (<xref rid="btac220-B6052098" ref-type="bibr">Kriebel and Welch, 2022</xref>) is able to perform integration, whenever there is some overlap between the features across modalities (shared features), i.e. protein and RNA expression of the same gene or gene accessibility scores for ATAC-seq. LIGER estimates a gene accessibility (ATAC-seq) matrix by counting the total number of ATAC-seq reads within the gene body and promoter regions(3 kb upstream) for each gene per cell. An additional unshared feature matrix is further produced by binning the genome into bins of 100 000 bps and counting the overlap of these bins with peaks from the respective dataset. LIGER has two major parameters: a regularization term and the number of factors (dimensions of the latent space). Regions associated to ENCODE Blacklist regions (<xref rid="btac220-B1" ref-type="bibr">Amemiya <italic toggle="yes">et al.</italic>, 2019</xref>) are removed. Moreover, LIGER can be only executed for bi-modal datasets.</p>
      </sec>
      <sec>
        <title>3.4.6 Symphony integration</title>
        <p>Symphony (<xref rid="btac220-B17" ref-type="bibr">Kang <italic toggle="yes">et al.</italic>, 2021</xref>) is a method to create single-cell reference atlas for subsequent annotation of new single-cell datasets. For a single case study with a multi-ome CITE-seq data, Symphony used canonical correlation analysis to find shared reference. This simple procedure differs from MOJITOO in several ways: it does not use dimension reduction as input; it is not able to cope with more than two modalities and it uses the latent space of only one modality (RNA) as shared space. Moreover, Symphony included the execution of batch correction with Harmony after the execution of CCA. The CCA analysis is not part of Symphony source code, but we implemented it based on a script provided by authors (<ext-link xlink:href="https://github.com/immunogenomics/TB_Tcell_CITEseq/blob/main/R/cca_analysis.R" ext-link-type="uri">https://github.com/immunogenomics/TB_Tcell_CITEseq/blob/main/R/cca_analysis.R</ext-link>). Also, due to high computational requirements, we were only able to run this on the dimension reduced space (PCA/LSI) described above. We call this method Symph-Int to reflect the fact that this is not Symphony, but an integration method used in one of the analysis of Symphony manuscript.</p>
      </sec>
      <sec>
        <title>3.4.7 DIABLO</title>
        <p>DIABLO (<xref rid="btac220-B26" ref-type="bibr">Singh <italic toggle="yes">et al.</italic>, 2019</xref>) is based on a generalized canonical analysis to integrate multiple datasets in a supervised way. It was originally designed for bulk multi-omics data, where sample labels are available and explored for feature selection. Since labels are not available for single-cell multi-modal data evaluated here, we provide a distinct label for each cell. DIABLO is executed as indicated in their <ext-link xlink:href="http://mixomics.org/mixdiablo/" ext-link-type="uri">tutorial</ext-link>. Due to a prohibitive computational costs if raw matrices are used, we provide dimension reduced matrices as input. Another major parameter is the number of CC components, which is usually set to the number of classes—1. Here, we used 30 components. Also, DIABLO does not provide a common latent space. We therefore combined the CCs to obtain a final latent space.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>4 Results</title>
    <sec>
      <title>4.1 Benchmarking of multimodal integration methods</title>
      <p>We evaluate MOJITTO and competing methods using six publicly available multimodal datasets with two or three modalities. These datasets have between 10 000 and 35 000 cells, 12 and 27 cell types and 25 to 344 492 features per modality (<xref rid="btac220-T1" ref-type="table">Table 1</xref>). We compare MOJITOO with MOFA (<xref rid="btac220-B2" ref-type="bibr">Argelaguet <italic toggle="yes">et al.</italic>, 2020</xref>), WNN (<xref rid="btac220-B12" ref-type="bibr">Hao <italic toggle="yes">et al.</italic>, 2021</xref>), Schema (<xref rid="btac220-B27" ref-type="bibr">Singh <italic toggle="yes">et al.</italic>, 2021</xref>), scAI (<xref rid="btac220-B16" ref-type="bibr">Jin <italic toggle="yes">et al.</italic>, 2020</xref>), LIGER (<xref rid="btac220-B6052098" ref-type="bibr">Kriebel and Welch, 2022</xref>), DIABLO (<xref rid="btac220-B26" ref-type="bibr">Singh <italic toggle="yes">et al.</italic>, 2019</xref>) and Symph-Int (<xref rid="btac220-B17" ref-type="bibr">Kang <italic toggle="yes">et al.</italic>, 2021</xref>). Of note, some methods (scAI, LIGER and Symph-Int) failed to be executed in some conditions, due to their inability to cope with more than 2 modalities or the lack of raw sequences for some of the evaluated datasets.</p>
      <p>First, we evaluate algorithms regarding their structure preservation, i.e. the average similarity between the euclidean distances in the shared space and distances in the space of each modality (<xref rid="btac220-B7687042" ref-type="bibr">Jain<italic toggle="yes"> et al.</italic>, 2021</xref>). Results indicate highest structure scores for MOJITOO (4 out of 6) followed by DIABLO (1 out of 6) and MOFA (1 out of 6). A ranking of the structure scores indicates MOJITOO as the best algorithm followed by DIABLO, MOFA and Symph-Int (<xref rid="btac220-F2" ref-type="fig">Fig. 2A</xref>). Interestingly, we observe that MOFA and Symph-Int tend to obtain higher structure scores for RNA and that MOJITOO and DIABLO have lower variance of structure scores across modalities. This suggests that the MOJITOO and DIABLO shared space captures information of all individual modalities more uniformly than competing methods. The lower performance of Symphony integration compared to other CCA methods (MOJITOO and DIABLO) is explained by the fact it only considers CCs from the RNA space as integrated embedding.</p>
      <fig position="float" id="btac220-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Benchmarking on data integration methods. (<bold>A</bold>) We show the average (trace) and modality-specific structure scores (dots) (<italic toggle="yes">y</italic>-axis) versus methods (<italic toggle="yes">x</italic>-axis) for the six datasets. The last graph shows the combined ranking of the method over all datasets, where the highest rank indicates the best performer. (<bold>B</bold>) Barplots showing silhouette score (<italic toggle="yes">y</italic>-axis) versus methods (<italic toggle="yes">x</italic>-axis) for six benchmark datasets. The last plot shows the combined ranked per method. (<bold>C</bold>) Boxplots showing ARI scores (<italic toggle="yes">y</italic>-axis) versus methods (<italic toggle="yes">x</italic>-axis) for distinct clustering solutions for all six data-sets. Asterisks indicate <italic toggle="yes">P</italic>-values of &lt;0.05(*), &lt;0.01(**), &lt;0.001(***), &lt;0.0001(****) obtained via <italic toggle="yes">t</italic>-test comparing the ARI values of MOJITOO versus other methods. The last boxplot shows the combined ranking for competing methods</p>
        </caption>
        <graphic xlink:href="btac220f2" position="float"/>
      </fig>
      <p>Next, we make use of the cell types reported in the original manuscripts introducing the single-cell datasets as true labels for benchmarking. First, we use these labels to evaluate the silhouette scores by contrasting class labels with Euclidean distance matrices estimates on the shared space. Regarding silhouette, MOFA is best in four out of six dataset, while MOJITTO is best in the other two datasets. MOJITOO obtains second rank in four out of six datasets and is ranked second in the overall ranking (<xref rid="btac220-F2" ref-type="fig">Fig. 2B</xref>). Finally, we perform Louvain clustering at distinct resolutions (0.1–2.0) on the shared latent space. We then measure the agreement of clustering results with labels using the Adjusted Rand Index (ARI). WNN and Symphony have the highest ARI in two datasets each, while DIABLO and MOJITOO have highest values in one dataset each (<xref rid="btac220-F2" ref-type="fig">Fig. 2C</xref>). MOJITOO has a higher rank than two in all dataset and has the highest overall rank followed by WNN and DIABLO. Moreover, we also perform a sensitivity analysis on MOJITOO to inspect if the dimension of the original PCA/LSI space has impact on its performance (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). We observe that if 50 or more components are used, MOJITOO obtain similar clustering and structure preservation scores. Examples of low dimensional embeddings obtained by distinct integration methods with the PBMC-Multiome dataset are provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4</xref>.</p>
      <p>A crucial aspect of single-cell analysis is the computational resources needed for computation on an increasing number of cells. For this, we inspect the time and memory used in the largest datasets in our benchmark (SKIN-SHARE). To obtain curves, we down-sample the number of cells from 30 000 to 3000 (<xref rid="btac220-F3" ref-type="fig">Fig. 3A and B</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1–S2</xref>). We observe that MOJITOO has the overall lowest computational requirement (2.4 min and 6.3 GBs) followed closely by MOFA (3.21 minuts and 13.09 GBs) and WNN (3.74 min and 6.8 GBs). DIABLO, on the other hand, required up to 103 min and 78.3 GBs for 30 000 cells, while scAI required 637 min and 75 GB of memory. Altogether, results indicate MOJITOO has the best recovery of data structure and clustering results, while being the fastest and having the lowest memory footprint among all competing methods.</p>
      <fig position="float" id="btac220-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Time and memory consumption on the Skin-SHARE. (<bold>A</bold>) Line plots showing elapsed time (log of seconds) for each method (<italic toggle="yes">y</italic>-axis). (<bold>B</bold>) Line plots showing peak memory (Gigabytes) required by each method (<italic toggle="yes">y</italic>-axis). In both A–B, the <italic toggle="yes">x</italic>-axis shows the number of cells used (randomly sampled) from the Skin-SHARE data</p>
        </caption>
        <graphic xlink:href="btac220f3" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>4.2 Canonical vectors support the interpretation of multiome data</title>
      <p>Additionally, we explore the use of the dimensions of the latent space (<italic toggle="yes">Z</italic>) as factors for interpreting the PBMC multiome data. We denote the latent features as canonical components (CC). As shown in <xref rid="btac220-F4" ref-type="fig">Figure 4</xref>, positive or negative values for the top CCs discern well all major cell types (<xref rid="btac220-F4" ref-type="fig">Fig. 4</xref>). High values of CC1 are associated to myeloid cells (CD14+ and CD16+ monocytes and dendritic cells), while negative values are associated to T and NK cells (<xref rid="btac220-F4" ref-type="fig">Fig. 4A</xref>). CC2 values discern B cell and plasmacytoid dendritic cells (pDC) from other cells, while CC3 differentiates B cells from pDCs (<xref rid="btac220-F4" ref-type="fig">Fig. 4B and C</xref>). Further CCs capture subtle changes between major cell sub-types (<xref rid="btac220-F4" ref-type="fig">Fig. 4D and E</xref>). CC4 and CC5 capture changes between naive T cells and active T CD8 and active T CD4 cells respectively, while CC5 captures differences between naive monocytes (CD14+) and activated monocytes (CD16+). Other smaller cell types (dendritic cells, platelets, double negative T cells and pre-B and progenitor B cells) can be characterized with further CCs (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>). We also evaluated CCs with low correlation, which were considered as noise by MOJITOO (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>). We observe that these CC have high scores for a few cells and low concordance across modalities. This supports their low biological relevance.</p>
      <fig position="float" id="btac220-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>(<bold>A–F</bold>) UMAP with the scores of CC1 to CC6. We highlight major cell types (or sub-types) associated to positive or negative CC scores and arrows indicate directions associated to the activation of particular immune cells</p>
        </caption>
        <graphic xlink:href="btac220f4" position="float"/>
      </fig>
      <p>Next, we explore the <italic toggle="yes">U</italic> matrices, which provide values associating molecular features with the latent dimensions (CCs). Indeed, the expression of genes with high CC1 values include monocyte genes as LYN and FCN1, while negative CC1 values are associated to T cell genes BCL11B and IL7R (<xref rid="btac220-F5" ref-type="fig">Fig. 5A</xref>). Similarly, we observe that top ranked peaks with high or low CC1 scores have monocyte or T-cell-specific open chromatin. These include regions close to the T cell gene BCL11B (<xref rid="btac220-F5" ref-type="fig">Fig. 5B</xref>). High CC2 value are associated with B cell genes IGHM and BCL11A, while low CC1 genes (BCBL11B and IL32) are associated with T cells (<xref rid="btac220-F5" ref-type="fig">Fig. 5C</xref>). As before, we observe cell-specific open chromatin patterns on top ranked ATAC-seq peaks associated with high and low CC2 values. Altogether, these results indicates that MOJITOO CCs can be used to capture major cell types of peripheral blood cells as well as to detect modality-specific molecular features associated to these.</p>
      <fig position="float" id="btac220-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>(<bold>A</bold>) Heatmap with scores for the top 10 positive and negative genes for CC1 (<italic toggle="yes">y</italic>-axis) versus cells (<italic toggle="yes">x</italic>-axis). Cells are ordered by CC1 scores (high to low). (<bold>B</bold>) Genome browser tracks with top 2 positive and negative peaks for CC1. Tracks correspond to normalized cell-specific pseudo bulk ATAC-seq profiles generated by deeptools (<xref rid="btac220-B23" ref-type="bibr">Ramírez <italic toggle="yes">et al.</italic>, 2016</xref>). Cell-specific tracks are ordered by CC1 score (high to low). (<bold>C</bold> and <bold>D</bold>) show respectively the heatmap of top genes and the genome browser of top peaks for CC2</p>
        </caption>
        <graphic xlink:href="btac220f5" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>5 Conclusion</title>
    <p>We present here MOJITOO, which is a fast and parameter free method based on canonical correlation analysis for integration of multimodal single-cell data of any protocol. A comprehensive analysis with six bi-modal and tri-modal multimodal datasets indicates that MOJITOO has the best performance regarding the preservation of the structures across modalities and the recovery of clusters, while it is ranked second regarding distance representation. Moreover, MOJITOO has the lowest time and memory requirements requiring 2.5 min and 6.4 GB in the largest dataset with 30.000 cells. WNN, which is the standard method for integration in Seurat, performed well on the clustering problem (2nd after MOJITOO) and had a low computational time, but had a poor performance in the structure preservation and silhouette scores. Moreover, WNN, which outputs a distance matrix on the shared space, does not provide latent features as MOJITOO, DIABLO or MOFA. MOFA performed well on distance representation, but was ranked fourth in the clustering problem and third at structure preservation score. DIABLO, which is also based in CCA, had an good predictive performance (2nd for structure preservation and 3rd in clustering and distance preservation), but had an a poor computational performance being the 2nd slowest method.</p>
    <p>An interesting result is the fact the structure preservation scores are more uniform across modalities for CCA-based methods MOJITOO and DIABLO, while runner-up methods (MOFA) obtained highest scores for the RNA modality. This is possibly rooted on the analytical frameworks of these methods. CCA analysis explicitly finds canonical vectors with high correlation across modalities, while matrix factorization methods (MOFA) do not explicitly guarantee factors are uniformly well represented across modalities. Of note, the CCA approach explored in Symphony was also biased toward structure preservation in RNA, due to the fact it only use RNA canonical vectors as a final latent representation. Another finding of this study is that matrix factorization methods (MOJITOO, MOFA, DIABLO), benefit from working with low dimensional matrices as input by having lower computational requirements. For MOFA, a comparison of the results with or without dimension reduction even indicates positive effects of low dimensional inputs in the clustering problem.</p>
    <p>It is important to point out that measures used in our benchmarking have their own limitations. The distance and clustering evaluation requires labels, which might be biased toward the methods used to derive the labels. Indeed, WNN does well on the clustering problem of the two CITE-seq data, which are originally evaluated with WNN. The Silhouete score has underlying distribution assumptions, which might not be met by the latent space generated by integration methods. Finally, the structure score requires a low-dimensional representation of the spaces. In this study, however, we consider methods performing well in all metrics, which mitigates biases of individual metrics.</p>
    <p>Finally, we highlight how a simple inspection of CCA derived latent spaces supports the biological interpretation and detection of relevant molecular features, as exemplified in the multiome PBMC dataset. Future work includes further exploring the interpretability of MOJITOO, for example, by finding associations between molecular features across modalities as gene to peak links (<xref rid="btac220-B11" ref-type="bibr">Granja <italic toggle="yes">et al.</italic>, 2021</xref>). Here, it would be interesting to explore potential non-linearities of features, as commonly explored in scRNA-seq data (<xref rid="btac220-B33" ref-type="bibr">Van Dijk <italic toggle="yes">et al.</italic>, 2018</xref>). Finally, an interesting topic is to investigate if differences in the modality-specific canonical vectors detected by MOJITOO can indicates biological properties of those. For example, in the Skin SHARE-seq data (<xref rid="btac220-B21" ref-type="bibr">Ma <italic toggle="yes">et al.</italic>, 2020</xref>), authors show that cells with changes in chromatin preceding changes in gene expression indicates cell differentiation.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This project was funded by the German Research Foundation (DFG) (project GE 2811/3-2) and the E: MED Consortia Fibromap funded by the German Ministry of Education and Science (BMBF).</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.  </p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>Pre-processed publically available data used for benchmarking is available at ZENODO: <ext-link xlink:href="https://doi.org/10.5281/zenodo.6348128" ext-link-type="uri">https://doi.org/10.5281/zenodo.6348128</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btac220_Supplementary_Data</label>
      <media xlink:href="btac220_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac220-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Amemiya</surname><given-names>H.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>The encode blacklist: identification of problematic regions of the genome</article-title>. <source>Sci. Rep</source>., <volume>9</volume>, <fpage>1</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">30626917</pub-id></mixed-citation>
    </ref>
    <ref id="btac220-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Argelaguet</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>MOFA+: a statistical framework for comprehensive integration of multi-modal single-cell data</article-title>. <source>Genome Biol</source>., <volume>21</volume>, <fpage>1</fpage>–<lpage>17</lpage>.</mixed-citation>
    </ref>
    <ref id="btac220-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Argelaguet</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Computational principles and challenges in single-cell data integration</article-title>. <source>Nat. Biotechnol</source>., <volume>39</volume>, <fpage>1202</fpage>–<lpage>1215</lpage>.<pub-id pub-id-type="pmid">33941931</pub-id></mixed-citation>
    </ref>
    <ref id="btac220-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Benjamini</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Hochberg</surname><given-names>Y.</given-names></string-name></person-group> (<year>1995</year>) <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>. <source>J. R. Stat. Soc. Ser. B (Methodological)</source>, <volume>57</volume>, <fpage>289</fpage>–<lpage>300</lpage>.</mixed-citation>
    </ref>
    <ref id="btac220-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Butler</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>. <source>Nat. Biotechnol</source>., <volume>36</volume>, <fpage>411</fpage>–<lpage>420</lpage>.<pub-id pub-id-type="pmid">29608179</pub-id></mixed-citation>
    </ref>
    <ref id="btac220-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buus</surname><given-names>T.B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Improving oligo-conjugated antibody signal in multimodal single-cell analysis</article-title>. <source>Elife</source>, <volume>10</volume>, <fpage>e61973</fpage>.<pub-id pub-id-type="pmid">33861199</pub-id></mixed-citation>
    </ref>
    <ref id="btac220-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cao</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Joint profiling of chromatin accessibility and gene expression in thousands of single cells</article-title>. <source>Science</source>, <volume>361</volume>, <fpage>1380</fpage>–<lpage>1385</lpage>.<pub-id pub-id-type="pmid">30166440</pub-id></mixed-citation>
    </ref>
    <ref id="btac220-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Clark</surname><given-names>S.J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>scNMT-seq enables joint profiling of chromatin accessibility DNA methylation and transcription in single cells</article-title>. <source>Nat. Commun</source>., <volume>9</volume>, <fpage>1</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">29317637</pub-id></mixed-citation>
    </ref>
    <ref id="btac220-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Efremova</surname><given-names>M.</given-names></string-name>, <string-name><surname>Teichmann</surname><given-names>S.A.</given-names></string-name></person-group> (<year>2020</year>) <article-title>Computational methods for single-cell omics across modalities</article-title>. <source>Nat. Methods</source>, <volume>17</volume>, <fpage>14</fpage>–<lpage>17</lpage>.<pub-id pub-id-type="pmid">31907463</pub-id></mixed-citation>
    </ref>
    <ref id="btac220-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gayoso</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Joint probabilistic modeling of single-cell multi-omic data with totalVI</article-title>. <source>Nat. Methods</source>, <volume>18</volume>, <fpage>272</fpage>–<lpage>282</lpage>.<pub-id pub-id-type="pmid">33589839</pub-id></mixed-citation>
    </ref>
    <ref id="btac220-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Granja</surname><given-names>J.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis</article-title>. <source>Nat. Genet</source>., <volume>53</volume>, <fpage>403</fpage>–<lpage>411</lpage>.<pub-id pub-id-type="pmid">33633365</pub-id></mixed-citation>
    </ref>
    <ref id="btac220-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hao</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Integrated analysis of multimodal single-cell data</article-title>. <source>Cell</source>, <volume>184</volume>, <fpage>3573</fpage>–<lpage>3587.e29</lpage>.<pub-id pub-id-type="pmid">34062119</pub-id></mixed-citation>
    </ref>
    <ref id="btac220-B3631751">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hu</surname>,<given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Single-cell RNA cap and tail sequencing (scRCAT-seq) reveals subtype-specific isoforms differing in transcript demarcation</article-title>. <source>Nat. Commun.</source>, <volume>11</volume>, <fpage>1</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">31911652</pub-id></mixed-citation>
    </ref>
    <ref id="btac220-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hubert</surname><given-names>L.</given-names></string-name>, <string-name><surname>Arabie</surname><given-names>P.</given-names></string-name></person-group> (<year>1985</year>) <article-title>Comparing partitions</article-title>. <source>J. Classif</source>., <volume>2</volume>, <fpage>193</fpage>–<lpage>218</lpage>.</mixed-citation>
    </ref>
    <ref id="btac220-B7687042">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jain</surname>,<given-names>M.S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>MultiMAP: dimensionality reduction and integration of multimodal data</article-title>. <source>Genome Biol.</source>, <volume>22</volume>, <fpage>1</fpage>–<lpage>26</lpage>.<pub-id pub-id-type="pmid">33397451</pub-id></mixed-citation>
    </ref>
    <ref id="btac220-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jin</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>scAI: an unsupervised approach for the integrative analysis of parallel single-cell transcriptomic and epigenomic profiles</article-title>. <source>Genome Biol</source>., <volume>21</volume>, <fpage>1</fpage>–<lpage>19</lpage>.</mixed-citation>
    </ref>
    <ref id="btac220-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kang</surname><given-names>J.B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Efficient and precise single-cell reference atlas mapping with symphony</article-title>. <source>Nat. Commun</source>., <volume>12</volume>, <fpage>1</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">33397941</pub-id></mixed-citation>
    </ref>
    <ref id="btac220-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Korsunsky</surname><given-names>I.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Fast, sensitive and accurate integration of single-cell data with harmony</article-title>. <source>Nat. Methods</source>, <volume>16</volume>, <fpage>1289</fpage>–<lpage>1296</lpage>.<pub-id pub-id-type="pmid">31740819</pub-id></mixed-citation>
    </ref>
    <ref id="btac220-B6052098">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kriebel</surname><given-names>A.R.</given-names></string-name>, <string-name><surname>Welch</surname><given-names>J.D.</given-names></string-name></person-group> (<year>2022</year>) <article-title>UINMF performs mosaic integration of single-cell multi-omic datasets using nonnegative matrix factorization</article-title>. <source>Nat. Commun.</source>, <volume>13</volume>, <fpage>1</fpage>–<lpage>17</lpage>.<pub-id pub-id-type="pmid">34983933</pub-id></mixed-citation>
    </ref>
    <ref id="btac220-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>Z.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Chromatin-accessibility estimation from single-cell ATAC-seq data with scOpen</article-title>. <source>Nat. Commun</source>., <volume>12</volume>, <fpage>1</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">33397941</pub-id></mixed-citation>
    </ref>
    <ref id="btac220-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Chromatin potential identified by shared single-cell profiling of RNA and chromatin</article-title>. <source>Cell</source><volume>183</volume>, <fpage>1103</fpage>–<lpage>1116</lpage>.<pub-id pub-id-type="pmid">33098772</pub-id></mixed-citation>
    </ref>
    <ref id="btac220-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mimitou</surname><given-names>E.P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Scalable, multimodal profiling of chromatin accessibility, gene expression and protein levels in single cells</article-title>. <source>Nat. Biotechnol</source>., <volume>39</volume>, <fpage>1246</fpage>.<pub-id pub-id-type="pmid">34083792</pub-id></mixed-citation>
    </ref>
    <ref id="btac220-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ramírez</surname><given-names>F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>deepTools2: a next generation web server for deep-sequencing data analysis</article-title>. <source>Nucleic Acids Res</source>., <volume>44</volume>, <fpage>W160</fpage>–<lpage>W165</lpage>.<pub-id pub-id-type="pmid">27079975</pub-id></mixed-citation>
    </ref>
    <ref id="btac220-B24">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Ramsay</surname><given-names>J.</given-names></string-name>, <string-name><surname>Silverman</surname><given-names>B.</given-names></string-name></person-group> (<year>1997</year>) <source>Functional Data Analysis</source>. <publisher-name>Springer</publisher-name>, New York, NY, pp. <fpage>199</fpage>–<lpage>216</lpage>.</mixed-citation>
    </ref>
    <ref id="btac220-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rousseeuw</surname><given-names>P.J.</given-names></string-name></person-group> (<year>1987</year>) <article-title>Silhouettes: a graphical aid to the interpretation and validation of cluster analysis</article-title>. <source>J. Comput. Appl. Math</source>., <volume>20</volume>, <fpage>53</fpage>–<lpage>65</lpage>.</mixed-citation>
    </ref>
    <ref id="btac220-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Singh</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>DIABLO: an integrative approach for identifying key molecular drivers from multi-omics assays</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>3055</fpage>–<lpage>3062</lpage>.<pub-id pub-id-type="pmid">30657866</pub-id></mixed-citation>
    </ref>
    <ref id="btac220-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Singh</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Schema: metric learning enables interpretable synthesis of heterogeneous single-cell modalities</article-title>. <source>Genome Biol</source>., <volume>22</volume>, <fpage>1</fpage>–<lpage>24</lpage>.<pub-id pub-id-type="pmid">33397451</pub-id></mixed-citation>
    </ref>
    <ref id="btac220-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stoeckius</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Simultaneous epitope and transcriptome measurement in single cells</article-title>. <source>Nat. Methods</source>, <volume>14</volume>, <fpage>865</fpage>–<lpage>868</lpage>.<pub-id pub-id-type="pmid">28759029</pub-id></mixed-citation>
    </ref>
    <ref id="btac220-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stuart</surname><given-names>T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Single-cell chromatin state analysis with signac</article-title>. <source>Nat. Methods</source>, <volume>9</volume>, <fpage>1</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="btac220-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Swanson</surname><given-names>E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Simultaneous trimodal single-cell measurement of transcripts, epitopes, and chromatin accessibility using TEA-seq</article-title>. <source>Elife</source>, <volume>10</volume>, <fpage>e63632</fpage>.<pub-id pub-id-type="pmid">33835024</pub-id></mixed-citation>
    </ref>
    <ref id="btac220-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Van Dijk</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Recovering gene interactions from single-cell data using data diffusion</article-title>. <source>Cell</source>, <volume>174</volume>, <fpage>716</fpage>–<lpage>729</lpage>.<pub-id pub-id-type="pmid">29961576</pub-id></mixed-citation>
    </ref>
    <ref id="btac220-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Welch</surname><given-names>J.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Single-cell multi-omic integration compares and contrasts features of brain cell identity</article-title>. <source>Cell</source>, <volume>177</volume>, <fpage>1873</fpage>–<lpage>1887</lpage>.<pub-id pub-id-type="pmid">31178122</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
