<?properties open_access?>
<?subarticle pone.0235748.r001?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7377372</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0235748</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-19-33090</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Motif Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Animal Genomics</subject>
              <subj-group>
                <subject>Mammalian Genomics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Mathematical and Statistical Techniques</subject>
          <subj-group>
            <subject>Mathematical Functions</subject>
            <subj-group>
              <subject>Convolution</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Molecular biology</subject>
          <subj-group>
            <subject>Molecular biology techniques</subject>
            <subj-group>
              <subject>Sequencing techniques</subject>
              <subj-group>
                <subject>DNA sequencing</subject>
                <subj-group>
                  <subject>DNase Seq</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and analysis methods</subject>
        <subj-group>
          <subject>Molecular biology techniques</subject>
          <subj-group>
            <subject>Sequencing techniques</subject>
            <subj-group>
              <subject>DNA sequencing</subject>
              <subj-group>
                <subject>DNase Seq</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Comparative Genomics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Comparative Genomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Epigenomics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Epigenomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Signal Transduction</subject>
            <subj-group>
              <subject>Cell Signaling</subject>
              <subj-group>
                <subject>Genomic Signal Processing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and analysis methods</subject>
        <subj-group>
          <subject>Database and informatics methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence analysis</subject>
              <subj-group>
                <subject>DNA sequence analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Predicting gene regulatory regions with a convolutional neural network for processing double-strand genome sequence information</article-title>
      <alt-title alt-title-type="running-head">Convolutional neural network for processing double-strand genome sequence information</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2428-9510</contrib-id>
        <name>
          <surname>Onimaru</surname>
          <given-names>Koh</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Project administration</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="corresp" rid="cor001">*</xref>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1969-2580</contrib-id>
        <name>
          <surname>Nishimura</surname>
          <given-names>Osamu</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kuraku</surname>
          <given-names>Shigehiro</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <addr-line>Laboratory for Phyloinformatics, RIKEN Center for Biosystems Dynamics Research (BDR), Chuo-ku, Kobe, Hyogo, Japan</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Makarenkov</surname>
          <given-names>Vladimir</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Universite du Quebec a Montreal, CANADA</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>koh.onimaru@riken.jp</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>23</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>15</volume>
    <issue>7</issue>
    <elocation-id>e0235748</elocation-id>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>11</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>6</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 Onimaru et al</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Onimaru et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0235748.pdf"/>
    <abstract>
      <p>With advances in sequencing technology, a vast amount of genomic sequence information has become available. However, annotating biological functions particularly of non-protein-coding regions in genome sequences without experiments is still a challenging task. Recently deep learning–based methods were shown to have the ability to predict gene regulatory regions from genome sequences, promising to aid the interpretation of genomic sequence data. Here, we report an improvement of the prediction accuracy for gene regulatory regions by using the design of convolution layers that efficiently process genomic sequence information, and developed a software, DeepGMAP, to train and compare different deep learning–based models (<ext-link ext-link-type="uri" xlink:href="https://github.com/koonimaru/DeepGMAP">https://github.com/koonimaru/DeepGMAP</ext-link>). First, we demonstrate that our convolution layers, termed forward- and reverse-sequence scan (FRSS) layers, integrate both forward and reverse strand information, and enhance the power to predict gene regulatory regions. Second, we assessed previous studies and identified problems associated with data structures that caused overfitting. Finally, we introduce visualization methods to examine what the program learned. Together, our FRSS layers improve the prediction accuracy for gene regulatory regions.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001691</institution-id>
            <institution>Japan Society for the Promotion of Science</institution>
          </institution-wrap>
        </funding-source>
        <award-id>17K15132</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2428-9510</contrib-id>
          <name>
            <surname>Onimaru</surname>
            <given-names>Koh</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution>Special Postdoctoral Researcher Program of RIKEN</institution>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2428-9510</contrib-id>
          <name>
            <surname>Onimaru</surname>
            <given-names>Koh</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100006264</institution-id>
            <institution>RIKEN</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <funding-statement>This work was supported in part by JSPS KAKENHI grant number 17K15132 to KO, a Special Postdoctoral Researcher Program of RIKEN to KO, and a research grant from MEXT to the RIKEN Center for Life Science Technologies and RIKEN Center for Biosystems Dynamics Research.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="4"/>
      <table-count count="2"/>
      <page-count count="17"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All codes used in this paper are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/koonimaru/DeepGMAP">https://github.com/koonimaru/DeepGMAP</ext-link>. The IDs for data downloaded from the ENCODE website are listed in <xref ref-type="supplementary-material" rid="pone.0235748.s009">S2 Table</xref>. The data generated and/or analyzed in the current study are available in the figshare repository, <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.6728348">https://doi.org/10.6084/m9.figshare.6728348</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All codes used in this paper are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/koonimaru/DeepGMAP">https://github.com/koonimaru/DeepGMAP</ext-link>. The IDs for data downloaded from the ENCODE website are listed in <xref ref-type="supplementary-material" rid="pone.0235748.s009">S2 Table</xref>. The data generated and/or analyzed in the current study are available in the figshare repository, <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.6728348">https://doi.org/10.6084/m9.figshare.6728348</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>In the last decade, advances in DNA sequencing technology have dramatically increased the amount of genome sequence data derived from diverse species [<xref rid="pone.0235748.ref001" ref-type="bibr">1</xref>] as well as from individual humans [<xref rid="pone.0235748.ref002" ref-type="bibr">2</xref>]. The next demanding challenge is the deeper understanding of how genome sequences encode phenotypes and how functional information can be extracted [<xref rid="pone.0235748.ref003" ref-type="bibr">3</xref>]. Such sequence-based understanding would ultimately enable the prediction of phenotypes based on genome sequence information, i.e., genotype-phenotype mapping. The syntax of protein-coding genes is well understood, e.g., certain phenotypic consequences are predictable (such as nonsense mutations), yet the basic rules for non-coding sequences have not been established. Several projects including ENCODE [<xref rid="pone.0235748.ref004" ref-type="bibr">4</xref>,<xref rid="pone.0235748.ref005" ref-type="bibr">5</xref>], ROADMAP [<xref rid="pone.0235748.ref006" ref-type="bibr">6</xref>], and FANTOM [<xref rid="pone.0235748.ref007" ref-type="bibr">7</xref>] have accumulated epigenomic data to annotate the characteristics of non-coding sequences, but a comprehensive understanding of the association between epigenomic signatures and sequence information has yet to be attained.</p>
    <p>Recently, this challenge has been addressed with deep learning–based methods [<xref rid="pone.0235748.ref008" ref-type="bibr">8</xref>–<xref rid="pone.0235748.ref011" ref-type="bibr">11</xref>]. Deep learning is a subfield of machine-learning methods, and has been applied to a variety of problems such as image classification and speech recognition [<xref rid="pone.0235748.ref012" ref-type="bibr">12</xref>]. For the application of deep learning to genomics, convolutional neural networks (CNN) or recurrent neural networks (RNN) are trained with input genomic sequences that are labeled with epigenomic data to predict functional non-coding sequences. Once trained, these types of classifiers can infer the functional effect of mutations in non-coding genomic regions from individual genome sequences. However, even though these deep learning–based classifiers have outperformed other methods, such as the support vector machine [<xref rid="pone.0235748.ref013" ref-type="bibr">13</xref>], the prediction accuracy is still far from satisfactory. In addition, as it is generally known [<xref rid="pone.0235748.ref014" ref-type="bibr">14</xref>], it remains elusive as to what deep learning–based models actually "learn" and what kinds of "understanding" underlies their predictions. In the present study, we first describe a CNN-based classifier that can outperform state-of-art models. Second, we identified problems associated with data structures that caused overfitting. Finally, we introduce methods to visualize trained models, potentially revealing the general syntax underlying regulatory sequences.</p>
  </sec>
  <sec sec-type="results" id="sec002">
    <title>Results</title>
    <p>To improve the accuracy of predicting regulatory sequences, we devised a deep learning–based method with three main features: a) integrating information from forward and reverse DNA sequences; b) simplifying the data structure; c) quality control to filter out low-quality data from a training dataset.</p>
    <sec id="sec003">
      <title>Training design and benchmarking</title>
      <p>As training data, we downloaded several alignment files containing data from chromatin accessibility assays and chromatin immunoprecipitation-sequencing (ChIP-seq) experiments from the ENCODE project, and regions enriched with reads were determined as peaks by MACS2 peak caller [<xref rid="pone.0235748.ref015" ref-type="bibr">15</xref>]. These data were used to mark genome sequences. We divided each of the mouse and human genome sequences into 1000-basepair (bp) windows and converted the four letters (i.e., A, C, G, T) into one-hot vectors (four dimensional zero-one vectors). To denote epigenomic marks, we assigned each window as 1 if it overlapped a signal positive region or 0 otherwise (signal negative) (see Methods for details). To reduce the number of potential artifacts caused by window boundaries, we also added windows that were shifted by 500 bp toward the 3′ side (<xref ref-type="fig" rid="pone.0235748.g001">Fig 1A</xref>; we refer to this window structure as 1-kbp window/0.5-kbp stride). These data were used to train CNN models (see <xref ref-type="supplementary-material" rid="pone.0235748.s001">S1 Fig</xref> for the overall scheme).</p>
      <fig id="pone.0235748.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0235748.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>The Forward- and Reverse-Sequence Scan (FRSS) layers and data structures.</title>
          <p>(<bold>A</bold>) Schematic representation of how to assign an epigenomic signal into a binary vector. A peak region (light blue bar) and the summit of a peak (red rectangle) are determined from epigenomic data and assigned as "1" to overlapping genomic regions (blue-filled rectangle), otherwise "0" (blue, empty rectangle). DeepGMAP, this study; DeepSEA, DanQ, previous studies. (<bold>B</bold>) The architecture of the FRSS layers. An input sequence is scanned by the first convolution kernels, and the kernels are rotated in parallel. After implementing the relu operation, pooling, and the second convolution, the two parallel outputs are combined through summation. (<bold>C</bold>) Illustration of the 180-degree rotation of kernels. Each variable in an M × N kernel is written as <italic>w</italic><sub><italic>m</italic>,<italic>n</italic>,<italic>h</italic>,<italic>k</italic></sub> ([<italic>m</italic>] = {0,…,<italic>M</italic>−1};[<italic>n</italic>] = {0,…,<italic>N</italic>−1};[<italic>h</italic>] = {0,…,<italic>H</italic>−1};[<italic>k</italic>] = {0,…,<italic>K</italic>−1}; H and K are the numbers of the channels and kernels, respectively). <italic>w</italic>′<sub><italic>m</italic>′,<italic>n</italic>′,<italic>h</italic>,<italic>k</italic></sub> is a variable after the 180-degree rotation, and equal to <italic>w</italic><sub>(<italic>M</italic>−1−<italic>m</italic>),(<italic>N</italic>−1−<italic>n</italic>),<italic>h</italic>,<italic>k</italic></sub> (also see Methods). In this example, a 9 × 4 kernel is trained to detect a sequence, AGCTAAAG (left). The geometric rotation of the kernel (right) results in the reverse complement of the original sequence. (<bold>D</bold>) A visual comparison between DNase-seq peaks and predictions of the conv4-FRSS and DeepSEA models. Black boxes indicate 1 kb-windows that overlap with peaks. Blue and purple boxes indicate peak regions predicted by the indicated models. Note that DeepSEA predictions contains many false positives. (<bold>E</bold>) The total number of false positives predicted by the DeepSEA model (purple) and the conv4-FRSS model (blue). The averages were calculated from predictions by three independently trained models.</p>
        </caption>
        <graphic xlink:href="pone.0235748.g001"/>
      </fig>
      <p>To find an effective architecture of neural networks, we first compared the network architecture of published models such as CNN-based models (DeepSEA [<xref rid="pone.0235748.ref009" ref-type="bibr">9</xref>] and Basset [<xref rid="pone.0235748.ref016" ref-type="bibr">16</xref>]) and a CNN-RNN hybrid (DanQ [<xref rid="pone.0235748.ref010" ref-type="bibr">10</xref>]; see <xref ref-type="supplementary-material" rid="pone.0235748.s008">S1 Table</xref> for details of the models). Because these models were implemented in different programming languages, we re-implemented them in our code (referred to as the DeepSEA-type model and so on) to examine only the effect of network architectures. In addition, because the aim of this benchmark is to find an architecture that can be efficiently trained with limited data (all epigenomic data are fundamentally limited by the genome size and the binding frequency of transcription factors), and the number of training epochs was constrained to one, which means that models were trained with the full dataset only once. Moreover, because full training of models sometimes take days or weeks, we simplified the training task in this benchmarking as follows: only a subset of mouse DNase-seq data was used (the data IDs are listed in <xref ref-type="supplementary-material" rid="pone.0235748.s009">S2 Table</xref>). As a result, the training dataset for this benchmark is composed of 16747 mini-batches (each mini-batch contains 100 data). For evaluation, we used the entire chromosome 2 sequence, which was excluded from training datasets, and calculated the prediction accuracy of models using two scores, namely the area under the receiver-operation curve (AUROC) and the area under the precision-recall curve (AUPRC). Because AUROC is not a proper criterion if the majority of the data is negatively labeled, we considered AUPRC as a more important criterion [<xref rid="pone.0235748.ref017" ref-type="bibr">17</xref>]. As a result, we found that the DeepSEA-type architecture performed better than the Basset-type and DanQ-type models at least in this training condition (<xref rid="pone.0235748.t001" ref-type="table">Table 1</xref>).</p>
      <table-wrap id="pone.0235748.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0235748.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>A performance comparison between models.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0235748.t001g" xlink:href="pone.0235748.t001"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="2" colspan="1"/>
                <th align="center" colspan="2" rowspan="1">129_ES_E14</th>
                <th align="center" colspan="2" rowspan="1">forebrain E11.5</th>
                <th align="center" colspan="2" rowspan="1">forelimb E11.5</th>
                <th align="center" colspan="2" rowspan="1">mean</th>
                <th align="center" rowspan="1" colspan="1">time<sup>b</sup></th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1">AUROC</th>
                <th align="center" rowspan="1" colspan="1">AUPRC</th>
                <th align="center" rowspan="1" colspan="1">AUROC</th>
                <th align="center" rowspan="1" colspan="1">AUPRC</th>
                <th align="center" rowspan="1" colspan="1">AUROC</th>
                <th align="center" rowspan="1" colspan="1">AUPRC</th>
                <th align="center" rowspan="1" colspan="1">AUROC</th>
                <th align="center" rowspan="1" colspan="1">AUPRC</th>
                <th align="left" rowspan="1" colspan="1"/>
              </tr>
            </thead>
            <tbody>
              <tr style="border-top:thick">
                <td align="center" rowspan="1" colspan="1">DeepSEA-type</td>
                <td align="center" rowspan="1" colspan="1">0.9234</td>
                <td align="center" rowspan="1" colspan="1">0.6038</td>
                <td align="center" rowspan="1" colspan="1">0.9141</td>
                <td align="center" rowspan="1" colspan="1">0.6380</td>
                <td align="center" rowspan="1" colspan="1">0.9315</td>
                <td align="center" rowspan="1" colspan="1">0.5734</td>
                <td align="center" rowspan="1" colspan="1">0.9230</td>
                <td align="center" rowspan="1" colspan="1">0.6051</td>
                <td align="center" rowspan="1" colspan="1">0.1773</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Basset-type</td>
                <td align="center" rowspan="1" colspan="1">0.9085</td>
                <td align="center" rowspan="1" colspan="1">0.5796</td>
                <td align="center" rowspan="1" colspan="1">0.9107</td>
                <td align="center" rowspan="1" colspan="1">0.6280</td>
                <td align="center" rowspan="1" colspan="1">0.9175</td>
                <td align="center" rowspan="1" colspan="1">0.5476</td>
                <td align="center" rowspan="1" colspan="1">0.9123</td>
                <td align="center" rowspan="1" colspan="1">0.5851</td>
                <td align="center" rowspan="1" colspan="1">0.0847</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">DanQ-type</td>
                <td align="center" rowspan="1" colspan="1">0.9057</td>
                <td align="center" rowspan="1" colspan="1">0.5785</td>
                <td align="center" rowspan="1" colspan="1">0.9076</td>
                <td align="center" rowspan="1" colspan="1">0.6214</td>
                <td align="center" rowspan="1" colspan="1">0.9046</td>
                <td align="center" rowspan="1" colspan="1">0.5164</td>
                <td align="center" rowspan="1" colspan="1">0.9059</td>
                <td align="center" rowspan="1" colspan="1">0.5721</td>
                <td align="center" rowspan="1" colspan="1">0.4586</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">DanQ-type block<sup>a</sup></td>
                <td align="center" rowspan="1" colspan="1">0.9053</td>
                <td align="center" rowspan="1" colspan="1">0.5699</td>
                <td align="center" rowspan="1" colspan="1">0.9063</td>
                <td align="center" rowspan="1" colspan="1">0.6168</td>
                <td align="center" rowspan="1" colspan="1">0.9030</td>
                <td align="center" rowspan="1" colspan="1">0.5031</td>
                <td align="center" rowspan="1" colspan="1">0.9049</td>
                <td align="center" rowspan="1" colspan="1">0.5633</td>
                <td align="center" rowspan="1" colspan="1">0.4832</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">conv4</td>
                <td align="center" rowspan="1" colspan="1">0.9300</td>
                <td align="center" rowspan="1" colspan="1">0.6234</td>
                <td align="center" rowspan="1" colspan="1">0.9146</td>
                <td align="center" rowspan="1" colspan="1">0.6426</td>
                <td align="center" rowspan="1" colspan="1">0.9351</td>
                <td align="center" rowspan="1" colspan="1">0.5884</td>
                <td align="center" rowspan="1" colspan="1">0.9266</td>
                <td align="center" rowspan="1" colspan="1">0.6181</td>
                <td align="center" rowspan="1" colspan="1">0.2548</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">conv3-FRSS</td>
                <td align="center" rowspan="1" colspan="1">0.9364</td>
                <td align="center" rowspan="1" colspan="1">0.6447</td>
                <td align="center" rowspan="1" colspan="1">0.9171</td>
                <td align="center" rowspan="1" colspan="1">0.6496</td>
                <td align="center" rowspan="1" colspan="1">0.9421</td>
                <td align="center" rowspan="1" colspan="1">0.6098</td>
                <td align="center" rowspan="1" colspan="1">0.9319</td>
                <td align="center" rowspan="1" colspan="1">0.6347</td>
                <td align="center" rowspan="1" colspan="1">0.3636</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">conv4-FRSS</td>
                <td align="center" rowspan="1" colspan="1">
                  <bold>0.9414</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <bold>0.6571</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <bold>0.9178</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <bold>0.6520</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <bold>0.9476</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <bold>0.6280</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <bold>0.9356</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <bold>0.6457</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">0.3729</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">conv4-FRSS+</td>
                <td align="center" rowspan="1" colspan="1">
                  <bold>0.9418</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <bold>0.6631</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <bold>0.9183</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <bold>0.6549</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <bold>0.9475</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <bold>0.6347</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <bold>0.9359</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <bold>0.6509</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">0.5802</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">conv4-nonFRSS</td>
                <td align="center" rowspan="1" colspan="1">0.9331</td>
                <td align="center" rowspan="1" colspan="1">0.6424</td>
                <td align="center" rowspan="1" colspan="1">0.9143</td>
                <td align="center" rowspan="1" colspan="1">0.6407</td>
                <td align="center" rowspan="1" colspan="1">0.9388</td>
                <td align="center" rowspan="1" colspan="1">0.6008</td>
                <td align="center" rowspan="1" colspan="1">0.9287</td>
                <td align="center" rowspan="1" colspan="1">0.6280</td>
                <td align="center" rowspan="1" colspan="1">0.3760</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">DanQ-FRSS</td>
                <td align="center" rowspan="1" colspan="1">0.9365</td>
                <td align="center" rowspan="1" colspan="1">0.6523</td>
                <td align="center" rowspan="1" colspan="1">0.9162</td>
                <td align="center" rowspan="1" colspan="1">0.6485</td>
                <td align="center" rowspan="1" colspan="1">0.9453</td>
                <td align="center" rowspan="1" colspan="1">0.6222</td>
                <td align="center" rowspan="1" colspan="1">0.9327</td>
                <td align="center" rowspan="1" colspan="1">0.6410</td>
                <td align="center" rowspan="1" colspan="1">0.7905</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t001fn001">
            <p><sup>a</sup>Tensorflow has several LSTM cells, and this model uses LSTMBlockCell, and the above uses LSTMCell. <sup>b</sup>the mean time (second) of 20 minibatch updates.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="sec004">
      <title>Reading forward and reverse-complementary sequences improve prediction accuracy</title>
      <p>Based on the above result, we next explored whether better models could be attained by modifying the DeepSEA architecture. First, as deeper convolutional networks are known to perform better [<xref rid="pone.0235748.ref018" ref-type="bibr">18</xref>], we inserted an additional convolution layer between the third convolution layer and the first fully connected layer of the DeepSEA-type model (with a reduced kernel number in some layers and smaller pooling patches). As expected, the four-layer convolutions achieved slightly better accuracy (conv4 in <xref rid="pone.0235748.t001" ref-type="table">Table 1</xref>). We next focused on one of the fundamental characteristics of genome sequences—the forward and reverse strands. In previous studies, the information on reverse-strand sequences was ignored or used as independent data. However, for example, transcription factors with leucine-zipper or helix-loop-helix domains bind both strands through dimerization, and such binding thus results in palindromic binding motifs [<xref rid="pone.0235748.ref019" ref-type="bibr">19</xref>,<xref rid="pone.0235748.ref020" ref-type="bibr">20</xref>]. Inspired by this fact, we devised a set of layers that can integrate information from the both strands (<xref ref-type="fig" rid="pone.0235748.g001">Fig 1B</xref> and Methods). We arranged the one-hot vectors that represent AGCT in a symmetric manner so that a 180-degree rotation of the one-hot vectors results in a reverse complementary sequence (<xref ref-type="fig" rid="pone.0235748.g001">Fig 1C</xref>). Thus, reverse-sequence information can be processed by rotating the kernels 180 degrees. The hidden layers derived from the two strands are combined by element-wise addition after the second convolution. We termed this architecture FRSS (<underline>f</underline>orward- and <underline>r</underline>everse-<underline>s</underline>equence <underline>s</underline>can) layers. The replacement of the first two convolutional layers in the DeepSEA-type model with FRSS (conv3-FRSS in <xref rid="pone.0235748.t001" ref-type="table">Table 1</xref>) improved the accuracy of prediction more than the simple addition of a convolution layer (conv4). Moreover, a four-layer convolution model with FRSS (conv4-FRSS) achieved higher AUPRC scores than the other models (<xref rid="pone.0235748.t001" ref-type="table">Table 1</xref>, and <xref ref-type="fig" rid="pone.0235748.g001">Fig 1D</xref> for a visual comparison). Although the magnitude of increase in AUPRC seemed subtle, the <xref ref-type="fig" rid="pone.0235748.g001">Fig 1D</xref> clearly showed a significant decrease in false positives. This visual intuition was validated by the total counts of false positives; the number of false positives by the DeepSEA-type model varied among replicates and was higher than those by the conv4-FRSS model (<xref ref-type="fig" rid="pone.0235748.g001">Fig 1E</xref>). Raising the kernel numbers of each convolution layer also slightly improved the performance (conv4-FRSS+ in <xref rid="pone.0235748.t001" ref-type="table">Table 1</xref>) but also increased computation time (the right most column in <xref rid="pone.0235748.t001" ref-type="table">Table 1</xref>). To confirm that the effect of FRSS resulted not from merely increase in the kenerl number but from the rotation of kernels, we replaced the rotated kernels with independently trainable kernels in the conv4-FRSS (named as "conv4-nonFRSS" in <xref rid="pone.0235748.t001" ref-type="table">Table 1</xref>). The replacement resulted in a poorer performance than the conv4-FRSS model, indicating that the rotated kernels improve training efficiency. We also found that the FRSS layers increased the learning efficiency of the DanQ model by a level comparable with conv4-FRSS (DanQ-FRSS in <xref rid="pone.0235748.t001" ref-type="table">Table 1</xref>). These results were consistently reproduced by repeated training and testing (<xref ref-type="supplementary-material" rid="pone.0235748.s010">S3 Table</xref>), indicating that the benchmark is robust against random initialization. Together, these results suggest that the FRSS layers enhance the predictive power of deep learning–based models.</p>
    </sec>
    <sec id="sec005">
      <title>The length of strides affect training efficiency</title>
      <p>Next, we examined the structure and quality of training data using the conv4-FRSS model. In certain previous studies, epigenomic signals were distributed into 200-bp windows of genome sequences, and 400-bp extra-sequences were added to the left and right sides of each window [<xref rid="pone.0235748.ref009" ref-type="bibr">9</xref>] (referred to as "DeepSEA-type data" in this study; <xref ref-type="fig" rid="pone.0235748.g001">Fig 1A</xref>). For comparison, we trained conv4-FRSS with the DeepSEA-type data structure. Training with the DeepSEA-type data yielded a higher AUROC score but a lower AUPRC score (DeepSEA-type in <xref rid="pone.0235748.t002" ref-type="table">Table 2</xref>). In addition, we tested several window and stride sizes and found that models can be trained most efficiently with a 1-kbp window and 0.3-kbp stride data. These results indicated that data-structure design is a critical factor for training models efficiently and that data augmentation using small strides, which was implemented in several studies [<xref rid="pone.0235748.ref021" ref-type="bibr">21</xref>,<xref rid="pone.0235748.ref022" ref-type="bibr">22</xref>], is not an optimal strategy for training models.</p>
      <table-wrap id="pone.0235748.t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0235748.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>A performance comparison between data structures.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0235748.t002g" xlink:href="pone.0235748.t002"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="2" colspan="1">Data structure</th>
                <th align="center" colspan="2" rowspan="1">chromosome 2 (true test)</th>
                <th align="center" colspan="2" rowspan="1">chromosome 1 (overfitting test)</th>
              </tr>
              <tr style="border-top:thick">
                <th align="center" rowspan="1" colspan="1">AUROC</th>
                <th align="center" rowspan="1" colspan="1">AUPRC</th>
                <th align="center" rowspan="1" colspan="1">AUROC</th>
                <th align="center" rowspan="1" colspan="1">AUPRC</th>
              </tr>
            </thead>
            <tbody>
              <tr style="border-top:thick">
                <td align="center" rowspan="1" colspan="1">DeepSEA-type</td>
                <td align="center" rowspan="1" colspan="1">0.9623</td>
                <td align="center" rowspan="1" colspan="1">0.4841</td>
                <td align="center" rowspan="1" colspan="1">0.9694</td>
                <td align="center" rowspan="1" colspan="1">0.4741</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">1 kb window/0.5 kb stride<sup>a</sup></td>
                <td align="center" rowspan="1" colspan="1">0.9356</td>
                <td align="center" rowspan="1" colspan="1">0.6457</td>
                <td align="center" rowspan="1" colspan="1">0.9453</td>
                <td align="center" rowspan="1" colspan="1">0.6293</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">1 kb window/0.4 kb stride</td>
                <td align="center" rowspan="1" colspan="1">0.9352</td>
                <td align="center" rowspan="1" colspan="1">0.6528</td>
                <td align="center" rowspan="1" colspan="1">0.9457</td>
                <td align="center" rowspan="1" colspan="1">0.6386</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">1 kb window/0.3 kb stride</td>
                <td align="center" rowspan="1" colspan="1">
                  <bold>0.9389</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <bold>0.6570</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">0.9515</td>
                <td align="center" rowspan="1" colspan="1">0.6618</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">1 kb window/0.2 kb stride</td>
                <td align="center" rowspan="1" colspan="1">0.9397</td>
                <td align="center" rowspan="1" colspan="1">0.6530</td>
                <td align="center" rowspan="1" colspan="1">0.9581</td>
                <td align="center" rowspan="1" colspan="1">0.6962</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">1 kb window/0.1 kb stride</td>
                <td align="center" rowspan="1" colspan="1">0.9368</td>
                <td align="center" rowspan="1" colspan="1">0.6396</td>
                <td align="center" rowspan="1" colspan="1">0.9689</td>
                <td align="center" rowspan="1" colspan="1">0.7757</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t002fn001">
            <p>The mean values of the three mouse DNase-seq data are shown. The columns under chromosome 2 are the results of true tests (the higher is better). The columns under chromosome 1 are overfitting tests (if the scores are higher than those of true tests, that is the sign of overfitting). <sup>a</sup>The same data with the mean values of conv4-FRSS in <xref rid="pone.0235748.t001" ref-type="table">Table 1</xref>.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="sec006">
      <title>conv4-FRSS outperforms previous models</title>
      <p>To validate the performance of the FRSS layers, we extended the list of training data. First, we newly trained conv4-FRSS with the same set of 125 human DNase-seq data used by Zhou &amp; Troyanskaya (2015) [<xref rid="pone.0235748.ref009" ref-type="bibr">9</xref>] (see <xref ref-type="supplementary-material" rid="pone.0235748.s009">S2 Table</xref> for the lists of data). We found that conv4-FRSS significantly outperformed DeepSEA and DanQ (<xref ref-type="fig" rid="pone.0235748.g002">Fig 2A and 2C</xref> and <xref ref-type="supplementary-material" rid="pone.0235748.s011">S4 Table</xref>; the scores of DeepSEA and DanQ were obtained from their publications; <ext-link ext-link-type="uri" xlink:href="https://media.nature.com/original/nature-assets/nmeth/journal/v12/n10/extref/nmeth.3547-S3.xlsx">https://media.nature.com/original/nature-assets/nmeth/journal/v12/n10/extref/nmeth.3547-S3.xlsx</ext-link> for DeepSEA and auc.txt of <ext-link ext-link-type="uri" xlink:href="https://github.com/uci-cbcl/DanQ">https://github.com/uci-cbcl/DanQ</ext-link> for DanQ). We also trained conv4-FRSS with 365 and 93 of human and mouse DNase-seq peaks, respectively ("hg38" and "mm10" in the <xref ref-type="fig" rid="pone.0235748.g002">Fig 2A</xref>; see <xref ref-type="supplementary-material" rid="pone.0235748.s009">S2 Table</xref> for the lists of data). As shown in the <xref ref-type="fig" rid="pone.0235748.g002">Fig 2A</xref> and <xref ref-type="supplementary-material" rid="pone.0235748.s011">S4 Table</xref>, we noticed that training with mouse data yielded higher performance than with human data. We also focused on CTCF ChIP-seq data because (a) CTCF has a general function in genome organization, (b) ENCODE releases plenty of CTCF data for both mice and humans, and (c) as evident for the AUPRC scores of DeepSEA (<xref ref-type="supplementary-material" rid="pone.0235748.s002">S2 Fig</xref>; reanalyzed data from Zhou &amp; Troyanskaya, 2015 [<xref rid="pone.0235748.ref009" ref-type="bibr">9</xref>]), the prediction accuracy is highly dependent on the target of ChIP-seq, and that of CTCF is the highest among transcription factors. As a result, the conv4-FRSS model was efficiently trained with both human and mouse CTCF data, and this model yielded a median AUPRC score of &gt;0.70 (<xref ref-type="fig" rid="pone.0235748.g002">Fig 2B and 2D</xref>; the scores of DeepSEA and DanQ were obtained from their publications). Together, these results validate the performance of the FRSS.</p>
      <fig id="pone.0235748.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0235748.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Performance analyses of models with extended datasets.</title>
          <p>(A, B) Comparison of AUPRCs of DNase-seq data (A) and CTCF data (B), respectively. The scores of DeepSEA and DanQ are obtained from their original studies. conv4-FRSS. hg38 and mm10 are the scores of conv4-FRSS with newly created training data using datasets obtained from the ENCODE project. filtered hg38 and mm10 are the prediction scores of conv4-FRSS trained with high-cFRiP datasets. p, two-sided Mann–Whitney–Wilcoxon test. Boxes, the lower to upper quantile values of the data; orange lines, the median; whiskers, the range of the data (Q1 –IQR × 1.5 and Q3 + IQR × 1.5 for the lower and upper bounds, respectively); flier points, those past the end of the whiskers. (C, D) Scatter plots of AUPRCs of DeepSEA (x axis; scores are obtained from its original data) and conv4-FRSS (y axis).</p>
        </caption>
        <graphic xlink:href="pone.0235748.g002"/>
      </fig>
    </sec>
    <sec id="sec007">
      <title>The quality control of training data</title>
      <p>In the above training with extended dataset, we suspected that several classes with low AUPRCs were attributable to poor data quality. To address this possibility, we calculated a known quality index, FRiP (fraction of reads in peaks [<xref rid="pone.0235748.ref023" ref-type="bibr">23</xref>]), of mouse CTCF data and found that classes with low AUPRCs tended to have low FRiPs (top panels in the <xref ref-type="supplementary-material" rid="pone.0235748.s003">S3 Fig</xref>), with some exceptions (arrows in the <xref ref-type="supplementary-material" rid="pone.0235748.s011">S4 Fig</xref> and <xref ref-type="supplementary-material" rid="pone.0235748.s012">S5 Table</xref>). Because FRiP is calculated based on reads in peaks per total reads, values may be inflated when the read number of the source data is too low. To correct such inflation, we multiplied FRiP by the fraction of genomic regions covered by at least one read in a genome. As shown in the <xref ref-type="supplementary-material" rid="pone.0235748.s003">S3 Fig</xref>, the corrected FRiPs (cFRiPs) could distinguish high and low AUPRC data more clearly. In addition, cFRiP yielded a stronger correlation with the total peak numbers of data than the uncorrected FRiP (bottom panels in the <xref ref-type="supplementary-material" rid="pone.0235748.s003">S3 Fig</xref>). Although the other datasets showed weaker relations between FRiP and AUPRC, data with optimal cutoff values of cFRiP increased the average AUPRC score except for the human CTCF data (filtered hg38 and mm10 data in the <xref ref-type="fig" rid="pone.0235748.g002">Fig 2A and 2B</xref>, and <xref ref-type="supplementary-material" rid="pone.0235748.s004">S4 Fig</xref>). These results suggested two points. First, the correction method reasonably represents the true quality of the data. Second, the linear correlation between peak numbers and cFRiPs implies that data quality is not saturated enough to detect all true peaks (and hence, the possibility remains that the model learns sample quality rather than cell-specific patterns). Therefore, whereas the ENCODE project seems to consider ≥1% FRiP as good data [<xref rid="pone.0235748.ref023" ref-type="bibr">23</xref>], our results suggest that higher stringency during quality control is required for the precise annotation of genomes.</p>
    </sec>
    <sec id="sec008">
      <title>The utility of conv4-FRSS</title>
      <p>Because the conv4-FRSS model showed a good accuracy for CTCF binding site prediction, we further examined the utility of this model. A comparison between the predictions of the model and CTCF motif regions detected by a motif scanning tool, FIMO [<xref rid="pone.0235748.ref024" ref-type="bibr">24</xref>] (FIMO in the <xref ref-type="fig" rid="pone.0235748.g003">Fig 3A</xref>) revealed that the model can predict CTCF binding regions that do not contain the canonical CTCF motif. In addition, we also used the class saliency extraction method [<xref rid="pone.0235748.ref025" ref-type="bibr">25</xref>] to identify informative sequences at the single-nucleotide level, which produce data similar to ChIP-seq signals (influential value in the <xref ref-type="fig" rid="pone.0235748.g003">Fig 3A</xref> and <xref ref-type="supplementary-material" rid="pone.0235748.s005">S5 Fig</xref>). This method is equivalent to the <italic>in silico</italic> saturation mutagenesis approach used previously [<xref rid="pone.0235748.ref008" ref-type="bibr">8</xref>,<xref rid="pone.0235748.ref009" ref-type="bibr">9</xref>] but is more computationally efficient because it does not require mutation-by-mutation evaluation (see Methods for details). Furthermore, using the dog genome (CanFam3.1), we performed a cross-species prediction of CTCF binding regions with the model trained solely with mouse data. As shown in the <xref ref-type="fig" rid="pone.0235748.g003">Fig 3B</xref>, the predictions of the model matched with the real CTCF signals of dog liver [<xref rid="pone.0235748.ref026" ref-type="bibr">26</xref>] and detected species-specific differences (compare red rectangles in the <xref ref-type="fig" rid="pone.0235748.g003">Fig 3</xref>), indicating the generality of the model. Based on all these data, we concluded that conv4-FRSS can be applied to diverse data.</p>
      <fig id="pone.0235748.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0235748.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>An example of CTCF binding site predictions on the HoxD cluster of mice and dogs.</title>
          <p>(<bold>A</bold>) Comparison between predictions by conv4-FRSS, experimaental data and motifs detected by FIMO in mouse chromosome 2 sequence. predictions, CTCF binding regions predicted by conv4-FRSS (prediction values ≥0.2 are shown, and the bluer is more probable); influential value, values calculated with the class saliency extraction method; mouse liver CTCF, alignment data from ENCFF627DYN; FIMO, CTCF sites that were detected by FIMO (black boxes, p ≤ 1e-4; gray boxes, 1e-4 &lt; p ≤ 1e-3). (<bold>B</bold>) Comparison between predictions by conv4-FRSS and experimaental data in the sequence of dog chromosome 36. dog liver CTCF, alignment data from ERR022304; red rectangles, a CTCF peak that is present in the mouse genome (solid rectangle) but not the dog genome (dashed rectangle).</p>
        </caption>
        <graphic xlink:href="pone.0235748.g003"/>
      </fig>
    </sec>
    <sec id="sec009">
      <title>Visualization of what deep-learning models learn about genome sequences</title>
      <p>To obtain insights into how the models predict regulatory sequences, we visualized conv4-FRSS trained with the subset of mouse DNase-seq data. First, as has been done in previous studies [<xref rid="pone.0235748.ref008" ref-type="bibr">8</xref>,<xref rid="pone.0235748.ref010" ref-type="bibr">10</xref>], we analyzed individual kernels of the first layer, which directly interact with DNA sequences and thus represent DNA motifs that are important for classifying regulatory sequences. We converted the weight variables to probability matrices by using a softmax-like operation and found that established models have indeed learned many known transcription factor binding motifs, such as those bound by CTCF, SOX9, OCT4 and KLF4 (<xref ref-type="fig" rid="pone.0235748.g004">Fig 4A</xref>, <xref ref-type="supplementary-material" rid="pone.0235748.s006">S6 Fig</xref> and see <xref ref-type="supplementary-material" rid="pone.0235748.s013">S6 Table</xref> for full comparison between the kernels and known motifs). Next, we applied the activation maximization method [<xref rid="pone.0235748.ref025" ref-type="bibr">25</xref>,<xref rid="pone.0235748.ref027" ref-type="bibr">27</xref>,<xref rid="pone.0235748.ref028" ref-type="bibr">28</xref>], in which we look for DNA sequences that maximize neuron activities in the final layer of a trained model by training the sequence itself (see Methods for formal mathematical expressions). First, we trained a sequence to activate the 129 ES E14–specific neuron in the last output layer. As with image-recognition studies [<xref rid="pone.0235748.ref025" ref-type="bibr">25</xref>,<xref rid="pone.0235748.ref028" ref-type="bibr">28</xref>], this method generated randomly repeated sequences that probably capture the 129 ES E14 class-specific traits (<xref ref-type="fig" rid="pone.0235748.g004">Fig 4B</xref>). Using the motif comparison software Tomtom [<xref rid="pone.0235748.ref029" ref-type="bibr">29</xref>], we found that the generated sequence contained the motifs of several reprogramming-related transcription factors, such as OCT4/SOX2 and KLF4, which are important for the pluripotency of embryonic stem cells [<xref rid="pone.0235748.ref030" ref-type="bibr">30</xref>] (the full detected motifs are listed in <xref ref-type="supplementary-material" rid="pone.0235748.s014">S7 Table</xref>). For comparison, we also trained a sequence to activate all of the three classes of the neurons, resulting in a CTCF motif–rich sequence (<xref ref-type="fig" rid="pone.0235748.g004">Fig 4C</xref>). This result is consistent with the general role of CTCF as an enhancer looping factor [<xref rid="pone.0235748.ref031" ref-type="bibr">31</xref>]. In addition, the generated sequence also contained small motifs next to the well-known 20-bp motif (dashed boxes in the <xref ref-type="fig" rid="pone.0235748.g004">Fig 4C</xref>, which resembled the other part of the alternative long CTCF motif (33/34 bp in length, including an additional GGNANTGCA or TGCANTNCC sequence) [<xref rid="pone.0235748.ref026" ref-type="bibr">26</xref>] (the full detected motifs are listed in <xref ref-type="supplementary-material" rid="pone.0235748.s015">S8 Table</xref>). Thus, the detection of motifs that are longer than the kernel size constitutes one of the advantages of this activation maximization method. Taken together, the activation maximization method helps understand how deep-learning models predict enhancer sequences.</p>
      <fig id="pone.0235748.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0235748.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Visualization of trained kernels and results of the activation maximization method.</title>
          <p>(A) Examples of known motifs (top) that match with kernels. (B, C) Sequences trained to activate the 129 ES E14–specific neuron in the last layer (B) and all neurons in the last layer (C), respectively. Boxes in the left panel, OCT4/SOX2 binding motifs; dashed boxes in the left panel, KLF4 binding motifs; boxes in the right panel, CTCF binding motifs; dashed boxes, motifs similar to the second part of the alternative longer CTCF motif.</p>
        </caption>
        <graphic xlink:href="pone.0235748.g004"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec010">
    <title>Discussions</title>
    <p>Our results demonstrate that a new convolution architecture, FRSS, efficiently discerns patterns of regulatory DNA sequences. Furthermore, the analyses of data quality and structure revealed that training efficiencies highly depend on the means by which the source data are filtered and processed. Although the visualization methods are still in development, these methods will provide researchers with clues for understanding the syntax of gene regulatory sequences.</p>
    <p>We designed FRSS to process the information for forward and reverse sequences simultaneously, and we demonstrated the efficacy of FRSS for this purpose. This is the first to show that a new CNN architecture specialized for processing DNA sequences outperforms existing models. However, there are many ways for designing layers for this purpose. For example, instead of pair-wise summation in the last layer of FRSS, one can concatenate the output tensors similar to bidirectional RNN [<xref rid="pone.0235748.ref032" ref-type="bibr">32</xref>]. In addition, during finishing this study, we found a study that implemented a CNN model with a similar idea but a different architecture, although their model seemed to suffer from a run-time memory problem, and they did not clearly compare the performance of their model with that of other models [<xref rid="pone.0235748.ref033" ref-type="bibr">33</xref>]. We choose the current FRSS architecture because its computational cost is smaller than that of other configurations. However, better architectures may be possible that retain low computational cost yet offer greater prediction power. Overall, our study indicates that neural net designs that take the nature of genomic molecules into account will yield high accuracy for genomic information processing. We released DeepGMAP (<ext-link ext-link-type="uri" xlink:href="https://github.com/koonimaru/DeepGMAP">https://github.com/koonimaru/DeepGMAP</ext-link>), a software that allows users to train models and predict regulatory sequences in <italic>de novo</italic> genome sequences.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec011">
    <title>Materials and methods</title>
    <sec id="sec012">
      <title>Dataset and processing</title>
      <p>The sequences for the human (hg19, hg38) and mouse (mm10) genomes were downloaded from UCSC (<ext-link ext-link-type="uri" xlink:href="http://hgdownload.soe.ucsc.edu/goldenPath/">http://hgdownload.soe.ucsc.edu/goldenPath/</ext-link>). Mitochondrial DNA sequences were excluded from analyses. The genomic sequences were divided into 1-kbp windows with a variety of strides as described in Results. The filtered alignment files for epigenomic data were downloaded from the ENCODE website (<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/">https://www.encodeproject.org/</ext-link>; see <xref ref-type="supplementary-material" rid="pone.0235748.s009">S2 Table</xref> for details). A peak caller, MACS2 version 2.1.1.20160309, was used to determine signal peak regions with the following options: "callpeak—call-summits -t &lt;target bam file&gt; -c &lt;control bam file&gt; -f &lt;BAM or BAMPE&gt; -g &lt;hs or mm&gt; -q 0.01" for ChIP-seq, and "callpeak—call-summits -q 0.01 –nomodel–shift -100 –extsize 200 -t &lt;target bam file&gt; -f &lt;BAM or BAMPE&gt; -g &lt;hs or mm&gt;" for DNase-seq. Using the outputs of MACS2, bedtools [<xref rid="pone.0235748.ref034" ref-type="bibr">34</xref>], and our codes, genomic regions were designated as positive if windows were found to overlap with the summits of peaks (<xref ref-type="fig" rid="pone.0235748.g001">Fig 1A</xref>). DNase-seq data with &lt; 10,000 peaks were excluded from training data because they showed an apparent poor quality. For comparative analyses in <xref ref-type="fig" rid="pone.0235748.g002">Fig 2A and 2B</xref>, peak files were downloaded from <ext-link ext-link-type="uri" xlink:href="http://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/">http://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/</ext-link> (these peak files were generated by ENCODE using hg19). These data were used to mark genome sequences. For cross-species comparison, CanFam 3.1 was downloaded from NCBI (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/genome/?term=dog">https://www.ncbi.nlm.nih.gov/genome/?term=dog</ext-link>), and the short reads for CTCF ChIP-seq data (ERR022304) were downloaded from EMBL-EBI ArrayExpress (<ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-437/">https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-437/</ext-link>).</p>
      <p>We divided each of the mouse and human genome sequences into 1000-basepair (bp) windows and converted the four letters into one-hot vectors (four dimensional zero-one vectors). Namely, the DNA symbols, A, G, C, T and N were converted into one-hot vectors: (1, 0, 0, 0), (0, 1, 0, 0), (0, 0, 1, 0), (0, 0, 0, 1), and (0, 0, 0, 0), respectively. Therefore, one training sample became a 1000×4 tensor. To reduce the number of potential artifacts caused by window boundaries, we also added windows that were shifted by 500 bp toward the 3′ side (<xref ref-type="fig" rid="pone.0235748.g001">Fig 1A</xref>). With a mini-batch number of 100 for the stochastic gradient descent and channel dimension 1 (a dimension for colors if the input was image data), the final shape of the input tensor was 100×1000×4×1. To denote epigenomic marks, we assigned each window as 1 if it overlapped a signal positive region or 0 otherwise, which became a label tensor of size mini-batch number×class number [i.e., 100 label vectors, and each label looks like (0, 0, 0, 1, 0, 1, …., 0); see the <xref ref-type="supplementary-material" rid="pone.0235748.s001">S1 Fig</xref> for visual illustration]. We generated several training datasets with different reference genome sequences (for example, we used the mm10 genome sequence for the mouse DNase-seq peaks that we determined with MACS2 and the hg19 genome sequence for the peak files downloaded from <ext-link ext-link-type="uri" xlink:href="http://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/">http://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/</ext-link>).</p>
    </sec>
    <sec id="sec013">
      <title>Design of models and implementation</title>
      <p>Tensorflow r1.8 for python (<ext-link ext-link-type="uri" xlink:href="https://www.tensorflow.org/">https://www.tensorflow.org/</ext-link>) with CUDA Driver v9.0 and cuDNN v7.0.5 was used as the main machine-learning library for model implementation. The Tensorflow library was compiled from the source codes with the bazel compiler (<ext-link ext-link-type="uri" xlink:href="https://bazel.build/">https://bazel.build/</ext-link>; with options: "-c opt—copt = -mavx—copt = -mavx2—copt = -mfma—copt = -mfpmath = both—copt = -msse4.2—config = cuda -k //tensorflow/tools/pip_package:build_pip_package"). For convolutions, we used a module, tensorflow.nn.conv2d, with options: "strides = [<xref rid="pone.0235748.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0235748.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0235748.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0235748.ref001" ref-type="bibr">1</xref>], padding = VALID". For the Basset model, because batch normalization did not yield any positive effects, we removed this operation. For RNN layers, we used the long short-term memory cells [<xref rid="pone.0235748.ref035" ref-type="bibr">35</xref>] (tensorflow.nn.rnn_cell.LSTMCell or tensorflow.contrib.rnn.LSTMBlockCell without the peephole option) and tensorflow.nn.bidirectional_dynamic_rnn for output calculations. The operations and hyperparameters of models are listed in <xref ref-type="supplementary-material" rid="pone.0235748.s008">S1 Table</xref>.</p>
      <p>For the FRSS layers, convolution kernels were rotated 180 degrees to extract reverse complementary information in the first and second layers in parallel with normal convolutions as follows. Let <italic>W</italic><sup><italic>l</italic></sup> a weight tensor of size M×N×H×K (M, kernel height; N, kernel width; H, input channel number; K, output channel number) in the <italic>l</italic> th convolution layer, defined as <inline-formula id="pone.0235748.e001"><alternatives><graphic xlink:href="pone.0235748.e001.jpg" id="pone.0235748.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> ([<italic>m</italic>] = {0,…,<italic>M</italic>−1};[<italic>n</italic>] = {0,…,<italic>N</italic>−1};[<italic>h</italic>] = {0,…,<italic>H</italic>−1};[<italic>k</italic>] = {0,…,<italic>K</italic>−1}). The rotated tensor <inline-formula id="pone.0235748.e002"><alternatives><graphic xlink:href="pone.0235748.e002.jpg" id="pone.0235748.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> can be written as <inline-formula id="pone.0235748.e003"><alternatives><graphic xlink:href="pone.0235748.e003.jpg" id="pone.0235748.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> (see the <xref ref-type="fig" rid="pone.0235748.g001">Fig 1C</xref> for a visual illustration for the rotation). Then, the first part of the FRSS layers is
<disp-formula id="pone.0235748.e004"><alternatives><graphic xlink:href="pone.0235748.e004.jpg" id="pone.0235748.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>v</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>v</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>X</italic><sup><italic>l</italic></sup> is an input/output tensor of size B×S×N×H (B, mini batch number; S, sequence length; N, input width; H, input channel number) in the <italic>l</italic> th convolution layer, <inline-formula id="pone.0235748.e005"><alternatives><graphic xlink:href="pone.0235748.e005.jpg" id="pone.0235748.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is the output of convolution with the rotated tensor, <italic>conv</italic> is the convolution operation, <italic>relu</italic> is the rectified linear unit, and <italic>pool</italic> is the max pooling operation of size 2×1 and stride 2. The second part of the FRSS layers is
<disp-formula id="pone.0235748.e006"><alternatives><graphic xlink:href="pone.0235748.e006.jpg" id="pone.0235748.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></alternatives></disp-formula>
Note that the variables of <inline-formula id="pone.0235748.e007"><alternatives><graphic xlink:href="pone.0235748.e007.jpg" id="pone.0235748.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> are not independent training targets but rather are the copies of those of <italic>W</italic><sup><italic>l</italic></sup>.</p>
    </sec>
    <sec id="sec014">
      <title>Training and testing models</title>
      <p>Stochastic gradient–based optimization was used for training models. For human data, the chromosome 8 and 9 were excluded from training data. For mouse data, the chromosome 2 was excluded. The excluded sequences were used to test trained models. hg19 genome was used for comparisons with previously reported AUPRCs (<xref ref-type="fig" rid="pone.0235748.g002">Fig 2A and 2B</xref>). A training dataset was subdivided into mini-batches containing 100 sequences. In the quick benchmark, because the fraction of positively labeled genomic windows was too small, negative samples were randomly downsampled to 25%. To accelerate the learning rate and compensate for the limited data size, each mini-batch was further divided into two sub-mini-batches, and updates were made alternately twice per sub-mini-batch (i.e., four updates per mini-batch). The loss function we used for training our models and the DeepSEA model is
<disp-formula id="pone.0235748.e008"><alternatives><graphic xlink:href="pone.0235748.e008.jpg" id="pone.0235748.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math></alternatives></disp-formula>
where <italic>y</italic><sub><italic>k</italic></sub> is a label of class <italic>k</italic>, <inline-formula id="pone.0235748.e009"><alternatives><graphic xlink:href="pone.0235748.e009.jpg" id="pone.0235748.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is a prediction after the sigmoid operation, <inline-formula id="pone.0235748.e010"><alternatives><graphic xlink:href="pone.0235748.e010.jpg" id="pone.0235748.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is the L2 regularization of all variables, ‖<italic>H</italic>‖<sub>1</sub> is the L1 regularization of predictions before the sigmoid operation. <italic>λ</italic><sub>1</sub> and <italic>λ</italic><sub>2</sub> were set as 5×10<sup>−7</sup> and1×10<sup>−8</sup>, respectively according to [<xref rid="pone.0235748.ref009" ref-type="bibr">9</xref>]. For the remaining models, the loss function without the regularization terms was used. The optimization algorithms RMSprop [<xref rid="pone.0235748.ref036" ref-type="bibr">36</xref>] and Adam [<xref rid="pone.0235748.ref037" ref-type="bibr">37</xref>] were used to train the DanQ model and the others, respectively. To monitor training accuracy, models were tested by every mini-batch before updating variables and then evaluated based on the F1 score (<inline-formula id="pone.0235748.e011"><alternatives><graphic xlink:href="pone.0235748.e011.jpg" id="pone.0235748.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>⋅</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mo>⋅</mml:mo><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>) to assess temporal accuracy. When a mean of F1 scores of the last three tests exceeded a certain threshold (0.75), models were tested by three mini-batch sets that had been randomly excluded from a training dataset and saved when a higher F1 score was attained relative to the previous test.</p>
      <p>NVIDIA TITAN X (Pascal; 3584 CUDA Cores; total amount of global memory, 12190 Mbytes; GPU Max Clock rate, 1531 MHz) was used for GPU-computing. Intel Xeon Processor E5-2640 v4 (2.40 GHz) was used for CPU-computing (see <xref ref-type="supplementary-material" rid="pone.0235748.s007">S1 Note</xref> for the full specification of our machine). Total training time was dependent on the number of classes, the amount of training data, and model architecture. For example, conv4-FRSS took three hours to train with the subset of mm10 DNase-seq data (three classes) and 11 hours with hg38 DNase-seq (365 classes). The bottleneck was, in part, to send tensor data from the GPU to CPU for evaluation of the temporal accuracy of the training models. In previous studies, training time was reported as 85 hours in the Basset paper with NVIDIA Tesla K20m and 164 classes, and as approximately 15 days in the DanQ paper with NVIDIA Titan Z and 919 classes. However, a fair comparison of training time with previous studies is difficult owing to differences in the machines, languages, and datasets.</p>
      <p>To test trained models, the chromosome 2 sequence for mice and chromosome 8 and 9 sequences for humans were divided into the same window size and stride with those of the training data. AUROC and AUPRC were calculated with functions in the scikit-learn library version 0.19.1 (<ext-link ext-link-type="uri" xlink:href="http://scikit-learn.org/stable/">http://scikit-learn.org/stable/</ext-link>). We compared the accuracy between a model trained with the full training data and one saved during training, and adopted the one with higher AUPRCs. AUPRCs of DeepSEA and DanQ in the <xref ref-type="fig" rid="pone.0235748.g002">Fig 2A and 2B</xref> were obtained from <xref ref-type="supplementary-material" rid="pone.0235748.s010">S3 Table</xref> of the DeepSEA paper (<ext-link ext-link-type="uri" xlink:href="https://media.nature.com/original/nature-assets/nmeth/journal/v12/n10/extref/nmeth.3547-S3.xlsx">https://media.nature.com/original/nature-assets/nmeth/journal/v12/n10/extref/nmeth.3547-S3.xlsx</ext-link>) and auc.txt of the DanQ repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/uci-cbcl/DanQ">https://github.com/uci-cbcl/DanQ</ext-link>) and are listed in our <xref ref-type="supplementary-material" rid="pone.0235748.s011">S4 Table</xref>. Predictions presented in the Figs <xref ref-type="fig" rid="pone.0235748.g001">1D</xref> and <xref ref-type="fig" rid="pone.0235748.g003">3</xref> were visualized using the integrative genomics viewer [<xref rid="pone.0235748.ref038" ref-type="bibr">38</xref>].</p>
    </sec>
    <sec id="sec015">
      <title>The class saliency extraction method</title>
      <p>To evaluate informative sequences at the single-nucleotide level (<xref ref-type="fig" rid="pone.0235748.g003">Fig 3</xref> and <xref ref-type="supplementary-material" rid="pone.0235748.s005">S5 Fig</xref>), the class saliency extraction method was performed as previously described [<xref rid="pone.0235748.ref025" ref-type="bibr">25</xref>] with slight modifications. Let <italic>S</italic><sub><italic>i</italic></sub>(<italic>X</italic><sup>0</sup>) be the score of the class <italic>i</italic> before sigmoidal operation, computed by the conv4-FRSS model for an arbitrary DNA sequence <italic>X</italic><sup>0</sup> of size 1000×4×1. In other words, <italic>S</italic><sub><italic>i</italic></sub>(<italic>X</italic><sup>0</sup>) is a function that includes all operations such as FRSS, convolution and fully-connected layers except the last sigmoidal operation. The derivative of <italic>S</italic><sub><italic>i</italic></sub>(<italic>X</italic><sup>0</sup>) with respect to <italic>X</italic><sup>0</sup> is
<disp-formula id="pone.0235748.e012"><alternatives><graphic xlink:href="pone.0235748.e012.jpg" id="pone.0235748.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:mi>ω</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math></alternatives></disp-formula>
where <inline-formula id="pone.0235748.e013"><alternatives><graphic xlink:href="pone.0235748.e013.jpg" id="pone.0235748.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is a given DNA sequence. The derivative <italic>ω</italic> is a tensor of size 1000×4×1, and each element corresponds to each element of <italic>X</italic><sup>0</sup>. The values shown in the <xref ref-type="fig" rid="pone.0235748.g003">Fig 3A</xref> and <xref ref-type="supplementary-material" rid="pone.0235748.s005">S5 Fig</xref> (orange) are ∑<sub><italic>n</italic></sub>|<italic>ω</italic><sub><italic>s</italic>,<italic>n</italic>,<italic>h</italic></sub>| (s = 0, …, 999; <italic>n =</italic> 0,…, 3; <italic>h</italic> = 0). To remove irrelevant values, the figures only show sequences with <italic>S</italic><sub><italic>i</italic></sub>(<italic>X</italic><sup>0</sup>)≥−2.0. These values represent the magnitude of the effect on the class score when nucleotide substitutions occur. Therefore, these values may be termed as influential values.</p>
    </sec>
    <sec id="sec016">
      <title>FRiP calculation and correction</title>
      <p>To calculate FRiPs, initially, mitochondrial and black-listed regions (<ext-link ext-link-type="uri" xlink:href="https://sites.google.com/site/anshulkundaje/projects/blacklists">https://sites.google.com/site/anshulkundaje/projects/blacklists</ext-link>) were removed from peak files. A module, "countReadsPerBin.CountReadsPerBin" in deeptools [<xref rid="pone.0235748.ref039" ref-type="bibr">39</xref>], was used to count reads in peaks, and these read counts were then divided by total reads. As a correction for read number differences, FRiP was multiplied by the fraction of genome regions covered by at least one read.</p>
    </sec>
    <sec id="sec017">
      <title>Visualizing the inside of a trained model</title>
      <p>Variables in each kernel were converted to a probability matrix by a softmax-like operation. Tomtom [<xref rid="pone.0235748.ref029" ref-type="bibr">29</xref>] version 4.12.0 and MEME motif database version 12.15 (<ext-link ext-link-type="uri" xlink:href="http://meme-suite.org/meme-software/Databases/motifs/motif_databases.12.15.tgz">http://meme-suite.org/meme-software/Databases/motifs/motif_databases.12.15.tgz</ext-link>) were used to identify closely related known transcription factor binding motifs. For visualizing kernels in the first layer of FRSS, the probability matrices were scaled by information content. Motif logos except Tomtom outputs were generated by our customized codes using the cairocffi library (<ext-link ext-link-type="uri" xlink:href="https://cairocffi.readthedocs.io/en/latest/">https://cairocffi.readthedocs.io/en/latest/</ext-link>).</p>
    </sec>
    <sec id="sec018">
      <title>The activation maximization method</title>
      <p>Let <inline-formula id="pone.0235748.e014"><alternatives><graphic xlink:href="pone.0235748.e014.jpg" id="pone.0235748.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula> be the score of the class <italic>i</italic> (<italic>i</italic> = 0,1,2), computed by the conv4-FRSS model for a sequence <italic>X</italic><sup>0</sup>. To find a sequence that is specific to class <italic>i</italic>, we sought to optimize the following problem:
<disp-formula id="pone.0235748.e015"><alternatives><graphic xlink:href="pone.0235748.e015.jpg" id="pone.0235748.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:munder><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:math></alternatives></disp-formula>
where <italic>λ</italic> = 5.0×10<sup>−3</sup>. For the common sequence (right panel in the <xref ref-type="fig" rid="pone.0235748.g004">Fig 4</xref>), the problem was:
<disp-formula id="pone.0235748.e016"><alternatives><graphic xlink:href="pone.0235748.e016.jpg" id="pone.0235748.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:munder><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">∏</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:math></alternatives></disp-formula>
These formulae differ slightly from those reported previously [<xref rid="pone.0235748.ref025" ref-type="bibr">25</xref>] because our model used the sigmoid function for the last output, whereas the others used softmax. The optimizer Adam was used to optimize the target sequence. The initialization of variables of <italic>X</italic><sup><bold>0</bold></sup> was set to have a mean of 0.02 and stddev of 0.02, and this was a critical factor for this optimization problem. Training with different initialization conditions sometimes did not converge, suggesting that the optimization landscape is rugged and there is a possibility that the results shown in the <xref ref-type="fig" rid="pone.0235748.g004">Fig 4</xref> are not the optimal solution. The generated sequences were visualized with our customized codes using the cairocffi library. Tomtom was used to find motifs in the generated sequences.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="sec019">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pone.0235748.s001">
      <label>S1 Fig</label>
      <caption>
        <title>Illustration of how a convolutional neural network reads DNA sequences.</title>
        <p>(<bold>A</bold>) One-hot vectors that represent a DNA sequence. A 1-kbp DNA sequence is converted into a 1000<bold>×</bold>4 matrix. (<bold>B</bold>) A general convolutional network for sequence classifications. Only the first layer is shown, as an example. In the first layer, 9<bold>×</bold>4 kernels "scan" a sequence by striding base pair-by-base pair. Each "scan" is actually an element-wise multiplication of the values of a kernel (wmnhk) with values of 0 or 1 in a part of the sequence, yielding a scalar value represented by the black-to-white colored boxes shown below. By striding, scalar values are concatenated to a vector of size 992 (1000–9 + 1). Because the layer has multiple kernels (320 in this case), the output of the layer is 320 vectors. Maxpooling chooses maximum elements in each window. In this case, because the window size is 2, the total length of the sequence is halved by pooling. After fully connecting the layers, sigmoid operations yield output values between 0 and 1, which is compared with the class labels of "0" and "1".</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0235748.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0235748.s002">
      <label>S2 Fig</label>
      <caption>
        <title>AUPRCs of the DeepSEA model.</title>
        <p>Boxplots of AUPRCs sorted by factors. The data were derived from nmeth.3547-S3.xlsx of Zhou &amp; Troyanskaya (2015). Boxes, the lower-to-upper quantile values for the data; orange lines, the median; whiskers, the range of the data. Flier points, those past the end of the whiskers. Note that the prediction of CTCF binding sites (red rectangle) had the best performance among transcription factors.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0235748.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0235748.s003">
      <label>S3 Fig</label>
      <caption>
        <title>Scatter plots for FRiP and corrected FRiP with AUPRCs (top panels) and peak numbers (bottom panels).</title>
        <p>AUPRCs are the prediction accuracy of conv4-FRSS trained with mm10 CTCF dataset. Black arrows indicate data with low AUPRCs but relatively high FRiP scores. The quality of these data is reasonably estimated with cFRiP. The validity of cFRiP is also supported by the better correlation with peak numbers. corr., Spearman’s correlation.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0235748.s003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0235748.s004">
      <label>S4 Fig</label>
      <caption>
        <title>The average of AUPRCs with various cutoff values of corrected FRiP.</title>
        <p>(<bold>A, B</bold>) Plots of average AUPRCs for human and mouse DNase-seq data (<bold>A</bold> and <bold>B</bold>) and CTCF data (<bold>C</bold> and <bold>D</bold>) as a function of cutoff values of corrected FRiPs. Note that increase in cutoff values of the corrected FRiPs results in an increase of the average AUPRCs, at least to some extent, except as shown in <bold>c</bold>. Red line, cutoff values for the filtered data in <xref ref-type="fig" rid="pone.0235748.g002">Fig 2A and 2B</xref>.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0235748.s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0235748.s005">
      <label>S5 Fig</label>
      <caption>
        <title>Evaluation of informative sequences at the single-nucleotide level.</title>
        <p>(<bold>A</bold>) CTCF binding distribution of mouse liver E14.5, as an example. Influential value, the values calculated by the class saliency extraction method; Prediction, CTCF binding sites predicted with conv4-FRSS; CTCF signal, CTCF ChIP-seq signals derived from ENCFF844ZSH; red rectangle, a region magnified in b. Note that the distribution of influential values is similar to that of the CTCF signal although the model is not directly trained with the signal data. (<bold>B</bold>) Comparison of influential values and CTCF binding motif. The CTCF binding motifs were detected with FIMO. Note that nucleotides with high influential value (orange) are aligned with the high information content sites in the CTCF motif (arrows).</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0235748.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0235748.s006">
      <label>S6 Fig</label>
      <caption>
        <title>All kernels of conv4-FRSS trained by a subset of the mouse DNase-seq data.</title>
        <p>Note that several kernels contain little information and thus appear empty. These kernels may suggest either that the kernel number was sufficiently set or that training was insufficient to optimize all kernels.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0235748.s006.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0235748.s007">
      <label>S1 Note</label>
      <caption>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0235748.s007.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0235748.s008">
      <label>S1 Table</label>
      <caption>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0235748.s008.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0235748.s009">
      <label>S2 Table</label>
      <caption>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0235748.s009.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0235748.s010">
      <label>S3 Table</label>
      <caption>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0235748.s010.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0235748.s011">
      <label>S4 Table</label>
      <caption>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0235748.s011.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0235748.s012">
      <label>S5 Table</label>
      <caption>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0235748.s012.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0235748.s013">
      <label>S6 Table</label>
      <caption>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0235748.s013.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0235748.s014">
      <label>S7 Table</label>
      <caption>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0235748.s014.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0235748.s015">
      <label>S8 Table</label>
      <caption>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0235748.s015.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank Dr. Yuichiro Hara for critical comments and Dr. Mitsutaka Kadota for discussions concerning unpublished data.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0235748.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Meadows</surname><given-names>JRS</given-names></name>, <name><surname>Lindblad-Toh</surname><given-names>K</given-names></name>. <article-title>Dissecting evolution and disease using comparative vertebrate genomics</article-title>. <source>Nat Rev Genet</source>. <year>2017</year>;<volume>18</volume>: <fpage>624</fpage>–<lpage>636</lpage>. <pub-id pub-id-type="doi">10.1038/nrg.2017.51</pub-id><?supplied-pmid 28736437?><pub-id pub-id-type="pmid">28736437</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><collab>Consortium 1000 Genomes Project</collab>, <name><surname>Abecasis</surname><given-names>GR</given-names></name>, <name><surname>Auton</surname><given-names>A</given-names></name>, <name><surname>Brooks</surname><given-names>LD</given-names></name>, <name><surname>DePristo</surname><given-names>MA</given-names></name>, <name><surname>Durbin</surname><given-names>RM</given-names></name>, <etal>et al</etal><article-title>An integrated map of genetic variation from 1,092 human genomes</article-title>. <source>Nature</source>. <year>2012</year>;<volume>491</volume>: <fpage>56</fpage>–<lpage>65</lpage>. <pub-id pub-id-type="doi">10.1038/nature11632</pub-id><?supplied-pmid 23128226?><pub-id pub-id-type="pmid">23128226</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Kratochwil</surname><given-names>CF</given-names></name>, <name><surname>Meyer</surname><given-names>A</given-names></name>. <article-title>Closing the genotype-phenotype gap: Emerging technologies for evolutionary genetics in ecological model vertebrate systems</article-title>. <source>BioEssays</source>. <year>2015</year>;<volume>37</volume>: <fpage>213</fpage>–<lpage>226</lpage>. <pub-id pub-id-type="doi">10.1002/bies.201400142</pub-id><?supplied-pmid 25380076?><pub-id pub-id-type="pmid">25380076</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Yue</surname><given-names>F</given-names></name>, <name><surname>Cheng</surname><given-names>Y</given-names></name>, <name><surname>Breschi</surname><given-names>A</given-names></name>, <name><surname>Vierstra</surname><given-names>J</given-names></name>, <name><surname>Wu</surname><given-names>W</given-names></name>, <name><surname>Ryba</surname><given-names>T</given-names></name>, <etal>et al</etal><article-title>A comparative encyclopedia of DNA elements in the mouse genome</article-title>. <source>Nature</source>. <year>2014</year>;<volume>515</volume>: <fpage>355</fpage>–<lpage>364</lpage>. <pub-id pub-id-type="doi">10.1038/nature13992</pub-id><?supplied-pmid 25409824?><pub-id pub-id-type="pmid">25409824</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Bernstein</surname><given-names>BE</given-names></name>, <name><surname>Birney</surname><given-names>E</given-names></name>, <name><surname>Dunham</surname><given-names>I</given-names></name>, <name><surname>Green</surname><given-names>ED</given-names></name>, <name><surname>Gunter</surname><given-names>C</given-names></name>, <name><surname>Snyder</surname><given-names>M</given-names></name>. <article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>. <source>Nature</source>. <year>2012</year>;<volume>489</volume>: <fpage>57</fpage>–<lpage>74</lpage>. <pub-id pub-id-type="doi">10.1038/nature11247</pub-id><?supplied-pmid 22955616?><pub-id pub-id-type="pmid">22955616</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Bernstein</surname><given-names>BE</given-names></name>, <name><surname>Stamatoyannopoulos</surname><given-names>JA</given-names></name>, <name><surname>Costello</surname><given-names>JF</given-names></name>, <name><surname>Ren</surname><given-names>B</given-names></name>, <name><surname>Milosavljevic</surname><given-names>A</given-names></name>, <name><surname>Meissner</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>The NIH roadmap epigenomics mapping consortium</article-title>. <source>Nat. Biotechnol</source>. <year>2010</year> pp. <fpage>1045</fpage>–<lpage>1048</lpage>. <pub-id pub-id-type="doi">10.1038/nbt1010-1045</pub-id>
<?supplied-pmid 20944595?><pub-id pub-id-type="pmid">20944595</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Andersson</surname><given-names>R</given-names></name>, <name><surname>Gebhard</surname><given-names>C</given-names></name>, <name><surname>Miguel-Escalada</surname><given-names>I</given-names></name>, <name><surname>Hoof</surname><given-names>I</given-names></name>, <name><surname>Bornholdt</surname><given-names>J</given-names></name>, <name><surname>Boyd</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>An atlas of active enhancers across human cell types and tissues</article-title>. <source>Nature</source>. <year>2014</year>;<volume>507</volume>: <fpage>455</fpage>–<lpage>461</lpage>. <pub-id pub-id-type="doi">10.1038/nature12787</pub-id><?supplied-pmid 24670763?><pub-id pub-id-type="pmid">24670763</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Kelley</surname><given-names>DR</given-names></name>, <name><surname>Snoek</surname><given-names>J</given-names></name>, <name><surname>Rinn</surname><given-names>JL</given-names></name>. <article-title>Basset: Learning the regulatory code of the accessible genome with deep convolutional neural networks</article-title>. <source>Genome Res</source>. <year>2016</year>;<volume>26</volume>: <fpage>990</fpage>–<lpage>999</lpage>. <pub-id pub-id-type="doi">10.1101/gr.200535.115</pub-id><?supplied-pmid 27197224?><pub-id pub-id-type="pmid">27197224</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Zhou</surname><given-names>J</given-names></name>, <name><surname>Troyanskaya</surname><given-names>OG</given-names></name>. <article-title>Predicting effects of noncoding variants with deep learning–based sequence model.</article-title><source>Nat Methods</source>. <year>2015</year>;<volume>12</volume>: <fpage>931</fpage>–<lpage>934</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.3547</pub-id><?supplied-pmid 26301843?><pub-id pub-id-type="pmid">26301843</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Quang</surname><given-names>D</given-names></name>, <name><surname>Xie</surname><given-names>X</given-names></name>. <article-title>DanQ: A hybrid convolutional and recurrent deep neural network for quantifying the function of DNA sequences</article-title>. <source>Nucleic Acids Res</source>. <year>2016</year>;<volume>44</volume>: <fpage>e107</fpage><pub-id pub-id-type="doi">10.1093/nar/gkw226</pub-id><?supplied-pmid 27084946?><pub-id pub-id-type="pmid">27084946</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Alipanahi</surname><given-names>B</given-names></name>, <name><surname>Delong</surname><given-names>A</given-names></name>, <name><surname>Weirauch</surname><given-names>MT</given-names></name>, <name><surname>Frey</surname><given-names>BJ</given-names></name>. <article-title>Predicting the sequence specificities of DNA- and RNA-binding proteins by deep learning</article-title>. <source>Nat Biotechnol</source>. <year>2015</year>;<volume>33</volume>: <fpage>831</fpage>–<lpage>838</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.3300</pub-id><?supplied-pmid 26213851?><pub-id pub-id-type="pmid">26213851</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Lecun</surname><given-names>Y</given-names></name>, <name><surname>Bengio</surname><given-names>Y</given-names></name>, <name><surname>Hinton</surname><given-names>G</given-names></name>. <article-title>Deep learning</article-title>. <source>Nature</source>. <year>2015</year>;<volume>521</volume>: <fpage>436</fpage>–<lpage>444</lpage>. <pub-id pub-id-type="doi">10.1038/nature14539</pub-id><?supplied-pmid 26017442?><pub-id pub-id-type="pmid">26017442</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Ghandi</surname><given-names>M</given-names></name>, <name><surname>Lee</surname><given-names>D</given-names></name>, <name><surname>Mohammad-Noori</surname><given-names>M</given-names></name>, <name><surname>Beer</surname><given-names>MA</given-names></name>. <article-title>Enhanced regulatory sequence prediction using gapped k-mer features</article-title>. <source>PLoS Comput Biol</source>. <year>2014</year>;<volume>10</volume><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003711</pub-id><?supplied-pmid 25033408?><pub-id pub-id-type="pmid">25033408</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Alain</surname><given-names>G</given-names></name>, <name><surname>Bengio</surname><given-names>Y</given-names></name>. <article-title>Understanding intermediate layers using linear classifier probes</article-title>. Preprint at <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1610.01644">http://arxiv.org/abs/1610.01644</ext-link>. <year>2016</year> Available: <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1610.01644">http://arxiv.org/abs/1610.01644</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>Y</given-names></name>, <name><surname>Liu</surname><given-names>T</given-names></name>, <name><surname>Meyer</surname><given-names>CA</given-names></name>, <name><surname>Eeckhoute</surname><given-names>J</given-names></name>, <name><surname>Johnson</surname><given-names>DS</given-names></name>, <name><surname>Bernstein</surname><given-names>BE</given-names></name>, <etal>et al</etal><article-title>Model-based analysis of ChIP-Seq (MACS)</article-title>. <source>Genome Biol</source>. <year>2008</year>;<volume>9</volume><pub-id pub-id-type="doi">10.1186/gb-2008-9-9-r137</pub-id><?supplied-pmid 18798982?><pub-id pub-id-type="pmid">18798982</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Kelley</surname><given-names>DR</given-names></name>, <name><surname>Snoek</surname><given-names>J</given-names></name>, <name><surname>Rinn</surname><given-names>JL</given-names></name>, <name><surname>Phelan</surname><given-names>CM</given-names></name>, <name><surname>Kuchenbaecker</surname><given-names>KB</given-names></name>, <name><surname>Tyrer</surname><given-names>JP</given-names></name>, <etal>et al</etal><article-title>Basset: learning the regulatory code of the accessible genome with deep convolutional neural networks</article-title>. <source>Genome Res</source>. <year>2016</year>;<volume>26</volume>: <fpage>990</fpage>–<lpage>999</lpage>. <pub-id pub-id-type="doi">10.1101/gr.200535.115</pub-id><?supplied-pmid 27197224?><pub-id pub-id-type="pmid">27197224</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Davis</surname><given-names>J</given-names></name>, <name><surname>Goadrich</surname><given-names>M</given-names></name>. <article-title>The relationship between Precision-Recall and ROC curves</article-title>. <source>Proc ICML</source>. <year>2006</year> pp. <fpage>233</fpage>–<lpage>240</lpage>. <pub-id pub-id-type="doi">10.1145/1143844.1143874</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Szegedy</surname><given-names>C</given-names></name>, <name><surname>Liu</surname><given-names>W</given-names></name>, <name><surname>Jia</surname><given-names>Y</given-names></name>, <name><surname>Sermanet</surname><given-names>P</given-names></name>, <name><surname>Reed</surname><given-names>S</given-names></name>, <name><surname>Anguelov</surname><given-names>D</given-names></name>, <etal>et al</etal><article-title>Going deeper with convolutions</article-title>. <source>Proc IEEE Comput Soc Conf Comput Vis Pattern Recognit</source>. <year>2015</year>;<fpage>7</fpage>–<lpage>12</lpage>: 1–9. <pub-id pub-id-type="doi">10.1109/CVPR.2015.7298594</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Glover</surname><given-names>JNM</given-names></name>, <name><surname>Harrison</surname><given-names>SC</given-names></name>. <article-title>Crystal structure of the heterodimeric bZIP transcription factor c-Fos–c-Jun bound to DNA</article-title>. <source>Nature</source>. <year>1995</year> pp. <fpage>257</fpage>–<lpage>261</lpage>. <pub-id pub-id-type="doi">10.1038/373257a0</pub-id>
<?supplied-pmid 7816143?><pub-id pub-id-type="pmid">7816143</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Shimizu</surname><given-names>T</given-names></name>, <name><surname>Toumoto</surname><given-names>A</given-names></name>, <name><surname>Ihara</surname><given-names>K</given-names></name>, <name><surname>Shimizu</surname><given-names>M</given-names></name>, <name><surname>Kyogoku</surname><given-names>Y</given-names></name>, <name><surname>Ogawa</surname><given-names>N</given-names></name>, <etal>et al</etal><article-title>Crystal structure of PHO4 bHLH domain-DNA complex: Flanking base recognition</article-title>. <source>EMBO J</source>. <year>1997</year>;<volume>16</volume>: <fpage>4689</fpage>–<lpage>4697</lpage>. <pub-id pub-id-type="doi">10.1093/emboj/16.15.4689</pub-id><?supplied-pmid 9303313?><pub-id pub-id-type="pmid">9303313</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Singh</surname><given-names>S</given-names></name>, <name><surname>Yang</surname><given-names>Y</given-names></name>, <name><surname>Poczos</surname><given-names>B</given-names></name>, <name><surname>Ma</surname><given-names>J</given-names></name>. <article-title>Predicting enhancer-promoter interaction from genomic sequence with deep neural networks</article-title>. Preprint at <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/early/2016/11/02/085241">https://www.biorxiv.org/content/early/2016/11/02/085241</ext-link>. <source>bioRxiv</source>. <year>2016</year><pub-id pub-id-type="doi">10.1101/085241</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Min</surname><given-names>X</given-names></name>, <name><surname>Zeng</surname><given-names>W</given-names></name>, <name><surname>Chen</surname><given-names>S</given-names></name>, <name><surname>Chen</surname><given-names>N</given-names></name>, <name><surname>Chen</surname><given-names>T</given-names></name>, <name><surname>Jiang</surname><given-names>R</given-names></name>. <article-title>Predicting enhancers with deep convolutional neural networks</article-title>. <source>BMC Bioinformatics</source>. <year>2017</year>;<volume>18</volume><pub-id pub-id-type="doi">10.1186/s12859-017-1878-3</pub-id><?supplied-pmid 29219068?><pub-id pub-id-type="pmid">29219068</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Landt</surname><given-names>SG</given-names></name>, <name><surname>Marinov</surname><given-names>GK</given-names></name>, <name><surname>Kundaje</surname><given-names>A</given-names></name>, <name><surname>Kheradpour</surname><given-names>P</given-names></name>, <name><surname>Pauli</surname><given-names>F</given-names></name>, <name><surname>Batzoglou</surname><given-names>S</given-names></name>, <etal>et al</etal><article-title>ChIP-seq guidelines and practices of the ENCODE and modENCODE consortia</article-title>. <source>Genome Res</source>. <year>2012</year> pp. <fpage>1813</fpage>–<lpage>1831</lpage>. <pub-id pub-id-type="doi">10.1101/gr.136184.111</pub-id>
<?supplied-pmid 22955991?><pub-id pub-id-type="pmid">22955991</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Grant</surname><given-names>CE</given-names></name>, <name><surname>Bailey</surname><given-names>TL</given-names></name>, <name><surname>Noble</surname><given-names>WS</given-names></name>. <article-title>FIMO: Scanning for occurrences of a given motif</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>: <fpage>1017</fpage>–<lpage>1018</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btr064</pub-id><?supplied-pmid 21330290?><pub-id pub-id-type="pmid">21330290</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Simonyan</surname><given-names>K</given-names></name>, <name><surname>Vedaldi</surname><given-names>A</given-names></name>, <name><surname>Zisserman</surname><given-names>A</given-names></name>. <article-title>Deep inside convolutional networks: visualising image classification models and saliency maps</article-title>. Preprint at <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1312.6034">http://arxiv.org/abs/1312.6034</ext-link>. arXiv.org. <year>2013</year> Available: <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1312.6034">http://arxiv.org/abs/1312.6034</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Schmidt</surname><given-names>D</given-names></name>, <name><surname>Schwalie</surname><given-names>PC</given-names></name>, <name><surname>Wilson</surname><given-names>MD</given-names></name>, <name><surname>Ballester</surname><given-names>B</given-names></name>, <name><surname>Gonalves</surname><given-names>Â</given-names></name>, <name><surname>Kutter</surname><given-names>C</given-names></name>, <etal>et al</etal><article-title>Waves of retrotransposon expansion remodel genome organization and CTCF binding in multiple mammalian lineages</article-title>. <source>Cell</source>. <year>2012</year>;<volume>148</volume>: <fpage>335</fpage>–<lpage>348</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2011.11.058</pub-id><?supplied-pmid 22244452?><pub-id pub-id-type="pmid">22244452</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Erhan</surname><given-names>D</given-names></name>, <name><surname>Bengio</surname><given-names>Y</given-names></name>, <name><surname>Courville</surname><given-names>A</given-names></name>, <name><surname>Vincent</surname><given-names>P</given-names></name>. <article-title>Visualizing higher-layer features of a deep network.</article-title><source>Bernoulli</source>. <year>2009</year>; <fpage>1</fpage>–<lpage>13</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://igva2012.wikispaces.asu.edu/file/view/Erhan+2009+Visualizing+higher+layer+features+of+a+deep+network.pdf">http://igva2012.wikispaces.asu.edu/file/view/Erhan+2009+Visualizing+higher+layer+features+of+a+deep+network.pdf</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Yosinski</surname><given-names>J</given-names></name>, <name><surname>Clune</surname><given-names>J</given-names></name>, <name><surname>Nguyen</surname><given-names>A</given-names></name>, <name><surname>Fuchs</surname><given-names>T</given-names></name>, <name><surname>Lipson</surname><given-names>H</given-names></name>. <article-title>Understanding Neural Networks Through Deep Visualization</article-title>. Preprint at <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1506.06579">http://arxiv.org/abs/1506.06579</ext-link>. <year>2015</year> Available: <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1506.06579">http://arxiv.org/abs/1506.06579</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Gupta</surname><given-names>S</given-names></name>, <name><surname>Stamatoyannopoulos</surname><given-names>JA</given-names></name>, <name><surname>Bailey</surname><given-names>TL</given-names></name>, <name><surname>Noble</surname><given-names>WS</given-names></name>. <article-title>Quantifying similarity between motifs</article-title>. <source>Genome Biol</source>. <year>2007</year>;<volume>8</volume><pub-id pub-id-type="doi">10.1186/gb-2007-8-2-r24</pub-id><?supplied-pmid 17324271?><pub-id pub-id-type="pmid">17324271</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Takahashi</surname><given-names>K</given-names></name>, <name><surname>Yamanaka</surname><given-names>S</given-names></name>. <article-title>Induction of pluripotent stem cells from mouse embryonic and adult fibroblast cultures by defined factors</article-title>. <source>Cell</source>. <year>2006</year>;<volume>126</volume>: <fpage>663</fpage>–<lpage>676</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2006.07.024</pub-id><?supplied-pmid 16904174?><pub-id pub-id-type="pmid">16904174</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Ong</surname><given-names>CT</given-names></name>, <name><surname>Corces</surname><given-names>VG</given-names></name>. <article-title>CTCF: An architectural protein bridging genome topology and function</article-title>. <source>Nat. Rev. Genet</source>. <year>2014</year> pp. <fpage>234</fpage>–<lpage>246</lpage>. <pub-id pub-id-type="doi">10.1038/nrg3663</pub-id>
<?supplied-pmid 24614316?><pub-id pub-id-type="pmid">24614316</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Schuster</surname><given-names>M</given-names></name>, <name><surname>Paliwal</surname><given-names>KK</given-names></name>. <article-title>Bidirectional recurrent neural networks</article-title>. <source>IEEE Trans Signal Process</source>. <year>1997</year>;<volume>45</volume>: <fpage>2673</fpage>–<lpage>2681</lpage>. <pub-id pub-id-type="doi">10.1109/78.650093</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Shrikumar</surname><given-names>A</given-names></name>, <name><surname>Greenside</surname><given-names>P</given-names></name>, <name><surname>Kundaje</surname><given-names>A</given-names></name>, <name><surname>Science</surname><given-names>C</given-names></name>. <article-title>Reverse-complement parameter sharing improves deep learning models for genomics</article-title>. Preprint at <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/early/2017/01/27/103663">https://www.biorxiv.org/content/early/2017/01/27/103663</ext-link>. <source>bioRxiv</source>. <year>2017</year><pub-id pub-id-type="doi">10.1101/103812</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Quinlan</surname><given-names>AR</given-names></name>, <name><surname>Hall</surname><given-names>IM</given-names></name>. <article-title>BEDTools: A flexible suite of utilities for comparing genomic features</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>: <fpage>841</fpage>–<lpage>842</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btq033</pub-id><?supplied-pmid 20110278?><pub-id pub-id-type="pmid">20110278</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Hochreiter</surname><given-names>S</given-names></name>, <name><surname>Schmidhuber</surname><given-names>J</given-names></name>. <article-title>Long Short-Term Memory</article-title>. <source>Neural Comput</source>. <year>1997</year>;<volume>9</volume>: <fpage>1735</fpage>–<lpage>1780</lpage>. <pub-id pub-id-type="doi">10.1162/neco.1997.9.8.1735</pub-id><?supplied-pmid 9377276?><pub-id pub-id-type="pmid">9377276</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Hinton</surname><given-names>GE</given-names></name>, <name><surname>Srivastava</surname><given-names>N</given-names></name>, <name><surname>Swersky</surname><given-names>K</given-names></name>. <article-title>Lecture 6e- rmsprop: Divide the gradient by a running average of its recent magnitude</article-title>. <source>COURSERA Neural Networks Mach Learn</source>. <year>2012</year>; <fpage>26</fpage>–<lpage>31</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="https://goo.gl/RsQeis">https://goo.gl/RsQeis</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Kingma</surname><given-names>DP</given-names></name>, <name><surname>Ba</surname><given-names>JL</given-names></name>. <article-title>Adam: a Method for Stochastic Optimization</article-title>. <source>Int Conf Learn Represent 2015</source>. <year>2015</year>; <fpage>1</fpage>–<lpage>15</lpage>. <ext-link ext-link-type="uri" xlink:href="http://doi.acm.org.ezproxy.lib.ucf.edu/10.1145/1830483.1830503">http://doi.acm.org.ezproxy.lib.ucf.edu/10.1145/1830483.1830503</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Robinson</surname><given-names>JT</given-names></name>, <name><surname>Thorvaldsdóttir</surname><given-names>H</given-names></name>, <name><surname>Winckler</surname><given-names>W</given-names></name>, <name><surname>Guttman</surname><given-names>M</given-names></name>, <name><surname>Lander</surname><given-names>ES</given-names></name>, <name><surname>Getz</surname><given-names>G</given-names></name>, <etal>et al</etal><article-title>Integrative genomics viewer</article-title>. <source>Nat. Biotechnol</source>. <year>2011</year> pp. <fpage>24</fpage>–<lpage>26</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.1754</pub-id>
<?supplied-pmid 21221095?><pub-id pub-id-type="pmid">21221095</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0235748.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Ramírez</surname><given-names>F</given-names></name>, <name><surname>Ryan</surname><given-names>DP</given-names></name>, <name><surname>Grüning</surname><given-names>B</given-names></name>, <name><surname>Bhardwaj</surname><given-names>V</given-names></name>, <name><surname>Kilpert</surname><given-names>F</given-names></name>, <name><surname>Richter</surname><given-names>AS</given-names></name>, <etal>et al</etal><article-title>deepTools2: a next generation web server for deep-sequencing data analysis</article-title>. <source>Nucleic Acids Res</source>. <year>2016</year>;<volume>44</volume>: <fpage>W160</fpage>–<lpage>W165</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkw257</pub-id><?supplied-pmid 27079975?><pub-id pub-id-type="pmid">27079975</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="pone.0235748.r001" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0235748.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Peng</surname>
          <given-names>Jiajie</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Jiajie Peng</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Jiajie Peng</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj001" ext-link-type="doi" xlink:href="10.1371/journal.pone.0235748" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">16 Mar 2020</named-content>
    </p>
    <p>PONE-D-19-33090</p>
    <p>Predicting gene regulatory regions with a convolutional neural network for processing double-strand genome sequence information</p>
    <p>PLOS ONE</p>
    <p>Dear Onimaru,</p>
    <p>Thank you for submitting your manuscript to PLOS ONE. After careful consideration, we feel that it has merit but does not fully meet PLOS ONE’s publication criteria as it currently stands. Therefore, we invite you to submit a revised version of the manuscript that addresses the points raised during the review process.</p>
    <p>We would appreciate receiving your revised manuscript by Apr 30 2020 11:59PM. When you are ready to submit your revision, log on to <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pone/">https://www.editorialmanager.com/pone/</ext-link> and select the 'Submissions Needing Revision' folder to locate your manuscript file.</p>
    <p>If you would like to make changes to your financial disclosure, please include your updated statement in your cover letter.</p>
    <p>To enhance the reproducibility of your results, we recommend that if applicable you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see: <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols">http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols</ext-link></p>
    <p>Please include the following items when submitting your revised manuscript:</p>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>A rebuttal letter that responds to each point raised by the academic editor and reviewer(s). This letter should be uploaded as separate file and labeled 'Response to Reviewers'.</p>
        </list-item>
        <list-item>
          <p>A marked-up copy of your manuscript that highlights changes made to the original version. This file should be uploaded as separate file and labeled 'Revised Manuscript with Track Changes'.</p>
        </list-item>
        <list-item>
          <p>An unmarked version of your revised paper without tracked changes. This file should be uploaded as separate file and labeled 'Manuscript'.</p>
        </list-item>
      </list>
    </p>
    <p>Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>We look forward to receiving your revised manuscript.</p>
    <p>Kind regards,</p>
    <p>Jiajie Peng</p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
    <p>Journal Requirements:</p>
    <p>When submitting your revision, we need you to address these additional requirements:</p>
    <p>1. Please ensure that your manuscript meets PLOS ONE's style requirements, including those for file naming. The PLOS ONE style templates can be found at <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/attachments/PLOSOne_formatting_sample_main_body.pdf">http://www.plosone.org/attachments/PLOSOne_formatting_sample_main_body.pdf</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/attachments/PLOSOne_formatting_sample_title_authors_affiliations.pdf">http://www.plosone.org/attachments/PLOSOne_formatting_sample_title_authors_affiliations.pdf</ext-link></p>
    <p>2. Please include captions for your Supporting Information files at the end of your manuscript, and update any in-text citations to match accordingly. Please see our Supporting Information guidelines for more information: <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosone/s/supporting-information">http://journals.plos.org/plosone/s/supporting-information</ext-link>.</p>
    <p>[Note: HTML markup is below. Please do not edit.]</p>
    <p>Reviewers' comments:</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Author</bold>
    </p>
    <p>1. Is the manuscript technically sound, and do the data support the conclusions?</p>
    <p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. </p>
    <p>Reviewer #1: Partly</p>
    <p>**********</p>
    <p>2. Has the statistical analysis been performed appropriately and rigorously? </p>
    <p>Reviewer #1: No</p>
    <p>**********</p>
    <p>3. Have the authors made all data underlying the findings in their manuscript fully available?</p>
    <p>The <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/static/policies.action#sharing">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data—e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>**********</p>
    <p>4. Is the manuscript presented in an intelligible fashion and written in standard English?</p>
    <p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.</p>
    <p>Reviewer #1: No</p>
    <p>**********</p>
    <p>5. Review Comments to the Author</p>
    <p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)</p>
    <p>Reviewer #1: Annotating biological functions in genome sequences without experiments is still a challenging task. In this manuscript, a deep-learning-based method was proposed to predict gene regulatory regions efficiently.</p>
    <p>I have the following major concerns.</p>
    <p>Fig 1 is blurry.</p>
    <p>Line 71, page 4, references are missing for DeepSEA and Basset.</p>
    <p>Line 274, page 16, what are the meanings of labels “0” and “1”?</p>
    <p>Line 293, page 17, more explanations are needed for the rotated kernel. Some examples of the kernel may help understand this concept.</p>
    <p>Line 298, page 17, what is the max pooling size?</p>
    <p>Line 263, page 15, “Data with &lt; 10,000 peaks were excluded from training data.” Why is that?</p>
    <p>Line 264, page 15, “peak files were downloaded from <ext-link ext-link-type="uri" xlink:href="http://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/.”">http://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/.”</ext-link> Are these peak files matching with hg38? What about the peak files for mouse genomes?</p>
    <p>Line 313, page 18, “λ1 = 5×10–7, and λ2 = 1×10–8” More explanations are needed for setting these two parameters.</p>
    <p>Line 346, page 19, what is the formula for Si(X0)?</p>
    <p>**********</p>
    <p>6. PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>[NOTE: If reviewer comments were submitted as an attachment file, they will be attached to this email and accessible via the submission site. Please log into your account, locate the manuscript record, and check for the action link "View Attachments". If this link does not appear, there are no attachment files to be viewed.]</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/">https://pacev2.apexcovantage.com/</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Registration is free. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>. Please note that Supporting Information files do not need this step.</p>
  </body>
</sub-article>
<sub-article id="pone.0235748.r002" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0235748.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article id="rel-obj002" ext-link-type="doi" xlink:href="10.1371/journal.pone.0235748" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">3 Apr 2020</named-content>
    </p>
    <p>We thank the reviewer for his/her valuable comments. Indeed, we agree that the points raised were unclear, and we have therefore used this input to make improvements to the manuscript. </p>
    <p>Reviewers' comments:</p>
    <p>Reviewer's Responses to Questions</p>
    <p>Comments to the Author</p>
    <p>======Comments======</p>
    <p>Reviewer #1: Annotating biological functions in genome sequences without experiments is still a challenging task. In this manuscript, a deep-learning-based method was proposed to predict gene regulatory regions efficiently.</p>
    <p>I have the following major concerns.</p>
    <p>Fig 1 is blurry.</p>
    <p>=======Response======</p>
    <p>We apologize for the problem. Because all figures were created with a same resolution, we have no idea what went wrong with Figure 1. At least, the resolution of Figures in the submitted manuscript was fine on my computer. We have double-checked the resolution of all figures. As the next submission will contain the figures as individual tiff files, the resolution will probably be better than the first submission.</p>
    <p>======Comments======</p>
    <p>Line 71, page 4, references are missing for DeepSEA and Basset.</p>
    <p>=======Response======</p>
    <p>We have added references.</p>
    <p>======Comments======</p>
    <p>Line 274, page 16, what are the meanings of labels “0” and “1”?</p>
    <p>=======Response======</p>
    <p>We agree that the explanation for generating training data was not clear enough. We assigned each window as 1 if an input sequence overlapped a signal positive region or 0 otherwise. We have improved the explanation for generating the training data (lines 287–298).</p>
    <p>======Comments======</p>
    <p>Line 293, page 17, more explanations are needed for the rotated kernel. Some examples of the kernel may help understand this concept.</p>
    <p>=======Response======</p>
    <p>We agree that we should have make the explanation for the rotated kernel easier to understand because this is the key concept of this paper. There was a visual explanation for this rotation in Figure 1C. Now, we have modified Figure 1C to be more consistent with the mathematical notation and cited Figure 1C in the sentence (Figure 1C and line 323). </p>
    <p>======Comments======</p>
    <p>Line 298, page 17, what is the max pooling size?</p>
    <p>=======Response======</p>
    <p>We have added the size of the max pooling (line 328). </p>
    <p>======Comments======</p>
    <p>Line 263, page 15, “Data with &lt; 10,000 peaks were excluded from training data.” Why is that?</p>
    <p>=======Response======</p>
    <p>We apologize for the poor explanation. First of all, one thing that we did not mention here was that this filtering was applied only for DNase-seq data. We filtered out DNase-seq data with a few peaks because they usually showed a poor quality and disrupted the training. We have added this explanation in lines 278–279.</p>
    <p>======Comments======</p>
    <p>Line 264, page 15, “peak files were downloaded from <ext-link ext-link-type="uri" xlink:href="http://hgdownload.cse.ucsc.”">http://hgdownload.cse.ucsc.”</ext-link> Are these peak files matching with hg38? What about the peak files for mouse genomes?</p>
    <p>=======Response======</p>
    <p>We agree that the explanation for generating training data was not clear enough. The reference of the peak files downloaded from the UCSC is hg19. These data are used for comparing the performance of conv4-frss, DeepSEA and DanQ, because DeepSEA and DanQ used these downloaded peaks for training (DeepSEA, DandQ and conv4-FRSS in Figure 2A and B). Separately, to utilize newly added data by the ENCODE project, which uses the mm10 and hg38 genomes, we created our own training datasets for other analyses such as Table 1 and “hg38” and “mm10” in Figure 2A and B). We have modified the manuscript to make that clear (lines 281–282 and lines 298–301).</p>
    <p>======Comments======</p>
    <p>Line 313, page 18, “λ1 = 5×10–7, and λ2 = 1×10–8” More explanations are needed for setting these two parameters.</p>
    <p>=======Response======</p>
    <p>These two parameters are set according to a previous paper (Zhou et al 2015). We have added this explanation to the manuscript (line 348).</p>
    <p>======Comments======</p>
    <p>Line 346, page 19, what is the formula for Si(X0)?</p>
    <p>=======Response======</p>
    <p>The formula for Si(X0) is too complex to write here, because it is composed of all operations including FRSS, convolution and fully-connected layers. We have added this explanation to the manuscript (lines 386–388).</p>
    <supplementary-material content-type="local-data" id="pone.0235748.s016">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">K_Onimaru_rebuttal_letter.docx</named-content></p>
      </caption>
      <media xlink:href="pone.0235748.s016.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pone.0235748.r003" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0235748.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Makarenkov</surname>
          <given-names>Vladimir</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Vladimir Makarenkov</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Vladimir Makarenkov</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj003" ext-link-type="doi" xlink:href="10.1371/journal.pone.0235748" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">23 Jun 2020</named-content>
    </p>
    <p>Predicting gene regulatory regions with a convolutional neural network for processing double-strand genome sequence information</p>
    <p>PONE-D-19-33090R1</p>
    <p>Dear Dr. Onimaru,</p>
    <p>We’re pleased to inform you that your manuscript has been judged scientifically suitable for publication and will be formally accepted for publication once it meets all outstanding technical requirements.</p>
    <p>Within one week, you’ll receive an e-mail detailing the required amendments. When these have been addressed, you’ll receive a formal acceptance letter and your manuscript will be scheduled for publication.</p>
    <p>An invoice for payment will follow shortly after the formal acceptance. To ensure an efficient process, please log into Editorial Manager at <ext-link ext-link-type="uri" xlink:href="http://www.editorialmanager.com/pone/">http://www.editorialmanager.com/pone/</ext-link>, click the 'Update My Information' link at the top of the page, and double check that your user information is up-to-date. If you have any billing related questions, please contact our Author Billing department directly at <email>authorbilling@plos.org</email>.</p>
    <p>If your institution or institutions have a press office, please notify them about your upcoming paper to help maximize its impact. If they’ll be preparing press materials, please inform our press team as soon as possible -- no later than 48 hours after receiving the formal acceptance. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information, please contact <email>onepress@plos.org</email>.</p>
    <p>Kind regards,</p>
    <p>Vladimir Makarenkov</p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
    <p>Additional Editor Comments (optional):</p>
    <p>Reviewers' comments:</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Author</bold>
    </p>
    <p>1. If the authors have adequately addressed your comments raised in a previous round of review and you feel that this manuscript is now acceptable for publication, you may indicate that here to bypass the “Comments to the Author” section, enter your conflict of interest statement in the “Confidential to Editor” section, and submit your "Accept" recommendation.</p>
    <p>Reviewer #1: All comments have been addressed</p>
    <p>Reviewer #2: All comments have been addressed</p>
    <p>**********</p>
    <p>2. Is the manuscript technically sound, and do the data support the conclusions?</p>
    <p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. </p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Partly</p>
    <p>**********</p>
    <p>3. Has the statistical analysis been performed appropriately and rigorously? </p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: N/A</p>
    <p>**********</p>
    <p>4. Have the authors made all data underlying the findings in their manuscript fully available?</p>
    <p>The <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/static/policies.action#sharing">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data—e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>5. Is the manuscript presented in an intelligible fashion and written in standard English?</p>
    <p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>6. Review Comments to the Author</p>
    <p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)</p>
    <p>Reviewer #1: (No Response)</p>
    <p>Reviewer #2: The authors have carefully addressed given comments raised in the previous round of review by other reviewers. Hence, I think this version can be accepted in this round as is.</p>
    <p>**********</p>
    <p>7. PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
  </body>
</sub-article>
<sub-article id="pone.0235748.r004" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0235748.r004</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Makarenkov</surname>
          <given-names>Vladimir</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Vladimir Makarenkov</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Vladimir Makarenkov</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj004" ext-link-type="doi" xlink:href="10.1371/journal.pone.0235748" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">1 Jul 2020</named-content>
    </p>
    <p>PONE-D-19-33090R1 </p>
    <p>Predicting gene regulatory regions with a convolutional neural network for processing double-strand genome sequence information </p>
    <p>Dear Dr. Onimaru:</p>
    <p>I'm pleased to inform you that your manuscript has been deemed suitable for publication in PLOS ONE. Congratulations! Your manuscript is now with our production department. </p>
    <p>If your institution or institutions have a press office, please let them know about your upcoming paper now to help maximize its impact. If they'll be preparing press materials, please inform our press team within the next 48 hours. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information please contact <email>onepress@plos.org</email>.</p>
    <p>If we can help with anything else, please email us at <email>plosone@plos.org</email>. </p>
    <p>Thank you for submitting your work to PLOS ONE and supporting open access. </p>
    <p>Kind regards, </p>
    <p>PLOS ONE Editorial Office Staff</p>
    <p>on behalf of</p>
    <p>Dr. Vladimir Makarenkov </p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
  </body>
</sub-article>
