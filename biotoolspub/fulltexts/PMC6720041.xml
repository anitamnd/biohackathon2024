<?properties open_access?>
<?subarticle report55093?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">F1000Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">F1000Res</journal-id>
    <journal-id journal-id-type="pmc">F1000Research</journal-id>
    <journal-title-group>
      <journal-title>F1000Research</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2046-1402</issn>
    <publisher>
      <publisher-name>F1000 Research Limited</publisher-name>
      <publisher-loc>London, UK</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6720041</article-id>
    <article-id pub-id-type="doi">10.12688/f1000research.18490.3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group>
        <subject>Articles</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Evaluation of methods to assign cell type labels to cell clusters from single-cell RNA-sequencing data</article-title>
      <fn-group content-type="pub-status">
        <fn>
          <p>[version 3; peer review: 2 approved</p>
        </fn>
      </fn-group>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Diaz-Mejia</surname>
          <given-names>J. Javier</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data Curation</role>
        <role content-type="http://credit.casrai.org/">Formal Analysis</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – Original Draft Preparation</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-2475-3077</contrib-id>
        <xref ref-type="corresp" rid="c1">a</xref>
        <xref ref-type="aff" rid="a1">1</xref>
        <xref ref-type="aff" rid="a2">2</xref>
        <xref ref-type="aff" rid="a3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Meng</surname>
          <given-names>Elaine C.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data Curation</role>
        <role content-type="http://credit.casrai.org/">Writing – Original Draft Preparation</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <xref ref-type="aff" rid="a3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pico</surname>
          <given-names>Alexander R.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-5706-2163</contrib-id>
        <xref ref-type="aff" rid="a4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>MacParland</surname>
          <given-names>Sonya A.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data Curation</role>
        <role content-type="http://credit.casrai.org/">Writing – Original Draft Preparation</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-8036-1425</contrib-id>
        <xref ref-type="aff" rid="a5">5</xref>
        <xref ref-type="aff" rid="a6">6</xref>
        <xref ref-type="aff" rid="a7">7</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ketela</surname>
          <given-names>Troy</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Writing – Original Draft Preparation</role>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pugh</surname>
          <given-names>Trevor J.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Writing – Original Draft Preparation</role>
        <xref ref-type="aff" rid="a1">1</xref>
        <xref ref-type="aff" rid="a8">8</xref>
        <xref ref-type="aff" rid="a9">9</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bader</surname>
          <given-names>Gary D.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – Original Draft Preparation</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-0185-8861</contrib-id>
        <xref ref-type="aff" rid="a2">2</xref>
        <xref ref-type="aff" rid="a10">10</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Morris</surname>
          <given-names>John H.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – Original Draft Preparation</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-0290-7979</contrib-id>
        <xref ref-type="corresp" rid="c2">b</xref>
        <xref ref-type="aff" rid="a3">3</xref>
      </contrib>
      <aff id="a1"><label>1</label>Princess Margaret Cancer Centre, University Health Network, Toronto, ON, M5G 2M9, Canada</aff>
      <aff id="a2"><label>2</label>The Donnelly Centre, University of Toronto, Toronto, ON, M5S 3E1, Canada</aff>
      <aff id="a3"><label>3</label>Department of Pharmaceutical Chemistry, University of California San Francisco, San Francisco, CA, 94143, USA</aff>
      <aff id="a4"><label>4</label>Gladstone Institutes, San Francisco, CA, 94158, USA</aff>
      <aff id="a5"><label>5</label>Multi-Organ Transplant Program, Toronto General Hospital Research Institute, Toronto, ON, M5G 2C4, Canada</aff>
      <aff id="a6"><label>6</label>Department of Immunology, University of Toronto, Toronto, ON, M5S 1A8, Canada</aff>
      <aff id="a7"><label>7</label>Department of Laboratory Medicine and Pathobiology, University of Toronto, Toronto, ON, M5G 1L7, Canada</aff>
      <aff id="a8"><label>8</label>Department of Medical Biophysics, University of Toronto, Toronto, ON, M5G 1L7, Canada</aff>
      <aff id="a9"><label>9</label>Ontario Institute for Cancer Research, Toronto, ON, M5G 0A3, Canada</aff>
      <aff id="a10"><label>10</label>Department of Molecular Genetics, University of Toronto, Toronto, ON, M5G 1A8, Canada</aff>
    </contrib-group>
    <author-notes>
      <corresp id="c1">
        <label>a</label>
        <email xlink:href="mailto:javier.diazmejia@gmail.com">javier.diazmejia@gmail.com</email>
      </corresp>
      <corresp id="c2">
        <label>b</label>
        <email xlink:href="mailto:scooter@cgl.ucsf.edu">scooter@cgl.ucsf.edu</email>
      </corresp>
      <fn fn-type="COI-statement">
        <p>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>8</volume>
    <elocation-id>ISCB Comm J-296</elocation-id>
    <history>
      <date date-type="accepted">
        <day>9</day>
        <month>10</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright: © 2019 Diaz-Mejia JJ et al.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="f1000research-8-22823.pdf"/>
    <abstract>
      <p><bold>Background:</bold> Identification of cell type subpopulations from complex cell mixtures using single-cell RNA-sequencing (scRNA-seq) data includes automated steps from normalization to cell clustering. However, assigning cell type labels to cell clusters is often conducted manually, resulting in limited documentation, low reproducibility and uncontrolled vocabularies. This is partially due to the scarcity of reference cell type signatures and because some methods support limited cell type signatures.</p>
      <p><bold>Methods:</bold> In this study, we benchmarked five methods representing first-generation enrichment analysis (ORA), second-generation approaches (GSEA and GSVA), machine learning tools (CIBERSORT) and network-based neighbor voting (METANEIGHBOR), for the task of assigning cell type labels to cell clusters from scRNA-seq data. We used five scRNA-seq datasets: human liver, 11 Tabula Muris mouse tissues, two human peripheral blood mononuclear cell datasets, and mouse retinal neurons, for which reference cell type signatures were available. The datasets span Drop-seq, 10X Chromium and Seq-Well technologies and range in size from ~3,700 to ~68,000 cells.</p>
      <p><bold>Results:</bold> Our results show that, in general, all five methods perform well in the task as evaluated by receiver operating characteristic curve analysis (average area under the curve (AUC) = 0.91, sd = 0.06), whereas precision-recall analyses show a wide variation depending on the method and dataset (average AUC = 0.53, sd = 0.24). We observed an influence of the number of genes in cell type signatures on performance, with smaller signatures leading more frequently to incorrect results.</p>
      <p><bold>Conclusions:</bold> GSVA was the overall top performer and was more robust in cell type signature subsampling simulations, although different methods performed well using different datasets. METANEIGHBOR and GSVA were the fastest methods. CIBERSORT and METANEIGHBOR were more influenced than the other methods by analyses including only expected cell types. We provide an extensible framework that can be used to evaluate other methods and datasets at
<underline><ext-link ext-link-type="uri" xlink:href="https://protect-eu.mimecast.com/s/jrmnCyQ6I46EBtMSFG4">https://github.com/jdime/scRNAseq_cell_cluster_labeling</ext-link></underline>.</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>single cell</kwd>
      <kwd>RNA-seq</kwd>
      <kwd>scRNA-seq</kwd>
      <kwd>bioinformatics</kwd>
      <kwd>benchmark</kwd>
      <kwd>evaluation</kwd>
      <kwd>labeling</kwd>
      <kwd>cell type</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="fund-1">
        <funding-source>National Resource for Network Biology</funding-source>
        <award-id>P41GM103504</award-id>
      </award-group>
      <award-group id="fund-2">
        <funding-source>Chan Zuckerberg Initiative</funding-source>
        <award-id>2018-183120</award-id>
      </award-group>
      <funding-statement>JJDM, ECM, ARP, and JHM are funded by grant number 2018-183120 from the Chan Zuckerberg Initiative DAF, an advised fund of the Silicon Valley Community Foundation. ARP, GDB and JHM are supported by the National Resource for Network Biology, P41GM103504 (NIGMS).This work was funded by the Government of Canada through Genome Canada and the Ontario Genomics Institute (OGI-167) via a grant to JJDM and TJP. </funding-statement>
      <funding-statement>
        <italic>The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</italic>
      </funding-statement>
    </funding-group>
  </article-meta>
  <notes notes-type="version-changes">
    <sec sec-type="version-changes">
      <label>Revised</label>
      <title>Amendments from Version 2</title>
      <p>We've addressed the question of Reviewer #1 in the Open Peer Review section and explained why
<italic>k</italic>-fold cross-validations can’t be applied to cell cluster level evaluations like those we conducted in this study.</p>
    </sec>
  </notes>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>During the last five years a number of single-cell sequencing technologies have been developed to identify cell subpopulations from complex cell mixtures (
<xref rid="ref-4" ref-type="bibr">Bakken
<italic>et al</italic>., 2017</xref>). For instance, recent advances in single-cell RNA-sequencing (scRNA-seq) enable the simultaneous measurement of expression levels of thousands of genes across thousands of individual cells. The resulting expression matrices of genes by cells are used to identify cell subpopulations with characteristic gene expression profiles (i.e. cell types).</p>
    <p>A typical computational pipeline to process scRNA-seq data involves: i) quality control of sequencing reads, ii) mapping reads against a reference transcriptome, iii) normalization of mapped reads to correct batch effects and remove contaminants, iv) data dimensionality reduction with principal component analysis or other approaches, v) clustering of cells using the reduced dimensionality representation, vi) detection of genes differentially expressed between clusters, vii) visualization of cell clusters in t-SNE or similar methods, and viii) assignment of cell type labels to cell clusters. A number of computational tools, including Cell Ranger (
<xref rid="ref-23" ref-type="bibr">Zheng
<italic>et al</italic>., 2017a</xref>) and Seurat (
<xref rid="ref-6" ref-type="bibr">Butler
<italic>et al</italic>., 2018</xref>), support automation of steps i to vii (
<xref rid="ref-10" ref-type="bibr">Duò
<italic>et al</italic>., 2018</xref>;
<xref rid="ref-12" ref-type="bibr">Freytag
<italic>et al</italic>., 2018</xref>;
<xref rid="ref-15" ref-type="bibr">Innes &amp; Bader, 2019</xref>). However, assignment of cell type labels to cell clusters is still conducted manually by most researchers. The typical procedure involves manual inspection of the genes expressed in a cluster, combined with a detailed literature search to identify if any of those genes are known gene expression markers for cell types of interest. This manual approach has several caveats, including limited documentation and low reproducibility of cell type gene marker selection, use of uncontrolled and non-standard vocabularies for cell type labels, and it is time-consuming. For these reasons, computational tools that enable researchers to systematically, reproducibly and quickly assign cell type labels to cell clusters derived from scRNA-seq experiments are needed.</p>
    <p>In this study we analysed each of five scRNA-seq datasets with five computational methods that can be used to assign cell type labels to cell clusters based on known gene expression marker lists. The datasets include human liver cells (
<xref rid="ref-16" ref-type="bibr">MacParland
<italic>et al</italic>., 2018</xref>); mouse retinal neurons (
<xref rid="ref-21" ref-type="bibr">Shekhar
<italic>et al</italic>., 2016b</xref>); the Tabula Muris mouse cell atlas data (
<xref rid="ref-31" ref-type="bibr">Tabula Muris Consortium
<italic>et al</italic>., 2018a</xref>), which encompasses 20 tissues of which we used 11 for which cell type signatures were available (
<xref rid="ref-32" ref-type="bibr">Tabula Muris Consortium, 2018b</xref>); and human peripheral blood mononuclear cells (PBMCs) mapped using two technologies: 10X Chromium (
<xref rid="ref-23" ref-type="bibr">Zheng
<italic>et al</italic>., 2017a</xref>) and Seq-Well (
<xref rid="ref-27" ref-type="bibr">Gierahn
<italic>et al</italic>., 2017a</xref>) (
<xref rid="T1" ref-type="table">Table 1</xref>). We chose these five datasets primarily because they provided expert curated known cell type marker gene lists and cell cluster annotations that we could use as gold standards. The five methods analysed were: CIBERSORT (
<xref rid="ref-18" ref-type="bibr">Newman
<italic>et al</italic>., 2015b</xref>), GSEA (
<xref rid="ref-22" ref-type="bibr">Subramanian
<italic>et al</italic>., 2005</xref>), GSVA (
<xref rid="ref-14" ref-type="bibr">Hänzelmann
<italic>et al</italic>., 2013</xref>), METANEIGHBOR (
<xref rid="ref-7" ref-type="bibr">Crow
<italic>et al</italic>., 2018</xref>) and ORA (
<xref rid="ref-11" ref-type="bibr">Fisher, 1935</xref>;
<xref rid="ref-13" ref-type="bibr">Goeman &amp; Bühlmann, 2007</xref>) (
<xref rid="T2" ref-type="table">Table 2</xref>). We chose these five methods to represent different categories of algorithms, ranging from first-generation enrichment analysis (ORA) to second-generation approaches (GSEA and GSVA), machine learning tools (CIBERSORT) and network-based neighbor voting approaches (METANEIGHBOR). Although ORA and GSEA were not originally developed to process RNA-seq data, they have been extensively used in transcriptomic studies for gene set enrichment analyses. GSVA was developed to analyse microarray and bulk RNA-seq data. CIBERSORT was developed to estimate abundances of cell types in mixed cell populations from bulk RNA-seq data, and METANEIGHBOR was developed to characterize replicability of scRNA-seq samples. We adapted all five methods to assign cell type labels to cell clusters from scRNA-seq data based on known sets of cell type marker genes. We evaluated these methods using two types of inputs: a matrix with the average expression of each gene
<italic>x</italic> from all the cells in each cell cluster
<italic>y</italic> (
<italic>Ě
<sub>xy</sub></italic>) from scRNA-seq measurements, which we assume corresponds to the profile of a cell type or state (
<xref ref-type="fig" rid="f1">Figure 1A</xref>), and known cell type signatures, represented as gene sets (
<xref ref-type="fig" rid="f1">Figure 1B</xref>) or continuous gene expression profiles (
<xref ref-type="fig" rid="f1">Figure 1C</xref>).</p>
    <table-wrap id="T1" orientation="portrait" position="anchor">
      <label>Table 1. </label>
      <caption>
        <title>scRNA-seq datasets used in this study.</title>
      </caption>
      <table frame="hsides" rules="groups" content-type="article-table">
        <thead>
          <tr>
            <th align="left" valign="top" rowspan="1" colspan="1">Dataset
<break/>Name</th>
            <th align="left" valign="top" rowspan="1" colspan="1">Description of scRNA-seq
<break/>dataset</th>
            <th align="left" valign="top" rowspan="1" colspan="1">Number of
<break/>genes in
<break/>
<italic>Ě
<sub>xy</sub></italic>
</th>
            <th align="left" valign="top" rowspan="1" colspan="1">Number
<break/>of cells</th>
            <th align="left" valign="top" rowspan="1" colspan="1">Number
<break/>of
<break/>cell
<break/>clusters</th>
            <th align="left" valign="top" rowspan="1" colspan="1">Number of
<break/>cell
<break/>type
<break/>signatures</th>
            <th align="left" valign="top" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left" valign="top" rowspan="1" colspan="1">Liver</td>
            <td align="left" valign="top" rowspan="1" colspan="1">10X Chromium sample from liver
<break/>cells from five human donors</td>
            <td align="left" valign="top" rowspan="1" colspan="1">20,007</td>
            <td align="left" valign="top" rowspan="1" colspan="1">8,444</td>
            <td align="left" valign="top" rowspan="1" colspan="1">20</td>
            <td align="left" valign="top" rowspan="1" colspan="1">10</td>
            <td align="left" valign="top" rowspan="1" colspan="1">(
<xref rid="ref-16" ref-type="bibr">MacParland
<italic>et al</italic>., 2018</xref>)</td>
          </tr>
          <tr>
            <td align="left" valign="top" rowspan="1" colspan="1">Retinal neurons</td>
            <td align="left" valign="top" rowspan="1" colspan="1">Drop-seq sample from retinal bipolar
<break/>neurons from healthy mice</td>
            <td align="left" valign="top" rowspan="1" colspan="1">13,166</td>
            <td align="left" valign="top" rowspan="1" colspan="1">27,499</td>
            <td align="left" valign="top" rowspan="1" colspan="1">18</td>
            <td align="left" valign="top" rowspan="1" colspan="1">15</td>
            <td align="left" valign="top" rowspan="1" colspan="1">(
<xref rid="ref-21" ref-type="bibr">Shekhar
<italic>et al</italic>., 2016b</xref>)</td>
          </tr>
          <tr>
            <td align="left" valign="top" rowspan="1" colspan="1">Tabula Muris</td>
            <td align="left" valign="top" rowspan="1" colspan="1">10X Chromium samples from 11 out
<break/>of 20 mouse tissues with cell type
<break/>signatures, or 6 out of those 11, with
<break/>signatures for three or more cell types</td>
            <td align="left" valign="top" rowspan="1" colspan="1">18,300</td>
            <td align="left" valign="top" rowspan="1" colspan="1">55,505</td>
            <td align="left" valign="top" rowspan="1" colspan="1">130</td>
            <td align="left" valign="top" rowspan="1" colspan="1">53</td>
            <td align="left" valign="top" rowspan="1" colspan="1">(
<xref rid="ref-31" ref-type="bibr">Tabula Muris Consortium
<italic>et al</italic>., 2018a</xref>)</td>
          </tr>
          <tr>
            <td align="left" valign="top" rowspan="1" colspan="1">PBMCs-10X</td>
            <td align="left" valign="top" rowspan="1" colspan="1">10X Chromium sample from
<break/>peripheral blood mononuclear
<break/>cells from a human donor</td>
            <td align="left" valign="top" rowspan="1" colspan="1">17,786</td>
            <td align="left" valign="top" rowspan="1" colspan="1">68,579</td>
            <td align="left" valign="top" rowspan="1" colspan="1">7</td>
            <td align="left" valign="top" rowspan="1" colspan="1">22 or 6</td>
            <td align="left" valign="top" rowspan="1" colspan="1">(
<xref rid="ref-23" ref-type="bibr">Zheng
<italic>et al</italic>., 2017a</xref>)</td>
          </tr>
          <tr>
            <td align="left" valign="top" rowspan="1" colspan="1">PBMCs-SeqWell</td>
            <td align="left" valign="top" rowspan="1" colspan="1">Seq-Well sample from peripheral
<break/>blood mononuclear cells from human</td>
            <td align="left" valign="top" rowspan="1" colspan="1">6,713</td>
            <td align="left" valign="top" rowspan="1" colspan="1">3,693</td>
            <td align="left" valign="top" rowspan="1" colspan="1">6</td>
            <td align="left" valign="top" rowspan="1" colspan="1">22 or 6</td>
            <td align="left" valign="top" rowspan="1" colspan="1">(
<xref rid="ref-27" ref-type="bibr">Gierahn
<italic>et al</italic>., 2017a</xref>)</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <table-wrap id="T2" orientation="portrait" position="anchor">
      <label>Table 2. </label>
      <caption>
        <title>Cell cluster labeling methods compared in this study.</title>
      </caption>
      <table frame="hsides" rules="groups" content-type="article-table">
        <thead>
          <tr>
            <th align="left" valign="top" rowspan="1" colspan="1">Acronym</th>
            <th align="left" valign="top" rowspan="1" colspan="1">Version</th>
            <th align="left" valign="top" rowspan="1" colspan="1">Name</th>
            <th align="left" valign="top" rowspan="1" colspan="1">Language</th>
            <th align="left" valign="top" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left" valign="top" rowspan="1" colspan="1">CIBERSORT</td>
            <td align="left" valign="top" rowspan="1" colspan="1">1.01</td>
            <td align="left" valign="top" rowspan="1" colspan="1"><underline>C</underline>ell type
<underline>I</underline>dentification
<underline>b</underline>y
<underline>E</underline>stimating
<break/><underline>R</underline>elative
<underline>S</underline>ubsets
<underline>o</underline>f
<underline>R</underline>NA
<underline>T</underline>ranscripts</td>
            <td align="left" valign="top" rowspan="1" colspan="1">R and Java</td>
            <td align="left" valign="top" rowspan="1" colspan="1">(
<xref rid="ref-18" ref-type="bibr">Newman
<italic>et al</italic>., 2015b</xref>)</td>
          </tr>
          <tr>
            <td align="left" valign="top" rowspan="1" colspan="1">GSEA</td>
            <td align="left" valign="top" rowspan="1" colspan="1">3.0</td>
            <td align="left" valign="top" rowspan="1" colspan="1"><underline>G</underline>ene
<underline>S</underline>et
<underline>E</underline>nrichment
<underline>A</underline>nalysis</td>
            <td align="left" valign="top" rowspan="1" colspan="1">Java</td>
            <td align="left" valign="top" rowspan="1" colspan="1">(
<xref rid="ref-22" ref-type="bibr">Subramanian
<italic>et al</italic>., 2005</xref>)</td>
          </tr>
          <tr>
            <td align="left" valign="top" rowspan="1" colspan="1">GSVA</td>
            <td align="left" valign="top" rowspan="1" colspan="1">1.30</td>
            <td align="left" valign="top" rowspan="1" colspan="1"><underline>G</underline>ene
<underline>S</underline>et
<underline>V</underline>ariation
<underline>A</underline>nalysis</td>
            <td align="left" valign="top" rowspan="1" colspan="1">R</td>
            <td align="left" valign="top" rowspan="1" colspan="1">(
<xref rid="ref-14" ref-type="bibr">Hänzelmann
<italic>et al</italic>., 2013</xref>)</td>
          </tr>
          <tr>
            <td align="left" valign="top" rowspan="1" colspan="1">METANEIGHBOR</td>
            <td align="left" valign="top" rowspan="1" colspan="1">1.3.1</td>
            <td align="left" valign="top" rowspan="1" colspan="1">Meta-analysis via neighbor voting</td>
            <td align="left" valign="top" rowspan="1" colspan="1">R</td>
            <td align="left" valign="top" rowspan="1" colspan="1">(
<xref rid="ref-7" ref-type="bibr">Crow
<italic>et al</italic>., 2018</xref>)</td>
          </tr>
          <tr>
            <td align="left" valign="top" rowspan="1" colspan="1">ORA</td>
            <td align="left" valign="top" rowspan="1" colspan="1">R( 3.5.1)</td>
            <td align="left" valign="top" rowspan="1" colspan="1"><underline>O</underline>ver-
<underline>r</underline>epresentation
<underline>A</underline>nalysis</td>
            <td align="left" valign="top" rowspan="1" colspan="1">R</td>
            <td align="left" valign="top" rowspan="1" colspan="1">(
<xref rid="ref-11" ref-type="bibr">Fisher, 1935</xref>;
<xref rid="ref-13" ref-type="bibr">Goeman &amp;</xref>
<break/>
<xref rid="ref-13" ref-type="bibr">Bühlmann, 2007</xref>)</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <fig fig-type="figure" id="f1" orientation="portrait" position="anchor">
      <label>Figure 1. </label>
      <caption>
        <title>Schematic of a process to benchmark automated cell type prediction methods.</title>
        <p>Two inputs are needed by automated cell type prediction methods (
<bold>A</bold>–
<bold>C</bold>). (
<bold>A</bold>) a matrix with the average expression of each gene
<italic>x</italic> for each cell cluster
<italic>y</italic> (
<italic>Ě
<sub>xy</sub></italic>). (
<bold>B</bold>,
<bold>C</bold>) cell type gene marker signatures can be provided as either gene sets (lists of gene identifiers, B) or numeric gene expression profiles (
<bold>C</bold>). (
<bold>D</bold>) Gene sets can be manually compiled from literature and are used for methods like GSEA, GSVA or ORA, whereas gene-expression profiles are measurements from microarrays, bulk- or single-cell RNA-sequencing (scRNA-seq) experiments and are used by methods like CIBERSORT and METANEIGHBOR. (
<bold>E</bold>) Automated cell type prediction methods produce a matrix of cell type prediction scores for each cell cluster. (
<bold>F</bold>) Some authors of scRNA-seq studies assign cell type labels manually to cell clusters using local expertise or orthogonal experiments such as fluorescence activated cell sorting. These annotations can be used as a gold standard to benchmark automated cell type predictions. (
<bold>G</bold>) Cell type prediction scores (from
<bold>E</bold>) for cell clusters are concatenated into a single vector and known cell cluster annotations (from
<bold>F</bold>) are added. The resulting matrix is used to assess the performance of cell type prediction methods by receiver operating characteristic (ROC) curve and precision-recall (PR) curve analyses varying over the prediction scores for all cell clusters in a dataset (
<bold>H</bold>). (
<bold>I</bold>) Robustness of cell type prediction methods can be analysed by gradually subsampling gene markers from cell type gene expression signatures (
<bold>B</bold> or
<bold>C</bold>) and repeating procedures of (
<bold>D</bold>–
<bold>H</bold>) to obtain distributions of the area under the curve (AUC) for ROC (ROC AUC) and PR (PR AUC) curves, which are shown as violin plots. We hypothesized that some prediction methods are more robust than others to the proportion of gene markers subsampled from cell type gene expression signatures.</p>
      </caption>
      <graphic xlink:href="f1000research-8-22823-g0000"/>
    </fig>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Generation of cell cluster average gene expression matrices (
<italic>Ě
<sub>xy</sub></italic>)</title>
      <p>For all datasets, the
<italic>Ě
<sub>xy</sub></italic> matrix was obtained from cell cluster scRNA-seq measurements with AverageExpression(use.raw = T) from
<ext-link ext-link-type="uri" xlink:href="https://satijalab.org/seurat/">Seurat</ext-link> v2 (
<xref rid="ref-6" ref-type="bibr">Butler
<italic>et al</italic>., 2018</xref>). For the liver dataset (
<xref rid="ref-16" ref-type="bibr">MacParland
<italic>et al</italic>., 2018</xref>) (NCBI GEO:
<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE115469">GSE115469</ext-link>) we followed the authors’ reported cell cluster assignments and applied AverageExpression() to compute the average expression profile for all cells in each cluster. For the retinal neuron dataset (
<xref rid="ref-21" ref-type="bibr">Shekhar
<italic>et al</italic>., 2016b</xref>) (NCBI GEO:
<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE81905">GSE81905</ext-link>) the gene expression matrix and cell cluster assignments were obtained from (
<xref rid="ref-20" ref-type="bibr">Shekhar
<italic>et al</italic>., 2016a</xref>) and processed with AverageExpression(). For the Tabula Muris dataset (NCBI GEO:
<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE109774">GSE109774</ext-link>), the droplet (10X Genomics) RNA measurements were obtained from Figshare (
<xref rid="ref-32" ref-type="bibr">Tabula Muris Consortium, 2018b</xref>). File ‘annotations_droplet.csv’ was used to obtain tissue and cell cluster information, and AverageExpression() was applied to clusters from each tissue. ‘Tabula Muris 11’ includes a subset of this data containing the 11 tissues for which we could map cell type gene expression signatures into cell clusters (see below), whereas ‘Tabula Muris 6’ was a subset of 6 tissues for which the mapped signatures had at least three cell types per tissue. The list of tissues included can be found in the corresponding
<italic>Ě
<sub>xy</sub></italic> matrices provided as Supplementary Information (
<xref rid="ref-8" ref-type="bibr">Diaz-Mejia
<italic>et al</italic>., 2019a</xref>). For the PBMC-10X datasets (
<xref rid="ref-23" ref-type="bibr">Zheng
<italic>et al</italic>., 2017a</xref>), ‘Fresh 68k PBMCs DonorA’ gene expression matrix files were obtained from 10X Genomics (
<xref rid="ref-24" ref-type="bibr">Zheng
<italic>et al</italic>., 2017b</xref>) (NCBI Sequence Read Archive:
<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRX1723926">SRX1723926</ext-link>). Normalization, data dimensionality reduction and cell clustering were conducted with Seurat v2 with the following functions: FilterCells(low.thresholds = 200,-Inf, high.thresholds = 0.05,10000); FindClusters(reduction.type = “pca”, dims.use = 1:10, resolution = 0.4); and AverageExpression(). For the PBMC-SeqWell datasets (
<xref rid="ref-28" ref-type="bibr">Gierahn
<italic>et al</italic>., 2017b</xref>), the GSM2486333_PBMC.txt file with read counts was obtained from GEO dataset
<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2486333">GSM2486333</ext-link> (NCBI GEO:
<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE92495">GSE92495</ext-link>). Columns with labels ‘Removed_*’ were removed and from the remaining columns, column header prefixes, like: BCELL*, NK*, CD4*, etc., were used to classify cells into clusters, and AverageExpression() was applied to each cluster.</p>
    </sec>
    <sec>
      <title>Collection of cell type gene expression signatures</title>
      <p>A gene expression signature is defined as a set of genes characteristically and detectably expressed in a cell type. These are typically inferred from small-scale experiments manually identified in the literature, or by comparing the transcriptome of a given cell type against all other available cell type gene expression profiles, usually from the same experiment. The liver cell type gene set signatures were manually curated by us (author S.A.M.) and were originally used to manually annotate cell types in the liver dataset (
<xref rid="ref-16" ref-type="bibr">MacParland
<italic>et al</italic>., 2018</xref>). We provide these gene sets on Zenodo (
<xref rid="ref-8" ref-type="bibr">Diaz-Mejia
<italic>et al</italic>., 2019a</xref>). For the retinal neuron dataset (
<xref rid="ref-21" ref-type="bibr">Shekhar
<italic>et al</italic>., 2016b</xref>), known cell type markers reported by the authors were used as cell type gene set signatures. For the Tabula Muris dataset, one of the consortium authors provided us with manually defined cell type gene set signatures for 11 of the 20 tissues included in the publication. The file is now available in the Tabula Muris repository (
<xref rid="ref-33" ref-type="bibr">Tabula Muris Consortium, 2018c</xref>;
<xref rid="ref-34" ref-type="bibr">Tabula Muris Consortium, 2019</xref>). For the PBMC-10X and PBMC-SeqWell datasets, we used a blood cell type gene expression profile signature compiled by the CIBERSORT developers called LM22, containing 547 genes and 22 cell types (
<xref rid="ref-17" ref-type="bibr">Newman
<italic>et al</italic>., 2015a</xref>). We also tested an alternative signature designed for RNA seq data with 17 cell types (
<xref rid="ref-29" ref-type="bibr">Monaco
<italic>et al</italic>., 2019</xref>), and it produced similar results to the LM22 dataset (Supplementary Table S2), thus we decided to use only the LM22 for our study. For the PBMC-10X dataset, reference cell type assignments were obtained from the authors’ fluorescence-activated cell sorting (FACS)-based assignments (
<xref rid="ref-25" ref-type="bibr">Zheng
<italic>et al</italic>., 2017c</xref>). The PBMC cell clusters we obtained with Seurat were mapped using cell barcode identifiers against the FACS assignments, and cell type names were manually matched to the LM22 signature. For the PBMC-SeqWell datasets (
<xref rid="ref-27" ref-type="bibr">Gierahn
<italic>et al</italic>., 2017a</xref>) cell cluster prefixes from the file GSM2486333_PBMC.txt column headers were used to manually assign cell types from the LM22 matrix (
<xref rid="ref-17" ref-type="bibr">Newman
<italic>et al</italic>., 2015a</xref>).</p>
      <p>CIBERSORT and METANEIGHBOR require as input a cell type gene expression signature in the form of gene expression profiles including gene expression scores. For the PBMC datasets, we used the LM22 signature to evaluate these two methods in two ways. First, we used the original LM22 signature (
<xref rid="ref-18" ref-type="bibr">Newman
<italic>et al</italic>., 2015b</xref>) with continuous valued gene expression measurements, which we called CIBERSORT ‘continuous’ and METANEIGHBOR ‘continuous’. Second, for each cell type of the LM22 signature, a value of ‘1’ was assigned to 5% of genes with highest expression values in their column or a value of ‘0’ otherwise, and we called this approach CIBERSORT ‘binary’ and METANEIGHBOR ‘binary’. The same 5% of genes was used to create cell type gene set signatures as inputs for GSEA, GSVA and ORA. For the liver dataset, we transformed the cell type gene set signature into a binary matrix of genes in rows and cell types in columns for CIBERSORT ‘binary’ and METANEIGHBOR ‘binary’. To do this, each gene included in each cell type gene set
<italic>m</italic> was assigned a value of ‘1’ in the column corresponding to
<italic>m</italic> in the matrix, whereas other genes absent in
<italic>m</italic> but present in other cell type gene sets were assigned a value of ‘0’. Similarly, for the retinal neuron dataset the ‘previously known markers’ for bipolar cell types provided in Table S2 of
<xref rid="ref-21" ref-type="bibr">Shekhar
<italic>et al</italic>. (2016b)</xref> were transformed into a binary matrix of genes by cell types for CIBERSORT ‘binary’ and METANEIGHBOR ‘binary’ analyses. For the Tabula Muris datasets, we organized the cell type gene set signatures of each tissue into a binary matrix of genes in rows and tissue-cell types in columns for CIBERSORT ‘binary’ and METANEIGHBOR ‘binary’ analyses.</p>
    </sec>
    <sec>
      <title>Generation of subsampled cell type gene expression signatures and area under the curve (AUC) distribution violin plots</title>
      <p>Cell type signature gene sets (
<xref ref-type="fig" rid="f1">Figure 1B</xref>) were subsampled by randomly removing between 10 and ~99% of genes from each signature in increments of 10%, keeping a minimum of one gene. Each subsampling of gene sets was organized as a binary matrix of genes by cell types for CIBERSORT ‘binary’ and METANEIGHBOR ‘binary’ as indicated above. Cell type gene expression profile signatures (
<xref ref-type="fig" rid="f1">Figure 1C</xref>) were subsampled in two stages: first we selected the top 5% highest expressed genes for each cell type, then we replaced the gene expression value of a random 10 to 100% of those genes from each cell type, in increments of 10%, by the minimum value of the cell type column. This resulted in subsampled gene expression profile signatures with identical size to the original profile signatures, but with values of the top highly expressed genes randomly replaced by the minimum score of each cell type. For percentage values between 10 to 100%, 1,000 subsampling replicates were generated for each cell type gene expression signature, and each replicate was processed as indicated by
<xref ref-type="fig" rid="f1">Figure 1D–I</xref>. Violin plots were used to show the resulting ROC and PR AUC distributions.</p>
    </sec>
    <sec>
      <title>Implementation of tested methods and use of enrichment metrics for ROC and PR analyses</title>
      <p>We used five methods to score each cell cluster for each cell type. Three methods (CIBERSORT, GSVA and METANEIGHBOR) generated scores that could be directly used for ROC and PR curve analyses. For ORA and GSEA, we first transformed their cell cluster labeling P-values to a -log10 scale, so that higher values reflected higher scores of a cell cluster belonging to a given cell type and used these scores for ROC and PR curve analyses. All prediction scores for each dataset over all tested cell cluster vs. cell type pairs were concatenated into a single vector and compared to gold standard cell cluster annotations (
<xref ref-type="fig" rid="f1">Figure 1G</xref>). Varying prediction score thresholds over this vector was used to plot the ROC and PR curves and obtain AUC values (using R ROCR and precrec libraries). For each prediction score threshold, all predictions above the threshold were predicted positives and these were compared to known cluster annotations to identify true and false positives, as well as true and false negatives below the score threshold, for ROC and PR curve analysis. Commands for each method were: CIBERSORT (v1.01), ‘CIBERSORT.jar -M Mixture -B signature -n 1000’; R library(GSVA) v1.30, R function gsva(); GSEA v3.0, ‘gsea-3.0.jar GseaPreranked -nperm 1000’; ORA, R function fisher.test() from R v3.5.1. For ORA, the universe of genes used was the intersection of genes present in the cell type gene expression signature and the
<italic>Ě
<sub>xy</sub></italic> matrix of each dataset. For METANEIGHBOR we created a modified version of function MetaNeighborUS() from the R library(MetaNeighbor) v1.3.1, to obtain cell type prediction scores. A typical MetaNeighborUS() run uses scRNA-seq measurements from studies 1 and 2, and its output is the average ROC AUC for each pair of neighbor ROC AUC scores across 'training' and 'testing' datasets. In this study, we instead used cell clusters from one scRNA-seq dataset as the 'testing' dataset (i.e. study 1) and cell type signatures as the 'training' dataset (i.e. study 2). With the advice of one of the MetaNeighbor developers, we modified function MetaNeighborUS() source code to remove the averaging command ‘cell_NV &lt;- (cell_NV+t(cell_NV))/2’ and compiled the library from the modified source. All methods were implemented in Java, R and Perl (
<xref rid="T2" ref-type="table">Table 2</xref>). The scripts used to run and benchmark cell type labeling methods described in this study are available on GitHub and archived at Zenodo (
<xref rid="ref-9" ref-type="bibr">Diaz-Mejia
<italic>et al</italic>., 2019b</xref>).</p>
    </sec>
    <sec>
      <title>Computing time benchmark</title>
      <p>We implemented wrapper scripts to execute each of the five methods tested, including a stopwatch to time the cell type prediction task. Other tasks, such as input and output preparation, were excluded from computing time values reported in
<xref ref-type="fig" rid="f6">Figure 6D</xref> and Supplementary Table 1. All computing time measurements were made using a 3.1-GHz Intel Core i5 CPU with 2 cores and 16 GB RAM. Robustness analyses were performed on the Niagara supercomputer at the SciNet HPC Consortium (
<xref rid="ref-30" ref-type="bibr">Ponce
<italic>et al</italic>., 2019</xref>).</p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <sec>
      <title>Benchmark of cell cluster labeling methods</title>
      <p>We benchmarked the performance and computing time of five cell type labeling methods: CIBERSORT, GSVA, GSEA, METANEIGHBOR and ORA (
<xref rid="T2" ref-type="table">Table 2</xref>), using average gene expression profiles of scRNA-seq cell clusters and known cell type gene expression signatures. We used five scRNA-seq datasets: liver (
<xref rid="ref-16" ref-type="bibr">MacParland
<italic>et al</italic>., 2018</xref>), retinal neurons (
<xref rid="ref-21" ref-type="bibr">Shekhar
<italic>et al</italic>., 2016b</xref>), the Tabula Muris mouse cell atlas (
<xref rid="ref-31" ref-type="bibr">Tabula Muris Consortium
<italic>et al</italic>., 2018a</xref>), and two PBMC datasets obtained with 10X Chromium (
<xref rid="ref-23" ref-type="bibr">Zheng
<italic>et al</italic>., 2017a</xref>) and Seq-Well technologies (
<xref rid="ref-27" ref-type="bibr">Gierahn
<italic>et al</italic>., 2017a</xref>) (
<xref rid="T1" ref-type="table">Table 1</xref>). Each method used two inputs: an
<italic>Ě
<sub>xy</sub></italic> matrix with the average gene expression for each cell cluster (
<xref ref-type="fig" rid="f1">Figure 1A</xref>) and a cell type gene expression signature, represented as either a gene set (discrete set of genes) or a gene expression profile (vector of continuous gene expression values). For three of the five methods tested (GSVA, GSEA and ORA) we used cell type signatures in the form of gene sets (
<xref ref-type="fig" rid="f1">Figure 1B</xref>), and for CIBERSORT and METANEIGHBOR we used two cell type signature representation approaches: binary and continuous. In one approach we transformed gene sets into binarized matrices and called the method variants CIBERSORT ‘binary’ and METANEIGHBOR ‘binary’. In the second approach, we used available gene expression profiles (
<xref ref-type="fig" rid="f1">Figure 1C</xref>) and called the method variants CIBERSORT ‘continuous’ and METANEIGHBOR ‘continuous’.</p>
      <p>Each method produced a matrix of cell type prediction scores (
<xref ref-type="fig" rid="f1">Figure 1D, E</xref>) which was compared to manually annotated cell type gold standards (
<xref ref-type="fig" rid="f1">Figure 1F, G</xref>) to conduct receiver operating characteristic (ROC) and precision-recall (PR) curve analyses (
<xref ref-type="fig" rid="f1">Figure 1H</xref>). The robustness of each method was assessed by randomly subsampling 10% to 100% of the genes from cell type gene expression signatures and repeating the cell type prediction, and ROC and PR curve analyses for each subsample (
<xref ref-type="fig" rid="f1">Figure 1I</xref>). In the following sections we show ROC and PR curve analyses side by side with their robustness analyses (
<xref ref-type="fig" rid="f2">Figure 2</xref> to
<xref ref-type="fig" rid="f5">Figure 5</xref>) and a summary of results in
<xref ref-type="fig" rid="f6">Figure 6</xref>.</p>
      <fig fig-type="figure" id="f2" orientation="portrait" position="anchor">
        <label>Figure 2. </label>
        <caption>
          <title>Performance and robustness analysis of cell type prediction methods using liver and retinal neuron scRNA-seq data.</title>
          <p>Receiver operating characteristic (ROC) and precision-recall (PR) curve analyses of five automated cell type prediction methods: CIBERSORT (CIBER(b)), GSEA, GSVA, METANEIGHBOR (META(b)) and ORA (
<xref rid="T2" ref-type="table">Table 2</xref>) using a human liver scRNA-seq dataset to compute ROC curve analysis (
<bold>A</bold>) and PR curve analysis (
<bold>B</bold>); using a mouse retinal neuron scRNA-seq dataset to compute ROC curve analysis (
<bold>C</bold>) and PR curve analysis (
<bold>D</bold>). The cell type gene expression signatures used for ROC and PR curve analyses for panels
<bold>A</bold> to
<bold>D</bold> were randomly subsampled 1,000 times, keeping 10 to 100% of genes from the original signatures each time. Automated cell type prediction was repeated for each subsample, and violin plots representing the distribution of resulting ROC AUCs and PR AUCs are shown for analyses using human liver cells to compute ROC AUC robustness (
<bold>E</bold>) and PR AUC robustness (
<bold>F</bold>), and using mouse retinal neurons to compute ROC AUC robustness (
<bold>G</bold>) and PR AUC robustness (
<bold>H</bold>).</p>
        </caption>
        <graphic xlink:href="f1000research-8-22823-g0001"/>
      </fig>
    </sec>
    <sec>
      <title>ROC curve analysis</title>
      <p>In general, we observed that all five methods showed high ROC AUCs for assigning cell types to all eight analysed scRNA-seq dataset variants (average ROC AUC over 40 method-data combinations = 0.91, s.d. = 0.06). The liver and retinal neuron datasets showed average ROC AUC = 0.96 and 0.93, respectively (
<xref ref-type="fig" rid="f2">Figure 2A, C</xref>). The Tabula Muris dataset was analysed in two ways. In the first way, which we call ‘Tabula Muris 11’, we used data from 11 tissues for which we could find cell type signatures (
<xref rid="ref-32" ref-type="bibr">Tabula Muris Consortium, 2018b</xref>), and used their signatures collectively as a gene set database input for a single task to predict cell types across all Tabula Muris tissues (average ROC AUC = 0.88,
<xref ref-type="fig" rid="f3">Figure 3A</xref>). In the second way, which we call ‘Tabula Muris 6’, we restricted predictions to six tissues with three or more cell type signatures per tissue, using tissue-specific cell type signature gene set databases, and merged the prediction scores from the six tissues to evaluate performance over all those tissues (average ROC AUC = 0.97,
<xref ref-type="fig" rid="f3">Figure 3C</xref>). Since we observed higher ROC AUCs using ‘Tabula Muris 6’ than using ‘Tabula Muris 11’ (
<xref ref-type="fig" rid="f3">Figure 3C vs. 3A</xref>), we also analysed the PBMC datasets similarly. First, we used all 22 cell type signatures from the LM22 (
<xref rid="ref-18" ref-type="bibr">Newman
<italic>et al</italic>., 2015b</xref>) to predict cell types using PBMC cell clusters from 10X and Seq-Well. We call these approaches ‘PBMCs-22-10X’ and ‘PBMCs-22-SeqWell’ and obtained average ROC AUCs of 0.85 and 0.86, respectively (
<xref ref-type="fig" rid="f4">Figure 4A</xref>,
<xref ref-type="fig" rid="f5">Figure 5A</xref>). Secondly, we restricted the analyses to the six cell types from the LM22 matrix that mapped to PBMC cell clusters (see Methods). We call these approaches ‘PBMCs-6-10X’ and ‘PBMCs-6-SeqWell’ and obtained average ROC AUCs of 0.89 and 0.96, respectively (
<xref ref-type="fig" rid="f4">Figure 4C</xref>,
<xref ref-type="fig" rid="f5">Figure 5C</xref>).</p>
      <fig fig-type="figure" id="f3" orientation="portrait" position="anchor">
        <label>Figure 3. </label>
        <caption>
          <title>Performance and robustness analysis of cell type prediction methods using Tabula Muris scRNA-seq data.</title>
          <p>The same procedure as described in
<xref ref-type="fig" rid="f2">Figure 2</xref> for ROC and PR AUCs of the liver and retinal neuron datasets was used here for the Tabula Muris dataset. Please see
<xref ref-type="fig" rid="f2">Figure 2</xref> legend for details. The Tabula Muris dataset was analysed in two ways. In the first way (‘Tabula Muris 11’, panels
<bold>A</bold>,
<bold>B</bold>,
<bold>E</bold> and
<bold>F</bold>), 11 tissues whose cell type signatures and cell clusters could be mapped against each other were analysed using all cell type signatures as a single input gene set database for cell type prediction methods. In the second way (‘Tabula Muris 6’, panels
<bold>C</bold>,
<bold>D</bold>,
<bold>G</bold> and
<bold>H</bold>), the analysis was restricted to six tissues with three or more cell type signatures. In this strategy, each tissue’s cell types were predicted separately from other tissues and the results were combined afterwards to evaluate the ROC, PR and robustness of each of five automated cell type prediction methods: CIBERSORT (CIBER(b)), GSEA, GSVA, METANEIGHBOR (META(b)) and ORA.</p>
        </caption>
        <graphic xlink:href="f1000research-8-22823-g0002"/>
      </fig>
      <p>In terms of ROC curve analyses, GSEA and GSVA were the top performers (average ROC AUCs = 0.93 each), closely followed by the two approaches of METANEIGHBOR and ORA (average ROC AUCs = 0.91 each), then CIBERSORT ‘binary’ (average ROC AUC = 0.88) and CIBERSORT ‘continuous’ (average ROC AUC = 0.86). Notably, the ‘binary’ approaches of CIBERSORT and METANEIGHBOR produced some of the highest performance among all tested methods for the liver (CIBERSORT ‘binary’ ROC AUC = 1,
<xref ref-type="fig" rid="f2">Figure 2A</xref>), retinal neuron (CIBERSORT ‘binary’ and METANEIGHBOR ‘binary’ ROC AUCs = 0.93 each,
<xref ref-type="fig" rid="f2">Figure 2C</xref>) and Tabula Muris datasets (METANEIGHBOR ‘binary’ ROC AUC = 0.92 using 11 tissues, and 0.99 using six tissues). In fact, the CIBERSORT and METANEIGHBOR ‘binary’ performances were comparable to those using the original LM22 matrix with continuous values, which we called CIBERSORT ‘continuous’ and METANEIGHBOR ‘continuous’ (
<xref ref-type="fig" rid="f6">Figure 6A</xref>). A summary of these observations is provided in
<xref ref-type="fig" rid="f6">Figure 6A</xref> and Supplementary Table 1.</p>
      <p>The analysis of ROC AUC robustness showed that in general, performance decayed as a function of removing genes from cell type gene signatures. For the liver dataset, GSVA and GSEA tolerated removal of up to 60% of genes from the liver signatures to maintain ROC AUCs ≥ 0.8, whereas CIBERSORT ‘binary’, METANEIGHBOR ‘binary’ and ORA tolerated removal of up to 50% of the genes at the same ROC AUC cutoff (
<xref ref-type="fig" rid="f2">Figure 2E</xref>). For the retinal neuron dataset, GSVA, METANEIGHBOR ‘binary’ and ORA tolerated removal of up to 50% of the genes from the signature to maintain ROC AUCs ≥ 0.8, whereas GSEA and CIBERSORT ‘binary’ tolerated removal of 30% and 20%, respectively (
<xref ref-type="fig" rid="f2">Figure 2G</xref>). Analysis of the Tabula Muris dataset showed that all methods were more stable to removal of genes from these signatures compared with observations for the liver, retinal neuron and PBMC datasets. The ‘Tabula Muris 6’ approach resulted in ROC AUCs slightly more robust than those using ‘Tabula Muris 11’ (
<xref ref-type="fig" rid="f3">Figure 3E, G</xref>). Analysis of the PBMC datasets showed that GSVA was the method that tolerated the highest removal of genes from signatures (of up to 90%) to maintain ROC AUCs ≥ 0.8 (
<xref ref-type="fig" rid="f4">Figures 4E, 4G</xref>,
<xref ref-type="fig" rid="f5">Figure 5E, 5G</xref>). In contrast, METANEIGHBOR ‘continuous’ was robust using the 10X PBMC dataset (
<xref ref-type="fig" rid="f4">Figure 4E, G</xref>) but decayed markedly using the Seq-Well dataset (
<xref ref-type="fig" rid="f5">Figure 5E, G</xref>). At the same ROC AUC cutoff = 0.8, ORA tolerated removal of up to 50% of genes and GSEA removal of 30–40% of genes for all PBMC datasets (
<xref ref-type="fig" rid="f4">Figure 4E, 4G</xref>,
<xref ref-type="fig" rid="f5">Figure 5E, 5G</xref>). The two versions of CIBERSORT showed similar behaviours to each other, tolerating removal of up to 60% of genes in the ‘PBMC-6-SeqWell’ approach (
<xref ref-type="fig" rid="f5">Figure 5G</xref>), but decayed quickly after removing only 10% of genes in the rest of the PBMC approaches (
<xref ref-type="fig" rid="f4">Figures 4E, 4G</xref>,
<xref ref-type="fig" rid="f5">Figure 5E</xref>).</p>
      <fig fig-type="figure" id="f4" orientation="portrait" position="anchor">
        <label>Figure 4. </label>
        <caption>
          <title>Performance and robustness analysis of cell type prediction methods using 10X PBMCs scRNA-seq data.</title>
          <p>The same procedure as described in
<xref ref-type="fig" rid="f2">Figure 2</xref> for ROC and PR AUCs of the liver and retinal neuron datasets was used here for the PBMCs dataset measured with the 10X Chromium technology. Please see
<xref ref-type="fig" rid="f2">Figure 2</xref> legend for details. Seven cell clusters from the 10X scRNA-seq measurements could be mapped vs. six out of 22 cell types of the PBMC LM22 matrix signatures. This dataset was analysed in two ways. In the first way (‘PBMCs-22-10X’, panels
<bold>A</bold>,
<bold>B</bold>,
<bold>E</bold> and
<bold>F</bold>), all 22 cell type signatures from the LM22 matrix were used as input for cell type prediction methods. In the second way (‘PBMCs-6-10X’,panels
<bold>C</bold>,
<bold>D</bold>,
<bold>G</bold> and
<bold>H</bold>), only the six cell types from the LM22 that could be mapped to the seven cell clusters were used as input for cell type prediction methods. For CIBERSORT and METANEIGHBOR, two approaches were used, one with the original LM22 matrix with continuous gene expression values, that we called CIBERSORT ‘continuous’ (CIBER(c)) and METANEIGHBOR ‘continuous’ (META(c)), and another with a thresholded and binarized version of the LM22 matrix, that we called CIBERSORT ‘binary’ (CIBER(b)) and METANEIGHBOR ‘binary’ (META(b)).</p>
        </caption>
        <graphic xlink:href="f1000research-8-22823-g0003"/>
      </fig>
    </sec>
    <sec>
      <title>Precision-Recall curve analysis</title>
      <p>When benchmarking the five methods compared in this study, we classified each cell cluster positively into a single-cell type and negatively into the remaining cell types. This produced a skewed distribution with few positive predictions and many negative predictions. To address this imbalance, we used PR curve analyses in addition to ROC curve analyses. In general, the PR AUCs were smaller and more diverse (average PR AUC = 0.53, s.d. = 0.24) than the ROC AUCs (average ROC AUC = 0.91, s.d. = 0.06) (
<xref ref-type="fig" rid="f2">Figure 2</xref> to
<xref ref-type="fig" rid="f5">Figure 5</xref>, panels A vs. B, and C vs. D). However, when we restricted signatures to keep only cell types expected to match the input cell clusters we found that ROC AUCs increased marginally (average 1.1 times), whereas the PR AUCs increased substantially (average 3.2 times). For instance, the average PR AUC using ‘Tabula Muris 6’ was higher than that using ‘Tabula Muris 11’ (0.73 vs. 0.23,
<xref ref-type="fig" rid="f3">Figure 3D vs. 3B</xref>). Similarly, the average PR AUC using ‘PBMC-6-10X’ was higher than that using ‘PBMC-22-10X’ (0.69 vs. 0.34,
<xref ref-type="fig" rid="f4">Figure 4D vs. 4B</xref>); and the average PR AUC using ‘PBMC-6-SeqWell’ was higher than that using ‘PBMC-22-SeqWell’ (0.79 vs. 0.21,
<xref ref-type="fig" rid="f5">Figure 5D vs. 5B</xref>).</p>
      <fig fig-type="figure" id="f5" orientation="portrait" position="anchor">
        <label>Figure 5. </label>
        <caption>
          <title>Performance and robustness analysis of cell type prediction methods using Seq-Well PBMCs scRNA-seq data.</title>
          <p>The same procedure as described in
<xref ref-type="fig" rid="f2">Figure 2</xref> for ROC and PR AUCs of the liver and retinal neuron datasets was used here for the PBMC dataset measured with the Seq-Well technology. Please see
<xref ref-type="fig" rid="f2">Figure 2</xref> legend for details. Six cell clusters from the Seq-Well scRNA-seq measurements could be mapped vs. six out of 22 cell types of the PBMC LM22 matrix signatures. This dataset was analysed in two ways. In the first way (‘PBMCs-22-SeqWell’, panels
<bold>A</bold>,
<bold>B</bold>,
<bold>E</bold> and
<bold>F</bold>), all 22 cell type signatures from the LM22 matrix were used as input for cell type prediction methods. In the second way (‘PBMCs-6-SeqWell’, panels
<bold>C</bold>,
<bold>D</bold>,
<bold>G</bold> and
<bold>H</bold>), only the six cell types from the LM22 that could be mapped to the six cell clusters were used as input for cell type prediction methods. For CIBERSORT and METANEIGHBOR, two approaches were used, one with the original LM22 matrix with continuous gene expression values, that we called CIBERSORT ‘continuous’ (CIBER(c)) and METANEIGHBOR ‘continuous’ (META(c)), and another with a thresholded and binarized version of the LM22 matrix, that we called CIBERSORT ‘binary’ (CIBER(b)) and METANEIGHBOR ‘binary’ (META(b)).</p>
        </caption>
        <graphic xlink:href="f1000research-8-22823-g0004"/>
      </fig>
      <p>Some methods clearly separated from the rest using PR curve analyses. For instance, the two highest PR AUCs obtained in this study were for CIBERSORT ‘continuous’ using the ‘PBMC-6-SeqWell’ dataset (PR AUC = 1,
<xref ref-type="fig" rid="f5">Figure 5D</xref>) and CIBERSORT ‘binary’ using the liver dataset (PR AUC = 0.98,
<xref ref-type="fig" rid="f2">Figure 2B</xref>). Interestingly, CIBERSORT ‘binary’ also showed some of the lowest PR AUCs in this study, with a PR AUC = 0.17 using the ‘Tabula Muris 11’ dataset (
<xref ref-type="fig" rid="f3">Figure 3B</xref>) and PR AUC = 0.15 using the ‘PBMC-22-SeqWell’ dataset (
<xref ref-type="fig" rid="f5">Figure 5B</xref>). A similar behaviour was observed for METANEIGHBOR ‘binary’ and ‘continuous’ showing low PR AUCs using the ‘PBMC-22-10X’ (PR AUC = 0.19 each) and ‘PBMC-22-SeqWell’ datasets (PR AUC = 0.17 and 0.22;
<xref ref-type="fig" rid="f4">Figures 4B</xref>,
<xref ref-type="fig" rid="f5">Figure 5B</xref>), but a considerable increase using the reduced versions of the same datasets: ‘PBMC-6-10X’ (PR AUC = 0.71 for METANEIGHBOR ‘continuous’ and 0.54 for METANEIGHBOR ‘binary’) and ‘PBMC-6-SeqWell (PR AUCs = 0.8 each).</p>
      <p>GSVA and ORA showed relatively stable PR AUCs across datasets, and GSVA was one of the methods showing the highest PR AUC using the liver, retinal neuron, ‘Tabula Muris 6’ and PBMC-10X datasets (
<xref ref-type="fig" rid="f6">Figure 6B</xref>). GSEA and METANEIGHBOR ‘binary’ showed lower PR AUCs than other methods using the liver, retinal neuron and ‘Tabula Muris 11’ datasets (
<xref ref-type="fig" rid="f2">Figure 2B, 2D</xref>,
<xref ref-type="fig" rid="f3">Figure 3B</xref>). A summary of these observations is provided in
<xref ref-type="fig" rid="f6">Figure 6B</xref> and Supplementary Table 1.</p>
      <fig fig-type="figure" id="f6" orientation="portrait" position="anchor">
        <label>Figure 6. </label>
        <caption>
          <title>Summary of performance and computing time of cell type prediction methods using scRNA-seq data.</title>
          <p>(
<bold>A</bold>) A heatmap showing a summary of cell type prediction ROC AUCs for the five datasets used (x-axis), including two variants each of the Tabula Muris and PBMC datasets, for the five methods studied (y-axis), including two approaches for CIBERSORT (‘binary’ CIBER(b), and ‘continuous’ CIBER(c)) and METANEIGHBOR (‘binary’ META(b), and ‘continuous’ META(c)). The mean ROC AUCs for each method across all scRNA-seq datasets and for each dataset across all methods are provided. (
<bold>B</bold>) A heatmap similar to (
<bold>A</bold>), but showing PR AUC values. (
<bold>C</bold>) A heatmap showing the percentage of clusters correctly assigned by each method for each dataset. (
<bold>D</bold>) A heatmap showing computing times for each cell type prediction task and the mean across all scRNA-seq datasets. Actual values for panels
<bold>A</bold> to
<bold>D</bold> are provided in Supplementary Table 1. (
<bold>E</bold>) Violin plots showing the influence of the number of genes in cell type signatures on methods that use gene sets as inputs. The number of genes in the signatures is shown on the x-axis along the number of signatures with that number of genes, in brackets. The rank of the expected (gold standard) predictions is shown on the y-axes. A perfect method would show its gold standard predictions ranked as ‘1’.</p>
        </caption>
        <graphic xlink:href="f1000research-8-22823-g0005"/>
      </fig>
      <p>In terms of the PR AUC robustness analysis, in general, all five methods achieved their more robust behaviour using the Tabula Muris datasets (
<xref ref-type="fig" rid="f3">Figure 3F, H</xref>). Other cases where the PR AUCs were robust include the liver (
<xref ref-type="fig" rid="f2">Figure 2F</xref>) and ‘PBMC-6-SeqWell’ datasets (
<xref ref-type="fig" rid="f5">Figure 5H</xref>).</p>
      <p>GSVA was one of the methods that maintained higher PR AUC values than other methods upon removal of genes from signatures; in particular using the liver (
<xref ref-type="fig" rid="f2">Figure 2F</xref>), ‘PBMC-6-10X’ (
<xref ref-type="fig" rid="f4">Figure 4H</xref>) and ‘PBMC-6-SeqWell’ datasets (
<xref ref-type="fig" rid="f5">Figure 5H</xref>). For instance, both GSVA and ORA tolerated removal of up to 60% of genes from the liver cell types signature to maintain PR AUCs ≥ 0.5; whereas CIBERSORT ‘binary’ tolerated removal of 50% of the genes and METANEIGHBOR ‘binary’ only 10%, using the same cutoff (
<xref ref-type="fig" rid="f2">Figure 2F</xref>). METANEIGHBOR ‘continuous’ showed high PR robustness for the ‘PBMC-6-10X’ dataset (
<xref ref-type="fig" rid="f4">Figure 4H</xref>), but interestingly, such behaviour was not recapitulated using the ‘PBMC-6-SeqWell’ dataset (
<xref ref-type="fig" rid="f5">Figure 5H</xref>).</p>
    </sec>
    <sec>
      <title>Computing time benchmark</title>
      <p>Computing times varied from 0.03s for METANEIGHBOR ‘continuous’, processing the ‘PBMC-6-SeqWell’ dataset, to 9,330s (2.6 hours) for CIBERSORT ‘continuous’, processing the ‘PBMC-22-10X’ dataset (
<xref ref-type="fig" rid="f6">Figure 6D</xref> and Supplementary Table 1). For all five datasets, METANEIGHBOR ‘continuous’ was the fastest method, with times between 0.03 and 0.11s, closely followed by METANEIGHBOR ‘binary’, with times between 0.4 and 1.77s. GSVA ranked third (0.4 to 4.74s), followed by ORA (1 to 28s). GSEA was 1 to 3 orders of magnitude slower than the preceding methods (48 to 1255s). Finally, the slowest methods were CIBERSORT ‘binary’ (46 to 1,522s) and CIBERSORT ‘continuous’ (75 to 9,330s).</p>
      <p>The size of the cell type gene expression signatures used for CIBERSORT influenced the speed of classification. For example, for the analysis of the PBMC datasets with CIBERSORT ‘continuous’ we used the original LM22 signature with 547 genes, whereas the thresholded binary matrix used for CIBERSORT ‘binary’ had 248 genes. CIBERSORT ‘continuous’ took 1.3 to 6 times longer than CIBERSORT ‘binary’ without much difference in performance (
<xref ref-type="fig" rid="f6">Figure 6C</xref> and Supplementary Table 1).</p>
    </sec>
    <sec>
      <title>Influence of number of genes in signatures on method performance</title>
      <p>We evaluated how the number of genes in cell type signatures affected the performance of the five tested methods. As shown in
<xref ref-type="fig" rid="f6">Figure 6E</xref>, all methods tended to rank positive gold standards as top hits (i.e. the greater the number of genes in cell type signatures, the greater the chances that a method correctly predicts a cell type). All methods tended to have mispredictions (ranks &gt; 1) using cell type signatures of only one or two genes. Methods like GSEA and GSVA showed a marked improvement when the cell type signatures had 11 genes or more compared with &lt;11 genes, whereas METANEIGHBOR ‘binary’ improved considerably when signatures had three or more genes, compared with one or two genes. CIBERSORT ‘binary’ and ORA showed a partial improvement when signatures had six or more genes, but they had peaks of mispredictions at 11–20 genes (ORA) and 21–50 genes (CIBERSORT ‘binary’).</p>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>The size and volume of scRNA-seq datasets are continually increasing. While most data processing is automated, cell type labeling of cell clusters is still conducted manually by most researchers. This is in part due to a scarcity of reference cell type gene expression signatures and also because most methods to address this challenge are only available via web servers supporting limited number of cell types (
<xref rid="ref-1" ref-type="bibr">Alavi
<italic>et al</italic>., 2018</xref>;
<xref rid="ref-2" ref-type="bibr">Alquicira-Hernandez
<italic>et al</italic>., 2018</xref>), making it difficult for users to adapt them for their needs. In this study we used five scRNA-seq datasets to benchmark five methods that can address these challenges. Although three of the five tested methods (GSEA, GSVA and ORA) were not explicitly developed to identify cell types, their extensive use in gene set enrichment tasks and their wide portability motivated us to test them as cell type classifiers. METANEIGHBOR was developed to analyse scRNA-seq datasets and can be adapted to predict cell types. CIBERSORT is implemented both as a webserver and a local command line software package that can be freely licensed for six months by academic researchers, enabling us to benchmark it with relatively low programmatic effort.</p>
    <p>Our results show that for the five scRNA-seq datasets used, all five tested methods achieved good performance by ROC curve analyses. However, ROC curves tend to overestimate performance when the ratio of positive to negative predictions is highly skewed. For this reason, we also conducted PR curve analyses. The PR curve analyses showed more variation in the performance of methods than the ROC curves. On average, for the five scRNA-seq datasets, GSVA was one of the top performers by ROC curve analysis and the top performer by PR curve analyses (
<xref ref-type="fig" rid="f6">Figure 6A, B</xref>). GSVA’s performance was more robust than that of other methods in analyses where we subsampled genes from cell type signatures. All of these features are particularly important at this stage of the scRNA-seq field, as only limited information on cell type gene expression signatures is available. Notably, despite its relative simplicity, ORA showed a performance comparable to GSVA using most datasets and even higher using the liver dataset. A caveat of ORA is that it requires one extra step compared with other methods, which is to threshold the
<italic>Ě
<sub>xy</sub></italic> matrix, typically using an arbitrary cutoff, often selected based on the overall distribution of gene expression values, as we used here. CIBERSORT and METANEIGHBOR were also comparable or even superior to GSVA in datasets where the number of cell clusters matched the number of cell types expected. For instance, both former methods outperformed GSVA using the PBMC-6-SeqWell datasets, and CIBERSORT’s performance was also higher than that of GSVA using the liver dataset. However, both CIBERSORT and METANEIGHBOR were markedly affected, and outperformed by GSVA, when the number of cell type signatures exceeded the number of cell clusters (i.e. ‘Tabula Muris 11’ and the PBCM-22-* datasets). A caveat of METANEIGHBOR is that in addition to the typical inputs (cell type signatures and
<italic>Ě
<sub>xy</sub></italic> matrix) it requires a training phase based on known cell type gene markers to compute an AUC ROC as its prediction scores, but known cell type markers are not available for several scRNA-seq datasets. GSEA was the method with the lowest PR AUC values using all five datasets and was also one of the least stable in robustness analyses.</p>
    <p>An interesting observation from the robustness analyses is that for some datasets and methods, subsamples of genes from cell type gene sets produced ROC and PR AUCs higher than those using 100% of the genes. This was particularly noticeable for CIBERSORT using retinal neurons, ‘Tabula Muris 11’, and the PBMC datasets, and for METANEIGHBOR using the PBMC datasets. This suggests that adding subsampling steps in the pipelines for some methods could improve their performance.</p>
    <p>In terms of computing times, METANEIGHBOR was the fastest, and along with GSVA and ORA, offered implementations which were orders of magnitude faster than those of CIBERSORT and GSEA. Our results showed that CIBERSORT ‘binary’ performance was comparable to CIBERSORT ‘continuous’ by both ROC and PR curve analyses, and our implementation of the former reduced computing times between 1.3 and 6 times. Current publicly available scRNA-seq datasets typically contain on the order of thousands of cells, grouped into dozens of cell clusters. In our tests, each of the five tested methods completed the cell type prediction tasks in seconds or minutes. However, bigger datasets from the Human Cell Atlas (
<xref rid="ref-19" ref-type="bibr">Rozenblatt-Rosen
<italic>et al</italic>., 2017</xref>) and other sources are expected to have millions of cells (e.g. 1.3 million brain cell from E18 mice, NCBI GEO:
<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE93421">GSE93421</ext-link>) grouped into hundreds of clusters, for which the fastest method implementations will be preferred. Considering overall performance, robustness to incomplete cell type signatures, and computing times, we found that GSVA offers one of the best options to label cell clusters from scRNA-seq datasets.</p>
    <p>A limitation of this study is that we included only five scRNA-seq datasets (
<xref rid="T1" ref-type="table">Table 1</xref>): liver, retinal neurons, Tabular Muris, and two PBMC datasets, plus variants of the latter three. This was due to the lack of reference cell type annotations needed for our ROC and PR curve analyses. As more scRNA-seq datasets become available and authors provide gold standard annotations of their cell types, our benchmark can be expanded. In the future, carefully annotated scRNA-seq cell clusters and their associated gene expression signatures and gene expression markers will likely replace literature curated gene expression marker sets, but we need many more and diverse scRNA-seq datasets to be generated to get to that stage. It would also be useful to identify recommended prediction score thresholds that maximize performance for each method as well as identify cell type gene sets that always perform poorly, but achieving general results from these analyses will likely need a larger and more diverse benchmark dataset. One way to address this is to predict cell types from individual cells, in which case a cross-validation approach can be used based on cluster labeling data (
<xref rid="ref-26" ref-type="bibr">Abdelaal
<italic>et al</italic>., 2019</xref>), but this has the caveat that current generation scRNA-seq methods identify relatively few genes expressed per cell, compared to the cell clusters we analyzed here. Additionally,
<italic>k</italic>-fold cross-validations can’t be applied to cell cluster level evaluations because a cluster represents a single object defined by a single vector capturing the average expression levels of all genes across all cells in the cluster.</p>
    <p>Studying how cluster parameters and data structure (e.g. cluster density, fuzzy vs. hard clusters) affects our results should also be considered in future work. One of the challenges that we faced while adapting the LM22 signature to predict cell types in the scRNA-seq cell clusters generated by
<xref rid="ref-23" ref-type="bibr">Zheng
<italic>et al</italic>. (2017a)</xref> was that, even though both datasets correspond to PBMCs, the granularity of their cell type labels was different. For instance, the LM22 signature contains six T-cell types, including three CD4+ (naïve, memory resting, and memory activated), follicular helper, regulatory and gamma delta, whereas the dataset of
<xref rid="ref-23" ref-type="bibr">Zheng
<italic>et al</italic>. (2017a)</xref> contained labels for four T-cell related cell types: CD4+/CD25 T Regulatory, CD4+/CD45RO+ Memory, CD4+/CD45RA+/CD25- Naive T and CD4+ T Helper2. Thus, even though these two datasets both classify PBMCs, their cell types cannot be easily related one-to-one. This could be addressed with an ontology analogous to the Gene Ontology (
<xref rid="ref-3" ref-type="bibr">Ashburner
<italic>et al</italic>., 2000</xref>) but dedicated to cell type annotations (
<xref rid="ref-4" ref-type="bibr">Bakken
<italic>et al</italic>., 2017</xref>;
<xref rid="ref-5" ref-type="bibr">Bard
<italic>et al</italic>., 2005</xref>). Fortunately, the Cell Ontology is being developed for this purpose. This is particularly important as increasing numbers of signatures are expected to arise from initiatives like the Human Cell Atlas (
<xref rid="ref-19" ref-type="bibr">Rozenblatt-Rosen
<italic>et al</italic>., 2017</xref>). However, it is an open question how cell cluster annotation performance will be affected when using these eventual comprehensive cell type gene expression marker set databases, as we observed that many methods are highly sensitive in precision-recall analysis when used with larger cell type marker gene set databases that contain additional cell types not represented in a given scRNA-seq dataset. Future work will need to study confusion matrices of all methods and better quantify precision scores. We hope our open source benchmark code can be extended as a useful starting point for future work.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <sec>
      <title>Underlying data</title>
      <p>The datasets used in this study were processed from the following source data:</p>
      <p>Single cell RNA-sequencing data from liver cells. Accession number,
<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE115469">GSE115469</ext-link>.
<ext-link ext-link-type="uri" xlink:href="https://identifiers.org/geo/GSE115469">https://identifiers.org/geo/GSE115469</ext-link>.</p>
      <p>Single cell RNA-sequencing of retinal bipolar cells. Accession number,
<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE81905">GSE81905</ext-link>.
<ext-link ext-link-type="uri" xlink:href="https://identifiers.org/geo/GSE81905">https://identifiers.org/geo/GSE81905</ext-link>.</p>
      <p>Single cell RNA-sequencing of Tabula Muris. Accession number,
<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE109774">GSE109774</ext-link>.
<ext-link ext-link-type="uri" xlink:href="https://identifiers.org/geo/GSE109774">https://identifiers.org/geo/GSE109774</ext-link>.</p>
      <p>Single cell RNA-sequencing data from peripheral blood mononuclear cells using 10X Chromium technology. Accession number,
<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/SRX1723926">SRX1723926</ext-link>.
<ext-link ext-link-type="uri" xlink:href="https://identifiers.org/insdc.sra/SRX1723926">https://identifiers.org/insdc.sra/SRX1723926</ext-link>.</p>
      <p>Single cell RNA-sequencing data from peripheral blood mononuclear cells using Seq-Well technology. Accession number,
<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE92495">GSE92495</ext-link>.
<ext-link ext-link-type="uri" xlink:href="https://identifiers.org/geo/GSE92495">https://identifiers.org/geo/GSE92495</ext-link>.</p>
    </sec>
    <sec>
      <title>Extended data</title>
      <p>Zenodo: Supplementary data for “Evaluation of methods to assign cell type labels to cell clusters from single-cell RNA-sequencing data”.
<ext-link ext-link-type="uri" xlink:href="https://dx.doi.org/10.5281/zenodo.2575049">https://doi.org/10.5281/zenodo.2575049</ext-link> version 2.1.1(
<xref rid="ref-8" ref-type="bibr">Diaz-Mejia
<italic>et al</italic>., 2019a</xref>).</p>
      <p>This project contains the five processed scRNA-seq datasets—from liver cells (
<xref rid="ref-16" ref-type="bibr">MacParland
<italic>et al</italic>., 2018</xref>), retinal neurons (
<xref rid="ref-21" ref-type="bibr">Shekhar
<italic>et al</italic>., 2016b</xref>), Tabula Muris (
<xref rid="ref-31" ref-type="bibr">Tabula Muris Consortium
<italic>et al</italic>., 2018a</xref>), peripheral blood mononuclear cells using 10X (
<xref rid="ref-23" ref-type="bibr">Zheng
<italic>et al</italic>., 2017a</xref>) and Seq-Well (
<xref rid="ref-27" ref-type="bibr">Gierahn
<italic>et al</italic>., 2017a</xref>)—examined in this study.</p>
    </sec>
  </sec>
  <sec>
    <title>Software availability</title>
    <p>R and Perl scripts used to run and benchmark cell type labeling methods available from:
<ext-link ext-link-type="uri" xlink:href="https://github.com/jdime/scRNAseq_cell_cluster_labeling">https://github.com/jdime/scRNAseq_cell_cluster_labeling</ext-link>.</p>
    <p>Archived code at the time of publication:
<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.3350461">https://doi.org/10.5281/zenodo.3350461</ext-link> (
<xref rid="ref-9" ref-type="bibr">Diaz-Mejia
<italic>et al</italic>., 2019b</xref>).</p>
    <p>License:
<ext-link ext-link-type="uri" xlink:href="https://github.com/jdime/scRNAseq_cell_cluster_labeling/blob/master/LICENSE">MIT license</ext-link>.</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We are thankful to Jeff Liu and Brendan Innes from the Bader lab for advice processing the liver dataset and implementing GSVA; to Megan Crow for advice implementing MetaNeighbor; to Angela Pisco for giving us access to Tabula Muris cell type signatures; to Danielle Croucher and Laura Richards from the Pugh lab for feedback collecting benchmark datasets; and to Rene Quevedo from the Pugh lab for help implementing R scripts. Computations were performed on the Niagara supercomputer at the SciNet HPC Consortium. SciNet is funded by: the Canada Foundation for Innovation; the Government of Ontario; Ontario Research Fund - Research Excellence; and the University of Toronto.</p>
  </ack>
  <ref-list>
    <ref id="ref-26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abdelaal</surname><given-names>T</given-names></name><name><surname>Michielsen</surname><given-names>L</given-names></name><name><surname>Cats</surname><given-names>D</given-names></name><etal/></person-group>:
<article-title>A comparison of automatic cell identification methods for single-cell RNA-sequencing data.</article-title><source><italic toggle="yes">Genome Biol.</italic></source><year>2019</year>;<volume>20</volume>(<issue>1</issue>):<fpage>194</fpage>.
<pub-id pub-id-type="doi">10.1186/s13059-019-1795</pub-id><!--<pub-id pub-id-type="pmcid">6734286</pub-id>--><?supplied-pmid 31500660?><pub-id pub-id-type="pmid">31500660</pub-id></mixed-citation>
    </ref>
    <ref id="ref-1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alavi</surname><given-names>A</given-names></name><name><surname>Ruffalo</surname><given-names>M</given-names></name><name><surname>Parvangada</surname><given-names>A</given-names></name><etal/></person-group>:
<article-title>A web server for comparative analysis of single-cell RNA-seq data.</article-title><source><italic toggle="yes">Nat Commun.</italic></source><year>2018</year>;<volume>9</volume>(<issue>1</issue>):<fpage>4768</fpage>.
<pub-id pub-id-type="doi">10.1038/s41467-018-07165-2</pub-id><!--<pub-id pub-id-type="pmcid">6233170</pub-id>--><?supplied-pmid 30425249?><pub-id pub-id-type="pmid">30425249</pub-id></mixed-citation>
    </ref>
    <ref id="ref-2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alquicira-Hernandez</surname><given-names>J</given-names></name><name><surname>Nguyen</surname><given-names>Q</given-names></name><name><surname>Powell</surname><given-names>JE</given-names></name></person-group>:
<article-title>scPred: scPred: Cell type prediction at single-cell resolution.</article-title><source><italic toggle="yes">bioRxiv.</italic></source><year>2018</year><pub-id pub-id-type="doi">10.1101/369538</pub-id></mixed-citation>
    </ref>
    <ref id="ref-3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ashburner</surname><given-names>M</given-names></name><name><surname>Ball</surname><given-names>CA</given-names></name><name><surname>Blake</surname><given-names>JA</given-names></name><etal/></person-group>:
<article-title>Gene ontology: tool for the unification of biology. The Gene Ontology Consortium.</article-title><source><italic toggle="yes">Nat Genet.</italic></source><year>2000</year>;<volume>25</volume>(<issue>1</issue>):<fpage>25</fpage>–<lpage>29</lpage>.
<pub-id pub-id-type="doi">10.1038/75556</pub-id><!--<pub-id pub-id-type="pmcid">3037419</pub-id>--><?supplied-pmid 10802651?><pub-id pub-id-type="pmid">10802651</pub-id></mixed-citation>
    </ref>
    <ref id="ref-4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bakken</surname><given-names>T</given-names></name><name><surname>Cowell</surname><given-names>L</given-names></name><name><surname>Aevermann</surname><given-names>BD</given-names></name><etal/></person-group>:
<article-title>Cell type discovery and representation in the era of high-content single cell phenotyping.</article-title><source><italic toggle="yes">BMC Bioinformatics.</italic></source><year>2017</year>;<volume>18</volume>(<issue>Suppl 17</issue>):<fpage>559</fpage>.
<pub-id pub-id-type="doi">10.1186/s12859-017-1977-1</pub-id><!--<pub-id pub-id-type="pmcid">5763450</pub-id>--><?supplied-pmid 29322913?><pub-id pub-id-type="pmid">29322913</pub-id></mixed-citation>
    </ref>
    <ref id="ref-5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bard</surname><given-names>J</given-names></name><name><surname>Rhee</surname><given-names>SY</given-names></name><name><surname>Ashburner</surname><given-names>M</given-names></name></person-group>:
<article-title>An ontology for cell types.</article-title><source><italic toggle="yes">Genome Biol.</italic></source><year>2005</year>;<volume>6</volume>(<issue>2</issue>):<fpage>R21</fpage>.
<pub-id pub-id-type="doi">10.1186/gb-2005-6-2-r21</pub-id><!--<pub-id pub-id-type="pmcid">551541</pub-id>--><?supplied-pmid 15693950?><pub-id pub-id-type="pmid">15693950</pub-id></mixed-citation>
    </ref>
    <ref id="ref-6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Butler</surname><given-names>A</given-names></name><name><surname>Hoffman</surname><given-names>P</given-names></name><name><surname>Smibert</surname><given-names>P</given-names></name><etal/></person-group>:
<article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species.</article-title><source><italic toggle="yes">Nat Biotechnol.</italic></source><year>2018</year>;<volume>36</volume>(<issue>5</issue>):<fpage>411</fpage>–<lpage>420</lpage>.
<pub-id pub-id-type="doi">10.1038/nbt.4096</pub-id><!--<pub-id pub-id-type="pmcid">6700744</pub-id>--><?supplied-pmid 29608179?><pub-id pub-id-type="pmid">29608179</pub-id></mixed-citation>
    </ref>
    <ref id="ref-7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crow</surname><given-names>M</given-names></name><name><surname>Paul</surname><given-names>A</given-names></name><name><surname>Ballouz</surname><given-names>S</given-names></name><etal/></person-group>:
<article-title>Characterizing the replicability of cell types defined by single cell RNA-sequencing data using MetaNeighbor.</article-title><source><italic toggle="yes">Nat Commun.</italic></source><year>2018</year>;<volume>9</volume>(<issue>1</issue>):<fpage>884</fpage>.
<pub-id pub-id-type="doi">10.1038/s41467-018-03282-0</pub-id><!--<pub-id pub-id-type="pmcid">5830442</pub-id>--><?supplied-pmid 29491377?><pub-id pub-id-type="pmid">29491377</pub-id></mixed-citation>
    </ref>
    <ref id="ref-8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Diaz-Mejia</surname><given-names>JJ</given-names></name><etal/></person-group>:
<article-title>Supplementary data for ‘Evaluation of methods to assign cell type labels to cell clusters from single-cell RNA-sequencing data’ (Diaz-Mejia JJ,
<italic>et al.</italic>, 2019)</article-title>.<year>2019a</year>; [Accessed February 21, 2019].
<pub-id pub-id-type="doi">10.5281/zenodo.2575049</pub-id></mixed-citation>
    </ref>
    <ref id="ref-9">
      <mixed-citation publication-type="data"><person-group person-group-type="author"><name><surname>Diaz-Mejia</surname><given-names>JJ</given-names></name><etal/></person-group>:
<article-title>Supplementary code for “Evaluation of methods to assign cell type labels to cell clusters from single-cell RNA-sequencing data” (Diaz-Mejia JJ
<italic>et al.</italic>, 2019) (Version v2.0).</article-title><source><italic toggle="yes">Zenodo.</italic></source><year>2019b</year><pub-id pub-id-type="doi">10.5281/zenodo.3350461</pub-id></mixed-citation>
    </ref>
    <ref id="ref-10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duò</surname><given-names>A</given-names></name><name><surname>Robinson</surname><given-names>MD</given-names></name><name><surname>Soneson</surname><given-names>C</given-names></name></person-group>:
<article-title>A systematic performance evaluation of clustering methods for single-cell RNA-seq data [version 1; referees: 2 approved with reservations].</article-title><source><italic toggle="yes">F1000Res.</italic></source><year>2018</year>;<volume>7</volume>:<fpage>1141</fpage>.
<pub-id pub-id-type="doi">10.12688/f1000research.15666.1</pub-id><!--<pub-id pub-id-type="pmcid">6134335</pub-id>--><?supplied-pmid 30271584?><pub-id pub-id-type="pmid">30271584</pub-id></mixed-citation>
    </ref>
    <ref id="ref-11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fisher</surname><given-names>RA</given-names></name></person-group>:
<article-title>The Logic of Inductive Inference.</article-title><source><italic toggle="yes">J R Stat Soc.</italic></source><year>1935</year>;<volume>98</volume>(<issue>1</issue>):<fpage>39</fpage>–<lpage>82</lpage>.
<pub-id pub-id-type="doi">10.2307/2342435</pub-id></mixed-citation>
    </ref>
    <ref id="ref-12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Freytag</surname><given-names>S</given-names></name><name><surname>Tian</surname><given-names>L</given-names></name><name><surname>Lönnstedt</surname><given-names>I</given-names></name><etal/></person-group>:
<article-title>Comparison of clustering tools in R for medium-sized 10x Genomics single-cell RNA-sequencing data [version 1; referees: 1 approved, 2 approved with reservations].</article-title><source><italic toggle="yes">F1000Res.</italic></source><year>2018</year>;<volume>7</volume>:<fpage>1297</fpage>.
<pub-id pub-id-type="doi">10.12688/f1000research.15809.1</pub-id><!--<pub-id pub-id-type="pmcid">6124389</pub-id>--><?supplied-pmid 30228881?><pub-id pub-id-type="pmid">30228881</pub-id></mixed-citation>
    </ref>
    <ref id="ref-13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goeman</surname><given-names>JJ</given-names></name><name><surname>Bühlmann</surname><given-names>P</given-names></name></person-group>:
<article-title>Analyzing gene expression data in terms of gene sets: methodological issues.</article-title><source><italic toggle="yes">Bioinformatics.</italic></source><year>2007</year>;<volume>23</volume>(<issue>8</issue>):<fpage>980</fpage>–<lpage>987</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btm051</pub-id><?supplied-pmid 17303618?><pub-id pub-id-type="pmid">17303618</pub-id></mixed-citation>
    </ref>
    <ref id="ref-27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gierahn</surname><given-names>TM</given-names></name><name><surname>Wadsworth</surname><given-names>MH</given-names><suffix>2nd</suffix></name><name><surname>Hughes</surname><given-names>TK</given-names></name><etal/></person-group>:
<article-title>Seq-Well: portable, low-cost RNA sequencing of single cells at high throughput.</article-title><source><italic toggle="yes">Nat Methods.</italic></source><year>2017a</year>;<volume>14</volume>(<issue>4</issue>):<fpage>395</fpage>–<lpage>398</lpage>.
<pub-id pub-id-type="doi">10.1038/nmeth.4179</pub-id><!--<pub-id pub-id-type="pmcid">5376227</pub-id>--><?supplied-pmid 28192419?><pub-id pub-id-type="pmid">28192419</pub-id></mixed-citation>
    </ref>
    <ref id="ref-28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gierahn</surname><given-names>TM</given-names></name><name><surname>Wadsworth</surname><given-names>MH</given-names></name><name><surname>Hughes</surname><given-names>TK</given-names></name><etal/></person-group>:
<article-title>Seq-Well: portable, low-cost RNA sequencing of single cells at high throughput.</article-title><source><italic toggle="yes">scRNA-seq measurements and clusters metadata.</italic></source><year>2017b</year><ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE92495">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hänzelmann</surname><given-names>S</given-names></name><name><surname>Castelo</surname><given-names>R</given-names></name><name><surname>Guinney</surname><given-names>J</given-names></name></person-group>:
<article-title>GSVA: gene set variation analysis for microarray and RNA-seq data.</article-title><source><italic toggle="yes">BMC Bioinformatics.</italic></source><year>2013</year>;<volume>14</volume>:<fpage>7</fpage>.
<pub-id pub-id-type="doi">10.1186/1471-2105-14-7</pub-id><!--<pub-id pub-id-type="pmcid">3618321</pub-id>--><?supplied-pmid 23323831?><pub-id pub-id-type="pmid">23323831</pub-id></mixed-citation>
    </ref>
    <ref id="ref-15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Innes</surname><given-names>BT</given-names></name><name><surname>Bader</surname><given-names>GD</given-names></name></person-group>:
<article-title>scClustViz – Single-cell RNAseq cluster assessment and visualization [version 1; referees: 2 approved with reservations].</article-title><source><italic toggle="yes">F1000Res.</italic></source><year>2019</year>;<volume>7</volume>:<fpage>1522</fpage><pub-id pub-id-type="doi">10.12688/f1000research.16198.2</pub-id></mixed-citation>
    </ref>
    <ref id="ref-16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>MacParland</surname><given-names>SA</given-names></name><name><surname>Liu</surname><given-names>JC</given-names></name><name><surname>Ma</surname><given-names>XZ</given-names></name><etal/></person-group>:
<article-title>Single cell RNA sequencing of human liver reveals distinct intrahepatic macrophage populations.</article-title><source><italic toggle="yes">Nat Commun.</italic></source><year>2018</year>;<volume>9</volume>(<issue>1</issue>): 4383.
<pub-id pub-id-type="doi">10.1038/s41467-018-06318-7</pub-id><!--<pub-id pub-id-type="pmcid">6197289</pub-id>--><?supplied-pmid 30348985?><pub-id pub-id-type="pmid">30348985</pub-id></mixed-citation>
    </ref>
    <ref id="ref-29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Monaco</surname><given-names>G</given-names></name><name><surname>Lee</surname><given-names>B</given-names></name><name><surname>Xu</surname><given-names>W</given-names></name><etal/></person-group>:
<article-title>RNA-Seq Signatures Normalized by mRNA Abundance Allow Absolute Deconvolution of Human Immune Cell Types.</article-title><source><italic toggle="yes">Cell Rep.</italic></source><year>2019</year>;<volume>26</volume>(<issue>6</issue>):<fpage>1627</fpage>–<lpage>1640</lpage>.e7.
<pub-id pub-id-type="doi">10.1016/j.celrep.2019.01.041</pub-id><!--<pub-id pub-id-type="pmcid">6367568</pub-id>--><?supplied-pmid 30726743?><pub-id pub-id-type="pmid">30726743</pub-id></mixed-citation>
    </ref>
    <ref id="ref-17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Newman</surname><given-names>AM</given-names></name><name><surname>Liu</surname><given-names>CL</given-names></name><name><surname>Green</surname><given-names>MR</given-names></name><etal/></person-group>:
<article-title>Robust enumeration of cell subsets from tissue expression profiles.</article-title><source><italic toggle="yes">LM22 signature.</italic></source><year>2015a</year><ext-link ext-link-type="uri" xlink:href="https://cibersort.stanford.edu/download.php">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Newman</surname><given-names>AM</given-names></name><name><surname>Liu</surname><given-names>CL</given-names></name><name><surname>Green</surname><given-names>MR</given-names></name><etal/></person-group>:
<article-title>Robust enumeration of cell subsets from tissue expression profiles.</article-title><source><italic toggle="yes">Nat Methods.</italic></source><year>2015b</year>;<volume>12</volume>(<issue>5</issue>):<fpage>453</fpage>–<lpage>457</lpage>.
<pub-id pub-id-type="doi">10.1038/nmeth.3337</pub-id><!--<pub-id pub-id-type="pmcid">4739640</pub-id>--><?supplied-pmid 25822800?><pub-id pub-id-type="pmid">25822800</pub-id></mixed-citation>
    </ref>
    <ref id="ref-30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ponce</surname><given-names>M</given-names></name><name><surname>van Zon</surname><given-names>R</given-names></name><name><surname>Northrup</surname><given-names>S</given-names></name><etal/></person-group>:
<article-title>Deploying a Top-100 Supercomputer for Large Parallel Workloads: the Niagara Supercomputer.</article-title><source><italic toggle="yes">PEARC'19 Proceedings.</italic></source><year>2019</year><pub-id pub-id-type="doi">10.1145/3332186.3332195</pub-id></mixed-citation>
    </ref>
    <ref id="ref-19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rozenblatt-Rosen</surname><given-names>O</given-names></name><name><surname>Stubbington</surname><given-names>MJT</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><etal/></person-group>:
<article-title>The Human Cell Atlas: from vision to reality.</article-title><source><italic toggle="yes">Nature.</italic></source><year>2017</year>;<volume>550</volume>(<issue>7677</issue>):<fpage>451</fpage>–<lpage>453</lpage>.
<pub-id pub-id-type="doi">10.1038/550451a</pub-id><?supplied-pmid 29072289?><pub-id pub-id-type="pmid">29072289</pub-id></mixed-citation>
    </ref>
    <ref id="ref-20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shekhar</surname><given-names>K</given-names></name><name><surname>Lapan</surname><given-names>SW</given-names></name><name><surname>Whitney</surname><given-names>IE</given-names></name><etal/></person-group>:
<article-title>Comprehensive Classification of Retinal Bipolar Neurons by Single-Cell Transcriptomics</article-title>.<year>2016a</year><ext-link ext-link-type="uri" xlink:href="https://portals.broadinstitute.org/single_cell/study/retinal-bipolar-neuron-drop-seq">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shekhar</surname><given-names>K</given-names></name><name><surname>Lapan</surname><given-names>SW</given-names></name><name><surname>Whitney</surname><given-names>IE</given-names></name><etal/></person-group>:
<article-title>Comprehensive Classification of Retinal Bipolar Neurons by Single-Cell Transcriptomics.</article-title><source><italic toggle="yes">Cell.</italic></source><year>2016b</year>;<volume>166</volume>(<issue>5</issue>):<fpage>1308</fpage>–<lpage>1323.e30</lpage>.
<pub-id pub-id-type="doi">10.1016/j.cell.2016.07.054</pub-id><!--<pub-id pub-id-type="pmcid">5003425</pub-id>--><?supplied-pmid 27565351?><pub-id pub-id-type="pmid">27565351</pub-id></mixed-citation>
    </ref>
    <ref id="ref-22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Subramanian</surname><given-names>A</given-names></name><name><surname>Tamayo</surname><given-names>P</given-names></name><name><surname>Mootha</surname><given-names>VK</given-names></name><etal/></person-group>:
<article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles.</article-title><source><italic toggle="yes">Proc Natl Acad Sci U S A.</italic></source><year>2005</year>;<volume>102</volume>(<issue>43</issue>):<fpage>15545</fpage>–<lpage>15550</lpage>.
<pub-id pub-id-type="doi">10.1073/pnas.0506580102</pub-id><!--<pub-id pub-id-type="pmcid">1239896</pub-id>--><?supplied-pmid 16199517?><pub-id pub-id-type="pmid">16199517</pub-id></mixed-citation>
    </ref>
    <ref id="ref-31">
      <mixed-citation publication-type="journal"><collab>Tabula Muris Consortium, </collab><collab>Overall coordination, </collab><collab>Logistical coordination</collab>:
<etal/><article-title>Single-cell transcriptomics of 20 mouse organs creates a
<italic>Tabula Muris</italic>.</article-title><source><italic toggle="yes">Nature.</italic></source><year>2018a</year>;<volume>562</volume>(<issue>7727</issue>):<fpage>367</fpage>–<lpage>372</lpage>.
<pub-id pub-id-type="doi">10.1038/s41586-018-0590-4</pub-id><!--<pub-id pub-id-type="pmcid">6642641</pub-id>--><?supplied-pmid 30283141?><pub-id pub-id-type="pmid">30283141</pub-id></mixed-citation>
    </ref>
    <ref id="ref-32">
      <mixed-citation publication-type="journal"><collab>Tabula Muris Consortium</collab>:
<article-title>Single-cell transcriptomics of 20 mouse organs creates a Tabula Muris.</article-title><source><italic toggle="yes">scRNA-seq measurements, tissues and clusters metadata.</italic></source><year>2018b</year><pub-id pub-id-type="doi">10.6084/m9.figshare.5968960.v2</pub-id></mixed-citation>
    </ref>
    <ref id="ref-33">
      <mixed-citation publication-type="journal"><collab>Tabula Muris Consortium</collab>:
<article-title>Single-cell transcriptomics of 20 mouse organs creates a Tabula Muris.</article-title><source><italic toggle="yes">Cell type signatures.</italic></source><year>2018c</year><ext-link ext-link-type="uri" xlink:href="https://github.com/czbiohub/tabula-muris">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-34">
      <mixed-citation publication-type="journal"><collab>Tabula Muris Consortium</collab>:
<article-title>A Single Cell Transcriptomic Atlas Characterizes Aging Tissues in the Mouse.</article-title><source><italic toggle="yes">bioRxiv.</italic></source><year>2019</year><pub-id pub-id-type="doi">10.1101/661728</pub-id></mixed-citation>
    </ref>
    <ref id="ref-23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zheng</surname><given-names>GX</given-names></name><name><surname>Terry</surname><given-names>JM</given-names></name><name><surname>Belgrader</surname><given-names>P</given-names></name><etal/></person-group>:
<article-title>Massively parallel digital transcriptional profiling of single cells.</article-title><source><italic toggle="yes">Nat Commun.</italic></source><year>2017a</year>;<volume>8</volume>: 14049.
<pub-id pub-id-type="doi">10.1038/ncomms14049</pub-id><!--<pub-id pub-id-type="pmcid">5241818</pub-id>--><?supplied-pmid 28091601?><pub-id pub-id-type="pmid">28091601</pub-id></mixed-citation>
    </ref>
    <ref id="ref-24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zheng</surname><given-names>GXY</given-names></name><name><surname>Terry</surname><given-names>JM</given-names></name><name><surname>Belgrader</surname><given-names>P</given-names></name><etal/></person-group>:
<article-title>Fresh 68k PBMCs (Donor A)</article-title>.<year>2017b</year><ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.1.0/fresh_68k_pbmc_donor_a">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zheng</surname><given-names>GXY</given-names></name><name><surname>Terry</surname><given-names>JM</given-names></name><name><surname>Belgrader</surname><given-names>P</given-names></name><etal/></person-group>:
<article-title>Single Cell RNA-seq Secondary Analysis of 68k PBMCs</article-title>.<year>2017c</year><ext-link ext-link-type="uri" xlink:href="https://github.com/10XGenomics/single-cell-3prime-paper/tree/master/pbmc68k_analysis">Reference Source</ext-link></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="report55093" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.22823.r55093</article-id>
    <title-group>
      <article-title>Reviewer response for version 3</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Freytag</surname>
          <given-names>Saskia</given-names>
        </name>
        <xref ref-type="aff" rid="r55093a1">1</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-2185-7068</contrib-id>
      </contrib>
      <aff id="r55093a1"><label>1</label>Epigenetics and Genomics, Harry Perkins Institute of Medical Research, Nedlands, WA, Australia</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2019 Freytag S</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" id="d35e3280" ext-link-type="doi" xlink:href="10.12688/f1000research.18490.3">Version 3</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>The authors have cleared all my concerns.</p>
    <p>I confirm that I have read this submission and believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
</sub-article>
<sub-article id="report52981" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.22108.r52981</article-id>
    <title-group>
      <article-title>Reviewer response for version 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Andrews</surname>
          <given-names>Tallulah</given-names>
        </name>
        <xref ref-type="aff" rid="r52981a2">2</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-1120-2196</contrib-id>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lee</surname>
          <given-names>Jimmy Tsz Hang</given-names>
        </name>
        <xref ref-type="aff" rid="r52981a1">1</xref>
        <role>Co-referee</role>
      </contrib>
      <aff id="r52981a1"><label>1</label>Wellcome Sanger Institute, Hixton, UK</aff>
      <aff id="r52981a2"><label>2</label>Wellcome Sanger Institute, Hinxton, UK</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>9</month>
      <year>2019</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2019 Lee JTH and Andrews T</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" id="d35e3354" ext-link-type="doi" xlink:href="10.12688/f1000research.18490.2">Version 2</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>The authors have significantly improved the article and I believe it to be a valuable contribution to the literature. All my concerns have been addressed.</p>
    <p>We confirm that we have read this submission and believe that we have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
</sub-article>
<sub-article id="report52982" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.22108.r52982</article-id>
    <title-group>
      <article-title>Reviewer response for version 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Freytag</surname>
          <given-names>Saskia</given-names>
        </name>
        <xref ref-type="aff" rid="r52982a1">1</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-2185-7068</contrib-id>
      </contrib>
      <aff id="r52982a1"><label>1</label>Epigenetics and Genomics, Harry Perkins Institute of Medical Research, Nedlands, WA, Australia</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>30</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2019 Freytag S</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" id="d35e3413" ext-link-type="doi" xlink:href="10.12688/f1000research.18490.2">Version 2</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve-with-reservations</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>The authors have addressed most of my concerns, however I still do not fully understand why other specialized approaches for assigning labels to single cells. In fact there has been a recent publication in bioRvix of automatic single cell identification methods for single cell RNA-sequencing data
<sup><xref rid="rep-ref-52982-1" ref-type="bibr">1</xref></sup>. I think it would be important to clarify this and acknowledge this paper.</p>
    <p>I confirm that I have read this submission and believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however I have significant reservations, as outlined above.</p>
  </body>
  <back>
    <ref-list>
      <title>References</title>
      <ref id="rep-ref-52982-1">
        <label>1</label>
        <mixed-citation publication-type="journal">
:
<article-title>A comparison of automatic cell identification methods for single-cell RNA-sequencing data</article-title>.
<source><italic toggle="yes">bioRxiv</italic></source>.<year>2019</year>;
<elocation-id>10.1101/644435</elocation-id>
<pub-id pub-id-type="doi">10.1101/644435</pub-id>
</mixed-citation>
      </ref>
    </ref-list>
  </back>
  <sub-article id="comment4959" article-type="response">
    <front-stub>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Diaz-Mejia</surname>
            <given-names>J. Javier</given-names>
          </name>
          <aff>University Health Network, Canada, Canada</aff>
        </contrib>
      </contrib-group>
      <author-notes>
        <fn fn-type="COI-statement">
          <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="epub">
        <day>7</day>
        <month>10</month>
        <year>2019</year>
      </pub-date>
    </front-stub>
    <body>
      <p>
        <italic>R1-Q1) The authors have addressed most of my concerns, however I still do not fully understand why other specialized approaches for assigning labels to single cells. In fact there has been a recent publication in bioRvix of automatic single cell identification methods for single cell RNA-sequencing data1. I think it would be important to clarify this and acknowledge this paper.</italic>
      </p>
      <p>
        <italic>References</italic>
      </p>
      <p>
        <italic>1. Abdelaal T, Michielsen L, Cats D, Hoogduin D, Mei H, Reinders M, Mahfouz A: A comparison of automatic cell identification methods for single-cell RNA-sequencing data. bioRxiv. 2019. Publisher Full Text</italic>
      </p>
      <p>R1-A1) We had previously cited this paper in our discussion section (that paper is now published in Genome Biology). Our evaluation results are complementary. The main difference is that Abdelaal
<italic>et al</italic>. evaluate methods that assign cell type labels to each single cell in a data set while we evaluate methods that assign cell type labels to clusters of similar cells. While these use cases seem similar enough, methods designed for one case cannot be easily run on the other case and the evaluation methods of Abdelaal
<italic>et al</italic>. and our paper are fundamentally different and incompatible. In particular, Abdelaal
<italic>et al</italic>. use a cross-validation approach where they split a data set into two sets of single cells, then apply the methods to both and compare the results. For example, if there are 1000 cells in a scRNA-seq dataset, Abdelaal
<italic>et al</italic>. (2019) would split the data into 200 cell parts, then for a given fold, they would take 80% of the data (800 cells) to train each method and test (annotate) the remaining 200 cells; and compare the 200 cell annotations against the labels provided by the authors of the original scRNA-seq dataset. It is not possible to apply this method at the cell cluster level because a cluster represents a single object defined by a single vector capturing the average expression levels of all genes across all cells in the cluster. We also can’t change our clusters in any way because they have been expertly defined and annotated to specific cell types - any change will invalidate this expert annotation. These differences evaluating cell cluster vs. individual cell methods are the reason why it was challenging to incorporate MetaNeighbor into our analysis, requiring source code modifications and extensive communication with the tool authors. Ultimately, the field will be well served by having two complementary benchmark papers, with Abdelaal
<italic>et al</italic>. focusing on individual cell classification methods and ours focusing on cluster classification methods. We have clarified this in our updated manuscript.</p>
    </body>
  </sub-article>
</sub-article>
<sub-article id="report45813" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.20232.r45813</article-id>
    <title-group>
      <article-title>Reviewer response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Cowell</surname>
          <given-names>Lindsay</given-names>
        </name>
        <xref ref-type="aff" rid="r45813a1">1</xref>
        <role>Referee</role>
      </contrib>
      <aff id="r45813a1"><label>1</label>Department of Population and Data Sciences, University of Texas Southwestern Medical Center, Dallas, TX, USA</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>4</month>
      <year>2019</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2019 Cowell L</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" id="d35e3560" ext-link-type="doi" xlink:href="10.12688/f1000research.18490.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve-with-reservations</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>The authors address an important problem, which is the need for systematic and reproducible approaches for assigning cell type labels based on single cell transcriptome data. They use three data sets with gold standard cell type annotations available and compare the performance of four computational tools on these data sets. The authors measure performance using ROC curves and plots of precision versus recall. They also assess performance over subsamples of the data used as reference gene expression patterns for cell types (either cell type-specific gene sets or cell type-specific expression profiles). In general, they found that all four methods perform reasonably well, although ORA and GSVA perform more consistently well across the three data sets. I do have some questions about the details of how the work was done. The answers to these questions are important for interpreting the results, reproducing the work, or extending it to include additional tools.
<list list-type="order"><list-item><p>Presumably the approach to creating the cell clusters, and how dense versus diffuse the clusters are, can have an impact on performance and confidence in the output?</p></list-item><list-item><p>How exactly were clusters mapped to cell types? From Figure 1E, it appears that each of the four tools generates a numerical vector for each cell type that contains a score for each cluster, presumably corresponding to the likelihood that that cluster is of the corresponding cell type.
<list list-type="bullet"><list-item><p>Is a cluster always assigned to the cell type corresponding to its highest score? (presumably yes).</p></list-item><list-item><p>In the example, each cell type and each cluster has only a single high score with all other scores being very small. What is the distribution of scores typically? Do clusters sometimes have multiple high scores? Were ties ever observed?</p></list-item><list-item><p>Can multiple clusters map to the same cell type?</p></list-item><list-item><p>Must a cluster be assigned to a cell type? Or could some remain unassigned?</p></list-item></list>
</p></list-item><list-item><p>How were the performance curves generated? What parameter was varied?</p></list-item></list>
</p>
    <p>I confirm that I have read this submission and believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however I have significant reservations, as outlined above.</p>
  </body>
  <sub-article id="comment4845" article-type="response">
    <front-stub>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Diaz-Mejia</surname>
            <given-names>J. Javier</given-names>
          </name>
          <aff>University Health Network, Canada, Canada</aff>
        </contrib>
      </contrib-group>
      <author-notes>
        <fn fn-type="COI-statement">
          <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="epub">
        <day>17</day>
        <month>8</month>
        <year>2019</year>
      </pub-date>
    </front-stub>
    <body>
      <p>
        <italic><bold>R3-Q1)</bold> Presumably the approach to creating the cell clusters, and how dense versus diffuse the clusters are, can have an impact on performance and confidence in the output?</italic>
      </p>
      <p><bold>R3-A1)</bold> We agree that cluster density and other structure in the data will likely impact automatic cluster annotation performance. Investigating the relationship between a given structure in the data (e.g. density vs. sparseness) and performance would require simulations that may not be realistic. Thus, we limited our analysis to published data with available gold standards. We have now added this point to the discussion.</p>
      <p>
        <italic>
          <bold>R3-Q2) </bold>
        </italic>
      </p>
      <p>
        <italic>[a] How exactly were clusters mapped to cell types? From Figure 1E, it appears that each of the four tools generates a numerical vector for each cell type that contains a score for each cluster, presumably corresponding to the likelihood that that cluster is of the corresponding cell type.</italic>
      </p>
      <p>
        <italic>[b] Is a cluster always assigned to the cell type corresponding to its highest score? (presumably yes).</italic>
      </p>
      <p>
        <italic>[c] In the example, each cell type and each cluster has only a single high score with all other scores being very small. What is the distribution of scores typically? Do clusters sometimes have multiple high scores? Were ties ever observed?</italic>
      </p>
      <p>
        <italic>[d] Can multiple clusters map to the same cell type?</italic>
      </p>
      <p>
        <italic>[e] Must a cluster be assigned to a cell type? Or could some remain unassigned?</italic>
      </p>
      <p>
        <bold>R3-A2)</bold>
      </p>
      <p>[a] Correct, each tool generates a numerical vector as the reviewer describes.</p>
      <p>[b] Yes, a cluster is always assigned to the cell type corresponding to its highest score.</p>
      <p>[c] In the methods that we compared, each cell cluster vs. each cell type receives only one score. As can be observed in our new Figure 6E, most cell clusters which were incorrectly classified (i.e. that were not the top-1 ranked prediction) still had top-ranks (ticker distribution in the violin plots closer to the top-1 ranks), which indicates that some clusters can have multiple high scores.  We found that 118 out of all 1,276 (9.2%) cell cluster labeling predictions we ran showed ties in the top-score: 65 of the 118 ties (68%) corresponded to METANEIGHBOR ‘binary, 24 (20%) to ORA, 15 (13%) to METANEIGHBOR ‘continuous’, 10 (8%) to GSEA, and 4 (3%) to GSVA. None of the CIBERSORT analyses showed ties.</p>
      <p>[d] Yes, multiple clusters can map to the same cell type and this is particularly the case for the newly incorporated Tabula Muris dataset, where 130 cell clusters map to 53 cell types. This doesn’t affect our evaluation because a method is not penalized for predicting that multiple clusters have the same cell type annotation.</p>
      <p>[e] Yes, a cluster must be assigned a cell type in our case because all clusters have a cell type assignment in our gold standards. In the case of the newly incorporated PBMC-SeqWell data (Gierahn
<italic>et al</italic>., 2017), some of the cell clusters were labeled as ‘Removed_’ by the authors, and they didn’t classify those clusters into cell types, thus we did not include these in our analysis.</p>
      <p>As mentioned above in response to reviewers 1 and 2, we’ve updated the Methods section “Implementation of tested methods and transformation of enrichment metrics for ROC and PR analyses” to clarify all of these points.</p>
      <p>
        <italic><bold>R3-Q3)</bold> How were the performance curves generated? What parameter was varied?</italic>
      </p>
      <p><bold>R3-A3)</bold> As mentioned above in response to reviewers 1 and 2, we’ve updated the Methods section “Implementation of tested methods and transformation of enrichment metrics for ROC and PR analyses” to clarify this. For each dataset, we combine all cell type gene set prediction scores for a method across all clusters into one column and vary the prediction score threshold to compute the ROC and PR curves.</p>
    </body>
  </sub-article>
</sub-article>
<sub-article id="report45811" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.20232.r45811</article-id>
    <title-group>
      <article-title>Reviewer response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Andrews</surname>
          <given-names>Tallulah</given-names>
        </name>
        <xref ref-type="aff" rid="r45811a2">2</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-1120-2196</contrib-id>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lee</surname>
          <given-names>Jimmy Tsz Hang</given-names>
        </name>
        <xref ref-type="aff" rid="r45811a1">1</xref>
        <role>Co-referee</role>
      </contrib>
      <aff id="r45811a1"><label>1</label>Wellcome Sanger Institute, Hixton, UK</aff>
      <aff id="r45811a2"><label>2</label>Wellcome Sanger Institute, Hinxton, UK</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>22</day>
      <month>3</month>
      <year>2019</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2019 Lee JTH and Andrews T</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" id="d35e3761" ext-link-type="doi" xlink:href="10.12688/f1000research.18490.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve-with-reservations</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>Diaz-Mejia et al. test the ability of four different algorithms to correctly annotate a set of clusters identified in single-cell RNA-seq data. They find that GSVA tends to be the most accurate and fastest method, interestingly they find ORA and GSVA are much more robust to small numbers of marker genes than GSEA or CIBERSORT. This is a very useful and timely study, as manual annotation of cell-types is currently the main bottleneck when analyzing single-cell RNA-seq data.</p>
    <p> Comments:
<list list-type="order"><list-item><p>It was unclear to me how the accuracy of the classification methods was evaluated. What was the gold standard truth used for each dataset? Were clusters assigned to (a) the single cell-type for which they had the greatest score or (b) all cell-types where their score exceeded some threshold, or (c) to the single cell-type for which they had the greatest score provided that score was above some threshold or another approach? This is crucial to interpreting the PR and ROC curves presented in the results.</p><p> Based on the first sentence of the “Precision-Recall curve analysis” section: I inferred you to be using method (c), but using such a method should not necessarily lead to recall values of 1 as clusters which are more similar to an incorrect cell-type than to the correct cell-type would never become true positives. Thus, I had inferred you to be using method (b) based on Figure 2. It would be very helpful to add a section to the Methods explaining precisely how the accuracy was evaluated.</p></list-item><list-item><p>In addition, I suggest adding figures/tables for the accuracy of each classification approach (% of clusters correctly assigned) when all clusters are simply assigned to the cell-type for which they have the highest score, since I expect this to be the most common approach users of these classifications would take.</p></list-item><list-item><p>The main weakness of the paper, as the authors admit, is the small number of datasets used to test the classification methods, particularly since the variability in performance between datasets was high. It would be useful to show reproducibility of the results in additional datasets.</p><p> We acknowledge identifying marker gene lists for many different tissues can be very time consuming, there are datasets similar to those the authors have already have markers for that they could use. E.g. mouse retina: Shekhar et al. 2016
<sup><xref rid="rep-ref-45811-1" ref-type="bibr">1</xref></sup>, PBMCs: Gierahn et al. 2017 (Seq-Well)
<sup><xref rid="rep-ref-45811-2" ref-type="bibr">2</xref></sup>. Alternatively, they could do cross-comparisons using the two mouse cell atlas (Tabula Muris
<sup><xref rid="rep-ref-45811-3" ref-type="bibr">3</xref></sup> and Mouse Cell Atlas
<sup><xref rid="rep-ref-45811-4" ref-type="bibr">4</xref></sup>). Or use datasets such as Pollen et al., 2014
<sup><xref rid="rep-ref-45811-5" ref-type="bibr">5</xref></sup> where gold-standard cell-type identity is known by design.</p></list-item><list-item><p>The authors show that performance degrades when small numbers of marker genes are used by the classifiers. Is it the case that more marker genes is always better or does performance also degrade if too many genes are used?</p></list-item></list>
</p>
    <p>We confirm that we have read this submission and believe that we have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however we have significant reservations, as outlined above.</p>
  </body>
  <back>
    <ref-list>
      <title>References</title>
      <ref id="rep-ref-45811-1">
        <label>1</label>
        <mixed-citation publication-type="journal">
:
<article-title>Comprehensive Classification of Retinal Bipolar Neurons by Single-Cell Transcriptomics.</article-title>
<source><italic toggle="yes">Cell</italic></source>.<year>2016</year>;<volume>166</volume>(<issue>5</issue>) :
<elocation-id>10.1016/j.cell.2016.07.054</elocation-id>
<fpage>1308</fpage>-<lpage>1323.e30</lpage>
<pub-id pub-id-type="doi">10.1016/j.cell.2016.07.054</pub-id>
<?supplied-pmid 27565351?><pub-id pub-id-type="pmid">27565351</pub-id></mixed-citation>
      </ref>
      <ref id="rep-ref-45811-2">
        <label>2</label>
        <mixed-citation publication-type="journal">
:
<article-title>Seq-Well: portable, low-cost RNA sequencing of single cells at high throughput.</article-title>
<source><italic toggle="yes">Nat Methods</italic></source>.<year>2017</year>;<volume>14</volume>(<issue>4</issue>) :
<elocation-id>10.1038/nmeth.4179</elocation-id>
<fpage>395</fpage>-<lpage>398</lpage>
<pub-id pub-id-type="doi">10.1038/nmeth.4179</pub-id>
<?supplied-pmid 28192419?><pub-id pub-id-type="pmid">28192419</pub-id></mixed-citation>
      </ref>
      <ref id="rep-ref-45811-3">
        <label>3</label>
        <mixed-citation publication-type="journal">
:
<article-title>Single-cell transcriptomics of 20 mouse organs creates a Tabula Muris.</article-title>
<source><italic toggle="yes">Nature</italic></source>.<volume>562</volume>(<issue>7727</issue>) :
<elocation-id>10.1038/s41586-018-0590-4</elocation-id>
<fpage>367</fpage>-<lpage>372</lpage>
<pub-id pub-id-type="doi">10.1038/s41586-018-0590-4</pub-id>
<?supplied-pmid 30283141?><pub-id pub-id-type="pmid">30283141</pub-id></mixed-citation>
      </ref>
      <ref id="rep-ref-45811-4">
        <label>4</label>
        <mixed-citation publication-type="journal">
:
<article-title>Mapping the Mouse Cell Atlas by Microwell-Seq</article-title>.
<source><italic toggle="yes">Cell</italic></source>.<year>2018</year>;<volume>172</volume>(<issue>5</issue>) :
<elocation-id>10.1016/j.cell.2018.02.001</elocation-id>
<fpage>1091</fpage>-<lpage>1107.e17</lpage>
<pub-id pub-id-type="doi">10.1016/j.cell.2018.02.001</pub-id>
<pub-id pub-id-type="pmid">29328907</pub-id></mixed-citation>
      </ref>
      <ref id="rep-ref-45811-5">
        <label>5</label>
        <mixed-citation publication-type="journal">
:
<article-title>Low-coverage single-cell mRNA sequencing reveals cellular heterogeneity and activated signaling pathways in developing cerebral cortex.</article-title>
<source><italic toggle="yes">Nat Biotechnol</italic></source>.<year>2014</year>;<volume>32</volume>(<issue>10</issue>) :
<elocation-id>10.1038/nbt.2967</elocation-id>
<fpage>1053</fpage>-<lpage>8</lpage>
<pub-id pub-id-type="doi">10.1038/nbt.2967</pub-id>
<?supplied-pmid 25086649?><pub-id pub-id-type="pmid">25086649</pub-id></mixed-citation>
      </ref>
    </ref-list>
  </back>
  <sub-article id="comment4844" article-type="response">
    <front-stub>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Diaz-Mejia</surname>
            <given-names>J. Javier</given-names>
          </name>
          <aff>University Health Network, Canada, Canada</aff>
        </contrib>
      </contrib-group>
      <author-notes>
        <fn fn-type="COI-statement">
          <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="epub">
        <day>17</day>
        <month>8</month>
        <year>2019</year>
      </pub-date>
    </front-stub>
    <body>
      <p>
        <italic><bold>R2-Q1) </bold>It was unclear to me how the accuracy of the classification methods was evaluated. What was the gold standard truth used for each dataset? Were clusters assigned to (a) the single cell-type for which they had the greatest score or (b) all cell-types where their score exceeded some threshold, or (c) to the single cell-type for which they had the greatest score provided that score was above some threshold or another approach? This is crucial to interpreting the PR and ROC curves presented in the results.</italic>
      </p>
      <p>
        <italic>Based on the first sentence of the “Precision-Recall curve analysis” section: I inferred you to be using method (c), but using such a method should not necessarily lead to recall values of 1 as clusters which are more similar to an incorrect cell-type than to the correct cell-type would never become true positives. Thus, I had inferred you to be using method (b) based on Figure 2. It would be very helpful to add a section to the Methods explaining precisely how the accuracy was evaluated.</italic>
      </p>
      <p><bold>R2-A1) </bold>Apologies for the confusion around this point. We have now clarified how the ROC and PR curves were computed in Figure 1 and the text, as described for reviewer 1, above. We combine all cell type gene set prediction scores for a method across all clusters into one column and vary the prediction score threshold to compute the ROC and PR curves. A cluster is only allowed to be correctly labeled using one cell type, as enforced by our gold standard cluster annotation data (the set of cell types an author used to label their given cell clusters). So this matches strategy (c).</p>
      <p>
        <italic><bold>R2-Q2) </bold>In addition, I suggest adding figures/tables for the accuracy of each classification approach (% of clusters correctly assigned) when all clusters are simply assigned to the cell-type for which they have the highest score, since I expect this to be the most common approach users of these classifications would take.</italic>
      </p>
      <p><bold>R2-A2) </bold>Percent of clusters correctly assigned is now included in Figure 6C and Supplementary Table 1. It is useful to have a range of performance indicators to capture different performance facets.</p>
      <p>
        <italic><bold>R2-Q3) </bold>The main weakness of the paper, as the authors admit, is the small number of datasets used to test the classification methods, particularly since the variability in performance between datasets was high. It would be useful to show reproducibility of the results in additional datasets.</italic>
      </p>
      <p>
        <italic>We acknowledge identifying marker gene lists for many different tissues can be very time consuming, there are datasets similar to those the authors have already have markers for that they could use. E.g. mouse retina: Shekhar et al. 20161, PBMCs: Gierahn et al. 2017 (Seq-Well)2. Alternatively, they could do cross-comparisons using the two mouse cell atlas (Tabula Muris3 and Mouse Cell Atlas4). Or use datasets such as Pollen et al., 20145 where gold-standard cell-type identity is known by design.</italic>
      </p>
      <p><bold>R2-A3) </bold>We thank the reviewer for suggesting these datasets. We already used Shekhar
<italic>et al</italic>. 2016 in version 1 of our paper. In the current version, we added Gierahn
<italic>et al</italic>. (2017) as the authors provide cell type labels for the cell clusters, and used the LM22 cell type signatures as input for the prediction methods. We also added the Tabula Muris dataset. We contacted one of the Tabula Muris authors (Angela Pisco), who kindly gave us access to a set of cell type signatures curated by experts on tissues of the Tabula Muris dataset. From the 20 tissues provided in the Tabula Muris data we could map 11 of them into the dataset of cell type signatures and that is what we used as ‘Tabula Muris 11’ in the current version of our paper. We also investigated the influence of cell type signatures using the PBMC datasets (10X and Seq-Well) using either the full LM22 signature database, that we call ‘PBMC-22’, or only the six cell types expected to occur in the data, that we call ‘PBMC-6’. Altogether, we provide analysis using eight dataset variants, up from the three in our initial manuscript.</p>
      <p>
        <italic><bold>R2-Q4) </bold>The authors show that performance degrades when small numbers of marker genes are used by the classifiers. Is it the case that more marker genes is always better or does performance also degrade if too many genes are used?</italic>
      </p>
      <p><bold>R2-A4)</bold> In general, having more marker genes is better, but not always. We approached this question by examining the influence of the number of genes in each gene set (x-axis) and asking what rank does the corresponding gold standard positive receive (y-axis). As can be seen in Figure 6E, the most common scenario is that the fewer the number of genes in the signatures, the more chances that the prediction is incorrect (i.e. assigned a rank lower than the top-rank). However, there are a few exceptions, like ORA in the 11-20 genes bin, where we found more incorrect predictions than having 6-10 genes, or CIBERSORT, which had higher error rate in the 31-50 genes category, than in the 11-20 or 21-30 categories. Thus, it is possible to use too many genes, but it is not always clear how many genes this will be and the performance drop is not great for most of the cases we have data for. We have added this analysis to the paper.</p>
    </body>
  </sub-article>
</sub-article>
<sub-article id="report45814" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.20232.r45814</article-id>
    <title-group>
      <article-title>Reviewer response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Freytag</surname>
          <given-names>Saskia</given-names>
        </name>
        <xref ref-type="aff" rid="r45814a1">1</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-2185-7068</contrib-id>
      </contrib>
      <aff id="r45814a1"><label>1</label>Epigenetics and Genomics, Harry Perkins Institute of Medical Research, Nedlands, WA, Australia</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>3</month>
      <year>2019</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2019 Freytag S</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" id="d35e4145" ext-link-type="doi" xlink:href="10.12688/f1000research.18490.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve-with-reservations</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>Diaz-Mejia et al have produced a nice research article on assessing methods for assigning cluster labels to cell clusters from scRNA-seq. I think this work is of great importance, but I felt that some crucial cluster labelling methods were not compared. I hope the authors can update the article with some of the suggestions:</p>
    <p>  
<list list-type="bullet"><list-item><p>The biggest suggestion for improvement is the choice of methods that the authors compare. The authors chose to adapt 4 methods originally developed for bulk RNA-seq in order to label clusters. While their approach is commendable, none of their adapted methods reflect the current standard practice in the field. Additionally, their claim that methods for cluster labelling in scRNA-seq are too immature or implemented as web-servers is not true. The website
<ext-link ext-link-type="uri" xlink:href="https://www.scrna-tools.org/">scRNA-tools.org</ext-link> lists 29 methods in this category. Many of these methods, such as scMCA, MetaNeighbour and scmap, are well-established and frequently used in the field. Furthermore, many of these methods recommend using annotated scRNA-seq datasets as references instead of bulk data. Hence, it would be great if the authors could include some of these tools in their analysis.</p></list-item></list>
<list list-type="bullet"><list-item><p>I am confused as to which classifier parameter was varied in order to generate the ROCs. Were these comparable across the different methods?</p></list-item></list>
<list list-type="bullet"><list-item><p>It would be interesting to see what the effect of varying the cluster resolution is to the ability of the methods to accurately label the populations. Do you obtain more diverse labelling when there are more clusters?</p></list-item></list>
<list list-type="bullet"><list-item><p>LM22 is a great reference dataset, but recently a new dataset has become openly accessible. This dataset, generated by Monaco et al
<sup><xref rid="rep-ref-45814-1" ref-type="bibr">1</xref></sup>, characterizes 29 human immune cell types by RNA-seq and flow cytometry. It would be interesting to see if the use of this dataset leads to an improvement.</p></list-item></list>
<list list-type="bullet"><list-item><p>I think it would be helpful for the reader if the authors could summarize their results. The sheer number of comparisons made, means that the reader can feel overwhelmed at the end. A figure summarizing the various results for each method in each dataset could help clarify the message.</p></list-item></list>  </p>
    <p> Thank you for making your code publicly available.</p>
    <p>I confirm that I have read this submission and believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however I have significant reservations, as outlined above.</p>
  </body>
  <back>
    <ref-list>
      <title>References</title>
      <ref id="rep-ref-45814-1">
        <label>1</label>
        <mixed-citation publication-type="journal">
:
<article-title>RNA-Seq Signatures Normalized by mRNA Abundance Allow Absolute Deconvolution of Human Immune Cell Types.</article-title>
<source><italic toggle="yes">Cell Rep</italic></source>.<year>2019</year>;<volume>26</volume>(<issue>6</issue>) :
<elocation-id>10.1016/j.celrep.2019.01.041</elocation-id>
<fpage>1627</fpage>-<lpage>1640.e7</lpage>
<pub-id pub-id-type="doi">10.1016/j.celrep.2019.01.041</pub-id>
<?supplied-pmid 30726743?><pub-id pub-id-type="pmid">30726743</pub-id></mixed-citation>
      </ref>
    </ref-list>
  </back>
  <sub-article id="comment4843" article-type="response">
    <front-stub>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Diaz-Mejia</surname>
            <given-names>J. Javier</given-names>
          </name>
          <aff>University Health Network, Canada, Canada</aff>
        </contrib>
      </contrib-group>
      <author-notes>
        <fn fn-type="COI-statement">
          <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="epub">
        <day>17</day>
        <month>8</month>
        <year>2019</year>
      </pub-date>
    </front-stub>
    <body>
      <p>
        <italic><bold>R1-Q1)</bold> The biggest suggestion for improvement is the choice of methods that the authors compare. The authors chose to adapt 4 methods originally developed for bulk RNA-seq in order to label clusters. While their approach is commendable, none of their adapted methods reflect the current standard practice in the field. Additionally, their claim that methods for cluster labelling in scRNA-seq are too immature or implemented as web-servers is not true. The website scRNA-tools.org lists 29 methods in this category. Many of these methods, such as scMCA, MetaNeighbour and scmap, are well-established and frequently used in the field. Furthermore, many of these methods recommend using annotated scRNA-seq datasets as references instead of bulk data. Hence, it would be great if the authors could include some of these tools in their analysis.</italic>
      </p>
      <p><bold>R1-A1)</bold> We thank the reviewer for their comments. We have added MetaNeighbor to the methods compared. The implementation of MetaNeighbor required considerable communication with one of the method developers (M. Crow) who kindly guided us on which parts of the MetaNeighbor source code we needed to modify to make one of its variants (MetaNeighborUS) compatible with the type of task in our study. As we detail in the Methods section ‘Implementation of tested methods and transformation of enrichment metrics for ROC and PR analyses’, the original goal of MetaNeighbor is to quantify cell type replicability across  scRNA-seq datasets (that the authors call ‘studies’); whereas in our comparison, we are “comparing” all the clusters in one scRNA-seq dataset against known cell type specific gene sets or gene expression profiles. Similar to MetaNeighbor, Scmap projects cells from a scRNA-seq experiment on to the cell types or individual cells identified in a different experiment. We would need to apply similar workarounds and modify its code to use it in our study. Although we acknowledge that adding more methods to our comparison would make our results more complete, these other methods were not designed for the specific task we evaluate and would require code modifications to work on our input data. However, we provide an extensible framework, code and datasets that others can use for additional benchmarks. We now clarify this point in the paper.</p>
      <p>
        <italic><bold>R1-Q2)</bold> I am confused as to which classifier parameter was varied in order to generate the ROCs. Were these comparable across the different methods?</italic>
      </p>
      <p><bold>R1-A2) </bold>Sorry for the confusion. For a set of cell clusters, a given method was used to score each cluster against all cell type gene sets resulting in a matrix of cell type prediction scores per cluster. All scores in this matrix were combined into one column to capture all cell type prediction scores across all clusters and this set of prediction scores was varied to generate the ROC and PR curves. This is now clarified in Figure 1 and the text.</p>
      <p>
        <italic><bold>R1-Q3)</bold> It would be interesting to see what the effect of varying the cluster resolution is to the ability of the methods to accurately label the populations. Do you obtain more diverse labelling when there are more clusters?</italic>
      </p>
      <p><bold>R1-A3) </bold>Presumably yes. However, there is a methodological barrier that prevents us from investigating this aspect of the data using our current evaluation design. Authors of the analyzed datasets provided gold standard annotations only at a single resolution per dataset, and we use these. Reclustering the original data to test other resolutions would require gold standards to be created for those resolutions (ideally by the original authors). However, we agree with the reviewer that studying the influence of cell cluster resolution is an interesting question. As the field moves towards increasing the number of scRNA-seq datasets annotated following standard ontology-based cell type annotations that consider a hierarchy of cell types at multiple granularities, this question could be addressed. We have added this to our discussion.</p>
      <p>
        <italic><bold>R1-Q4) </bold>LM22 is a great reference dataset, but recently a new dataset has become openly accessible. This dataset, generated by Monaco et al1, characterizes 29 human immune cell types by RNA-seq and flow cytometry. It would be interesting to see if the use of this dataset leads to an improvement.</italic>
      </p>
      <p><bold>R1-A4) </bold>Thanks for the pointer. We decided to keep the LM22 dataset because only six of the 22 cell types represented in it could be mapped into the PBMC data we analyzed. The Monaco dataset does not improve this number. Only five of the 17 cell types represented in the Monaco signature for RNA seq data are present in the PBMC data we analyzed. Furthermore, the ROC AUC and PR AUC values obtained using the LM22 and the Monaco signature are comparable to each other (Supplementary Table 2).</p>
      <p>
        <italic><bold>R1-Q5)</bold> I think it would be helpful for the reader if the authors could summarize their results. The sheer number of comparisons made, means that the reader can feel overwhelmed at the end. A figure summarizing the various results for each method in each dataset could help clarify the message.</italic>
      </p>
      <p><bold>R1-A5) </bold>Thanks for raising this point. We have now included summary Figure 6.</p>
      <p>
        <italic><bold>R1-Q6) </bold>Thank you for making your code publicly available.</italic>
      </p>
      <p><bold>R1-A6) </bold>Thanks. We have updated our GitHub repository with the MetaNeighbor implementation and modifications to our main wrapper to make it easier to incorporate new methods.</p>
    </body>
  </sub-article>
</sub-article>
