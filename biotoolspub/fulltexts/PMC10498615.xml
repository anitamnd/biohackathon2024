<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10498615</article-id>
    <article-id pub-id-type="pmid">37704947</article-id>
    <article-id pub-id-type="publisher-id">5461</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05461-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>BiocMAP: a Bioconductor-friendly, GPU-accelerated pipeline for bisulfite-sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Eagles</surname>
          <given-names>Nicholas J.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wilton</surname>
          <given-names>Richard</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jaffe</surname>
          <given-names>Andrew E.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2140-308X</contrib-id>
        <name>
          <surname>Collado-Torres</surname>
          <given-names>Leonardo</given-names>
        </name>
        <address>
          <email>lcolladotor@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/04q36wn27</institution-id><institution-id institution-id-type="GRID">grid.429552.d</institution-id><institution-id institution-id-type="ISNI">0000 0004 5913 1291</institution-id><institution>Lieber Institute for Brain Development, Johns Hopkins Medical Campus, </institution></institution-wrap>Baltimore, 21205 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00za53h95</institution-id><institution-id institution-id-type="GRID">grid.21107.35</institution-id><institution-id institution-id-type="ISNI">0000 0001 2171 9311</institution-id><institution>Department of Physics and Astronomy, </institution><institution>Johns Hopkins University, </institution></institution-wrap>Baltimore, 21218 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>340</elocation-id>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>4</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>8</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Bisulfite sequencing is a powerful tool for profiling genomic methylation, an epigenetic modification critical in the understanding of cancer, psychiatric disorders, and many other conditions. Raw data generated by whole genome bisulfite sequencing (WGBS) requires several computational steps before it is ready for statistical analysis, and particular care is required to process data in a timely and memory-efficient manner. Alignment to a reference genome is one of the most computationally demanding steps in a WGBS workflow, taking several hours or even days with commonly used WGBS-specific alignment software. This naturally motivates the creation of computational workflows that can utilize GPU-based alignment software to greatly speed up the bottleneck step. In addition, WGBS produces raw data that is large and often unwieldy; a lack of memory-efficient representation of data by existing pipelines renders WGBS impractical or impossible to many researchers.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We present BiocMAP, a Bioconductor-friendly methylation analysis pipeline consisting of two modules, to address the above concerns. The first module performs computationally-intensive read alignment using <italic>Arioc</italic>, a GPU-accelerated short-read aligner. Since GPUs are not always available on the same computing environments where traditional CPU-based analyses are convenient, the second module may be run in a GPU-free environment. This module extracts and merges DNA methylation proportions—the fractions of methylated cytosines across all cells in a sample at a given genomic site. Bioconductor-based output objects in R utilize an on-disk data representation to drastically reduce required main memory and make WGBS projects computationally feasible to more researchers.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">BiocMAP is implemented using Nextflow and available at <ext-link ext-link-type="uri" xlink:href="http://research.libd.org/BiocMAP/">http://research.libd.org/BiocMAP/</ext-link>. To enable reproducible analysis across a variety of typical computing environments, BiocMAP can be containerized with Docker or Singularity, and executed locally or with the SLURM or SGE scheduling engines. By providing Bioconductor objects, BiocMAP’s output can be integrated with powerful analytical open source software for analyzing methylation data.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05461-3.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>WGBS</kwd>
      <kwd>Bioconductor</kwd>
      <kwd>Pipeline</kwd>
      <kwd>Arioc</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000738</institution-id>
            <institution>U.S. Department of Veterans Affairs</institution>
          </institution-wrap>
        </funding-source>
        <award-id>VA-241-17-C-0138</award-id>
        <principal-award-recipient>
          <name>
            <surname>Eagles</surname>
            <given-names>Nicholas J.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par20">The genome of many organisms is more than just a sequence of four nucleotides. These nucleotides can be chemically modified, and a common modification is the methylation of cytosines [<xref ref-type="bibr" rid="CR1">1</xref>], which was discovered in mammals as early as DNA itself [<xref ref-type="bibr" rid="CR2">2</xref>]. The percent of methylated cytosines was first measured across a significant portion of the human genome using methylation arrays [<xref ref-type="bibr" rid="CR3">3</xref>]. With the advent of whole genome sequencing, whole genome bisulfite sequencing (WGBS) became a reality, allowing researchers to study methylated cytosines in different contexts (CpG, CpH) [<xref ref-type="bibr" rid="CR4">4</xref>] and experimental settings [<xref ref-type="bibr" rid="CR3">3</xref>]. However, population-scale studies have generally been limited to microarrays due to complexities in sample pre-processing required for WGBS. While methylation typically occurs primarily at cytosines in CpG context in almost all cell and tissue types, CpH-context methylation is present and plays a significant role in the brain [<xref ref-type="bibr" rid="CR5">5</xref>]. In contrast to microarrays, WGBS captures CpH methylation and novel CpG loci. Furthermore, a study by Perzell Mandell et al. [<xref ref-type="bibr" rid="CR6">6</xref>] exploring age and sex-associated methylation differences in human dorsolateral prefrontal cortex samples found that more than 97% of significant CpG loci were unmeasured by microarrays.</p>
    <p id="Par21">Raw sequencing reads require several computational processing steps to produce DNA methylation proportions, a feature ready for statistical analysis. Among the most computationally demanding steps is alignment of reads to a reference genome, where software must consider alignments across reference sequences from 4 methylation states: methylated and unmethylated cytosines under directional and non-directional library preparation protocols. With currently available CPUs, alignment software such as <italic>Bismark</italic> [<xref ref-type="bibr" rid="CR7">7</xref>] may require hours or days to align a single WGBS sample. The <italic>Arioc</italic> [<xref ref-type="bibr" rid="CR8">8</xref>] aligner, which uses GPU acceleration to compute WGBS alignments, achieves processing speeds that are an order of magnitude faster without sacrificing accuracy or sensitivity. This provides a natural motivation for the implementation of a workflow that can use GPUs for alignment but CPUs for remaining processing steps. However, the use of GPUs for non-graphics-related tasks is still in its infancy, and GPU resources are sometimes not available on the same computing clusters where traditional CPU and memory resources are abundant.</p>
    <p id="Par22">We introduce BiocMAP [<xref ref-type="bibr" rid="CR9">9</xref>], a <bold>Bioc</bold>onductor-friendly <bold>M</bold>ethylation <bold>A</bold>nalysis <bold>P</bold>ipeline for processing bisulfite-sequencing data into analysis-ready R [<xref ref-type="bibr" rid="CR10">10</xref>] objects. As <italic>bsseq</italic> [<xref ref-type="bibr" rid="CR11">11</xref>] objects, BiocMAP outputs extend the popular <italic>SummarizedExperiment</italic> [<xref ref-type="bibr" rid="CR12">12</xref>] format and are readily analyzable with a number of Bioconductor [<xref ref-type="bibr" rid="CR13">13</xref>] R [<xref ref-type="bibr" rid="CR10">10</xref>] packages, making WGBS research convenient for more of the computational genomics community. BiocMAP is split into two modules that can be executed in different computing environments; this can allow a researcher to align samples in a computing environment with ample GPU resources, but perform “methylation extraction”—calculating the fraction of methylated cytosines at a given genomic site—and remaining processing steps in an environment with more CPUs and memory. BiocMAP is built using Nextflow [<xref ref-type="bibr" rid="CR14">14</xref>], a popular workflow-management framework enabling simple configuration, effective parallelization, and straightforward support of multiple computing environments. Small edits to configuration files allow any Nextflow workflow to run with Sun/Son of Grid Engine (SGE) or Simple Linux Utility for Resource Management (SLURM) job schedulers, in cloud environments like Google Cloud or Amazon Web Services, and running pipeline components inside Docker or Singularity containers.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Overview</title>
      <p id="Par23">The BiocMAP workflow consists of a set of two modules—alignment and extraction, which together process raw WGBS reads in FASTQ format into Bioconductor-friendly [<xref ref-type="bibr" rid="CR13">13</xref>] R [<xref ref-type="bibr" rid="CR10">10</xref>] objects containing DNA methylation proportions essentially as a cytosine-by-sample matrix (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). In the first alignment module, an initial quality check is performed with <italic>FastQC</italic> [<xref ref-type="bibr" rid="CR15">15</xref>], after which samples are trimmed with <italic>Trim Galore!</italic> [<xref ref-type="bibr" rid="CR16">16</xref>], aligned to a reference genome with <italic>Arioc</italic> [<xref ref-type="bibr" rid="CR8">8</xref>], and low-quality or duplicate mappings are filtered out.<fig id="Fig1"><label>Fig. 1</label><caption><p>BiocMAP workflow overview. Diagram representing the conceptual workflow traversed by BiocMAP. The red box indicates the FASTQ files are inputs to the pipeline; green coloring denotes major output files from the pipeline; the remaining boxes represent computational steps. Yellow and orange-colored steps are optional or not always performed; for example, lambda pseudoalignment is an optional step intended for experiments with spike-ins of the lambda bacteriophage. Finally, blue-colored steps are ordinary processes which occur on every pipeline execution. Depending on the available high performance computing (HPC) systems, both modules can be run sequentially on a HPC system with both GPUs and CPUs, or the alignment module can be run on a GPU-powered HPC system, then files transferred to a CPU-based HPC system as well as updating file paths on the <italic>rules.txt</italic> file (dotted line), before running the extraction module on the CPU-based HPC system</p></caption><graphic xlink:href="12859_2023_5461_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par24">In the second extraction module, DNA methylation proportion extraction is performed within each sample using <italic>MethylDackel</italic> [<xref ref-type="bibr" rid="CR17">17</xref>] or optionally <italic>Bismark</italic> [<xref ref-type="bibr" rid="CR7">7</xref>], and the results are aggregated across samples into a pair of <italic>bsseq</italic> [<xref ref-type="bibr" rid="CR11">11</xref>] R [<xref ref-type="bibr" rid="CR10">10</xref>] objects for easy integration with a number of Bioconductor [<xref ref-type="bibr" rid="CR13">13</xref>] packages to facilitate downstream statistical analyses. Some examples include <italic>limma</italic> [<xref ref-type="bibr" rid="CR18">18</xref>] for linear modeling, <italic>Borealis</italic> [<xref ref-type="bibr" rid="CR19">19</xref>] for outlier detection, and <italic>MethCP</italic> [<xref ref-type="bibr" rid="CR20">20</xref>] and <italic>DMRcate</italic> [<xref ref-type="bibr" rid="CR21">21</xref>] for finding differentially methylated regions. The first <italic>bsseq</italic> object contains counts of methylated and unmethylated cytosines in CpG context across the entire reference genome, while the second object contains any additional cytosines in CpH context, when relevant (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). A summary table is also produced, compiling together metrics and statistics from trimming, alignment, and methylation extraction for each sample (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S1). Examples of information gathered include percent of reads concordantly aligned and percent of reads trimmed. This allows researchers to control for potential covariates and unintended sources of variation when performing downstream statistical analyses such as the identification of differentially methylated regions (DMRs) [<xref ref-type="bibr" rid="CR11">11</xref>].<fig id="Fig2"><label>Fig. 2</label><caption><p><italic>bsseq</italic> output objects. The major outputs from the extraction module are R objects from the <italic>bsseq</italic> Bioconductor package, which contain methylation proportion and coverage information at all cytosine loci in the human genome. <italic>bsseq</italic> extends the <italic>SummarizedExperiment</italic> class, which provides a general and popular format for storing genomics data and is memory efficient thanks to the <italic>HDF5Array</italic> backend. Two <italic>bsseq</italic> objects are produced, with one object containing cytosine sites in CpG context, and the other containing the remaining CpH loci</p></caption><graphic xlink:href="12859_2023_5461_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Application</title>
      <p id="Par25">To demonstrate how BiocMAP outputs might be used to perform statistical analysis and visualization on real WGBS data (Additional file <xref rid="MOESM2" ref-type="media">2</xref>), we used a publicly available dataset and illustrate an example analysis [<xref ref-type="bibr" rid="CR9">9</xref>]. The dataset used includes 32 human brain dorsolateral prefrontal cortex (DLPFC) samples spanning developmental years from postnatal up to 23 years of age [<xref ref-type="bibr" rid="CR22">22</xref>]. NeuN-based fluorescence-activated nuclear sorting was used to produce 8 glial and 24 neuronal samples from the homogenate DLPFC tissue. Prenatal samples present in Price et al. [<xref ref-type="bibr" rid="CR5">5</xref>] were excluded for this analysis. As CpH methylation is known to be crucially involved in age-related neuronal development [<xref ref-type="bibr" rid="CR5">5</xref>], this dataset exemplifies a practical research use-case for BiocMAP analysis. As a whole-genome human dataset, it also reflects the potentially large scale of data possible to process with BiocMAP. The first module was run with the default <italic>jhpce</italic> configuration, which runs at most 40 concurrent Nextflow processes, performs alignment with 3 NVIDIA A100 80 GB GPUs, with virtual memory peaking at 276 GB during alignment. The second module was also run with <italic>jhpce</italic> defaults and 35 concurrent processes, peaking at 142 GB of virtual memory usage. Resulting R objects load in 23 GB of memory. Execution times for each computational step in BiocMAP with this dataset were recorded and provide a guideline for other datasets (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). The execution time boxplots that can be generated as part of a Nextflow [<xref ref-type="bibr" rid="CR14">14</xref>] “execution report”, produced by including the <italic>-with-report</italic> command-line option to the appropriate BiocMAP execution script (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S2).<fig id="Fig3"><label>Fig. 3</label><caption><p>Process run-times from combined execution reports. Wallclock run-times for each process in the alignment and extraction BiocMAP modules, (<bold>A</bold>) and (<bold>B</bold>) respectively, are plotted for the 32-sample subset of the Price et. al dataset [<xref ref-type="bibr" rid="CR22">22</xref>]. Individual boxplots for each module, combined here for illustration purposes, are one several plot types included in an HTML execution report generated by including the <italic>-with-report</italic> command-line option to BiocMAP, as made possible through the Nextflow [<xref ref-type="bibr" rid="CR14">14</xref>] framework. A given process, or computational step, in the BiocMAP workflow may be executed for one of more samples in the dataset; boxplots here summarize the distribution of run-times across all executions of each process type</p></caption><graphic xlink:href="12859_2023_5461_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par26">In the example analysis, we show how to attach external sample metadata to the <italic>bsseq</italic> [<xref ref-type="bibr" rid="CR11">11</xref>] objects and produce several exploratory plots (Additional file <xref rid="MOESM2" ref-type="media">2</xref>). For example, we compared the estimated bisulfite-conversion rate (produced by BiocMAP) across neuronal and glial samples (provided by the dataset metadata; Additional file <xref rid="MOESM2" ref-type="media">2</xref>). We examined the relationship between methylation contexts (CpG, CHG, CHH), which shows higher methylation rates for neurons compared to glia as well as higher correlation between the methylation rate in CpG context against CHH or CHG context in neurons versus glia (Fig. <xref rid="Fig4" ref-type="fig">4</xref>A). The proportion of cytosines with methylation higher than 10% is not significantly different under the CpG context, but is on the CpH context (CHH or CHG) when comparing neurons versus glia (Fig. <xref rid="Fig4" ref-type="fig">4</xref>B). This proportion doesn’t change across ages 0 to 23. The original study describing this dataset identified differentially methylated regions (DMRs) between cell types [<xref ref-type="bibr" rid="CR5">5</xref>]. By providing R/Bioconductor objects, BiocMAP’s outputs can easily be integrated with other R/Bioconductor packages that provide statistical and visualization methods. For example, DMRs can be visualized with <italic>bsseq</italic> [<xref ref-type="bibr" rid="CR11">11</xref>] (Fig. <xref rid="Fig4" ref-type="fig">4</xref>C).<fig id="Fig4"><label>Fig. 4</label><caption><p>Visualization of BiocMAP outputs on an Example Dataset. <bold>A</bold> Comparison of average methylation rate by trinucleotide context and cell type, showing significant correlation between contexts and similar methylation distributions with different means by cell type. Glia have lower correlation with CpG and a lower methylation rate than neurons. <bold>B</bold> Proportion of highly methylated cytosines across age by cell type and trinucleotide context. Here it can be seen that neuronal CpH methylation appears to generally increase with age, with no obvious association with age in other combinations of cell type and context. <bold>C</bold> Genomic region containing differential methylation between neurons and glia. Orange and green methylation curves represent neuronal and glial samples, respectively. Windows highlighted in light red show differentially methylated regions (DMRs) determined in the Price et al. manuscript [<xref ref-type="bibr" rid="CR5">5</xref>]</p></caption><graphic xlink:href="12859_2023_5461_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Benchmark</title>
      <p id="Par27">To quantify BiocMAP’s performance, we selected a 4-sample subset of the Price et. al. dataset [<xref ref-type="bibr" rid="CR22">22</xref>] and ran BiocMAP in its entirety along with a popular and functionally similar WGBS pipeline, nf-core/methylseq [<xref ref-type="bibr" rid="CR23">23</xref>]. We found that BiocMAP is considerably faster while using significantly less CPU hours and memory (total TB hours) (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). These two metrics are the ones typically quantified for billing purposes on high performance computing environments, thus BiocMAP can reduce computational expenses associated with pre-processing of WGBS data, in addition to time gains. On the other hand, BiocMAP was significantly more demanding at its peak in terms of total concurrent memory usage, at 341 GB, compared with nf-core/methylseq’s 73 GB. During the benchmark, each tool was allowed 40 concurrent Nextflow processes and unlimited CPU and memory resources (<italic>Methods: Benchmark</italic>). Given these loose constraints, BiocMAP aggressively parallelizes steps and consequently utilizes a much larger peak memory than nf-core/methylseq, despite an overall  12.6-fold lower overall memory utilized (by total TB hours). The most demanding step in BiocMAP requests 180 GB by default, imposing a practical minimum of 180 GB for a system to run BiocMAP from start to end. Moreover, this value can generally be reduced in BiocMAP configuration files (<italic>Methods: Configuration</italic>) for datasets consisting of less than about 400 samples.<fig id="Fig5"><label>Fig. 5</label><caption><p>Benchmark results. <bold>A</bold> Total wallclock duration of each pipeline. BiocMAP completes in roughly 1 day, not including downtime between the first and second module, while nf-core/methylseq completes in roughly 7 days. <bold>B</bold> Total CPU utilization by pipeline, in CPU hours. nf-core/methylseq uses more than 14 times the CPU resources as BiocMAP, at 1527 CPU hours. BiocMAP uses less than 8.7 GPU hours total (not shown) during alignment, suggesting the greater CPU usage of nf-core/methylseq is not explained by BiocMAP’s use of GPUs. <bold>C</bold> Maximal concurrent CPU usage at any point during pipeline execution. BiocMAP utilized 26 CPUs at its most demanding moment, while nf-core/methylseq used 72. Concurrent CPU usage is configurable, but was designed to be unconstrained during this benchmark. <bold>D</bold> Total memory usage by each pipeline in TB-hours. nf-core/methylseq used approximately 12.5 times more memory hours than BiocMAP over the full course of execution. <bold>E</bold> Maximal concurrent memory usage in GB across all processes, at any point during pipeline execution. BiocMAP used 341 GB of memory, approximately 4.7 times more than nf-core/methylseq, at each of their most memory-intensive moments. Note that concurrent memory usage is configurable, but was intentionally unconstrained for this benchmark</p></caption><graphic xlink:href="12859_2023_5461_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Methods</title>
    <sec id="Sec7">
      <title>Overview</title>
      <p id="Par28">In the first alignment module, FASTQ files are checked with <italic>FastQC</italic> 0.11.8 [<xref ref-type="bibr" rid="CR15">15</xref>], and by default samples that fail the “Adapter Content” metric are trimmed using <italic>Trim Galore!</italic> 0.6.6 [<xref ref-type="bibr" rid="CR16">16</xref>] (see <italic>Methods: Configuration</italic> for alternative trimming options). The resulting FASTQ files are aligned to a reference genome using the GPU-based aligner <italic>Arioc</italic> 1.43 [<xref ref-type="bibr" rid="CR8">8</xref>], to produce alignments in SAM format [<xref ref-type="bibr" rid="CR24">24</xref>]. Using <italic>SAMtools</italic> 1.10 [<xref ref-type="bibr" rid="CR24">24</xref>], alignments are filtered such that only primary alignments with <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$MAPQ \ge 5$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>P</mml:mi><mml:mi>Q</mml:mi><mml:mo>≥</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5461_Article_IEq1.gif"/></alternatives></inline-formula> are kept, duplicate reads are dropped using <italic>SAMBLASTER</italic> 0.1.26 [<xref ref-type="bibr" rid="CR25">25</xref>], and finally the result is coordinate-sorted, indexed and stored in BAM format via <italic>SAMtools</italic>.</p>
      <p id="Par29">In the second extraction module, methylation extraction is performed with <italic>MethylDackel</italic> 0.5.2 [<xref ref-type="bibr" rid="CR17">17</xref>] or optionally <italic>Bismark</italic> 0.23.0 [<xref ref-type="bibr" rid="CR7">7</xref>] on alignments from the alignment module. By default, a BAM file and corresponding index are expected as input to <italic>MethylDackel</italic>, while just a SAM or BAM file is required if <italic>Bismark</italic> is to be used. For experiments using spike-ins of the lambda bacteriophage, we use a pseudo-alignment-based approach to infer bisulfite-conversion efficiency for each sample. In particular, we prepare two “versions” of the lambda genome: the original and a copy where each cytosine is replaced with a thymine (Availability of data and materials). The latter version represents “in-silico bisulfite conversion” of the original genome, where we assume this original is completely unmethylated. Using <italic>kallisto</italic> 0.46.1 [<xref ref-type="bibr" rid="CR26">26</xref>], we count the number of reads aligned to each version of the lambda genome, and call these counts <italic>o</italic> and <italic>b</italic> for the original and bisulfite-converted versions, respectively. We define the bisulfite conversion efficiency rate <italic>e</italic> with the following ratio: <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e=\frac{b}{o + b}$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>b</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5461_Article_IEq2.gif"/></alternatives></inline-formula>. This contrasts with the more conventional approach [<xref ref-type="bibr" rid="CR27">27</xref>], which involves directly aligning reads to the lambda reference genome and comparing cytosine and thymine counts on a single strand. In our own tests, we have found our pseudo-alignment-based approach to be sufficiently concordant with the conventional method, while requiring just a fraction of the computational time. The Bioconductor package <italic>bsseq</italic> [<xref ref-type="bibr" rid="CR11">11</xref>] is used to gather methylation information into <italic>SummarizedExperiment</italic>-based [<xref ref-type="bibr" rid="CR12">12</xref>] objects. The final result is a pair of <italic>bsseq</italic> objects, each of which contains all samples in the experiment as columns (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). One object contains all cytosines in the genome observed in CpG context, represented as rows, while the other contains the remaining cytosines in CpH context (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Various metrics from <italic>FastQC</italic> [<xref ref-type="bibr" rid="CR15">15</xref>], trimming, alignment, methylation extraction, and lambda pseudoalignment, if applicable, are aggregated into the <italic>colData()</italic> slot of each object (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S1).</p>
    </sec>
    <sec id="Sec8">
      <title>Configuration</title>
      <p id="Par30">A researcher typically must modify one or two types of files in BiocMAP: the execution script and optionally, a configuration file. The execution script contains the <italic>nextflow</italic> command [<xref ref-type="bibr" rid="CR14">14</xref>] and major experiment-specific options, which together invoke one module in BiocMAP on a particular platform. Execution script templates are provided for each module in BiocMAP (“alignment” and “extraction”) and platform, which includes local Linux machines and systems managed by the Sun/Son of Grid Engine (SGE) or Simple Linux Utility for Resource Management (SLURM) job schedulers (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S2). Additional job management systems are supported by Nextflow [<xref ref-type="bibr" rid="CR14">14</xref>].</p>
      <p id="Par31">Required arguments in each execution script include “reference” and “sample”. “reference” may take values “hg38” or “hg19”, corresponding to the reference human genome to which samples should be aligned. The mouse reference genome “mm10” is also supported. “sample” may take values “single” or “paired”, referring to whether samples are single-end or paired-end. Several other options may be configured in the execution script. For example, the “input” argument takes the directory including <italic>samples.manifest</italic> for the alignment module, and the directory containing <italic>rules.txt</italic> for the extraction module (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S3). The optional “trim_mode” argument in the alignment module may take values “skip”, “adaptive”, or “force”, allowing the user to avoid trimming any samples, trim samples whose “Adapter Content” metric from <italic>FastQC</italic> [<xref ref-type="bibr" rid="CR15">15</xref>] is “FAIL”, or trim all samples, respectively.</p>
    </sec>
    <sec id="Sec9">
      <title>Inputs</title>
      <p id="Par32">Both the alignment and extraction modules require a file called <italic>samples.manifest</italic> as input; this file is identical to those used in SPEAQeasy [<xref ref-type="bibr" rid="CR28">28</xref>], thus providing a common file for describing input samples in both RNA-seq and WGBS projects. Briefly, <italic>samples.manifest</italic> is a tab-delimited plain-text file containing the absolute paths to each FASTQ file in the experiment, and associating files with a sample identifier. For compatibility with a previous format, optional MD5 sums can be associated with each FASTQ file. FASTQ files may optionally be compressed using gzip, so “.fq”, “.fastq”, “.fq.gz”, and “.fastq.gz” are all accepted file extensions. A researcher can specify that any combination of files be merged and treated as a single sample, simply by using the same sample ID in each line of FASTQ files to combine. This allows for simple management of the common case where a single biological sample is sequenced across several sequencing lanes and thus produces several files.</p>
      <p id="Par33">The extraction module makes use of the same <italic>samples.manifest</italic> file as the alignment module, as well as an additional file called <italic>rules.txt</italic> (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S3). The purpose of this file is to direct BiocMAP to each of the sets of outputs produced from the alignment module, which may not necessarily have been produced on the same high performance computing (HPC) system. From the alignment module, a researcher will have produced SAM or BAM files from alignment, as well as logs from quality checking, trimming, and alignment. The extraction module requires that a researcher create the <italic>rules.txt</italic> file, and point to the directory containing it via the <italic>–input</italic> option in the main submission script. <italic>rules.txt</italic> is a plain-text file where each line consists of a key-value pair (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S3). To facilitate this process, the alignment module creates a template <italic>rules.txt</italic> file which can be easily updated by the researcher in case file paths change in HPC system used for the extraction module. As an example <italic>rule</italic>, the “sam” key requires the path to each SAM or BAM from alignment as a value. Other keys are “manifest”, “arioc_log”, “xmc_log”, “trim_report”, “fastqc_log_first”, and “fastqc_log_last”, some of which are optional. Because an experiment typically consists of many samples, each value typically refers to multiple paths; including the literal “[id]” in a particular path signals for BiocMAP to replace “[id]” with each sample name to determine the full set of paths. A path can also be written as a glob expression, which is useful whenever a key refers to more than one file per sample; for example, the “sam” key can accept a BAM file and its index for every sample. For more detail about <italic>rules.txt</italic> and properly specifying file paths, see the documentation site (Availability of data and materials).</p>
    </sec>
    <sec id="Sec10">
      <title>Outputs</title>
      <p id="Par34">The final product from running BiocMAP is a pair of <italic>bsseq</italic> R objects, together containing methylation proportion and coverage information at all cytosine loci in the human or mouse genome (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). One object contains all cytosines occurring in “CpG” context in the reference genome, while the other object contains the remaining cytosines in “CpH” context. The <italic>bsseq</italic> [<xref ref-type="bibr" rid="CR11">11</xref>] class extends the <italic>SummarizedExperiment</italic> [<xref ref-type="bibr" rid="CR12">12</xref>] class, and here rows correspond to cytosines, while columns correspond to samples. Both objects contain the <italic>M</italic> and <italic>Cov</italic> assays, stored as <italic>DelayedArray</italic>s [<xref ref-type="bibr" rid="CR29">29</xref>] and representing methylation proportions and coverage counts, respectively. We “strand-collapse” CpG loci, which involves combining methylation data from both genomic strands and thus discards strand-specific information. The CpG object is also smoothed using the <italic>BSmooth</italic> [<xref ref-type="bibr" rid="CR30">30</xref>] pipeline as implemented in the <italic>bsseq</italic> [<xref ref-type="bibr" rid="CR11">11</xref>] package, yielding an additional assay called <italic>coef</italic>, which contains the smoothing coefficients corresponding to each raw methylation proportion stored in the <italic>M</italic> assay. Computing <italic>coef</italic> is time consuming, which is why for the CpH methylation data BiocMAP does not compute it as typical analyses will first filter the CpH data before computing this matrix. For a typical experiment involving many samples, these objects might occupy tens or even hundreds of gigabytes in memory if loaded in a traditional fashion. To enable working with the objects in a reasonable amount of memory, the assays are HDF5-backed using functionality from the <italic>HDF5Array</italic> [<xref ref-type="bibr" rid="CR31">31</xref>] package. The HDF5 format is designed to allow direct manipulation of on-disk data as if it were loaded in random access memory (RAM), thus reducing the required RAM by an order of magnitude. The large matrices containing methylation proportions, coverage, and smoothing coefficients are not loaded into memory, and common operations on these matrices are “chunked”, meaning only small pieces of a matrix are loaded into memory (RAM) at a time.</p>
      <p id="Par35">A table of metrics is stored in the <italic>colData()</italic> slot of each object, containing information collected from quality checking, trimming, alignment, methylation extraction, and potentially pseudoalignment to the lambda transcriptome (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S1). These metrics can be used for exploratory data analysis as well as for adjusting for them when performing downstream statistical analyses such as the identification of differentially methylated regions (DMRs). This table is also produced as a standalone R data frame to provide a format that is trivial to load into memory, interactively explore through <ext-link ext-link-type="uri" xlink:href="https://libd.shinyapps.io/shinycsv/">https://libd.shinyapps.io/shinycsv/</ext-link> [<xref ref-type="bibr" rid="CR32">32</xref>], or export to other formats.</p>
      <p id="Par36">In addition to the primary outputs of interest, BiocMAP produces a number of output files from intermediate pipeline steps (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S4).</p>
    </sec>
    <sec id="Sec11">
      <title>Software management</title>
      <p id="Par37">BiocMAP is designed to run on Linux machines, either locally or through the SGE or SLURM job scheduling engines, or other engines supported by Nextflow [<xref ref-type="bibr" rid="CR14">14</xref>]. We require Java 8 or later to be installed, as well as docker or singularity, based on the user’s preferred installation method. If neither are available, R [<xref ref-type="bibr" rid="CR10">10</xref>] 4.0 or later and python 3 are required. Finally, an NVIDIA GPU and its corresponding drivers are required. Docker users must also have the NVIDIA container toolkit installed.</p>
      <p id="Par38">BiocMAP makes use of a number of external software tools which must be installed to use the pipeline. We support three different installation methods to accommodate a user’s existing set-up: download of docker images containing software, download of corresponding singularity images, or direct “local” installation of software. All three methods require simply invoking a shell script, followed by the name of the installation method (“docker”, “singularity”, or “local”):<graphic position="anchor" xlink:href="12859_2023_5461_Figa_HTML" id="MO6"/></p>
      <p id="Par39">For users of computing clusters, we make the assumption that GPU resources are accessible via a particular queue. Therefore, cluster users must also perform an additional manual step to complete the installation; this involves setting a variable in the appropriate configuration file (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S2) to the name of the queue where GPU(s) are available.<graphic position="anchor" xlink:href="12859_2023_5461_Figb_HTML" id="MO7"/></p>
      <p id="Par40">We recommend using the “docker” or “singularity” installation methods, if those tools are available, or the “local” method otherwise. As a Nextflow-based [<xref ref-type="bibr" rid="CR14">14</xref>] pipeline, BiocMAP is out-of-the-box able to execute individual pipeline components, called <italic>processes</italic>, inside Docker or Singularity containers. These containers provide an exact environment, including the main software, system tools, and other dependencies, so that each BiocMAP process behaves identically on different computing systems. We host every docker image used by BiocMAP on a public Docker Hub repository (Availability of data and materials). In practice, the “singularity” installation mode automatically pulls the required docker images and builds singularity-compatible equivalents to use at run-time.</p>
      <p id="Par41">Alternatively, a researcher may use the “local” installation mode, which builds individual software tools from source when possible or downloads pre-compiled binaries otherwise. Since each piece of software is installed to a local directory and not globally, root permissions are not required for this installation method, and thus might be preferred by some users. However, because this approach tailors the installation to a particular computing environment, it is beyond our capacity to test unlike the “docker” or “singularity” modes, and we thus encourage you to avoid using the “local” mode.</p>
    </sec>
    <sec id="Sec12">
      <title>Annotation</title>
      <p id="Par42">Since BiocMAP performs alignment to a reference genome and can quantify lambda spike-ins [<xref ref-type="bibr" rid="CR27">27</xref>], it must make use of external reference files. By default, required reference files are automatically pulled from GENCODE [<xref ref-type="bibr" rid="CR33">33</xref>] (or NCBI for the lambda genome), but a user can also opt to provide their own files instead. The method used by BiocMAP to manage external reference files is nearly identical to that used in SPEAQeasy [<xref ref-type="bibr" rid="CR28">28</xref>], and we encourage those interested to refer to that manuscript for more details; however, we provide a brief summary here.</p>
      <p id="Par43">When using default annotation from GENCODE [<xref ref-type="bibr" rid="CR33">33</xref>], the genomes “hg38”, “hg19”, and “mm10” are supported; one of these values must be passed to the <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$--reference$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mo>-</mml:mo><mml:mo>-</mml:mo><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5461_Article_IEq3.gif"/></alternatives></inline-formula> option. A researcher may specify the GENCODE version for human or mouse, as appropriate (e.g. “38” or “M27”, respectively). An additional configuration variable called “anno_build” determines if all sequences present in the “primary_assembly” file from GENCODE are kept, or if only canonical reference chromosomes are used for alignment; this corresponds to the values “primary” or “main” that a researcher may select, respectively. BiocMAP only pulls files from GENCODE that have not already been downloaded; after the first execution of the workflow for a given set of settings, it uses a locally cached copy of relevant files. A researcher may manually choose a directory to place annotation files via the command-line option “–annotation [path to directory]”, which enables potentially many users to share a single location for reference files to save disk space and time.</p>
      <p id="Par44">Alternatively, a researcher may provide their own reference genome in FASTA format in place of the automatically managed GENCODE [<xref ref-type="bibr" rid="CR33">33</xref>] files. In this case, the “–annotation [path to directory]” option signifies the directory containing the provided FASTA file, and the “–custom_anno [label]” option assigns an informative label, or name, that can later be used in place of explicitly providing the genome. Note that the lambda genome is only automatically managed, since it is unlikely a user will need to swap out a different version.</p>
    </sec>
    <sec id="Sec13">
      <title>Test samples</title>
      <p id="Par45">Small test files are provided in the <italic>test</italic> directory of the GitHub repository, for each combination of species (human and mouse) and pairing (single-end and paired-end). These are intended to allow a researcher to quickly verify BiocMAP has properly installed. While human, paired-end files are from the example <italic>AgeNeunSortedWGBS</italic> dataset [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR22">22</xref>], the remaining files were retrieved from the Sequence Read Archive (SRA) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S5). All FASTQ files were subsetted to 100,000 reads. A researcher can opt to run the extraction module on test data, without needing to run the alignment module beforehand. Test inputs to the extraction module, which include BAM files, their indices, and logs up through alignment, were generated by running BiocMAP with default settings, with the exception of using <italic>–trim_mode “force”</italic> in place of the default <italic>–trim_mode “adaptive”</italic>.</p>
    </sec>
    <sec id="Sec14">
      <title>AgeNeunSortedWGBS samples</title>
      <p id="Par46">The vignette provided with BiocMAP makes use of a dataset that includes 32 human postnatal dorsolateral prefrontal cortex samples up to 23 years of age [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR22">22</xref>]. Homogenate postmortem tissue was sorted with NeuN-based fluorescence-activated nuclear sorting to produce 8 glial and 24 neuronal samples. The Price et al. manuscript also included prenatal samples that were excluded for this analysis [<xref ref-type="bibr" rid="CR5">5</xref>].</p>
      <p id="Par47"><italic>HDF5Array</italic> 1.22.1 [<xref ref-type="bibr" rid="CR31">31</xref>] is used to load the <italic>bsseq</italic> objects partially into memory, while keeping the <italic>assays()</italic> on disk as <italic>DelayedMatrix</italic> objects from the <italic>DelayedArray</italic> 0.20.0 [<xref ref-type="bibr" rid="CR29">29</xref>] package. Exploratory plots use <italic>ggplot2</italic> 3.3.5 [<xref ref-type="bibr" rid="CR34">34</xref>] and the <italic>ggpairs()</italic> function from <italic>GGally</italic> 2.1.2 [<xref ref-type="bibr" rid="CR35">35</xref>]. Methylation curves at a genomic region with several individual DMRs are explored with <italic>plotRegion()</italic> from <italic>bsseq</italic> 1.30.0 [<xref ref-type="bibr" rid="CR11">11</xref>]. A total of 42 GB of memory is required to run this analysis, and the analysis completes in 55 min.</p>
    </sec>
    <sec id="Sec15">
      <title>Benchmark</title>
      <p id="Par48">BiocMAP was installed with “jhpce” mode and run with default configuration and command-line options. It was previously run with the same annotation settings on the testing machine, meaning the benchmarking run of BiocMAP excludes one-time steps related to pulling annotation files and encoding for use in Arioc. Because the first module of BiocMAP completed overnight, the second module was not run immediately in succession. The downtime between executions of the first and second modules of BiocMAP was not counted towards computing total wallclock duration (Fig. <xref rid="Fig5" ref-type="fig">5</xref>A).</p>
      <p id="Par49">First, a dry run of nf-core/methylseq [<xref ref-type="bibr" rid="CR23">23</xref>] was performed using the singularity profile and the <italic>GRCh38</italic> genome to install local files, singularity-related dependencies, and cache genome-related files. As its base configuration does not allow for execution on an SGE cluster where computational resources were available, the base configuration was modified. In particular, any memory request was modified to use the “mem_free” and “h_vmem” resources instead of Nextflow’s default of “virtual_free”; this was changed to meet JHPCE usage guidelines. The following segment of code was added to configuration to specify at most 40 concurrent processes, and usage of the SGE job scheduler, settings identical to BiocMAP: <graphic position="anchor" xlink:href="12859_2023_5461_Figc_HTML" id="MO8"/></p>
      <p id="Par50">Next, memory requests were raised for <italic>process_single</italic> and <italic>process_low</italic> to 20 G from 6 G and 12 G, respectively. This allowed singularity 3.6.0 to have sufficient memory to run on our machines. Finally, time limits were removed on all processes after exceeding some limits in initial tests. After establishing a successful configuration, nf-core/methylseq was run with otherwise default settings with the singularity profile and <italic>GRCh38</italic> reference genome.</p>
      <p id="Par51">Both BiocMAP and nf-core/methylseq were run on a system with enough RAM and CPUs, such that jobs were not on hold in the SGE queue. In other words, both software tools executed processing steps as soon as previous steps finished, enabling us to compare pipelines by total wallclock time.</p>
    </sec>
  </sec>
  <sec id="Sec16">
    <title>Discussion</title>
    <p id="Par52">Alignment to a reference genome is often the most computationally intensive component of a whole genome bisulfite sequencing (WGBS) data-processing workflow. As a result, workflows with an efficient alignment step can reduce total time required to process a dataset by a significant factor. CPU-based aligners like <italic>Bismark</italic> [<xref ref-type="bibr" rid="CR7">7</xref>] or the more recent <italic>BS-Seeker3</italic> [<xref ref-type="bibr" rid="CR36">36</xref>] can process WGBS samples in hours or days, but the GPU-based <italic>Arioc</italic> aligner offers higher alignment speeds than CPU-based aligners while maintaining comparable accuracy [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR37">37</xref>] (Additional file <xref rid="MOESM3" ref-type="media">3</xref>). Furthermore, we demonstrate that the BiocMAP workflow as a whole is significantly faster than comparable CPU-based workflows, making analyses of several-hundred-sample WGBS datasets feasible.</p>
    <p id="Par53">Given the recent introduction of GPUs and limited availability, researchers might not have access to GPUs on their main high performance computing (HPC) environment. HPC systems with GPUs might be under high demand or more expensive to use. Nextflow [<xref ref-type="bibr" rid="CR14">14</xref>] does not provide functionality for executing some processing steps in one HPC system, transferring files, and resuming executing processes on a second HPC system. For these reasons, BiocMAP was implemented as two separate modules such that processing steps that benefit from the presence of GPUs can be run on HPC systems with GPUs, and the remaining steps can be run on regular CPU-powered HPC systems. Ultimately, if you have access to a HPC system with GPUs, you might prefer to run both modules on such a system. In that situation, BiocMAP’s two modules can be run serially without having to edit the <italic>rules.txt</italic> file that is automatically generated by the alignment module.</p>
    <p id="Par54">While BiocMAP is already likely to align reads quickly through <italic>Arioc</italic> with default settings, researchers are highly encouraged to configure BiocMAP settings to most efficiently use <italic>Arioc</italic> given the available hardware as noted on the documentation website (Availability of data and materials). Most configuration variables used by <italic>Arioc</italic> [<xref ref-type="bibr" rid="CR8">8</xref>] can be directly edited in the appropriate BiocMAP configuration file (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S2). For example, the <italic>batchSize</italic> BiocMAP configuration variable is passed to the <italic>batchSize</italic> attribute of the <italic>AriocU</italic> or <italic>AriocP</italic> element of the configuration for <italic>AriocU</italic> or <italic>AriocP</italic>, which specifies how many reads <italic>Arioc</italic> can concurrently align per GPU utilized. This is one of many settings that depends on the specifications of the GPU(s) a researcher has available in their HPC system, which can be adjusted to achieve greater throughput. The <italic>max_gpus</italic> BiocMAP configuration variable specifies how many GPUs to use for alignment of each sample, potentially allowing increased parallelism when there is an abundance of GPU resources relative to number of samples in the experiment. A more comprehensive guide to adjusting BiocMAP configuration for a given computing environment is provided as part of the documentation website (Availability of data and materials).</p>
    <p id="Par55">We demonstrated how BiocMAP can be used to process publicly available WGBS data using an example dataset [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR22">22</xref>]. Additional file <xref rid="MOESM2" ref-type="media">2</xref> shows how you can then load the outputs of BiocMAP and use the data with R and Bioconductor packages such as <italic>bsseq</italic> [<xref ref-type="bibr" rid="CR11">11</xref>], <italic>ggplot2</italic> [<xref ref-type="bibr" rid="CR34">34</xref>], and <italic>GGally</italic> [<xref ref-type="bibr" rid="CR35">35</xref>] to perform exploratory data analysis as well as downstream statistical analyses. In addition, development versions of BiocMAP were used in other peer reviewed publications [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR38">38</xref>, <xref ref-type="bibr" rid="CR39">39</xref>] that have publicly available R code for several downstream analyses.</p>
    <p id="Par56">While we used a dataset of 32 samples to exemplify BiocMAP [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR22">22</xref>], memory requirements scale roughly linearly with number of samples, with the production of a 600-sample dataset requiring about 200 GB of RAM, despite CpH and CpG cytosines encompassing around half of the genome (depending on the GC content of the genome; private WGBS datasets). Thus BiocMAP is scalable to a sample size larger than most if not all current WGBS datasets. The 200 GB RAM can likely be drastically reduced by future internal BiocMAP updates and can definitely be reduced for any dataset once you apply a filter on the number of reads per cytosine, stored in the <italic>Cov</italic> assay. Despite the potentially large memory requirements for running BiocMAP, loading the output <italic>bsseq</italic> [<xref ref-type="bibr" rid="CR11">11</xref>] objects requires significantly less memory and is independent of the number of samples in the dataset, thanks to the HDF5 storage backend [<xref ref-type="bibr" rid="CR31">31</xref>]. Users most likely need around 20–30 GB of RAM to load filtered <italic>bsseq</italic> objects for downstream statistical analyses for the CpH context, while the CpG context object requires less than 1 GB of RAM.</p>
    <p id="Par57">We envision that most users will not be interested in tweaking WGBS processing steps as long as they generate the output in a reasonable amount of time, but instead will want to focus on downstream analyses. We implemented BiocMAP in such a way that it will benefit from community developments in Bioconductor [<xref ref-type="bibr" rid="CR13">13</xref>]. The main output data container is a <italic>bsseq</italic> [<xref ref-type="bibr" rid="CR11">11</xref>] object that is an extension of <italic>SummarizedExperiment</italic> [<xref ref-type="bibr" rid="CR12">12</xref>]. <italic>SummarizedExperiment</italic> itself is the one compatible with low-memory footprint backends such as <italic>HDF5Array</italic> [<xref ref-type="bibr" rid="CR31">31</xref>]. If <italic>SummarizedExperiment</italic> becomes more efficient, by for example providing a low-memory footprint option for the gene coordinates (<italic>rowRanges()</italic> slot), users of BiocMAP will benefit from the reduction in RAM required to generate and load BiocMAP’s outputs. Similarly, if new R/Bioconductor packages are developed that implement downstream statistical analyses, they will be compatible with BiocMAP’s output objects as they are the central format for DNA methylation data [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]. <italic>zellkonverter</italic> [<xref ref-type="bibr" rid="CR40">40</xref>] is a Bioconductor package that allows exporting <italic>SingleCellExperiment</italic> R objects to Python. Given that <italic>SingleCellExperiment</italic> is an extension of <italic>SummarizedExperiment</italic>, just like <italic>bsseq</italic>, it seems reasonable to expect that <italic>bsseq</italic> objects will be readable from Python. Given these reasons, we envision that BiocMAP’s users will be able to use the resulting <italic>bsseq</italic> objects with any new methods implemented in R and most likely Python, two of the most widely used programming languages.</p>
    <p id="Par58">Despite the potential for customization within BiocMAP, it is designed to run “out of the box”, without a strict need to make hardware-specific configuration. This enables researchers to focus on their particular analysis questions instead of technical processing details.</p>
  </sec>
  <sec id="Sec17">
    <title>Conclusion</title>
    <p id="Par59">We implemented a whole genome bisulfite sequencing (WGBS) data processing workflow that relies on the GPU-accelerated <italic>Arioc</italic> aligner [<xref ref-type="bibr" rid="CR8">8</xref>], yet is flexible enough to be used on multiple high performance computing (HPC) systems. The alignment output is further processed and packaged into <italic>bsseq</italic> [<xref ref-type="bibr" rid="CR11">11</xref>] R/Bioconductor objects that are memory efficient and deeply integrated with the R/Bioconductor open source software ecosystem [<xref ref-type="bibr" rid="CR13">13</xref>]. Thus BiocMAP will get the data processing job done in a fast and efficient manner for WGBS datasets up to several hundred samples, allowing researchers to focus their attention on exploratory data analysis and downstream statistical analyses. BiocMAP is available and documented at <ext-link ext-link-type="uri" xlink:href="http://research.libd.org/BiocMAP/">http://research.libd.org/BiocMAP/</ext-link>.</p>
  </sec>
  <sec id="Sec18">
    <title>Availability and requirements</title>
    <p id="Par60">Project name: BiocMAP</p>
    <p id="Par61">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/LieberInstitute/BiocMAP">https://github.com/LieberInstitute/BiocMAP</ext-link></p>
    <p id="Par62">Operating system(s): Linux</p>
    <p id="Par63">Programming language: Nextflow, R, Groovy</p>
    <p id="Par64">Other requirements: Java 8 or higher, access to NVIDIA GPU(s), Singularity or Docker (recommended)</p>
    <p id="Par65">License: GNU GPLv3</p>
    <p id="Par66">Any restrictions to use by non-academics: N/A</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec20">
      <title>Supplementary information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5461_MOESM1_ESM.xlsx">
            <caption>
              <p><bold>Additional file 1.</bold> Various tables with information about BiocMAP inputs, outputs, test files, and more. This is provided as a multi-sheet excel file, with each sheet described in more detail below. S1: List of output metrics collected by BiocMAP. These are various quantities aggregated from processing steps like <italic>FastQC</italic> [15], trimming, alignment, and methylation extraction. Together they form an R <italic>data.frame</italic> accessible from the file <italic>metrics.rda</italic> and from within the <italic>colData()</italic> of output <italic>bsseq</italic> [11] objects. For paired-end samples, some metrics are computed separately for each mate, in which case metric names are appended with “_R1” and “_R2” to refer to each mate, respectively. S2: BiocMAP execution scripts and associated configuration files. BiocMAP provides several potential files for out-of-the-box functionality on local Linux machines as well as on SLURM or SGE-managed computing clusters. S3: Content of <italic>rules.txt</italic>. Each line of this input file to the extraction BiocMAP module consists of key-value pairs of the form <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;key&gt; = &lt;value&gt;$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mi>e</mml:mi><mml:mi>y</mml:mi><mml:mo>&gt;</mml:mo><mml:mo>=</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mo>&gt;</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5461_Article_IEq4.gif"/></alternatives></inline-formula>, some of which are required. S4: Intermediate output files. These files are not the main output files of interest from running both modules of BiocMAP, but are generated along the way as byproducts. S5: Sources of test data provided in the BiocMAP repository. Human and mouse single-end and paired-end samples are provided to allow users to quickly verify proper installation of BiocMAP, sourced from SRA or the FlowRNA-WGBS dataset.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2023_5461_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2.</bold> Example vignette showing the use of BiocMAP output objects in downstream analysis. This is a PDF file walking through R code and exploratory plots applied on the Price et al. data [22]. This file is also available from the BiocMAP GitHub repository (Availability of data and materials).</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2023_5461_MOESM3_ESM.pdf">
            <caption>
              <p><bold>Additional file 3.</bold> Comparison of alignment results between Arioc and Bismark. In 94 postmortem human brain samples from the dorsolateral prefrontal cortex (DLPFC) and hippocampus (HIPPO) [40], Arioc 1.25.2401.18201 [8] maps reads at a consistently higher rate than Bismark 0.19.0 [7], while finding similar methylation rates in different cytosine contexts. Results are colored by brain region and diagnosis (control and schizophrenia), but are fairly uniform across these categories, with the exception of generally higher CHG-context methylation reported by both tools in the DLPFC.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>BiocMAP</term>
        <def>
          <p id="Par4">Bioconductor-friendly Nextflow-based methylation analysis pipeline</p>
        </def>
      </def-item>
      <def-item>
        <term>CpG</term>
        <def>
          <p id="Par5">Cytosine preceding a guanine (methylation context)</p>
        </def>
      </def-item>
      <def-item>
        <term>CpH</term>
        <def>
          <p id="Par6">Cytosine preceding a nucleotide other than guanine (methylation context)</p>
        </def>
      </def-item>
      <def-item>
        <term>CHG</term>
        <def>
          <p id="Par7">Cytosine followed by non-guanine nucleotide, then guanine (methylation context)</p>
        </def>
      </def-item>
      <def-item>
        <term>CHH</term>
        <def>
          <p id="Par8">Cytosine followed by two nucleotides other than guanine (methylation context)</p>
        </def>
      </def-item>
      <def-item>
        <term>CPU</term>
        <def>
          <p id="Par9">Central processing unit</p>
        </def>
      </def-item>
      <def-item>
        <term>CUDA</term>
        <def>
          <p id="Par10">Compute unified device architecture</p>
        </def>
      </def-item>
      <def-item>
        <term>DMR</term>
        <def>
          <p id="Par11">Differentially methylated region</p>
        </def>
      </def-item>
      <def-item>
        <term>GPU</term>
        <def>
          <p id="Par12">Graphics processing unit</p>
        </def>
      </def-item>
      <def-item>
        <term>HPC</term>
        <def>
          <p id="Par13">High performance computing</p>
        </def>
      </def-item>
      <def-item>
        <term>NCBI</term>
        <def>
          <p id="Par14">National Center for Biotechnology Information</p>
        </def>
      </def-item>
      <def-item>
        <term>RAM</term>
        <def>
          <p id="Par15">Random access memory</p>
        </def>
      </def-item>
      <def-item>
        <term>SGE</term>
        <def>
          <p id="Par16">Sun grid engine or son of grid engine</p>
        </def>
      </def-item>
      <def-item>
        <term>SLURM</term>
        <def>
          <p id="Par17">Simple Linux Utility for Resource Management</p>
        </def>
      </def-item>
      <def-item>
        <term>SRA</term>
        <def>
          <p id="Par18">Sequence read archive</p>
        </def>
      </def-item>
      <def-item>
        <term>WGBS</term>
        <def>
          <p id="Par19">Whole genome bisulfite sequencing</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to thank Anandita Rajpurohit and Kira A. Perzel Mandell (Lieber Institute for Brain Development), and Amanda J. Price (National Institute of Child Health and Human Development) for their suggestions on how to best present BiocMAP. Geo Pertea (LIBD) helped us proofread the documentation of BiocMAP. We would like to thank the Joint High Performance Computing Exchange (JHPCE) for providing computing resources for these analyses.</p>
    <sec id="d32e1457">
      <title>Authors’ information</title>
      <p id="Par67">Andrew E Jaffe is currently an employee and shareholder of Neumora Therapeutics, which is unrelated to the contents of this manuscript.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>NJE and AEJ designed the software, then NJE and RW implemented the software. NJE and LCT wrote the manuscript draft. All authors contributed to revising the manuscript and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the Lieber Institute for Brain Development (NJE, AEJ, LCT). This work was also supported by contract # VA-241-17-C-0138, funding from the VA Connecticut Health Care System, West Haven, CT, Central Texas Veterans Health Care System, Temple, TX, Durham VA Healthcare System, Durham NC, VA San Diego Healthcare System, La Jolla, CA, VA Boston Healthcare System, Boston, MA, USA and the National Center for PTSD, U.S. Department of Veterans Affairs. The views expressed here are those of the authors and do not necessarily reflect the position or policy of the Department of Veterans Affairs (VA) or the U.S. government. All funding bodies had no role in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The BiocMAP software is available from GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/LieberInstitute/BiocMAP">https://github.com/LieberInstitute/BiocMAP</ext-link> [<xref ref-type="bibr" rid="CR9">9</xref>], with documentation at <ext-link ext-link-type="uri" xlink:href="http://research.libd.org/BiocMAP/">http://research.libd.org/BiocMAP/</ext-link>. The WGBS data used in the example vignette is available from <ext-link ext-link-type="uri" xlink:href="https://www.synapse.org/#%21Synapse:syn5842535">https://www.synapse.org/#!Synapse:syn5842535</ext-link> [<xref ref-type="bibr" rid="CR5">5</xref>]. The original version of the lambda genome is available at <ext-link ext-link-type="uri" xlink:href="ftp://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/000/840/245/GCA_000840245.1_ViralProj14204/GCA_000840245.1_ViralProj14204_genomic.fna.gz">ftp://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/000/840/245/GCA_000840245.1_ViralProj14204/GCA_000840245.1_ViralProj14204_genomic.fna.gz</ext-link>. Docker images required for BiocMAP are hosted at <ext-link ext-link-type="uri" xlink:href="https://hub.docker.com/orgs/libddocker/repositories">https://hub.docker.com/orgs/libddocker/repositories</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par68">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par69">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par70">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moore</surname>
            <given-names>LD</given-names>
          </name>
          <name>
            <surname>Le</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>DNA methylation and its basic function</article-title>
        <source>Neuropsychopharmacology</source>
        <year>2013</year>
        <volume>38</volume>
        <issue>1</issue>
        <fpage>23</fpage>
        <lpage>38</lpage>
        <pub-id pub-id-type="doi">10.1038/npp.2012.112</pub-id>
        <?supplied-pmid 22781841?>
        <pub-id pub-id-type="pmid">22781841</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Avery</surname>
            <given-names>OT</given-names>
          </name>
          <name>
            <surname>Macleod</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>McCarty</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Studies on the chemical nature of the substance inducing transformation of pneumococcal types: induction of transformation by a desoxyribonucleic acid fraction isolated from pneumococcus type III</article-title>
        <source>J Exp Med</source>
        <year>1944</year>
        <volume>79</volume>
        <issue>2</issue>
        <fpage>137</fpage>
        <lpage>158</lpage>
        <pub-id pub-id-type="doi">10.1084/jem.79.2.137</pub-id>
        <?supplied-pmid 19871359?>
        <pub-id pub-id-type="pmid">19871359</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harrison</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Parle-McDermott</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>DNA methylation: a timeline of methods and applications</article-title>
        <source>Front Genet</source>
        <year>2011</year>
        <volume>2</volume>
        <fpage>74</fpage>
        <pub-id pub-id-type="doi">10.3389/fgene.2011.00074</pub-id>
        <?supplied-pmid 22303369?>
        <pub-id pub-id-type="pmid">22303369</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harris</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Coarfa</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Nagarajan</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Hong</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Downey</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Fouse</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Delaney</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Olshen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ballinger</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Forsberg</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Gu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Echipare</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>O’Geen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lister</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Pelizzola</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Xi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Epstein</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Bernstein</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Hawkins</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Chung</surname>
            <given-names>W-Y</given-names>
          </name>
          <name>
            <surname>Gu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bock</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gnirke</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>MQ</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ecker</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Farnham</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Waterland</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Meissner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Marra</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Hirst</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Milosavljevic</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Costello</surname>
            <given-names>JF</given-names>
          </name>
        </person-group>
        <article-title>Comparison of sequencing-based methods to profile DNA methylation and identification of monoallelic epigenetic modifications</article-title>
        <source>Nat Biotechnol</source>
        <year>2010</year>
        <volume>28</volume>
        <issue>10</issue>
        <fpage>1097</fpage>
        <lpage>1105</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1682</pub-id>
        <?supplied-pmid 20852635?>
        <pub-id pub-id-type="pmid">20852635</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Collado-Torres</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ivanov</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Xia</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Burke</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Shin</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Tao</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Jia</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hyde</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Kleinman</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Weinberger</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Jaffe</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>Divergent neuronal DNA methylation patterns across human cortical development reveal critical periods and a unique role of CpH methylation</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>196</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1805-1</pub-id>
        <?supplied-pmid 31554518?>
        <pub-id pub-id-type="pmid">31554518</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Perzel Mandell</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Price</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Wilton</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Collado-Torres</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Tao</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Eagles</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Szalay</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Hyde</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Weinberger</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Kleinman</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Jaffe</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>Characterizing the dynamic and functional DNA methylation landscape in the developing human cortex</article-title>
        <source>Epigenetics</source>
        <year>2021</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1080/15592294.2020.1786304</pub-id>
        <?supplied-pmid 32602773?>
        <pub-id pub-id-type="pmid">32602773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krueger</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Bismark: a flexible aligner and methylation caller for Bisulfite-Seq applications</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>11</issue>
        <fpage>1571</fpage>
        <lpage>1572</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr167</pub-id>
        <?supplied-pmid 21493656?>
        <pub-id pub-id-type="pmid">21493656</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilton</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Budavari</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wheelan</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Szalay</surname>
            <given-names>AS</given-names>
          </name>
        </person-group>
        <article-title>Arioc: high-throughput read alignment with GPU-accelerated exploration of the seed-and-extend search space</article-title>
        <source>PeerJ</source>
        <year>2015</year>
        <volume>3</volume>
        <fpage>808</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj.808</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Nick-Eagles: LieberInstitute/BiocMAP: v0-draft, 2022. <pub-id pub-id-type="doi">10.5281/zenodo.6425727</pub-id>. Accessed 08 Apr 2022.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">R Core Team. R: a language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria; 2021. R Foundation for Statistical Computing. <ext-link ext-link-type="uri" xlink:href="https://www.R-project.org/">https://www.R-project.org/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hansen</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>BSmooth: from whole genome bisulfite sequencing reads to differentially methylated regions</article-title>
        <source>Genome Biol</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>10</issue>
        <fpage>83</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2012-13-10-r83</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Morgan M, Obenchain V, Hester J, Pagès H. SummarizedExperiment: SummarizedExperiment Container. 2021. R package version 1.24.0. <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/SummarizedExperiment">https://bioconductor.org/packages/SummarizedExperiment</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>VJ</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Carlson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Carvalho</surname>
            <given-names>BS</given-names>
          </name>
          <name>
            <surname>Bravo</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gatto</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Girke</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gottardo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hahne</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hansen</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>MacDonald</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Obenchain</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Ole’s</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Pagès</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Reyes</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shannon</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Tenenbaum</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Waldron</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Morgan</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Orchestrating high-throughput genomic analysis with bioconductor</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <issue>2</issue>
        <fpage>115</fpage>
        <lpage>121</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3252</pub-id>
        <?supplied-pmid 25633503?>
        <pub-id pub-id-type="pmid">25633503</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Di Tommaso</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Chatzou</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Floden</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Barja</surname>
            <given-names>PP</given-names>
          </name>
          <name>
            <surname>Palumbo</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Notredame</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Nextflow enables reproducible computational workflows</article-title>
        <source>Nat Biotechnol</source>
        <year>2017</year>
        <volume>35</volume>
        <issue>4</issue>
        <fpage>316</fpage>
        <lpage>319</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3820</pub-id>
        <?supplied-pmid 28398311?>
        <pub-id pub-id-type="pmid">28398311</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Andrews S. FastQC: a quality control tool for high throughput sequence data, 2018. <ext-link ext-link-type="uri" xlink:href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">https://www.bioinformatics.babraham.ac.uk/projects/fastqc/</ext-link>. Accessed 12 Apr 2022.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Krueger F. Trim Galore: a wrapper tool around Cutadapt and FastQC to consistently apply quality and adapter trimming to FastQ files, 2020. <ext-link ext-link-type="uri" xlink:href="https://www.bioinformatics.babraham.ac.uk/projects/trim_galore/">https://www.bioinformatics.babraham.ac.uk/projects/trim_galore/</ext-link>. Accessed 08 Apr 2022.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Ryan D. A (mostly) universal methylation extractor for BS-seq experiments, 2021. <ext-link ext-link-type="uri" xlink:href="https://github.com/dpryan79/MethylDackel">https://github.com/dpryan79/MethylDackel</ext-link>. Accessed 12 Apr 2022.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ritchie</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Phipson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Law</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <issue>7</issue>
        <fpage>47</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv007</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oliver</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Jenkinson</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Olson</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Shultz-Rogers</surname>
            <given-names>LE</given-names>
          </name>
          <name>
            <surname>Klee</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <article-title>Detection of outlier methylation from bisulfite sequencing data with novel bioconductor package borealis</article-title>
        <source>bioRxiv</source>
        <year>2022</year>
        <pub-id pub-id-type="doi">10.1101/2022.05.19.492700</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Gong B. MethCP. Bioconductor 2019.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peters</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Buckley</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Statham</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Pidsley</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Samaras</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lord</surname>
            <given-names>RV</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Molloy</surname>
            <given-names>PL</given-names>
          </name>
        </person-group>
        <article-title>De novo identification of differentially methylated regions in the human genome</article-title>
        <source>Epigenetics Chromatin</source>
        <year>2015</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>6</fpage>
        <pub-id pub-id-type="doi">10.1186/1756-8935-8-6</pub-id>
        <?supplied-pmid 25972926?>
        <pub-id pub-id-type="pmid">25972926</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Price AJ. LIBD-WGBS, 2016. <pub-id pub-id-type="doi">10.7303/syn5842535</pub-id>. Accessed 08 Apr 2022.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Ewels P, Hüther P, Spix N, Miller E, Bot N-C, Hörtenhuber M, Peltzer A, F, S, Alneberg J, Di Tommaso P, Garcia MU, Davenport C, Ajith V, Krueger F, Patel H, Alessia, Devailly G, Syme R, VIJAY, Menden K, Céline N. nf-core/methylseq: nf-core/methylseq version 2.3.0 [Pyrite Alligator]. Zenodo 2022.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Handsaker</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wysoker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Homer</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>1000 genome project data processing subgroup: the sequence alignment/map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>16</issue>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <?supplied-pmid 19505943?>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Faust</surname>
            <given-names>GG</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>IM</given-names>
          </name>
        </person-group>
        <article-title>SAMBLASTER: fast duplicate marking and structural variant read extraction</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>17</issue>
        <fpage>2503</fpage>
        <lpage>2505</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu314</pub-id>
        <?supplied-pmid 24812344?>
        <pub-id pub-id-type="pmid">24812344</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bray</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Pimentel</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Melsted</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Near-optimal probabilistic RNA-seq quantification</article-title>
        <source>Nat Biotechnol</source>
        <year>2016</year>
        <volume>34</volume>
        <issue>5</issue>
        <fpage>525</fpage>
        <lpage>527</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3519</pub-id>
        <?supplied-pmid 27043002?>
        <pub-id pub-id-type="pmid">27043002</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leontiou</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Hadjidaniel</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Mina</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Antoniou</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ioannides</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Patsalis</surname>
            <given-names>PC</given-names>
          </name>
        </person-group>
        <article-title>Bisulfite conversion of DNA: performance comparison of different kits and methylation quantitation of epigenetic biomarkers that have the potential to be used in non-invasive prenatal testing</article-title>
        <source>PLoS ONE</source>
        <year>2015</year>
        <volume>10</volume>
        <issue>8</issue>
        <fpage>0135058</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0135058</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eagles</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Burke</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Leonard</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Barry</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Stolz</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Huuki</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Phan</surname>
            <given-names>BN</given-names>
          </name>
          <name>
            <surname>Serrato</surname>
            <given-names>VL</given-names>
          </name>
          <name>
            <surname>Gutiérrez-Millán</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Aguilar-Ordoñez</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Jaffe</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Collado-Torres</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>SPEAQeasy: a scalable pipeline for expression analysis and quantification for r/bioconductor-powered RNA-seq analyses</article-title>
        <source>BMC Bioinform</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>224</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-021-04142-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Pagès H, with contributions from Peter Hickey, Lun A. DelayedArray: a unified framework for working transparently with on-disk and in-memory array-like datasets. 2021. R package version 0.20.0. <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/DelayedArray">https://bioconductor.org/packages/DelayedArray</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hansen</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>BSmooth: from whole genome bisulfite sequencing reads to differentially methylated regions</article-title>
        <source>Genome Biol</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>10</issue>
        <fpage>83</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2012-13-10-r83</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Pagès H. HDF5Array: HDF5 backend for DelayedArray objects. 2021. R package version 1.22.1. <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/HDF5Array">https://bioconductor.org/packages/HDF5Array</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Collado-Torres L. LieberInstitute/shinycsv: Zenodo integration. Zenodo 2019. <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/badge/latestdoi/72884509">https://zenodo.org/badge/latestdoi/72884509</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frankish</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Diekhans</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ferreira</surname>
            <given-names>A-M</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Jungreis</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Loveland</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mudge</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Sisu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Armstrong</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Barnes</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Berry</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bignell</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Carbonell Sala</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chrast</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cunningham</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Di Domenico</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Donaldson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fiddes</surname>
            <given-names>IT</given-names>
          </name>
          <name>
            <surname>García Girón</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gonzalez</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Grego</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hardy</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hourlier</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hunt</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Izuogu</surname>
            <given-names>OG</given-names>
          </name>
          <name>
            <surname>Lagarde</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Martínez</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mohanan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Muir</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Navarro</surname>
            <given-names>FCP</given-names>
          </name>
          <name>
            <surname>Parker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pei</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Pozo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ruffier</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schmitt</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Stapleton</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Suner</surname>
            <given-names>M-M</given-names>
          </name>
          <name>
            <surname>Sycheva</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Uszczynska-Ratajczak</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yates</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zerbino</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Aken</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Choudhary</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Guigó</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hubbard</surname>
            <given-names>TJP</given-names>
          </name>
          <name>
            <surname>Kellis</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Paten</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Reymond</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tress</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Flicek</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>GENCODE reference annotation for the human and mouse genomes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>D1</issue>
        <fpage>766</fpage>
        <lpage>773</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky955</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Wickham H. Ggplot2: elegant graphics for data analysis. Springer; 2016. <ext-link ext-link-type="uri" xlink:href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <mixed-citation publication-type="other">Schloerke B, Cook D, Larmarange J, Briatte F, Marbach M, Thoen E, Elberg A, Crowley J. GGally: extension to ’ggplot2’. 2021. R package version 2.1.2. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=GGally">https://CRAN.R-project.org/package=GGally</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>KYY</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Y-J</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>P-Y</given-names>
          </name>
        </person-group>
        <article-title>BS-Seeker3: ultrafast pipeline for bisulfite sequencing</article-title>
        <source>BMC Bioinform</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>111</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-018-2120-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Jaffe AE. LIBD-WGBS-SCZD, 2021. <pub-id pub-id-type="doi">10.7303/syn4921369</pub-id>. Accessed 18 Jul 2023.</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Perzel Mandell</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Eagles</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Wilton</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Price</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Semick</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Collado-Torres</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ulrich</surname>
            <given-names>WS</given-names>
          </name>
          <name>
            <surname>Tao</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Szalay</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Hyde</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Kleinman</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Weinberger</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Jaffe</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide sequencing-based identification of methylation quantitative trait loci and their role in schizophrenia risk</article-title>
        <source>Nat Commun</source>
        <year>2021</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>5251</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-25517-3</pub-id>
        <?supplied-pmid 34475392?>
        <pub-id pub-id-type="pmid">34475392</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Perzel Mandell</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Eagles</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Deep-Soboslay</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tao</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wilton</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Szalay</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Hyde</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Kleinman</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Jaffe</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Weinberger</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Molecular phenotypes associated with antipsychotic drugs in the human caudate nucleus</article-title>
        <source>Mol Psychiatry</source>
        <year>2022</year>
        <volume>27</volume>
        <fpage>2061</fpage>
        <lpage>2067</lpage>
        <pub-id pub-id-type="doi">10.1038/s41380-022-01453-6</pub-id>
        <?supplied-pmid 35236959?>
        <pub-id pub-id-type="pmid">35236959</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">Zappia L, Lun A. Zellkonverter: conversion between scRNA-seq objects. 2021. R package version 1.4.0. <ext-link ext-link-type="uri" xlink:href="https://github.com/theislab/zellkonverter">https://github.com/theislab/zellkonverter</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10498615</article-id>
    <article-id pub-id-type="pmid">37704947</article-id>
    <article-id pub-id-type="publisher-id">5461</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05461-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>BiocMAP: a Bioconductor-friendly, GPU-accelerated pipeline for bisulfite-sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Eagles</surname>
          <given-names>Nicholas J.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wilton</surname>
          <given-names>Richard</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jaffe</surname>
          <given-names>Andrew E.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2140-308X</contrib-id>
        <name>
          <surname>Collado-Torres</surname>
          <given-names>Leonardo</given-names>
        </name>
        <address>
          <email>lcolladotor@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/04q36wn27</institution-id><institution-id institution-id-type="GRID">grid.429552.d</institution-id><institution-id institution-id-type="ISNI">0000 0004 5913 1291</institution-id><institution>Lieber Institute for Brain Development, Johns Hopkins Medical Campus, </institution></institution-wrap>Baltimore, 21205 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00za53h95</institution-id><institution-id institution-id-type="GRID">grid.21107.35</institution-id><institution-id institution-id-type="ISNI">0000 0001 2171 9311</institution-id><institution>Department of Physics and Astronomy, </institution><institution>Johns Hopkins University, </institution></institution-wrap>Baltimore, 21218 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>340</elocation-id>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>4</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>8</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Bisulfite sequencing is a powerful tool for profiling genomic methylation, an epigenetic modification critical in the understanding of cancer, psychiatric disorders, and many other conditions. Raw data generated by whole genome bisulfite sequencing (WGBS) requires several computational steps before it is ready for statistical analysis, and particular care is required to process data in a timely and memory-efficient manner. Alignment to a reference genome is one of the most computationally demanding steps in a WGBS workflow, taking several hours or even days with commonly used WGBS-specific alignment software. This naturally motivates the creation of computational workflows that can utilize GPU-based alignment software to greatly speed up the bottleneck step. In addition, WGBS produces raw data that is large and often unwieldy; a lack of memory-efficient representation of data by existing pipelines renders WGBS impractical or impossible to many researchers.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We present BiocMAP, a Bioconductor-friendly methylation analysis pipeline consisting of two modules, to address the above concerns. The first module performs computationally-intensive read alignment using <italic>Arioc</italic>, a GPU-accelerated short-read aligner. Since GPUs are not always available on the same computing environments where traditional CPU-based analyses are convenient, the second module may be run in a GPU-free environment. This module extracts and merges DNA methylation proportions—the fractions of methylated cytosines across all cells in a sample at a given genomic site. Bioconductor-based output objects in R utilize an on-disk data representation to drastically reduce required main memory and make WGBS projects computationally feasible to more researchers.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">BiocMAP is implemented using Nextflow and available at <ext-link ext-link-type="uri" xlink:href="http://research.libd.org/BiocMAP/">http://research.libd.org/BiocMAP/</ext-link>. To enable reproducible analysis across a variety of typical computing environments, BiocMAP can be containerized with Docker or Singularity, and executed locally or with the SLURM or SGE scheduling engines. By providing Bioconductor objects, BiocMAP’s output can be integrated with powerful analytical open source software for analyzing methylation data.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05461-3.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>WGBS</kwd>
      <kwd>Bioconductor</kwd>
      <kwd>Pipeline</kwd>
      <kwd>Arioc</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000738</institution-id>
            <institution>U.S. Department of Veterans Affairs</institution>
          </institution-wrap>
        </funding-source>
        <award-id>VA-241-17-C-0138</award-id>
        <principal-award-recipient>
          <name>
            <surname>Eagles</surname>
            <given-names>Nicholas J.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par20">The genome of many organisms is more than just a sequence of four nucleotides. These nucleotides can be chemically modified, and a common modification is the methylation of cytosines [<xref ref-type="bibr" rid="CR1">1</xref>], which was discovered in mammals as early as DNA itself [<xref ref-type="bibr" rid="CR2">2</xref>]. The percent of methylated cytosines was first measured across a significant portion of the human genome using methylation arrays [<xref ref-type="bibr" rid="CR3">3</xref>]. With the advent of whole genome sequencing, whole genome bisulfite sequencing (WGBS) became a reality, allowing researchers to study methylated cytosines in different contexts (CpG, CpH) [<xref ref-type="bibr" rid="CR4">4</xref>] and experimental settings [<xref ref-type="bibr" rid="CR3">3</xref>]. However, population-scale studies have generally been limited to microarrays due to complexities in sample pre-processing required for WGBS. While methylation typically occurs primarily at cytosines in CpG context in almost all cell and tissue types, CpH-context methylation is present and plays a significant role in the brain [<xref ref-type="bibr" rid="CR5">5</xref>]. In contrast to microarrays, WGBS captures CpH methylation and novel CpG loci. Furthermore, a study by Perzell Mandell et al. [<xref ref-type="bibr" rid="CR6">6</xref>] exploring age and sex-associated methylation differences in human dorsolateral prefrontal cortex samples found that more than 97% of significant CpG loci were unmeasured by microarrays.</p>
    <p id="Par21">Raw sequencing reads require several computational processing steps to produce DNA methylation proportions, a feature ready for statistical analysis. Among the most computationally demanding steps is alignment of reads to a reference genome, where software must consider alignments across reference sequences from 4 methylation states: methylated and unmethylated cytosines under directional and non-directional library preparation protocols. With currently available CPUs, alignment software such as <italic>Bismark</italic> [<xref ref-type="bibr" rid="CR7">7</xref>] may require hours or days to align a single WGBS sample. The <italic>Arioc</italic> [<xref ref-type="bibr" rid="CR8">8</xref>] aligner, which uses GPU acceleration to compute WGBS alignments, achieves processing speeds that are an order of magnitude faster without sacrificing accuracy or sensitivity. This provides a natural motivation for the implementation of a workflow that can use GPUs for alignment but CPUs for remaining processing steps. However, the use of GPUs for non-graphics-related tasks is still in its infancy, and GPU resources are sometimes not available on the same computing clusters where traditional CPU and memory resources are abundant.</p>
    <p id="Par22">We introduce BiocMAP [<xref ref-type="bibr" rid="CR9">9</xref>], a <bold>Bioc</bold>onductor-friendly <bold>M</bold>ethylation <bold>A</bold>nalysis <bold>P</bold>ipeline for processing bisulfite-sequencing data into analysis-ready R [<xref ref-type="bibr" rid="CR10">10</xref>] objects. As <italic>bsseq</italic> [<xref ref-type="bibr" rid="CR11">11</xref>] objects, BiocMAP outputs extend the popular <italic>SummarizedExperiment</italic> [<xref ref-type="bibr" rid="CR12">12</xref>] format and are readily analyzable with a number of Bioconductor [<xref ref-type="bibr" rid="CR13">13</xref>] R [<xref ref-type="bibr" rid="CR10">10</xref>] packages, making WGBS research convenient for more of the computational genomics community. BiocMAP is split into two modules that can be executed in different computing environments; this can allow a researcher to align samples in a computing environment with ample GPU resources, but perform “methylation extraction”—calculating the fraction of methylated cytosines at a given genomic site—and remaining processing steps in an environment with more CPUs and memory. BiocMAP is built using Nextflow [<xref ref-type="bibr" rid="CR14">14</xref>], a popular workflow-management framework enabling simple configuration, effective parallelization, and straightforward support of multiple computing environments. Small edits to configuration files allow any Nextflow workflow to run with Sun/Son of Grid Engine (SGE) or Simple Linux Utility for Resource Management (SLURM) job schedulers, in cloud environments like Google Cloud or Amazon Web Services, and running pipeline components inside Docker or Singularity containers.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Overview</title>
      <p id="Par23">The BiocMAP workflow consists of a set of two modules—alignment and extraction, which together process raw WGBS reads in FASTQ format into Bioconductor-friendly [<xref ref-type="bibr" rid="CR13">13</xref>] R [<xref ref-type="bibr" rid="CR10">10</xref>] objects containing DNA methylation proportions essentially as a cytosine-by-sample matrix (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). In the first alignment module, an initial quality check is performed with <italic>FastQC</italic> [<xref ref-type="bibr" rid="CR15">15</xref>], after which samples are trimmed with <italic>Trim Galore!</italic> [<xref ref-type="bibr" rid="CR16">16</xref>], aligned to a reference genome with <italic>Arioc</italic> [<xref ref-type="bibr" rid="CR8">8</xref>], and low-quality or duplicate mappings are filtered out.<fig id="Fig1"><label>Fig. 1</label><caption><p>BiocMAP workflow overview. Diagram representing the conceptual workflow traversed by BiocMAP. The red box indicates the FASTQ files are inputs to the pipeline; green coloring denotes major output files from the pipeline; the remaining boxes represent computational steps. Yellow and orange-colored steps are optional or not always performed; for example, lambda pseudoalignment is an optional step intended for experiments with spike-ins of the lambda bacteriophage. Finally, blue-colored steps are ordinary processes which occur on every pipeline execution. Depending on the available high performance computing (HPC) systems, both modules can be run sequentially on a HPC system with both GPUs and CPUs, or the alignment module can be run on a GPU-powered HPC system, then files transferred to a CPU-based HPC system as well as updating file paths on the <italic>rules.txt</italic> file (dotted line), before running the extraction module on the CPU-based HPC system</p></caption><graphic xlink:href="12859_2023_5461_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par24">In the second extraction module, DNA methylation proportion extraction is performed within each sample using <italic>MethylDackel</italic> [<xref ref-type="bibr" rid="CR17">17</xref>] or optionally <italic>Bismark</italic> [<xref ref-type="bibr" rid="CR7">7</xref>], and the results are aggregated across samples into a pair of <italic>bsseq</italic> [<xref ref-type="bibr" rid="CR11">11</xref>] R [<xref ref-type="bibr" rid="CR10">10</xref>] objects for easy integration with a number of Bioconductor [<xref ref-type="bibr" rid="CR13">13</xref>] packages to facilitate downstream statistical analyses. Some examples include <italic>limma</italic> [<xref ref-type="bibr" rid="CR18">18</xref>] for linear modeling, <italic>Borealis</italic> [<xref ref-type="bibr" rid="CR19">19</xref>] for outlier detection, and <italic>MethCP</italic> [<xref ref-type="bibr" rid="CR20">20</xref>] and <italic>DMRcate</italic> [<xref ref-type="bibr" rid="CR21">21</xref>] for finding differentially methylated regions. The first <italic>bsseq</italic> object contains counts of methylated and unmethylated cytosines in CpG context across the entire reference genome, while the second object contains any additional cytosines in CpH context, when relevant (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). A summary table is also produced, compiling together metrics and statistics from trimming, alignment, and methylation extraction for each sample (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S1). Examples of information gathered include percent of reads concordantly aligned and percent of reads trimmed. This allows researchers to control for potential covariates and unintended sources of variation when performing downstream statistical analyses such as the identification of differentially methylated regions (DMRs) [<xref ref-type="bibr" rid="CR11">11</xref>].<fig id="Fig2"><label>Fig. 2</label><caption><p><italic>bsseq</italic> output objects. The major outputs from the extraction module are R objects from the <italic>bsseq</italic> Bioconductor package, which contain methylation proportion and coverage information at all cytosine loci in the human genome. <italic>bsseq</italic> extends the <italic>SummarizedExperiment</italic> class, which provides a general and popular format for storing genomics data and is memory efficient thanks to the <italic>HDF5Array</italic> backend. Two <italic>bsseq</italic> objects are produced, with one object containing cytosine sites in CpG context, and the other containing the remaining CpH loci</p></caption><graphic xlink:href="12859_2023_5461_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Application</title>
      <p id="Par25">To demonstrate how BiocMAP outputs might be used to perform statistical analysis and visualization on real WGBS data (Additional file <xref rid="MOESM2" ref-type="media">2</xref>), we used a publicly available dataset and illustrate an example analysis [<xref ref-type="bibr" rid="CR9">9</xref>]. The dataset used includes 32 human brain dorsolateral prefrontal cortex (DLPFC) samples spanning developmental years from postnatal up to 23 years of age [<xref ref-type="bibr" rid="CR22">22</xref>]. NeuN-based fluorescence-activated nuclear sorting was used to produce 8 glial and 24 neuronal samples from the homogenate DLPFC tissue. Prenatal samples present in Price et al. [<xref ref-type="bibr" rid="CR5">5</xref>] were excluded for this analysis. As CpH methylation is known to be crucially involved in age-related neuronal development [<xref ref-type="bibr" rid="CR5">5</xref>], this dataset exemplifies a practical research use-case for BiocMAP analysis. As a whole-genome human dataset, it also reflects the potentially large scale of data possible to process with BiocMAP. The first module was run with the default <italic>jhpce</italic> configuration, which runs at most 40 concurrent Nextflow processes, performs alignment with 3 NVIDIA A100 80 GB GPUs, with virtual memory peaking at 276 GB during alignment. The second module was also run with <italic>jhpce</italic> defaults and 35 concurrent processes, peaking at 142 GB of virtual memory usage. Resulting R objects load in 23 GB of memory. Execution times for each computational step in BiocMAP with this dataset were recorded and provide a guideline for other datasets (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). The execution time boxplots that can be generated as part of a Nextflow [<xref ref-type="bibr" rid="CR14">14</xref>] “execution report”, produced by including the <italic>-with-report</italic> command-line option to the appropriate BiocMAP execution script (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S2).<fig id="Fig3"><label>Fig. 3</label><caption><p>Process run-times from combined execution reports. Wallclock run-times for each process in the alignment and extraction BiocMAP modules, (<bold>A</bold>) and (<bold>B</bold>) respectively, are plotted for the 32-sample subset of the Price et. al dataset [<xref ref-type="bibr" rid="CR22">22</xref>]. Individual boxplots for each module, combined here for illustration purposes, are one several plot types included in an HTML execution report generated by including the <italic>-with-report</italic> command-line option to BiocMAP, as made possible through the Nextflow [<xref ref-type="bibr" rid="CR14">14</xref>] framework. A given process, or computational step, in the BiocMAP workflow may be executed for one of more samples in the dataset; boxplots here summarize the distribution of run-times across all executions of each process type</p></caption><graphic xlink:href="12859_2023_5461_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par26">In the example analysis, we show how to attach external sample metadata to the <italic>bsseq</italic> [<xref ref-type="bibr" rid="CR11">11</xref>] objects and produce several exploratory plots (Additional file <xref rid="MOESM2" ref-type="media">2</xref>). For example, we compared the estimated bisulfite-conversion rate (produced by BiocMAP) across neuronal and glial samples (provided by the dataset metadata; Additional file <xref rid="MOESM2" ref-type="media">2</xref>). We examined the relationship between methylation contexts (CpG, CHG, CHH), which shows higher methylation rates for neurons compared to glia as well as higher correlation between the methylation rate in CpG context against CHH or CHG context in neurons versus glia (Fig. <xref rid="Fig4" ref-type="fig">4</xref>A). The proportion of cytosines with methylation higher than 10% is not significantly different under the CpG context, but is on the CpH context (CHH or CHG) when comparing neurons versus glia (Fig. <xref rid="Fig4" ref-type="fig">4</xref>B). This proportion doesn’t change across ages 0 to 23. The original study describing this dataset identified differentially methylated regions (DMRs) between cell types [<xref ref-type="bibr" rid="CR5">5</xref>]. By providing R/Bioconductor objects, BiocMAP’s outputs can easily be integrated with other R/Bioconductor packages that provide statistical and visualization methods. For example, DMRs can be visualized with <italic>bsseq</italic> [<xref ref-type="bibr" rid="CR11">11</xref>] (Fig. <xref rid="Fig4" ref-type="fig">4</xref>C).<fig id="Fig4"><label>Fig. 4</label><caption><p>Visualization of BiocMAP outputs on an Example Dataset. <bold>A</bold> Comparison of average methylation rate by trinucleotide context and cell type, showing significant correlation between contexts and similar methylation distributions with different means by cell type. Glia have lower correlation with CpG and a lower methylation rate than neurons. <bold>B</bold> Proportion of highly methylated cytosines across age by cell type and trinucleotide context. Here it can be seen that neuronal CpH methylation appears to generally increase with age, with no obvious association with age in other combinations of cell type and context. <bold>C</bold> Genomic region containing differential methylation between neurons and glia. Orange and green methylation curves represent neuronal and glial samples, respectively. Windows highlighted in light red show differentially methylated regions (DMRs) determined in the Price et al. manuscript [<xref ref-type="bibr" rid="CR5">5</xref>]</p></caption><graphic xlink:href="12859_2023_5461_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Benchmark</title>
      <p id="Par27">To quantify BiocMAP’s performance, we selected a 4-sample subset of the Price et. al. dataset [<xref ref-type="bibr" rid="CR22">22</xref>] and ran BiocMAP in its entirety along with a popular and functionally similar WGBS pipeline, nf-core/methylseq [<xref ref-type="bibr" rid="CR23">23</xref>]. We found that BiocMAP is considerably faster while using significantly less CPU hours and memory (total TB hours) (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). These two metrics are the ones typically quantified for billing purposes on high performance computing environments, thus BiocMAP can reduce computational expenses associated with pre-processing of WGBS data, in addition to time gains. On the other hand, BiocMAP was significantly more demanding at its peak in terms of total concurrent memory usage, at 341 GB, compared with nf-core/methylseq’s 73 GB. During the benchmark, each tool was allowed 40 concurrent Nextflow processes and unlimited CPU and memory resources (<italic>Methods: Benchmark</italic>). Given these loose constraints, BiocMAP aggressively parallelizes steps and consequently utilizes a much larger peak memory than nf-core/methylseq, despite an overall  12.6-fold lower overall memory utilized (by total TB hours). The most demanding step in BiocMAP requests 180 GB by default, imposing a practical minimum of 180 GB for a system to run BiocMAP from start to end. Moreover, this value can generally be reduced in BiocMAP configuration files (<italic>Methods: Configuration</italic>) for datasets consisting of less than about 400 samples.<fig id="Fig5"><label>Fig. 5</label><caption><p>Benchmark results. <bold>A</bold> Total wallclock duration of each pipeline. BiocMAP completes in roughly 1 day, not including downtime between the first and second module, while nf-core/methylseq completes in roughly 7 days. <bold>B</bold> Total CPU utilization by pipeline, in CPU hours. nf-core/methylseq uses more than 14 times the CPU resources as BiocMAP, at 1527 CPU hours. BiocMAP uses less than 8.7 GPU hours total (not shown) during alignment, suggesting the greater CPU usage of nf-core/methylseq is not explained by BiocMAP’s use of GPUs. <bold>C</bold> Maximal concurrent CPU usage at any point during pipeline execution. BiocMAP utilized 26 CPUs at its most demanding moment, while nf-core/methylseq used 72. Concurrent CPU usage is configurable, but was designed to be unconstrained during this benchmark. <bold>D</bold> Total memory usage by each pipeline in TB-hours. nf-core/methylseq used approximately 12.5 times more memory hours than BiocMAP over the full course of execution. <bold>E</bold> Maximal concurrent memory usage in GB across all processes, at any point during pipeline execution. BiocMAP used 341 GB of memory, approximately 4.7 times more than nf-core/methylseq, at each of their most memory-intensive moments. Note that concurrent memory usage is configurable, but was intentionally unconstrained for this benchmark</p></caption><graphic xlink:href="12859_2023_5461_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Methods</title>
    <sec id="Sec7">
      <title>Overview</title>
      <p id="Par28">In the first alignment module, FASTQ files are checked with <italic>FastQC</italic> 0.11.8 [<xref ref-type="bibr" rid="CR15">15</xref>], and by default samples that fail the “Adapter Content” metric are trimmed using <italic>Trim Galore!</italic> 0.6.6 [<xref ref-type="bibr" rid="CR16">16</xref>] (see <italic>Methods: Configuration</italic> for alternative trimming options). The resulting FASTQ files are aligned to a reference genome using the GPU-based aligner <italic>Arioc</italic> 1.43 [<xref ref-type="bibr" rid="CR8">8</xref>], to produce alignments in SAM format [<xref ref-type="bibr" rid="CR24">24</xref>]. Using <italic>SAMtools</italic> 1.10 [<xref ref-type="bibr" rid="CR24">24</xref>], alignments are filtered such that only primary alignments with <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$MAPQ \ge 5$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>P</mml:mi><mml:mi>Q</mml:mi><mml:mo>≥</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5461_Article_IEq1.gif"/></alternatives></inline-formula> are kept, duplicate reads are dropped using <italic>SAMBLASTER</italic> 0.1.26 [<xref ref-type="bibr" rid="CR25">25</xref>], and finally the result is coordinate-sorted, indexed and stored in BAM format via <italic>SAMtools</italic>.</p>
      <p id="Par29">In the second extraction module, methylation extraction is performed with <italic>MethylDackel</italic> 0.5.2 [<xref ref-type="bibr" rid="CR17">17</xref>] or optionally <italic>Bismark</italic> 0.23.0 [<xref ref-type="bibr" rid="CR7">7</xref>] on alignments from the alignment module. By default, a BAM file and corresponding index are expected as input to <italic>MethylDackel</italic>, while just a SAM or BAM file is required if <italic>Bismark</italic> is to be used. For experiments using spike-ins of the lambda bacteriophage, we use a pseudo-alignment-based approach to infer bisulfite-conversion efficiency for each sample. In particular, we prepare two “versions” of the lambda genome: the original and a copy where each cytosine is replaced with a thymine (Availability of data and materials). The latter version represents “in-silico bisulfite conversion” of the original genome, where we assume this original is completely unmethylated. Using <italic>kallisto</italic> 0.46.1 [<xref ref-type="bibr" rid="CR26">26</xref>], we count the number of reads aligned to each version of the lambda genome, and call these counts <italic>o</italic> and <italic>b</italic> for the original and bisulfite-converted versions, respectively. We define the bisulfite conversion efficiency rate <italic>e</italic> with the following ratio: <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e=\frac{b}{o + b}$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>b</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5461_Article_IEq2.gif"/></alternatives></inline-formula>. This contrasts with the more conventional approach [<xref ref-type="bibr" rid="CR27">27</xref>], which involves directly aligning reads to the lambda reference genome and comparing cytosine and thymine counts on a single strand. In our own tests, we have found our pseudo-alignment-based approach to be sufficiently concordant with the conventional method, while requiring just a fraction of the computational time. The Bioconductor package <italic>bsseq</italic> [<xref ref-type="bibr" rid="CR11">11</xref>] is used to gather methylation information into <italic>SummarizedExperiment</italic>-based [<xref ref-type="bibr" rid="CR12">12</xref>] objects. The final result is a pair of <italic>bsseq</italic> objects, each of which contains all samples in the experiment as columns (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). One object contains all cytosines in the genome observed in CpG context, represented as rows, while the other contains the remaining cytosines in CpH context (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Various metrics from <italic>FastQC</italic> [<xref ref-type="bibr" rid="CR15">15</xref>], trimming, alignment, methylation extraction, and lambda pseudoalignment, if applicable, are aggregated into the <italic>colData()</italic> slot of each object (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S1).</p>
    </sec>
    <sec id="Sec8">
      <title>Configuration</title>
      <p id="Par30">A researcher typically must modify one or two types of files in BiocMAP: the execution script and optionally, a configuration file. The execution script contains the <italic>nextflow</italic> command [<xref ref-type="bibr" rid="CR14">14</xref>] and major experiment-specific options, which together invoke one module in BiocMAP on a particular platform. Execution script templates are provided for each module in BiocMAP (“alignment” and “extraction”) and platform, which includes local Linux machines and systems managed by the Sun/Son of Grid Engine (SGE) or Simple Linux Utility for Resource Management (SLURM) job schedulers (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S2). Additional job management systems are supported by Nextflow [<xref ref-type="bibr" rid="CR14">14</xref>].</p>
      <p id="Par31">Required arguments in each execution script include “reference” and “sample”. “reference” may take values “hg38” or “hg19”, corresponding to the reference human genome to which samples should be aligned. The mouse reference genome “mm10” is also supported. “sample” may take values “single” or “paired”, referring to whether samples are single-end or paired-end. Several other options may be configured in the execution script. For example, the “input” argument takes the directory including <italic>samples.manifest</italic> for the alignment module, and the directory containing <italic>rules.txt</italic> for the extraction module (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S3). The optional “trim_mode” argument in the alignment module may take values “skip”, “adaptive”, or “force”, allowing the user to avoid trimming any samples, trim samples whose “Adapter Content” metric from <italic>FastQC</italic> [<xref ref-type="bibr" rid="CR15">15</xref>] is “FAIL”, or trim all samples, respectively.</p>
    </sec>
    <sec id="Sec9">
      <title>Inputs</title>
      <p id="Par32">Both the alignment and extraction modules require a file called <italic>samples.manifest</italic> as input; this file is identical to those used in SPEAQeasy [<xref ref-type="bibr" rid="CR28">28</xref>], thus providing a common file for describing input samples in both RNA-seq and WGBS projects. Briefly, <italic>samples.manifest</italic> is a tab-delimited plain-text file containing the absolute paths to each FASTQ file in the experiment, and associating files with a sample identifier. For compatibility with a previous format, optional MD5 sums can be associated with each FASTQ file. FASTQ files may optionally be compressed using gzip, so “.fq”, “.fastq”, “.fq.gz”, and “.fastq.gz” are all accepted file extensions. A researcher can specify that any combination of files be merged and treated as a single sample, simply by using the same sample ID in each line of FASTQ files to combine. This allows for simple management of the common case where a single biological sample is sequenced across several sequencing lanes and thus produces several files.</p>
      <p id="Par33">The extraction module makes use of the same <italic>samples.manifest</italic> file as the alignment module, as well as an additional file called <italic>rules.txt</italic> (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S3). The purpose of this file is to direct BiocMAP to each of the sets of outputs produced from the alignment module, which may not necessarily have been produced on the same high performance computing (HPC) system. From the alignment module, a researcher will have produced SAM or BAM files from alignment, as well as logs from quality checking, trimming, and alignment. The extraction module requires that a researcher create the <italic>rules.txt</italic> file, and point to the directory containing it via the <italic>–input</italic> option in the main submission script. <italic>rules.txt</italic> is a plain-text file where each line consists of a key-value pair (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S3). To facilitate this process, the alignment module creates a template <italic>rules.txt</italic> file which can be easily updated by the researcher in case file paths change in HPC system used for the extraction module. As an example <italic>rule</italic>, the “sam” key requires the path to each SAM or BAM from alignment as a value. Other keys are “manifest”, “arioc_log”, “xmc_log”, “trim_report”, “fastqc_log_first”, and “fastqc_log_last”, some of which are optional. Because an experiment typically consists of many samples, each value typically refers to multiple paths; including the literal “[id]” in a particular path signals for BiocMAP to replace “[id]” with each sample name to determine the full set of paths. A path can also be written as a glob expression, which is useful whenever a key refers to more than one file per sample; for example, the “sam” key can accept a BAM file and its index for every sample. For more detail about <italic>rules.txt</italic> and properly specifying file paths, see the documentation site (Availability of data and materials).</p>
    </sec>
    <sec id="Sec10">
      <title>Outputs</title>
      <p id="Par34">The final product from running BiocMAP is a pair of <italic>bsseq</italic> R objects, together containing methylation proportion and coverage information at all cytosine loci in the human or mouse genome (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). One object contains all cytosines occurring in “CpG” context in the reference genome, while the other object contains the remaining cytosines in “CpH” context. The <italic>bsseq</italic> [<xref ref-type="bibr" rid="CR11">11</xref>] class extends the <italic>SummarizedExperiment</italic> [<xref ref-type="bibr" rid="CR12">12</xref>] class, and here rows correspond to cytosines, while columns correspond to samples. Both objects contain the <italic>M</italic> and <italic>Cov</italic> assays, stored as <italic>DelayedArray</italic>s [<xref ref-type="bibr" rid="CR29">29</xref>] and representing methylation proportions and coverage counts, respectively. We “strand-collapse” CpG loci, which involves combining methylation data from both genomic strands and thus discards strand-specific information. The CpG object is also smoothed using the <italic>BSmooth</italic> [<xref ref-type="bibr" rid="CR30">30</xref>] pipeline as implemented in the <italic>bsseq</italic> [<xref ref-type="bibr" rid="CR11">11</xref>] package, yielding an additional assay called <italic>coef</italic>, which contains the smoothing coefficients corresponding to each raw methylation proportion stored in the <italic>M</italic> assay. Computing <italic>coef</italic> is time consuming, which is why for the CpH methylation data BiocMAP does not compute it as typical analyses will first filter the CpH data before computing this matrix. For a typical experiment involving many samples, these objects might occupy tens or even hundreds of gigabytes in memory if loaded in a traditional fashion. To enable working with the objects in a reasonable amount of memory, the assays are HDF5-backed using functionality from the <italic>HDF5Array</italic> [<xref ref-type="bibr" rid="CR31">31</xref>] package. The HDF5 format is designed to allow direct manipulation of on-disk data as if it were loaded in random access memory (RAM), thus reducing the required RAM by an order of magnitude. The large matrices containing methylation proportions, coverage, and smoothing coefficients are not loaded into memory, and common operations on these matrices are “chunked”, meaning only small pieces of a matrix are loaded into memory (RAM) at a time.</p>
      <p id="Par35">A table of metrics is stored in the <italic>colData()</italic> slot of each object, containing information collected from quality checking, trimming, alignment, methylation extraction, and potentially pseudoalignment to the lambda transcriptome (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S1). These metrics can be used for exploratory data analysis as well as for adjusting for them when performing downstream statistical analyses such as the identification of differentially methylated regions (DMRs). This table is also produced as a standalone R data frame to provide a format that is trivial to load into memory, interactively explore through <ext-link ext-link-type="uri" xlink:href="https://libd.shinyapps.io/shinycsv/">https://libd.shinyapps.io/shinycsv/</ext-link> [<xref ref-type="bibr" rid="CR32">32</xref>], or export to other formats.</p>
      <p id="Par36">In addition to the primary outputs of interest, BiocMAP produces a number of output files from intermediate pipeline steps (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S4).</p>
    </sec>
    <sec id="Sec11">
      <title>Software management</title>
      <p id="Par37">BiocMAP is designed to run on Linux machines, either locally or through the SGE or SLURM job scheduling engines, or other engines supported by Nextflow [<xref ref-type="bibr" rid="CR14">14</xref>]. We require Java 8 or later to be installed, as well as docker or singularity, based on the user’s preferred installation method. If neither are available, R [<xref ref-type="bibr" rid="CR10">10</xref>] 4.0 or later and python 3 are required. Finally, an NVIDIA GPU and its corresponding drivers are required. Docker users must also have the NVIDIA container toolkit installed.</p>
      <p id="Par38">BiocMAP makes use of a number of external software tools which must be installed to use the pipeline. We support three different installation methods to accommodate a user’s existing set-up: download of docker images containing software, download of corresponding singularity images, or direct “local” installation of software. All three methods require simply invoking a shell script, followed by the name of the installation method (“docker”, “singularity”, or “local”):<graphic position="anchor" xlink:href="12859_2023_5461_Figa_HTML" id="MO6"/></p>
      <p id="Par39">For users of computing clusters, we make the assumption that GPU resources are accessible via a particular queue. Therefore, cluster users must also perform an additional manual step to complete the installation; this involves setting a variable in the appropriate configuration file (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S2) to the name of the queue where GPU(s) are available.<graphic position="anchor" xlink:href="12859_2023_5461_Figb_HTML" id="MO7"/></p>
      <p id="Par40">We recommend using the “docker” or “singularity” installation methods, if those tools are available, or the “local” method otherwise. As a Nextflow-based [<xref ref-type="bibr" rid="CR14">14</xref>] pipeline, BiocMAP is out-of-the-box able to execute individual pipeline components, called <italic>processes</italic>, inside Docker or Singularity containers. These containers provide an exact environment, including the main software, system tools, and other dependencies, so that each BiocMAP process behaves identically on different computing systems. We host every docker image used by BiocMAP on a public Docker Hub repository (Availability of data and materials). In practice, the “singularity” installation mode automatically pulls the required docker images and builds singularity-compatible equivalents to use at run-time.</p>
      <p id="Par41">Alternatively, a researcher may use the “local” installation mode, which builds individual software tools from source when possible or downloads pre-compiled binaries otherwise. Since each piece of software is installed to a local directory and not globally, root permissions are not required for this installation method, and thus might be preferred by some users. However, because this approach tailors the installation to a particular computing environment, it is beyond our capacity to test unlike the “docker” or “singularity” modes, and we thus encourage you to avoid using the “local” mode.</p>
    </sec>
    <sec id="Sec12">
      <title>Annotation</title>
      <p id="Par42">Since BiocMAP performs alignment to a reference genome and can quantify lambda spike-ins [<xref ref-type="bibr" rid="CR27">27</xref>], it must make use of external reference files. By default, required reference files are automatically pulled from GENCODE [<xref ref-type="bibr" rid="CR33">33</xref>] (or NCBI for the lambda genome), but a user can also opt to provide their own files instead. The method used by BiocMAP to manage external reference files is nearly identical to that used in SPEAQeasy [<xref ref-type="bibr" rid="CR28">28</xref>], and we encourage those interested to refer to that manuscript for more details; however, we provide a brief summary here.</p>
      <p id="Par43">When using default annotation from GENCODE [<xref ref-type="bibr" rid="CR33">33</xref>], the genomes “hg38”, “hg19”, and “mm10” are supported; one of these values must be passed to the <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$--reference$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mo>-</mml:mo><mml:mo>-</mml:mo><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5461_Article_IEq3.gif"/></alternatives></inline-formula> option. A researcher may specify the GENCODE version for human or mouse, as appropriate (e.g. “38” or “M27”, respectively). An additional configuration variable called “anno_build” determines if all sequences present in the “primary_assembly” file from GENCODE are kept, or if only canonical reference chromosomes are used for alignment; this corresponds to the values “primary” or “main” that a researcher may select, respectively. BiocMAP only pulls files from GENCODE that have not already been downloaded; after the first execution of the workflow for a given set of settings, it uses a locally cached copy of relevant files. A researcher may manually choose a directory to place annotation files via the command-line option “–annotation [path to directory]”, which enables potentially many users to share a single location for reference files to save disk space and time.</p>
      <p id="Par44">Alternatively, a researcher may provide their own reference genome in FASTA format in place of the automatically managed GENCODE [<xref ref-type="bibr" rid="CR33">33</xref>] files. In this case, the “–annotation [path to directory]” option signifies the directory containing the provided FASTA file, and the “–custom_anno [label]” option assigns an informative label, or name, that can later be used in place of explicitly providing the genome. Note that the lambda genome is only automatically managed, since it is unlikely a user will need to swap out a different version.</p>
    </sec>
    <sec id="Sec13">
      <title>Test samples</title>
      <p id="Par45">Small test files are provided in the <italic>test</italic> directory of the GitHub repository, for each combination of species (human and mouse) and pairing (single-end and paired-end). These are intended to allow a researcher to quickly verify BiocMAP has properly installed. While human, paired-end files are from the example <italic>AgeNeunSortedWGBS</italic> dataset [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR22">22</xref>], the remaining files were retrieved from the Sequence Read Archive (SRA) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S5). All FASTQ files were subsetted to 100,000 reads. A researcher can opt to run the extraction module on test data, without needing to run the alignment module beforehand. Test inputs to the extraction module, which include BAM files, their indices, and logs up through alignment, were generated by running BiocMAP with default settings, with the exception of using <italic>–trim_mode “force”</italic> in place of the default <italic>–trim_mode “adaptive”</italic>.</p>
    </sec>
    <sec id="Sec14">
      <title>AgeNeunSortedWGBS samples</title>
      <p id="Par46">The vignette provided with BiocMAP makes use of a dataset that includes 32 human postnatal dorsolateral prefrontal cortex samples up to 23 years of age [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR22">22</xref>]. Homogenate postmortem tissue was sorted with NeuN-based fluorescence-activated nuclear sorting to produce 8 glial and 24 neuronal samples. The Price et al. manuscript also included prenatal samples that were excluded for this analysis [<xref ref-type="bibr" rid="CR5">5</xref>].</p>
      <p id="Par47"><italic>HDF5Array</italic> 1.22.1 [<xref ref-type="bibr" rid="CR31">31</xref>] is used to load the <italic>bsseq</italic> objects partially into memory, while keeping the <italic>assays()</italic> on disk as <italic>DelayedMatrix</italic> objects from the <italic>DelayedArray</italic> 0.20.0 [<xref ref-type="bibr" rid="CR29">29</xref>] package. Exploratory plots use <italic>ggplot2</italic> 3.3.5 [<xref ref-type="bibr" rid="CR34">34</xref>] and the <italic>ggpairs()</italic> function from <italic>GGally</italic> 2.1.2 [<xref ref-type="bibr" rid="CR35">35</xref>]. Methylation curves at a genomic region with several individual DMRs are explored with <italic>plotRegion()</italic> from <italic>bsseq</italic> 1.30.0 [<xref ref-type="bibr" rid="CR11">11</xref>]. A total of 42 GB of memory is required to run this analysis, and the analysis completes in 55 min.</p>
    </sec>
    <sec id="Sec15">
      <title>Benchmark</title>
      <p id="Par48">BiocMAP was installed with “jhpce” mode and run with default configuration and command-line options. It was previously run with the same annotation settings on the testing machine, meaning the benchmarking run of BiocMAP excludes one-time steps related to pulling annotation files and encoding for use in Arioc. Because the first module of BiocMAP completed overnight, the second module was not run immediately in succession. The downtime between executions of the first and second modules of BiocMAP was not counted towards computing total wallclock duration (Fig. <xref rid="Fig5" ref-type="fig">5</xref>A).</p>
      <p id="Par49">First, a dry run of nf-core/methylseq [<xref ref-type="bibr" rid="CR23">23</xref>] was performed using the singularity profile and the <italic>GRCh38</italic> genome to install local files, singularity-related dependencies, and cache genome-related files. As its base configuration does not allow for execution on an SGE cluster where computational resources were available, the base configuration was modified. In particular, any memory request was modified to use the “mem_free” and “h_vmem” resources instead of Nextflow’s default of “virtual_free”; this was changed to meet JHPCE usage guidelines. The following segment of code was added to configuration to specify at most 40 concurrent processes, and usage of the SGE job scheduler, settings identical to BiocMAP: <graphic position="anchor" xlink:href="12859_2023_5461_Figc_HTML" id="MO8"/></p>
      <p id="Par50">Next, memory requests were raised for <italic>process_single</italic> and <italic>process_low</italic> to 20 G from 6 G and 12 G, respectively. This allowed singularity 3.6.0 to have sufficient memory to run on our machines. Finally, time limits were removed on all processes after exceeding some limits in initial tests. After establishing a successful configuration, nf-core/methylseq was run with otherwise default settings with the singularity profile and <italic>GRCh38</italic> reference genome.</p>
      <p id="Par51">Both BiocMAP and nf-core/methylseq were run on a system with enough RAM and CPUs, such that jobs were not on hold in the SGE queue. In other words, both software tools executed processing steps as soon as previous steps finished, enabling us to compare pipelines by total wallclock time.</p>
    </sec>
  </sec>
  <sec id="Sec16">
    <title>Discussion</title>
    <p id="Par52">Alignment to a reference genome is often the most computationally intensive component of a whole genome bisulfite sequencing (WGBS) data-processing workflow. As a result, workflows with an efficient alignment step can reduce total time required to process a dataset by a significant factor. CPU-based aligners like <italic>Bismark</italic> [<xref ref-type="bibr" rid="CR7">7</xref>] or the more recent <italic>BS-Seeker3</italic> [<xref ref-type="bibr" rid="CR36">36</xref>] can process WGBS samples in hours or days, but the GPU-based <italic>Arioc</italic> aligner offers higher alignment speeds than CPU-based aligners while maintaining comparable accuracy [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR37">37</xref>] (Additional file <xref rid="MOESM3" ref-type="media">3</xref>). Furthermore, we demonstrate that the BiocMAP workflow as a whole is significantly faster than comparable CPU-based workflows, making analyses of several-hundred-sample WGBS datasets feasible.</p>
    <p id="Par53">Given the recent introduction of GPUs and limited availability, researchers might not have access to GPUs on their main high performance computing (HPC) environment. HPC systems with GPUs might be under high demand or more expensive to use. Nextflow [<xref ref-type="bibr" rid="CR14">14</xref>] does not provide functionality for executing some processing steps in one HPC system, transferring files, and resuming executing processes on a second HPC system. For these reasons, BiocMAP was implemented as two separate modules such that processing steps that benefit from the presence of GPUs can be run on HPC systems with GPUs, and the remaining steps can be run on regular CPU-powered HPC systems. Ultimately, if you have access to a HPC system with GPUs, you might prefer to run both modules on such a system. In that situation, BiocMAP’s two modules can be run serially without having to edit the <italic>rules.txt</italic> file that is automatically generated by the alignment module.</p>
    <p id="Par54">While BiocMAP is already likely to align reads quickly through <italic>Arioc</italic> with default settings, researchers are highly encouraged to configure BiocMAP settings to most efficiently use <italic>Arioc</italic> given the available hardware as noted on the documentation website (Availability of data and materials). Most configuration variables used by <italic>Arioc</italic> [<xref ref-type="bibr" rid="CR8">8</xref>] can be directly edited in the appropriate BiocMAP configuration file (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S2). For example, the <italic>batchSize</italic> BiocMAP configuration variable is passed to the <italic>batchSize</italic> attribute of the <italic>AriocU</italic> or <italic>AriocP</italic> element of the configuration for <italic>AriocU</italic> or <italic>AriocP</italic>, which specifies how many reads <italic>Arioc</italic> can concurrently align per GPU utilized. This is one of many settings that depends on the specifications of the GPU(s) a researcher has available in their HPC system, which can be adjusted to achieve greater throughput. The <italic>max_gpus</italic> BiocMAP configuration variable specifies how many GPUs to use for alignment of each sample, potentially allowing increased parallelism when there is an abundance of GPU resources relative to number of samples in the experiment. A more comprehensive guide to adjusting BiocMAP configuration for a given computing environment is provided as part of the documentation website (Availability of data and materials).</p>
    <p id="Par55">We demonstrated how BiocMAP can be used to process publicly available WGBS data using an example dataset [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR22">22</xref>]. Additional file <xref rid="MOESM2" ref-type="media">2</xref> shows how you can then load the outputs of BiocMAP and use the data with R and Bioconductor packages such as <italic>bsseq</italic> [<xref ref-type="bibr" rid="CR11">11</xref>], <italic>ggplot2</italic> [<xref ref-type="bibr" rid="CR34">34</xref>], and <italic>GGally</italic> [<xref ref-type="bibr" rid="CR35">35</xref>] to perform exploratory data analysis as well as downstream statistical analyses. In addition, development versions of BiocMAP were used in other peer reviewed publications [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR38">38</xref>, <xref ref-type="bibr" rid="CR39">39</xref>] that have publicly available R code for several downstream analyses.</p>
    <p id="Par56">While we used a dataset of 32 samples to exemplify BiocMAP [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR22">22</xref>], memory requirements scale roughly linearly with number of samples, with the production of a 600-sample dataset requiring about 200 GB of RAM, despite CpH and CpG cytosines encompassing around half of the genome (depending on the GC content of the genome; private WGBS datasets). Thus BiocMAP is scalable to a sample size larger than most if not all current WGBS datasets. The 200 GB RAM can likely be drastically reduced by future internal BiocMAP updates and can definitely be reduced for any dataset once you apply a filter on the number of reads per cytosine, stored in the <italic>Cov</italic> assay. Despite the potentially large memory requirements for running BiocMAP, loading the output <italic>bsseq</italic> [<xref ref-type="bibr" rid="CR11">11</xref>] objects requires significantly less memory and is independent of the number of samples in the dataset, thanks to the HDF5 storage backend [<xref ref-type="bibr" rid="CR31">31</xref>]. Users most likely need around 20–30 GB of RAM to load filtered <italic>bsseq</italic> objects for downstream statistical analyses for the CpH context, while the CpG context object requires less than 1 GB of RAM.</p>
    <p id="Par57">We envision that most users will not be interested in tweaking WGBS processing steps as long as they generate the output in a reasonable amount of time, but instead will want to focus on downstream analyses. We implemented BiocMAP in such a way that it will benefit from community developments in Bioconductor [<xref ref-type="bibr" rid="CR13">13</xref>]. The main output data container is a <italic>bsseq</italic> [<xref ref-type="bibr" rid="CR11">11</xref>] object that is an extension of <italic>SummarizedExperiment</italic> [<xref ref-type="bibr" rid="CR12">12</xref>]. <italic>SummarizedExperiment</italic> itself is the one compatible with low-memory footprint backends such as <italic>HDF5Array</italic> [<xref ref-type="bibr" rid="CR31">31</xref>]. If <italic>SummarizedExperiment</italic> becomes more efficient, by for example providing a low-memory footprint option for the gene coordinates (<italic>rowRanges()</italic> slot), users of BiocMAP will benefit from the reduction in RAM required to generate and load BiocMAP’s outputs. Similarly, if new R/Bioconductor packages are developed that implement downstream statistical analyses, they will be compatible with BiocMAP’s output objects as they are the central format for DNA methylation data [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]. <italic>zellkonverter</italic> [<xref ref-type="bibr" rid="CR40">40</xref>] is a Bioconductor package that allows exporting <italic>SingleCellExperiment</italic> R objects to Python. Given that <italic>SingleCellExperiment</italic> is an extension of <italic>SummarizedExperiment</italic>, just like <italic>bsseq</italic>, it seems reasonable to expect that <italic>bsseq</italic> objects will be readable from Python. Given these reasons, we envision that BiocMAP’s users will be able to use the resulting <italic>bsseq</italic> objects with any new methods implemented in R and most likely Python, two of the most widely used programming languages.</p>
    <p id="Par58">Despite the potential for customization within BiocMAP, it is designed to run “out of the box”, without a strict need to make hardware-specific configuration. This enables researchers to focus on their particular analysis questions instead of technical processing details.</p>
  </sec>
  <sec id="Sec17">
    <title>Conclusion</title>
    <p id="Par59">We implemented a whole genome bisulfite sequencing (WGBS) data processing workflow that relies on the GPU-accelerated <italic>Arioc</italic> aligner [<xref ref-type="bibr" rid="CR8">8</xref>], yet is flexible enough to be used on multiple high performance computing (HPC) systems. The alignment output is further processed and packaged into <italic>bsseq</italic> [<xref ref-type="bibr" rid="CR11">11</xref>] R/Bioconductor objects that are memory efficient and deeply integrated with the R/Bioconductor open source software ecosystem [<xref ref-type="bibr" rid="CR13">13</xref>]. Thus BiocMAP will get the data processing job done in a fast and efficient manner for WGBS datasets up to several hundred samples, allowing researchers to focus their attention on exploratory data analysis and downstream statistical analyses. BiocMAP is available and documented at <ext-link ext-link-type="uri" xlink:href="http://research.libd.org/BiocMAP/">http://research.libd.org/BiocMAP/</ext-link>.</p>
  </sec>
  <sec id="Sec18">
    <title>Availability and requirements</title>
    <p id="Par60">Project name: BiocMAP</p>
    <p id="Par61">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/LieberInstitute/BiocMAP">https://github.com/LieberInstitute/BiocMAP</ext-link></p>
    <p id="Par62">Operating system(s): Linux</p>
    <p id="Par63">Programming language: Nextflow, R, Groovy</p>
    <p id="Par64">Other requirements: Java 8 or higher, access to NVIDIA GPU(s), Singularity or Docker (recommended)</p>
    <p id="Par65">License: GNU GPLv3</p>
    <p id="Par66">Any restrictions to use by non-academics: N/A</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec20">
      <title>Supplementary information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5461_MOESM1_ESM.xlsx">
            <caption>
              <p><bold>Additional file 1.</bold> Various tables with information about BiocMAP inputs, outputs, test files, and more. This is provided as a multi-sheet excel file, with each sheet described in more detail below. S1: List of output metrics collected by BiocMAP. These are various quantities aggregated from processing steps like <italic>FastQC</italic> [15], trimming, alignment, and methylation extraction. Together they form an R <italic>data.frame</italic> accessible from the file <italic>metrics.rda</italic> and from within the <italic>colData()</italic> of output <italic>bsseq</italic> [11] objects. For paired-end samples, some metrics are computed separately for each mate, in which case metric names are appended with “_R1” and “_R2” to refer to each mate, respectively. S2: BiocMAP execution scripts and associated configuration files. BiocMAP provides several potential files for out-of-the-box functionality on local Linux machines as well as on SLURM or SGE-managed computing clusters. S3: Content of <italic>rules.txt</italic>. Each line of this input file to the extraction BiocMAP module consists of key-value pairs of the form <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;key&gt; = &lt;value&gt;$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mi>e</mml:mi><mml:mi>y</mml:mi><mml:mo>&gt;</mml:mo><mml:mo>=</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mo>&gt;</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5461_Article_IEq4.gif"/></alternatives></inline-formula>, some of which are required. S4: Intermediate output files. These files are not the main output files of interest from running both modules of BiocMAP, but are generated along the way as byproducts. S5: Sources of test data provided in the BiocMAP repository. Human and mouse single-end and paired-end samples are provided to allow users to quickly verify proper installation of BiocMAP, sourced from SRA or the FlowRNA-WGBS dataset.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2023_5461_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2.</bold> Example vignette showing the use of BiocMAP output objects in downstream analysis. This is a PDF file walking through R code and exploratory plots applied on the Price et al. data [22]. This file is also available from the BiocMAP GitHub repository (Availability of data and materials).</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2023_5461_MOESM3_ESM.pdf">
            <caption>
              <p><bold>Additional file 3.</bold> Comparison of alignment results between Arioc and Bismark. In 94 postmortem human brain samples from the dorsolateral prefrontal cortex (DLPFC) and hippocampus (HIPPO) [40], Arioc 1.25.2401.18201 [8] maps reads at a consistently higher rate than Bismark 0.19.0 [7], while finding similar methylation rates in different cytosine contexts. Results are colored by brain region and diagnosis (control and schizophrenia), but are fairly uniform across these categories, with the exception of generally higher CHG-context methylation reported by both tools in the DLPFC.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>BiocMAP</term>
        <def>
          <p id="Par4">Bioconductor-friendly Nextflow-based methylation analysis pipeline</p>
        </def>
      </def-item>
      <def-item>
        <term>CpG</term>
        <def>
          <p id="Par5">Cytosine preceding a guanine (methylation context)</p>
        </def>
      </def-item>
      <def-item>
        <term>CpH</term>
        <def>
          <p id="Par6">Cytosine preceding a nucleotide other than guanine (methylation context)</p>
        </def>
      </def-item>
      <def-item>
        <term>CHG</term>
        <def>
          <p id="Par7">Cytosine followed by non-guanine nucleotide, then guanine (methylation context)</p>
        </def>
      </def-item>
      <def-item>
        <term>CHH</term>
        <def>
          <p id="Par8">Cytosine followed by two nucleotides other than guanine (methylation context)</p>
        </def>
      </def-item>
      <def-item>
        <term>CPU</term>
        <def>
          <p id="Par9">Central processing unit</p>
        </def>
      </def-item>
      <def-item>
        <term>CUDA</term>
        <def>
          <p id="Par10">Compute unified device architecture</p>
        </def>
      </def-item>
      <def-item>
        <term>DMR</term>
        <def>
          <p id="Par11">Differentially methylated region</p>
        </def>
      </def-item>
      <def-item>
        <term>GPU</term>
        <def>
          <p id="Par12">Graphics processing unit</p>
        </def>
      </def-item>
      <def-item>
        <term>HPC</term>
        <def>
          <p id="Par13">High performance computing</p>
        </def>
      </def-item>
      <def-item>
        <term>NCBI</term>
        <def>
          <p id="Par14">National Center for Biotechnology Information</p>
        </def>
      </def-item>
      <def-item>
        <term>RAM</term>
        <def>
          <p id="Par15">Random access memory</p>
        </def>
      </def-item>
      <def-item>
        <term>SGE</term>
        <def>
          <p id="Par16">Sun grid engine or son of grid engine</p>
        </def>
      </def-item>
      <def-item>
        <term>SLURM</term>
        <def>
          <p id="Par17">Simple Linux Utility for Resource Management</p>
        </def>
      </def-item>
      <def-item>
        <term>SRA</term>
        <def>
          <p id="Par18">Sequence read archive</p>
        </def>
      </def-item>
      <def-item>
        <term>WGBS</term>
        <def>
          <p id="Par19">Whole genome bisulfite sequencing</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to thank Anandita Rajpurohit and Kira A. Perzel Mandell (Lieber Institute for Brain Development), and Amanda J. Price (National Institute of Child Health and Human Development) for their suggestions on how to best present BiocMAP. Geo Pertea (LIBD) helped us proofread the documentation of BiocMAP. We would like to thank the Joint High Performance Computing Exchange (JHPCE) for providing computing resources for these analyses.</p>
    <sec id="d32e1457">
      <title>Authors’ information</title>
      <p id="Par67">Andrew E Jaffe is currently an employee and shareholder of Neumora Therapeutics, which is unrelated to the contents of this manuscript.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>NJE and AEJ designed the software, then NJE and RW implemented the software. NJE and LCT wrote the manuscript draft. All authors contributed to revising the manuscript and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the Lieber Institute for Brain Development (NJE, AEJ, LCT). This work was also supported by contract # VA-241-17-C-0138, funding from the VA Connecticut Health Care System, West Haven, CT, Central Texas Veterans Health Care System, Temple, TX, Durham VA Healthcare System, Durham NC, VA San Diego Healthcare System, La Jolla, CA, VA Boston Healthcare System, Boston, MA, USA and the National Center for PTSD, U.S. Department of Veterans Affairs. The views expressed here are those of the authors and do not necessarily reflect the position or policy of the Department of Veterans Affairs (VA) or the U.S. government. All funding bodies had no role in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The BiocMAP software is available from GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/LieberInstitute/BiocMAP">https://github.com/LieberInstitute/BiocMAP</ext-link> [<xref ref-type="bibr" rid="CR9">9</xref>], with documentation at <ext-link ext-link-type="uri" xlink:href="http://research.libd.org/BiocMAP/">http://research.libd.org/BiocMAP/</ext-link>. The WGBS data used in the example vignette is available from <ext-link ext-link-type="uri" xlink:href="https://www.synapse.org/#%21Synapse:syn5842535">https://www.synapse.org/#!Synapse:syn5842535</ext-link> [<xref ref-type="bibr" rid="CR5">5</xref>]. The original version of the lambda genome is available at <ext-link ext-link-type="uri" xlink:href="ftp://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/000/840/245/GCA_000840245.1_ViralProj14204/GCA_000840245.1_ViralProj14204_genomic.fna.gz">ftp://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/000/840/245/GCA_000840245.1_ViralProj14204/GCA_000840245.1_ViralProj14204_genomic.fna.gz</ext-link>. Docker images required for BiocMAP are hosted at <ext-link ext-link-type="uri" xlink:href="https://hub.docker.com/orgs/libddocker/repositories">https://hub.docker.com/orgs/libddocker/repositories</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par68">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par69">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par70">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moore</surname>
            <given-names>LD</given-names>
          </name>
          <name>
            <surname>Le</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>DNA methylation and its basic function</article-title>
        <source>Neuropsychopharmacology</source>
        <year>2013</year>
        <volume>38</volume>
        <issue>1</issue>
        <fpage>23</fpage>
        <lpage>38</lpage>
        <pub-id pub-id-type="doi">10.1038/npp.2012.112</pub-id>
        <?supplied-pmid 22781841?>
        <pub-id pub-id-type="pmid">22781841</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Avery</surname>
            <given-names>OT</given-names>
          </name>
          <name>
            <surname>Macleod</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>McCarty</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Studies on the chemical nature of the substance inducing transformation of pneumococcal types: induction of transformation by a desoxyribonucleic acid fraction isolated from pneumococcus type III</article-title>
        <source>J Exp Med</source>
        <year>1944</year>
        <volume>79</volume>
        <issue>2</issue>
        <fpage>137</fpage>
        <lpage>158</lpage>
        <pub-id pub-id-type="doi">10.1084/jem.79.2.137</pub-id>
        <?supplied-pmid 19871359?>
        <pub-id pub-id-type="pmid">19871359</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harrison</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Parle-McDermott</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>DNA methylation: a timeline of methods and applications</article-title>
        <source>Front Genet</source>
        <year>2011</year>
        <volume>2</volume>
        <fpage>74</fpage>
        <pub-id pub-id-type="doi">10.3389/fgene.2011.00074</pub-id>
        <?supplied-pmid 22303369?>
        <pub-id pub-id-type="pmid">22303369</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harris</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Coarfa</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Nagarajan</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Hong</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Downey</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Fouse</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Delaney</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Olshen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ballinger</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Forsberg</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Gu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Echipare</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>O’Geen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lister</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Pelizzola</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Xi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Epstein</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Bernstein</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Hawkins</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Chung</surname>
            <given-names>W-Y</given-names>
          </name>
          <name>
            <surname>Gu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bock</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gnirke</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>MQ</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ecker</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Farnham</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Waterland</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Meissner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Marra</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Hirst</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Milosavljevic</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Costello</surname>
            <given-names>JF</given-names>
          </name>
        </person-group>
        <article-title>Comparison of sequencing-based methods to profile DNA methylation and identification of monoallelic epigenetic modifications</article-title>
        <source>Nat Biotechnol</source>
        <year>2010</year>
        <volume>28</volume>
        <issue>10</issue>
        <fpage>1097</fpage>
        <lpage>1105</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1682</pub-id>
        <?supplied-pmid 20852635?>
        <pub-id pub-id-type="pmid">20852635</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Collado-Torres</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ivanov</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Xia</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Burke</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Shin</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Tao</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Jia</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hyde</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Kleinman</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Weinberger</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Jaffe</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>Divergent neuronal DNA methylation patterns across human cortical development reveal critical periods and a unique role of CpH methylation</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>196</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1805-1</pub-id>
        <?supplied-pmid 31554518?>
        <pub-id pub-id-type="pmid">31554518</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Perzel Mandell</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Price</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Wilton</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Collado-Torres</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Tao</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Eagles</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Szalay</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Hyde</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Weinberger</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Kleinman</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Jaffe</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>Characterizing the dynamic and functional DNA methylation landscape in the developing human cortex</article-title>
        <source>Epigenetics</source>
        <year>2021</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1080/15592294.2020.1786304</pub-id>
        <?supplied-pmid 32602773?>
        <pub-id pub-id-type="pmid">32602773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krueger</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Bismark: a flexible aligner and methylation caller for Bisulfite-Seq applications</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>11</issue>
        <fpage>1571</fpage>
        <lpage>1572</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr167</pub-id>
        <?supplied-pmid 21493656?>
        <pub-id pub-id-type="pmid">21493656</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilton</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Budavari</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wheelan</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Szalay</surname>
            <given-names>AS</given-names>
          </name>
        </person-group>
        <article-title>Arioc: high-throughput read alignment with GPU-accelerated exploration of the seed-and-extend search space</article-title>
        <source>PeerJ</source>
        <year>2015</year>
        <volume>3</volume>
        <fpage>808</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj.808</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Nick-Eagles: LieberInstitute/BiocMAP: v0-draft, 2022. <pub-id pub-id-type="doi">10.5281/zenodo.6425727</pub-id>. Accessed 08 Apr 2022.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">R Core Team. R: a language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria; 2021. R Foundation for Statistical Computing. <ext-link ext-link-type="uri" xlink:href="https://www.R-project.org/">https://www.R-project.org/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hansen</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>BSmooth: from whole genome bisulfite sequencing reads to differentially methylated regions</article-title>
        <source>Genome Biol</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>10</issue>
        <fpage>83</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2012-13-10-r83</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Morgan M, Obenchain V, Hester J, Pagès H. SummarizedExperiment: SummarizedExperiment Container. 2021. R package version 1.24.0. <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/SummarizedExperiment">https://bioconductor.org/packages/SummarizedExperiment</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>VJ</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Carlson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Carvalho</surname>
            <given-names>BS</given-names>
          </name>
          <name>
            <surname>Bravo</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gatto</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Girke</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gottardo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hahne</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hansen</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>MacDonald</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Obenchain</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Ole’s</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Pagès</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Reyes</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shannon</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Tenenbaum</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Waldron</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Morgan</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Orchestrating high-throughput genomic analysis with bioconductor</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <issue>2</issue>
        <fpage>115</fpage>
        <lpage>121</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3252</pub-id>
        <?supplied-pmid 25633503?>
        <pub-id pub-id-type="pmid">25633503</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Di Tommaso</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Chatzou</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Floden</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Barja</surname>
            <given-names>PP</given-names>
          </name>
          <name>
            <surname>Palumbo</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Notredame</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Nextflow enables reproducible computational workflows</article-title>
        <source>Nat Biotechnol</source>
        <year>2017</year>
        <volume>35</volume>
        <issue>4</issue>
        <fpage>316</fpage>
        <lpage>319</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3820</pub-id>
        <?supplied-pmid 28398311?>
        <pub-id pub-id-type="pmid">28398311</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Andrews S. FastQC: a quality control tool for high throughput sequence data, 2018. <ext-link ext-link-type="uri" xlink:href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">https://www.bioinformatics.babraham.ac.uk/projects/fastqc/</ext-link>. Accessed 12 Apr 2022.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Krueger F. Trim Galore: a wrapper tool around Cutadapt and FastQC to consistently apply quality and adapter trimming to FastQ files, 2020. <ext-link ext-link-type="uri" xlink:href="https://www.bioinformatics.babraham.ac.uk/projects/trim_galore/">https://www.bioinformatics.babraham.ac.uk/projects/trim_galore/</ext-link>. Accessed 08 Apr 2022.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Ryan D. A (mostly) universal methylation extractor for BS-seq experiments, 2021. <ext-link ext-link-type="uri" xlink:href="https://github.com/dpryan79/MethylDackel">https://github.com/dpryan79/MethylDackel</ext-link>. Accessed 12 Apr 2022.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ritchie</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Phipson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Law</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <issue>7</issue>
        <fpage>47</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv007</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oliver</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Jenkinson</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Olson</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Shultz-Rogers</surname>
            <given-names>LE</given-names>
          </name>
          <name>
            <surname>Klee</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <article-title>Detection of outlier methylation from bisulfite sequencing data with novel bioconductor package borealis</article-title>
        <source>bioRxiv</source>
        <year>2022</year>
        <pub-id pub-id-type="doi">10.1101/2022.05.19.492700</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Gong B. MethCP. Bioconductor 2019.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peters</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Buckley</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Statham</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Pidsley</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Samaras</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lord</surname>
            <given-names>RV</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Molloy</surname>
            <given-names>PL</given-names>
          </name>
        </person-group>
        <article-title>De novo identification of differentially methylated regions in the human genome</article-title>
        <source>Epigenetics Chromatin</source>
        <year>2015</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>6</fpage>
        <pub-id pub-id-type="doi">10.1186/1756-8935-8-6</pub-id>
        <?supplied-pmid 25972926?>
        <pub-id pub-id-type="pmid">25972926</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Price AJ. LIBD-WGBS, 2016. <pub-id pub-id-type="doi">10.7303/syn5842535</pub-id>. Accessed 08 Apr 2022.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Ewels P, Hüther P, Spix N, Miller E, Bot N-C, Hörtenhuber M, Peltzer A, F, S, Alneberg J, Di Tommaso P, Garcia MU, Davenport C, Ajith V, Krueger F, Patel H, Alessia, Devailly G, Syme R, VIJAY, Menden K, Céline N. nf-core/methylseq: nf-core/methylseq version 2.3.0 [Pyrite Alligator]. Zenodo 2022.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Handsaker</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wysoker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Homer</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>1000 genome project data processing subgroup: the sequence alignment/map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>16</issue>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <?supplied-pmid 19505943?>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Faust</surname>
            <given-names>GG</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>IM</given-names>
          </name>
        </person-group>
        <article-title>SAMBLASTER: fast duplicate marking and structural variant read extraction</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>17</issue>
        <fpage>2503</fpage>
        <lpage>2505</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu314</pub-id>
        <?supplied-pmid 24812344?>
        <pub-id pub-id-type="pmid">24812344</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bray</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Pimentel</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Melsted</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Near-optimal probabilistic RNA-seq quantification</article-title>
        <source>Nat Biotechnol</source>
        <year>2016</year>
        <volume>34</volume>
        <issue>5</issue>
        <fpage>525</fpage>
        <lpage>527</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3519</pub-id>
        <?supplied-pmid 27043002?>
        <pub-id pub-id-type="pmid">27043002</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leontiou</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Hadjidaniel</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Mina</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Antoniou</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ioannides</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Patsalis</surname>
            <given-names>PC</given-names>
          </name>
        </person-group>
        <article-title>Bisulfite conversion of DNA: performance comparison of different kits and methylation quantitation of epigenetic biomarkers that have the potential to be used in non-invasive prenatal testing</article-title>
        <source>PLoS ONE</source>
        <year>2015</year>
        <volume>10</volume>
        <issue>8</issue>
        <fpage>0135058</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0135058</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eagles</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Burke</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Leonard</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Barry</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Stolz</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Huuki</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Phan</surname>
            <given-names>BN</given-names>
          </name>
          <name>
            <surname>Serrato</surname>
            <given-names>VL</given-names>
          </name>
          <name>
            <surname>Gutiérrez-Millán</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Aguilar-Ordoñez</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Jaffe</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Collado-Torres</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>SPEAQeasy: a scalable pipeline for expression analysis and quantification for r/bioconductor-powered RNA-seq analyses</article-title>
        <source>BMC Bioinform</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>224</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-021-04142-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Pagès H, with contributions from Peter Hickey, Lun A. DelayedArray: a unified framework for working transparently with on-disk and in-memory array-like datasets. 2021. R package version 0.20.0. <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/DelayedArray">https://bioconductor.org/packages/DelayedArray</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hansen</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>BSmooth: from whole genome bisulfite sequencing reads to differentially methylated regions</article-title>
        <source>Genome Biol</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>10</issue>
        <fpage>83</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2012-13-10-r83</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Pagès H. HDF5Array: HDF5 backend for DelayedArray objects. 2021. R package version 1.22.1. <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/HDF5Array">https://bioconductor.org/packages/HDF5Array</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Collado-Torres L. LieberInstitute/shinycsv: Zenodo integration. Zenodo 2019. <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/badge/latestdoi/72884509">https://zenodo.org/badge/latestdoi/72884509</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frankish</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Diekhans</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ferreira</surname>
            <given-names>A-M</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Jungreis</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Loveland</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mudge</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Sisu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Armstrong</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Barnes</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Berry</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bignell</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Carbonell Sala</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chrast</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cunningham</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Di Domenico</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Donaldson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fiddes</surname>
            <given-names>IT</given-names>
          </name>
          <name>
            <surname>García Girón</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gonzalez</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Grego</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hardy</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hourlier</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hunt</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Izuogu</surname>
            <given-names>OG</given-names>
          </name>
          <name>
            <surname>Lagarde</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Martínez</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mohanan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Muir</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Navarro</surname>
            <given-names>FCP</given-names>
          </name>
          <name>
            <surname>Parker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pei</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Pozo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ruffier</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schmitt</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Stapleton</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Suner</surname>
            <given-names>M-M</given-names>
          </name>
          <name>
            <surname>Sycheva</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Uszczynska-Ratajczak</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yates</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zerbino</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Aken</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Choudhary</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Guigó</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hubbard</surname>
            <given-names>TJP</given-names>
          </name>
          <name>
            <surname>Kellis</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Paten</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Reymond</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tress</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Flicek</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>GENCODE reference annotation for the human and mouse genomes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>D1</issue>
        <fpage>766</fpage>
        <lpage>773</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky955</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Wickham H. Ggplot2: elegant graphics for data analysis. Springer; 2016. <ext-link ext-link-type="uri" xlink:href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <mixed-citation publication-type="other">Schloerke B, Cook D, Larmarange J, Briatte F, Marbach M, Thoen E, Elberg A, Crowley J. GGally: extension to ’ggplot2’. 2021. R package version 2.1.2. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=GGally">https://CRAN.R-project.org/package=GGally</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>KYY</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Y-J</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>P-Y</given-names>
          </name>
        </person-group>
        <article-title>BS-Seeker3: ultrafast pipeline for bisulfite sequencing</article-title>
        <source>BMC Bioinform</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>111</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-018-2120-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Jaffe AE. LIBD-WGBS-SCZD, 2021. <pub-id pub-id-type="doi">10.7303/syn4921369</pub-id>. Accessed 18 Jul 2023.</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Perzel Mandell</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Eagles</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Wilton</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Price</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Semick</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Collado-Torres</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ulrich</surname>
            <given-names>WS</given-names>
          </name>
          <name>
            <surname>Tao</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Szalay</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Hyde</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Kleinman</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Weinberger</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Jaffe</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide sequencing-based identification of methylation quantitative trait loci and their role in schizophrenia risk</article-title>
        <source>Nat Commun</source>
        <year>2021</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>5251</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-25517-3</pub-id>
        <?supplied-pmid 34475392?>
        <pub-id pub-id-type="pmid">34475392</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Perzel Mandell</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Eagles</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Deep-Soboslay</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tao</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wilton</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Szalay</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Hyde</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Kleinman</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Jaffe</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Weinberger</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Molecular phenotypes associated with antipsychotic drugs in the human caudate nucleus</article-title>
        <source>Mol Psychiatry</source>
        <year>2022</year>
        <volume>27</volume>
        <fpage>2061</fpage>
        <lpage>2067</lpage>
        <pub-id pub-id-type="doi">10.1038/s41380-022-01453-6</pub-id>
        <?supplied-pmid 35236959?>
        <pub-id pub-id-type="pmid">35236959</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">Zappia L, Lun A. Zellkonverter: conversion between scRNA-seq objects. 2021. R package version 1.4.0. <ext-link ext-link-type="uri" xlink:href="https://github.com/theislab/zellkonverter">https://github.com/theislab/zellkonverter</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
