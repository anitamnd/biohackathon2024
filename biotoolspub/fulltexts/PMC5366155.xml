<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5366155</article-id>
    <article-id pub-id-type="publisher-id">1182</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-017-1182-6</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MeDeCom: discovery and quantification of latent components of heterogeneous methylomes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Lutsik</surname>
          <given-names>Pavlo</given-names>
        </name>
        <address>
          <email>p.lutsik@mx.uni-saarland.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Slawski</surname>
          <given-names>Martin</given-names>
        </name>
        <address>
          <email>martin.slawski@rutgers.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gasparoni</surname>
          <given-names>Gilles</given-names>
        </name>
        <address>
          <email>gillesgasparoni@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vedeneev</surname>
          <given-names>Nikita</given-names>
        </name>
        <address>
          <email>nikitavedeneev@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Hein</surname>
          <given-names>Matthias</given-names>
        </name>
        <address>
          <email>hein@cs.uni-saarland.de</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0563-7417</contrib-id>
        <name>
          <surname>Walter</surname>
          <given-names>Jörn</given-names>
        </name>
        <address>
          <email>j.walter@mx.uni-saarland.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2167 7588</institution-id><institution-id institution-id-type="GRID">grid.11749.3a</institution-id><institution>Department of EpiGenetics, </institution><institution>Saarland University, </institution></institution-wrap>Campus A2.4, Saarbrücken, 66123 Germany </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2167 7588</institution-id><institution-id institution-id-type="GRID">grid.11749.3a</institution-id><institution>Machine Learning Group, </institution><institution>Saarland University, </institution></institution-wrap>Campus E1.1, Saarbrücken66123, Germany </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 8796</institution-id><institution-id institution-id-type="GRID">grid.430387.b</institution-id><institution>Department of Statistics and Biostatistics, Department of Computer Science, </institution><institution>Rutgers University, </institution></institution-wrap>110 Frelinghuysen Rd, Piscataway, 08854 NJ USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0492 0584</institution-id><institution-id institution-id-type="GRID">grid.7497.d</institution-id><institution>Present address: Division of Cancer Epigenetics, </institution><institution>German Cancer Research Center, </institution></institution-wrap>Im Neuenheimerfeld 280, Heidelberg, 69120 Germany </aff>
      <aff id="Aff5"><label>5</label>Present address: Department of Statistics, Volgenau School of Engineering, George Mason University, 4400 University Drive, MS 4A7 Fairfax, Fairfax, VA 22030-4444 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>3</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>3</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <volume>18</volume>
    <elocation-id>55</elocation-id>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>9</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>2</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2017</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p>It is important for large-scale epigenomic studies to determine and explore the nature of hidden confounding variation, most importantly cell composition. We developed MeDeCom as a novel reference-free computational framework that allows the decomposition of complex DNA methylomes into latent methylation components and their proportions in each sample. MeDeCom is based on constrained non-negative matrix factorization with a new biologically motivated regularization function. It accurately recovers cell-type-specific latent methylation components and their proportions. MeDeCom is a new unsupervised tool for the exploratory study of the major sources of methylation variation, which should lead to a deeper understanding and better biological interpretation.</p>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s13059-017-1182-6) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>DNA methylation</kwd>
      <kwd>DNA methylome</kwd>
      <kwd>Cell heterogeneity</kwd>
      <kwd>Deconvolution</kwd>
      <kwd>Matrix factorization</kwd>
      <kwd>Epigenetics</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>EU 7th Framework Programme</institution>
        </funding-source>
        <award-id>267038 (NOTOX)</award-id>
        <principal-award-recipient>
          <name>
            <surname>Lutsik</surname>
            <given-names>Pavlo</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001659</institution-id>
            <institution>Deutsche Forschungsgemeinschaft</institution>
          </institution-wrap>
        </funding-source>
        <award-id>Cluster of Excellence MMCI</award-id>
        <principal-award-recipient>
          <name>
            <surname>Slawski</surname>
            <given-names>Martin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002347</institution-id>
            <institution>Bundesministerium für Bildung und Forschung</institution>
          </institution-wrap>
        </funding-source>
        <award-id>01KU1216A (DEEP)</award-id>
        <principal-award-recipient>
          <name>
            <surname>Walter</surname>
            <given-names>Jörn</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2017</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>DNA methylation is one of the most extensively studied epigenetic marks in the human genome. Methods of detection and quantification are relatively robust and methylation data can be obtained at single-base resolution. DNA methylation closely mirrors the functional state of a cell [<xref ref-type="bibr" rid="CR1">1</xref>]. Each human cell type has a characteristic methylation profile (methylome) covering its roughly 27 million CpG dinucleotides [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>]. DNA methylomes undergo significant global and lineage-related changes during development [<xref ref-type="bibr" rid="CR4">4</xref>] and form cell-type-specific patterns upon differentiation [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>]. They also reflect the individual (genetic) constitution [<xref ref-type="bibr" rid="CR7">7</xref>], are influenced by gender, are subject to environmental influences [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>], and change with age [<xref ref-type="bibr" rid="CR10">10</xref>]. In aging cells and in diseased cells, they accumulate errors over time and DNA replications [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. DNA methylation can, therefore, be used to infer the developmental origin, the cell-type specificity, and many other biological and sampling variables contributing to individual epigenetic profiles. A knowledge of these confounding effects and their consequences for methylome changes are of utmost importance for a biological interpretation of DNA-methylation changes in comparative studies.</p>
    <p>For practical reasons, comparative epigenomic studies often use tissue samples or cells extracted from body fluids (mostly blood) [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]. All these sources are composed of several major and minor cell types with variable composition [<xref ref-type="bibr" rid="CR14">14</xref>]. Blood, for example, includes up to ten major and many more minor cell types. Cell type-attributed heterogeneity was shown to be a major source of variation in comparative blood-based DNA methylome studies [<xref ref-type="bibr" rid="CR15">15</xref>]. The same holds for studies performed with brain tissue, where the compositional changes of cells are strongly influenced by age, gender, and disease state [<xref ref-type="bibr" rid="CR16">16</xref>–<xref ref-type="bibr" rid="CR19">19</xref>]. Overall, genetic variation, variable cell composition, and age appear to be the strongest confounders in DNA methylome analysis [<xref ref-type="bibr" rid="CR20">20</xref>–<xref ref-type="bibr" rid="CR22">22</xref>].</p>
    <p>To overcome the compositional confounding, DNA methylation studies increasingly make use of cell enrichment or cell separation techniques [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR24">24</xref>] to decompose samples experimentally prior to methylation analysis [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>]. These methods clearly enhance the signal interpretability, but they come at the risk of introducing new experimental variation caused by cell-sorting methods, tissue dissection approaches etc. [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR27">27</xref>]. In the worst case, cell separation may even exclude unknown – but informative – cell populations. Single-cell methylome analyses would be an alternative. However, comprehensive single-cell methylome data are still difficult to obtain and too costly for studies in which large sample numbers have to be compared [<xref ref-type="bibr" rid="CR28">28</xref>–<xref ref-type="bibr" rid="CR31">31</xref>]. Moreover, non-uniform cell separation or sampling prior to single-cell approaches may also introduce additional uncontrollable confounding effects. Finally, the sequencing depth has to be high to recover important changes in rare or difficult-to-recover cell populations [<xref ref-type="bibr" rid="CR31">31</xref>].</p>
    <p>Possible approaches for dealing with the heterogeneity problems include computational estimation or correction (adjustment) methods [<xref ref-type="bibr" rid="CR32">32</xref>]. Houseman et al. were the first to develop a systematic approach that used reference DNA methylation profiles of purified cell types to infer the cell-type proportions in blood via a constrained projection procedure [<xref ref-type="bibr" rid="CR33">33</xref>–<xref ref-type="bibr" rid="CR36">36</xref>]. Similar reference-based correction approaches have also been used for complex tissues such as brain [<xref ref-type="bibr" rid="CR37">37</xref>, <xref ref-type="bibr" rid="CR38">38</xref>]. Recently, a series of reference-free methods were developed that adjust for DNA methylation changes caused by cell heterogeneity, allowing for the quantification of direct methylation effects [<xref ref-type="bibr" rid="CR39">39</xref>–<xref ref-type="bibr" rid="CR41">41</xref>].</p>
    <p>Here we present a novel computational framework called MeDeCom, which uses a special form of regularized non-negative matrix factorization (NMF) to decompose methylome data into a set of underlying latent DNA methylation components (LMCs) and their proportions in each sample. A similar NMF-based approach, RefFreeCellMix, has recently been proposed [<xref ref-type="bibr" rid="CR42">42</xref>]. However, a key feature distinguishing MeDeCom from RefFreeCellMix and other standard NMF approaches is the incorporation of a biologically motivated regularizer that favors LMCs with per-CpG values close to zero (unmethylated) or one (methylated). In various experiments, we demonstrate that this form of regularization is the key element for an accurate estimation of LMCs corresponding to cell-type-specific methylomes and their associated proportions. Unlike RefFreeCellMix and other NMF-based methods, which infer a correct decomposition only if measurements of pure cell-types are implicitly present in the data set, MeDeCom also works when only measurements of mixtures of different cell types and no purified references are available. We demonstrate the performance of MeDeCom in controlled experimental settings and its application in more complex scenarios of cell populations and tissues. We show that MeDeCom can be used for adjustment in an epigenome-wide association study (EWAS) with excellent performance on par with the most advanced methods [<xref ref-type="bibr" rid="CR39">39</xref>–<xref ref-type="bibr" rid="CR41">41</xref>]. Finally, we demonstrate that the unsupervised decomposition of complex methylation data into LMCs and their proportions can be used as a new exploratory tool to obtain novel biological insights going beyond the analysis of confounding factors.</p>
  </sec>
  <sec id="Sec2">
    <title>Results and discussion</title>
    <sec id="Sec3">
      <title>MeDeCom: introduction to the computational framework</title>
      <p>We developed MeDeCom, a novel computational framework for methylation data decomposition. The conceptual background of MeDeCom is illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>
<xref rid="Fig1" ref-type="fig">a</xref>. DNA methylation profiles of complex tissues and cell mixtures are a composite mix of patterns of individual cell types with discrete (binary) position-specific methylation values (Fig. <xref rid="Fig1" ref-type="fig">1</xref>
<xref rid="Fig1" ref-type="fig">a</xref>). In other words, the DNA-methylation pattern generated, e.g., using 450K or EPIC bead arrays, is the product of the cell-specific pattern variation <italic>C</italic> and the frequencies in which individual cells are present in tissues or cell mixes, <italic>F</italic> (Fig. <xref rid="Fig1" ref-type="fig">1</xref>
<xref rid="Fig1" ref-type="fig">a</xref>, top). MeDeCom decomposes such mixed methylome patterns into two matrices, <italic>T</italic> and <italic>A</italic>. <italic>T</italic> describes the LMCs and reflects an average methylation pattern of an underlying cell type, while <italic>A</italic> contains the proportions of LMCs in each sample (Fig. <xref rid="Fig1" ref-type="fig">1</xref>
<xref rid="Fig1" ref-type="fig">a</xref>, bottom).
<fig id="Fig1"><label>Fig. 1</label><caption><p>Computational framework of MeDeCom. <bold>a</bold> The conceptional background of MeDeCom. The measured methylomes (e.g., as 450K data, shown in the center) can be seen as a composition of binary single-cell methylome signatures (<italic>C</italic>) with their frequencies in each sample (<italic>F</italic>). Single-cell signatures of a particular cell type form a cell-type specific cluster in <italic>C</italic>. MeDeCom decomposes the measured methylation data into a matrix <italic>T</italic>, representing latent methylation components (LMCs), which in turn correspond to the averaged cell methylomes of a cell-type-specific cluster in <italic>C</italic>, and into <italic>A</italic>, the relative proportions of LMCs (respectively, cell types) in the sample. <bold>b</bold> Histograms of the values in the estimated <italic>T</italic> matrices for the 500 most varying CpG sites for the cell reconstruction experiment of neuronal cells (see text). We observe that both MeDeCom with no regularization (<italic>λ</italic>=0), and RefFreeCellMix are unable to match the distribution of the reference profiles (ground truth), which is biased towards zero and one. However, MeDeCom with our regularizer (parameter <italic>λ</italic> is chosen by cross-validation) biases the entries of the LMCs towards zero (unmethylated) and one (methylated). Thus, the distribution of the entries of the estimated LMCs matches approximately the ground truth leading to a significantly better estimation of <italic>T</italic> as well as <italic>A</italic>. <bold>c</bold>-<bold>d</bold> Geometric intuition about the different methods for a fully synthetic example of two CpGs (<italic>n</italic>=30, <italic>k</italic>=3). Each LMC corresponds to a column of <italic>T</italic> and, thus, is a point in [0,1]<sup>2</sup>. <bold>c</bold> shows the estimated LMCs (<italic>squares</italic>) of RefFreeCellMix and MeDeCom with <italic>λ</italic>=0 and <italic>λ</italic>=10<sup>−2</sup>, and the ground truth (<italic>black squares</italic>) together with the data (<italic>blue dots</italic>). The data points are mixtures of the ground truth points and, thus, lie in the convex hull of the latter. Factorization problem (<xref rid="Equ2" ref-type="">2</xref>) (see “<xref rid="Sec13" ref-type="sec">Methods</xref>”) is ill-posed as the solution is not unique. MeDeCom with appropriate regularization estimates <italic>T</italic> (<italic>red squares</italic>) very accurately as the solution is biased towards zero or one, whereas RefFreeCellMix and MeDeCom with <italic>λ</italic>=0 are unable to find the correct LMCs. This also leads to huge errors in the estimation of the proportions as visualized by the ternary plot for ten randomly selected data points (<bold>d</bold>). In contrast, MeDeCom with appropriate regularization estimates <italic>A</italic> very accurately</p></caption><graphic xlink:href="13059_2017_1182_Fig1_HTML" id="MO1"/></fig>
</p>
      <p>To estimate <italic>T</italic> and proportions <italic>A</italic> for LMCs, MeDeCom uses a constrained NMF algorithm together with a regularization function on <italic>T</italic>. The regularization shifts the estimated matrix of methylation patterns <italic>T</italic> towards biologically plausible binary values close to zero (unmethylated) or one (methylated). The regularization of <italic>T</italic> is key to yielding accurate estimates of cell-type-specific methylation patterns and their proportions (see below). MeDeCom has two parameters: i) the number <italic>k</italic> of LMCs that are supposed to be estimated and ii) the amount of regularization <italic>λ</italic>. We show that both parameters can be reliably estimated by cross-validation. The details and the mathematical background of MeDeCom are outlined in “<xref rid="Sec13" ref-type="sec">Methods</xref>.”</p>
      <p>To facilitate the interpretation of the MeDeCom results, we designed an exploratory interactive visualization tool called FactorViz. This tool allows the user to visualize the performance of MeDeCom, explore the LMCs, and obtain various kinds of information for further biological interpretation. MeDeCom and FactorViz are publicly available as a web resource at [<xref ref-type="bibr" rid="CR43">43</xref>].</p>
      <p>In the following sections, we will demonstrate the use of MeDeCom on synthetic and real Infinium 450k data sets of increasing complexity. We also demonstrate the usefulness of MeDeCom to decompose complex blood and tissue methylation data (also in comparison to reference-based methods) and provide examples showing how the obtained LMCs can help explore the origin of variation. We will adjust these parameters and provide novel ideas for the biological interpretation of methylation data.</p>
      <sec id="Sec4">
        <title>Illustration of the effect of regularization</title>
        <p>While conceptually simple, the introduction of our biologically motivated regularizer is the major determinant of the superior decomposition achieved by MeDeCom (Fig. <xref rid="Fig1" ref-type="fig">1</xref>
<xref rid="Fig1" ref-type="fig">b</xref>). The histograms of the estimated <italic>T</italic> matrices are shown for an unregularized model and the regularized model chosen by cross-validation (a more detailed description of the corresponding cell reconstruction experiment follows below). The histogram of <italic>T</italic> for the regularized model is very close to the histogram of the true methylomes, while the histograms of the unregularized model and of RefFreeCellMix are far from the ground truth, which reflect the lack of bias towards biologically plausible <italic>T</italic>. The correct estimation of <italic>T</italic> via regularization allows us also to recover the correct proportions (Fig. <xref rid="Fig1" ref-type="fig">1</xref>
<xref rid="Fig1" ref-type="fig">c</xref>, <xref rid="Fig1" ref-type="fig">d</xref>). In our model scenario, all data points (blue dots) lie in the convex hull of the three estimated LMCs (squares), showing that there exist multiple solutions with virtually the same fit to the data. MeDeCom breaks this ambiguity in the solution as the regularizer shifts the values of the LMCs towards zero and one. We see that the regularized model fits the ground truth well (Fig. <xref rid="Fig1" ref-type="fig">1</xref>
<xref rid="Fig1" ref-type="fig">c</xref>). A misestimation of <italic>T</italic> also leads to a misestimation of the proportions in <italic>A</italic> (Fig. <xref rid="Fig1" ref-type="fig">1</xref>
<xref rid="Fig1" ref-type="fig">d</xref>). The proportions of the three LMCs in each sample as estimated by MeDeCom are very close to the true ones for the regularized model while they are completely wrong for the unregularized model and RefFreeCellMix.</p>
      </sec>
      <sec id="Sec5">
        <title>Decomposition of simulated methylation data</title>
        <p>To examine the performance of MeDeCom in a controlled setting, we analyzed synthetic DNA methylation mixtures generated by simulation (see “<xref rid="Sec13" ref-type="sec">Methods</xref>” for details). The controlled data sets varied in the numbers of cell-type-specific patterns (LMCs), the inter-LMC similarity, and the variability of the mixture proportions (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1).</p>
        <p>Figure <xref rid="Fig2" ref-type="fig">2</xref>
<xref rid="Fig2" ref-type="fig">a</xref>–<xref rid="Fig2" ref-type="fig">f</xref> summarizes the results for moderately variable mixture proportions of five pure blood-derived cell-type profiles (see below). FactorViz inspections show that the cross-validation error (CVE) levels out at <italic>k</italic>≥5, indicating that MeDeCom identified the correct number of underlying LMCs (Fig. <xref rid="Fig2" ref-type="fig">2</xref>
<xref rid="Fig2" ref-type="fig">a</xref>). The optimal regularization parameter <italic>λ</italic> was found to be <italic>λ</italic>=0.01. The estimated LMCs unambiguously match the source DNA methylation profiles (Fig. <xref rid="Fig2" ref-type="fig">2</xref>
<xref rid="Fig2" ref-type="fig">b</xref>). The individual methylation profiles were reconstructed with an overall root-mean-square error (RMSE) of 0.064. MeDeCom also accurately reproduced the mixing coefficients (proportions) with mean absolute error (MAE) of 0.0296 (Fig. <xref rid="Fig2" ref-type="fig">2</xref>
<xref rid="Fig2" ref-type="fig">c</xref>–<xref rid="Fig2" ref-type="fig">f</xref>). We obtained similar results for other cases with a varying number of underlying components and mixture proportions (see the MeDeCom web resource).
<fig id="Fig2"><label>Fig. 2</label><caption><p>Testing MeDeCom on simulated and artificial cell mixture data. <bold>a</bold>–<bold>f</bold> Results for the simulated data example with five methylation components, moderately variable mixing proportions, and medium noise level. <bold>a</bold> Selection of parameters <italic>k</italic> and <italic>λ</italic> by cross-validation. <bold>b</bold> Matching of the recovered LMCs to the true underlying profiles. The dendrogram visualizes the agglomerative hierarchical clustering analysis with correlation-based distance measure and average linkage. <bold>c</bold>–<bold>f</bold> Recovery of the mixing proportions. <italic>Truth</italic> stands for true mixing proportions and <italic>regression</italic> denotes the reference-based proportion estimation as described in “<xref rid="Sec13" ref-type="sec">Methods</xref>.” In each line plot, the synthetic samples are sorted by ascending true mixing proportion. <bold>g</bold>, <bold>h</bold> Results for the ArtMixN data set. <bold>g</bold> Selection of parameters <italic>k</italic> and <italic>λ</italic> by cross-validation. <bold>h</bold> Recovery of mixing proportions (only NeuN <sup>+</sup> is shown) for MeDeCom and RefFreeCellMix. RefFreeCellMix misinterprets the most extreme mixtures as pure cell types and, thus, estimates <italic>T</italic> (see Fig. 1b) as well as the proportions in <italic>A</italic> wrongly. Notation is the same as in <bold>c</bold>–<bold>f</bold>
</p></caption><graphic xlink:href="13059_2017_1182_Fig2_HTML" id="MO2"/></fig>
</p>
        <p>The summary plots of the LMC recovery rate (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S1) show that, given a low number of samples, the choice of the model and the variability level of the mixture proportions were key factors in the performance of LMC reconstruction in MeDeCom. However, decomposition became impossible when the variability of the mixture proportions was very low and, at the same time, the noise level was high (see an example in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S2 and the MeDeCom web resource). In this case, the variation in the data due to uneven cell-type composition is comparable or smaller than the noise, and, thus, it becomes impossible to estimate LMCs and their proportions. We also did the same experiments for RefFreeCellMix. For simple cases, it performs similarly to MeDeCom, but RefFreeCellMix is outperformed consistently by MeDeCom once the setting gets more difficult (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S1).</p>
      </sec>
      <sec id="Sec6">
        <title>Decomposition of reconstructed cell mixtures</title>
        <p>Next, we analyzed the performance of MeDeCom on publicly available 450K data sets of cell mixtures with known proportions [<xref ref-type="bibr" rid="CR37">37</xref>] (data set ArtMixN in Table <xref rid="Tab1" ref-type="table">1</xref>). In this study, brain cell nuclei were separated using a neuron-specific marker NeuN, and fluorescence activated cell sorting (FACS) into NeuN <sup>+</sup> (neuronal) and NeuN <sup>−</sup> (non-neuronal) fractions. These fractions were mixed incrementally (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2) and methylomes measured on a 450K array. We were interested in finding out how well MeDeCom could recover the source NeuN <sup>+/−</sup> methylomes and their mixing ratios. We show the results for five mixtures: {(0.3,0.7),(0.4,0.6),(0.5,0.5), (0.6,0.4),(0.7,0.3)}. The results for all nine mixtures can be found in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figures S6 and S7.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Public Infinium 450k data sets used in the study</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">ID</th><th align="left">Source</th><th align="left">GEO Accession</th><th align="left">Brief description</th><th align="left"><italic>n</italic></th><th align="left">Reference</th></tr></thead><tbody><tr><td align="left"><italic>Blood data sets</italic></td><td align="left"/><td align="left"/><td align="justify"/><td align="left"/><td align="left"/></tr><tr><td align="left">PureBC</td><td align="left">[<xref ref-type="bibr" rid="CR44">44</xref>]</td><td align="left">GSE35069</td><td align="justify">Seven MACS-purified blood cell types from blood of six healthy male donors: neutrophils, monocytes, B cells, CD4+ and CD8+ T cells, NK cells, and eosinophils</td><td align="left">42</td><td align="left"/></tr><tr><td align="left">WB1</td><td align="left">[<xref ref-type="bibr" rid="CR35">35</xref>]</td><td align="left">GSE42861</td><td align="justify">Whole blood of healthy controls from a rheumatoid arthritis study (technical batch II)</td><td align="left">87</td><td align="left">PureBC</td></tr><tr><td align="left">WB2</td><td align="left">[<xref ref-type="bibr" rid="CR45">45</xref>]</td><td align="left">GSE51032</td><td align="justify">Whole blood of the EPIC Italy study participants who remained cancer-free in 2010</td><td align="left">442</td><td align="left">PureBC</td></tr><tr><td align="left"><italic>Neuronal data sets</italic></td><td align="left"/><td align="left"/><td align="justify"/><td align="left"/><td align="left"/></tr><tr><td align="left">PureN</td><td align="left">[<xref ref-type="bibr" rid="CR37">37</xref>]</td><td align="left">GSE15745</td><td align="justify">Cortical NeuN <sup>+/−</sup> fractions of the 29 healthy controls</td><td align="left">58</td><td align="left"/></tr><tr><td align="left">ArtMixN</td><td align="left">[<xref ref-type="bibr" rid="CR37">37</xref>]</td><td align="left">GSE15745</td><td align="justify">Nine titration mixtures of the NeuN <sup>+/−</sup> fractions</td><td align="left">9</td><td align="left">PureN</td></tr><tr><td align="left">FC1</td><td align="left">[<xref ref-type="bibr" rid="CR37">37</xref>]</td><td align="left">GSE15745</td><td align="justify">Frontal cortex of ten MDD patients and ten healthy controls</td><td align="left">20</td><td align="left">PureN</td></tr><tr><td align="left">FC2</td><td align="left">[<xref ref-type="bibr" rid="CR19">19</xref>]</td><td align="left">GSE15745</td><td align="justify">Frontal cortex from a large AD study</td><td align="left">114</td><td align="left">PureN</td></tr></tbody></table><table-wrap-foot><p><italic>AD</italic> Alzheimer’s disease, <italic>GEO</italic> Gene Expression Omnibus, <italic>MDD</italic> major depression disorder</p></table-wrap-foot></table-wrap>
</p>
        <p>MeDeCom indeed identified two major LMCs at CVE minimum close to <italic>λ</italic>=5×10<sup>−4</sup> (Fig. <xref rid="Fig2" ref-type="fig">2</xref>
<xref rid="Fig2" ref-type="fig">g</xref>; Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S3). Each of the recovered LMCs showed high CpG-wise correlation to the average profile of either the NeuN <sup>+</sup> or NeuN <sup>−</sup> fractions (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S4) and reproduced it with high accuracy (RMSE 0.029). The mixture proportions were accurately recovered as well (MAE 0.025; Fig. <xref rid="Fig2" ref-type="fig">2</xref>
<xref rid="Fig2" ref-type="fig">h</xref>). As in the artificial example of Fig. <xref rid="Fig1" ref-type="fig">1</xref>
<xref rid="Fig1" ref-type="fig">c</xref>, RefFreeCellMix is inferior both in the estimation of <italic>T</italic> (RMSE 0.037) and <italic>A</italic> (MAE 0.162) due to the lack of a bias towards biologically plausible values (Fig. <xref rid="Fig2" ref-type="fig">2</xref>
<xref rid="Fig2" ref-type="fig">h</xref> and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S5). The difference in the results for MeDeCom and RefFreeCellMix becomes even more pronounced if one computes the RMSE for <italic>T</italic> limited to the 500 most varying CpG sites, where MeDeCom has a RMSE of 0.082 compared to 0.190 for RefFreeCellMix and 0.194 for MeDeCom with no regularizer (<italic>λ</italic>=0). In Fig. <xref rid="Fig1" ref-type="fig">1</xref>
<xref rid="Fig1" ref-type="fig">b</xref>, we visualize the difference by showing the histogram of the estimated entries of <italic>T</italic> for the 500 most varying CpG sites. Our estimated histogram is close to the ground truth whereas the histograms of RefFreeCellMix and the unregularized model are much further off, which is then reflected in the wrong estimation of the proportions for RefFreeCellMix. Since the synthetic experiments as well as the artificial mixture experiment show that RefFreeCellMix cannot reliably recover cell-type LMCs and their proportions when there are only mixtures as samples, we do not compare to them in the analysis of complex mixtures from blood or brain tissue.</p>
      </sec>
    </sec>
    <sec id="Sec7">
      <title>Methylome decomposition of whole-blood cell samples</title>
      <p>Following the successful test of MeDeCom on synthetic data and artificial cell mixtures, we applied our method to whole-blood Infinium 450k samples from two independent studies (Table <xref rid="Tab1" ref-type="table">1</xref>). Our aim was to test the performance, reproducibility, and robustness of our method in a side-by-side comparison. We first applied MeDeCom to control samples from a large rheumatoid arthritis study [<xref ref-type="bibr" rid="CR35">35</xref>]. To avoid known technical confounding effects (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S9), we confined our first analysis to 87 samples forming a technically homogeneous batch (data set WB1).</p>
      <p>The CVE continued to decline until <italic>k</italic>=20 implying a large number of distinct variation confounders that is, LMCs (Fig. <xref rid="Fig3" ref-type="fig">3</xref>
<xref rid="Fig3" ref-type="fig">a</xref>). We, therefore, examined the factorization results for increasing values of <italic>k</italic> to understand the relation between LMC recovery and underlying major and minor confounding variants (i.e., cell types, subtypes etc.). For a biological interpretation, we compared the LMCs of increasing values of <italic>k</italic> to published reference methylomes of FACS-sorted major blood cell types [<xref ref-type="bibr" rid="CR44">44</xref>] (data set PureBC).
<fig id="Fig3"><label>Fig. 3</label><caption><p>Results for blood cell methylomes. <bold>a</bold>–<bold>e</bold> WB1 data set. <bold>a</bold> Selection of parameters <italic>k</italic> and <italic>λ</italic> by cross-validation. <bold>b</bold> Matching the WB1 LMCs to PureBC methylomes (<italic>k</italic>=20, <italic>λ</italic>=0.001). Here and below the dendrogram visualizes agglomerative hierarchical clustering analysis with a correlation-based distance measure and average linkage. <bold>c</bold> Matching the LMCs from the WB2 data set (<italic>k</italic>=20, <italic>λ</italic>=0.001) to the PureBC methylomes. <bold>d</bold> Matching the WB1 and WB2 LMCs to each other. Pairs of reproducible LMCs also matching to the reference profiles are highlighted by <italic>red segments</italic>. <italic>Green segments</italic> mark reproducible LMCs that do not directly match any of the reference profiles. <bold>e</bold> Adjustment of the association analysis for rheumatoid arthritis in the full Liu et al. data set [<xref ref-type="bibr" rid="CR35">35</xref>]. Each curve is a Q-Q plot of <italic>P</italic> values observed in the corresponding analysis versus the expected <italic>P</italic> values sampled from a uniform distribution. <bold>f</bold>–<bold>h</bold> PureBC data. <bold>f</bold> Selection of parameters <italic>k</italic> and <italic>λ</italic> by cross-validation. <bold>g</bold> Heat map of recovered proportions in PureBC data (<italic>k</italic>=15, <italic>λ</italic>=0.001). Rows represent LMCs while columns correspond to individual purified samples. The order of blood donors is the same within column sets, corresponding to one cell type. <bold>h</bold> Methylation differences in naive versus memory B cells at CpGs differentially methylated between LMC2 and LMC13 from the PureBC data set. WGBS methylation profiles of naive and memory B cells were obtained from BLUEPRINT. The value for memory B cells is an average of three WGBS samples. A Wilcoxon ranked sum test was used to test the null hypothesis that WBGS methylation calls are the same in naive and memory cells at their respective CpG positions</p></caption><graphic xlink:href="13059_2017_1182_Fig3_HTML" id="MO3"/></fig>
</p>
      <p>From <italic>k</italic>=2 on, the recovered LMCs distinguish the cell populations of the myeloid and the lymphoid lineages, respectively (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figures S10 and S11). This split in the two lineage clusters is maintained at increasing values, e.g., <italic>k</italic>=20, <italic>λ</italic>=1.0×10<sup>−3</sup> (Fig. <xref rid="Fig3" ref-type="fig">3</xref>
<xref rid="Fig3" ref-type="fig">b</xref>; Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S12). Altogether, 11 LMCs in the myeloid arm cluster show greater similarity to LMCs describing FACS-sorted references for monocytes, eosinophils, and neutrophils while the remaining nine LMCs cluster with CD4+ T cells, CD8+ T cells, NK cells, and B cells. In the myeloid cluster, we fail to detect direct sub-lineage-specific LMC matches. In the lymphoid cluster, however, we observed one LMC closely matching the CD4+ T-cell profile, and one LMC corresponding to the sub-cluster of CD8+ T cells and NK cells, indicating a better separability of the T-cell signatures based on the 450K data used. Finally, our analysis directly identified a number of LMCs with high proportions in single donors, most probably reflecting sites with genetic variation (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figures S13 and S14).</p>
      <p>The results of the first data set were reproduced on a second independent whole-blood data set (WB2) from the EPIC Italy study [<xref ref-type="bibr" rid="CR45">45</xref>], which recovered a highly similar clustering of LMCs (Fig. <xref rid="Fig3" ref-type="fig">3</xref>
<xref rid="Fig3" ref-type="fig">b</xref> and <xref rid="Fig3" ref-type="fig">c</xref>). A direct comparison of the LMC clustering between both whole-blood data sets reveals a considerable agreement of LMCs matching side by side, suggesting that MeDeCom recovers robust and reproducible LMC signatures (Fig. <xref rid="Fig3" ref-type="fig">3</xref>
<xref rid="Fig3" ref-type="fig">d</xref>).</p>
      <p>An aggregated comparison of LMCs matching to reference cell types in both blood analyses showed good correspondence to the regression-based estimations of cell proportions (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S15). For several LMCs in WB1 and WB2, we observed that their proportions correlated with age, e.g., for WB1 the LMC12 related to CD4+ T cells (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S17). Although the total number of CD4+ T cells was reported to change non-significantly with age [<xref ref-type="bibr" rid="CR46">46</xref>], T-cell-specific immunological senescence is a well-known phenomenon characterized by depletion of the naive T-cell sub-populations [<xref ref-type="bibr" rid="CR47">47</xref>, <xref ref-type="bibr" rid="CR48">48</xref>]. This might imply that LMC12 rather reflects the methylation pattern of the naive CD4+ T cells. Indeed, a comparison to reference methylomes of isolated T cells supports this suggestion (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S16).</p>
      <sec id="Sec8">
        <title>Correction of the phenotype association analysis</title>
        <p>Next, we examined if LMCs estimated by MeDeCom can be efficiently used for data adjustment in phenotype association analyses. We first verified the potential of the adjustment in a fully synthetic setting mimicking a typical EWAS in blood (see “<xref rid="Sec13" ref-type="sec">Methods</xref>” for details). We added true methylation effects at the level of single cell type as well as confounding by cell-type proportions (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S29a and b). Adjustment for LMC proportions indeed helped to decrease the confounding and recover the true methylation effects with performance close to the reference-based adjustment of the best available third-party methods (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S29c–e).</p>
        <p>We then applied this approach to a large rheumatoid arthritis data set (WB1), which previously has been used by others for confounding corrections [<xref ref-type="bibr" rid="CR35">35</xref>, <xref ref-type="bibr" rid="CR39">39</xref>–<xref ref-type="bibr" rid="CR41">41</xref>]. We started by selected CpGs significantly associated with the rheumatoid arthritis status using linear modeling (see “<xref rid="Sec13" ref-type="sec">Methods</xref>” for details) with and without adjustment for common covariates. The deviations of the observed <italic>P</italic> value distribution from the expected uniform distribution indicated a large inflation of significance (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S19a). This effect is due to the confounding caused by the unequal distribution of the cell types in rheumatoid arthritis patients and controls [<xref ref-type="bibr" rid="CR35">35</xref>]. We then performed an independent correction for cell composition variability using one reference-based [<xref ref-type="bibr" rid="CR33">33</xref>] and four reference-free methods [<xref ref-type="bibr" rid="CR39">39</xref>–<xref ref-type="bibr" rid="CR42">42</xref>], and compared these results to the results obtained with MeDeCom. Comparative Q-Q plots of the <italic>P</italic> values show that the methods indeed decrease the inflation of significance (Fig. <xref rid="Fig3" ref-type="fig">3</xref>
<xref rid="Fig3" ref-type="fig">e</xref> and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S19). In this test, the adjustment using the LMCs estimated by MeDeCom showed comparable performance with reference-based analysis and the results of ReFACTor. We conclude that the LMCs generated by MeDeCom are useful for covariate correction.</p>
      </sec>
      <sec id="Sec9">
        <title>Purified blood cell populations</title>
        <p>Our whole-blood analyses revealed a limitation in an unambiguous assignment of reference cell types by single LMCs, which may have several reasons. One possible explanation is that the methylomes of FACS-sorted CD marker-positive purified cells, which we and others use as references, constitute composed methylomes of donors with a varying content of cell subtypes. First, a recent single-cell-resolution study of transcriptional heterogeneity in mammalian hematopoiesis [<xref ref-type="bibr" rid="CR49">49</xref>] revealed that the potential of the canonical cell-surface markers to discriminate fine blood cell populations is limited, and their use as FACS gates for cell separation is prone to errors. Second, in particular for B and T cells, it is known that the proportion of cell subtypes may vary and different types of quiescent or dividing cells, such as naive, effector, or memory sub-populations, may confound a clear LMC assignment. We addressed this question by performing a MeDeCom analysis on the seven purified blood cell populations derived from six donors (data set PureBC) [<xref ref-type="bibr" rid="CR44">44</xref>].</p>
        <p>In this analysis, the CVE stabilized at <italic>k</italic>=16 and <italic>λ</italic>=10<sup>−3</sup> (Fig. <xref rid="Fig3" ref-type="fig">3</xref>
<xref rid="Fig3" ref-type="fig">f</xref>; Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figures S21 and S22). A matrix of mixture proportions (Fig. <xref rid="Fig3" ref-type="fig">3</xref>
<xref rid="Fig3" ref-type="fig">g</xref>) showed that the recovered 16 LMCs could be classified into two distinct groups. Six LMCs (LMCs 6, 7, 8, 10, 15, and 16) could be associated with individual donors, most likely reflecting donor-specific genetic variation at the informative CpG positions underlying these LMCs. In a second group, LMCs 1, 3, 4, 5, 7, 9, and 11 corresponded to the enriched cell-type-associated profiles; e.g., LMC4 was predominantly present in CD4+ T cells, LMC11 in neutrophils etc. Nevertheless, we also observed that several LMCs were shared by related cell types. For instance, eosinophil samples show enrichment of the neutrophil-specific LMC11, CD8+ T cells (LMC9) show overlaps with CD4+ T cells (LMC5). Finally, we observed LMCs that were associated with more than one cell type, but which were not a dominating LMC in any of them. For instance, LMC14 was present at low proportion both in CD8+ T cells and NK cells. The co-occurrence of two or more LMCs within one isolated cell population, as well as sharing of LMCs between the populations, suggests that these cell populations could be either mixtures of still not separated distinct cell types, or that these cell populations share epigenetic features that may indeed co-occur in different cell types.</p>
        <p>A clear split for sub-population heterogeneity was observed for CD19+ B cells. Here two LMCs, LMC2 and LMC13, apparently separate naive and memory B cells. To support this conclusion, we selected 401 CpG positions with a methylation difference of more than 0.33 in LMC2 compared to LMC13. First, we saw that many of these CpGs were located in the vicinity of known B-cell-associated genes (Additional file <xref rid="MOESM3" ref-type="media">3</xref>), such as <italic>PTPRCAP</italic> (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S23). We then compared the LMC2- and LMC13-specific CpG 450K values to reference WGBS methylome profiles of memory and naive B-cell samples, obtained by the BLUEPRINT project [<xref ref-type="bibr" rid="CR50">50</xref>]. Then, 44 CpGs (Additional file <xref rid="MOESM3" ref-type="media">3</xref>) indeed directly correspond to the methylation state differences reported by Kulis et al. [<xref ref-type="bibr" rid="CR50">50</xref>] in memory and naive B-cell sub-populations, respectively (Fig. <xref rid="Fig3" ref-type="fig">3</xref>
<xref rid="Fig3" ref-type="fig">d</xref>). We would like to note that LMC2 and and LMC13 have almost inverse proportions for individual donors, indicating that the MeDeCom analysis directly reflects the differences in sample-specific abundance of memory and naive B cells, which suggests individual- or isolation-attributed variation.</p>
        <p>In our blood analysis, we observed that CpGs, which clearly discriminated cell types in purified myeloid and lymphoid lineages, did not exhibit this power in complex samples. To understand this better, we preselected 15,000 marker CpGs with the highest discriminative power between cell types (highest CpG-wise <italic>p</italic>=2.91×10<sup>−44</sup>, ANOVA F-test). A visual comparison of these CpGs between individual reference populations and whole-blood data (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S18) clearly showed that they have a rather low variation across whole-blood samples. Indeed, only a relatively small proportion of marker CpGs also showed a high variance across whole-blood samples detectable by MeDeCom (see the row color code in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S18). We conclude that CpGs, which can be assigned to isolated cell types in purified myeloid and lymphoid lineages, are less informative in complex samples since their level of informative variation in an NMF-based analysis of whole blood is low. This may be a second reason to explain why a series of LMCs recovered in whole blood and in the extreme cases of our simulations do not unambiguously match the reference methylomes.</p>
      </sec>
    </sec>
    <sec id="Sec10">
      <title>Decomposition of the brain tissue methylomes</title>
      <p>Next we applied MeDeCom to examine the heterogeneity of tissue methylomes. The human brain is composed of many neuronal and glial cell types. Current studies apply FACS-based methods to separate glial cells and neurons. The RBFOX3 protein localized in the nuclear membrane of most neuronal cells (also known as NeuN) is used as a selection marker. While the NeuN-enriched and NeuN-depleted cell fractions serve as references in methylome analysis, the question remains to which extent these separated methylomes represent the composition of whole-brain tissue.</p>
      <p>We applied MeDeCom to 20 frontal cortex methylomes from a major depression disorder study [<xref ref-type="bibr" rid="CR37">37</xref>] (data set FC1 in Table <xref rid="Tab1" ref-type="table">1</xref>). The data set also included NeuN <sup>+</sup> and NeuN <sup>−</sup> cell fractions (data set PureN), which we analyzed in comparison to total brain tissue. In addition, we examined an independent bulk frontal cortex methylome data set from a recent large-scale Alzheimer’s disease (AD) study [<xref ref-type="bibr" rid="CR19">19</xref>] (data set FC2).</p>
      <p>For both the FC1 and FC2 data sets, the inspection of CVEs showed a substantial change at <italic>k</italic>≥3, strongly suggesting the existence of more than three main epigenetically distinct cell components (LMCs) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>
<xref rid="Fig4" ref-type="fig">a</xref> and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S24). We carefully examined the factorization results and compared the three main LMCs at <italic>k</italic>=3 and <italic>λ</italic>=5×10<sup>−3</sup> to the NeuN <sup>+</sup> and NeuN <sup>−</sup> profiles. Clustering analysis (Fig. <xref rid="Fig4" ref-type="fig">4</xref>
<xref rid="Fig4" ref-type="fig">b</xref>) showed that the average NeuN <sup>−</sup> reference profile is related to LMC3 while the NeuN <sup>+</sup> profile is more similar to LMC2. The third component LMC1 was truly distinct from both reference methylomes retaining a slightly higher similarity to LMC2 and the NeuN <sup>+</sup> methylome. All three LMCs were remarkably well reproduced in the independent FC2 data set at <italic>k</italic>=3 (Fig. <xref rid="Fig4" ref-type="fig">4</xref>
<xref rid="Fig4" ref-type="fig">c</xref>).
<fig id="Fig4"><label>Fig. 4</label><caption><p>Results for brain methylomes. <bold>a</bold>–<bold>d</bold> Decomposition of the FC1 data set. <bold>a</bold> Selection of parameters <italic>k</italic> and <italic>λ</italic> by cross-validation. <bold>b</bold> Matching frontal cortex LMCs to the reference NeuN <sup>+/−</sup> profiles. The dendrogram visualizes agglomerative hierarchical clustering analysis with a correlation-based distance measure and average linkage. <bold>c</bold> Matching of LMCs between FC1 and FC2. <bold>d</bold> Example of an LMC1-specific CpG (<italic>k</italic>=3) in the PAX6 locus. <bold>e</bold>, <bold>f</bold> AD-associated LMCs in the FC2 data set. <bold>e</bold> LMC2 is associated with the AD phenotype (Wilcoxon rank sum test <italic>P</italic>=3.1×10<sup>−4</sup>). <bold>f</bold> LMC2 is also significantly associated with the Braak stage (<italic>P</italic>=4.8×10<sup>−3</sup>, <italic>T</italic> test of the linear regression coefficient). <bold>g</bold> Clustering of the recovered LMCs for <italic>k</italic>=9 with the LMCs for <italic>k</italic>=3 and reference profiles. LMC2 belongs to the NeuN <sup>−</sup>-associated cluster. <bold>h</bold> Most significant gene ontology terms from the biological process category for the LMC2-associated hypermethylated genes</p></caption><graphic xlink:href="13059_2017_1182_Fig4_HTML" id="MO4"/></fig>
</p>
      <p>This finding indicates that the FACS separation of brain tissues into NeuN <sup>+</sup> and NeuN <sup>−</sup> cells introduces a new confounding variable. In most cases, the NeuN <sup>+</sup> and NeuN <sup>−</sup> fractions together do not fully recapitulate the methylomes of total brain tissues. To get more insights into the biological nature of the LMCs, we asked which loci differ in their methylation between the LMCs and examined the biological annotation of genes associated with LMC-specific CpGs. LMC-specific CpGs were selected to have methylation differences more than 0.33 between one LMC against the two other ones (Additional file <xref rid="MOESM4" ref-type="media">4</xref>). We then mapped LMC-specific CpG positions to their neighboring genes (Additional file <xref rid="MOESM4" ref-type="media">4</xref>; see “<xref rid="Sec13" ref-type="sec">Methods</xref>”) and performed a functional annotation of the associated genes using GREAT [<xref ref-type="bibr" rid="CR51">51</xref>] (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S25). LMC2 (NeuN <sup>+</sup>)-specific CpGs map to genes with a clear enrichment for neuronal-related terms, while LMC3 (NeuN <sup>−</sup>)-specific CpGs were close to genes associated with non-neuronal, mostly oligodendrocyte-related, categories. LMC1-specific CpGs map close to genes associated with developmental and stem-cell-related terms. Strikingly, among the genes associated with LMC1, we found several markers of the neuronal stem-cell lineage, such as <italic>PAX6</italic>, <italic>ZIC1</italic>, <italic>ZIC4</italic>, and <italic>NEUROG1</italic> (Additional file <xref rid="MOESM4" ref-type="media">4</xref>). Notably, the DNA methylation patterns at LMC1-specific CpGs showed significantly higher or lower methylation levels in crude brain tissue than in NeuN <sup>+</sup> and NeuN <sup>+</sup> reference methylomes (see <italic>PAX6</italic> as an example in Fig. <xref rid="Fig4" ref-type="fig">4</xref>
<xref rid="Fig4" ref-type="fig">d</xref> and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S26). Furthermore, a recent study on neuronal heterogeneity in the mouse brain [<xref ref-type="bibr" rid="CR52">52</xref>] provided a reference for the fine cellular subtypes possibly present in the mammalian frontal cortex. We found several of the most significant LMC1-specific genes among the DMRs reported in [<xref ref-type="bibr" rid="CR52">52</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3).</p>
      <p>As outlined earlier, LMC proportions tended to be biased when <italic>k</italic> was significantly lower than optimal (see the WB1 analysis with <italic>k</italic>=2 above). We, therefore, explored MeDeCom results at <italic>k</italic>=4 and <italic>λ</italic>=0.005 (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S27). The analysis revealed that the NeuN <sup>+</sup>-specific LMC3 rather accurately reproduced a reference-estimated NeuN <sup>+</sup> content in most brain samples (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figures S7a and S28a). However, samples with the highest deviation from the reference-based proportions had the highest proportion of co-purified cells (and methylomes), characteristic of LMC2 (equivalent to LMC1 for <italic>k</italic>=3; Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figures S27b and S28b). For <italic>k</italic>=4, two LMCs match to NeuN <sup>−</sup>. For each of them, the proportions recovered by MeDeCom deviated significantly from the reference-based estimates for NeuN <sup>−</sup> (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S28c and d). Nevertheless, the combined proportions largely reflected the reference-estimated NeuN <sup>−</sup> content across all samples (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S28e). Again, we observe that samples with the lowest correspondence had a high contribution of LMC2 (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S28f). The proportion analysis shows that by using MeDeCom we can infer realistic LMC proportions for NeuN <sup>+</sup>, NeuN <sup>−</sup> in individual samples, and a third separate LMC with a distinct cell composition. The latter LMC is variably convoluted into the other main NeuN <sup>+</sup> and NeuN <sup>−</sup> cell fractions in the reference-based analysis. We conclude that reference-independent decomposition is a very helpful approach for exploring, identifying, and quantifying heterogeneity effects across composite tissue samples and will allow us to obtain important and unbiased correction parameters for epigenetic studies of the brain.</p>
    </sec>
    <sec id="Sec11">
      <title>Discovery and annotation of the AD-related LMCs</title>
      <p>Finally, we applied MeDeCom for a phenotype-related analysis on samples where reference methylome adjustment is impossible. To demonstrate the exploratory potential of MeDeCom over other methods in such a setting, we first tested MeDeCom on a simulated data set with an admixture of a rare cell population in one of the compared sample groups as the only phenotype-related effect (see “<xref rid="Sec13" ref-type="sec">Methods</xref>”). In this example, MeDeCom correctly estimated the number of underlying methylation components, and revealed the enrichment of the rare LMC only in the case group (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S30). Encouraged by these results, we applied MeDeCom for an association analysis of the AD phenotype in the FC2 data set. The authors used a canonical CpG-wise approach to identify methylation changes associated with AD. Braak staging was used as a main phenotypic readout. Standard linear modeling using Braak stage as the response variable corrected for sex and age at death revealed residual inflation of significance, arguing for the presence of an unknown confounding variability component (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S31a). A search for the strongest associations with LMC proportions across all obtained factorization solutions revealed that for the decomposition case with <italic>k</italic>=9 and <italic>λ</italic>=0.09, the proportion of some LMCs, in particular LMC2, is significantly correlated with both AD phenotype and Braak stage (Fig. <xref rid="Fig4" ref-type="fig">4</xref>
<xref rid="Fig4" ref-type="fig">e</xref> and <xref rid="Fig4" ref-type="fig">f</xref>). When we included the proportions of the three most significant LMCs as covariates in the association analysis, the remaining <italic>P</italic> value inflation was eliminated (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S31b). When compared to the LMCs recovered at <italic>k</italic>=3, LMC2 was the closest to the NeuN <sup>−</sup>-related cluster (Fig. <xref rid="Fig4" ref-type="fig">4</xref>
<xref rid="Fig4" ref-type="fig">g</xref>). We used GREAT to annotate the LMC2-specific CpG positions. Gene ontology terms with significant enrichment included rhombomere development, brain segmentation, nerve morphogenesis etc. (Fig. <xref rid="Fig4" ref-type="fig">4</xref>
<xref rid="Fig4" ref-type="fig">h</xref>). We also observed an enrichment for gene promoters overlapping the vitamin D receptor and MEIS1 binding motifs (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S32). LMC2 might, therefore, represent one or several cell populations that are enriched in AD samples; however, a more in-depth biological analysis and validation would be necessary to confirm this finding.</p>
    </sec>
  </sec>
  <sec id="Sec12" sec-type="conclusion">
    <title>Conclusions</title>
    <p>DNA methylomes of multicellular samples can be modeled as mixtures of several latent variables. Here we present a novel computational framework called MeDeCom, which decomposes complex DNA methylation data into latent components and sample-dependent proportions based on a mixture model for methylomes. We show that the method performs reproducibly and with high sensitivity on both synthetic and biological data sets.</p>
    <p>MeDeCom provides significant advances compared to existing methods. First of all, our method does not require reference cell-type measurements. It can be applied to any DNA methylation data set to explore the compositions of mixtures. Note that reference methylome data are not yet available for many cell types, and MeDeCom offers the possibility of exploring non-standard data in a reference-free manner. Second, MeDeCom has strong conceptual differences to other reference-free methods, such as the surrogate variable analysis (SVA) methods [<xref ref-type="bibr" rid="CR53">53</xref>, <xref ref-type="bibr" rid="CR54">54</xref>], EWASHER [<xref ref-type="bibr" rid="CR40">40</xref>], or the SVA-inspired RefFreeEWAS [<xref ref-type="bibr" rid="CR39">39</xref>] method. All these methods focus on the correction of significance analysis for a phenotypic trait of interest by calculating and eliminating confounding heterogeneity effects. In contrast, MeDeCom uses a variant of NMF specifically designed to recover latent DNA methylomes by using biologically motivated constraints and regularization. The imposed constraints on the factorization integrate biological prior knowledge, such as non-negativity of the estimated methylation profiles and their proportions. However, we show that these constraints alone are not sufficient to get biologically meaningful methylation profiles and accurate estimates of their proportions. A key element distinguishing MeDeCom from other methods based on naive matrix factorization, in particular RefFreeCellMix [<xref ref-type="bibr" rid="CR42">42</xref>], is that we add a regularizer encoding the prior expectation that most sites in the methylation profiles are close to zero or one. This prior expectation is because at the level of a single cell, methylation profiles are binary and for most CpG sites this is true also at the level of a homogeneous population of cells, such as a particular cell type. This allows us to estimate methylation profiles and their proportions simultaneously, without any reference profiles. In contrast to RefFreeCellMix, the employed regularizer enables MeDeCom to identify methylation profiles even in blood and brain tissue where each sample is a heterogeneous mixture of different cell types.</p>
    <p>Our proof-of-concept analysis shows that MeDeCom acts robustly and reliably on complex artificial and natural methylome mixtures measured by Infinium 450k arrays. MeDeCom identifies key signatures of major cell populations present in complex whole-blood and brain methylomes without any prior knowledge of references or data adjustment. However, our analysis also reveals the limits of a MeDeCom analysis. The method strongly depends on a fair number of discriminatory methylation positions and a sufficient level of sample-to-sample variation (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S18). In complex 450k whole-blood methylomes, both parameters are affected such that a clean separation and assignment of LMCs specific for blood cell subtypes becomes challenging. Two major aspects are the likely causes of this difficulty. First, the Infinium 450k platform covers only a limited number of CpGs informative for the minor cell subtypes, which can easily become indistinguishable from the remaining technical noise of the 450k arrays. Second, the proportions of most cell subtypes in blood are too low. MeDeCom factorization requires a certain grade of sample-to-sample variation to identify component (cell type)-specific CpG signals. We had noticed both of these limitations in our simulation analysis with artificial mixtures. In the future, these problems may be partially overcome by using WGBS/RRBS or extended array platforms such as the Methylation EPIC array covering additional cell-type-specific variable CpG positions. Furthermore, cell-enrichment or cell-depletion strategies may help to obtain deeper sample-specific compositional insights.</p>
    <p>Since MeDeCom does not require predefined references, it can be flexibly applied to any level of methylome analysis. We show that MeDeCom can facilitate a deeper insight into cell composition if the sample complexity is experimentally reduced. As one example, we investigated the composition of methylomes generated after cell preselection, e.g., by surface marker-based separation [<xref ref-type="bibr" rid="CR44">44</xref>]. Our results on pre-sorted CD4+ (T cell) or CD19+ (B cell) blood cells clearly show that their methylomes still maintain a substantial level of heterogeneity. We identify a number of additional separable DNA methylation components, some of which we can associate with age-dependent changes in T-cell populations or show that they discriminate naive from primed B cells. In both cases, the characteristic CpG signatures vary in their sample-by-sample proportions. Such observations are very important for the biological interpretation of methylation changes across populations of samples. Many of the components identified by MeDeCom are likely to carry such biological information, which can be extracted for further exploration. Furthermore, we show that MeDeCom can, in principle, be extended to include prior information, such as known cell-type profiles and the approximate range of cell-type proportions for certain cell types (Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Supplementary Note 2).</p>
    <p>The decomposition of brain methylomes provided by MeDeCom further supports the usefulness of unsupervised exploratory decomposition for the analysis of complex methylome data. The separation of brain cells into neuronal and non-neuronal fractions has become a new standard procedure for brain-specific epigenetic studies in human postmortem samples. Our first finding shows that NeuN <sup>+/−</sup> mixture models do not fully capture the composition of the full brain tissue. In fact, we identify an additional component that differs from the NeuN <sup>+</sup> (neuron) and NeuN <sup>−</sup> (non-neuron)-specific components in full brain tissues. This new component is apparently sorted out or even lost in the enrichment procedure. Our analysis shows that the samples denominated as NeuN <sup>+</sup> and NeuN <sup>−</sup> contain variable contributions of this unknown cell fraction. Here, MeDeCom opens a new possibility for identifying the differences in cell composition and, hence, making data from different NeuN separations more comparable. Moreover, a biological analysis of the CpGs and genes associated with this new component reveals a strikingly different association of biological terms compared to the NeuN <sup>+</sup> and NeuN <sup>−</sup> fractions. Finally, we show that a phenotypic re-analysis of complex brain data sets using LMCs allows us to identify novel associations with cellular origin (neurons) and disease-state progression.</p>
    <p>In summary, our analysis demonstrates that MeDeCom is a broadly applicable reference-free tool allowing us to explore complex data sets for confounding variables and, thus, to improve the biological interpretation of large-scale DNA methylation data sets. For the pilot demonstration, we exclusively used Infinium 450k data. In principle, MeDeCom is applicable to any complex methylome data set. However, since MeDeCom requires a low level of technical noise and a high level of biological variation, we suggest that the method is applied to carefully controlled data sets that fulfill such requirements. A high standard technical preprocessing of 450k array data minimizes possible pitfalls of quality, technical batch effects, or other non-biological issues. We, therefore, recommend using data after passing them through available bioinformatic pipelines (see, e.g., [<xref ref-type="bibr" rid="CR55">55</xref>] or [<xref ref-type="bibr" rid="CR56">56</xref>]).</p>
  </sec>
  <sec id="Sec13">
    <title>Methods</title>
    <sec id="Sec14">
      <title>MeDeCom element I: mixture model for DNA methylation measurements</title>
      <p>Let <italic>D</italic>∈ [ 0,1]<sup><italic>m</italic>×<italic>n</italic></sup> be the matrix of absolute methylation values of <italic>m</italic> CpGs obtained from <italic>n</italic> multicellular specimens, with <italic>m</italic> typically being much larger than <italic>n</italic>. Here, entry <italic>D</italic>
<sub><italic>ij</italic></sub> represents the methylation level for CpG <italic>i</italic> for specimen <italic>j</italic>, with <italic>i</italic>=1,…,<italic>m</italic> and <italic>j</italic>=1,…,<italic>n</italic>. We consider an approximate low-rank model for <italic>D</italic> assuming that the cell populations of samples consist of a finite number of sub-populations each contributing a distinctive methylation profile. We also assume that population mixtures are similar but slightly variable across biological samples collected in the same manner. Both assumptions suggest that the methylation profiles of the samples are a weighted average (mixture) of the methylation profiles associated with the underlying cell types, where the weights equal the proportions of these cell types. Note that we verified this concept in our analysis with artificial cell mixtures. Our matrix factorization model, 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ D = TA + E,  $$ \end{document}</tex-math><mml:math id="M2"><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mtext mathvariant="italic">TA</mml:mtext><mml:mo>+</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2017_1182_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p>represents this concept where <italic>T</italic>∈ [ 0,1]<sup><italic>m</italic>×<italic>k</italic></sup> represents the methylation profiles of <italic>k</italic> cell prototypes or other recurrent variables (in most cases representing a specific cell type) and <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$A \in \mathbb {R}_{+}^{k \times n}$\end{document}</tex-math><mml:math id="M4"><mml:mi>A</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq1.gif"/></alternatives></inline-formula> such that <italic>A</italic>
<sup>⊤</sup>
<bold>1</bold>
<sub><italic>k</italic></sub>=<bold>1</bold>
<sub><italic>n</italic></sub> (i.e., the entries of <italic>A</italic> are non-negative and its columns sum to one). Entry <italic>T</italic>
<sub><italic>is</italic></sub> equals the methylation profile of CpG <italic>i</italic> of prototype <italic>s</italic>, with <italic>i</italic>=1,…,<italic>m</italic> and <italic>s</italic>=1,…,<italic>k</italic>, while <italic>A</italic>
<sub><italic>si</italic></sub> equals the relative abundance (proportion) of prototype <italic>s</italic> in specimen <italic>i</italic>. The matrix <italic>E</italic> represents errors, capturing model misspecification and noise arising from the measurement process. Note that the biologically motivated constraints for <italic>T</italic> and <italic>A</italic> distinguish our model from other low-rank models as they are used for adjustment of the phenotype association analysis [<xref ref-type="bibr" rid="CR39">39</xref>–<xref ref-type="bibr" rid="CR41">41</xref>]. Notably, (<xref rid="Equ1" ref-type="">1</xref>) can be seen as an approximation of a more general constructive or exact model while the emerging approximation error can be estimated analytically (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>
<xref rid="Fig1" ref-type="fig">a</xref> and Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Supplementary Note 1).</p>
    </sec>
    <sec id="Sec15">
      <title>MeDeCom element II: model fitting</title>
      <p>Using a straightforward least-squares approach to fit model (<xref rid="Equ1" ref-type="">1</xref>), yields the optimization problem: 
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \begin{array}{ll} \min_{T,A} ||{D - TA}||_{F}^{2} = &amp;\sum_{i=1}^{m} \sum_{j = 1}^{n} (D_{ij} - (TA)_{ij})^{2} \\ \text{subject to} \;\;&amp; 0 \leq T_{is} \leq 1 \;\, \forall i,s \\ &amp; A_{sj} \geq 0 \;\, \forall s,j \\ &amp; \sum_{s = 1}^{k} A_{sj} = 1 \;\, \forall j. \end{array}  $$ \end{document}</tex-math><mml:math id="M6"><mml:mtable class="array" columnalign="left"><mml:mtr><mml:mtd><mml:munder><mml:mrow><mml:mo>min</mml:mo></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:munder><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo>−</mml:mo><mml:mtext mathvariant="italic">TA</mml:mtext><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">TA</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>subject to</mml:mtext><mml:mspace width="2.77626pt"/><mml:mspace width="2.77626pt"/></mml:mtd><mml:mtd><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mspace width="2.77626pt"/><mml:mspace width="0.3em"/><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">sj</mml:mtext></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mspace width="2.77626pt"/><mml:mspace width="0.3em"/><mml:mo>∀</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">sj</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="2.77626pt"/><mml:mspace width="0.3em"/><mml:mo>∀</mml:mo><mml:mi>j.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2017_1182_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p>Here and in the following, ∥.∥<sub><italic>F</italic></sub> denotes the Frobenius norm of a matrix, defined as the square root of the sum of squares of its entries. We may think of the above problem as an instance of blind source separation, a task that has been well studied in signal processing [<xref ref-type="bibr" rid="CR57">57</xref>]. The attribute blind expresses that the source signals, as represented by the columns of the matrix <italic>T</italic>, are unknown, as opposed to when they are given in advance and only the mixture coefficients in <italic>A</italic> need to be recovered.</p>
      <p>The minimization problem in (<xref rid="Equ2" ref-type="">2</xref>) is not jointly convex in <italic>T</italic> and <italic>A</italic>. As a result, one cannot hope to converge always to the global optimum; in fact, it has been shown that constrained matrix factorization problems of this form are computationally hard in general [<xref ref-type="bibr" rid="CR58">58</xref>].</p>
      <p>Once <italic>T</italic> or <italic>A</italic> is given, the problem (<xref rid="Equ2" ref-type="">2</xref>) leads to a convex quadratic program. This property is the basis of <italic>alternating minimization</italic>, a common (heuristic) approach for fitting matrix factorization models where one alternates minimization w.r.t. <italic>T</italic> for fixed <italic>A</italic> and vice versa [<xref ref-type="bibr" rid="CR59">59</xref>]. While lacking theoretical guarantees, alternating minimization often works very well in practice.</p>
      <p>Note that independently of our work, Houseman et al. [<xref ref-type="bibr" rid="CR42">42</xref>] recently proposed RefFreeCellMix, an approach like (<xref rid="Equ2" ref-type="">2</xref>). A rather minor difference is that in RefFreeCellMix, the equality constraint, <inline-formula id="IEq2"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$ \sum _{s = 1}^{k} A_{sj} = 1$\end{document}</tex-math><mml:math id="M8"><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">sj</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq2.gif"/></alternatives></inline-formula>, is replaced with an inequality constraint, <inline-formula id="IEq3"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sum _{s = 1}^{k} A_{sj} \leq 1$\end{document}</tex-math><mml:math id="M10"><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">sj</mml:mtext></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq3.gif"/></alternatives></inline-formula>. Thus, the components of <italic>A</italic> estimated by RefFreeCellMix cannot be interpreted as the proportions of the corresponding methylation profiles. Moreover, we will argue in the following that the direct use of approach (<xref rid="Equ2" ref-type="">2</xref>) ignores valuable prior biological information about the problem, which leads to suboptimal solutions. This, in turn, has an adverse effect on the estimation of the proportions <italic>A</italic> and the methylation profiles <italic>T</italic>, leading to considerably worse solutions.</p>
      <p>The main problem of (<xref rid="Equ2" ref-type="">2</xref>) is ill-posedness. In general, there are multiple optimal solutions to (<xref rid="Equ2" ref-type="">2</xref>) (excluding those generated by column and row permutations in <italic>T</italic>, respectively, <italic>A</italic>), as can easily be seen from geometric considerations (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>
<xref rid="Fig1" ref-type="fig">c</xref>). In geometric terms, problem (<xref rid="Equ2" ref-type="">2</xref>) can be re-phrased as follows: find a set of <italic>k</italic> points {<italic>t</italic>
<sub>1</sub>,…,<italic>t</italic>
<sub><italic>k</italic></sub>}⊂ [ 0,1]<sup><italic>m</italic></sup> corresponding to the columns of <italic>T</italic> such that their convex hull <inline-formula id="IEq4"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {T} = \{y \in \mathbb {R}^{m}: y = \sum _{s = 1}^{k} \lambda _{s} t_{s}, \; \lambda _{s} \geq 0 \; \forall s, \; \sum _{s=1}^{k} \lambda _{s} = 1\}$\end{document}</tex-math><mml:math id="M12"><mml:mi mathvariant="script">T</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mo>:</mml:mo><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="2.77626pt"/><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mspace width="2.77626pt"/><mml:mo>∀</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mspace width="2.77626pt"/><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq4.gif"/></alternatives></inline-formula> minimizes the sum of squared Euclidean distances of the data points {<italic>D</italic>
<sub>:,1</sub>,…,<italic>D</italic>
<sub>:,<italic>n</italic></sub>} to that convex hull. As shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>
<xref rid="Fig1" ref-type="fig">c</xref>, one can easily construct problem instances for which it is possible to extend or shrink <inline-formula id="IEq5"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {T}$\end{document}</tex-math><mml:math id="M14"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq5.gif"/></alternatives></inline-formula> while keeping the least-squares objective (essentially) unchanged. Note that a solution from RefFreeCellMix or one from our model without the regularizer (<italic>λ</italic>=0) will be far away from the ground truth and, thus, have gross errors both in the estimation of the proportions <italic>A</italic> as well as the profiles <italic>T</italic>.</p>
      <p>To deal with this ambiguity, we suggest complementing the least-squares objective with a biologically plausible regularizing term pushing the points {<italic>t</italic>
<sub>1</sub>,…,<italic>t</italic>
<sub><italic>k</italic></sub>} towards the vertex set of [ 0,1]<sup><italic>m</italic></sup>, i.e., the set of binary vectors {0,1}<sup><italic>m</italic></sup>. The rationale behind this is as follows. Recall that the columns of <italic>T</italic> take the role of methylation profiles of prototypes, which in typical cases represent a (near) homogeneous sub-population of cells. Depending on the homogeneity of the sub-population, the methylation profile of the corresponding prototype may be close to binary since at the level of a single cell, methylation profiles are exactly binary (methylated vs unmethylated) when ignoring the comparatively rare case of half-methylation. Incorporating this structure contributes significantly to the success in finding biologically meaningful matrices <italic>T</italic> and <italic>A</italic>. Specifically, we consider the following regularized least-squares criterion: 
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $${} \begin{aligned} &amp;\min_{T,A} \|D - TA\|_{F}^{2} + \lambda \sum_{i = 1}^{m} \sum_{s=1}^{k} \omega(T_{is}), \text{with} \,\omega(x) = x(1 - x),\\ &amp;\text{subject to~} 0 \leq T_{is} \leq 1 \;\, \forall i,s \\ &amp;\qquad \qquad A_{sj} \geq 0 \;\, \forall s,j \\ &amp; \qquad \qquad \sum_{s = 1}^{k} A_{sj} = 1 \;\, \forall j, \end{aligned}  $$ \end{document}</tex-math><mml:math id="M16"><mml:mtable><mml:mtr><mml:mtd><mml:munder><mml:mrow><mml:mo>min</mml:mo></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:munder><mml:mo>∥</mml:mo><mml:mi>D</mml:mi><mml:mo>−</mml:mo><mml:mtext mathvariant="italic">TA</mml:mtext><mml:msubsup><mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:mi>ω</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mtext>with</mml:mtext><mml:mspace width="0.3em"/><mml:mi>ω</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>subject to</mml:mtext><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mspace width="2.77626pt"/><mml:mspace width="0.3em"/><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">sj</mml:mtext></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mspace width="2.77626pt"/><mml:mspace width="0.3em"/><mml:mo>∀</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">sj</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="2.77626pt"/><mml:mspace width="0.3em"/><mml:mo>∀</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2017_1182_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p>where <italic>λ</italic>≥0 is a hyperparameter. Note that <italic>ω</italic>:[ 0,1]→[ 0,1] is a quadratic function symmetric around its mode 0.5 (i.e., <italic>ω</italic>(<italic>x</italic>)=<italic>ω</italic>(1−<italic>x</italic>)) and vanishes at the boundary points 0 and 1. The additional regularization term in (<xref rid="Equ3" ref-type="">3</xref>) acts as a soft binary constraint depending on the parameter <italic>λ</italic>. For <italic>λ</italic> sufficiently large, any minimizer <inline-formula id="IEq6"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$(\widehat {T}, \widehat {A})$\end{document}</tex-math><mml:math id="M18"><mml:mo>(</mml:mo><mml:mover accent="false"><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="false"><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq6.gif"/></alternatives></inline-formula> of (<xref rid="Equ3" ref-type="">3</xref>) must satisfy <inline-formula id="IEq7"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\widehat {T}_{is} \in \{0,1\}$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq7.gif"/></alternatives></inline-formula> for all <italic>i,s</italic>. We stress that the proposed form of regularization is much better suited to the given problem than the popular lasso (<italic>ℓ</italic>
<sub>1</sub> regularization with <italic>ω</italic>(<italic>x</italic>)=|<italic>x</italic>|), which promotes zeroes but discourages ones, which has little meaning for the given problem from a biological perspective.</p>
      <p>We would like to stress again that the introduction of this regularizer constitutes a key prerequisite for getting biologically meaningful solutions for matrices <italic>T</italic> and <italic>A</italic>. While (<xref rid="Equ2" ref-type="">2</xref>) and RefFreeCellMix work reasonably well if the methylation profiles of the pure cell types are present as samples in the data matrix <italic>D</italic>, this approach can fail completely if the measured samples consist only of mixtures of cell types, as shown in the artificial NeuN <sup>+/−</sup> mixture experiment. The reason for the bad performance of RefFreeCellMix is that it basically interprets the mixtures (0.3,0.7) and (0.7,0.3) as columns of <italic>T</italic>, whereas the regularizer proposed in the present paper pushes <italic>T</italic> towards 0 (respectively 1), and, thus, can estimate the correct profiles and their proportions accurately.</p>
      <p>From the computational standpoint, the extra term in (<xref rid="Equ3" ref-type="">3</xref>) poses an additional challenge compared to (<xref rid="Equ2" ref-type="">2</xref>), as the function <italic>ω</italic> is non-convex (in fact, it is concave). As a consequence, when using the alternatization scheme mentioned above, one has to bear in mind that optimizing <italic>T</italic> for fixed <italic>A</italic> is no longer a convex quadratic program, but a so-called difference of convex program in virtue of the concavity of <italic>ω</italic>. The concave–convex procedure [<xref ref-type="bibr" rid="CR60">60</xref>, <xref ref-type="bibr" rid="CR61">61</xref>] can be employed to generate a sequence of iterates ensuring the monotonic descent of the objective function before reaching a stationary point. As detailed in Algorithm 1, it is straightforward to integrate this approach into the alternating optimization scheme.</p>
      <p>
        <graphic xlink:href="13059_2017_1182_Figa_HTML.gif" id="MO5"/>
      </p>
      <p>The main computational efforts go into the successive solution of the convex quadratic optimization problems <bold>optT</bold> and <bold>optA</bold>, which can be done by a variety of efficient solvers. Updating <italic>T</italic> follows the concave–convex procedure in which the concave part of the objective (here given by <italic>h</italic>(<italic>T</italic>)) is repeatedly linearized, yielding a sequence of convex surrogate minimization problems.</p>
    </sec>
    <sec id="Sec16">
      <title>MeDeCom element III: parameter selection</title>
      <p>The mixture model (<xref rid="Equ1" ref-type="">1</xref>) and the fitting algorithm (Algorithm 1) involve two free parameters to be provided by the user. The inner dimension <italic>k</italic> of the matrix product <italic>TA</italic>, <italic>k</italic>≤ min{<italic>m,n</italic>} in (<xref rid="Equ1" ref-type="">1</xref>), equals the number of DNA methylation prototypes used to model the given data. The regularization parameter <italic>λ</italic> determines how strongly the entries of <inline-formula id="IEq8"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\widehat {T}$\end{document}</tex-math><mml:math id="M22"><mml:mover accent="false"><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq8.gif"/></alternatives></inline-formula> are encouraged to take values in {0,1}. The choice of <italic>k</italic> can be guided by prior (biological) knowledge about the possible composition of the underlying mixture. However, to select the optimal values of <italic>k</italic> and <italic>λ</italic>, we developed a cross-validation procedure.</p>
      <sec id="Sec17">
        <title>Cross-validation</title>
        <p>Typical approaches to cross-validation in matrix factorization are (a) leaving out columns, (b) leaving out rows, and (c) leaving out both rows and columns [<xref ref-type="bibr" rid="CR62">62</xref>]. We decided to use (a) since it leads to a straightforward scheme as displayed in Algorithm 2. For each fold, a subset of the samples is left out. Thereby, the column-reduced data matrix <italic>D</italic>
<sup>in</sup> is factorized as if one were given the full matrix. The resulting left factor <inline-formula id="IEq9"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\widehat {T}^{\text {in}}$\end{document}</tex-math><mml:math id="M24"><mml:msup><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>in</mml:mtext></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq9.gif"/></alternatives></inline-formula> is used to fit the left-out columns in <italic>D</italic>
<sup>out</sup> as <inline-formula id="IEq10"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$D^{\text {out}} \approx \widehat {T}^{\text {in}} \widehat {A}^{\text {out}}$\end{document}</tex-math><mml:math id="M26"><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>out</mml:mtext></mml:mrow></mml:msup><mml:mo>≈</mml:mo><mml:msup><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>in</mml:mtext></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>out</mml:mtext></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq10.gif"/></alternatives></inline-formula>. The squared error of that approximation or CVE is saved and finally combined with the errors from other folds.</p>
        <p>
          <graphic xlink:href="13059_2017_1182_Figb_HTML.gif" id="MO6"/>
        </p>
      </sec>
      <sec id="Sec18">
        <title>Selecting <italic>k</italic></title>
        <p>The choice of <italic>k</italic> is critical for the good performance of our model. In some instances, such as for the synthetic mixtures, the number of cell populations are known and the optimal selection of <italic>k</italic> is straightforward. However, for most biological samples, prior knowledge of cell-type composition and other variables is not available or can only be estimated. Moreover, a number of other variable effects, such as age, gender, genetic background, allelic variations etc., have to be included to obtain an interpretable LMC separation. We observe that <italic>k</italic> should be chosen such that the estimation error and the approximation error in model (<xref rid="Equ1" ref-type="">1</xref>) are roughly balanced. The former results from noise and is incurred when fitting the model to the data, while the latter is a consequence of model misspecification, which, as discussed above, is inevitable for limited <italic>k</italic> given the many possible sources and levels of variance.</p>
        <p>Statistically the selection of <italic>k</italic> is related to the selection of numbers of components in a principal component analysis (PCA). In fact, the matrix factorization model (<xref rid="Equ1" ref-type="">1</xref>) can be seen as a method of linear dimension reduction applied to <italic>D</italic>. A common computational approach to PCA is singular value decomposition (SVD), which yields a matrix factorization of rank <italic>k</italic> of <italic>D</italic> by discarding all singular vectors not corresponding to the top <italic>k</italic> singular values. A notable advantage of our scalable model (<xref rid="Equ1" ref-type="">1</xref>) over the truncated SVD/PCA is its direct interpretability at a biological level, which is achieved by putting suitable constraints on the two factors <italic>T</italic> and <italic>A</italic>.</p>
        <p>For a fixed value of the parameter <italic>λ</italic>, the data-fitting term of the factorization problem (<xref rid="Equ3" ref-type="">3</xref>) decreases as <italic>k</italic> increases. The approximation error of the factorization model decreases since with more columns in <italic>T</italic>, one has a better chance of capturing differences between the cluster methylomes. At the same time, the estimation error increases as the additional degrees of freedom favor over-adaptation to noise. A suitable choice of <italic>k</italic> balances both effects. The use of cross-validation is intended to achieve this balance by tracing the CVE over a grid of values for <italic>k</italic> and selecting the one corresponding to the minimum. The final choice of <italic>k</italic> is made by combining visual inspection of the cross-validation results and available prior information about the most likely number of underlying methylation signatures.</p>
      </sec>
      <sec id="Sec19">
        <title>Selecting <italic>λ</italic></title>
        <p>In our example in Fig. <xref rid="Fig1" ref-type="fig">1</xref>
<xref rid="Fig1" ref-type="fig">b</xref>, the regularization parameter <italic>λ</italic>, which balances the trade-off between the data fidelity term and the data-independent regularization term, has a crucial influence on the solution of the factorization problem (<xref rid="Equ1" ref-type="">1</xref>) delivered by Algorithm 1. Since there is, in general, no objective criterion to assess the suitability of each solution at a biological level, we use CVE, as for the parameter <italic>k</italic>. Determining a minimum CVE for <italic>λ</italic> is difficult as that parameter takes values in a continuous domain, namely the non-negative real line. To approach this, we perform a two-stage grid search, starting with a coarse grid and then concentrating on a smaller range covered by a finer grid. Details of the procedure are outlined in Algorithm 3. At the beginning of each of the two rounds of the grid search, Algorithm 3 is run for each grid point of <italic>λ</italic> using multiple (≈50) random initializations. As the solutions corresponding to nearby grid points can be expected to be similar, we complement random initializations with a smoothing scheme in which the solutions of the five preceding and the five subsequent grid points are used for initialization.</p>
        <p>
          <graphic xlink:href="13059_2017_1182_Figc_HTML.gif" id="MO7"/>
        </p>
      </sec>
      <sec id="Sec20">
        <title>Computational performance</title>
        <p>When <italic>m</italic>≫<italic>n</italic>, the computational burden is dominated by the optimization step over <italic>T</italic>, which scales in the worst case as <italic>O</italic>(<italic>n m k</italic>
<sup>3</sup>), where <italic>O</italic>(<italic>k</italic>
<sup>3</sup>) is the worst-case performance in solving a quadratic program of size <italic>k</italic>, which in practice often behaves better. However, the optimization of rows of <italic>T</italic> can be done independently and, thus, we have parallelized this step, leading to an almost linear speed-up on multi-core machines. Moreover, we have parallelized all the independent runs done for cross-validation and used to find a good regularization parameter. While still computationally demanding, the method is in this way scalable to large data sets, both for the number of CpG sites <italic>m</italic> and number of samples <italic>n</italic>. RefFreeCellMix is faster than MeDeCom as it does not have to test for different regularization parameters. However, a single factorization for <italic>λ</italic>=0 is faster in MeDeCom.</p>
      </sec>
    </sec>
    <sec id="Sec21">
      <title>LMC matching</title>
      <p>As a first interpretation level, we propose matching MeDeCom LMC results of unknown samples to reference profiles, which can be either methylomes of purified cell types or other LMCs. Given a matrix of <italic>k</italic> LMCs <inline-formula id="IEq11"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\widehat {T}$\end{document}</tex-math><mml:math id="M28"><mml:mover accent="false"><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq11.gif"/></alternatives></inline-formula> estimated from a data set <italic>D</italic> and a matrix of <italic>k</italic>
<sup>⋆</sup> reference profiles <italic>T</italic>
<sup>⋆</sup>, we first selected a set of rows <inline-formula id="IEq12"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}$\end{document}</tex-math><mml:math id="M30"><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq12.gif"/></alternatives></inline-formula> corresponding to the overlap of CpGs present in both <inline-formula id="IEq13"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\widehat {T}$\end{document}</tex-math><mml:math id="M32"><mml:mover accent="false"><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq13.gif"/></alternatives></inline-formula> and <italic>T</italic>
<sup>⋆</sup>. We then computed the matrix <italic>S</italic>=(<italic>S</italic>
<sub><italic>i,j</italic></sub>) of Pearson correlation coefficients between all pairs of vectors <inline-formula id="IEq14"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\widehat {T}_{\mathcal {R},i}$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="script">R</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq14.gif"/></alternatives></inline-formula> and <inline-formula id="IEq15"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$T^{\star }_{\mathcal {R},j}$\end{document}</tex-math><mml:math id="M36"><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">R</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>⋆</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq15.gif"/></alternatives></inline-formula>. We consider LMC <inline-formula id="IEq16"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {i}$\end{document}</tex-math><mml:math id="M38"><mml:mi>ī</mml:mi></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq16.gif"/></alternatives></inline-formula> as a match to reference profile <inline-formula id="IEq17"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {j}$\end{document}</tex-math><mml:math id="M40"><mml:mover accent="true"><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq17.gif"/></alternatives></inline-formula> if <inline-formula id="IEq18"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$S_{\bar {i}, \bar {j}}=\max _{i} {S_{i,\bar {j}}}$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>ī</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>max</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq18.gif"/></alternatives></inline-formula>. We considered the matching unambiguous when <inline-formula id="IEq19"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$S_{\bar {i}, \bar {j}}=\max _{j} {S_{\bar {i},j}} = \max _{i} S_{i,\bar {j}}$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>ī</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>max</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>ī</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>max</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq19.gif"/></alternatives></inline-formula> for all such matching pairs <inline-formula id="IEq20"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$(\bar {i}, \bar {j})$\end{document}</tex-math><mml:math id="M46"><mml:mo>(</mml:mo><mml:mi>ī</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq20.gif"/></alternatives></inline-formula>. In most of the cases, we observe better matching when both <inline-formula id="IEq21"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {T}$\end{document}</tex-math><mml:math id="M48"><mml:mover accent="true"><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq21.gif"/></alternatives></inline-formula> and <italic>T</italic>
<sup>⋆</sup> are centered, i.e., <inline-formula id="IEq22"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$(1/k) \hat {T}\mathbf {1}_{k}$\end{document}</tex-math><mml:math id="M50"><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:msub><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq22.gif"/></alternatives></inline-formula> (respectively <inline-formula id="IEq23"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$(1/k^{\star }) T^{\star } \mathbf {1}_{k^{\star }}$\end{document}</tex-math><mml:math id="M52"><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>⋆</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:msup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mo>⋆</mml:mo></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>⋆</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq23.gif"/></alternatives></inline-formula>) is subtracted from each column. To compare sets of prototypes corresponding to different parameter settings, we normalize the total number of unambiguously matching prototypes by the achievable maximum, which yields a score <italic>ε</italic>∈[0,1] given by <inline-formula id="IEq24"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\epsilon = 1/\min (k,k^{\star }) \ |\big \{ (\bar {i}, \bar {j}) \in \{1,\ldots, k \} \times \{1,\ldots,k^{\star }\} : S_{\bar {i}, \bar {j}}=\max _{j} S_{\bar {i},j}\ \text {and}\ S_{\bar {i}, \bar {j}} = \max _{i} S_{i,\bar {j}} \big \}|$\end{document}</tex-math><mml:math id="M54"><mml:mi>ε</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mo>min</mml:mo><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>⋆</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mspace width="1em"/><mml:mo>|</mml:mo><mml:mstyle mathsize="1.19em"><mml:mfenced close="" open="{" separators=""><mml:mrow/></mml:mfenced></mml:mstyle><mml:mo>(</mml:mo><mml:mi>ī</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>}</mml:mo><mml:mo>×</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>⋆</mml:mo></mml:mrow></mml:msup><mml:mo>}</mml:mo><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>ī</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>max</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>ī</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:mtext>and</mml:mtext><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>ī</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>max</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:msub><mml:mstyle mathsize="1.19em"><mml:mfenced close="" open="}" separators=""><mml:mrow/></mml:mfenced></mml:mstyle><mml:mo>|</mml:mo></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq24.gif"/></alternatives></inline-formula>.</p>
      <p>On the next alternative level, we propose a combined clustering analysis of LMC prototypes and reference profiles. For that, we composed a matrix <inline-formula id="IEq25"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$T^{\dagger } = [\widehat {T}_{\mathcal {R},:} \; T^{\star }_{\mathcal {R},:}]$\end{document}</tex-math><mml:math id="M56"><mml:msup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>†</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="script">R</mml:mi><mml:mo>,</mml:mo><mml:mo>:</mml:mo></mml:mrow></mml:msub><mml:mspace width="2.77626pt"/><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">R</mml:mi><mml:mo>,</mml:mo><mml:mo>:</mml:mo></mml:mrow><mml:mrow><mml:mo>⋆</mml:mo></mml:mrow></mml:msubsup><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq25.gif"/></alternatives></inline-formula>. We also computed a correlation matrix <italic>S</italic>
<sup><italic>†</italic></sup> analogously to <italic>S</italic>, and used it as a similarity matrix for agglomerative hierarchical clustering with average linkage (procedure hclust in the R package <italic>clust</italic>).</p>
    </sec>
    <sec id="Sec22">
      <title>Functional annotation of LMC-specific CpG positions</title>
      <p>On a third level, we propose a functional annotation of the recovered LMCs by selecting component-specific CpG positions using a fixed methylation difference threshold <italic>θ</italic>. We consider a CpG position <italic>l</italic>∈{1,…,<italic>m</italic>} to be specific to component <italic>i</italic> if <inline-formula id="IEq26"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$|\widehat {T}_{l,j}-\sum _{j \ne i} \widehat {T}_{l,j}| &gt; \theta $\end{document}</tex-math><mml:math id="M58"><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq26.gif"/></alternatives></inline-formula>. We investigate each set <inline-formula id="IEq27"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {L}_{j}$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mrow><mml:mi mathvariant="script">ℒ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq27.gif"/></alternatives></inline-formula> of all such CpGs with respect to enrichment of annotation categories using GREAT [<xref ref-type="bibr" rid="CR51">51</xref>]. In general, we use the default definition for a functional domain of a gene, with a maximal distance of 10 kb upstream or downstream of the transcriptional start site (the “two closest genes” option in GREAT).</p>
    </sec>
    <sec id="Sec23">
      <title>Reference-based estimation of cell-type proportions</title>
      <p>If a matrix <italic>T</italic> of <italic>k</italic> prototype methylomes is available, e.g., experimentally obtained using cell separation methods, one can estimate a corresponding matrix of mixture proportions by solving sub-problem <bold>optA</bold> in Algorithm 1. From here onwards, we refer to this method as regression, and we apply it for reference-based estimation of mixture proportions whenever the reference methylomes are available. This form of proportion estimation is like a method called constrained projection proposed for the same purpose in [<xref ref-type="bibr" rid="CR33">33</xref>]. The important difference is, however, that the analogue of the matrix <italic>T</italic> in that method is constructed from the selection of a comparatively small set of cell-type-specific marker CpGs. In the following, we compare to its proportion estimates whenever appropriate.</p>
    </sec>
    <sec id="Sec24">
      <title>Application of RefFreeCellMix</title>
      <p>We performed reference-free deconvolution with the method RefFreeCellMix by Houseman et al. [<xref ref-type="bibr" rid="CR42">42</xref>] using the R package RefFreeEWAS. In accordance with the original publication of the method [<xref ref-type="bibr" rid="CR42">42</xref>], we applied it to the 20,000 most variable CpG positions from the methylation matrix, unless the total number of rows was less, in which case we used the full matrix. In the former case, we used the available option to obtain the estimates of the methylation components for all CpGs as the final step of the deconvolution procedure (supplying the complete data matrix as argument Yfinal).</p>
    </sec>
    <sec id="Sec25">
      <title>Simulations</title>
      <p>For the performance analysis, we generated simulated DNA methylation data by mixing measured profiles of isolated cell types in controlled proportions and adding varying levels of Gaussian noise. An <italic>m</italic>×<italic>n</italic> matrix of DNA methylation values <italic>D</italic>
<sub>sim</sub> was generated according to the model in (<xref rid="Equ1" ref-type="">1</xref>).</p>
      <p>The underlying matrix of LMCs <inline-formula id="IEq28"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\phantom {\dot {i}\!}T \in [0,1]^{m \times k_{\text {sim}}}$\end{document}</tex-math><mml:math id="M62"><mml:mi>T</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>sim</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq28.gif"/></alternatives></inline-formula> was obtained by averaging methylation profiles for <italic>k</italic>
<sub>sim</sub> purified blood cell types from six donors in the Reinius et al. study [<xref ref-type="bibr" rid="CR44">44</xref>]. We tested four different constellations of blood cell types: 
<list list-type="bullet"><list-item><p><italic>k</italic><sub>sim</sub>=2 with two distant cell types (neutrophils and CD4+ T cells).</p></list-item><list-item><p><italic>k</italic><sub>sim</sub>=2 with two similar cell types (neutrophils and monocytes).</p></list-item><list-item><p><italic>k</italic><sub>sim</sub>=3 with two similar cell types and one distant from the first two (neutrophils, monocytes and CD4+ T cells).</p></list-item><list-item><p><italic>k</italic><sub>sim</sub>=5 with all major blood cell types, excluding eosinophils and B cells.</p></list-item></list>
</p>
      <p>The columns of the matrix of mixture proportions <italic>A</italic> were sampled from a Dirichlet distribution commonly used to model distributions over the probability simplex. The distribution had <italic>k</italic>
<sub>sim</sub> parameters <inline-formula id="IEq29"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$v\alpha _{1},\dots,v\alpha _{k_{\text {sim}}}$\end{document}</tex-math><mml:math id="M64"><mml:mi>v</mml:mi><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>sim</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq29.gif"/></alternatives></inline-formula>. The simplex base <inline-formula id="IEq30"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\alpha _{1},\dots,\alpha _{k_{\text {sim}}}$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>sim</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq30.gif"/></alternatives></inline-formula>, <inline-formula id="IEq31"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sum _{i} \alpha _{i}=1$\end{document}</tex-math><mml:math id="M68"><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq31.gif"/></alternatives></inline-formula>, was chosen to model the prior expectation for the mixing proportions in a typical individual. We tested two scenarios: on average equal (uniform) proportions across individuals, i.e., <italic>α</italic>
<sub><italic>i</italic></sub>=1/<italic>k</italic>
<sub>sim</sub>, <italic>i</italic>=1,…,<italic>k</italic>
<sub>sim</sub>, and a setting where some concentration parameter values were much larger than others, which comes closer to the situation one encounters for whole blood. The scaling factor <italic>v</italic> was used to control the variability of the mixing proportions, with <italic>v</italic>=1 yielding highly variable, <italic>v</italic>=10 moderately variable, and <italic>v</italic>=100 marginally variable proportions across individuals. Finally, the additive noise term <italic>E</italic> was generated by sampling <italic>mn</italic> values from a Gaussian distribution with mean 0 and standard deviation 0.05, 0.1, and 0.2 to simulate low, moderate, and high levels of noise, respectively.</p>
      <p>To simulate true methylation effects of average size <italic>δ</italic> for <italic>m</italic>
<sub><italic>e</italic></sub>≪<italic>m</italic> CpGs in cell type <italic>l</italic> under a simple case vs control setting, the source cell-type-specific methylation profiles of the affected samples (cases) were changed to mimic DNA methylation differences. More specifically, a set <inline-formula id="IEq32"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {C}_{e}$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq32.gif"/></alternatives></inline-formula> of affected CpGs randomly sampled from 1,…,<italic>m</italic>, and a matrix <italic>T</italic>
<sup><italic>e</italic></sup> was obtained so that <inline-formula id="IEq33"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$T^{e}_{l,u} = T^{e}_{l,u} + \mathcal {N}(\delta,\sigma) \mathcal {I}_{\mathcal {N}(0,1)&gt;0}$\end{document}</tex-math><mml:math id="M72"><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mi>δ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">I</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq33.gif"/></alternatives></inline-formula> where <inline-formula id="IEq34"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$u \in \mathcal {C}_{e}$\end{document}</tex-math><mml:math id="M74"><mml:mi>u</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2017_1182_Article_IEq34.gif"/></alternatives></inline-formula>. The simulated effect for the proportion of cell type <italic>l</italic> was introduced by changing parameter <italic>α</italic>
<sub><italic>l</italic></sub> of the Dirichlet distribution for one sample group only.</p>
    </sec>
    <sec id="Sec26">
      <title>Infinium 450k data</title>
      <sec id="Sec27">
        <title>Public Infinium 450k data sets</title>
        <p>The publicly available data sets used to validate the factorization approach are summarized in Table <xref rid="Tab1" ref-type="table">1</xref>. To test MeDeCom for blood-based data, we used one reference data set and data from two large whole-blood-based studies. The data set from Reinius et al. contains profiles of purified blood cell types, as well as mixed samples with known cell counts [<xref ref-type="bibr" rid="CR44">44</xref>]. In addition, we used data from a large rheumatoid arthritis EWAS with 354 cases and 337 controls [<xref ref-type="bibr" rid="CR35">35</xref>]. Finally, we validated the whole-blood results in the data from the EPIC Italy prospective cohort, which provided 845 Infinium 450k measurements [<xref ref-type="bibr" rid="CR45">45</xref>]. Neuronal data sets were obtained from one reference study and one large AD cohort. As a reference, we used data from the CETS study [<xref ref-type="bibr" rid="CR37">37</xref>], which contained in total 145 Infinium 450k profiles of various neuronal samples from major depression disorder patients and healthy controls, such as cortical NeuN <sup>+</sup>- and NeuN <sup>−</sup>-enriched cell populations, nine artificial NeuN <sup>+/−</sup> titration mixtures, as well as 20 intact frontal cortex samples. For validation, we used data from a recent AD study [<xref ref-type="bibr" rid="CR19">19</xref>].</p>
      </sec>
      <sec id="Sec28">
        <title>Processing and preparation of the Infinium 450k data</title>
        <p>The raw Infinium 450k data were collected as IDAT files or, if the latter were not available, from probe-wise intensity matrices (Illumina Genome Studio reports). Loading and primary processing, such as intensity summarization and methylation ratio (<italic>β</italic> value) calling, was performed with the RnBeads package [<xref ref-type="bibr" rid="CR55">55</xref>]. We used <italic>dasen</italic> as the primary normalization method [<xref ref-type="bibr" rid="CR63">63</xref>]. We used several layers of filtering criteria to eliminate low-quality probes. We required each methylation call to be supported by at least five Infinium beads. Since too low and too high probe intensity may indicate measurement problems, we discarded CpGs where the raw intensity for either methylated or unmethylated probes was below 0.1 or above 0.9 quantiles of the total intensity distribution in the respective channel. To diminish the effects of genetic variation, we also discarded CpGs with probes that overlapped with annotated single-nucleotide polymorphism positions (dbSNP132 entries with MAF &gt;0.05, as defined in the RnBeads.hg19 annotation) along the whole probe sequence.</p>
      </sec>
      <sec id="Sec29">
        <title>Adjustment of the phenotype association analysis</title>
        <p>For consistency with the published results, we performed the association analysis using the code that we obtained from the authors of the ReFACTor paper [<xref ref-type="bibr" rid="CR41">41</xref>]. For the unadjusted analysis, a logistic linear model was fitted for each CpG site, with the phenotype (rheumatoid arthritis status) as a response variable and methylation level as the only predictor. The <italic>T</italic> test of the predictor variable coefficient being different from zero was used as the test of the association. For the adjusted analysis, first, the ordinary linear model was fitted to the methylation data for each CpG using the common covariates, such as age, gender, smoking status, and the experimental bath, as predictors. The residuals of this model were then used to fit the phenotype model instead of the actual methylation values. The adjustment for cell composition was performed either via a specialized statistical procedure (RefFreeEWAS [<xref ref-type="bibr" rid="CR39">39</xref>] and Fast-LMM-EWASher [<xref ref-type="bibr" rid="CR40">40</xref>]) or by including additional covariate variables reflecting the compositional variation. In the reference-based adjustment, unconstrained cell-type contribution estimates obtained with the Houseman et al. method [<xref ref-type="bibr" rid="CR33">33</xref>] were added to the covariate list. For RefFreeEWAS and Fast-LMM-EWASher, no custom modeling was performed, but the data and common covariates were supplied directly to the published implementations and the output <italic>P</italic> values were used for the comparison. When adjusting using ReFACTor and RefFreeCellMix, columns of the recovered matrices <italic>R</italic> and <italic>Ω</italic> were included, respectively. For MeDeCom, the LMC proportions were used as covariates. To decrease the complexity for large <italic>k</italic>, we considered including only <italic>k</italic>
<sup>′</sup> LMCs with, on average, the largest proportions across all samples. The efficiency of the adjustment was assessed by comparing the observed distribution of <italic>P</italic> values to the expected one under the assumption that none of the tested null hypotheses are false (which corresponds to a uniform distribution).</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional files</title>
    <sec id="Sec30">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2017_1182_MOESM1_ESM.pdf">
            <label>Additional file 1</label>
            <caption>
              <p>Supplementary Tables. PDF document with supplementary tables. (PDF 120 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2017_1182_MOESM2_ESM.pdf">
            <label>Additional file 2</label>
            <caption>
              <p>Supplementary Figures. PDF document with supplementary figures. (PDF 2088 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2017_1182_MOESM3_ESM.csv">
            <label>Additional file 3</label>
            <caption>
              <p>CpGs used for the analysis of memory and naive B cells. A comma-separated value table file. (CSV 35 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="13059_2017_1182_MOESM4_ESM.csv">
            <label>Additional file 4</label>
            <caption>
              <p>LMC-specific CpG positions of the FC1 data set. A comma-separated value table file. (CSV 256 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="13059_2017_1182_MOESM5_ESM.pdf">
            <label>Additional file 5</label>
            <caption>
              <p>Supplementary Text. PDF document with supplementary notes. (PDF 158 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>AD</term>
        <def>
          <p>Alzheimer’s disease</p>
        </def>
      </def-item>
      <def-item>
        <term>CVE</term>
        <def>
          <p>Cross-validation error</p>
        </def>
      </def-item>
      <def-item>
        <term>EWAS</term>
        <def>
          <p>Epigenome-wide association study</p>
        </def>
      </def-item>
      <def-item>
        <term>FACS</term>
        <def>
          <p>Fluorescence activated cell sorting</p>
        </def>
      </def-item>
      <def-item>
        <term>GEO</term>
        <def>
          <p>Gene Expression Omnibus</p>
        </def>
      </def-item>
      <def-item>
        <term>LMC</term>
        <def>
          <p>Latent (DNA) methylation component</p>
        </def>
      </def-item>
      <def-item>
        <term>MAE</term>
        <def>
          <p>Mean absolute error</p>
        </def>
      </def-item>
      <def-item>
        <term>MDD</term>
        <def>
          <p>Major depression disorder</p>
        </def>
      </def-item>
      <def-item>
        <term>NMF</term>
        <def>
          <p>Non-negative matrix factorization</p>
        </def>
      </def-item>
      <def-item>
        <term>PCA</term>
        <def>
          <p>Principal component analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>RMSE</term>
        <def>
          <p>Root-mean-square error</p>
        </def>
      </def-item>
      <def-item>
        <term>SVA</term>
        <def>
          <p>Surrogate variable analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>SVD</term>
        <def>
          <p>Singular value decomposition</p>
        </def>
      </def-item>
      <def-item>
        <term>MACS</term>
        <def>
          <p>magnetic activated cell sorting</p>
        </def>
      </def-item>
      <def-item>
        <term>WGBS</term>
        <def>
          <p>whole-genome bisulfite sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>DMR</term>
        <def>
          <p>differentially methylated region</p>
        </def>
      </def-item>
      <def-item>
        <term>MAF</term>
        <def>
          <p>minor allele frequency</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <ack>
    <p>Our implementation of the matrix factorization Algorithm 1 in this paper is based on extensions of code originally developed by Qinqing Zheng in collaboration with MS and MH. We would like to thank Karl Nordström, Abdulrahman Salhab, and the DEEP project for providing and processing the WGBS data of the CD4+ T cells. We are thankful to Elior Rahmani for providing the source code for the adjustment method comparison, and to the authors of the Liu et al. paper for providing additional information about their samples.</p>
    <sec id="d29e4824">
      <title>Funding</title>
      <p>PL obtained funding from the European Union’s Seventh Framework Programme (FP7/2007-2013) grant agreement 267038 (NOTOX). MS was supported by DFG Cluster of Excellence MMCI. Support was also provided by German Science Ministry grant 01KU1216A (DEEP).</p>
    </sec>
    <sec id="d29e4829">
      <title>Availability of data and materials</title>
      <p>The data sets supporting the conclusions of this article are available in the GEO repository under accessions: GSE35069 (PureBC), GSE42861 (WB1), GSE51032 (WB2), GSE15745 (PureN, ArtMixN, and FC1), and GSE15745 (FC2). WGBS data of CD4+ T cells are deposited in EGA as a part of the DEEP project submission (accession EGAS00001001624). WGBS profiles of naive and memory B cells were downloaded in bedGraph format from the IHEC data portal (sample names S001JP51, C003K951, C003N351, and C0068L51). The MeDeCom source code has been deposited at Zenodo [<xref ref-type="bibr" rid="CR64">64</xref>] and is available from GitHub (<ext-link ext-link-type="uri" xlink:href="http://github.com/lutsik/MeDeCom">http://github.com/lutsik/MeDeCom</ext-link>) under the GPL-3 license.</p>
    </sec>
    <sec id="d29e4842">
      <title>Authors’ contributions</title>
      <p>PL, MS, MH, and JW together conceived the project. PL did the R implementation and analyzed the data. MS and MH designed the MeDeCom models (with PL) and developed the algorithms implemented and prototyped by MS. GG provided conceptual advice on neuronal data analysis. NV implemented the improved optimization algorithms and ported factorization code to C++. MH suggested improvements for primary data processing and co-supervised the project. JW provided key expertise in the interpretation of biological results and co-supervised the project. All authors discussed the results at all stages and contributed to writing the manuscript. All authors read and approved the final manuscript.</p>
    </sec>
    <sec id="d29e4847">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="d29e4852">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schübeler</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Function and information content of DNA methylation</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>517</volume>
        <issue>7534</issue>
        <fpage>321</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/nature14192</pub-id>
        <?supplied-pmid 25592537?>
        <pub-id pub-id-type="pmid">25592537</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pelizzola</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ecker</surname>
            <given-names>JR</given-names>
          </name>
        </person-group>
        <article-title>The DNA methylome</article-title>
        <source>FEBS Lett</source>
        <year>2011</year>
        <volume>585</volume>
        <issue>13</issue>
        <fpage>1994</fpage>
        <lpage>2000</lpage>
        <pub-id pub-id-type="doi">10.1016/j.febslet.2010.10.061</pub-id>
        <?supplied-pmid 21056564?>
        <pub-id pub-id-type="pmid">21056564</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Roadmap Epigenomics Consortium</collab>
          <name>
            <surname>Kundaje</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Meuleman</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Ernst</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bilenky</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yen</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrative analysis of 111 reference human epigenomes</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>518</volume>
        <issue>7539</issue>
        <fpage>317</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="doi">10.1038/nature14248</pub-id>
        <pub-id pub-id-type="pmid">25693563</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reik</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Dean</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Walter</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Epigenetic reprogramming in mammalian development</article-title>
        <source>Science</source>
        <year>2001</year>
        <volume>293</volume>
        <issue>5532</issue>
        <fpage>1089</fpage>
        <lpage>93</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1063443</pub-id>
        <?supplied-pmid 11498579?>
        <pub-id pub-id-type="pmid">11498579</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baron</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Türbachova</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Hellwag</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eckhardt</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Berlin</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hoffmuller</surname>
            <given-names>U</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DNA methylation analysis as a tool for cell typing</article-title>
        <source>Epigenetics</source>
        <year>2006</year>
        <volume>1</volume>
        <issue>1</issue>
        <fpage>55</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.4161/epi.1.1.2643</pub-id>
        <?supplied-pmid 17998806?>
        <pub-id pub-id-type="pmid">17998806</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ji</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ehrlich</surname>
            <given-names>LIR</given-names>
          </name>
          <name>
            <surname>Seita</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Murakami</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Doi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lindau</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive methylome map of lineage commitment from haematopoietic progenitors</article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>467</volume>
        <issue>7313</issue>
        <fpage>338</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1038/nature09367</pub-id>
        <?supplied-pmid 20720541?>
        <pub-id pub-id-type="pmid">20720541</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shoemaker</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Allele-specific methylation is prevalent and is contributed by CpG-SNPs in the human genome</article-title>
        <source>Genome Res</source>
        <year>2010</year>
        <volume>20</volume>
        <issue>7</issue>
        <fpage>883</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.104695.109</pub-id>
        <?supplied-pmid 20418490?>
        <pub-id pub-id-type="pmid">20418490</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Christiansen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kolte</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Hansen</surname>
            <given-names>TO</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>FC</given-names>
          </name>
        </person-group>
        <article-title>IGF2 mRNA-binding protein 2: biological function and putative role in type 2 diabetes</article-title>
        <source>J Mol Endocrinol</source>
        <year>2009</year>
        <volume>43</volume>
        <issue>5</issue>
        <fpage>187</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="doi">10.1677/JME-09-0016</pub-id>
        <?supplied-pmid 19429674?>
        <pub-id pub-id-type="pmid">19429674</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>KWK</given-names>
          </name>
          <name>
            <surname>Pausova</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Cigarette smoking and DNA methylation</article-title>
        <source>Front Genet</source>
        <year>2013</year>
        <volume>4</volume>
        <fpage>132</fpage>
        <?supplied-pmid 23882278?>
        <pub-id pub-id-type="pmid">23882278</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Horvath</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>DNA methylation age of human tissues and cell types</article-title>
        <source>Genome Biol</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>10</issue>
        <fpage>115</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2013-14-10-r115</pub-id>
        <pub-id pub-id-type="pmid">23657273</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baylin</surname>
            <given-names>SB</given-names>
          </name>
        </person-group>
        <article-title>DNA methylation and gene silencing in cancer</article-title>
        <source>Nat Clin Pract Oncol</source>
        <year>2005</year>
        <volume>2 Suppl 1</volume>
        <fpage>4</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1038/ncponc0354</pub-id>
        <pub-id pub-id-type="pmid">16264831</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Esteller</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Cancer epigenomics: DNA methylomes and histone-modification maps</article-title>
        <source>Nat Rev Genet</source>
        <year>2007</year>
        <volume>8</volume>
        <issue>4</issue>
        <fpage>286</fpage>
        <lpage>98</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2005</pub-id>
        <?supplied-pmid 17339880?>
        <pub-id pub-id-type="pmid">17339880</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bernstein</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Stamatoyannopoulos</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Costello</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Milosavljevic</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Meissner</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The NIH Roadmap Epigenomics Mapping Consortium</article-title>
        <source>Nat Biotechnol</source>
        <year>2010</year>
        <volume>28</volume>
        <issue>10</issue>
        <fpage>1045</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt1010-1045</pub-id>
        <?supplied-pmid 20944595?>
        <pub-id pub-id-type="pmid">20944595</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Michels</surname>
            <given-names>KB</given-names>
          </name>
          <name>
            <surname>Binder</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Dedeurwaerder</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Epstein</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Greally</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Gut</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Recommendations for the design and analysis of epigenome-wide association studies</article-title>
        <source>Nat Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <issue>10</issue>
        <fpage>949</fpage>
        <lpage>55</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2632</pub-id>
        <?supplied-pmid 24076989?>
        <pub-id pub-id-type="pmid">24076989</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lam</surname>
            <given-names>LL</given-names>
          </name>
          <name>
            <surname>Emberly</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Fraser</surname>
            <given-names>HB</given-names>
          </name>
          <name>
            <surname>Neumann</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>GE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Factors underlying variable DNA methylation in a human community cohort</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2012</year>
        <volume>109</volume>
        <issue>Supplement_2</issue>
        <fpage>17253</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1121249109</pub-id>
        <?supplied-pmid 23045638?>
        <pub-id pub-id-type="pmid">23045638</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Badner</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genetic control of individual differences in gene-specific methylation in human brain</article-title>
        <source>Am J Hum Genet</source>
        <year>2010</year>
        <volume>86</volume>
        <issue>3</issue>
        <fpage>411</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2010.02.005</pub-id>
        <?supplied-pmid 20215007?>
        <pub-id pub-id-type="pmid">20215007</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MiR-185 targets the DNA methyltransferases 1 and regulates global DNA methylation in human glioma</article-title>
        <source>Mol Cancer</source>
        <year>2011</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>124</fpage>
        <pub-id pub-id-type="doi">10.1186/1476-4598-10-124</pub-id>
        <?supplied-pmid 21962230?>
        <pub-id pub-id-type="pmid">21962230</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kaut</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Schmitt</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Wüllner</surname>
            <given-names>U</given-names>
          </name>
        </person-group>
        <article-title>Genome-scale methylation analysis of Parkinson’s disease patients’ brains reveals DNA hypomethylation and increased mRNA expression of cytochrome P450 2E1</article-title>
        <source>Neurogenetics</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>87</fpage>
        <lpage>91</lpage>
        <pub-id pub-id-type="doi">10.1007/s10048-011-0308-3</pub-id>
        <?supplied-pmid 22238121?>
        <pub-id pub-id-type="pmid">22238121</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lunnon</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hannon</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>De Jager</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Srivastava</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Volta</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Methylomic profiling implicates cortical deregulation of ANK1 in Alzheimer’s disease</article-title>
        <source>Nat Neurosci</source>
        <year>2014</year>
        <volume>17</volume>
        <issue>9</issue>
        <fpage>1164</fpage>
        <lpage>70</lpage>
        <pub-id pub-id-type="doi">10.1038/nn.3782</pub-id>
        <?supplied-pmid 25129077?>
        <pub-id pub-id-type="pmid">25129077</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Adalsteinsson</surname>
            <given-names>BT</given-names>
          </name>
          <name>
            <surname>Gudnason</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Aspelund</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>TB</given-names>
          </name>
          <name>
            <surname>Launer</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Eiriksdottir</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Heterogeneity in white blood cells has potential to confound DNA methylation measurements</article-title>
        <source>PLOS ONE</source>
        <year>2012</year>
        <volume>7</volume>
        <issue>10</issue>
        <fpage>46705</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0046705</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jaffe</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Accounting for cellular heterogeneity is critical in epigenome-wide association studies</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>2</issue>
        <fpage>31</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2014-15-2-r31</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Houseman</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Kelsey</surname>
            <given-names>KT</given-names>
          </name>
          <name>
            <surname>Wiencke</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Marsit</surname>
            <given-names>CJ</given-names>
          </name>
        </person-group>
        <article-title>Cell-composition effects in the analysis of DNA methylation array data: a mathematical perspective</article-title>
        <source>BMC Bioinform</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>95</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-015-0527-y</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dainiak</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Galaev</surname>
            <given-names>IY</given-names>
          </name>
          <name>
            <surname>Mattiasson</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Methods in cell separations</article-title>
        <source>Adv Biochem Eng Biotechnol</source>
        <year>2007</year>
        <volume>106</volume>
        <fpage>1</fpage>
        <lpage>18</lpage>
        <?supplied-pmid 17660999?>
        <pub-id pub-id-type="pmid">17660999</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tomlinson</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Tomlinson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>XB</given-names>
          </name>
          <name>
            <surname>Kirkham</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Cell separation: terminology and practical considerations</article-title>
        <source>J Tissue Eng</source>
        <year>2013</year>
        <volume>4</volume>
        <fpage>2041731412472690</fpage>
        <pub-id pub-id-type="doi">10.1177/2041731412472690</pub-id>
        <?supplied-pmid 23440031?>
        <pub-id pub-id-type="pmid">23440031</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rakyan</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Beyan</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Down</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Hawa</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Maslau</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Aden</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of type 1 diabetes-associated DNA methylation variable positions that precede disease diagnosis</article-title>
        <source>PLOS Genet</source>
        <year>2011</year>
        <volume>7</volume>
        <issue>9</issue>
        <fpage>1002300</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1002300</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Bundo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kato</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Iwamoto</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Karpova</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Epigenetic methods in neuroscience research</article-title>
        <source>Neuromethods</source>
        <year>2016</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kumar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bhardwaj</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Methods in cell separation for biomedical application: cryogels as a new tool</article-title>
        <source>Biomed Mater</source>
        <year>2008</year>
        <volume>3</volume>
        <issue>3</issue>
        <fpage>034008</fpage>
        <pub-id pub-id-type="doi">10.1088/1748-6041/3/3/034008</pub-id>
        <?supplied-pmid 18708708?>
        <pub-id pub-id-type="pmid">18708708</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kantlehner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kirchner</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hartmann</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ellwart</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Alunni-Fabbroni</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schumacher</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A high-throughput DNA methylation analysis of a single cell</article-title>
        <source>Nucleic Acids Res</source>
        <year>2011</year>
        <volume>39</volume>
        <issue>7</issue>
        <fpage>44</fpage>
        <lpage>68</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkq1357</pub-id>
        <pub-id pub-id-type="pmid">20843780</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fang</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Munera</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>DI</given-names>
          </name>
          <name>
            <surname>Mandlik</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chao</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Banerjee</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide mapping of methylated adenine residues in pathogenic <italic>Escherichia coli</italic> using single-molecule real-time sequencing</article-title>
        <source>Nat Biotechnol</source>
        <year>2012</year>
        <volume>30</volume>
        <issue>12</issue>
        <fpage>1232</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2432</pub-id>
        <?supplied-pmid 23138224?>
        <pub-id pub-id-type="pmid">23138224</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schadt</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Banerjee</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>WH</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Modeling kinetic rate variation in third generation DNA sequencing data to detect putative modifications to DNA bases</article-title>
        <source>Genome Res</source>
        <year>2013</year>
        <volume>23</volume>
        <issue>1</issue>
        <fpage>129</fpage>
        <lpage>41</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.136739.111</pub-id>
        <?supplied-pmid 23093720?>
        <pub-id pub-id-type="pmid">23093720</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwartzman</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Tanay</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Single-cell epigenomics: techniques and emerging applications</article-title>
        <source>Nat Rev Genet</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>12</issue>
        <fpage>716</fpage>
        <lpage>26</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3980</pub-id>
        <?supplied-pmid 26460349?>
        <pub-id pub-id-type="pmid">26460349</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lowe</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Rakyan</surname>
            <given-names>VK</given-names>
          </name>
        </person-group>
        <article-title>Correcting for cell-type composition bias in epigenome-wide association studies</article-title>
        <source>Genome Med</source>
        <year>2014</year>
        <volume>6</volume>
        <issue>3</issue>
        <fpage>23</fpage>
        <pub-id pub-id-type="doi">10.1186/gm540</pub-id>
        <?supplied-pmid 25031617?>
        <pub-id pub-id-type="pmid">25031617</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Houseman</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Accomando</surname>
            <given-names>WP</given-names>
          </name>
          <name>
            <surname>Koestler</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Christensen</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Marsit</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Nelson</surname>
            <given-names>HH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DNA methylation arrays as surrogate measures of cell mixture distribution</article-title>
        <source>BMC Bioinform</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>86</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-13-86</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koestler</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Christensen</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Karagas</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Marsit</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Langevin</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Kelsey</surname>
            <given-names>KT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Blood-based profiles of DNA methylation predict the underlying distribution of cell types: a validation analysis</article-title>
        <source>Epigenetics</source>
        <year>2013</year>
        <volume>8</volume>
        <issue>8</issue>
        <fpage>816</fpage>
        <lpage>26</lpage>
        <pub-id pub-id-type="doi">10.4161/epi.25430</pub-id>
        <?supplied-pmid 23903776?>
        <pub-id pub-id-type="pmid">23903776</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Aryee</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Padyukov</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Fallin</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Hesselberg</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Runarsson</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Epigenome-wide association data implicate DNA methylation as an intermediary of genetic risk in rheumatoid arthritis</article-title>
        <source>Nat Biotechnol</source>
        <year>2013</year>
        <volume>31</volume>
        <issue>2</issue>
        <fpage>142</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2487</pub-id>
        <?supplied-pmid 23334450?>
        <pub-id pub-id-type="pmid">23334450</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Accomando</surname>
            <given-names>WP</given-names>
          </name>
          <name>
            <surname>Wiencke</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Houseman</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Nelson</surname>
            <given-names>HH</given-names>
          </name>
          <name>
            <surname>Kelsey</surname>
            <given-names>KT</given-names>
          </name>
        </person-group>
        <article-title>Quantitative reconstruction of leukocyte subsets using DNA methylation</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>3</issue>
        <fpage>50</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2014-15-3-r50</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guintivano</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Aryee</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Kaminsky</surname>
            <given-names>ZA</given-names>
          </name>
        </person-group>
        <article-title>A cell epigenotype specific model for the correction of brain cellular heterogeneity bias and its application to age, brain region and major depression</article-title>
        <source>Epigenetics</source>
        <year>2013</year>
        <volume>8</volume>
        <issue>3</issue>
        <fpage>290</fpage>
        <lpage>302</lpage>
        <pub-id pub-id-type="doi">10.4161/epi.23924</pub-id>
        <?supplied-pmid 23426267?>
        <pub-id pub-id-type="pmid">23426267</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Montaño</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Kaufmann</surname>
            <given-names>WE</given-names>
          </name>
          <name>
            <surname>Talbot</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gur</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Feinberg</surname>
            <given-names>AP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Measuring cell-type specific differential methylation in human brain tissue</article-title>
        <source>Genome Biol</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>8</issue>
        <fpage>94</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2013-14-8-r94</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Houseman</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Molitor</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Marsit</surname>
            <given-names>CJ</given-names>
          </name>
        </person-group>
        <article-title>Reference-free cell mixture adjustments in analysis of DNA methylation data</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>10</issue>
        <fpage>1431</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu029</pub-id>
        <?supplied-pmid 24451622?>
        <pub-id pub-id-type="pmid">24451622</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zou</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lippert</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Heckerman</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Aryee</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Listgarten</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Epigenome-wide association studies without the need for cell-type composition</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>3</issue>
        <fpage>309</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2815</pub-id>
        <?supplied-pmid 24464286?>
        <pub-id pub-id-type="pmid">24464286</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41</label>
      <mixed-citation publication-type="other">Rahmani E, Zaitlen N, Baran Y, Eng C, Hu D, Galanter J, et al. Sparse PCA corrects for cell type heterogeneity in epigenome-wide association studies. Nat Methods. 2016. doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.3809">10.1038/nmeth.3809</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Houseman</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Kile</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Christiani</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Ince</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Kelsey</surname>
            <given-names>KT</given-names>
          </name>
          <name>
            <surname>Marsit</surname>
            <given-names>CJ</given-names>
          </name>
        </person-group>
        <article-title>Reference-free deconvolution of DNA methylation data and mediation by cell composition effects</article-title>
        <source>BMC Bioinform</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>259</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-016-1140-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43</label>
      <mixed-citation publication-type="other">Lutsik P, Slawski M, Gasparoni G, Hein M, Walter J. MeDeCom web resource. <ext-link ext-link-type="uri" xlink:href="http://public.genetik.uni-sb.de/medecom">http://public.genetik.uni-sb.de/medecom</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reinius</surname>
            <given-names>LE</given-names>
          </name>
          <name>
            <surname>Acevedo</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Joerink</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pershagen</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Dahlén</surname>
            <given-names>SE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Differential DNA methylation in purified human blood cells: implications for cell lineage and studies on disease susceptibility</article-title>
        <source>PLOS ONE</source>
        <year>2012</year>
        <volume>7</volume>
        <issue>7</issue>
        <fpage>41361</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0041361</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Palli</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Berrino</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Vineis</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tumino</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Panico</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Masala</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A molecular epidemiology project on diet and cancer: the EPIC-Italy Prospective Study. Design and baseline characteristics of participants</article-title>
        <source>Tumori</source>
        <year>2003</year>
        <volume>89</volume>
        <issue>6</issue>
        <fpage>586</fpage>
        <lpage>93</lpage>
        <?supplied-pmid 14870823?>
        <pub-id pub-id-type="pmid">14870823</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fahey</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Schnelle</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Boscardin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Gorre</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Aziz</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Distinct categories of immunologic changes in frail elderly</article-title>
        <source>Mech Ageing Dev</source>
        <year>2000</year>
        <volume>115</volume>
        <issue>1–2</issue>
        <fpage>1</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="doi">10.1016/S0047-6374(00)00094-4</pub-id>
        <?supplied-pmid 10854626?>
        <pub-id pub-id-type="pmid">10854626</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cossarizza</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ortolani</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Paganelli</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Barbieri</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Monti</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CD45 isoforms expression on CD4+ and CD8+ T cells throughout life, from newborns to centenarians: implications for T cell memory</article-title>
        <source>Mech Ageing Dev</source>
        <year>1996</year>
        <volume>86</volume>
        <issue>3</issue>
        <fpage>173</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="doi">10.1016/0047-6374(95)01691-0</pub-id>
        <?supplied-pmid 8733112?>
        <pub-id pub-id-type="pmid">8733112</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Romanyukha</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Yashin</surname>
            <given-names>AI</given-names>
          </name>
        </person-group>
        <article-title>Age related changes in population of peripheral T cells: towards a model of immunosenescence</article-title>
        <source>Mech Ageing Dev</source>
        <year>2003</year>
        <volume>124</volume>
        <issue>4</issue>
        <fpage>433</fpage>
        <lpage>3</lpage>
        <pub-id pub-id-type="doi">10.1016/S0047-6374(03)00019-8</pub-id>
        <?supplied-pmid 12714250?>
        <pub-id pub-id-type="pmid">12714250</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paul</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Arkin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Giladi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jaitin</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kenigsberg</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Keren-Shaul</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptional heterogeneity and lineage commitment in myeloid progenitors</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>163</volume>
        <issue>7</issue>
        <fpage>1663</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.11.013</pub-id>
        <?supplied-pmid 26627738?>
        <pub-id pub-id-type="pmid">26627738</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kulis</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Merkel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Heath</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Queirós</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Schuyler</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Castellano</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Whole-genome fingerprint of the DNA methylome during human B cell differentiation</article-title>
        <source>Nat Genet</source>
        <year>2015</year>
        <volume>47</volume>
        <issue>7</issue>
        <fpage>746</fpage>
        <lpage>56</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.3291</pub-id>
        <?supplied-pmid 26053498?>
        <pub-id pub-id-type="pmid">26053498</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McLean</surname>
            <given-names>CY</given-names>
          </name>
          <name>
            <surname>Bristor</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hiller</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Schaar</surname>
            <given-names>BT</given-names>
          </name>
          <name>
            <surname>Lowe</surname>
            <given-names>CB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GREAT improves functional interpretation of cis-regulatory regions</article-title>
        <source>Nat Biotechnol</source>
        <year>2010</year>
        <volume>28</volume>
        <issue>5</issue>
        <fpage>495</fpage>
        <lpage>501</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1630</pub-id>
        <?supplied-pmid 20436461?>
        <pub-id pub-id-type="pmid">20436461</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mukamel</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>FP</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Henry</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Picard</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Epigenomic signatures of neuronal diversity in the mammalian brain</article-title>
        <source>Neuron</source>
        <year>2015</year>
        <volume>86</volume>
        <issue>6</issue>
        <fpage>1369</fpage>
        <lpage>84</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuron.2015.05.018</pub-id>
        <?supplied-pmid 26087164?>
        <pub-id pub-id-type="pmid">26087164</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leek</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Capturing heterogeneity in gene expression studies by surrogate variable analysis</article-title>
        <source>PLOS Genet</source>
        <year>2007</year>
        <volume>3</volume>
        <issue>9</issue>
        <fpage>1724</fpage>
        <lpage>35</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.0030161</pub-id>
        <?supplied-pmid 17907809?>
        <pub-id pub-id-type="pmid">17907809</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Teschendorff</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Zhuang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Widschwendter</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Independent surrogate variable analysis to deconvolve confounding factors in large-scale microarray profiling studies</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>11</issue>
        <fpage>1496</fpage>
        <lpage>505</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr171</pub-id>
        <?supplied-pmid 21471010?>
        <pub-id pub-id-type="pmid">21471010</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Assenov</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Lutsik</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Walter</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lengauer</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bock</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive analysis of DNA methylation data with RnBeads</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>11</issue>
        <fpage>1138</fpage>
        <lpage>40</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3115</pub-id>
        <?supplied-pmid 25262207?>
        <pub-id pub-id-type="pmid">25262207</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56</label>
      <mixed-citation publication-type="other">Aryee MJ, Jaffe AE, Corrada-Bravo H, Ladd-Acosta C, Feinberg AP, Hansen KD, et al. Minfi: a flexible and comprehensive Bioconductor package for the analysis of Infinium DNA methylation microarrays. Bioinformatics. 2014. doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btu049">10.1093/bioinformatics/btu049</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR57">
      <label>57</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Choi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cichocki</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>H-M</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>S-Y</given-names>
          </name>
        </person-group>
        <article-title>Blind source separation and independent component analysis: a review</article-title>
        <source>Neural Inf Process Lett Rev</source>
        <year>2005</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>57</lpage>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vavasis</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>On the complexity of nonnegative matrix factorization</article-title>
        <source>SIAM J Optim</source>
        <year>2007</year>
        <volume>20</volume>
        <issue>3</issue>
        <fpage>1</fpage>
        <lpage>12</lpage>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>CJ</given-names>
          </name>
        </person-group>
        <article-title>Projected gradient methods for nonnegative matrix factorization</article-title>
        <source>Neural Comput</source>
        <year>2007</year>
        <volume>19</volume>
        <issue>10</issue>
        <fpage>2756</fpage>
        <lpage>79</lpage>
        <pub-id pub-id-type="doi">10.1162/neco.2007.19.10.2756</pub-id>
        <?supplied-pmid 17716011?>
        <pub-id pub-id-type="pmid">17716011</pub-id>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tao</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>An</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Convex analysis approach to dc programming: theory, algorithms and applications</article-title>
        <source>Acta Mathematica Vietnamica</source>
        <year>1997</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>289</fpage>
        <lpage>355</lpage>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yuille</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Rangarajan</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>The concave-convex procedure</article-title>
        <source>Neural Comput</source>
        <year>2003</year>
        <volume>15</volume>
        <issue>4</issue>
        <fpage>915</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="doi">10.1162/08997660360581958</pub-id>
        <?supplied-pmid 12689392?>
        <pub-id pub-id-type="pmid">12689392</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Owen</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Perry</surname>
            <given-names>PO</given-names>
          </name>
        </person-group>
        <article-title>Bi-cross-validation of the SVD and the nonnegative matrix factorization</article-title>
        <source>Ann Appl Stat</source>
        <year>2009</year>
        <volume>3</volume>
        <issue>2</issue>
        <fpage>564</fpage>
        <lpage>94</lpage>
        <pub-id pub-id-type="doi">10.1214/08-AOAS227</pub-id>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pidsley</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>CCY</given-names>
          </name>
          <name>
            <surname>Volta</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lunnon</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Mill</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schalkwyk</surname>
            <given-names>LC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A data-driven approach to preprocessing Illumina 450K methylation array data</article-title>
        <source>BMC Genomics</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>293</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-14-293</pub-id>
        <?supplied-pmid 23631413?>
        <pub-id pub-id-type="pmid">23631413</pub-id>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64</label>
      <mixed-citation publication-type="other">Lutsik P, Slawski M, Gasparoni G, Hein M, Walter J. MeDeCom: R package for decomposition of heterogeneous methylomes. 2016. doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5281/zenodo.208195">10.5281/zenodo.208195</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
