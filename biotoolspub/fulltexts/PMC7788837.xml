<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7788837</article-id>
    <article-id pub-id-type="publisher-id">3945</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-020-03945-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>mixIndependR</italic>: a R package for statistical independence testing of loci in database of multi-locus genotypes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9905-410X</contrib-id>
        <name>
          <surname>Song</surname>
          <given-names>Bing</given-names>
        </name>
        <address>
          <email>BingSong@my.unthsc.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Woerner</surname>
          <given-names>August E.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Planz</surname>
          <given-names>John</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.266871.c</institution-id><institution-id institution-id-type="ISNI">0000 0000 9765 6057</institution-id><institution>Department of Microbiology, Immunology and Genetics, </institution><institution>University of North Texas Health Science Center, </institution></institution-wrap>3500 Camp Bowie Blvd, Fort Worth, TX 76107 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>6</day>
      <month>1</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>6</day>
      <month>1</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>12</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>6</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>12</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Multi-locus genotype data are widely used in population genetics and disease studies. In evaluating the utility of multi-locus data, the independence of markers is commonly considered in many genomic assessments. Generally, pairwise non-random associations are tested by linkage disequilibrium; however, the dependence of one panel might be triplet, quartet, or other. Therefore, a compatible and user-friendly software is necessary for testing and assessing the global linkage disequilibrium among mixed genetic data.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">This study describes a software package for testing the mutual independence of mixed genetic datasets. Mutual independence is defined as no non-random associations among all subsets of the tested panel. The new R package “<italic>mixIndependR</italic>” calculates basic genetic parameters like allele frequency, genotype frequency, heterozygosity, Hardy–Weinberg equilibrium, and linkage disequilibrium (LD) by mutual independence from population data, regardless of the type of markers, such as simple nucleotide polymorphisms, short tandem repeats, insertions and deletions, and any other genetic markers. A novel method of assessing the dependence of mixed genetic panels is developed in this study and functionally analyzed in the software package. By comparing the observed distribution of two common summary statistics (the number of heterozygous loci [K] and the number of share alleles [X]) with their expected distributions under the assumption of mutual independence, the overall independence is tested.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">The package “<italic>mixIndependR</italic>” is compatible to all categories of genetic markers and detects the overall non-random associations. Compared to pairwise disequilibrium, the approach described herein tends to have higher power, especially when number of markers is large. With this package, more multi-functional or stronger genetic panels can be developed, like mixed panels with different kinds of markers. In population genetics, the package “<italic>mixIndependR</italic>” makes it possible to discover more about admixture of populations, natural selection, genetic drift, and population demographics, as a more powerful method of detecting LD. Moreover, this new approach can optimize variants selection in disease studies and contribute to panel combination for treatments in multimorbidity. Application of this approach in real data is expected in the future, and this might bring a leap in the field of genetic technology.</p>
      </sec>
      <sec>
        <title>Availability</title>
        <p id="Par4">The R package <italic>mixIndependR,</italic> is available on the Comprehensive R Archive Network (CRAN) at: <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/mixIndependR/index.html">https://cran.r-project.org/web/packages/mixIndependR/index.html</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Linkage disequilibrium</kwd>
      <kwd>R package</kwd>
      <kwd>Non-random association</kwd>
      <kwd>Mutual independence</kwd>
      <kwd>STRs</kwd>
      <kwd>SNPs</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par16">Genetic polymorphisms are commonly classified into different types, such as SNPs, InDels, and STRs. Different characteristics, such as mutation rates, deviations, and heterozygosity, make those markers isolated in application. However, due to their specific advantages, such as the higher power of discrimination of STRs, and the important roles of SNPs in application of ancestry informative markers (AIMs) and prediction of physical traits [<xref ref-type="bibr" rid="CR1">1</xref>], mixed multiplex assays are considered more multi-functional [<xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR4">4</xref>] in some applications of molecular genetics. While there are many studies that compare one marker to others of their kind (SNPs to SNPs, STRs to STRS), only rarely are comparisons made between marker classes. A few notable exceptions include a 2002 study that noted the linkage disequilibrium (LD) of SNPs and microsatellites [<xref ref-type="bibr" rid="CR5">5</xref>]. Later in 2017, 13 CODIS STR markers were found to be matched to genome-wide SNP profiles with median accuracies in excess of 90% [<xref ref-type="bibr" rid="CR4">4</xref>]. Even though the disequilibrium among different markers can be significant and the hypothesis of independence may require testing, most of the software available now is designed specifically for one kind of those markers. For example, <italic>adegenet,</italic> which analyzes SNPs and STRs separately; <italic>BCFTools</italic> [<xref ref-type="bibr" rid="CR6">6</xref>] and <italic>SNPrelate</italic> [<xref ref-type="bibr" rid="CR7">7</xref>]<italic>,</italic> both of which focus on SNPs; and Genetic Data Analysis (GDA) [<xref ref-type="bibr" rid="CR8">8</xref>], which targets at STRs specially. Therefore, a software compatible with multi-type genetic markers simultaneously that can test independence between different type of data is needed.</p>
    <p id="Par17">Another shortcoming of traditional measures of LD is the way it is assessed, that is to test pairwise linkage disequilibrium. However, due to more accurate conception, non-random associations can be not only pairwise associations, but also triplet, quartet, and higher order associations among all sites, defined as mutual independence. D′ is sometimes used to assess the higher-level associations, but it is time consuming to obtain due to numerous calculations. Therefore, summary statistics become a choice to avoid all these excess and burden.</p>
    <p id="Par18">A new package, <italic>mixIndependR</italic>, was developed for testing mutual independence among all sites of the multi-locus genotypes mixed type of genetic markers for the R software. As a larger category of dependency across all over the panel needs to be tested, summary statistics, which are able to give a quick and comprehensive description of the dataset, came into consideration. In an early study [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>], summary statistics, such as the number of heterozygous loci (K) and the number of shared alleles (X), were used to test the significance of disequilibrium (non-random associations) or dependency between loci by comparing the observed and expected distributions under the hypothesis of mutual independence. Functions for obtaining basic genetic parameters like allele frequency, genotype frequency, heterozygosity, and Hardy–Weinberg equilibrium (HWE) are also included in <italic>mixIndependR</italic> to increase its versatility.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Software pipeline</title>
      <p id="Par19">This section presents how a multi-locus genotype panel with mixed genetic markers (SNPs and STR) can be tested for its mutual independence using <italic>mixIndependR</italic>. In the following example, a sample with 6 STRs and 94 SNPs (Additional file <xref rid="MOESM8" ref-type="media">8</xref>: Table S1) was tested using <italic>mixIndependR</italic>. This panel was designed after variant selection and pruning with the threshold <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r^{2} &lt; 0.1$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&lt;</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3945_Article_IEq1.gif"/></alternatives></inline-formula> by <italic>plink (version 1.90)</italic>, based on the genotypes and the reference panel created by Saini et al. [<xref ref-type="bibr" rid="CR11">11</xref>]. This reference haplotype panel was created by imputing STR genotypes into existing SNPs datasets. The STRs were selected from genome-wide catalog of STR variation they generated in Simons Simplex Collection (SSC) cohort, and genotype data for 2504 individuals are from existing 1000 genome phase 3 [<xref ref-type="bibr" rid="CR11">11</xref>]. The threshold for independent panels is usually set as 0.2 [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>], but here we narrowed the scope in pruning to get a panel with less possibility to carry dependency. In addition, pairwise correlations of this dataset were exported and check, and no dependent pairs have been found with the usual threshold of 0.2. This dataset is included in the <italic>mixIndependR</italic> package under the name “mixexample”. <italic>mixIndependR</italic> is compatible with genotype files in a tabular format (e.g., excel, cvs) and the variant call format (vcf) [<xref ref-type="bibr" rid="CR14">14</xref>]. The allele separator in the genotypes needs to be specified using the “sep” parameter.<list list-type="bullet"><list-item><p id="Par20">x &lt;- mixexample # This panel with 96 SNPs and 4 STRs are filtered from a reference haplotype panel developed by Saini et al. [<xref ref-type="bibr" rid="CR11">11</xref>]</p></list-item></list><italic>mixIndependR</italic> can be used to estimate basic genetic parameters, such as allele frequencies, tables of heterozygosity and of shared alleles, and to test Hardy Weinberg equilibrium in either Pearson’s.</p>
      <sec id="Sec4">
        <title>Chi-squared test.</title>
        <p id="Par21">
          <list list-type="bullet">
            <list-item>
              <p id="Par22">p &lt;- <bold>AlleleFreq</bold>(x,sep = "\\|") # calculate the table of allele frequencies and return a table with rows of alleles and columns of markers (Additional file <xref rid="MOESM9" ref-type="media">9</xref>: Table S2).</p>
            </list-item>
            <list-item>
              <p id="Par23">G &lt;- <bold>GenotypeFreq</bold>(x,sep = "\\|",expect = FALSE) # calculate the observed genotype frequencies with genotypes in rows and markers in columns.</p>
            </list-item>
            <list-item>
              <p id="Par24">G0 &lt;- <bold>GenotypeFreq</bold>(x,sep = "\\|",expect = TRUE) # calculate the expected genotype frequencies under Hardy–Weinberg equilibrium (HWE).</p>
            </list-item>
            <list-item>
              <p id="Par25">h &lt;- <bold>Heterozygous</bold>(x,sep = "\\|") # obtain the table of heterozygosity with rows of individuals and columns of markers, where “1” denotes heterozygous while “0” denotes homozygous (Additional file <xref rid="MOESM10" ref-type="media">10</xref>: Table S3).</p>
            </list-item>
            <list-item>
              <p id="Par26">H &lt;- <bold>RxpHetero</bold>(h,p,HWE = TRUE) # calculate the observed average heterozygosity or the expected heterozygosity on each marker under the assumption of HWE.</p>
            </list-item>
            <list-item>
              <p id="Par27">AS &lt;- <bold>AlleleShare</bold>(x,sep = "\\|",replacement = FALSE) # calculate the table of shared alleles of each pair of individuals for each marker with the rows denoting the pairs of individuals and the columns denoting the variants. If the replacement is TRUE, the pairs are formed with replacement randomly and this table includes all possible pairs; if the replacement is FALSE, the pairs are formed without replacement randomly and the number of pairs equals half of the sample size. (Additional file <xref rid="MOESM11" ref-type="media">11</xref>: Table S4).</p>
            </list-item>
            <list-item>
              <p id="Par28">e &lt;- <bold>RealProAlleleShare</bold>(AS) # calculate the observed proportions of sharing 0, 1 or 2 alleles on each marker.</p>
            </list-item>
            <list-item>
              <p id="Par29">e0 &lt;- <bold>ExpProAlleleShare</bold>(p) # calculate the expected probabilities of sharing 0, 1 or 2 alleles on each marker for any unrelated individuals. This process is according to the functions described by Weirs et al. [<xref ref-type="bibr" rid="CR15">15</xref>]</p>
            </list-item>
            <list-item>
              <p id="Par30">HWE_pvalue &lt;- <bold>HWE.Chisq</bold>(G,G0,rescale.p = T, simulate.p.value = T,B = 2000) # test the HWE with Pearson’s Chi-square test and export the <italic>p</italic> value for each marker.</p>
            </list-item>
          </list>
        </p>
        <p id="Par31">According to the mathematical principles described in previous studies of Chakraborty et al. [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>], the observed and expected distribution of the number of heterozygous loci (K) and number of share alleles (X) can be constructed and visualized (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1, Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S2).<list list-type="bullet"><list-item><p id="Par32">ObsDist_K &lt;- <bold>FreqHetero</bold>(h) # calculate the observed distribution of K, exporting the frequencies of K at the values from 0 to total number of tested markers.</p></list-item><list-item><p id="Par33">ExpDist_K &lt;- <bold>DistHetero</bold>(H) # calculate the expected distribution of K, exporting the probabilities of K at the values from 0 to total number of tested markers.</p></list-item><list-item><p id="Par34">ObsDist_X &lt;- <bold>FreqAlleleShare</bold>(AS) # calculate the observed distribution of X, exporting the frequencies of X at the values from 0 to 2 times of total number of tested markers.</p></list-item><list-item><p id="Par35">ExpDist_X &lt;- <bold>DistAlleleShare</bold>(e) # calculate the expected distribution of X, exporting the probabilities of X at the values from 0 to 2 times of total number of tested markers.</p></list-item><list-item><p id="Par36">df_K &lt;- <bold>ComposPare_K</bold>(h,ExpDist_K,trans = F) #generate comparison data frame for observed and expected distributions. If “trans = F”, the table contains a variable “OvE” denoting the category of “observed” or “expected”, and a variable “Freq” denoting the frequencies. This format is prepared for visualization in “ggplot2”. If “trans = T”, the result is made by two columns- “K_io” and “K_ie” which denoting the observed and expected K for each individual, and the number of rows equals to the number of individuals of the sample.</p></list-item><list-item><p id="Par37">df_X &lt;- <bold>ComposPare_X</bold>(AS,ExpDist_X,trans = F) #generate comparison data frame for observed and expected distributions. If “trans = F”, the table contains a variable “OvE” denoting the category of “observed” or “expected”, and a variable “Freq” denoting the frequencies. This format is prepared for visualization in “ggplot2”. If “trans = T”, the result is made by two columns- “X_io” and “X_ie” which denoting the observed and expected X for each pair of individuals, and the number of rows equals to the number of pair of individuals of table of number of shared alleles AS.</p></list-item></list></p>
        <p id="Par38">Not only were the visual comparisons made, but statistical tests were also conducted using this package. Considering the expected distributions under assumption of mutual independence follow restricted multinomial distributions with fixed probabilities on each trial, no traditional statistic tests can be applied (e.g. traditional chi-square test for multinomial distribution). Instead, simulations were conducted to obtain null distributions of chi-square values and cumulative probability functions were built to find an accurate critical value.<list list-type="bullet"><list-item><p id="Par39">Simu_K &lt;- <bold>Simulate_DistK</bold>(H,2504,500) #build 500 times of simulations for distribution of K with the sample size equals to the original data for each simulation, under the mutual independence assumption (Additional file <xref rid="MOESM12" ref-type="media">12</xref>: Table S5).</p></list-item><list-item><p id="Par40">Simu_X &lt;- <bold>Simulate_DistX</bold>(e,1252,500) #build 500 times of simulations for distribution of X with the sample size equals to the number of pairs composed in “AS” table for each simulation, under the mutual independence assumption (Additional file <xref rid="MOESM13" ref-type="media">13</xref>: Table S6).</p></list-item><list-item><p id="Par41">x2_K &lt;- <bold>Dist_SimuChisq</bold>(Simu_K,ExpDist_K$Density,1000) # Calculate 500 Chi-square values for K with 1000 times of replicates in each and export the set of <italic>p</italic> values.</p></list-item><list-item><p id="Par42">x2_X &lt;- <bold>Dist_SimuChisq</bold>(Simu_X,ExpDist_X$Density,1000) # Calculate 500 Chi-square values for X with 1000 times of replicates in each and export the set of <italic>p</italic> values.</p></list-item><list-item><p id="Par43">P1 &lt;- <bold>ecdf</bold>(x2_K) #Build the cumulative probability of function for the set of Chi-square values. Note: this is the function in the package of “stats”.</p></list-item><list-item><p id="Par44">P2 &lt;- <bold>ecdf</bold>(x2_X) #Build the cumulative probability of function for the set of Chi-square values. Note: this is the function in the package of “stats”.</p></list-item></list></p>
        <p id="Par45">If the significant level is 0.05, the critical value of the chi-square value for each specific expected distribution is the value when cumulative probability equals 95%. In Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Figure S3 and Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Figure S4, the cross points of vertical and horizontal line are the critical values. In this example, the critical value for K is 112.9 and the test chi-square value equals 77.417; while 115.0 as critical value for X and test statistic is 62.229. In both statistics, we fail to reject the null hypothesis and may conclude the panel is mutual independent. This results also agree with the selection rules in the process of variant pruning on plink that the pairwise squared correlation between genotype allele counts “--indep-pairwise” is smaller than 0.1 [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>]. However, the result in this section represents a single analysis, and the results can vary among different trials.</p>
      </sec>
    </sec>
    <sec id="Sec5">
      <title>Statistical analysis</title>
      <p id="Par46">Both simulation and real data have been tested with this approach. We simulated unlinked and linked data under the Wright-Fisher neutral model using the software <italic>ms</italic> [<xref ref-type="bibr" rid="CR18">18</xref>]; the microsatellite data were converted by <italic>microsat</italic> [<xref ref-type="bibr" rid="CR19">19</xref>] from <italic>ms</italic> format. In the single-comparison example, we used the simulated panel with 20 STRs and 10 SNPs for unlinked and fully-linked scenarios and the sample size is 500 in each case. The comparisons of the single-run for unlinked data and fully-linked data were made and presented in Figs. <xref rid="Fig1" ref-type="fig">1</xref> and <xref rid="Fig2" ref-type="fig">2</xref>.<fig id="Fig1"><label>Fig. 1</label><caption><p>Distribution of number of heterozygous loci and shared alleles for unlinked vs fully linked data. The simulated dataset is a mixed genetic panel with 20 STRs and 10 SNPs for 500 random individuals. <bold>a</bold>, <bold>b</bold> are the distribution comparisons of number of heterozygous loci and Shared Alleles (non-overlapped pairs) for unlinked data. All STRs and SNPs were generated from different chromosomes randomly. <bold>c</bold>, <bold>d</bold> are distribution comparisons of number of heterozygous loci and Shared Alleles (non-overlapped pairs) for linked data. All STRs were from the same chromosome, and all SNPs were from the same chromosome. However, STRs and SNPs were randomly grouped. Red line in plots are curves of expected probabilities</p></caption><graphic xlink:href="12859_2020_3945_Fig1_HTML" id="MO1"/></fig><fig id="Fig2"><label>Fig. 2</label><caption><p>Curve of cumulative probability of Chi-square values for number of heterozygous loci or shared alleles. Red line is where the critical value lies for the confidence level of 95%; while the blue one is the test statistic. <bold>a</bold>, <bold>b</bold> are figures for unlinked data; <bold>c</bold>, <bold>d</bold> are figures for fully linked data. In (<bold>c</bold>) and (<bold>d</bold>), the test statistic is far larger than the critical value, and beyond the limit of x-axis</p></caption><graphic xlink:href="12859_2020_3945_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par47">Consistent with expectations, the unlinked STR-SNP panel shows significant difference neither for K (<italic>p</italic> value = 0.26) (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a) or X (<italic>p</italic> value = 0.13) (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). At the same time, significant LD is detected for both of K (<italic>p</italic> value &lt; 0.0001) and X (<italic>p</italic> value &lt; 0.0001) at the fully linked STR-SNP panels (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c, d). It is contrastive that, for the simulated unlinked panel, the observed distribution of K and X matched the expected one visually under the assumption of mutual independence while, for the fully-linked panel, there is significant offset between the observed and expected distributions.</p>
      <p id="Par48">For the unlinked panel, the test statistic of <italic>K</italic> is 19.40 and that of <italic>X</italic> is 33.31, both smaller than the critical value 39.00 and 50.00, respectively (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a, b). However, the test values (1,559,984 and 6.8834 × 10<sup>12</sup> for <italic>K</italic> and <italic>X,</italic> respectively) for the fully linked panel are much larger than the critical values (35.00, 52.00 for <italic>K</italic> and <italic>X,</italic> respectively) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c, d).</p>
      <p id="Par49">Simulated data with different levels of linkage were tested to determine the type I error and power of the method. Figures <xref rid="Fig1" ref-type="fig">1</xref> and <xref rid="Fig2" ref-type="fig">2</xref> presents the results for completely unlinked and fully linked panels (20 STRs and 10 SNPs). To test different extents of LD more adequately, different numbers of random selected genetic unlinked and fully linked markers were imported to the package and tested for mutual independence. <italic>p</italic>-value, which equals to one minus the cumulative probability was chosen as the statistic. Among the 1000 in silico replicates, the percentages of significant cases are recorded in Table <xref rid="Tab2" ref-type="table">2</xref> for different levels of linkage. In this process, mixed panels made up with equal numbers of SNPs and STRs were simulated, and each level of linkage was set up in three ways: biased to SNPs, biased to STRs, and unbiased. For example, in a panel of 20 markers, 10 SNPs and 10 STRs were selected; if the linkage is set as half-linked in the SNP-biased panel, there would be 10 linked SNPs and 10 unlinked STRs. In contrast, if the panel is STR-biased, 10 linked STRs and 10 unlinked SNPs would be chosen. In the unbiased group, the linked STRs and linked SNPs are always of the same number, which is 5 linked SNPs, 5 linked STRs, 5 unlinked SNPs, and 5 unlinked STRs in the unbiased half-linked panels of 20 markers (Details in Tables <xref rid="Tab1" ref-type="table">1</xref>, <xref rid="Tab2" ref-type="table">2</xref> and Additional file <xref rid="MOESM14" ref-type="media">14</xref>: Table S7).<table-wrap id="Tab1"><label>Table 1</label><caption><p>The rules of panel design for power test of simulation</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Panel size</th><th align="left">Number of linked markers</th><th align="left">Number of linked SNPs</th><th align="left">Number of linked STRs</th><th align="left">Linkage</th><th align="left">Bias</th></tr></thead><tbody><tr><td align="left">x</td><td align="left">0</td><td align="left">0</td><td align="left">0</td><td align="left">Unlinked</td><td align="left">Both</td></tr><tr><td align="left">x</td><td align="left">2</td><td align="left">2</td><td align="left">0</td><td align="left">OnePair-Linked</td><td align="left">SNP</td></tr><tr><td align="left">x</td><td align="left">2</td><td align="left">0</td><td align="left">2</td><td align="left">OnePair-Linked</td><td align="left">STR</td></tr><tr><td align="left">x</td><td align="left">0.125x</td><td align="left">0.125x</td><td align="left">0</td><td align="left">HalfQuarter-Linked</td><td align="left">SNP</td></tr><tr><td align="left">x</td><td align="left">0.125x</td><td align="left">0</td><td align="left">0.125x</td><td align="left">HalfQuarter-Linked</td><td align="left">STR</td></tr><tr><td align="left">x</td><td align="left">0.125x</td><td align="left">0.0625x</td><td align="left">0.0625x</td><td align="left">HalfQuarter-Linked</td><td align="left">Both</td></tr><tr><td align="left">x</td><td align="left">0.25x</td><td align="left">0.25x</td><td align="left">0</td><td align="left">Quarter-Linked</td><td align="left">SNP</td></tr><tr><td align="left">x</td><td align="left">0.25x</td><td align="left">0</td><td align="left">0.25x</td><td align="left">Quarter-Linked</td><td align="left">STR</td></tr><tr><td align="left">x</td><td align="left">0.25x</td><td align="left">0.125x</td><td align="left">0.125x</td><td align="left">Quarter-Linked</td><td align="left">Both</td></tr><tr><td align="left">x</td><td align="left">0.5x</td><td align="left">0.5x</td><td align="left">0</td><td align="left">Half-Linked</td><td align="left">SNP</td></tr><tr><td align="left">x</td><td align="left">0.5x</td><td align="left">0</td><td align="left">0.5x</td><td align="left">Half-Linked</td><td align="left">STR</td></tr><tr><td align="left">x</td><td align="left">0.5x</td><td align="left">0.25x</td><td align="left">0.25x</td><td align="left">Half-Linked</td><td align="left">Both</td></tr><tr><td align="left">x</td><td align="left">0.75x</td><td align="left">0.5x</td><td align="left">0.25x</td><td align="left">ThreeQuarter-Linked</td><td align="left">SNP</td></tr><tr><td align="left">x</td><td align="left">0.75x</td><td align="left">0.25x</td><td align="left">0.5x</td><td align="left">ThreeQuarter-Linked</td><td align="left">STR</td></tr><tr><td align="left">x</td><td align="left">0.75x</td><td align="left">0.375x</td><td align="left">0.375x</td><td align="left">ThreeQuarter-Linked</td><td align="left">Both</td></tr><tr><td align="left">x</td><td align="left">x-2</td><td align="left">0.5x</td><td align="left">0.5x-2</td><td align="left">Almost-Linked</td><td align="left">SNP</td></tr><tr><td align="left">x</td><td align="left">x-2</td><td align="left">0.5x-2</td><td align="left">0.5x</td><td align="left">Almost-Linked</td><td align="left">STR</td></tr><tr><td align="left">x</td><td align="left">x</td><td align="left">0.5x</td><td align="left">0.5x</td><td align="left">Fully-Linked</td><td align="left">Both</td></tr></tbody></table><table-wrap-foot><p>The “PanelSize” is the number of markers in each panel and in each panel, half markers are SNPs and the other half markers are STRs. In this table to illustrate the rules of design, “PanelSize” is set to “x”</p><p>The variable “Linkage” is defined as the percentage of linked markers among the total. For example, if the “PanelSize” is x, the number of linked markers is 0.5x, then the “Linkage” equals to “Half-Linked”. The “OnePair-Linked” and “Almost-Linked” have unfixed percentage of linked markers but hold the numbers of linked or unlined markers. If there are only 2 linked markers, the “Linkage” is defined as “OnePair-Linked”; if there are only 2 unlinked markers and all others are linked, the “Linkage” is defined as “Almost-Linked”</p><p>The variable “Bias” is defined as the distribution of linked markers. If the number of linked SNPs is larger than linked of STRs, the “Bias” equals to “SNP”; in contrast, if the number of linked SNPs is smaller than linked STRs, the “Bias” equals to “STR”; but if the number of linked SNPs and STRs are the same, “Bias = Both”. When the linked markers are less than 50% of total markers, in the biased groups, all linked markers are the same type of markers- the biased one. When the linkage is higher than “Half-Linked”, all the biased markers are linked, and the unlinked markers are found on the other type</p></table-wrap-foot></table-wrap><table-wrap id="Tab2"><label>Table 2</label><caption><p>Proportion of <italic>p</italic> values &lt; 0.05 in 1000 times for different levels of linkage using summary statistics (only “Bias = Both” is shown, more details in Additional file <xref rid="MOESM14" ref-type="media">14</xref>: Table S7)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">X.1</th><th align="left">Panel size</th><th align="left">Number of linked markers</th><th align="left">Linkage</th><th align="left">Bias</th><th align="left">Total number of heterozygous loci (K)</th><th align="left">Total number of shared alleles (X)</th></tr></thead><tbody><tr><td align="left">1</td><td char="." align="char">10</td><td char="." align="char">0</td><td align="left">Unlinked</td><td align="left">Both</td><td align="left">0.047</td><td align="left">0.039</td></tr><tr><td align="left">2</td><td char="." align="char">20</td><td char="." align="char">0</td><td align="left">Unlinked</td><td align="left">Both</td><td align="left">0.05</td><td align="left">0.036</td></tr><tr><td align="left">3</td><td char="." align="char">30</td><td char="." align="char">0</td><td align="left">Unlinked</td><td align="left">Both</td><td align="left">0.051</td><td align="left">0.048</td></tr><tr><td align="left">4</td><td char="." align="char">40</td><td char="." align="char">0</td><td align="left">Unlinked</td><td align="left">Both</td><td align="left">0.055</td><td align="left">0.038</td></tr><tr><td align="left">5</td><td char="." align="char">50</td><td char="." align="char">0</td><td align="left">Unlinked</td><td align="left">Both</td><td align="left">0.045</td><td align="left">0.053</td></tr><tr><td align="left">6</td><td char="." align="char">100</td><td char="." align="char">0</td><td align="left">Unlinked</td><td align="left">Both</td><td align="left">0.047</td><td align="left">0.051</td></tr><tr><td align="left">31</td><td char="." align="char">16</td><td char="." align="char">2</td><td align="left">HalfQuarter-Linked</td><td align="left">Both</td><td align="left">0.045</td><td align="left">0.044</td></tr><tr><td align="left">32</td><td char="." align="char">32</td><td char="." align="char">4</td><td align="left">HalfQuarter-Linked</td><td align="left">Both</td><td align="left">0.069</td><td align="left">0.041</td></tr><tr><td align="left">33</td><td char="." align="char">48</td><td char="." align="char">6</td><td align="left">HalfQuarter-Linked</td><td align="left">Both</td><td align="left">0.072</td><td align="left">0.063</td></tr><tr><td align="left">34</td><td char="." align="char">64</td><td char="." align="char">8</td><td align="left">HalfQuarter-Linked</td><td align="left">Both</td><td align="left">0.082</td><td align="left">0.065</td></tr><tr><td align="left">35</td><td char="." align="char">80</td><td char="." align="char">10</td><td align="left">HalfQuarter-Linked</td><td align="left">Both</td><td align="left">0.094</td><td align="left">0.068</td></tr><tr><td align="left">36</td><td char="." align="char">96</td><td char="." align="char">12</td><td align="left">HalfQuarter-Linked</td><td align="left">Both</td><td align="left">0.109</td><td align="left">0.069</td></tr><tr><td align="left">53</td><td char="." align="char">8</td><td char="." align="char">2</td><td align="left">Quarter-Linked</td><td align="left">Both</td><td align="left">0.015</td><td align="left">0.047</td></tr><tr><td align="left">54</td><td char="." align="char">16</td><td char="." align="char">4</td><td align="left">Quarter-Linked</td><td align="left">Both</td><td align="left">0.03</td><td align="left">0.058</td></tr><tr><td align="left">55</td><td char="." align="char">24</td><td char="." align="char">6</td><td align="left">Quarter-Linked</td><td align="left">Both</td><td align="left">0.057</td><td align="left">0.074</td></tr><tr><td align="left">56</td><td char="." align="char">32</td><td char="." align="char">8</td><td align="left">Quarter-Linked</td><td align="left">Both</td><td align="left">0.052</td><td align="left">0.094</td></tr><tr><td align="left">57</td><td char="." align="char">40</td><td char="." align="char">10</td><td align="left">Quarter-Linked</td><td align="left">Both</td><td align="left">0.186</td><td align="left">0.09</td></tr><tr><td align="left">58</td><td char="." align="char">64</td><td char="." align="char">16</td><td align="left">Quarter-Linked</td><td align="left">Both</td><td align="left">0.303</td><td align="left">0.137</td></tr><tr><td align="left">59</td><td char="." align="char">80</td><td char="." align="char">20</td><td align="left">Quarter-Linked</td><td align="left">Both</td><td align="left">0.382</td><td align="left">0.154</td></tr><tr><td align="left">60</td><td char="." align="char">96</td><td char="." align="char">24</td><td align="left">Quarter-Linked</td><td align="left">Both</td><td align="left">0.421</td><td align="left">0.209</td></tr><tr><td align="left">81</td><td char="." align="char">8</td><td char="." align="char">4</td><td align="left">Half-Linked</td><td align="left">Both</td><td align="left">0.011</td><td align="left">0.116</td></tr><tr><td align="left">82</td><td char="." align="char">12</td><td char="." align="char">6</td><td align="left">Half-Linked</td><td align="left">Both</td><td align="left">0.29</td><td align="left">0.15</td></tr><tr><td align="left">83</td><td char="." align="char">16</td><td char="." align="char">8</td><td align="left">Half-Linked</td><td align="left">Both</td><td align="left">0.326</td><td align="left">0.171</td></tr><tr><td align="left">84</td><td char="." align="char">20</td><td char="." align="char">10</td><td align="left">Half-Linked</td><td align="left">Both</td><td align="left">0.388</td><td align="left">0.221</td></tr><tr><td align="left">85</td><td char="." align="char">24</td><td char="." align="char">12</td><td align="left">Half-Linked</td><td align="left">Both</td><td align="left">0.419</td><td align="left">0.242</td></tr><tr><td align="left">86</td><td char="." align="char">32</td><td char="." align="char">16</td><td align="left">Half-Linked</td><td align="left">Both</td><td align="left">0.513</td><td align="left">0.297</td></tr><tr><td align="left">87</td><td char="." align="char">40</td><td char="." align="char">20</td><td align="left">Half-Linked</td><td align="left">Both</td><td align="left">0.638</td><td align="left">0.374</td></tr><tr><td align="left">88</td><td char="." align="char">60</td><td char="." align="char">30</td><td align="left">Half-Linked</td><td align="left">Both</td><td align="left">0.83</td><td align="left">0.516</td></tr><tr><td align="left">89</td><td char="." align="char">80</td><td char="." align="char">40</td><td align="left">Half-Linked</td><td align="left">Both</td><td align="left">0.934</td><td align="left">0.687</td></tr><tr><td align="left">90</td><td char="." align="char">100</td><td char="." align="char">50</td><td align="left">Half-Linked</td><td align="left">Both</td><td align="left">0.982</td><td align="left">0.819</td></tr><tr><td align="left">105</td><td char="." align="char">16</td><td char="." align="char">12</td><td align="left">ThreeQuarter-Linked</td><td align="left">Both</td><td align="left">0.582</td><td align="left">0.372</td></tr><tr><td align="left">106</td><td char="." align="char">24</td><td char="." align="char">18</td><td align="left">ThreeQuarter-Linked</td><td align="left">Both</td><td align="left">0.738</td><td align="left">0.499</td></tr><tr><td align="left">107</td><td char="." align="char">32</td><td char="." align="char">24</td><td align="left">ThreeQuarter-Linked</td><td align="left">Both</td><td align="left">0.845</td><td align="left">0.635</td></tr><tr><td align="left">108</td><td char="." align="char">40</td><td char="." align="char">30</td><td align="left">ThreeQuarter-Linked</td><td align="left">Both</td><td align="left">0.914</td><td align="left">0.719</td></tr><tr><td align="left">109</td><td char="." align="char">64</td><td char="." align="char">48</td><td align="left">ThreeQuarter-Linked</td><td align="left">Both</td><td align="left">0.986</td><td align="left">0.943</td></tr><tr><td align="left">110</td><td char="." align="char">80</td><td char="." align="char">60</td><td align="left">ThreeQuarter-Linked</td><td align="left">Both</td><td align="left">0.997</td><td align="left">0.974</td></tr><tr><td align="left">111</td><td char="." align="char">96</td><td char="." align="char">72</td><td align="left">ThreeQuarter-Linked</td><td align="left">Both</td><td align="left">0.999</td><td align="left">0.995</td></tr><tr><td align="left">124</td><td char="." align="char">10</td><td char="." align="char">10</td><td align="left">Fully-Linked</td><td align="left">Both</td><td align="left">0.604</td><td align="left">0.404</td></tr><tr><td align="left">125</td><td char="." align="char">20</td><td char="." align="char">20</td><td align="left">Fully-Linked</td><td align="left">Both</td><td align="left">0.835</td><td align="left">0.691</td></tr><tr><td align="left">126</td><td char="." align="char">30</td><td char="." align="char">30</td><td align="left">Fully-Linked</td><td align="left">Both</td><td align="left">0.957</td><td align="left">0.849</td></tr><tr><td align="left">127</td><td char="." align="char">40</td><td char="." align="char">40</td><td align="left">Fully-Linked</td><td align="left">Both</td><td align="left">0.989</td><td align="left">0.936</td></tr><tr><td align="left">128</td><td char="." align="char">50</td><td char="." align="char">50</td><td align="left">Fully-Linked</td><td align="left">Both</td><td align="left">0.997</td><td align="left">0.973</td></tr><tr><td align="left">129</td><td char="." align="char">100</td><td char="." align="char">100</td><td align="left">Fully-Linked</td><td align="left">Both</td><td align="left">1</td><td align="left">1</td></tr></tbody></table><table-wrap-foot><p>For both number of heterozygous loci and number of shared alleles, the proportions of detecting dependency in unlinked dataset are approximately less than 5%; in fully linked dataset, is over 70% when the number of markers is larger than 10. When the percentage of linked markers increases, the power of test increases</p></table-wrap-foot></table-wrap></p>
      <p id="Par50">For the unlinked panels, the proportion of <italic>p</italic> values smaller than 0.05 was approximately 50 out of 1000 times. As the number of markers increased, the proportions of significant results became closer to 0.05 (Table <xref rid="Tab2" ref-type="table">2</xref> and Additional file <xref rid="MOESM14" ref-type="media">14</xref>: Table S7). The significant cases in the unlink panel are the Type I errors, which indicates the significance level is about 0.05 for this method. In a fully linked dataset, the power of this test was over 50% when one panel had more than 20 markers, and as the sizes of panels increase, the power of K and X is stronger and stronger.</p>
      <p id="Par51">As the visualization of Table <xref rid="Tab2" ref-type="table">2</xref> and Additional file <xref rid="MOESM14" ref-type="media">14</xref>: Table S7, comparison of different levels of linked data is presented in Fig. <xref rid="Fig3" ref-type="fig">3</xref> (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). In addition, three linkage bias scenarios were also compared at each level of linkage (Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Figure S5), and the comparisons of K and X are shown in Additional file <xref rid="MOESM6" ref-type="media">6</xref>: Figure S6.<fig id="Fig3"><label>Fig. 3</label><caption><p>Power and significance level (proportion of <italic>p</italic> values &lt; 0.05) for different levels of linkage. X-axis denotes the number of markers in one panel; Y-axis denotes the proportion of cases when <italic>p</italic> values &lt; 0.05 out of 1000 cases. For the completely unlinked panels, this proportion means significance level (Type I error) in null hypothesis; for other panels with linkages, this proportion means power (1- type II error) of these two methods. <bold>a</bold>–<bold>c</bold> are figures of K and <bold>d</bold>–<bold>f</bold> are figures of X. <bold>a</bold>, <bold>d</bold> are panels with all linked markers are SNPs; <bold>b</bold>, <bold>e</bold> are panels with all linked markers on STRs; <bold>c</bold>, <bold>f</bold> are panels with equal number of linked SNPs and STRs. In condition, power increases with panel size extends; linkage on SNPs contributes more power than STRs; and K shows more power than X. For SNP-biased (linkage on SNPs) panels, dependency can be detected when linkage is quarter-linked or more; but for STR-biased panels, only three-quarter-linked and almost -linked panels can be tested as dependent panels. In unbiased panels, half-quarter-linkage are also hardly to be detected</p></caption><graphic xlink:href="12859_2020_3945_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par52">The power of <italic>mixIndependR</italic> appears to follow three basic trends: (1) when the number of markers increases, the power of testing increases (Fig. <xref rid="Fig3" ref-type="fig">3</xref>); (2) compared to STRs, linkage in SNPs gives more power for linkage tests (Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Figure S5); (3) between the two summary statistics, the number of heterozygous loci (K) can detect dependency more often than the number of shared alleles (X) for the same panel (Additional file <xref rid="MOESM6" ref-type="media">6</xref>: Figure S6).</p>
      <p id="Par53">When there is only one pair of genetic markers linked, neither of the two methods detected the dependency effectively. In half-quarter-linked panels, the SNP-biased group has a little higher power than STR-biased group- around 10–40% on K and 6% to 18% on X; and power of the unbiased group is between SNP-biased and STR-biased groups, but none of the three groups present a strong enough power in half-quarter-linked panels. However, for quarter- or higher-levels of linkage both K and X yield power greater than 50% when the number of parkers is no less than 60 in SNP-biased group. In contrast, only the three-quarter of linkage and almost-linkage (one pair of markers not linked) can be detected in the STR-biased group. Only with more than 40 markers can the power of STR-biased panels reach 50% and more. In the unbiased group where the number of linked SNPs and linked STRs are equal, K presented more than 50% power when panel sizes were greater than 32 in half-linked panels and greater than 16 in three-quarter-linked panels; the power of X is not as strong as K, only greater than 50% when panel sizes are over 60 in half-linked panels and over 32 in three-quarter-linked panels. In another direction, the number of shared alleles (X) has a lower power than the number of heterozygous loci (K), but the type-I error is larger for K when the panel size is small (Fig. <xref rid="Fig3" ref-type="fig">3</xref> and Additional file <xref rid="MOESM6" ref-type="media">6</xref>: Figure S6).</p>
      <p id="Par54">Afterwards, pure SNP panels were chosen tested to compare summary statistics and other methods. When the panels have more than 10 SNPs the power of both methods are larger than 50%, even in quarter-linked scenarios. For little-linked panels where only one pair of SNPs in linkage, summary statistics are able to detect with power of about 10–20% when panel size are smaller than twenty SNPs, which is much more powerful than pairwise LD. For quarter and half-linked panels, summary statistics presented their advantage with distinguished power for larger panels. In half-linked panels, summary statistics can detect linkage disequilibrium with power of approximately 75–80% when the sample size is larger than 20 and more than 40–50% in quarter-linked panels when the panel sizes are not smaller than 30. For panels with more than 30 SNPs, the power of summary statistics is larger than 40% and increases with the panel size. When there are more than 20 SNPs, the power is estimated to be 100% for fully linked loci, more than 50% for quarter-linked panels, and nearly 90% for half-linked panels (Additional file <xref rid="MOESM7" ref-type="media">7</xref>: Figure S7).</p>
    </sec>
    <sec id="Sec6">
      <title>Real data analysis</title>
      <p id="Par55">Furthermore, having been used in the tests on simulated panels, <italic>mixIndependR</italic> was applied to panels with real data. Based on the SNP + STR reference haplotype panel which was generated by imputing STRs to SNPs [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR20">20</xref>], a mix panel of 2067 variants including 47 STRs and 2020 SNPs, with a threshold 0.2 for squared pairwise correlation -r<sup>2</sup> (Details of variants selection in Methods). In PCA panel design, this is a threshold for “independent” variants. Refer to the output of <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r^{2}$$\end{document}</tex-math><mml:math id="M4"><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2020_3945_Article_IEq2.gif"/></alternatives></inline-formula> table from plink, 0.36% of pairs are detected as pairwise LD (<inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r^{2} &gt; 0.2$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&gt;</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3945_Article_IEq3.gif"/></alternatives></inline-formula>) in this panel though. Therefore, we expect detecting this level of linkage disequilibrium with K and X. With a sample size of 2504 individuals, <italic>p</italic> values of mutual independence test were calculated by K and X. Controlling the panel size for easy comparison in later research, panel size was defined as 100. In other words, 100 markers of the 2067 variants were selected randomly as a sample panel to test, and the process of choose and test was repeated in 1000 times.</p>
      <p id="Par56">As a results, in the 1000 trials 76.1% of <italic>p</italic> values of K and 19.0% of <italic>p</italic> values for X are smaller than 0.05, which indicates that the markers of this panel are not mutual independent. In contrast, the number of significant pairwise LDs calculated by <italic>GDA</italic> is 218 out of 4950 pairs of markers (100 markers were selected randomly in one sample), which is 4.40%. The large difference between the power of X compared to K might result from the fact that majority of the markers are SNPs, the heterozygosity of which data carries more information than number of sharing alleles. In contrast, the pairwise LDs between these markers gave a result of <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r^{2}$$\end{document}</tex-math><mml:math id="M8"><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2020_3945_Article_IEq4.gif"/></alternatives></inline-formula> &lt; 0.2, which is the selection rule for this panel. Our new approach with summary performed better than the traditional methods in the panels with little linkage in the real world. In addition, more panels with different threshold of <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r^{2}$$\end{document}</tex-math><mml:math id="M10"><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2020_3945_Article_IEq5.gif"/></alternatives></inline-formula> have been designed and the comparison is presented in the section of Discussion.</p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Discussion</title>
    <p id="Par57">Compared to traditional LD tests (e.g., D′), the approaches presented herein appear to become more powerful as the size of the panel increases. In Fig. <xref rid="Fig4" ref-type="fig">4</xref> presented the comparisons of power between summary statistics and pairwise LD on simulated pure SNP panels with different levels of linkage (Details of calculation in Methods). K and X showed shows more powerful with 10% than pairwise LD in half-linked panels and holds a stronger advantage in quarter-linked panels, where pairwise LD loss its power. For little-linked panels where there is only one pair of SNPs in linkage, summary statistics can detect linkage with about 20% power for small panel size.<fig id="Fig4"><label>Fig. 4</label><caption><p>Power and significance level comparison between summary statistics and traditional LD test. Comparison among K, X, and pairwise LD calculated by R package genetics. K denotes number of heterozygous loci; X denotes number of shared alleles; Pairwise LD denotes the results from the function <italic>LD</italic> of package <italic>genetics</italic></p></caption><graphic xlink:href="12859_2020_3945_Fig4_HTML" id="MO4"/></fig></p>
    <p id="Par58">On the other hand, the tests of real data panels have also been completed and compared between the pairwise correlation and summary statistics- K and X. With the threshold for <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r^{2}$$\end{document}</tex-math><mml:math id="M12"><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2020_3945_Article_IEq6.gif"/></alternatives></inline-formula> set in 4 groups: &lt; 0.2, &lt; 0.4, &lt; 0.6 and &lt; 0.8, four panels in Table <xref rid="Tab3" ref-type="table">3</xref> were designed. With the threshold lifting, the number of markers selected increase from 2067 to 5754, among which the number of STRs increases from 47 to 115. The percentage of variant pairs with significant LD in each group increases from 0.36 to 21.43%. Though the maximum of correlation was setting higher, the means of <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r^{2}$$\end{document}</tex-math><mml:math id="M14"><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2020_3945_Article_IEq7.gif"/></alternatives></inline-formula> and 3rd quarters of <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r^{2}$$\end{document}</tex-math><mml:math id="M16"><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2020_3945_Article_IEq8.gif"/></alternatives></inline-formula> remain below 0.2 (Table <xref rid="Tab3" ref-type="table">3</xref> and Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). Using the software <italic>GDA</italic>, a set of <italic>p</italic>-values for pairwise LD were calculated (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b). After the Bonferroni correction, about 3–5% pairs of variants are found significant dependent in each test of a panel with 100 variants. Holding the panel size as 100 constant, 10 times of analysis were repeated with different 100 variants which were chosen randomly from each group, and the power of method <italic>GDA</italic> has been assessed using the formula explained in Methods. Due to the few repeats of experiments, most of the power is below 20%. Though 7 of the 10 repeats at the group of 0.6 have been found as significance, the average of proportion of significant <italic>p</italic> values after Bonferroni correction is 0.054. The seven proportions defined as dependency panel are range of 0.05 and 0.06. This result might be explained by not enough times of experiments. More trials can be tested, but this method is time-consuming as one single calculation for pairwise LD of a 100-variant-panel needs 1 h and 8 min, without the time of generating and formatting samples. However, in the tests using K and X, linkage disequilibrium was detected. Controlling panel size as 100 markers, the proportion of significant <italic>p</italic> values (&lt; 0.05) is 96.35% on average for K and 23.80% for X. Across four groups with different threshold of <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r^{2}$$\end{document}</tex-math><mml:math id="M18"><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2020_3945_Article_IEq9.gif"/></alternatives></inline-formula> and total panel size, the power of K or X fluctuate in a small scale (<inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$sd_{K} = 0.016. sd_{X} = 0.029)$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi>s</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.016</mml:mn><mml:mo>.</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mn>0.029</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3945_Article_IEq10.gif"/></alternatives></inline-formula>. The reason why K shows a much stronger power than X also lies in the large proportion of SNPs in panels. Also, K or X can conduct a single test in 100 times with different random samples selected each time in only 12 and a half minutes for panels with 100 markers.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Summary of panels designed from real data</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">LD (r2 threshold)</th><th align="left">&lt; 0.2</th><th align="left">&lt; 0.4</th><th align="left">&lt; 0.6</th><th align="left">&lt; 0.8</th></tr></thead><tbody><tr><td align="left" colspan="5"><italic>Number of different type of markers</italic></td></tr><tr><td align="left">Number of Markers</td><td align="left">2067</td><td align="left">3157</td><td align="left">4278</td><td align="left">5754</td></tr><tr><td align="left">Number of STRs</td><td align="left">47</td><td align="left">64</td><td align="left">83</td><td align="left">115</td></tr><tr><td align="left">Number of SNPs</td><td align="left">2020</td><td align="left">3093</td><td align="left">4195</td><td align="left">5639</td></tr><tr><td align="left" colspan="5"><italic>Summary of r2</italic></td></tr><tr><td align="left">Min</td><td align="left">0.000</td><td align="left">0.000</td><td align="left">0.000</td><td align="left">0.000</td></tr><tr><td align="left">1st Qu</td><td align="left">0.000</td><td align="left">0.002</td><td align="left">0.003</td><td align="left">0.006</td></tr><tr><td align="left">Median</td><td align="left">0.000</td><td align="left">0.009</td><td align="left">0.018</td><td align="left">0.037</td></tr><tr><td align="left">Mean</td><td align="left">0.020</td><td align="left">0.042</td><td align="left">0.074</td><td align="left">0.124</td></tr><tr><td align="left">3rd Qu</td><td align="left">0.020</td><td align="left">0.042</td><td align="left">0.084</td><td align="left">0.159</td></tr><tr><td align="left">Max</td><td align="left">0.990</td><td align="left">0.991</td><td align="left">0.991</td><td align="left">0.991</td></tr></tbody></table><table-wrap-foot><p>This is the summary for panels designed out of real data. On the chromosome 22, 4 mixed panels have been generated from the SNP-STR reference haplotype panel of Gymrek’s lab [<xref ref-type="bibr" rid="CR20">20</xref>]. The pruning was completed on plink/1.90 with threshold of pairwise correlation 0.2, 0.4, 0.6 and 0.8, with the code “--indep-pairwise”. The second part of Table <xref rid="Tab3" ref-type="table">3</xref> presents the summary of <inline-formula id="IEq20"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r^{2}$$\end{document}</tex-math><mml:math id="M22"><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2020_3945_Article_IEq20.gif"/></alternatives></inline-formula> values for each panel. The lists of <inline-formula id="IEq21"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r^{2}$$\end{document}</tex-math><mml:math id="M24"><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2020_3945_Article_IEq21.gif"/></alternatives></inline-formula> were calculated and exported with the code “ –r2 –ld-window-r2 0”.</p></table-wrap-foot></table-wrap><fig id="Fig5"><label>Fig. 5</label><caption><p>Comparison of K or X and pairwise LD in real data. Four panels designed from real dataset by variant pruning with threshold 0.2, 0.4, 0.6 and 0.8 are tested in pairwise LD and summary statistic K and X. In each panel, there are 2067, 3157, 4278 and 5754 variants, respectively. <bold>a</bold> is the boxplot excluding outliers of <inline-formula id="IEq19"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r^{2}$$\end{document}</tex-math><mml:math id="M26"><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2020_3945_Article_IEq19.gif"/></alternatives></inline-formula> values for each panel. With the threshold increasing (x-axis denotes the groups), the boxplot lifts but major parts remain under 0.2. <bold>b</bold> is the power of pairwise LD by GDA, K, and X in multiple trials (10 trials for GDA, 1000 trials for K or X) for 100 random markers from each panel. On each new trial, the markers were re-selected. Y-axis shows the proportion of significant <italic>p </italic>values on each panel. The number of trials for GDA is small due to the time-consuming of this software. The power in this method might not be accurate. Average proportions for significant <italic>p</italic> values in method GDA is: 0.047 (0.2 group); 0.041 (0.4 group), 0.054 (0.6 group), 0.040 (0.8 group)</p></caption><graphic xlink:href="12859_2020_3945_Fig5_HTML" id="MO5"/></fig></p>
    <p id="Par59">Therefore, both in simulation and real data, this approach presented a stronger power on detecting linkage disequilibrium in a manner of testing the linkage more than pairwise of a whole panel, regardless of the types of genetic markers.</p>
  </sec>
  <sec id="Sec8">
    <title>Conclusions</title>
    <p id="Par60">The R package <italic>mixIndependR</italic> is available on the Comprehensive R Archive Network (CRAN) at: <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/mixIndependR/index.html">https://cran.r-project.org/web/packages/mixIndependR/index.html</ext-link> [<xref ref-type="bibr" rid="CR21">21</xref>] and the development version can be found on Github: <ext-link ext-link-type="uri" xlink:href="https://github.com/ice4prince/mixIndependR.git">https://github.com/ice4prince/mixIndependR.git</ext-link> [<xref ref-type="bibr" rid="CR22">22</xref>]. This package contributes to the LD test of mixed panels with different types of genetic markers. It permits several new approaches to estimating LD, with the described method permitting LD estimation between heterogeneous marker types (e.g., SNPs and STRs). Instead of pairwise LD, the method tests mutual independence across all the markers of one panel. With new test statistics, this approach improved the power of dependency testing, and succeeded in testing the overall linkage disequilibrium across all sites simultaneously.</p>
  </sec>
  <sec id="Sec9">
    <title>Methods</title>
    <sec id="Sec10">
      <title>Data representations</title>
      <p id="Par61">In <italic>mixIndpendR</italic>, dataset to import can be an “. xslx” “.csv” or “vcf” file, with the marker names in the first row, and sample ID in the first column like the example (Table <xref rid="Tab4" ref-type="table">4</xref>). “vcf” file can be imported with the function <italic>read_vcf_gt</italic>. Allele files where alleles are separated in two different cells needs a conversion by function “<italic>makeGenotypes</italic>” in <italic>genetics</italic>[<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR24">24</xref>].<table-wrap id="Tab4"><label>Table 4</label><caption><p>Example of imported data</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Sample ID</th><th align="left">STR1</th><th align="left">SNP1</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">12|12</td><td align="left">A|A</td></tr><tr><td align="left">2</td><td align="left">13|14</td><td align="left">T|T</td></tr><tr><td align="left">3</td><td align="left">13|13</td><td align="left">A|T</td></tr><tr><td align="left">4</td><td align="left">14|15</td><td align="left">A|T</td></tr><tr><td align="left">5</td><td align="left">15|13</td><td align="left">T|A</td></tr><tr><td align="left">6</td><td align="left">13|14</td><td align="left">A|T</td></tr><tr><td align="left">7</td><td align="left">14|3</td><td align="left">A|A</td></tr><tr><td align="left">8</td><td align="left">12|2</td><td align="left">T|A</td></tr><tr><td align="left">9</td><td align="left">14|14</td><td align="left">T|T</td></tr><tr><td align="left">10</td><td align="left">15|15</td><td align="left">A|T</td></tr></tbody></table><table-wrap-foot><p>Each row denotes each individual sample; each column denotes each marker. The format of csv file can be imported directly by “read.csv” and the vcf file can be imported with the function “<italic>read_vcf_gt</italic>” in this package. The allele separator is not restricted to “|”. It can be specified in the following functions</p></table-wrap-foot></table-wrap></p>
      <p id="Par62">We simulated unlinked and linked data under the Wright-Fisher neutral model using the software <italic>ms</italic> [<xref ref-type="bibr" rid="CR18">18</xref>]; the microsatellite data were converted by <italic>microsat</italic> [<xref ref-type="bibr" rid="CR19">19</xref>] from <italic>ms</italic> format. For data simulation, we chose the average mutation rate (<inline-formula id="IEq11"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu$$\end{document}</tex-math><mml:math id="M28"><mml:mi>μ</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3945_Article_IEq11.gif"/></alternatives></inline-formula>) 1.3 × 10<sup>–3</sup> [<xref ref-type="bibr" rid="CR25">25</xref>] and an effective population (N) size of 3100, the latter of which was estimated from linkage disequilibrium [<xref ref-type="bibr" rid="CR26">26</xref>]. Thus, to simulate the unlinked STR data the mutation parameter <inline-formula id="IEq12"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta { }\left( {\theta = 4{\text{N}}\mu { }} \right)$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mi>θ</mml:mi><mml:mrow/><mml:mfenced close=")" open="("><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mtext>N</mml:mtext><mml:mi>μ</mml:mi><mml:mrow/></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3945_Article_IEq12.gif"/></alternatives></inline-formula> is equal to 16.12. In contrast, to simulate SNPs a fixed number of segregating sites was simulated for both unlinked data and linked data.</p>
      <p id="Par63">Real data was downloaded and filtered from the reference panel of Dr. Saini et al. [<xref ref-type="bibr" rid="CR11">11</xref>] using <italic>plink 1.90</italic> [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>]. Chromosome 22 was chosen so that fewer variants needs to import, and less time will be spent. Before selecting for different levels of pairwise dependence, variants and samples with more than 1% missing data, with minor allele frequency lower than 0.1, and those who fail in Hardy–Weinberg test at 5%, and with Mendel error rate higher than 0.1 at family level or higher than 0.2 for SNPs, had been filtered out. As to the different levels of linkage panels, selection rules were set using the pairwise correlation-r<sup>2</sup>. Four groups were formed with pairwise correlation (window size 50 kb and step size 10 variants) &lt; 0.2 (2067 variants), &lt; 0.4 (3157 variants), &lt; 0.6 (4278 variants) and &lt; 0.8 (5754 variants), and in each panel there are 47 STRs, 64 STRs, 83 STRs, and 115 STRs, respectively. The LD significant pairs of variants in these groups make up 0.36%, 5.71%, 12.21%, and 21.43% among all variants in each panel, respectively. Furthermore, the pairwise r<sup>2</sup> values for each group were exported by <italic>plink</italic>.</p>
      <p id="Par64">The example dataset attached in the package “<italic>mixexample</italic>” was filtered from chromosome 4 with the same selection rule but with a threshold 0.1 for <inline-formula id="IEq13"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r^{2}$$\end{document}</tex-math><mml:math id="M32"><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2020_3945_Article_IEq13.gif"/></alternatives></inline-formula>. Among the panel of 7413 variants, 100 markers were selected randomly to make up the example dataset.</p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Functionalities</title>
    <p id="Par65">The package <italic>mixIndependR</italic> is made up of two main sections—basic genetic parameters calculation and mutual independence testing. Parameters obtained in the first part can be used in the second section. The software pipeline presented a structure of all the functions (Fig. <xref rid="Fig6" ref-type="fig">6</xref>).<fig id="Fig6"><label>Fig. 6</label><caption><p>Pipeline of <italic>mixIndependR</italic>. Functions are presented in the grey boxes, and the results are in dark red boxes. The same function in different paths use different logic parameters. Crossed paths share input parameters</p></caption><graphic xlink:href="12859_2020_3945_Fig6_HTML" id="MO6"/></fig></p>
    <sec id="Sec12">
      <title>Basic genetics</title>
      <p id="Par66">The first part of this package was developed to calculate the basic genetic parameters of a mixed or non-mixed panel, including the allele frequencies <italic>(AlleleFreq),</italic> the genotype frequencies or expected genotype probabilities <italic>(GenotypeFreq)</italic>, and the Hardy–Weinberg Equilibrium <italic>(HWE.Chisq)</italic> [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR27">27</xref>]. Different from other packages or software, these functions for basic genetic parameters can ignore the types of genetic markers and do not need to input the list of marker names, but the separator between alleles needs to be specified.
</p>
    </sec>
    <sec id="Sec13">
      <title>Mutual independence</title>
      <sec id="Sec14">
        <title>Summary statistics design</title>
        <p id="Par67">In traditional statistics, non-random associations were tested from pairs. However, mutual independence also included other subsets, like triplets and quartets. As the number of subsets increases, large quantities of free parameters will be generated. For example, for independence of two loci, there would be 3 free parameters if the heterozygosity were chosen as the tested statistics. But for 5 loci where the number of pair comes to 32, there would be 2<sup>5</sup> − 1 = 31 free parameters in only pairwise independence testing, not to mention more subsets like triplets and quartets. When tens of loci were imported, the parameters would increase to thousands, where even the sample size might not be that large sometimes.</p>
        <p id="Par68">In order to break the large barrier that the number of free parameters might exceed the relatively small number of observations/subjects for the traditional statistic method when the sample size is not big enough, to avoid numerous calculations, and to reduce time consumption, two summary statistics were designed—the number of heterozygous Loci (K) and the number of shared alleles (X) [<xref ref-type="bibr" rid="CR10">10</xref>].</p>
        <p id="Par69">Under the assumption of mutual independence, the distribution of these summary statistics follows a restricted multinomial distribution. By comparing the observed and expected distribution, the hypothesis for mutual independence could be tested [<xref ref-type="bibr" rid="CR10">10</xref>].</p>
        <p id="Par70">For the number of heterozygous loci (K), the distribution follows an appropriate binomial distribution of 0 and 1, with the fixed but different probabilities on each trial. Similarly, the distribution of the number of shared alleles(X) follows a “skewed” multinomial distribution of 0, 1, and 2, where the probabilities are specified on each trial.</p>
      </sec>
      <sec id="Sec15">
        <title>The number of heterozygous loci (K)</title>
        <p id="Par71">The number of heterozygous loci (K) is the sum of the number of heterozygous loci for each individual, which was denoted as<disp-formula id="Equa"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} &amp; K = K_{1} + K_{2} +K_{3} + \cdots K_{i} + \cdots + K_{m} \quad where \;m\;is\;the\;number\;of\;loci; \\ &amp; K_{i} \;denotes\;the\;status\;of\;heterozygosity\;of\;the\;i_{th} \;loci,\ \\&amp; 0\;as\;homozygous, and\;1\;as\;heterozygous; \\ &amp; when\;m\;is\;the\;number\;of\;loci,\;K\;belongs\;to\;\left( {0, m} \right) \\ \end{aligned}$$\end{document}</tex-math><mml:math id="M34" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mspace width="1em"/><mml:mi>w</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.277778em"/><mml:mi>m</mml:mi><mml:mspace width="0.277778em"/><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.277778em"/><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.277778em"/><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.277778em"/><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.277778em"/><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mo>;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.277778em"/><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.277778em"/><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.277778em"/><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.277778em"/><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.277778em"/><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>z</mml:mi><mml:mi>y</mml:mi><mml:mi>g</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mspace width="0.277778em"/><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.277778em"/><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.277778em"/><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">th</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.277778em"/><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mspace width="4pt"/></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mspace width="0.277778em"/><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.277778em"/><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>z</mml:mi><mml:mi>y</mml:mi><mml:mi>g</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.277778em"/><mml:mn>1</mml:mn><mml:mspace width="0.277778em"/><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.277778em"/><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>z</mml:mi><mml:mi>y</mml:mi><mml:mi>g</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mo>;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>w</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.277778em"/><mml:mi>m</mml:mi><mml:mspace width="0.277778em"/><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.277778em"/><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.277778em"/><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.277778em"/><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.277778em"/><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mi>K</mml:mi><mml:mspace width="0.277778em"/><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.277778em"/><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mspace width="0.277778em"/><mml:mfenced close=")" open="("><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2020_3945_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par72">With the dataset imported<italic>,</italic> a table for heterozygosity was built by <italic>Heterozygous.</italic> This function exported a table of 0 and 1, where 0 denoted homozygous and 1 denoted heterozygous, with each row for each individual and each column for each marker. With the table of heterozygous status, the function <italic>FreqHetero</italic> obtained the observed distribution of number of heterozygous loci for the targeted dataset.</p>
        <p id="Par73">The expected distribution was built according to a recurrence formula with a specially assigned “Start” and “End” [<xref ref-type="bibr" rid="CR9">9</xref>]. For the first m-th loci, there were two possible scenarios to discover r heterozygous loci: 1. the last locus is homozygous and there were r heterozygous loci on the first (m − 1) loci; 2. the last locus is heterozygous and there were (r − 1) heterozygous loci on the first (m − 1) loci.<disp-formula id="Equb"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} &amp; P_{{{\text{x}} = {\text{r}}}}^{{\text{m}}} = P_{x = r}^{m - 1} \left( {1 - h_{m} } \right) + P_{x = r - 1}^{m - 1} h_{m} \\ &amp; where\;h_{m} \;is\;the\;heterozygosity\;of\;the\;m\text{-}th\;locus \\ \end{aligned}$$\end{document}</tex-math><mml:math id="M36" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mrow><mml:mtext>x</mml:mtext><mml:mo>=</mml:mo><mml:mtext>r</mml:mtext></mml:mrow></mml:mrow><mml:mtext>m</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>h</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>w</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.277778em"/><mml:msub><mml:mi>h</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mspace width="0.277778em"/><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.277778em"/><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.277778em"/><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>z</mml:mi><mml:mi>y</mml:mi><mml:mi>g</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mspace width="0.277778em"/><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.277778em"/><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.277778em"/><mml:mi>m</mml:mi><mml:mtext>-</mml:mtext><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mspace width="0.277778em"/><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2020_3945_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par74">The vector of heterozygosity was calculated with function <italic>RxpHetero</italic> in case of Hardy–Weinberg Equilibrium or Disequilibrium with the logic parameter <italic>HWE</italic> true or false. The heterozygosity was saved into the vector <italic>H</italic> in the order of loci, and the expected distribution of K was calculated by <italic>DistHetero(H).</italic></p>
      </sec>
      <sec id="Sec16">
        <title>The number of shared alleles (X)</title>
        <p id="Par75">Similarly, the number of shared alleles (X) is the summation of the number of shared alleles on each locus obtained by comparing each two individuals.<disp-formula id="Equc"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} &amp; X = X_{1} + X_{2} + X_{3} + \cdots X_{i} \cdots + X_{m} \quad {\text{where}}\;{\text{m}}\;{\text{is}}\;{\text{number}}\;{\text{of}}\;{\text{loci}} \\ &amp; X_{{\text{i}}} \;{\text{denotes}}\;{\text{the}}\;{\text{number}}\;{\text{of}}\;{\text{shared}}\;{\text{alleles}}\;{\text{on}}\;{\text{the}}\;i_{th} \;{\text{locus}};\;{\text{belongs}}\;{\text{to}}\;\left( {0,1,2} \right) \\ &amp; X\;{\text{belongs}}\;{\text{to}}\;\left( {0,{ }2{\text{m}}} \right){ } \\ \end{aligned}$$\end{document}</tex-math><mml:math id="M38" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mspace width="1em"/><mml:mtext>where</mml:mtext><mml:mspace width="0.277778em"/><mml:mtext>m</mml:mtext><mml:mspace width="0.277778em"/><mml:mtext>is</mml:mtext><mml:mspace width="0.277778em"/><mml:mtext>number</mml:mtext><mml:mspace width="0.277778em"/><mml:mtext>of</mml:mtext><mml:mspace width="0.277778em"/><mml:mtext>loci</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mtext>i</mml:mtext></mml:msub><mml:mspace width="0.277778em"/><mml:mtext>denotes</mml:mtext><mml:mspace width="0.277778em"/><mml:mtext>the</mml:mtext><mml:mspace width="0.277778em"/><mml:mtext>number</mml:mtext><mml:mspace width="0.277778em"/><mml:mtext>of</mml:mtext><mml:mspace width="0.277778em"/><mml:mtext>shared</mml:mtext><mml:mspace width="0.277778em"/><mml:mtext>alleles</mml:mtext><mml:mspace width="0.277778em"/><mml:mtext>on</mml:mtext><mml:mspace width="0.277778em"/><mml:mtext>the</mml:mtext><mml:mspace width="0.277778em"/><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">th</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.277778em"/><mml:mtext>locus</mml:mtext><mml:mo>;</mml:mo><mml:mspace width="0.277778em"/><mml:mtext>belongs</mml:mtext><mml:mspace width="0.277778em"/><mml:mtext>to</mml:mtext><mml:mspace width="0.277778em"/><mml:mfenced close=")" open="("><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>X</mml:mi><mml:mspace width="0.277778em"/><mml:mtext>belongs</mml:mtext><mml:mspace width="0.277778em"/><mml:mtext>to</mml:mtext><mml:mspace width="0.277778em"/><mml:mfenced close=")" open="("><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow/><mml:mn>2</mml:mn><mml:mtext>m</mml:mtext></mml:mrow></mml:mfenced><mml:mrow/></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2020_3945_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par76">A table of <inline-formula id="IEq14"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_{{\text{i}}}$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mi>X</mml:mi><mml:mtext>i</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3945_Article_IEq14.gif"/></alternatives></inline-formula> was built by <italic>AlleleShare,</italic> where a logic parameter “<italic>replacement</italic>” defining the type of “pick pairs” needs to be clarified as <italic>TRUE</italic> for pairs with replacement or <italic>FALSE</italic> for pairs without replacement.</p>
        <p id="Par77">The observed distribution of <inline-formula id="IEq15"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_{i}$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3945_Article_IEq15.gif"/></alternatives></inline-formula> was built by <italic>FreqAlleleShare</italic> from the result of <italic>AlleleShare.</italic> As for the expected distribution, the probability for sharing 0, 1, or 2 alleles on each locus was needed. According to Weir, the expected probabilities of sharing 0, 1, or 2 alleles for two unrelated individuals could be obtained by <italic>ExpProAlleleShare,</italic> with the allele frequency table from <italic>AlleleFreq</italic>. On the other hand, for non-ideal samples, the real proportions of sharing alleles were also suitable to use, which could be calculated by <italic>RealProAlleleShare.</italic> With the probability table, an expected distribution of <inline-formula id="IEq16"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_{i}$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3945_Article_IEq16.gif"/></alternatives></inline-formula> was built by <italic>DistAlleleShare</italic> by the principles of multinomial distribution<disp-formula id="Equd"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} &amp; P_{x = r}^{m} = P_{x = r}^{m - 1} *p_{0}^{m} + P_{x = r - 1}^{m - 1} *p_{1}^{m} + P_{r - 2}^{m - 1} *p_{2}^{m} \\ &amp; where\;p_{k}^{m} \;denotes\;the\;probability\;of\;have\;k\;shared\;alleles\;on\;the\;m\text{-}th\;locus \\ \end{aligned}$$\end{document}</tex-math><mml:math id="M46" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow/><mml:mo>∗</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow/><mml:mo>∗</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow/><mml:mo>∗</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>w</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.277778em"/><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mspace width="0.277778em"/><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.277778em"/><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.277778em"/><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mspace width="0.277778em"/><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.277778em"/><mml:mi>h</mml:mi><mml:mi>a</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.277778em"/><mml:mi>k</mml:mi><mml:mspace width="0.277778em"/><mml:mi>s</mml:mi><mml:mi>h</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.277778em"/><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.277778em"/><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.277778em"/><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.277778em"/><mml:mi>m</mml:mi><mml:mtext>-</mml:mtext><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mspace width="0.277778em"/><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2020_3945_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec17">
        <title>Significance test</title>
        <p id="Par78">With the distributions built, two functions were designed for data visualization: <italic>ComposPare_K</italic> and <italic>ComposPare_X</italic>. These functions generated expected frequencies from the probabilities and converted the dataset into a form suitable to <italic>ggplot2</italic> [<xref ref-type="bibr" rid="CR28">28</xref>] or <italic>plot</italic> in R.</p>
        <p id="Par79">The null hypothesis was that all markers, regardless of which type, are independent from each other. To test the null hypothesis, making comparisons between observed and expected distribution was required. Generally, a multinomial distribution has a fixed probability for each trial. However, in genetics, we cannot predict the distribution of heterozygosity or probability of sharing alleles for an unknown panel under testing. Thus, there were no perfect statistical methods designed for this special problem at this moment.</p>
        <p id="Par80">Despite the lack of existed methodology, with the fixed probability, it was not difficult to find the distribution of the test statistics by large sample simulation.</p>
        <p id="Par81">In this research, chi square value was chosen as the test statistic since the test was for fit of goodness and the distribution was similar to multinomial distribution. To ensure a good approximation for the chi square distribution, the expected numbers of each category were restricted to no less than five. Functions <italic>Simulate_DistK</italic> and <italic>Simulate_DistX</italic> built the simulation for K and X, respectively. For each new panel, each new bundle of simulation needs to be built. Via the basic equation of calculating the Chi-square value, a set of Chi-square values were generated by function <italic>Dist_SimuChisq.</italic> With the set of Chi-square values, a plot of cumulative distribution of <inline-formula id="IEq17"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\chi^{2}$$\end{document}</tex-math><mml:math id="M48"><mml:msup><mml:mi>χ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2020_3945_Article_IEq17.gif"/></alternatives></inline-formula> were drawn clearly, from which the critical value of Chi-square statistic was specified.</p>
      </sec>
    </sec>
    <sec id="Sec18">
      <title>Comparison with other software</title>
      <p id="Par82">The R package <italic>genetics</italic> provides a function <italic>LD</italic> to test the linkage disequilibrium for all possible pairs of loci in one panel. This function can output D, D′, Pearson’s correlation coefficient, Chi-square statistic for linkage equilibrium (D = D′ = 0) and the <italic>p</italic> value of Chi-square test for independence. Using the unlinked data and linked data simulated above, a distribution of the proportion of <italic>p</italic> values smaller than significance level after Bonferroni correction can be obtained. The null hypothesis is that there is no significant LD among all the pairs for unlinked panel, which is <inline-formula id="IEq18"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Pr \left( {p \text{-}values &lt; \frac{0.05}{{number\,of\,pairs}}} \right) = 0$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mo>Pr</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>p</mml:mi><mml:mtext>-</mml:mtext><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mo>&lt;</mml:mo><mml:mfrac><mml:mrow><mml:mn>0.05</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.166667em"/><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.166667em"/><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3945_Article_IEq18.gif"/></alternatives></inline-formula>. Under the null hypothesis, even though the markers were simulated on different chromosomes and there should be no association between any pair of them, some random associations may still be generated. In this program, no more than 5% random associations among the 1000 runs was allowed. In other words, if the percentage of significant <italic>p</italic> values is larger than 0.05, the null hypothesis would be rejected.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec30">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2020_3945_MOESM1_ESM.png">
            <caption>
              <p><bold>Additional file 1: Figure S1.</bold> Distribution of number of heterozygous loci (K) for the example dataset. The X-axis is the number of shared alleles from 0 to 100, and the Y-axis is the observed density or expected probability of each K. The red bar is the expected distribution, and the green bar denotes the observed distribution. The red line is the expected spline for probability of K.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2020_3945_MOESM2_ESM.png">
            <caption>
              <p><bold>Additional file 2: Figure S2.</bold> Distribution of number of shared alleles (X) for the example dataset. The X-axis is the number of shared alleles from 0 to 200, and the Y-axis is the observed density or expected probability of each X. The red bar is the expected distribution, and the green bar denotes the observed distribution. The red line is the expected spline for probability of X.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2020_3945_MOESM3_ESM.png">
            <caption>
              <p><bold>Additional file 3: Figure S3.</bold> Cumulative probability function of Chi-square values for number of heterozygous loci (K) of the example dataset. The Y-axis is the cumulative probability (1- p-value) for the chi-square value at X-axis. In this example, the tested chi-square value of K is 77.417 (blue line), with a cumulative probability of 0.924. In contrast, the critical value for p-value = 0.05 (cumulative probability = 0.95) is 112.9 (red line).</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="12859_2020_3945_MOESM4_ESM.png">
            <caption>
              <p><bold>Additional file 4: Figure S4.</bold> Cumulative probability function of Chi-square values for number of shared alleles (X) of the example dataset. The Y-axis is the cumulative probability (1- p-value) for the chi-square value at X-axis. In this example, the tested chi-square value of X is 62.299 (blue line), with a cumulative probability of 0.778. In contrast, the critical value for p-value = 0.05 (cumulative probability = 0.95) is 115 (red line).</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="12859_2020_3945_MOESM5_ESM.tif">
            <caption>
              <p><bold>Additional file 5: Figure S5.</bold> Summary of power tests for simulated data at different linkage levels for K and X- comparison between ‘<italic>Bias</italic>’. The X-axis denotes the number of markers in each panel, and the Y-axis is the proportion of significant cases whose p-value is smaller than 0.05. The colors present different categories of <italic>‘Bias’</italic>- when ‘<italic>Bias</italic>’ = Both, the types of linked markers are both SNPs and STRs with equal numbers; when ‘<italic>Bias</italic>’ = SNP, the most or all linked markers are SNPs; when ‘<italic>Bias</italic>’ = STR, the most or all linked markers are STRs. In Fig. <xref rid="Fig5" ref-type="fig">5</xref>, the left plots are those for number of heterozygous loci (K) and the right plots are number of shared alleles (X). From the top to the bottom, the levels of linkage increase from “OnePair-Linked” to “Almost-Linked”. In the “Onepair/Little-Linked” level, only one pair of markers are linked in each panel; in the “HalfQuarter-Linked” level, 12.5% SNPs are linked; in the “Quarter-Linked” level, 25% SNPs are linked; in the “ThreeQuarter-Linked” level, 75% SNPs are linked; in the “Almost-Linked” level, all except one pair of markers are linked.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="12859_2020_3945_MOESM6_ESM.tif">
            <caption>
              <p><bold>Additional file 6: Figure S6.</bold> Comparison of Power for mixed simulated data (‘<italic>Bias</italic>’ = Both) between number of heterozygous loci (K) and number of shared alleles (X). The X-axis denotes the number of markers in each panel, and the Y-axis is the proportion of significant cases whose p-value is smaller than 0.05. “Linkage on Both” means half of the linked markers are SNPs and the other linked markers are STRs. The solid lines are presented the power trends of K, and the dotted lines are the power trends of X. Different colors are different linkage levels: red lines are half-linked panels (50% markers are linked); green lines are Quarter-Linked panels (25% markers are linked); blue lines are ThreeQuarter-Linked panels (75% markers are linked).</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="12859_2020_3945_MOESM7_ESM.png">
            <caption>
              <p><bold>Additional file 7: Figure S7.</bold> Power and significant level of K and X for simulated SNP panels at different linkage levels. The proportions of significant cases out of 1000 trials along different panel size for simulated SNP panels at different linkage levels. In the “Unlinked” level, all markers in each panel are unlinked; in the “Onepair/Little-Linked” level, only one pair of markers are linked in each panel; in the “HalfQuarter-Linked” level, 12.5% SNPs are linked; in the “Quarter-Linked” level, 25% SNPs are linked; in the “ThreeQuarter-Linked” level, 75% SNPs are linked; in the “Almost-Linked” level, all except one pair of markers are linked; in the “Fully-Linked” level, all markers in each panel are linked. The axis “Panel Size” denotes the number of the SNPs in each panel.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM8">
          <media xlink:href="12859_2020_3945_MOESM8_ESM.csv">
            <caption>
              <p><bold>Additional file 8: Table S1.</bold> Genotypes of example dataset—‘<italic>mixexample</italic>’. The raw genotypes of the example data. Each row denotes each individual and each column denotes each marker.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM9">
          <media xlink:href="12859_2020_3945_MOESM9_ESM.csv">
            <caption>
              <p><bold>Additional file 9: Table S2.</bold> Table of allele frequency (expected) for example dataset- ‘<italic>mixexample</italic>’. Each column denotes each marker. The first column lists all alleles appeared at all loci-0, 1, 2, 3, 4, and 5. There is the probability of the allele of this row at the locus of this column.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM10">
          <media xlink:href="12859_2020_3945_MOESM10_ESM.csv">
            <caption>
              <p><bold>Additional file 10: Table S3.</bold> Table of heterozygosity for example dataset- ‘<italic>mixexample</italic>’. In each cell, the status of heterozygosity -0 (homozygous) or 1 (heterozygous), for the individual of this row at this locus is presented. Column names are markers’ names, and the row names are individuals.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM11">
          <media xlink:href="12859_2020_3945_MOESM11_ESM.csv">
            <caption>
              <p><bold>Additional file 11: Table S4.</bold> Table of shared alleles for example dataset- ‘<italic>mixexample</italic>’. In each cell, the number of shared alleles -0 or 1 or 2, for the pair of individuals of this row at this locus is presented. Column names are markers’ names, and the row names are pairs of individuals.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM12">
          <media xlink:href="12859_2020_3945_MOESM12_ESM.csv">
            <caption>
              <p><bold>Additional file 12: Table S5.</bold> Simulations for expected number of heterozygous loci (K) for the example dataset- ‘mixexample’. The first row (also the column names) is the number of heterozygous loci (K) from 0 to 100; and the first column is the index of simulations 1 to 500. Each row denotes each simulation and shows one distribution of K.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM13">
          <media xlink:href="12859_2020_3945_MOESM13_ESM.csv">
            <caption>
              <p><bold>Additional file 13: Table S6.</bold> Simulations for expected number of shared alleles (X) for the example dataset- ‘mixexample’. The first row (also the column names) is the number of shared alleles from 0 to 200; and the first column is the index of simulations- 1 to 500. Each row denotes each simulation and shows one distribution of X.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM14">
          <media xlink:href="12859_2020_3945_MOESM14_ESM.xlsx">
            <caption>
              <p><bold>Additional file 14: Table S7.</bold> Summary of power test for simulated mix panels. Full version of Table <xref rid="Tab2" ref-type="table">2</xref>. The first sheet includes all designed panels; and sheet 2 ~ 4 filtered on variable ‘Bias’. Sheet 2 presents the panels when half of linked markers are SNPs and the other half of linked markers are STRs; Sheet 3 presents the panels with more linked SNPs than linked STRs; Sheet 4 presents the panels with more linked STRs than linked SNPs.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>SNP</term>
        <def>
          <p id="Par5">Single nucleotide polymorphism</p>
        </def>
      </def-item>
      <def-item>
        <term>InDel</term>
        <def>
          <p id="Par6">Insertions and deletions</p>
        </def>
      </def-item>
      <def-item>
        <term>STR</term>
        <def>
          <p id="Par7">Short tandem repeats</p>
        </def>
      </def-item>
      <def-item>
        <term>LD</term>
        <def>
          <p id="Par8">Linkage disequilibrium</p>
        </def>
      </def-item>
      <def-item>
        <term>K</term>
        <def>
          <p id="Par9">The number of heterozygous loci</p>
        </def>
      </def-item>
      <def-item>
        <term>X</term>
        <def>
          <p id="Par10">The number of shared alleles</p>
        </def>
      </def-item>
      <def-item>
        <term>CRAN</term>
        <def>
          <p id="Par11">The R package mixIndependR<italic>,</italic> is available on the Comprehensive R Archive Network</p>
        </def>
      </def-item>
      <def-item>
        <term>CODIS</term>
        <def>
          <p id="Par12">The combined DNA Index System</p>
        </def>
      </def-item>
      <def-item>
        <term>CEU</term>
        <def>
          <p id="Par13">Northern and Western Europe</p>
        </def>
      </def-item>
      <def-item>
        <term>JPT</term>
        <def>
          <p id="Par14">Japanese from Tokyo</p>
        </def>
      </def-item>
      <def-item>
        <term>HCB</term>
        <def>
          <p id="Par15">Han Chinese from Beijing</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary Information</title>
    <p>The online version contains supplementary material available at 10.1186/s12859-020-03945-0.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This paper is dedicated to the memory of Dr. Ranajit Chakraborty, who conceived of the original idea of this project. BS would like to express my deep gratitude to Professor Chakraborty for his supervision at the very start of this project. BS would like to express my great appreciation to Professor Shande Chen, Dr. Zhengyang Zhou and Dr. Allison Mann for their instructive and contributive suggestions about biostatistics and software. BS would like to thank Dr. Kaili Liu, Danfeng Chen, M.S., and Bingchun Wan, M.S. for their contribution of running scripts. Besides, BS would like to thank Mr. Peter Mosley for his contributive grammar support and great patience.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>BS developed this method, wrote the software, performed the analysis and the manuscript. AW instructed BS in data simulation and bioinformatics, and inspired BS with the methods of power test. JP supervised the project. All authors have read and approved the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>No funding was obtained for this study.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The package is available on both CRAN: CRAN—Package mixIndependR (r-project.org) and GitHub(development version): ice4prince/mixIndependR: R Package mixIndependR (github.com) and all the data used in this project are available in “Additional Data and Material” section of GitHub: mixIndependR/Additional Data and Material at main · ice4prince/mixIndependR (github.com).</p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p id="Par83">Not applicable.</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p id="Par84">Not applicable.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par85">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Butler</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Coble</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Vallone</surname>
            <given-names>PM</given-names>
          </name>
        </person-group>
        <article-title>STRs vs. SNPs: thoughts on the future of forensic DNA testing</article-title>
        <source>Forensic Sci Med Pathol</source>
        <year>2007</year>
        <volume>3</volume>
        <issue>3</issue>
        <fpage>200</fpage>
        <lpage>205</lpage>
        <?supplied-pmid 25869164?>
        <pub-id pub-id-type="pmid">25869164</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wei</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Liao</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Xiao</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>A novel multiplex assay of SNP-STR markers for forensic purpose</article-title>
        <source>PLoS ONE</source>
        <year>2018</year>
        <volume>13</volume>
        <issue>7</issue>
        <fpage>e0200700</fpage>
        <?supplied-pmid 30020969?>
        <pub-id pub-id-type="pmid">30020969</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Mao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>HB</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>WB</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Development of a SNP-STRs multiplex for forensic identification</article-title>
        <source>Forensic Sci Int Genet Suppl Ser</source>
        <year>2015</year>
        <volume>5</volume>
        <fpage>e598</fpage>
        <lpage>e600</lpage>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edge</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Algee-Hewitt</surname>
            <given-names>BFB</given-names>
          </name>
          <name>
            <surname>Pemberton</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>JZ</given-names>
          </name>
          <name>
            <surname>Rosenberg</surname>
            <given-names>NA</given-names>
          </name>
        </person-group>
        <article-title>Linkage disequilibrium matches forensic genetic records to disjoint genomic marker sets</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2017</year>
        <volume>114</volume>
        <issue>22</issue>
        <fpage>5671</fpage>
        <lpage>5676</lpage>
        <?supplied-pmid 28507140?>
        <pub-id pub-id-type="pmid">28507140</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schulze</surname>
            <given-names>TG</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>YS</given-names>
          </name>
          <name>
            <surname>Akula</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Hennessy</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Badner</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>McInnis</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>DePaulo</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Schumacher</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cichon</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Propping</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Can long-range microsatellite data be used to predict short-range linkage disequilibrium?</article-title>
        <source>Hum Mol Genet</source>
        <year>2002</year>
        <volume>11</volume>
        <issue>12</issue>
        <fpage>1363</fpage>
        <lpage>1372</lpage>
        <?supplied-pmid 12023978?>
        <pub-id pub-id-type="pmid">12023978</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Danecek P, Schiffels S, Durbin R. Multiallelic calling model in bcftools (-m). In: June; 2014.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Levine</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gogarten</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Laurie</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Weir</surname>
            <given-names>BS</given-names>
          </name>
        </person-group>
        <article-title>A high-performance computing toolset for relatedness and principal component analysis of SNP data</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>24</issue>
        <fpage>3326</fpage>
        <lpage>3328</lpage>
        <?supplied-pmid 23060615?>
        <pub-id pub-id-type="pmid">23060615</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Weir</surname>
            <given-names>BS</given-names>
          </name>
        </person-group>
        <source>Genetic data analysis II: methods for discrete population genetic data</source>
        <year>1996</year>
        <publisher-loc>Sunderland</publisher-loc>
        <publisher-name>Sinauer Associates</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chakraborty</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>The distribution of the number of heterozygous Loci in an individual in natural populations</article-title>
        <source>Genetics</source>
        <year>1981</year>
        <volume>98</volume>
        <issue>2</issue>
        <fpage>461</fpage>
        <lpage>466</lpage>
        <?supplied-pmid 17249095?>
        <pub-id pub-id-type="pmid">17249095</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chakraborty</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Stivers</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zhong</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Budowle</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>The utility of short tandem repeat loci beyond human identification: implications for development of new DNA typing systems</article-title>
        <source>Electrophoresis</source>
        <year>1999</year>
        <volume>20</volume>
        <issue>8</issue>
        <fpage>1682</fpage>
        <lpage>1696</lpage>
        <?supplied-pmid 10435432?>
        <pub-id pub-id-type="pmid">10435432</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saini</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mitra</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Mousavi</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Fotsing</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Gymrek</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A reference haplotype panel for genome-wide imputation of short tandem repeats</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>4397</fpage>
        <?supplied-pmid 30353011?>
        <pub-id pub-id-type="pmid">30353011</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Delourme</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Falentin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fomeju</surname>
            <given-names>BF</given-names>
          </name>
          <name>
            <surname>Boillot</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lassalle</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>André</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Duarte</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gauthier</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Lucante</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Marty</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-density SNP-based genetic map development and linkage disequilibrium assessment in <italic>Brassica napus</italic> L</article-title>
        <source>BMC Genom</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>120</fpage>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Acharya</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Farmer</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Monteros</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Brummer</surname>
            <given-names>EC</given-names>
          </name>
        </person-group>
        <article-title>Development of an alfalfa SNP array and its use to evaluate patterns of population structure and linkage disequilibrium</article-title>
        <source>PLoS ONE</source>
        <year>2014</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>e84329</fpage>
        <?supplied-pmid 24416217?>
        <pub-id pub-id-type="pmid">24416217</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Danecek</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Auton</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Albers</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Banks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>DePristo</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Handsaker</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Lunter</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>GT</given-names>
          </name>
          <name>
            <surname>Sherry</surname>
            <given-names>ST</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The variant call format and VCFtools</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>15</issue>
        <fpage>2156</fpage>
        <lpage>2158</lpage>
        <?supplied-pmid 21653522?>
        <pub-id pub-id-type="pmid">21653522</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weir</surname>
            <given-names>BS</given-names>
          </name>
        </person-group>
        <article-title>Matching and partially-matching DNA profiles</article-title>
        <source>J Forensic Sci</source>
        <year>2004</year>
        <volume>49</volume>
        <issue>5</issue>
        <fpage>1009</fpage>
        <lpage>1014</lpage>
        <?supplied-pmid 15461102?>
        <pub-id pub-id-type="pmid">15461102</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Purcell</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Neale</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Todd-Brown</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ferreira</surname>
            <given-names>MAR</given-names>
          </name>
          <name>
            <surname>Bender</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Maller</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sklar</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>de Bakker</surname>
            <given-names>PIW</given-names>
          </name>
          <name>
            <surname>Daly</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PLINK: a tool set for whole-genome association and population-based linkage analyses</article-title>
        <source>Am J Hum Genet</source>
        <year>2007</year>
        <volume>81</volume>
        <issue>3</issue>
        <fpage>559</fpage>
        <lpage>575</lpage>
        <?supplied-pmid 17701901?>
        <pub-id pub-id-type="pmid">17701901</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">PLINK 1.90. <ext-link ext-link-type="uri" xlink:href="http://pngu.mgh.harvard.edu/purcell/plink/">http://pngu.mgh.harvard.edu/purcell/plink/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hudson</surname>
            <given-names>RR</given-names>
          </name>
        </person-group>
        <article-title>Generating samples under a Wright-Fisher neutral model of genetic variation</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <issue>2</issue>
        <fpage>337</fpage>
        <lpage>338</lpage>
        <?supplied-pmid 11847089?>
        <pub-id pub-id-type="pmid">11847089</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Simulates the evolution of linked and unlinked microsatellites using the coalescent. <ext-link ext-link-type="uri" xlink:href="https://github.com/mpcox/microsat">https://github.com/mpcox/microsat</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">A reference haplotype panel for genome-wide imputation of short tandem repeats. <ext-link ext-link-type="uri" xlink:href="http://gymreklab.com/2018/03/05/snpstr_imputation.html">http://gymreklab.com/2018/03/05/snpstr_imputation.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">mixIndependR: genetics and independence testing of mixed genetic panels. <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/mixIndependR/index.html">https://cran.r-project.org/web/packages/mixIndependR/index.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Song B. mixIndependR: genetics and independence testing of mixed genetic panels (Version v0.4.3). In: 2020, December 1.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gregorius</surname>
            <given-names>HR</given-names>
          </name>
        </person-group>
        <article-title>The probability of losing an allele when diploid genotypes are sampled</article-title>
        <source>Biometrics</source>
        <year>1980</year>
        <volume>36</volume>
        <issue>4</issue>
        <fpage>643</fpage>
        <lpage>652</lpage>
        <?supplied-pmid 7248433?>
        <pub-id pub-id-type="pmid">7248433</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">genetics: population genetics. <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/genetics/index.html">https://cran.r-project.org/web/packages/genetics/index.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dauber</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Bär</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Klintschar</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Neuhuber</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Parson</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Glock</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Mayr</surname>
            <given-names>WR</given-names>
          </name>
        </person-group>
        <article-title>Mutation rates at 23 different short tandem repeat loci</article-title>
        <source>Int Congr Ser</source>
        <year>2003</year>
        <volume>1239</volume>
        <fpage>565</fpage>
        <lpage>567</lpage>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tenesa</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Navarro</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Duffy</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Goddard</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Visscher</surname>
            <given-names>PM</given-names>
          </name>
        </person-group>
        <article-title>Recent human effective population size estimated from linkage disequilibrium</article-title>
        <source>Genome Res</source>
        <year>2007</year>
        <volume>17</volume>
        <issue>4</issue>
        <fpage>520</fpage>
        <lpage>526</lpage>
        <?supplied-pmid 17351134?>
        <pub-id pub-id-type="pmid">17351134</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guo</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>EA</given-names>
          </name>
        </person-group>
        <article-title>Performing the exact test of Hardy–Weinberg proportion for multiple alleles</article-title>
        <source>Biometrics</source>
        <year>1992</year>
        <volume>48</volume>
        <issue>2</issue>
        <fpage>361</fpage>
        <lpage>372</lpage>
        <?supplied-pmid 1637966?>
        <pub-id pub-id-type="pmid">1637966</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Wickham</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <source>ggplot2: elegant graphics for data analysis</source>
        <year>2016</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
  </ref-list>
</back>
