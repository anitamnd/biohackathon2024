<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6934287</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0226949</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-19-05925</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Evolutionary Processes</subject>
            <subj-group>
              <subject>Convergent Evolution</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
              <subj-group>
                <subject>Phylogenetic Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
              <subj-group>
                <subject>Phylogenetic Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
            <subj-group>
              <subject>Evolutionary Systematics</subject>
              <subj-group>
                <subject>Phylogenetics</subject>
                <subj-group>
                  <subject>Phylogenetic Analysis</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Research Assessment</subject>
          <subj-group>
            <subject>Research Errors</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Psychology</subject>
          <subj-group>
            <subject>Behavior</subject>
            <subj-group>
              <subject>Animal Behavior</subject>
              <subj-group>
                <subject>Grazing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Social Sciences</subject>
        <subj-group>
          <subject>Psychology</subject>
          <subj-group>
            <subject>Behavior</subject>
            <subj-group>
              <subject>Animal Behavior</subject>
              <subj-group>
                <subject>Grazing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Zoology</subject>
          <subj-group>
            <subject>Animal Behavior</subject>
            <subj-group>
              <subject>Grazing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
            <subj-group>
              <subject>Evolutionary Systematics</subject>
              <subj-group>
                <subject>Phylogenetics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Eukaryota</subject>
            <subj-group>
              <subject>Animals</subject>
              <subj-group>
                <subject>Vertebrates</subject>
                <subj-group>
                  <subject>Amniotes</subject>
                  <subj-group>
                    <subject>Mammals</subject>
                    <subj-group>
                      <subject>Cats</subject>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
              <subj-group>
                <subject>Animal Phylogenetics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
              <subj-group>
                <subject>Animal Phylogenetics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
            <subj-group>
              <subject>Evolutionary Systematics</subject>
              <subj-group>
                <subject>Phylogenetics</subject>
                <subj-group>
                  <subject>Animal Phylogenetics</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Zoology</subject>
          <subj-group>
            <subject>Animal Phylogenetics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Paleontology</subject>
          <subj-group>
            <subject>Paleogenetics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Earth Sciences</subject>
        <subj-group>
          <subject>Paleontology</subject>
          <subj-group>
            <subject>Paleogenetics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A new, fast method to search for morphological convergence with shape data</article-title>
      <alt-title alt-title-type="running-head">Searching for morphological convergence</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Castiglione</surname>
          <given-names>Silvia</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Serio</surname>
          <given-names>Carmela</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tamagnini</surname>
          <given-names>Davide</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Melchionna</surname>
          <given-names>Marina</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mondanaro</surname>
          <given-names>Alessandro</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Di Febbraro</surname>
          <given-names>Mirko</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Profico</surname>
          <given-names>Antonio</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Piras</surname>
          <given-names>Paolo</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff005">
          <sup>5</sup>
        </xref>
        <xref ref-type="aff" rid="aff006">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Barattolo</surname>
          <given-names>Filippo</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4593-8006</contrib-id>
        <name>
          <surname>Raia</surname>
          <given-names>Pasquale</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Dipartimento di Scienze della Terra, dell’Ambiente e delle Risorse, University of Naples Federico II, Napoli, Italy</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Dipartimento di Biologia Ambientale, Sapienza Università di Roma, Rome, Italy</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Dipartimento di Scienze della Terra, University of Florence, Firenze, Italy</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Dipartimento di Bioscienze e Territorio, University of Molise, Pesche, Isernia, Italy</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Dipartimento di Ingegneria Strutturale e Geotecnica, Sapienza Università di Roma, Rome, Italy</addr-line>
    </aff>
    <aff id="aff006">
      <label>6</label>
      <addr-line>Dipartimento di Scienze Cardiovascolari, Respiratorie, Nefrologiche, Anestesiologiche e Geriatriche, Sapienza Università di Roma, Rome, Italy</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Evans</surname>
          <given-names>Alistair Robert</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Monash University, AUSTRALIA</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>pasquale.raia@unina.it</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>14</volume>
    <issue>12</issue>
    <elocation-id>e0226949</elocation-id>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>2</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>12</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2019 Castiglione et al</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Castiglione et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0226949.pdf"/>
    <abstract>
      <p>Morphological convergence is an intensely studied macroevolutionary phenomenon. It refers to the morphological resemblance between phylogenetically distant taxa. Currently available methods to explore evolutionary convergence either: rely on the analysis of the phenotypic resemblance between sister clades as compared to their ancestor, fit different evolutionary regimes to different parts of the tree to see whether the same regime explains phenotypic evolution in phylogenetically distant clades, or assess deviations from the congruence between phylogenetic and phenotypic distances. We introduce a new test for morphological convergence working directly with non-ultrametric (i.e. paleontological) as well as ultrametric phylogenies and multivariate data. The method (developed as the function <italic>search</italic>.<italic>conv</italic> within the R package RRphylo) tests whether unrelated clades are morphologically more similar to each other than expected by their phylogenetic distance. It additionally permits using known phenotypes as the most recent common ancestors of clades, taking full advantage of fossil information. We assessed the power of <italic>search</italic>.<italic>conv</italic> and the incidence of false positives by means of simulations, and then applied it to three well-known and long-discussed cases of (purported) morphological convergence: the evolution of grazing adaptation in the mandible of ungulates with high-crowned molars, the evolution of mandibular shape in sabertooth cats, and the evolution of discrete ecomorphs among anoles of Caribbean islands. The <italic>search</italic>.<italic>conv</italic> method was found to be powerful, correctly identifying simulated cases of convergent morphological evolution in 95% of the cases. Type I error rate is as low as 4–6%. We found <italic>search</italic>.<italic>conv</italic> is some three orders of magnitude faster than a competing method for testing convergence.</p>
    </abstract>
    <funding-group>
      <funding-statement>The authors received no specific funding for this work.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="6"/>
      <table-count count="4"/>
      <page-count count="20"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All files for this study are available within the paper and its Supporting Information files and at <ext-link ext-link-type="uri" xlink:href="https://github.com/pasraia/RRphylo">https://github.com/pasraia/RRphylo</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All files for this study are available within the paper and its Supporting Information files and at <ext-link ext-link-type="uri" xlink:href="https://github.com/pasraia/RRphylo">https://github.com/pasraia/RRphylo</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>A species’ phenotype depends on its ancestral state and the responses to selection or drift it experiences since that state. Selection towards similar optima in different parts of a tree (which could be described by the Ornstein–Uhlenbeck (OU) mode of evolution [<xref rid="pone.0226949.ref001" ref-type="bibr">1</xref>,<xref rid="pone.0226949.ref002" ref-type="bibr">2</xref>]) generates a pattern of evolutionary convergence [<xref rid="pone.0226949.ref003" ref-type="bibr">3</xref>–<xref rid="pone.0226949.ref006" ref-type="bibr">6</xref>]. Convergence is an intensely studied macroevolutionary pattern [<xref rid="pone.0226949.ref007" ref-type="bibr">7</xref>–<xref rid="pone.0226949.ref011" ref-type="bibr">11</xref>]. Evolutionary convergence is often invoked to explain instances of morphological resemblance between phylogenetically distant clades. Well-known examples include the evolution of wings in bats and birds [<xref rid="pone.0226949.ref012" ref-type="bibr">12</xref>,<xref rid="pone.0226949.ref013" ref-type="bibr">13</xref>], neck elongation in sauropods and giraffes [<xref rid="pone.0226949.ref014" ref-type="bibr">14</xref>], bone cracking ability in percrocutids, borophagine canids and hyaenids [<xref rid="pone.0226949.ref015" ref-type="bibr">15</xref>], hypsodont molars in grazing ‘ungulates’ [<xref rid="pone.0226949.ref016" ref-type="bibr">16</xref>,<xref rid="pone.0226949.ref017" ref-type="bibr">17</xref>], or the repeated occupation of specific ecomorphs by unrelated <italic>Anolis</italic> species in different Caribbean islands [<xref rid="pone.0226949.ref018" ref-type="bibr">18</xref>,<xref rid="pone.0226949.ref019" ref-type="bibr">19</xref>]. Examples of repeated convergence within a clade, known as iterative evolution, include the evolution of trenchant-heeled lower molar talonids in several canid lineages [<xref rid="pone.0226949.ref012" ref-type="bibr">12</xref>] and elongated and laterally-compressed upper canines within the cat family, Felidae [<xref rid="pone.0226949.ref020" ref-type="bibr">20</xref>]. This by no means exhaustive list just represents a brief account of a diffuse, widely occurring evolutionary pattern [<xref rid="pone.0226949.ref021" ref-type="bibr">21</xref>].</p>
    <p>Current methods to address patterns of morphological convergence [<xref rid="pone.0226949.ref022" ref-type="bibr">22</xref>] rely on either: i) the phenotypic analysis of groups of species falling in some pre-selected state (i.e. qualitative categorization) as compared to their ancestors [<xref rid="pone.0226949.ref023" ref-type="bibr">23</xref>]; ii) fitting several OU models to different clades in the phylogenetic tree to see if they evolve towards the same peak (i.e. whether distant clades can be statistically collapsed under a common evolutionary regime [<xref rid="pone.0226949.ref024" ref-type="bibr">24</xref>]); iii) assessing the congruence between phylogenetic and phenotypic distances [<xref rid="pone.0226949.ref018" ref-type="bibr">18</xref>,<xref rid="pone.0226949.ref025" ref-type="bibr">25</xref>] or iv) studying the trajectory of phenotypic change across multiple evolutionary levels [<xref rid="pone.0226949.ref026" ref-type="bibr">26</xref>]. All these methods have advantages and shortcomings. For instance, the comparison of phenotypic to phylogenetic distance matrices may reveal departures from the expected association between the two for reasons other than convergence [<xref rid="pone.0226949.ref006" ref-type="bibr">6</xref>]. Methods based on selective regimes are strongly affected by trait dimensionality and independence [<xref rid="pone.0226949.ref027" ref-type="bibr">27</xref>] and are unsuited to investigate the evolutionary ‘history’ of convergence [<xref rid="pone.0226949.ref010" ref-type="bibr">10</xref>]. Metrics that necessarily require pre-selected states are strongly influenced by cases of uncertain categorization and by the choice of states. A few methods address convergence by assuming that a certain biological mechanism underpins the pattern [<xref rid="pone.0226949.ref003" ref-type="bibr">3</xref>]. Such methods cannot explain convergence that is not produced by directional processes, and are therefore inadvisable [<xref rid="pone.0226949.ref022" ref-type="bibr">22</xref>].</p>
    <p>Here, we present a new method (available as the function <italic>search</italic>.<italic>conv</italic> in the R package RRphylo) which assesses convergence by testing whether phenotypes in distant clades in a phylogenetic tree are more similar to each other than expected by chance. The method works by computing the angle between the phenotypic vectors of the species as a measure of their similarity and allows identification of the clades (rather than just the species) that converge. We show through simulations that <italic>search</italic>.<italic>conv</italic> is remarkably powerful and fast. It does not require the convergent clades to be phenotypically unusual as compared to the rest of the tree. In addition, it has low (ca. 5%) Type I error rates (false positives).</p>
    <p>We apply <italic>search</italic>.<italic>conv</italic> to three well-supported cases of morphological convergence, namely the independent adaptation to grazing in perissodactyl and artiodactyl mandibles, the evolution of the sabertooth morphology in machairodont cats and barbourofelids, and the evolution of distinct ecomorphs by Caribbean <italic>Anolis</italic>. The <italic>seach</italic>.<italic>conv</italic> function together with example files is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/pasraia/RRphylo">https://github.com/pasraia/RRphylo</ext-link>.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and methods</title>
    <p>The method is based on phylogenetic ridge regression, <italic>RRphylo</italic> [<xref rid="pone.0226949.ref028" ref-type="bibr">28</xref>]. With <italic>RRphylo</italic>, the phenotypic change between a node and a daughter tip along a phyletic line is described by the sum of individual contributions at each consecutive branch according to the equation <inline-formula id="pone.0226949.e001"><alternatives><graphic xlink:href="pone.0226949.e001.jpg" id="pone.0226949.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mrow><mml:mo>Δ</mml:mo><mml:mtext>y</mml:mtext><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mn mathvariant="italic">1</mml:mn></mml:msub><mml:msub><mml:mi mathvariant="italic">l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mn mathvariant="italic">2</mml:mn></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mn mathvariant="italic">2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>…</mml:mo><mml:mo>.</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> where <italic>n</italic> equals the number of branches intervening between the node and the tip, <inline-formula id="pone.0226949.e002"><alternatives><graphic xlink:href="pone.0226949.e002.jpg" id="pone.0226949.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mn mathvariant="italic">1</mml:mn></mml:msub><mml:msub><mml:mrow/><mml:mrow><mml:mo>…</mml:mo><mml:mo>.</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> are the vectors of regression coefficients (the evolutionary rates) at each branch, and <italic>l</italic><sub><italic>1…n</italic></sub> are the branch lengths. Regression coefficients are computed simultaneously for all the branches in the tree and independently for each variable (in the case of multivariate data), by applying to each of them a normalization factor λ which avoids fitting extreme <italic>β</italic> values and prevents multicollinearity [<xref rid="pone.0226949.ref029" ref-type="bibr">29</xref>].</p>
    <p>Dealing with multivariate data, each species at the tree tips is represented by a phenotypic vector, including one entry value for each variable. Naming <bold>A</bold> and <bold>B</bold> the phenotypic vectors of a given pair of species in the tree, the angle θ between them is computed as the inverse cosine of the ratio between the dot product of <bold>A</bold> and <bold>B</bold>, and the product of vectors sizes:
<disp-formula id="pone.0226949.e003"><alternatives><graphic xlink:href="pone.0226949.e003.jpg" id="pone.0226949.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mo>θ</mml:mo><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mfrac><mml:mrow><mml:mi>A</mml:mi><mml:mo>•</mml:mo><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:math></alternatives></disp-formula></p>
    <p>The cosine of angle θ actually represents the correlation coefficient between the two vectors [<xref rid="pone.0226949.ref030" ref-type="bibr">30</xref>]. As such, it exemplifies a measure of phenotypic resemblance [<xref rid="pone.0226949.ref026" ref-type="bibr">26</xref>]. Possible θ values span from 0 to 180 degrees. Small angles (i.e. close to 0°) imply similar phenotypes. At around 90° the phenotypes are dissimilar, whereas towards 180° the two phenotypic vectors point in opposing directions (i.e. the two phenotypes have contrasting values for each variable). For a phenotype with <italic>n</italic> variables, the two vectors intersect at a vector of <italic>n</italic> zeros (the origin of the axes in the 3D plot produced by using the <xref ref-type="supplementary-material" rid="pone.0226949.s001">S1 File</xref>). However, it is important to note that with geometric morphometric data (PC scores) the origin coincides with the consensus shape (where all PC scores are 0), so that, for instance, a large θ indicates the two species diverge from the consensus in opposite directions and the phenotypic vectors can be visualized in the PC space (<xref ref-type="supplementary-material" rid="pone.0226949.s001">S1 File</xref>).</p>
    <p>Under the Brownian Motion (BM) model of evolution, the phenotypic dissimilarity between any two species in the tree (hence the θ angle between them) is expected to be proportional to the age of their most recent common ancestor. Under convergence, this expectation is violated and the angle between species should be shallower than expected by their phylogenetic distance (see <xref ref-type="supplementary-material" rid="pone.0226949.s001">S1 File</xref>, selecting either ‘convergence’ or ‘convergence from similar ancestors’). We developed a new R function, <italic>search</italic>.<italic>conv</italic>, specifically meant to calculate θ values and to test whether actual θs between groups of species are smaller than expected by their phylogenetic distance. The function tests for convergence in either entire clades or species grouped under different evolutionary ‘states’ (<xref ref-type="fig" rid="pone.0226949.g001">Fig 1</xref>).</p>
    <fig id="pone.0226949.g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0226949.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <title>Hypothetical example illustrating how the <italic>search</italic>.<italic>conv</italic> function algorithm works.</title>
        <p>In the clade case (A), given any two monophyletic clades in the tree, the mean angle averaged over all possible combinations of two species (one per clade) is computed. This θ<sub>real</sub> angle is divided by the distance between the most recent common ancestors to the respective clades, mrca1 and mrca2. Significance is assessed by comparing the result of this procedure to 1,000 randomly generated angles θ<sub>random</sub> computed between species extracted by chance from the tree, divided by their respective distances. Angles are further computed between phenotypes at the mrcas. These θ<sub>ace</sub> angles are summed to the corresponding θ<sub>real</sub> to test whether convergence was already present at the beginning of clade history. Ancestral phenotypes are either estimated by <italic>RRphylo</italic> or provided by the user according to the fossil record. In the state case (B), θ<sub>real</sub> are computed as in the clade case, but taking the mean angle between each combination of pairs of species (taken one per state), divided by their distance.</p>
      </caption>
      <graphic xlink:href="pone.0226949.g001"/>
    </fig>
    <p>Given two monophyletic clades (subtrees) <bold>C1</bold> and <bold>C2</bold>, <italic>search</italic>.<italic>conv</italic> computes the mean angle θ<sub>real</sub> over all possible combinations of pairs of species taking one species per clade. This θ<sub>real</sub> is divided by the patristic (i.e. the sum of branch lengths) distance between the most recent common ancestors (mrcas) to <bold>C1</bold> and <bold>C2</bold>, <bold>mrcaC1</bold> and <bold>mrcaC2</bold>, respectively (<xref ref-type="fig" rid="pone.0226949.g001">Fig 1</xref>), to account for the fact that the mean angle (hence the phenotypic distance) is expected to increase, on average, with phylogenetic distance (<xref ref-type="fig" rid="pone.0226949.g002">Fig 2</xref>). To assess significance, <italic>search</italic>.<italic>conv</italic> randomly takes a pair of tips from the tree (<italic>t1</italic> and <italic>t2</italic>), computes the angle θ<sub>random</sub> between their phenotypes and divides θ<sub>random</sub> by the distance between <italic>t1</italic> and <italic>t2</italic> respective immediate ancestors (i.e. the distance between the first node <italic>N1</italic> above <italic>t1</italic>, and the first node <italic>N2</italic> above <italic>t2</italic>). This procedure is repeated 1,000 times generating θ<sub>random</sub> per unit time values, directly from the tree and data. The θ<sub>random</sub> per unit time distribution is used to test whether θ<sub>real</sub> divided by the distance between <bold>mrcaC1</bold> and <bold>mrcaC2</bold> is statistically significant, meaning it is smaller than 5% of θ<sub>random</sub> values the two clades are said to converge.</p>
    <fig id="pone.0226949.g002" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0226949.g002</object-id>
      <label>Fig 2</label>
      <caption>
        <title>Plot of angles between phenotypic vectors versus time distance.</title>
        <p>The increase in the mean angle between the phenotypic vectors of all species pairs in the tree θ<sub>tips</sub> and the distance between the species (left). The sum of θ<sub>tips</sub> plus the angle between the phenotypes estimated at the first node above each tip θ<sub>ace</sub> plotted against the distance between these nodes (right). The phenotype was generated according to the Brownian Motion model of evolution with sigma2 (the Browian rate) = 1. The tree is 100 species wide.</p>
      </caption>
      <graphic xlink:href="pone.0226949.g002"/>
    </fig>
    <p>When testing convergence, researchers typically have species phenotypes and, ideally, a phylogenetic tree representing their relationships. This means that while it is usually possible to test convergence among species, it is generally not possible to identify entire clades evolving under convergence. In the real world, these clades actually coincide with <bold>mrcaC1</bold> and <bold>mrcaC2</bold> and their descendants. In <italic>seach</italic>.<italic>conv</italic>, we devised a strategy to identify <bold>mrcaC1</bold> and <bold>mrcaC2</bold>. In practice, given a pair of candidate nodes tested for the initiation of convergence, the phenotypes at <bold>mrcaC1</bold> and <bold>mrcaC2</bold> are estimated by <italic>RRphylo</italic>, and the angle between the ancestral states (θ<sub>ace</sub>) is calculated (see the angle between mrcas produced by using the <xref ref-type="supplementary-material" rid="pone.0226949.s001">S1 File</xref>). Then, θ<sub>ace</sub> is added to θ<sub>real</sub> and the resulting sum divided by the distance between <bold>mrcaC1</bold> and <bold>mrcaC2</bold>. The sum θ<sub>ace</sub> + θ<sub>real</sub> should be small for clades evolving from similar ancestors towards similar daughter phenotypes (see the average angle between tips, ‘mean.dir’, produced by using the <xref ref-type="supplementary-material" rid="pone.0226949.s001">S1 File</xref>). Importantly, a small θ<sub>ace</sub> means similar phenotypes at the mrcas of the two clades, whereas a small θ<sub>real</sub> implies similar phenotypes between their descendants. It does not mean, though, that the mrcas have to be similar to their own descendants. Two clades might, in principle, start with certain phenotypes and both evolve towards a similar phenotype which is different from the initial shape. This means that the two clades literally evolve along parallel trajectories (<xref ref-type="supplementary-material" rid="pone.0226949.s001">S1 File</xref>, select the option ‘convergence from similar ancestors’). Under <italic>search</italic>.<italic>conv</italic>, simple convergence is distinguished by such instances of convergence with parallel evolution. The former is tested by looking at the significance of θ<sub>real</sub>. The latter is assessed by testing whether the quantity θ<sub>ace</sub> + θ<sub>real</sub> is small (at alpha = 0.05) compared to the distribution of the same quantity generated by summing the θ<sub>random</sub> calculated for each randomly selected pair of species <italic>t1</italic> and <italic>t2</italic> plus the angle between the phenotypic estimates at their respective ancestors <italic>N1</italic> and <italic>N2</italic> divided by their distance.</p>
    <p>As with many other methods concerned with testing convergence (e.g. [<xref rid="pone.0226949.ref010" ref-type="bibr">10</xref>,<xref rid="pone.0226949.ref018" ref-type="bibr">18</xref>,<xref rid="pone.0226949.ref031" ref-type="bibr">31</xref>]), the <italic>seach</italic>.<italic>conv</italic> function suffers from the problem that ancestral states estimation entirely depends on the phylogenetic tree and data at hand and the evolutionary model used to fit the states. To help addressing this issue, under <italic>search</italic>.<italic>conv</italic> phenotypes at the nodes can be indicated directly by the user, when there is a specific hypothesis (i.e. real fossil specimens) about the phenotype of the most recent common ancestor to the clades. This is useful since the inclusion of fossil information increases power and reliability of comparative analyses of trait evolution [<xref rid="pone.0226949.ref032" ref-type="bibr">32</xref>,<xref rid="pone.0226949.ref033" ref-type="bibr">33</xref>].</p>
    <p>Under <italic>search</italic>.<italic>conv</italic>, instances of convergence may be either assessed under the ‘automatic mode’ or specifying candidate node pairs. By default, <italic>search</italic>.<italic>conv</italic> runs the former, testing all clade pairs which are at least as distant as a one tenth of the tree size, counted as the number of nodes between their most recent common ancestors (i.e. clades 10 nodes apart for a 100 species tree). Alternatively, a time, rather than number of nodes, distance could be specified (we illustrate this procedure in the supplementary information and demonstrate via simulations how robust this alternative is). Although any minimum distance can be specified, it must be reminded that by testing too many node pairs at once potentially introduces Type I error inflation. We empirically found that this just becomes a problem by testing very small clades in very large trees. With the default option (i.e. nodes that are at least as distant as a one tenth of the tree size) Type I error inflation is negligible. As detailed below, we assessed the effect of phylogenetic distance on <italic>search</italic>.<italic>conv</italic> Type I and Type II error rates. Our expectation is that the closer the clades are on the tree, the harder it becomes to find convergence, as phenotypic similarity is best explained in this case by phylogenetic proximity.</p>
    <p>Several candidate node pairs could map on the same region of the tree, because phenotypic values in close nodes are strongly autocorrelated (for instance, a candidate node pair could be represented by nodes n1 and n2, and another by the pair of nodes immediately bracketing n1 and n2). For each candidate node pair representing a statistically significant signal for convergence, <italic>search</italic>.<italic>conv</italic> performs the analysis of multivariate homogeneity of group dispersions by using the function <italic>betadisper</italic> in the R package vegan [<xref rid="pone.0226949.ref034" ref-type="bibr">34</xref>], calculates the average distance from group centroids for individual species in the clades, and orders candidate and significant node pairs (if they are &gt; 1 in number) from the least variable to the most. The rationale is that under convergent evolution, species phenotypes are expected to deviate the least from group centroids, at least when the convergent states represent evolutionary attractors [<xref rid="pone.0226949.ref001" ref-type="bibr">1</xref>,<xref rid="pone.0226949.ref002" ref-type="bibr">2</xref>].</p>
    <p>The clade-wise approach we have described so far ignores instances of phenotypic convergence that occur at the level of species rather than clades. The <italic>search</italic>.<italic>conv</italic> function is also designed to deal with this case. To do that, the user must specify distinctive ‘states’ for the species presumed to converge. The function will test convergence between any pair of given states. The species ascribed to a given state may belong anywhere on the tree or be grouped in two separate regions of it, in which case two states are indicated, one for each region. The former design facilitates testing questions such as whether all hypsodont ungulates converge on similar shapes, while latter aids in testing questions such as whether hypsodont artiodactyls converge on hypsodont perissodactyls.</p>
    <p>If provided with such ‘states’ <italic>search</italic>.<italic>conv</italic> will calculate the mean θ<sub>real</sub> between all possible species pairs evolving under a given state (or between the species in the two states presumed to converge on each other). The θ<sub>random</sub> angles are calculated by shuffling the states 1,000 times across the tree tips. Both θ<sub>real</sub> and individual θ<sub>random</sub> are divided by the distance between the respective tips.</p>
    <sec id="sec003">
      <title>Testing <italic>search</italic>.<italic>conv</italic> on convergence generated by unknown evolutionary processes</title>
      <p>We assessed the power of <italic>search</italic>.<italic>conv</italic> using both simulation experiments and real cases. The first set of simulations reproduces the existence of phenotypically similar clades or species in distant regions of the tree. This corresponds to the traditional observation of entire clades converging towards similar ecomorphologies (e.g. adaptation to durophagy in the mandible and skull of borophagine canids and modern hyaenids, body shape in ichthyosaurs and dolphins).</p>
      <p>We started by generating a paleontological (i.e. non ultrametric) tree with at least 80 species, by using the function <italic>sim</italic>.<italic>bdtree</italic> in the R package geiger (we set birth and death rates at 0.5 and 0.2, respectively [<xref rid="pone.0226949.ref035" ref-type="bibr">35</xref>]). Then, we produced a set of phenotypic data for the tree composed of three uncorrelated variables generated according to the BM model of evolution with variance (the Brownian rate) = 1, using the function <italic>fastBM</italic> in the R package phytools [<xref rid="pone.0226949.ref036" ref-type="bibr">36</xref>].</p>
      <sec id="sec004">
        <title>Clade case</title>
        <p>To test for convergence between entire clades, our strategy was to select, duplicate, modify, and eventually attach a given clade and its phenotypes to the tree. First, we randomly selected a given subtree <bold><italic>s</italic></bold>. Then, we changed its topology and branch lengths as to produce a new subtree <bold><italic>s’</italic></bold>. The phenotypes in <bold><italic>s’</italic></bold> are similar but not the same as in <bold><italic>s</italic></bold>. Eventually, <bold><italic>s’</italic></bold> and its phenotypes are grafted to a target node on the tree being at least as distant from <bold><italic>s</italic></bold> as one tenth of the tree nodes (<xref ref-type="fig" rid="pone.0226949.g003">Fig 3</xref>). Since the two subtrees have similar phenotypes in spite of being phylogenetically distant, they should be found to converge on each other.</p>
        <fig id="pone.0226949.g003" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0226949.g003</object-id>
          <label>Fig 3</label>
          <caption>
            <title>The procedure used to simulate convergence.</title>
            <p>Clades set to converge are colored. The focal clade (<bold><italic>s</italic></bold>) is indicated in bright pink, the modified clade (<bold><italic>s’</italic></bold> dark pink) is grafted at the target node indicated by the dark pink dot.</p>
          </caption>
          <graphic xlink:href="pone.0226949.g003"/>
        </fig>
        <p>To accomplish this procedure, we started by selecting <bold><italic>s</italic></bold> from within the tree among clades having as many as one tenth to one quarter of the tree tips. We deliberately avoided considering subtrees that are too young (i.e. more than 80% of the tree height in terms of distance from the root) given they would represent an unrealistic case of clades which have had very little time to evolve any convergence (<xref ref-type="fig" rid="pone.0226949.g003">Fig 3</xref>).</p>
        <p>After modifying <bold><italic>s</italic></bold> to produce <bold><italic>s’</italic></bold>, we assigned to their species phenotypes which are similar to each other and different from the rest of the tree, in order to avoid the new tree phenotype representing BM (which predicts no convergence). To produce the new phenotypes for <bold><italic>s</italic></bold> and <bold><italic>s’</italic></bold>, we took the maximum value of each original variable (thereby creating a vector of maxima <inline-formula id="pone.0226949.e004"><alternatives><graphic xlink:href="pone.0226949.e004.jpg" id="pone.0226949.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula>) and multiplied <inline-formula id="pone.0226949.e005"><alternatives><graphic xlink:href="pone.0226949.e005.jpg" id="pone.0226949.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> by a random factor <italic>f</italic> ranging from 0.5 to 2 to generate a new vector <inline-formula id="pone.0226949.e006"><alternatives><graphic xlink:href="pone.0226949.e006.jpg" id="pone.0226949.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mover accent="true"><mml:mrow><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. Then, for each subclade (<bold><italic>s</italic></bold> and <bold><italic>s’</italic></bold>) we produced a number <italic>n</italic> of phenotypes as long as the number of species of each subclade, using the function <italic>jitter</italic> in R. The variables in the new <bold><italic>s</italic></bold> and <bold><italic>s’</italic></bold> phenotypes were thus designed to have means equal to <inline-formula id="pone.0226949.e007"><alternatives><graphic xlink:href="pone.0226949.e007.jpg" id="pone.0226949.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mover accent="true"><mml:mrow><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and standard deviations equal to the standard deviations of the original variables.</p>
        <p>With <italic>f</italic> &gt; 1 the new phenotypes lay outside the range of the original, BM phenotypes, and the converse with <italic>f</italic> &lt; 1. Thereby, we checked how ‘extreme’ the phenotypic values in <bold><italic>s</italic></bold> and <bold><italic>s’</italic></bold> have to be for <italic>search</italic>.<italic>conv</italic> to detect convergence (see <xref ref-type="fig" rid="pone.0226949.g004">Fig 4</xref>). Before attaching <bold><italic>s’</italic></bold> to the target node, we also dropped two species at random from the subtree and changed its topology and branch lengths by applying the function <italic>swapONE</italic> in RRphylo. By default, this function changes the topology for half of the tree tips and the length of half of the branch lengths (<xref ref-type="fig" rid="pone.0226949.g003">Fig 3</xref>). Eventually, the new subtree was rescaled on the height of the clade subtended by the target node (i.e. the maximum distance of its tips from the tree root equals the same distance for tips descending from the new node) so that both <bold><italic>s</italic></bold> and <bold><italic>s</italic></bold>’ will terminate at the same distance from the root but will have very different heights (<xref ref-type="fig" rid="pone.0226949.g003">Fig 3</xref>).</p>
        <fig id="pone.0226949.g004" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0226949.g004</object-id>
          <label>Fig 4</label>
          <caption>
            <title>The effect of phenotypic similarity between clades set to converge and the rest of the tree phenotypes on <italic>seach</italic>.<italic>conv</italic> power.</title>
            <p>In each panel the PC1/PC2 plot of the tree phenotypes are reported. Clades set to converge are indicated by colored convex hulls. Upper row, clade case. Ancestral phenotypes (mrca<italic>s</italic>) of the clades set to converge are indicated by an asterisk. Large colored dots represent the mean phenotypes (group centroids) of the clades set to converge. A modified traitgram plot is added to the lower right corner in each figure, with branches belonging to the clades set to converge highlighted in color. Lower row, species belonging to states set to converge are indicated by colored convex hulls (<italic>0</italic> = background states, <italic>1</italic> and <italic>2</italic> are the states set to converge). To the lower right corner of the quadrants the circular plot reports the mean angle between states (blue lines) and the range of random angles (gray shaded area). The p-value for the convergence test is printed within the circular plots. The <italic>f</italic> values used to simulate the convergent clades are (from the left to the right): 0.2, 0.4 and 0.8.</p>
          </caption>
          <graphic xlink:href="pone.0226949.g004"/>
        </fig>
        <p>In sum, the two clades set to converge have different topologies, branch lengths, ages and number of tips, only superficial phenotypic resemblance to each other, and may actually be very similar (phenotypically) to other clades in the tree (with <italic>f</italic> &lt; 1, see Figs <xref ref-type="fig" rid="pone.0226949.g003">3</xref> and <xref ref-type="fig" rid="pone.0226949.g004">4</xref>). While the distribution of phenotypes of the new tree departs from the BM expectation (which would violate the basic premise for convergent evolution) we deliberately produced phenotypes which are not too different from the rest of the tree phenotypes, to avoid testing <italic>search</italic>.<italic>conv</italic> with unrealistic or too obvious cases of convergence (see ref. [<xref rid="pone.0226949.ref022" ref-type="bibr">22</xref>] for a similar approach).</p>
        <p>We performed <italic>search</italic>.<italic>conv</italic> on the tree and the attached phenotypic variables both by testing for convergence between all possible combinations of nodes (having proper size and distance) in the tree (the automatic mode) or by indicating target nodes (the specified clades mode). The entire procedure was repeated reducing the distance between convergent clades at three nodes only. In this latter case, the power of <italic>search</italic>.<italic>conv</italic> is expected to decrease because the phenotypic similarity between clades so close to each other is best explained by phylogenetic proximity rather than by phenotypic convergence. To assess the Type I error rates (i.e. the incidence of false positive instances of convergence found by <italic>search</italic>.<italic>conv</italic> when in fact there is none) we repeated the same procedure described above to modify the tree topology and branch lengths, and generated on this modified tree a BM phenotype. This way, no convergence is expected to occur between <bold><italic>s</italic></bold> and <bold><italic>s’</italic></bold> or anywhere else in the tree. The complete set of analyses was reiterated 100 times (i.e. for 100 different trees and phenotypes once to assess Type II and then again to assess Type I error rates).</p>
        <p>We repeated the analyses to test the performance of <italic>search</italic>.<italic>conv</italic> with phenotypic variables generated by a non-BM process. To this aim, we rescaled the original tree in accordance with four different evolutionary models (“kappa”, “delta”, “lambda”, and “trend”) by using the function <italic>rescale</italic>.<italic>phylo</italic> in the package geiger [<xref rid="pone.0226949.ref035" ref-type="bibr">35</xref>]. The rescaled trees were used to produce multivariate phenotypes (formed by three variables each) generated according to these evolutionary models and then attached to the original (unscaled) tree. A fifth multivariate trait was generated according to the “drift” model (i.e. having a trend in the phenotypic mean over time) by using the function <italic>setBM</italic> in RRphylo. The procedure was repeated 25 times for each model by sampling model parameters (kappa ranging between 0 and 1, delta ranging between 0.1 and 3, lambda ranging between 0.1 and 1, trend ranging between -0.01 and 0.01, and drift with ds ranging between 0 and 1) at each repetition.</p>
        <p>We checked whether the target subtrees are too similar to each other as compared to any other pair of clades in the tree, which would make the test look unreliably powerful and the simulation conditions naive. To this aim, we ran <italic>RRphylo</italic> on the modified tree and phenotype in order to estimate the ancestral phenotypes. Then, we calculated the multivariate Euclidean distance between all the ancestral phenotypes in the tree, to check whether the morphological distance between the two target (i.e. converging) nodes (<bold><italic>s</italic></bold> and <bold><italic>s’</italic></bold>) fell within the 95% confidence interval of the internode phenotypic distances. The entire procedure was repeated 100 times. At each repetition, we searched for cases of statistically significant convergence between all the nodes in the tree at least as distant from each other as the target nodes.</p>
      </sec>
      <sec id="sec005">
        <title>State case</title>
        <p>To test for convergence among groups of species evolving under a single state, we randomly sampled a subgroup including up to one tenth of the number of species in the tree and set it to evolve under a given state. Species in this subgroup were then given new phenotypic values by applying the same procedure as described in the ‘clade’ case.</p>
        <p>Similarly, to test for convergence between states, we repeated the procedure for two subgroups, set to converge morphologically on each other (<xref ref-type="fig" rid="pone.0226949.g001">Fig 1</xref>). Species in these subgroups were given new phenotypic values as we described in the ‘clade’ case. Yet, one of the two groups’ phenotypes were given twice the standard deviation as the original phenotype. The phenotypes thus fell into three different states: “background state” is the background state produced under BM, “state 1” and “state 2” are the states set to converge (<xref ref-type="fig" rid="pone.0226949.g001">Fig 1</xref>). The entire procedure was repeated 100 times.</p>
      </sec>
    </sec>
    <sec id="sec006">
      <title>Testing <italic>search</italic>.<italic>conv</italic> on convergence generated by known evolutionary processes</title>
      <p>The simulation sets described so far assume a pattern-based recognition of convergence, assessing whether phenotypically similar yet phylogenetically distant clades or species do represent convergent evolution regardless of the process generating convergence (see Supplementary <xref ref-type="supplementary-material" rid="pone.0226949.s004">S4 File</xref> for the R code). Two additional simulation sets address the power of <italic>search</italic>.<italic>conv</italic> to identify convergence by using an explicit process. We used Stayton’s [<xref rid="pone.0226949.ref022" ref-type="bibr">22</xref>] simulation design to this goal. In keeping with this, we started by using the function <italic>sim</italic>.<italic>bd</italic>.<italic>taxa</italic> in TreeSim [<xref rid="pone.0226949.ref037" ref-type="bibr">37</xref>] fixing the number of species at 26 (we set birth and death rates at 0.5 and 0, respectively). Then, we generated ten different phenotypic vectors according to the BM model. The phenotypic variance of the ten variables follows a broken-stick distribution [<xref rid="pone.0226949.ref022" ref-type="bibr">22</xref>]. Two to ten phenotypes were selected at each repetition and attached to the tree. Three species distant no less than three nodes from one another were selected from the tree and tested for convergence. Since all variables were generated under BM, no issue of convergence should be found by <italic>search</italic>.<italic>conv</italic>. Hence, this simulation set provides an assessment of <italic>search</italic>.<italic>conv</italic> Type I error rate. A second simulation set was applied to assess Type II error rate, still replicating Stayton’s procedure [<xref rid="pone.0226949.ref022" ref-type="bibr">22</xref>]. At this time, after producing the original, BM phenotypes as described above, three different lineages within the tree were randomly selected to evolve towards a common phenotype according to the OU process, with alpha (the strength of selection) randomly varying between 1 and 50 and theta (the phenotypic attractor) being 1.25 times the maximum values of the original BM phenotype. Both procedures were ran 1,000 times and the number of false positive and false negative instances provided by <italic>search</italic>.<italic>conv</italic> were recorded. Within the supplementary information, we illustrate these same simulations performed by using a time distance (rather than number of nodes distance) criterion (File S3).</p>
    </sec>
    <sec id="sec007">
      <title>Real cases</title>
      <p>We tested three real cases for possible instances of morphological convergence. They represent well-supported instances of morphological convergence during the evolution of the mammalian mandible (cases 1–2) and the colonization of the Caribbean islands by the lizard genus <italic>Anolis</italic> (case 3).</p>
      <p>The first case concerns felids. Felids fall in two major ecotypes. Pantherine and feline cats possess robust, conical upper canines. A second ecotype was present in two extinct clades within the cat family, i.e. machairodonts and barbourofelids. The latter is the sister group to true felids. Machairodonts include three tribes [<xref rid="pone.0226949.ref038" ref-type="bibr">38</xref>], one with short and not particularly flattened upper canines, the Metailurini, a second with long, flattened upper canines often possessing crenulated margins, the Homotheriini, and a last tribe with exceptionally long, extremely flat upper canines with smooth margins, the Smilodontini. Smilodontini are the sister clade to Metailurini. Both Homotheriini and Smilodontini are “true” sabertooths [<xref rid="pone.0226949.ref039" ref-type="bibr">39</xref>]. The true sabertooth cats and barbourofelids present highly derived mandibular morphologies, specialized to confer these cats their unique killing behavior, including reduced dentition, low coronoid and condyle processes and protruding incisors [<xref rid="pone.0226949.ref020" ref-type="bibr">20</xref>]. We tested whether mandibular shape in the extinct sabertooth cat clade Machairodontini converges on mandibular shape in Barbourofelidae (the sister clade to all felids which is usually referred to as ‘false’ sabertooth cats). We used geometric morphometric data and the tree published in Piras et al. [<xref rid="pone.0226949.ref038" ref-type="bibr">38</xref>]. The geometric morphometrics data included 83 species and 711 specimens, and we chose 10 landmarks and 23 semi-landmarks to record the mandibular shape (<xref ref-type="supplementary-material" rid="pone.0226949.s003">S3 File</xref>). We used the first 15 eigenvectors to represent 95% of the cumulative shape variance explained. We ran this experiment with the ‘automatic’ procedure of <italic>search</italic>.<italic>conv</italic> (i.e. without specifying which clades to be tested).</p>
      <p>We further explored the potential effect of specifying ancestral states in finding morphological convergence by applying <italic>search</italic>.<italic>conv</italic>. To this aim, we repeated the analysis by setting the ancestral mandibular phenotype of barbourofelids and machairodonts to be equal to <italic>Barbourofelis fricki</italic> and <italic>Smilodon fatalis</italic>, respectively.</p>
      <p>We compared <italic>seach</italic>.<italic>conv</italic> to an existing method sought to address morphological convergence embedded in the R package convevol [<xref rid="pone.0226949.ref040" ref-type="bibr">40</xref>]. To this aim, we performed both <italic>search</italic>.<italic>conv</italic> (under the ‘state’ condition) and <italic>convratsig</italic> [<xref rid="pone.0226949.ref040" ref-type="bibr">40</xref>] by collapsing barbourofelids and sabertoothed cats under a single state. The function <italic>convratsig</italic> returns four distance-based metrics of convergence and their relative statistical significance obtained by means of randomizations. The C<sub>1</sub> metric is the ratio of phenotypic distance between two (presumably convergent) tips (D<sub>tip</sub>) to the maximum phenotypic distance (D<sub>max</sub>) between any pair of taxa in those lineages. When the tips converge, C<sub>1</sub> gets close to 1. The C<sub>2</sub> metric quantifies the magnitude of convergence. It is computed as the difference between D<sub>max</sub> and D<sub>tip</sub>. The C<sub>3</sub> and C<sub>4</sub> metrics are computed by dividing C<sub>2</sub> by the total amount of morphological evolution intervening between the tips (i.e. the sum of phenotypic change along the tree branches) and by the total amount of morphological evolution in the entire clade defined by the mrca of convergent tips, respectively. All metrics rely on the estimation of ancestral states at internal nodes (reconstructed according to BM) and none of them include information about the timing for convergent evolution to take place [<xref rid="pone.0226949.ref040" ref-type="bibr">40</xref>].</p>
      <p>The second case study was based on hooved mammals (Ungulatomorpha). Hooved mammals fall into two major feeding categories, that is browsing on soft vegetable matter, and grazing on harder vegetable material, typically grasses, whose leaves are rich in silica and therefore result in increased wear rate of the molar tooth crowns. Browsing is typical of most Palaeocene and Eocene ‘ungulates’ and persists today in most deer, tragulids and other small-bodied forms [<xref rid="pone.0226949.ref041" ref-type="bibr">41</xref>]. With the emergence of grasslands and the spread of grasses, the inclusion of grasses in the diet became widespread in herbivorous mammals [<xref rid="pone.0226949.ref042" ref-type="bibr">42</xref>,<xref rid="pone.0226949.ref043" ref-type="bibr">43</xref>] and is responsible for the rapid diversification of grazing artiodactyls [<xref rid="pone.0226949.ref016" ref-type="bibr">16</xref>]. In morphology, the dietary shift from soft (browsing) to hard and fibrous (grazing) plant material is accompanied by profound changes in the skull and mandible, including the acquisition of high-crowned (hypsodont) molars, longer snout, and deeper mandible [<xref rid="pone.0226949.ref044" ref-type="bibr">44</xref>–<xref rid="pone.0226949.ref046" ref-type="bibr">46</xref>]. This pattern is present in equids, and also appeared several times among Pecora. Nonetheless, true grazing is restricted to a minority of species, most of them being properly defined as mixed-feeders consuming both grasses and soft material [<xref rid="pone.0226949.ref044" ref-type="bibr">44</xref>].</p>
      <p>The data were obtained from 353 images in lateral view taken from the scientific literature or directly from specimens (see <xref ref-type="supplementary-material" rid="pone.0226949.s002">S2 File</xref> for full details), representing 205 species. On each image we recorded nine landmarks to register mandibular shape and analyzed shapes by means of geometric morphometrics (see <xref ref-type="supplementary-material" rid="pone.0226949.s003">S3 File</xref> for details). We used the five largest eigenvectors, as they represent 95% of the cumulative shape variance explained. The ungulate tree was assembled from literature [<xref rid="pone.0226949.ref016" ref-type="bibr">16</xref>,<xref rid="pone.0226949.ref046" ref-type="bibr">46</xref>,<xref rid="pone.0226949.ref047" ref-type="bibr">47</xref>]. We considered individual species as either grazing artiodactyls, grazing perissodactyls, or “others” (i.e. non convergent) depending on their molar morphology (i.e. degree of hypsodonty) and tested whether grazing ungulates from different parts of the tree converged on similar mandibular morphologies by using the ‘state’ approach.</p>
      <p>The third real case pertains to extant lizards of the genus <italic>Anolis</italic>. The genus includes more than 400 species distributed in the Neotropical region and the Caribbean. Insular anoles fall into six distinct ecomorphs which have been intensely studied as a classic example of convergent evolution [<xref rid="pone.0226949.ref019" ref-type="bibr">19</xref>]. The data include a 100 species wide tree for <italic>Anolis</italic> lizards living on the main islands of the Greater Antilles, and 11 phylogenetic principal components extracted analyzing lizards body shapes [<xref rid="pone.0226949.ref048" ref-type="bibr">48</xref>,<xref rid="pone.0226949.ref049" ref-type="bibr">49</xref>] (see Supplementary <xref ref-type="supplementary-material" rid="pone.0226949.s004">S4 File</xref> for the R code). Six species do not fall into any ecomorph category and are therefore not expected to converge.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec008">
    <title>Results</title>
    <sec id="sec009">
      <title>Testing convergence generated by unknown evolutionary processes under the automatic mode</title>
      <p>The average tree size in the simulation experiments was 192.14 tips (range 156–247). The clades set to converge varied from 17 to 44 species (average 26.74). On average, the heights of the clades set to converge were 64.39% the tree height (range 10.33%-87.76%). The Euclidean distance between <bold><italic>s</italic></bold> and <bold><italic>s’</italic></bold> respective mrcas phenotypes falls with the 95% confidence intervals of the distribution of inter-node distances in the tree 96% of the times. The distance between the convergent clades was, on average, 98% of the tree height (range 30.14%-166.23%). Despite this great variation in convergent clade size, distance and height, under the automatic mode the Type II error (the rate of false negatives) is as low as 6%. Type I error (false positive) rate is similarly low at 4%. We analyzed the effect of tree size, <italic>f</italic>, and convergent clades’ relative size and distance (that is clade size and the distance between the <bold>mrcaC1</bold> and <bold>mrcaC2</bold> divided to the tree size and height, respectively) on the likelihood to find convergent clades, by regressing these metrics against the p-value calculated for θ<sub>real</sub> over 100 simulations. The effect of relative clade distance is negative and almost significant (p = 0.063) whereas <italic>f</italic> is positive and significant (p = 0.037), meaning that the likelihood of finding convergence increases for clades with distinctive phenotypes and relatively distant from each other on the tree as expected (<xref ref-type="fig" rid="pone.0226949.g004">Fig 4</xref>).</p>
      <p>As expected, when the simulations were repeated with clades separated by only three nodes, Type I error is 0%, whereas Type II error increases to 54%. These results indicate that <italic>search</italic>.<italic>conv</italic> does not find convergence between clades that are very close to each other on the tree, whose phenotypic resemblance is best explained by phylogenetic proximity rather than convergence.</p>
    </sec>
    <sec id="sec010">
      <title>Testing convergence generated by unknown evolutionary processes by specifying candidate clades</title>
      <p>The power of <italic>search</italic>.<italic>conv</italic> to correctly identify the convergent clades when they are specified by the user (i.e. both θ<sub>real</sub> and θ<sub>real</sub> + θ<sub>ace</sub> are significant) is 71%. However, considering cases when species phenotypes (θ<sub>real</sub>) are found to be significantly convergent but θ<sub>real</sub> + θ<sub>ace</sub> is not, the identified mrca<italic>s</italic> for the clades found to converge were correct 88% of the time, within 2 nodes distance from the convergent clades’ mrcas. <italic>search</italic>.<italic>conv</italic> often identifies nodes which are very close to the ‘real’ mrcas rather than the ‘real’ mrcas themselves. We found this usually depends on the balancing between the clade set to converge and its sister node, and the strong phenotypic autocorrelation between these clades (because a given clade necessarily includes all of the descendants of its daughter node). When the sister to the real mrca is made up of very few species <italic>search</italic>.<italic>conv</italic> usually identifies a younger node than the real mrca. Whichever exact mrca pair is identified, 97.5% of the species set to converge are, on average, found to do so.</p>
      <p>The Type I and Type II error rates of <italic>search</italic>.<italic>conv</italic> (automatic mode) are little influenced by how the phenotypes are simulated. The Type I error (the percentage of false positives) remains remarkably low (<xref rid="pone.0226949.t001" ref-type="table">Table 1</xref>). However, some types of phenotypes (most notably ‘drift’) present high Type II error rate (<xref rid="pone.0226949.t001" ref-type="table">Table 1</xref>).</p>
      <table-wrap id="pone.0226949.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0226949.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Type I and Type II error rates.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0226949.t001g" xlink:href="pone.0226949.t001"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1"/>
                <th align="center" rowspan="1" colspan="1">Type II error</th>
                <th align="center" rowspan="1" colspan="1">Type I error</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Phenotype type</bold>
                </td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">browian</td>
                <td align="char" char="." rowspan="1" colspan="1">6.00%</td>
                <td align="char" char="." rowspan="1" colspan="1">4.00%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">kappa</td>
                <td align="char" char="." rowspan="1" colspan="1">4.00%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.00%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">delta</td>
                <td align="char" char="." rowspan="1" colspan="1">12.00%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.00%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">lambda</td>
                <td align="char" char="." rowspan="1" colspan="1">0.00%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.00%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">trend</td>
                <td align="char" char="." rowspan="1" colspan="1">12.00%</td>
                <td align="char" char="." rowspan="1" colspan="1">4.00%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">drift</td>
                <td align="char" char="." rowspan="1" colspan="1">16.00%</td>
                <td align="char" char="." rowspan="1" colspan="1">4.00%</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t001fn001">
            <p>Type I and Type II error rates with phenotypes simulated according to different evolutionary models.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="sec011">
      <title>Testing convergence generated by unknown evolutionary processes using evolutionary states</title>
      <p>By using the ‘state’ specification, the Type I error rate is 5%, either within or between states. Type II error of <italic>search</italic>.<italic>conv</italic> is 1% when testing for convergence within a group and 6% testing two different states for convergence on each other. We did not find a significant regression between the rank of θ<sub><italic>real</italic></sub> and <italic>f</italic> across 100 simulations (within state p = 0.104; between states p = 0.882). This is not surprising because under the state case species evolving under a single state appear randomly across the tree, hence the effect of <italic>f</italic> transformation is diffused rather than focusing on a single clade.</p>
    </sec>
    <sec id="sec012">
      <title>Testing convergence generated by known evolutionary processes</title>
      <p>We found 47 instances of convergence among groups of three randomly selected species out of 1,000 simulations with phenotypes designed to evolve under the BM model. This means that the Type I error rate of <italic>search</italic>.<italic>conv</italic>, under this condition, is 4.7%. By using the OU process to model convergence, we found <italic>search</italic>.<italic>conv</italic> fails to recognize convergence 45 times out of 1,000 simulation. The corresponding figure for Type II error rate (4.5%) is below the nominal alpha level (5%). By using time distances to select clades for convergence, we found Type I error rate as low as 2% and Type II rate at 4.9% (see supplementary information).</p>
    </sec>
    <sec id="sec013">
      <title>Real case scenarios</title>
      <sec id="sec014">
        <title>Felid mandibles</title>
        <p>When testing for convergence between clades, we found two instances of convergent morphological evolution, both pertaining the same clade, Barbourofelidae. The latter includes false saber-toothed cats of the genera <italic>Barbourofelis</italic> and <italic>Albanosmilus</italic>. They were found to be convergent on both Smilodontini and Homotheriini within machairodonts, which represent the true sabertoothed cats (<xref ref-type="fig" rid="pone.0226949.g005">Fig 5</xref>). It is noteworthy that <italic>search</italic>.<italic>conv</italic> effectively failed to find convergence between barbourofelids and Metailurini (<xref ref-type="fig" rid="pone.0226949.g005">Fig 5</xref>), which form a clade of machairodont cats sister to Smilodontini but did not possess the full sabertooth morphology. The mean angle between barbourofelids and Smilodontini is 29.93 degrees (<xref rid="pone.0226949.t002" ref-type="table">Table 2A</xref>). The angle between their ancestors is 21.50 degrees. Both θ<sub><italic>real</italic></sub> and θ<sub><italic>real</italic></sub> + θ<sub><italic>ace</italic></sub> are statistically smaller than expected by chance (p = 0.009 for both). This suggests that the two clades evolved along parallel trajectories. The angle between barbourofelids and Homotheriini is 43.09 degrees, the angle between their reconstructed ancestors is 39.09 degrees, and both θ<sub><italic>real</italic></sub> and θ<sub><italic>real</italic></sub> + θ<sub><italic>ace</italic></sub> are statistically significant (p = 0.019 and 0.011, respectively; <xref rid="pone.0226949.t002" ref-type="table">Table 2A</xref>). The computational time was 145 seconds.</p>
        <fig id="pone.0226949.g005" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0226949.g005</object-id>
          <label>Fig 5</label>
          <caption>
            <title>Convergence among mandibular shapes in felids.</title>
            <p>A) The clades found to converge were Homotheriini (orange) and Barbourofelidae (blue) and Smilodontini (green). B) PC1/PC2 plot showing the position of the convergent clades compared to the rest of the tree. Deformation grids are shown at the extremes of both axes. The silhouette for <italic>Homotherium</italic> was available for reuse under the Creative Commons Attribution 3.0 Unported (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-sa/3.0/">https://creativecommons.org/licenses/by-sa/3.0/</ext-link>) at <ext-link ext-link-type="uri" xlink:href="http://phylopic.org/image/c6c2d17b-56b3-4c87-97c4-cd2b7de365fa/">http://phylopic.org/image/c6c2d17b-56b3-4c87-97c4-cd2b7de365fa/</ext-link> (image by Zimices). The silhouettes for <italic>Smilodon</italic> and <italic>Barbourofelis</italic> are our own work.</p>
          </caption>
          <graphic xlink:href="pone.0226949.g005"/>
        </fig>
        <table-wrap id="pone.0226949.t002" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0226949.t002</object-id>
          <label>Table 2</label>
          <caption>
            <title>The results of <italic>search</italic>.<italic>conv</italic> applied to felid mandibular shape.</title>
          </caption>
          <alternatives>
            <graphic id="pone.0226949.t002g" xlink:href="pone.0226949.t002"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
              </colgroup>
              <tbody>
                <tr>
                  <td align="left" colspan="8" rowspan="1">
                    <bold>A. <italic>ACE estimated</italic></bold>
                  </td>
                </tr>
                <tr>
                  <td align="center" colspan="2" rowspan="1">candidate node pairs</td>
                  <td align="center" rowspan="1" colspan="1">θ<sub>ace</sub></td>
                  <td align="center" rowspan="1" colspan="1">θ<sub>real</sub></td>
                  <td align="center" rowspan="1" colspan="1">distance<break/>(# nodes)</td>
                  <td align="center" rowspan="1" colspan="1">distance (years * 10<sup>6</sup>)</td>
                  <td align="center" rowspan="1" colspan="1">p (θ<sub>real</sub>)</td>
                  <td align="center" rowspan="1" colspan="1">p (θ<sub>real</sub>+θ<sub>ace</sub>)</td>
                </tr>
                <tr>
                  <td align="center" rowspan="1" colspan="1">Smilodontini</td>
                  <td align="center" rowspan="1" colspan="1">Barbourofelidae</td>
                  <td align="center" rowspan="1" colspan="1">21.50</td>
                  <td align="center" rowspan="1" colspan="1">29.93</td>
                  <td align="center" rowspan="1" colspan="1">9</td>
                  <td align="center" rowspan="1" colspan="1">43.5</td>
                  <td align="center" rowspan="1" colspan="1">0.01</td>
                  <td align="center" rowspan="1" colspan="1">0.01</td>
                </tr>
                <tr>
                  <td align="center" rowspan="1" colspan="1">Homotheriini</td>
                  <td align="center" rowspan="1" colspan="1">Barbourofelidae</td>
                  <td align="center" rowspan="1" colspan="1">39.09</td>
                  <td align="center" rowspan="1" colspan="1">43.09</td>
                  <td align="center" rowspan="1" colspan="1">9</td>
                  <td align="center" rowspan="1" colspan="1">40.8</td>
                  <td align="center" rowspan="1" colspan="1">0.02</td>
                  <td align="center" rowspan="1" colspan="1">0.01</td>
                </tr>
                <tr>
                  <td align="left" colspan="8" rowspan="1">
                    <bold>B. <italic>ACE indicated</italic></bold>
                  </td>
                </tr>
                <tr>
                  <td align="center" colspan="2" rowspan="1">candidate node pairs</td>
                  <td align="center" rowspan="1" colspan="1">θ<sub>ace</sub></td>
                  <td align="center" rowspan="1" colspan="1">θ<sub>real</sub></td>
                  <td align="center" rowspan="1" colspan="1">distance<break/>(# nodes)</td>
                  <td align="center" rowspan="1" colspan="1">distance (years * 10<sup>6</sup>)</td>
                  <td align="center" rowspan="1" colspan="1">p (θ<sub>real</sub>)</td>
                  <td align="center" rowspan="1" colspan="1">p (θ<sub>real</sub>+θ<sub>ace</sub>)</td>
                </tr>
                <tr>
                  <td align="center" rowspan="1" colspan="1">Smilodontini</td>
                  <td align="center" rowspan="1" colspan="1">Barbourofelidae</td>
                  <td align="center" rowspan="1" colspan="1">34.44</td>
                  <td align="center" rowspan="1" colspan="1">29.93</td>
                  <td align="center" rowspan="1" colspan="1">9</td>
                  <td align="center" rowspan="1" colspan="1">43.5</td>
                  <td align="center" rowspan="1" colspan="1">0.01</td>
                  <td align="center" rowspan="1" colspan="1">0.01</td>
                </tr>
                <tr>
                  <td align="center" rowspan="1" colspan="1">Homotheriini</td>
                  <td align="center" rowspan="1" colspan="1">Barbourofelidae</td>
                  <td align="center" rowspan="1" colspan="1">51.67</td>
                  <td align="center" rowspan="1" colspan="1">43.09</td>
                  <td align="center" rowspan="1" colspan="1">9</td>
                  <td align="center" rowspan="1" colspan="1">40.8</td>
                  <td align="center" rowspan="1" colspan="1">0.03</td>
                  <td align="center" rowspan="1" colspan="1">0.03</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="t002fn001">
              <p>The results of <italic>search</italic>.<italic>conv</italic> applied to felid mandibular shape, either by estimating ancestral phenotypes by RRphylo (A), or specifying the ancestral phenotypes to all barbourofelids and all machairodonts to be equal to the phenotype of <italic>Barbourofelis fricki</italic> and <italic>Smilodon fatalis</italic> (B), respectively. ACE = ancestral character state (i.e. the ancestral phenotype), p (θ<sub>real</sub>) the significance of convergence test restricted to species only, p (θ<sub>real</sub> + θ<sub>ace</sub>) the significance of convergence test for the θ<sub>real</sub> + θ<sub>ace</sub> sum.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <p>By using the mandibular shapes of <italic>Barbourofelis fricki</italic> and <italic>Smilodon fatalis</italic> as the ancestral states to all barbourofelids and machairodonts, respectively, the results are similar to those obtained without specifying phenotypes at the mrca nodes (<xref rid="pone.0226949.t002" ref-type="table">Table 2B</xref>, <xref ref-type="supplementary-material" rid="pone.0226949.s003">S3 File</xref>), and this may help explaining the good performance of <italic>search</italic>.<italic>conv</italic> in finding the correct position, hence the true identity, of converging clades.</p>
        <p>By performing the analysis collapsing machairodonts and barbourofelids under a single state, <italic>search</italic>.<italic>conv</italic> produced a small and significant mean angle (19.93 degrees, p = 0.001) between convergent species. The computational time was 44 seconds. This latter analysis performed by using <italic>convratsig</italic> [<xref rid="pone.0226949.ref040" ref-type="bibr">40</xref>] produced significant results for all the measures (<xref rid="pone.0226949.t003" ref-type="table">Table 3</xref>). The computational time was 21h 48’ 7”.</p>
        <table-wrap id="pone.0226949.t003" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0226949.t003</object-id>
          <label>Table 3</label>
          <caption>
            <title>The results of <italic>convratsig</italic> applied to felid mandibular shape.</title>
          </caption>
          <alternatives>
            <graphic id="pone.0226949.t003g" xlink:href="pone.0226949.t003"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="left" rowspan="1" colspan="1"/>
                  <th align="center" rowspan="1" colspan="1">value</th>
                  <th align="center" rowspan="1" colspan="1">p-value</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>C1</bold>
                  </td>
                  <td align="char" char="." rowspan="1" colspan="1">0.259</td>
                  <td align="center" rowspan="1" colspan="1">0</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>C2</bold>
                  </td>
                  <td align="char" char="." rowspan="1" colspan="1">0.058</td>
                  <td align="center" rowspan="1" colspan="1">0</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>C3</bold>
                  </td>
                  <td align="char" char="." rowspan="1" colspan="1">0.110</td>
                  <td align="center" rowspan="1" colspan="1">0</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>C4</bold>
                  </td>
                  <td align="char" char="." rowspan="1" colspan="1">0.013</td>
                  <td align="center" rowspan="1" colspan="1">0</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="t003fn001">
              <p>Distance-based measures of convergence and relative significance level as derived by the function <italic>convratsig</italic> in the R package convevol.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
      </sec>
      <sec id="sec015">
        <title>Grazing ungulate mandibles</title>
        <p>We performed <italic>search</italic>.<italic>conv</italic> once taking grazers as a single group, then considering grazing artiodactyls and grazing perissodactyls separately.</p>
        <p>The mean angle between all grazers collapsed under a single state is 69.62 degrees. This is significant at p = 0.041 (see <xref ref-type="supplementary-material" rid="pone.0226949.s003">S3 File</xref> for figure). The mean angle between grazing artiodactyls and grazing perissodactyls is 77.53 degrees. Although large, we found this angle is less than expected by chance (p = 0.001, <xref ref-type="fig" rid="pone.0226949.g006">Fig 6</xref>). In fact, the angle θ<sub>real</sub> increases by 0.51 degrees per million year between grazing artiodactyls and grazing perissodactyls (which are separated by some 152 million years of independent evolution on the ‘ungulate’ tree, i.e. at least twice as much as the inferred age of the most recent common ancestor to all ‘Ungulatomorpha’). This same figure is 0.71 degrees per million year between grazing perissodactyls and “others” and 0.65 between grazing artiodactyls and “others”.</p>
        <fig id="pone.0226949.g006" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0226949.g006</object-id>
          <label>Fig 6</label>
          <caption>
            <title>Convergence among mandibular shapes in ungulates.</title>
            <p>A) The distribution of individual species per state (gray = background state (others), orange = grazing artiodactyls, green = grazing perissodactyls) on the ‘ungulate’ tree. B) PC1/PC2 plot showing the position of the convergent states (grazers) compared to the rest of the tree. Deformation grids are shown at the extremes of both axes. Animal silhouettes were available under Public Domain license at phylopic (<ext-link ext-link-type="uri" xlink:href="http://phylopic.org/">http://phylopic.org/</ext-link>). Specifically, <italic>Bos primigenius</italic> (<ext-link ext-link-type="uri" xlink:href="http://phylopic.org/image/dc5c561e-e030-444d-ba22-3d427b60e58a/">http://phylopic.org/image/dc5c561e-e030-444d-ba22-3d427b60e58a/</ext-link>) image by DFoidl (modified by T. Michael Keesey) and <italic>Equus ferus</italic> (<ext-link ext-link-type="uri" xlink:href="http://phylopic.org/image/85d95128-912c-427a-9542-138e1dbf5651/">http://phylopic.org/image/85d95128-912c-427a-9542-138e1dbf5651/</ext-link>) image by Mercedes Yrayzoz (vectorized by T. Michael Keesey) are available for reuse under the Creative Commons Attribution 3.0 Unported (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-sa/3.0/">https://creativecommons.org/licenses/by-sa/3.0/</ext-link>).</p>
          </caption>
          <graphic xlink:href="pone.0226949.g006"/>
        </fig>
      </sec>
      <sec id="sec016">
        <title>Caribbean <italic>Anolis</italic></title>
        <p>By using <italic>search</italic>.<italic>conv</italic>, we found significant convergence in 5 out of the 6 ecomorphs traditionally recognized for insular anoles (<xref rid="pone.0226949.t004" ref-type="table">Table 4</xref>, see <xref ref-type="supplementary-material" rid="pone.0226949.s003">S3 File</xref> for figure).</p>
        <table-wrap id="pone.0226949.t004" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0226949.t004</object-id>
          <label>Table 4</label>
          <caption>
            <title>Results of convergence within <italic>Anolis</italic> ecomorphs.</title>
            <p>The left columns represent the results obtained by applying <italic>search</italic>.<italic>conv</italic>. The last two rightmost columns are the corresponding results pertaining to the metrics C1 and C5, retrieved from [<xref rid="pone.0226949.ref022" ref-type="bibr">22</xref>]. mean angle = the mean angle between species within the ecomorph; mean angle by time = the mean angle between species within the ecomorph divided by time distance; p mean angle = significance level for mean angle; p mean angle by time = significance level for mean angle by time; p-value C1 = significance level for the C1 measure [<xref rid="pone.0226949.ref022" ref-type="bibr">22</xref>]; p-value C5 = significance level for the C5 measure [<xref rid="pone.0226949.ref022" ref-type="bibr">22</xref>].</p>
          </caption>
          <alternatives>
            <graphic id="pone.0226949.t004g" xlink:href="pone.0226949.t004"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="left" rowspan="2" colspan="1">Ecomorph</th>
                  <th align="center" colspan="4" rowspan="1"><italic>search</italic>.<italic>conv</italic></th>
                  <th align="center" colspan="2" rowspan="1">Stayton 2015</th>
                </tr>
                <tr>
                  <th align="center" rowspan="1" colspan="1">mean<break/>angle</th>
                  <th align="center" rowspan="1" colspan="1">mean angle<break/>by time</th>
                  <th align="center" rowspan="1" colspan="1">p<break/>mean angle</th>
                  <th align="center" rowspan="1" colspan="1">p mean angle by time</th>
                  <th align="center" rowspan="1" colspan="1">p-value<break/>C<sub>1</sub></th>
                  <th align="center" rowspan="1" colspan="1">p-value<break/>C<sub>5</sub></th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Trunk-ground</td>
                  <td align="char" char="." rowspan="1" colspan="1">44.064</td>
                  <td align="char" char="." rowspan="1" colspan="1">32.204</td>
                  <td align="char" char="." rowspan="1" colspan="1">&lt;0.001</td>
                  <td align="char" char="." rowspan="1" colspan="1">&lt;0.001</td>
                  <td align="char" char="." rowspan="1" colspan="1">0.008</td>
                  <td align="char" char="." rowspan="1" colspan="1">0.120</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Grass-bush</td>
                  <td align="char" char="." rowspan="1" colspan="1">35.855</td>
                  <td align="char" char="." rowspan="1" colspan="1">24.835</td>
                  <td align="char" char="." rowspan="1" colspan="1">&lt;0.001</td>
                  <td align="char" char="." rowspan="1" colspan="1">&lt;0.001</td>
                  <td align="char" char="." rowspan="1" colspan="1">&lt;0.001</td>
                  <td align="char" char="." rowspan="1" colspan="1">0.386</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Crown-giant</td>
                  <td align="char" char="." rowspan="1" colspan="1">20.814</td>
                  <td align="char" char="." rowspan="1" colspan="1">36.305</td>
                  <td align="char" char="." rowspan="1" colspan="1">&lt;0.001</td>
                  <td align="char" char="." rowspan="1" colspan="1">0.003</td>
                  <td align="char" char="." rowspan="1" colspan="1">&lt;0.001</td>
                  <td align="char" char="." rowspan="1" colspan="1">&lt;0.001</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Trunk-crown</td>
                  <td align="char" char="." rowspan="1" colspan="1">68.635</td>
                  <td align="char" char="." rowspan="1" colspan="1">45.403</td>
                  <td align="char" char="." rowspan="1" colspan="1">0.002</td>
                  <td align="char" char="." rowspan="1" colspan="1">0.040</td>
                  <td align="char" char="." rowspan="1" colspan="1">0.186</td>
                  <td align="char" char="." rowspan="1" colspan="1">0.011</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Twig</td>
                  <td align="char" char="." rowspan="1" colspan="1">30.050</td>
                  <td align="char" char="." rowspan="1" colspan="1">19.695</td>
                  <td align="char" char="." rowspan="1" colspan="1">&lt;0.001</td>
                  <td align="char" char="." rowspan="1" colspan="1">&lt;0.001</td>
                  <td align="char" char="." rowspan="1" colspan="1">&lt;0.001</td>
                  <td align="char" char="." rowspan="1" colspan="1">0.445</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Trunk</td>
                  <td align="char" char="." rowspan="1" colspan="1">41.289</td>
                  <td align="char" char="." rowspan="1" colspan="1">43.735</td>
                  <td align="char" char="." rowspan="1" colspan="1">&lt;0.001</td>
                  <td align="char" char="." rowspan="1" colspan="1">0.119</td>
                  <td align="char" char="." rowspan="1" colspan="1">0.252</td>
                  <td align="char" char="." rowspan="1" colspan="1">0.002</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">None</td>
                  <td align="char" char="." rowspan="1" colspan="1">87.996</td>
                  <td align="char" char="." rowspan="1" colspan="1">53.344</td>
                  <td align="char" char="." rowspan="1" colspan="1">0.317</td>
                  <td align="char" char="." rowspan="1" colspan="1">0.991</td>
                  <td align="char" char="." rowspan="1" colspan="1">0.255</td>
                  <td align="char" char="." rowspan="1" colspan="1">0.763</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
        <p>We found convergence in 5 out of 6 different ecomorphs, the only exception being ‘trunk’ anoles. The <italic>Anolis</italic> species that cannot be ascribed to any ecomorphs are, unsurprisingly, not found to converge. By using the C1 metric, Stayton [<xref rid="pone.0226949.ref022" ref-type="bibr">22</xref>] found 4 of 6 ecomorphs converging. By using the metric C5, convergence is found in 3 ecomorphs. Species not ascribed to an ecomorph were not found to converge for either of the metrics.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec017">
    <title>Discussion</title>
    <p>Evolutionary convergence has been the focus of many evolutionary studies [<xref rid="pone.0226949.ref006" ref-type="bibr">6</xref>,<xref rid="pone.0226949.ref021" ref-type="bibr">21</xref>]. Morphological convergence arises from adaptation to similar niches by different lineages, which can be separated geographically, phylogenetically and temporally [<xref rid="pone.0226949.ref012" ref-type="bibr">12</xref>], although different processes such as phylogenetic and developmental constraint, and even chance may produce the same pattern [<xref rid="pone.0226949.ref050" ref-type="bibr">50</xref>–<xref rid="pone.0226949.ref053" ref-type="bibr">53</xref>].</p>
    <p>There are several methods available in the literature to test the hypothesis of morphological convergence. Most of them rely on the basic assumption that convergence implies stronger phenotypic resemblance than expected by phylogenetic distance. Although the method we propose here, <italic>search</italic>.<italic>conv</italic>, makes this same assumption, it additionally helps identifying entire clades evolving towards similar shapes and recognizing whether they actually converge from different starting points (which we deem simple convergence) or evolved along parallel trajectories (note that under Adams and Collyer’s phenotypic trajectory analysis there is no expectation about how large the angle between a pair of phenotypic vectors should be [<xref rid="pone.0226949.ref026" ref-type="bibr">26</xref>]). Our procedure to identify convergence between clades is at least as dependent on ancestral state estimation as many other approaches (e.g. [<xref rid="pone.0226949.ref006" ref-type="bibr">6</xref>,<xref rid="pone.0226949.ref010" ref-type="bibr">10</xref>,<xref rid="pone.0226949.ref023" ref-type="bibr">23</xref>,<xref rid="pone.0226949.ref054" ref-type="bibr">54</xref>]). However, in <italic>search</italic>.<italic>conv</italic> it is possible to indicate specific phenotypes at nodes, if they are known from the fossil record, which can reduce the impact of ancestral states estimation.</p>
    <p>We demonstrate <italic>search</italic>.<italic>conv</italic>, which is embedded in the R package RRphylo, is robust, has low Type I and Type II error rates, and is very fast even with reasonably large trees. Although the mrcas set to converge are not always found with precision under the automatic mode, the species actually set to converge are correctly identified up to 97.5% of the time, further demonstrating the selection of clade pairs is reasonably precise. When the starting phenotype was modelled to follow an evolutionary model other than BM, the function remains powerful, perhaps with the exception of the ‘drift’ (a trend in the mean phenotype over time) case. The lower performance of <italic>seach</italic>.<italic>conv</italic> on ‘drift-ed’ phenotypes might depend on the fact that ancestral state estimation is bounded by the actual phenotypes at the tips, making it evident how highly informative the specification of ancestral phenotypes could be.</p>
    <p>We successfully applied <italic>search</italic>.<italic>conv</italic> to mandibular shape evolution in mammals in two different real cases and to Caribbean islands anole ecomorphs. The first real case study regards the evolution of mandibular shapes in felids. We found “true” sabertooths (Homotheriini and Smilodontini) independently converge on barbourofelids in their mandible morphology. Intriguingly, Metailurini (i.e. “false” sabertooths) which is nested within the machairodont family, were not found to converge on barbourofelids under the automatic mode. This means <italic>search</italic>.<italic>conv</italic> successfully excluded the false sabertooths from the convergence pattern despite their phylogenetic position close to other “true” sabertoothed machairodont cats [<xref rid="pone.0226949.ref055" ref-type="bibr">55</xref>,<xref rid="pone.0226949.ref056" ref-type="bibr">56</xref>].</p>
    <p>We used the felid data to compare <italic>search</italic>.<italic>conv</italic> to convevol’s <italic>convratsig</italic> function. While both functions recognize the same pattern, <italic>search</italic>.<italic>conv</italic> was found to be three orders of magnitude faster, which could be crucial when it comes to assessing convergence with uncertain state categorization, or to taking the effect of phylogenetic uncertainty into account, as this implies repeating the analyses dozens of times by using different phylogenetic hypotheses.</p>
    <p>The second real case application, performed with the ‘state’ approach, relates to the evolution of hypsodonty due to grass feeding in ‘ungulates’. Grazing adaptations in the mandible evolved independently in horses (genus <italic>Equus</italic>) and several bovid lineages, most notably among antelopes. We found evidence for convergent evolution between <italic>Equus</italic> and strictly grazing bovids, such as <italic>Bison</italic>, <italic>Bos</italic>, and <italic>Alcelaphus</italic>. This is especially noteworthy considering that the paleontological tree we used includes a number of non-grazing equids, such as hipparionoid horses and browsing anchitheriine equids, plus several extinct rhinos and tapirs which were all browsers. This demonstrates the method was able to find convergence among grazers despite the effect of phylogeny and body size on mandibular shape variation [<xref rid="pone.0226949.ref046" ref-type="bibr">46</xref>].</p>
    <p>The final real case pertains to <italic>Anolis</italic> ecomorphs. We found evidence for convergence in all of them but the ‘trunk’ ecomorph species. Intriguingly, five of the six ‘trunk’ groups belong to a single monophyletic clade, indicating that the trunk ecomorph evolved only twice, once for a single clade only present on Hispaniola and then again when Cuban <italic>Anolis loysiana</italic> converged on them.</p>
    <p>Compared to other statistical procedures used to test for morphological convergence, <italic>search</italic>.<italic>conv</italic> offers the possibility to test convergence between entire clades, and allows testing specific ‘states’ sparsely distributed across the tree. In addition, being much faster than alternative approaches, <italic>seach</italic>.<italic>conv</italic> allows exploring the potential effect of phylogenetic uncertainty and use of fossil phenotypes as ancestral states, that can be crucial in the presence of non-Brownian processes. It must however be noted that not all cases of “convergence” may be explored best with <italic>search</italic>.<italic>conv</italic>. There are several instances reported in literature of convergence between closely related clades and even single species with close phylogenetic proximity. We provide a test which is useful to find instances of large-scale morphological resemblance between distant clades that are generally referred at as either ‘convergent’ or just cases of iterative evolution. Caution must be applied to the choice of the ancestral phenotype in the presence of strong phenotypic drift.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec018">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pone.0226949.s001">
      <label>S1 File</label>
      <caption>
        <title>Angles theta for ancestors and tips of two clades evolving with or without convergence.</title>
        <p>The R code produces a 3D plot showing the distribution of phenotypes for a &gt; 100 species tree. Two clades are selected to evolve convergent tip phenotypes (simple convergence), convergent tip phenotypes starting from ancestors which are similar to each other (convergence and parallel trajectories) or no convergence. At running the code, the user interactively chooses which kind of simulation to perform and how much the convergent clades have to be different (phenotypically) from the rest of the tree.</p>
        <p>(R)</p>
      </caption>
      <media xlink:href="pone.0226949.s001.R">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0226949.s002">
      <label>S2 File</label>
      <caption>
        <title>Supplementary information for ‘ungulates’.</title>
        <p>State attribution with references and source for images used in GMM.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0226949.s002.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0226949.s003">
      <label>S3 File</label>
      <caption>
        <title>Supplementary material.</title>
        <p>Details of the methods and additional results.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0226949.s003.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0226949.s004">
      <label>S4 File</label>
      <caption>
        <title>Convergence simulations.</title>
        <p>R code to perform the simulations.</p>
        <p>(R)</p>
      </caption>
      <media xlink:href="pone.0226949.s004.R">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We are grateful to Lorenzo Rook, Francesco Carotenuto, Gianmarco Tesone, and Martina Piccolo for the comments on earlier version of the manuscript. The authors declare no conflict of interest. Alistair Evans, Roland Sookias and two anonymous reviewers provided insightful comments to an earlier version of this manuscript.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0226949.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Beaulieu</surname><given-names>JM</given-names></name>, <name><surname>Jhwueng</surname><given-names>D-C</given-names></name>, <name><surname>Boettiger</surname><given-names>C</given-names></name>, <name><surname>O’Meara</surname><given-names>BC</given-names></name>. <article-title>Modeling stabilizing selection: expanding the Ornstein-Uhlenbeck model of adaptive evolution</article-title>. <source>Evolution</source>. <year>2012</year>;<volume>66</volume>: <fpage>2369</fpage>–<lpage>2383</lpage>. <pub-id pub-id-type="doi">10.1111/j.1558-5646.2012.01619.x</pub-id><?supplied-pmid 22834738?><pub-id pub-id-type="pmid">22834738</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Butler</surname><given-names>MA</given-names></name>, <name><surname>King</surname><given-names>AA</given-names></name>. <article-title>Phylogenetic Comparative Analysis: A Modeling Approach for Adaptive Evolution</article-title>. <source>Am Nat</source>. <year>2004</year>;<volume>164</volume>: <fpage>683</fpage>–<lpage>695</lpage>. <pub-id pub-id-type="doi">10.1086/426002</pub-id><?supplied-pmid 29641928?><pub-id pub-id-type="pmid">29641928</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Wake</surname><given-names>DB</given-names></name>, <name><surname>Wake</surname><given-names>MH</given-names></name>, <name><surname>Specht</surname><given-names>CD</given-names></name>. <article-title>Homoplasy: from detecting pattern to determining process and mechanism of evolution</article-title>. <source>Science</source>. <year>2011</year>;<volume>331</volume>: <fpage>1032</fpage>–<lpage>1035</lpage>. <pub-id pub-id-type="doi">10.1126/science.1188545</pub-id><?supplied-pmid 21350170?><pub-id pub-id-type="pmid">21350170</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Bravo</surname><given-names>GA</given-names></name>, <name><surname>Remsen</surname><given-names>JV</given-names><suffix>Jr</suffix></name>., <name><surname>Brumfield</surname><given-names>RT</given-names></name>. <article-title>Adaptive processes drive ecomorphological convergent evolution in antwrens (Thamnophilidae)</article-title>. <source>Evolution</source>. <year>2014</year>;<volume>68</volume>: <fpage>2757</fpage>–<lpage>2774</lpage>. <pub-id pub-id-type="doi">10.1111/evo.12506</pub-id><?supplied-pmid 25135629?><pub-id pub-id-type="pmid">25135629</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Huang</surname><given-names>S</given-names></name>, <name><surname>Roy</surname><given-names>K</given-names></name>, <name><surname>Valentine</surname><given-names>JW</given-names></name>, <name><surname>Jablonski</surname><given-names>D</given-names></name>. <article-title>Convergence, divergence, and parallelism in marine biodiversity trends: Integrating present-day and fossil data</article-title>. <source>Proc Natl Acad Sci</source>. <year>2015</year>;<volume>112</volume>: <fpage>4903</fpage>–<lpage>4908</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1412219112</pub-id><?supplied-pmid 25901312?><pub-id pub-id-type="pmid">25901312</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Speed</surname><given-names>MP</given-names></name>, <name><surname>Arbuckle</surname><given-names>K</given-names></name>. <article-title>Quantification provides a conceptual basis for convergent evolution</article-title>. <source>Biol Rev</source>. <year>2016</year>;<volume>92</volume>: <fpage>815</fpage>–<lpage>829</lpage>. <pub-id pub-id-type="doi">10.1111/brv.12257</pub-id><?supplied-pmid 26932796?><pub-id pub-id-type="pmid">26932796</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Goswami</surname><given-names>A</given-names></name>, <name><surname>Milne</surname><given-names>N</given-names></name>, <name><surname>Wroe</surname><given-names>S</given-names></name>. <article-title>Biting through constraints: cranial morphology, disparity and convergence across living and fossil carnivorous mammals</article-title>. <source>Proc R Soc B Biol Sci</source>. <year>2011</year>;<volume>278</volume>: <fpage>1831</fpage>–<lpage>1839</lpage>. <pub-id pub-id-type="doi">10.1098/rspb.2010.2031</pub-id><?supplied-pmid 21106595?><pub-id pub-id-type="pmid">21106595</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Ingram</surname><given-names>T</given-names></name>, <name><surname>Kai</surname><given-names>Y</given-names></name>. <article-title>The Geography of Morphological Convergence in the Radiations of Pacific Sebastes Rockfishes</article-title>. <source>Am Nat</source>. <year>2014</year>;<volume>184</volume>: <fpage>E115</fpage>–<lpage>E131</lpage>. <pub-id pub-id-type="doi">10.1086/678053</pub-id><?supplied-pmid 25325753?><pub-id pub-id-type="pmid">25325753</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Serb</surname><given-names>JM</given-names></name>, <name><surname>Sherratt</surname><given-names>E</given-names></name>, <name><surname>Alejandrino</surname><given-names>A</given-names></name>, <name><surname>Adams</surname><given-names>DC</given-names></name>. <article-title>Phylogenetic convergence and multiple shell shape optima for gliding scallops (Bivalvia: Pectinidae)</article-title>. <source>J Evol Biol</source>. <year>2017</year>;<volume>63</volume>: <fpage>685</fpage>–<lpage>1747</lpage>. <pub-id pub-id-type="doi">10.1111/jeb.13137</pub-id><?supplied-pmid 28667696?><pub-id pub-id-type="pmid">28667696</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Moen</surname><given-names>DS</given-names></name>, <name><surname>Morlon</surname><given-names>H</given-names></name>, <name><surname>Wiens</surname><given-names>JJ</given-names></name>. <article-title>Testing Convergence Versus History: Convergence Dominates Phenotypic Evolution for over 150 Million Years in Frogs</article-title>. <source>Syst Biol</source>. <year>2015</year>;<volume>65</volume>: <fpage>146</fpage>–<lpage>160</lpage>. <pub-id pub-id-type="doi">10.1093/sysbio/syv073</pub-id><?supplied-pmid 26454873?><pub-id pub-id-type="pmid">26454873</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Piras</surname><given-names>P</given-names></name>, <name><surname>Sansalone</surname><given-names>G</given-names></name>, <name><surname>Teresi</surname><given-names>L</given-names></name>, <name><surname>Kotsakis</surname><given-names>T</given-names></name>, <name><surname>Colangelo</surname><given-names>P</given-names></name>, <name><surname>Loy</surname><given-names>A</given-names></name>. <article-title>Testing convergent and parallel adaptations in talpids humeral mechanical performance by means of geometric morphometrics and finite element analysis</article-title>. <source>J Morphol</source>. <year>2012</year>;<volume>273</volume>: <fpage>696</fpage>–<lpage>711</lpage>. <pub-id pub-id-type="doi">10.1002/jmor.20015</pub-id><?supplied-pmid 22419178?><pub-id pub-id-type="pmid">22419178</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Van Valkenburgh</surname><given-names>B</given-names></name>. <article-title>Deja vu: the evolution of feeding morphologies in the Carnivora</article-title>. <source>Integr Comp Biol</source>. <year>2007</year>;<volume>47</volume>: <fpage>147</fpage>–<lpage>163</lpage>. <pub-id pub-id-type="doi">10.1093/icb/icm016</pub-id><?supplied-pmid 21672827?><pub-id pub-id-type="pmid">21672827</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Slater</surname><given-names>GJ</given-names></name>. <article-title>Iterative adaptive radiations of fossil canids show no evidence for diversity-dependent trait evolution</article-title>. <source>Proc Natl Acad Sci</source>. <year>2015</year>;<volume>112</volume>: <fpage>4897</fpage>–<lpage>4902</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1403666111</pub-id><?supplied-pmid 25901311?><pub-id pub-id-type="pmid">25901311</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Sander</surname><given-names>PM</given-names></name>, <name><surname>Christian</surname><given-names>A</given-names></name>, <name><surname>Clauss</surname><given-names>M</given-names></name>, <name><surname>Fechner</surname><given-names>R</given-names></name>, <name><surname>Gee</surname><given-names>CT</given-names></name>, <name><surname>Griebeler</surname><given-names>EM</given-names></name>, <etal>et al</etal><article-title>Biology of the sauropod dinosaurs: the evolution of gigantism</article-title>. <source>Biol Rev</source>. <year>2010</year>;<volume>86</volume>: <fpage>117</fpage>–<lpage>155</lpage>. <pub-id pub-id-type="doi">10.1111/j.1469-185X.2010.00137.x</pub-id><?supplied-pmid 21251189?><pub-id pub-id-type="pmid">21251189</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Figueirido</surname><given-names>B</given-names></name>, <name><surname>Tseng</surname><given-names>ZJ</given-names></name>, <name><surname>Martín-Serra</surname><given-names>A</given-names></name>. <article-title>Skull shape evolution in durophagous carnivorans</article-title>. <source>Evolution</source>. <year>2013</year>;<volume>67</volume>: <fpage>1975</fpage>–<lpage>1993</lpage>. <pub-id pub-id-type="doi">10.1111/evo.12059</pub-id><?supplied-pmid 23815654?><pub-id pub-id-type="pmid">23815654</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Raia</surname><given-names>P</given-names></name>, <name><surname>Carotenuto</surname><given-names>F</given-names></name>, <name><surname>Eronen</surname><given-names>JT</given-names></name>, <name><surname>Fortelius</surname><given-names>M</given-names></name>. <article-title>Longer in the tooth, shorter in the record? The evolutionary correlates of hypsodonty in Neogene ruminants</article-title>. <source>Proc R Soc B Biol Sci</source>. <year>2011</year>;<volume>278</volume>: <fpage>3474</fpage>–<lpage>3481</lpage>. <pub-id pub-id-type="doi">10.1098/rspb.2011.0273</pub-id><?supplied-pmid 21471111?><pub-id pub-id-type="pmid">21471111</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref017">
      <label>17</label>
      <mixed-citation publication-type="book"><name><surname>Janis</surname><given-names>C</given-names></name>. <chapter-title>An Evolutionary History of Browsing and Grazing Ungulates</chapter-title> In: <name><surname>Gordon</surname><given-names>IJ</given-names></name>, <name><surname>Prins</surname><given-names>HHT</given-names></name>, editors. <source>The Ecology of Browsing and Grazing</source>. <publisher-loc>Berlin, Heidelberg</publisher-loc>: <publisher-name>Springer</publisher-name>; <year>2008</year> pp. <fpage>21</fpage>–<lpage>45</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0226949.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Harmon</surname><given-names>LJ</given-names></name>, <name><surname>Kolbe</surname><given-names>JJ</given-names></name>, <name><surname>Cheverud</surname><given-names>JM</given-names></name>, <name><surname>Losos</surname><given-names>JB</given-names></name>. <article-title>Convergence and the multidimensional niche</article-title>. <source>Evolution</source>. <year>2005</year>;<volume>59</volume>: <fpage>409</fpage>–<lpage>421</lpage>. <pub-id pub-id-type="doi">10.1111/j.0014-3820.2005.tb00999.x</pub-id><?supplied-pmid 15807425?><pub-id pub-id-type="pmid">15807425</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Losos</surname><given-names>JB</given-names></name>. <article-title>The Evolution of Convergent Structure in Caribbean Anolis Communities</article-title>. <source>Syst. Biol</source>. <year>1992</year>; <volume>41</volume>:<fpage>403</fpage>–<lpage>420</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0226949.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Christiansen</surname><given-names>P</given-names></name>. <article-title>Evolutionary convergence of primitive sabertooth craniomandibular morphology: the clouded leopard (<italic>Neofelis nebulosa</italic>) and <italic>Paramachairodus ogygia</italic> compared</article-title>. <source>J Mammal Evol</source>. <year>2008</year>;<volume>15</volume>: <fpage>155</fpage>–<lpage>179</lpage>. <pub-id pub-id-type="doi">10.1007/s10914-007-9069-z</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref021">
      <label>21</label>
      <mixed-citation publication-type="book"><name><surname>McGhee</surname><given-names>GR</given-names></name>. <source>Convergent Evolution: Limited Forms Most Beautiful</source>. <publisher-name>MIT Press</publisher-name>; <year>2011</year>.</mixed-citation>
    </ref>
    <ref id="pone.0226949.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Stayton</surname><given-names>CT</given-names></name>. <article-title>The definition, recognition, and interpretation of convergent evolution, and two new measures for quantifying and assessing the significance of convergence</article-title>. <source>Evolution</source>. <year>2015</year>;<volume>69</volume>: <fpage>2140</fpage>–<lpage>2153</lpage>. <pub-id pub-id-type="doi">10.1111/evo.12729</pub-id><?supplied-pmid 26177938?><pub-id pub-id-type="pmid">26177938</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Stayton</surname><given-names>CT</given-names></name>. <article-title>Testing hypotheses of convergence with multivariate data: morphological and functional convergence among herbivorous lizards</article-title>. <source>Evolution</source>. <year>2006</year>;<volume>60</volume>: <fpage>824</fpage>–<lpage>841</lpage>. <pub-id pub-id-type="doi">10.1111/j.0014-3820.2006.tb01160.x</pub-id><?supplied-pmid 16739463?><pub-id pub-id-type="pmid">16739463</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Ingram</surname><given-names>T</given-names></name>, <name><surname>Mahler</surname><given-names>DL</given-names></name>. <article-title>SURFACE: detecting convergent evolution from comparative data by fitting Ornstein-Uhlenbeck models with stepwise Akaike Information Criterion</article-title>. <name><surname>Hansen</surname><given-names>T</given-names></name>, editor. <source>Met Ecol Evol</source>. <year>2013</year>;<volume>4</volume>: <fpage>416</fpage>–<lpage>425</lpage>. <pub-id pub-id-type="doi">10.1111/2041-210X.12034</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Muschick</surname><given-names>M</given-names></name>, <name><surname>Indermaur</surname><given-names>A</given-names></name>, <name><surname>Salzburger</surname><given-names>W</given-names></name>. <article-title>Convergent Evolution within an Adaptive Radiation of Cichlid Fishes</article-title>. <source>Curr Biol</source>. <year>2012</year>;<volume>22</volume>: <fpage>2362</fpage>–<lpage>2368</lpage>. <pub-id pub-id-type="doi">10.1016/j.cub.2012.10.048</pub-id><?supplied-pmid 23159601?><pub-id pub-id-type="pmid">23159601</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Adams</surname><given-names>DC</given-names></name>, <name><surname>Collyer</surname><given-names>ML</given-names></name>. <article-title>A general framework for the analysis of phenotypic trajectories in evolutionary studies</article-title>. <source>Evolution</source>. <year>2009</year>;<volume>63</volume>: <fpage>1143</fpage>–<lpage>1154</lpage>. <pub-id pub-id-type="doi">10.1111/j.1558-5646.2009.00649.x</pub-id><?supplied-pmid 19210539?><pub-id pub-id-type="pmid">19210539</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Adams</surname><given-names>DC</given-names></name>, <name><surname>Collyer</surname><given-names>ML</given-names></name>. <article-title>Multivariate Phylogenetic Comparative Methods: Evaluations, Comparisons, and Recommendations</article-title>. <source>Syst Biol</source>. <year>2017</year>;<volume>67</volume>: <fpage>14</fpage>–<lpage>31</lpage>. <pub-id pub-id-type="doi">10.1093/sysbio/syx055</pub-id><?supplied-pmid 28633306?><pub-id pub-id-type="pmid">28633306</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Castiglione</surname><given-names>S</given-names></name>, <name><surname>Tesone</surname><given-names>G</given-names></name>, <name><surname>Piccolo</surname><given-names>M</given-names></name>, <name><surname>Melchionna</surname><given-names>M</given-names></name>, <name><surname>Mondanaro</surname><given-names>A</given-names></name>, <name><surname>Serio</surname><given-names>C</given-names></name>, <etal>et al</etal><article-title>A new method for testing evolutionary rate variation and shifts in phenotypic evolution</article-title>. <source>Met Ecol Evol</source>. <year>2018</year>;<volume>62</volume>: <fpage>181</fpage>–<lpage>10</lpage>. <pub-id pub-id-type="doi">10.1111/2041-210X.12954</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref029">
      <label>29</label>
      <mixed-citation publication-type="book"><name><surname>James</surname><given-names>G</given-names></name>, <name><surname>Witten</surname><given-names>D</given-names></name>, <name><surname>Hastie</surname><given-names>T</given-names></name>, <name><surname>Tibshirani</surname><given-names>R</given-names></name>. <source>An Introduction to Statistical Learning</source>. <publisher-loc>New York, NY</publisher-loc>: <publisher-name>Springer Science &amp; Business Media</publisher-name>; <year>2013</year>.</mixed-citation>
    </ref>
    <ref id="pone.0226949.ref030">
      <label>30</label>
      <mixed-citation publication-type="book"><name><surname>Zelditch</surname><given-names>ML</given-names></name>, <name><surname>Swiderski</surname><given-names>DL</given-names></name>, <name><surname>Sheets</surname><given-names>HD</given-names></name>. <source>Geometric Morphometrics for Biologists</source>. <publisher-name>Academic Press</publisher-name>; <year>2012</year>.</mixed-citation>
    </ref>
    <ref id="pone.0226949.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Revell</surname><given-names>LJ</given-names></name>, <name><surname>Johnson</surname><given-names>MA</given-names></name>, <name><surname>Schulte</surname><given-names>JA</given-names></name>, <name><surname>Kolbe</surname><given-names>JJ</given-names></name>, <name><surname>Losos</surname><given-names>JB</given-names></name>. <article-title>A phylogenetic test for adaptive convergence in rock-dwelling lizards</article-title>. <source>Evolution</source>. <edition>2nd edition</edition><year>2007</year>;<volume>61</volume>: <fpage>2898</fpage>–<lpage>2912</lpage>. <pub-id pub-id-type="doi">10.1111/j.1558-5646.2007.00225.x</pub-id><?supplied-pmid 17894806?><pub-id pub-id-type="pmid">17894806</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Slater</surname><given-names>GJ</given-names></name>, <name><surname>Harmon</surname><given-names>LJ</given-names></name>, <name><surname>Alfaro</surname><given-names>ME</given-names></name>. <article-title>Integrating fossils with molecular phylogenies improves inference of trait evolution</article-title>. <source>Evolution</source>. <year>2012</year>;<volume>66</volume>: <fpage>3931</fpage>–<lpage>3944</lpage>. <pub-id pub-id-type="doi">10.1111/j.1558-5646.2012.01723.x</pub-id><?supplied-pmid 23206147?><pub-id pub-id-type="pmid">23206147</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Slater</surname><given-names>GJ</given-names></name>, <name><surname>Harmon</surname><given-names>LJ</given-names></name>. <article-title>Unifying fossils and phylogenies for comparative analyses of diversification and trait evolution</article-title>. <source>Met Ecol Evol</source>. <year>2013</year>;<volume>4</volume>: <fpage>699</fpage>–<lpage>702</lpage>. <pub-id pub-id-type="doi">10.1111/2041-210X.12091</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref034">
      <label>34</label>
      <mixed-citation publication-type="other">Oksanen J, Blanchet FG, Friendly M, Kindt R, Legendre P, Mcglinn D, et al. vegan: Community Ecology Package. R package version 2.5–2. 2018. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=vegan">https://CRAN.R-project.org/package=vegan</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Harmon</surname><given-names>LJ</given-names></name>, <name><surname>Weir</surname><given-names>JT</given-names></name>, <name><surname>Brock</surname><given-names>CD</given-names></name>, <name><surname>Glor</surname><given-names>RE</given-names></name>, <name><surname>Challenger</surname><given-names>W</given-names></name>. 2007. <article-title>GEIGER: investigating evolutionary radiations</article-title>. <source>Bioinformatics</source>. <year>2007</year>; <volume>24</volume>: <fpage>129</fpage>–<lpage>131</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btm538</pub-id><?supplied-pmid 18006550?><pub-id pub-id-type="pmid">18006550</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Revell</surname><given-names>LJ</given-names></name>. <article-title>phytools: an R package for phylogenetic comparative biology (and other things)</article-title>. <source>Met Ecol Evol</source>. <year>2012</year>;<volume>3</volume>: <fpage>217</fpage>–<lpage>223</lpage>. <pub-id pub-id-type="doi">10.1111/j.2041-210X.2011.00169.x</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref037">
      <label>37</label>
      <mixed-citation publication-type="other">Stadler T. TreeSim: Simulating Phylogenetic Trees. R package version 2.3.; 2019; <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=TreeSim">https://CRAN.R-project.org/package=TreeSim</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Piras</surname><given-names>P</given-names></name>, <name><surname>Silvestro</surname><given-names>D</given-names></name>, <name><surname>Carotenuto</surname><given-names>F</given-names></name>, <name><surname>Castiglione</surname><given-names>S</given-names></name>, <name><surname>Kotsakis</surname><given-names>A</given-names></name>, <name><surname>Maiorino</surname><given-names>L</given-names></name>, <etal>et al</etal><article-title>Evolution of the sabertooth mandible: A deadly ecomorphological specialization</article-title>. <source>Palaeogeogr Palaeoclimatol Palaeoecol. Elsevier</source>; <year>2018</year>;<volume>496</volume>: <fpage>166</fpage>–<lpage>174</lpage>. <pub-id pub-id-type="doi">10.1016/j.palaeo.2018.01.034</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Christiansen</surname><given-names>P</given-names></name>. <article-title>Canine morphology in the larger Felidae: implications for feeding ecology</article-title>. <source>Biological Journal of the Linnean Society. Blackwell Publishing Ltd</source>; <year>2007</year>;<volume>91</volume>: <fpage>573</fpage>–<lpage>592</lpage>. <pub-id pub-id-type="doi">10.1111/j.1095-8312.2007.00819.x</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref040">
      <label>40</label>
      <mixed-citation publication-type="other">Stayton, CT. convevol: Analysis of Convergent Evolution. R package version 1.3; 2018; <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=convevol">https://CRAN.R-project.org/package=convevol</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Mw</surname><given-names>Demment</given-names></name>, <name><surname>Pj</surname><given-names>Vansoest</given-names></name>. <article-title>A Nutritional Explanation for Body-Size Patterns of Ruminant and Nonruminant Herbivores</article-title>. <source>Am Nat</source>. <year>1985</year>;<volume>125</volume>: <fpage>641</fpage>–<lpage>672</lpage>. <pub-id pub-id-type="doi">10.1086/284369</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Figueirido</surname><given-names>B</given-names></name>, <name><surname>Janis</surname><given-names>CM</given-names></name>, <name><surname>Pérez-Claros</surname><given-names>JA</given-names></name>, <name><surname>De Renzi</surname><given-names>M</given-names></name>, <name><surname>Palmqvist</surname><given-names>P</given-names></name>. <article-title>Cenozoic climate change influences mammalian evolutionary dynamics</article-title>. <source>Proceedings of the National Academy of Sciences. National Academy of Sciences</source>; <year>2012</year>;<volume>109</volume>: <fpage>722</fpage>–<lpage>727</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1110246108</pub-id><?supplied-pmid 22203974?><pub-id pub-id-type="pmid">22203974</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Janis</surname><given-names>CM</given-names></name>. <article-title>Tertiary mammal evolution in the context of changing climates, vegetation, and tectonic events</article-title>. <source>Annu Rev Ecol Syst</source>. <year>1993</year>;<volume>24</volume>: <fpage>467</fpage>–<lpage>500</lpage>. <pub-id pub-id-type="doi">10.1146/annurev.es.24.110193.002343</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Mendoza</surname><given-names>M</given-names></name>, <name><surname>Janis</surname><given-names>CM</given-names></name>, <name><surname>Palmqvist</surname><given-names>P</given-names></name>. <article-title>Characterizing complex craniodental patterns related to feeding behaviour in ungulates: a multivariate approach</article-title>. <source>J Zool</source>. <year>2002</year>;<volume>258</volume>: <fpage>223</fpage>–<lpage>246</lpage>. <pub-id pub-id-type="doi">10.1017/S0952836902001346</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Damuth</surname><given-names>J</given-names></name>, <name><surname>Janis</surname><given-names>CM</given-names></name>. <article-title>On the relationship between hypsodonty and feeding ecology in ungulate mammals, and its utility in palaeoecology</article-title>. <source>Biol Rev</source>. <year>2011</year>;<volume>86</volume>: <fpage>733</fpage>–<lpage>758</lpage>. <pub-id pub-id-type="doi">10.1111/j.1469-185X.2011.00176.x</pub-id><?supplied-pmid 21418504?><pub-id pub-id-type="pmid">21418504</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Raia</surname><given-names>P</given-names></name>, <name><surname>Carotenuto</surname><given-names>F</given-names></name>, <name><surname>Meloro</surname><given-names>C</given-names></name>, <name><surname>Piras</surname><given-names>P</given-names></name>, <name><surname>Pushkina</surname><given-names>D</given-names></name>. <article-title>The shape of contention: adaptation, history, and contingency in ungulate mandibles</article-title>. <source>Evolution</source>. <year>2010</year>;<volume>64</volume>: <fpage>1489</fpage>–<lpage>1503</lpage>. <pub-id pub-id-type="doi">10.1111/j.1558-5646.2009.00921.x</pub-id><?supplied-pmid 20015238?><pub-id pub-id-type="pmid">20015238</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Raia</surname><given-names>P</given-names></name>, <name><surname>Carotenuto</surname><given-names>F</given-names></name>, <name><surname>Passaro</surname><given-names>F</given-names></name>, <name><surname>Piras</surname><given-names>P</given-names></name>, <name><surname>Fulgione</surname><given-names>D</given-names></name>, <name><surname>Werdelin</surname><given-names>L</given-names></name>, <etal>et al</etal><article-title>Rapid action in the Palaeogene, the relationship between phenotypic and taxonomic diversification in Coenozoic mammals</article-title>. <source>Proc R Soc B Biol Sci</source>. <year>2013</year>;<volume>280</volume>: <fpage>20122244</fpage>–<lpage>20122244</lpage>. <pub-id pub-id-type="doi">10.1098/rspb.2012.2244</pub-id><?supplied-pmid 23173207?><pub-id pub-id-type="pmid">23173207</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Mahler</surname><given-names>DL</given-names></name>, <name><surname>Ingram</surname><given-names>T</given-names></name>, <name><surname>Revell</surname><given-names>LJ</given-names></name>, <name><surname>Losos</surname><given-names>JB</given-names></name>. <article-title>Exceptional Convergence on the Macroevolutionary Landscape in Island Lizard Radiations</article-title>. <source>Science. American Association for the Advancement of Science</source>; <year>2013</year>;<volume>341</volume>: <fpage>292</fpage>–<lpage>295</lpage>. <pub-id pub-id-type="doi">10.1126/science.1232392</pub-id><?supplied-pmid 23869019?><pub-id pub-id-type="pmid">23869019</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Mahler</surname><given-names>DL</given-names></name>, <name><surname>Revell</surname><given-names>LJ</given-names></name>, <name><surname>Glor</surname><given-names>RE</given-names></name>, <name><surname>Losos</surname><given-names>JB</given-names></name>. <article-title>Ecological opportunity and the rate of morphological evolution in the diversification of greater antillean anoles</article-title>. <source>Evolution. Blackwell Publishing Inc</source>; <year>2010</year>;<volume>64</volume>: <fpage>2731</fpage>–<lpage>2745</lpage>. <pub-id pub-id-type="doi">10.1111/j.1558-5646.2010.01026.x</pub-id><?supplied-pmid 20455931?><pub-id pub-id-type="pmid">20455931</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref050">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Sanger</surname><given-names>TJ</given-names></name>, <name><surname>Revell</surname><given-names>LJ</given-names></name>, <name><surname>Gibson-Brown</surname><given-names>JJ</given-names></name>, <name><surname>Losos</surname><given-names>JB</given-names></name>. <article-title>Repeated modification of early limb morphogenesis programmes underlies the convergence of relative limb length in Anolis lizards</article-title>. <source>Proc R Soc B Biol Sci</source>. <year>2012</year>;<volume>279</volume>: <fpage>739</fpage>–<lpage>748</lpage>. <pub-id pub-id-type="doi">10.1098/rspb.2011.0840</pub-id><?supplied-pmid 21849319?><pub-id pub-id-type="pmid">21849319</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref051">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Losos</surname><given-names>JB</given-names></name>. <article-title>Convergence, adaptation, and constraint</article-title>. <source>Evolution</source>. <year>2011</year>;<volume>65</volume>: <fpage>1827</fpage>–<lpage>1840</lpage>. <pub-id pub-id-type="doi">10.1111/j.1558-5646.2011.01289.x</pub-id><?supplied-pmid 21729041?><pub-id pub-id-type="pmid">21729041</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Piras</surname><given-names>P</given-names></name>, <name><surname>Maiorino</surname><given-names>L</given-names></name>, <name><surname>Raia</surname><given-names>P</given-names></name>, <name><surname>Marcolini</surname><given-names>F</given-names></name>, <name><surname>Salvi</surname><given-names>D</given-names></name>. <article-title>Functional and phylogenetic constraints in Rhinocerotinae craniodental morphology</article-title>. <source>Evol Ecol Res</source>. <year>2010</year>;<volume>128</volume>: <fpage>897</fpage>–<lpage>928</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0226949.ref053">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Meloro</surname><given-names>C</given-names></name>, <name><surname>Clauss</surname><given-names>M</given-names></name>, <name><surname>Raia</surname><given-names>P</given-names></name>. <article-title>Ecomorphology of Carnivora challenges convergent evolution</article-title>. <source>Org Divers Evol</source>. <year>2015</year>;<volume>15</volume>: <fpage>711</fpage>–<lpage>720</lpage>. <pub-id pub-id-type="doi">10.1007/s13127-015-0227-5</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref054">
      <label>54</label>
      <mixed-citation publication-type="journal"><name><surname>Arbuckle</surname><given-names>K</given-names></name>, <name><surname>Bennett</surname><given-names>CM</given-names></name>, <name><surname>Speed</surname><given-names>MP</given-names></name>. <article-title>A simple measure of the strength of convergent evolution</article-title>. <name><surname>Münkemüller</surname><given-names>T</given-names></name>, editor. <source>Met Ecol Evol</source>. <year>2014</year>;<volume>5</volume>: <fpage>685</fpage>–<lpage>693</lpage>. <pub-id pub-id-type="doi">10.1111/2041-210X.12195</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref055">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>Christiansen</surname><given-names>P</given-names></name>. <article-title>Canine morphology in the larger Felidae: implications for feeding ecology</article-title>. <source>Biol J Linn Soc</source>. <year>2007</year>;<volume>91</volume>: <fpage>573</fpage>–<lpage>592</lpage>. <pub-id pub-id-type="doi">10.1111/j.1095-8312.2007.00819.x</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226949.ref056">
      <label>56</label>
      <mixed-citation publication-type="journal"><name><surname>Meachen-Samuels</surname><given-names>JA</given-names></name>. <article-title>Morphological convergence of the prey-killing arsenal of sabertooth predators</article-title>. <source>Paleobiology</source>. <year>2012</year>;<volume>38</volume>: <fpage>1</fpage>–<lpage>14</lpage>. <pub-id pub-id-type="doi">10.1017/S0094837300000373</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
