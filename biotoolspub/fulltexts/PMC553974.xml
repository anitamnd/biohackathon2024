<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id>
    <journal-title>BMC Genomics</journal-title>
    <issn pub-type="epub">1471-2164</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">553974</article-id>
    <article-id pub-id-type="publisher-id">1471-2164-6-16</article-id>
    <article-id pub-id-type="pmid">15710039</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2164-6-16</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A class of models for analyzing GeneChip<sup>® </sup>gene expression analysis array data</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" contrib-type="author">
        <name>
          <surname>Fan</surname>
          <given-names>Wenhong</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>wfan@fhcrc.org</email>
      </contrib>
      <contrib id="A2" contrib-type="author">
        <name>
          <surname>Pritchard</surname>
          <given-names>Joel I</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>pritchaj@u.washington.edu</email>
      </contrib>
      <contrib id="A3" contrib-type="author">
        <name>
          <surname>Olson</surname>
          <given-names>James M</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>jolson@fhcrc.org</email>
      </contrib>
      <contrib id="A4" contrib-type="author">
        <name>
          <surname>Khalid</surname>
          <given-names>Najma</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>nkhalid@fhcrc.org</email>
      </contrib>
      <contrib id="A5" corresp="yes" contrib-type="author">
        <name>
          <surname>Zhao</surname>
          <given-names>Lue Ping</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>lzhao@fhcrc.org</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Division of Public Health Sciences, Fred Hutchinson Cancer Research Center, 1100 Fairview Ave. N., Seattle, WA 98109, USA</aff>
    <aff id="I2"><label>2</label>Clinical Research Division, Fred Hutchinson Cancer Research Center, 1100 Fairview Ave. N., Seattle, WA 98109, USA</aff>
    <pub-date pub-type="collection">
      <year>2005</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>2</month>
      <year>2005</year>
    </pub-date>
    <volume>6</volume>
    <fpage>16</fpage>
    <lpage>16</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2164/6/16"/>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>7</month>
        <year>2004</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>2</month>
        <year>2005</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2005 Fan et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2005</copyright-year>
      <copyright-holder>Fan et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Fan
               Wenhong
               
               wfan@fhcrc.org
            </dc:author><dc:title>
            A class of models for analyzing GeneChip&#x000ae; gene expression analysis array data
         </dc:title><dc:date>2005</dc:date><dcterms:bibliographicCitation>BMC Genomics 6(1): 16-. (2005)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2164(2005)6:1&#x0003c;16&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2164</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Various analytical methods exist that first quantify gene expression and then analyze differentially expressed genes from Affymetrix GeneChip<sup>® </sup>gene expression analysis array data. These methods differ in the choice of probe measure (quantification of probe hybridization), summarizing multiple probe intensities into a gene expression value, and analysis of differential gene expression. Research papers that describe these methods focus on performance, and how their approaches differ from others. To better understand the common features and differences between various methods, and to evaluate their impact on the results of gene expression analysis, we describe a class of models, referred to as generalized probe models (GPMs), which encompass various currently available methods.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>Using an empirical dataset, we compared different formulations of GPMs, and GPMs with three other commonly used methods, i.e. MAS 5.0, dChip, and RMA. The comparison shows that, <bold><italic>on a genome-wide scale </italic></bold>, different methods yield similar results if the same probe measures are chosen.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>In this paper we present a general framework, i.e. GPMs, which encompasses various methods. GPMs permit the use of a wide range of probe measures and facilitate appropriate comparison between commonly used methods. We demonstrate that the dissimilar results stem primarily from different choice of probe measures, rather than other factors.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Microarray experiments are routinely conducted to assess associations of experimental factors (or disease outcomes) with gene expression profiles. The Affymetrix GeneChip<sup>® </sup>gene expression analysis array, one of most commonly used microarray technologies, uses multiple oligonuleotides (25-mers) to measure expression abundance of a single gene. Recognizing that non-specific hybridization could significantly alter the accurate quantification of transcript abundance, Affymetrix designs the array to contain two types of probes. Probes that are perfectly complementary to the target sequence, called Perfect Matches (PM), are intended to measure mainly specific hybridization. A second set of probes identical to PM except for a single nucleotide in the center of the probe sequence (the 13<sup>th </sup>nucleotide), called Mismatches (MM), are intended to quantify non-specific hybridization [<xref ref-type="bibr" rid="B1">1</xref>]. A PM and its corresponding MM constitutes a probe pair, and multiple probe pairs, i.e. a probe set, are summarized to measure transcript abundance for a particular gene. "Probe measure" is used in this paper to refer to the manner in which probe hybridization is quantified based on a pair of PM and MM intensity values. For example, PM-MM is a probe measure, and PM only is another probe measure.</p>
    <p>A number of methods have been developed to quantify gene expression abundance from GeneChip<sup>® </sup>expression analysis array data using different probe measures and summary schemes. Among them, Microarray Suite 5.0 (MAS 5.0) [<xref ref-type="bibr" rid="B1">1</xref>], dChip [<xref ref-type="bibr" rid="B2">2</xref>] and robust multiple-array average (RMA) [<xref ref-type="bibr" rid="B3">3</xref>] are the best known.</p>
    <p>Prior to MAS 5.0, the probe measure used in MAS 4.0 was PM-MM [<xref ref-type="bibr" rid="B4">4</xref>]. The problem arises when a significant proportion of MM values, (~33% in the HuGeneFL array and ~25% in the Human Genome U133A array), is greater than the corresponding PM values, which makes PM-MM negative. To resolve this anomaly, in MAS 5.0, Affymetrix computes an "ideal mismatch" (IM) based on missing data theory such that PM-IM is always greater than zero [<xref ref-type="bibr" rid="B1">1</xref>]. Then, all probe pairs are used to estimate a gene expression value based on Tukey's Biweight algorithm. However, even with the use of IM, the variation among probes could be greater than between samples.</p>
    <p>Li and Wong modelled probe level data to generate model based expression index (MBEI) and implemented it in the dChip software [<xref ref-type="bibr" rid="B2">2</xref>]. Noting that probe specificity is significant, highly reproducible and predictable, Li and Wong used a hybridization rate parameter to account for the hybridization specificity for a probe. For a probe pair, hybridization rates are different for PM and MM; the former is always greater than the latter, and both are greater than zero. The rate was fixed for the same probe across all the samples. Both PM and MM together or PM only, can be used in the Li and Wong model.</p>
    <p>Another approach, RMA, available from Bioconductor [<xref ref-type="bibr" rid="B5">5</xref>], summarizes probe intensities into a gene expression measure based on an additive model on the logarithmic scale of a background corrected PM (PM<sub>rma</sub>) [<xref ref-type="bibr" rid="B3">3</xref>]. RMA estimates a common mean non-specific hybridization background (for an entire chip) from PM using a convolution model and then subtracts this background from PM to generate the PM<sub>rma</sub>.</p>
    <p>The gene expression obtained from either MAS 5.0 or dChip or RMA can then be used to associate the gene expression values with experimental factors using an algorithm of the users' choice. Three main factors affect the analytical results of differential gene expression analysis: the probe measure chosen, the algorithm used to summarize probe level data into gene expression (called summary algorithm in this paper), and the model used to associate gene expression with the experimental factors (called association model). Direct comparisons of the various approaches proposed for analyzing GeneChip<sup>® </sup>gene expression data are complicated considering these three factors. Generalizing the various algorithms into one framework would facilitate comparisons.</p>
    <p>In this paper we propose a class of generalized probe models (GPMs) that includes various analytical approaches for GeneChip<sup>® </sup>gene expression analysis array data as special cases. Using an empirical dataset, we assess the impact of different processes on the analytical results by comparing different formulations of GPM as well as GPMs with three other methods, MAS 5.0, dChip, and RMA.</p>
  </sec>
  <sec>
    <title>Results</title>
    <p>We applied GPM to the analyses of data obtained from a study investigating gene response to ATRA (all trans retinoic acid) or drug diluent (ETOH, ethyl alcohol). Briefly, at twenty-four hours after treatment, total RNA was extracted from cells, processed and hybridized to the HuGeneFL GeneChip<sup>®</sup>. The dataset consists of ten samples from the ATRA treatment group and ten samples from the control group (ETOH treated) in four medulloblastoma cell lines. We are interested in identifying genes that are differentially expressed between the two treatment groups.</p>
    <p>We used three different probe measures: PM-IM, PM only and PM<sub>rma</sub>, and compared the performance of different methods using standardized coefficients, defined as the estimated coefficient divided by its standard error. The reason for using this index is that the standardized coefficients, usually known as Z-score test statistics, are independent of scale, and may be used to make statistical inference.</p>
    <p>GPM-1 (2), GPM-2 (3) and GPM-3 (4) can be derived from the full GPM model (1) by making different statistical modeling assumptions. GPM-1 takes summarized gene expressions and associates them with experimental factors; GPM-2 and GPM-3 directly associate probe level data with experimental factors without first summarizing gene expressions (see Methods).</p>
    <sec>
      <title>Comparison of GPMs with three other commonly used methods</title>
      <p>We compared GPMs with three commonly used methods, i.e. MAS 5.0, dChip, and RMA. Each of these methods dictates its own specific probe measure, i.e. PM-IM in MAS 5.0, PM-MM, or PM only in dChip and PM<sub>rma </sub>in RMA. We found that all the methods were similar when the same probe measure was used, and the dissimilarity between the MAS 5.0 and other PM based approaches most likely stems from the different probe measure used. We first computed the gene expression using the software available for MAS 5.0, dChip (using the PM only option) and RMA, and then estimated the standardized coefficients for each gene with the association model GPM-1. We refer to these analytical options as MAS 5.0 PM-IM and hereafter (in MAS 5.0 PM-IM we omitted the term GPM-1 which indicates the association model used since GPM-1 is the only one in GPMs that handles gene expression values), dChip PM and RMA PM<sub>rma</sub>, respectively. Figure <xref ref-type="fig" rid="F1">1</xref> shows the pair-wise comparisons among MAS 5.0 PM-IM, dChip PM, and RMA PM<sub>rma</sub>. For each pair-wise comparison, we plotted the standardized coefficients for each pair in a XY plot. To assess the similarity between two methods, we computed the correlation coefficients (R) between the standardized coefficients generated from the two methods. In addition, we computed the mean squared error (MSE) between the two standardized coefficients, i.e. <inline-graphic xlink:href="1471-2164-6-16-i1.gif"/>, where <italic>N </italic>is total number of genes, <italic>Z</italic><sub><italic>j</italic>1 </sub>and <italic>Z</italic><sub><italic>j</italic>2 </sub>are the standardized coefficients for <italic>j </italic>th gene, for two methods, respectively. When two methods are similar, the XY plot of their standardized coefficients will lie closely along the diagonal line. Correspondingly, the correlation coefficient will be closer to one and the MSE will be closer to zero. In Figure <xref ref-type="fig" rid="F1">1</xref>, we see smaller R and larger MSE in the comparisons of MAS 5.0 PM-IM versus dChip PM, and MAS 5.0 PM-IM versus RMA PM<sub>rma </sub>compared to dChip PM versus RMA PM<sub>rma</sub>.</p>
      <fig position="float" id="F1">
        <label>Figure 1</label>
        <caption>
          <p><bold>Comparison among MAS 5.0, dChip and RMA. </bold>Gene expression was computed from MAS 5.0, dChip, and RMA using the probe measure dictated in the methods. Standardized coefficients for each method were estimated using the association model GPM-1 and were plotted pair-wise.</p>
        </caption>
        <graphic xlink:href="1471-2164-6-16-1"/>
      </fig>
      <p>Next, using probe measures of PM only and PM-IM, we directly (in a single step) estimated standardized coefficients with GPM-2 (referred as GPM-2 PM and GPM-2 PM-IM. We omitted the term which indicates the summary algorithm since GPM-2 and GPM-3 directly associate the probe level data with the experimental factors without first summarizing across all probes) and GPM-3, respectively. Figure <xref ref-type="fig" rid="F2">2</xref> shows the pair-wise comparisons among MAS 5.0 PM-IM, GPM-2 PM, GPM-3 PM, GPM-2 PM-IM, and GPM-3 PM-IM. We see greater similarity between MAS 5.0 PM-IM and GPM-2 PM-IM or GPM-3 PM-IM (Figure <xref ref-type="fig" rid="F2">2</xref>, second row), than between MAS 5.0 PM-IM and GPM-2 PM or GPM-3 PM (Figure <xref ref-type="fig" rid="F2">2</xref>, first row). In the latter comparisons, only the probe measure is different indicating that the probe measure plays a more significant role than the combined effect of the summary algorithm and the association model.</p>
      <fig position="float" id="F2">
        <label>Figure 2</label>
        <caption>
          <p><bold>Impact of probe measure on analytical results. </bold>Gene expression from MAS 5.0 was used to estimate standardized coefficients using the association model GPM-1. Either PM-IM or PM only was used directly in GPM-2 or GPM-3 models. Standardized coefficients were plotted pair-wise.</p>
        </caption>
        <graphic xlink:href="1471-2164-6-16-2"/>
      </fig>
    </sec>
    <sec>
      <title>Comparison among the GPMs</title>
      <p>We also compared the results from GPM-1 (2), GPM-2 (3) and GPM-3 (4), to evaluate their differences, and found similar results when using the same probe measure. We selected the top eight candidate genes from the results of MAS 5.0 PM-IM and used them to compare the performance of GPM-2 PM-IM and GPM-3 PM-IM. In Table <xref ref-type="table" rid="T1">1</xref>, for the eight selected genes we list estimated coefficients, their standard errors and standardized coefficients, estimated under the three GPM models. From Table <xref ref-type="table" rid="T1">1</xref>, for these eight selected genes, the statistics generated from the three GPMs formulation are similar using probe measure of PM-IM. Next, to compare the standardized coefficients on a genome-wide scale, Figure <xref ref-type="fig" rid="F3">3</xref> panel A shows the pair-wise comparisons using probe measure of PM-IM. Figure <xref ref-type="fig" rid="F3">3</xref> panel B shows the pair-wise comparisons using PM only and PM<sub>rma</sub>. The six plots in Figure <xref ref-type="fig" rid="F3">3</xref> demonstrate the similarity of standardized coefficients on a genome-wide scale among variants of GPMs when the same (or similar, in the case of PM versus PM<sub>rma</sub>) probe measures are used in the analyses.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>Estimated parameters for eight candidate genes from GPMs</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="left">
                <bold>Probe set ID</bold>
              </td>
              <td align="center" colspan="3">
                <bold>Y00291_at</bold>
              </td>
              <td align="center" colspan="3">
                <bold>L13738_at</bold>
              </td>
              <td align="center" colspan="3">
                <bold>D79990_at</bold>
              </td>
              <td align="center" colspan="3">
                <bold>M13666_at</bold>
              </td>
              <td align="center" colspan="3">
                <bold>X02158_rna1_at</bold>
              </td>
              <td align="center" colspan="3">
                <bold>X84002_at</bold>
              </td>
              <td align="center" colspan="3">
                <bold>L19605_at</bold>
              </td>
              <td align="center" colspan="3">
                <bold>M60503_at</bold>
              </td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">
                <bold>Parameters</bold>
              </td>
              <td align="center">
                <bold>
                  <italic>β</italic>
                </bold>
              </td>
              <td align="center">
                <bold>
                  <italic>SE</italic>
                </bold>
              </td>
              <td align="center">
                <bold>
                  <italic>Z</italic>
                </bold>
              </td>
              <td align="center">
                <bold>
                  <italic>β</italic>
                </bold>
              </td>
              <td align="center">
                <bold>
                  <italic>SE</italic>
                </bold>
              </td>
              <td align="center">
                <bold>
                  <italic>Z</italic>
                </bold>
              </td>
              <td align="center">
                <bold>
                  <italic>β</italic>
                </bold>
              </td>
              <td align="center">
                <bold>
                  <italic>SE</italic>
                </bold>
              </td>
              <td align="center">
                <bold>
                  <italic>Z</italic>
                </bold>
              </td>
              <td align="center">
                <bold>
                  <italic>β</italic>
                </bold>
              </td>
              <td align="center">
                <bold>
                  <italic>SE</italic>
                </bold>
              </td>
              <td align="center">
                <bold>
                  <italic>Z</italic>
                </bold>
              </td>
              <td align="center">
                <bold>
                  <italic>β</italic>
                </bold>
              </td>
              <td align="center">
                <bold>
                  <italic>SE</italic>
                </bold>
              </td>
              <td align="center">
                <bold>
                  <italic>Z</italic>
                </bold>
              </td>
              <td align="center">
                <bold>
                  <italic>β</italic>
                </bold>
              </td>
              <td align="center">
                <bold>
                  <italic>SE</italic>
                </bold>
              </td>
              <td align="center">
                <bold>
                  <italic>Z</italic>
                </bold>
              </td>
              <td align="center">
                <bold>
                  <italic>β</italic>
                </bold>
              </td>
              <td align="center">
                <bold>
                  <italic>SE</italic>
                </bold>
              </td>
              <td align="center">
                <bold>
                  <italic>Z</italic>
                </bold>
              </td>
              <td align="center">
                <bold>
                  <italic>β</italic>
                </bold>
              </td>
              <td align="center">
                <bold>
                  <italic>SE</italic>
                </bold>
              </td>
              <td align="center">
                <bold>
                  <italic>Z</italic>
                </bold>
              </td>
            </tr>
            <tr>
              <td colspan="25">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">
                <bold>GPM-1 PM-IM</bold>
              </td>
              <td align="center">3.17</td>
              <td align="center">0.48</td>
              <td align="center">6.65</td>
              <td align="center">0.80</td>
              <td align="center">0.18</td>
              <td align="center">4.50</td>
              <td align="center">3.04</td>
              <td align="center">0.68</td>
              <td align="center">4.47</td>
              <td align="center">1.07</td>
              <td align="center">0.25</td>
              <td align="center">4.24</td>
              <td align="center">-1.07</td>
              <td align="center">0.25</td>
              <td align="center">-4.24</td>
              <td align="center">0.63</td>
              <td align="center">0.15</td>
              <td align="center">4.18</td>
              <td align="center">0.51</td>
              <td align="center">0.12</td>
              <td align="center">4.16</td>
              <td align="center">-2.05</td>
              <td align="center">0.50</td>
              <td align="center">-4.13</td>
            </tr>
            <tr>
              <td align="left">
                <bold>GPM-2 PM-IM</bold>
              </td>
              <td align="center">2.79</td>
              <td align="center">0.36</td>
              <td align="center">7.74</td>
              <td align="center">0.65</td>
              <td align="center">0.13</td>
              <td align="center">4.89</td>
              <td align="center">2.92</td>
              <td align="center">0.67</td>
              <td align="center">4.3</td>
              <td align="center">1.11</td>
              <td align="center">0.24</td>
              <td align="center">4.6</td>
              <td align="center">-0.92</td>
              <td align="center">0.24</td>
              <td align="center">-3.86</td>
              <td align="center">0.33</td>
              <td align="center">0.12</td>
              <td align="center">2.63</td>
              <td align="center">0.51</td>
              <td align="center">0.09</td>
              <td align="center">5.53</td>
              <td align="center">-1.56</td>
              <td align="center">0.35</td>
              <td align="center">-4.44</td>
            </tr>
            <tr>
              <td align="left">
                <bold>GPM-3 PM-IM</bold>
              </td>
              <td align="center">3.05</td>
              <td align="center">0.35</td>
              <td align="center">8.60</td>
              <td align="center">0.71</td>
              <td align="center">0.12</td>
              <td align="center">5.69</td>
              <td align="center">3.10</td>
              <td align="center">0.63</td>
              <td align="center">4.89</td>
              <td align="center">1.31</td>
              <td align="center">0.22</td>
              <td align="center">5.93</td>
              <td align="center">-1.40</td>
              <td align="center">0.25</td>
              <td align="center">-5.73</td>
              <td align="center">0.25</td>
              <td align="center">0.11</td>
              <td align="center">2.26</td>
              <td align="center">0.52</td>
              <td align="center">0.09</td>
              <td align="center">6.02</td>
              <td align="center">-2.25</td>
              <td align="center">0.38</td>
              <td align="center">-5.96</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Estimated coefficients (<italic>β </italic>), their standard errors (<italic>SE </italic>) and standardized coefficients (<italic>Z </italic>) for eight candidate genes from GPM-1 (using MAS 5.0 expression measure), GPM-2 and GPM-3 using PM-IM</p>
        </table-wrap-foot>
      </table-wrap>
      <fig position="float" id="F3">
        <label>Figure 3</label>
        <caption>
          <p><bold>3A:Comparison among GPMs using PM-IM. </bold>Gene expression from MAS 5.0 was used to estimate standardized coefficients using the association model GPM-1. Standardized coefficients from GPM-1, GPM-2 and GPM-3 with same PM-IM probe measure were plotted pair-wise. <bold>3B: Comparison of GPM-2, GPM-3, dChip and RMA using PM. </bold>Gene expression from dChip, and RMA were used to estimate standardized coefficients using the association model GPM-1. Standardized coefficients from GPM-2, GMP-3, dChip and RMA with probe measures of PM or PM<sub>rma </sub>were plotted pair-wise.</p>
        </caption>
        <graphic xlink:href="1471-2164-6-16-3"/>
      </fig>
      <p>In summary, we conclude that the GPMs are similar to MAS 5.0, dChip and RMA on a genome-wide level when using the same probe measures and that the choice of probe measure may be more important than the summary algorithms to obtain the gene expression or models used to compute the coefficients.</p>
    </sec>
  </sec>
  <sec>
    <title>Discussion</title>
    <p>In this paper, we have described a general framework that can be used to compare various methods and evaluate their similarities and differences. We found that various methods tend to generate similar results, on a genome-wide scale, when the same probe measure is chosen, and probe measure seems to have greater impact on the analytical results than other factors.</p>
    <p>In Figure <xref ref-type="fig" rid="F1">1</xref>, we compared the standardized coefficients estimated with GPM-1 using gene expression computed from MAS 5.0, dChip and RMA with their own dictated probe measures. Since we consistently used GPM-1 as the association modeling machinery for each analysis, we assessed the combined impact of probe measure and summary algorithm. We found that the results obtained from dChip PM and RMA PM<sub>rma </sub>were similar to each other, but different from those obtained from MAS 5.0 PM-IM. Although dChip PM and RMA PM<sub>rma </sub>use different summary algorithms, their analytical results are similar due to the PM based probe measures used in both analyses.</p>
    <p>In Figure <xref ref-type="fig" rid="F2">2</xref>, we see again, that on a genome-wide scale, results from MAS 5.0, GPM-2 and GPM-3 are more similar when same probe measure is used than when the probe measures are different, indicating that the probe measure plays a key role in determining the similarity of results from two methods. Our preliminary analyses suggest that the choice of probe measure has bigger impact on the results than summary algorithm and association modeling.</p>
    <p>For the three variants of GPMs, we compared the standardized coefficients from GPM-2 or GPM-3 with those from GPM-1 using the gene expression values computed in MAS 5.0, dChip and RMA. From the high R values (and correspondingly, low MSEs) in the six plots shown in Figure <xref ref-type="fig" rid="F3">3</xref>, we infer that the standardized coefficients obtained from variants of GPMs are similar when they used the same probe measure.</p>
    <p>For seven of the eight candidate genes selected by GPM-1 using gene expression values generated by MAS 5.0, the gene-specific regression coefficients were similar among the MAS 5.0 PM-IM, GPM-2 PM-IM and GPM-3 PM-IM. This indicates that for these seven genes it makes little difference between using summary measures or modeling directly at the probe level data in GMP-2 or GPM-3, when the same probe measure is used.</p>
    <p>In addition to the three factors we mentioned (i.e. choice of probe measure, summary algorithm and association modeling) that have an impact on analytical results, data pre-processing/normalization could also affect the analytical results. Some researchers combine the probe measure and pre-processing normalization together. Normalization matters the most when the arrays in an experiment are not comparable to each other. In such cases, normalization process could significantly impact on the result. In our case, we normalized the data in the GPMs using a regression-based approach [<xref ref-type="bibr" rid="B6">6</xref>], either at probe level in GPM-2 and GPM-3, or on gene expression level in GPM-1. The expression measures obtained from dChip and RMA were normalized by their own normalization schemes. However, even with the different normalization schemes, probe measure appears to be the primary factor to impact the results in our data set.</p>
    <p>An important feature of the framework presented in this paper is that it accommodates various probe measures (see Table <xref ref-type="table" rid="T2">2</xref>) to quantify the abundance of the transcript. A question arises: how does one combine results from analyses using different probe measures. This is the dilemma we face when we analyze thousands of genes simultaneously. On the one hand, microarray technology is still imperfect and it is prudent to evaluate a number of exploratory approaches. On the other hand, by the very nature of the problem, it is unlikely that a single approach will be equally appropriate for each gene. The reality is that microarrays afford a rapid preliminary assessment of thousands of genes for future experimental validation. Ultimately, any scientific validation has to be drawn from further bench experiments.</p>
    <table-wrap position="float" id="T2">
      <label>Table 2</label>
      <caption>
        <p>A list of selected probe measures</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <td align="left">Scenario</td>
            <td align="left">Calculation</td>
            <td align="left">Annotation</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">1. MAS4.0-equivalent</td>
            <td align="left"><italic>Z</italic><sub><italic>jik </italic></sub>= (<italic>y</italic><sub><italic>ji</italic>1<italic>k </italic></sub>- <italic>y</italic><sub><italic>ji</italic>0<italic>k </italic></sub>)</td>
            <td align="left">Direct difference between PM and MM</td>
          </tr>
          <tr>
            <td align="left">2. MAS5.0-equivalent</td>
            <td align="left"><italic>Z</italic><sub><italic>jik </italic></sub>= (<italic>y</italic><sub><italic>ji</italic>1<italic>k </italic></sub>- <graphic xlink:href="1471-2164-6-16-i2.gif"/>)</td>
            <td align="left"><graphic xlink:href="1471-2164-6-16-i2.gif"/> is the Idealized Mis-match (IM)</td>
          </tr>
          <tr>
            <td align="left">3. PM only</td>
            <td align="left"><italic>Z</italic><sub><italic>jik </italic></sub>= <italic>y</italic><sub><italic>ji</italic>1<italic>k</italic></sub></td>
            <td align="left">Ignore MM</td>
          </tr>
          <tr>
            <td align="left">4. RMA-equivalent</td>
            <td align="left"><italic>Z</italic><sub><italic>jik </italic></sub>= log(<italic>y</italic><sub><italic>ji</italic>1<italic>k </italic></sub>- <graphic xlink:href="1471-2164-6-16-i3.gif"/>)</td>
            <td align="left"><graphic xlink:href="1471-2164-6-16-i3.gif"/> is the mean background estimated from PM for the k<sup>th </sup>chip</td>
          </tr>
          <tr>
            <td align="left">5. Log ratio</td>
            <td align="left"><italic>Z</italic><sub><italic>jik </italic></sub>= ln(<italic>y</italic><sub><italic>ji</italic>1<italic>k </italic></sub>/ <italic>y</italic><sub><italic>ji</italic>0<italic>k </italic></sub>)</td>
            <td align="left">Difference on the logarithmic scale</td>
          </tr>
          <tr>
            <td align="left">6. Log difference</td>
            <td align="left"><italic>Z</italic><sub><italic>jik </italic></sub>= ln(<italic>y</italic><sub><italic>ji</italic>1<italic>k </italic></sub>- <graphic xlink:href="1471-2164-6-16-i2.gif"/>)</td>
            <td align="left">Difference on the logarithmic scale</td>
          </tr>
          <tr>
            <td align="left">7. Log PM</td>
            <td align="left"><italic>Z</italic><sub><italic>jik </italic></sub>= ln(<italic>y</italic><sub><italic>ji</italic>1<italic>k </italic></sub>)</td>
            <td align="left">PM only on the logarithmic scale</td>
          </tr>
          <tr>
            <td align="left">8. Box-Cox on PM</td>
            <td align="left"><italic>Z</italic><sub><italic>jik </italic></sub>= (<graphic xlink:href="1471-2164-6-16-i4.gif"/> - 1) / <italic>ω </italic></td>
            <td align="left">Box-Cox transformation on PM only</td>
          </tr>
          <tr>
            <td align="left">9. Box-Cox on PM-IM</td>
            <td align="left"><italic>Z</italic><sub><italic>jik </italic></sub>= [(<italic>y</italic><sub><italic>ji</italic>1<italic>k </italic></sub>- <graphic xlink:href="1471-2164-6-16-i2.gif"/>)<sup><italic>ω </italic></sup>- 1] / <italic>ω </italic></td>
            <td align="left">Box-Cox transformation on PM-IM</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <p>To facilitate the evaluation and use of GPMs, we have developed a software program, called ProbePlus that implements our GPMs. This program will be made available to academic researchers through the website <ext-link ext-link-type="uri" xlink:href="http://qge.fhcrc.org/probeplus"/>.</p>
  </sec>
  <sec>
    <title>Conclusions</title>
    <p>In this paper we describe a general framework to analyze GeneChip<sup>® </sup>gene expression analysis array data. This framework is flexible to permit comparisons of different methods with respect to the choice of probe measure and analytical models used. We found that different methods yield similar result when probe measures are the same.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>The generalized probe model</title>
      <p>Consider an experimental study with <italic>K </italic>chips. Each chip is engineered to assess levels of <italic>J </italic>gene expressions. Each gene has <italic>I </italic>probe pairs. Now let <italic>y</italic><sub><italic>jilk </italic></sub>denote the intensity value for the <italic>j</italic>th gene (<italic>j </italic>= 1,2...<italic>J</italic>), the <italic>i</italic>th probe pair (<italic>i </italic>= 1,2...<italic>I</italic>), PM (<italic>l </italic>= 1) or MM (<italic>l </italic>= 0), and the <italic>k</italic>th sample (<italic>k </italic>= 1,2...<italic>K</italic>). Table <xref ref-type="table" rid="T3">3</xref> displays the notation for a typical microarray dataset. The probe intensity <italic>y</italic><sub><italic>jilk </italic></sub>, quantifying the abundance of the RNA hybridized on a probe, is treated as a random variable, influenced by the effects of probe-specific hybridization, gene-specific hybridization, non-specific hybridization and random noise. In this paper we use <italic>Z</italic><sub><italic>jik </italic></sub>to denote the quantification of the signal of the <italic>i</italic>th probe, in the <italic>j</italic>th gene from the <italic>k</italic>th sample. <italic>Z</italic><sub><italic>jik </italic></sub>could be based on any probe measure, such as PM only or PM-IM (some other selected probe measures are listed in Table <xref ref-type="table" rid="T2">2</xref>).</p>
      <table-wrap position="float" id="T3">
        <label>Table 3</label>
        <caption>
          <p>A typical probe-level data generated from GeneChip<sup>® </sup>gene expression analysis array</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="left">Sample ID</td>
              <td align="left">Probe</td>
              <td align="left">PM (1)</td>
              <td align="left">1</td>
              <td align="left">2</td>
              <td align="left">...</td>
              <td align="left">k</td>
              <td align="left">...</td>
              <td align="left">K</td>
            </tr>
            <tr>
              <td align="left">Covariate</td>
              <td align="left">ID</td>
              <td align="left">MM(0)</td>
              <td align="left">
                <italic>x</italic>
                <sub>1</sub>
              </td>
              <td align="left">
                <italic>x</italic>
                <sub>2</sub>
              </td>
              <td align="left">...</td>
              <td align="left">
                <italic>x</italic>
                <sub>
                  <italic>k</italic>
                </sub>
              </td>
              <td align="left">...</td>
              <td align="left">
                <italic>x</italic>
                <sub>
                  <italic>K</italic>
                </sub>
              </td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">ORF<sub>1</sub></td>
              <td align="left">1</td>
              <td align="left">1</td>
              <td align="left">
                <italic>y</italic>
                <sub>1111</sub>
              </td>
              <td align="left">
                <italic>y</italic>
                <sub>1112</sub>
              </td>
              <td/>
              <td align="left">
                <italic>y</italic>
                <sub>111<italic>k</italic></sub>
              </td>
              <td align="left">...</td>
              <td align="left">
                <italic>y</italic>
                <sub>111<italic>K</italic></sub>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="left">1</td>
              <td align="left">0</td>
              <td align="left">
                <italic>y</italic>
                <sub>1101</sub>
              </td>
              <td align="left">
                <italic>y</italic>
                <sub>1102</sub>
              </td>
              <td/>
              <td align="left">
                <italic>y</italic>
                <sub>110<italic>k</italic></sub>
              </td>
              <td align="left">...</td>
              <td align="left">
                <italic>y</italic>
                <sub>110<italic>K</italic></sub>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="left">2</td>
              <td align="left">1</td>
              <td align="left">
                <italic>y</italic>
                <sub>1211</sub>
              </td>
              <td align="left">
                <italic>y</italic>
                <sub>1212</sub>
              </td>
              <td/>
              <td align="left">
                <italic>y</italic>
                <sub>121<italic>k</italic></sub>
              </td>
              <td align="left">...</td>
              <td align="left">
                <italic>y</italic>
                <sub>121<italic>K</italic></sub>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="left">2</td>
              <td align="left">0</td>
              <td align="left">
                <italic>y</italic>
                <sub>1201</sub>
              </td>
              <td align="left">
                <italic>y</italic>
                <sub>1202</sub>
              </td>
              <td/>
              <td align="left">
                <italic>y</italic>
                <sub>120<italic>k</italic></sub>
              </td>
              <td align="left">...</td>
              <td align="left">
                <italic>y</italic>
                <sub>120<italic>K</italic></sub>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="left">...</td>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
            </tr>
            <tr>
              <td/>
              <td align="left">
                <italic>N</italic>
              </td>
              <td align="left">1</td>
              <td align="left">
                <italic>y</italic>
                <sub>1<italic>N </italic>11</sub>
              </td>
              <td align="left">
                <italic>y</italic>
                <sub>1<italic>N</italic>12</sub>
              </td>
              <td/>
              <td align="left">
                <italic>y</italic>
                <sub>1<italic>N </italic>1<italic>k</italic></sub>
              </td>
              <td align="left">...</td>
              <td align="left">
                <italic>y</italic>
                <sub>1<italic>N</italic>1<italic>K</italic></sub>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="left">
                <italic>N </italic>
              </td>
              <td align="left">0</td>
              <td align="left">
                <italic>y</italic>
                <sub>1<italic>N</italic>01</sub>
              </td>
              <td align="left">
                <italic>y</italic>
                <sub>1<italic>N </italic>02</sub>
              </td>
              <td/>
              <td align="left">
                <italic>y</italic>
                <sub>1<italic>N</italic>0<italic>k</italic></sub>
              </td>
              <td align="left">...</td>
              <td align="left">
                <italic>y</italic>
                <sub>1<italic>N </italic>0<italic>K</italic></sub>
              </td>
            </tr>
            <tr>
              <td align="left">...</td>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
            </tr>
            <tr>
              <td align="left">ORF<sub><italic>j</italic></sub></td>
              <td align="left">1</td>
              <td align="left">1</td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>j</italic>111</sub>
              </td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>j </italic>112</sub>
              </td>
              <td/>
              <td align="left">
                <italic>y</italic>
                <sub><italic>j</italic>11<italic>k</italic></sub>
              </td>
              <td align="left">...</td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>j </italic>11<italic>K</italic></sub>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="left">1</td>
              <td align="left">0</td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>j</italic>101</sub>
              </td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>j </italic>102</sub>
              </td>
              <td/>
              <td align="left">
                <italic>y</italic>
                <sub><italic>j</italic>10<italic>k</italic></sub>
              </td>
              <td align="left">...</td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>j </italic>10<italic>K</italic></sub>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="left">2</td>
              <td align="left">1</td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>j</italic>211</sub>
              </td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>j </italic>212</sub>
              </td>
              <td/>
              <td align="left">
                <italic>y</italic>
                <sub><italic>j</italic>21<italic>k</italic></sub>
              </td>
              <td align="left">...</td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>j </italic>21<italic>K</italic></sub>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="left">2</td>
              <td align="left">0</td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>j</italic>201</sub>
              </td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>j </italic>202</sub>
              </td>
              <td/>
              <td align="left">
                <italic>y</italic>
                <sub><italic>j</italic>20<italic>k</italic></sub>
              </td>
              <td align="left">...</td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>j</italic>20<italic>K</italic></sub>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="left">...</td>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
            </tr>
            <tr>
              <td/>
              <td align="left">i</td>
              <td align="left">1</td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>ji</italic>11</sub>
              </td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>ji</italic>12</sub>
              </td>
              <td/>
              <td align="left">
                <italic>y</italic>
                <sub><italic>ji</italic>1<italic>k</italic></sub>
              </td>
              <td align="left">...</td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>ji</italic>1<italic>K</italic></sub>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="left">i</td>
              <td align="left">0</td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>ji</italic>01</sub>
              </td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>ji</italic>02</sub>
              </td>
              <td/>
              <td align="left">
                <italic>y</italic>
                <sub><italic>ji</italic>0<italic>k</italic></sub>
              </td>
              <td align="left">...</td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>ji</italic>0<italic>K</italic></sub>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="left">...</td>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
            </tr>
            <tr>
              <td/>
              <td align="left">
                <italic>N</italic>
              </td>
              <td align="left">1</td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>jN</italic>11</sub>
              </td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>jN</italic>12</sub>
              </td>
              <td/>
              <td align="left">
                <italic>y</italic>
                <sub><italic>jN</italic>1<italic>k</italic></sub>
              </td>
              <td align="left">...</td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>jN</italic>1<italic>K</italic></sub>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="left">
                <italic>N</italic>
              </td>
              <td align="left">0</td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>jN</italic>01</sub>
              </td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>jN</italic>02</sub>
              </td>
              <td/>
              <td align="left">
                <italic>y</italic>
                <sub><italic>jN</italic>0<italic>k</italic></sub>
              </td>
              <td align="left">...</td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>jN</italic>0<italic>K</italic></sub>
              </td>
            </tr>
            <tr>
              <td align="left">...</td>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
            </tr>
            <tr>
              <td align="left">ORF<sub><italic>J</italic></sub></td>
              <td align="left">1</td>
              <td align="left">1</td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>J</italic>111</sub>
              </td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>J</italic>112</sub>
              </td>
              <td/>
              <td align="left">
                <italic>y</italic>
                <sub><italic>J</italic>11<italic>k</italic></sub>
              </td>
              <td align="left">...</td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>J</italic>11<italic>K</italic></sub>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="left">1</td>
              <td align="left">0</td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>J</italic>101</sub>
              </td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>J</italic>102</sub>
              </td>
              <td/>
              <td align="left">
                <italic>y</italic>
                <sub><italic>J</italic>10<italic>k</italic></sub>
              </td>
              <td align="left">...</td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>J</italic>10<italic>K</italic></sub>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="left">2</td>
              <td align="left">1</td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>J</italic>211</sub>
              </td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>J</italic>212</sub>
              </td>
              <td/>
              <td align="left">
                <italic>y</italic>
                <sub><italic>J</italic>21<italic>k</italic></sub>
              </td>
              <td align="left">...</td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>J</italic>21<italic>K</italic></sub>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="left">2</td>
              <td align="left">0</td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>J</italic>201</sub>
              </td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>J</italic>202</sub>
              </td>
              <td/>
              <td align="left">
                <italic>y</italic>
                <sub><italic>J</italic>20<italic>k</italic></sub>
              </td>
              <td align="left">...</td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>J</italic>20<italic>K</italic></sub>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="left">...</td>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
            </tr>
            <tr>
              <td/>
              <td align="left">
                <italic>N</italic>
              </td>
              <td align="left">1</td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>JN</italic>11</sub>
              </td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>JN</italic>12</sub>
              </td>
              <td/>
              <td align="left">
                <italic>y</italic>
                <sub><italic>JN</italic>1<italic>k</italic></sub>
              </td>
              <td align="left">...</td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>JN</italic>1<italic>K</italic></sub>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="left">
                <italic>N</italic>
              </td>
              <td align="left">0</td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>JN</italic>01</sub>
              </td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>JN</italic>02</sub>
              </td>
              <td/>
              <td align="left">
                <italic>y</italic>
                <sub><italic>JN</italic>0<italic>k</italic></sub>
              </td>
              <td align="left">...</td>
              <td align="left">
                <italic>y</italic>
                <sub><italic>JN</italic>0<italic>K</italic></sub>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>In a typical experiment as described above, it is frequently of interest to discover genes that are significantly associated with one or more experimental covariates <italic>x</italic><sub><italic>k </italic></sub>. For example, consider an experiment to discover genes that are differentially expressed between two groups, <italic>x</italic><sub><italic>k </italic></sub>takes a binary values: <italic>x</italic><sub><italic>k </italic></sub>= 0 for the control group and <italic>x</italic><sub><italic>k </italic></sub>= 1 for the treatment group. To achieve the scientific objective, the analytic procedure is to assess associations of <inline-graphic xlink:href="1471-2164-6-16-i5.gif"/> = (<italic>Z</italic><sub><italic>j</italic>1<italic>k </italic></sub>, <italic>Z</italic><sub><italic>j</italic>2<italic>k </italic></sub>,...,<italic>Z</italic><sub><italic>jNk </italic></sub>)' with covariates <italic>x</italic><sub><italic>k </italic></sub>via the distribution function <italic>f </italic>(<inline-graphic xlink:href="1471-2164-6-16-i5.gif"/> | <italic>x</italic><sub><italic>k </italic></sub>). In essence, <italic>Z</italic><sub><italic>jik </italic></sub>are treated as vectors of multivariate correlated outcome variables, and used to identify the probes/genes that are differentially expressed. Recognizing the high dimensionality of multiple probes and multiple genes, we propose to apply a marginal model that uses marginal means to describe relationship of probes/genes with the covariates without the necessity of specifying the full distribution <italic>f </italic>(<inline-graphic xlink:href="1471-2164-6-16-i5.gif"/> | <italic>x</italic><sub><italic>k </italic></sub>). Our framework directly associates experimental factors with probe intensities and is referred to as the generalized probe model or GPM. We propose the following (1) to describe relationship between <inline-graphic xlink:href="1471-2164-6-16-i5.gif"/> and <italic>x</italic><sub><italic>k </italic></sub>,</p>
      <p>
        <inline-graphic xlink:href="1471-2164-6-16-i6.gif"/>
      </p>
      <p>where (<italic>δ</italic><sub><italic>k </italic></sub>, <italic>λ</italic><sub><italic>k </italic></sub>) are chip-specific heterogeneity factors for <italic>k </italic>th chip [<xref ref-type="bibr" rid="B7">7</xref>], <italic>τ</italic><sub><italic>ji </italic></sub>are gene- and probe-specific parameters quantifying the mean intensity value for the <italic>i</italic>th probe of the <italic>j</italic>th gene, <italic>β</italic><sub><italic>ji </italic></sub>quantifies the gene- and probe-specific parameters quantifying the difference between treated and control groups, and <italic>v</italic><sub><italic>jik </italic></sub>quantifies expression values for individual probe pairs. Lastly, (<italic>ξ</italic><sub><italic>j</italic>1<italic>k </italic></sub>, <italic>ξ</italic><sub><italic>j</italic>2<italic>k </italic></sub>,...,<italic>ξ</italic><sub><italic>jNk </italic></sub>) represents a vector of gene- and probe-specific random variations across <italic>K </italic>independent samples. Since probe pairs are selected to target the <italic>j</italic>th gene and are spatially arranged by a pre-selected design to eliminate common artifacts, they may be correlated because of cross-hybridizations or spatial dependencies. From the biological perspective, specifying a joint distribution for (<italic>ξ</italic><sub><italic>j</italic>1<italic>k </italic></sub>, <italic>ξ</italic><sub><italic>j</italic>2<italic>k </italic></sub>,...,<italic>ξ</italic><sub><italic>jNk </italic></sub>) would be difficult, if not impossible. It is thus preferable to leave it unspecified.</p>
      <p>The above GPM (1) includes a range of more simplified models based on specific assumptions. First, under the assumption that all probe-specific parameters are the same, i.e., <italic>τ</italic><sub><italic>ji </italic></sub>= <italic>τ</italic><sub><italic>j </italic></sub>and <italic>β</italic><sub><italic>ji </italic></sub>= <italic>β</italic><sub><italic>j </italic></sub>, the general model (1) simplifies to the following model:</p>
      <p>
        <inline-graphic xlink:href="1471-2164-6-16-i7.gif"/>
      </p>
      <p>and is equivalent to using a summarized gene expression to associate with the experimental factors [<xref ref-type="bibr" rid="B7">7</xref>]. For simplicity and comparison with other special models, we refer this model as GPM-1.</p>
      <p>If one postulates that all probe-specific parameters are not the same, but follow an additive probe model, then general model (1) under modeling assumption that <italic>β</italic><sub><italic>ji </italic></sub>= <italic>β</italic><sub><italic>j </italic></sub>, with probe-specific values (<italic>τ</italic><sub><italic>j</italic>1</sub>, <italic>τ</italic><sub><italic>j</italic>2</sub>,...,<italic>τ</italic><sub><italic>jN </italic></sub>) may be written as</p>
      <p>
        <inline-graphic xlink:href="1471-2164-6-16-i8.gif"/>
      </p>
      <p>in which estimating <italic>β</italic><sub><italic>j </italic></sub>is of primary interest. This variation of the general model is referred to as GPM-2.</p>
      <p>On the other hand, the probe parameters may follow a multiplicative model (in the spirit of Li and Wong's model), then the third model, referred to as GPM-3, is derived under the assumption that <italic>τ</italic><sub><italic>ji </italic></sub>≈ <italic>φ</italic><sub><italic>ji </italic></sub><italic>τ</italic><sub><italic>j </italic></sub>and <italic>β</italic><sub><italic>ji </italic></sub>≈ <italic>φ</italic><sub><italic>ji </italic></sub><italic>β</italic><sub><italic>j </italic></sub>, and may be written as</p>
      <p>
        <inline-graphic xlink:href="1471-2164-6-16-i9.gif"/>
      </p>
      <p>where <italic>φ</italic><sub><italic>ji </italic></sub>denote the multiplicative probe-specific effects and can be uniquely determined by constraining the mean to be one.</p>
    </sec>
    <sec>
      <title>Estimation and inference</title>
      <p>Our estimation procedures do not require any assumptions with respect to the error distribution, since any distributional assumptions, which may be appropriate for some genes, are likely to be violated for other genes. To ensure the robustness of statistical inference, we propose to use generalized estimating equation theory, which has been fully described in a seminal paper by [<xref ref-type="bibr" rid="B8">8</xref>]. In the current context, we choose the "working independence" assumption for modeling dependencies between probes [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B9">9</xref>]., to avoid making any assumptions on dependence structures. The asymptotic variance matrix is estimated with the usual "sandwich" estimator [<xref ref-type="bibr" rid="B8">8</xref>]. Diagonal elements in the variance matrix are estimates of marginal variances for all estimated parameters, and are denoted by <inline-graphic xlink:href="1471-2164-6-16-i10.gif"/> for the estimated parameters <inline-graphic xlink:href="1471-2164-6-16-i11.gif"/> in the model. Both estimates can be used to construct test statistics, such as the ratio of <inline-graphic xlink:href="1471-2164-6-16-i11.gif"/> over <inline-graphic xlink:href="1471-2164-6-16-i12.gif"/>, known as Wald-statistic. Under the null hypothesis, each statistic has an asymptotic normal distribution when the sample size is sufficiently large, and can therefore be used for making statistical inferences. When the sample size is small, this quantity is treated as a standardized regression coefficient.</p>
    </sec>
  </sec>
  <sec>
    <title>List of abbreviations</title>
    <p>ATRA: All Trans Retinoic Acid</p>
    <p>ETOH: Ethyl Alcohol</p>
    <p>GPM: Generalized Probe Model</p>
    <p>IM: Ideal Mismatch</p>
    <p>MAS: Microarray Suite</p>
    <p>MM: Mismatch</p>
    <p>ORF: Open Reading Frame</p>
    <p>PM: Perfect Match</p>
    <p>RMA: Robust Multiple Array average</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>WF carried out analyses and prepared the manuscript. JIP conducted microarray experiments. JMO conceived the study. NK: prepared the manuscript. LPZ: conceived the study, developed the GPM algorithms and prepared the manuscript.</p>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>We wish to thank Andrew Strand for his helpful discussion during the preparation of this manuscript. This work was supported by grants from National Institutes of Health.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <collab>Affymetrix</collab>
        </person-group>
        <article-title>Microarray Suite 5.0 User's Guide</article-title>
        <year>2001</year>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>WH</given-names>
          </name>
        </person-group>
        <article-title>Model-based analysis of oligonucleotide arrays: expression index computation and outlier detection</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2001</year>
        <volume>98</volume>
        <fpage>31</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="pmid">11134512</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.011404098</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Hobbs</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Collin</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Beazer-Barclay</surname>
            <given-names>YD</given-names>
          </name>
          <name>
            <surname>Antonellis</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Scherf</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>Exploration, normalization, and summaries of high density oligonucleotide array probe level data</article-title>
        <source>Biostatistics</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>249</fpage>
        <lpage>64</lpage>
        <pub-id pub-id-type="pmid">12925520</pub-id>
        <pub-id pub-id-type="doi">10.1093/biostatistics/4.2.249</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <collab>Affymetrix</collab>
        </person-group>
        <article-title>Microarray Suite 4.0 User's Guide</article-title>
        <year>1999</year>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="other">
        <article-title>Bioconductor project</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org"/>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thomas</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Olson</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Tapscott</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>LP</given-names>
          </name>
        </person-group>
        <article-title>An efficient and robust statistical modeling approach to discover differentially expressed genes using genomic expression profiles</article-title>
        <source>Genome Res</source>
        <year>2001</year>
        <volume>11</volume>
        <fpage>1227</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="pmid">11435405</pub-id>
        <pub-id pub-id-type="doi">10.1101/gr.165101</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>LP</given-names>
          </name>
          <name>
            <surname>Prentice</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Breeden</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Statistical modeling of large microarray data sets to identify stimulus-response profiles</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2001</year>
        <volume>98</volume>
        <fpage>5631</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="pmid">11344303</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.101013198</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liang</surname>
            <given-names>KY</given-names>
          </name>
          <name>
            <surname>Zeger</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Longitudinal data analysis using generalized linear models</article-title>
        <source>Biometrika</source>
        <year>1986</year>
        <volume>73</volume>
        <fpage>13</fpage>
        <lpage>22</lpage>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prentice</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>LP</given-names>
          </name>
        </person-group>
        <article-title>Estimating equations for parameters in means and covariances of multivariate discrete and continuous responses</article-title>
        <source>Biometrics</source>
        <year>1991</year>
        <volume>47</volume>
        <fpage>825</fpage>
        <lpage>39</lpage>
        <pub-id pub-id-type="pmid">1742441</pub-id>
      </citation>
    </ref>
  </ref-list>
</back>
