<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Gigascience</journal-id>
    <journal-id journal-id-type="iso-abbrev">Gigascience</journal-id>
    <journal-id journal-id-type="publisher-id">gigascience</journal-id>
    <journal-title-group>
      <journal-title>GigaScience</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2047-217X</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5632294</article-id>
    <article-id pub-id-type="doi">10.1093/gigascience/gix079</article-id>
    <article-id pub-id-type="publisher-id">gix079</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Technical Note</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Bayes Forest: a data-intensive generator of morphological tree clones</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Potapov</surname>
          <given-names>Ilya</given-names>
        </name>
        <!--<email>ilya.potapov@tut.fi</email>-->
        <xref ref-type="aff" rid="aff1">1</xref>
        <xref ref-type="corresp" rid="cor1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Järvenpää</surname>
          <given-names>Marko</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Åkerblom</surname>
          <given-names>Markku</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Raumonen</surname>
          <given-names>Pasi</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kaasalainen</surname>
          <given-names>Mikko</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">1</xref>
      </contrib>
    </contrib-group>
    <aff id="aff1"><label>1</label>Mathematics Department, Tampere University of Technology, P.O. Box 553, 33101, Tampere, Finland</aff>
    <aff id="aff2"><label>2</label>Helsinki Institute for Information Technology HIIT, Department of Computer Science, Aalto University, P.O. Box 15400, FI-00076, Espoo, Finland</aff>
    <author-notes>
      <corresp id="cor1"><label>*</label><bold>Correspondence address.</bold> Ilya Potapov, Mathematics Department, Tampere University of Technology, P.O. Box 553, 33101, Tampere, Finland; Tel: +358 46 550 8122; E-mail: <email>ilya.potapov@tut.fi</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>10</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-08-19">
      <day>19</day>
      <month>8</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>19</day>
      <month>8</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>6</volume>
    <issue>10</issue>
    <fpage>1</fpage>
    <lpage>13</lpage>
    <history>
      <date date-type="accepted">
        <day>13</day>
        <month>8</month>
        <year>2017</year>
      </date>
      <date date-type="received">
        <day>18</day>
        <month>4</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>08</day>
        <month>7</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Authors 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<uri xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</uri>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="gix079.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Detailed and realistic tree form generators have numerous applications in ecology and forestry. For example, the varying morphology of trees contributes differently to formation of landscapes, natural habitats of species, and eco-physiological characteristics of the biosphere. Here, we present an algorithm for generating morphological tree “clones” based on the detailed reconstruction of the laser scanning data, statistical measure of similarity, and a plant growth model with simple stochastic rules. The algorithm is designed to produce tree forms, i.e., morphological clones, similar (and not identical) in respect to tree-level structure, but varying in fine-scale structural detail. Although we opted for certain choices in our algorithm, individual parts may vary depending on the application, making it a general adaptable pipeline. Namely, we showed that a specific multipurpose procedural stochastic growth model can be algorithmically adjusted to produce the morphological clones replicated from the target experimentally measured tree. For this, we developed a statistical measure of similarity (structural distance) between any given pair of trees, which allows for the comprehensive comparing of the tree morphologies by means of empirical distributions describing the geometrical and topological features of a tree. Finally, we developed a programmable interface to manipulate data required by the algorithm. Our algorithm can be used in a variety of applications for exploration of the morphological potential of the growth models (both theoretical and experimental), arising in all sectors of plant science research.</p>
    </abstract>
    <kwd-group kwd-group-type="keywords">
      <kwd>quantitative structure tree model</kwd>
      <kwd>morphological clone</kwd>
      <kwd>stochastic data driven model</kwd>
      <kwd>terrestrial laser scanning</kwd>
      <kwd>large scale data</kwd>
      <kwd>empirical distributions</kwd>
    </kwd-group>
    <counts>
      <page-count count="13"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <title>Findings</title>
    <sec id="sec1-1">
      <title>Background</title>
      <p>Models for plant architecture attract significant attention due to their ability to assist empirical studies in ecology, plant biology, forestry, and agronomy [<xref rid="bib1" ref-type="bibr">1</xref>]. The modeling activity is especially useful in research since it arises as fruitful collaboration between specialists in different fields of studies: computer scientists, mathematicians, and biologists [<xref rid="bib2" ref-type="bibr">2</xref>].</p>
      <p>Modeling plant architecture is approached from many directions. Some progress has been achieved in synthesis of realistic plant forms in the field of computer graphics [<xref rid="bib3" ref-type="bibr">3</xref>–<xref rid="bib5" ref-type="bibr">5</xref>]. These models, although based on heuristic rules of growth, produce realistic tree representation in a fast and efficient manner, which is usually dictated by the application of this approach, i.e., natural scenery in computer visualization. Heuristic growth rules of the procedural models for graphics applications are not firmly based on biological principles, but nevertheless elucidate some algorithmic properties of the growth process (for example, the recursive [<xref rid="bib6" ref-type="bibr">6</xref>] vs self-organizing [<xref rid="bib3" ref-type="bibr">3</xref>, <xref rid="bib7" ref-type="bibr">7</xref>] character of architecture development).</p>
      <p>However, the most promising plant architectural models are so-called functional-structural plant models (FSPM) [<xref rid="bib8" ref-type="bibr">8</xref>–<xref rid="bib10" ref-type="bibr">10</xref>] because this type of models allows for a balanced description between morphological and functional/physiological properties of a plant. It is capable of connecting the external abiotic factors (e.g., radiation, temperature, and soil) and the most vital functions of a plant organism (such as photosynthesis, respiration, and water and salt uptake) with its structural characteristics [<xref rid="bib1" ref-type="bibr">1</xref>, <xref rid="bib2" ref-type="bibr">2</xref>].</p>
      <p>Nevertheless, biologically relevant architectural plant models rely on data in a form of empirically fitted functions and parameters that correspond to a particular species and/or certain site conditions [<xref rid="bib11" ref-type="bibr">11</xref>–<xref rid="bib14" ref-type="bibr">14</xref>]. Thus, the change in these conditions requires re-calibration of the models, which is done in a manual fashion every time the model is simulated for the new conditions. Strong dependence on data, where each simulation would be calibrated automatically by data, is limited by both computation time and lack of the fast measurement and processing systems allowing for a detailed 3D morphological reconstruction of the actual plant/tree.</p>
      <p>The most recent advances in laser scanning techniques allow for fast and non-destructive measurement of trees with subsequent reconstruction of various characteristics depending on application (e.g., [<xref rid="bib15" ref-type="bibr">15</xref>, <xref rid="bib16" ref-type="bibr">16</xref>]). Most of such studies dedicated to reconstruction of 3D point clouds obtained from laser scanning measurements deal with overall characteristics, such as height, width, and volume of stems/crowns, leaf index, biomass etc., resembling traditional destructive methods of measurement [<xref rid="bib15" ref-type="bibr">15</xref>, <xref rid="bib17" ref-type="bibr">17</xref>]. However, the detailed precise geometrical and topological reconstruction of the tree architecture is never achieved perfectly.</p>
      <p>We use a fast, precise, automatic, and comprehensive reconstruction algorithm initially presented in Raumonen et al. [<xref rid="bib18" ref-type="bibr">18</xref>] and further developed and tested in Calders et al. [<xref rid="bib19" ref-type="bibr">19</xref>]. The algorithm reliably reconstructs a quantitative structure model (QSM), which contains all geometrical and topological characteristics of the object tree. Input for the method is the 3D point cloud, sufficiently covering the tree, obtained from the terrestrial laser scanning measurements (TLS). No additional allometric relations used for estimation of the branch proportions (as in [<xref rid="bib20" ref-type="bibr">20</xref>, <xref rid="bib21" ref-type="bibr">21</xref>]) are needed. Compared to other similar techniques (e.g., [<xref rid="bib20" ref-type="bibr">20</xref>–<xref rid="bib22" ref-type="bibr">22</xref>]), this method requires few parameters and no user interaction. It reconstructs the tree surface with subsequent cylinder (or any other geometrical primitive) approximation, which is usually consistent with theoretical plant growth models. The reconstruction algorithm has been validated in several studies with several different tree species and different scanner instruments [<xref rid="bib19" ref-type="bibr">19</xref>, <xref rid="bib23" ref-type="bibr">23</xref>–<xref rid="bib26" ref-type="bibr">26</xref>]. There are other published QSM reconstruction methods from TLS data that can produce QSMs of at least similar quality [<xref rid="bib23" ref-type="bibr">23</xref>].</p>
      <p>In this work, we utilize an inverse iterative procedure to optimize model parameters for matching the (empirical) distribution of structural features of the simulated stochastic tree models (FSPM, graphical, or other) to that of the tree reconstructed from the laser scanning data. Meanwhile, we formulate a measure of similarity of the tree structures based on the tomographic analysis of the structural distributions (e.g., Radon transform) [<xref rid="bib27" ref-type="bibr">27</xref>, <xref rid="bib28" ref-type="bibr">28</xref>]. Finally, the optimal parameter set produces morphological “clone” trees with similar overall structure, but varying fine-scale details.</p>
      <p>Recently, we have reported a proof-of-concept study where we used reconstruction of a pine tree and the corresponding FSPM (named LIGNUM [<xref rid="bib13" ref-type="bibr">13</xref>, <xref rid="bib29" ref-type="bibr">29</xref>]) to demonstrate the practical feasibility of the approach [<xref rid="bib30" ref-type="bibr">30</xref>]. Here, however, we develop a unifying interface (in the form of a programmable toolbox) for our procedure and use a general purpose fast procedural tree growth model from Palubicki et al. [<xref rid="bib3" ref-type="bibr">3</xref>]. This procedural model is easier to adapt for technical experimentation with the whole algorithm. A similar algorithmic pipeline was reported in Stava et al. [<xref rid="bib5" ref-type="bibr">5</xref>] for procedural tree growth models in the context of graphics synthesis. However, in our approach, we see the tree growth as a random process and, consequently, apply corresponding statistical methods for measuring the similarity between trees. Moreover, in our algorithm, we put emphasis on biologically and physically relevant descriptions, hence the careful choice of the reconstruction algorithm. Another advantage is a possibility to use FSPM to relate physiological parameters to the morphogenetic processes in trees. Finally, we use no extra structures improving visual properties of trees that are not supported by empirical observation (e.g., leaves). We note that any other choices of parameters and feature descriptions can be used in our approach, further facilitated with the programmable interface.</p>
    </sec>
    <sec id="sec1-2">
      <title>Algorithm overview</title>
      <p>Our approach is based upon 5 distinct parts:
<list list-type="order" id="lst1"><list-item><p>The quantitative structure model (QSM) is a reconstruction of a tree model from 3D point clouds obtained from terrestrial laser scanning measurements (TLS). Here we use specific algorithm for such reconstruction reported in [<xref rid="bib18" ref-type="bibr">18</xref>] and [<xref rid="bib19" ref-type="bibr">19</xref>] but other approaches could be used as well.</p></list-item><list-item><p>The stochastic structure model (SSM) is a tree growth model that is selected depending on the application. There are no limitations on the class of the model, except that it must produce a measurable 3D branching structure.</p></list-item><list-item><p>The structural data set (U) is a collection of structural features (empirical distributions) to be compared between QSM and SSM. It is important that <italic>U</italic> be defined in the same way by both the QSM and SSM.</p></list-item><list-item><p>The measure of structural dissimilarity, or structural distance D<sub>S</sub>, is a measure of discrepancy between any two data sets. In other words, <italic>D<sub>S</sub></italic>(<italic>U<sub>1</sub>, U<sub>2</sub></italic>) returns a value quantifying how much different the two data sets <italic>U<sub>1</sub></italic> and <italic>U<sub>2</sub></italic> are.</p></list-item><list-item><p>The optimization algorithm is a numerical routine capable of finding a minimum of any given function by varying its arguments. Examples include the Newton algorithm, genetic algorithm, and simulated annealing.</p></list-item></list></p>
      <p>The connection between these components is outlined in Fig. <xref ref-type="fig" rid="fig1">1</xref>, with an explanation in the text below.</p>
      <fig id="fig1" orientation="portrait" position="float">
        <label>Figure 1:</label>
        <caption>
          <p>The algorithm outline (see explanation in the text).</p>
        </caption>
        <graphic xlink:href="gix079fig1"/>
      </fig>
      <p>The algorithm outline (Fig. <xref ref-type="fig" rid="fig1">1</xref>):
<list list-type="simple" id="lst2"><list-item><p><italic>Stage A: preparation</italic><list list-type="simple" id="lst3"><list-item><p>A1: build QSM from TLS.</p></list-item><list-item><p>A2: extract <italic>U<sub>d</sub></italic> from QSM.</p></list-item></list></p></list-item><list-item><p><italic>Stage B: main cycle</italic><list list-type="simple" id="lst4"><list-item><p>B1: simulate SSM (with fixed random generator seed for repro-ducibility) for the given parameters and extract <italic>U<sub>m</sub></italic>.</p></list-item><list-item><p>B2: compare <italic>U<sub>m</sub></italic> and <italic>U<sub>d</sub></italic>, getting an estimation of the distance <italic>D<sub>S</sub></italic>between them.</p></list-item><list-item><p>B3: change SSM parameters trying to decrease <italic>D<sub>S</sub></italic>, go to B1, orstop and go to B4 (changing of the parameters and stoppingcriteria depend on any particular realization of the optimiza-tion routine).</p></list-item><list-item><p>B4: simulate SSM with the “best-fit” parameter values corre-sponding to the smallest found <italic>D<sub>S</sub></italic>.</p></list-item><list-item><p>B5: generate morphological clones using the best-fit SSM withdifferent random number sequences.</p></list-item></list></p></list-item></list></p>
      <p>At the preparation stage, the QSM is formed from the TLS point cloud (A1). The detailed description of this process is reported in [<xref rid="bib18" ref-type="bibr">18</xref>, <xref rid="bib19" ref-type="bibr">19</xref>]. The resultant QSM contains all the geometrical and topological features needed to form the empirical distributions <italic>U<sub>d</sub></italic> (A2). The distributions can be formed from several tree individuals if they are close by shape to ensure the sample size of the data sets (e.g., a tree has a single main stem/trunk; hence its features are underrepresented).</p>
      <p>At the main cycle of the algorithm, the empirical distribution <italic>U<sub>m</sub></italic> is formed from the simulated SSM tree (B1). Next, <italic>U<sub>m</sub></italic> is compared against <italic>U<sub>d</sub></italic> using the measure of distance (B2). The optimization routine iteratively minimizes the distance value every time, changing the parameter values of SSM (B3), simulating SSM, and repeating the cycle from B1. After the stopping criteria of the optimization routine (number of iterations, minimal allowed distance, etc.) are met, the algorithm stops and produces the best-fit SSM tree (B4). The best-fit SSM with different random sequences produces different morphological clones (B5).</p>
      <p>Below we describe general aspects of each of the main components of the algorithm. The Methods section addresses further the technical details.</p>
      <sec id="sec1-2-1">
        <title>Quantitative Structure Model</title>
        <p>QSM is derived from the point cloud obtained by TLS. Essentially, QSM is a surface reconstruction of the branches of the real tree measured by TLS. The reconstruction itself is a stochastic process, giving different architecture results for different runs. Therefore, the reconstruction introduces internal errors in addition to the TLS measurement errors. Besides giving spatial locations of parts of the tree, QSM also reconstructs topological relations between the tree branches. The branches of QSM consist of elementary units, i.e., circular cylinders, but other geometrical primitives can also be applicable [<xref rid="bib31" ref-type="bibr">31</xref>]. Thus, any potential structural information about the original tree can be approximated with high accuracy with QSM. The details of the reconstruction algorithm are presented in [<xref rid="bib18" ref-type="bibr">18</xref>, <xref rid="bib19" ref-type="bibr">19</xref>], while the validation of the algorithm is demonstrated in [<xref rid="bib19" ref-type="bibr">19</xref>, <xref rid="bib23" ref-type="bibr">23</xref>–<xref rid="bib25" ref-type="bibr">25</xref>]).</p>
        <p>In this work, we use the reconstructed QSM of a maple tree (Fig. <xref ref-type="fig" rid="fig2">2</xref>). The QSM was selected due to its non-trivial form and obvious irregularities in the tree growth. This is needed to determine whether the stochastic rules of SSM growth can account for this variability. In fact, the QSM growth irregularities might come from some deterministic sources, like constant wind, shading from the neighbors, animal influences, etc. Thus, our algorithm tries to compensate for the lack of knowledge of the growth process with simple stochastic rules of SSM and optimization of the stochastic distance function.</p>
        <fig id="fig2" orientation="portrait" position="float">
          <label>Figure 2:</label>
          <caption>
            <p>The target QSM structure in 3 main 2D projections.</p>
          </caption>
          <graphic xlink:href="gix079fig2"/>
        </fig>
      </sec>
      <sec id="sec1-2-2">
        <title>Stochastic Structure Model</title>
        <p>SSM is a simulated model, preferably based on analytical and/or heuristic rules for the tree growth; however, any viable algorithm for generating tree forms may be used. Importantly, the ultimate output of the SSM simulation is a table containing data sets <italic>U</italic> describing the tree structure.</p>
        <p>Additionally, SSM may be supplied with stochastic variability in its parameter values. Through our studies, we implement simple stochastic variations in the form of normal and uniform distributions added to the parameter values of SSM.</p>
        <p>Finally, the elementary units, such as cylinders [<xref rid="bib31" ref-type="bibr">31</xref>], forming the SSM branches should be compatible with the units used in the QSM reconstruction.</p>
        <p>Examples of SSM are <italic>LIGNUM</italic> [<xref rid="bib13" ref-type="bibr">13</xref>], a functional-structural plant model based on the physiological principles of growth of pine trees, but also applicable to other tree forms [<xref rid="bib32" ref-type="bibr">32</xref>]; <italic>self-organizing tree model</italic> [<xref rid="bib3" ref-type="bibr">3</xref>] based on the heuristic principles of growth, capable of producing various tree shapes and used in computer graphics; <italic>plastic trees</italic> [<xref rid="bib4" ref-type="bibr">4</xref>], procedural growth models used in computer graphics; <italic>AMAP/GreenLab</italic> (see e.g., [<xref rid="bib33" ref-type="bibr">33</xref>, <xref rid="bib34" ref-type="bibr">34</xref>]), a modeling approach to generate FSPM based upon empirical rules of growth with some physiological processes taken into account.</p>
        <p>In this work, we use the self-organizing tree model (SOT) with a shadow propagation algorithm [<xref rid="bib3" ref-type="bibr">3</xref>] as SSM adapted for comparison with QSM. Note that more specialized tree growth models designed for the species in question would be better for the morphology optimization, and the usual choice is FSPMs (see e.g., [<xref rid="bib30" ref-type="bibr">30</xref>]).</p>
      </sec>
      <sec id="sec1-2-3">
        <title>Structural data sets</title>
        <p>Structural data sets for any given tree structure are empirical collections of the physical dimensions and spatial orientation measures of segments and branches that are composed of segments. These data sets must be similarly obtained for any pair of {<italic>U<sub>m</sub>, U<sub>d</sub></italic>} in the calculation of the structural distance.</p>
        <p>Quantities in the data sets may represent scalar characteristics and/or relations between several covariates (e.g., radii, lengths, angles, tapering function of a branch, etc.). On one hand, one needs to exhaustively describe morphology of the tree using various geometrical and topological features. On the other hand, as the number of compared data sets {<italic>U<sub>m</sub>, U<sub>d</sub></italic>} grows, the efficiency of the optimization routine decreases since the number of distance measures to be minimized grows correspondingly (one distance value for each pair {<italic>U<sub>m</sub>, U<sub>d</sub></italic>}). In the case of multiple data sets, we minimize the average value of the corresponding distances.</p>
        <p>Branch- and segment-related data are described in Table <xref ref-type="table" rid="tbl1">1</xref> (see also Methods). These features are not exhaustive and can be augmented when needed. But we found this set sufficient for obtaining realistic tree shapes. Throughout the manuscript, we maintain the notations <italic>B<sup>w</sup></italic> and <italic>S<sup>w</sup></italic> for the branch- and segment-related data sets of the (Gravelius) order <italic>w</italic>, respectively. The zero order <italic>w</italic> is assigned to the trunk (a branch connecting a tree with the ground). At the branching points, the lateral buds give rise to branches with order <italic>w</italic> + 1, where <italic>w</italic> is the order of the parent branch, while the apical buds continue the branch of the same order.</p>
        <table-wrap id="tbl1" orientation="portrait" position="float">
          <label>Table 1:</label>
          <caption>
            <p>Branch and segment features</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Structural features, units</th>
                <th align="center" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">β, degree</td>
                <td rowspan="1" colspan="1">Inclination angle of the branch, i.e., angle with its parent branch.</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">α, degree</td>
                <td rowspan="1" colspan="1">Azimuthal angle of the branch, i.e., angle around its parent branch (calculated from the fixed direction).</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">L<sub>t</sub>, m</td>
                <td rowspan="1" colspan="1">Total length of the branch (calculated as the sum of the segment lengths constituting the branch).</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">R<sub>f</sub>, m</td>
                <td rowspan="1" colspan="1">Initial radius of the branch, i.e., radius of its first segment.</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">L<sub>a</sub>, m</td>
                <td rowspan="1" colspan="1">Length of the parent branch from its beginning segment to the point where the current (child) branch emanates.</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">R, m</td>
                <td rowspan="1" colspan="1">Radius of the segment.</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">L, m</td>
                <td rowspan="1" colspan="1">Distance from the beginning of the branch to the segment.</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">γ, degree</td>
                <td rowspan="1" colspan="1">Angle between horizontal projections of the segment and its parent segment.</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">ζ, degree</td>
                <td rowspan="1" colspan="1">Angle between vertical projections of the segment and its parent segment.</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <fn id="tb1fn1">
              <p>The additional details of the data set representation are explained in the Methods.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
      </sec>
      <sec id="sec1-2-4">
        <title>Measure of structural distance</title>
        <p>The distance <italic>D<sub>S</sub></italic> between any two data sets, or empirical distributions, measures the difference between the local densities of points in <italic>U</italic>-space for these data sets, i.e., <italic>S</italic> and <italic>B</italic> tables of morphological features. Here, it is constructed by measuring the SSM vs QSM difference of the normalized cumulative distributions of the point densities projected onto a number of line directions in the coordinate space of the variables in <italic>U</italic> (see Methods). The difference between the projected cumulative distributions is further measured by the Kolmogorov-Smirnov statistic. The resulting distance between the two data sets <italic>U</italic> is an average of all statistics calculated from each of the lines.</p>
        <p>In order to provide a reference to traditional measurement systems, we also calculate three main tree characteristics that are used for describing a tree shape [<xref rid="bib35" ref-type="bibr">35</xref>], i.e., <italic>height</italic> (<italic>h</italic>), <italic>girth</italic> (<italic>g</italic>), and <italic>crown spread</italic> (<italic>c</italic>). Finally, to compare SSM and QSM shapes, we calculate relative error distances <italic>d<sub>h</sub>, d<sub>g</sub></italic>, and <italic>d<sub>c</sub></italic> for height, girth, and crown spread, respectively. The classical distance <italic>d<sub>i</sub></italic> shows how large the difference is between entities <italic>i</italic> of the two trees in proportion of the corresponding reference/QSM tree value.</p>
        <p>The details of the distance calculations are further explained in the Methods section.</p>
      </sec>
      <sec id="sec1-2-5">
        <title>Optimization routine</title>
        <p>The measure of structural distance <italic>D<sub>S</sub></italic>(<italic>U<sub>m</sub>, U<sub>d</sub></italic>) is minimized by adjusting the parameters <italic>v</italic> of SSM. With infinite sampling, <italic>D<sub>S</sub></italic> = 0 for two trees that have exactly the same parameters <italic>v</italic>. These trees are not copies of each other, but they are structurally similar. The choice of <italic>U</italic> defined in <italic>D<sub>S</sub></italic> is not unique, but ideally <italic>U</italic> should satisfy the following uniqueness condition for <italic>D<sub>S</sub></italic> to yield an acceptable measure of distance. Let three trees be defined by the corresponding parameters <italic>v</italic><sub>A</sub>, <italic>v</italic><sub>B</sub>, and <italic>v</italic><sub>C</sub> with the data sets <italic>U<sub>A</sub>, U<sub>B</sub></italic>, and <italic>U<sub>C</sub></italic>, respectively. Then, if <italic>D<sub>S</sub></italic>(<italic>U</italic><sub>A</sub>, <italic>U</italic><sub>B</sub>) &lt; <italic>D<sub>S</sub></italic>(<italic>U</italic><sub>A</sub>, <italic>U</italic><sub>C</sub>), one can update <italic>C</italic> ← <italic>B</italic>; i.e., substitute tree <italic>C</italic> with tree <italic>B</italic>, find any new <italic>v</italic><sub>B</sub> for which the inequality holds, and repeat until <italic>D<sub>S</sub></italic>(<italic>U</italic><sub>A</sub>, <italic>U</italic><sub>B</sub>) → 0 and <italic>v</italic><sub>B</sub> → <italic>v</italic><sub>A</sub>. In practice, this should be true in a large neighborhood of <italic>v</italic><sub>A</sub>; however, in practice, <italic>D<sub>S</sub></italic> &gt; 0 due to the finite sampling and insufficient model.</p>
      </sec>
    </sec>
    <sec id="sec1-3">
      <title>Testing of the algorithm</title>
      <p>First, we run the optimization within each of the parameter groups <italic>I—V</italic>, representing different processes of growth (see the Methods for details) to determine the basic values of the parameters. These basic values represent choices that generate a viable tree structure similar to the target QSM. Each optimization run takes the best parameters for the group optimized at the previous step. The target structural distributions <italic>U</italic> for these runs are segment-related (<italic>S</italic>) features of the branches of topological order <italic>w</italic> = 0, 1, i.e., <italic>S</italic><sup>0,1</sup>. Note that this exercise serves as a basic exploration of the model's behavior, which can be (partially) replaced, for example, by the expert guesses for the parameter values or some calibration process.</p>
      <p>Second, based on these preliminary results, we may want to determine the most influential parameters for each of the group and combine them in a single optimization setup. Changes in these parameters cause the largest relative changes in the structural distance value. This step is required to reduce optimization time, and it is not needed if one possesses large enough computational resources. Several independent optimization runs were taken in order to determine the most influential parameters. For example, we found that the angular properties vary the least among these runs, whereas the apical dominance requires subtler adjustments (as can be understood from the complex structure of the target QSM).</p>
      <sec id="sec1-3-1">
        <title>Low-order topological adjustment of the shape</title>
        <p>After these initial manipulations, we obtained a model with 11 parameters and good fit of the trunk (<italic>w</italic> = 0) and first-order branches (Fig. <xref ref-type="fig" rid="fig3">3</xref>C) with classical metrics <italic>d<sub>h</sub></italic> = 0.05, <italic>d<sub>g</sub></italic> = 0.42, <italic>d<sub>c</sub></italic> = 0.57. However, the overall form of the resulting minimal score tree does not resemble the target QSM due to its rosette shape (Fig. <xref ref-type="fig" rid="fig3">3</xref>A and B). A closer look at the tree reveals that the higher-order branches (<italic>w</italic> &gt; 1) are mainly responsible for the formation of the rosette-shape of the tree, i.e., the orders that were not subject to the optimization (Fig. <xref ref-type="fig" rid="fig3">3</xref>A and E). This example demonstrates the contribution of the higher-order branches to the overall tree shape, which suggests using the information at <italic>w</italic> &gt; 1 in further optimization steps. Moreover, the branch-related (<italic>B</italic>) features, such as the angular properties of branches of order <italic>w</italic> &gt; 1, were not captured well (Fig. <xref ref-type="fig" rid="fig3">3</xref>E), although similar order segment-related <italic>S</italic> features show correct stochastic tendencies (Fig. <xref ref-type="fig" rid="fig3">3</xref>D) generated automatically by the growth algorithm of the SSM. However, note that these features of <italic>w</italic> &gt; 1 were not subject to optimization.</p>
        <fig id="fig3" orientation="portrait" position="float">
          <label>Figure 3:</label>
          <caption>
            <p>The rosette-shape SSM resulting from adjustment of the low-order segment-related scatters. (<bold>A</bold>) The SSM tree. (<bold>B</bold>) The target QSM. (<bold>C</bold>) Some segment-related (<italic>S</italic><sup>0,1</sup>) scatters used in the optimization. (<bold>D</bold>) Higher-order (<italic>w</italic> = 2) <italic>S</italic>-scatters (not used in optimization). (<bold>E</bold>) Higher-order (<italic>w</italic> = 2, 3) branch-related <italic>B</italic>-scatters (not used in optimization). SSM/QSM scatters are shown in red/blue.</p>
          </caption>
          <graphic xlink:href="gix079fig3"/>
        </fig>
      </sec>
      <sec id="sec1-3-2">
        <title>Low- and high-order topological adjustment</title>
        <p>The increase in number of the structural feature tables is coupled with the increase in the number of distinct distance values; i.e., each pair of tables (QSM vs SSM) produces a distance score to be optimized. Although the optimization of the mean distance value for all tables hinders the improvement for each table separately, the low-order and high-order branches need to be fitted to the corresponding branches of the target QSM. To reduce the number of distinct feature tables for the optimization, we further utilize a set of merged data sets (see Methods) resulting in two joint segment- (<italic>S</italic>) and branch-related (<italic>B</italic>) tables for all topological orders.</p>
        <p>Thus, we opted for <italic>S</italic><sup>0,1</sup> and <italic>B</italic><sup>2,3,4</sup> merged data sets in the next run of optimization to account for the higher-order branch variability (<italic>d<sub>h</sub></italic> = 0.08, <italic>d<sub>g</sub></italic> = 0.20, <italic>d<sub>c</sub></italic> = 0.68) (Fig. <xref ref-type="fig" rid="fig4">4</xref>). We observe a significant improvement to the tree form due to the correct account of the angular properties of the higher-order (<italic>w</italic> &gt; 1) branches (Fig. <xref ref-type="fig" rid="fig4">4</xref>E). The poor convergence of the branch linear dimensions (radii, lengths etc.) present in the branch-related tables might be due to the parameter choice of the model. Namely, the small proportion of branches with similar <italic>R<sub>f</sub></italic> values (Fig. <xref ref-type="fig" rid="fig4">4</xref>E) is the result of the fixed segment length we selected as a compromise between realism and computational complexity. The QSM minimal segment length is close to 0, and the median is 0.06 m, whereas that of SSM is fixed at 0.2 m. We note the similar span of the curvature data points of SSM and QSM for <italic>w</italic> = 1, 2 (Fig. <xref ref-type="fig" rid="fig4">4</xref>C and D). The <italic>w</italic> = 2 branch curvature was automatically generated by SSM as a result of the correct proportions of the <italic>w</italic> = 1 branches, which were obtained during the optimization. Additionally, due to the lack of the orientation landmark in the feature data sets, our best-fit SSM is fitted to the target QSM with accuracy of the rotation around the z-axis.</p>
        <fig id="fig4" orientation="portrait" position="float">
          <label>Figure 4:</label>
          <caption>
            <p>Low- and high-order adjustment of the stochastic feature tables. The best-fit SSM is obtained through optimization against <italic>S</italic><sup>0,1</sup> and <italic>B</italic><sup>2,3,4</sup> merged feature data sets. (<bold>A</bold>) The best-fit SSM tree. (<bold>B</bold>) The target QSM tree. (<bold>C</bold>) Some projection scatters from <italic>S</italic><sup>1</sup>. (<bold>D</bold>) <italic>S</italic><sup>2</sup> projection scatters. (<bold>E</bold>) <italic>B</italic><sup>2</sup> and <italic>B</italic><sup>3</sup> projection scatters.</p>
          </caption>
          <graphic xlink:href="gix079fig4"/>
        </fig>
      </sec>
      <sec id="sec1-3-3">
        <title>Clonal nature of the best-fit SSM</title>
        <p>Due to the highly discrete and stochastic nature of the tree growth, the structural distance hyper-surface in the space of the parameters is extremely variable (Fig. <xref ref-type="fig" rid="fig5">5</xref>A). Hence, finding the global minima of such a surface is not a trivial task. The classical smooth function optimizers are not suitable in this case, while stochastic discrete optimizers, like the genetic algorithm, seem to be more appropriate. Moreover, the hyper-surface itself is a stochastic entity changing every time the new sample of random numbers is used for a particular SSM growth realization. Therefore, any best-fit SSM is the best for a particular realization of this stochastic process, and one needs to study variability of the tree shapes (Fig. <xref ref-type="fig" rid="fig5">5</xref>B). We call these many realizations of the SSM growth <italic>morphological tree clones</italic>.</p>
        <fig id="fig5" orientation="portrait" position="float">
          <label>Figure 5:</label>
          <caption>
            <p>Stochastic structure distance profiles in the parameter space. (<bold>A</bold>) Three realizations of the distance hyper-surface projection along a dimensionless parameter λ of the SSM, controlling the apical dominance of a tree (the shown fragment of the projection with the step of 0.001 approximates 30% of the allowed variability of the parameter during optimization, which was in the range [0.0, 0.65]). (<bold>B</bold>) Structural distance values (with <italic>U</italic> = {<italic>S</italic><sup>0,1</sup>, <italic>B</italic><sup>2,3,4</sup>}) for 100 randomly generated SSM trees for each value of a discrete SSM parameter, i.e., number of growth iterations (red line connects the median points of the distance distributions for each parameter value; blue line shows the same median distance profile but for the distance with <italic>U</italic> = <italic>S</italic><sup>0,1</sup>, see (C)). (<bold>C</bold>) Same as in (B), but <italic>U</italic> = <italic>S</italic><sup>0,1</sup> (blue line is the median profile; red line is from (B)). The SSM is the best-fit SSM obtained in the experimentation reported in Fig. <xref ref-type="fig" rid="fig4">4</xref>; the black arrow indicates the parameter value of the best-fit SSM found in the experimentation.</p>
          </caption>
          <graphic xlink:href="gix079fig5"/>
        </fig>
        <p>The structural distance profile depends not only on the parameters of the SSM, but the choice of the structural data sets. For example, in Fig. <xref ref-type="fig" rid="fig5">5</xref>B and C the median distance profile is depicted given <italic>U</italic> = {<italic>S</italic><sup>0,1</sup>, <italic>B</italic><sup>2,3,4</sup>} (red line) and <italic>U</italic> = <italic>S</italic><sup>0,1</sup> (blue line). In the given parameter range, the latter seems to be more flattened and lifted compared to the former. The addition of the <italic>B</italic><sup>2,3,4</sup> data set might be seen as a perturbation to the distance profile changing the landscape properties (like minima). In our simulations, we maintain the global parameter boundaries, which allows for a search within the full available space. However, we sequentially improve the model characteristics by perturbing the system, i.e., changing the parameters, their intervals, and the <italic>U</italic> data sets to address problematic parts of the SSM (like rosette shape, Fig. <xref ref-type="fig" rid="fig3">3</xref>) such that at every next optimization run the genetic algorithm is instructed to search around the previous best point using the initial ranges (see the genetic algorithm in the Methods).</p>
        <p>Given the considerations above about the nature of the structural distance hyper-surface, further study of the morphological clones is needed. Specifically, the variability and plausibility of the clonal shapes need to be addressed. For example, the clones must be further selected as to produce realistic tree shapes; however, in our analysis we did not find any unrealistic tree sampled from the best-fit SSM. Additionally, the variability of the clones can be further calibrated, for instance, by the analysis of the natural/QSM clonal individuals.</p>
      </sec>
      <sec id="sec1-3-4">
        <title>Morphological tree clones</title>
        <p>The main objective of our work is the generation of the morphological clones. In our pipeline, this occupies the last stage (see Fig. <xref ref-type="fig" rid="fig1">1</xref>, B5). After the optimization is finished and the best-fit SSM is found, one can further randomize the outcome of SSM by letting the random number generator produce different sequences every time SSM is run. As a result, the different realizations of SSM should constitute the morphological clone generator yielding structural copies close to QSM and to each other and <italic>varying</italic> in fine detail of organization of their branches. In other words, the coarse-grain structure is repeated in each clone (and possibly grasps that of the target QSM), whereas the fine-grain structure varies.</p>
        <p>We demonstrate visualization of 6 clones for 3 distinct models in Fig. <xref ref-type="fig" rid="fig6">6</xref> (clones from other best-fit SSMs are provided by the Bayes Forest Toolbox [<xref rid="bib36" ref-type="bibr">36</xref>]). One can see the fine-grain variation in the structure in each panel of the figure, although the overall (coarse-grain) structure is preserved and presumably captures that of the target maple QSM from Fig. <xref ref-type="fig" rid="fig2">2</xref> (however, the models have higher branch densities than the QSM due to the discretization of the space using the voxels of finite size; see [<xref rid="bib3" ref-type="bibr">3</xref>]). The three models are the one found during the optimization process (Fig. <xref ref-type="fig" rid="fig6">6</xref>A), the one minimizing the sample median distance profile for <italic>D<sub>S</sub></italic>(<italic>U</italic> = {<italic>S</italic><sup>0,1</sup>, <italic>B</italic><sup>2,3,4</sup>}), shown in Fig. <xref ref-type="fig" rid="fig5">5</xref>B (Fig. <xref ref-type="fig" rid="fig6">6</xref>B), and the one minimizing the sample median profile <italic>D<sub>S</sub></italic>(<italic>U</italic> = <italic>S</italic><sup>0,1</sup>), from Fig. <xref ref-type="fig" rid="fig5">5</xref>C (Fig. <xref ref-type="fig" rid="fig6">6</xref>C).</p>
        <fig id="fig6" orientation="portrait" position="float">
          <label>Figure 6:</label>
          <caption>
            <p>Morphological clones generated from the best-fit SSM. The best-fit SSM was found using the higher–topological order adjustments (Fig. <xref ref-type="fig" rid="fig4">4</xref>) with number of growth iterations of 30 (<bold>A</bold>), 26 (<bold>B</bold>), and 18 (<bold>C</bold>). The height, girth, crown spread, and classical metrics distributions are shown in (D) for the clones in (A), (B), and (C) (the total number of generated clones for each case is <italic>n</italic> = 100, only 6 are shown). The black horizontal line indicates the corresponding measure of the target QSM.</p>
          </caption>
          <graphic xlink:href="gix079fig6"/>
        </fig>
        <p>Out of 100 simulated clones for each case, we can see that the best-fit SSM obtained directly as the optimization outcome (Fig. <xref ref-type="fig" rid="fig6">6</xref>A) produces a larger proportion of individual trees exhibiting the three standard allometric measures closer to those of QSM (Fig. <xref ref-type="fig" rid="fig6">6</xref>D). However, we argue that such simple description of a tree, as using the allometric measures, cannot be exhaustive enough to capture both the overall structure and its fine details.</p>
        <p>The height statistics have the largest discrepancy amongst the three models in Fig. <xref ref-type="fig" rid="fig6">6</xref>, but by the visual inspection of the drawn clones one can see that this variability does not exert significant alterations of the z-axis span and the trees seem to have even heights. Perhaps the way we calculate the height of a tree produces such large deviations in each particular case, which makes it a non-robust estimator for modeling quality. That is, the overall branch density may not be affected if a single branch protrudes higher than others; thus the overall outlook of a tree is not affected, whereas its height is.</p>
        <p>Note also that the model clones in Fig. <xref ref-type="fig" rid="fig6">6</xref>A are the direct result of the optimization, i.e., the best-fit SSM. The clones in Fig. <xref ref-type="fig" rid="fig6">6</xref>B and C are obtained by manually adjusting the growth parameter to minimize the median distance profiles from Fig. <xref ref-type="fig" rid="fig5">5</xref>B and C, respectively. The growth iteration parameter directly affects the tree height. Hence, the larger proportion of clones with heights closer to the QSM height is achieved in case of the best-fit SSM (Fig. <xref ref-type="fig" rid="fig6">6</xref>D). Additionally, this indicates that the optimization implicitly accounts for such simple allometric measure as height.</p>
        <p>Similarly, the girth estimation, although being captured correctly, produces large errors <italic>d<sub>g</sub></italic>, which seems to be a result of variation in its linear dimensions (Fig. <xref ref-type="fig" rid="fig6">6</xref>D). The girth dimension spans a small proportion of the dimension of the whole tree: from several to tens of centimeters compared to meters of the whole tree. This makes the girth-specific error look gigantic (exceeding, in some cases, 100%) and thus non-robust as well.</p>
        <p>The crown spread measure shows significant variation (Fig. <xref ref-type="fig" rid="fig6">6</xref>D). We believe that this takes place due to the environment of the real tree the QSM was reconstructed from, which was not modeled appropriately in the SSM. Namely, the environmental effects (positions relative to the sun as the tree grows in the Northern country, animals, winds, neighboring trees, etc.) might cause systematic influences exerted on the shape of the QSM tree. These influences were not accounted for in the SSM, which was allowed to grow in any direction, limited by the uniform light conditions, existing branches of the same tree, and global boundaries of the available space. In addition to the environment influences, there are TLS measurement and QSM reconstruction errors, arising from the physical limitations of the instrumental technique and stochasticity of the QSM formation, respectively.</p>
        <p>Finally, the true understanding of the variability of any measures of the morphological clones comes with the measurements of the real clones, i.e., trees similar in shape and/or genetics. Carrying out control experiments with QSM reconstructed from the real clonal individuals can only assess the variability. These real clone controlled experiments can further identify whether the obtained variability is large/small for the given species/clones and lead to the adjustment of the optimization parameters.</p>
      </sec>
    </sec>
    <sec id="sec1-4">
      <title>Performance of the algorithm</title>
      <p>We have performed several tests on the performance of the algorithm. The most computationally intensive parts of the algorithm are the SSM simulation and optimization, which both depend on a particular SSM implementation and the parameter search space.</p>
      <p>Computational time and data size scale linearly, i.e., <italic>O</italic>(<italic>N</italic>), with the number of morphological features when extracted from a tree growth model.</p>
      <p>Next, we used surrogate data, namely standard normal distributions, for each of the features to assess the computational complexity of the distance algorithm. The results of this numerical assay are summarized in Fig. <xref ref-type="fig" rid="fig7">7</xref>.</p>
      <fig id="fig7" orientation="portrait" position="float">
        <label>Figure 7:</label>
        <caption>
          <p>Computational complexity of the distance algorithm. CPU time (<italic>s</italic>) vs number of line projections (<bold>A</bold>), number of structural features (<bold>B</bold>), and number of samples per structural feature (<bold>C</bold>). Specification: a single 2.9 GHz core is used; where fixed, the number of features is 20, the number of samples is 1000, the number of line projections is 1000 (B) and 500 (C).</p>
        </caption>
        <graphic xlink:href="gix079fig7"/>
      </fig>
      <fig id="fig8" orientation="portrait" position="float">
        <label>Figure 8:</label>
        <caption>
          <p>Visual structure of a tree and its representation using the structural data sets <italic>U</italic>. (<bold>A</bold>) A sample tree. (<bold>B</bold>) Geometrical features of the branch- (<italic>B</italic>) and segment-related (<italic>S</italic>) data sets. (<bold>C</bold>) Various projections of the <italic>U</italic> data sets.</p>
        </caption>
        <graphic xlink:href="gix079fig8"/>
      </fig>
    </sec>
    <sec id="sec1-5">
      <title>Bayes Forest Toolbox</title>
      <p>We developed a unified interface using Matlab (MATLAB, <ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/RRID:SCR_001622">RRID:SCR_001622</ext-link>) to facilitate exploration, drawing, optimization, and simulation of SSM and QSM as well as to study the morphological tree clones. Our interface allows for faster and easier manipulation of the required data, models, and optimization routines from the Matlab Optimization Toolbox, using only the required elements of otherwise complex Matlab configuration for the analysis.</p>
      <p>The Bayes Forest Toolbox is freely available online [<xref rid="bib36" ref-type="bibr">36</xref>, <xref rid="bib37" ref-type="bibr">37</xref>] ([<xref rid="bib36" ref-type="bibr">36</xref>] is the version used in this study, while [<xref rid="bib37" ref-type="bibr">37</xref>] is preferred for contributions and contains the latest version of the package). We also encourage the plant and computer scientists’ community to expand their efforts using the toolbox with other species and models. Such a systematic approach can further be useful in tinkering the best options for creating QSM, SSM, and construction of the structural data sets.</p>
    </sec>
    <sec id="sec2" sec-type="discussion">
      <title>Discussion</title>
      <p>In this work, we described an algorithmic pipeline aimed at producing stochastic structural replicas, or morphological “clones,” of trees from a QSM tree (based on TLS data) and a complimentary SSM tree. The pipeline is based on an iterative minimization of a distance between morphological structures. The distance is based on construction of the structural data sets of the tree morphologies and subsequent measures of their discrepancy using the ideas of the distribution tomography analysis. The resulting best-fit morphological clones are statistically similar, which is expressed in the overall similarity of their form and the difference in the fine details of their structural organization.</p>
      <p>Here, we have shown the general logic behind the pipeline for generation of the morphological clones. For this purpose, we used a highly variable procedural tree model [<xref rid="bib3" ref-type="bibr">3</xref>], which is more difficult to optimize. As the pipeline consists of several elementary steps, each of which can be changed according to the application and target analysis, we have proposed an initial setup and basic configuration. We assume larger possibilities of exploration of the proposed configuration, let alone changing the steps and individual algorithms within the pipeline, which could be fulfilled by the community of plant science researchers.</p>
      <p>The interest in building this pipeline was driven by biological applications rather than visualization purposes. Thus, for example, we use real TLS measurements and general purpose measures of the distance, while omitting visual effects (e.g., shades, leaves, etc.). We believe this pipeline can be useful in the rigorous analysis of the plant morphogenesis and corresponding applications, which differ from similar studies done in the computer graphics field (e.g., [<xref rid="bib5" ref-type="bibr">5</xref>]).</p>
      <p>Moreover, our algorithm makes use of the distance measure, taking into account a significant portion of the data for at least 1 topological order. This allows for a more comprehensive analysis of forms and their description, using empirical distributions of morphological features rather than scalar allometric entities. Due to this reason, we do not rely on the traditional metrics comparison in this work as we found that similar values for the height, girth, and crown distances may correspond to different tree forms and, thus, be non-robust.</p>
      <p>The use of several QSM trees can enhance the robustness of the statistical analysis presented here. In this case, similar-looking trees should be used, and the degree of similarity might be established using our definition of the structural distance. For example, the trunk features are more reliably reproduced in the statistical sense, when several QSMs are used. It might be stressed that other notions of “clone” can be used to establish a relationship with morphology. Thus, the genetic clones might be utilized to establish to what degree the morphology of a tree is encoded into genes.</p>
    </sec>
  </sec>
  <sec sec-type="methods" id="sec3">
    <title>Methods</title>
    <sec id="sec3-1">
      <title>Laser scanning measurements</title>
      <p>The subject tree was measured in leaf-off conditions, and our system consisted of a phase-shift-based terrestrial laser scanner, namely the Leica HDS6100 with a 650–690 nm wavelength. The distance measurement accuracy and the point separation angle of the scanner were about 2–3 mm and 0.036 degrees, respectively. The horizontal distance of the scanner to the trunk was about 7–12 m, giving an average point density on the surface of the trunk (at the level of the scanner) for a single scan of around 2–5 points per square centimeter. The QSM of the subject maple tree consists of 19 000 cylinders approximating 3078 branches.</p>
    </sec>
    <sec id="sec3-2">
      <title>Self-organizing tree model</title>
      <p>In this work, we used SOT implemented in the LPFG simulator, part of the Virtual Laboratory software suite [<xref rid="bib38" ref-type="bibr">38</xref>], version 4.4.0–2424 for 64-bit Mac OS (see [<xref rid="bib39" ref-type="bibr">39</xref>]). This procedural tree model is fast and able to generate variety of forms.</p>
      <p>The total number of growth parameters of the model is 27: 23 are grouped, 4 are fixed. The values of the latter are dictated both by suggestions of the authors in [<xref rid="bib3" ref-type="bibr">3</xref>] and the compromise between computation time and details of the morphological description. For example, the segment length is 0.2 m, the voxel size is 0.2 m, and the model tree grows within a 12 × 12 × 12 m cube from the center of XY bottom plane of the cube (z-axis is oriented upwards).</p>
      <p>The grouped parameters are divided between 5 distinct groups corresponding to different related processes:
<list list-type="order" id="lst5"><list-item><p>Group I: the initial growth parameters, including limiting values, and pipe model related parameters.</p></list-item><list-item><p>Group II: environmental effects such as sensitivity to the neighborhood shading, vertical gradient distribution of the light, tropism, etc.</p></list-item><list-item><p>Group III: apical dominance parameters.</p></list-item><list-item><p>Group IV: shadow propagation related constants (see [<xref rid="bib3" ref-type="bibr">3</xref>]).</p></list-item><list-item><p>Group V: angular/branching properties.</p></list-item></list></p>
    </sec>
    <sec id="sec3-3">
      <title>Data set representation</title>
      <p>One needs a more compact representation of the data since the larger the number of data sets <italic>U</italic> is, the larger number of distance values is and the more difficult the optimization becomes. One solution is to use larger data sets with all application-specific features. Therefore, we use tables including all measured features; hence, one table represents a data set. However, it is not possible to combine segment- and branch-related features into a single table as these differ in dimension (usually one branch is composed of many segments). Thus, we usually compare the array of pairs {<italic>U<sub>m</sub>, U<sub>d</sub></italic>}, having as a result the array of distance values, but with such larger table representation, we have a smaller size of these arrays. For example, one could form <italic>U</italic><sub>1</sub> from inclination angle <italic>β</italic> and <italic>U</italic><sub>2</sub> from azimuthal angle <italic>α</italic> or, alternatively, form a larger table <italic>U</italic> consisting of all branching features (<italic>β, α, L<sub>t</sub>, R<sub>f</sub>, L<sub>a</sub></italic> from Table <xref ref-type="table" rid="tbl1">1</xref>). The former distance would be formed from <italic>D<sub>1</sub></italic> and <italic>D<sub>2</sub></italic> for <italic>U<sub>1</sub></italic> and <italic>U<sub>2</sub></italic>, respectively, whereas the latter case would require a single distance to optimize.</p>
      <p>Additionally, it is possible to merge the corresponding data sets for several topological orders, which results at most in two large data sets of branching and segment features, respectively. While this simplifies the search of the distance minimum, this technique must be used with care as in this case one heavily relies upon the growth rules of SSM. If these rules are not based on biologically motivated rules, SSM can produce highly unrealistic tree forms as the “best fit” since there is a possibility to mix the features of different topological orders. For example, the branches of higher order could be much thicker than those of the lower order, which should not happen using biologically based growth algorithms (e.g., pipe model).</p>
      <p>In a simulated SSM structure, the extraction of topological relations between branches is straightforward: the lateral buds start the next order and apical buds continue the current order. However, this is not the case with QSM since it is a time snapshot of a tree form that does not retain the history of the tree growth. Thus, the reconstruction algorithm requires other means for extracting the topology. Although the reconstruction algorithm defines a complicated procedure that outlines the topology of a tree, it can be roughly approximated by the following rule: at branching points, the thickest branch is the continuation of the same order <italic>w</italic>, while thinner branches are lateral expansions of the order <italic>w</italic> + 1 [<xref rid="bib18" ref-type="bibr">18</xref>]. For the species with weak apical dominance (shrubby trees), we follow the rule when extracting topology from SSM (for the species with strong apical dominance, the rule gives the same result as the analytical procedure).</p>
    </sec>
    <sec id="sec3-4">
      <title>Structural and traditional distances</title>
      <p>The structural distance is calculated measuring difference between the normalized cumulative distributions of two point densities projected onto a number of line directions. The directions of lines are generated with a quasi–Monte Carlo method using low-discrepancy (quasi-random) sequences, which cover the given space more evenly than uniformly generated sequences.</p>
      <p>The empirical probability density function <italic>p(U), U</italic> ∈ <italic>R<sup>N</sup></italic>, can be approximated by the series of 1D density functions <italic>p<sub>1D</sub>(U, L)</italic>, where <italic>L</italic> is a line in <italic>R<sup>N</sup></italic>. Each of these 1D functions is constructed by projecting all the data points of <italic>U</italic> onto a line <italic>L</italic> (in this work, we used 1000 lines), see Fig. <xref ref-type="fig" rid="fig9">9</xref>A. Cumulative distributions <italic>P</italic><sub>1</sub><italic><sub>D</sub>(U<sub>m</sub>, L<sub>i</sub>)</italic> and <italic>P</italic><sub>1</sub><italic><sub>D</sub>(U<sub>d</sub>, L<sub>i</sub>)</italic> (<italic>U<sub>m</sub></italic> and <italic>U<sub>d</sub></italic> being the two point densities, e.g., SSM vs QSM data sets) for each line direction <italic>L<sub>i</sub></italic> are compared, and for any given data set pair {<italic>U<sub>m</sub>, U<sub>d</sub></italic>}, the resultant distance value is 
<disp-formula><tex-math id="M1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\[
{D_S} ({U_m},{U_d}) = \frac{1}{n}\ \mathop \sum \limits_{i=1}^n K
[{P_{1D}} ({U_m},{L_i}),{P_{1D}} ({U_d},{L_i})],
\]
\end{document}</tex-math></disp-formula>where <italic>n</italic> is the number of lines and operator <italic>K</italic>[ ·, · ] returns the Kolmogorov-Smirnov statistic for the given pair of 1D empirical cumulative distributions.</p>
      <p><italic>Height</italic> (<italic>h</italic>) is calculated as the highest point of a tree. <italic>Girth</italic> (<italic>g</italic>) is calculated as the diameter of the ground segment because the diameter at breast height is not appropriate for the shrubby trees. <italic>Crown spread</italic> (<italic>c</italic>) is calculated as follows. First, on the XY-plane (top view, Fig. <xref ref-type="fig" rid="fig9">9</xref>B), the set of spokes (red lines in Fig. <xref ref-type="fig" rid="fig9">9</xref>B) emanating from the center of a tree (the ground segment, green circle) is built with 10 degrees azimuthal separation. Then the length of each spoke is calculated as a distance from the tree center to the most distant point of the crown in the direction of the spoke (blue circles). The crown spread is twice the average of all spokes of a tree.</p>
      <fig id="fig9" orientation="portrait" position="float">
        <label>Figure 9:</label>
        <caption>
          <p>Distribution tomography of the structural data sets (<bold>A</bold>) and classical metric for the crown spread (<bold>B</bold>). (A) Data points in <italic>U</italic> (projected here for simplicity onto the (<italic>u<sub>i</sub>, u<sub>j</sub></italic>) plane, i.e., in 2D) are used to construct the projection onto a line <italic>L</italic>. Cumulative empirical distribution is calculated along <italic>L</italic> (red). Only one line is shown. (B) Top view of a tree: spokes (red) emanate from the ground segment (green), extending up to the most distant points (blue).</p>
        </caption>
        <graphic xlink:href="gix079fig9"/>
      </fig>
      <p>Finally, when comparing two tree shapes with traditional metrics, we calculate the distances as follows: 
<disp-formula><tex-math id="M2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\[
{d_h} = \frac{| {{h_d} - {h_m}} |}{{{h_d}}};
{d_g} = \frac{| {{g_d} - {g_m}} |}{{{g_d}}};
{d_c} = \frac{| {{c_d} - {c_m}} |}{{{c_d}}}.
\]
\end{document}</tex-math></disp-formula></p>
      <p>In this, <italic>h<sub>d</sub>, g<sub>d</sub></italic>, and <italic>c<sub>d</sub></italic> are the height, girth, and crown spread of the QSM tree, respectively, whereas <italic>h<sub>m</sub>, g<sub>m</sub></italic>, and <italic>c<sub>m</sub></italic> are the corresponding attributes of the best-fit SSM tree.</p>
    </sec>
    <sec id="sec3-5">
      <title>Genetic algorithm</title>
      <p>Any algorithm from a standard optimization library (e.g., Matlab Optimization Toolbox) that finds a minimum of an objective function (<italic>D<sub>S</sub> = F</italic>(<italic>v</italic>)) can be used. However, to facilitate global minimum search and given the nature of the problem, we use the genetic algorithm (implemented in Matlab, version R2015b). Additionally, some parameters of SSM may take only integer values, so the genetic algorithm handles the integer parameters correctly, unlike, for example, the classical steepest decent algorithm. The genetic algorithm iteratively finds a minimum of <italic>D<sub>S</sub></italic>, each iteration being called <italic>generation</italic>. Each generation is characterized with a number of individuals, i.e., <italic>population</italic>; one individual is equivalent to one set of the parameter values. The variation is controlled by the <italic>crossover rate</italic> (rate of recombination of the population parameters) and <italic>mutation rate</italic> (rate of introduction of the new variability into the population). The former is fixed to 80% in the Matlab Optimization Toolbox, whereas the latter is controlled by our configuration (19% in the rosette-shaped example, Fig. <xref ref-type="fig" rid="fig3">3</xref>, and 15% in the best-fit SSM from Fig. <xref ref-type="fig" rid="fig4">4</xref>). The user controls values’ ranges of the parameters. There are two types of ranges: <italic>global</italic> lower and upper boundaries for each of the parameter values and <italic>initial range</italic>, from which the algorithm tries to construct the initial population. The latter impacts the convergence rate: if it is too broad, poor convergence is attained. Finally, the algorithm stops when it reaches a fixed number of generations without improving the distance.</p>
      <p>Thus, the objective function takes the input parameters <italic>v</italic>, simulates SSM with <italic>v</italic>, calculates and returns structural data sets <italic>U<sub>m</sub></italic>. Subsequently, the objective function calculates <italic>D<sub>S</sub></italic>(<italic>U<sub>m</sub>, U<sub>d</sub></italic>) and returns it to the optimization routine. The SSM, being a stochastic model, <italic>must</italic> have a fixed random generator seed during optimization, i.e., the same input parameter set must produce the same structural output. This is needed for convergence of the optimization. After obtaining the final best-fit form of SSM, one can further explore the variability coming from different random number sequences used in the SSM simulations. Such a random best-fit SSM is capable of producing the clonal morphologies.</p>
    </sec>
  </sec>
  <sec id="sec4">
    <title>Availability of supporting source code and requirements</title>
    <p>Project name: BayesForest</p>
    <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/inuritdino/BayesForest/wiki">https://github.com/inuritdino/BayesForest/wiki</ext-link></p>
    <p>Operating system: platform independent</p>
    <p>Programming language: Matlab</p>
    <p>Other requirements: VLAB software suite, version ≥ 4.4.0–2424</p>
    <p>License: MIT</p>
  </sec>
  <sec id="sec5">
    <title>Data availability</title>
    <p>All data needed to reproduce the results of this study, some additional materials, and the Bayes Forest Toolbox are available online [<xref rid="bib36" ref-type="bibr">36</xref>, <xref rid="bib37" ref-type="bibr">37</xref>] ([<xref rid="bib36" ref-type="bibr">36</xref>] is the version used in this study, while [<xref rid="bib37" ref-type="bibr">37</xref>] is preferred for contributions and contains the latest version of the package). Tutorials on how to run the tests using the Matlab toolbox are available in the BayesForest Wiki [<xref rid="bib40" ref-type="bibr">40</xref>], and snapshots are also available in the <italic>GigaScience</italic> repository, <italic>Giga</italic>DB [<xref rid="bib41" ref-type="bibr">41</xref>].</p>
  </sec>
  <sec id="sec6">
    <title>Abbreviations</title>
    <p>FSPM: functional-structural plant model; QSM: quantitative structure model; SOT: self-organizing tree model; SSM: stochastic structure model; TLS: terrestrial laser scanning.</p>
  </sec>
  <sec id="sec7">
    <title>Funding</title>
    <p>This work was supported by the Academy of Finland: Suomen Akatemia (Center of Excellence in Inverse Problem Research; one of the PIs is Mikko Kaasalainen).</p>
  </sec>
  <sec id="sec8">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec id="sec9">
    <title>Author contributions</title>
    <p>I.P. performed all simulations, processed the data, and wrote the manuscript; M.J. wrote the code for calculating the structural distance and discussed the results; M.Å. contributed to the Bayes Forest Toolbox; P.R. generated and provided the QSM data, wrote the manuscript, and discussed the results; M.K. conceived the study, discussed the results, and wrote the manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>GIGA-D-17-00087_Original-Submission.pdf</label>
      <media xlink:href="gix079_GIGA-D-17-00087_Original-Submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup2">
      <label>GIGA-D-17-00087_Revision-1.pdf</label>
      <media xlink:href="gix079_GIGA-D-17-00087_Revision-1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup3">
      <label>Response-to-Reviewer-Comments_Original-Submission.pdf</label>
      <media xlink:href="gix079_Response-to-Reviewer-Comments_Original-Submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup4">
      <label>Reviewer-1-Report-(Original-Submission).pdf</label>
      <media xlink:href="gix079_Reviewer-1-Report-(Original-Submission).pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup5">
      <label>Reviewer-1_Original-Submission-(Attachment).pdf</label>
      <media xlink:href="gix079_Reviewer-1_Original-Submission-(Attachment).pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup6">
      <label>Reviewer-2-Report-(Original-Submission).pdf</label>
      <media xlink:href="gix079_Reviewer-2-Report-(Original-Submission).pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup7">
      <label>Reviewer-2-Report-(Revision-1).pdf</label>
      <media xlink:href="gix079_Reviewer-2-Report-(Revision-1).pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to thank Risto Sievänen and Wojtek Palubicki for useful discussion and comments on the model design and implementation.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="bib1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Prusinkiewicz</surname><given-names>P</given-names></name></person-group><article-title>Modeling plant growth and development</article-title>. <source>Curr Opin Plant Biol</source><year>2004</year>;<volume>7</volume>:<fpage>79</fpage>–<lpage>83</lpage>.<pub-id pub-id-type="pmid">14732445</pub-id></mixed-citation>
    </ref>
    <ref id="bib2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fourcaud</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Stokes</surname><given-names>A</given-names></name><etal/></person-group><article-title>Plant Growth modelling and applications: the increasing importance of plant architecture in growth models</article-title>. <source>Ann Botany</source><year>2008</year>;<volume>101</volume>:<fpage>1053</fpage>–<lpage>63</lpage>.<pub-id pub-id-type="pmid">18387970</pub-id></mixed-citation>
    </ref>
    <ref id="bib3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Palubicki</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Horel</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Longay</surname><given-names>S</given-names></name><etal/></person-group><article-title>Self-organizing tree models for image synthesis</article-title>. <source>ACM Trans Graph</source><year>2009</year>;<volume>28</volume>:<fpage>1</fpage>.</mixed-citation>
    </ref>
    <ref id="bib4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pirk</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Stava</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Kratt</surname><given-names>J</given-names></name><etal/></person-group><article-title>Plastic trees</article-title>. <source>ACM Trans Graph</source><year>2012</year>;<volume>31</volume>:<fpage>1</fpage>.</mixed-citation>
    </ref>
    <ref id="bib5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Stava</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Pirk</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Kratt</surname><given-names>J</given-names></name><etal/></person-group><article-title>Inverse procedural modelling of trees</article-title>. <source>Comput Graph Forum</source><year>2014</year>;<volume>33</volume>:<fpage>118</fpage>–<lpage>31</lpage>.</mixed-citation>
    </ref>
    <ref id="bib6">
      <label>6.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Hallé</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Oldeman</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Tomlinson</surname><given-names>P</given-names></name></person-group><source>Tropical Trees and Forests: An Architectural Analysis</source>. <publisher-loc>Berlin</publisher-loc>: <publisher-name>Springer</publisher-name>; <year>1978</year>.</mixed-citation>
    </ref>
    <ref id="bib7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sachs</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Novoplansky</surname><given-names>A</given-names></name></person-group><article-title>Tree form: architectural models do not suffice</article-title>. <source>Israel J Plant Sci</source><year>1995</year>;<volume>43</volume>:<fpage>203</fpage>–<lpage>12</lpage>.</mixed-citation>
    </ref>
    <ref id="bib8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Room</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Hanan</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Prusinkiewicz</surname><given-names>P</given-names></name></person-group><article-title>Virtual plants: new perspectives for ecologists, pathologists and agricultural scientists</article-title>. <source>Trends Plant Sci</source><year>1996</year>;<volume>1</volume>:<fpage>33</fpage>–<lpage>38</lpage>.</mixed-citation>
    </ref>
    <ref id="bib9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sievänen</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Nikinmaa</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Nygren</surname><given-names>P</given-names></name><etal/></person-group><article-title>Components of functional-structural tree models</article-title>. <source>Ann For Sci</source><year>2000</year>;<volume>57</volume>:<fpage>399</fpage>–<lpage>412</lpage>.</mixed-citation>
    </ref>
    <ref id="bib10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Godin</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Sinoquet</surname><given-names>H</given-names></name></person-group><article-title>Functional-structural plant modelling</article-title>. <source>New Phytol</source>, <year>2005</year>;<volume>166</volume>:<fpage>705</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">15869632</pub-id></mixed-citation>
    </ref>
    <ref id="bib11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mäkelä</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Hari</surname><given-names>P</given-names></name></person-group><article-title>Stand growth model based on carbon uptake and allocation in individual trees</article-title>. <source>Ecol Modell</source><year>1986</year>;<volume>33</volume>:<fpage>205</fpage>–<lpage>29</lpage>.</mixed-citation>
    </ref>
    <ref id="bib12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rauscher</surname><given-names>HM</given-names></name>, <name name-style="western"><surname>Isebrands</surname><given-names>JG</given-names></name>, <name name-style="western"><surname>Host</surname><given-names>GE</given-names></name><etal/></person-group><article-title>ECOPHYS: an ecophysiological growth process model for juvenile poplar</article-title>. <source>Tree Physiol</source><year>1990</year>;<volume>7</volume>:<fpage>255</fpage>–<lpage>81</lpage>.<pub-id pub-id-type="pmid">14972923</pub-id></mixed-citation>
    </ref>
    <ref id="bib13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Perttunen</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Sievänen</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Nikinmaa</surname><given-names>E</given-names></name><etal/></person-group><article-title>LIGNUM: a tree model based on simple structural units</article-title>. <source>Ann Bot</source><year>1996</year>;<volume>77</volume>:<fpage>87</fpage>–<lpage>98</lpage>.</mixed-citation>
    </ref>
    <ref id="bib14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lacointe</surname><given-names>A.</given-names></name></person-group><article-title>Carbon allocation among tree organs: a review of basic processes and representation in functional-structural tree models</article-title>. <source>Ann Forest Sci</source><year>2000</year>;<volume>57</volume>:<fpage>521</fpage>–<lpage>33</lpage>.</mixed-citation>
    </ref>
    <ref id="bib15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rosell</surname><given-names>JR</given-names></name>, <name name-style="western"><surname>Llorens</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Sanz</surname><given-names>R</given-names></name><etal/></person-group><article-title>Obtaining the three-dimensional structure of tree orchards from remote 2D terrestrial LIDAR scanning</article-title>. <source>Agricult Forest Meteorol</source><year>2009</year>;<volume>149</volume>:<fpage>1505</fpage>–<lpage>15</lpage>.</mixed-citation>
    </ref>
    <ref id="bib16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Van Leeuwen</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Nieuwenhuis</surname><given-names>M</given-names></name></person-group><article-title>Retrieval of forest structural parameters using lidar remote sensing</article-title>. <source>Eur J Forest Res</source><year>2010</year>;<volume>129</volume>:<fpage>749</fpage>–<lpage>70</lpage>.</mixed-citation>
    </ref>
    <ref id="bib17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rutzinger</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Pratihast</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Oude Elberink</surname><given-names>S</given-names></name><etal/></person-group><article-title>Detection and modelling of 3D trees from mobile laser scanning data</article-title>. <source>Int Arch Photogramm Remote Sens Spat Inform Sci</source><year>2010</year>;<volume>XXXVIII</volume>:<fpage>520</fpage>–<lpage>5</lpage>.</mixed-citation>
    </ref>
    <ref id="bib18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Raumonen</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Kaasalainen</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Åkerblom</surname><given-names>M</given-names></name><etal/></person-group><article-title>Fast automatic precision tree models from terrestrial laser scanner data</article-title>. <source>Remote Sensing</source><year>2013</year>;<volume>5</volume>:<fpage>491</fpage>–<lpage>520</lpage>.</mixed-citation>
    </ref>
    <ref id="bib19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Calders</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Newnham</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Burt</surname><given-names>A</given-names></name><etal/></person-group><article-title>Nondestructive estimates of above-ground biomass using terrestrial laser scanning</article-title>. <source>Methods Ecol Evol</source><year>2015</year>;<volume>6</volume>:<fpage>198</fpage>–<lpage>208</lpage>.</mixed-citation>
    </ref>
    <ref id="bib20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Xu</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Gossett</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>B</given-names></name></person-group><article-title>Knowledge and heuristic-based modeling of laser-scanned trees</article-title>. <source>ACM Trans Graph</source><year>2007</year>;<volume>26</volume>:<fpage>19</fpage>.</mixed-citation>
    </ref>
    <ref id="bib21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Livny</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Yan</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Olson</surname><given-names>M</given-names></name><etal/></person-group><article-title>Automatic reconstruction of tree skeletal structures from point clouds</article-title>. <source>ACM Trans Graph</source><year>2010</year>;<volume>29</volume>:<fpage>1</fpage>.</mixed-citation>
    </ref>
    <ref id="bib22">
      <label>22.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Preuksakarn</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Boudon</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Ferraro</surname><given-names>P</given-names></name><etal/></person-group><article-title>Reconstructing plant architecture from 3D laser scanner data</article-title>. In: <person-group person-group-type="editor"><name name-style="western"><surname>DeJong</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Da Silva</surname><given-names>D</given-names></name></person-group>, eds., <source>Proceedings of the 6th International Workshop on Functional-Structural Plant Models</source>. <publisher-loc>USA</publisher-loc>: <publisher-name>University of California, Davis</publisher-name>, <year>2010</year> p. <fpage>14</fpage>–<lpage>16</lpage>.</mixed-citation>
    </ref>
    <ref id="bib23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hackenberg</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Spiecker</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Calders</surname><given-names>K</given-names></name><etal/></person-group><article-title>SimpleTree—an efficient open source tool to build tree models from TLS clouds</article-title>. <source>Forests</source><year>2015</year>;<volume>6</volume>:<fpage>4245</fpage>–<lpage>94</lpage>.</mixed-citation>
    </ref>
    <ref id="bib24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kaasalainen</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Krooks</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Liski</surname><given-names>J</given-names></name><etal/></person-group><article-title>Change detection of tree biomass with terrestrial laser scanning and quantitative structure modelling</article-title>. <source>Remote Sensing</source><year>2014</year>;<volume>6</volume>:<fpage>3906</fpage>–<lpage>22</lpage>.</mixed-citation>
    </ref>
    <ref id="bib25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Raumonen</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Casella</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Calders</surname><given-names>K</given-names></name><etal/></person-group><article-title>Massive-scale tree modelling from TLS data</article-title>. <source>ISPRS Ann Photogramm Remote Sens Spatial Inf Sci</source><year>2015</year>;<volume>II-3/W4</volume>:<fpage>189</fpage>–<lpage>96</lpage>.</mixed-citation>
    </ref>
    <ref id="bib26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Smith</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Astrup</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Raumonen</surname><given-names>P</given-names></name><etal/></person-group><article-title>Tree root system characterization and volume estimation by terrestrial laser scanning and quantitative structure modeling</article-title>. <source>Forests</source><year>2014</year>;<volume>5</volume>:<fpage>3274</fpage>–<lpage>94</lpage>.</mixed-citation>
    </ref>
    <ref id="bib27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kaasalainen</surname><given-names>M</given-names></name></person-group><article-title>Dynamical tomography of gravitationally bound systems</article-title>. <source>IPI</source><year>2008</year>;<volume>2</volume>:<fpage>527</fpage>–<lpage>46</lpage>.</mixed-citation>
    </ref>
    <ref id="bib28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bracewell</surname><given-names>RN</given-names></name></person-group><article-title>Numerical transforms</article-title>. <source>Science</source><year>1990</year>;<volume>248</volume>:<fpage>697</fpage>–<lpage>704</lpage>.<pub-id pub-id-type="pmid">17812072</pub-id></mixed-citation>
    </ref>
    <ref id="bib29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sievänen</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Perttunen</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Nikinmaa</surname><given-names>E</given-names></name><etal/></person-group><article-title>Toward extension of a single tree functional–structural model of Scots pine to stand level: effect of the canopy of randomly distributed, identical trees on development of tree structure</article-title>. <source>Functional Plant Biol</source><year>2008</year>;<fpage>964</fpage>–<lpage>75</lpage>.</mixed-citation>
    </ref>
    <ref id="bib30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Potapov</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Järvenpää</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Åkerblom</surname><given-names>M</given-names></name><etal/></person-group><article-title>Data-based stochastic modeling of tree growth and structure formation</article-title>. <source>Silva Fenn</source><year>2016</year>;<volume>50</volume>:<fpage>1413</fpage>.</mixed-citation>
    </ref>
    <ref id="bib31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Åkerblom</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Raumonen</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Kaasalainen</surname><given-names>M</given-names></name><etal/></person-group><article-title>Analysis of geometric primitives in quantitative structure models of tree stems</article-title>. <source>Remote Sensing</source><year>2015</year>;<volume>7</volume>:<fpage>4581</fpage>–<lpage>603</lpage>.</mixed-citation>
    </ref>
    <ref id="bib32">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lu</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Nygren</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Perttunen</surname><given-names>J</given-names></name><etal/></person-group><article-title>Application of the functional-structural tree model LIGNUM to growth simulation of short-rotation eastern cottonwood</article-title>. <source>Silva Fenn</source><year>2011</year>;<volume>45</volume>:<fpage>431</fpage>–<lpage>74</lpage>.</mixed-citation>
    </ref>
    <ref id="bib33">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>De Reffye</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Fourcaud</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Blaise</surname><given-names>F</given-names></name><etal/></person-group><article-title>A functional model of tree growth and tree architecture</article-title>. <source>Silva Fenn</source><year>1997</year>;<volume>31</volume>:<fpage>297</fpage>–<lpage>311</lpage>.</mixed-citation>
    </ref>
    <ref id="bib34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yan</surname><given-names>H-P</given-names></name>, <name name-style="western"><surname>Kang</surname><given-names>M</given-names></name>, <name name-style="western"><surname>de Reffye</surname><given-names>P</given-names></name><etal/></person-group><article-title>A dynamic, architectural plant model simulating resource-dependent growth</article-title>. <source>Ann Botany</source><year>2004</year>;<volume>93</volume>:<fpage>591</fpage>–<lpage>602</lpage>.<pub-id pub-id-type="pmid">15056562</pub-id></mixed-citation>
    </ref>
    <ref id="bib35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Frank</surname><given-names>E</given-names></name></person-group><article-title>A numerical method of plotting tree shapes</article-title>. <source>Bull East Nat Tree Soc</source><year>2010</year>;<volume>6</volume>:<fpage>2</fpage>–<lpage>8</lpage>.</mixed-citation>
    </ref>
    <ref id="bib36">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Potapov</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Järvenpää</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Åkerblom</surname><given-names>M</given-names></name><etal/></person-group><article-title>Bayes Forest Toolbox</article-title>. <comment><ext-link ext-link-type="uri" xlink:href="http://math.tut.fi/inversegroup/app/bayesforest/v1/">http://math.tut.fi/inversegroup/app/bayesforest/v1/</ext-link>. Accessed 25 June 2017</comment>.</mixed-citation>
    </ref>
    <ref id="bib37">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Potapov</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Järvenpää</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Åkerblom</surname><given-names>M</given-names></name><etal/></person-group><article-title>Bayes Forest Toolbox: the developmental version</article-title>. <comment><ext-link ext-link-type="uri" xlink:href="https://github.com/inuritdino/BayesForest">https://github.com/inuritdino/BayesForest</ext-link></comment>.</mixed-citation>
    </ref>
    <ref id="bib38">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Federl</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Prusinkiewicz</surname><given-names>P</given-names></name></person-group><article-title>Virtual Laboratory: an interactive software environment for computer graphics</article-title>. In: <source>Proceedings of Computer Graphics International</source>, <year>1999</year> p. <fpage>93</fpage>–<lpage>100</lpage>.</mixed-citation>
    </ref>
    <ref id="bib39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Prusinkiewicz</surname><given-names>P</given-names></name></person-group><article-title>Virtual laboratory (VLAB)/L-studio homepage</article-title>. <comment><ext-link ext-link-type="uri" xlink:href="http://algorithmicbotany.org/virtual_laboratory/">http://algorithmicbotany.org/virtual_laboratory/</ext-link>. Accessed 17 April 2017</comment>.</mixed-citation>
    </ref>
    <ref id="bib40">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>The BayesForest Wiki</collab></person-group><comment><ext-link ext-link-type="uri" xlink:href="https://github.com/inuritdino/BayesForest/wiki">https://github.com/inuritdino/BayesForest/wiki</ext-link>. Accessed 24 June 2017</comment>.</mixed-citation>
    </ref>
    <ref id="bib41">
      <label>41.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Potapov</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Järvenpää</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Åkerblom</surname><given-names>M</given-names></name><etal/></person-group><article-title>Bayes Forest: a data-intensive generator of morphological tree clones</article-title><source>GigaScience Database</source><year>2017</year><comment><ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5524/100337">http://dx.doi.org/10.5524/100337</ext-link></comment>.</mixed-citation>
    </ref>
  </ref-list>
</back>
