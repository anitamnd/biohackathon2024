<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7884436</article-id>
    <article-id pub-id-type="publisher-id">21312</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-021-21312-2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Fast and precise single-cell data analysis using a hierarchical autoencoder</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2918-8601</contrib-id>
        <name>
          <surname>Tran</surname>
          <given-names>Duc</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nguyen</surname>
          <given-names>Hung</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tran</surname>
          <given-names>Bang</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1441-897X</contrib-id>
        <name>
          <surname>La Vecchia</surname>
          <given-names>Carlo</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2172-1849</contrib-id>
        <name>
          <surname>Luu</surname>
          <given-names>Hung N.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8001-9470</contrib-id>
        <name>
          <surname>Nguyen</surname>
          <given-names>Tin</given-names>
        </name>
        <address>
          <email>tinn@unr.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.266818.3</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 914X</institution-id><institution>Department of Computer Science and Engineering, </institution><institution>University of Nevada Reno, </institution></institution-wrap>Reno, NV USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.4708.b</institution-id><institution-id institution-id-type="ISNI">0000 0004 1757 2822</institution-id><institution>Department of Clinical Sciences and Community Health, </institution><institution>University of Milan, </institution></institution-wrap>Milan, Italy </aff>
      <aff id="Aff3"><label>3</label>Division of Cancer Control and Population Sciences, Hillman Cancer Center, University of Pittsburgh Medical Center, Pittsburgh, PA USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.21925.3d</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 9000</institution-id><institution>Department of Epidemiology, </institution><institution>University of Pittsburgh Graduate School of Public Health, </institution></institution-wrap>Pittsburgh, PA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>15</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>12</volume>
    <elocation-id>1029</elocation-id>
    <history>
      <date date-type="received">
        <day>29</day>
        <month>12</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>12</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">A primary challenge in single-cell RNA sequencing (scRNA-seq) studies comes from the massive amount of data and the excess noise level. To address this challenge, we introduce an analysis framework, named single-cell Decomposition using Hierarchical Autoencoder (scDHA), that reliably extracts representative information of each cell. The scDHA pipeline consists of two core modules. The first module is a non-negative kernel autoencoder able to remove genes or components that have insignificant contributions to the part-based representation of the data. The second module is a stacked Bayesian autoencoder that projects the data onto a low-dimensional space (compressed). To diminish the tendency to overfit of neural networks, we repeatedly perturb the compressed space to learn a more generalized representation of the data. In an extensive analysis, we demonstrate that scDHA outperforms state-of-the-art techniques in many research sub-fields of scRNA-seq analysis, including cell segregation through unsupervised learning, visualization of transcriptome landscape, cell classification, and pseudo-time inference.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Accurate analysis of single-cell RNA sequencing (scRNA-seq) data is affected by issues including technical noise and high dropout rate. Here, the authors develop a hierarchical autoencoder, scDHA, which outperforms existing methods in scRNA-seq analyses such as cell segregation and classification.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Machine learning</kwd>
      <kwd>Software</kwd>
      <kwd>RNA sequencing</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000057</institution-id>
            <institution>U.S. Department of Health &amp; Human Services | NIH | National Institute of General Medical Sciences (NIGMS)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>GM103440</award-id>
        <principal-award-recipient>
          <name>
            <surname>Nguyen</surname>
            <given-names>Tin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation (NSF)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2001385</award-id>
        <award-id>2019609</award-id>
        <principal-award-recipient>
          <name>
            <surname>Nguyen</surname>
            <given-names>Tin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000104</institution-id>
            <institution>National Aeronautics and Space Administration (NASA)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>80NSSC19M0170</award-id>
        <award-id>NNX15AI02H</award-id>
        <principal-award-recipient>
          <name>
            <surname>Nguyen</surname>
            <given-names>Tin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">Advances in microfluidics and sequencing technologies have allowed us to monitor biological systems at single-cell resolution<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref></sup>. This comprehensive decomposition of complex tissues holds enormous potential in both developmental biology and clinical research<sup><xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR5">5</xref></sup>. Many computational methods have been developed to extract valuable information available in massive single-cell RNA sequencing data. These include methods for cell segregation, transcriptome landscape visualization, cell classification, and pseudo-time inference.</p>
    <p id="Par4">Defining cell types through unsupervised learning, also known as cell segregation or clustering, is considered the most powerful application of scRNA-seq data<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>. This has led to the creation of a number of atlas projects<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR8">8</xref></sup>, which aim to build the references of all cell types in model organisms at various developmental stages. Widely-used methods in this category include SC3<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, SEURAT<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>, SINCERA<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>, CIDR<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>, and SCANPY<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>. Another fundamental application of scRNA-seq is the visualization of transcriptome landscape. Computational methods in this category aim at representing the high-dimensional scRNA-seq data in a low-dimensional space while preserving the relevant structure of the data. Non-linear methods<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>, including Isomap<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>, Diffusion Map<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>, t-SNE<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>, and UMAP<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, have been recognized as efficient techniques to avoid overcrowding due to the large number of cells, while preserving the local data structure. Among these, t-SNE is the most commonly used technique while UMAP and SCANPY are recent methods.</p>
    <p id="Par5">Visualizing transcriptome landscape and building comprehensive atlases are problems of unsupervised learning. Once the cellular subpopulations have been determined and validated, classification techniques can be used to determine the composition of new data sets by classifying cells into discrete types. Dominant classification methods include XGBoost<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>, Random Forest (RF)<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>, Deep Learning (DL)<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>, and Gradient Boosting Machine (GBM)<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. Another important downstream analysis is pseudo-time inference. Cellular processes, such as cell cycle, proliferation, differentiation, and activation<sup><xref ref-type="bibr" rid="CR23">23</xref>,<xref ref-type="bibr" rid="CR24">24</xref></sup>, can be modeled computationally using trajectory inference methods. These methods aim at ordering the cells along developmental trajectories. Among a number of trajectory inference tools, Monocle<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>, TSCAN<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>, Slingshot<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>, and SCANPY<sup><xref ref-type="bibr" rid="CR13">13</xref></sup> are considered state-of-the-art and are widely used for pseudo-temporal ordering.</p>
    <p id="Par6">As the volume of scRNA-seq data increases exponentially each year<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>, the above-mentioned methods have become primary investigation tools in many research fields, including cancer<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>, immunology<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>, or virology<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>. However, the ever-increasing number of cells, technical noise, and high dropout rate pose significant computational challenges in scRNA-seq analysis<sup><xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR32">32</xref>,<xref ref-type="bibr" rid="CR33">33</xref></sup>. These challenges affect both analysis accuracy and scalability, and greatly hinder our capability to extract the wealth of information available in single-cell data.</p>
    <p id="Par7">In this work, we develop a new analysis framework, called single-cell Decomposition using Hierarchical Autoencoder (scDHA), that can efficiently detach noise from informative biological signals. The scDHA pipeline consists of two core modules (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). The first module is a non-negative kernel autoencoder that provides a non-negative, part-based representation of the data. Based on the weight distribution of the encoder, scDHA removes genes or components that have insignificant contributions to the representation. The second module is a Stacked Bayesian Self-learning Network that is built upon the Variational Autoencoder (VAE)<sup><xref ref-type="bibr" rid="CR34">34</xref></sup> to project the data onto a low-dimensional space (see Methods section). Using this informative and compact representation, many analyses can be performed with high accuracy and tractable time complexity (mostly linear or lower complexity). In one joint framework, the scDHA software package conducts cell segregation through unsupervised learning, dimension reduction and visualization, cell classification, and time-trajectory inference. We will show that scDHA outperforms state-of-the-art methods in all four sub-fields: cell segregation through unsupervised learning, transcriptome landscape visualization, cell classification, and pseudo-time inference.<fig id="Fig1"><label>Fig. 1</label><caption><title>Overview of scDHA architecture and analysis performance on 34 scRNA-seq data sets.</title><p><bold>a</bold> Schematic overview of scDHA and applications: cell segregation through unsupervised learning, visualization, pseudo-temporal ordering, and cell classification. <bold>b</bold> Clustering performance of scDHA, SC3, SEURAT, SINCERA, CIDR, SCANPY, and k-means measured by adjusted Rand index (ARI). The first 34 panels show the ARI values obtained for individual data sets whereas the last panel shows the average ARIs and their variance (vertical segments). scDHA significantly outperforms other clustering methods by having the highest ARI values (<italic>p</italic> = 2.2 × 10<sup>−16</sup> using one-sided Wilcoxon test). <bold>c</bold> Running time of the clustering methods, each using 10 cores. scDHA is the fastest among the six methods. <bold>d</bold> Color-coded representation of the Kolodziejczyk and Segerstolpe data sets using scDHA, PCA, t-SNE, UMAP, and SCANPY (from left to right). For each representation, we report the silhouette index, which measures the cohesion among cells of the same type, as well as the separation between different cell types. <bold>e</bold> Average silhouette values (bar plot) and their variance (vertical lines). scDHA significantly outperforms other dimension reduction methods by having the highest silhouette values (<italic>p</italic> = 1.7 × 10<sup>−6</sup> using one-sided Wilcoxon test).</p></caption><graphic xlink:href="41467_2021_21312_Fig1_HTML" id="d32e482"/></fig></p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Cell segregation</title>
      <p id="Par8">We assess the performance of scDHA in clustering using 34 scRNA-seq data sets with known cell types (see Methods section for details of each data set). The true class information of these data sets is only used a posteriori to assess the results. We compare scDHA with five methods that are widely used for single-cell clustering: SC3<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, SEURAT<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>, SINCERA<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>, CIDR<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>, and SCANPY<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>. Note that SCANPY is also an all-in-one pipeline that is able to perform three types of analysis: clustering, visualization, and pseudo-time inference. We include k-means as the reference method in cluster analysis.</p>
      <p id="Par9">As the true cell types are known in these data sets, we use adjusted Rand index (ARI)<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> to assess the performance of the six clustering methods. Figure <xref rid="Fig1" ref-type="fig">1</xref>b shows the ARI values obtained for each data set, as well as the average ARIs and their variances. scDHA outperforms all other methods by not only having the highest average ARI, but also being the most consistent method. The average ARI of scDHA across all 34 data sets is 0.81 with very low variability. The second best method, CIDR, has an average ARI of only 0.5. The one-sided Wilcoxon test also indicates that the ARI values of scDHA are significantly higher than the rest with a p-value of 2.2 × 10<sup>−16</sup>.</p>
      <p id="Par10">To perform a more comprehensive analysis, we calculate the normalized mutual information (NMI) and Jaccard index (JI) for each method (Supplementary Section <xref rid="MOESM1" ref-type="media">1</xref> and Tables <xref rid="MOESM1" ref-type="media">2</xref>–<xref rid="MOESM1" ref-type="media">4</xref>). We also compare the methods across different data platforms: plate-based, flow-cell-based, Smart-Seq1/2, SMARTer, inDrop, and 10X Genomics (see Supplementary Fig. <xref rid="MOESM1" ref-type="media">23</xref>). Regardless of the assessment metrics, scDHA consistently outperforms all other methods. At the same time, scDHA and SCANPY are the fastest among the seven methods (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c and Supplementary Table <xref rid="MOESM1" ref-type="media">5</xref>). For the Macosko data set with 44 thousand cells, scDHA finishes the analysis in less than five minutes. On the contrary, it takes CIDR &gt;2 days (3312 minutes) to finish the analysis of this data set. In summary, scDHA outperforms other clustering methods in terms of both accuracy and scalability.</p>
      <p id="Par11">We also assess the performance of the clustering methods using simulation. We use Splatter<sup><xref ref-type="bibr" rid="CR36">36</xref></sup> to generate 25 data sets with 10,000 genes and varying number of cells (5000, 10,000, 25,000, 50,000, and 100,000) and sparsity levels (28%, 32%, 37%, 44%, 51%). Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref> shows the ARI values obtained from comparing the discovered groups against the ground truth. Overall, scDHA has the highest ARI values in our analysis. Similar to the analysis of real data sets, scDHA and SCANPY are the fastest among the seven methods (see Supplementary Section <xref rid="MOESM1" ref-type="media">1.4</xref> for more details).</p>
      <p id="Par12">Note that the 34 single-cell data sets were normalized using different techniques by the data providers: raw counts (12 data sets), counts per million mapped reads (CPM, six data sets), reads per kilobase million (RPKM, eight data sets), and transcript per million (TPM, eight data sets). To understand the effect of normalization on the performance of scDHA, we re-normalize each data set using TPM, CPM, and RPKM, and then re-analyze the data. Our analysis shows that TMP-normalized data has a slight advantage over CPM- and RPKM-normalized data when using scDHA (see Supplementary Section <xref rid="MOESM1" ref-type="media">1.5</xref> and Fig. <xref rid="MOESM1" ref-type="media">2</xref>).</p>
    </sec>
    <sec id="Sec4">
      <title>Dimension reduction and visualization</title>
      <p id="Par13">Here, we demonstrate that scDHA is more efficient than t-SNE, UMAP, and SCANPY, as well as the classical principal component analysis (PCA) in visualizing single-cell data. We test the five techniques on the same 34 single-cell data sets described above. Again, cell type information is not given as input to any algorithm.</p>
      <p id="Par14">The top row of Fig. <xref rid="Fig1" ref-type="fig">1</xref>d shows the color-coded representations of the Kolodziejczyk data set, which consists of three types of mouse embryo stem cells: <italic>2i</italic>, <italic>a2i</italic>, and <italic>lif</italic>. The classical PCA simply rotates the orthogonal coordinates to place dissimilar data points far apart in the two-dimensional (2D) space. In contrast, t-SNE focuses on representing similar cells together in order to preserve the local structure. In this analysis, t-SNE splits each of the two classes <italic>2i</italic> and <italic>a2i</italic> into two smaller groups, and <italic>lif</italic> class into three groups. The transcriptome landscape represented by UMAP is similar to that of t-SNE, in which UMAP also splits cells of the same type into smaller groups. According to the authors of this data set<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>, embryonic stem cells were cultured in three different conditions: <italic>lif</italic> (serum media that has leukemia inhibitory factor), <italic>2i</italic> (basal media that has GSK3<italic>β</italic> and Mek1/2 inhibitor), and <italic>a2i</italic> (alternative <italic>2i</italic> that has GSK3<italic>β</italic> and Src inhibitor). The <italic>lif</italic> cells were measured in two batches and both t-SNE and UMAP split this cell type according to batches. Similarly, the <italic>a2i</italic> cells were measured by two batches and the cells were separated according to batches. The <italic>2i</italic> cells were measured by four batches (chip1–2 cells, chip2–59 cells, chip3–72 cells, and chip4 - 82 cells). Both t-SNE and UMAP split the cells into two groups: the first group consists of cells from chip1 and the second group consists of cells from chip2, chip3, and chip4 (see Supplementary Section <xref rid="MOESM1" ref-type="media">2.2</xref> and Fig. <xref rid="MOESM1" ref-type="media">18</xref> for more details). SCANPY is able to mitigate batch effects in the <italic>lif</italic> cells but still splits <italic>2i</italic> and <italic>a2i</italic> cells. In contrast, scDHA provides a clear representation of the data, in which cells of the same type are grouped together and cells of different types are well separated.</p>
      <p id="Par15">The lower row of Fig. <xref rid="Fig1" ref-type="fig">1</xref>d shows the visualization of the Sergerstolpe data set (human pancreas). The landscapes of SCANPY, UMAP, and t-SNE are better than that of PCA. In these representations, the cell types are separable. However, the cells are overcrowded and many cells from different classes overlap. Also, the <italic>alpha</italic>, <italic>beta,</italic> and <italic>gamma</italic> cells are split into smaller groups. According to the authors of this data set<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>, the data were collected from different donors, which is potentially the source of heterogeneity. For this data set, scDHA better represents the data by clearly showing the transcriptome landscape with separable cell types.</p>
      <p id="Par16">To quantify the performance of each method, we calculate the silhouette index (SI)<sup><xref ref-type="bibr" rid="CR39">39</xref></sup> of each representation using true cell labels. This metric measures the cohesion among the cells of the same type and the separation among different cell types. For both data sets shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>d, the SI values of scDHA are much higher than those obtained for PCA, t-SNE, UMAP, and SCANPY. The visualization, SI values, and running time of all data sets are shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">9</xref>–<xref rid="MOESM1" ref-type="media">17</xref> and Tables <xref rid="MOESM1" ref-type="media">6</xref> and <xref rid="MOESM1" ref-type="media">7</xref>. The average SI values obtained across the 34 data sets are shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>e. We also compare the methods across different data platforms: plate-based, flow-cell-based, Smart-Seq1/2, SMARTer, inDrop, and 10X Genomics (Supplementary Fig. <xref rid="MOESM1" ref-type="media">24</xref>). Overall, scDHA consistently and significantly outperforms other methods (<italic>p</italic> = 1.7 × 10<sup>−6</sup>).</p>
    </sec>
    <sec id="Sec5">
      <title>Cell classification</title>
      <p id="Par17">We assess scDHA’s classification capability by comparing it with four methods that are dominant in machine learning: XGBoost (XGB)<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>, Random Forest (RF)<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>, Deep Learning (DL)<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>, and Gradient Boosted Machine (GBM)<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>.</p>
      <p id="Par18">We test these methods using five data sets: Baron (8569 cells), Segerstolpe (2209 cells), Muraro (2126 cells), Xin (1600 cells), and Wang (457 cells). All five data sets are related to human pancreas and thus have similar cell types. In each analysis scenario, we use one data set as training and then classify the cells in the remaining four data sets. For example, we first train the models on Baron and then test them on Segerstolpe, Muraro, Xin, and Wang. Next, we train the models on Segerstolpe and test on the rest, etc. The accuracy of each method is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref> and Supplementary Table <xref rid="MOESM1" ref-type="media">8</xref>.<fig id="Fig2"><label>Fig. 2</label><caption><title>Classification accuracy of scDHA, XGBoost (XGB), Random Forest (RF), Deep Learning (DL), Gradient Boosted Machine (GBM) using five human pancreatic data sets.</title><p>In each scenario (row), we use one data set as training and the rest as testing, resulting in 20 train-predict pairs. The overall panel shows the average accuracy values and their variance (vertical segment). The accuracy values of scDHA are significantly higher than those of other methods (<italic>p</italic> = 2.1 × 10<sup>−8</sup> using Wilcoxon one-tailed test).</p></caption><graphic xlink:href="41467_2021_21312_Fig2_HTML" id="d32e738"/></fig></p>
      <p id="Par19">Overall, scDHA is accurate across all 20 combinations with accuracy ranging from 0.88 to 1. scDHA outperforms other methods by having the highest accuracy. The average accuracy of scDHA is 0.96, compared with 0.77, 0.69, 0.43, and 0.72 for XGB, RF, DL, and GBM, respectively. In addition, scDHA is very consistent, while the performance of existing methods fluctuates from one analysis to another, especially when the testing data set is much larger than the training data set. For example, when the testing set (Baron) is 20 times larger than the training set (Wang), the accuracy of existing methods is close to 30%, whereas scDHA achieves an accuracy of 0.93. The one-sided Wilcoxon test also confirms that the accuracy values of scDHA are significantly higher than the rest (<italic>p</italic> = 2.1 × 10<sup>−8</sup>). Regarding time complexity, scDHA is the fastest with an average running time of two minutes per analysis (Supplementary Fig. <xref rid="MOESM1" ref-type="media">20</xref>).</p>
    </sec>
    <sec id="Sec6">
      <title>Time-trajectory inference</title>
      <p id="Par20">Here we compare the performance of scDHA with state-of-the-art methods for time-trajectory inference: Monocle<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>, TSCAN<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>, Slingshot<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>, and SCANPY<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>. We test scDHA and these methods using three mouse embryo development data sets: Yan, Goolam, and Deng. The true developmental stages of these data sets are only used a posteriori to assess the performance of the methods.</p>
      <p id="Par21">Figure <xref rid="Fig3" ref-type="fig">3</xref>a shows the Yan data set in the first two t-SNE components. The smoothed lines shown in each panel indicate the time-trajectory of scDHA (left) and Monocle (right). The trajectory inferred by scDHA accurately follows the true developmental stages: it starts from zygote, going through 2cell, 4cell, 8cell, 16cell, and then stops at the blast class. On the contrary, the trajectory of Monocle goes directly from zygote to 8cell before coming back to 2cell. Figure <xref rid="Fig3" ref-type="fig">3</xref>b shows the cells ordered by pseudo-time. The time inferred by scDHA is strongly correlated with the true developmental stages. On the other hand, Monocle fails to differentiate between zygote, 2cell, and 4cell. To quantify how well the inferred trajectory explains the developmental stages, we also calculate the R-squared value. scDHA outperforms Monocle by having a higher R-squared value (0.93 compared with 0.84).<fig id="Fig3"><label>Fig. 3</label><caption><title>Pseudo-time inference of three mouse embryo development data sets (Yan, Goolam, and Deng) using scDHA and Monocle.</title><p><bold>a</bold> Visualized time-trajectory of the Yan data set in the first two t-SNE dimensions using scDHA (left) and Monocle (right). <bold>b</bold> Pseudo-temporal ordering of the cells in the Yan data set. The horizontal axis shows the inferred time for each cell while the vertical axis shows the true developmental stages. <bold>c</bold>, <bold>d</bold> Time-trajectory of the Goolam data set. Monocle is unable to estimate the time for most cells in 8cell, 16cell, and blast (colored in gray). <bold>e</bold>, <bold>f</bold> Time-trajectory of the Deng data set. Monocle is unable to estimate the pseudo-time for most blast cells.</p></caption><graphic xlink:href="41467_2021_21312_Fig3_HTML" id="d32e806"/></fig></p>
      <p id="Par22">Figure <xref rid="Fig3" ref-type="fig">3</xref>c, d show the results of the Goolam data set. scDHA correctly reconstructs the time-trajectory whereas Monocle fails to estimate pseudo-time for 8cell, 16cell, and blast cells (colored in gray). Monocle assigns an "infinity” value for these cell classes. Figure <xref rid="Fig3" ref-type="fig">3</xref>e, f show the results obtained for the Deng data set. Similarly, the time-trajectory inferred by scDHA accurately follows the developmental stages, whereas Monocle cannot estimate the time for half of the cells. The results of TSCAN, Slingshot, and SCANPY are shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">21</xref>, <xref rid="MOESM1" ref-type="media">22</xref>. scDHA outperforms all three methods by having the highest R-squared values in every single analysis.</p>
    </sec>
  </sec>
  <sec id="Sec7" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par23">The ever-increasing number of cells, technical noise, and high dropout rate pose significant computational challenges in scRNA-seq analysis. These challenges affect both analysis accuracy and scalability, and greatly hinder our capability to extract the wealth of information available in single-cell data. To detach noise from informative biological signals, we have introduced scDHA, a powerful framework for scRNA-seq data analysis. We have shown that the framework can be utilized for both upstream and downstream analyses, including de novo clustering of cells, visualizing the transcriptome landscape, classifying cells, and inferring pseudo-time. We demonstrate that scDHA outperforms state-of-the-art techniques in each research sub-field. Although we focus on single-cell as an example, scDHA is flexible enough to be adopted in a range of research areas, from cancer to obesity to aging to any other area that employs high-throughput data.</p>
    <p id="Par24">In contrast to existing autoencoders, such as scVI<sup><xref ref-type="bibr" rid="CR40">40</xref></sup> that was developed for data imputation, scDHA provides a complete analysis pipeline from feature selection (first module) to dimension reduction (second module) and downstream analyses (visualization, clustering, classification, and pseudo-time inference). The scVI package itself is not capable of clustering, visualization, classification, and pseudo-time inference. Even for the implementation of autoencoder, there are two key differences between scDHA and scVI. First, scDHA implements a hierarchical autoencoder that consists of two modules: the first autoencoder to remove noise (denoising), and the second autoencoder to compress data. The added denoising module (first module) filters out the noisy features and thus improves the quality of the data. Second, we modify the standard VAE (second module) to generate multiple realizations of the input. This step makes the VAE more robust. Indeed, our analysis results show that scDHA and its second module consistently outperform scVI when scVI is used in conjunction with downstream analysis methods implemented in scDHA and other packages (see Supplementary Section <xref rid="MOESM1" ref-type="media">6</xref> and Fig. <xref rid="MOESM1" ref-type="media">25</xref>–<xref rid="MOESM1" ref-type="media">32</xref>).</p>
    <p id="Par25">In summary, scDHA is user-friendly and is expected to be more accurate than existing autoencoders. Users can apply scDHA to perform downstream analyses without installing additional packages for the four analysis applications (clustering, visualization, classification, and pseudo-time-trajectory inference). At the same time, the hierarchical autoencoder and the modified VAE (second module of scDHA) are expected to be more efficient than other autoencoders in single-cell data analysis.</p>
  </sec>
  <sec id="Sec8">
    <title>Methods</title>
    <sec id="Sec9">
      <title>Data and pre-processing</title>
      <p id="Par26">The 34 single-cell data sets used in our data analysis are described in Table <xref rid="Tab1" ref-type="table">1</xref>. The data sets Montoro, Sanderson, Slyper, Zilionis, Karagiannis, Orozco, and Kozareva were downloaded from Broad Institute Single Cell Portal. The data sets Puram, Hrvatin, and Darrah were downloaded from Gene Expression Omnibus. Tabula Muris was downloaded from Figshare. The remaining 23 data sets were downloaded from Hemberg Group’s website (see Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref> for link to each data set). We removed samples with ambiguous labels from these data sets. Specifically, we removed cells with label “zothers” from Chen, “Unknown” from Camp (Brain), “dropped” from Wang, and “not applicable” from Segerstolpe. The only processing step we did was to perform log transformation (base 2) to rescale the data if the range of the data is larger than 100.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Description of the 34 single-cell data sets used to assess the performance of computational methods.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Data set</th><th>Tissue</th><th>Size</th><th>Class</th><th>Protocol</th><th>Accession ID</th><th>Reference</th></tr></thead><tbody><tr><td>1. Yan</td><td>Human embryo</td><td>90</td><td>6</td><td>Tang</td><td>GSE36552</td><td>Yan et al., 2013<sup><xref ref-type="bibr" rid="CR50">50</xref></sup></td></tr><tr><td>2. Goolam</td><td>Mouse embryo</td><td>124</td><td>5</td><td>Smart-Seq2</td><td>E-MTAB-3321</td><td>Goolam et al., 2016<sup><xref ref-type="bibr" rid="CR51">51</xref></sup></td></tr><tr><td>3. Deng</td><td>Mouse embryo</td><td>268</td><td>6</td><td>Smart-Seq2</td><td>GSE45719</td><td>Deng et al., 2014<sup><xref ref-type="bibr" rid="CR52">52</xref></sup></td></tr><tr><td>4. Pollen</td><td>Human tissues</td><td>301</td><td>11</td><td>SMARTer</td><td>SRP041736</td><td>Pollen et al., 2014<sup><xref ref-type="bibr" rid="CR53">53</xref></sup></td></tr><tr><td>5. Patel</td><td>Human tissues</td><td>430</td><td>5</td><td>Smart-Seq</td><td>GSE57872</td><td>Patel et al., 2014<sup><xref ref-type="bibr" rid="CR4">4</xref></sup></td></tr><tr><td>6. Wang</td><td>Human pancreas</td><td>457</td><td>7</td><td>SMARTer</td><td>GSE83139</td><td>Wang et al., 2016<sup><xref ref-type="bibr" rid="CR54">54</xref></sup></td></tr><tr><td>7. Darmanis</td><td>Human brain</td><td>466</td><td>9</td><td>SMARTer</td><td>GSE67835</td><td>Darmanis et al., 2015<sup><xref ref-type="bibr" rid="CR55">55</xref></sup></td></tr><tr><td>8. Camp (Brain)</td><td>Human brain</td><td>553</td><td>5</td><td>SMARTer</td><td>GSE75140</td><td>Camp et al., 2015<sup><xref ref-type="bibr" rid="CR56">56</xref></sup></td></tr><tr><td>9. Usoskin</td><td>Mouse brain</td><td>622</td><td>4</td><td>STRT-Seq</td><td>GSE59739</td><td>Usoskin et al., 2015<sup><xref ref-type="bibr" rid="CR57">57</xref></sup></td></tr><tr><td>10. Kolodziejczyk</td><td>Mouse embryo stem cells</td><td>704</td><td>3</td><td>SMARTer</td><td>E-MTAB-2600</td><td>Kolodziejczyk et al., 2015<sup><xref ref-type="bibr" rid="CR37">37</xref></sup></td></tr><tr><td>11. Camp (Liver)</td><td>Human liver</td><td>777</td><td>7</td><td>SMARTer</td><td>GSE81252</td><td>Camp et al., 2017<sup><xref ref-type="bibr" rid="CR58">58</xref></sup></td></tr><tr><td>12. Xin</td><td>Human pancreas</td><td>1,600</td><td>8</td><td>SMARTer</td><td>GSE81608</td><td>Xin et al., 2016<sup><xref ref-type="bibr" rid="CR59">59</xref></sup></td></tr><tr><td>13. Baron (Mouse)</td><td>Mouse pancreas</td><td>1,886</td><td>13</td><td>inDrop</td><td>GSE84133</td><td>Baron et al., 2016<sup><xref ref-type="bibr" rid="CR60">60</xref></sup></td></tr><tr><td>14. Muraro</td><td>Human pancreas</td><td>2,126</td><td>10</td><td>CEL-Seq2</td><td>GSE85241</td><td>Muraro et al., 2016<sup><xref ref-type="bibr" rid="CR61">61</xref></sup></td></tr><tr><td>15. Segerstolpe</td><td>Human pancreas</td><td>2,209</td><td>14</td><td>Smart-Seq2</td><td>E-MTAB-5061</td><td>Segerstolpe et al., 2016<sup><xref ref-type="bibr" rid="CR38">38</xref></sup></td></tr><tr><td>16. Klein</td><td>Mouse embryo stem cells</td><td>2,717</td><td>4</td><td>inDrop</td><td>GSE65525</td><td>Klein et al., 2015<sup><xref ref-type="bibr" rid="CR62">62</xref></sup></td></tr><tr><td>17. Romanov</td><td>Mouse brain</td><td>2,881</td><td>7</td><td>SMARTer</td><td>GSE74672</td><td>Romanov et al., 2017<sup><xref ref-type="bibr" rid="CR63">63</xref></sup></td></tr><tr><td>18. Zeisel</td><td>Mouse brain</td><td>3,005</td><td>9</td><td>STRT-Seq</td><td>GSE60361</td><td>Zeisel et al., 2015<sup><xref ref-type="bibr" rid="CR3">3</xref></sup></td></tr><tr><td>19. Lake</td><td>Human brain</td><td>3,042</td><td>16</td><td>Fluidigm C1</td><td>phs000833.v3.p1</td><td>Lake et al., 2016<sup><xref ref-type="bibr" rid="CR64">64</xref></sup></td></tr><tr><td>20. Puram</td><td>Human tissues</td><td>5,902</td><td>10</td><td>Smart-Seq2</td><td>GSE103322</td><td>Puram et al., 2017<sup><xref ref-type="bibr" rid="CR65">65</xref></sup></td></tr><tr><td>21. Montoro</td><td>Human pancreas</td><td>7,193</td><td>7</td><td>Smart-Seq2</td><td>GSE103354</td><td>Montoro et al., 2018<sup><xref ref-type="bibr" rid="CR66">66</xref></sup></td></tr><tr><td>22. Baron (Human)</td><td>Human pancreas</td><td>8,569</td><td>14</td><td>inDrop</td><td>GSE84133</td><td>Baron et al., 2016<sup><xref ref-type="bibr" rid="CR60">60</xref></sup></td></tr><tr><td>23. Chen</td><td>Mouse brain</td><td>12,089</td><td>46</td><td>Drop-seq</td><td>GSE87544</td><td>Chen et al., 2017<sup><xref ref-type="bibr" rid="CR67">67</xref></sup></td></tr><tr><td>24. Sanderson</td><td>Mouse tissues</td><td>12,648</td><td>11</td><td>10X Genomics</td><td>SCP916</td><td>Sanderson et al., 2020<sup><xref ref-type="bibr" rid="CR68">68</xref></sup></td></tr><tr><td>25. Slyper</td><td>Human blood</td><td>13,316</td><td>8</td><td>10X Genomics</td><td>SCP345</td><td/></tr><tr><td>26. Campbell</td><td>Mouse brain</td><td>21,086</td><td>21</td><td>Drop-seq</td><td>GSE93374</td><td>Campbell et al., 2017<sup><xref ref-type="bibr" rid="CR69">69</xref></sup></td></tr><tr><td>27. Zilionis</td><td>Human lung</td><td>34,558</td><td>9</td><td>inDrop</td><td>GSE127465</td><td>Zilionis et al., 2019<sup><xref ref-type="bibr" rid="CR70">70</xref></sup></td></tr><tr><td>28. Macosko</td><td>Mouse retina</td><td>44,808</td><td>12</td><td>Drop-seq</td><td>GSE63473</td><td>Macosko et al., 2015<sup><xref ref-type="bibr" rid="CR71">71</xref></sup></td></tr><tr><td>29. Hrvatin</td><td>Mouse visual cortex</td><td>48,266</td><td>8</td><td>inDrop</td><td>GSE102827</td><td>Hrvatin et al., 2018<sup><xref ref-type="bibr" rid="CR72">72</xref></sup></td></tr><tr><td>30. Tabula Muris</td><td>Mouse tissues</td><td>54,439</td><td>40</td><td>10X Genomics</td><td>GSE109774</td><td>Schaum et al., 2018<sup><xref ref-type="bibr" rid="CR73">73</xref></sup></td></tr><tr><td>31. Karagiannis</td><td>Human blood</td><td>72,914</td><td>12</td><td>10X Genomics</td><td>GSE128879</td><td>Karagiannis et al., 2020<sup><xref ref-type="bibr" rid="CR74">74</xref></sup></td></tr><tr><td>32. Orozco</td><td>Human eye</td><td>100,055</td><td>11</td><td>10X Genomics</td><td>GSE135133</td><td>Orozco et al., 2020<sup><xref ref-type="bibr" rid="CR75">75</xref></sup></td></tr><tr><td>33. Darrah</td><td>Human blood</td><td>162,490</td><td>14</td><td>Drop-seq</td><td>GSE139598</td><td>Darrah et al., 2020<sup><xref ref-type="bibr" rid="CR76">76</xref></sup></td></tr><tr><td>34. Kozareva</td><td>Mouse cerebellum</td><td>611,034</td><td>18</td><td>10X Genomics</td><td>SCP795</td><td>Kozareva et al., 2020<sup><xref ref-type="bibr" rid="CR77">77</xref></sup></td></tr></tbody></table><table-wrap-foot><p>The first two columns describe the name and tissue while the next five columns show the number of cells, number of cell types, protocol, accession ID, and reference.</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec10">
      <title>Software package and setting</title>
      <p id="Par27">In our analysis, we followed the instruction and tutorials provided by the authors of each software package. We used the default parameters of each tool to perform the analysis. The memory limit for all analysis methods is set to 200GB of RAM.</p>
      <p id="Par28">For clustering, we compared scDHA with SC3, SEURAT, SINCERA, CIDR, SCANPY and k-means. We used the following packages: (i) SC3 version 1.10.1 from Bioconductor, (ii) SEURAT version 2.3.4 from CRAN, (iii) CIDR version 0.1.5 from GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/VCCRI/CIDR">github.com/VCCRI/CIDR</ext-link>), (iv) scanpy version 1.4.4 from Anaconda, (v) SINCERA script provided by Hemberg group (<ext-link ext-link-type="uri" xlink:href="https://scrnaseq-course.cog.sanger.ac.uk/website/biological-analysis.html">scrnaseq-course.cog.sanger.ac.uk/website/biological-analysis.html</ext-link>), and (vi) stats for k-means in conjunction with PCA implementation available in the package irlba version 2.3.3 from CRAN. For k-means, we used the first 100 principal components for clustering purpose. In contrast to the other five methods, k-means cannot determine the number of clusters. Therefore, we also provided the true number of cell types for k-means. In addition, since k-means often converges to local optima, we ran k-means using 1000 different sets of starting points and then chose the partitioning with the smallest squared error.</p>
      <p id="Par29">For dimension reduction and visualization, we used the following packages: (i) irlba version 2.3.3 from CRAN for PCA, (ii) Rtsne version 0.15 from CRAN for t-SNE, (iii) scanpy version 1.4.4, and (iv) python package umap-learn version 0.3.9 from Anaconda python distribution for UMAP. This python package is run through a wrapper in R package umap version 0.2.2.</p>
      <p id="Par30">For classification, we compared scDHA with XGBoost, RF, DL, and GBM. We used the R package H2O version 3.24.0.5 from CRAN. This package provides the implementation of XGBoost, RF, DL, and GBM. All models were run with fivefold cross-validation for better accuracy.</p>
      <p id="Par31">For time-trajectory inference, we compared scDHA with Monocle, TSCAN, Slingshot, and SCANPY. We used the following packages: (i) R package Monocle3 version 0.1.1 from GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/cole-trapnell-lab/monocle3">github.com/cole-trapnell-lab/monocle3</ext-link>), (ii) TSCAN version 1.20.0 from Bioconductor, (iii) Slingshot version 1.3.1 from Bioconductor, and (iv) scanpy version 1.4.4.</p>
    </sec>
    <sec id="Sec11">
      <title>scDHA pipeline</title>
      <p id="Par32">scDHA requires an expression matrix <italic>M</italic> as input, in which rows represent cells and columns represent genes or transcripts. Given the input <italic>M</italic>, scDHA automatically performs a log transformation (base 2) to rescale the data if the range of <italic>M</italic> is higher than 100. The goal is to prevent the domination of genes or features with high expression.</p>
      <p id="Par33">scDHA pipeline for scRNA sequencing data analysis consists of two core modules (Figure <xref rid="Fig1" ref-type="fig">1</xref>a). The first module is a non-negative kernel autoencoder that provides a non-negative, part-based representation of the data. Based on the weight distribution of the encoder, scDHA removes genes or components that have insignificant contributions to the part-based representation. The second module is a Stacked Bayesian Self-learning Network that is built upon the VAE<sup><xref ref-type="bibr" rid="CR34">34</xref></sup> to project the data onto a low-dimensional space. For example, for clustering application, the first module automatically rescales the data and removes genes with insignificant contribution to the part-based representation. The second module then projects the clean data to a low-dimensional latent space using VAE before separating the cells using k-nearest neighbor spectral clustering. The details of each step are described below.</p>
    </sec>
    <sec id="Sec12">
      <title>Non-negative kernel autoencoder</title>
      <p id="Par34">To reduce the technical variability and heterogeneous calibration from sequencing technologies, the expression data are rescaled to a range of 0 to 1 for each cell as follow:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{ij}=\frac{{M}_{ij}-min({M}_{i.})}{max({M}_{i.})-min({M}_{i.})}$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2021_21312_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <italic>M</italic> is the input matrix and <italic>X</italic> is the normalized matrix. This min-max scaling step is to reduce standard deviation and to suppress the effect of outliers, which is frequently used in DL models<sup><xref ref-type="bibr" rid="CR41">41</xref>,<xref ref-type="bibr" rid="CR42">42</xref></sup> (see Supplementary Section <xref rid="MOESM1" ref-type="media">1.6</xref> and Fig. <xref rid="MOESM1" ref-type="media">3</xref> for more details).</p>
      <p id="Par35">After normalization, the data are then passed through a one-layer autoencoder to filter out insignificant genes/features. In short, autoencoder consists of two components: encoder and decoder. The formulation of autoencoder can be written as follows:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e	={f}_{E}(x)\\ \bar{x}	={f}_{D}(e)$$\end{document}</tex-math><mml:math id="M4"><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2021_21312_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq1"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x\in {R}_{+}^{n}$$\end{document}</tex-math><mml:math id="M6"><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2021_21312_Article_IEq1.gif"/></alternatives></inline-formula> is the input of the model (x is simply a row/sample, i.e., <italic>x</italic> = <italic>X</italic><sub><italic>i</italic>.</sub>), <italic>f</italic><sub><italic>E</italic></sub> and <italic>f</italic><sub><italic>D</italic></sub> represent the transformation by encoder and decoder layers, <inline-formula id="IEq2"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{x}$$\end{document}</tex-math><mml:math id="M8"><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2021_21312_Article_IEq2.gif"/></alternatives></inline-formula> is the reconstruction of <italic>x</italic>. The encoder and decoder transformations can be represented as <italic>f</italic><sub><italic>E</italic></sub>(<italic>x</italic>) = <italic>x</italic><italic>W</italic><sub><italic>E</italic></sub> + <italic>b</italic><sub><italic>E</italic></sub> and <italic>f</italic><sub><italic>D</italic></sub>(<italic>e</italic>) = <italic>e</italic><italic>W</italic><sub><italic>D</italic></sub> + <italic>b</italic><sub><italic>D</italic></sub>, where <italic>W</italic>-s are the weight matrices and <italic>b</italic>-s are the bias vectors. Encoder aims at representing the data in a much lower dimensional space (compression) whereas decoder tries to reconstruct the original input from the compressed data. Optimizing this process can theoretically result in a compact representation of the original, high-dimensional data. The size of the bottleneck layer is set to 50 nodes (not user-provided parameter). Changing this number of nodes has no significant impact on the results of scDHA (see Supplementary Fig. <xref rid="MOESM1" ref-type="media">5</xref>).</p>
      <p id="Par36">In our model, the weights of the encoder (<italic>W</italic><sub><italic>E</italic></sub> in <italic>f</italic><sub><italic>E</italic></sub>(⋅)) are forced to be non-negative so that each latent variable is an additive combination of the original features. By doing so, the non-negative coefficients of the less important features will be shrunk toward zero (see Supplementary Section <xref rid="MOESM1" ref-type="media">1.7</xref> and Fig. <xref rid="MOESM1" ref-type="media">4</xref> for more discussion). Based on the computed weights, the method only keeps genes or components with high weight variances. In principle, the set of these genes can be considered a “sufficient and necessary” set to represent the original data. These genes are necessary because removing them would greatly damage the reversibility of the decoder, i.e., decoder cannot accurately reconstruct the original data. At the same time, they are sufficient because the encoder automatically shrinks the weights of genes or gene groups that have similar but lesser impacts in the compression procedure. By default, scDHA selects 5000 genes but users can choose a different number based on the weight distribution (see Supplementary Section 1.8 and Fig. <xref rid="MOESM1" ref-type="media">6</xref>)</p>
    </sec>
    <sec id="Sec13">
      <title>Stacked Bayesian autoencoder</title>
      <p id="Par37">After the gene filtering step using non-negative kernel autoencoder, we obtain a data matrix in which each gene is considered critical to preserve cell heterogeneity. However, although the step has greatly reduced the number of features, the number of genes is still in the scale of hundreds or thousands. Therefore, it is necessary to perform dimension reduction before conducting any analysis or visualization. For this purpose, we developed a modified version of VAE (theorized by Kingma et al.<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>). We name it stacked Bayesian autoencoder (Figure <xref rid="Fig4" ref-type="fig">4</xref>) since the model is designed with multiple latent spaces, instead of only one latent space used in the original VAE or any other autoencoder model.<fig id="Fig4"><label>Fig. 4</label><caption><title>High-level representation of stacked Bayesian autoencoder.</title><p>The encoder projects input data to multiple low-dimensional latent spaces (outputs of <italic>z</italic><sub>1</sub> to <italic>z</italic><sub><italic>n</italic></sub> layers). The decoders infer original data from these latent data. Minimizing the difference between inferred data and original one leads to a high quality representation of the original data at bottleneck layer (outputs of <italic>μ</italic> layer).</p></caption><graphic xlink:href="41467_2021_21312_Fig4_HTML" id="d32e2157"/></fig></p>
      <p id="Par38">VAE has the same basic structure as a standard autoencoder, which is a self-learning model consisting of two components: encoder and decoder. Given the input matrix (the filtered matrix obtained from Non-negative kernel autoencoder), VAE’s encoder constructs a low-dimensional representation of the input matrix while the decoder aims at inferring the original data. By minimizing the difference between the inferred and the input data, the middle bottleneck layer is considered as the “near lossless” projection of the input onto a latent space with a low number of dimensions (<italic>m</italic> = 15 by default). We keep the model size small to avoid overfitting and force the neuron network to be as compressed as possible. Also, restricting the size of the latent layer will converge cells from the same group into similar latent space manifold. At the same time, the size of the latent layer needs to be sufficient (15 dimensions) to keep the latent variables disentangled. Per our experience, varying <italic>m</italic> between 10 and 20 does not alter the analysis results.</p>
      <p id="Par39">Given an expression profile of a cell <italic>x</italic>, the formulation of this architecture can be formulated as follows:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e	={f}_{E}(x)\\ \mu 	={f}_{\mu }(e)\\ \sigma 	={f}_{\sigma }(e)\\ z 	\sim N(\mu ,{\sigma }^{2})\\ \bar{x}	={f}_{D}(z)$$\end{document}</tex-math><mml:math id="M10"><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>z</mml:mi><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2021_21312_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq3"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x\in {R}_{+}^{n}$$\end{document}</tex-math><mml:math id="M12"><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2021_21312_Article_IEq3.gif"/></alternatives></inline-formula> is the input of the network, <italic>f</italic><sub><italic>E</italic></sub> and <italic>f</italic><sub><italic>D</italic></sub> represent the transformation by encoder and decoder layers. In addition to the standard autoencoder, two transformations <italic>f</italic><sub><italic>μ</italic></sub> and <italic>f</italic><sub><italic>σ</italic></sub> are added on the output <italic>e</italic> of encoder to generate the parameters <italic>μ</italic> and <italic>σ</italic> (<italic>μ</italic>, <italic>σ</italic> ∈ <italic>R</italic><sup><italic>m</italic></sup>). The compressed data <italic>z</italic> is now sampled from the distribution <italic>N</italic>(<italic>μ</italic>, <italic>σ</italic><sup>2</sup>). In contrast to the standard autoencoder, VAE uses <italic>z</italic> as the input of the decoder instead of <italic>e</italic>. By adding randomness in generating <italic>z</italic>, VAE prevents overfitting by avoiding mapping the original data to the compressed space without learning a generalized representation of data. The perturbation process was shown to be an effective method to increase data stability<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>.</p>
      <p id="Par40">In our stacked model, to further diminish overfitting and increase the robustness, we generate multiple compressed spaces with multiple realizations of <italic>z</italic>. For that purpose, we use a re-parameterization trick to generate multiple realizations of <italic>z</italic> as follows: <italic>z</italic> = <italic>μ</italic> + σ∗<italic>N</italic>(0, 1). This re-parameterization trick is introduced to ensure that the model can backpropagate<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>.</p>
      <p id="Par41">To train our model, we use AdamW<sup><xref ref-type="bibr" rid="CR44">44</xref></sup> as optimizer while adopting a two-stage training scheme<sup><xref ref-type="bibr" rid="CR45">45</xref></sup>: (i) a warm-up process, which uses only reconstruction loss, and (ii) the VAE stage, in which the Kullback–Leibler loss is also considered to ensure the normal distribution of latent variables <italic>z</italic>. The warm-up process prevents the model from ignoring reconstruction loss and only focuses on Kullback–Leibler loss. By doing this, we avoid the pitfall of making the model fail to learn generalized representations of the data. This process also makes the model less sensitive to the weight initialization. For faster convergence and better accuracy, scaled exponential linear unit<sup><xref ref-type="bibr" rid="CR46">46</xref></sup> is used as the activation function.</p>
      <p id="Par42">After finishing the training stage, the input data are processed through the encoder to generate representative latent variables of original data. This compressed representation of the data will be used for single-cell applications: (1) cell segregation through unsupervised learning, (2) transcriptome landscape visualization, (3) pseudo-time-trajectory inference, and (4) cell classification.</p>
    </sec>
    <sec id="Sec14">
      <title>Cell segregation via clustering</title>
      <sec id="Sec15">
        <title>Predicting the number of cell types</title>
        <p id="Par43">The number of cell types is determined using two indices: (i) the ratio of between sum of squares over the total sum of squares, and (ii) the increase of the within sum of squares when the number of clusters increases. The indices are formulated as follows:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Index\,1=\frac{S{S}_{between,j}}{S{S}_{total,j}}$$\end{document}</tex-math><mml:math id="M14"><mml:mi>I</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mspace width="0.25em"/><mml:mn>1</mml:mn><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>w</mml:mi><mml:mi>e</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2021_21312_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Index\,2=\frac{S{S}_{within,j+1}-S{S}_{within,j}}{S{S}_{within,j}}$$\end{document}</tex-math><mml:math id="M16"><mml:mi>I</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mspace width="0.25em"/><mml:mn>2</mml:mn><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2021_21312_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where <italic>j</italic> is the number of clusters.</p>
        <p id="Par44">Larger <italic>Index 1</italic> means that members of one group are far from other groups, i.e., the clusters are well separated. <italic>Index 2</italic> is affected by the number of eigenvectors generated by spectral decomposition, which is also the number of clusters. We assume that the addition of an eigenvector that leads to the highest spike in the within sum of squares (which is undesirable) would be the correct number of clusters. These indices are calculated by performing k-nearest neighbor spectral clustering on a subset of samples over a range of cluster numbers. Mean of the predictions from these two indices is set to be the final number of clusters (see Supplementary Fig.</p>
      </sec>
      <sec id="Sec16">
        <title>Basic clustering algorithm</title>
        <p id="Par45">In order to improve the accuracy when clustering non-spherical data while ensuring the fast running time, we apply a k-nearest neighbor adaption of spectral clustering (k-nn SC) as the clustering method embedded in our package. Instead of using Euclidean distance to determine the similarity between two samples, Pearson correlation is used to improve the stability of cluster assignment. The difference between k-nn SC and normal SC is that the constructed affinity matrix of data points is sparse. For each data point, the distance is calculated for only its k-nearest neighbors while the distance to the rest is left at zero. The clustering process of k-nn SC consists of four steps: (i) constructing affinity matrix <italic>A</italic> for all data points to use as input graph, (ii) generating a symmetric and normalized Laplacian matrix <inline-formula id="IEq4"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}^{\text{sym}}=I-{D}^{-\frac{1}{2}}A{D}^{-\frac{1}{2}}$$\end{document}</tex-math><mml:math id="M18"><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">sym</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mi>A</mml:mi><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_21312_Article_IEq4.gif"/></alternatives></inline-formula> where <italic>D</italic> is the degree matrix of the graph, <italic>A</italic> is the constructed affinity matrix and <italic>I</italic> is the identity matrix, (iii) calculating eigenvalues for Laplacian matrix and select those with smallest values, generating eigenvectors corresponding to selected eigenvalues, (iv) performing final clustering using k-means on the obtained eigenvectors.</p>
      </sec>
      <sec id="Sec17">
        <title>Consensus clustering</title>
        <p id="Par46">We use the basic clustering algorithm described above to cluster the compressed data. To achieve higher accuracy and to avoid local minima, an ensemble of data projection models is used. We first repeat the data projection and clustering process multiple times. We then combine the clustering results using the Weighted-based meta-clustering (wMetaC) implemented in SHARP<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>. wMetaC is conducted through five steps: (i) calculating cell–cell weighted similarity matrix <italic>W</italic>, <italic>w</italic><sub><italic>i</italic>,<italic>j</italic></sub> = <italic>s</italic><sub><italic>i</italic>,<italic>j</italic></sub>(1 − <italic>s</italic><sub><italic>i</italic>,<italic>j</italic></sub>) where <italic>s</italic><sub><italic>i</italic>,<italic>j</italic></sub> is the chance that cell <italic>i</italic> and <italic>j</italic> are in the same cluster, (ii) calculating cell weight, which is the sum of all cell–cell weights related to this cell, (iii) generating cluster-cluster similarity matrix ∣<italic>C</italic>∣<italic>x</italic>∣<italic>C</italic>∣, where C is the union of all the clusters obtained in each replicate, (iv) performing hierarchical clustering on cluster-cluster similarity matrix, and (v) determining final results by a voting scheme.</p>
      </sec>
      <sec id="Sec18">
        <title>Voting procedure</title>
        <p id="Par47">For large data sets, we also provide an additional option in our package to reduce the time complexity without compromising the performance. Instead of clustering the whole data set, which requires a large amount of memory and heavy computation, we can perform the clustering on a subset of the data points and then apply a vote-counting procedure to assign the rest of the data to each cluster. The voting process is based on the k-nearest neighbor classification. This approach still ensures the high clustering quality without compromising the speed of the method, as shown in Figure <xref rid="Fig5" ref-type="fig">5</xref>.<fig id="Fig5"><label>Fig. 5</label><caption><title>Accuracy and running time of scDHA on large data sets with and without using the voting procedure.</title><p>The voting procedure significantly reduces the running time without compromising the accuracy. Each point represents the result of a single run, while the bar shows the average of 10 runs.</p></caption><graphic xlink:href="41467_2021_21312_Fig5_HTML" id="d32e2770"/></fig></p>
      </sec>
      <sec id="Sec19">
        <title>Dimension reduction and visualization</title>
        <p id="Par48">Given the compressed data (10–15 dimensions), we compute the distance matrix for the cells and then perform log and <italic>z</italic> transformations as follows:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${D}_{ij}=\frac{\mathrm{log}\,({D}_{ij})-{\mu }_{\mathrm{log}\,({D}_{i.})}}{{\sigma }_{\mathrm{log}\,({D}_{i.})}}$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">log</mml:mi><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2021_21312_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>where <italic>D</italic> is a distance matrix. The rationale of this transformation is to make the distribution of distances from one point to its neighbors more uniform. Next, we calculate the probabilities <italic>p</italic><sub><italic>i</italic><italic>j</italic></sub> that are proportional to the similarity between sample <italic>i</italic> and <italic>j</italic> as follows:<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{j| i}=\frac{\exp ({D}_{ij})}{{\sum }_{k\ne i}\exp ({D}_{ik})}$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∣</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2021_21312_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par49">At the same time, using the compressed data, we build a neural network to project the data to two-dimensional space. Using two formulas described above, we re-calculate the probabilities <italic>q</italic><sub><italic>i</italic><italic>j</italic></sub> that are proportional to the similarity between sample <italic>i</italic> and <italic>j</italic> in the two-dimensional space. Our goal is to learn a two-dimensional projection of the data that retains the probabilities <italic>p</italic> as well as possible. We achieve this by minimizing the distance between <italic>Q</italic> and <italic>P</italic>. Here, we use the Kullback–Leibler divergence to represent the distance between the two probability distributions, which can be formulated as:<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$KL(P| | Q)={\sum }_{i\ne j}{p}_{ij}\mathrm{log}\,\frac{{p}_{ij}}{{q}_{ij}}$$\end{document}</tex-math><mml:math id="M24"><mml:mi>K</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>∣</mml:mo><mml:mo>∣</mml:mo><mml:mi>Q</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">log</mml:mi><mml:mspace width="0.25em"/><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2021_21312_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par50">By minimizing Kullback–Leibler divergence, we obtain the optimal representation of the data in the two-dimensional space. The algorithm can be generalized to three or higher number of dimensions.</p>
      </sec>
    </sec>
    <sec id="Sec20">
      <title>Classification</title>
      <p id="Par51">The problem can be described as follows. We are given two data sets of the same tissue: the training data set and the testing data set. For the training data set, we have the cell labels. The goal is to determine the cell labels of the testing data set.</p>
      <p id="Par52">Our classification procedure consists of the following steps: (i) concatenate the two matrices into a single matrix, in which the rows consist of all cells from the two data sets and columns are the common genes; (ii) normalize and compress the merged data using the hierarchical autoencoder described above; (iii) compute the similarity matrix for the cells using Pearson correlation; and finally (iv) determine the label of cells from testing data using k-nearest neighbor algorithm (k-nn).</p>
      <p id="Par53">The rationale for concatenating the two data sets is to exploit the robust denoising and dimension reduction procedure offered by the hierarchical autoencoder. Since we normalize the data per each cell, different scaling of the two data sets (training or testing) would not pose as a problem. At the same time, the hierarchical autoencoder efficiently diminishes batch effect and noise, moving cells of the same type closer to one another. We demonstrated that even with an unsophisticated classification technique as k-nn, scDHA is proven to be better than current state-of-the-art methods, including XGBoost, RF, DL, and GBM.</p>
    </sec>
    <sec id="Sec21">
      <title>Time-trajectory inference</title>
      <p id="Par54">We implement a pseudo-time inference method that allows users to infer non-branching trajectory that is correlated with the developmental stages of cells. This method requires a starting point as part of the input. We note that users can easily apply any other methods on the compressed data provided by scDHA (see Saelens et al.<sup><xref ref-type="bibr" rid="CR48">48</xref></sup> for a comprehensive list of pseudo-time inference methods). Given the compressed data, our method computes the similarity distance for the cells using Pearson correlation. Using this similarity matrix as the affinity matrix, we construct a graph in which nodes represent cells and edges represent the distance between the cells. In order to construct the pseudo-time trajectory, we apply the minimum spanning tree (MST) algorithm on the graph to find the shortest path that goes through all cells. From the MST, pseudo-time is determined by distance from one point to the designated starting point.</p>
    </sec>
    <sec id="Sec22">
      <title>Statistics and reproducibility</title>
      <p id="Par55">The scDHA package is installed in the docker image that is available at <ext-link ext-link-type="uri" xlink:href="http://scdha.tinnguyen-lab.com/">http://scdha.tinnguyen-lab.com/</ext-link>, which has all tools, dependencies, and scripts so that readers can reproduce all results. All analyses are performed with fixed random seed to ensure reproducibility.</p>
    </sec>
    <sec id="Sec23">
      <title>Reporting summary</title>
      <p id="Par56">Further information on research design is available in the <xref rid="MOESM2" ref-type="media">Nature Research Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec24">
      <supplementary-material content-type="local-data" id="MOESM1">
        <media xlink:href="41467_2021_21312_MOESM1_ESM.pdf">
          <caption>
            <p>Supplementary Information</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM2">
        <media xlink:href="41467_2021_21312_MOESM2_ESM.pdf">
          <caption>
            <p>Reporting Summary</p>
          </caption>
        </media>
      </supplementary-material>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Peer review information</bold><italic>Nature Communications</italic> thanks Etienne Becht, Joshua Ho and the other, anonymous, reviewer for their contribution to the peer review of this work.</p>
    </fn>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41467-021-21312-2.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work was partially supported by NASA under grant numbers 80NSSC19M0170 and NNX15AI02H (subaward no. 21-02), by NIH NIGMS under grant number GM103440, and by NSF under grant numbers 2001385 and 2019609. Any opinions, findings, and conclusions, or recommendations expressed in this material are those of the authors and do not necessarily reflect the views of any of the funding agencies.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>D.T. and T.N. conceived of and designed the approach. D.T. implemented the method in R, performed the data analysis and all computational experiments. B.T. and H.N. helped with data preparation and some data analysis. H.L. and C.L.V. provided advice in method development. D.T. and T.N. wrote the manuscript. All authors reviewed the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The details of 34 single-cell data sets analyzed in the article can be found in Table <xref rid="Tab1" ref-type="table">1</xref>. The links to publicly available sources are reported in Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>. The processed data can also be found at <ext-link ext-link-type="uri" xlink:href="http://scdha.tinnguyen-lab.com/">http://scdha.tinnguyen-lab.com/</ext-link>.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>The scDHA package<sup><xref ref-type="bibr" rid="CR49">49</xref></sup> is available as an independent software at <ext-link ext-link-type="uri" xlink:href="https://github.com/duct317/scDHA">https://github.com/duct317/scDHA</ext-link>.</p>
  </notes>
  <notes id="FPar1" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par57">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saliba</surname>
            <given-names>A-E</given-names>
          </name>
          <name>
            <surname>Westermann</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Gorski</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Vogel</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA-seq: advances and future challenges</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2014</year>
        <volume>42</volume>
        <fpage>8845</fpage>
        <lpage>8860</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku555</pub-id>
        <?supplied-pmid 25053837?>
        <pub-id pub-id-type="pmid">25053837</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shields IV</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Reyes</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>López</surname>
            <given-names>GP</given-names>
          </name>
        </person-group>
        <article-title>Microfluidic cell sorting: a review of the advances in the separation of cells from debulking to rare cell isolation</article-title>
        <source>Lab Chip</source>
        <year>2015</year>
        <volume>15</volume>
        <fpage>1230</fpage>
        <lpage>1249</lpage>
        <pub-id pub-id-type="doi">10.1039/C4LC01246A</pub-id>
        <pub-id pub-id-type="pmid">25598308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeisel</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>347</volume>
        <fpage>1138</fpage>
        <lpage>1142</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaa1934</pub-id>
        <?supplied-pmid 25700174?>
        <pub-id pub-id-type="pmid">25700174</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patel</surname>
            <given-names>AP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq highlights intratumoral heterogeneity in primary glioblastoma</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>344</volume>
        <fpage>1396</fpage>
        <lpage>1401</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1254257</pub-id>
        <?supplied-pmid 24925914?>
        <pub-id pub-id-type="pmid">24925914</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Nguyen, H., Tran, D., Tran, B., Pehlivan, B. &amp; Nguyen, T. A comprehensive survey of regulatory network inference methods using single cell RNA sequencing data. <italic>Brief. Bioinform.</italic> bbaa190 (2020).</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>VY</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Challenges in unsupervised clustering of single-cell RNA-seq data</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>273</fpage>
        <lpage>282</lpage>
        <pub-id pub-id-type="doi">10.1038/s41576-018-0088-9</pub-id>
        <?supplied-pmid 30617341?>
        <pub-id pub-id-type="pmid">30617341</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davie</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell transcriptome Atlas of the aging Drosophila brain</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>174</volume>
        <fpage>982</fpage>
        <lpage>998</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.05.057</pub-id>
        <?supplied-pmid 29909982?>
        <pub-id pub-id-type="pmid">29909982</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rozenblatt-Rosen</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Stubbington</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>The Human Cell Atlas: From vision to reality</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>550</volume>
        <fpage>451</fpage>
        <lpage>453</lpage>
        <pub-id pub-id-type="doi">10.1038/550451a</pub-id>
        <?supplied-pmid 29072289?>
        <pub-id pub-id-type="pmid">29072289</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>VY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SC3: consensus clustering of single-cell RNA-seq data</article-title>
        <source>Nat. Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>483</fpage>
        <lpage>486</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4236</pub-id>
        <?supplied-pmid 28346451?>
        <pub-id pub-id-type="pmid">28346451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Farrell</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Gennert</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schier</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Spatial reconstruction of single-cell gene expression data</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2015</year>
        <volume>33</volume>
        <fpage>495</fpage>
        <lpage>502</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3192</pub-id>
        <?supplied-pmid 25867923?>
        <pub-id pub-id-type="pmid">25867923</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Potter</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Whitsett</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>SINCERA: a pipeline for single-cell RNA-seq profiling analysis</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2015</year>
        <volume>11</volume>
        <fpage>e1004575</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004575</pub-id>
        <?supplied-pmid 26600239?>
        <pub-id pub-id-type="pmid">26600239</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Troup</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>JWK</given-names>
          </name>
        </person-group>
        <article-title>CIDR: Ultrafast and accurate clustering through imputation for single-cell RNA-seq data</article-title>
        <source>Genome Biol.</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>59</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1188-0</pub-id>
        <?supplied-pmid 28351406?>
        <pub-id pub-id-type="pmid">28351406</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wolf</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Angerer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>
        <source>Genome Biol.</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>15</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1382-0</pub-id>
        <?supplied-pmid 29409532?>
        <pub-id pub-id-type="pmid">29409532</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saeys</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Van Gassen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lambrecht</surname>
            <given-names>BN</given-names>
          </name>
        </person-group>
        <article-title>Computational flow cytometry: helping to make sense of high-dimensional immunology data</article-title>
        <source>Nat. Rev. Immunol.</source>
        <year>2016</year>
        <volume>16</volume>
        <fpage>449</fpage>
        <lpage>462</lpage>
        <pub-id pub-id-type="doi">10.1038/nri.2016.56</pub-id>
        <?supplied-pmid 27320317?>
        <pub-id pub-id-type="pmid">27320317</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tenenbaum</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>De Silva</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Langford</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>A global geometric framework for nonlinear dimensionality reduction</article-title>
        <source>Science</source>
        <year>2000</year>
        <volume>290</volume>
        <fpage>2319</fpage>
        <lpage>2323</lpage>
        <pub-id pub-id-type="doi">10.1126/science.290.5500.2319</pub-id>
        <?supplied-pmid 11125149?>
        <pub-id pub-id-type="pmid">11125149</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coifman</surname>
            <given-names>RR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Geometric diffusions as a tool for harmonic analysis and structure definition of data: Diffusion maps</article-title>
        <source>Proc. Natl. Acad. Sci.</source>
        <year>2005</year>
        <volume>102</volume>
        <fpage>7426</fpage>
        <lpage>7431</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0500334102</pub-id>
        <?supplied-pmid 15899970?>
        <pub-id pub-id-type="pmid">15899970</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Amir</surname>
            <given-names>E-aD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>viSNE enables visualization of high dimensional single-cell data and reveals phenotypic heterogeneity of leukemia</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2013</year>
        <volume>31</volume>
        <fpage>545</fpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2594</pub-id>
        <pub-id pub-id-type="pmid">23685480</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Becht</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dimensionality reduction for visualizing single-cell data using UMAP</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>38</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4314</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Chen, T. &amp; Guestrin, C. XGBoost: A scalable tree boosting system. In <italic>Proceedings of the 22Nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</italic>, KDD ’16, 785-794 (ACM, New York, NY, USA, 2016).</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Breiman</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Random forests</article-title>
        <source>Mach. Learn.</source>
        <year>2001</year>
        <volume>45</volume>
        <fpage>5</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1023/A:1010933404324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>LeCun</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Bengio</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hinton</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Deep learning</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>521</volume>
        <fpage>436</fpage>
        <lpage>444</lpage>
        <pub-id pub-id-type="doi">10.1038/nature14539</pub-id>
        <?supplied-pmid 26017442?>
        <pub-id pub-id-type="pmid">26017442</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Friedman</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>Greedy function approximation: a gradient boosting machine</article-title>
        <source>Ann. Stat.</source>
        <year>2001</year>
        <volume>29</volume>
        <fpage>1189</fpage>
        <lpage>1232</lpage>
        <pub-id pub-id-type="doi">10.1214/aos/1013203451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tanay</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Scaling single-cell genomics from phenomenology to mechanism</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>541</volume>
        <fpage>331</fpage>
        <lpage>338</lpage>
        <pub-id pub-id-type="doi">10.1038/nature21350</pub-id>
        <?supplied-pmid 28102262?>
        <pub-id pub-id-type="pmid">28102262</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Etzrodt</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Endele</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schroeder</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Quantitative single-cell approaches to stem cell research</article-title>
        <source>Cell Stem Cell</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>546</fpage>
        <lpage>558</lpage>
        <pub-id pub-id-type="doi">10.1016/j.stem.2014.10.015</pub-id>
        <?supplied-pmid 25517464?>
        <pub-id pub-id-type="pmid">25517464</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>
        <source>Nature Biotechnol.</source>
        <year>2014</year>
        <volume>32</volume>
        <fpage>381</fpage>
        <lpage>386</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2859</pub-id>
        <pub-id pub-id-type="pmid">24658644</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ji</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>TSCAN: Pseudo-time reconstruction and evaluation in single-cell RNA-seq analysis</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>e117</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw430</pub-id>
        <?supplied-pmid 27179027?>
        <pub-id pub-id-type="pmid">27179027</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Street</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Slingshot: cell lineage and pseudotime inference for single-cell transcriptomics</article-title>
        <source>BMC Genomics</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>477</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-018-4772-0</pub-id>
        <?supplied-pmid 29914354?>
        <pub-id pub-id-type="pmid">29914354</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Svensson</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Vento-Tormo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>Exponential scaling of single-cell RNA-seq in the past decade</article-title>
        <source>Nat. Protoc.</source>
        <year>2018</year>
        <volume>13</volume>
        <fpage>599</fpage>
        <lpage>604</lpage>
        <pub-id pub-id-type="doi">10.1038/nprot.2017.149</pub-id>
        <?supplied-pmid 29494575?>
        <pub-id pub-id-type="pmid">29494575</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lawson</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Kessenbrock</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>RT</given-names>
          </name>
          <name>
            <surname>Pervolarakis</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Werb</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Tumour heterogeneity and metastasis at single-cell resolution</article-title>
        <source>Nat. Cell Biol.</source>
        <year>2018</year>
        <volume>20</volume>
        <fpage>1349</fpage>
        <lpage>1360</lpage>
        <pub-id pub-id-type="doi">10.1038/s41556-018-0236-7</pub-id>
        <?supplied-pmid 30482943?>
        <pub-id pub-id-type="pmid">30482943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Neu</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Khan</surname>
            <given-names>AA</given-names>
          </name>
        </person-group>
        <article-title>Single-cell genomics: approaches and utility in immunology</article-title>
        <source>Trends Immunol.</source>
        <year>2017</year>
        <volume>38</volume>
        <fpage>140</fpage>
        <lpage>149</lpage>
        <pub-id pub-id-type="doi">10.1016/j.it.2016.12.001</pub-id>
        <?supplied-pmid 28094102?>
        <pub-id pub-id-type="pmid">28094102</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>S-Y</given-names>
          </name>
        </person-group>
        <article-title>Microfluidics in single-cell virology: technologies and applications</article-title>
        <source>Trends Biotechnol.</source>
        <year>2020</year>
        <volume>38</volume>
        <fpage>1360</fpage>
        <lpage>1372</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tibtech.2020.04.010</pub-id>
        <?supplied-pmid 32430227?>
        <pub-id pub-id-type="pmid">32430227</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eling</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Morgan</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Challenges in measuring and understanding biological noise</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>536</fpage>
        <lpage>548</lpage>
        <pub-id pub-id-type="doi">10.1038/s41576-019-0130-6</pub-id>
        <?supplied-pmid 31114032?>
        <pub-id pub-id-type="pmid">31114032</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stegle</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Computational and analytical challenges in single-cell transcriptomics</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>133</fpage>
        <lpage>145</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3833</pub-id>
        <?supplied-pmid 25628217?>
        <pub-id pub-id-type="pmid">25628217</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Kingma, D. P. &amp; Welling, M. Auto-encoding variational bayes. <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1312.6114">https://arxiv.org/abs/1312.6114</ext-link> (2013).</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hubert</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Arabie</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Comparing partitions</article-title>
        <source>J. Classif.</source>
        <year>1985</year>
        <volume>2</volume>
        <fpage>193</fpage>
        <lpage>218</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01908075</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zappia</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Phipson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Splatter: Simulation of single-cell RNA sequencing data</article-title>
        <source>Genome Biol.</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1305-0</pub-id>
        <pub-id pub-id-type="pmid">28077169</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kolodziejczyk</surname>
            <given-names>AA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single cell RNA-sequencing of pluripotent states unlocks modular transcriptional variation</article-title>
        <source>Cell Stem Cell</source>
        <year>2015</year>
        <volume>17</volume>
        <fpage>471</fpage>
        <lpage>485</lpage>
        <pub-id pub-id-type="doi">10.1016/j.stem.2015.09.011</pub-id>
        <?supplied-pmid 26431182?>
        <pub-id pub-id-type="pmid">26431182</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segerstolpe</surname>
            <given-names>Å</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptome profiling of human pancreatic islets in health and type 2 diabetes</article-title>
        <source>Cell Metab.</source>
        <year>2016</year>
        <volume>24</volume>
        <fpage>593</fpage>
        <lpage>607</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cmet.2016.08.020</pub-id>
        <?supplied-pmid 27667667?>
        <pub-id pub-id-type="pmid">27667667</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rousseeuw</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Silhouettes: a graphical aid to the interpretation and validation of cluster analysis</article-title>
        <source>J. Comput. Appl. Math.</source>
        <year>1987</year>
        <volume>20</volume>
        <fpage>53</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1016/0377-0427(87)90125-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lopez</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Regier</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cole</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Jordan</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Yosef</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Deep generative modeling for single-cell transcriptomics</article-title>
        <source>Nat. Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>1053</fpage>
        <lpage>1058</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0229-2</pub-id>
        <?supplied-pmid 30504886?>
        <pub-id pub-id-type="pmid">30504886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">He, K., Zhang, X., Ren, S. &amp; Sun, J. Deep residual learning for image recognition. In <italic>2016 IEEE Conference on Computer Vision and Pattern Recognition (CVPR)</italic>, 770–778 (2016).</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">Tan, M. &amp; Le, Q. EfficientNet: Rethinking model scaling for convolutional neural networks. In <italic>Proceedings of the 36th International Conference on Machine Learning</italic>, vol. 97, 6105–6114 (Long Beach, California, USA, 2019).</mixed-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tagett</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Diaz</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Draghici</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>A novel approach for data integration and disease subtyping</article-title>
        <source>Genome Res.</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>2025</fpage>
        <lpage>2039</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.215129.116</pub-id>
        <?supplied-pmid 29066617?>
        <pub-id pub-id-type="pmid">29066617</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Loshchilov, I. &amp; Hutter, F. Decoupled weight decay regularization. In <italic>International Conference on Learning Representations</italic><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1711.05101">https://arxiv.org/abs/1711.05101</ext-link> (2019).</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <mixed-citation publication-type="other">Sønderby, C. K., Raiko, T., Maaløe, L., Sønderby, S. K. &amp; Winther, O. Ladder variational autoencoders. <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1602.02282">https://arxiv.org/abs/1602.02282</ext-link> (2016).</mixed-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <mixed-citation publication-type="other">Klambauer, G., Unterthiner, T., Mayr, A. &amp; Hochreiter, S. Self-normalizing neural networks. In <italic>Advances in Neural Information Processing Systems</italic>, 971–980 <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1706.02515v5">https://arxiv.org/abs/1706.02515v5</ext-link> (2017).</mixed-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Won</surname>
            <given-names>KJ</given-names>
          </name>
        </person-group>
        <article-title>SHARP: hyperfast and accurate processing of single-cell RNA-seq data via ensemble random projection</article-title>
        <source>Genome Res.</source>
        <year>2020</year>
        <volume>30</volume>
        <fpage>205</fpage>
        <lpage>213</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.254557.119</pub-id>
        <?supplied-pmid 31992615?>
        <pub-id pub-id-type="pmid">31992615</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saelens</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Cannoodt</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Todorov</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Saeys</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>A comparison of single-cell trajectory inference methods</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>547</fpage>
        <lpage>554</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0071-9</pub-id>
        <?supplied-pmid 30936559?>
        <pub-id pub-id-type="pmid">30936559</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Tran, D. et al. Fast and precise single-cell data analysis using a hierarchical autoencoder. 10.5281/zenodo.4290047 (2020).</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yan</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq profiling of human preimplantation embryos and embryonic stem cells</article-title>
        <source>Nat. Struct. Mol. Biol.</source>
        <year>2013</year>
        <volume>20</volume>
        <fpage>1131</fpage>
        <pub-id pub-id-type="doi">10.1038/nsmb.2660</pub-id>
        <?supplied-pmid 23934149?>
        <pub-id pub-id-type="pmid">23934149</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goolam</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Heterogeneity in Oct4 and Sox2 targets biases cell fate in 4-cell mouse embryos</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>165</volume>
        <fpage>61</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2016.01.047</pub-id>
        <?supplied-pmid 27015307?>
        <pub-id pub-id-type="pmid">27015307</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deng</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Ramsköld</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Reinius</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Sandberg</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA-seq reveals dynamic, random monoallelic gene expression in mammalian cells</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>343</volume>
        <fpage>193</fpage>
        <lpage>196</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1245316</pub-id>
        <?supplied-pmid 24408435?>
        <pub-id pub-id-type="pmid">24408435</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pollen</surname>
            <given-names>AA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Low-coverage single-cell mRNA sequencing reveals cellular heterogeneity and activated signaling pathways in developing cerebral cortex</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2014</year>
        <volume>32</volume>
        <fpage>1053</fpage>
        <lpage>1058</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2967</pub-id>
        <?supplied-pmid 25086649?>
        <pub-id pub-id-type="pmid">25086649</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>YJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomics of the human endocrine pancreas</article-title>
        <source>Diabetes</source>
        <year>2016</year>
        <volume>65</volume>
        <fpage>3028</fpage>
        <lpage>3038</lpage>
        <pub-id pub-id-type="doi">10.2337/db16-0405</pub-id>
        <?supplied-pmid 27364731?>
        <pub-id pub-id-type="pmid">27364731</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darmanis</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A survey of human brain transcriptome diversity at the single cell level</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2015</year>
        <volume>112</volume>
        <fpage>7285</fpage>
        <lpage>7290</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1507125112</pub-id>
        <?supplied-pmid 26060301?>
        <pub-id pub-id-type="pmid">26060301</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Camp</surname>
            <given-names>JG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Human cerebral organoids recapitulate gene expression programs of fetal neocortex development</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2015</year>
        <volume>112</volume>
        <fpage>15672</fpage>
        <lpage>15677</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1520760112</pub-id>
        <?supplied-pmid 26644564?>
        <pub-id pub-id-type="pmid">26644564</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Usoskin</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Unbiased classification of sensory neuron types by large-scale single-cell RNA sequencing</article-title>
        <source>Nature Neurosci.</source>
        <year>2015</year>
        <volume>18</volume>
        <fpage>145</fpage>
        <lpage>153</lpage>
        <pub-id pub-id-type="doi">10.1038/nn.3881</pub-id>
        <?supplied-pmid 25420068?>
        <pub-id pub-id-type="pmid">25420068</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Camp</surname>
            <given-names>JG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multilineage communication regulates human liver bud development from pluripotency</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>546</volume>
        <fpage>533</fpage>
        <lpage>538</lpage>
        <pub-id pub-id-type="doi">10.1038/nature22796</pub-id>
        <?supplied-pmid 28614297?>
        <pub-id pub-id-type="pmid">28614297</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xin</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA sequencing of single human islet cells reveals type 2 diabetes genes</article-title>
        <source>Cell Metab.</source>
        <year>2016</year>
        <volume>24</volume>
        <fpage>608</fpage>
        <lpage>615</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cmet.2016.08.018</pub-id>
        <?supplied-pmid 27667665?>
        <pub-id pub-id-type="pmid">27667665</pub-id>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baron</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell transcriptomic map of the human and mouse pancreas reveals inter-and intra-cell population structure</article-title>
        <source>Cell Systems</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>346</fpage>
        <lpage>360</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.08.011</pub-id>
        <?supplied-pmid 27667365?>
        <pub-id pub-id-type="pmid">27667365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Muraro</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell transcriptome atlas of the human pancreas</article-title>
        <source>Cell Syst.</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>385–394.e3</fpage>
        <?supplied-pmid 27693023?>
        <pub-id pub-id-type="pmid">27693023</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Klein</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Droplet barcoding for single-cell transcriptomics applied to embryonic stem cells</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <fpage>1187</fpage>
        <lpage>1201</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.04.044</pub-id>
        <?supplied-pmid 26000487?>
        <pub-id pub-id-type="pmid">26000487</pub-id>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Romanov</surname>
            <given-names>RA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Molecular interrogation of hypothalamic organization reveals distinct dopamine neuronal subtypes</article-title>
        <source>Nat. Neurosci.</source>
        <year>2017</year>
        <volume>20</volume>
        <fpage>176</fpage>
        <lpage>188</lpage>
        <pub-id pub-id-type="doi">10.1038/nn.4462</pub-id>
        <?supplied-pmid 27991900?>
        <pub-id pub-id-type="pmid">27991900</pub-id>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lake</surname>
            <given-names>BB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Neuronal subtypes and diversity revealed by single-nucleus RNA sequencing of the human brain</article-title>
        <source>Science</source>
        <year>2016</year>
        <volume>352</volume>
        <fpage>1586</fpage>
        <lpage>1590</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaf1204</pub-id>
        <?supplied-pmid 27339989?>
        <pub-id pub-id-type="pmid">27339989</pub-id>
      </element-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Puram</surname>
            <given-names>SV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomic analysis of primary and metastatic tumor ecosystems in head and neck cancer</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>171</volume>
        <fpage>1611</fpage>
        <lpage>1624</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2017.10.044</pub-id>
        <?supplied-pmid 29198524?>
        <pub-id pub-id-type="pmid">29198524</pub-id>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Montoro</surname>
            <given-names>DT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A revised airway epithelial hierarchy includes CFTR-expressing ionocytes</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>560</volume>
        <fpage>319</fpage>
        <pub-id pub-id-type="doi">10.1038/s41586-018-0393-7</pub-id>
        <?supplied-pmid 30069044?>
        <pub-id pub-id-type="pmid">30069044</pub-id>
      </element-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA-seq reveals hypothalamic cell diversity</article-title>
        <source>Cell Rep.</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>3227</fpage>
        <lpage>3241</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2017.03.004</pub-id>
        <?supplied-pmid 28355573?>
        <pub-id pub-id-type="pmid">28355573</pub-id>
      </element-citation>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <mixed-citation publication-type="other">Sanderson, S. M. et al. The Na+/K+ atpase regulates glycolysis and defines immunometabolism in tumors. 10.1101/2020.03.31.018739 (2020).</mixed-citation>
    </ref>
    <ref id="CR69">
      <label>69.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Campbell</surname>
            <given-names>JN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A molecular census of arcuate hypothalamus and median eminence cell types</article-title>
        <source>Nat. Neurosci.</source>
        <year>2017</year>
        <volume>20</volume>
        <fpage>484</fpage>
        <lpage>496</lpage>
        <pub-id pub-id-type="doi">10.1038/nn.4495</pub-id>
        <?supplied-pmid 28166221?>
        <pub-id pub-id-type="pmid">28166221</pub-id>
      </element-citation>
    </ref>
    <ref id="CR70">
      <label>70.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zilionis</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomics of human and mouse lung cancers reveals conserved myeloid populations across individuals and species</article-title>
        <source>Immunity</source>
        <year>2019</year>
        <volume>50</volume>
        <fpage>1317</fpage>
        <lpage>1334</lpage>
        <pub-id pub-id-type="doi">10.1016/j.immuni.2019.03.009</pub-id>
        <?supplied-pmid 30979687?>
        <pub-id pub-id-type="pmid">30979687</pub-id>
      </element-citation>
    </ref>
    <ref id="CR71">
      <label>71.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Macosko</surname>
            <given-names>EZ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <fpage>1202</fpage>
        <lpage>1214</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.05.002</pub-id>
        <?supplied-pmid 26000488?>
        <pub-id pub-id-type="pmid">26000488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR72">
      <label>72.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hrvatin</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell analysis of experience-dependent transcriptomic states in the mouse visual cortex</article-title>
        <source>Nat. Neurosci.</source>
        <year>2018</year>
        <volume>21</volume>
        <fpage>120</fpage>
        <lpage>129</lpage>
        <pub-id pub-id-type="doi">10.1038/s41593-017-0029-5</pub-id>
        <?supplied-pmid 29230054?>
        <pub-id pub-id-type="pmid">29230054</pub-id>
      </element-citation>
    </ref>
    <ref id="CR73">
      <label>73.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schaum</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomics of 20 mouse organs creates a Tabula Muris</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>562</volume>
        <fpage>367</fpage>
        <lpage>372</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-018-0590-4</pub-id>
        <pub-id pub-id-type="pmid">30283141</pub-id>
      </element-citation>
    </ref>
    <ref id="CR74">
      <label>74.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karagiannis</surname>
            <given-names>TT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single cell transcriptomics reveals opioid usage evokes widespread suppression of antiviral gene program</article-title>
        <source>Nat. Commun.</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-16159-y</pub-id>
        <pub-id pub-id-type="pmid">31911652</pub-id>
      </element-citation>
    </ref>
    <ref id="CR75">
      <label>75.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Orozco</surname>
            <given-names>LD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integration of eQTL and a single-cell atlas in the human eye identifies causal genes for age-related macular degeneration</article-title>
        <source>Cell Rep.</source>
        <year>2020</year>
        <volume>30</volume>
        <fpage>1246</fpage>
        <lpage>1259</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2019.12.082</pub-id>
        <?supplied-pmid 31995762?>
        <pub-id pub-id-type="pmid">31995762</pub-id>
      </element-citation>
    </ref>
    <ref id="CR76">
      <label>76.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darrah</surname>
            <given-names>PA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Prevention of tuberculosis in macaques after intravenous BCG immunization</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>577</volume>
        <fpage>95</fpage>
        <lpage>102</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1817-8</pub-id>
        <?supplied-pmid 31894150?>
        <pub-id pub-id-type="pmid">31894150</pub-id>
      </element-citation>
    </ref>
    <ref id="CR77">
      <label>77.</label>
      <mixed-citation publication-type="other">Kozareva, V. et al. A transcriptomic atlas of the mouse cerebellum reveals regional specializations and novel cell types. 10.1101/2020.03.04.976407 (2020).</mixed-citation>
    </ref>
  </ref-list>
</back>
