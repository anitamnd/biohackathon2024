<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Conserv Physiol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Conserv Physiol</journal-id>
    <journal-id journal-id-type="publisher-id">conphys</journal-id>
    <journal-title-group>
      <journal-title>Conservation Physiology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2051-1434</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6364290</article-id>
    <article-id pub-id-type="doi">10.1093/conphys/coz003</article-id>
    <article-id pub-id-type="publisher-id">coz003</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Toolbox</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>FishResp: R package and GUI application for analysis of aquatic respirometry data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-1894-833X</contrib-id>
        <name>
          <surname>Morozov</surname>
          <given-names>Sergey</given-names>
        </name>
        <xref ref-type="aff" rid="coz003af1">1</xref>
        <xref ref-type="corresp" rid="coz003cor1"/>
        <!--<email>sergey.morozov@helsinki.fi</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>McCairns</surname>
          <given-names>R J Scott</given-names>
        </name>
        <xref ref-type="aff" rid="coz003af2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Merilä</surname>
          <given-names>Juha</given-names>
        </name>
        <xref ref-type="aff" rid="coz003af1">1</xref>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Cooke</surname>
          <given-names>Steven</given-names>
        </name>
        <role>Editor</role>
      </contrib>
    </contrib-group>
    <aff id="coz003af1"><label>1</label>Ecological Genetics Research Unit, Organismal and Evolutionary Biology Programme, Faculty of Biological and Environmental Sciences, University of Helsinki, Helsinki, Finland</aff>
    <aff id="coz003af2"><label>2</label>ESE, Ecology and Ecosystem Health, INRA, Agrocampus Ouest, Rennes, France</aff>
    <author-notes>
      <corresp id="coz003cor1"><bold>Corresponding author</bold>: Ecological Genetics Research Unit, Organismal and Evolutionary Biology Programme, Faculty of Biological and Environmental Sciences, University of Helsinki, 00014 Helsinki, Finland. Email: <email>sergey.morozov@helsinki.fi</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <pub-date iso-8601-date="2019-02-06" pub-type="epub">
      <day>06</day>
      <month>2</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>06</day>
      <month>2</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>7</volume>
    <issue>1</issue>
    <elocation-id>coz003</elocation-id>
    <history>
      <date date-type="received">
        <day>10</day>
        <month>11</month>
        <year>2018</year>
      </date>
      <date date-type="rev-recd">
        <day>19</day>
        <month>12</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>07</day>
        <month>1</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press and the Society for Experimental Biology.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="coz003.pdf"/>
    <abstract abstract-type="teaser">
      <p>FishResp is a user-friendly tool for calculating oxygen uptake of aquatic organisms. The aim of the software is to improve the quality of metabolic rate estimates based on a straightforward pipeline: background respiration correction, detection of mechanical problems, conduction of QC tests, and filtration based on user-defined criteria.</p>
    </abstract>
    <abstract>
      <title>Abstract</title>
      <p>Intermittent-flow respirometry is widely used to measure oxygen uptake rates and subsequently estimate aerobic metabolic rates of aquatic animals. However, the lack of a standard quality-control software to detect technical problems represents a potential impediment to comparisons across studies in the field of evolutionary and conservation physiology. Here, we introduce ‘FishResp’, a versatile R package and its graphical implementation for quality-control and filtering of raw respirometry data. Our goal is to provide a straightforward, cross-platform and free software to help improve the quality and comparability of metabolic rate estimates for reducing methodological fragmentation in the field of aquatic respirometry. FishResp accepts data from various respirometry systems, allows users to detect potential mechanical problems which can occur during oxygen uptake measurements (e.g. chamber leaking, poor water circulation), and offers six options to correct raw data for microbial oxygen consumption. The software performs filtering of raw data based on user criteria, and produces accurate and unbiased estimates of absolute and mass-specific metabolic rates. Using data from three-spined sticklebacks (<italic>Gasterosteus aculeatus</italic>) and Trinidadian guppies (<italic>Poecilia reticulata</italic>), we demonstrate the virtues of FishResp, highlighting the importance of detecting mechanical problems and correcting measurements for background respiration.</p>
    </abstract>
    <kwd-group>
      <kwd>background respiration</kwd>
      <kwd>free software</kwd>
      <kwd>intermittent-flow respirometry</kwd>
      <kwd>metabolic rate</kwd>
      <kwd>oxygen uptake</kwd>
      <kwd>three-spined stickleback</kwd>
      <kwd>Trinidadian guppy</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Oskar Öflund Foundation</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Alfred Kordelin Foundation</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Helsinki Institute of Life Sciences</named-content>
        </funding-source>
        <award-id>797011029</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Academy of Finland</named-content>
          <named-content content-type="funder-identifier">10.13039/501100002341</named-content>
        </funding-source>
        <award-id>259944</award-id>
        <award-id>292737</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="13"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="coz003s1">
    <title>Introduction</title>
    <p>Whole-body intermittent-flow respirometry (i.e. measuring the oxygen uptake of an organism) represents the most reliable and widespread technique to estimate aerobic metabolic rate of aquatic animals (<xref rid="coz003C36" ref-type="bibr">Steffensen, 1989</xref>; <xref rid="coz003C10" ref-type="bibr">Clark <italic>et al.</italic>, 2013</xref>; <xref rid="coz003C40" ref-type="bibr">Svendsen <italic>et al.</italic>, 2016b</xref>). As the availability and precision of oxygen sensors has grown (<xref rid="coz003C27" ref-type="bibr">Nelson, 2016</xref>), respirometry has become increasingly common in the field of evolutionary and conservation physiology (<xref rid="coz003C24" ref-type="bibr">Metcalfe <italic>et al.</italic>, 2016</xref>; <xref rid="coz003C6" ref-type="bibr">Chabot <italic>et al.</italic>, 2016a</xref>). Among other fundamental questions, it has been applied to the identification of ecological and environmental factors that cause metabolic rate variation (<xref rid="coz003C30" ref-type="bibr">Ohlberger <italic>et al.</italic>, 2007</xref>; <xref rid="coz003C2" ref-type="bibr">Auer <italic>et al.</italic>, 2015</xref>; <xref rid="coz003C8" ref-type="bibr">Christensen <italic>et al.</italic>, 2017</xref>) and for studying physiological plasticity and adaptation to novel environmental conditions, including adaptive potential to global ocean warming, ocean acidification, hypoxia and chemical contaminants (<xref rid="coz003C21" ref-type="bibr">Kreiss <italic>et al.</italic>, 2015</xref>; <xref rid="coz003C23" ref-type="bibr">McDonnell and Chapman, 2015</xref>; <xref rid="coz003C15" ref-type="bibr">Hancock and Place, 2016</xref>; <xref rid="coz003C22" ref-type="bibr">Kunz <italic>et al.</italic>, 2016</xref>; <xref rid="coz003C29" ref-type="bibr">Norin <italic>et al.</italic>, 2016</xref>; <xref rid="coz003C19" ref-type="bibr">Jayasundara <italic>et al.</italic>, 2017</xref>; <xref rid="coz003C44" ref-type="bibr">Zhang <italic>et al.</italic>, 2017</xref>). In addition, intermittent-flow respirometry has been recently used in studies devoted to both applied and fundamental problems in aquaculture and fisheries (<xref rid="coz003C17" ref-type="bibr">Hessenauer <italic>et al.</italic>, 2015</xref>; <xref rid="coz003C35" ref-type="bibr">Siikavuopio and James, 2015</xref>; <xref rid="coz003C14" ref-type="bibr">Gerile and Pirhonen, 2017</xref>; <xref rid="coz003C38" ref-type="bibr">Svendsen <italic>et al.</italic>, 2018</xref>).</p>
    <p>Despite the growing use of respirometry, quality-control of raw data and extraction of key parameters from it, remains the responsibility of individual researchers (<xref rid="coz003C32" ref-type="bibr">Rodgers <italic>et al.</italic>, 2016</xref>). The lack of standard quality-control software with the ability to detect and correct for technical problems in the raw data may compromise the comparability of results from different studies. Indeed, the literature contains many contradictory reports of intraspecific metabolic differences that are difficult to ascribe to only biological causes. For example, whilst inter-population comparisons of mean standard metabolic rate (SMR) estimates of Trinidadian guppy (<italic>Poecilia reticulata</italic>) have reported difference up to 1.7-fold between populations (<xref rid="coz003C16" ref-type="bibr">Handelsman <italic>et al.</italic>, 2013</xref>; <xref rid="coz003C1" ref-type="bibr">Auer <italic>et al.</italic>, 2018</xref>), comparisons between independent studies conducted under similar temperature conditions show 5-fold differences (from 100 to 550 mg O<sub>2</sub>/kg/h; <xref rid="coz003C37" ref-type="bibr">Svendsen <italic>et al.</italic>, 2013</xref>; <xref rid="coz003C12" ref-type="bibr">Ejbye-Ernst <italic>et al.</italic>, 2016</xref>; <xref rid="coz003C20" ref-type="bibr">Killen <italic>et al.</italic>, 2016</xref>). Such a wide range of SMR estimates within a species are unlikely to be explained by biological factors, but more likely, reflect unstandardized measurement conditions and data post-processing procedures.</p>
    <p>Two critical factors that influence the quality and reliability of respirometry data are (i) mechanical problems with the system itself and (ii) background respiration. As to the former, both the absence of or damage to a mixing device leading to poor water circulation in a system, and a large ratio of respirometer to fish volume, can reduce the resolution of raw data (<xref rid="coz003C32" ref-type="bibr">Rodgers <italic>et al.</italic>, 2016</xref>; <xref rid="coz003C39" ref-type="bibr">Svendsen <italic>et al.</italic>, 2016a</xref>). Similarly, study animals blocking the water supply to an oxygen sensor can cause dramatic drops in dissolved oxygen measurements, whereas leaking of a measurement chamber, which can be particularly pronounced under high water flow velocity in Blazka-type swimming tunnels (<xref rid="coz003C4" ref-type="bibr">Blazka <italic>et al.</italic>, 1960</xref>), has potential to lead to underestimation of metabolic rates (<xref rid="coz003C40" ref-type="bibr">Svendsen <italic>et al.</italic>, 2016b</xref>). Mechanical problems are relatively easy to detect via linear analysis of raw data, and may indicate the need to repair faulty equipment. However, detecting and correcting for background respiration (i.e. oxygen consumption of microorganisms in the water or on inner surfaces of equipment) can be more challenging (<xref rid="coz003C11" ref-type="bibr">Dalla Via, 1983</xref>; <xref rid="coz003C10" ref-type="bibr">Clark <italic>et al.</italic>, 2013</xref>; <xref rid="coz003C32" ref-type="bibr">Rodgers <italic>et al.</italic>, 2016</xref>). Although several approaches exist, many studies fail to mention how background respiration was dealt with, or whether background respiration was totally ignored in data processing (see <xref rid="coz003C40" ref-type="bibr">Svendsen <italic>et al.</italic>, 2016b</xref>). The potential problem with background respiration is especially relevant when metabolic rate is measured at high temperatures—a condition that favours microbial growth—and in small chambers, where the relative contribution of microbes to total rate of oxygen consumption is high and not constant over time (<xref rid="coz003C32" ref-type="bibr">Rodgers <italic>et al.</italic>, 2016</xref>). Both are prevalent when working with small tropical fish, as in the aforementioned guppy example, and can lead to substantial overestimates of oxygen consumption. In addition, background respiration may represent an increasingly large proportion of the total oxygen consumption under hypoxic conditions.</p>
    <p>Here, we introduce ‘FishResp’, software for running quality control tests, filtering raw data and calculating metabolic estimates of high accuracy. We demonstrate the utility of FishResp for detecting mechanical problems and correcting for background microbial oxygen consumption using raw data obtained from the three-spined stickleback (<italic>Gasterosteus aculeatus</italic>) and the Trinidadian guppy (<italic>Poecilia reticulata</italic>). These examples demonstrate how FishResp significantly improves the quality of final estimates, setting what we hope will become standard practice for processing raw respirometry data.</p>
  </sec>
  <sec sec-type="methods" id="coz003s2">
    <title>Materials and methods</title>
    <sec id="coz003s3">
      <title>Software description</title>
      <p>FishResp is an R package (<xref rid="coz003C31" ref-type="bibr">R Development Core Team, 2018</xref>) for analysing raw data from intermittent-flow respirometry systems. Its current version 1.0.2 consists of 15 functions (listed in Table <xref rid="coz003TB1" ref-type="table">1</xref>) and utilizes six dependencies (existing R packages) which will be automatically installed once FishResp is executed (listed in Table <xref rid="coz003TB2" ref-type="table">2</xref>). The order of application of each function in a typical analysis is described in Fig. <xref ref-type="fig" rid="coz003F1">1</xref>, encompassing all steps from data input to parameter estimation. Alternatively, a graphical user interface (GUI) of FishResp is also available, written in JavaFX. To integrate Java with R, the ‘rJava’ package (<xref rid="coz003C41" ref-type="bibr">Urbanek, 2018</xref>) and its extension ‘JRI’ are used. The graphical interface consists of five tabs with functional blocks on the left side (functions with parameters), and information, graphical or extensions modules on the right side of the application (Fig. <xref ref-type="fig" rid="coz003F2">2</xref>). The ‘Extensions Module’ has been created to integrate FishResp with other respirometry tools written in the R language, such as modified functions for unit conversion from the R packages ‘respirometry’ and ‘rMR’ (<xref rid="coz003C3" ref-type="bibr">Birk, 2018</xref>; <xref rid="coz003C26" ref-type="bibr">Moulton, 2018</xref>). Different colours of tabs and buttons are used as indicators of progress: unavailable (grey); plotting optional (blue); action required (yellow); successful execution (green). The log of complete actions can be saved using an icon in the upper-right corner of the graphical interface. Both versions of FishResp are free and open-source software, compatible with Windows, MacOS and Linux.
<table-wrap id="coz003TB1" orientation="portrait" position="float"><label>Table 1:</label><caption><p>Overview of all functions in the R package</p></caption><table frame="hsides" rules="all"><colgroup span="1"><col align="left" span="1"/><col align="left" span="1"/></colgroup><thead><tr><th rowspan="1" colspan="1">Function</th><th rowspan="1" colspan="1">Description</th></tr></thead><tbody><tr><td rowspan="1" colspan="1"><italic>input.info</italic></td><td rowspan="1" colspan="1">Input information about experimental organisms and chambers</td></tr><tr><td rowspan="1" colspan="1"><italic>import.test</italic></td><td rowspan="1" colspan="1">Import raw data for a background respiration test</td></tr><tr><td rowspan="1" colspan="1"><italic>import.meas</italic></td><td rowspan="1" colspan="1">Import raw data for metabolic rate measurements</td></tr><tr><td rowspan="1" colspan="1"><italic>correct.meas</italic></td><td rowspan="1" colspan="1">Correction of measurements for background respiration</td></tr><tr><td rowspan="1" colspan="1"><italic>QC.meas</italic></td><td rowspan="1" colspan="1">Graphical quality control of temperature and O<sub>2</sub> measurements before and after correction for bacterial respiration</td></tr><tr><td rowspan="1" colspan="1"><italic>QC.activity</italic></td><td rowspan="1" colspan="1">Graphical quality control of measurement windows</td></tr><tr><td rowspan="1" colspan="1"><italic>extract.slope</italic></td><td rowspan="1" colspan="1">Extraction of target measurements</td></tr><tr><td rowspan="1" colspan="1"><italic>QC.slope</italic></td><td rowspan="1" colspan="1">Graphical quality control of extracted measurements</td></tr><tr><td rowspan="1" colspan="1"><italic>rm.data</italic></td><td rowspan="1" colspan="1">Remove raw data manually for a specific measurement phase</td></tr><tr><td rowspan="1" colspan="1"><italic>calculate.MR</italic></td><td rowspan="1" colspan="1">Calculation and visualization of background respiration, absolute and mass-specific metabolic rates</td></tr><tr><td rowspan="1" colspan="1"><italic>export.MR</italic></td><td rowspan="1" colspan="1">Export results as .csv and .txt files (optionally, calculate aerobic metabolic scope)</td></tr><tr><td rowspan="1" colspan="1"><italic>convert.respirometry &amp; convert.rMR</italic></td><td rowspan="1" colspan="1">Convert dissolved oxygen to partial pressure units and <italic>vice versa</italic> in raw data obtained in multichannel respirometry systems (see the R packages ‘respirometry’ and ‘rMR’)</td></tr><tr><td rowspan="1" colspan="1"><italic>presens.aquaresp &amp; pyroscience.aquaresp</italic></td><td rowspan="1" colspan="1">Convert raw data from OxyView (PreSens) or Pyro Oxygen Logger (PyroScience) along with a summary file from AquaResp (free software) to the FishResp format</td></tr></tbody></table><table-wrap-foot><fn id="coz003tfn1"><p>The functions are listed in order of a typical FishResp analysis (see also Fig. 1), excluding optional functions <italic>convert.respirometry</italic>, <italic>convert.rMR</italic>, <italic>presens.aquaresp</italic>, <italic>pyroscience.aquaresp</italic>.</p></fn></table-wrap-foot></table-wrap><table-wrap id="coz003TB2" orientation="portrait" position="float"><label>Table 2:</label><caption><p>Overview of package dependencies and its functions in FishResp</p></caption><table frame="hsides" rules="all"><colgroup span="1"><col align="left" span="1"/><col align="left" span="1"/><col align="left" span="1"/></colgroup><thead><tr><th rowspan="1" colspan="1">R package</th><th rowspan="1" colspan="1">Function</th><th rowspan="1" colspan="1">Reference</th></tr></thead><tbody><tr><td rowspan="1" colspan="1"><italic>chron</italic></td><td rowspan="1" colspan="1">time analysis</td><td rowspan="1" colspan="1"><xref rid="coz003C18" ref-type="bibr">James and Hornik (2018)</xref></td></tr><tr><td rowspan="1" colspan="1"><italic>lattice</italic></td><td rowspan="1" colspan="1">graphics</td><td rowspan="1" colspan="1"><xref rid="coz003C33" ref-type="bibr">Sarkar (2008)</xref></td></tr><tr><td rowspan="1" colspan="1"><italic>mclust</italic></td><td rowspan="1" colspan="1">SMR determination</td><td rowspan="1" colspan="1"><xref rid="coz003C34" ref-type="bibr">Scrucca <italic>et al.</italic> (2016)</xref></td></tr><tr><td rowspan="1" colspan="1"><italic>respirometry</italic></td><td rowspan="1" colspan="1">DO converter</td><td rowspan="1" colspan="1"><xref rid="coz003C3" ref-type="bibr">Birk (2018)</xref></td></tr><tr><td rowspan="1" colspan="1"><italic>rMR</italic></td><td rowspan="1" colspan="1">DO converter</td><td rowspan="1" colspan="1"><xref rid="coz003C26" ref-type="bibr">Moulton (2018)</xref></td></tr><tr><td rowspan="1" colspan="1"><italic>rJava</italic></td><td rowspan="1" colspan="1">R to Java Interface</td><td rowspan="1" colspan="1"><xref rid="coz003C41" ref-type="bibr">Urbanek (2018)</xref></td></tr></tbody></table></table-wrap></p>
      <fig id="coz003F1" orientation="portrait" position="float">
        <label>Figure 1:</label>
        <caption>
          <p>Flowchart illustrating a data processing pipeline for conducting analysis in the R package ‘FishResp’. The names of R functions are italicized. The functions are grouped into four categories: raw data preparation (optional), input data and background respiration correction, slope extraction based on parameter filtration, and calculation of metabolic rate estimates.</p>
        </caption>
        <graphic xlink:href="coz003f01"/>
      </fig>
      <fig id="coz003F2" orientation="portrait" position="float">
        <label>Figure 2:</label>
        <caption>
          <p>GUI implementation of ‘FishResp’: general settings and the information about guppies used in Case Study 2.</p>
        </caption>
        <graphic xlink:href="coz003f02"/>
      </fig>
      <p>The software allows a user to analyse data from up to eight respirometry chambers concurrently. Raw data can be imported into the R package/GUI application directly from ‘AutoResp’ (Loligo Systems, Denmark) and ‘Q-box Aqua’ (Qubit Systems, Canada); and via ‘AquaResp’ (University of Copenhagen, Denmark) with ‘OxyView’ (PreSens GmbH, Germany) and ‘Pyro Oxygen Logger’ (Pyro Science GmbH, Germany) output. The output from other logger software and DIY setups can be manually adjusted to ‘FishResp’ import format (see ‘Details’ in the documentation of the R function ‘import.test’ or ‘import.meas’). The software accepts several units of O<sub>2</sub> concentration, while partial pressure units (e.g. % sat, mmHg or kPa) can be converted to O<sub>2</sub> concentration using the R functions ‘convert.respirometry’ and ‘convert.rMR’ or in the ‘Extensions Module’ of the GUI application (for details see the documentation of those functions). Quality-control tests and data filtering are performed with the aid of graphical visualizations, and parameters from simple linear models: the slope of the linear regression of O<sub>2</sub> concentration over time, and the coefficient of determination (<italic>r</italic><sup>2</sup>). Slopes are used to calculate metabolic rate, and to correct for background respiration.</p>
    </sec>
    <sec id="coz003s4">
      <title>Experimental design for correction of background respiration</title>
      <p>The number of traits calculated per one session is not limited in the R package, while GUI implementation of FishResp can be used only for measuring one or two metabolic traits per session, as shown in Fig. <xref ref-type="fig" rid="coz003F3">3</xref>. In order to subtract background respiration from total oxygen consumption, additional tests must be conducted without an animal in the chambers before, after or during metabolic rate measurements (pre-test, post-tests and parallel blank test, respectively). A full experiment processed with the GUI application can consist of four different steps (Fig. <xref ref-type="fig" rid="coz003F3">3</xref>A), but this can be reduced to one metabolic measurement with either one or two background respiration tests (Fig. <xref ref-type="fig" rid="coz003F3">3</xref>B). Both full and reduced designs are described to illustrate the use of the R package and its GUI version.</p>
      <fig id="coz003F3" orientation="portrait" position="float">
        <label>Figure 3:</label>
        <caption>
          <p>Schematic representation of full (<bold>A</bold>) and reduced (<bold>B</bold>) experimental designs. SMR and AMR are conditional terms and can be substituted with other traits. Pre and post blocks represent tests of background oxygen consumption before and after experiments.</p>
        </caption>
        <graphic xlink:href="coz003f03"/>
      </fig>
      <p>Six options are available for the correction of background respiration, each based on subtracting the slope of background respiration over time from the slope of animal oxygen consumption over time. Methods ‘pre.test’ and ‘post.test’ are used to remove background respiration before or after metabolic rate measurements, respectively. When a single metabolic trait has been measured with both pre- and post-tests (Fig. <xref ref-type="fig" rid="coz003F3">3</xref>B), ‘average’, ‘linear’ and ‘exponential’ methods can be used to subtract the averaged slope of the tests, or the progressively changing slope over time between those tests. Alternatively, an empty chamber running in parallel with actual metabolic rate measurements can be used for the correction. Note that the ‘parallel’ method does not require running pre- and/or post-tests. To choose an optimal method of correction, monitoring of background respiration over a long measurement period is recommended (<xref rid="coz003C32" ref-type="bibr">Rodgers <italic>et al.</italic>, 2016</xref>; <xref rid="coz003C40" ref-type="bibr">Svendsen <italic>et al.</italic>, 2016b</xref>).</p>
    </sec>
    <sec id="coz003s5">
      <title>Metabolic rate calculation</title>
      <p>Several methods of slope extraction are available to estimate metabolic rate: all slopes, slopes with minimal or maximal values, or those of a given quantile within the frequency distribution of observed slopes. In addition, four methods for determination of SMR have been integrated into FishResp: mean of the lowest normal distribution (MLND), quantiles, low10, and low10% (see <xref rid="coz003C7" ref-type="bibr">Chabot <italic>et al.</italic>, 2016b</xref>). Likewise, users can define a threshold <italic>r</italic><sup>2</sup> value (default value of 0.95), the parameter used to detect mechanical problems in a respirometry system (e.g. chamber leaking and poor water flow) or spontaneous animal activity during SMR measurements (but see <xref rid="coz003C10" ref-type="bibr">Clark <italic>et al.</italic>, 2013</xref>; <xref rid="coz003C28" ref-type="bibr">Norin and Clark, 2017</xref>; <xref rid="coz003C43" ref-type="bibr">Zhang and Gilbert, 2017</xref>).</p>
      <p>Calculation of absolute (absMO<sub>2</sub>; ‘cO<sub>2</sub> unit’/h) and mass-specific (massMO<sub>2</sub>; ‘cO<sub>2</sub> unit’/kg/h) metabolic rates are based on the following equations (<xref rid="coz003C9" ref-type="bibr">Claireaux and Lagardère, 1999</xref>):
<disp-formula id="coz003M1"><label>(1)</label><mml:math id="coz003DmEq1"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">absMO</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>×</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mo>−</mml:mo><mml:mi>D</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="coz003M2"><label>(2)</label><mml:math id="coz003DmEq2"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">massMO</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">abs</mml:mi><mml:mspace width=".25em"/><mml:msub><mml:mrow><mml:mi mathvariant="normal">MO</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo form="prefix">−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula>where Δ<italic>[O</italic><sub>2</sub><italic>]</italic>/Δ<italic>t</italic> is slope in ‘cO<sub>2</sub> unit’/L/h, <italic>m</italic> is mass in kg, <italic>V</italic> the chamber volume in L, and <italic>D</italic> is the density of an animal body (by default = 1000 kg/m<sup>3</sup>, can be modified; but see <xref rid="coz003C40" ref-type="bibr">Svendsen <italic>et al.</italic> (2016b)</xref>)</p>
    </sec>
    <sec id="coz003s6">
      <title>Fish and respirometry systems used for case studies</title>
      <p>Use of FishResp is demonstrated in two case studies. Case Study 1 shows how the full scheme can be run using the R package, and provides an example of how mechanical problems can be detected. Raw respirometry data come from four three-spined sticklebacks (average mass = 1.96, SD = 0.19 g), measured in a 4-channel respirometry system of 250 mL Blazka-type swim tunnels (DAQ-PAC-F4 package, AutoResp user’s manual; Loligo Systems, Denmark), together with pre- and post-tests. Standard metabolic rate (SMR) was measured overnight (22:00–06:00) after 4 h of acclimation in the absence of light and other external stimuli; active metabolic rate (AMR) was measured during the day at 80% of individual critical swimming speed, which represents a proxy of maximum aerobic activity during prolonged swimming performance, but not absolute maxMO<sub>2</sub> (for definitions, see <xref rid="coz003C5" ref-type="bibr">Brett, 1964</xref>; <xref rid="coz003C13" ref-type="bibr">Fry, 1971</xref>). We used an intermittent-flow procedure consisting of flush, wait and measurement phases (420/180/1200 s for SMR and pre-test, and 420/180/600 s for AMR and post-test). The experiment was conducted in fresh water at 16.5°C with constant velocity (5 cm/s) generated by a propeller inside a swim tunnel. The level of dissolved oxygen during an open phase was 8.8 mg/L (90% air saturation), and it never dropped below 5.95 mg/L (61% air saturation) during the measurement phase.</p>
      <p>Case Study 2, using data from four male and four female guppies (average mass<sub>male</sub> = 0.084, SD = 0.014 g and average mass<sub>female</sub> = 0.271, SD = 0.109 g), provides an example of excessively high background respiration, and is presented to demonstrate both the GUI and the importance of background respiration correction. Measures of SMR were taken overnight after 4 h of acclimation using eight 21.8 mL static chambers connected to an 8-channel respirometry system (DAQ-PAC-WF8 package, AutoResp user’s manual; Loligo Systems, Denmark) with 300 s flush, 180 s wait and 720 s measurement periods. Fresh water was constantly mixed by a pump during the measurement phase (<italic>T</italic> = 24.8°C; mean cO<sub>2</sub> = 7.1, SD = 0.5 mg/L). Background respiration in the chambers was measured before and after the experiment (Fig. <xref ref-type="fig" rid="coz003F3">3</xref>B). The calibration of the oxygen sensors for case studies was performed following the 2-point calibration procedure described in the AutoResp user’s manual (Loligo Systems, Denmark). Raw data for both Case Study 1 and Case Study 2 can be found in the package folders ‘FishResp/extdata/stickleback’ and ‘FishResp/extdata/guppy,’ respectively.</p>
      <p>Experiments were carried out in accordance with the recommendations and approval of the National Animal Experiment Board of Finland (permit no: ESAVI/6097/04.10.07/2013) and the Stockholm Ethical Board (permit no: N173/13, 223/15 and N8/17).</p>
    </sec>
  </sec>
  <sec id="coz003s7">
    <title>Results and discussion</title>
    <sec id="coz003s8">
      <title>Case Study 1: Calculation of SMR, AMR and MS of Sticklebacks</title>
      <sec id="coz003s9">
        <title>Import and correction of raw data</title>
        <p>Following the general outline of a typical ‘FishResp’ analysis (Fig. <xref ref-type="fig" rid="coz003F1">1</xref>), the command library(FishResp) is used to load the package. The function input.info() must be applied first to specify dissolved oxygen measurement units, and to provide information about individual ID, fish mass (g), and chamber volumes (mL) used in subsequent analyses (see Table <xref rid="coz003TB1" ref-type="table">1</xref>):</p>
        <p>info &lt;- input.info(DO.unit = "mg/L", ID = c("Stickleback_1", "Stickleback_2", "Stickleback_3", "Stickleback_4"), Mass = c(1.86, 1.92, 2.23, 1.80), Volume = c(250, 250, 250, 250))</p>
        <p>To load files containing raw data of background respiration measurements into R (‘pre-test.txt’ and ‘post-test.txt’), the function import.test() should be used—note that if data files are not located in the same directory as the R session, file names should be specified with their full paths (see code in <xref ref-type="supplementary-material" rid="sup1">File S1</xref>). The path to the file, the type of oxygen logger software, and the number of chambers used should also be included as arguments. Graphs of oxygen and temperature over time are plotted automatically to check temperature fluctuations and water supply to the sensor during background respiration tests:</p>
        <p>pre &lt;- import.test(pre.path, info.data=info, logger="AutoResp", n.chamber=4)</p>
        <p>post &lt;- import.test(post.path, info.data=info, logger="AutoResp", n.chamber=4)</p>
        <p>The next step is to import raw data of SMR and AMR measurements into R using the import.meas() function. If the date format is not ‘DMY’, specify it in this function. Two additional parameters (start.measure and stop.measure, respectively) corresponding to the time interval of measurements not exceeding 24 h can help remove non-target data (e.g. acclimation period after handling stress):</p>
        <p>SMR.raw &lt;- import.meas(SMR.path, info.data=info, logger="AutoResp", n.chamber=4, start.measure="22:00:00", stop.measure="06:00:00")</p>
        <p>AMR.raw &lt;- import.meas(AMR.path, info.data=info, logger="AutoResp", n.chamber=4)</p>
        <p>As a full design was chosen for this experiment (Fig. <xref ref-type="fig" rid="coz003F3">3</xref>A), ‘pre’ and ‘post’ methods are used to correct SMR and AMR for background respiration, respectively, where slopes of linear models (level of dissolved oxygen over time) for background respiration tests are automatically subtracted from slopes of linear models for actual measurements using the function correct.meas():</p>
        <p>SMR.clean &lt;- correct.meas(info.data=info, pre.data=pre, meas.data=SMR.raw, method="pre.test")</p>
        <p>AMR.clean &lt;- correct.meas(info.data=info, post.data=post, meas.data=AMR.raw, method="post.test")</p>
        <p>Oxygen data before and after background respiration correction can be visualized using the function QC.meas():</p>
        <p>QC.meas(SMR.clean, "Total.O2.phases")QC.meas(SMR.clean, "Corrected.O2.phases")QC.meas(SMR.clean, "Total.O2.chambers")QC.meas(SMR.clean, "Corrected.O2.chambers")</p>
        <p>Plotting raw data plays an important role in assessing its quality, providing preliminary information about the rate of background respiration; corrected O<sub>2</sub> plots allow the user to evaluate their choice of correction strategy. In this example, levels of dissolved oxygen and temperature were stable over the duration of the experiment, indicating that both pre- and post-tests can be used to remove background respiration.</p>
      </sec>
      <sec id="coz003s10">
        <title>Extraction and visualization of results: identifying and removing artefacts due to animal disturbance or swimming inactivity</title>
        <p>The next step is to select slopes of dissolved oxygen concentration over time to calculate metabolic rate. This is particularly relevant when several consecutive measurement cycles are taken. In this example, SMR measurements were collected every 30 min over an 8 h period, but only three slopes have been extracted to determine SMR. In contrast, as only three AMR measurements are available for each individual, all three slopes are used for calculation of AMR. For both traits, only slopes with <italic>r</italic><sup>2</sup> &gt; 0.95 are extracted.</p>
        <p>SMR.slope &lt;- extract.slope(SMR.clean, method="min", n.slope=3, r2=0.95)</p>
        <p>AMR.slope &lt;- extract.slope(AMR.clean, method="all", r2=0.95)</p>
        <p>It can be helpful to plot each slope separately: the function QC.slope() visualizes how a linear model fits data corrected for background respiration. However, if one of the ‘calcSMR’ methods is selected to determine SMR (<xref rid="coz003C7" ref-type="bibr">Chabot <italic>et al.</italic>, 2016b</xref>), a user should first extract all slopes to be able to plot linear models, and then apply a ‘calcSMR’ method (see Case Study 2 and <xref ref-type="supplementary-material" rid="sup1">File S2</xref>). Note that an exponential decrease of oxygen content over long measurement periods might be caused by chamber leaking or poor water circulation in a respirometry system even with high <italic>r</italic><sup>2</sup> value (<xref rid="coz003C40" ref-type="bibr">Svendsen <italic>et al.</italic>, 2016b</xref>; <xref rid="coz003C28" ref-type="bibr">Norin and Clark, 2017</xref>). Would this be the case, those data should be omitted from further analyses.</p>
        <p>QC.slope(SMR.slope, SMR.clean, chamber="CH1", current=1200, alter=600)</p>
        <p>QC.slope(AMR.slope, AMR.clean, chamber="CH4", current=600, alter=300)</p>
        <p>In this example, linear models perfectly capture the trend in SMR and most AMR data (Fig. <xref ref-type="fig" rid="coz003F4">4</xref>, M1). However, data from the two final AMR measurement phases in ‘Chamber 4’ show decreases in oxygen uptake rate with time (Fig. <xref ref-type="fig" rid="coz003F4">4</xref>, M2 &amp; M3). During experiments (including <xref rid="coz003C25" ref-type="bibr">Morozov <italic>et al.</italic>, 2018</xref>), we noticed that some individuals could not constantly maintain 80% of U<sub>crit</sub> in swimming tunnels during the final minutes of AMR measurements, but leaned against the honeycomb stopper housing the oxygen sensor. Occasionally, fish were able to block the oxygen supply to the sensor, leading to dramatic decrease of oxygen level in raw data (Fig. <xref ref-type="fig" rid="coz003F4">4</xref>, M2). The slopes for M2 look similar because blocking of the sensor was short and in the middle stage of measurement phase. The other common problem, when an experimental organism stopped swimming and rate of oxygen uptake dropped, is illustrated in panel M3 (Fig. <xref ref-type="fig" rid="coz003F4">4</xref>, M3): the fish was not able to swim after the first five minutes of the measurement phase, reflected in the upward inflection of the QC plot. In fact, here we detected both these mechanical problems based on graphical QC tests, but not based on <italic>r</italic><sup>2</sup> &lt; 0.95. Thus, it is important to combine computational methods with visualization of intermittent results of the analysis. To avoid under- and over-estimating AMR, and to follow a uniform approach for extracting slopes for this trait, we decreased the time interval used for slope calculation with the function extract.slope(). The other important feature of the function QC.slope(), which can represent a useful tool for detecting deviations from linearity and in determination of measurement window length, is regression diagnostic plots for current and alternative length of a measurement window (Fig. <xref ref-type="fig" rid="coz003F5">5</xref>). In this example, reducing the measurement window to 5 min (300 s) helps improve linear fit and allow us to avoid artefacts due to swimming inactivity (Fig. <xref ref-type="fig" rid="coz003F4">4</xref>; red lines, Fig. <xref ref-type="fig" rid="coz003F5">5</xref>; red graphs):</p>
        <fig id="coz003F4" orientation="portrait" position="float">
          <label>Figure 4:</label>
          <caption>
            <p>Slopes for AMR in three-spined stickleback. The level of oxygen content in a respirometry chamber was measured every second over 10 min during three measurement phases (M1—M3). Black lines denote a linear model over the whole measurement period; in red measurements are restricted to the first 5 min. M1, M2 and M3 are the discrete measurement cycles.</p>
          </caption>
          <graphic xlink:href="coz003f04"/>
        </fig>
        <fig id="coz003F5" orientation="portrait" position="float">
          <label>Figure 5:</label>
          <caption>
            <p>Regression diagnostics for the measurement phase ‘M3’ of Chamber 4. Raw data with fitted linear models for current length of measurement window (600s, black colour) and the alternative one (300s, red colour) displayed on the top graph. Regression diagnostic plots for current and alternative measurement windows are located in the middle section and the bottom section of the figure, respectively. More information on diagnostic plots can be found in the documentation of the base R function plot.lm().</p>
          </caption>
          <graphic xlink:href="coz003f05"/>
        </fig>
        <p>QC.slope(AMR.slope, AMR.clean, chamber="CH4", current=600, alter=300, residuals=TRUE)</p>
        <p>AMR.slope &lt;- extract.slope(AMR.clean, method="all", r2=0.95, length=300)</p>
        <p>It should be noted that a call to extract.slope() uses <italic>r</italic><sup>2</sup> = 0.95 as a default linearity filter. <xref rid="coz003C40" ref-type="bibr">Svendsen <italic>et al.</italic> (2016b)</xref> have suggested that this should be viewed as the minimum criterion when estimating O<sub>2</sub> consumption from the slope of a linear model. This value can be manually changed if users wish to use a more robust value. Under some circumstances users may wish to relax this parameter; however, we would urge careful reflection before doing so, and that all parameters used be reported.</p>
        <p>The final step is to calculate and plot metabolic rate estimates, together with the percentage rate of background respiration using the function calculate.MR().</p>
        <p>SMR &lt;- calculate.MR(SMR.slope, density=1000)</p>
        <p>AMR &lt;- calculate.MR(AMR.slope, density=1000)</p>
        <p>Results can be exported as .txt or .csv files. Optionally, when two traits are measured, they can be merged into one dataset containing absolute, mass-specific and factorial metabolic scopes.</p>
        <p>results &lt;- export.MR(SMR, AMR, "results.csv", simplify=TRUE, MS=TRUE)</p>
        <p>Note that the rate of background respiration for both SMR and AMR is not more than 13.8% and 28.7% respectively. However, the situation can change dramatically when the experiment is conducted at high water temperature and/or in small chambers, as demonstrated by Case Study 2.</p>
      </sec>
    </sec>
    <sec id="coz003s11">
      <title>Case Study 2: The effect of background respiration on SMR of Guppies</title>
      <sec id="coz003s12">
        <title>Running the analysis using GUI application</title>
        <p>The GUI version is created for users who prefer to interact with graphical elements in a user-friendly interface instead of working with a command line. Here, we demonstrate the use of the application for estimating background respiration, and calculating SMR (see <xref ref-type="supplementary-material" rid="sup1">File S2</xref> to run this example in R). After launching the program, a user should set parameters in the ‘Global settings’ module: we choose ‘pre- and post-tests’ as background respiration tests, ‘AutoResp’ for the type of logger software, and eight chambers in the respirometry system. As we measured only one trait (SMR), the field for ‘Trait 2’ should be empty. Click the ‘Save global settings’ button, and fill in the table with information about animals and chambers (Fig. <xref ref-type="fig" rid="coz003F2">2</xref>). Next, move to the ‘Background respiration’ tab and import data for pre- and post-tests. Note that conducting visual QC tests of raw data is critical: if the temperature is unstable, or oxygen data show loss of linearity, further calculations might be meaningless. Navigation buttons of the graphical module can be used for zooming and switching plots for different chambers. Finally, open the ‘Standard Metabolic Rate’ tab, import raw data for SMR (time interval: 22:00:00–06:00:00), and correct them for background respiration. As both pre- and post-tests were used, all methods excluding ‘parallel’ are available (Fig. <xref ref-type="fig" rid="coz003F3">3</xref>B). In this example, the method ‘exponential’ is used because background respiration was on average 17% lower during the pre-test than during the post-test in all chambers (Wilcoxon signed-rank test, <italic><italic>P</italic></italic> = 0.014), wherein exponential microbial growth is expected (<xref rid="coz003C11" ref-type="bibr">Dalla Via, 1983</xref>, but see <xref rid="coz003C32" ref-type="bibr">Rodgers <italic>et al.</italic>, 2016</xref>).</p>
      </sec>
      <sec id="coz003s13">
        <title>Comparison of SMR before and after correction</title>
        <p>In the module ‘Visual QC tests’, a user can compare non-corrected versus corrected data, and check for indications of animal activity over the measurement period (GUI implementation of the package functions, QC.meas and QC.activity). ‘Activity’ and ‘Comparison’ options calculate mass-specific metabolic rate automatically, disabling any filters for slope estimation (but see <xref rid="coz003C42" ref-type="bibr">Wilson, 2018</xref>). The ‘Activity’ option can be helpful for defining the time of corrected SMR, while ‘Comparison’ is used for graphical comparison of results with and without correction for background respiration (Fig. <xref ref-type="fig" rid="coz003F6">6</xref>). Fig. <xref ref-type="fig" rid="coz003F6">6</xref> shows that mass-specific SMR after the subtraction of microbial oxygen consumption is markedly lower than before correction.</p>
        <fig id="coz003F6" orientation="portrait" position="float">
          <label>Figure 6:</label>
          <caption>
            <p>GUI implementation of ‘FishResp’: graphical module shows the difference in mass-specific SMR of guppies before (upper panel) and after correction (lower panel) for background respiration.</p>
          </caption>
          <graphic xlink:href="coz003f06"/>
        </fig>
        <p>To calculate SMR, together with the percentage of background respiration, open the ‘Results’ tab. The method ‘calcSMR: quant’ (<xref rid="coz003C7" ref-type="bibr">Chabot <italic>et al.</italic>, 2016b</xref>) is chosen to determine SMR based on calculation of the lower quantile (<italic>P</italic> = 0.25) of all slopes with <italic>r</italic><sup>2</sup> &gt; 0.9 (the threshold level is reduced because of the high rate of background respiration, coupled with a low ratio between mass of male guppies and the volume of chambers, both of which seriously reduced the linearity of corrected data). Note, if any of ‘calcSMR’ methods are applied, then slopes cannot be plotted individually in the module ‘QC of slopes’. Thus, before using ‘calcSMR: quant’, we extract all slopes and conduct graphical QC tests of slopes for each chamber. Finally, we insert information about the body density of fish and click the button ‘Calculate and plot’. Three graphs are plotted automatically in the graphical module: percentage rate of background respiration, absolute and mass-specific SMR. The last step is to save results as a .csv or .txt file (a log file with all commands applied during the analysis is also logged automatically in the same folder).</p>
        <p>Results of the analysis show that background respiration represents 57.1–89% of the total oxygen consumption (Fig. <xref ref-type="fig" rid="coz003F7">7</xref>A), despite daily cleaning of chambers and sensors, weekly changing 50% of water volume in the respirometry system and constant usage of the UV filter. Absolute SMR varies depending on mass of fish, while the mean mass-specific SMR is 185.5 mgO<sub>2</sub>/kg/h. Thus, mean SMR is overestimated by ~2.8 times for females and 6.7 times for males (Fig. <xref ref-type="fig" rid="coz003F7">7</xref>B), when not corrected for background respiration.</p>
        <fig id="coz003F7" orientation="portrait" position="float">
          <label>Figure 7:</label>
          <caption>
            <p>(<bold>A</bold>) Absolute SMR of guppies versus background respiration. (<bold>B</bold>) Difference in corrected and non-corrected mass-specific SMR.</p>
          </caption>
          <graphic xlink:href="coz003f07"/>
        </fig>
      </sec>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="coz003s14">
    <title>Conclusions</title>
    <p>Our case studies demonstrate that neglecting mechanical problems and microbial growth in a respirometry system can lead to underestimation and/or overestimation of metabolic rate. FishResp software, used together with a proper experimental design (<xref rid="coz003C10" ref-type="bibr">Clark <italic>et al.</italic>, 2013</xref>; <xref rid="coz003C40" ref-type="bibr">Svendsen <italic>et al.</italic>, 2016b</xref>), represents a simple and efficient approach to account for the effects of chamber issues and background respiration in the processing of raw respirometry data. To make FishResp a universally available tool, we have developed both the R package (available on CRAN), and its cross-platform and user-friendly graphical implementation under open source licenses. Both can import raw data from the majority of respirometry systems available on the market. FishResp can be adjusted for different experimental designs: the software allows users to choose among various options for detection of mechanical problems, correction of background respiration, and calculation of metabolic rate. Therefore, FishResp provides a universal and straightforward tool that can improve the quality of metabolic rate estimation in fishes and other aquatic animals. Last but not least, the ‘Extensions module’ in the GUI version of FishResp represents a platform for graphical implementation of other R packages, scripts and functions available in open-access/published. Thus, FishResp has potential to become a community-driven software in the field of aquatic respirometry.</p>
  </sec>
  <sec sec-type="data-availability" id="coz003s15">
    <title>Data availability</title>
    <p>The R package and data are available on the CRAN repository (<uri xlink:href="http://cran.r-project.org/package=FishResp">http://cran.r-project.org/package=FishResp</uri>). R scripts for running both case studies are provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary files S1 &amp; S2</xref>. Application of functions which have not been reviewed in the case studies are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary file S3</xref>. The official website (<uri xlink:href="https://fishresp.org">https://fishresp.org</uri>) will host all information related to FishResp, including user manuals, tutorial videos, FAQ, a forum and a blog with the latest updates of the software.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="coz003_supplementary_revised.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="coz003ack1">
    <title>Acknowledgements</title>
    <p>We thank Artur Zaripov and Roman Kovalev for significant contribution to GUI development, Federico Calboli and Nicholas Carey for helpful advice and testing the R package, Niclas Kolm and Alexander Kotrschal for providing the guppy data.</p>
  </ack>
  <sec id="coz003s17">
    <title>Funding</title>
    <p>This work was supported by Oskar Öflund Foundation (SM), Alfred Kordelin Foundation (SM), Helsinki Institute of Life Sciences [797011029 to J.M.] and Academy of Finland [259944 to R.J.S.M., 292737 to J.M.].</p>
  </sec>
  <sec id="coz003s18">
    <title>Authors’ contributions</title>
    <p>S.M. and R.J.S.M. conceived the ideas and designed the original R functions. S.M. developed the R package and GUI application. All authors led the writing of the manuscript and contributed critically to all drafts, and gave final approval for publication.</p>
  </sec>
  <sec id="coz003s19">
    <title>Conflict of interest statement</title>
    <p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="coz003C1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Auer</surname><given-names>SK</given-names></name>, <name name-style="western"><surname>Dick</surname><given-names>CA</given-names></name>, <name name-style="western"><surname>Metcalfe</surname><given-names>NB</given-names></name>, <name name-style="western"><surname>Reznick</surname><given-names>DN</given-names></name></person-group> (<year>2018</year>) <article-title>Metabolic rate evolves rapidly and in parallel with the pace of life history</article-title>. <source>Nat Commun</source><volume>9</volume>: <fpage>6</fpage>.<pub-id pub-id-type="pmid">29295974</pub-id></mixed-citation>
    </ref>
    <ref id="coz003C2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Auer</surname><given-names>SK</given-names></name>, <name name-style="western"><surname>Salin</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Rudolf</surname><given-names>AM</given-names></name>, <name name-style="western"><surname>Anderson</surname><given-names>GJ</given-names></name>, <name name-style="western"><surname>Metcalfe</surname><given-names>NB</given-names></name></person-group> (<year>2015</year>) <article-title>The optimal combination of standard metabolic rate and aerobic scope for somatic growth depends on food availability</article-title>. <source>Funct Ecol</source><volume>29</volume>: <fpage>479</fpage>–<lpage>486</lpage>.</mixed-citation>
    </ref>
    <ref id="coz003C3">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Birk</surname><given-names>MA</given-names></name></person-group> (<year>2018</year>) respirometry: Tools for conducting and analyzing respirometry experiments, R package, version 0.7.0, URL: <uri xlink:href="http://cran.r-project.org/package=respirometry">http://cran.r-project.org/package=respirometry</uri></mixed-citation>
    </ref>
    <ref id="coz003C4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Blazka</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Volf</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Cepela</surname><given-names>M</given-names></name></person-group> (<year>1960</year>) <article-title>A new type of respirometer for the determination of the metabolism of fish in an active state</article-title>. <source>Physiol Bohemoslov</source><volume>9</volume>: <fpage>553</fpage>–<lpage>558</lpage>.</mixed-citation>
    </ref>
    <ref id="coz003C5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Brett</surname><given-names>JR</given-names></name></person-group> (<year>1964</year>) <article-title>The respiratory metabolism and swimming performance of young sockeye salmon</article-title>. <source>J Fish Res Board Can</source><volume>21</volume>: <fpage>1183</fpage>–<lpage>1226</lpage>.</mixed-citation>
    </ref>
    <ref id="coz003C6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chabot</surname><given-names>D</given-names></name>, <name name-style="western"><surname>McKenzie</surname><given-names>DJ</given-names></name>, <name name-style="western"><surname>Craig</surname><given-names>JF</given-names></name></person-group> (<year>2016</year>a) <article-title>Metabolic rate in fishes: definitions, methods and significance for conservation physiology</article-title>. <source>J Fish Biol</source><volume>88</volume>: <fpage>1</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">26768969</pub-id></mixed-citation>
    </ref>
    <ref id="coz003C7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chabot</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Steffensen</surname><given-names>JF</given-names></name>, <name name-style="western"><surname>Farrell</surname><given-names>AP</given-names></name></person-group> (<year>2016</year>b) <article-title>The determination of standard metabolic rate in fishes</article-title>. <source>J Fish Biol</source><volume>88</volume>: <fpage>81</fpage>–<lpage>121</lpage>.<pub-id pub-id-type="pmid">26768973</pub-id></mixed-citation>
    </ref>
    <ref id="coz003C8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Christensen</surname><given-names>EAF</given-names></name>, <name name-style="western"><surname>Svendsen</surname><given-names>MBS</given-names></name>, <name name-style="western"><surname>Steffensen</surname><given-names>JF</given-names></name></person-group> (<year>2017</year>) <article-title>Plasma osmolality and oxygen consumption of perch <italic>Perca fluviatilis</italic> in response to different salinities and temperatures</article-title>. <source>J Fish Biol</source><volume>90</volume>: <fpage>819</fpage>–<lpage>833</lpage>.<pub-id pub-id-type="pmid">27981561</pub-id></mixed-citation>
    </ref>
    <ref id="coz003C9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Claireaux</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Lagardère</surname><given-names>JP</given-names></name></person-group> (<year>1999</year>) <article-title>Influence of temperature, oxygen and salinity on the metabolism of the European sea bass</article-title>. <source>J Sea Res</source><volume>42</volume>: <fpage>157</fpage>–<lpage>168</lpage>.</mixed-citation>
    </ref>
    <ref id="coz003C10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Clark</surname><given-names>TD</given-names></name>, <name name-style="western"><surname>Sandblom</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Jutfelt</surname><given-names>F</given-names></name></person-group> (<year>2013</year>) <article-title>Aerobic scope measurements of fishes in an era of climate change: respirometry, relevance and recommendations</article-title>. <source>J Exp Biol</source><volume>216</volume>: <fpage>2771</fpage>–<lpage>2782</lpage>.<pub-id pub-id-type="pmid">23842625</pub-id></mixed-citation>
    </ref>
    <ref id="coz003C11">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Dalla Via</surname><given-names>GJ</given-names></name></person-group> (<year>1983</year>) <article-title>Bacterial growth and antibiotics in animal respirometry</article-title>. In A Erich Gnaiger, Hellmuth Forstner, eds, <source>Polarographic oxygen sensors. Springer Vol 216</source>. <publisher-name>Springer, Berlin, Heidelberg</publisher-name>, <volume>216</volume>: pp <fpage>202</fpage>–<lpage>218</lpage>.</mixed-citation>
    </ref>
    <ref id="coz003C12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ejbye-Ernst</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Michaelsen</surname><given-names>TY</given-names></name>, <name name-style="western"><surname>Tirsgaard</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Wilson</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Jensen</surname><given-names>LF</given-names></name>, <name name-style="western"><surname>Steffensen</surname><given-names>JF</given-names></name>, <name name-style="western"><surname>Pertoldi</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Aarestrup</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Svendsen</surname><given-names>JC</given-names></name></person-group> (<year>2016</year>) <article-title>Partitioning the metabolic scope: the importance of anaerobic metabolism and implications for the oxygen- and capacity-limited thermal tolerance (OCLTT) hypothesis</article-title>. <source>Conserv Physiol</source><volume>4</volume>: <fpage>13</fpage>.</mixed-citation>
    </ref>
    <ref id="coz003C13">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Fry</surname><given-names>FEJ</given-names></name></person-group> (<year>1971</year>) <chapter-title>The effect of environmental factors on the physiology of fish</chapter-title> In <person-group person-group-type="editor"><name name-style="western"><surname>Hoar</surname><given-names>WS</given-names></name>, <name name-style="western"><surname>Randall</surname><given-names>DJ</given-names></name>, eds</person-group>
<source>Fish Physiology</source>, <volume>Vol. 6</volume>
<publisher-name>Academic Press</publisher-name>, <publisher-loc>New York</publisher-loc>, pp <fpage>1</fpage>–<lpage>98</lpage>.</mixed-citation>
    </ref>
    <ref id="coz003C14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gerile</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Pirhonen</surname><given-names>J</given-names></name></person-group> (<year>2017</year>) <article-title>Replacement of fishmeal with corn gluten meal in feeds for juvenile rainbow trout (<italic>Oncorhynchus mykiss</italic>) does not affect oxygen consumption during forced swimming</article-title>. <source>Aquaculture</source><volume>479</volume>: <fpage>616</fpage>–<lpage>618</lpage>.</mixed-citation>
    </ref>
    <ref id="coz003C15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hancock</surname><given-names>JR</given-names></name>, <name name-style="western"><surname>Place</surname><given-names>SP</given-names></name></person-group> (<year>2016</year>) <article-title>Impact of ocean acidification on the hypoxia tolerance of the woolly sculpin, <italic>Clinocottus analis</italic></article-title>. <source>Conserv Physiol</source><volume>4</volume>: <fpage>cow040</fpage>.<pub-id pub-id-type="pmid">27729981</pub-id></mixed-citation>
    </ref>
    <ref id="coz003C16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Handelsman</surname><given-names>CA</given-names></name>, <name name-style="western"><surname>Broder</surname><given-names>ED</given-names></name>, <name name-style="western"><surname>Dalton</surname><given-names>CM</given-names></name>, <name name-style="western"><surname>Ruell</surname><given-names>EW</given-names></name>, <name name-style="western"><surname>Myrick</surname><given-names>CA</given-names></name>, <name name-style="western"><surname>Reznick</surname><given-names>DN</given-names></name>, <name name-style="western"><surname>Ghalambor</surname><given-names>CK</given-names></name></person-group> (<year>2013</year>) <article-title>Predator-induced phenotypic plasticity in metabolism and rate of growth: rapid adaptation to a novel environment</article-title>. <source>Integr Comp Biol</source><volume>53</volume>: <fpage>975</fpage>–<lpage>988</lpage>.<pub-id pub-id-type="pmid">23784701</pub-id></mixed-citation>
    </ref>
    <ref id="coz003C17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hessenauer</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Vokoun</surname><given-names>JC</given-names></name>, <name name-style="western"><surname>Suski</surname><given-names>CD</given-names></name>, <name name-style="western"><surname>Davis</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Jacobs</surname><given-names>R</given-names></name>, <name name-style="western"><surname>O’Donnell</surname><given-names>E</given-names></name></person-group> (<year>2015</year>) <article-title>Differences in the metabolic rates of exploited and unexploited fish populations: a signature of recreational fisheries induced evolution?</article-title><source>PLoS One</source><volume>10</volume>: <fpage>12</fpage>.</mixed-citation>
    </ref>
    <ref id="coz003C18">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>James</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Hornik</surname><given-names>K</given-names></name></person-group> (<year>2018</year>). chron: Chronological objects which can handle dates and times, R package, version 2.3–53, URL: <uri xlink:href="http://cran.r-project.org/package=chron">http://cran.r-project.org/package=chron</uri></mixed-citation>
    </ref>
    <ref id="coz003C19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jayasundara</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Fernando</surname><given-names>PW</given-names></name>, <name name-style="western"><surname>Osterberg</surname><given-names>JS</given-names></name>, <name name-style="western"><surname>Cammen</surname><given-names>KM</given-names></name>, <name name-style="western"><surname>Schultz</surname><given-names>TF</given-names></name>, <name name-style="western"><surname>Di Giulio</surname><given-names>RT</given-names></name></person-group> (<year>2017</year>) <article-title>Cost of tolerance: physiological consequences of evolved resistance to inhabit a polluted environment in teleost fish <italic>Fundulus heteroclitus</italic></article-title>. <source>Environ Sci Technol</source><volume>51</volume>: <fpage>8763</fpage>–<lpage>8772</lpage>.<pub-id pub-id-type="pmid">28682633</pub-id></mixed-citation>
    </ref>
    <ref id="coz003C20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Killen</surname><given-names>SS</given-names></name>, <name name-style="western"><surname>Croft</surname><given-names>DP</given-names></name>, <name name-style="western"><surname>Salin</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Darden</surname><given-names>SK</given-names></name></person-group> (<year>2016</year>) <article-title>Male sexually coercive behaviour drives increased swimming efficiency in female guppies</article-title>. <source>Funct Ecol</source><volume>30</volume>: <fpage>576</fpage>–<lpage>583</lpage>.<pub-id pub-id-type="pmid">27478292</pub-id></mixed-citation>
    </ref>
    <ref id="coz003C21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kreiss</surname><given-names>CM</given-names></name>, <name name-style="western"><surname>Michael</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Lucassen</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Jutfelt</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Motyka</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Dupont</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Pörtner</surname><given-names>HO</given-names></name></person-group> (<year>2015</year>) <article-title>Ocean warming and acidification modulate energy budget and gill ion regulatory mechanisms in Atlantic cod (<italic>Gadus morhua</italic>)</article-title>. <source>J Comp Physiol B</source><volume>185</volume>: <fpage>767</fpage>–<lpage>781</lpage>.<pub-id pub-id-type="pmid">26219611</pub-id></mixed-citation>
    </ref>
    <ref id="coz003C22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kunz</surname><given-names>KL</given-names></name>, <name name-style="western"><surname>Frickenhaus</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Hardenberg</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Johansen</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Leo</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Pörtner</surname><given-names>HO</given-names></name>, <name name-style="western"><surname>Schmidt</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Windisch</surname><given-names>HS</given-names></name>, <name name-style="western"><surname>Knust</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Mark</surname><given-names>FC</given-names></name></person-group> (<year>2016</year>) <article-title>New encounters in Arctic waters: a comparison of metabolism and performance of polar cod (<italic>Boreogadus saida</italic>) and Atlantic cod (<italic>Gadus morhua</italic>) under ocean acidification and warming</article-title>. <source>Polar Biol</source><volume>39</volume>: <fpage>1137</fpage>–<lpage>1153</lpage>.</mixed-citation>
    </ref>
    <ref id="coz003C23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>McDonnell</surname><given-names>LH</given-names></name>, <name name-style="western"><surname>Chapman</surname><given-names>LJ</given-names></name></person-group> (<year>2015</year>) <article-title>At the edge of the thermal window: effects of elevated temperature on the resting metabolism, hypoxia tolerance and upper critical thermal limit of a widespread African cichlid</article-title>. <source>Conserv Physiol</source><volume>3</volume>: <fpage>13</fpage>.</mixed-citation>
    </ref>
    <ref id="coz003C24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Metcalfe</surname><given-names>NB</given-names></name>, <name name-style="western"><surname>Van Leeuwen</surname><given-names>TE</given-names></name>, <name name-style="western"><surname>Killen</surname><given-names>SS</given-names></name></person-group> (<year>2016</year>) <article-title>Does individual variation in metabolic phenotype predict fish behaviour and performance?</article-title><source>J Fish Biol</source><volume>88</volume>: <fpage>298</fpage>–<lpage>321</lpage>.<pub-id pub-id-type="pmid">26577442</pub-id></mixed-citation>
    </ref>
    <ref id="coz003C25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Morozov</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Leinonen</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Merilä</surname><given-names>J</given-names></name>, <name name-style="western"><surname>McCairns</surname><given-names>RJS</given-names></name></person-group> (<year>2018</year>) <article-title>Selection on the morphology–physiology‐performance nexus: lessons from freshwater stickleback morphs</article-title>. <source>Ecol Evol</source><volume>8</volume>: <fpage>1286</fpage>–<lpage>1299</lpage>.<pub-id pub-id-type="pmid">29375798</pub-id></mixed-citation>
    </ref>
    <ref id="coz003C26">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Moulton</surname><given-names>TL</given-names></name></person-group> (<year>2018</year>). rMR: Importing data from Loligo Systems software, calculating metabolic rates and critical tensions, R package, version 1.1.0, URL: <uri xlink:href="http://cran.r-project.org/package=rMR">http://cran.r-project.org/package=rMR</uri></mixed-citation>
    </ref>
    <ref id="coz003C27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nelson</surname><given-names>JA</given-names></name></person-group> (<year>2016</year>) <article-title>Oxygen consumption rate <italic>v</italic>. rate of energy utilization of fishes: a comparison and brief history of the two measurements</article-title>. <source>J Fish Biol</source><volume>88</volume>: <fpage>10</fpage>–<lpage>25</lpage>.<pub-id pub-id-type="pmid">26768970</pub-id></mixed-citation>
    </ref>
    <ref id="coz003C28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Norin</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Clark</surname><given-names>TD</given-names></name></person-group> (<year>2017</year>) <article-title>Reply to Zhang &amp; Gilbert (2017): Comment on ‘Measurement and relevance of maximum metabolic rate in fishes by Norin &amp; Clark (2016)’</article-title>. <source>J Fish Biol</source><volume>91</volume>: <fpage>403</fpage>–<lpage>408</lpage>.<pub-id pub-id-type="pmid">28776704</pub-id></mixed-citation>
    </ref>
    <ref id="coz003C29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Norin</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Malte</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Clark</surname><given-names>TD</given-names></name></person-group> (<year>2016</year>) <article-title>Differential plasticity of metabolic rate phenotypes in a tropical fish facing environmental change</article-title>. <source>Funct Ecol</source><volume>30</volume>: <fpage>369</fpage>–<lpage>378</lpage>.</mixed-citation>
    </ref>
    <ref id="coz003C30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ohlberger</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Staaks</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Hölker</surname><given-names>F</given-names></name></person-group> (<year>2007</year>) <article-title>Effects of temperature, swimming speed and body mass on standard and active metabolic rate in vendace (<italic>Coregonus albula</italic>)</article-title>. <source><italic toggle="yes">J Comp Physiol B-Biochem Syst </italic>Environ Physiol</source><volume>177</volume>: <fpage>905</fpage>–<lpage>916</lpage>.</mixed-citation>
    </ref>
    <ref id="coz003C31">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><collab>R Development Core Team</collab></person-group> (<year>2018</year>). R: A Language and Environment for Statistical Computing, R Foundation for Statistical Computing, Vienna, Austria.</mixed-citation>
    </ref>
    <ref id="coz003C32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rodgers</surname><given-names>GG</given-names></name>, <name name-style="western"><surname>Tenzing</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Clark</surname><given-names>TD</given-names></name></person-group> (<year>2016</year>) <article-title>Experimental methods in aquatic respirometry: the importance of mixing devices and accounting for background respiration</article-title>. <source>J Fish Biol</source><volume>88</volume>: <fpage>65</fpage>–<lpage>80</lpage>.<pub-id pub-id-type="pmid">26768972</pub-id></mixed-citation>
    </ref>
    <ref id="coz003C33">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Sarkar</surname><given-names>D</given-names></name></person-group> (<year>2008</year>) <source>Lattice: Multivariate Data Visualization with R</source>. <publisher-name>Springer Science &amp; Business Media</publisher-name>, New York.</mixed-citation>
    </ref>
    <ref id="coz003C34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Scrucca</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Fop</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Murphy</surname><given-names>TB</given-names></name>, <name name-style="western"><surname>Raftery</surname><given-names>AE</given-names></name></person-group> (<year>2016</year>) <article-title>mclust 5: clustering, classification and density estimation using Gaussian finite mixture models</article-title>. <source>R J</source><volume>8</volume>: <fpage>289</fpage>–<lpage>317</lpage>.<pub-id pub-id-type="pmid">27818791</pub-id></mixed-citation>
    </ref>
    <ref id="coz003C35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Siikavuopio</surname><given-names>SI</given-names></name>, <name name-style="western"><surname>James</surname><given-names>P</given-names></name></person-group> (<year>2015</year>) <article-title>Effects of temperature on feed intake, growth and oxygen consumption in adult male king crab <italic>Paralithodes camtschaticus</italic> held in captivity and fed manufactured diets</article-title>. <source>Aquac Res</source><volume>46</volume>: <fpage>602</fpage>–<lpage>608</lpage>.</mixed-citation>
    </ref>
    <ref id="coz003C36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Steffensen</surname><given-names>JF</given-names></name></person-group> (<year>1989</year>) <article-title>Some errors in respirometry of aquatic breathers: how to avoid and correct for them</article-title>. <source>Fish Physiol Biochem</source><volume>6</volume>: <fpage>49</fpage>–<lpage>59</lpage>.<pub-id pub-id-type="pmid">24226899</pub-id></mixed-citation>
    </ref>
    <ref id="coz003C37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Svendsen</surname><given-names>MBS</given-names></name>, <name name-style="western"><surname>Andersen</surname><given-names>NR</given-names></name>, <name name-style="western"><surname>Hansen</surname><given-names>PJ</given-names></name>, <name name-style="western"><surname>Steffensen</surname><given-names>JF</given-names></name></person-group> (<year>2018</year>) <article-title>Effects of harmful algal blooms on fish: insights from <italic>Prymnesium parvum</italic></article-title>. <source>Fishes</source><volume>3</volume>: <fpage>11</fpage>.</mixed-citation>
    </ref>
    <ref id="coz003C38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Svendsen</surname><given-names>JC</given-names></name>, <name name-style="western"><surname>Banet</surname><given-names>AI</given-names></name>, <name name-style="western"><surname>Christensen</surname><given-names>RHB</given-names></name>, <name name-style="western"><surname>Steffensen</surname><given-names>JF</given-names></name>, <name name-style="western"><surname>Aarestrup</surname><given-names>K</given-names></name></person-group> (<year>2013</year>) <article-title>Effects of intraspecific variation in reproductive traits, pectoral fin use and burst swimming on metabolic rates and swimming performance in the Trinidadian guppy (<italic>Poecilia reticulata</italic>)</article-title>. <source>J Exp Biol</source><volume>216</volume>: <fpage>3564</fpage>–<lpage>3574</lpage>.<pub-id pub-id-type="pmid">23737561</pub-id></mixed-citation>
    </ref>
    <ref id="coz003C39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Svendsen</surname><given-names>MBS</given-names></name>, <name name-style="western"><surname>Bushnell</surname><given-names>PG</given-names></name>, <name name-style="western"><surname>Christensen</surname><given-names>EAF</given-names></name>, <name name-style="western"><surname>Steffensen</surname><given-names>JF</given-names></name></person-group> (<year>2016</year>a) <article-title>Sources of variation in oxygen consumption of aquatic animals demonstrated by simulated constant oxygen consumption and respirometers of different sizes</article-title>. <source>J Fish Biol</source><volume>88</volume>: <fpage>51</fpage>–<lpage>64</lpage>.<pub-id pub-id-type="pmid">26768971</pub-id></mixed-citation>
    </ref>
    <ref id="coz003C40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Svendsen</surname><given-names>MBS</given-names></name>, <name name-style="western"><surname>Bushnell</surname><given-names>PG</given-names></name>, <name name-style="western"><surname>Steffensen</surname><given-names>JF</given-names></name></person-group> (<year>2016</year>b) <article-title>Design and setup of intermittent-flow respirometry system for aquatic organisms</article-title>. <source>J Fish Biol</source><volume>88</volume>: <fpage>26</fpage>–<lpage>50</lpage>.<pub-id pub-id-type="pmid">26603018</pub-id></mixed-citation>
    </ref>
    <ref id="coz003C41">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Urbanek</surname><given-names>S</given-names></name></person-group> (<year>2018</year>). rJava: Low-level R to Java interface, R package, version 0.9–10, URL: <uri xlink:href="http://cran.r-project.org/package=rJava">http://cran.r-project.org/package=rJava</uri></mixed-citation>
    </ref>
    <ref id="coz003C42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wilson</surname><given-names>AJ</given-names></name></person-group> (<year>2018</year>) <article-title>How should we interpret estimates of individual repeatability?</article-title><source>Evol Lett</source><volume>2</volume>: <fpage>4</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">30283660</pub-id></mixed-citation>
    </ref>
    <ref id="coz003C43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Gilbert</surname><given-names>MJH</given-names></name></person-group> (<year>2017</year>) <article-title>Comment on ‘Measurement and relevance of maximum metabolic rate in fishes by Norin &amp; Clark (2016)’</article-title>. <source>J Fish Biol</source><volume>91</volume>: <fpage>397</fpage>–<lpage>402</lpage>.<pub-id pub-id-type="pmid">28776701</pub-id></mixed-citation>
    </ref>
    <ref id="coz003C44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>YF</given-names></name>, <name name-style="western"><surname>Mauduit</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Farrell</surname><given-names>AP</given-names></name>, <name name-style="western"><surname>Chabot</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Ollivier</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Rio-Cabello</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Le Floch</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Claireaux</surname><given-names>G</given-names></name></person-group> (<year>2017</year>) <article-title>Exposure of European sea bass (<italic>Dicentrarchus labrax</italic>) to chemically dispersed oil has a chronic residual effect on hypoxia tolerance but not aerobic scope</article-title>. <source>Aquat Toxicol</source><volume>191</volume>: <fpage>95</fpage>–<lpage>104</lpage>.<pub-id pub-id-type="pmid">28806602</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
