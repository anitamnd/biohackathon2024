<?all-math-mml yes?>
<?use-mml?>
<?properties open_access?>
<?properties manuscript?>
<?origin nihpa?>
<?iso-abbr Nat. Methods?>
<?submitter-system nihms?>
<?submitter-canonical-name Nature Publishing Group?>
<?submitter-canonical-id NATURE-STRUCTUR?>
<?submitter-userid 8068858?>
<?submitter-authority myNCBI?>
<?submitter-login nature-structure?>
<?submitter-name Nature Publishing Group?>
<?domain nihpa?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-journal-id">101215604</journal-id>
    <journal-id journal-id-type="pubmed-jr-id">32338</journal-id>
    <journal-id journal-id-type="nlm-ta">Nat Methods</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat. Methods</journal-id>
    <journal-title-group>
      <journal-title>Nature methods</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1548-7091</issn>
    <issn pub-type="epub">1548-7105</issn>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6884698</article-id>
    <article-id pub-id-type="pmid">31686038</article-id>
    <article-id pub-id-type="doi">10.1038/s41592-019-0616-3</article-id>
    <article-id pub-id-type="manuscript">nihpa1540415</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Learning accurate representations of microbe-metabolite interactions</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Morton</surname>
          <given-names>James T.</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Aksenov</surname>
          <given-names>Alexander A.</given-names>
        </name>
        <xref ref-type="aff" rid="A3">3</xref>
        <xref ref-type="aff" rid="A4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nothias</surname>
          <given-names>Louis Felix</given-names>
        </name>
        <xref ref-type="aff" rid="A3">3</xref>
        <xref ref-type="aff" rid="A4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Foulds</surname>
          <given-names>James R.</given-names>
        </name>
        <xref ref-type="aff" rid="A5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Quinn</surname>
          <given-names>Robert A.</given-names>
        </name>
        <xref ref-type="aff" rid="A6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Badri</surname>
          <given-names>Michelle H.</given-names>
        </name>
        <xref ref-type="aff" rid="A7">7</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Swenson</surname>
          <given-names>Tami L.</given-names>
        </name>
        <xref ref-type="aff" rid="A8">8</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Van Goethem</surname>
          <given-names>Marc W.</given-names>
        </name>
        <xref ref-type="aff" rid="A8">8</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Northen</surname>
          <given-names>Trent R.</given-names>
        </name>
        <xref ref-type="aff" rid="A8">8</xref>
        <xref ref-type="aff" rid="A9">9</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vazquez-Baeza</surname>
          <given-names>Yoshiki</given-names>
        </name>
        <xref ref-type="aff" rid="A10">10</xref>
        <xref ref-type="aff" rid="A11">11</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Mingxun</given-names>
        </name>
        <xref ref-type="aff" rid="A3">3</xref>
        <xref ref-type="aff" rid="A4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bokulich</surname>
          <given-names>Nicholas A.</given-names>
        </name>
        <xref ref-type="aff" rid="A12">12</xref>
        <xref ref-type="aff" rid="A13">13</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Watters</surname>
          <given-names>Aaron</given-names>
        </name>
        <xref ref-type="aff" rid="A14">14</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Song</surname>
          <given-names>Se Jin</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A11">11</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bonneau</surname>
          <given-names>Richard</given-names>
        </name>
        <xref ref-type="aff" rid="A7">7</xref>
        <xref ref-type="aff" rid="A14">14</xref>
        <xref ref-type="aff" rid="A15">15</xref>
        <xref ref-type="aff" rid="A16">16</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dorrestein</surname>
          <given-names>Pieter C.</given-names>
        </name>
        <xref ref-type="aff" rid="A3">3</xref>
        <xref ref-type="aff" rid="A4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Knight</surname>
          <given-names>Rob</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A2">2</xref>
        <xref ref-type="aff" rid="A17">17</xref>
        <xref ref-type="aff" rid="A11">11</xref>
      </contrib>
    </contrib-group>
    <aff id="A1"><label>1</label>Department of Pediatrics, University of California, San Diego, La Jolla, CA, USA</aff>
    <aff id="A2"><label>2</label>Department of Computer Science &amp; Engineering, University of California, San Diego, La Jolla, CA, USA</aff>
    <aff id="A3"><label>3</label>Collaborative Mass Spectrometry Innovaftion Center, University of California San Diego, La Jolla, CA, USA</aff>
    <aff id="A4"><label>4</label>Skaggs School of Pharmacy and Pharmaceutical Sciences, University of California San Diego, La Jolla, CA, USA</aff>
    <aff id="A5"><label>5</label>Department of Information Systems, University of Maryland Baltimore County, Baltimore, MD, USA</aff>
    <aff id="A6"><label>6</label>Department of Biochemistry and Molecular Biology, Michigan State University, East Lansing, MI, USA</aff>
    <aff id="A7"><label>7</label>Department of Biology, New York University, New York, 10012 NY, USA</aff>
    <aff id="A8"><label>8</label>Environmental Genomics and Systems Biology Division, Lawrence Berkeley National Laboratory,1 Cyclotron Rd, Berkeley, CA, 94720, USA</aff>
    <aff id="A9"><label>9</label>DOE Joint Genome Institute, 2800 Mitchell Dr., Walnut Creek, CA, 94598, USA</aff>
    <aff id="A10"><label>10</label>Jacobs School of Engineering, University of California San Diego, La Jolla, CA, USA</aff>
    <aff id="A11"><label>11</label>Center for Microbiome Innovation, University of California, San Diego, La Jolla, CA, USA</aff>
    <aff id="A12"><label>12</label>The Pathogen and Microbiome Institute, Northern Arizona University, Flagstaff, AZ, USA</aff>
    <aff id="A13"><label>13</label>Department of Biological Sciences, Northern Arizona University, Flagstaff, AZ, USA</aff>
    <aff id="A14"><label>14</label>Flatiron Institute, Simons Foundation, New York, 10010 NY, USA</aff>
    <aff id="A15"><label>15</label>Computer Science Department, Courant Institute, New York, 10012 NY, USA</aff>
    <aff id="A16"><label>16</label>Center For Data Science, NYU, New York, NY 10008, USA</aff>
    <aff id="A17"><label>17</label>Department of Bioengineering University of California, San Diego, La Jolla, CA, USA</aff>
    <author-notes>
      <fn fn-type="con" id="FN1">
        <label>6</label>
        <p id="P1">Author contributions</p>
        <p id="P2">J.T.M wrote the mmvec algorithm, conducted the benchmarks and ran all of the analyses. A.A.A. and L.F.N. preprocessed and annotated the metabolomics data. A.A.A. provided insights in the high fat diet study. J.R.F. provided insights behind word2vec and topic modeling. M.H.B. benchmarked SPIEC-EASI. R.A.Q. provided insights behind the cystic fibrosis study and simulations. Y.V.B. provided insights behind the interpretation of the IBD analysis. M.W. developed the GNPS workflow for mmvec. N.A.B developed the heatmap visualizations. A.W developed the network visualizations. A.W developed the network visualizations. T.L.S. M.W.V.G and T.N. provided insights behind the biocrust soils experiment. All authors were involved with writing the manuscript.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="nihms-submitted">
      <day>24</day>
      <month>9</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>04</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>04</day>
      <month>5</month>
      <year>2020</year>
    </pub-date>
    <volume>16</volume>
    <issue>12</issue>
    <fpage>1306</fpage>
    <lpage>1314</lpage>
    <!--elocation-id from pubmed: 10.1038/s41592-019-0616-3-->
    <permissions>
      <license>
        <license-p>Users may view, print, copy, and download text and data-mine the content in such documents, for the purposes of academic research, subject always to the full Conditions of use:<uri xlink:type="simple" xlink:href="http://www.nature.com/authors/editorial_policies/license.html#terms">http://www.nature.com/authors/editorial_policies/license.html#terms</uri></license-p>
      </license>
    </permissions>
    <abstract id="ABS1">
      <p id="P3">Integrating multi-omics datasets is critical for microbiome research, but multiple statistical challenges can confound traditional correlation techniques. We solve this problem by using neural networks to estimate the conditional probability that each molecule is present given the presence of each specific microbe. We show with known environmental (desert biological soil crust wetting) and clinical (cystic fibrosis lung) examples, our ability to recover microbe-metabolite relationships, and demonstrate how the method can discover relationships between microbially-produced metabolites and inflammatory bowel disease.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec id="S1">
    <label>2</label>
    <title>Introduction</title>
    <p id="P4">Knowledge gained by integrating complementary “-omics” data with a multi-omics approach will lead to improved diagnostics, automated drug discovery, and optimized culturing conditions for uncharacterized microbes [<xref rid="R1" ref-type="bibr">1</xref>]. Previous work have been able to predict metabolite abundance profiles from microbe abundance profiles [<xref rid="R2" ref-type="bibr">2</xref>, <xref rid="R3" ref-type="bibr">3</xref>]. However, because conventional correlation techniques have unacceptably high false discovery rates, finding meaningful relationships between genes within complex microbiomes and their products in the metabolome is challenging.</p>
    <p id="P5">Although there has been a widespread effort to develop multi-omics approaches, several conceptual challenges limit techniques that integrate disparate “omics” data in general, including linking the microbial sequencing and untargeted mass spectrometry. Therefore, new approaches are needed that can handle disparate data types [<xref rid="R4" ref-type="bibr">4</xref>]. Relative abundances of thousands of microbes and metabolites can be measured using sequencing and mass spectrometry, resulting in the generation of very high dimensional microbiome and metabolomics datasets. Quantifying microbe-metabolite interactions from these abundances requires estimating a distribution across all possible microbe-metabolite interactions.</p>
    <p id="P6">Techniques such as Canonical Correspondence Analysis (CCA) and Partial Least Squares (PLS) approximate this joint distribution using a low dimensional representations [<xref rid="R5" ref-type="bibr">5</xref>, <xref rid="R6" ref-type="bibr">6</xref>, <xref rid="R7" ref-type="bibr">7</xref>]. Network models have been shown to improve classification accuracy using multiple datasets [<xref rid="R8" ref-type="bibr">8</xref>]. Factor models have been proposed to incorporate multiple datasets for biomarker analysis [<xref rid="R9" ref-type="bibr">9</xref>]. Despite of the wide application of these methods, they are notoriously difficult to interpret [<xref rid="R10" ref-type="bibr">10</xref>, <xref rid="R11" ref-type="bibr">11</xref>, <xref rid="R12" ref-type="bibr">12</xref>] and it remains unclear whether these models can obtain individual microbe-metabolite interactions.</p>
    <p id="P7">Pearson and Spearman correlations assume independence between interactions, simplifying the estimation procedure by reducing it to a combination of independent two dimensional problems. However, many studies have shown that these methods are not statistically valid for compositional data, a fact first recognized by Pearson in 1895 and followed up in numerous studies [<xref rid="R13" ref-type="bibr">13</xref>, <xref rid="R14" ref-type="bibr">14</xref>, <xref rid="R15" ref-type="bibr">15</xref>, <xref rid="R16" ref-type="bibr">16</xref>, <xref rid="R17" ref-type="bibr">17</xref>]. This problem is further complicated because both microbiome [<xref rid="R17" ref-type="bibr">17</xref>] and mass spectrometry [<xref rid="R18" ref-type="bibr">18</xref>, <xref rid="R19" ref-type="bibr">19</xref>, <xref rid="R20" ref-type="bibr">20</xref>, <xref rid="R21" ref-type="bibr">21</xref>] datasets are also compositional, meaning that the absolute abundances are not measured, which can confound statistical inference. For example, in untargeted mass spectrometry experiments, the set of molecules detected and their relative abundance vary depending on the extraction protocol and analytic methods used, which leads to only a partial snapshot of the metabolome. Moreover, measuring the total mass of molecules extracted is often not performed in large scale metabolomics efforts, due to the highly laborious nature of that step.</p>
    <p id="P8">To understand how issues associated with compositional data impact inference on microbe-metabolite interactions, consider the example in <xref rid="SD1" ref-type="supplementary-material">Figure S1</xref>. There are two microbes and two metabolites in <xref rid="SD1" ref-type="supplementary-material">Figure S1a</xref>. All are increasing exponentially at different rates and are highly correlated with each other. If proportions are estimated from the absolute abundances via sampling, the information about the total microbe population size and the total metabolite abundance is lost, and the correlations between the microbes and the metabolites disappear. False positives can also appear as shown in <xref rid="SD1" ref-type="supplementary-material">Figure S1b</xref>, microbe and metabolite interactions that have no apparent correlation structure may appear to be correlated when investigating the proportions. These issues alone can give rise to overwhelming false positives and false negatives, making Pearson and Spearman in some scenarios comparable to random coin flips. Experimental validation currently takes large laboratories multiple years to perform [<xref rid="R22" ref-type="bibr">22</xref>], often requiring time-consuming manual examinations of erroneous correlations.</p>
    <p id="P9">There are other compositional techniques such as SparCC[<xref rid="R13" ref-type="bibr">13</xref>] and proportionality[<xref rid="R23" ref-type="bibr">23</xref>] that are scale-invariant when analyzing a single dataset, but lose scale-invariance when analyzing multiomics datasets. This was shown in the context of identifying microbe-fungal interactions [<xref rid="R24" ref-type="bibr">24</xref>], which provided motivation to extend SPIEC-EASI [<xref rid="R14" ref-type="bibr">14</xref>] to handle multiomics datasets. We show that this approach does not work for microbe-metabolite interactions because of differences of measurement units between sequencing and mass spectrometry measurements (<xref rid="SD2" ref-type="supplementary-material">Supplementary materials</xref>). An alternative approach is to consider co-occurrence probabilities instead of correlations. Here, co-occurrence probabilities refer to the conditional probability of observing a metabolite given that a microbe was observed, thereby allowing us to identify the most likely microbe-metabolite interactions. To do this, we propose “mmvec”, (microbe-metabolite vectors), to learn these co-occurrence probabilities between microbes and metabolites (<xref rid="F1" ref-type="fig">Figure 1</xref>). Due to its scale-robustness properties, the microbial-metabolite relationships learned by mmvec are consistent between the absolute and relative abundances. The microbe-metabolite interactions can be ranked [<xref rid="R25" ref-type="bibr">25</xref>] and visualized through standard dimensionality reduction interfaces, enabling interpretable findings. The computations behind mmvec can take advantage of modern GPU architectures using Tensorflow [<xref rid="R26" ref-type="bibr">26</xref>], enabling scalable inference on large multiomics datasets. Furthermore, we provide evidence in two benchmarks and four case studies that mmvec outperforms existing statistical methods.</p>
  </sec>
  <sec id="S2">
    <label>3</label>
    <title>Results and Discussion</title>
    <p id="P10">We performed benchmarks comparing mmvec to Pearson, Spearman, SPIEC-EASI, SparCC and Proportionality [<xref rid="R23" ref-type="bibr">23</xref>] using a cystic fibrosis biofilm simulation. We then show that mmvec can resolve contradictory cyanobacteria-metabolite relationships in a desert soil biocrust wetting study. We also demonstrate recovery of known associations of <italic>P. aeruginosa</italic>-produced metabolites observed in cystic fibrosis [<xref rid="R27" ref-type="bibr">27</xref>]. Finally, we explore the relationships of microbiota and metabolic changes in mice fed a high fat diet [<xref rid="R28" ref-type="bibr">28</xref>] and inflammatory bowel disease [<xref rid="R29" ref-type="bibr">29</xref>], showing how this approach can be used to determine microbial origin of novel molecules even in extremely complex real-life biological systems with limited knowledge of existing associations.</p>
    <sec id="S3">
      <label>3.1</label>
      <title>Simulation benchmarks</title>
      <p id="P11">To compare mmvec performance to Pearson, Spearman, Proportionality, SparCC and SPIEC-EASI correlations, we used data from existing studies in which the relationships between microbes and metabolites were the central focus of investigation. One such study simulated spatial-temporal dynamics in a microbial biofilm [<xref rid="R27" ref-type="bibr">27</xref>]. The original study tested the hypothesis that the cystic fibrosis (CF) microbiome community within human lungs can be manipulated by altering its chemical environment. Changes in pH and oxygen saturation suppress the principal pathogen, <italic>P. aeruginosa</italic>, without using antibiotics, by promoting the growth of a community of fermenters that out-compete the pathogen. The simplicity of this system allowed the high-level ecological patterns to be modelled. In the original simulations, the interactions between two microbes (fermenters denoted by Θ<sub><italic>f</italic></sub> and <italic>P. aeruginosa</italic> denoted by Θ<sub><italic>p</italic></sub>) and multiple molecules were modeled using Monad kinetics and diffusion processes[<xref rid="R27" ref-type="bibr">27</xref>] (<xref rid="F2" ref-type="fig">Figure 2a</xref>).</p>
      <p id="P12">We simulated the measurement process for microbial DNA sequencing and untargeted mass spectrometry for metabolites as discussed in the Online Methods, providing ground truth information on their interactions. The model simulates interactions between <italic>P. aeruginosa</italic> and the fermenters, and their interactions with the environment. It also simulates known interactions between microbes and molecules, such as sugar consumption by fermenters and ammonia production by the pathogen. For example, the fermenters are positively associated with sugars and ammonium concentration, and negatively associated with inhibitor concentration; <italic>P. aeruginosa</italic> is positively associated with amino acids and pH.</p>
      <p id="P13">Therefore, we can test whether the top <italic>K</italic> metabolites associated with each microbe by each tool includes the correct microbe-metabolite interactions. <xref rid="F2" ref-type="fig">Figure 2c</xref> shows specificity and sensitivity for each tools as a function of <italic>K</italic>. In these simulations, random chance outperformed all of the tools except for mmvec and SPIEC-EASI, with mmvec performing the best. As shown in <xref rid="F2" ref-type="fig">Figure 2d</xref> and <xref rid="SD1" ref-type="supplementary-material">Figure S2</xref>, mmvec is the only method robust to scale deviations amongst the methods tested. This is critical for maintaining consistency between absolute and relative abundances, which can otherwise lead to inflated false positives and false negatives [<xref rid="R16" ref-type="bibr">16</xref>].</p>
    </sec>
    <sec id="S4">
      <label>3.2</label>
      <title>Soil biocrust wetting event case study</title>
      <p id="P14">Many studies produce inconsistent results that can be resolved with improved data analysis, especially in environmental and clinical settings. To test whether mmvec can resolve unexplained discrepancies in microbe-metabolite interactions across studies, we applied it to a study of biocrust wetting [<xref rid="R30" ref-type="bibr">30</xref>]. In this study, laboratory-based exometabolite patterns observed with bacterial isolates were reproduced in the environment. Specifically, in this work authors identified metabolites that were consumed and released by multiple biocrust isolates including <italic>Microcoleus vaginatus</italic> and two <italic>Bacillus</italic> strains [<xref rid="R31" ref-type="bibr">31</xref>], and compared these patterns with closely-related environmental taxa and metabolites observed in situ [<xref rid="R30" ref-type="bibr">30</xref>].</p>
      <p id="P15">While almost 70% of the examined microbe-metabolite relationships following the wetting event were validated [<xref rid="R30" ref-type="bibr">30</xref>], some contradicted the microbe-metabolite relationships observed in cultures [<xref rid="R31" ref-type="bibr">31</xref>]. These contradictions stemmed from Spearman correlations between <italic>M. vaginatus</italic> abundances and the observed metabolite abundances, but were resolved by mmvec (<xref rid="F3" ref-type="fig">Figure 3a</xref>).</p>
      <p id="P16">All metabolites released from the <italic>M. vaginatus</italic> isolate have higher conditional probabilities than the average metabolite following biocrust wetting, and are among the top 80 co-occurring metabolites with <italic>M. vaginatus</italic> (of 485 molecules total). This result supports the original finding that <italic>M. vaginatus</italic> actually releases these molecules after the wetting event. In contrast, Spearman labels 7 of 13 of these molecules with a negative correlation, indicating that these molecules were consumed by <italic>M. vaginatus</italic> rather than released, as originally stated in [<xref rid="R30" ref-type="bibr">30</xref>]. When the annotation detection rates amongst different statistical methodologies, mmvec has a substantially higher true positive rate as shown in <xref rid="F3" ref-type="fig">Figure 3b</xref>.</p>
      <p id="P17">The conflicting results between mmvec and Spearman could be explained by the growing microbial biomass and shift in available resources after wetting (<xref rid="F3" ref-type="fig">Figure 3 c</xref>, <xref rid="F3" ref-type="fig">d</xref>). Total biomass is expected to increase, because <italic>M. vaginatus</italic> releases metabolites that enable the growth of many other microbes. Because DNA sequencing can only measure proportions, the growth in other microbes could cause the proportions of <italic>M. vaginatus</italic> to decrease, leading to a misleading anti-correlation with 4-guanidinobutanoate (<xref rid="F3" ref-type="fig">Figure 3d</xref>). However, it is not possible to infer whether <italic>M. vaginatus</italic> is decreasing in abundance [<xref rid="R25" ref-type="bibr">25</xref>] or 4-guanidinobutanoate is increasing in abundance.</p>
      <p id="P18">The change in the total biomass and the total available resources could explain the contradiction between the Spearman correlations and the isolate results. <italic>M. vaginatus</italic> likely grows at a slower rate relative to other microbes that benefit from the metabolite release. Because mmvec does not rely on knowledge of the total biomass or normalize to relative abundance, these contradictions are avoided.</p>
    </sec>
    <sec id="S5">
      <label>3.3</label>
      <title>Cystic Fibrosis case study</title>
      <p id="P19">To further validate if mmvec can detect known microbe-metabolite interactions in a biological setting, we re-analyzed a study on lung mucus microbiome of patients with cystic fibrosis [<xref rid="R27" ref-type="bibr">27</xref>, <xref rid="R32" ref-type="bibr">32</xref>]. Cystic fibrosis has been shown to be dominated by two major groups of microbes, anaerobes and pathogens that occupy unique niches, and their interactions are defined by the environment. Anaerobes dominate in low oxygen and low pH environments, while pathogens, in particular <italic>P. aeruginosa</italic>, dominate in the opposite conditions [<xref rid="R27" ref-type="bibr">27</xref>]. Mmvec clearly separates anaerobes and pathogens (<xref rid="F4" ref-type="fig">Figure 4a</xref>), with known anaerobic microbes (<italic>Veillonella</italic>, <italic>Fusobacterium</italic>, <italic>Prevotella</italic> and <italic>Streptococcus</italic>) on the left, and notable pathogens, such as <italic>P. aeruginosa</italic>, on the right.</p>
      <p id="P20"><italic>P. aeruginosa</italic> is known to produce small-molecule virulence factors [<xref rid="R33" ref-type="bibr">33</xref>]. In the original study, based on annotations from GNPS[<xref rid="R34" ref-type="bibr">34</xref>], the bacterium was found to produce six molecules: 4-hydroxy-2-heptylquinoline (HHQ), Pyocyanin (PYO), Phenazine-1-carboxylic acid (PCA), 2-nonyl-4-hydroxy-quinoline (NHQ), 2-heptyl-3,4-dihydroxyquinoline (PQS, Pseudomonas quinolone signal) and Pyochelin [<xref rid="R27" ref-type="bibr">27</xref>]. As shown in <xref rid="F4" ref-type="fig">Figure 4a</xref>, mmvec identifies these molecules with a high co-occurrence probability with <italic>P. aeruginosa</italic>. Mmvec also identifies a cluster of rhamnolipids likely produced by <italic>P. aeruginosa</italic>. Rhamnolipids are well characterized and are an important virulence factors for <italic>P. aeruginosa</italic>, contributing to biofilm development, motility on surfaces and antagonistic interactions with host inflammatory cells [<xref rid="R35" ref-type="bibr">35</xref>, <xref rid="R36" ref-type="bibr">36</xref>]. These rhamnolipids were not identified in the original study [<xref rid="R27" ref-type="bibr">27</xref>]. The annotations for these compounds have been estiblished using GNPS [<xref rid="R34" ref-type="bibr">34</xref>].</p>
      <p id="P21">There is a negative correlation between the first principal component learned from mmvec and the metabolites log-fold change across the oxygen gradient (<xref rid="F4" ref-type="fig">Figure 4b</xref>) (Pearson r=−0.59, p-value 1.8×10<sup>−44</sup>, n=442 molecules), which is consistent with the findings in the original work. No such correlation between the oxygen gradient and the first microbial principal component was found by Pearson (r=0.11, p=0.16, n=138 microbes). There exist two notable microbes on opposing ends of the first microbial principal component: <italic>P. aeruginosa</italic>, a known pathogen, and <italic>Streptococcus</italic>, a known anaerobe. The top 100 metabolites that are specific to <italic>P. aeruginosa</italic> and <italic>Streptococcus</italic> are shown to have drastically different profiles in samples where <italic>P. aeruginosa</italic> and <italic>Streptococcus</italic> were the most abundant species (<xref rid="F4" ref-type="fig">Figure 4d</xref>,<xref rid="F4" ref-type="fig">e</xref>) (logratio t-test=6.51, p=4.4×10<sup>−8</sup>, n=49 samples). This provides evidence that in the context of this study, the metabolomic profiles can be largely influenced by the most abundant microbes, a notion that has important implications for understanding CF etiology. To further support this, the learned metabolite conditional probabilities for <italic>P. aeruginosa</italic> can be used to predict the metabolite proportions in the 41 samples where <italic>P. aeruginosa</italic> is the most abundant taxa. The predicted <italic>P. aeruginosa</italic> metabolite profiles alone can explain 10% of the metabolite variation in these samples (r=0.319, p=1.18×10<sup>−11</sup>, n=442 molecules).</p>
      <p id="P22">Of 14 quinolone molecules known to be produced by <italic>P. aeruginosa</italic>, Pearson correlation detected 9 with <italic>p</italic>&lt;0.05 without FDR correction, and only 5 with FDR correction. For example, Pyocyanin, does not appear related to <italic>P. aeruginosa</italic> by the raw proportions (r=0.158, FDR-corrected pvalue=0.089, rank=96, n=172 samples), but is ranked 34th most associated with <italic>P. aeruginosa</italic> by mmvec (<xref rid="SD1" ref-type="supplementary-material">Figure S3c</xref>), consistent with culturing experiments that demonstrate that <italic>P. aeruginosa</italic> produces this molecule [<xref rid="R37" ref-type="bibr">37</xref>]. 18 rhamnolipids are among the top 25 metabolites most associated with <italic>P. aeruginosa</italic> by mmvec, and have higher ranks with mmvec than with Pearson correlation (<xref rid="SD1" ref-type="supplementary-material">Figure S3b</xref>).</p>
    </sec>
    <sec id="S6">
      <label>3.4</label>
      <title>Effects of high fat diet in murine model case study</title>
      <p id="P23">We then tested whether mmvec could determine the microbial origin of specific molecules in a complex biological system. We recently discovered a new kind of bile acid, where cholate is conjugated to amino acids other than glycine and taurine [<xref rid="R38" ref-type="bibr">38</xref>]. These molecules increased in abundance with high-fat diet in humans. We determined that these molecules are microbially-made since they were present in specific pathogen free, but not in germ free mice. We therefore set out to identify candidate producers. We were able to confirm that one of these bile acids, cholate phenylalanine amidate, was associated with high-fat diet in well-controlled study that investigated the development of non-alcoholic fatty liver disease (NAFLD), cirrhosis, and hepatocarcinoma (HCC) in a mouse model [<xref rid="R28" ref-type="bibr">28</xref>]. When re-analyzing these datasets for differential abundances via multinomial regression, the strong association of the novel bile acid with HFD became immediately apparent. The use of mmvec showed distinct associated groups of microbes and HFD (<xref rid="F5" ref-type="fig">Figure 5a</xref>) and a clear stratification of the mass spectrometry data according to diet (<xref rid="F5" ref-type="fig">Figure 5b</xref>). Several <italic>Clostridium spp.</italic> correlated with the cholate phenylalanine conjugate. Indeed, we showed that <italic>Clostridium spp.</italic> were found to produce this bile acid [<xref rid="R38" ref-type="bibr">38</xref>]. This result demonstrates mmvec’s ability to streamline the discovery of microbes that produce specific molecules of interest <italic>in vivo</italic>.</p>
    </sec>
    <sec id="S7">
      <label>3.5</label>
      <title>Microbe-metabolite interactions in Inflammatory Bowel Disease</title>
      <p id="P24">Finally, microbe-metabolite interactions were investigated for samples of IBD patients generated under the integrative Human Microbiome Project [<xref rid="R29" ref-type="bibr">29</xref>]. The role of the microbiome in IBD is acknowledged, but still poorly understood. The original study uncovered shifts in metabolomic and microbial profiles associated with the IBD. In particular, levels of carnitines and bile acids were shown to be affected [<xref rid="R29" ref-type="bibr">29</xref>]. Using mmvec we confirmed the core findings in the previous study, such as the co-occurrence between <italic>R. hominis</italic> and multiple carnitines, including previously noted C20, which have anti-inflammatory properties (<xref rid="F6" ref-type="fig">Figure 6a</xref>) [<xref rid="R29" ref-type="bibr">29</xref>]. We also found high correlation of <italic>Klebsiella spp.</italic> with IBD status and that it co-occurs with high probability with several bile acids (<xref rid="F6" ref-type="fig">Figure 6b</xref>). Although <italic>Klebsiella</italic> itself does not produce these compounds, some pathogens (including <italic>Klebsiella</italic>) are known to be resistant to bile acids [<xref rid="R39" ref-type="bibr">39</xref>]. Excessive production of some bile acids and bile acid malabsorption can lead to overabundance of bile acids, which is a hallmark of IBD [<xref rid="R40" ref-type="bibr">40</xref>], although the exact mechanisms remain unknown. The ability of <italic>Klebsiella</italic> to thrive in concentrated bile acid environments is consistent with the high co-occurrence probabilities shown in <xref rid="F6" ref-type="fig">Figure 6b</xref>. We also noted that three <italic>Klebsiella</italic> species are the top drivers of the IBD-associated molecules (<xref rid="F6" ref-type="fig">Figure 6c</xref>). It is important to delineate different reasons for co-occurrence. Unlike <italic>Klebsiella</italic>, <italic>Clostridium</italic> species are known for bile acid manipulation, including production of bile that can germinate <italic>Clostridium difficile</italic> spores or that have anti-microbial properties [<xref rid="R41" ref-type="bibr">41</xref>, <xref rid="R42" ref-type="bibr">42</xref>].</p>
      <p id="P25">Therefore, it is possible that in case of <italic>Clostridia</italic>, the existing co-occurrences (<xref rid="F6" ref-type="fig">Figure 6b</xref>) are due to actual biosynthesis of the metabolites by the microbial species indicated rather than ability to withstand them.</p>
      <p id="P26">In addition to recapitulating reported findings, mmvec also yielded previously undetected relationships. The major microbe that was found to be associated with healthy patients is <italic>Propionibacteriaceae</italic>, which was not detected in Price et al 2019 (<xref rid="F6" ref-type="fig">Figure 6cd</xref>). This relationship is corroborated by other published studies. In one study, it has been shown that some members of the <italic>Propionibacterium</italic> genus produce 1.4-Dihydroxy-2-naphthoic acid (DHNA), a growth stimulator for bacteria such as <italic>Bifidobacterium</italic> that are thought to reduce the symptoms of IBD [<xref rid="R43" ref-type="bibr">43</xref>]. Also, in a survey of <italic>in vivo</italic> vs. <italic>in vitro</italic> bacterial activity, <italic>Probionibacterium freudenreichii</italic> was shown to play an immunomodulatory role in the context of an ulcerative colitis mice model [<xref rid="R44" ref-type="bibr">44</xref>]. In another study it was shown that <italic>Propionibacterium freudenreichii</italic> is a viable core component in an anti-inflammatory probiotic fermented dairy product [<xref rid="R45" ref-type="bibr">45</xref>]. The members of this family have been considered beneficial for intestinal immunoregulation; <italic>Propionibacteriaceae</italic> have been observed to be enriched in human breast milk and have been shown to restore Th17 differentiation [<xref rid="R46" ref-type="bibr">46</xref>]. Thus, it appears that the existing knowledge supports the statistically-inferred interaction uncovered by mmvec, but not identified in the published analysis of the dataset.</p>
    </sec>
  </sec>
  <sec id="S8">
    <label>4</label>
    <title>Conclusion</title>
    <p id="P27">In both simulation benchmarks and annotated dataset, mmvec shows promise for inferring microbe-metabolite interactions from multiomics datasets. Our benchmarks suggest that mmvec outperforms all existing tools that aim to infer interactions between paired microbe-metabolite abundance datasets, both in simulations and in experimental data. In the biocrust wetting experiment, mmvec resolved conflicting findings between the <italic>in vitro</italic> validated <italic>M. vaginatus</italic> released metabolites and the sequencing/mass spectrometry analysis of environmental samples. In the cystic fibrosis study, mmvec can reliably identify all of the experimentally determined <italic>P. aeroginosa</italic>-produced molecules of interest. We show in the example of bile acid production that mmvec enables exploratory analysis in complex biological systems and streamlined discovery of the microbial origin of specific metabolites. Finally, mmvec was able to identify the strongest microbial contributions to the metabolite abundances in the IBD study, where one of those microbes was missed in the original study.</p>
    <p id="P28">In light of these findings, the current methodology still has limitations. It remains unclear how to access statistical significance of an interaction using co-occurrence probabilities. Similarly, confidence intervals for the strength of each microbe-metabolite interaction can not yet be calculated. Furthermore, more theoretical work will be required to handle continuous-valued inputs.</p>
    <p id="P29">The concepts outlined here should generalize beyond microbe-metabolite interactions to handle other paired multi-omic data types, provided that the input dataset is made up of counts (as in metagenomics, transcriptomics, etc.). With the exponential growth of multiomics datasets, there is much potential to use these methods to reveal microbial metabolism, including for microbes that are not cultivable in the laboratory. Approaches utilizing co-occurrence probabilities have the potential to enable more targeted experimental assays, accelerating the discovery of microbe-metabolite interactions, paving the way towards new ecosystems engineering approaches in clinical, environmental and industrial applications.</p>
  </sec>
  <sec id="S9">
    <label>10</label>
    <title>Methods</title>
    <sec id="S10">
      <label>10.1</label>
      <title>Mmvec neural network architecture</title>
      <p id="P30">The development of our proposed neural network was inspired by applications in natural language processing. The underlying model can also be referred to as a bi-loglinear multinomial regression. Our mmvec model posits an assumed generative process for the data, which leads to an inference algorithm to recover the model’s parameters from multi-omics data. The model’s assumed generative model for metabolite ν, microbe μ and sample <italic>k</italic> given as follows.</p>
      <p id="P31">First generate microbe vector <bold>u</bold><sub>μ</sub> for microbe μ∈{1,...<italic>N</italic>} and metabolite vectors <bold>v</bold><sub><bold>ν</bold></sub> for metabolite ν∈{1,...<italic>M</italic>},
<disp-formula id="FD1"><mml:math display="block" id="M1" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">u</mml:mi><mml:mi mathvariant="normal">μ</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="2em"/><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mi mathvariant="bold">ν</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
These vectors are length <italic>p</italic>, corresponding to the number of latent vectors dimensions. Each of these vectors are drawn from a normal prior centered around zero and a diagonal covariance matrix with variances σ<sub><italic>u</italic></sub> and σ<sub><italic>v</italic></sub>, namely to serve regularization purposes and avoid overfitting. For a given microbial sample <italic>x</italic><sub><italic>k</italic></sub>, the models generative process draws a single microbe from a single draw from the categorical distribution
<disp-formula id="FD2"><mml:math display="block" id="M2" overflow="scroll"><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi><mml:mo>∼</mml:mo><mml:mi>C</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>g</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi mathvariant="bold">k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
That microbe μ can be used to index <italic>U</italic> in order to generate conditional probabilities <bold>q</bold><sub><bold>μ</bold></sub>
<disp-formula id="FD3"><mml:math display="block" id="M3" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">ν</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="normal">μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mi mathvariant="normal">ν</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mi mathvariant="bold">u</mml:mi><mml:mi mathvariant="normal">μ</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">ν</mml:mi><mml:mrow><mml:mi mathvariant="normal">ν</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:mi>exp</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mi mathvariant="bold">j</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mi mathvariant="bold">u</mml:mi><mml:mi mathvariant="normal">μ</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">ν</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>
<disp-formula id="FD4"><mml:math display="block" id="M4" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">q</mml:mi><mml:mi mathvariant="bold">μ</mml:mi></mml:msub><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="normal">ν</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="normal">μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="normal">ν</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="normal">μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></disp-formula>
Here, <italic>v</italic><sub><italic>j</italic></sub>0 + <italic>u</italic><sub>μ0</sub> are row and column biases, which are required to accurately estimate the conditional probabilities. The above transformation is the softmax transform [<xref rid="R47" ref-type="bibr">47</xref>] to compute probabilities from real-valued quantities. This transformation is also known as the inverse clr transform [<xref rid="R48" ref-type="bibr">48</xref>], which enforces scale invariance as shown in the simulations. In the mmvec model’s generative process, these conditional probabilities generate the metabolite abundances <bold>y</bold><sub><bold>k</bold></sub> for a given sample <italic>k</italic> through a multinomial distribution.
<disp-formula id="FD5"><mml:math display="block" id="M5" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">y</mml:mi><mml:mi mathvariant="bold">k</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>M</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">q</mml:mi><mml:mi mathvariant="bold">μ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>n</italic> is the total metabolite abundances across sample <italic>k</italic>. It is important to note that metabolite abundances themselves are not counts, but rather a continuous representation of molecule counts. We make the simplifying assumption that these continuous valued abundances can be approximated by Multinomial count models.</p>
      <p id="P32">This model bears resemblance to how word2vec estimates word probabilities conditioned on a single particular word [<xref rid="R49" ref-type="bibr">49</xref>]. There are a couple of majors differences to be considered. First, in the original application of word2vec, a skipgram was proposed. Skipgrams [<xref rid="R49" ref-type="bibr">49</xref>] have been designed to account for the sequential nature of text. There is no such sequential nature with microbiome or metabolite samples, the only ordering information that is known is the sample membership. As a result, the skipgrams can be replaced using multinomial sampling, where a single microbe is randomly sampled from a microbiome sample at each gradient descent step.</p>
      <p id="P33">Second, in the original word2vec application a single input/output word pair were evaluated at each gradient descent step, which is required to incorporate the contextual information of words within sentences. In the application of multiomics, this is unnecessasrily complicated, since there is no such contextual with regards to microbes and metabolites. Instead, all of the metabolite abundances can be simultaneously evaluated for each gradient descent step, ultimately speeding up computations. Specifically, these metabolite abundances are simultaneously considered in order to estimate the conditional probabilities <italic>q</italic><sub><italic>k</italic></sub> for the given microbial count <italic>u</italic><sub><italic>jk</italic></sub>. From these conditional probabilities, the metabolite abundances <italic>y</italic><sub><italic>k</italic></sub> are generated from a Multinomial distribution. This process is repeated across all of the microbial reads. To show that <italic>p</italic>(ν|μ) truly approximates the probability of observing a metabolite given a microbe, we first need to make the simplifying assumption that the conditional distribution of a metabolite given the presence of a single microbe also follows a multinomial distribution as follows
<disp-formula id="FD6"><mml:math display="block" id="M6" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">μ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi mathvariant="normal">μ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>
Where <italic>y</italic> is the vector of observed metabolites, <italic>Y</italic> is the random variable modeling metabolite abundances, <italic>X</italic> is a random variable modeling microbe abundances, <italic>x</italic> is a vector of observed microbes and μ is a single microbe. Given these modeling assumptions, we can parameterize the conditional Multinomial distributions with embedding vectors as described above. This estimation procedure can be reformulated as a matrix factorization, where the conditional probability matrix is decomposed into two weight matrices <bold>U</bold> and <bold>V</bold>, which are comprised of microbe-metabolite vectors as follows
<disp-formula id="FD7"><mml:math display="block" id="M7" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">U</mml:mi><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">u</mml:mi><mml:mn mathvariant="bold">0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">u</mml:mi><mml:mn mathvariant="bold">1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mn>...</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">u</mml:mi><mml:mi mathvariant="bold">N</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mspace width="1em"/><mml:mi mathvariant="bold">V</mml:mi><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mn mathvariant="bold">0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mn mathvariant="bold">1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mn>...</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mi mathvariant="bold">M</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
Here <bold>U</bold>∈<italic>R</italic><sup><italic>N</italic>×<italic>p</italic></sup> and <bold>V</bold>∈<italic>R</italic><sup>(<italic>M</italic>−1)×<italic>p</italic></sup> represents the corresponding embeddings for <italic>N</italic> microbes and <italic>M</italic> metabolites. The number dimensions <italic>p</italic> for both <bold>U</bold> and <bold>V</bold> as well as the priors are specified by the user, but can also be evaluated during cross-validation. The biases <bold>u</bold><sub><bold>0</bold></sub> and <bold>v</bold><sub><bold>0</bold></sub> are critical for estimating accurate co-occurrence probabilities, as suggested by similar methodologies used in recommender systems [<xref rid="R50" ref-type="bibr">50</xref>]. The <bold>U</bold> and <bold>V</bold> matrices are estimated through maximum a posteriori (MAP) estimation using ADAM [<xref rid="R51" ref-type="bibr">51</xref>] with the following log-posterior
<disp-formula id="FD8"><mml:math display="block" id="M8" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mi>Y</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula>
<disp-formula id="FD9"><mml:math display="block" id="M9" overflow="scroll"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi mathvariant="normal">μ</mml:mi></mml:munder><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">ϱ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">ϱ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
<disp-formula id="FD10"><mml:math display="block" id="M10" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi mathvariant="normal">ν</mml:mi></mml:munder><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">ϱ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">ν</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">ϱ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">σ</mml:mi><mml:mi mathvariant="normal">ν</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
<disp-formula id="FD11"><mml:math display="block" id="M11" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mi>Y</mml:mi></mml:msub><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mi>M</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">y</mml:mi><mml:mi mathvariant="bold">k</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold">q</mml:mi><mml:mi mathvariant="bold">μ</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
Within a single iteration of stochastic gradient descent a single microbial sequence <italic>i</italic> is randomly drawn and compared to a complete set of metabolite abundances <italic>y</italic><sub><italic>i</italic></sub> for that given sample. If there are a total of <italic>R</italic> microbial reads across all of the microbial samples, there will be <italic>R</italic> iterations for a complete epoch over the microbial dataset. This means that the running time of this training process is <italic>O</italic>(<italic>RM</italic>) for a single epoch. Cross validation can be performed by holding out samples measuring the predictive power by looking at the sum of squares errors. Predictions can be made as follows
<disp-formula id="FD12"><mml:math display="block" id="M12" overflow="scroll"><mml:mrow><mml:mi>S</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:mi>s</mml:mi><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">V</mml:mi><mml:msub><mml:mi mathvariant="bold">U</mml:mi><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋅</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
Where the predictive metabolite abundances are compared to the holdout abundances <italic>y</italic><sub><italic>k</italic></sub> across all microbial reads <italic>i</italic> in the holdout samples <italic>k</italic>. <italic>m</italic><sub><italic>k</italic></sub> denotes the total metabolite abundances in sample <italic>k</italic></p>
    </sec>
    <sec id="S11">
      <label>10.2</label>
      <title>Microbe-metabolite vectors in simplicial coordinates</title>
      <p id="P34">Here, we will provide some insights behind the underlying geometry behind this neural network. Doing so will provide intuition behind the algebraic operations commonly applied in the context of word2vec, suggesting the possibility of performing similar tasks in the context of microbe-metabolite interactions. Furthermore, this will motivate the use of the Aitchison distance to quantify microbe-microbe and metabolite-metabolite interactions. Finally we will make a connection to topic modeling, providing another means to potentially interpret the latent dimensions in the model. The connection between the softmax and the inverse clr transform suggests that the inputs to this transform can be represented in clr coordinates. The softmax function and its corresponding inverse, the clr transform, is given as follows
<disp-formula id="FD13"><mml:math display="block" id="M13" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
<disp-formula id="FD14"><mml:math display="block" id="M14" overflow="scroll"><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mfrac><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>log</mml:mi><mml:mfrac><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
Since biases are incorporated into the mmvec model, by construction <italic>Q</italic>=<italic>UV</italic><sup><italic>T</italic></sup> is both row centered and column centered, meaning that the sum of rows are zero and the sum of the columns are zero. Given this the following holds</p>
      <p id="P35"><bold>Theorem:</bold> If <bold>Q</bold>=<bold>UV</bold> and <bold>1</bold><sub><bold>N</bold></sub><bold>Q</bold>=<bold>0</bold> and <bold>Q1</bold><sub><bold>M</bold></sub>=<bold>0</bold> then <bold>U1</bold><sub><bold>p</bold></sub>=<bold>0</bold> and <bold>V1</bold><sub><bold>p</bold></sub>=<bold>0</bold></p>
      <p id="P36">Suppose that there exists another solution <inline-formula><mml:math display="inline" id="M15" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">U</mml:mi><mml:msup><mml:mi mathvariant="bold">V</mml:mi><mml:mrow><mml:msup><mml:mo>*</mml:mo><mml:mi mathvariant="bold">T</mml:mi></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math display="inline" id="M16" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">V</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">V</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mn mathvariant="bold">1</mml:mn><mml:mi mathvariant="bold">M</mml:mi></mml:msub><mml:msubsup><mml:mi mathvariant="bold">λ</mml:mi><mml:mi mathvariant="bold">v</mml:mi><mml:mi mathvariant="bold">T</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and <bold>λ</bold><sub><bold>v</bold></sub>∈<italic>R</italic><sup><italic>p</italic></sup>. Then
<disp-formula id="FD15"><mml:math display="block" id="M17" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">V</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mn mathvariant="bold">1</mml:mn><mml:mi mathvariant="bold">M</mml:mi></mml:msub><mml:msubsup><mml:mi mathvariant="bold">λ</mml:mi><mml:mi mathvariant="bold">v</mml:mi><mml:mi mathvariant="bold">T</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p id="P37">Given that the rows of <bold>Q</bold> sum to 0, then
<disp-formula id="FD16"><mml:math display="block" id="M18" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">U</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">V</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mn mathvariant="bold">1</mml:mn><mml:mi mathvariant="bold">M</mml:mi></mml:msub><mml:msubsup><mml:mi mathvariant="bold">λ</mml:mi><mml:mi mathvariant="bold">v</mml:mi><mml:mi mathvariant="bold">T</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mn mathvariant="bold">1</mml:mn><mml:mi mathvariant="bold">M</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></disp-formula>
<disp-formula id="FD17"><mml:math display="block" id="M19" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">U</mml:mi><mml:msub><mml:mi mathvariant="bold">λ</mml:mi><mml:mi mathvariant="bold">v</mml:mi></mml:msub><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>0.</mml:mn></mml:mrow></mml:math></disp-formula></p>
      <p id="P38">This means that only the trivial solution <bold>λ</bold><sub><bold>v</bold></sub>=0 exists, therefore the rows of <bold>V</bold> do sum to 0.</p>
      <p id="P39">Using the same reasoning above, suppose that there exists another solution <bold>Q</bold>=<bold>U</bold>*<bold>V</bold><sup><bold>T</bold></sup> where <inline-formula><mml:math display="inline" id="M20" overflow="scroll"><mml:mrow><mml:msup><mml:mi mathvariant="bold">U</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mi mathvariant="bold">U</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mn mathvariant="bold">1</mml:mn><mml:mi mathvariant="bold">N</mml:mi></mml:msub><mml:msup><mml:mrow><mml:msub><mml:mi mathvariant="bold">λ</mml:mi><mml:mi mathvariant="bold">u</mml:mi></mml:msub></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> and <bold>λ</bold><sub><bold>u</bold></sub>∈<italic>R</italic><sup><italic>p</italic></sup>. Then
<disp-formula id="FD18"><mml:math display="block" id="M21" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">U</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mn mathvariant="bold">1</mml:mn><mml:mi mathvariant="bold">N</mml:mi></mml:msub><mml:msup><mml:mrow><mml:msub><mml:mi mathvariant="bold">λ</mml:mi><mml:mi mathvariant="bold">u</mml:mi></mml:msub></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi mathvariant="bold">V</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p id="P40">Given that the columns of <bold>Q</bold> sum to 0, then
<disp-formula id="FD19"><mml:math display="block" id="M22" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:msub><mml:mn mathvariant="bold">1</mml:mn><mml:mtext>N</mml:mtext></mml:msub></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">U</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mn mathvariant="bold">1</mml:mn><mml:mtext>N</mml:mtext></mml:msub><mml:msup><mml:mrow><mml:msub><mml:mi mathvariant="bold">λ</mml:mi><mml:mi mathvariant="bold">u</mml:mi></mml:msub></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi mathvariant="bold">V</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></disp-formula>
<disp-formula id="FD20"><mml:math display="block" id="M23" overflow="scroll"><mml:mrow><mml:mi>N</mml:mi><mml:msup><mml:mrow><mml:msub><mml:mi mathvariant="bold">λ</mml:mi><mml:mi mathvariant="bold">u</mml:mi></mml:msub></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">V</mml:mi><mml:mo>=</mml:mo><mml:mn>0.</mml:mn></mml:mrow></mml:math></disp-formula></p>
      <p id="P41">This means that only the trivial solution <bold>λ</bold><sub><bold>u</bold></sub>=0 exists, therefore the rows of <bold>U</bold> do sum to 0.</p>
      <p id="P42">Therefore the rows of both <bold>U</bold> and <bold>V</bold> must sum to zero if <bold>U</bold> and <bold>V</bold> are non-trivial.</p>
      <p id="P43">As noted in previous compositional data analysis work, the sum of the components within a vector in clr coordinates is zero. Given that the row vectors within <italic>U</italic> and <italic>V</italic> both sum to zero, that suggests that each of these vectors are also in clr coordinates. This means the following properties are satisfied</p>
      <sec id="S12">
        <title>Topic proportions</title>
        <p id="P44">Since the <italic>U</italic> and <italic>V</italic> row vectors are in clr coordinates, that implies that these row vectors can be directly converted to <italic>p</italic>-dimensional proportions, yielding a similar interpretation to topics used in models such as LDA [<xref rid="R52" ref-type="bibr">52</xref>, <xref rid="R53" ref-type="bibr">53</xref>].</p>
      </sec>
      <sec id="S13">
        <title>Linearity</title>
        <p id="P45">Vectors in clr coordinates are known to satisfy linearity, namely
<disp-formula id="FD21"><mml:math display="block" id="M24" overflow="scroll"><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">α</mml:mi><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="normal">α</mml:mi><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>
for α∈<italic>R</italic>, <italic>x</italic>∈<italic>S</italic><sup><italic>p</italic></sup> and <italic>y</italic>∈<italic>S</italic><sup><italic>p</italic></sup>. This linearity property was leveraged in word2vec models to perform analogy reasoning. Since both microbes and metabolites are in clr coordinates, it should be possible to categorize microbe-microbe and metabolite-metabolite interactions.</p>
      </sec>
      <sec id="S14">
        <title>Isometry</title>
        <p id="P46">The clr transform is distance preserving, meaning that the Aitchison distance on proportions is equivalent to the Euclidean distance on clr vectors. This provides motivation for using Euclidean distances to compute microbe-microbe and metabolite-metabolite similarities.</p>
      </sec>
    </sec>
    <sec id="S15">
      <label>10.3</label>
      <title>Visualization through biplots</title>
      <p id="P47">Visualization techniques from compositional data analysis can aid with interpretation [<xref rid="R54" ref-type="bibr">54</xref>, <xref rid="R55" ref-type="bibr">55</xref>]. <bold>U</bold> and <bold>V</bold> can be visualized as factors within a biplot to visualize the microbe-metabolite embeddings on a single plot. The first two latent dimensions of <bold>U</bold> represent microbial coordinates on a 2D scatter plot and the first two latent dimensions of <bold>V</bold> represent metabolite coordinates on a 2D scatter plot. Typically the coordinate from the <bold>V</bold> matrix are plotted as arrows from the origin in order to identify features that explain the variance in <bold>U</bold>. However, in our case studies, there are typically many more metabolites than microbes - so we opt to visualize the metabolites as points and microbes as arrows for a simpler visualization As suggested by the above theorem, the distance between points approximates the Aitchison distance between metabolites, and the distance between arrow tips approximates the Aitchison distance between microbes. As suggested in [<xref rid="R56" ref-type="bibr">56</xref>], the Aitchison distance is also equivalent to the variance of the log ratios, suggesting that microbe-microbe and metabolite-metabolite distances could also be interpreted as a measure of proportionality [<xref rid="R23" ref-type="bibr">23</xref>].</p>
    </sec>
    <sec id="S16">
      <label>10.4</label>
      <title>Benchmarks</title>
      <p id="P48">The simulated data was based on a cystic fibrosis biofilm model derived in Quinn et al [<xref rid="R27" ref-type="bibr">27</xref>] shown in Figure S12 in the paper. The biofilm model was built to explain how fermenters and <italic>P. aeruginosa</italic> responded to different concentrations of sugars, amino acids, pH, oxgygen and antibiotics across the Winogradsky column. These models solved for differential equations integrating Monad kinetics and diffusion processes and was run in Matlab using the code provided at <ext-link ext-link-type="uri" xlink:href="https://github.com/zhangzhongxun/WinCF_model_Code">https://github.com/zhangzhongxun/WinCF_model_Code</ext-link></p>
      <p id="P49">From this simulation, we only focus 2 microbes and 5 compounds. The two microbes are P. aeroginosa (Θ<sub><italic>p</italic></sub>) and fermenters (Θ<sub><italic>f</italic></sub>). The five compounds (SG), acids (F), ammonium (P), amino acids (SA) and inhibition molecules (I). In order to simulate a high dimensional dataset, each microbial taxon was split into 50 different subtaxa and each compound was split into 50 molecular subclasses. The partitioning procedure is given as follows
<disp-formula id="FD22"><mml:math display="block" id="M25" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mi mathvariant="bold">i</mml:mi></mml:msub><mml:mspace width="1em"/><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="3em"/><mml:msub><mml:mi mathvariant="bold">q</mml:mi><mml:mi mathvariant="bold">i</mml:mi></mml:msub><mml:mspace width="1em"/><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
<disp-formula id="FD23"><mml:math display="block" id="M26" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">o</mml:mi><mml:mrow><mml:mi mathvariant="bold">ij</mml:mi></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="normal">κ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mi mathvariant="bold">i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="2em"/><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mrow><mml:mi mathvariant="bold">ik</mml:mi></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="normal">η</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">q</mml:mi><mml:mi mathvariant="bold">i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <bold>p</bold><sub><bold>i</bold></sub> is a vector proportions representing how the subtaxa corresponding to <italic>j</italic> will be distributed in sample <italic>i</italic>. κ<sub><italic>ij</italic></sub> represents the absolute abundance of taxon <italic>j</italic> in sample <italic>i</italic>. <bold>o</bold><sub><bold>ij</bold></sub> represents a vector of the absolute abundances for all of the subtaxa corresponding to taxon <italic>j</italic>. These are the absolute abundances that are used for comparison in <xref rid="F2" ref-type="fig">Figure 2</xref>.</p>
      <p id="P50">Here we use the <italic>ilr</italic><sup>−1</sup> transform to generate proportions from a multivariate normal distribution. Here the multivariate normal distribution is centered around zero, and the covariance matrix σ<sub><italic>o</italic></sub><bold>I</bold> has only a constant diagonal structure with a tunable parameter σ<sub><italic>o</italic></sub> specifying the variability of the partitioning procedure. Larger values of σ<sub><italic>o</italic></sub> will cause the allocations of the microbes to be increasingly uneven.</p>
      <p id="P51">The partitioning procedure is identical for the metabolites. <bold>q</bold><sub><bold>i</bold></sub> is a vector proportions representing how the subcompounds corresponding to <italic>k</italic> will be distributed in sample <italic>i</italic>. η<sub><italic>ik</italic></sub> represents the absolute abundance of compound <italic>k</italic> in sample <italic>i</italic>. <bold>c</bold><sub><bold>ik</bold></sub> represents a vector of the absolute abundances for all of the subtaxa corresponding to compound <italic>k</italic>. The multivariate normal distribution used to generate the proportions is centered around zero. The covariance matrix σ<sub><italic>c</italic></sub><bold>I</bold> has only a constant diagonal structure with a tunable parameter σ<sub><italic>c</italic></sub> specifying the variability of the partitioning procedure. Larger values of σ<sub><italic>c</italic></sub> will cause the allocations of the metabolites to be increasingly uneven.</p>
      <p id="P52">Once the subtaxa and subcompounds absolute abundances have been simulated, the microbial relative counts and metabolite abundances are simulated. The sampling procedure is performed as follows
<disp-formula id="FD24"><mml:math display="block" id="M27" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="normal">ζ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="1.5em"/><mml:mo>∼</mml:mo><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">τ</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="5em"/><mml:msub><mml:mi mathvariant="normal">ω</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="1.5em"/><mml:mo>∼</mml:mo><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">τ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula id="FD25"><mml:math display="block" id="M28" overflow="scroll"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="1.5em"/><mml:mo>∼</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="normal">ζ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.25em"/><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">ε</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="2em"/><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="1.5em"/><mml:mo>∼</mml:mo><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="normal">ω</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.25em"/><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mi mathvariant="bold">i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">ε</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
The total sequencing depths and total intensities for sample <italic>i</italic> are draw from Lognormal distributions with means parameterized by <italic>n</italic> and <italic>m</italic> and overdispersion parameters τ<sub><italic>o</italic></sub> and τ<sub><italic>c</italic></sub>. We chose to use the lognormal distribution for three reasons. First, the lognormal distribution models overdispersion. Second, the lognormal distribution has a simpler interpretation than other overdispersed distributions such as the negative binomial, since the parameters can be directly interpreted as a normal distribution and consequentially has a compositional interpretation due to its connection to the ilr transform. Finally, the lognormal distribution commonly used for modeling in the the ecological literature in the context of studying species populations in Niche theory and Neutral theory, leading to a natural biological interpretation.</p>
      <p id="P53">Once the total sequencing depth and the total intensities are sampled, the microbial sequencing counts and metabolite abundances are then sampled. A Poisson lognormal distribution is used to generate the microbial counts from the microbial proportions <italic>C</italic>(<bold>o</bold><sub><bold>i</bold></sub>) scaled by the sequencing depth ζ<sub><italic>i</italic></sub>. The counts are sampled with error ε<sub><italic>o</italic></sub>. A Lognormal distribution is used to generate the metabolite abundances from metabolite proportions <italic>C</italic>(<bold>c</bold><sub><bold>i</bold></sub>) scaled by the total intensity ω<sub><italic>i</italic></sub>. The abundances are sampled with error ε<sub><italic>c</italic></sub>. All of the code used to generate the benchmarks can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/knightlab-analyses/multiomic-cooccurrences">https://github.com/knightlab-analyses/multiomic-cooccurrences</ext-link>.</p>
    </sec>
    <sec id="S17">
      <label>10.5</label>
      <title>Software workflows</title>
      <p id="P54">To facilitate utilization of the mmvec tool, we have developed two different user facing interfaces. First, we have developed a qiime2 plugin [<xref rid="R57" ref-type="bibr">57</xref>], where mmvec can be run using a simple command line interface. This interface is complemented using [<xref rid="R26" ref-type="bibr">26</xref>], where users can monitor convergence rates for their models in real-time and evaluate how different parameters will affect their model fit (<xref rid="SD1" ref-type="supplementary-material">Figure S4</xref>). Second, we have integrated mmvec into the Global Natural Product Social Molecular Networking (GNPS) platform that can be accessed by the public. The online interface through GNPS resolves several usability issues. First, GNPS facilitates import of metabolomics data into qiime2 by pre-processing, importing, and sample renaming, This is performed as part of the standard metabolomics analysis at GNPS (e.g. molecular networking and feature-based molecular networking). Second, since it is possible to both download and re-use outputs of workflows run at GNPS directly, it is straightforward to select the GNPS qza and molecule annotations needed for mmvec. The user will need to upload the accompanying feature and taxonomy data for qiime2 and the analysis will be begin. Once the workflow completes, the biplots can be viewed directly in the browser and other outputs (e.g. ranks) are available for download (<xref rid="SD1" ref-type="supplementary-material">Figure S5</xref>).</p>
      <p id="P55">The mmvec implementation is written using Tensorflow and can leverage GPUs for computation. The number of gradient descent iterations is specified by the user and model fit diagnostics can be monitored in real time using Tensorboard. The runtime of mmvec across 16 cores can take multiple days until a model convergence reaches convergence. With GPUs, the running time is reduced to a few hours. Using a Telsa GPU, the model can reach convergence within 4 hours on the IBD dataset comprised of 562 microbial taxa, 26,966 metabolite features and 400 samples. However, there is a trade-off of accuracy and running time. More accurate models require smaller learning rates and may take longer to run.</p>
    </sec>
    <sec id="S18">
      <label>10.6</label>
      <title>Data Analysis</title>
      <p id="P56">Due to the overwhelming sparsity in microbiome datasets, some filtering is required in order to infer microbe-metabolite interactions. We chose to filter out microbes that appear in less than 10 samples, since these microbes don’t have enough information to infer which metabolites are co-occurring with them. In other words the mmvec model has too many degrees of freedom to perform inference on these microbes. For the cystic fibrosis study, there were 172 samples and after filtering there were 138 unique microbial taxa and 462 metabolite features. For the biocrust soils study, there were 19 samples and after filtering there were 466 unique microbial taxa and 85 metabolite features. For the murine high fat diet study, there were 434 samples and after filtering there were 902 microbes and 11978 metabolites. For the IBD dataset, there were 13920 features in the c18 LCMS dataset, 26966 features in the c8 LCMS dataset and 562 taxa. Cross validation was performed across all studies to evaluate overfitting. In the desert biocrust soils experiment, 1 sample out of 19 samples was randomly chosen to be left out for cross-validation. In all of the other studies, 10 samples were randomly chosen to be left out for cross-validation. All of the analyses can be found under <ext-link ext-link-type="uri" xlink:href="https://github.com/knightlab-analyses/multiomic-cooccurences">https://github.com/knightlab-analyses/multiomic-cooccurences</ext-link>.</p>
    </sec>
    <sec sec-type="data-availability" id="S19">
      <label>10.7</label>
      <title>Data availability</title>
      <p id="P57">The cystic fibrosis sequencing and metadata data can be found under <ext-link ext-link-type="uri" xlink:href="http://qiita.microbio.me/">http://qiita.microbio.me</ext-link>; study id: 10863. The corresponding GNPS analysis can be accessed at <ext-link ext-link-type="uri" xlink:href="http://gnps.ucsd.edu/ProteoSAFe/status.jsp?task=34d825dbf4e9466e81d809faf814995b">http://gnps.ucsd.edu/ProteoSAFe/status.jsp?task=34d825dbf4e9466e81d809faf814995b</ext-link>.</p>
      <p id="P58">The biocrust soils data was retrieved from the supplemental section in Swenson et al [<xref rid="R30" ref-type="bibr">30</xref>]. The High fat diet murine model case study 16S rRNA data can be found under <ext-link ext-link-type="uri" xlink:href="http://qiita.microbio.me/">http://qiita.microbio.me</ext-link>; study id: 10856. The High fat diet murine model case study are publicly available at <ext-link ext-link-type="uri" xlink:href="https://massive.ucsd.edu/">https://massive.ucsd.edu/</ext-link> at MassIVE ID MSV000080918. The GNPS analysis for this study can be accessed at <ext-link ext-link-type="uri" xlink:href="https://gnps.ucsd.edu/ProteoSAFe/status.jsp?task=977d85bba47b4e96bf69872b961b8edd">https://gnps.ucsd.edu/ProteoSAFe/status.jsp?task=977d85bba47b4e96bf69872b961b8edd</ext-link></p>
      <p id="P59">The IBD data used can be found under <ext-link ext-link-type="uri" xlink:href="https://ibdmdb.org/">https://ibdmdb.org</ext-link>.</p>
      <p id="P60">See Life Sciences Reporting Summary for more details on the experimental design.</p>
    </sec>
    <sec id="S20">
      <label>10.7</label>
      <title>Software availability</title>
      <p id="P61">The software implementing the mmvec algorithm can be found under <ext-link ext-link-type="uri" xlink:href="https://github.com/biocore/mmvec">https://github.com/biocore/mmvec</ext-link>.</p>
      <p id="P62">Differential abundance analyses in the high fat diet study was performed using L2-regularized multinomial regression using software available at <ext-link ext-link-type="uri" xlink:href="https://github.com/biocore/songbird">https://github.com/biocore/songbird</ext-link></p>
      <p id="P63">The software used to build the multiomics network can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/mortonjt/multiomics_network">https://github.com/mortonjt/multiomics_network</ext-link>.</p>
      <p id="P64">Biplots were generated using Emperor [<xref rid="R58" ref-type="bibr">58</xref>].</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="SM1">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="SD1">
      <label>1</label>
      <media xlink:href="NIHMS1540415-supplement-1.docx" orientation="portrait" xlink:type="simple" id="d36e3283" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD2">
      <label>2</label>
      <media xlink:href="NIHMS1540415-supplement-2.pdf" orientation="portrait" xlink:type="simple" id="d36e3287" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="S21">
    <label>5</label>
    <title>Acknowledgements</title>
    <p id="P65">We would like to thank Vera Pawlowsky, Juan Jose Egozcue and Susan Holmes for their insights behind the geometry of this neural network model. In addition, we would also like to thank Nicholas Bokulich for their feedback and contributions on the mmvec software package. T.L.S., M.W.V.G and T.R.N greatly acknowledge funding from the Office Science Early Career Research Program, Office of Biological and Environmental Research, of the U.S. Department of Energy under contract number DE-AC02-05CH11231 to Lawrence Berkeley National Laboratory. This was in part supported by P41GM103484 Center for Computational Mass Spectrometry, Instrument support through NIH S10RR029121 and R03 CA211211 on reuse of metabolomics data. Y. V. B. is funded by the Janssen Human Microbiome Institute through a collaboration with the Center for Microbiome Innovation. J.T.M. was funded by NSF grant GRFP DGE-1144086. R. K. and S. J. S. have been funded by Janssen under grant number 20175015 and the Alfred P. Sloan Foundation under grant number G-2017-9838.</p>
  </ack>
  <fn-group>
    <fn fn-type="COI-statement" id="FN2">
      <label>7</label>
      <p id="P66">Competing interests</p>
      <p id="P67">Mingxun Wang is the founder of Ometa Labs LLC. None of the remaining authors have any competing interests.</p>
    </fn>
  </fn-group>
  <ref-list>
    <label>8</label>
    <title>References</title>
    <ref id="R1">
      <label>[1]</label>
      <mixed-citation publication-type="journal"><name><surname>Jansson</surname><given-names>Janet K</given-names></name> and <name><surname>Baker</surname><given-names>Erin S</given-names></name>. <article-title>A multi-omic future for microbiome studies</article-title>. <source>Nat Microbiol</source>, <volume>1</volume>(<issue>16049</issue>):<fpage>645</fpage>, <year>2016</year>.</mixed-citation>
    </ref>
    <ref id="R2">
      <label>[2]</label>
      <mixed-citation publication-type="journal"><name><surname>Noecker</surname><given-names>Cecilia</given-names></name>, <name><surname>Eng</surname><given-names>Alexander</given-names></name>, <name><surname>Srinivasan</surname><given-names>Sujatha</given-names></name>, <name><surname>Theriot</surname><given-names>Casey M</given-names></name>, <name><surname>Young</surname><given-names>Vincent B</given-names></name>, <name><surname>Jansson</surname><given-names>Janet K</given-names></name>, <name><surname>Fredricks</surname><given-names>David N</given-names></name>, and <name><surname>Borenstein</surname><given-names>Elhanan</given-names></name>. <article-title>Metabolic model-based integration of microbiome taxonomic and metabolomic profiles elucidates mechanistic links between ecological and metabolic variation</article-title>. <source>MSystems</source>, <volume>1</volume>(<issue>1</issue>):<fpage>e00013</fpage>–<lpage>15</lpage>, <year>2016</year>.</mixed-citation>
    </ref>
    <ref id="R3">
      <label>[3]</label>
      <mixed-citation publication-type="journal"><name><surname>Mallick</surname><given-names>Himel</given-names></name>, <name><surname>Franzosa</surname><given-names>Eric A</given-names></name>, <name><surname>Mclver</surname><given-names>Lauren J</given-names></name>, <name><surname>Banerjee</surname><given-names>Soumya</given-names></name>, <name><surname>Sirota-Madi</surname><given-names>Alexandra</given-names></name>, <name><surname>Kostic</surname><given-names>Aleksandar D</given-names></name>, <name><surname>Clish</surname><given-names>Clary B</given-names></name>, <name><surname>Vlamakis</surname><given-names>Hera</given-names></name>, <name><surname>Xavier</surname><given-names>Ramnik J</given-names></name>, and <name><surname>Huttenhower</surname><given-names>Curtis</given-names></name>. <article-title>Predictive metabolomic profiling of microbial communities using amplicon or metagenomic sequences</article-title>. <source>Nature communications</source>, <volume>10</volume>(<issue>1</issue>):<fpage>3136</fpage>, <year>2019</year>.</mixed-citation>
    </ref>
    <ref id="R4">
      <label>[4]</label>
      <mixed-citation publication-type="journal"><name><surname>Knight</surname><given-names>Rob</given-names></name>, <name><surname>Vrbanac</surname><given-names>Alison</given-names></name>, <name><surname>Taylor</surname><given-names>Bryn C</given-names></name>, <name><surname>Aksenov</surname><given-names>Alexander</given-names></name>, <name><surname>Callewaert</surname><given-names>Chris</given-names></name>, <name><surname>Debelius</surname><given-names>Justine</given-names></name>, <name><surname>Gonzalez</surname><given-names>Antonio</given-names></name>, <name><surname>Kosciolek</surname><given-names>Tomasz</given-names></name>, <name><surname>McCall</surname><given-names>Laura-Isobel</given-names></name>, <name><surname>McDonald</surname><given-names>Daniel</given-names></name>, <etal/><article-title>Best practices for analysing microbiomes</article-title>. <source>Nature Reviews Microbiology</source>, page <volume>1</volume>, <fpage>2018</fpage>.</mixed-citation>
    </ref>
    <ref id="R5">
      <label>[5]</label>
      <mixed-citation publication-type="journal"><name><surname>Meng</surname><given-names>Chen</given-names></name>, <name><surname>Zeleznik</surname><given-names>Oana A</given-names></name>, <name><surname>Thallinger</surname><given-names>Gerhard G</given-names></name>, <name><surname>Kuster</surname><given-names>Bernhard</given-names></name>, <name><surname>Gholami</surname><given-names>Amin M</given-names></name>, and <name><surname>Culhane</surname><given-names>Aedín C</given-names></name>. <article-title>Dimension reduction techniques for the integrative analysis of multi-omics data</article-title>. <source>Brief. Bioinform</source>, <volume>17</volume>(<issue>4</issue>):<fpage>628</fpage>–<lpage>641</lpage>, <month>7</month><year>2016</year>.<pub-id pub-id-type="pmid">26969681</pub-id></mixed-citation>
    </ref>
    <ref id="R6">
      <label>[6]</label>
      <mixed-citation publication-type="journal"><name><surname>Le Gall</surname><given-names>Gwénaëlle</given-names></name>, <name><surname>Noor</surname><given-names>Samah O</given-names></name>, <name><surname>Ridgway</surname><given-names>Karyn</given-names></name>, <name><surname>Scovell</surname><given-names>Louise</given-names></name>, <name><surname>Jamieson</surname><given-names>Crawford</given-names></name>, <name><surname>Johnson</surname><given-names>Ian T</given-names></name>, <name><surname>Colquhoun</surname><given-names>Ian J</given-names></name>, <name><surname>Kemsley</surname><given-names>E Kate</given-names></name>, and <name><surname>Narbad</surname><given-names>Arjan</given-names></name>. <article-title>Metabolomics of fecal extracts detects altered metabolic activity of gut microbiota in ulcerative colitis and irritable bowel syndrome</article-title>. <source>Journal of proteome research</source>, <volume>10</volume>(<issue>9</issue>):<fpage>4208</fpage>–<lpage>4218</lpage>, <year>2011</year>.<pub-id pub-id-type="pmid">21761941</pub-id></mixed-citation>
    </ref>
    <ref id="R7">
      <label>[7]</label>
      <mixed-citation publication-type="journal"><name><surname>Rohart</surname><given-names>Florian</given-names></name>, <name><surname>Gautier</surname><given-names>Benoit</given-names></name>, <name><surname>Singh</surname><given-names>Amrit</given-names></name>, and <name><surname>Le Cao</surname><given-names>Kim-Anh</given-names></name>. <article-title>mixomics: An r package for ‘omics feature selection and multiple data integration</article-title>. <source>PLoS computational biology</source>, <volume>13</volume>(<issue>11</issue>):<fpage>e1005752</fpage>, <year>2017</year>.<pub-id pub-id-type="pmid">29099853</pub-id></mixed-citation>
    </ref>
    <ref id="R8">
      <label>[8]</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>Bo</given-names></name>, <name><surname>Mezlini</surname><given-names>Aziz M</given-names></name>, <name><surname>Demir</surname><given-names>Feyyaz</given-names></name>, <name><surname>Fiume</surname><given-names>Marc</given-names></name>, <name><surname>Tu</surname><given-names>Zhuowen</given-names></name>, <name><surname>Brudno</surname><given-names>Michael</given-names></name>, <name><surname>Haibe-Kains</surname><given-names>Benjamin</given-names></name>, and <name><surname>Goldenberg</surname><given-names>Anna</given-names></name>. <article-title>Similarity network fusion for aggregating data types on a genomic scale</article-title>. <source>Nature methods</source>, <volume>11</volume>(<issue>3</issue>):<fpage>333</fpage>, <year>2014</year>.<pub-id pub-id-type="pmid">24464287</pub-id></mixed-citation>
    </ref>
    <ref id="R9">
      <label>[9]</label>
      <mixed-citation publication-type="journal"><name><surname>Argelaguet</surname><given-names>Ricard</given-names></name>, <name><surname>Velten</surname><given-names>Britta</given-names></name>, <name><surname>Arnol</surname><given-names>Damien</given-names></name>, <name><surname>Dietrich</surname><given-names>Sascha</given-names></name>, <name><surname>Zenz</surname><given-names>Thorsten</given-names></name>, <name><surname>Marioni</surname><given-names>John C</given-names></name>, <name><surname>Buettner</surname><given-names>Florian</given-names></name>, <name><surname>Huber</surname><given-names>Wolfgang</given-names></name>, and <name><surname>Stegle</surname><given-names>Oliver</given-names></name>. <article-title>Multi-omics factor analysis—a framework for unsupervised integration of multi-omics data sets</article-title>. <source>Molecular systems biology</source>, <volume>14</volume>(<issue>6</issue>):<fpage>e8124</fpage>, <year>2018</year>.<pub-id pub-id-type="pmid">29925568</pub-id></mixed-citation>
    </ref>
    <ref id="R10">
      <label>[10]</label>
      <mixed-citation publication-type="journal"><name><surname>Cajo</surname><given-names>JF</given-names></name><name><surname>Braak</surname><given-names>Ter</given-names></name> and <name><surname>Verdonschot</surname><given-names>Piet FM</given-names></name>. <article-title>Canonical correspondence analysis and related multivariate methods in aquatic ecology</article-title>. <source>Aquatic sciences</source>, <volume>57</volume>(<issue>3</issue>):<fpage>255</fpage>–<lpage>289</lpage>, <year>1995</year>.</mixed-citation>
    </ref>
    <ref id="R11">
      <label>[11]</label>
      <mixed-citation publication-type="journal"><name><surname>Witten</surname><given-names>Daniela M</given-names></name>, <name><surname>Tibshirani</surname><given-names>Robert</given-names></name>, and <name><surname>Hastie</surname><given-names>Trevor</given-names></name>. <article-title>A penalized matrix decomposition, with applications to sparse principal components and canonical correlation analysis</article-title>. <source>Biostatistics</source>, <volume>10</volume>(<issue>3</issue>):<fpage>515</fpage>–<lpage>534</lpage>, <year>2009</year>.<pub-id pub-id-type="pmid">19377034</pub-id></mixed-citation>
    </ref>
    <ref id="R12">
      <label>[12]</label>
      <mixed-citation publication-type="journal"><name><surname>Bodein</surname><given-names>Antoine</given-names></name>, <name><surname>Chapleur</surname><given-names>Olivier</given-names></name>, <name><surname>Droit</surname><given-names>Arnaud</given-names></name>, and <name><surname>Lê Cao</surname><given-names>Kim-Anh</given-names></name>. <article-title>A generic multivariate framework for the integration of microbiome longitudinal studies with other data types</article-title>. <source>bioRxiv</source>, page <fpage>585802</fpage>, <year>2019</year>.</mixed-citation>
    </ref>
    <ref id="R13">
      <label>[13]</label>
      <mixed-citation publication-type="journal"><name><surname>Friedman</surname><given-names>Jonathan</given-names></name> and <name><surname>Alm</surname><given-names>Eric J</given-names></name>. <article-title>Inferring correlation networks from genomic survey data</article-title>. <source>PLoS computational biology</source>, <volume>8</volume>(<issue>9</issue>):<fpage>e1002687</fpage>, <year>2012</year>.<pub-id pub-id-type="pmid">23028285</pub-id></mixed-citation>
    </ref>
    <ref id="R14">
      <label>[14]</label>
      <mixed-citation publication-type="journal"><name><surname>Kurtz</surname><given-names>Zachary D</given-names></name>, <name><surname>Müller</surname><given-names>Christian L</given-names></name>, <name><surname>Miraldi</surname><given-names>Emily R</given-names></name>, <name><surname>Littman</surname><given-names>Dan R</given-names></name>, <name><surname>Blaser</surname><given-names>Martin J</given-names></name>, and <name><surname>Bonneau</surname><given-names>Richard A</given-names></name>. <article-title>Sparse and compositionally robust inference of microbial ecological networks</article-title>. <source>PLoS computational biology</source>, <volume>11</volume>(<issue>5</issue>):<fpage>e1004226</fpage>, <year>2015</year>.<pub-id pub-id-type="pmid">25950956</pub-id></mixed-citation>
    </ref>
    <ref id="R15">
      <label>[15]</label>
      <mixed-citation publication-type="journal"><name><surname>Weiss</surname><given-names>Sophie</given-names></name>, <name><surname>Van Treuren</surname><given-names>Will</given-names></name>, <name><surname>Lozupone</surname><given-names>Catherine</given-names></name>, <name><surname>Faust</surname><given-names>Karoline</given-names></name>, <name><surname>Friedman</surname><given-names>Jonathan</given-names></name>, <name><surname>Deng</surname><given-names>Ye</given-names></name>, <name><surname>Xia</surname><given-names>Li Charlie</given-names></name>, <name><surname>Xu</surname><given-names>Zhenjiang Zech</given-names></name>, <name><surname>Ursell</surname><given-names>Luke</given-names></name>, <name><surname>Alm</surname><given-names>Eric J</given-names></name>, <etal/><article-title>Correlation detection strategies in microbial data sets vary widely in sensitivity and precision</article-title>. <source>The ISME journal</source>, <volume>10</volume>(<issue>7</issue>):<fpage>1669</fpage>, <year>2016</year>.<pub-id pub-id-type="pmid">26905627</pub-id></mixed-citation>
    </ref>
    <ref id="R16">
      <label>[16]</label>
      <mixed-citation publication-type="journal"><name><surname>Vandeputte</surname><given-names>Doris</given-names></name>, <name><surname>Kathagen</surname><given-names>Gunter</given-names></name>, <name><surname>Kevin D’hoe</surname><given-names>Sara Vieira-Silva</given-names></name>, <name><surname>Mireia Valles-Colomer</surname><given-names>João Sabino</given-names></name>, <name><surname>Wang</surname><given-names>Jun</given-names></name>, <name><surname>Tito</surname><given-names>Raul Y</given-names></name>, <name><surname>De Commer</surname><given-names>Lindsey</given-names></name>, <name><surname>Darzi</surname><given-names>Youssef</given-names></name>, <name><surname>Vermeire</surname><given-names>Séverine</given-names></name>, <name><surname>Falony</surname><given-names>Gwen</given-names></name>, and <name><surname>Raes</surname><given-names>Jeroen</given-names></name>. <article-title>Quantitative microbiome profiling links gut community variation to microbial load</article-title>. <source>Nature</source>, <volume>551</volume>(<issue>7681</issue>):<fpage>507</fpage>–<lpage>511</lpage>, <month>11</month><year>2017</year>.<pub-id pub-id-type="pmid">29143816</pub-id></mixed-citation>
    </ref>
    <ref id="R17">
      <label>[17]</label>
      <mixed-citation publication-type="journal"><name><surname>Gloor</surname><given-names>Gregory B</given-names></name>, <name><surname>Macklaim</surname><given-names>Jean M</given-names></name>, <name><surname>Pawlowsky-Glahn</surname><given-names>Vera</given-names></name>, and <name><surname>Egozcue</surname><given-names>Juan J</given-names></name>. <article-title>Microbiome datasets are compositional: And this is not optional</article-title>. <source>Front. Microbiol</source>, <volume>8</volume>, <fpage>2017</fpage>.<pub-id pub-id-type="pmid">29118739</pub-id></mixed-citation>
    </ref>
    <ref id="R18">
      <label>[18]</label>
      <mixed-citation publication-type="journal"><name><surname>Tang</surname><given-names>Keqi</given-names></name>, <name><surname>Page</surname><given-names>Jason S</given-names></name>, and <name><surname>Smith</surname><given-names>Richard D</given-names></name>. <article-title>Charge competition and the linear dynamic range of detection in electrospray ionization mass spectrometry</article-title>. <source>J. Am. Soc. Mass Spectrom</source>, <volume>15</volume>(<issue>10</issue>):<fpage>1416</fpage>–<lpage>1423</lpage>, <year>2004</year>.<pub-id pub-id-type="pmid">15465354</pub-id></mixed-citation>
    </ref>
    <ref id="R19">
      <label>[19]</label>
      <mixed-citation publication-type="journal"><name><surname>King</surname><given-names>Richard</given-names></name>, <name><surname>Bonfiglio</surname><given-names>Ryan</given-names></name>, <name><surname>Fernandez-Metzler</surname><given-names>Carmen</given-names></name>, <name><surname>Miller-Stein</surname><given-names>Cynthia</given-names></name>, and <name><surname>Olah</surname><given-names>Timothy</given-names></name>. <article-title>Mechanistic investigation of ionization suppression in electrospray ionization</article-title>. <source>J. Am. Soc. Mass Spectrom</source>, <volume>11</volume>(<issue>11</issue>):<fpage>942</fpage>–<lpage>950</lpage>, <year>2000</year>.<pub-id pub-id-type="pmid">11073257</pub-id></mixed-citation>
    </ref>
    <ref id="R20">
      <label>[20]</label>
      <mixed-citation publication-type="journal"><name><surname>Matuszewski</surname><given-names>BK</given-names></name>, <name><surname>Constanzer</surname><given-names>ML</given-names></name>, and <name><surname>Chavez-Eng</surname><given-names>CM</given-names></name>. <article-title>Strategies for the assessment of matrix effect in quantitative bioanalytical methods based on hplc-ms/ms</article-title>. <source>Anal. Chem</source>, <volume>75</volume>(<issue>13</issue>):<fpage>3019</fpage>–<lpage>3030</lpage>, <year>2003</year>.<pub-id pub-id-type="pmid">12964746</pub-id></mixed-citation>
    </ref>
    <ref id="R21">
      <label>[21]</label>
      <mixed-citation publication-type="journal"><name><surname>Alžběta Kalivodová</surname><given-names>Karel Hron</given-names></name>, <name><surname>Filzmoser</surname><given-names>Peter</given-names></name>, <name><surname>Najdekr</surname><given-names>Lukáš</given-names></name>, <name><surname>Janečková</surname><given-names>Hana</given-names></name>, and <name><surname>Adam</surname><given-names>Tomáš</given-names></name>. <article-title>Pls-da for compositional data with application to metabolomics</article-title>. <source>Journal of Chemometrics</source>, <volume>29</volume>(<issue>1</issue>):<fpage>21</fpage>–<lpage>28</lpage>, <year>2015</year>.</mixed-citation>
    </ref>
    <ref id="R22">
      <label>[22]</label>
      <mixed-citation publication-type="journal"><name><surname>Jansson</surname><given-names>JK</given-names></name> and <name><surname>Baker</surname><given-names>ES</given-names></name>
<article-title>A multi-omic future for microbiome studies</article-title>. <source>Nat Microbiol</source>, <volume>1</volume>:<fpage>16049</fpage>, <comment>04</comment>
<year>2016</year>.<pub-id pub-id-type="pmid">27572648</pub-id></mixed-citation>
    </ref>
    <ref id="R23">
      <label>[23]</label>
      <mixed-citation publication-type="journal"><name><surname>Lovell</surname><given-names>David</given-names></name>, <name><surname>Pawlowsky-Glahn</surname><given-names>Vera</given-names></name>, <name><surname>José Egozcue</surname><given-names>Juan</given-names></name>, <name><surname>Marguerat</surname><given-names>Samuel</given-names></name>, and <name><surname>Bähler</surname><given-names>Jürg</given-names></name>. <article-title>Proportionality: a valid alternative to correlation for relative data</article-title>. <source>PLoS computational biology</source>, <volume>11</volume>(<issue>3</issue>):<fpage>e1004075</fpage>, <year>2015</year>.<pub-id pub-id-type="pmid">25775355</pub-id></mixed-citation>
    </ref>
    <ref id="R24">
      <label>[24]</label>
      <mixed-citation publication-type="journal"><name><surname>Tipton</surname><given-names>Laura</given-names></name>, <name><surname>Müller</surname><given-names>Christian L</given-names></name>, <name><surname>Kurtz</surname><given-names>Zachary D</given-names></name>, <name><surname>Huang</surname><given-names>Laurence</given-names></name>, <name><surname>Kleerup</surname><given-names>Eric</given-names></name>, <name><surname>Morris</surname><given-names>Alison</given-names></name>, <name><surname>Bonneau</surname><given-names>Richard</given-names></name>, and <name><surname>Ghedin</surname><given-names>Elodie</given-names></name>. <article-title>Fungi stabilize connectivity in the lung and skin microbial ecosystems</article-title>. <source>Microbiome</source>, <volume>6</volume>(<issue>1</issue>):<fpage>12</fpage>, <year>2018</year>.<pub-id pub-id-type="pmid">29335027</pub-id></mixed-citation>
    </ref>
    <ref id="R25">
      <label>[25]</label>
      <mixed-citation publication-type="journal"><name><surname>Morton</surname><given-names>James T</given-names></name>, <name><surname>Marotz</surname><given-names>Clarisse</given-names></name>, <name><surname>Washburne</surname><given-names>Alex</given-names></name>, <name><surname>Silverman</surname><given-names>Justin</given-names></name>, <name><surname>Zaramela</surname><given-names>Livia S</given-names></name>, <name><surname>Edlund</surname><given-names>Anna</given-names></name>, <name><surname>Zengler</surname><given-names>Karsten</given-names></name>, and <name><surname>Knight</surname><given-names>Rob</given-names></name>. <article-title>Establishing microbial composition measurement standards with reference frames</article-title>. <source>Nature Communications</source>, <volume>10</volume>(<issue>1</issue>):<fpage>2719</fpage>, <year>2019</year>.</mixed-citation>
    </ref>
    <ref id="R26">
      <label>[26]</label>
      <mixed-citation publication-type="confproc"><name><surname>Abadi</surname><given-names>Martín</given-names></name>, <name><surname>Barham</surname><given-names>Paul</given-names></name>, <name><surname>Chen</surname><given-names>Jianmin</given-names></name>, <name><surname>Chen</surname><given-names>Zhifeng</given-names></name>, <name><surname>Davis</surname><given-names>Andy</given-names></name>, <name><surname>Dean</surname><given-names>Jeffrey</given-names></name>, <name><surname>Devin</surname><given-names>Matthieu</given-names></name>, <name><surname>Ghemawat</surname><given-names>Sanjay</given-names></name>, <name><surname>Irving</surname><given-names>Geoffrey</given-names></name>, <name><surname>Isard</surname><given-names>Michael</given-names></name>, <etal/><source>Tensorflow: A system for large-scale machine learning</source>. In <conf-name>12th {USENIX} Symposium on Operating Systems Design and Implementation ({OSDI} 16)</conf-name>, pages <fpage>265</fpage>–<lpage>283</lpage>, <year>2016</year>.</mixed-citation>
    </ref>
    <ref id="R27">
      <label>[27]</label>
      <mixed-citation publication-type="journal"><name><surname>Quinn</surname><given-names>Robert A</given-names></name>, <name><surname>Comstock</surname><given-names>William</given-names></name>, <name><surname>Zhang</surname><given-names>Tianyu</given-names></name>, <name><surname>Morton</surname><given-names>James T</given-names></name>, <name><surname>da Silva</surname><given-names>Ricardo</given-names></name>, <name><surname>Tran</surname><given-names>Alda</given-names></name>, <name><surname>Aksenov</surname><given-names>Alexander</given-names></name>, <name><surname>Nothias</surname><given-names>Louis-Felix</given-names></name>, <name><surname>Wangpraseurt</surname><given-names>Daniel</given-names></name>, <name><surname>Melnik</surname><given-names>Alexey V</given-names></name>, <name><surname>Ackermann</surname><given-names>Gail</given-names></name>, <name><surname>Conrad</surname><given-names>Douglas</given-names></name>, <name><surname>Klapper</surname><given-names>Isaac</given-names></name>, <name><surname>Knight</surname><given-names>Rob</given-names></name>, and <name><surname>Dorrestein</surname><given-names>Pieter C</given-names></name>. <article-title>Niche partitioning of a pathogenic microbiome driven by chemical gradients</article-title>. <source>Sci Adv</source>, <volume>4</volume>(<issue>9</issue>):<fpage>eaau1908</fpage>, <month>9</month><year>2018</year>.<pub-id pub-id-type="pmid">30263961</pub-id></mixed-citation>
    </ref>
    <ref id="R28">
      <label>[28]</label>
      <mixed-citation publication-type="journal"><name><surname>Shalapour</surname><given-names>Shabnam</given-names></name>, <name><surname>Lin</surname><given-names>Xue-Jia</given-names></name>, <name><surname>Bastian</surname><given-names>Ingmar N</given-names></name>, <name><surname>Brain</surname><given-names>John</given-names></name>, <name><surname>Burt</surname><given-names>Alastair D</given-names></name>, <name><surname>Aksenov</surname><given-names>Alexander A</given-names></name>, <name><surname>Vrbanac</surname><given-names>Alison F</given-names></name>, <name><surname>Li</surname><given-names>Weihua</given-names></name>, <name><surname>Perkins</surname><given-names>Andres</given-names></name>, <name><surname>Matsutani</surname><given-names>Takaji</given-names></name>, <etal/><article-title>Inflammation-induced iga+ cells dismantle anti-liver cancer immunity</article-title>. <source>Nature</source>, <volume>551</volume>(<issue>7680</issue>):<fpage>340</fpage>, <year>2017</year>.<pub-id pub-id-type="pmid">29144460</pub-id></mixed-citation>
    </ref>
    <ref id="R29">
      <label>[29]</label>
      <mixed-citation publication-type="journal"><name><surname>Lloyd-Price</surname><given-names>J</given-names></name>, <name><surname>Arze</surname><given-names>C</given-names></name>, <name><surname>Ananthakrishnan</surname><given-names>AN</given-names></name>, <name><surname>Schirmer</surname><given-names>M</given-names></name>, <name><surname>Avila-Pacheco</surname><given-names>J</given-names></name>, <name><surname>Poon</surname><given-names>TW</given-names></name>, <name><surname>Andrews</surname><given-names>E</given-names></name>, <name><surname>Ajami</surname><given-names>NJ</given-names></name>, <name><surname>Bonham</surname><given-names>KS</given-names></name>, <name><surname>Brislawn</surname><given-names>CJ</given-names></name>, <name><surname>Casero</surname><given-names>D</given-names></name>, <name><surname>Courtney</surname><given-names>H</given-names></name>, <name><surname>Gonzalez</surname><given-names>A</given-names></name>, <name><surname>Graeber</surname><given-names>TG</given-names></name>, <name><surname>Hall</surname><given-names>AB</given-names></name>, <name><surname>Lake</surname><given-names>K</given-names></name>, <name><surname>Landers</surname><given-names>CJ</given-names></name>, <name><surname>Mallick</surname><given-names>H</given-names></name>, <name><surname>Plichta</surname><given-names>DR</given-names></name>, <name><surname>Prasad</surname><given-names>M</given-names></name>, <name><surname>Rahnavard</surname><given-names>G</given-names></name>, <name><surname>Sauk</surname><given-names>J</given-names></name>, <name><surname>Shungin</surname><given-names>D</given-names></name>, <name><surname>Vazquez-Baeza</surname><given-names>Y</given-names></name>, <name><surname>White</surname><given-names>RA</given-names></name>, <name><surname>Braun</surname><given-names>J</given-names></name>, <name><surname>Denson</surname><given-names>LA</given-names></name>, <name><surname>Jansson</surname><given-names>JK</given-names></name>, <name><surname>Knight</surname><given-names>R</given-names></name>, <name><surname>Kugathasan</surname><given-names>S</given-names></name>, <name><surname>McGovern</surname><given-names>DPB</given-names></name>, <name><surname>Petrosino</surname><given-names>JF</given-names></name>, <name><surname>Stappenbeck</surname><given-names>TS</given-names></name>, <name><surname>Winter</surname><given-names>HS</given-names></name>, <name><surname>Clish</surname><given-names>CB</given-names></name>, <name><surname>Franzosa</surname><given-names>EA</given-names></name>, <name><surname>Vlamakis</surname><given-names>H</given-names></name>, <name><surname>Xavier</surname><given-names>RJ</given-names></name>, <name><surname>Huttenhower</surname><given-names>C</given-names></name>, <name><surname>Bishai</surname><given-names>J</given-names></name>, <name><surname>Bullock</surname><given-names>K</given-names></name>, <name><surname>Deik</surname><given-names>A</given-names></name>, <name><surname>Dennis</surname><given-names>C</given-names></name>, <name><surname>Kaplan</surname><given-names>JL</given-names></name>, <name><surname>Khalili</surname><given-names>H</given-names></name>, <name><surname>McIver</surname><given-names>LJ</given-names></name>, <name><surname>Moran</surname><given-names>CJ</given-names></name>, <name><surname>Nguyen</surname><given-names>L</given-names></name>, <name><surname>Pierce</surname><given-names>KA</given-names></name>, <name><surname>Schwager</surname><given-names>R</given-names></name>, <name><surname>Sirota-Madi</surname><given-names>A</given-names></name>, <name><surname>Stevens</surname><given-names>BW</given-names></name>, <name><surname>Tan</surname><given-names>W</given-names></name>, <name><surname>Ten Hoeve</surname><given-names>JJ</given-names></name>, <name><surname>Weingart</surname><given-names>G</given-names></name>, <name><surname>Wilson</surname><given-names>RG</given-names></name>, and <name><surname>Yajnik</surname><given-names>V</given-names></name><article-title>Multi-omics of the gut microbial ecosystem in inflammatory bowel diseases</article-title>. <source>Nature</source>, <volume>569</volume>(<issue>7758</issue>):<fpage>655</fpage>–<lpage>662</lpage>, <month>5</month><year>2019</year>.<pub-id pub-id-type="pmid">31142855</pub-id></mixed-citation>
    </ref>
    <ref id="R30">
      <label>[30]</label>
      <mixed-citation publication-type="journal"><name><surname>Swenson</surname><given-names>Tami L</given-names></name>, <name><surname>Karaoz</surname><given-names>Ulas</given-names></name>, <name><surname>Swenson</surname><given-names>Joel M</given-names></name>, <name><surname>Bowen</surname><given-names>Benjamin P</given-names></name>, and <name><surname>Northen</surname><given-names>Trent R</given-names></name>. <article-title>Linking soil biology and chemistry in biological soil crust using isolate exometabolomics</article-title>. <source>Nature communications</source>, <volume>9</volume>(<issue>1</issue>):<fpage>19</fpage>, <year>2018</year>.</mixed-citation>
    </ref>
    <ref id="R31">
      <label>[31]</label>
      <mixed-citation publication-type="journal"><name><surname>Baran</surname><given-names>Richard</given-names></name>, <name><surname>Brodie</surname><given-names>Eoin L</given-names></name>, <name><surname>Mayberry-Lewis</surname><given-names>Jazmine</given-names></name>, <name><surname>Hummel</surname><given-names>Eric</given-names></name>, <name><surname>Da Rocha</surname><given-names>Ulisses Nunes</given-names></name>, <name><surname>Chakraborty</surname><given-names>Romy</given-names></name>, <name><surname>Bowen</surname><given-names>Benjamin P</given-names></name>, <name><surname>Karaoz</surname><given-names>Ulas</given-names></name>, <name><surname>Cadillo-Quiroz</surname><given-names>Hinsby</given-names></name>, <name><surname>Garcia-Pichel</surname><given-names>Ferran</given-names></name>, <etal/><article-title>Exometabolite niche partitioning among sympatric soil bacteria</article-title>. <source>Nature communications</source>, <volume>6</volume>:<fpage>8289</fpage>, <year>2015</year>.</mixed-citation>
    </ref>
    <ref id="R32">
      <label>[32]</label>
      <mixed-citation publication-type="journal"><name><surname>Quinn</surname><given-names>Robert A</given-names></name>, <name><surname>Whiteson</surname><given-names>Katrine</given-names></name>, <name><surname>Lim</surname><given-names>Yan-Wei</given-names></name>, <name><surname>Salamon</surname><given-names>Peter</given-names></name>, <name><surname>Bailey</surname><given-names>Barbara</given-names></name>, <name><surname>Mienardi</surname><given-names>Simone</given-names></name>, <name><surname>Sanchez</surname><given-names>Savannah E</given-names></name>, <name><surname>Blake</surname><given-names>Don</given-names></name>, <name><surname>Conrad</surname><given-names>Doug</given-names></name>, and <name><surname>Rohwer</surname><given-names>Forest</given-names></name>. <article-title>A winogradsky-based culture system shows an association between microbial fermentation and cystic fibrosis exacerbation</article-title>. <source>ISME J</source>, <volume>9</volume>(<issue>4</issue>):<fpage>1024</fpage>–<lpage>1038</lpage>, <month>3</month><year>2015</year>.<pub-id pub-id-type="pmid">25514533</pub-id></mixed-citation>
    </ref>
    <ref id="R33">
      <label>[33]</label>
      <mixed-citation publication-type="journal"><name><surname>Moree</surname><given-names>Wilna J</given-names></name>, <name><surname>Phelan</surname><given-names>Vanessa V</given-names></name>, <name><surname>Wu</surname><given-names>Cheng-Hsuan</given-names></name>, <name><surname>Bandeira</surname><given-names>Nuno</given-names></name>, <name><surname>Cornett</surname><given-names>Dale S</given-names></name>, <name><surname>Duggan</surname><given-names>Brendan M</given-names></name>, and <name><surname>Dorrestein</surname><given-names>Pieter C</given-names></name>. <article-title>Interkingdom metabolic transformations captured by microbial imaging mass spectrometry</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>109</volume>(<issue>34</issue>):<fpage>13811</fpage>–<lpage>13816</lpage>, <year>2012</year>.</mixed-citation>
    </ref>
    <ref id="R34">
      <label>[34]</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>Mingxun</given-names></name>, <name><surname>Carver</surname><given-names>Jeremy J</given-names></name>, <name><surname>Phelan</surname><given-names>Vanessa V</given-names></name>, <name><surname>Sanchez</surname><given-names>Laura M</given-names></name>, <name><surname>Garg</surname><given-names>Neha</given-names></name>, <name><surname>Peng</surname><given-names>Yao</given-names></name>, <name><surname>Nguyen</surname><given-names>Don Duy</given-names></name>, <name><surname>Watrous</surname><given-names>Jeramie</given-names></name>, <name><surname>Kapono</surname><given-names>Clifford A</given-names></name>, <name><surname>Luzzatto-Knaan</surname><given-names>Tal</given-names></name>, <name><surname>Porto</surname><given-names>Carla</given-names></name>, <name><surname>Bouslimani</surname><given-names>Amina</given-names></name>, <name><surname>Melnik</surname><given-names>Alexey V</given-names></name>, <name><surname>Meehan</surname><given-names>Michael J</given-names></name>, <name><surname>Liu</surname><given-names>Wei-Ting</given-names></name>, <name><surname>Crüsemann</surname><given-names>Max</given-names></name>, <name><surname>Boudreau</surname><given-names>Paul D</given-names></name>, <name><surname>Esquenazi</surname><given-names>Eduardo</given-names></name>, <name><surname>Sandoval-Calderón</surname><given-names>Mario</given-names></name>, <name><surname>Kersten</surname><given-names>Roland D</given-names></name>, <name><surname>Pace</surname><given-names>Laura A</given-names></name>, <name><surname>Quinn</surname><given-names>Robert A</given-names></name>, <name><surname>Duncan</surname><given-names>Katherine R</given-names></name>, <name><surname>Hsu</surname><given-names>Cheng-Chih</given-names></name>, <name><surname>Floros</surname><given-names>Dimitrios J</given-names></name>, <name><surname>Gavilan</surname><given-names>Ronnie G</given-names></name>, <name><surname>Kleigrewe</surname><given-names>Karin</given-names></name>, <name><surname>Northen</surname><given-names>Trent</given-names></name>, <name><surname>Dutton</surname><given-names>Rachel J</given-names></name>, <name><surname>Parrot</surname><given-names>Delphine</given-names></name>, <name><surname>Carlson</surname><given-names>Erin E</given-names></name>, <name><surname>Aigle</surname><given-names>Bertrand</given-names></name>, <name><surname>Michelsen</surname><given-names>Charlotte F</given-names></name>, <name><surname>Jelsbak</surname><given-names>Lars</given-names></name>, <name><surname>Sohlenkamp</surname><given-names>Christian</given-names></name>, <name><surname>Pevzner</surname><given-names>Pavel</given-names></name>, <name><surname>Edlund</surname><given-names>Anna</given-names></name>, <name><surname>McLean</surname><given-names>Jeffrey</given-names></name>, <name><surname>Piel</surname><given-names>Jörn</given-names></name>, <name><surname>Murphy</surname><given-names>Brian T</given-names></name>, <name><surname>Gerwick</surname><given-names>Lena</given-names></name>, <name><surname>Liaw</surname><given-names>Chih-Chuang</given-names></name>, <name><surname>Yang</surname><given-names>Yu-Liang</given-names></name>, <name><surname>Humpf</surname><given-names>Hans-Ulrich</given-names></name>, <name><surname>Maansson</surname><given-names>Maria</given-names></name>, <name><surname>Keyzers</surname><given-names>Robert A</given-names></name>, <name><surname>Sims</surname><given-names>Amy C</given-names></name>, <name><surname>Johnson</surname><given-names>Andrew R</given-names></name>, <name><surname>Sidebottom</surname><given-names>Ashley M</given-names></name>, <name><surname>Sedio</surname><given-names>Brian E</given-names></name>, <name><surname>Klitgaard</surname><given-names>Andreas</given-names></name>, <name><surname>Larson</surname><given-names>Charles B</given-names></name>, <name><surname>Cristopher</surname><given-names>A</given-names></name><name><surname>Boya</surname><given-names>P</given-names></name>, <name><surname>Torres-Mendoza</surname><given-names>Daniel</given-names></name>, <name><surname>Gonzalez</surname><given-names>David J</given-names></name>, <name><surname>Silva</surname><given-names>Denise B</given-names></name>, <name><surname>Marques</surname><given-names>Lucas M</given-names></name>, <name><surname>Demarque</surname><given-names>Daniel P</given-names></name>, <name><surname>Pociute</surname><given-names>Egle</given-names></name>, <name><surname>O’Neill</surname><given-names>Ellis C</given-names></name>, <name><surname>Briand</surname><given-names>Enora</given-names></name>, <name><surname>Helfrich</surname><given-names>Eric J N</given-names></name>, <name><surname>Granatosky</surname><given-names>Eve A</given-names></name>, <name><surname>Glukhov</surname><given-names>Evgenia</given-names></name>, <name><surname>Ryffel</surname><given-names>Florian</given-names></name>, <name><surname>Houson</surname><given-names>Hailey</given-names></name>, <name><surname>Mohimani</surname><given-names>Hosein</given-names></name>, <name><surname>Kharbush</surname><given-names>Jenan J</given-names></name>, <name><surname>Zeng</surname><given-names>Yi</given-names></name>, <name><surname>Vorholt</surname><given-names>Julia A</given-names></name>, <name><surname>Kurita</surname><given-names>Kenji L</given-names></name>, <name><surname>Charusanti</surname><given-names>Pep</given-names></name>, <name><surname>McPhail</surname><given-names>Kerry L</given-names></name>, <name><surname>Nielsen</surname><given-names>Kristian Fog</given-names></name>, <name><surname>Vuong</surname><given-names>Lisa</given-names></name>, <name><surname>Elfeki</surname><given-names>Maryam</given-names></name>, <name><surname>Traxler</surname><given-names>Matthew F</given-names></name>, <name><surname>Engene</surname><given-names>Niclas</given-names></name>, <name><surname>Koyama</surname><given-names>Nobuhiro</given-names></name>, <name><surname>Vining</surname><given-names>Oliver B</given-names></name>, <name><surname>Baric</surname><given-names>Ralph</given-names></name>, <name><surname>Silva</surname><given-names>Ricardo R</given-names></name>, <name><surname>Mascuch</surname><given-names>Samantha J</given-names></name>, <name><surname>Tomasi</surname><given-names>Sophie</given-names></name>, <name><surname>Jenkins</surname><given-names>Stefan</given-names></name>, <name><surname>Macherla</surname><given-names>Venkat</given-names></name>, <name><surname>Hoffman</surname><given-names>Thomas</given-names></name>, <name><surname>Agarwal</surname><given-names>Vinayak</given-names></name>, <name><surname>Williams</surname><given-names>Philip G</given-names></name>, <name><surname>Dai</surname><given-names>Jingqui</given-names></name>, <name><surname>Neupane</surname><given-names>Ram</given-names></name>, <name><surname>Gurr</surname><given-names>Joshua</given-names></name>, <name><surname>Rodríguez</surname><given-names>Andrés M C</given-names></name>, <name><surname>Lamsa</surname><given-names>Anne</given-names></name>, <name><surname>Zhang</surname><given-names>Chen</given-names></name>, <name><surname>Dorrestein</surname><given-names>Kathleen</given-names></name>, <name><surname>Duggan</surname><given-names>Brendan M</given-names></name>, <name><surname>Almaliti</surname><given-names>Jehad</given-names></name>, <name><surname>Allard</surname><given-names>Pierre-Marie</given-names></name>, <name><surname>Phapale</surname><given-names>Prasad</given-names></name>, <name><surname>Nothias</surname><given-names>Louis-Felix</given-names></name>, <name><surname>Alexandrov</surname><given-names>Theodore</given-names></name>, <name><surname>Litaudon</surname><given-names>Marc</given-names></name>, <name><surname>Wolfender</surname><given-names>Jean-Luc</given-names></name>, <name><surname>Kyle</surname><given-names>Jennifer E</given-names></name>, <name><surname>Metz</surname><given-names>Thomas O</given-names></name>, <name><surname>Peryea</surname><given-names>Tyler</given-names></name>, <name><surname>Nguyen</surname><given-names>Dac-Trung</given-names></name>, <name><surname>VanLeer</surname><given-names>Danielle</given-names></name>, <name><surname>Shinn</surname><given-names>Paul</given-names></name>, <name><surname>Jadhav</surname><given-names>Ajit</given-names></name>, <name><surname>Müller</surname><given-names>Rolf</given-names></name>, <name><surname>Waters</surname><given-names>Katrina M</given-names></name>, <name><surname>Shi</surname><given-names>Wenyuan</given-names></name>, <name><surname>Liu</surname><given-names>Xueting</given-names></name>, <name><surname>Zhang</surname><given-names>Lixin</given-names></name>, <name><surname>Knight</surname><given-names>Rob</given-names></name>, <name><surname>Jensen</surname><given-names>Paul R</given-names></name>, <name><surname>Palsson</surname><given-names>Bernhard O</given-names></name>, <name><surname>Pogliano</surname><given-names>Kit</given-names></name>, <name><surname>Linington</surname><given-names>Roger G</given-names></name>, <name><surname>Gutiérrez</surname><given-names>Marcelino</given-names></name>, <name><surname>Lopes</surname><given-names>Norberto P</given-names></name>, <name><surname>Gerwick</surname><given-names>William H</given-names></name>, <name><surname>Moore</surname><given-names>Bradley S</given-names></name>, <name><surname>Dorrestein</surname><given-names>Pieter C</given-names></name>, and <name><surname>Bandeira</surname><given-names>Nuno</given-names></name>. <article-title>Sharing and community curation of mass spectrometry data with global natural products social molecular networking</article-title>. <source>Nat. Biotechnol</source>, <volume>34</volume>(<issue>8</issue>):<fpage>828</fpage>–<lpage>837</lpage>, <month>8</month><year>2016</year>.<pub-id pub-id-type="pmid">27504778</pub-id></mixed-citation>
    </ref>
    <ref id="R35">
      <label>[35]</label>
      <mixed-citation publication-type="journal"><name><surname>Maier</surname><given-names>Raina Margaret</given-names></name> and <name><surname>Soberon-Chavez</surname><given-names>G</given-names></name>. <article-title>Pseudomonas aeruginosa rhamnolipids: biosynthesis and potential applications</article-title>. <source>Applied Microbiology and Biotechnology</source>, <volume>54</volume>(<issue>5</issue>):<fpage>625</fpage>–<lpage>633</lpage>, <year>2000</year>.<pub-id pub-id-type="pmid">11131386</pub-id></mixed-citation>
    </ref>
    <ref id="R36">
      <label>[36]</label>
      <mixed-citation publication-type="journal"><name><surname>Wood</surname><given-names>Thammajun L</given-names></name>, <name><surname>Gong</surname><given-names>Ting</given-names></name>, <name><surname>Zhu</surname><given-names>Lei</given-names></name>, <name><surname>Miller</surname><given-names>James</given-names></name>, <name><surname>Miller</surname><given-names>Daniel S</given-names></name>, <name><surname>Yin</surname><given-names>Bei</given-names></name>, and <name><surname>Wood</surname><given-names>Thomas K</given-names></name>. <article-title>Rhamnolipids from pseudomonas aeruginosa disperse the biofilms of sulfate-reducing bacteria</article-title>. <source>NPJ biofilms and microbiomes</source>, <volume>4</volume>(<issue>1</issue>):<fpage>22</fpage>, <year>2018</year>.<pub-id pub-id-type="pmid">30302271</pub-id></mixed-citation>
    </ref>
    <ref id="R37">
      <label>[37]</label>
      <mixed-citation publication-type="journal"><name><surname>Allen</surname><given-names>Lucy</given-names></name>, <name><surname>Dockrell</surname><given-names>David H</given-names></name>, <name><surname>Pattery</surname><given-names>Theresa</given-names></name>, <name><surname>Lee</surname><given-names>Daniel G</given-names></name>, <name><surname>Cornelis</surname><given-names>Pierre</given-names></name>, <name><surname>Hellewell</surname><given-names>Paul G</given-names></name>, and <name><surname>Whyte</surname><given-names>Moira KB</given-names></name>. <article-title>Pyocyanin production by pseudomonas aeruginosa induces neutrophil apoptosis and impairs neutrophil-mediated host defenses in vivo</article-title>. <source>The Journal of Immunology</source>, <volume>174</volume>(<issue>6</issue>):<fpage>3643</fpage>–<lpage>3649</lpage>, <year>2005</year>.<pub-id pub-id-type="pmid">15749902</pub-id></mixed-citation>
    </ref>
    <ref id="R38">
      <label>[38]</label>
      <mixed-citation publication-type="journal"><name><surname>Quinn</surname><given-names>Robert A.</given-names></name>, <name><surname>Vrbanac</surname><given-names>Alison</given-names></name>, <name><surname>Melnik</surname><given-names>Alexey V.</given-names></name>, <name><surname>Patras</surname><given-names>Kathryn A.</given-names></name>, <name><surname>Christy</surname><given-names>Mitchell</given-names></name>, <name><surname>Nelson</surname><given-names>Andrew T.</given-names></name>, <name><surname>Aksenov</surname><given-names>Alexander</given-names></name>, <name><surname>Tripathi</surname><given-names>Anupriya</given-names></name>, <name><surname>Humphrey</surname><given-names>Greg</given-names></name>, <name><surname>da Silva</surname><given-names>Ricardo</given-names></name>, <name><surname>Bussell</surname><given-names>Robert</given-names></name>, <name><surname>Thron</surname><given-names>Taren</given-names></name>, <name><surname>Wang</surname><given-names>Mingxun</given-names></name>, <name><surname>Vargas</surname><given-names>Fernando</given-names></name>, <name><surname>Gauglitz</surname><given-names>Julia M.</given-names></name>, <name><surname>Meehan</surname><given-names>Michael J.</given-names></name>, <name><surname>Poulsen</surname><given-names>Orit</given-names></name>, <name><surname>Boland</surname><given-names>Brigid S.</given-names></name>, <name><surname>Chang</surname><given-names>John T.</given-names></name>, <name><surname>Sandborn</surname><given-names>William J.</given-names></name>, <name><surname>Lim</surname><given-names>Meerana</given-names></name>, <name><surname>Garg</surname><given-names>Neha</given-names></name>, <name><surname>Lumeng</surname><given-names>Julie</given-names></name>, <name><surname>Kazmierczak</surname><given-names>Barbara I.</given-names></name>, <name><surname>Jain</surname><given-names>Ruchi</given-names></name>, <name><surname>Egan</surname><given-names>Marie</given-names></name>, <name><surname>Rhee</surname><given-names>Kyung E.</given-names></name>, <name><surname>Haddad</surname><given-names>Gabriel G.</given-names></name>, <name><surname>Siegel</surname><given-names>Dionicio</given-names></name>, <name><surname>Mazmanian</surname><given-names>Sarkis</given-names></name>, <name><surname>Nizet</surname><given-names>Victor</given-names></name>, <name><surname>Knight</surname><given-names>Rob</given-names></name>, and <name><surname>Dorrestein</surname><given-names>Pieter C.</given-names></name><article-title>Chemical impacts of the microbiome across scales reveal novel conjugated bile acids</article-title>. <source>bioRxiv</source>, <year>2019</year>.</mixed-citation>
    </ref>
    <ref id="R39">
      <label>[39]</label>
      <mixed-citation publication-type="journal"><name><surname>Paczosa</surname><given-names>Michelle K.</given-names></name> and <name><surname>Mecsas</surname><given-names>Joan</given-names></name>. <article-title>Klebsiella pneumoniae: Going on the offense with a strong defense</article-title>. <source>Microbiology and Molecular Biology Reviews</source>, <volume>80</volume>(<issue>3</issue>):<fpage>629</fpage>–<lpage>661</lpage>, <year>2016</year>.<pub-id pub-id-type="pmid">27307579</pub-id></mixed-citation>
    </ref>
    <ref id="R40">
      <label>[40]</label>
      <mixed-citation publication-type="journal"><name><surname>Tiratterra</surname><given-names>Elisa</given-names></name>, <name><surname>Franco</surname><given-names>Placido</given-names></name>, <name><surname>Porru</surname><given-names>Emanuele</given-names></name>, <name><surname>Katsanos</surname><given-names>Konstantinos H</given-names></name>, <name><surname>Christodoulou</surname><given-names>Dimitrios K</given-names></name>, and <name><surname>Roda</surname><given-names>Giulia</given-names></name>. <article-title>Role of bile acids in inflammatory bowel disease</article-title>. <source>Annals of gastroenterology</source>, <volume>31</volume>(<issue>3</issue>):<fpage>266</fpage>, <year>2018</year>.<pub-id pub-id-type="pmid">29720851</pub-id></mixed-citation>
    </ref>
    <ref id="R41">
      <label>[41]</label>
      <mixed-citation publication-type="journal"><name><surname>Hofmann</surname><given-names>Alan F</given-names></name> and <name><surname>Eckmann</surname><given-names>Lars</given-names></name>. <article-title>How bile acids confer gut mucosal protection against bacteria</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>103</volume>(<issue>12</issue>):<fpage>4333</fpage>–<lpage>4334</lpage>, <year>2006</year>.</mixed-citation>
    </ref>
    <ref id="R42">
      <label>[42]</label>
      <mixed-citation publication-type="journal"><name><surname>Begley</surname><given-names>Máire</given-names></name>, <name><surname>Gahan</surname><given-names>Cormac GM</given-names></name>, and <name><surname>Hill</surname><given-names>Colin</given-names></name>. <article-title>The interaction between bacteria and bile</article-title>. <source>FEMS microbiology reviews</source>, <volume>29</volume>(<issue>4</issue>):<fpage>625</fpage>–<lpage>651</lpage>, <year>2005</year>.<pub-id pub-id-type="pmid">16102595</pub-id></mixed-citation>
    </ref>
    <ref id="R43">
      <label>[43]</label>
      <mixed-citation publication-type="journal"><name><surname>Okada</surname><given-names>Y</given-names></name>, <name><surname>Tsuzuki</surname><given-names>Y</given-names></name>, <name><surname>Miyazaki</surname><given-names>J</given-names></name>, <name><surname>Matsuzaki</surname><given-names>K</given-names></name>, <name><surname>Hokari</surname><given-names>R</given-names></name>, <name><surname>Komoto</surname><given-names>S</given-names></name>, <name><surname>Kato</surname><given-names>S</given-names></name>, <name><surname>Kawaguchi</surname><given-names>A</given-names></name>, <name><surname>Nagao</surname><given-names>S</given-names></name>, <name><surname>Itoh</surname><given-names>K</given-names></name>, <name><surname>Watanabe</surname><given-names>T</given-names></name>, and <name><surname>Miura</surname><given-names>S</given-names></name><article-title>Propionibacterium freudenreichii component 1.4-dihydroxy-2-naphthoic acid (DHNA) attenuates dextran sodium sulphate induced colitis by modulation of bacterial flora and lymphocyte homing</article-title>. <source>Gut</source>, <volume>55</volume>(<issue>5</issue>):<fpage>681</fpage>–<lpage>688</lpage>, <month>5</month><year>2006</year>.<pub-id pub-id-type="pmid">16299037</pub-id></mixed-citation>
    </ref>
    <ref id="R44">
      <label>[44]</label>
      <mixed-citation publication-type="journal"><name><surname>Foligne</surname><given-names>B</given-names></name>, <name><surname>Parayre</surname><given-names>S</given-names></name>, <name><surname>Cheddani</surname><given-names>R</given-names></name>, <name><surname>Famelart</surname><given-names>MH</given-names></name>, <name><surname>Madec</surname><given-names>MN</given-names></name>, <name><surname>Ple</surname><given-names>C</given-names></name>, <name><surname>Breton</surname><given-names>J</given-names></name>, <name><surname>Dewulf</surname><given-names>J</given-names></name>, <name><surname>Jan</surname><given-names>G</given-names></name>, and <name><surname>Deutsch</surname><given-names>SM</given-names></name><article-title>Immunomodulation properties of multi-species fermented milks</article-title>. <source>Food Microbiol</source>, <volume>53</volume>(<issue>Pt A</issue>):<fpage>60</fpage>–<lpage>69</lpage>, <month>2</month><year>2016</year>.<pub-id pub-id-type="pmid">26611170</pub-id></mixed-citation>
    </ref>
    <ref id="R45">
      <label>[45]</label>
      <mixed-citation publication-type="journal"><name><surname>Ple</surname><given-names>C</given-names></name>, <name><surname>Breton</surname><given-names>J</given-names></name>, <name><surname>Richoux</surname><given-names>R</given-names></name>, <name><surname>Nurdin</surname><given-names>M</given-names></name>, <name><surname>Deutsch</surname><given-names>SM</given-names></name>, <name><surname>Falentin</surname><given-names>H</given-names></name>, <name><surname>Herve</surname><given-names>C</given-names></name>, <name><surname>Chuat</surname><given-names>V</given-names></name>, <name><surname>Lemee</surname><given-names>R</given-names></name>, <name><surname>Maguin</surname><given-names>E</given-names></name>, <name><surname>Jan</surname><given-names>G</given-names></name>, <name><surname>Van de Guchte</surname><given-names>M</given-names></name>, and <name><surname>Foligne</surname><given-names>B</given-names></name><article-title>Combining selected immunomodulatory Propionibacterium freudenreichii and Lactobacillus delbrueckii strains: Reverse engineering development of an anti-inflammatory cheese</article-title>. <source>Mol Nutr Food Res</source>, <volume>60</volume>(<issue>4</issue>):<fpage>935</fpage>–<lpage>948</lpage>, <month>4</month><year>2016</year>.<pub-id pub-id-type="pmid">26640113</pub-id></mixed-citation>
    </ref>
    <ref id="R46">
      <label>[46]</label>
      <mixed-citation publication-type="journal"><name><surname>Colliou</surname><given-names>Natacha</given-names></name>, <name><surname>Ge</surname><given-names>Yong</given-names></name>, <name><surname>Sahay</surname><given-names>Bikash</given-names></name>, <name><surname>Gong</surname><given-names>Minghao</given-names></name>, <name><surname>Zadeh</surname><given-names>Mojgan</given-names></name>, <name><surname>Owen</surname><given-names>Jennifer L</given-names></name>, <name><surname>Neu</surname><given-names>Josef</given-names></name>, <name><surname>Farmerie</surname><given-names>William G</given-names></name>, <name><surname>Alonzo</surname><given-names>Francis</given-names></name>, <name><surname>Liu</surname><given-names>Ken</given-names></name>, <etal/><article-title>Commensal propionibacterium strain uf1 mitigates intestinal inflammation via th17 cell regulation</article-title>. <source>The Journal of clinical investigation</source>, <volume>127</volume>(<issue>11</issue>):<fpage>3970</fpage>–<lpage>3986</lpage>, <year>2017</year>.<pub-id pub-id-type="pmid">28945202</pub-id></mixed-citation>
    </ref>
  </ref-list>
  <ref-list>
    <label>11</label>
    <title>Methods only references</title>
    <ref id="R47">
      <label>[47]</label>
      <mixed-citation publication-type="journal"><name><surname>Nasrabadi</surname><given-names>Nasser M</given-names></name>. <article-title>Pattern recognition and machine learning</article-title>. <source>Journal of electronic imaging</source>, <volume>16</volume>(<issue>4</issue>):<fpage>049901</fpage>, <year>2007</year>.</mixed-citation>
    </ref>
    <ref id="R48">
      <label>[48]</label>
      <mixed-citation publication-type="book"><name><surname>Pawlowsky-Glahn</surname><given-names>Vera</given-names></name>, <name><surname>Egozcue</surname><given-names>Juan José</given-names></name>, and <name><surname>Tolosana-Delgado</surname><given-names>Raimon</given-names></name>. <source>Modeling and Analysis of Compositional Data</source>. <publisher-name>John Wiley &amp; Sons</publisher-name>, <month>2</month><year>2015</year>.</mixed-citation>
    </ref>
    <ref id="R49">
      <label>[49]</label>
      <mixed-citation publication-type="journal"><name><surname>Mikolov</surname><given-names>Tomas</given-names></name> and <name><surname>Sutskever</surname><given-names>Ilya</given-names></name> and <name><surname>Chen</surname><given-names>Kai</given-names></name> and <name><surname>Corrado</surname><given-names>Greg S</given-names></name> and <name><surname>Dean</surname><given-names>Jeff</given-names></name>. <article-title>Distributed representations of words and phrases and their compositionality</article-title>. In <source>Advances in neural information processing systems</source>, pages <fpage>3111</fpage>–<lpage>3119</lpage>, <year>2013</year>.</mixed-citation>
    </ref>
    <ref id="R50">
      <label>[50]</label>
      <mixed-citation publication-type="journal"><name><surname>Koren</surname><given-names>Yehuda</given-names></name>, <name><surname>Bell</surname><given-names>Robert</given-names></name>, and <name><surname>Volinsky</surname><given-names>Chris</given-names></name>. <article-title>Matrix factorization techniques for recommender systems</article-title>. <source>Computer</source>, (<volume>8</volume>):<fpage>30</fpage>–<lpage>37</lpage>, <year>2009</year>.</mixed-citation>
    </ref>
    <ref id="R51">
      <label>[51]</label>
      <mixed-citation publication-type="journal"><name><surname>Kingma</surname><given-names>Diederik P</given-names></name> and <name><surname>Ba</surname><given-names>Jimmy</given-names></name>. <article-title>Adam: A method for stochastic optimization</article-title>. <source>arXiv preprint arXiv:1412.6980</source>, <year>2014</year>.</mixed-citation>
    </ref>
    <ref id="R52">
      <label>[52]</label>
      <mixed-citation publication-type="journal"><name><surname>Blei</surname><given-names>David M</given-names></name>, <name><surname>Ng</surname><given-names>Andrew Y</given-names></name>, and <name><surname>Jordan</surname><given-names>Michael I</given-names></name>. <article-title>Latent dirichlet allocation</article-title>. <source>Journal of machine Learning research</source>, <volume>3</volume>(<issue>Jan</issue>):<fpage>993</fpage>–<lpage>1022</lpage>, <year>2003</year>.</mixed-citation>
    </ref>
    <ref id="R53">
      <label>[53]</label>
      <mixed-citation publication-type="journal"><name><surname>Sankaran</surname><given-names>Kris</given-names></name> and <name><surname>Holmes</surname><given-names>Susan P</given-names></name>. <article-title>Latent variable modeling for the microbiome</article-title>. <source>arXiv preprint arXiv:1706.04969</source>, <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="R54">
      <label>[54]</label>
      <mixed-citation publication-type="journal"><name><surname>Aitchison</surname><given-names>John</given-names></name> and <name><surname>Greenacre</surname><given-names>Michael</given-names></name>. <article-title>Biplots of compositional data</article-title>. <source>Journal of the Royal Statistical Society: Series C (Applied Statistics)</source>, <volume>51</volume>(<issue>4</issue>):<fpage>375</fpage>–<lpage>392</lpage>, <year>2002</year>.</mixed-citation>
    </ref>
    <ref id="R55">
      <label>[55]</label>
      <mixed-citation publication-type="journal"><name><surname>Aitchison</surname><given-names>John</given-names></name>, <name><surname>Ng</surname><given-names>KW</given-names></name>, <etal/><source>Conditional compositional biplots: theory and application</source>. <year>2005</year>.</mixed-citation>
    </ref>
    <ref id="R56">
      <label>[56]</label>
      <mixed-citation publication-type="journal"><name><surname>Martín-Fernández</surname><given-names>JA</given-names></name>, <name><surname>Pawlowsky-Glahn</surname><given-names>V</given-names></name>, <name><surname>Egozcue</surname><given-names>JJ</given-names></name>, and <name><surname>Tolosona-Delgado</surname><given-names>R</given-names></name>. <article-title>Advances in principal balances for compositional data</article-title>. <source>Mathematical Geosciences</source>, <volume>50</volume>(<issue>3</issue>):<fpage>273</fpage>–<lpage>298</lpage>, <year>2018</year>.</mixed-citation>
    </ref>
    <ref id="R57">
      <label>[57]</label>
      <mixed-citation publication-type="journal"><name><surname>Bolyen</surname><given-names>Evan</given-names></name>, <name><surname>Rideout</surname><given-names>Jai Ram</given-names></name>, <name><surname>Dillon</surname><given-names>Matthew R</given-names></name>, <name><surname>Bokulich</surname><given-names>Nicholas A</given-names></name>, <name><surname>Abnet</surname><given-names>Christian</given-names></name>, <name><surname>Al-Ghalith</surname><given-names>Gabriel A</given-names></name>, <name><surname>Alexander</surname><given-names>Harriet</given-names></name>, <name><surname>Alm</surname><given-names>Eric J</given-names></name>, <name><surname>Arumugam</surname><given-names>Manimozhiyan</given-names></name>, <name><surname>Asnicar</surname><given-names>Francesco</given-names></name>, <etal/><article-title>Qiime 2: Reproducible, interactive, scalable, and extensible microbiome data science</article-title>. <source>Technical report, PeerJ Preprints</source>, <year>2018</year>.</mixed-citation>
    </ref>
    <ref id="R58">
      <label>[58]</label>
      <mixed-citation publication-type="journal"><name><surname>Yoshiki Vázquez-Baeza</surname><given-names>Meg Pirrung</given-names></name>, <name><surname>Gonzalez</surname><given-names>Antonio</given-names></name>, and <name><surname>Knight</surname><given-names>Rob</given-names></name>. <article-title>Emperor: a tool for visualizing high-throughput microbial community data</article-title>. <source>Gigascience</source>, <volume>2</volume>(<issue>1</issue>):<fpage>16</fpage>, <year>2013</year>.<pub-id pub-id-type="pmid">24280061</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="F1" orientation="portrait" position="float">
    <label>Figure 1:</label>
    <caption>
      <p id="P68">Input data types and mmvec neural network architecture. (a) The neural network architecture where the input layer represents one-hot encodings of N microbes and the output layer represents the proportions of M metabolites. U corresponds to microbial vectors and V corresponds to metabolite vectors. (b) The pipeline for training mmvec. The objective behind mmvec is to predict metabolite abundances (y) given a single input microbe sequence (x), also known as a one-hot encoding. This training procedure will estimate conditional probabilities of observing a metabolite given the input microbe sequence. Cross-validation can be performed on hold-out samples to access overfitting.</p>
    </caption>
    <graphic xlink:href="nihms-1540415-f0001"/>
  </fig>
  <fig id="F2" orientation="portrait" position="float">
    <label>Figure 2:</label>
    <caption>
      <p id="P69">Simulation benchmarks. (a) Absolute abundances of microbes and metabolites simulated from differential equations derived in [<xref rid="R27" ref-type="bibr">27</xref>] for a specific spatial point. (b) Proportions of the abundances shown in (a). (c) F1 score, precision and recall curves comparing mmvec to Pearson, Spearman, SparCC, SPIEC-EASI, and proportionality metrics phi and rho across the top 100 metabolites for each microbe. (d) comparisons of coefficients learned from absolute abundances and relative abundances all of the benchmarked methods.</p>
    </caption>
    <graphic xlink:href="nihms-1540415-f0002"/>
  </fig>
  <fig id="F3" orientation="portrait" position="float">
    <label>Figure 3:</label>
    <caption>
      <p id="P70"><italic>M. vaginatus</italic> released metabolites after the biocrust wetting event. (a) Comparison of <italic>M. vaginatus</italic> metabolite interactions estimated from Spearman and mmvec from (n=19 samples). All of the experimentally validated <italic>M. vaginatus</italic> released metabolites are labeled. All metabolites with contradicting findings between the wetting experiment and the <italic>in vitro</italic> experimental results are highlighted in red. Points are resized according to the −10 log(p-value) obtained from Spearman correlation. Dashlines mark the cutoff for a Spearman correlation of zero, and the conditional log probabilities of zero. Here a zero log conditional probability represents the conditional probability of the average metabolite because all probabilities here are mean centered. (b) Benchmarks comparing the detection rate of the experimentally validated molecules across different statistical methodologies. (c) <italic>M. vaginatus</italic> proportions and (d) 4-guanidinobutanoate proportions following a wetting event.</p>
    </caption>
    <graphic xlink:href="nihms-1540415-f0003"/>
  </fig>
  <fig id="F4" orientation="portrait" position="float">
    <label>Figure 4:</label>
    <caption>
      <p id="P71">Investigation of <italic>P.aeruginosa</italic>-associated molecules. (a) Biplot drawn from the mmvec conditional probabilities estimated for the cystic fibrosis dataset [<xref rid="R27" ref-type="bibr">27</xref>]. Arrows represent microbes and dots represent metabolites. The x and y axes represent principal components from the SVD of the microbe-metabolite conditional probabilities estimated from mmvec (n=138 samples). Distances between points quantify co-occurrence strength between metabolites, with small distances indicating metabolites that have a high probability of co-occurring with high probability. Distances between arrow tips quantify co-occurrence strength between microbes. The directionality of the arrows can be used to pinpoint which microbes can explain the metabolite co-occurrence patterns. Arrows highlighted in green correspond to putative cystic fibrosis pathogens and yellow arrows highlight known anaerobes. Only known molecules produced by <italic>P. aeruginosa</italic> are labeled. (b) Scatter plot of molecules with respect to the oxygen gradient differential and the first principal component learned from mmvec (n=442 molecules) with linear regression model and 95% confidence interval for regression estimate. (c) The first principal component vs the number of samples where the taxa was the most abundant taxa in that sample. (d) Heatmap of <italic>P. aeruginosa</italic> and <italic>Streptococcus</italic> abundances in samples where they are the most abundant species. (e) Heatmap of the top 100 molecules that co-occur with <italic>P. aeruginosa</italic> and <italic>Streptococcus</italic>.</p>
    </caption>
    <graphic xlink:href="nihms-1540415-f0004"/>
  </fig>
  <fig id="F5" orientation="portrait" position="float">
    <label>Figure 5:</label>
    <caption>
      <p id="P72">Microbe/metabolite co-occurrences across study of HCC progression in the context of innate immunity in a mouse model [<xref rid="R28" ref-type="bibr">28</xref>]. (a) Visualization of microbial co-occurrence patterns, where distances between points approximates the Aitchison distance between microbes, which quantities microbial occurrences. Small distances are indicative of microbes with high probability of co-occurring together. Microbes are colored according to their association with HFD, which was estimated using differential abundance analysis via multinomial regression. (b) Emperor [59] biplot of microbe-metabolite interactions, with metabolites colored according to their association with HFD. HFD association was estimated through differential abundance analysis via multinomial regression. Distances between points approximate Aitchison distances between metabolites and distances between arrow tips approximate Aitchison distances between microbes. Several <italic>Clostridium spp.</italic> appear to co-occur with the new bile acid molecule cholate phenylalanine amidate, also referred to as Phe conjugated cholic acid.</p>
    </caption>
    <graphic xlink:href="nihms-1540415-f0005"/>
  </fig>
  <fig id="F6" orientation="portrait" position="float">
    <label>Figure 6:</label>
    <caption>
      <p id="P73">Microbe-metabolite interactions of the human microbiome in association with IBD samples [<xref rid="R29" ref-type="bibr">29</xref>]. (a) Heatmap visualization of the inferred conditional probabilities for various bile acids given the presence of <italic>Klebsiella</italic>, <italic>Roseburia</italic> and <italic>Clostridium bolteae</italic>. (b) Heatmap visualization of the inferred conditional probabilities for the carnitines given the presence of <italic>Klebsiella</italic>, <italic>Roseburia</italic>, and <italic>Clostridium bolteae</italic>. (c) Multiomics biplot of the microbe-metabolite interactions learned from metagenomics profiles and C18 negative ion mode LC-MS. Microbes (arrows) and metabolites (spheres) are colored according to their differentials estimated from multinomial regression. <italic>Klebsiella spp.</italic> appears to be strongly associated with IBD, while <italic>Propionibacterium spp.</italic> has strong negative association. (d) Network of the top 300 edges where only the edges that contain <italic>Klebsiella</italic> and <italic>Propionibacteriaceae</italic> are visualized.</p>
    </caption>
    <graphic xlink:href="nihms-1540415-f0006"/>
  </fig>
</floats-group>
