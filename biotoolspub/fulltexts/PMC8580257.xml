<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle pcbi.1009541.r001?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8580257</article-id>
    <article-id pub-id-type="pmid">34714829</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009541</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-21-00651</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Alignment</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Macromolecular Structure Analysis</subject>
            <subj-group>
              <subject>Protein Structure</subject>
              <subj-group>
                <subject>Protein Structure Comparison</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Proteins</subject>
            <subj-group>
              <subject>Protein Structure</subject>
              <subj-group>
                <subject>Protein Structure Comparison</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>RNA</subject>
              <subj-group>
                <subject>Non-coding RNA</subject>
                <subj-group>
                  <subject>Ribosomal RNA</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Ribosomes</subject>
            <subj-group>
              <subject>Ribosomal RNA</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Cell biology</subject>
          <subj-group>
            <subject>Cellular structures and organelles</subject>
            <subj-group>
              <subject>Ribosomes</subject>
              <subj-group>
                <subject>Ribosomal RNA</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Computational Techniques</subject>
          <subj-group>
            <subject>Split-Decomposition Method</subject>
            <subj-group>
              <subject>Multiple Alignment Calculation</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Molecular biology</subject>
          <subj-group>
            <subject>Macromolecular structure analysis</subject>
            <subj-group>
              <subject>RNA structure</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>RNA</subject>
              <subj-group>
                <subject>RNA structure</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Molecular biology</subject>
          <subj-group>
            <subject>Macromolecular structure analysis</subject>
            <subj-group>
              <subject>RNA structure</subject>
              <subj-group>
                <subject>RNA alignment</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>RNA</subject>
              <subj-group>
                <subject>RNA structure</subject>
                <subj-group>
                  <subject>RNA alignment</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Ribosomes</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Structures and Organelles</subject>
            <subj-group>
              <subject>Ribosomes</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleotides</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>TwinCons: Conservation score for uncovering deep sequence similarity and divergence</article-title>
      <alt-title alt-title-type="running-head">TwinCons: Conservation score for uncovering sequence similarity and divergence</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9027-3824</contrib-id>
        <name>
          <surname>Penev</surname>
          <given-names>Petar I.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1827-8946</contrib-id>
        <name>
          <surname>Alvarez-Carreño</surname>
          <given-names>Claudia</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Smith</surname>
          <given-names>Eric</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
        <xref rid="aff005" ref-type="aff">
          <sup>5</sup>
        </xref>
        <xref rid="aff006" ref-type="aff">
          <sup>6</sup>
        </xref>
        <xref rid="aff007" ref-type="aff">
          <sup>7</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3359-7299</contrib-id>
        <name>
          <surname>Petrov</surname>
          <given-names>Anton S.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7215-4194</contrib-id>
        <name>
          <surname>Williams</surname>
          <given-names>Loren Dean</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>NASA Center for the Origin of Life, Georgia Institute of Technology, Atlanta, Georgia, United States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>School of Biological Sciences, Georgia Institute of Technology, Atlanta, Georgia, United States of America</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>School of Chemistry and Biochemistry, Georgia Institute of Technology, Atlanta, Georgia, United States of America</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Earth-Life Science Institute, Tokyo Institute of Technology, Meguro-ku, Tokyo, Japan</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Santa Fe Institute, Santa Fe, New Mexico, United States of America</addr-line>
    </aff>
    <aff id="aff006">
      <label>6</label>
      <addr-line>Department of Physics, The University of Wisconsin-Madison, Madison, Wisconsin, United States of America</addr-line>
    </aff>
    <aff id="aff007">
      <label>7</label>
      <addr-line>Ronin Institute, Montclair, New Jersey, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Ouzounis</surname>
          <given-names>Christos A.</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>CPERI, GREECE</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>anton.petrov@biology.gatech.edu</email> (ASP); <email>loren.williams@chemistry.gatech.edu</email> (LDW)</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <volume>17</volume>
    <issue>10</issue>
    <elocation-id>e1009541</elocation-id>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>4</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>6</day>
        <month>10</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2021 Penev et al</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Penev et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1009541.pdf"/>
    <abstract>
      <p>We have developed the program TwinCons, to detect noisy signals of deep ancestry of proteins or nucleic acids. As input, the program uses a composite alignment containing pre-defined groups, and mathematically determines a ‘cost’ of transforming one group to the other at each position of the alignment. The output distinguishes conserved, variable and signature positions. A signature is conserved within groups but differs between groups. The method automatically detects continuous characteristic stretches (segments) within alignments. TwinCons provides a convenient representation of conserved, variable and signature positions as a single score, enabling the structural mapping and visualization of these characteristics. Structure is more conserved than sequence. TwinCons highlights alternative sequences of conserved structures. Using TwinCons, we detected highly similar segments between proteins from the translation and transcription systems. TwinCons detects conserved residues within regions of high functional importance for the ribosomal RNA (rRNA) and demonstrates that signatures are not confined to specific regions but are distributed across the rRNA structure. The ability to evaluate both nucleic acid and protein alignments allows TwinCons to be used in combined sequence and structural analysis of signatures and conservation in rRNA and in ribosomal proteins (rProteins). TwinCons detects a strong sequence conservation signal between bacterial and archaeal rProteins related by circular permutation. This conserved sequence is structurally colocalized with conserved rRNA, indicated by TwinCons scores of rRNA alignments of bacterial and archaeal groups. This combined analysis revealed deep co-evolution of rRNA and rProtein buried within the deepest branching points in the tree of life.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>All species on Earth can be thought of as leaves on the Tree of Life, which are connected by branches representing their ancestral relationships. Biopolymers are evolutionary markers within species, that contain records of evolutionary history. Excavation of molecular evolutionary histories involves collecting sequences from extant species and organizing them into multiple sequence alignments. For the purpose of comparison, the sequences within an alignment can be partitioned into two groups, resulting in a composite alignment. We have developed the program TwinCons, to detect noisy signals of deep ancestry. TwinCons distinguishes conserved, variable and signature positions between the groups of the composite alignment. A signature is a position conserved within each group but differing between groups. TwinCons can further be used to detect uninterrupted ranges of positions (segments) preserved within the composite alignment. TwinCons results can be mapped onto structures of molecules. TwinCons scores can be applied to either proteins or ribonucleic acids (RNA). Using TwinCons we detected highly similar segments across ancient and essential protein components of living cells (translation and transcription) and pinpointed the deepest signatures between bacterial and archaeal RNAs within the ribosome.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000104</institution-id>
            <institution>National Aeronautics and Space Administration</institution>
          </institution-wrap>
        </funding-source>
        <award-id>80NSSC18K1139</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7215-4194</contrib-id>
          <name>
            <surname>Williams</surname>
            <given-names>Loren Dean</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000104</institution-id>
            <institution>National Aeronautics and Space Administration</institution>
          </institution-wrap>
        </funding-source>
        <award-id>80NSSC18K1139</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3359-7299</contrib-id>
          <name>
            <surname>Petrov</surname>
            <given-names>Anton S.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000104</institution-id>
            <institution>National Aeronautics and Space Administration</institution>
          </institution-wrap>
        </funding-source>
        <award-id>NASA postdoctoral program fellowship</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1827-8946</contrib-id>
          <name>
            <surname>Alvarez-Carreño</surname>
            <given-names>Claudia</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This work was funded by the National Aeronautics and Space Administration grant 80NSSC18K1139 awarded to LDW and ASP. CA-C was supported by the NASA Postdoctoral Program fellowship award. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="6"/>
      <table-count count="2"/>
      <page-count count="32"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2021-11-10</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The TwinCons source code is available at <ext-link xlink:href="https://github.com/LDWLab/TwinCons" ext-link-type="uri">https://github.com/LDWLab/TwinCons</ext-link> The source code also includes scripts used for dataset processing and classifier training and evaluation. TwinCons is also available as a python package in the Python Package Index <ext-link xlink:href="https://pypi.org/project/TwinCons/" ext-link-type="uri">https://pypi.org/project/TwinCons/</ext-link>. The script used for calculating rRNA TwinCons distributions is available at <ext-link xlink:href="https://github.com/LDWLab/TWC_distribution" ext-link-type="uri">https://github.com/LDWLab/TWC_distribution</ext-link>. The github projects were archived at <ext-link xlink:href="https://zenodo.org/record/4654505" ext-link-type="uri">https://zenodo.org/record/4654505</ext-link>. Alignment datasets Training datasets, query composite alignments, and the caspase-metacaspase alignment are available at: <ext-link xlink:href="https://apollo2.chemistry.gatech.edu/TwinConsDatasets/" ext-link-type="uri">https://apollo2.chemistry.gatech.edu/TwinConsDatasets/</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The TwinCons source code is available at <ext-link xlink:href="https://github.com/LDWLab/TwinCons" ext-link-type="uri">https://github.com/LDWLab/TwinCons</ext-link> The source code also includes scripts used for dataset processing and classifier training and evaluation. TwinCons is also available as a python package in the Python Package Index <ext-link xlink:href="https://pypi.org/project/TwinCons/" ext-link-type="uri">https://pypi.org/project/TwinCons/</ext-link>. The script used for calculating rRNA TwinCons distributions is available at <ext-link xlink:href="https://github.com/LDWLab/TWC_distribution" ext-link-type="uri">https://github.com/LDWLab/TWC_distribution</ext-link>. The github projects were archived at <ext-link xlink:href="https://zenodo.org/record/4654505" ext-link-type="uri">https://zenodo.org/record/4654505</ext-link>. Alignment datasets Training datasets, query composite alignments, and the caspase-metacaspase alignment are available at: <ext-link xlink:href="https://apollo2.chemistry.gatech.edu/TwinConsDatasets/" ext-link-type="uri">https://apollo2.chemistry.gatech.edu/TwinConsDatasets/</ext-link>.</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic toggle="yes">PLOS Computational Biology</italic> Methods paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Advances in sequencing and metagenomics [<xref rid="pcbi.1009541.ref001" ref-type="bibr">1</xref>] allow biologists to observe alterations in cancer genomes [<xref rid="pcbi.1009541.ref002" ref-type="bibr">2</xref>], identify genetic novelty [<xref rid="pcbi.1009541.ref003" ref-type="bibr">3</xref>], characterize microbial communities [<xref rid="pcbi.1009541.ref004" ref-type="bibr">4</xref>], fold protein sequences [<xref rid="pcbi.1009541.ref005" ref-type="bibr">5</xref>], and unravel ancestral relationships [<xref rid="pcbi.1009541.ref006" ref-type="bibr">6</xref>–<xref rid="pcbi.1009541.ref008" ref-type="bibr">8</xref>]. Sequence data are commonly analyzed and interpreted in the form of multiple sequence alignments in which rows are linear sequences and columns are analyzed to quantitate conservation, which can indicate homology and common ancestry [<xref rid="pcbi.1009541.ref009" ref-type="bibr">9</xref>].</p>
    <sec id="sec002">
      <title>Composite alignments</title>
      <p>We wish to probe ancestral relationships within the translation and transcription systems, which contain some of the oldest proteins and RNAs in the biological world. Can we look back far beyond the Last Universal Common Ancestor (LUCA) [<xref rid="pcbi.1009541.ref010" ref-type="bibr">10</xref>] and establish whether segments of ribosomal proteins (rProteins) share ancestry with segments of RNA polymerase (RNAP) or translation factors, and determine how these segments interplay with nearly RNA? For that purpose, here we establish and apply a score of conservation within a composite alignment, which is a multiple sequence alignment containing two pre-defined sequence groups. For example, in a composite alignment of a single gene, one group could be bacterial sequences while the other could be archaeal sequences. Alternatively, a composite alignment might contain paralogous sequences, where two different but related genes form the groups. One group could be an initiation factor and the other group could be an elongation factor. In this scenario, the homology within each group is known or suspected, but homology between the groups is in question. The method developed here, called TwinCons, can be applied to either protein or nucleic acid sequences. Classical methods consider only conserved and non-conserved alignment positions, while TwinCons differentiates between universal, signature, and non-conserved segments or positions.</p>
    </sec>
    <sec id="sec003">
      <title>Phylogenetic signatures</title>
      <p>Universal positions are conserved within and between groups. We define and detect signature positions as those that are conserved within groups but differ between groups. Signature positions have high mutational cost between groups as defined by substitution matrices [<xref rid="pcbi.1009541.ref011" ref-type="bibr">11</xref>–<xref rid="pcbi.1009541.ref013" ref-type="bibr">13</xref>]. Protein signature positions that exhibit radical differences between groups have been referred to as “functionally divergent” [<xref rid="pcbi.1009541.ref014" ref-type="bibr">14</xref>,<xref rid="pcbi.1009541.ref015" ref-type="bibr">15</xref>] or “constant-but-different” [<xref rid="pcbi.1009541.ref016" ref-type="bibr">16</xref>] or “subfamily specific” [<xref rid="pcbi.1009541.ref017" ref-type="bibr">17</xref>,<xref rid="pcbi.1009541.ref018" ref-type="bibr">18</xref>] or positions that maximize functional similarity within groups and functional variation between groups [<xref rid="pcbi.1009541.ref019" ref-type="bibr">19</xref>]. Such positions hint at differential mechanisms of function between groups. Signature positions that exhibit differences in group-specific evolutionary rates suggest residues that are critical for the function of one group but not the other [<xref rid="pcbi.1009541.ref020" ref-type="bibr">20</xref>–<xref rid="pcbi.1009541.ref022" ref-type="bibr">22</xref>].</p>
    </sec>
    <sec id="sec004">
      <title>Search for ancient conservation</title>
      <p>Classical methods for homology detection are based on alignments of a query sequence and a database of annotated sequences, using sequence similarity scores or sequence profiles. Some of the most widely used methods to detect homology employ local sequence similarity and Hidden Markov Models [<xref rid="pcbi.1009541.ref023" ref-type="bibr">23</xref>–<xref rid="pcbi.1009541.ref031" ref-type="bibr">31</xref>]. These methods, together with annotated motif descriptor databases are the basis of protein classification systems, and of function and structure prediction algorithms [<xref rid="pcbi.1009541.ref032" ref-type="bibr">32</xref>]. These methods have become standards in annotating novel sequences, and they infer ancestry of long conserved regions. Traditional methods rarely produce positive results from deep and noisy ancestry that is locked in short segments of proteins with different functions and structures. In these cases, researchers directly inspect conservation levels within alignments to discover specific functional sites and homologies within a group of sequences [<xref rid="pcbi.1009541.ref033" ref-type="bibr">33</xref>–<xref rid="pcbi.1009541.ref037" ref-type="bibr">37</xref>].</p>
      <p>Alignments provide a variety of information such as relative rates of mutation. Substitution models are obtained by determining which substitutions are common or rare in alignments of homologous sequences [<xref rid="pcbi.1009541.ref038" ref-type="bibr">38</xref>–<xref rid="pcbi.1009541.ref042" ref-type="bibr">42</xref>]. Further sequestering alignments by different functions or structure classes allows construction of substitution models of specific structural elements [<xref rid="pcbi.1009541.ref043" ref-type="bibr">43</xref>] or among specialized types of proteins (e.g. membrane proteins [<xref rid="pcbi.1009541.ref044" ref-type="bibr">44</xref>], mitochondrial proteins [<xref rid="pcbi.1009541.ref045" ref-type="bibr">45</xref>]). Henikoff &amp; Henikoff [<xref rid="pcbi.1009541.ref046" ref-type="bibr">46</xref>] used distantly related sequences to calculate BLOSUM matrices, which do not implement any evolutionary model, but are rather a direct observation on substitution frequencies within alignment sequence blocks.</p>
      <p>The neutral theory of molecular evolution [<xref rid="pcbi.1009541.ref047" ref-type="bibr">47</xref>] states that structurally and/or functionally important sites within proteins experience stronger selection, with lower rates of change. Therefore, high conservation has been widely used as an indicator for functionally important sites within proteins [<xref rid="pcbi.1009541.ref037" ref-type="bibr">37</xref>,<xref rid="pcbi.1009541.ref048" ref-type="bibr">48</xref>–<xref rid="pcbi.1009541.ref050" ref-type="bibr">50</xref>]. Numerous studies have applied this theory by calculating evolutionary rates from alignments based on specific positions [<xref rid="pcbi.1009541.ref051" ref-type="bibr">51</xref>,<xref rid="pcbi.1009541.ref052" ref-type="bibr">52</xref>], specific structures [<xref rid="pcbi.1009541.ref043" ref-type="bibr">43</xref>], or global phylogenies [<xref rid="pcbi.1009541.ref033" ref-type="bibr">33</xref>]. Statistical methods have been developed to detect sequence divergencies between duplicated genes [<xref rid="pcbi.1009541.ref015" ref-type="bibr">15</xref>,<xref rid="pcbi.1009541.ref053" ref-type="bibr">53</xref>,<xref rid="pcbi.1009541.ref054" ref-type="bibr">54</xref>] and have been used to discover functionally important changes between proteins [<xref rid="pcbi.1009541.ref055" ref-type="bibr">55</xref>,<xref rid="pcbi.1009541.ref056" ref-type="bibr">56</xref>].</p>
    </sec>
    <sec id="sec005">
      <title>The TwinCons score</title>
      <p>In the current work we describe TwinCons–which quantifies sequence conservation and signature positions in protein or nucleic acid composite alignments. TwinCons highlights universally conserved, variable, and signature positions in alignments of enzymatic and non-enzymatic proteins. TwinCons detects short segments that are common between proteins. Such short segments are hypothesized to have recorded the deepest relationships between proteins [<xref rid="pcbi.1009541.ref057" ref-type="bibr">57</xref>,<xref rid="pcbi.1009541.ref058" ref-type="bibr">58</xref>]. Using TwinCons `full capabilities allowed us to discover correlations between highly similar rProtein segments and ribosomal RNA (rRNA) signatures in the most ancient ribosomal components. The TwinCons method incorporates a composite alignment, with groups for each polymer of interest. The method uses prior information on ancestry within each group. Instead of calculating statistics of similarity, we mathematically determine a ‘cost’ of transforming an alignment column of one group to the corresponding alignment column of the other group.</p>
      <p>TwinCons offers advantages over previous methods. TwinCons identifies and discriminates between universally conserved sites (large positive scores), intra-group signature sites (large negative scores) and random sites (near zero scores). A positive TwinCons value corresponds to conservation within each group in addition to conservation between the groups. A negative TwinCons value represents conservation within groups and divergence between groups. Finally, a TwinCons value near zero represents variability within and between groups.</p>
    </sec>
  </sec>
  <sec sec-type="materials|methods" id="sec006">
    <title>Materials and methods</title>
    <sec id="sec007">
      <title>TwinCons calculation methodology</title>
      <sec id="sec008">
        <title>Summary</title>
        <p>TwinCons computes and compares, for each position of a composite alignment, two 20-dimensional vectors of amino acid frequencies, one for each group. For nucleic acid alignments the vectors are in 4-dimensions. TwinCons extends the formalism of a pairwise alignment to composite alignment between two groups (See Supplementary text in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref> for a detailed description). TwinCons computes the price of transformation of one vector onto the other, filtered by a substitution matrix. The nature of the conservation is defined by the substitution matrix, and can be based on empirical mutational frequencies, physico-chemical properties, etc. The scores computed over all columns within a composite alignment can be used to identify conserved regions, signature regions and random regions between the two groups. Thus, the proposed score provides multiple utilities, and is useful for comprehensive analysis of deep protein ancestry.</p>
      </sec>
      <sec id="sec009">
        <title>Selection of groups within the alignment</title>
        <p>TwinCons is a metric that estimates the similarity between two sequence groups for each position within a composite alignment considering global substitution frequencies inferred from a substitution matrix (Table A in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>). Similarity is determined by the values of off diagonal elements in the substitution matrix. For each alignment position two distributions of frequencies are calculated based on the two groups: Group I and Group II that are defined prior to TwinCons calculations. Groups can be manually defined in the input alignment or computed using the deepest branching point of a phylogenetic tree, built from the input alignment.</p>
      </sec>
      <sec id="sec010">
        <title>Gap adjustment in the composite alignment</title>
        <p>The TwinCons score performs gap adjustment by prorating their frequency. Prorating can be done uniformly (for protein and nucleic acid alignments) or by using the background frequency of a specified substitution matrix (only for protein alignments, default option). With uniform prorating option, a single gap character counts as 0.05 of every amino acid residue (for a protein alignment) or 0.25 of every nucleotide (for nucleic acid alignments). With frequency prorating option, each gap contributes a skewed frequency distribution from all 20 amino acids, provided from the substitution matrix. The gap adjusted frequencies for each group are then computed for every column of the alignment and used for the TwinCons calculations.</p>
        <p>Heavily gapped columns can be ignored by removing them from the calculation. The default gap percentage threshold (GT) for a column to be removed is calculated as:
<disp-formula id="pcbi.1009541.e001"><alternatives><graphic xlink:href="pcbi.1009541.e001.jpg" id="pcbi.1009541.e001g" position="anchor"/><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mi>G</mml:mi><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mtext>min</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></alternatives><label>(1)</label></disp-formula>
where G1 and G2 denote the number of sequences present in each group and min is a function that takes the smaller result. This ensures that regions present only in one group are removed and is most useful when mapping results on three-dimensional structures. Gapped regions in an alignment can be omitted with the option “-cg”. The option “-gt” followed by percentage as a decimal number (e.g., 0.9 = 90% gaps) can be used to override the default percentage for removal of columns.</p>
      </sec>
      <sec id="sec011">
        <title>Vector frequency calculations</title>
        <p>We represent the distributions of the gap adjusted frequencies in each column of Groups I and II as n-dimensional vectors Xn and Yn. With “n” we denote the number of possible residues (n = 4 in nucleotide alignments and n = 20 in amino-acid alignments). Each value in the vector is the fractional occurrence for a given residue, therefore the sum of values within one vector always equals one.</p>
      </sec>
      <sec id="sec012">
        <title>Frequency weighting</title>
        <p>Each sequence within a group optionally can be weighted based on its distance from the other sequences using either a Voronoi algorithm [<xref rid="pcbi.1009541.ref059" ref-type="bibr">59</xref>] or distance based on branch length of a tree [<xref rid="pcbi.1009541.ref060" ref-type="bibr">60</xref>]. Thus, if an alignment contains many identical sequences, they will be given less importance.</p>
      </sec>
      <sec id="sec013">
        <title>Substitution matrices in TwinCons</title>
        <p>TwinCons supports a variety of substitution matrices in log-odds form and is designed to work both with nucleotide and protein alignments. For nucleotides we can select between a simple identity matrix, a transition/transversion matrix and the <italic toggle="yes">blastn</italic> matrix (Table A in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>). For amino acids we support a variety of substitution matrices (Table A in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>) [<xref rid="pcbi.1009541.ref061" ref-type="bibr">61</xref>]. Many of the available matrices are evolutionary informed by mutational rates from global alignments (like Blosum62) and their off-diagonal values confer information about signature substitutions. When provided with a structure file we use structurally informed substitution matrices that account for the partitioning of sequence into secondary and 3D structure information (Table A in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>) [<xref rid="pcbi.1009541.ref043" ref-type="bibr">43</xref>]. Custom matrices in the PAML triangular format are also supported [<xref rid="pcbi.1009541.ref062" ref-type="bibr">62</xref>,<xref rid="pcbi.1009541.ref063" ref-type="bibr">63</xref>]. Throughout the manuscript we use structurally informed LG-derived substitution matrices when a structure is available for both groups within a composite alignment. When structures are not available, we use the LG matrix which does no structural partitioning.</p>
      </sec>
      <sec id="sec014">
        <title>TwinCons calculations</title>
        <p>To calculate the cost of transforming one frequency vector in another we take the transpose of one of the vectors and dot multiply both vectors by the scoring matrix. Thus, for each alignment position TwinCons (TWC) is calculated as:
<disp-formula id="pcbi.1009541.e002"><alternatives><graphic xlink:href="pcbi.1009541.e002.jpg" id="pcbi.1009541.e002g" position="anchor"/><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:mi>T</mml:mi><mml:mi>W</mml:mi><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>*</mml:mo><mml:mi>M</mml:mi><mml:mo>*</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>n</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives><label>(2)</label></disp-formula>
where X<sub>n</sub><sup>T</sup> is a column vector of frequency components for Group I, Y<sub>n</sub>, is a raw vector of frequency components for Group II, and M is a transformation matrix (the cost of the transformation), which determines the mutation penalties between each pair of residues or nucleotides. For a complete mathematical justification of the TwinCons calculation see Supplementary text in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>. The scoring matrices M are symmetric (equal to their transpose), therefore TwinCons does not discriminate between departure and arrival points. In a given composite alignment, TwinCons is computed for each position of the alignment.</p>
      </sec>
      <sec id="sec015">
        <title>Baseline correction</title>
        <p>The range of TwinCons values depends on the matrix used. To have an ability of comparing TwinCons scores computed using different matrices, we performed baseline correction. Each matrix is adjusted by adding a value to each of its elements such that the TwinCons computed for a selected distribution is zero. The value is calculated either uniformly or, when available, using the background frequency of the substitution matrix (option “-bn”). The default behavior is to use background frequency. In both cases the baseline correction aims to produce a matrix which evaluates to 0 when dot multiplied with the baselining vectors. When using uniform baseline correction TwinCons is comparable to conservation scores, except that it accounts for multiple groups. Classical conservation scores show maximum entropy, no information and zero conservation for completely random positions. When using background frequency baseline correction TwinCons produces scores which are more realistic for biological sequences.</p>
        <p>Baseline correction follows naturally from the interpretation of TwinCons as a log-likelihood score for paired sets of aligned residues, sampled from the leaves of a branching process generated by the chosen substitution matrix. The baseline derived from the substitution matrix is simply the expectation of TwinCons on a random sample, and thus the null hypothesis under that generating model for samples grouped in the same way as the data. The derivation of TwinCons as a statistic, including the baseline correction, and possible compositional adjustments [<xref rid="pcbi.1009541.ref064" ref-type="bibr">64</xref>,<xref rid="pcbi.1009541.ref065" ref-type="bibr">65</xref>] is provided in the Supplementary text in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>.</p>
        <p>No additional normalization is performed to the maximal and minimal intensities across different matrices. These values are a meaningful description of the evolutionary processes present in the original datasets used to build the matrices. The TwinCons score tries to maximally preserve this information.</p>
      </sec>
      <sec id="sec016">
        <title>Example</title>
        <p>For example, an alignment position has the nucleotide distribution ‘GATTACA’ in one group and ‘AAAAAAA’ in the other group, this will produce a pair of 4-dimensional vectors (<xref rid="pcbi.1009541.e003" ref-type="disp-formula">Eq 3</xref>).
<disp-formula id="pcbi.1009541.e003"><alternatives><graphic xlink:href="pcbi.1009541.e003.jpg" id="pcbi.1009541.e003g" position="anchor"/><mml:math id="M3" display="block" overflow="scroll"><mml:mrow><mml:mtext>GCAT</mml:mtext><mml:mo>:</mml:mo><mml:mspace width="0.25em"/><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0.14</mml:mn><mml:mo>,</mml:mo><mml:mn>0.14</mml:mn><mml:mo>,</mml:mo><mml:mn>0.44</mml:mn><mml:mo>,</mml:mo><mml:mn>0.28</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>GATTACA</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives><label>(3)</label></disp-formula>
<disp-formula id="pcbi.1009541.e004"><alternatives><graphic xlink:href="pcbi.1009541.e004.jpg" id="pcbi.1009541.e004g" position="anchor"/><mml:math id="M4" display="block" overflow="scroll"><mml:mrow><mml:mtext>GCAT</mml:mtext><mml:mo>:</mml:mo><mml:mspace width="0.25em"/><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>AAAAAAA</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>
These vectors can be represented as points in a 4-dimensional space; to reach one point from the other we must traverse the space between them. To represent the costs associated with traversing that distance we use an n-by-n scoring matrix. In our example we use a 4-by-4 matrix defined from the blastn algorithm and adjusted to produce score zero for uniform vectors. TwinCons for our example vectors evaluates to 1.71 (<xref rid="pcbi.1009541.e005" ref-type="disp-formula">Eq 4</xref>).</p>
        <disp-formula id="pcbi.1009541.e005">
          <alternatives>
            <graphic xlink:href="pcbi.1009541.e005.jpg" id="pcbi.1009541.e005g" position="anchor"/>
            <mml:math id="M5" display="block" overflow="scroll">
              <mml:mrow>
                <mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:mn>0.14</mml:mn>
                    <mml:mspace width="0.25em"/>
                    <mml:mn>0.14</mml:mn>
                    <mml:mspace width="0.25em"/>
                    <mml:mn>0.44</mml:mn>
                    <mml:mspace width="0.25em"/>
                    <mml:mn>0.28</mml:mn>
                  </mml:mrow>
                  <mml:mo>|</mml:mo>
                </mml:mrow>
                <mml:mo>*</mml:mo>
                <mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:mtable>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mn>6.75</mml:mn>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>2.25</mml:mn>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>2.25</mml:mn>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>2.25</mml:mn>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>2.25</mml:mn>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mn>6.75</mml:mn>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>2.25</mml:mn>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>2.25</mml:mn>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>2.25</mml:mn>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>2.25</mml:mn>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mn>6.75</mml:mn>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>2.25</mml:mn>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>2.25</mml:mn>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>2.25</mml:mn>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>2.25</mml:mn>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mn>6.75</mml:mn>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                  </mml:mrow>
                  <mml:mo>|</mml:mo>
                </mml:mrow>
                <mml:mo>*</mml:mo>
                <mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:mtable>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mn>0</mml:mn>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mn>0</mml:mn>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mn>1</mml:mn>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mn>0</mml:mn>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                  </mml:mrow>
                  <mml:mo>|</mml:mo>
                </mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:mn>1.71</mml:mn>
              </mml:mrow>
            </mml:math>
          </alternatives>
          <label>(4)</label>
        </disp-formula>
      </sec>
    </sec>
    <sec id="sec017">
      <title>Evaluating group similarity with TwinCons</title>
      <p>To evaluate similarity between groups from a composite alignment we calculate segments based on TwinCons scores. A segment is defined as a range of positions, within which the cumulative TwinCons score is continuously increasing. To calculate a cumulative representation of the score we consecutively add the TwinCons score for each position. Next, the cumulative score is smoothed using the Savitzky-Golay filter [<xref rid="pcbi.1009541.ref066" ref-type="bibr">66</xref>]. Segments are detected by identifying local minima and maxima of the smoothed cumulative score. That way we generate positive uninterrupted segments (<xref rid="pcbi.1009541.g001" ref-type="fig">Fig 1C</xref>). Each alignment generates a distribution of these segments with different lengths. The sum of scores for each position within a segment is considered as the weight of a segment. Thus, there are two variables describing each segment–length and weight; they are normalized against the lengths and weights of the dataset used for evaluation. Alignments that produce positive segments with greater lengths and weights have groups of sequences that are more similar than groups from alignments that generate smaller segments (<xref rid="pcbi.1009541.g001" ref-type="fig">Fig 1D</xref>). An alignment comprised entirely of random sequences will produce TwinCons score around zero for all alignment positions when using uniform baseline correction, and the cumulative score will have many troughs. All positive segments will have short lengths. In contrast, an alignment comprised entirely of identical sequences will produce a continually increasing cumulative score, without any troughs, resulting in a single positive uninterrupted segment with length equal to the number of columns within the alignment. Therefore, groups within alignments that produce larger positive segments have sequences that are more similar and are more likely to share ancient ancestry. Detection of segments and calculation of TwinCons scores can be automated. Below we provide a detailed description of the automation process and the necessary parametrization procedure. Parametrization depends on a large number of composite alignments and makes the inclusion of structure-informed matrices intractable. We describe the rationale for the parameter choices we have made and possible alternatives that have been studied during the parametrization.</p>
      <fig position="float" id="pcbi.1009541.g001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009541.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>TwinCons results from composite alignments.</title>
          <p>(A) Example composite sequence alignment. Conserved positions within each group are shaded blue for hydrophobic residues and red for charged residues; variable positions are not shaded. Consistent color spanning two groups represents conservation. Change of colors between but not within groups represents signature. (B) TwinCons score for each position in the example composite alignment. Conservation spanning groups produces large positive TwinCons scores (green, positions 1–3, 5). Conservation within but not between groups produces negative scores (purple, position 4). Variability within and between groups produces scores near 0 (white, position 9). Columns with high proportion of gaps produce score equal to 0 (position 10). (C) Cumulative TwinCons score calculated from positional scores. Local minima are indicated with black squares and local maxima are indicated with black stars. Segments are defined as the alignment positions between adjacent local minima (squares) and maxima (stars). Resulting segments are indicated with red arrows. (D) TwinCons results for segments from the BaliBASE multiple alignments. Segments from alignments with related sequence groups are shown with white circles and segments from alignments with unrelated sequence groups are shown with black circles. Each alignment produces multiple segments with normalized length and weight plotted on the 2D graph. One alignment can produce multiple segments (white circles with red boundaries). Segment length and weight is normalized by the maximal length and weight present in the dataset. Circle sizes indicate absolute segment lengths. The decision boundary calculated between segments from related sequence groups (white circles) and segments from unrelated sequence groups (black circles) is shown with red line. Distance away from the decision boundary in the range of -1 to +1 is shown with a diverging gradient and magenta dotted line. Cross validation statistics of true positive rate (TPR) and true negative rate (TNR) for detecting correct assignments of the alignments for each decision boundary distance are on the right.</p>
        </caption>
        <graphic xlink:href="pcbi.1009541.g001" position="float"/>
      </fig>
      <sec id="sec018">
        <title>Automated identification of protein segment similarities</title>
        <p>To determine whether two sequence groups are related we must define a boundary that separates short segments from long segments. The discrimination is performed in Cartesian space of the segment lengths and weights (<xref rid="pcbi.1009541.g001" ref-type="fig">Fig 1D</xref>). To calculate a separation boundary between segments generated from alignments with related and unrelated groups, we generated multiple composite alignment training sets that include alignments from random sequences with INDElible [<xref rid="pcbi.1009541.ref067" ref-type="bibr">67</xref>] and from biological sequences using rProteins, the BaliBASE database [<xref rid="pcbi.1009541.ref068" ref-type="bibr">68</xref>], and PROSITE [<xref rid="pcbi.1009541.ref069" ref-type="bibr">69</xref>,<xref rid="pcbi.1009541.ref070" ref-type="bibr">70</xref>]. Each set contains true positive composite alignments (TP) with groups known to be ancestrally related and true negative alignments (TN) with groups that do not share ancestry (<xref rid="pcbi.1009541.t001" ref-type="table">Table 1</xref>). Some TN composite alignments were filtered to ensure that they do not contain groups with shared ancestry. Complete description of the four training datasets is available in the Supplementary text in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>.</p>
        <table-wrap position="float" id="pcbi.1009541.t001">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1009541.t001</object-id>
          <label>Table 1</label>
          <caption>
            <title>Sources, numbers, and applied filtering of training datasets.</title>
            <p>Details for the source of each training dataset are given as reference to relevant publications. Numbers of TP and TN indicate the number of composite alignments used to train classifiers. Details on the composite alignment generation and filtering procedures for each dataset are available in the Supplementary text in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>. The INDELible program uses a control file which we provide as <xref rid="pcbi.1009541.s009" ref-type="supplementary-material">S8 Dataset</xref>. All composite alignments are available at <ext-link xlink:href="https://apollo2.chemistry.gatech.edu/TwinConsDatasets/" ext-link-type="uri">https://apollo2.chemistry.gatech.edu/TwinConsDatasets/</ext-link>.</p>
          </caption>
          <alternatives>
            <graphic xlink:href="pcbi.1009541.t001" id="pcbi.1009541.t001g" position="float"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="center" rowspan="1" colspan="1">Dataset</th>
                  <th align="center" rowspan="1" colspan="1">Source</th>
                  <th align="center" rowspan="1" colspan="1">TP composite alignments</th>
                  <th align="center" rowspan="1" colspan="1">TN composite alignments</th>
                  <th align="center" rowspan="1" colspan="1">TN Filtering</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">INDELible</td>
                  <td align="center" rowspan="1" colspan="1">Simulator of biological evolution [<xref rid="pcbi.1009541.ref067" ref-type="bibr">67</xref>]</td>
                  <td align="center" rowspan="1" colspan="1">22</td>
                  <td align="center" rowspan="1" colspan="1">179</td>
                  <td align="center" rowspan="1" colspan="1">Removed 11 TN for which the random generation performed poorly.</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Ribosomal proteins</td>
                  <td align="center" rowspan="1" colspan="1">Sparse and Efficient Representation of the Extant Biology (SEREB)[<xref rid="pcbi.1009541.ref071" ref-type="bibr">71</xref>]</td>
                  <td align="center" rowspan="1" colspan="1">32</td>
                  <td align="center" rowspan="1" colspan="1">178</td>
                  <td align="center" rowspan="1" colspan="1">Combination of SSU rProteins for TN</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">BaliBASE</td>
                  <td align="center" rowspan="1" colspan="1">BaliBASE multiple alignment suite reference dataset 3 [<xref rid="pcbi.1009541.ref068" ref-type="bibr">68</xref>]</td>
                  <td align="center" rowspan="1" colspan="1">38</td>
                  <td align="center" rowspan="1" colspan="1">141</td>
                  <td align="center" rowspan="1" colspan="1">Removed TN, which contain alignment groups with similar structural folds or functions (<xref rid="pcbi.1009541.s002" ref-type="supplementary-material">S1 Dataset</xref>).</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">PROSITE</td>
                  <td align="center" rowspan="1" colspan="1">Protein patterns and profiles [<xref rid="pcbi.1009541.ref069" ref-type="bibr">69</xref>,<xref rid="pcbi.1009541.ref070" ref-type="bibr">70</xref>]</td>
                  <td align="center" rowspan="1" colspan="1">120</td>
                  <td align="center" rowspan="1" colspan="1">36856</td>
                  <td align="center" rowspan="1" colspan="1">Combinations based on motifs within the same documentation entry.</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
        <p>Using the training datasets, we executed performance optimization and selection of various TwinCons and segment delineation parameters. The parameters were evaluated to discern the combination that best discriminates between TN and TP. Afterwards, we split the training datasets to evaluate the best penalty parameter for training a classifier. The best performing classifier was evaluated against the full datasets to calculate its precision and to define a significance threshold away from the boundary that defines a segment with high similarity between the groups of the composite alignment. The detailed steps of parametrization and training as well as the selected options for each parameter are described below.</p>
      </sec>
      <sec id="sec019">
        <title>Training a decision boundary</title>
        <p>TP and TN composite alignments were used as a training set for classifiers based on support vector machines (SVM) [<xref rid="pcbi.1009541.ref072" ref-type="bibr">72</xref>], or forests of randomized decision trees [<xref rid="pcbi.1009541.ref073" ref-type="bibr">73</xref>]. An SVM can find an optimal decision boundary that separates the TP and TN parts of a dataset. A random forest of decision trees gives a probabilistic result based on the voting average of each tree. We compared classifiers from the SVM and random forest families generated with the python <italic toggle="yes">sklearn</italic> library [<xref rid="pcbi.1009541.ref074" ref-type="bibr">74</xref>]. Each of the training datasets was used to generate a separate classifier which were validated against each other. Each segment was represented by two variables–normalized segment length and total segment weight, additionally each segment’s importance was weighted by its total length. Every alignment produces segments that are very small and short. The difference between alignments with related (TP) and unrelated (TN) groups is that alignments with related groups also produce larger and heavier segments. Therefore, when training the decision boundary, we tried using all segments or filtering out the bottom 50% of scoring segments. When filtering each alignment, we used only the largest segments that cover 50% of the total normalized length and total absolute length of all alignment segments.</p>
      </sec>
      <sec id="sec020">
        <title>Parameterization of TwinCons segment calculation</title>
        <p>Calculations of the TwinCons scores and segments depend on multiple parameters: a) the substitution matrix used, b) the baseline correction (uniform or background frequency), c) the weighing algorithm for sequences, d) threshold for determining segment boundaries (the window size for smoothing the cumulative score or the absolute intensity and length thresholds), e) percentage gaps to be removed from the alignment before a calculation is done, f) filtering out low scoring segments, g) treating signature positions as conserved positions, h) calculating a single average segment position (central mass) from all segments of an alignment, and i) the classifier used.</p>
        <p>To identify the combination of parameters that produces most robust differentiation between segments from TP and TN composite alignments, we generated classifiers for segments generated with combinations of TwinCons parameters. Then we calculated a receiver operating characteristic by testing the training sets against the other datasets (Fig A in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref> and <xref rid="pcbi.1009541.s003" ref-type="supplementary-material">S2 Dataset</xref>). Performance can be measured by calculating the percentage area under curve (AUC) statistic.</p>
        <p>Our results demonstrate that SVM classifiers consistently outperformed all types of random forest-based classifiers in all combinations of training/testing datasets. SVM classifiers based on the BaliBASE dataset produced best results, often above 95% AUC, against the other datasets. <xref rid="pcbi.1009541.s003" ref-type="supplementary-material">S2 Dataset</xref> holds detailed results for all tested parameter permutations.</p>
        <p>The parameter combination for BaliBASE classifier that produced most robust differentiation between all datasets was:</p>
        <list list-type="alpha-lower">
          <list-item>
            <p>Substitution matrix: LG</p>
          </list-item>
          <list-item>
            <p>Baseline correction with background frequency</p>
          </list-item>
          <list-item>
            <p>No weighing of sequences</p>
          </list-item>
          <list-item>
            <p>Cumulative segment delineation with smoothing window 9</p>
          </list-item>
          <list-item>
            <p>Positions with more than 90% gaps were removed</p>
          </list-item>
          <list-item>
            <p>Use the top 50% of segments</p>
          </list-item>
          <list-item>
            <p>Do not treat signature positions as conserved</p>
          </list-item>
          <list-item>
            <p>Do not calculate central mass of segments</p>
          </list-item>
          <list-item>
            <p>Use SVM classifier.</p>
          </list-item>
        </list>
        <p>After the selection of parameters of TwinCons and the type of classifier two additional parameters related to the SVM calculation need to be defined. These are the regularization (penalty) parameter and the gamma coefficient of the kernel function.</p>
      </sec>
      <sec id="sec021">
        <title>Penalty and gamma selection for the SVM classifier</title>
        <p>Determining a decision boundary by using SVM involves the parameters of penalty, kernel, and gamma function for the algorithm. We used the default <italic toggle="yes">sklearn</italic> settings for kernel (rbf). To determine a penalty value, we used a cross-validation methodology where we split a training dataset into 3 folds. This was done by randomly assigning segments from each alignment to one of the three folds, each fold was further split in a training and testing dataset. A classifier was built using the training portion of the fold and tested against the testing portion with different penalty and gamma parameters. Receiver operating characteristics (ROC) curves were generated for different penalty and gamma values for each fold. Using multiple folds of the training data allowed us to determine standard deviations between runs for the ROC curves. Performance was measured by calculating the AUC statistic. The gamma parameter did not significantly alter the performance of classifiers based on BaliBASE or PROSITE datasets (Fig B in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>). Therefore, we use the automatic setting which sets gamma to 1 divided by the number of features. In our case we have two features (segment length and weight), and gamma is 0.5. Different datasets produced different penalties as best performers (Fig B in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>). Classifiers built from the BaliBASE, and INDElible datasets showed best results with penalty of 20. Classifiers built from the PROSITE dataset showed improved results with the two lowest tested values for penalty. Classifiers built from the rProtein dataset did not show significant difference across all tested penalty values. We selected to use the penalty of 20, since it gives best results for our best-performing dataset (BaliBASE) (Fig B in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>).</p>
      </sec>
      <sec id="sec022">
        <title>Choice for significance threshold</title>
        <p>Using the calculated decision boundary to directly determine whether a segment has strong similarity between the groups can generate false positives or negatives (<xref rid="pcbi.1009541.g001" ref-type="fig">Fig 1</xref>). We used the AUC performance statistics from the best parameter combination and classifier dataset (BaliBASE) to determine a reasonable threshold away from the decision boundary that lowers false positive results. This threshold is used throughout the manuscript to determine significant segments. Each dataset was tested against the BaliBASE classifier, by calculating TPR and TNR for distances away from the decision boundary from -5 to 5 with a 0.1 step. A distance of 0.7 from the decision boundary produced robust results against the PROSITE (100% TNR, 42% TPR), the INDElible (68% TNR, 100% TPR), and the rProtein (90% TNR, 100% TPR) datasets (<xref rid="pcbi.1009541.s005" ref-type="supplementary-material">S4 Dataset</xref>). Setting the significance threshold to a more conservative value of 1.5 would ensure that even the INDElible dataset produces TNR above 90% but would limit the TPR results to 35% in the PROSITE dataset (<xref rid="pcbi.1009541.s005" ref-type="supplementary-material">S4 Dataset</xref>). We selected a significance threshold of 0.7 as it gives good results against all datasets from biological sources.</p>
      </sec>
      <sec id="sec023">
        <title>Probability estimation</title>
        <p>An SVM classifier is not intrinsically a probabilistic classifier, however it can output a probability for the prediction it makes. We include this probability in our outputs for user convenience. In our tests all segments with distance greater than 0.7 from the decision boundary have a probability greater than 90%. Furthermore, we provide scripts to generate calibrated SVM classifiers from our training data, which should behave analogous to probabilistic classifiers.</p>
      </sec>
      <sec id="sec024">
        <title>Query alignments</title>
        <p>Here we probe the ability of TwinCons to detect highly conserved sequence motifs for 27 proteins or protein fragments from the translation and transcription systems with known or suspected ancestry (Table D in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>) based on structural similarity or previous literature [<xref rid="pcbi.1009541.ref075" ref-type="bibr">75</xref>,<xref rid="pcbi.1009541.ref076" ref-type="bibr">76</xref>] (<xref rid="pcbi.1009541.s006" ref-type="supplementary-material">S5 Dataset</xref>). All translation proteins were retrieved from the advanced visualization website ProteoVision [<xref rid="pcbi.1009541.ref077" ref-type="bibr">77</xref>]. Sequences for transcription systems were retrieved from NCBI and are available at <ext-link xlink:href="https://apollo2.chemistry.gatech.edu/TwinConsDatasets/" ext-link-type="uri">https://apollo2.chemistry.gatech.edu/TwinConsDatasets/</ext-link>. Alignment of Tyrosyl and Tryptophanyl aminoacyl tRNA-synthetases were retrieved from Fournier and Alm [<xref rid="pcbi.1009541.ref078" ref-type="bibr">78</xref>]. To compute TwinCons, we generated composite alignments for each pair of candidates.</p>
      </sec>
      <sec id="sec025">
        <title>Querying an alignment against trained classifier</title>
        <p>To detect significant segments within a single alignment we calculate TwinCons and segments with the same parameters used for the classifier. We calculate the distance from the decision boundary for each calculated alignment segment. If the distance is greater than 0.7 the segment is considered as a significant hit. TwinCons reports the significant segments, their probability, their distance from the decision boundary, and the alignment ranges they span in a csv format.</p>
      </sec>
      <sec id="sec026">
        <title>Evaluating TwinCons performance against HHalign on training datasets</title>
        <p>To evaluate the performance of the TwinCons segment calculation we compared it to HHalign 3.0.3 [<xref rid="pcbi.1009541.ref031" ref-type="bibr">31</xref>]. HHalign can take as input a template alignment and a query alignment to produce a combined alignment. All pairs of alignments in the rProteins, INDELible, BaliBASE, and PROSITE datasets were aligned with HHalign with default parameters, varying only the parameter that filters input alignment columns by percentage of gaps. By default, HHalign generates an output alignment that includes segments of local similarity between two input alignments. HHalign also calculates scores for the output alignment including P-value, E-value, and probability of homology of the locally aligned segment. We used the HHalign E-value as a threshold to generate ROC curves for a range of E-values starting from 0 and ending at 1 with a step of 0.001. HHalign performed perfectly (100% AUC) in detecting homologous and non-homologous groups in the rProtein and INDELible datasets (Fig C in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>). HHalign performed almost perfectly on average in detecting homology in the BaliBASE and PROSITE datasets (97% and 92% AUC). The exclusion of columns by different percentage of gaps showed weak influence on the results with removal of 10% showing the lowest AUC (Fig C in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>). While TwinCons was not designed to detect homologies, it is able to reach 90% AUC for the BaliBASE (Fig B in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>) and PROSITE (<xref rid="pcbi.1009541.s003" ref-type="supplementary-material">S2</xref> and <xref rid="pcbi.1009541.s005" ref-type="supplementary-material">S4</xref> Datasets) datasets and 100% for the rProtein and INDELible datasets, performing nearly as well as HHalign (Fig C in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>).</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="results" id="sec027">
    <title>Results</title>
    <sec id="sec028">
      <title>TwinCons: Score that highlights conserved and signature regions</title>
      <p>TwinCons detects highly conserved and signature sequences between two groups within a composite alignment. Here, we demonstrate the utility of TwinCons using ribosomal protein uL2. Archaeal uL2 sequences form one group in the alignment and bacterial uL2 sequences form the other group. In addition, we analyze caspases and metacaspases, which are cysteine proteases thought to share ancestry. For the caspase and metacaspase composite alignment, caspases form the first group and metacaspases form the second group. We provide a detailed comparison of TwinCons results with two previously described conservation metrics ConSurf [<xref rid="pcbi.1009541.ref033" ref-type="bibr">33</xref>–<xref rid="pcbi.1009541.ref035" ref-type="bibr">35</xref>] and Zebra2 [<xref rid="pcbi.1009541.ref017" ref-type="bibr">17</xref>,<xref rid="pcbi.1009541.ref018" ref-type="bibr">18</xref>]. ConSurf can detect conservation within proteins and RNA across an entire alignment column, while Zebra2 detects signature residues in a composite alignment. We calculate protein conservation of the common composite alignments with TwinCons, ConSurf and Zebra2 and compare their scores directly (<xref rid="pcbi.1009541.s011" ref-type="supplementary-material">S10 Dataset</xref>), we further map them on 3D structures (Figs <xref rid="pcbi.1009541.g002" ref-type="fig">2</xref> and <xref rid="pcbi.1009541.g003" ref-type="fig">3</xref>, and D in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>).</p>
      <fig position="float" id="pcbi.1009541.g002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009541.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Comparison of ConSurf and TwinCons results by structural mapping.</title>
          <p>(A) ConSurf results from a composite sequence alignment for uL2 of archaeal and bacterial sequences mapped on the <italic toggle="yes">E</italic>. <italic toggle="yes">coli</italic> uL2 structure from PDB ID 4V9D [<xref rid="pcbi.1009541.ref079" ref-type="bibr">79</xref>]. (B) TwinCons results for the same composite alignment. (C) ConSurf results mapped on the <italic toggle="yes">P</italic>. <italic toggle="yes">furiosus</italic> uL2 structure from PDB ID 4V6U [<xref rid="pcbi.1009541.ref080" ref-type="bibr">80</xref>]. (D) TwinCons results mapped in the same way. White indicates positions with highly variable sequences across the alignment. Purple indicates signature positions. Gray indicates heavily gapped regions. Orange circles highlight regions of difference between TwinCons and ConSurf. The default coloring scheme of ConSurf was adjusted to a gradient from white to dark green to allow correct comparison between ConSurf and TwinCons.</p>
        </caption>
        <graphic xlink:href="pcbi.1009541.g002" position="float"/>
      </fig>
      <fig position="float" id="pcbi.1009541.g003">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009541.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>TwinCons is a convenient tool to study conservation and signatures.</title>
          <p>(A) Zebra2 conservation mapped on yeast metacaspase (PDB ID 4F6O [<xref rid="pcbi.1009541.ref086" ref-type="bibr">86</xref>]). (B) Zebra2 conservation mapped onto human caspase-9 (PDB ID 1JXQ [<xref rid="pcbi.1009541.ref085" ref-type="bibr">85</xref>]). (C) TwinCons conservation mapped on yeast metacaspase. (D) TwinCons conservation mapped onto human caspase 9. (E) Zebra2 signatures (subfamily specific) mapped on the metacaspase (F) Zebra2 signatures (subfamily specific) mapped on caspase 9. Zebra2 conservations are shown with a gradient from yellow to gray, with yellow indicating highly conserved and gray indicating non-conserved residues. Zebra2 signatures are shown with a gradient from cyan to red, with red indicating signatures. TwinCons conservation is shown in white to green gradient (green is more conserved). TwinCons signatures are shown with a white to purple gradient (purple indicates signatures). For TwinCons, white indicates non-conserved and gray indicates alignment positions that have sequences in only one group. The inset shows the superimposition of the central β-sheets of each pair of proteins.</p>
        </caption>
        <graphic xlink:href="pcbi.1009541.g003" position="float"/>
      </fig>
      <sec id="sec029">
        <title>TwinCons detects highly conserved and signature positions in composite alignments</title>
        <p>TwinCons readily detects sequence conservation in ancient proteins. uL2 is thought to be one of the oldest ribosomal proteins [<xref rid="pcbi.1009541.ref081" ref-type="bibr">81</xref>–<xref rid="pcbi.1009541.ref083" ref-type="bibr">83</xref>], and its high sequence conservation across phylogeny has been documented [<xref rid="pcbi.1009541.ref081" ref-type="bibr">81</xref>]. High conservation is revealed within the globular region as well as the extended loop of uL2 by both TwinCons and ConSurf (dark green, <xref rid="pcbi.1009541.g002" ref-type="fig">Fig 2</xref>). The results from TwinCons are consistent with those from ConSurf for the sites that are highly conserved across the entire alignment (<xref rid="pcbi.1009541.g002" ref-type="fig">Fig 2</xref> and <xref rid="pcbi.1009541.s011" ref-type="supplementary-material">S10 Dataset</xref>).</p>
        <p>In addition to detecting the conserved positions within a composite alignment, TwinCons identifies signature sequences that are conserved within each group and are different between the groups. In that way TwinCons highlights important evolutionary differences between archaeal and bacterial sequences (<xref rid="pcbi.1009541.g002" ref-type="fig">Fig 2B</xref>). Such sites are indicated by negative TwinCons scores. Thus, sites 41, 49, 150, 171, 199, 202, 206, 212, 248 in uL2 (<italic toggle="yes">E</italic>. <italic toggle="yes">coli</italic> numbering scheme) have large negative TwinCons scores. These signature sites cover bacterial and archaeal structural regions that superimpose well (<xref rid="pcbi.1009541.g002" ref-type="fig">Fig 2</xref>). Since these residues are conserved within each branch of the TOL but have different identities between the branches, TwinCons can point to sequence changes with evolutionary significance. By contrast, ConSurf indicates these sites are moderately conserved (<xref rid="pcbi.1009541.g002" ref-type="fig">Fig 2</xref>, orange circles).</p>
        <p>TwinCons, like ConSurf, detects heavily gapped alignment positions. TwinCons can discriminate between alignment positions that contain gaps only within one group and alignment positions with gaps spanning the entire column. For example, the N-terminal β-hairpin of uL2 (1–37 <italic toggle="yes">E</italic>. <italic toggle="yes">coli</italic> numbering) is a feature present only in bacterial ribosomes and it should not exhibit any TwinCons conservation, for that reason it lacks a score and is colored gray (<xref rid="pcbi.1009541.g002" ref-type="fig">Fig 2B</xref>).</p>
      </sec>
      <sec id="sec030">
        <title>TwinCons detects signature-rich regions</title>
        <p><bold>TwinCons can highlight alternative sequences of conserved structures.</bold> TwinCons can identify structurally similar regions with high frequency of signature columns within a composite alignment. For example, a short α-helix, located between positions 196 and 206 of uL2 in <italic toggle="yes">E</italic>. <italic toggle="yes">coli</italic>, displays seven highly conserved sites when calculating its evolutionary rate with ConSurf (<xref rid="pcbi.1009541.g002" ref-type="fig">Fig 2A</xref> and Table C in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>). In contrast, TwinCons reveals four signature sites for Bacteria and Archaea in the same region. Three of these positions coincide with the conserved residues detected by ConSurf (<xref rid="pcbi.1009541.g002" ref-type="fig">Fig 2B</xref> and Table C in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>). Analysis of the sequence similarity within each (archaeal and bacterial) group reveals that consensus sequences calculated for each group are distinct (Table C in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>). Yet, the 3D structures of archaeal and bacterial uL2 exhibit a common α-helical element in this region (Fig E in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>), therefore TwinCons can be used to detect alternative sequences for common structural elements.</p>
        <p><bold>TwinCons provides convenient representation of signatures and conservation.</bold> TwinCons is robust and can probe evolutionary relationships between distantly related paralogs. Cysteine-dependent aspartate-directed proteases called Caspases regulate apoptosis in metazoans. Similar apoptotic proteases, called metacaspases, are found in plants, fungi, and unicellular organisms. Caspase and metacaspase structures share α/β three-layered sandwich architecture characterized by a single centrally positioned parallel β-sheet and α-helices on both of its sides; their evolutionary relationship predates the last eukaryotic common ancestor [<xref rid="pcbi.1009541.ref084" ref-type="bibr">84</xref>]. Here we demonstrate the use of structurally informed substitution matrices in TwinCons to compare sequence similarity of caspases and metacaspases. We cross check the TwinCons analysis with Zebra2 results computed from the same alignment. We map these results on structures from a caspase (PDB ID: 1JXQ [<xref rid="pcbi.1009541.ref085" ref-type="bibr">85</xref>]) and a metacaspase (PDB ID: 4F6O [<xref rid="pcbi.1009541.ref086" ref-type="bibr">86</xref>]) (<xref rid="pcbi.1009541.g003" ref-type="fig">Fig 3</xref>).</p>
        <p>The two groups of proteases are evolutionary related [<xref rid="pcbi.1009541.ref084" ref-type="bibr">84</xref>] and structures representing each group superimpose with an RMSD of 2.9 Å. TwinCons highlights four distinct types of sites; i) universally conserved sites associated with the catalytic region; ii) moderately conserved buried residues; iii) highly variable solvent exposed residues; iv) signature residues at the periphery of secondary structural elements (<xref rid="pcbi.1009541.g003" ref-type="fig">Fig 3D–3F</xref>). Zebra2 detects all 4 types of regions by using separate scores for conserved (<xref rid="pcbi.1009541.g003" ref-type="fig">Fig 3A–3C</xref>) and signature residues (<xref rid="pcbi.1009541.g003" ref-type="fig">Fig 3G–3I</xref>). The two Zebra2 scores are not mutually exclusive. Zebra2 detects more signatures within the alignment than TwinCons does, and just within the core β-sheet there are 10 Zebra2 signature sites (<xref rid="pcbi.1009541.g003" ref-type="fig">Fig 3H</xref>). TwinCons detects fewer signature residues in the entire alignment and 8 within the core β-sheet (<xref rid="pcbi.1009541.g003" ref-type="fig">Fig 3E</xref>). The difference between the two scores stems from low penalties for signatures in the structural matrices used by TwinCons. While Zebra2 requires two separate mappings to visualize its scores (<xref rid="pcbi.1009541.g003" ref-type="fig">Fig 3A–3C and 3G–3I</xref>), TwinCons produces a single score that detects highly conserved, variable and signature residues, which are mapped on the structure (<xref rid="pcbi.1009541.g003" ref-type="fig">Fig 3D–3F</xref>).</p>
      </sec>
    </sec>
    <sec id="sec031">
      <title>TwinCons: Score that detects sequence similarity between pairs of proteins</title>
      <p>The simplicity and universality of TwinCons in analyzing local differences within protein composite alignments were leveraged to detect highly similar regions for any two proteins. We developed an automated parsing protocol aimed to detect continuous stretches of columns with high TwinCons across the entire length of a composite alignment. We refer to such regions as segments. A segment spans a range of alignment positions with a continuously increasing cumulative TwinCons score after a smoothing with window size 9 (suggested by TwinCons parameterization protocol) has been performed. We used a supervised learning model to predict whether a composite alignment contains regions with greater TwinCons scores compared to those from composite alignments that include ancestrally unrelated groups. To explore the ability of TwinCons to detect highly conserved sequence motifs, we applied this method to 27 proteins or protein fragments from the translation and transcription systems with known or suspected ancestry (Table D in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref> and <xref rid="pcbi.1009541.s006" ref-type="supplementary-material">S5</xref> Dataset) [<xref rid="pcbi.1009541.ref075" ref-type="bibr">75</xref>,<xref rid="pcbi.1009541.ref076" ref-type="bibr">76</xref>]. The results from 36 composite alignments (some protein pairs have more than one alignment) are summarized in <xref rid="pcbi.1009541.g004" ref-type="fig">Fig 4</xref>.</p>
      <fig position="float" id="pcbi.1009541.g004">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009541.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>TwinCons can detect noisy sequence similarity.</title>
          <p>Results from composite alignments of genes related by putative ancient duplication events. Segments are represented with uniquely colored circles for each alignment. Circle sizes indicate segment length. The segment weight and length are normalized relative to the training BaliBASE dataset. The decision boundary calculated from the BaliBASE dataset is shown with a red line, distances from the boundary are shown with a diverging gradient (purple to green). The inset shows the number of segments for each alignment at a significant distance from the decision boundary. Negative distance values indicate positions below the decision boundary and positive values indicate positions above the boundary. Alignments with segments close to the decision boundary are at the bottom of the legend and those further away are at the top. On the right, each distance from the decision boundary is associated with the calculated false positive rate for the BaliBASE dataset. *Structure guided alignment.</p>
        </caption>
        <graphic xlink:href="pcbi.1009541.g004" position="float"/>
      </fig>
      <p>Automated TwinCons analysis reveals similar segments in 10 pairs of proteins from 13 composite alignments. TwinCons detects highly similar segments between elongation factor Tu (EF-Tu) and Initiation factors 2 (IF2) and 5 (aIF5 –archaeal variant of IF2), between rProteins aL8, aL30, and eS12, between ribosomal protein bS1 and RNAP subunit 7, between rProteins aL37 and bL34, between rProteins aL14 and eL27. TwinCons further detects more marginal similarities between rProteins aL42 and bL33, between Tyrosyl and Tryptophanyl aminoacyl tRNA-synthetases, and between rProteins uL2 and bL34 (<xref rid="pcbi.1009541.g004" ref-type="fig">Fig 4</xref> and <xref rid="pcbi.1009541.t002" ref-type="table">Table 2</xref>). We describe TwinCons results in terms of number of segments, significance, and the total length of the detected segments. Complete descriptions and 3D maps of the highly similar segments are available in the Supplementary text and Table E in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>. We further provide a comparison of our results with HHalign [<xref rid="pcbi.1009541.ref031" ref-type="bibr">31</xref>,<xref rid="pcbi.1009541.ref087" ref-type="bibr">87</xref>], an established method for detecting homology in protein sequences using hidden Markov’s algorithms.</p>
      <table-wrap position="float" id="pcbi.1009541.t002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009541.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Significant segments detected by TwinCons for protein composite alignments.</title>
          <p>Sequence ranges for segments detected as significant with TwinCons and in parenthesis their respective distance from the decision boundary. Sum of all significant segment lengths for each alignment. HHalign E-value confidence results of aligning the group sequences. Number of aligned columns with HHalign; for each pair, each protein was used as template and the higher result is reported here. Figures that show detected segments in 3D are indicated under the alignment names. Indexing species for the indicated ranges and complete data for all query alignments are available in <xref rid="pcbi.1009541.s010" ref-type="supplementary-material">S9 Dataset</xref>.</p>
        </caption>
        <alternatives>
          <graphic xlink:href="pcbi.1009541.t002" id="pcbi.1009541.t002g" position="float"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1">Composite alignment</th>
                <th align="center" rowspan="1" colspan="1">TWC Segment residue ranges (Boundary dist.; prob.)</th>
                <th align="center" rowspan="1" colspan="1">Total length</th>
                <th align="center" rowspan="1" colspan="1">HHalign E-value</th>
                <th align="center" rowspan="1" colspan="1">HH Range</th>
                <th align="center" rowspan="1" colspan="1">HHalign aligned columns</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">IF2/EF-Tu P-loop</td>
                <td align="center" rowspan="1" colspan="1">10–35 (5.4; 100%)<break/>95–145 (12.8; 100%)</td>
                <td align="center" rowspan="1" colspan="1">75</td>
                <td align="center" rowspan="1" colspan="1">2.8e<sup>-29</sup></td>
                <td align="center" rowspan="1" colspan="1">16–181</td>
                <td align="center" rowspan="1" colspan="1">140</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">aIF5/EF-Tu (Fig J in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>)</td>
                <td align="center" rowspan="1" colspan="1">8–32 (4.7; 100%)<break/>95–141 (11.1; 100%)</td>
                <td align="center" rowspan="1" colspan="1">70</td>
                <td align="center" rowspan="1" colspan="1">3.6e<sup>-22</sup></td>
                <td align="center" rowspan="1" colspan="1">15–274</td>
                <td align="center" rowspan="1" colspan="1">237</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">aL8/eS12</td>
                <td align="center" rowspan="1" colspan="1">30–93 (10; 100%)</td>
                <td align="center" rowspan="1" colspan="1">63</td>
                <td align="center" rowspan="1" colspan="1">5.1e<sup>-18</sup></td>
                <td align="center" rowspan="1" colspan="1">22–137</td>
                <td align="center" rowspan="1" colspan="1">115</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">RNAP7C/bS1 (Fig K in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>)</td>
                <td align="center" rowspan="1" colspan="1">83–120 (8.2; 100%)</td>
                <td align="center" rowspan="1" colspan="1">37</td>
                <td align="center" rowspan="1" colspan="1">3.6e<sup>-15</sup></td>
                <td align="center" rowspan="1" colspan="1">114–203</td>
                <td align="center" rowspan="1" colspan="1">72</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">aL8-aL30</td>
                <td align="center" rowspan="1" colspan="1">22–66 (6.8; 100%)</td>
                <td align="center" rowspan="1" colspan="1">44</td>
                <td align="center" rowspan="1" colspan="1">4.2e<sup>-15</sup></td>
                <td align="center" rowspan="1" colspan="1">32–124</td>
                <td align="center" rowspan="1" colspan="1">91</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">aL37-bL34 (Fig L in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>)</td>
                <td align="center" rowspan="1" colspan="1">1–26 (5.7; 100%)</td>
                <td align="center" rowspan="1" colspan="1">25</td>
                <td align="center" rowspan="1" colspan="1">0.39</td>
                <td align="center" rowspan="1" colspan="1">51–51</td>
                <td align="center" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">aL30-eS12</td>
                <td align="center" rowspan="1" colspan="1">3–43 (4.1; 100%)</td>
                <td align="center" rowspan="1" colspan="1">40</td>
                <td align="center" rowspan="1" colspan="1">7e<sup>-8</sup></td>
                <td align="center" rowspan="1" colspan="1">20–114</td>
                <td align="center" rowspan="1" colspan="1">92</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">aL14-eL27</td>
                <td align="center" rowspan="1" colspan="1">4–30 (4.7; 100%)</td>
                <td align="center" rowspan="1" colspan="1">26</td>
                <td align="center" rowspan="1" colspan="1">6.5e<sup>-9</sup></td>
                <td align="center" rowspan="1" colspan="1">3–66</td>
                <td align="center" rowspan="1" colspan="1">64</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">RNAP7C/bS1 Struct. based</td>
                <td align="center" rowspan="1" colspan="1">83–114 (2.1; 99%)</td>
                <td align="center" rowspan="1" colspan="1">31</td>
                <td align="center" rowspan="1" colspan="1">1.2e<sup>-18</sup></td>
                <td align="center" rowspan="1" colspan="1">120–286</td>
                <td align="center" rowspan="1" colspan="1">136</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">aL42/bL33CP</td>
                <td align="center" rowspan="1" colspan="1">4–26 (1.3; 95%)</td>
                <td align="center" rowspan="1" colspan="1">22</td>
                <td align="center" rowspan="1" colspan="1">3.1e<sup>-8</sup></td>
                <td align="center" rowspan="1" colspan="1">76–154</td>
                <td align="center" rowspan="1" colspan="1">68</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">aL42/bL33</td>
                <td align="center" rowspan="1" colspan="1">3–31 (1.2; 93%)</td>
                <td align="center" rowspan="1" colspan="1">28</td>
                <td align="center" rowspan="1" colspan="1">5.8e<sup>-5</sup></td>
                <td align="center" rowspan="1" colspan="1">101–122</td>
                <td align="center" rowspan="1" colspan="1">20</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">TyrRS/TrpRS</td>
                <td align="center" rowspan="1" colspan="1">38–63 (0.9; 89%)</td>
                <td align="center" rowspan="1" colspan="1">25</td>
                <td align="center" rowspan="1" colspan="1">3.5e<sup>-28</sup></td>
                <td align="center" rowspan="1" colspan="1">118–287</td>
                <td align="center" rowspan="1" colspan="1">151</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">uL2/bL34</td>
                <td align="center" rowspan="1" colspan="1">13–39 (0.81; 87%)</td>
                <td align="center" rowspan="1" colspan="1">26</td>
                <td align="center" rowspan="1" colspan="1">0.064</td>
                <td align="center" rowspan="1" colspan="1">77–107</td>
                <td align="center" rowspan="1" colspan="1">30</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>Results between HHalign and TwinCons from the query set are largely similar (<xref rid="pcbi.1009541.t002" ref-type="table">Table 2</xref>), except for alignments that include multi-domain proteins (EFTu-aIF5 and bS1-aRNAP7), for which TwinCons yields shorter ranges. TwinCons segments are generally more conservative and fragmented than HHalign segments (<xref rid="pcbi.1009541.t002" ref-type="table">Table 2</xref>; aL8-aL30, aL8-eS12, aL30-eS12). TwinCons detects similarity between shorter segments more readily than HHalign (<xref rid="pcbi.1009541.t002" ref-type="table">Table 2</xref>; bL34-aL37). TwinCons detects at least a single segment for alignment pairs where HHalign has high confidence results (<xref rid="pcbi.1009541.s010" ref-type="supplementary-material">S9 Dataset</xref>). To illustrate TwinCons detection of a possible similarity for a marginal case, we provide detailed description of the automated TwinCons results for a pair of proteins related by a circular permutation.</p>
      <sec id="sec032">
        <title>Sequence similarity between the circularly permuted bL33 and aL42</title>
        <p>TwinCons detects a conservation signal within a β-hairpin when comparing rProteins bL33 and aL42. Previous work demonstrated the structural relationship between rProteins bL33 and aL42 [<xref rid="pcbi.1009541.ref088" ref-type="bibr">88</xref>,<xref rid="pcbi.1009541.ref089" ref-type="bibr">89</xref>]. These proteins are colocalized in bacterial and archaeal ribosomes and have very similar structures, related by a circular permutation. Here we refer to them with their classical domain names bL33 and aL42 [<xref rid="pcbi.1009541.ref090" ref-type="bibr">90</xref>] for clarity, however we and others have proposed that they should share the name uL33 [<xref rid="pcbi.1009541.ref088" ref-type="bibr">88</xref>,<xref rid="pcbi.1009541.ref091" ref-type="bibr">91</xref>]. We probed whether TwinCons can detect the ancestral relationship within the composite alignment of bL33 and aL42. To do that we aligned one composite alignment with unpermuted sequences (bL33-aL42) and two composite alignments containing either a permutation of bL33 (bL33<sub>CP</sub>-aL42) or of aL42 (bL33-aL42<sub>CP</sub>).</p>
        <p>In both permuted composite alignments TwinCons detects a pair of segments with sequence similarity between bL33 and aL42 (<xref rid="pcbi.1009541.g004" ref-type="fig">Fig 4</xref> pink and <xref rid="pcbi.1009541.t002" ref-type="table">Table 2</xref> and <xref rid="pcbi.1009541.s010" ref-type="supplementary-material">S9 Dataset</xref>). One of these segments is significant and it corresponds to the N-terminal β-hairpin of the aL42 structure (PDB ID: 4V6U [<xref rid="pcbi.1009541.ref080" ref-type="bibr">80</xref>]) and the C-terminal β-hairpin of the bL33 structure (PDB ID: 4V9D [<xref rid="pcbi.1009541.ref079" ref-type="bibr">79</xref>]) (Fig F in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>). These two β-hairpins superimpose well and are structurally similar (Fig F in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>). The second segment has a weaker TwinCons signal and corresponds to the C-terminal β-hairpin of the aL42 structure and the N-terminal β-hairpin of the bL33 structure (<xref rid="pcbi.1009541.s010" ref-type="supplementary-material">S9 Dataset</xref>). HHalign confirms the circular permutation over the entire range in both composite permuted alignments (<xref rid="pcbi.1009541.t002" ref-type="table">Table 2</xref> and <xref rid="pcbi.1009541.s010" ref-type="supplementary-material">S9 Dataset</xref>). Thus, our results confirm a previous proposal on common ancestry of these two proteins and suggest that they should be treated as a universal protein uL33 [<xref rid="pcbi.1009541.ref088" ref-type="bibr">88</xref>].</p>
        <p>We also note that both TwinCons and HHalign detect a short region of marginal similarity (<xref rid="pcbi.1009541.t002" ref-type="table">Table 2</xref>) in a non-permuted alignment of bL33 and aL42 (<xref rid="pcbi.1009541.g004" ref-type="fig">Fig 4</xref> violet and <xref rid="pcbi.1009541.s010" ref-type="supplementary-material">S9 Dataset</xref>). These results appear to be low-scoring artifacts of a structurally inconsistent sequence alignment.</p>
      </sec>
    </sec>
    <sec id="sec033">
      <title>TwinCons results between archaeal and bacterial rRNA</title>
      <p>TwinCons is a useful metric to study conservation and ancestry of nucleic acids. For example, TwinCons can be applied to identify signature positions in rRNAs grouped into the three major domains of life [<xref rid="pcbi.1009541.ref011" ref-type="bibr">11</xref>], provided that the transformation matrix in <xref rid="pcbi.1009541.e002" ref-type="disp-formula">Eq 2</xref> is adjusted for nucleic acids. Previously, Woese et al. have detected signature positions within rRNA sequence and structure [<xref rid="pcbi.1009541.ref012" ref-type="bibr">12</xref>,<xref rid="pcbi.1009541.ref092" ref-type="bibr">92</xref>]. Here, we used TwinCons computed for sequence alignments of bacterial and archaeal rRNAs to identify ancient signature nucleotides.</p>
      <p>We mapped the values of TwinCons onto a representative LSU 2D and 3D structures for each group–<italic toggle="yes">E</italic>. <italic toggle="yes">coli</italic> for Bacteria (<xref rid="pcbi.1009541.g005" ref-type="fig">Fig 5</xref>) and <italic toggle="yes">P</italic>. <italic toggle="yes">furiosus</italic> for Archaea (Fig G in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>) [<xref rid="pcbi.1009541.ref012" ref-type="bibr">12</xref>,<xref rid="pcbi.1009541.ref092" ref-type="bibr">92</xref>]. We used TwinCons to identify conserved, variable and signature positions between bacterial and archaeal rRNA sequences (Supplementary text in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>). Regions of high functional importance for the ribosome, such as the exit tunnel, the central protuberance, the central pseudoknot (CPK), the peptidyl transferase center (PTC) and the sarcin-ricin loop, are highly conserved and have high TwinCons scores (dark green regions in Figs <xref rid="pcbi.1009541.g005" ref-type="fig">5</xref> and G in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>). Regions on the ribosomal surface, known to contain multiple long insertions with highly variable sequences, are correctly detected as either highly variable (white regions in Figs <xref rid="pcbi.1009541.g005" ref-type="fig">5</xref> and G in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>) or heavily gapped (gray regions in Figs <xref rid="pcbi.1009541.g005" ref-type="fig">5</xref> and G in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>).</p>
      <fig position="float" id="pcbi.1009541.g005">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009541.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>TwinCons between archaeal and bacterial rRNA sequences, mapped on 2D and 3D representation of the E. coli ribosomal structure.</title>
          <p>(A) Secondary structure of the <italic toggle="yes">E</italic>. <italic toggle="yes">coli</italic> 16S rRNA. (B) secondary structure of the <italic toggle="yes">E</italic>. <italic toggle="yes">coli</italic> 5S and 23S rRNAs. (C) Surface representation of the three-dimensional structure of the 16S rRNA of the <italic toggle="yes">E</italic>. <italic toggle="yes">coli</italic> ribosome. D) Surface representation of the three-dimensional structure of the 5S and 23S rRNAs of the <italic toggle="yes">E</italic>. <italic toggle="yes">coli</italic> ribosome. The 3D structures are viewed into the subunit interface. Gray indicates heavily gapped regions, indicating elements that are present in either bacterial or archaeal rRNAs; dark green indicates highly conserved regions within both bacterial and archaeal sequences; dark purple indicates signature regions between bacterial and archaeal sequences; white indicates sequence variable regions. Helical numbers are blue and domain numbers are brown. 2D representations were generated with RiboVision [<xref rid="pcbi.1009541.ref093" ref-type="bibr">93</xref>], and 3D representations were generated with PyMOL [<xref rid="pcbi.1009541.ref094" ref-type="bibr">94</xref>]. PDB ID used for 3D representations is 4V9D [<xref rid="pcbi.1009541.ref079" ref-type="bibr">79</xref>].</p>
        </caption>
        <graphic xlink:href="pcbi.1009541.g005" position="float"/>
      </fig>
      <p>Signature sites detected by TwinCons are sparse and are distributed throughout the rRNA structure. Surprisingly, signature sites are not confined to the variable ribosomal surface regions (<xref rid="pcbi.1009541.g005" ref-type="fig">Fig 5C and 5D</xref> and G in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>). Signatures are found both in conserved regions of functional importance, like the central pseudoknot in the SSU (helices 1–3 and 28 in <xref rid="pcbi.1009541.g005" ref-type="fig">Fig 5A</xref>) and the PTC in the LSU (Helices 73 and 89–93 in <xref rid="pcbi.1009541.g005" ref-type="fig">Fig 5B</xref>), signature sites are also found in variable regions like helix 33 (<xref rid="pcbi.1009541.g005" ref-type="fig">Fig 5A</xref>) and Helix 55 (<xref rid="pcbi.1009541.g005" ref-type="fig">Fig 5B</xref>). In total we detect 208 signature nucleotides in the SSU and 294 signatures in the LSU (<xref rid="pcbi.1009541.s008" ref-type="supplementary-material">S7 Dataset</xref>). Some signatures occur at base-pairing nucleotides, revealing highly conserved base pairs within each group which co-vary between the two groups (helix 30 in <xref rid="pcbi.1009541.g005" ref-type="fig">Fig 5A</xref> and Helix 69 in <xref rid="pcbi.1009541.g005" ref-type="fig">Fig 5B</xref>). By identifying the signature positions in rRNAs, we uncover the deepest evolutionary changes in the translational machinery that define the phylogenetic split at the last universal common ancestor.</p>
      <sec id="sec034">
        <title>TwinCons can identify colocalized patterns in rRNA and rProteins</title>
        <p>To extend our analysis beyond signals obtained from individual sequences we performed a combined sequence and structural analysis of rRNA and rProteins. This analysis reveals colocalized changes suggesting coevolution of the two types of ribosomal biopolymers. Previously Roberts and co-authors correlated the structural signatures between rProteins and rRNA, however they did not identify rProtein sequence signatures or correlate them to rRNA sequence signatures [<xref rid="pcbi.1009541.ref092" ref-type="bibr">92</xref>]. rProtein uL33 (bL33 or aL42) is located near the E-site of the LSU. Using TwinCons we detected a sequence segment that is highly conserved between Bacteria and Archaea (cyan cartoon Figs <xref rid="pcbi.1009541.g006" ref-type="fig">6</xref> and F in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref> and <xref rid="pcbi.1009541.t002" ref-type="table">Table 2</xref>). This segment interacts with highly conserved rRNA Helices 82 and 86 (<italic toggle="yes">E</italic>. <italic toggle="yes">coli</italic> numbering), part of the central protuberance (<xref rid="pcbi.1009541.g006" ref-type="fig">Fig 6</xref>). The other β-hairpin of uL33, which has low sequence similarity between bacteria and archaea, interacts with multiple rRNA signature sites in Helices 81 and 88 (gray cartoon Figs <xref rid="pcbi.1009541.g006" ref-type="fig">6</xref> and <xref rid="pcbi.1009541.g005" ref-type="fig">5</xref>). The α-helical insertion present only in archaeal uL33, also interacts with rRNA Helices 81 and 88 (<italic toggle="yes">E</italic>. <italic toggle="yes">coli</italic> numbering) (gray cartoon <xref rid="pcbi.1009541.g006" ref-type="fig">Fig 6</xref>). These results indicate correlation between changes in rProtein and rRNA in the most ancient ribosomal regions.</p>
        <fig position="float" id="pcbi.1009541.g006">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1009541.g006</object-id>
          <label>Fig 6</label>
          <caption>
            <title>Correlation between signatures and conservation in archaeal and bacterial rRNA and rProteins detected with TwinCons.</title>
            <p>(A) Archaea (rProtein aL42 in <italic toggle="yes">P</italic>. <italic toggle="yes">furiosus</italic> ribosome). (B) Bacteria (rProtein bL33 in <italic toggle="yes">E</italic>. <italic toggle="yes">coli</italic> ribosome). rRNA helices are labeled with capital H and canonical numbering. rProteins bL33 and aL42 are shown with cartoon with the highly conserved segment colored in cyan and the rest of the protein colored in gray. This figure was generated with PyMOL [<xref rid="pcbi.1009541.ref094" ref-type="bibr">94</xref>]. The PDB ID used for panel (A) is 4V6U [<xref rid="pcbi.1009541.ref080" ref-type="bibr">80</xref>] and for panel (B) is 4V9D [<xref rid="pcbi.1009541.ref079" ref-type="bibr">79</xref>].</p>
          </caption>
          <graphic xlink:href="pcbi.1009541.g006" position="float"/>
        </fig>
      </sec>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec035">
    <title>Discussion</title>
    <p>Multiple sequence alignments can provide us with archives of molecular history [<xref rid="pcbi.1009541.ref095" ref-type="bibr">95</xref>]. These archives are imperfect records of past events; with lost sentences, paragraphs, pages and chapters. These imperfections reflect a complex history of evolution, during which simple point mutations accumulate together with more complex processes of large insertions, deletions, duplications, and permutations. Molecular history has been tracked successfully using protein domains [<xref rid="pcbi.1009541.ref075" ref-type="bibr">75</xref>,<xref rid="pcbi.1009541.ref096" ref-type="bibr">96</xref>,<xref rid="pcbi.1009541.ref097" ref-type="bibr">97</xref>], motifs [<xref rid="pcbi.1009541.ref057" ref-type="bibr">57</xref>,<xref rid="pcbi.1009541.ref098" ref-type="bibr">98</xref>,<xref rid="pcbi.1009541.ref099" ref-type="bibr">99</xref>], and short segments of proteins [<xref rid="pcbi.1009541.ref058" ref-type="bibr">58</xref>,<xref rid="pcbi.1009541.ref100" ref-type="bibr">100</xref>]. Comparing two alignment groups within a composite alignment of two genes that are possibly related, and combining sequence and structural analysis, can help unveil the origins and deep history of ancestral genes, pushing the boundaries of what we can learn about the distant molecular past. In general, from a composite alignment, multiple types of patterns can be recovered, revealing distinctive aspects of molecular history. Important patterns include:</p>
    <list list-type="bullet">
      <list-item>
        <p>Highly conserved sequence regions across groups highlight critical elements responsible for structural and functional identity of a particular gene.</p>
      </list-item>
      <list-item>
        <p>Highly variable regions across groups, represent an archive of recent evolutionary history and are essential for fine-grained phylogenetic reconstructions.</p>
      </list-item>
      <list-item>
        <p>Regions that are conserved within alignment groups but differ between groups (signatures), highlight functional diversification between groups.</p>
      </list-item>
    </list>
    <p>Using pre-generated composite alignments, TwinCons detects conserved, variable and signature positions between alignment groups in a single step. TwinCons can be mapped onto three dimensional structures and employs a wide variety of sequence- and structure-informed substitution matrices, as well as sequence weighing based on global similarity measures. Automated visualization of TwinCons has been implemented in ProteoVision [<xref rid="pcbi.1009541.ref077" ref-type="bibr">77</xref>], an online webserver that enables simultaneous structural visualization and custom data mapping at levels of primary, secondary, and three-dimensional structure of proteins. TwinCons displays signatures and conservation in a single convenient layout and highlights alternative sequences of conserved structures. TwinCons identifies structural locations of signatures and conserved residues associated with catalytic regions of distantly related enzymes. Furthermore, TwinCons finds similar segments within composite alignments. TwinCons is generalizable for both protein and nucleotide alignments, facilitating joint analysis between RNA and proteins in complex RNA-protein assemblies such as the ribosome, unveiling ancient molecular history.</p>
    <sec id="sec036">
      <title>TwinCons highlights structurally important sites in enzymes</title>
      <p>Evolutionary related caspases and metacaspases [<xref rid="pcbi.1009541.ref084" ref-type="bibr">84</xref>] were analyzed here by TwinCons, highlighting four categories of information: i) universal conservation, ii) moderate conservation, iii) high variability, and iv) signatures (<xref rid="pcbi.1009541.g003" ref-type="fig">Fig 3D–3F</xref>). These TwinCons results are consistent with caspase and metacaspase structures.</p>
      <list list-type="roman-lower">
        <list-item>
          <p>Universally conserved sites of caspases and metacaspases are associated with catalytic regions, signifying conserved catalytic mechanisms.</p>
        </list-item>
        <list-item>
          <p>Moderately conserved sites are found at buried residues, implicating residues that preserve the structural core.</p>
        </list-item>
        <list-item>
          <p>Highly variable sites are found at solvent exposed residues, which do not influence the structure or function of the enzyme.</p>
        </list-item>
        <list-item>
          <p>Signature sites are often observed at the periphery of secondary structural elements, signifying differences in caspase and metacaspase mechanisms of association between secondary structural elements and the structural core.</p>
        </list-item>
      </list>
      <p>The comparison of caspases and metacaspases illustrates how TwinCons can quickly highlight conserved, variable, and signature sites with a single score. In that way TwinCons is a useful tool for comparative evolutionary studies between related groups of proteins.</p>
    </sec>
    <sec id="sec037">
      <title>TwinCons compared to alternative scores</title>
      <p>Conservation within sequence alignments is a cornerstone of evolutionary analysis. A wide variety of full column conservation scores have been developed [<xref rid="pcbi.1009541.ref034" ref-type="bibr">34</xref>,<xref rid="pcbi.1009541.ref036" ref-type="bibr">36</xref>,<xref rid="pcbi.1009541.ref052" ref-type="bibr">52</xref>,<xref rid="pcbi.1009541.ref101" ref-type="bibr">101</xref>]. These conservation scores treat an alignment as a single object (without partitioning into groups) and thus, they cannot discriminate between signature and conserved regions, as exemplified by comparison with ConSurf (<xref rid="pcbi.1009541.g002" ref-type="fig">Fig 2</xref>). One of the first forays in identifying functional protein residues likens the entire protein sequence to a vector [<xref rid="pcbi.1009541.ref102" ref-type="bibr">102</xref>]. TwinCons also utilizes such notation, when frequencies of residues or nucleotides in each group are represented as vectors and transformed by a substitution matrix. Thus, the calculation of our score is analogous to computation of the energy of a dipole vector in an external anisotropic electric field, defined by an anisotropic tensor. Several statistical methods focus on identifying functionally important regions within a composite alignment [<xref rid="pcbi.1009541.ref103" ref-type="bibr">103</xref>,<xref rid="pcbi.1009541.ref104" ref-type="bibr">104</xref>]; these methods lack the ability to incorporate structural data and are protein specific. Toolkits like Diverge3 [<xref rid="pcbi.1009541.ref054" ref-type="bibr">54</xref>] and Zebra2 [<xref rid="pcbi.1009541.ref018" ref-type="bibr">18</xref>] that incorporate structural data and map scores on structures have also been developed [<xref rid="pcbi.1009541.ref105" ref-type="bibr">105</xref>,<xref rid="pcbi.1009541.ref106" ref-type="bibr">106</xref>]. By contrast, TwinCons provides a single metric that specifies between-group conservation. TwinCons improves on existing signature-identifying methods by providing greater accessibility and flexibility in usage, in calculation methods, in visualization capabilities, and in simultaneous application for RNA and protein. Below, we briefly compare TwinCons with the scores mentioned above and highlight the strengths of each method.</p>
      <sec id="sec038">
        <title>Comparison of TwinCons with DIVERGE3</title>
        <p>Diverge3 reveals site-specific divergences (signatures) within a protein family for a supplied alignment and sequence groups. Diverge3 evaluates a Bayesian profile for each group and measures how amino acid residues contribute to signatures. Diverge3 can map its divergence score onto a 3D structure. The divergence statistics employed by Diverge3 are based on analysis of evolutionary rates inferred from a given alignment. Diverge3 is not intended to detect conserved and highly variable regions. Unlike Diverge3, TwinCons uses statistics built into substitution matrices (see below) and provides instantaneous computations of the scores for every position within a composite alignment.</p>
      </sec>
      <sec id="sec039">
        <title>Comparison of TwinCons signature positions with Zebra2</title>
        <p>Zebra2 automatically partitions an alignment into multiple pairs of groups and assigns significance values for every grouping. For every detected group, it calculates two separate metrics for conservation and signatures. Zebra2 provides 3D structural mappings, and a sequence similarity network representation of the results [<xref rid="pcbi.1009541.ref017" ref-type="bibr">17</xref>,<xref rid="pcbi.1009541.ref018" ref-type="bibr">18</xref>]. TwinCons uses either pre-defined or automated phylogeny-based partitioning of an alignment to define its groups; it computes a single score that distinguishes between conserved, variable and signature regions. The single TwinCons score facilitates visualization and identification of each of these regions and does not require mapping data multiple times, which would be necessary for Zebra2 (<xref rid="pcbi.1009541.g003" ref-type="fig">Fig 3</xref>). The results for signature regions obtained by Zebra2 and TwinCons are consistent, if TwinCons is computed using structure-informed substitution matrices (Figs <xref rid="pcbi.1009541.g003" ref-type="fig">3</xref> and H in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>) [<xref rid="pcbi.1009541.ref043" ref-type="bibr">43</xref>].</p>
      </sec>
    </sec>
    <sec id="sec040">
      <title>TwinCons requires a pre-computed composite alignment</title>
      <p>TwinCons is an evolutionary metric computed for each position within the composite alignment. It does not optimize or otherwise alter the input alignment. Thus, TwinCons results are highly dependent on the alignment and the initial determination of sequence groups within that alignment. TwinCons will produce a result for any supplied composite alignment, manually curated or automatic. A given set of sequences, organized in different groups or in different alignments, can produce differing TwinCons scores. Thus, supplied composite alignments and the groupings within them should be carefully checked in advance for sufficient quality.</p>
      <sec id="sec041">
        <title>TwinCons detects short highly similar segments</title>
        <p>HHalign from the HH-suite [<xref rid="pcbi.1009541.ref031" ref-type="bibr">31</xref>] can compute an optimal pairwise alignment between HMM profiles generated from two alignments [<xref rid="pcbi.1009541.ref030" ref-type="bibr">30</xref>,<xref rid="pcbi.1009541.ref087" ref-type="bibr">87</xref>]. In that way HHalign can produce predictions about protein homology and can identify highly similar regions between two alignments or profiles. TwinCons measures the conservation between two pre-defined groups within an already constructed composite alignment and can identify segments that have higher levels of similarity than observed in datasets of unrelated alignments. The two methods are different, yet their results, from our query set, are largely similar (<xref rid="pcbi.1009541.t002" ref-type="table">Table 2</xref>). While the overall ranges of TwinCons segments are more conservative and more fragmented than HHalign ranges, TwinCons detects similarity between short segments, which HHalign does not. Thus, TwinCons is more useful for identification of short motifs. This difference is likely the result of the segment delineation rule, used by TwinCons. In future releases of TwinCons we plan to improve on this rule using a probabilistic method that accounts for global similarities.</p>
      </sec>
    </sec>
    <sec id="sec042">
      <title>TwinCons detects shared segments within the universal core of life</title>
      <p>Reuse of small protein segments is ubiquitous in protein evolution. Opportunistic reuse has been observed so often as to raise questions about the primacy of the protein domain as the “atomic unit” of evolution [<xref rid="pcbi.1009541.ref057" ref-type="bibr">57</xref>,<xref rid="pcbi.1009541.ref058" ref-type="bibr">58</xref>,<xref rid="pcbi.1009541.ref098" ref-type="bibr">98</xref>]. The translation and transcription systems contribute to most of the universal gene set of life [<xref rid="pcbi.1009541.ref071" ref-type="bibr">71</xref>,<xref rid="pcbi.1009541.ref107" ref-type="bibr">107</xref>,<xref rid="pcbi.1009541.ref108" ref-type="bibr">108</xref>]. TwinCons identified segments of peptides with high similarity between 9 pairs of proteins from 12 composite alignments, spanning the translational and transcriptional systems (Figs <xref rid="pcbi.1009541.g005" ref-type="fig">5</xref> and F, J-L in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>). TwinCons can be used on any composite alignment and can identify similar segments between structurally similar or different proteins.</p>
    </sec>
    <sec id="sec043">
      <title>Significance of rRNA and rProtein colocalized signatures for the deepest branching events in phylogenetic trees</title>
      <p>TwinCons identifies signatures that determine the deepest and most ancient branching events in the tree of life (TOL). The ribosome is the ultimate molecular fossil, holding records of protein and RNA co-evolution [<xref rid="pcbi.1009541.ref109" ref-type="bibr">109</xref>–<xref rid="pcbi.1009541.ref112" ref-type="bibr">112</xref>]. Ribosomal RNA was the ‘gold standard’ for phylogenetic analysis for many years [<xref rid="pcbi.1009541.ref113" ref-type="bibr">113</xref>]. In the rRNA derived ‘Woesian’ tree Bacteria, Archaea, and Eukarya represent three major independent branches [<xref rid="pcbi.1009541.ref011" ref-type="bibr">11</xref>]. Recently, concatenated rProtein sequences have been used for determining and characterizing the TOL [<xref rid="pcbi.1009541.ref008" ref-type="bibr">8</xref>,<xref rid="pcbi.1009541.ref114" ref-type="bibr">114</xref>–<xref rid="pcbi.1009541.ref117" ref-type="bibr">117</xref>], suggesting that Eukarya may have branched from within the Asgard archaeal superphylum. Thus, phylogenetic trees built from rRNA and rProteins show substantially different topologies [<xref rid="pcbi.1009541.ref008" ref-type="bibr">8</xref>]. The deepest branches in the TOL are determined by signature positions in rRNA [<xref rid="pcbi.1009541.ref092" ref-type="bibr">92</xref>] and likely in rProteins.</p>
      <p>TwinCons provides the toolkit to identify sequence signatures in both rRNA and rProteins. This analysis can be further substantiated if coupled with information derived from the 3D structure. Specifically, we identify the structural clusters, in which signatures in both rRNA and rProteins (the deepest evolutionary signals) are colocalized as in the case of uL33 and its RNA binding site. Furthermore, it is possible to identify the asymmetric regions, in which the evolutionary changes in one polymer are not compensated by adjustments in the surrounding counterpart. We hope that the identification of such polarized regions combined with the structural and compositional analysis of the ribosomes will provide clues for evolutionary processes that resulted in divergence of archaeal and bacterial translation systems.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec044">
    <title>Conclusion</title>
    <p>TwinCons is a single metric that highlights conserved, variable, and diverging (signature) single column positions between a given pair of sequence groups within an alignment of protein or RNA. The TwinCons score can be used to query deep ancestry of short peptides from full protein alignments. Coupling TwinCons with supervised machine learning techniques provides a robust method for probing ancestry between any pair of possible protein candidates. TwinCons improves on existing signature-identifying methods by providing greater accessibility and flexibility in usage, in calculation methods, in visualization capabilities, and in simultaneous application for RNA and protein. TwinCons analysis coupled with information inferred from 3D structures can be a useful tool in studying colocalized changes in RNA and protein assemblies like the ribosome and uncovering mechanisms of sequence change and conservation hidden in ancient molecular history.</p>
  </sec>
  <sec id="sec045" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1009541.s001" position="float" content-type="local-data">
      <label>S1 Appendix</label>
      <caption>
        <title>Supplementary text, figures, and tables.</title>
        <p><bold>Fig A.</bold> ROC curves for classifiers with different parameters built from the BaliBASE dataset, tested against the rProt dataset. Parameters shown here are segment boundaries (length threshold), TWC intensity for detection of positive positions (intensity threshold), and what percentage gaps should be used for removal of alignment columns (gap threshold). Each subplot represents different combination of the intensity and length thresholds. Colored lines within subplots represent different gap thresholds. Cutting only alignment positions with more than 80–90% gaps produce better distinction between true positive and true negatives. Complete data including all tested parameters and datasets is available in S2 Dataset. <bold>Fig B</bold>. ROC curves of training classifiers with different penalties and gamma parameters. The first four subplots (A-D) test different penalties and the last four test different gamma values (E-H). Each subplot represents a different dataset that was used for training and testing. (A) and (E) are PROSITE, (B) and (F) are BaliBASE, (C) and (G) are INDELible, (D) and (H) are rProtein dataset. For testing each dataset was split in 3 folds. Each fold produces an ROC curve, we plot the mean of the three results as single curve and plot the standard deviation of the true positive rate as a shaded region around it. Complete data is available in S3 Dataset. <bold>Fig C</bold>. ROC curves generated from HHalign alignments from the four datasets: BaliBASE, rProtein, INDELible, and PROSITE. Colored lines within subplots represent different gap thresholds used for column exclusion. <bold>Fig D.</bold> Comparison of structural mapping between Zebra2 and TwinCons. A) Zebra2 results and B) TwinCons results from sequence alignment for uL2 between archaeal and bacterial sequences mapped on the E. coli uL2 structure from PDB 4V9D [<xref rid="pcbi.1009541.ref022" ref-type="bibr">22</xref>]. C) Zebra2 results and D) TwinCons results from the same sequence alignment mapped on the P. furiosus uL2 structure from PDB 4V6U [<xref rid="pcbi.1009541.ref036" ref-type="bibr">36</xref>]. In panels A) and C) red indicates signatures. In panels B) and D) dark green indicates alignment positions with high conservation of residues, purple indicates signature positions, gray indicates heavily gapped regions in the composite alignment. Orange circles indicate signature positions. <bold>Fig E.</bold> TwinCons mapped for a short α-helix region in uL2 with analogous sequence between Bacteria and Archaea. Residues depicted here are listed in Table C in S1 Appendix. (A) stick representation for E. coli uL2. (B) stick representation for P. furiosus uL2. (C) cartoon representation of E. coli uL2. (D) cartoon representation of P. furiosus uL2. (E) and (F) show different angle for the E. coli and P. furiosus uL2. Conserved residues are colored green, signatures are colored purple, and random positions are white. Heavily gapped regions, present in a single group, are colored gray. Figure generated with PyMOL. PDB IDs and chains used for the figure are available in Table E in S1 Appendix. <bold>Fig F.</bold> TwinCons segment with significant sequence similarity between (A, B) bL33 and (C, D) aL42. The segment is shown with full opacity cartoon, non-segment regions are shown with transparent cartoon. Conserved residues are colored green, signatures are colored purple, and random positions are white. Heavily gapped regions, present in a single group, are colored gray. Segment definitions are available in S6 Dataset. Figure generated with PyMOL. PDB IDs and chains used for the figure are available in Table E in S1 Appendix. <bold>Fig G.</bold> TwinCons score for Archaea and Bacteria composite alignments of the small and large subunits. (A) Secondary structure of the P. furiosus 16S rRNA with mapped TwinCons. (B) Secondary structure of the P. furiosus 5S and 23S rRNAs with mapped TwinCons. (C) Surface representation of the 16S rRNA for P. furiosus ribosome. (D) Surface representation of the 5S and 23S rRNAs for P. furiosus ribosome in crown view. Both the small and large subunits are shown from the subunit interface direction. Gray indicates heavily gapped regions, present only in bacterial or archaeal sequences; dark green indicates highly conserved regions between both bacterial and archaeal sequences; dark purple indicates signature regions between bacterial and archaeal sequences; white indicates sequence variable regions. In panels (A) and (B) blue numbers indicate helical numbering and ribosomal domains are indicated with brown. Panels (A) and (B) are generated with RiboVision, panels (C) and (D) are generated with PyMOL. PDB IDs and chains used for the figure are available in Table E in S1 Appendix. <bold>Fig H.</bold> TwinCons signatures differ based on the substitution matrix used. TwinCons results mapped on (A) metacaspase, (C) caspase, and (B) β-sheet superimposition of both structures, using the Blosum62 matrix. TwinCons results mapped on (D) metacaspase, (F) caspase, and (E) β-sheet superimposition of both structures, using structure-informed substitution matrices. A position with differing result is highlighted between panels (B) and (D) with red. Set of residues, representing the composite alignment column for the highlighted position, are shown between (B) and (E). Structure-informed matrices produce stronger signature signal between the two groups for this alignment position. Structures are generated with PyMOL. PDB IDs and chains used for the figure are available in Table E in S1 Appendix. <bold>Fig I.</bold> Distribution of TwinCons scores from the E. coli rRNA, based on three composite alignments between Archaeal and Bacterial sequences of 23S, 16S, and 5S rRNA. (A) Histogram of TwinCons scores showing three peaks of distribution around the minimum score, score zero, and the maximum score. (B) Scatter plot of TwinCons scores with group assignment by k-means clustering algorithm. The y-axis holds randomly assigned values and is only illustrative. Scores from different groups are colored with the viridis gradient. The red and green lines indicate the calculated thresholds of the groups spanning the lowest (red) and highest (green) scores. Thresholds calculated from each composite alignment are available in Table B in S1 Appendix. <bold>Fig J.</bold> TwinCons segments with significant sequence similarity between the P-loop domains of (A, C) aIF5 and (B, D) EF-Tu. Segments are shown with full opacity cartoon, while non-segment regions are shown with transparent cartoon. GDP from the EF-Tu structure is shown with sticks. Conserved residues are colored green, signatures are colored purple, and random positions are white. Heavily gapped regions, present in a single group, are colored gray. Segment definitions are available in S6 Dataset. Figure generated with PyMOL. PDB IDs and chains used for the figure are available in Table E in S1 Appendix. <bold>Fig K.</bold> TwinCons segment with significant sequence similarity between bS1 and domain 7 of RNAP mapped on the RNAP7 structure. (A) and (B) two views of the segment mapped on the RNAP7 structure. Segment is shown with full opacity cartoon, while non-segment regions are shown with transparent cartoon. Conserved residues are colored green, signatures are colored purple, and random positions are white. Heavily gapped regions, present in a single group, are colored gray. Segment definitions are available in S6 Dataset. Figure generated with PyMOL. PDB IDs and chains used for the figure are available in Table E in S1 Appendix. <bold>Fig L.</bold> TwinCons segment with significant sequence similarity between bL34 and aL37. (A) representation of E. coli bL34, (B) representation of P. furiosus aL37, (C) 90-degree rotation view of E. coli bL34, and (D) 90-degree rotation view of P. furiosus aL37. The segment is shown with full opacity cartoon, non-segment regions are shown with transparent cartoon. Conserved residues are colored green, signatures are colored purple, and random positions are white. Heavily gapped regions, present in a single group, are colored gray. Segment definitions are available in S6 Dataset. Figure generated with PyMOL. PDB IDs and chains used for the figure are available in Table E in S1 Appendix. <bold>Table A.</bold> Substitution matrices available for TwinCons calculation and references for full descriptions. <bold>Table B.</bold> TwinCons thresholds calculated with 5 k-clusters for different subsets of rRNA. First two rows, tagged with ‘ribosome’, include sequences from the 23S, 5S, and 16S. Entries tagged with LSU include sequences from the 23S and 5S. Entries tagged with SSU include only rRNA from the 16S rRNA. TwinCons was calculated against the Archaea-Bacteria composite alignment of the rRNA. Standard deviations were calculated after repeating the calculation 100 times. Full script used to generate this data can be found at <ext-link xlink:href="https://github.com/LDWLab/TWC_distribution" ext-link-type="uri">https://github.com/LDWLab/TWC_distribution</ext-link>. <bold>Table C.</bold> TwinCons and ConSurf statistics for α-helical region in uL2. Positions with low Shannon entropy, low ConSurf score, and high TwinCons score are detected as highly conserved. Positions with TwinCons below -0.6 are detected as signature positions. Signature positions detected with TwinCons, that are detected as conserved by ConSurf are highlighted with blue. <bold>Table D.</bold> Composite alignments used in sequence similarity analysis. <bold>Table E.</bold> Protein and rRNA structures used to map sequence similarity analysis. When multiple PDBs are used in a single row they are separated by a semicolon. When multiple chains are used from a single PDB they are separated by &amp;.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1009541.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009541.s002" position="float" content-type="local-data">
      <label>S1 Dataset</label>
      <caption>
        <title>Table with BaliBASE alignment names with enzyme and EC annotations present in the alignment.</title>
        <p>Alignments with similar EC annotations are colored the same. Combinations between alignments that share color are excluded from dataset generation.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1009541.s002.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009541.s003" position="float" content-type="local-data">
      <label>S2 Dataset</label>
      <caption>
        <title>Figures with ROC curves for all tested parameters.</title>
        <p>The title of each figure indicates the training dataset and the tested dataset. For example, “BBS vs PROSITE” indicates that the training set was BaliBASE and it was tested against the PROSITE dataset. ROC labels of subplots and lines are the same as the ones used in Fig A in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1009541.s003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009541.s004" position="float" content-type="local-data">
      <label>S3 Dataset</label>
      <caption>
        <title>Data used to generate Fig B in <xref rid="pcbi.1009541.s001" ref-type="supplementary-material">S1 Appendix</xref>.</title>
        <p>The title of each sheet indicates whether penalties or gamma values were tested. TPR, FPR, and TPR standard deviation for each of the datasets. Calculations were done for boundary distance thresholds varying from -20 to 20 with a step of 0.05.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1009541.s004.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009541.s005" position="float" content-type="local-data">
      <label>S4 Dataset</label>
      <caption>
        <title>Performance of trained classifier from the BaliBASE dataset with best parameter combination against itself and the three other datasets.</title>
        <p>TPR, TNR, and precision for boundary distance thresholds varying from -5 to 5 with a step of 0.1. The distance thresholds of 0.7 and 1.5 are highlighted.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1009541.s005.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009541.s006" position="float" content-type="local-data">
      <label>S5 Dataset</label>
      <caption>
        <title>Description of query composite alignments used in <xref rid="pcbi.1009541.g004" ref-type="fig">Fig 4</xref>.</title>
        <p>Alignments are available at <ext-link xlink:href="https://apollo2.chemistry.gatech.edu/TwinConsDatasets/" ext-link-type="uri">https://apollo2.chemistry.gatech.edu/TwinConsDatasets/</ext-link>.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1009541.s006.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009541.s007" position="float" content-type="local-data">
      <label>S6 Dataset</label>
      <caption>
        <title>TwinCons segment results for composite alignments used in <xref rid="pcbi.1009541.g004" ref-type="fig">Fig 4</xref>.</title>
        <p>Each segment is identified with its alignment position and the distance it was from the decision boundary.</p>
        <p>(CSV)</p>
      </caption>
      <media xlink:href="pcbi.1009541.s007.csv">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009541.s008" position="float" content-type="local-data">
      <label>S7 Dataset</label>
      <caption>
        <title>TwinCons results from rRNA composite alignment of 23S, 16S, and 5S sequences between Archaea and Bacteria.</title>
        <p>TwinCons results from protein composite alignments of caspase-metacaspase and uL2. Thresholds for signature and conserved positions for each alignment are indicated.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1009541.s008.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009541.s009" position="float" content-type="local-data">
      <label>S8 Dataset</label>
      <caption>
        <title>INDELible control file used to generate artificial sequence alignments from random sequence seeds, evolved under biological model.</title>
        <p>(TXT)</p>
      </caption>
      <media xlink:href="pcbi.1009541.s009.txt">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009541.s010" position="float" content-type="local-data">
      <label>S9 Dataset</label>
      <caption>
        <title>Combined TwinCons and HHalign results for segments detected within the query alignment set.</title>
        <p>The file reports alignment group names, TwinCons scores and probability, TwinCons segment ranges, HHalign scores and probabilities, HHalign ranges, and index sequences used for the ranges.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1009541.s010.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009541.s011" position="float" content-type="local-data">
      <label>S10 Dataset</label>
      <caption>
        <title>Direct score comparison for the alignment of uL2 between TwinCons and Zebra2, as well as TwinCons and ConSurf.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1009541.s011.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank prof. Jordan I. King and Dr. Gene Lamm for helpful discussions. We also thank Dr. Stephen Altschul and Dr. Yi-Kuo Yu for providing the matrix compositional adjustment code.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1009541.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Wooley</surname><given-names>JC</given-names></name>, <name><surname>Godzik</surname><given-names>A</given-names></name>, <name><surname>Friedberg</surname><given-names>I</given-names></name>. <article-title>A primer on metagenomics</article-title>. <source>PLoS Comput Biol</source>. <year>2010</year>;<volume>6</volume>(<issue>2</issue>):<fpage>e1000667</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000667</pub-id><?supplied-pmid 20195499?><pub-id pub-id-type="pmid">20195499</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Maher</surname><given-names>CA</given-names></name>, <name><surname>Kumar-Sinha</surname><given-names>C</given-names></name>, <name><surname>Cao</surname><given-names>X</given-names></name>, <name><surname>Kalyana-Sundaram</surname><given-names>S</given-names></name>, <name><surname>Han</surname><given-names>B</given-names></name>, <name><surname>Jing</surname><given-names>X</given-names></name>, <etal>et al</etal>. <article-title>Transcriptome sequencing to detect gene fusions in cancer</article-title>. <source>Nature</source>. <year>2009</year>;<volume>458</volume>(<issue>7234</issue>):<fpage>97</fpage>–<lpage>101</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature07638</pub-id><?supplied-pmid 19136943?><pub-id pub-id-type="pmid">19136943</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Allen</surname><given-names>HK</given-names></name>, <name><surname>Moe</surname><given-names>LA</given-names></name>, <name><surname>Rodbumrer</surname><given-names>J</given-names></name>, <name><surname>Gaarder</surname><given-names>A</given-names></name>, <name><surname>Handelsman</surname><given-names>J</given-names></name>. <article-title>Functional metagenomics reveals diverse β-lactamases in a remote alaskan soil</article-title>. <source>ISME J</source>. <year>2009</year>;<volume>3</volume>(<issue>2</issue>):<fpage>243</fpage>–<lpage>51</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/ismej.2008.86</pub-id><?supplied-pmid 18843302?><pub-id pub-id-type="pmid">18843302</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Tringe</surname><given-names>SG</given-names></name>, <name><surname>Von Mering</surname><given-names>C</given-names></name>, <name><surname>Kobayashi</surname><given-names>A</given-names></name>, <name><surname>Salamov</surname><given-names>AA</given-names></name>, <name><surname>Chen</surname><given-names>K</given-names></name>, <name><surname>Chang</surname><given-names>HW</given-names></name>, <etal>et al</etal>. <article-title>Comparative metagenomics of microbial communities</article-title>. <source>Science</source>. <year>2005</year>;<volume>308</volume>(<issue>5721</issue>):<fpage>554</fpage>–<lpage>7</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.1107851</pub-id><?supplied-pmid 15845853?><pub-id pub-id-type="pmid">15845853</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>AlQuraishi</surname><given-names>M</given-names></name>. <article-title>Alphafold at casp13</article-title>. <source>Bioinformatics</source>. <year>2019</year>;<volume>35</volume>(<issue>22</issue>):<fpage>4862</fpage>–<lpage>5</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btz422</pub-id><?supplied-pmid 31116374?><pub-id pub-id-type="pmid">31116374</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Penev</surname><given-names>PI</given-names></name>, <name><surname>Fakhretaha-Aval</surname><given-names>S</given-names></name>, <name><surname>Patel</surname><given-names>VJ</given-names></name>, <name><surname>Cannone</surname><given-names>JJ</given-names></name>, <name><surname>Gutell</surname><given-names>RR</given-names></name>, <name><surname>Petrov</surname><given-names>AS</given-names></name>, <etal>et al</etal>. <article-title>Supersized ribosomal rna expansion segments in asgard archaea</article-title>. <source>Genome Biol Evol</source>. <year>2020</year>;<volume>12</volume>(<issue>10</issue>):<fpage>1694</fpage>–<lpage>710</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/gbe/evaa170</pub-id><?supplied-pmid 32785681?><pub-id pub-id-type="pmid">32785681</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Keeling</surname><given-names>PJ</given-names></name>, <name><surname>Burki</surname><given-names>F</given-names></name>. <article-title>Progress towards the tree of eukaryotes</article-title>. <source>Current Biology</source>. <year>2019</year>;<volume>29</volume>(<issue>16</issue>):<fpage>R808</fpage>–<lpage>R17</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cub.2019.07.031</pub-id><?supplied-pmid 31430481?><pub-id pub-id-type="pmid">31430481</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Hug</surname><given-names>LA</given-names></name>, <name><surname>Baker</surname><given-names>BJ</given-names></name>, <name><surname>Anantharaman</surname><given-names>K</given-names></name>, <name><surname>Brown</surname><given-names>CT</given-names></name>, <name><surname>Probst</surname><given-names>AJ</given-names></name>, <name><surname>Castelle</surname><given-names>CJ</given-names></name>, <etal>et al</etal>. <article-title>A new view of the tree of life</article-title>. <source>Nat Microbiol</source>. <year>2016</year>;<volume>1</volume>:<fpage>16048</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nmicrobiol.2016.48</pub-id><?supplied-pmid 27572647?><pub-id pub-id-type="pmid">27572647</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Smith</surname><given-names>TF</given-names></name>, <name><surname>Waterman</surname><given-names>MS</given-names></name>. <article-title>Identification of common molecular subsequences</article-title>. <source>J Mol Biol</source>. <year>1981</year>;<volume>147</volume>(<issue>1</issue>):<fpage>195</fpage>–<lpage>7</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2836(81)90087-5</pub-id><?supplied-pmid 7265238?><pub-id pub-id-type="pmid">7265238</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Kyrpides</surname><given-names>N</given-names></name>, <name><surname>Overbeek</surname><given-names>R</given-names></name>, <name><surname>Ouzounis</surname><given-names>C</given-names></name>. <article-title>Universal protein families and the functional content of the last universal common ancestor</article-title>. <source>J Mol Evol</source>. <year>1999</year>;<volume>49</volume>(<issue>4</issue>):<fpage>413</fpage>–<lpage>23</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/pl00006564</pub-id><?supplied-pmid 10485999?><pub-id pub-id-type="pmid">10485999</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Woese</surname><given-names>CR</given-names></name>, <name><surname>Kandler</surname><given-names>O</given-names></name>, <name><surname>Wheelis</surname><given-names>ML</given-names></name>. <article-title>Towards a natural system of organisms: Proposal for the domains archaea, bacteria, and eucarya</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>1990</year>;<volume>87</volume>(<issue>12</issue>):<fpage>4576</fpage>–<lpage>9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.87.12.4576</pub-id><?supplied-pmid 2112744?><pub-id pub-id-type="pmid">2112744</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Winker</surname><given-names>S</given-names></name>, <name><surname>Woese</surname><given-names>CR</given-names></name>. <article-title>A definition of the domains archaea, bacteria and eucarya in terms of small subunit ribosomal rna characteristics</article-title>. <source>Syst Appl Microbiol</source>. <year>1991</year>;<volume>14</volume>(<issue>4</issue>):<fpage>305</fpage>–<lpage>10</lpage>. <pub-id pub-id-type="doi">10.1016/S0723-2020(11)80303-6</pub-id><?supplied-pmid 11540071?><pub-id pub-id-type="pmid">11540071</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>K</given-names></name>, <name><surname>Eargle</surname><given-names>J</given-names></name>, <name><surname>Sarkar</surname><given-names>K</given-names></name>, <name><surname>Gruebele</surname><given-names>M</given-names></name>, <name><surname>Luthey-Schulten</surname><given-names>Z</given-names></name>. <article-title>Functional role of ribosomal signatures</article-title>. <source>Biophys J</source>. <year>2010</year>;<volume>99</volume>(<issue>12</issue>):<fpage>3930</fpage>–<lpage>40</lpage>. <pub-id pub-id-type="doi">10.1016/j.bpj.2010.09.062</pub-id><?supplied-pmid 21156135?><pub-id pub-id-type="pmid">21156135</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Gu</surname><given-names>X</given-names></name>. <article-title>Maximum-likelihood approach for gene family evolution under functional divergence</article-title>. <source>Mol Biol Evol</source>. <year>2001</year>;<volume>18</volume>(<issue>4</issue>):<fpage>453</fpage>–<lpage>64</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a003824</pub-id><?supplied-pmid 11264396?><pub-id pub-id-type="pmid">11264396</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Gu</surname><given-names>X</given-names></name>. <article-title>A simple statistical method for estimating type-ii (cluster-specific) functional divergence of protein sequences</article-title>. <source>Mol Biol Evol</source>. <year>2006</year>;<volume>23</volume>(<issue>10</issue>):<fpage>1937</fpage>–<lpage>45</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msl056</pub-id><?supplied-pmid 16864604?><pub-id pub-id-type="pmid">16864604</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Gribaldo</surname><given-names>S</given-names></name>, <name><surname>Casane</surname><given-names>D</given-names></name>, <name><surname>Lopez</surname><given-names>P</given-names></name>, <name><surname>Philippe</surname><given-names>H</given-names></name>. <article-title>Functional divergence prediction from evolutionary analysis: A case study of vertebrate hemoglobin</article-title>. <source>Mol Biol Evol</source>. <year>2003</year>;<volume>20</volume>(<issue>11</issue>):<fpage>1754</fpage>–<lpage>9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msg171</pub-id><?supplied-pmid 12832652?><pub-id pub-id-type="pmid">12832652</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Suplatov</surname><given-names>D</given-names></name>, <name><surname>Shalaeva</surname><given-names>D</given-names></name>, <name><surname>Kirilin</surname><given-names>E</given-names></name>, <name><surname>Arzhanik</surname><given-names>V</given-names></name>, <name><surname>Švedas</surname><given-names>V</given-names></name>. <article-title>Bioinformatic analysis of protein families for identification of variable amino acid residues responsible for functional diversity</article-title>. <source>J Biomol Struct Dyn</source>. <year>2014</year>;<volume>32</volume>(<issue>1</issue>):<fpage>75</fpage>–<lpage>87</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1080/07391102.2012.750249</pub-id><?supplied-pmid 23384165?><pub-id pub-id-type="pmid">23384165</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Suplatov</surname><given-names>D</given-names></name>, <name><surname>Sharapova</surname><given-names>Y</given-names></name>, <name><surname>Geraseva</surname><given-names>E</given-names></name>, <name><surname>Švedas</surname><given-names>V</given-names></name>. <article-title>Zebra2: Advanced and easy-to-use web-server for bioinformatic analysis of subfamily-specific and conserved positions in diverse protein superfamilies</article-title>. <source>Nucleic Acids Res</source>. <year>2020</year>;<volume>48</volume>(<issue>W1</issue>):<fpage>W65</fpage>–<lpage>W71</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkaa276</pub-id><?supplied-pmid 32313959?><pub-id pub-id-type="pmid">32313959</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Lichtarge</surname><given-names>O</given-names></name>, <name><surname>Bourne</surname><given-names>HR</given-names></name>, <name><surname>Cohen</surname><given-names>FE</given-names></name>. <article-title>An evolutionary trace method defines binding surfaces common to protein families</article-title>. <source>J Mol Biol</source>. <year>1996</year>;<volume>257</volume>(<issue>2</issue>):<fpage>342</fpage>–<lpage>58</lpage>. Epub 1996/03/29. <comment>doi: </comment><pub-id pub-id-type="doi">10.1006/jmbi.1996.0167</pub-id> .<?supplied-pmid 8609628?><pub-id pub-id-type="pmid">8609628</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Gu</surname><given-names>X</given-names></name>. <article-title>Statistical methods for testing functional divergence after gene duplication</article-title>. <source>Mol Biol Evol</source>. <year>1999</year>;<volume>16</volume>(<issue>12</issue>):<fpage>1664</fpage>–<lpage>74</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a026080</pub-id><?supplied-pmid 10605109?><pub-id pub-id-type="pmid">10605109</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Knudsen</surname><given-names>B</given-names></name>, <name><surname>Miyamoto</surname><given-names>MM</given-names></name>. <article-title>A likelihood ratio test for evolutionary rate shifts and functional divergence among proteins</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2001</year>;<volume>98</volume>(<issue>25</issue>):<fpage>14512</fpage>–<lpage>7</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.251526398</pub-id> .<?supplied-pmid 11734650?><pub-id pub-id-type="pmid">11734650</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Gaucher</surname><given-names>EA</given-names></name>, <name><surname>Gu</surname><given-names>X</given-names></name>, <name><surname>Miyamoto</surname><given-names>MM</given-names></name>, <name><surname>Benner</surname><given-names>SA</given-names></name>. <article-title>Predicting functional divergence in protein evolution by site-specific rate shifts</article-title>. <source>Trends Biochem Sci</source>. <year>2002</year>;<volume>27</volume>(<issue>6</issue>):<fpage>315</fpage>–<lpage>21</lpage>. <pub-id pub-id-type="doi">10.1016/S0968-0004(02)02094-7</pub-id><?supplied-pmid 12069792?><pub-id pub-id-type="pmid">12069792</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Altschul</surname><given-names>SF</given-names></name>, <name><surname>Gish</surname><given-names>W</given-names></name>, <name><surname>Miller</surname><given-names>W</given-names></name>, <name><surname>Myers</surname><given-names>EW</given-names></name>, <name><surname>Lipman</surname><given-names>DJ</given-names></name>. <article-title>Basic local alignment search tool</article-title>. <source>J Mol Biol</source>. <year>1990</year>;<volume>215</volume>(<issue>3</issue>):<fpage>403</fpage>–<lpage>10</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/S0022-2836(05)80360-2</pub-id><?supplied-pmid 2231712?><pub-id pub-id-type="pmid">2231712</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Altschul</surname><given-names>SF</given-names></name>, <name><surname>Madden</surname><given-names>TL</given-names></name>, <name><surname>Schäffer</surname><given-names>AA</given-names></name>, <name><surname>Zhang</surname><given-names>J</given-names></name>, <name><surname>Zhang</surname><given-names>Z</given-names></name>, <name><surname>Miller</surname><given-names>W</given-names></name>, <etal>et al</etal>. <article-title>Gapped blast and psi-blast: A new generation of protein database search programs</article-title>. <source>Nucleic Acids Res</source>. <year>1997</year>;<volume>25</volume>(<issue>17</issue>):<fpage>3389</fpage>–<lpage>402</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/25.17.3389</pub-id><?supplied-pmid 9254694?><pub-id pub-id-type="pmid">9254694</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Boratyn</surname><given-names>GM</given-names></name>, <name><surname>Schäffer</surname><given-names>AA</given-names></name>, <name><surname>Agarwala</surname><given-names>R</given-names></name>, <name><surname>Altschul</surname><given-names>SF</given-names></name>, <name><surname>Lipman</surname><given-names>DJ</given-names></name>, <name><surname>Madden</surname><given-names>TL</given-names></name>. <article-title>Domain enhanced lookup time accelerated blast</article-title>. <source>Biol Direct</source>. <year>2012</year>;<volume>7</volume>(<issue>1</issue>):<fpage>12</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1745-6150-7-12</pub-id><?supplied-pmid 22510480?><pub-id pub-id-type="pmid">22510480</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>Z</given-names></name>, <name><surname>Schwartz</surname><given-names>S</given-names></name>, <name><surname>Wagner</surname><given-names>L</given-names></name>, <name><surname>Miller</surname><given-names>W</given-names></name>. <article-title>A greedy algorithm for aligning DNA sequences</article-title>. <source>J Comp Biol</source>. <year>2000</year>;<volume>7</volume>(<issue>1–2</issue>):<fpage>203</fpage>–<lpage>14</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1089/10665270050081478</pub-id><?supplied-pmid 10890397?><pub-id pub-id-type="pmid">10890397</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Krogh</surname><given-names>A</given-names></name>, <name><surname>Brown</surname><given-names>M</given-names></name>, <name><surname>Mian</surname><given-names>IS</given-names></name>, <name><surname>Sjölander</surname><given-names>K</given-names></name>, <name><surname>Haussler</surname><given-names>D</given-names></name>. <article-title>Hidden markov models in computational biology: Applications to protein modeling</article-title>. <source>J Mol Biol</source>. <year>1994</year>;<volume>235</volume>(<issue>5</issue>):<fpage>1501</fpage>–<lpage>31</lpage>. <pub-id pub-id-type="doi">10.1006/jmbi.1994.1104</pub-id><?supplied-pmid 8107089?><pub-id pub-id-type="pmid">8107089</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Eddy</surname><given-names>SR</given-names></name>. <article-title>A new generation of homology search tools based on probabilistic inference</article-title>. <source>Genome informatics 2009: Genome informatics series vol 23: World Scientific</source>; <year>2009</year>. p. <fpage>205</fpage>–<lpage>11</lpage>. <?supplied-pmid 20180275?><pub-id pub-id-type="pmid">20180275</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Eddy</surname><given-names>SR</given-names></name>. <article-title>Accelerated profile hmm searches</article-title>. <source>PLoS Comp Biol</source>. <year>2011</year>;<volume>7</volume>(<issue>10</issue>):<fpage>e1002195</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002195</pub-id><?supplied-pmid 22039361?><pub-id pub-id-type="pmid">22039361</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Remmert</surname><given-names>M</given-names></name>, <name><surname>Biegert</surname><given-names>A</given-names></name>, <name><surname>Hauser</surname><given-names>A</given-names></name>, <name><surname>Söding</surname><given-names>J</given-names></name>. <article-title>Hhblits: Lightning-fast iterative protein sequence searching by hmm-hmm alignment</article-title>. <source>Nat Methods</source>. <year>2012</year>;<volume>9</volume>(<issue>2</issue>):<fpage>173</fpage>–<lpage>5</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nmeth.1818</pub-id><?supplied-pmid 22198341?><pub-id pub-id-type="pmid">22198341</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Steinegger</surname><given-names>M</given-names></name>, <name><surname>Meier</surname><given-names>M</given-names></name>, <name><surname>Mirdita</surname><given-names>M</given-names></name>, <name><surname>Vöhringer</surname><given-names>H</given-names></name>, <name><surname>Haunsberger</surname><given-names>SJ</given-names></name>, <name><surname>Söding</surname><given-names>J</given-names></name>. <article-title>Hh-suite3 for fast remote homology detection and deep protein annotation</article-title>. <source>BMC Bioinformatics</source>. <year>2019</year>;<volume>20</volume>(<issue>1</issue>):<fpage>473</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s12859-019-3019-7</pub-id><?supplied-pmid 31521110?><pub-id pub-id-type="pmid">31521110</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Biasini</surname><given-names>M</given-names></name>, <name><surname>Bienert</surname><given-names>S</given-names></name>, <name><surname>Waterhouse</surname><given-names>A</given-names></name>, <name><surname>Arnold</surname><given-names>K</given-names></name>, <name><surname>Studer</surname><given-names>G</given-names></name>, <name><surname>Schmidt</surname><given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Swiss-model: Modelling protein tertiary and quaternary structure using evolutionary information</article-title>. <source>Nucleic Acids Res</source>. <year>2014</year>;<volume>42</volume>(<issue>W1</issue>):<fpage>W252</fpage>–<lpage>W8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gku340</pub-id><?supplied-pmid 24782522?><pub-id pub-id-type="pmid">24782522</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Armon</surname><given-names>A</given-names></name>, <name><surname>Graur</surname><given-names>D</given-names></name>, <name><surname>Ben-Tal</surname><given-names>N</given-names></name>. <article-title>Consurf: An algorithmic tool for the identification of functional regions in proteins by surface mapping of phylogenetic information</article-title>. <source>J Mol Biol</source>. <year>2001</year>;<volume>307</volume>(<issue>1</issue>):<fpage>447</fpage>–<lpage>63</lpage>. Epub 2001/03/13. <comment>doi: </comment><pub-id pub-id-type="doi">10.1006/jmbi.2000.4474</pub-id> .<?supplied-pmid 11243830?><pub-id pub-id-type="pmid">11243830</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Martz</surname><given-names>E</given-names></name>, <name><surname>Ashkenazy</surname><given-names>H</given-names></name>, <name><surname>Chay</surname><given-names>O</given-names></name>, <name><surname>Abadi</surname><given-names>S</given-names></name>, <name><surname>Ben-Tal</surname><given-names>N</given-names></name>, <name><surname>Mayrose</surname><given-names>I</given-names></name>, <etal>et al</etal>. <article-title>Consurf 2016: An improved methodology to estimate and visualize evolutionary conservation in macromolecules</article-title>. <source>Nucleic Acids Res</source>. <year>2016</year>;<volume>44</volume>(<issue>W1</issue>):<fpage>W344</fpage>–<lpage>W50</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkw408</pub-id><?supplied-pmid 27166375?><pub-id pub-id-type="pmid">27166375</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Celniker</surname><given-names>G</given-names></name>, <name><surname>Nimrod</surname><given-names>G</given-names></name>, <name><surname>Ashkenazy</surname><given-names>H</given-names></name>, <name><surname>Glaser</surname><given-names>F</given-names></name>, <name><surname>Martz</surname><given-names>E</given-names></name>, <name><surname>Mayrose</surname><given-names>I</given-names></name>, <etal>et al</etal>. <article-title>Consurf: Using evolutionary data to raise testable hypotheses about protein function</article-title>. <source>Isr J Chem</source>. <year>2013</year>;<volume>53</volume>(<issue>3–4</issue>):<fpage>199</fpage>–<lpage>206</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/ijch.201200096</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Glaser</surname><given-names>F</given-names></name>, <name><surname>Mayrose</surname><given-names>I</given-names></name>, <name><surname>Ben-Tal</surname><given-names>N</given-names></name>, <name><surname>Bell</surname><given-names>RE</given-names></name>, <name><surname>Pupko</surname><given-names>T</given-names></name>. <article-title>Rate4site: An algorithmic tool for the identification of functional regions in proteins by surface mapping of evolutionary determinants within their homologues</article-title>. <source>Bioinformatics</source>. <year>2002</year>;<volume>18</volume>(<issue>suppl_1</issue>):<fpage>S71</fpage>–<lpage>S7</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/18.suppl_1.s71</pub-id><?supplied-pmid 12169533?><pub-id pub-id-type="pmid">12169533</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Crooks</surname><given-names>GE</given-names></name>, <name><surname>Hon</surname><given-names>G</given-names></name>, <name><surname>Chandonia</surname><given-names>JM</given-names></name>, <name><surname>Brenner</surname><given-names>SE</given-names></name>. <article-title>Weblogo: A sequence logo generator</article-title>. <source>Genome Res</source>. <year>2004</year>;<volume>14</volume>(<issue>6</issue>):<fpage>1188</fpage>–<lpage>90</lpage>. Epub 2004/06/03. <comment>doi: </comment><pub-id pub-id-type="doi">10.1101/gr.849004</pub-id> ; PubMed Central PMCID: PMC419797.<?supplied-pmid 15173120?><pub-id pub-id-type="pmid">15173120</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Dayhoff</surname><given-names>M</given-names></name>, <name><surname>Schwartz</surname><given-names>R</given-names></name>, <name><surname>Orcutt</surname><given-names>B</given-names></name>. <article-title>22 a model of evolutionary change in proteins. Atlas of protein sequence and structure</article-title>. <source>5: National Biomedical Research Foundation Silver Spring</source>; <year>1978</year>. p. <fpage>345</fpage>–<lpage>52</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Jones</surname><given-names>DT</given-names></name>, <name><surname>Taylor</surname><given-names>WR</given-names></name>, <name><surname>Thornton</surname><given-names>JM</given-names></name>. <article-title>The rapid generation of mutation data matrices from protein sequences</article-title>. <source>Bioinformatics</source>. <year>1992</year>;<volume>8</volume>(<issue>3</issue>):<fpage>275</fpage>–<lpage>82</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/8.3.275</pub-id><?supplied-pmid 1633570?><pub-id pub-id-type="pmid">1633570</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Gonnet</surname><given-names>GH</given-names></name>, <name><surname>Cohen</surname><given-names>MA</given-names></name>, <name><surname>Benner</surname><given-names>SA</given-names></name>. <article-title>Exhaustive matching of the entire protein sequence database</article-title>. <source>Science</source>. <year>1992</year>;<volume>256</volume>(<issue>5062</issue>):<fpage>1443</fpage>–<lpage>5</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.1604319</pub-id><?supplied-pmid 1604319?><pub-id pub-id-type="pmid">1604319</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Whelan</surname><given-names>S</given-names></name>, <name><surname>Goldman</surname><given-names>N</given-names></name>. <article-title>A general empirical model of protein evolution derived from multiple protein families using a maximum-likelihood approach</article-title>. <source>Mol Biol Evol</source>. <year>2001</year>;<volume>18</volume>(<issue>5</issue>):<fpage>691</fpage>–<lpage>9</lpage>. Epub 2001/04/25. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a003851</pub-id> .<?supplied-pmid 11319253?><pub-id pub-id-type="pmid">11319253</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Le</surname><given-names>SQ</given-names></name>, <name><surname>Gascuel</surname><given-names>O</given-names></name>. <article-title>An improved general amino acid replacement matrix</article-title>. <source>Mol Biol Evol</source>. <year>2008</year>;<volume>25</volume>(<issue>7</issue>):<fpage>1307</fpage>–<lpage>20</lpage>. Epub 2008/03/28. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msn067</pub-id> .<?supplied-pmid 18367465?><pub-id pub-id-type="pmid">18367465</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Le</surname><given-names>SQ</given-names></name>, <name><surname>Gascuel</surname><given-names>O</given-names></name>. <article-title>Accounting for solvent accessibility and secondary structure in protein phylogenetics is clearly beneficial</article-title>. <source>Syst Biol</source>. <year>2010</year>;<volume>59</volume>(<issue>3</issue>):<fpage>277</fpage>–<lpage>87</lpage>. Epub 2010/06/09. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/sysbio/syq002</pub-id> .<?supplied-pmid 20525635?><pub-id pub-id-type="pmid">20525635</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Jones</surname><given-names>D</given-names></name>, <name><surname>Taylor</surname><given-names>W</given-names></name>, <name><surname>Thornton</surname><given-names>J</given-names></name>. <article-title>A model recognition approach to the prediction of all-helical membrane protein structure and topology</article-title>. <source>Biochemistry</source>. <year>1994</year>;<volume>33</volume>(<issue>10</issue>):<fpage>3038</fpage>–<lpage>49</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1021/bi00176a037</pub-id><?supplied-pmid 8130217?><pub-id pub-id-type="pmid">8130217</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Adachi</surname><given-names>J</given-names></name>, <name><surname>Hasegawa</surname><given-names>M</given-names></name>. <article-title>Model of amino acid substitution in proteins encoded by mitochondrial DNA</article-title>. <source>J Mol Evol</source>. <year>1996</year>;<volume>42</volume>(<issue>4</issue>):<fpage>459</fpage>–<lpage>68</lpage>. Epub 1996/04/01. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/BF02498640</pub-id> .<?supplied-pmid 8642615?><pub-id pub-id-type="pmid">8642615</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Henikoff</surname><given-names>S</given-names></name>, <name><surname>Henikoff</surname><given-names>JG</given-names></name>. <article-title>Amino acid substitution matrices from protein blocks</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>1992</year>;<volume>89</volume>(<issue>22</issue>):<fpage>10915</fpage>–<lpage>9</lpage>. Epub 1992/11/15. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.89.22.10915</pub-id> ; PubMed Central PMCID: PMC50453.<?supplied-pmid 1438297?><pub-id pub-id-type="pmid">1438297</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref047">
      <label>47</label>
      <mixed-citation publication-type="book"><name><surname>Kimura</surname><given-names>M</given-names></name>. <source>The neutral theory of molecular evolution</source>: <publisher-name>Cambridge University Press</publisher-name>; <year>1983</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Schneider</surname><given-names>TD</given-names></name>, <name><surname>Stephens</surname><given-names>RM</given-names></name>. <article-title>Sequence logos: A new way to display consensus sequences</article-title>. <source>Nucleic Acids Res</source>. <year>1990</year>;<volume>18</volume>(<issue>20</issue>):<fpage>6097</fpage>–<lpage>100</lpage>. Epub 1990/10/25. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/18.20.6097</pub-id> ; PubMed Central PMCID: PMC332411.<?supplied-pmid 2172928?><pub-id pub-id-type="pmid">2172928</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref049">
      <label>49</label>
      <mixed-citation publication-type="book"><name><surname>Page</surname><given-names>RDM</given-names></name>, <name><surname>Holmes</surname><given-names>EC</given-names></name>. <source>Molecular evolution: A phylogenetic approach</source>. <publisher-loc>Oxford</publisher-loc>: <publisher-name>Wiley-Blackwell</publisher-name>; <year>1998</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref050">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Lichtarge</surname><given-names>O</given-names></name>, <name><surname>Sowa</surname><given-names>ME</given-names></name>. <article-title>Evolutionary predictions of binding surfaces and interactions</article-title>. <source>Curr Opin Struct Biol</source>. <year>2002</year>;<volume>12</volume>(<issue>1</issue>):<fpage>21</fpage>–<lpage>7</lpage>. Epub 2002/02/13. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/s0959-440x(02)00284-1</pub-id> .<?supplied-pmid 11839485?><pub-id pub-id-type="pmid">11839485</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref051">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Pupko</surname><given-names>T</given-names></name>, <name><surname>Pe’er</surname><given-names>I</given-names></name>, <name><surname>Hasegawa</surname><given-names>M</given-names></name>, <name><surname>Graur</surname><given-names>D</given-names></name>, <name><surname>Friedman</surname><given-names>N</given-names></name>. <article-title>A branch-and-bound algorithm for the inference of ancestral amino-acid sequences when the replacement rate varies among sites: Application to the evolution of five gene families</article-title>. <source>Bioinformatics</source>. <year>2002</year>;<volume>18</volume>(<issue>8</issue>):<fpage>1116</fpage>–<lpage>23</lpage>. Epub 2002/08/15. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/18.8.1116</pub-id> .<?supplied-pmid 12176835?><pub-id pub-id-type="pmid">12176835</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Pei</surname><given-names>J</given-names></name>, <name><surname>Grishin</surname><given-names>NV</given-names></name>. <article-title>Al2co: Calculation of positional conservation in a protein sequence alignment</article-title>. <source>Bioinformatics</source>. <year>2001</year>;<volume>17</volume>(<issue>8</issue>):<fpage>700</fpage>–<lpage>12</lpage>. Epub 2001/08/29. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/17.8.700</pub-id> .<?supplied-pmid 11524371?><pub-id pub-id-type="pmid">11524371</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref053">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Gu</surname><given-names>X</given-names></name>, <name><surname>Vander Velden</surname><given-names>K</given-names></name>. <article-title>Diverge: Phylogeny-based analysis for functional–structural divergence of a protein family</article-title>. <source>Bioinformatics</source>. <year>2002</year>;<volume>18</volume>(<issue>3</issue>):<fpage>500</fpage>–<lpage>1</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/18.3.500</pub-id><?supplied-pmid 11934757?><pub-id pub-id-type="pmid">11934757</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref054">
      <label>54</label>
      <mixed-citation publication-type="journal"><name><surname>Gu</surname><given-names>X</given-names></name>, <name><surname>Zou</surname><given-names>Y</given-names></name>, <name><surname>Su</surname><given-names>Z</given-names></name>, <name><surname>Huang</surname><given-names>W</given-names></name>, <name><surname>Zhou</surname><given-names>Z</given-names></name>, <name><surname>Arendsee</surname><given-names>Z</given-names></name>, <etal>et al</etal>. <article-title>An update of diverge software for functional divergence analysis of protein family</article-title>. <source>Mol Biol Evol</source>. <year>2013</year>;<volume>30</volume>(<issue>7</issue>):<fpage>1713</fpage>–<lpage>9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/mst069</pub-id><?supplied-pmid 23589455?><pub-id pub-id-type="pmid">23589455</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref055">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>DeLey Cox</surname><given-names>VE</given-names></name>, <name><surname>Cole</surname><given-names>MF</given-names></name>, <name><surname>Gaucher</surname><given-names>EA</given-names></name>. <article-title>Incorporation of modified amino acids by engineered elongation factors with expanded substrate capabilities</article-title>. <source>ACS Synthetic Biology</source>. <year>2019</year>;<volume>8</volume>(<issue>2</issue>):<fpage>287</fpage>–<lpage>96</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1021/acssynbio.8b00305</pub-id><?supplied-pmid 30609889?><pub-id pub-id-type="pmid">30609889</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref056">
      <label>56</label>
      <mixed-citation publication-type="journal"><name><surname>King Jordan</surname><given-names>I</given-names></name>, <name><surname>Kota</surname><given-names>KC</given-names></name>, <name><surname>Cui</surname><given-names>G</given-names></name>, <name><surname>Thompson</surname><given-names>CH</given-names></name>, <name><surname>McCarty</surname><given-names>NA</given-names></name>. <article-title>Evolutionary and functional divergence between the cystic fibrosis transmembrane conductance regulator and related atp-binding cassette transporters</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2008</year>;<volume>105</volume>(<issue>48</issue>):<fpage>18865</fpage>–<lpage>70</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.0806306105</pub-id><?supplied-pmid 19020075?><pub-id pub-id-type="pmid">19020075</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref057">
      <label>57</label>
      <mixed-citation publication-type="journal"><name><surname>Alva</surname><given-names>V</given-names></name>, <name><surname>Söding</surname><given-names>J</given-names></name>, <name><surname>Lupas</surname><given-names>AN</given-names></name>. <article-title>A vocabulary of ancient peptides at the origin of folded proteins</article-title>. <source>eLife</source>. <year>2015</year>:<fpage>e09410</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.7554/eLife.09410</pub-id><?supplied-pmid 26653858?><pub-id pub-id-type="pmid">26653858</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref058">
      <label>58</label>
      <mixed-citation publication-type="journal"><name><surname>Nepomnyachiy</surname><given-names>S</given-names></name>, <name><surname>Ben-Tal</surname><given-names>N</given-names></name>, <name><surname>Kolodny</surname><given-names>R</given-names></name>. <article-title>Complex evolutionary footprints revealed in an analysis of reused protein segments of diverse lengths</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2017</year>;<volume>114</volume>(<issue>44</issue>):<fpage>11703</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.1707642114</pub-id><?supplied-pmid 29078314?><pub-id pub-id-type="pmid">29078314</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref059">
      <label>59</label>
      <mixed-citation publication-type="journal"><name><surname>Sibbald</surname><given-names>PR</given-names></name>, <name><surname>Argos</surname><given-names>P</given-names></name>. <article-title>Weighting aligned protein or nucleic acid sequences to correct for unequal representation</article-title>. <source>J Mol Biol</source>. <year>1990</year>;<volume>216</volume>(<issue>4</issue>):<fpage>813</fpage>–<lpage>8</lpage>. Epub 1990/12/20. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/S0022-2836(99)80003-5</pub-id> .<?supplied-pmid 2176240?><pub-id pub-id-type="pmid">2176240</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref060">
      <label>60</label>
      <mixed-citation publication-type="journal"><name><surname>Allen</surname><given-names>B</given-names></name>, <name><surname>Kon</surname><given-names>M</given-names></name>, <name><surname>Bar-Yam</surname><given-names>Y</given-names></name>. <article-title>A new phylogenetic diversity measure generalizing the shannon index and its application to phyllostomid bats</article-title>. <source>The American Naturalist</source>. <year>2009</year>;<volume>174</volume>(<issue>2</issue>):<fpage>236</fpage>–<lpage>43</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1086/600101</pub-id><?supplied-pmid 19548837?><pub-id pub-id-type="pmid">19548837</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref061">
      <label>61</label>
      <mixed-citation publication-type="journal"><name><surname>Vogt</surname><given-names>G</given-names></name>, <name><surname>Etzold</surname><given-names>T</given-names></name>, <name><surname>Argos</surname><given-names>P</given-names></name>. <article-title>An assessment of amino acid exchange matrices in aligning protein sequences: The twilight zone revisited</article-title>. <source>J Mol Biol</source>. <year>1995</year>;<volume>249</volume>(<issue>4</issue>):<fpage>816</fpage>–<lpage>31</lpage>. <pub-id pub-id-type="doi">10.1006/jmbi.1995.0340</pub-id><?supplied-pmid 7602593?><pub-id pub-id-type="pmid">7602593</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref062">
      <label>62</label>
      <mixed-citation publication-type="journal"><name><surname>Yang</surname><given-names>Z</given-names></name>. <article-title>Paml: A program package for phylogenetic analysis by maximum likelihood</article-title>. <source>Bioinformatics</source>. <year>1997</year>;<volume>13</volume>(<issue>5</issue>):<fpage>555</fpage>–<lpage>6</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/13.5.555</pub-id><?supplied-pmid 9367129?><pub-id pub-id-type="pmid">9367129</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref063">
      <label>63</label>
      <mixed-citation publication-type="journal"><name><surname>Yang</surname><given-names>Z</given-names></name>. <article-title>Paml 4: Phylogenetic analysis by maximum likelihood</article-title>. <source>Mol Biol Evol</source>. <year>2007</year>;<volume>24</volume>(<issue>8</issue>):<fpage>1586</fpage>–<lpage>91</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msm088</pub-id><?supplied-pmid 17483113?><pub-id pub-id-type="pmid">17483113</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref064">
      <label>64</label>
      <mixed-citation publication-type="journal"><name><surname>Yu</surname><given-names>Y-K</given-names></name>, <name><surname>Wootton</surname><given-names>JC</given-names></name>, <name><surname>Altschul</surname><given-names>SF</given-names></name>. <article-title>The compositional adjustment of amino acid substitution matrices</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2003</year>;<volume>100</volume>(<issue>26</issue>):<fpage>15688</fpage>–<lpage>93</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.2533904100</pub-id><?supplied-pmid 14663142?><pub-id pub-id-type="pmid">14663142</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref065">
      <label>65</label>
      <mixed-citation publication-type="journal"><name><surname>Yu</surname><given-names>Y-K</given-names></name>, <name><surname>Altschul</surname><given-names>SF</given-names></name>. <article-title>The construction of amino acid substitution matrices for the comparison of proteins with non-standard compositions</article-title>. <source>Bioinformatics</source>. <year>2004</year>;<volume>21</volume>(<issue>7</issue>):<fpage>902</fpage>–<lpage>11</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bti070</pub-id><?supplied-pmid 15509610?><pub-id pub-id-type="pmid">15509610</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref066">
      <label>66</label>
      <mixed-citation publication-type="journal"><name><surname>Savitzky</surname><given-names>A</given-names></name>, <name><surname>Golay</surname><given-names>MJE</given-names></name>. <article-title>Smoothing and differentiation of data by simplified least squares procedures</article-title>. <source>Analytical Chemistry</source>. <year>1964</year>;<volume>36</volume>(<issue>8</issue>):<fpage>1627</fpage>–<lpage>39</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1021/ac60214a047</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref067">
      <label>67</label>
      <mixed-citation publication-type="journal"><name><surname>Fletcher</surname><given-names>W</given-names></name>, <name><surname>Yang</surname><given-names>Z</given-names></name>. <article-title>Indelible: A flexible simulator of biological sequence evolution</article-title>. <source>Mol Biol Evol</source>. <year>2009</year>;<volume>26</volume>(<issue>8</issue>):<fpage>1879</fpage>–<lpage>88</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msp098</pub-id><?supplied-pmid 19423664?><pub-id pub-id-type="pmid">19423664</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref068">
      <label>68</label>
      <mixed-citation publication-type="journal"><name><surname>Thompson</surname><given-names>JD</given-names></name>, <name><surname>Koehl</surname><given-names>P</given-names></name>, <name><surname>Ripp</surname><given-names>R</given-names></name>, <name><surname>Poch</surname><given-names>O</given-names></name>. <article-title>Balibase 3.0: Latest developments of the multiple sequence alignment benchmark. Proteins</article-title>: <source>Struct Funct Bioinform</source>. <year>2005</year>;<volume>61</volume>(<issue>1</issue>):<fpage>127</fpage>–<lpage>36</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/prot.20527</pub-id><?supplied-pmid 16044462?><pub-id pub-id-type="pmid">16044462</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref069">
      <label>69</label>
      <mixed-citation publication-type="journal"><name><surname>Sigrist</surname><given-names>CJA</given-names></name>, <name><surname>Cerutti</surname><given-names>L</given-names></name>, <name><surname>Hulo</surname><given-names>N</given-names></name>, <name><surname>Gattiker</surname><given-names>A</given-names></name>, <name><surname>Falquet</surname><given-names>L</given-names></name>, <name><surname>Pagni</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Prosite: A documented database using patterns and profiles as motif descriptors</article-title>. <source>Briefings in Bioinformatics</source>. <year>2002</year>;<volume>3</volume>(<issue>3</issue>):<fpage>265</fpage>–<lpage>74</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bib/3.3.265</pub-id><?supplied-pmid 12230035?><pub-id pub-id-type="pmid">12230035</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref070">
      <label>70</label>
      <mixed-citation publication-type="journal"><name><surname>Sigrist</surname><given-names>CJ</given-names></name>, <name><surname>de Castro</surname><given-names>E</given-names></name>, <name><surname>Cerutti</surname><given-names>L</given-names></name>, <name><surname>Cuche</surname><given-names>BA</given-names></name>, <name><surname>Hulo</surname><given-names>N</given-names></name>, <name><surname>Bridge</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>New and continuing developments at prosite</article-title>. <source>Nucleic Acids Res</source>. <year>2013</year>;<volume>41</volume>(<issue>Database issue</issue>):<fpage>D344</fpage>–<lpage>7</lpage>. Epub 2012/11/20. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gks1067</pub-id> ; PubMed Central PMCID: PMC3531220.<?supplied-pmid 23161676?><pub-id pub-id-type="pmid">23161676</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref071">
      <label>71</label>
      <mixed-citation publication-type="journal"><name><surname>Bernier</surname><given-names>CR</given-names></name>, <name><surname>Petrov</surname><given-names>AS</given-names></name>, <name><surname>Kovacs</surname><given-names>NA</given-names></name>, <name><surname>Penev</surname><given-names>PI</given-names></name>, <name><surname>Williams</surname><given-names>LD</given-names></name>. <article-title>Translation: The universal structural core of life</article-title>. <source>Mol Biol Evol</source>. <year>2018</year>;<volume>35</volume>(<issue>8</issue>):<fpage>2065</fpage>–<lpage>76</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msy101</pub-id><?supplied-pmid 29788252?><pub-id pub-id-type="pmid">29788252</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref072">
      <label>72</label>
      <mixed-citation publication-type="other">Boser BE, Guyon IM, Vapnik VN. A training algorithm for optimal margin classifiers. Proceedings of the fifth annual workshop on Computational learning theory; Pittsburgh, Pennsylvania, USA: Association for Computing Machinery; 1992. p. 144–52.</mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref073">
      <label>73</label>
      <mixed-citation publication-type="journal"><name><surname>Breiman</surname><given-names>L</given-names></name>. <article-title>Random forests</article-title>. <source>Machine Learning</source>. <year>2001</year>;<volume>45</volume>(<issue>1</issue>):<fpage>5</fpage>–<lpage>32</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1023/A:1010933404324</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref074">
      <label>74</label>
      <mixed-citation publication-type="journal"><name><surname>Pedregosa</surname><given-names>F</given-names></name>, <name><surname>Varoquaux</surname><given-names>G</given-names></name>, <name><surname>Gramfort</surname><given-names>A</given-names></name>, <name><surname>Michel</surname><given-names>V</given-names></name>, <name><surname>Thirion</surname><given-names>B</given-names></name>, <name><surname>Grisel</surname><given-names>O</given-names></name>, <etal>et al</etal>. <article-title>Scikit-learn: Machine learning in python</article-title>. <source>Journal of Machine Learning Research</source>. <year>2011</year>;<volume>12</volume>(<issue>85</issue>):<fpage>2825</fpage>–<lpage>30</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref075">
      <label>75</label>
      <mixed-citation publication-type="journal"><name><surname>Cheng</surname><given-names>H</given-names></name>, <name><surname>Schaeffer</surname><given-names>RD</given-names></name>, <name><surname>Liao</surname><given-names>Y</given-names></name>, <name><surname>Kinch</surname><given-names>LN</given-names></name>, <name><surname>Pei</surname><given-names>J</given-names></name>, <name><surname>Shi</surname><given-names>S</given-names></name>, <etal>et al</etal>.<article-title>Ecod: An evolutionary classification of protein domains</article-title>. <source>PLoS Comp Biol</source>. <year>2014</year>;<volume>10</volume>(<issue>12</issue>):e1003926-e. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003926</pub-id> .<?supplied-pmid 25474468?><pub-id pub-id-type="pmid">25474468</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref076">
      <label>76</label>
      <mixed-citation publication-type="journal"><name><surname>Vishwanath</surname><given-names>P</given-names></name>, <name><surname>Favaretto</surname><given-names>P</given-names></name>, <name><surname>Hartman</surname><given-names>H</given-names></name>, <name><surname>Mohr</surname><given-names>SC</given-names></name>, <name><surname>Smith</surname><given-names>TF</given-names></name>. <article-title>Ribosomal protein-sequence block structure suggests complex prokaryotic evolution with implications for the origin of eukaryotes</article-title>. <source>Mol Phylogen Evol</source>. <year>2004</year>;<volume>33</volume>(<issue>3</issue>):<fpage>615</fpage>–<lpage>25</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.ympev.2004.07.003</pub-id><?supplied-pmid 15522791?><pub-id pub-id-type="pmid">15522791</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref077">
      <label>77</label>
      <mixed-citation publication-type="journal"><name><surname>Penev</surname><given-names>PI</given-names></name>, <name><surname>McCann</surname><given-names>HM</given-names></name>, <name><surname>Meade</surname><given-names>CD</given-names></name>, <name><surname>Alvarez-Carreño</surname><given-names>C</given-names></name>, <name><surname>Maddala</surname><given-names>A</given-names></name>, <name><surname>Bernier Chad</surname><given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Proteovision: Web server for advanced visualization of ribosomal proteins</article-title>. <source>Nucleic Acids Res</source>. <year>2021</year>;<volume>49</volume>(<issue>W1</issue>):<fpage>W578</fpage>–<lpage>W88</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkab351</pub-id><?supplied-pmid 33999189?><pub-id pub-id-type="pmid">33999189</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref078">
      <label>78</label>
      <mixed-citation publication-type="journal"><name><surname>Fournier</surname><given-names>GP</given-names></name>, <name><surname>Alm</surname><given-names>EJ</given-names></name>. <article-title>Ancestral reconstruction of a pre-luca aminoacyl-trna synthetase ancestor supports the late addition of trp to the genetic code</article-title>. <source>J Mol Evol</source>. <year>2015</year>;<volume>80</volume>(<issue>3</issue>):<fpage>171</fpage>–<lpage>85</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s00239-015-9672-1</pub-id><?supplied-pmid 25791872?><pub-id pub-id-type="pmid">25791872</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref079">
      <label>79</label>
      <mixed-citation publication-type="journal"><name><surname>Dunkle</surname><given-names>JA</given-names></name>, <name><surname>Wang</surname><given-names>L</given-names></name>, <name><surname>Feldman</surname><given-names>MB</given-names></name>, <name><surname>Pulk</surname><given-names>A</given-names></name>, <name><surname>Chen</surname><given-names>VB</given-names></name>, <name><surname>Kapral</surname><given-names>GJ</given-names></name>, <etal>et al</etal>. <article-title>Structures of the bacterial ribosome in classical and hybrid states of trna binding</article-title>. <source>Science</source>. <year>2011</year>;<volume>332</volume>(<issue>6032</issue>):<fpage>981</fpage>–<lpage>4</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.1202692</pub-id><?supplied-pmid 21596992?><pub-id pub-id-type="pmid">21596992</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref080">
      <label>80</label>
      <mixed-citation publication-type="journal"><name><surname>Armache</surname><given-names>JP</given-names></name>, <name><surname>Anger</surname><given-names>AM</given-names></name>, <name><surname>Marquez</surname><given-names>V</given-names></name>, <name><surname>Franckenberg</surname><given-names>S</given-names></name>, <name><surname>Frohlich</surname><given-names>T</given-names></name>, <name><surname>Villa</surname><given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Promiscuous behaviour of archaeal ribosomal proteins: Implications for eukaryotic ribosome evolution</article-title>. <source>Nucleic Acids Res</source>. <year>2013</year>;<volume>41</volume>(<issue>2</issue>):<fpage>1284</fpage>–<lpage>93</lpage>. Epub 2012/12/12. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gks1259</pub-id> ; PubMed Central PMCID: PMC3553981.<?supplied-pmid 23222135?><pub-id pub-id-type="pmid">23222135</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref081">
      <label>81</label>
      <mixed-citation publication-type="journal"><name><surname>Fournier</surname><given-names>GP</given-names></name>, <name><surname>Neumann</surname><given-names>JE</given-names></name>, <name><surname>Gogarten</surname><given-names>JP</given-names></name>. <article-title>Inferring the ancient history of the translation machinery and genetic code via recapitulation of ribosomal subunit assembly orders</article-title>. <source>PLoS One</source>. <year>2010</year>;<volume>5</volume>(<issue>3</issue>):e9437-e. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0009437</pub-id> .<?supplied-pmid 20208990?><pub-id pub-id-type="pmid">20208990</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref082">
      <label>82</label>
      <mixed-citation publication-type="book"><name><surname>Fox</surname><given-names>GE</given-names></name>, <name><surname>Naik</surname><given-names>AK</given-names></name>. <part-title>The evolutionary history of the translation machinery</part-title>. In: <name><surname>de Pouplana</surname><given-names>LR</given-names></name>, editor. <source>The genetic code and the origin of life</source>: <publisher-name>Kluwer Academic / Plenum Publishers</publisher-name>, <publisher-loc>New York</publisher-loc><year>2004</year>. p. <fpage>92</fpage>–<lpage>105</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref083">
      <label>83</label>
      <mixed-citation publication-type="book"><name><surname>Fox</surname><given-names>GE</given-names></name>. <part-title>Origins and early evolution of the ribosome</part-title>. In: <name><surname>Hernández</surname><given-names>G</given-names></name>, <name><surname>Jagus</surname><given-names>R</given-names></name>, editors. <source>Evolution of the protein synthesis machinery and its regulation</source>. <publisher-loc>Cham</publisher-loc>: <publisher-name>Springer International Publishing</publisher-name>; <year>2016</year>. p. <fpage>31</fpage>–<lpage>60</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref084">
      <label>84</label>
      <mixed-citation publication-type="journal"><name><surname>Klim</surname><given-names>J</given-names></name>, <name><surname>Gładki</surname><given-names>A</given-names></name>, <name><surname>Kucharczyk</surname><given-names>R</given-names></name>, <name><surname>Zielenkiewicz</surname><given-names>U</given-names></name>, <name><surname>Kaczanowski</surname><given-names>S</given-names></name>. <article-title>Ancestral state reconstruction of the apoptosis machinery in the common ancestor of eukaryotes</article-title>. <source>G3 (Bethesda, Md)</source>. <year>2018</year>;<volume>8</volume>(<issue>6</issue>):<fpage>2121</fpage>–<lpage>34</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1534/g3.118.200295</pub-id> .<?supplied-pmid 29703784?><pub-id pub-id-type="pmid">29703784</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref085">
      <label>85</label>
      <mixed-citation publication-type="journal"><name><surname>Renatus</surname><given-names>M</given-names></name>, <name><surname>Stennicke</surname><given-names>HR</given-names></name>, <name><surname>Scott</surname><given-names>FL</given-names></name>, <name><surname>Liddington</surname><given-names>RC</given-names></name>, <name><surname>Salvesen</surname><given-names>GS</given-names></name>. <article-title>Dimer formation drives the activation of the cell death protease caspase 9</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2001</year>;<volume>98</volume>(<issue>25</issue>):<fpage>14250</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.231465798</pub-id><?supplied-pmid 11734640?><pub-id pub-id-type="pmid">11734640</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref086">
      <label>86</label>
      <mixed-citation publication-type="journal"><name><surname>Wong</surname><given-names>AH-H</given-names></name>, <name><surname>Yan</surname><given-names>C</given-names></name>, <name><surname>Shi</surname><given-names>Y</given-names></name>. <article-title>Crystal structure of the yeast metacaspase yca1</article-title>. <source>The Journal of biological chemistry</source>. <year>2012</year>;<volume>287</volume>(<issue>35</issue>):<fpage>29251</fpage>–<lpage>9</lpage>. Epub 2012/07/02. <comment>doi: </comment><pub-id pub-id-type="doi">10.1074/jbc.M112.381806</pub-id> .<?supplied-pmid 22761449?><pub-id pub-id-type="pmid">22761449</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref087">
      <label>87</label>
      <mixed-citation publication-type="journal"><name><surname>Söding</surname><given-names>J</given-names></name>. <article-title>Protein homology detection by hmm–hmm comparison</article-title>. <source>Bioinformatics</source>. <year>2004</year>;<volume>21</volume>(<issue>7</issue>):<fpage>951</fpage>–<lpage>60</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bti125</pub-id><?supplied-pmid 15531603?><pub-id pub-id-type="pmid">15531603</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref088">
      <label>88</label>
      <mixed-citation publication-type="journal"><name><surname>Kovacs</surname><given-names>NA</given-names></name>, <name><surname>Penev</surname><given-names>PI</given-names></name>, <name><surname>Venapally</surname><given-names>A</given-names></name>, <name><surname>Petrov</surname><given-names>AS</given-names></name>, <name><surname>Williams</surname><given-names>LD</given-names></name>. <article-title>Circular permutation obscures universality of a ribosomal protein</article-title>. <source>J Mol Evol</source>. <year>2018</year>;<volume>86</volume>(<issue>8</issue>):<fpage>581</fpage>–<lpage>92</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s00239-018-9869-1</pub-id><?supplied-pmid 30306205?><pub-id pub-id-type="pmid">30306205</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref089">
      <label>89</label>
      <mixed-citation publication-type="journal"><name><surname>Klein</surname><given-names>D</given-names></name>, <name><surname>Moore</surname><given-names>P</given-names></name>, <name><surname>Steitz</surname><given-names>T</given-names></name>. <article-title>The roles of ribosomal proteins in the structure assembly, and evolution of the large ribosomal subunit</article-title>. <source>J Mol Biol</source>. <year>2004</year>;<volume>340</volume>(<issue>1</issue>):<fpage>141</fpage>–<lpage>77</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.jmb.2004.03.076</pub-id><?supplied-pmid 15184028?><pub-id pub-id-type="pmid">15184028</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref090">
      <label>90</label>
      <mixed-citation publication-type="journal"><name><surname>Ban</surname><given-names>N</given-names></name>, <name><surname>Beckmann</surname><given-names>R</given-names></name>, <name><surname>Cate</surname><given-names>JH</given-names></name>, <name><surname>Dinman</surname><given-names>JD</given-names></name>, <name><surname>Dragon</surname><given-names>F</given-names></name>, <name><surname>Ellis</surname><given-names>SR</given-names></name>, <etal>et al</etal>. <article-title>A new system for naming ribosomal proteins</article-title>. <source>Curr Opin Struct Biol</source>. <year>2014</year>;<volume>24</volume>:<fpage>165</fpage>–<lpage>9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.sbi.2014.01.002</pub-id><?supplied-pmid 24524803?><pub-id pub-id-type="pmid">24524803</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref091">
      <label>91</label>
      <mixed-citation publication-type="journal"><name><surname>Timsit</surname><given-names>Y</given-names></name>, <name><surname>Sergeant-Perthuis</surname><given-names>G</given-names></name>, <name><surname>Bennequin</surname><given-names>D</given-names></name>. <article-title>Evolution of ribosomal protein network architectures</article-title>. <source>Sci Rep</source>. <year>2021</year>;<volume>11</volume>(<issue>1</issue>):<fpage>625</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41598-020-80194-4</pub-id><?supplied-pmid 33436806?><pub-id pub-id-type="pmid">33436806</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref092">
      <label>92</label>
      <mixed-citation publication-type="journal"><name><surname>Roberts</surname><given-names>E</given-names></name>, <name><surname>Sethi</surname><given-names>A</given-names></name>, <name><surname>Montoya</surname><given-names>J</given-names></name>, <name><surname>Woese</surname><given-names>CR</given-names></name>, <name><surname>Luthey-Schulten</surname><given-names>Z</given-names></name>. <article-title>Molecular signatures of ribosomal evolution</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2008</year>;<volume>105</volume>(<issue>37</issue>):<fpage>13953</fpage>–<lpage>8</lpage>. Epub 2008/09/05. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.0804861105</pub-id> ; PubMed Central PMCID: PMC2528867.<?supplied-pmid 18768810?><pub-id pub-id-type="pmid">18768810</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref093">
      <label>93</label>
      <mixed-citation publication-type="journal"><name><surname>Bernier</surname><given-names>C</given-names></name>, <name><surname>Petrov</surname><given-names>AS</given-names></name>, <name><surname>Waterbury</surname><given-names>C</given-names></name>, <name><surname>Jett</surname><given-names>J</given-names></name>, <name><surname>Li</surname><given-names>F</given-names></name>, <name><surname>Freil</surname><given-names>LE</given-names></name>, <etal>et al</etal>. <article-title>Ribovision: Visualization and analysis of ribosomes</article-title>. <source>Faraday Discuss</source>. <year>2014</year>;<volume>169</volume>(<issue>1</issue>):<fpage>195</fpage>–<lpage>207</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1039/c3fd00126a</pub-id><?supplied-pmid 25340471?><pub-id pub-id-type="pmid">25340471</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref094">
      <label>94</label>
      <mixed-citation publication-type="other">Schrodinger, LLC. The pymol molecular graphics system, version 1.8. 2015.</mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref095">
      <label>95</label>
      <mixed-citation publication-type="journal"><name><surname>Fitch</surname><given-names>WM</given-names></name>, <name><surname>Smith</surname><given-names>TF</given-names></name>. <article-title>Optimal sequence alignments</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>1983</year>;<volume>80</volume>(<issue>5</issue>):<fpage>1382</fpage>–<lpage>6</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.80.5.1382</pub-id><?supplied-pmid 16593289?><pub-id pub-id-type="pmid">16593289</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref096">
      <label>96</label>
      <mixed-citation publication-type="journal"><name><surname>Andreeva</surname><given-names>A</given-names></name>, <name><surname>Kulesha</surname><given-names>E</given-names></name>, <name><surname>Gough</surname><given-names>J</given-names></name>, <name><surname>Murzin</surname><given-names>AG</given-names></name>. <article-title>The scop database in 2020: Expanded classification of representative family and superfamily domains of known protein structures</article-title>. <source>Nucleic Acids Res</source>. <year>2019</year>;<volume>48</volume>(<issue>D1</issue>):<fpage>D376</fpage>–<lpage>D82</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkz1064</pub-id><?supplied-pmid 31724711?><pub-id pub-id-type="pmid">31724711</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref097">
      <label>97</label>
      <mixed-citation publication-type="journal"><name><surname>Sillitoe</surname><given-names>I</given-names></name>, <name><surname>Dawson</surname><given-names>N</given-names></name>, <name><surname>Lewis</surname><given-names>TE</given-names></name>, <name><surname>Das</surname><given-names>S</given-names></name>, <name><surname>Lees</surname><given-names>JG</given-names></name>, <name><surname>Ashford</surname><given-names>P</given-names></name>, <etal>et al</etal>. <article-title>Cath: Expanding the horizons of structure-based functional annotations for genome sequences</article-title>. <source>Nucleic Acids Res</source>. <year>2018</year>;<volume>47</volume>(<issue>D1</issue>):<fpage>D280</fpage>–<lpage>D4</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gky1097</pub-id><?supplied-pmid 30398663?><pub-id pub-id-type="pmid">30398663</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref098">
      <label>98</label>
      <mixed-citation publication-type="journal"><name><surname>Söding</surname><given-names>J</given-names></name>, <name><surname>Lupas</surname><given-names>AN</given-names></name>. <article-title>More than the sum of their parts: On the evolution of proteins from peptides</article-title>. <source>Bioessays</source>. <year>2003</year>;<volume>25</volume>(<issue>9</issue>):<fpage>837</fpage>–<lpage>46</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/bies.10321</pub-id><?supplied-pmid 12938173?><pub-id pub-id-type="pmid">12938173</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref099">
      <label>99</label>
      <mixed-citation publication-type="journal"><name><surname>Lupas</surname><given-names>AN</given-names></name>, <name><surname>Alva</surname><given-names>V</given-names></name>. <article-title>Ribosomal proteins as documents of the transition from unstructured (poly) peptides to folded proteins</article-title>. <source>J Struct Biol</source>. <year>2017</year>;<volume>198</volume>(<issue>2</issue>):<fpage>74</fpage>–<lpage>81</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.jsb.2017.04.007</pub-id><?supplied-pmid 28454764?><pub-id pub-id-type="pmid">28454764</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref100">
      <label>100</label>
      <mixed-citation publication-type="journal"><name><surname>Smith</surname><given-names>TF</given-names></name>, <name><surname>Waterman</surname><given-names>MS</given-names></name>. <article-title>Comparison of biosequences</article-title>. <source>Advances in Applied Mathematics</source>. <year>1981</year>;<volume>2</volume>(<issue>4</issue>):<fpage>482</fpage>–<lpage>9</lpage>. <pub-id pub-id-type="doi">10.1016/0196-8858(81)90046-4</pub-id>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref101">
      <label>101</label>
      <mixed-citation publication-type="journal"><name><surname>Valdar</surname><given-names>WS</given-names></name>. <article-title>Scoring residue conservation</article-title>. <source>Proteins</source>. <year>2002</year>;<volume>48</volume>(<issue>2</issue>):<fpage>227</fpage>–<lpage>41</lpage>. Epub 2002/07/12. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/prot.10146</pub-id> .<?supplied-pmid 12112692?><pub-id pub-id-type="pmid">12112692</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref102">
      <label>102</label>
      <mixed-citation publication-type="journal"><name><surname>Casari</surname><given-names>G</given-names></name>, <name><surname>Sander</surname><given-names>C</given-names></name>, <name><surname>Valencia</surname><given-names>A</given-names></name>. <article-title>A method to predict functional residues in proteins</article-title>. <source>Nat Struct Biol</source>. <year>1995</year>;<volume>2</volume>(<issue>2</issue>):<fpage>171</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nsb0295-171</pub-id><?supplied-pmid 7749921?><pub-id pub-id-type="pmid">7749921</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref103">
      <label>103</label>
      <mixed-citation publication-type="journal"><name><surname>Bharatham</surname><given-names>K</given-names></name>, <name><surname>Zhang</surname><given-names>ZH</given-names></name>, <name><surname>Mihalek</surname><given-names>I</given-names></name>. <article-title>Determinants, discriminants, conserved residues—a heuristic approach to detection of functional divergence in protein families</article-title>. <source>PLoS One</source>. <year>2011</year>;<volume>6</volume>(<issue>9</issue>):e24382-e. Epub 2011/09/12. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0024382</pub-id> .<?supplied-pmid 21931701?><pub-id pub-id-type="pmid">21931701</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref104">
      <label>104</label>
      <mixed-citation publication-type="journal"><name><surname>Capra</surname><given-names>JA</given-names></name>, <name><surname>Singh</surname><given-names>M</given-names></name>. <article-title>Characterization and prediction of residues determining protein functional specificity</article-title>. <source>Bioinformatics</source>. <year>2008</year>;<volume>24</volume>(<issue>13</issue>):<fpage>1473</fpage>–<lpage>80</lpage>. Epub 2008/05/03. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btn214</pub-id> ; PubMed Central PMCID: PMC2718669.<?supplied-pmid 18450811?><pub-id pub-id-type="pmid">18450811</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref105">
      <label>105</label>
      <mixed-citation publication-type="journal"><name><surname>Rausell</surname><given-names>A</given-names></name>, <name><surname>Juan</surname><given-names>D</given-names></name>, <name><surname>Pazos</surname><given-names>F</given-names></name>, <name><surname>Valencia</surname><given-names>A</given-names></name>. <article-title>Protein interactions and ligand binding: From protein subfamilies to functional specificity</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2010</year>;<volume>107</volume>(<issue>5</issue>):<fpage>1995</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.0908044107</pub-id><?supplied-pmid 20133844?><pub-id pub-id-type="pmid">20133844</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref106">
      <label>106</label>
      <mixed-citation publication-type="journal"><name><surname>Pazos</surname><given-names>F</given-names></name>, <name><surname>Sternberg</surname><given-names>MJE</given-names></name>. <article-title>Automated prediction of protein function and detection of functional sites from structure</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2004</year>;<volume>101</volume>(<issue>41</issue>):<fpage>14754</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.0404569101</pub-id><?supplied-pmid 15456910?><pub-id pub-id-type="pmid">15456910</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref107">
      <label>107</label>
      <mixed-citation publication-type="journal"><name><surname>Koonin</surname><given-names>EV</given-names></name>, <name><surname>Krupovic</surname><given-names>M</given-names></name>, <name><surname>Ishino</surname><given-names>S</given-names></name>, <name><surname>Ishino</surname><given-names>Y</given-names></name>. <article-title>The replication machinery of luca: Common origin of DNA replication and transcription</article-title>. <source>BMC Biol</source>. <year>2020</year>;<volume>18</volume>(<issue>1</issue>):<fpage>61</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s12915-020-00800-9</pub-id><?supplied-pmid 32517760?><pub-id pub-id-type="pmid">32517760</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref108">
      <label>108</label>
      <mixed-citation publication-type="journal"><name><surname>Sauguet</surname><given-names>L</given-names></name>, <name><surname>Raia</surname><given-names>P</given-names></name>, <name><surname>Henneke</surname><given-names>G</given-names></name>, <name><surname>Delarue</surname><given-names>M</given-names></name>. <article-title>Shared active site architecture between archaeal pold and multi-subunit rna polymerases revealed by x-ray crystallography</article-title>. <source>Nat Commun</source>. <year>2016</year>;<volume>7</volume>:<fpage>12227</fpage>. Epub 2016/08/23. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/ncomms12227</pub-id> ; PubMed Central PMCID: PMC4996933.<?supplied-pmid 27548043?><pub-id pub-id-type="pmid">27548043</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref109">
      <label>109</label>
      <mixed-citation publication-type="journal"><name><surname>Bowman</surname><given-names>JC</given-names></name>, <name><surname>Petrov</surname><given-names>AS</given-names></name>, <name><surname>Frenkel-Pinter</surname><given-names>M</given-names></name>, <name><surname>Penev</surname><given-names>PI</given-names></name>, <name><surname>Williams</surname><given-names>LD</given-names></name>. <article-title>Root of the tree: The significance, evolution, and origins of the ribosome</article-title>. <source>Chem Rev</source>. <year>2020</year>;<volume>120</volume>(<issue>11</issue>):<fpage>4848</fpage>–<lpage>78</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1021/acs.chemrev.9b00742</pub-id><?supplied-pmid 32374986?><pub-id pub-id-type="pmid">32374986</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref110">
      <label>110</label>
      <mixed-citation publication-type="journal"><name><surname>Belousoff</surname><given-names>MJ</given-names></name>, <name><surname>Davidovich</surname><given-names>C</given-names></name>, <name><surname>Zimmerman</surname><given-names>E</given-names></name>, <name><surname>Caspi</surname><given-names>Y</given-names></name>, <name><surname>Wekselman</surname><given-names>I</given-names></name>, <name><surname>Rozenszajn</surname><given-names>L</given-names></name>, <etal>et al</etal>. <article-title>Ancient machinery embedded in the contemporary ribosome</article-title>. <source>Biochem Soc Trans</source>. <year>2010</year>;<volume>38</volume>(<issue>2</issue>):<fpage>422</fpage>–<lpage>7</lpage>. Epub 2010/03/20. <comment>doi: </comment><pub-id pub-id-type="doi">10.1042/BST0380422</pub-id> .<?supplied-pmid 20298195?><pub-id pub-id-type="pmid">20298195</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref111">
      <label>111</label>
      <mixed-citation publication-type="journal"><name><surname>Petrov</surname><given-names>AS</given-names></name>, <name><surname>Gulen</surname><given-names>B</given-names></name>, <name><surname>Norris</surname><given-names>AM</given-names></name>, <name><surname>Kovacs</surname><given-names>NA</given-names></name>, <name><surname>Bernier</surname><given-names>CR</given-names></name>, <name><surname>Lanier</surname><given-names>KA</given-names></name>, <etal>et al</etal>. <article-title>History of the ribosome and the origin of translation</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2015</year>;<volume>112</volume>:<fpage>15396</fpage>–<lpage>401</lpage>. Epub 2015/12/02. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.1509761112</pub-id> .<?supplied-pmid 26621738?><pub-id pub-id-type="pmid">26621738</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref112">
      <label>112</label>
      <mixed-citation publication-type="journal"><name><surname>Kovacs</surname><given-names>NA</given-names></name>, <name><surname>Petrov</surname><given-names>AS</given-names></name>, <name><surname>Lanier</surname><given-names>KA</given-names></name>, <name><surname>Williams</surname><given-names>LD</given-names></name>. <article-title>Frozen in time: The history of proteins</article-title>. <source>Mol Biol Evol</source>. <year>2017</year>;<volume>34</volume>(<issue>5</issue>):<fpage>1252</fpage>–<lpage>60</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msx086</pub-id><?supplied-pmid 28201543?><pub-id pub-id-type="pmid">28201543</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref113">
      <label>113</label>
      <mixed-citation publication-type="journal"><name><surname>Woese</surname><given-names>CR</given-names></name>, <name><surname>Fox</surname><given-names>GE</given-names></name>. <article-title>Phylogenetic structure of the prokaryotic domain: The primary kingdoms</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>1977</year>;<volume>74</volume>(<issue>11</issue>):<fpage>5088</fpage>–<lpage>90</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.74.11.5088</pub-id><?supplied-pmid 270744?><pub-id pub-id-type="pmid">270744</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref114">
      <label>114</label>
      <mixed-citation publication-type="journal"><name><surname>Ramulu</surname><given-names>HG</given-names></name>, <name><surname>Groussin</surname><given-names>M</given-names></name>, <name><surname>Talla</surname><given-names>E</given-names></name>, <name><surname>Planel</surname><given-names>R</given-names></name>, <name><surname>Daubin</surname><given-names>V</given-names></name>, <name><surname>Brochier-Armanet</surname><given-names>C</given-names></name>. <article-title>Ribosomal proteins: Toward a next generation standard for prokaryotic systematics?</article-title><source>Mol Phylogen Evol</source>. <year>2014</year>;<volume>75</volume>:<fpage>103</fpage>–<lpage>17</lpage>. <pub-id pub-id-type="doi">10.1016/j.ympev.2014.02.013</pub-id>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref115">
      <label>115</label>
      <mixed-citation publication-type="journal"><name><surname>Matte-Tailliez</surname><given-names>O</given-names></name>, <name><surname>Brochier</surname><given-names>C</given-names></name>, <name><surname>Forterre</surname><given-names>P</given-names></name>, <name><surname>Philippe</surname><given-names>H</given-names></name>. <article-title>Archaeal phylogeny based on ribosomal proteins</article-title>. <source>Mol Biol Evol</source>. <year>2002</year>;<volume>19</volume>(<issue>5</issue>):<fpage>631</fpage>–<lpage>9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a004122</pub-id><?supplied-pmid 11961097?><pub-id pub-id-type="pmid">11961097</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref116">
      <label>116</label>
      <mixed-citation publication-type="journal"><name><surname>Olm</surname><given-names>MR</given-names></name>, <name><surname>Crits-Christoph</surname><given-names>A</given-names></name>, <name><surname>Diamond</surname><given-names>S</given-names></name>, <name><surname>Lavy</surname><given-names>A</given-names></name>, <name><surname>Matheus Carnevali</surname><given-names>PB</given-names></name>, <name><surname>Banfield</surname><given-names>JF</given-names></name>. <article-title>Consistent metagenome-derived metrics verify and delineate bacterial species boundaries</article-title>. <source>mSystems</source>. <year>2020</year>;<volume>5</volume>(<issue>1</issue>):<fpage>e00731</fpage>–<lpage>19</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1128/mSystems.00731-19</pub-id><?supplied-pmid 31937678?><pub-id pub-id-type="pmid">31937678</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009541.ref117">
      <label>117</label>
      <mixed-citation publication-type="journal"><name><surname>Berkemer</surname><given-names>SJ</given-names></name>, <name><surname>McGlynn</surname><given-names>SE</given-names></name>. <article-title>A new analysis of archaea–bacteria domain separation: Variable phylogenetic distance and the tempo of early evolution</article-title>. <source>Mol Biol Evol</source>. <year>2020</year>;<volume>37</volume>(<issue>8</issue>):<fpage>2332</fpage>–<lpage>40</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msaa089</pub-id><?supplied-pmid 32316034?><pub-id pub-id-type="pmid">32316034</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="aggregated-review-documents" id="pcbi.1009541.r001" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009541.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ouzounis</surname>
          <given-names>Christos A.</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Elofsson</surname>
          <given-names>Arne</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Ouzounis, Elofsson</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Ouzounis, Elofsson</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009541" id="rel-obj001" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">1 Jul 2021</named-content>
    </p>
    <p>Dear Dr Petrov,</p>
    <p>Thank you very much for submitting your manuscript "TwinCons: conservation score for uncovering deep sequence similarity and divergence" for consideration at PLOS Computational Biology.</p>
    <p>As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. In light of the reviews (below this email), we would like to invite the resubmission of a significantly-revised version that takes into account the reviewers' comments.</p>
    <p>We cannot make any decision about publication until we have seen the revised manuscript and your response to the reviewers' comments. Your revised manuscript is also likely to be sent to reviewers for further evaluation.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Please prepare and submit your revised manuscript within 60 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. Please note that revised manuscripts received after the 60-day due date may require evaluation and peer review similar to newly submitted manuscripts.</p>
    <p>Thank you again for your submission. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Christos A. Ouzounis</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Arne Elofsson</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: Manuscript: TwinCons: conservation score for uncovering deep sequence similarity and divergence</p>
    <p>The manuscript presents TwinCons, a scoring function for evaluating the match between two amino acid (nucleotide) distributions observed at each position of two corresponding aligned sequence families (groups). Highly positive scores indicate the matching conservation across the families. Highly negative scores, called signatures in the manuscript, show conservation high within the families but divergent across them. While high conservation across the families indicates evolutionarily important sites, signatures may specify functionally important sites for one of the families. The TwinCons usefulness lies in the possibility to apply it to protein and nucleic acid multiple sequence alignments (MSAs). The manuscript presents results from the application of TwinCons to both types of MSAs.</p>
    <p>Comments:</p>
    <p>1. TwinCons depends on a substitution matrix (SM) M in Eq. 2. Can TwinCons use multiple SMs? If so, how does it combine them?</p>
    <p>2. The section "Generating random alignments" (line 273) lacks details of how random alignments were generated: how randomized sequence seeds were obtained and how a random tree was constructed, leading to a random alignment.</p>
    <p>3. The manuscript should provide information on how the MSAs were obtained for all examples in the results section.</p>
    <p>4. It would be useful to see both structures for the full context of the correlation between sequence-based scoring and structural observations in the section "TwinCons detects highly conserved and signature positions in composite alignments" (line 429).</p>
    <p>Also, as the manuscript benchmarks TwinCons against these methods for other use cases, a comparison with Zebra2 and HHalign conservation and signature scores (highly negative scores for HHalign), and similarly, a comparison with ConSurf and HHalign in the section "TwinCons provides convenient representation of signatures and conservation" (line 463), would be useful.</p>
    <p>5. Table 1 in the section "TwinCons: score that detects sequence similarity between pairs of proteins" (line 500) provides a comparison with HHalign for 8 out of 36 alignments (line 511). Would it be possible to include all alignments in the comparison?</p>
    <p>6. Would it be possible to evaluate the accuracy of the tested methods, e.g., by quantifying the number of true and false positives and negatives for identified signatures?</p>
    <p>7. The section "Comparison of TwinCons signature positions with Zebra2" states that a "structure-informed substitution matrix" was used for one of the use cases (line 734). The optimal configuration, however, includes the BLOSUM62 matrix (line 346). Was the same SM used in the application throughout the results section? If not, what criteria were used for selecting a substitution matrix for application?</p>
    <p>Reviewer #2: TwinCons is a score for evaluating conservation patterns within and between two groups of sequences. The authors present numerous examples of the methods utility for distinguishing conserved, nonconserved, and "signature" residues. The ability to visualize conserved and unique resides on a PDB structure is particularly nice.</p>
    <p>## Major Critiques</p>
    <p>1. Substitution matrices are typically in logorithmic units. Why is a linear multiplication with the frequency vector appropriate? More broadly, I think additional theory tying the TWC score to the statistics of substition processes is required. For instance, if the matrix M were a Markov chain transition matrix (such as PAM scores, when properly converted to linear space), then the quantity Mx represents the expected drift of the sequence over a fixed period of time. The product yMx is then the dot product of the two frequency vectors after accounting for a fixed period of drift. Of course, for substitution matrices which are not transition matrices this theory is not valid, but in that case I think a deeper discussion could motivate the choice of scoring matrix.</p>
    <p>2. Uniform distributions are used for the null model in gaps and in the matrix scaling. However, uniform distributions are not very realistic for biological sequences. Would it be better to use background frequencies instead? In some cases these can be derived from the substitution matrix (e.g. the eigenvectors of a transition matrix give the stationary distribution).</p>
    <p>3. More details are needed about the matrix scaling procedure. "Uniform scaling" (line 207) would normally suggest multiplication by a scalar factor, but to produce the expected 0 value I suppose an additive component must be used. Is there any additional scaling done between matrices to assure that the range of TWC values are comperable, in addition to having a consistent zero point? This issue is particularly important when comparing RNA and protein TwinCons scores, and may account for the saturation of rRNA scores.</p>
    <p>4. The segment creation rule of two negative scores seems arbitrary. Were any other rules considered? The zero point for a particular set of parameters is going to be an approximation, both due to the scaling issue in point 3 and to the generous rounding used in many substitution matrices. It seems like a rule which included the magnitude as well as the sign would be more robust and might decrease fragmentation (lin 523).</p>
    <p>5. Was SVM with rbf kernel the only classifier considered? Since the data is highly non-seperable SVM does not seem an obvious choice. Distance from the boundary is also not a very good metric for the quality of a segment. A probabilistic classifier would give a better calibrated quality score.</p>
    <p>6. The procedure for rRNA segment creation appears to be significantly different from the protein method. The Suppl Text is a bit unclear and should be revised, but I think the fact that different thresholds were used for RNA should be discussed in the main text. The suppl text refers to k-mers in the context of k-means clustering; probably "k clusters" was intended (also S2).</p>
    <p>7. One major limitation of TwinCons is that it relies entirely on the input alignment and the division into two groups. This is discussed towwards the end (735), but I think it should be emphasized more. In particular, the source of the alignment for all examples should be clearly stated. The non-permuted bL33/aL42 alignment should be pointed out to be deliberately wrong (e.g. to align non-homologous residues), as it is presumably a low-scoring artifact.</p>
    <p>## Minor Critiques</p>
    <p>8. Several sentences could be naively interpretted that TwinCons allows one to compare two nonhomologous genes/proteins (e.g. 'inspecting a pair of polymers' (35), 'correlated changes in RNA and protein assemblies' (778), etc). Particularly in the abstract it should be clear that TwinCons applies to alignment rows and does not address coevolution.</p>
    <p>9. I suggest using a diverging color palette for decision boundary distance (e.g. Fig 1C) to emphasize the boundary. (<ext-link xlink:href="https://seaborn.pydata.org/tutorial/color_palettes.html#perceptually-uniform-divering-palettes" ext-link-type="uri">https://seaborn.pydata.org/tutorial/color_palettes.html#perceptually-uniform-divering-palettes</ext-link>)</p>
    <p>10. The gradients in Fig 1B make it difficult to read the bar plot.</p>
    <p>11. The 'TwinCons Score' Section (line 115) gets into some details that are not explained until the methods section. Please consider the organization.</p>
    <p>12. "random residue distribution" should be "uniform" (line 208) to prevent confusion with background frequencies.</p>
    <p>13. Coefficients &amp; formula for the trained SVM should be included (may be supplemental).</p>
    <p>14. A table comparing the different data sets used for SVM training might be helpful (number of positive &amp; negative examples, whether negatives were filtered, etc).</p>
    <p>15. Why are some sidechains visible in Fig 3? If they are important residues, perhaps they should be shown consistently across all structures.</p>
    <p>16. If the goal of Fig 2 &amp; 3 is to compare TwinCons to ConSurf and Zebra2 respectively, I wonder if a dotplot showing the correlation between scores directly would be more pertinent. This could be quite interesting, as comparing the different color scales can be difficult by eye.</p>
    <p>17. The application to rProtein and rRNA trees (lin 677) was not clear to me. How can TwinCons be applied to more than one gene at a time? Particularly cases with different alphabets?</p>
    <p>18. I don't understand the analogy to dipole energy (line 706). Is this just the fact that both are vector quantities?</p>
    <p>## Code</p>
    <p>19. I was able to successfully install and run the tool. Code is sufficiently documented and available in the pypi repo. The URL needs to be updated to <ext-link xlink:href="https://github.com/LDWLab/AlignmentScore" ext-link-type="uri">https://github.com/LDWLab/AlignmentScore</ext-link>. It might make sense to rename the project to LDWLab/TwinCons or similar to make it easier to find.</p>
    <p>20. It would be nice to include in the repository a complete example. For instance, there are no pdb files available for use with TwinCons.py</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: <bold>Yes: </bold>Mindaugas Margelevicius</p>
    <p>Reviewer #2: <bold>Yes: </bold>Spencer Bliven</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link xlink:href="https://pacev2.apexcovantage.com/" ext-link-type="uri">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email>figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5" ext-link-type="uri">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pcbi.1009541.r002">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009541.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009541" id="rel-obj002" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">16 Sep 2021</named-content>
    </p>
    <supplementary-material id="pcbi.1009541.s012" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">PLOS_revision_responses_to_reviewers.docx</named-content></p>
      </caption>
      <media xlink:href="pcbi.1009541.s012.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="aggregated-review-documents" id="pcbi.1009541.r003" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009541.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ouzounis</surname>
          <given-names>Christos A.</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Elofsson</surname>
          <given-names>Arne</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Ouzounis, Elofsson</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Ouzounis, Elofsson</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009541" id="rel-obj003" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">6 Oct 2021</named-content>
    </p>
    <p>Dear Dr Petrov,</p>
    <p>We are pleased to inform you that your manuscript 'TwinCons: conservation score for uncovering deep sequence similarity and divergence' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Christos A. Ouzounis</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Arne Elofsson</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: The authors have addressed my comments.</p>
    <p>Reviewer #2: The authors have made substantial improvements to the method, analysis, and the text. On every point from my previous review the authors have addressed the issues. I particularly appreciate the detailed theory that has been added in the supplemental.</p>
    <p>## Minor Issues</p>
    <p>- There's a duplicated sentence in the suppl text (pg 2, These differences of...)</p>
    <p>- In point 16 from my previous review I mistakenly suggested a "dotplot" when I meant a simple scatter plot comparing TwinCons vs the other scores. This would show the correlation between scores (e.g. how low ConSurf scores correlate to both positive and negative TwinCons). However, with the addition of the ul2 data in S10 it is easy for interested readers to do this for themselves.</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: <bold>Yes: </bold>Mindaugas Margelevičius</p>
    <p>Reviewer #2: <bold>Yes: </bold>Spencer Bliven</p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pcbi.1009541.r004" specific-use="acceptance-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009541.r004</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ouzounis</surname>
          <given-names>Christos A.</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Elofsson</surname>
          <given-names>Arne</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Ouzounis, Elofsson</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Ouzounis, Elofsson</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009541" id="rel-obj004" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">22 Oct 2021</named-content>
    </p>
    <p>PCOMPBIOL-D-21-00651R1 </p>
    <p>TwinCons: conservation score for uncovering deep sequence similarity and divergence</p>
    <p>Dear Dr Petrov,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Katalin Szabo</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link xlink:href="http://ploscompbiol.org" ext-link-type="uri">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
