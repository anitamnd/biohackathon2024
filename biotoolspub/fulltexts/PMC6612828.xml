<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6612828</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btz363</article-id>
    <article-id pub-id-type="publisher-id">btz363</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Ismb/Eccb 2019 Conference Proceedings</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Studies of Phenotypes and Clinical Applications</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Comprehensive evaluation of transcriptome-based cell-type quantification methods for immuno-oncology</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Sturm</surname>
          <given-names>Gregor</given-names>
        </name>
        <xref ref-type="aff" rid="btz363-aff1">1</xref>
        <xref ref-type="aff" rid="btz363-aff2">2</xref>
        <xref ref-type="corresp" rid="btz363-cor1"/>
        <!--<email>g.sturm@tum.de</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Finotello</surname>
          <given-names>Francesca</given-names>
        </name>
        <xref ref-type="aff" rid="btz363-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Petitprez</surname>
          <given-names>Florent</given-names>
        </name>
        <xref ref-type="aff" rid="btz363-aff4">4</xref>
        <xref ref-type="aff" rid="btz363-aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Jitao David</given-names>
        </name>
        <xref ref-type="aff" rid="btz363-aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Baumbach</surname>
          <given-names>Jan</given-names>
        </name>
        <xref ref-type="aff" rid="btz363-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fridman</surname>
          <given-names>Wolf H</given-names>
        </name>
        <xref ref-type="aff" rid="btz363-aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>List</surname>
          <given-names>Markus</given-names>
        </name>
        <xref ref-type="aff" rid="btz363-aff7">7</xref>
        <xref ref-type="author-notes" rid="btz363-FM2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Aneichyk</surname>
          <given-names>Tatsiana</given-names>
        </name>
        <xref ref-type="aff" rid="btz363-aff2">2</xref>
        <xref ref-type="aff" rid="btz363-aff8">8</xref>
        <xref ref-type="author-notes" rid="btz363-FM2"/>
      </contrib>
    </contrib-group>
    <aff id="btz363-aff1"><label>1</label>Chair of Experimental Bioinformatics, TUM School of Life Sciences Weihenstephan, Technical University of Munich, Freising, Germany</aff>
    <aff id="btz363-aff2"><label>2</label>Pieris Pharmaceuticals GmbH, Freising, Germany</aff>
    <aff id="btz363-aff3"><label>3</label>Biocenter, Division of Bioinformatics, Medical University of Innsbruck, Innsbruck, Austria</aff>
    <aff id="btz363-aff4"><label>4</label>Cordeliers Research Centre, UMRS_1138, INSERM, University Paris-Descartes, Sorbonne University, Paris, France</aff>
    <aff id="btz363-aff5"><label>5</label>Programme Cartes d’Identité des Tumeurs, Ligue Nationale Contre le Cancer, Paris, France</aff>
    <aff id="btz363-aff6"><label>6</label>Roche Pharma Research and Early Development, Pharmaceutical Sciences, Roche Innovation Center Basel, F. Hoffmann-La Roche Ltd, Basel, Switzerland</aff>
    <aff id="btz363-aff7"><label>7</label>Big Data in BioMedicine Group, Chair of Experimental Bioinformatis, TUM School of Life Sciences Weihenstephan, Technical University of Munich, Freising, Germany</aff>
    <aff id="btz363-aff8"><label>8</label>Independent Data Lab UG, Munich, Germany</aff>
    <author-notes>
      <corresp id="btz363-cor1">To whom correspondence should be addressed. <email>g.sturm@tum.de</email></corresp>
      <fn id="btz363-FM2">
        <p>The authors wish it to be known that, in their opinion, the last two authors should be regarded as Joint First Authors.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-07-05">
      <day>05</day>
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>35</volume>
    <issue>14</issue>
    <fpage>i436</fpage>
    <lpage>i445</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btz363.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The composition and density of immune cells in the tumor microenvironment (TME) profoundly influence tumor progression and success of anti-cancer therapies. Flow cytometry, immunohistochemistry staining or single-cell sequencing are often unavailable such that we rely on computational methods to estimate the immune-cell composition from bulk RNA-sequencing (RNA-seq) data. Various methods have been proposed recently, yet their capabilities and limitations have not been evaluated systematically. A general guideline leading the research community through cell type deconvolution is missing.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We developed a systematic approach for benchmarking such computational methods and assessed the accuracy of tools at estimating nine different immune- and stromal cells from bulk RNA-seq samples. We used a single-cell RNA-seq dataset of ∼11 000 cells from the TME to simulate bulk samples of known cell type proportions, and validated the results using independent, publicly available gold-standard estimates. This allowed us to analyze and condense the results of more than a hundred thousand predictions to provide an exhaustive evaluation across seven computational methods over nine cell types and ∼1800 samples from five simulated and real-world datasets. We demonstrate that computational deconvolution performs at high accuracy for well-defined cell-type signatures and propose how fuzzy cell-type signatures can be improved. We suggest that future efforts should be dedicated to refining cell population definitions and finding reliable signatures.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>A snakemake pipeline to reproduce the benchmark is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/grst/immune_deconvolution_benchmark">https://github.com/grst/immune_deconvolution_benchmark</ext-link>. An R package allows the community to perform integrated deconvolution using different methods (<ext-link ext-link-type="uri" xlink:href="https://grst.github.io/immunedeconv">https://grst.github.io/immunedeconv</ext-link>).</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Austrian Cancer Aid</named-content>
        </funding-source>
        <award-id>17003</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Austrian Science Fund</named-content>
          <named-content content-type="funder-identifier">10.13039/501100002428</named-content>
        </funding-source>
        <award-id>T 974-B30</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Tumors are not only composed of malignant cells but are embedded in a complex microenvironment within which dynamic interactions are built (<xref rid="btz363-B219" ref-type="bibr">Fridman <italic>et al.</italic>, 2012</xref>). Notably, this tumor microenvironment (TME) comprises a vast variety of immune cells. Knowledge of immune cell content in cancer samples is invaluable for cancer-immunotherapy drug discovery as well as for clinical decisions about treatment options. The cellular composition of the immune infiltrate of tumors can shed light on the escape mechanisms that tumor cells use to evade the immune response. In clinical trials, it can be used to stratify patients to assign most suitable treatment options depending on the targeted cell type, hence increasing the overall chances of success, and ultimately accelerating access to improved treatment options (<xref rid="btz363-B12" ref-type="bibr">Friedman <italic>et al.</italic>, 2015</xref>).</p>
    <p>Methods like fluorescence-activated cell sorting (FACS) or immunohistochemistry (IHC)-staining have been used as gold standards to estimate the immune cell content within a sample (<xref rid="btz363-B27" ref-type="bibr">Petitprez <italic>et al.</italic>, 2018a</xref>). However, each of the methods has its technical limitations and might not be generally applicable. More specifically, FACS requires a large amount of material, hence limiting its application to tumor biopsies, and IHC provides an estimate from a single tumor slice, which may not be representative of a heterogeneous immune landscape of the tumor. Furthermore, both methods can utilize only a small number of cell type-specific markers. More recently, single-cell RNA sequencing (scRNA-seq) is used to characterize cell types and states, yet for the time being it remains too expensive and laborious for routine clinical use. Moreover, cell type proportions might be biased in scRNA-seq data due to differences in single-cell dissociation efficiencies (<xref rid="btz363-B20" ref-type="bibr">Lambrechts <italic>et al.</italic>, 2018</xref>). At the same time, methods for gene expression profiling, RNA-seq and microarrays have been developed and optimized to be applicable in clinical settings, resulting in a plethora of transcriptomics datasets derived from patient tumor samples. However, while these methods provide transcriptomics data from heterogeneous samples considered as a whole, they do not provide information on their cellular composition, which therefore has to be inferred using computational techniques.</p>
    <p>Previously, available methods for estimating immune cell contents of tumor samples have been reviewed in terms of methodology (<xref rid="btz363-B3" ref-type="bibr">Avila Cobos <italic>et al.</italic>, 2018</xref>; <xref rid="btz363-B9" ref-type="bibr">Finotello and Trajanoski, 2018</xref>; <xref rid="btz363-B24" ref-type="bibr">Newman and Alizadeh, 2016</xref>; <xref rid="btz363-B27" ref-type="bibr">Petitprez <italic>et al.</italic>, 2018a</xref>) and limited quantitative comparisons have been made as part of some of the methods’ publications (<xref rid="btz363-B2" ref-type="bibr">Aran <italic>et al.</italic>, 2017</xref>; <xref rid="btz363-B5" ref-type="bibr">Becht <italic>et al.</italic>, 2016</xref>; <xref rid="btz363-B29" ref-type="bibr">Racle <italic>et al.</italic>, 2017</xref>). These are however limited to only a few methods, do not address background predictions or are not cell-type specific. We, therefore, provide the first systematic, quantitative comparison of computational cell type quantification methods for immuno-oncology at a per-cell-type resolution. While we acknowledge that many general-purpose deconvolution methods are available (reviewed in <xref rid="btz363-B9" ref-type="bibr">Finotello and Trajanoski, 2018</xref>), we focus this benchmark on methods that provide cell-type signatures for immuno-oncology (<xref rid="btz363-T1" ref-type="table">Table 1</xref>).</p>
    <table-wrap id="btz363-T1" orientation="portrait" position="float">
      <label>Table 1.</label>
      <caption>
        <p>Overview of cell type quantification methods providing gene signatures for immuno-oncology</p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th align="left" rowspan="1" colspan="1">Tool</th>
            <th align="left" rowspan="1" colspan="1">Abbrev.</th>
            <th align="left" rowspan="1" colspan="1">Type</th>
            <th align="left" rowspan="1" colspan="1">Score</th>
            <th align="left" rowspan="1" colspan="1">Comparisons</th>
            <th align="left" rowspan="1" colspan="1">Algorithm</th>
            <th align="left" rowspan="1" colspan="1">Cell types</th>
            <th align="left" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">CIBERSORT</td>
            <td rowspan="1" colspan="1">CBS</td>
            <td rowspan="1" colspan="1">D</td>
            <td rowspan="1" colspan="1">Immune cell fractions, relative to total immune cell content</td>
            <td rowspan="1" colspan="1">Intra</td>
            <td rowspan="1" colspan="1"><italic>ν</italic>-support vector regression</td>
            <td rowspan="1" colspan="1">22 immune cell types</td>
            <td rowspan="1" colspan="1">
              <xref rid="btz363-B25" ref-type="bibr">Newman <italic>et al.</italic> (2015)</xref>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">CIBERSORT abs. mode</td>
            <td rowspan="1" colspan="1">CBA</td>
            <td rowspan="1" colspan="1">D</td>
            <td rowspan="1" colspan="1">Score of arbitrary units that reflects the absolute proportion of each cell type</td>
            <td rowspan="1" colspan="1">Intra, inter</td>
            <td rowspan="1" colspan="1"><italic>ν</italic>-support vector regression</td>
            <td rowspan="1" colspan="1">22 immune cell types</td>
            <td rowspan="1" colspan="1"><xref rid="btz363-B25" ref-type="bibr">Newman <italic>et al.</italic> (2015</xref>, <xref rid="btz363-B26" ref-type="bibr">2018</xref>)</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">EPIC</td>
            <td rowspan="1" colspan="1">EPC</td>
            <td rowspan="1" colspan="1">D</td>
            <td rowspan="1" colspan="1">Cell fractions, relative to all cells in sample</td>
            <td rowspan="1" colspan="1">Intra, inter</td>
            <td rowspan="1" colspan="1">constrained least square regression</td>
            <td rowspan="1" colspan="1">6 immune cell types, fibroblasts, endothelial cells</td>
            <td rowspan="1" colspan="1">
              <xref rid="btz363-B29" ref-type="bibr">Racle <italic>et al.</italic> (2017)</xref>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">MCP-counter</td>
            <td rowspan="1" colspan="1">MCP</td>
            <td rowspan="1" colspan="1">M</td>
            <td rowspan="1" colspan="1">Arbitrary units, comparable between samples</td>
            <td rowspan="1" colspan="1">Inter</td>
            <td rowspan="1" colspan="1">mean of marker gene expression</td>
            <td rowspan="1" colspan="1">8 immune cell types, fibroblasts, endothelial cells</td>
            <td rowspan="1" colspan="1">
              <xref rid="btz363-B5" ref-type="bibr">Becht <italic>et al.</italic> (2016)</xref>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">quanTIseq</td>
            <td rowspan="1" colspan="1">QTS</td>
            <td rowspan="1" colspan="1">D</td>
            <td rowspan="1" colspan="1">Cell fractions, relative to all cells in sample</td>
            <td rowspan="1" colspan="1">Intra, inter</td>
            <td rowspan="1" colspan="1">constrained least square regression</td>
            <td rowspan="1" colspan="1">10 immune cell types</td>
            <td rowspan="1" colspan="1">
              <xref rid="btz363-B119" ref-type="bibr">Finotello <italic>et al.</italic> (2017)</xref>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">TIMER</td>
            <td rowspan="1" colspan="1">TMR</td>
            <td rowspan="1" colspan="1">D</td>
            <td rowspan="1" colspan="1">Arbitrary units, comparable between samples (not different cancer types)</td>
            <td rowspan="1" colspan="1">Inter</td>
            <td rowspan="1" colspan="1">linear least square regression</td>
            <td rowspan="1" colspan="1">6 immune cell types</td>
            <td rowspan="1" colspan="1">
              <xref rid="btz363-B23" ref-type="bibr">Li <italic>et al.</italic> (2016)</xref>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">xCell</td>
            <td rowspan="1" colspan="1">XCL</td>
            <td rowspan="1" colspan="1">M</td>
            <td rowspan="1" colspan="1">Arbitrary units, comparable between samples</td>
            <td rowspan="1" colspan="1">Inter</td>
            <td rowspan="1" colspan="1">ssGSEA (<xref rid="btz363-B16" ref-type="bibr">Hänzelmann <italic>et al.</italic>, 2013</xref>)</td>
            <td rowspan="1" colspan="1">64 immune and non-immune cell types</td>
            <td rowspan="1" colspan="1">
              <xref rid="btz363-B2" ref-type="bibr">Aran <italic>et al.</italic> (2017)</xref>
            </td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="tblfn1">
          <p><italic>Note:</italic> Methods can be conceptually distinguished in marker-gene-based approaches (M) and deconvolution-based approaches (D). The output scores of the methods have different properties and allow either intra-sample comparisons between cell types, inter-sample comparisons of the same cell type, or both. All methods come with a set of cell type signatures ranging from six immune cell types to 64 immune and non-immune cell types.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>These methods can, in general, be classified into two categories: marker gene-based approaches and deconvolution-based approaches. Marker gene-based approaches utilize a list of genes that are characteristic for a cell type. These gene sets are usually derived from targeted transcriptomics studies characterizing each immune-cell type and/or from comprehensive literature search and experimental validation. By using the expression values of marker genes in heterogeneous samples, these models quantify every cell type independently, either aggregating them into an abundance score (MCP-counter, <xref rid="btz363-B5" ref-type="bibr">Becht <italic>et al.</italic>, 2016</xref>) or by performing a statistical test for enrichment of the marker genes (xCell, <xref rid="btz363-B2" ref-type="bibr">Aran <italic>et al.</italic>, 2017</xref>). Deconvolution methods, on the other hand, formulate the problem as a system of equations that describe the gene expression of a sample as the weighted sum of the expression profiles of the admixed cell types (reviewed in <xref rid="btz363-B9" ref-type="bibr">Finotello and Trajanoski, 2018</xref>). By solving the inverse problem, cell type fractions can be inferred given a signature matrix and the bulk gene expression. In practice, this problem can be solved using linear least square regression (e.g. TIMER, <xref rid="btz363-B23" ref-type="bibr">Li <italic>et al.</italic>, 2016</xref>), constrained least square regression (e.g. quanTIseq and EPIC, <xref rid="btz363-B119" ref-type="bibr">Finotello, <italic>et al.</italic>, 2017</xref>; <xref rid="btz363-B29" ref-type="bibr">Racle <italic>et al.</italic>, 2017</xref>), or <italic>ν</italic>-Support Vector Regression (e.g. CIBERSORT, <xref rid="btz363-B25" ref-type="bibr">Newman <italic>et al.</italic>, 2015</xref>).</p>
    <p>Conducting a fair benchmark between computational cell type quantification methods is challenging, as the scores of the different methods have different properties and are not always directly comparable (<xref rid="btz363-T1" ref-type="table">Table 1</xref>). For instance the marker-based approaches only allow for generating a semi-quantitative score, which enables a comparison between samples, but not between cell types (<xref rid="btz363-B28" ref-type="bibr">Petitprez <italic>et al.</italic>, 2018b</xref>). Deconvolution allows, in principle, to generate absolute scores that can be interpreted as cell fractions and compared both inter- and intra-sample. In practice, CIBERSORT expresses results as a fraction relative to the immune-cell content and TIMER produces a score in arbitrary units that cannot be compared between cell types. Both quanTIseq and EPIC generate scores relative to the total amount of sequenced cells, being the only two methods generating an absolute score that can be interpreted as a cell fraction. CIBERSORT has recently been extended to the ‘absolute mode’, which provides a score that can be compared between both samples and cell types but still cannot be interpreted as a cell fraction (<xref rid="btz363-B26" ref-type="bibr">Newman <italic>et al.</italic>, 2018</xref>). From now on, we refer to this extension as ‘CIBERSORT abs’. quanTIseq comes as an entire pipeline that allows to directly analyze raw RNA-seq data (i.e. FASTQ files of sequencing reads), whereas the other methods only analyze pre-computed, normalized expression data. In this benchmark, we consider only its ‘deconvolution’ module alone, acknowledging that the full quanTIseq pipeline can, in principle, provide higher performance. A limitation of TIMER and xCell is that the results of these methods depend on all samples that are analyzed in a single run, i.e. the same sample can have different scores when submitted together with different other samples. In particular, xCell uses the variability among the samples for a linear transformation of the output score. TIMER uses COMBAT (<xref rid="btz363-B18" ref-type="bibr">Johnson <italic>et al.</italic>, 2007</xref>) to merge the input samples with reference profiles. This is particularly problematic with small datasets and hampers comparability and interpretability of the score. Moreover, xCell does not detect any signal when ran with few non-heterogeneous samples (<xref rid="btz363-B1" ref-type="bibr">Aran, 2018</xref>). Nonetheless, all methods except CIBERSORT (relative mode) support between-sample comparisons and the performance of the methods can be readily compared using Pearson correlation with the gold-standard measure of cell fractions.</p>
    <p>Here we developed a systematic approach for benchmarking such computational methods and assessed the accuracy of estimating the abundance of nine immune and stromal cell types from bulk RNA-seq samples for seven widely used approaches specifically designed for immuno-oncology and provide immuno-oncologists guidance on which method they can apply in their studies. We use an integrated scRNA-seq dataset of more than 11 000 single cancer, stromal and immune cells from 23 melanoma and ovarian cancer patients (<xref rid="btz363-B31" ref-type="bibr">Schelker <italic>et al.</italic>, 2017</xref>) to simulate bulk RNA-seq samples with known compositions and validate the benchmark results using three independent datasets that have been profiled with FACS (<xref rid="btz363-B17" ref-type="bibr">Hoek <italic>et al.</italic>, 2015</xref>; <xref rid="btz363-B29" ref-type="bibr">Racle <italic>et al.</italic>, 2017</xref>; <xref rid="btz363-B31" ref-type="bibr">Schelker <italic>et al.</italic>, 2017</xref>). We assess the performance of the methods by four metrics, namely: (i) predictive performance, (ii) minimal detection fraction, (iii) background predictions and (iv) spillover effects. We demonstrate, that by addressing spillover effects, ‘fuzzy’ signatures of still not well-understood cell-types can be significantly improved. Finally, we provide an R package, immunedeconv, integrating all of the investigated methods for user-friendly access. To facilitate benchmarking of newly developed methods and signatures, we provide a reproducible pipeline on GitHub, which can be straightforwardly extended to benchmark additional methods.</p>
  </sec>
  <sec>
    <title>2 Results</title>
    <sec>
      <title>2.1 Benchmark on simulated and true bulk RNA-seq samples reveals differences in method performance between cell types</title>
      <p>We created 100 simulated bulk RNA-seq samples with known cell type proportions using the single cell dataset. For each sample, we individually retrieved and aggregated 500 random immune- and non-immune cells. This approach has been established and successfully applied by <xref rid="btz363-B31" ref-type="bibr">Schelker <italic>et al.</italic> (2017)</xref> for benchmarking CIBERSORT. Additional consistency checks support that simulated bulk RNA-seq data are not subject to systematic biases (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figs S1–S4</xref>).</p>
      <p>We applied the seven methods to these samples and compared the estimated to the known fractions. The results are shown in <xref ref-type="fig" rid="btz363-F1">Figure 1a</xref>. All methods obtained a high correlation on B cells (Pearson’s <italic>r </italic> &gt; <italic> </italic>0.71), cancer associated fibroblasts (<italic>r</italic>  &gt;<italic> </italic>0.72), endothelial cells (<italic>r  </italic>&gt; <italic> </italic>0.94) and CD8+ T cells (<italic>r</italic> <italic> </italic>&gt; <italic> </italic>0.76). Most methods obtain a correlation of <italic>r</italic> &gt; <italic> </italic>0.68 on macrophages/monocytes, NK cells and overall CD4+ T cells. We observed poor performance in distinguishing regulatory from non-regulatory CD4+ T cells and in estimating dendritic cells (DCs).
</p>
      <fig id="btz363-F1" orientation="portrait" position="float">
        <label>Fig. 1.</label>
        <caption>
          <p>(<bold>a</bold>) Correlation of predicted versus known cell type fractions on 100 simulated bulk RNA-seq samples generated from single cell RNA-seq. Pearson’s <italic>r</italic> is indicated in each panel. Due to the lack of a corresponding signature, we estimated macrophages/monocytes with EPIC using the ‘macrophage’ signature and with MCP-counter using the ‘monocytic lineage’ signature as a surrogate. (<bold>b</bold>) Performance of the methods on three independent datasets that provide immune cell quantification by FACS. Different cell types are indicated in different colors. Pearson’s <italic>r</italic> has been computed as a single correlation on all cell types simultaneously. Note that only methods that allow both inter- and intra-sample comparisons (i.e. EPIC, quanTIseq, CIBERSORT absolute mode) can be expected to perform well here. (<bold>c–d</bold>) Performance on the three validation datasets per cell type. Schelker’s and Racle’s dataset have too few samples to be considered individually. The values indicate Pearson correlation of the predictions with the cell type fractions determined using FACS. Blank squares indicate that the method does not provide a signature for the respective cell type. ‘n/a’ values indicate that no correlation could be computed because all predictions were zero. The asterisk (*) indicates that the ‘monocytic lineage’ signature was used as a surrogate to predict monocyte content. <italic>P</italic>-values: **** &lt; 0.0001; *** &lt; 0.001; ** &lt; 0.01; * &lt; 0.05; ns <inline-formula id="IE1"><mml:math id="IM1"><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>. <italic>P</italic>-values are not adjusted for multiple testing. Method abbreviations: see <xref rid="btz363-T1" ref-type="table">Table 1</xref></p>
        </caption>
        <graphic xlink:href="btz363f1"/>
      </fig>
      <p>We validated the results using three independent datasets, which provide both bulk RNA-seq data and a gold-standard estimate of immune cell fractions using FACS (<xref ref-type="fig" rid="btz363-F1">Fig. 1b–d</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig.</xref><xref ref-type="supplementary-material" rid="sup1">S5</xref>). In general, the results are highly consistent with the mixing benchmark, with the exception that the methods’ performance on CD8+ T cells is worse on the validation data considered altogether (<xref ref-type="fig" rid="btz363-F1">Fig. 1c</xref>). This can be attributed to the fact that the variance of CD8+ T cell contents between the samples is low and the correlations are therefore not meaningful (see <xref ref-type="fig" rid="btz363-F1">Fig. 1b</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig.</xref><xref ref-type="supplementary-material" rid="sup1">S5</xref>). Moreover, in the simulation benchmark, only TIMER detects DCs, while in Hoek’s dataset (<xref rid="btz363-B17" ref-type="bibr">Hoek <italic>et al.</italic>, 2015</xref>), all methods except CIBERSORT detect a signal. This inconsistency and the poor performance on DCs in general might be indicative of the still not well defined biological heterogeneity between DC subtypes.</p>
    </sec>
    <sec>
      <title>2.2 Background predictions widespread among deconvolution-based methods</title>
      <p>Next we investigated two related questions: at which abundance level do methods reliably identify the presence of immune cells (minimal detection fraction) and, conversely, what fractions of a certain cell type are predicted even when they are actually absent (background predictions). To this end, we took advantage of the fact that single cell-based simulations allow us to create artificial bulk RNA-seq samples of arbitrary compositions. For each cell type, we created samples by spiking-in an increasing amount of the cell type of interest into a background of 1000 cells randomly sampled from all other cell types. We measured the background prediction level as the predicted score on the background only, i.e. no spike-in cells added. We defined the minimal detection fraction as the minimal number of spike-in cells needed for the score to be significantly different from the background.</p>
      <p>We observed that, in most cases, the deconvolution-based approaches predict a minimal amount of immune cells even though they are absent (<xref ref-type="fig" rid="btz363-F2">Fig. 2</xref>). Yet, background predictions are low for CAFs and NK cells for EPIC and non-regulatory CD4+ T cells and NK cells for quanTIseq. Also, TIMER does not suffer from background predictions (except for DCs) at the cost of a highly elevated minimal detection fraction. In contrast, xCell, which uses a statistical test for enrichment of the marker-genes, is highly robust against background-predictions (score = 0 for all tested cell types) at a slightly elevated minimal detection fraction (&lt;5% infiltration for most cell types). Unfortunately, testing MCP-counter for its detection limit and background-predictions is not straightforward, as the method does not compute a score, but uses raw gene expression values. To make a statement about the absence of a cell type, a platform-specific null-model needs to be generated, which, in fact, is already provided by the authors for some microarray platforms, but not for RNA-seq. The authors also addressed the detection limit on RNA mixtures in their original publication (<xref rid="btz363-B5" ref-type="bibr">Becht <italic>et al.</italic>, 2016</xref>). In short, we observe that deconvolution-based approaches are susceptible to background-predictions that might be due to the similarity of the signatures of closely related cell types (multicollinearity) and/or to a lower cell-specificity of signature/marker genes.
</p>
      <fig id="btz363-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p>Minimal detection fraction and background prediction level. For each panel, we created simulated bulk RNA-seq samples with an increasing amount of the cell type of interest and a background of 1000 cells randomly sampled from the other cell types. The dots show the mean predicted score across five independently simulated samples for each fraction of spike-in cells. The grey ribbon indicates the 95% confidence interval. The red line refers to the minimal detection fraction, i.e. the minimal fraction of an immune cell type needed for a method to reliably detect its abundance as significantly different from the background (<italic>P</italic>-value &lt; 0.05, one-sided t-test). The blue line refers to the background prediction level, i.e. the average estimate of a method while the cell type of interest is absent. Method abbreviations: see <xref rid="btz363-T1" ref-type="table">Table 1</xref></p>
        </caption>
        <graphic xlink:href="btz363f2"/>
      </fig>
    </sec>
    <sec>
      <title>2.3 Spillover can be attributed to non-specific signature genes</title>
      <p>Motivated by the hypothesis that background predictions might be due to non-specific signature genes, we asked which cell types lead to methods erroneously predicting a higher abundance of another. We refer to this effect as ‘spillover’. We assessed spillover effects using simulated bulk RNA-seq samples containing single immune cell types (<xref ref-type="fig" rid="btz363-F3">Fig. 3</xref>) and validated the results using true bulk RNA-seq samples of FACS-purified immune cells (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig.</xref><xref ref-type="supplementary-material" rid="sup1">S6</xref>).
</p>
      <fig id="btz363-F3" orientation="portrait" position="float">
        <label>Fig. 3.</label>
        <caption>
          <p>Spillover analysis. All methods were applied to simulated bulk RNA-seq samples containing only cells of one of the nine immune and non-immune cell types. The outer circle indicates the different samples, the connections within refer to the methods’ predictions. The size of a border segment is reflective of the predicted score on that cell type. A connection leading to a border segment of the same color indicates a correctly predicted cell type fraction; a connection leading to a different color indicates spillover, i.e. a prediction of a different cell type than actually present. Note that not all methods provide signatures for all cell types, in that case the connections are indicative of the cell types wrongly predicted when a method is confronted with cell types it has not been optimized for. CD4+ T cell samples are an aggregate of regulatory and non-regulatory CD4+ T cells. The numbers in the center indicate the overall noise ratio, i.e. the fraction of predictions that are attributed to a wrong cell type. Method abbreviations: <xref rid="btz363-T1" ref-type="table">Table 1</xref></p>
        </caption>
        <graphic xlink:href="btz363f3"/>
      </fig>
      <p>In Section 2.2, we observed, for instance, that quanTIseq is affected by a high background prediction level for macrophages/monocytes (<xref ref-type="fig" rid="btz363-F2">Fig. 2</xref>). In the spillover analysis in <xref ref-type="fig" rid="btz363-F3">Figure 3</xref>, we note that quanTIseq predicts a pure CAF sample to contain a considerable amount of macrophages/monocytes. We, therefore, suspect that the high background prediction level is driven by non-specific marker genes in the quanTIseq signature matrix. Indeed, we identified five genes, <italic>CXCL2, ICAM1, PLTP, SERPING1</italic> and <italic>CXCL3</italic> that are expressed in both CAFs and Macrophages/Monocytes. After removing these genes from the matrix, the background prediction level is significantly reduced by 27% (<xref ref-type="fig" rid="btz363-F4">Fig. 4a</xref>).
</p>
      <fig id="btz363-F4" orientation="portrait" position="float">
        <label>Fig. 4.</label>
        <caption>
          <p>(<bold>a</bold>) Background prediction level of quanTIseq before and after removing nonspecific signature genes. This plot is based on the same five simulated samples used to determine the background prediction level in the Mac/Mono panel of <xref ref-type="fig" rid="btz363-F2">Figure 2</xref>. (<bold>b</bold>) B cell score on ten simulated pDC samples before and after removing nonspecific signature genes. Method abbreviations: <xref rid="btz363-T1" ref-type="table">Table 1</xref></p>
        </caption>
        <graphic xlink:href="btz363f4"/>
      </fig>
      <p>Beyond, for all methods, we consistently observe spillover between CD8+ and CD4+ T cells, between NK cells and CD8+ T cells and from DCs to B cells. The former two spillover effects are conserved in the validation dataset (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig</xref>. <xref ref-type="supplementary-material" rid="sup1">S6</xref>) supporting that the effects are not due to misannotated cells in the single cell dataset.</p>
      <p>The spillover between DCs and B cells could not be confirmed in the validation dataset, however, we demonstrate that in the single cell dataset, the B cell and DC clusters are both distinct and well-annotated (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig.</xref><xref ref-type="supplementary-material" rid="sup1">S7</xref>). Proceeding analogously to the CAF/macrophage spillover above, we identified six genes, <italic>TCL1A, TCF4, CD37, SPIB, IRF8</italic> and <italic>BCL11A</italic>, that are expressed both in the B cell and DC subpopulations on the mRNA level. Indeed, in the LifeMap Discovery database (<xref rid="btz363-B8" ref-type="bibr">Edgar <italic>et al.</italic>, 2013</xref>), all six genes are annotated as being expressed in both B cells and plasmacytoid DCs (pDCs). When excluding these genes from the deconvolution matrices, the spillover effect is substantially reduced by 55% for EPIC and 78% for quanTIs<xref ref-type="fig" rid="btz363-F4">eq (Fig. 4b</xref>). Given that the single cell dataset contains pDCs, quanTIseq has been trained on myeloid DCs (mDCs) and EPIC does not consider any kind of DCs (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S2</xref>), it is not surprising that both methods view these genes as B cell markers and are not able to discriminate between pDCs and B cells.</p>
    </sec>
    <sec>
      <title>2.4 Guidelines for method selection</title>
      <p>In <xref rid="btz363-T2" ref-type="table">Table 2</xref>, we provide guidelines on which method to use for which cell type based on three criteria: interpretability of the score, overall performance and possible limitations. It is very important to understand the implications of the different scoring strategies. EPIC and quanTIseq are the only methods providing an ‘absolute score’ that represents a cell fraction. All other methods provide scores in arbitrary units that are only meaningful in relation to another sample of the same dataset. For this reason, and due to a robust overall performance, we recommend EPIC and quanTIseq for general purpose deconvolution. In practice, absolute scores are not always necessary. For instance, in a clinical trial, relative scoring methods can be used to infer fold changes between treatment and control group or to monitor changes in the immune composition in longitudinal samples. In that case, using MCP-counter is a good choice thanks to its highly specific signatures that excelled in the spillover benchmark. A limitation of deconvolution methods is that they are susceptible to background predictions, i.e. prediction of (small) fractions for cell types that are actually absent. Therefore, when interested in presence/absence of a cell type, we suggest using xCell.</p>
      <table-wrap id="btz363-T2" orientation="portrait" position="float">
        <label>Table 2.</label>
        <caption>
          <p>Guidelines for method selection</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Cell type</th>
              <th align="left" rowspan="1" colspan="1">Recommended methods</th>
              <th align="left" rowspan="1" colspan="1">Overall performance</th>
              <th align="left" rowspan="1" colspan="1">Absolute score</th>
              <th align="left" rowspan="1" colspan="1">No background predictions</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">B cell</td>
              <td rowspan="1" colspan="1">EPIC</td>
              <td rowspan="1" colspan="1">++</td>
              <td rowspan="1" colspan="1">++</td>
              <td rowspan="1" colspan="1">+</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">MCP-counter</td>
              <td rowspan="1" colspan="1">++</td>
              <td rowspan="1" colspan="1">−</td>
              <td rowspan="1" colspan="1">−</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">T cell CD4+</td>
              <td rowspan="1" colspan="1">EPIC</td>
              <td rowspan="1" colspan="1">++</td>
              <td rowspan="1" colspan="1">++</td>
              <td rowspan="1" colspan="1">−</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">xCell</td>
              <td rowspan="1" colspan="1">++</td>
              <td rowspan="1" colspan="1">−</td>
              <td rowspan="1" colspan="1">++</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">T cell CD4+ non-regulatory</td>
              <td rowspan="1" colspan="1">quanTIseq</td>
              <td rowspan="1" colspan="1">+</td>
              <td rowspan="1" colspan="1">++</td>
              <td rowspan="1" colspan="1">+</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">xCell</td>
              <td rowspan="1" colspan="1">+</td>
              <td rowspan="1" colspan="1">−</td>
              <td rowspan="1" colspan="1">++</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">T cell regulatory</td>
              <td rowspan="1" colspan="1">quanTIseq</td>
              <td rowspan="1" colspan="1">++</td>
              <td rowspan="1" colspan="1">++</td>
              <td rowspan="1" colspan="1">−</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">xCell</td>
              <td rowspan="1" colspan="1">++</td>
              <td rowspan="1" colspan="1">−</td>
              <td rowspan="1" colspan="1">++</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">T cell CD8+</td>
              <td rowspan="1" colspan="1">quanTIseq</td>
              <td rowspan="1" colspan="1">++</td>
              <td rowspan="1" colspan="1">++</td>
              <td rowspan="1" colspan="1">−</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">EPIC</td>
              <td rowspan="1" colspan="1">++</td>
              <td rowspan="1" colspan="1">++</td>
              <td rowspan="1" colspan="1">−</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">MCP-counter</td>
              <td rowspan="1" colspan="1">++</td>
              <td rowspan="1" colspan="1">−</td>
              <td rowspan="1" colspan="1">−</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">xCell</td>
              <td rowspan="1" colspan="1">+</td>
              <td rowspan="1" colspan="1">−</td>
              <td rowspan="1" colspan="1">++</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Natural Killer Cell</td>
              <td rowspan="1" colspan="1">EPIC</td>
              <td rowspan="1" colspan="1">++</td>
              <td rowspan="1" colspan="1">++</td>
              <td rowspan="1" colspan="1">+</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">MCP-counter</td>
              <td rowspan="1" colspan="1">++</td>
              <td rowspan="1" colspan="1">−</td>
              <td rowspan="1" colspan="1">−</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Macrophage / Monocyte</td>
              <td rowspan="1" colspan="1">xCell</td>
              <td rowspan="1" colspan="1">−</td>
              <td rowspan="1" colspan="1">++</td>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">EPIC</td>
              <td rowspan="1" colspan="1">+</td>
              <td rowspan="1" colspan="1">++</td>
              <td rowspan="1" colspan="1">+</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">MCP-counter</td>
              <td rowspan="1" colspan="1">++</td>
              <td rowspan="1" colspan="1">−</td>
              <td rowspan="1" colspan="1">−</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Cancer-associated fibroblast</td>
              <td rowspan="1" colspan="1">EPIC</td>
              <td rowspan="1" colspan="1">++</td>
              <td rowspan="1" colspan="1">++</td>
              <td rowspan="1" colspan="1">+</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">MCP-counter</td>
              <td rowspan="1" colspan="1">++</td>
              <td rowspan="1" colspan="1">−</td>
              <td rowspan="1" colspan="1">−</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Endothelial Cell</td>
              <td rowspan="1" colspan="1">EPIC</td>
              <td rowspan="1" colspan="1">++</td>
              <td rowspan="1" colspan="1">++</td>
              <td rowspan="1" colspan="1">+</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">xCell</td>
              <td rowspan="1" colspan="1">++</td>
              <td rowspan="1" colspan="1">−</td>
              <td rowspan="1" colspan="1">++</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Dentricic cell</td>
              <td colspan="4" rowspan="1">None of the methods can be recommended to estimate overall DC content. MCP-counter and quanTIseq can be used to profile mDCs.</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn2">
            <p><italic>Note:</italic> For each cell type, we recommend which method to use, highlighting advantages and possible limitations. Overall performance: indicates how well predicted fractions correspond to known fractions in the benchmark. Absolute score: the method provides an absolute score that can be interpreted as a cell fraction. Methods that do not provide an absolute score only support inter-sample comparisons within the same experimental dataset, i.e. the score is only meaningful in relation to another sample. Background predictions: indicates, if a method tends to predict a cell type although it is absent.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>2.5 Immunodeconv R package provides easy access to deconvolution methods</title>
      <p>We created an R package, <monospace>immunedeconv</monospace>, that provides a unified interface to the different deconvolution methods. The package is freely available from GitHub: <ext-link ext-link-type="uri" xlink:href="https://github.com/grst/immunedeconv">https://github.com/grst/immunedeconv</ext-link>. In a separate repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/grst/immune_deconvolution_benchmark">https://github.com/grst/immune_deconvolution_benchmark</ext-link>), we provide a snakemake pipeline (<xref rid="btz363-B19" ref-type="bibr">Koster and Rahmann, 2012</xref>) that allows to fully reproduce this benchmark and includes step-by-step instructions on how to test additional methods.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Discussion</title>
    <p>Quantification of the cellular composition of bulk tumor samples is a challenging computational problem that has been addressed by a variety of methods. For the utility of these methods, it is imperative to fully understand their capabilities and limitations. Here we provide a comprehensive overview and the first cell type-specific quantitative comparison of existing methods applied to RNA-seq data to guide researchers and clinicians in selecting the most suitable approach for the analysis of their samples.</p>
    <p>We assessed seven state-of-the-art computational methods by applying them to simulated bulk RNA-seq samples derived from a scRNA-seq dataset of ∼11 000 single cells, integrated from different experiments (<xref rid="btz363-B31" ref-type="bibr">Schelker <italic>et al.</italic>, 2017</xref>). We validated the results using true bulk RNA-seq samples profiled by FACS from three independent datasets (<xref rid="btz363-B17" ref-type="bibr">Hoek <italic>et al.</italic>, 2015</xref>; <xref rid="btz363-B29" ref-type="bibr">Racle <italic>et al.</italic>, 2017</xref>; <xref rid="btz363-B31" ref-type="bibr">Schelker <italic>et al.</italic>, 2017</xref>). FACS or IHC measurements are currently considered the gold standard for assessing cell type composition but in public databases only a few RNA-seq samples with matched FACS or IHC reference can be found. Further publicly available matched datasets are needed to enhance our ability to reliably compare computational cell-type quantification methods to gold standard techniques. However, even with the limited number of observations available, we showed that there is generally a good agreement between FACS and the methods’ estimates.</p>
    <p>ScRNA-seq-based simulation by <italic>in silico</italic> mixing of cell types is a powerful surrogate for bulk-RNA. Not only does it allow for creating an arbitrary number of bulk RNA-seq samples with known cell-type composition, it also uniquely enables us to generate data <italic>ad hoc</italic> to assess specific performance metrics, such as the background prediction level, systematically.</p>
    <p>Possible limitations of the single cell-based simulations are related to the transcriptional activities of the cells. First, different cell types contain different amounts of mRNA, differently contributing to bulk RNA-seq samples, while in our simulation approach (averaging normalized gene expression per gene), each cell contributes the same. This would likely severely impact the absolute quantification of cell types, why we refrain from providing an estimate of the absolute deviation for quanTIseq and EPIC. The evaluations performed in this study only rely on between-sample comparisons, and, therefore, should only be marginally affected by this issue, as relative changes are preserved, independent of how much a cell contributes to the mixture. Second, there might be changes in the expression profile of a cell depending on the other cancer-, immune- or stromal cells present in the microenvironment that cannot be taken into account using the simulation approach. A step toward addressing this question could be to evaluate how immune cell profiles depend on the tumor type (see below).</p>
    <p>Similar cell type deconvolution methods exist for DNA methylation array or bisulfite sequencing (BS-seq) data (<xref rid="btz363-B33" ref-type="bibr">Teschendorff <italic>et al.</italic>, 2017</xref>). The benchmarking strategy introduced in our study utilizing single-cell sequencing to simulate bulk sequencing would be advantageous to validate such methods. However, while protocols for single cell BS-seq have been established (<xref rid="btz363-B32" ref-type="bibr">Smallwood <italic>et al.</italic>, 2014</xref>), we currently lack a comprehensive single cell methylation dataset needed for generating bulk DNA methylation sequencing data as suggested here.</p>
    <p>The major conclusion of our study is that RNA-seq can be utilized for estimation of immune cell infiltrates in the tumor robustly and with good accuracy, particularly when a cell type is well characterized. Most methods show near-perfect correlations on CD8+ T-cells, B cells, NK, fibroblasts and endothelial cells. However, as observed previously by <xref rid="btz363-B31" ref-type="bibr">Schelker <italic>et al.</italic> (2017)</xref> and <xref rid="btz363-B29" ref-type="bibr">Racle <italic>et al.</italic> (2017)</xref>, regulatory and non-regulatory CD4+ T cells are hard to distinguish. Moreover, we found that DCs are not sufficiently covered by currently available gene signatures. DCs comprise heterogeneous subtypes with unique functions, including pDC and mDCs (<xref rid="btz363-B6" ref-type="bibr">Collin <italic>et al.</italic>, 2013</xref>; <xref rid="btz363-B35" ref-type="bibr">Villani <italic>et al.</italic>, 2017</xref>). Currently, only MCP-counter specifically addresses mDCs. As our results demonstrate, none of the methods quantifies total DC content, but rather a specific subtype as reported in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S2</xref>. This can lead to spillover between cell types and suggests improved signatures are needed.</p>
    <p>Our analysis reveals substantial spillover between DCs and B cells in several methods caused by a subset of marker genes characterized by lower cell-specificity. We validated in a public knowledge base that these genes are indeed markers expressed in both pDCs and B cells on the mRNA level and could significantly reduce the spillover effect by removing the genes from the signature matrices. Similarly, we could substantially reduce the background prediction level of quanTIseq on macrophages/monocytes by excluding non-specific genes. By leveraging recently published large-scale single-cell RNA-seq datasets (<xref rid="btz363-B4" ref-type="bibr">Azizi <italic>et al.</italic>, 2018</xref>; <xref rid="btz363-B15" ref-type="bibr">Guo <italic>et al.</italic>, 2018</xref>; <xref rid="btz363-B20" ref-type="bibr">Lambrechts <italic>et al.</italic>, 2018</xref>; <xref rid="btz363-B30" ref-type="bibr">Sade-Feldman <italic>et al.</italic>, 2018</xref>; <xref rid="btz363-B37" ref-type="bibr">Zheng <italic>et al.</italic>, 2017</xref>;), we envision that our understanding of immune cell types and states can be greatly improved and by explicitly addressing spillover effects, more specific cell type signatures can be distilled.</p>
    <p>In this benchmark, we considered only methods providing cell-type signatures for immuno-oncology and test the methods out-of-the-box in combination with their corresponding signatures. Exchanging the signatures between methods, and therefore delineating the impact of the algorithms from the impact of the signatures is not straightforward due to the different approaches: xCell and MCP-counter are based on marker genes, CIBERSORT, quanTIseq and EPIC use a signature matrix and TIMER depends on multiple reference samples for each cell type. Given that we could substantially reduce spillover effects by modifying the signature matrix, we believe that the improvements made to signature matrices outweigh potential algorithmic improvements.</p>
    <p>An open question is if profiles derived from one tumor type also apply to another. <xref rid="btz363-B31" ref-type="bibr">Schelker <italic>et al.</italic> (2017)</xref>, to a certain extent, addressed this question, suggesting that cancer-type specific signatures are required. However, their analysis is limited to CIBERSORT and two tumor types (melanoma and ovarian cancer). In our benchmark, other methods already achieve near-perfect correlations on some cell-types without requiring cancer-specific signatures, suggesting that universal cell-type signatures are possible. As a next step, recently published single-cell datasets of various cancer types (<xref rid="btz363-B4" ref-type="bibr">Azizi <italic>et al.</italic>, 2018</xref>; <xref rid="btz363-B20" ref-type="bibr">Lambrechts <italic>et al.</italic>, 2018</xref>; <xref rid="btz363-B30" ref-type="bibr">Sade-Feldman <italic>et al.</italic>, 2018</xref>) could be combined with our pipeline to address this question comprehensively.</p>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>In summary, our results demonstrate that computational deconvolution is feasible at high accuracy, given well-defined, high-quality signatures. These findings indicate that future efforts should prioritize defining cell populations and finding reliable signatures over developing new deconvolution approaches. This study establishes a roadmap to evaluate computational cell-type deconvolution methods and provides guidelines to researchers working in immuno-oncology in selecting appropriate methods for characterization of cellular context of the tumors.</p>
  </sec>
  <sec>
    <title>5 Materials and Methods</title>
    <sec>
      <title>5.1 Single-cell data</title>
      <p>The dataset of 11 759 single cells from <xref rid="btz363-B31" ref-type="bibr">Schelker <italic>et al.</italic> (2017)</xref> was obtained through their figshare repository (<ext-link ext-link-type="uri" xlink:href="https://figshare.com/s/711d3fb2bd3288c8483a">https://figshare.com/s/711d3fb2bd3288c8483a</ext-link>). We reproduced their analysis using their MATLAB source code and exported the final dataset to continue our analysis in R. We excluded all cells that were classified as ‘Unknown’ from the downstream analysis. Moreover, we did not consider cells originating from Peripheral blood mononuclear cells (PBMC) as we were interested in the methods’ performance on cancer samples. Gene expression values are expressed as transcripts per million (TPM).</p>
    </sec>
    <sec>
      <title>5.2 Immune-cell reference data</title>
      <p>Immune cell reference profiles were obtained from the sources described in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S3</xref>. FASTQ files were extracted from SRA files using the <monospace>fastq-dump</monospace> command of the SRA toolkit (<xref rid="btz363-B21" ref-type="bibr">Leinonen <italic>et al.</italic>, 2011</xref>). Reads were aligned and gene expression estimated as TPM using STAR (<xref rid="btz363-B7" ref-type="bibr">Dobin <italic>et al.</italic>, 2013</xref>) and RSEM (<xref rid="btz363-B22" ref-type="bibr">Li and Dewey, 2011</xref>) using the <monospace>rsem-calculate-expression</monospace> command in paired-end mode.</p>
    </sec>
    <sec>
      <title>5.3 Validation data</title>
      <p>We obtained preprocessed bulk RNA-seq and FACS data for eight PBMC samples from <xref rid="btz363-B17" ref-type="bibr">Hoek <italic>et al.</italic> (2015)</xref> through personal communication from the quanTIseq authors (Finotello <italic>et al.</italic>, 2017). We obtained bulk RNA-seq and FACS data for four metastatic melanoma samples from <xref rid="btz363-B29" ref-type="bibr">Racle <italic>et al.</italic> (2017)</xref> through GEO accession number GSE93722. We obtained bulk RNA-seq and FACS data for three ovarian cancer ascites samples (<xref rid="btz363-B31" ref-type="bibr">Schelker <italic>et al.</italic>, 2017</xref>) from the figshare repository (<ext-link ext-link-type="uri" xlink:href="https://figshare.com/s/711d3fb2bd3288c8483a">https://figshare.com/s/711d3fb2bd3288c8483a</ext-link>). The three ovarian cancer ascites samples consist of two technical replicates each. The two replicates are highly consistent for each of the samples (Pearson’s <inline-formula id="IE2"><mml:math id="IM2"><mml:mrow><mml:mi>r</mml:mi><mml:mo>≥</mml:mo><mml:mn>0.98</mml:mn></mml:mrow></mml:math></inline-formula>). We therefore, took the straightforward approach of merging them by the arithmetic mean for each gene. All gene expression values are expressed as TPM.</p>
    </sec>
    <sec>
      <title>5.4 Cell type mapping</title>
      <p>For comparing the methods, it is essential to map the cell types of the different methods to a controlled vocabulary (CV). It has to be taken into account that the different methods resolve the cell types at different granularities. For example, while CIBERSORT predicts naive- and memory CD8+ T cells, all other methods only predict CD8+ T cells. We address this issue by creating a hierarchy of cell types, and map each cell type from a dataset or method to a node in the cell type tree (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig.</xref><xref ref-type="supplementary-material" rid="sup1">S8 and </xref><xref ref-type="supplementary-material" rid="sup1">Supplementary Table S4</xref>). If a node (e.g. CD8+ T cell) is to be compared among the different methods, the estimated fraction is computed as follows: (i) if the method provides an estimate for the node, take that value. (ii) If the method provides an estimate for all child nodes, sum up all children. This is done recursively until no estimates are available or the leaves of the tree are reached. (iii) If an estimate is missing for at least one of the child nodes, no estimate will be available. An exception was made for the following cell types that are only provided by few methods: T cell gamma delta, Macrophage M0, Monocyte, T cell follicular helper. If an estimate is missing for one of those cell types, the remaining child nodes will be summed up.</p>
    </sec>
    <sec>
      <title>5.5 Validation of the methodology</title>
      <p><xref rid="btz363-B31" ref-type="bibr">Schelker <italic>et al.</italic> (2017)</xref> provide three ovarian cancer ascites samples for which both single cell RNA-seq and bulk RNA-seq data are available. We generated artificial bulk samples by taking the mean of the TPM values for each gene of all single-cell samples. First, we compared the values using Pearson correlation on log-scale. Next, we used BioQC (<xref rid="btz363-B36" ref-type="bibr">Zhang <italic>et al.</italic>, 2017</xref>) to test for differential enrichment of gene ontology (GO)-terms (<xref rid="btz363-B34" ref-type="bibr">The Gene Ontology Consortium, 2017</xref>). Finally, we ran the deconvolution methods on both the true and simulated bulk RNA-seq samples and compared the results. To demonstrate that xCell’s low correlation is in fact due to little variance between the samples, we reran xCell while additionally including the 51 immune cell reference samples (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S3</xref>) in the expression matrix of both simulated and true bulk RNA-seq.</p>
    </sec>
    <sec>
      <title>5.6 Deconvolution methods</title>
      <p>We implemented an R package, <monospace>immunedeconv</monospace>, that provides a unified interface to all seven deconvolution methods compared in this paper. The CIBERSORT R source code was obtained from their website on 2018-03-26. The xCell, EPIC, MCP-counter, TIMER and quanTIseq source codes were obtained from GitHub from the following commits: dviraran/xCell@870ddc39, GfellerLab/EPIC@e5ae8803, ebecht/MCPcounter@e7c379b4, hanfeisun/TIMER@a030bac73, FFinotello/quanTIseq@ee9f4036.</p>
      <p>We ran CIBERSORT with disabled quantile normalization, as recommended on their website for RNA-seq data. While quanTIseq provides an entire pipeline, starting with read-mapping and estimation of gene expression, we only ran the last part of that pipeline, which estimates the immune cell fractions from gene expression data. We ran TIMER with ‘OV’ on ovarian cancer ascites samples and with ‘SKCM’ on melanoma samples. We ran quanTIseq with the option <monospace>tumor = TRUE</monospace> on all tumor samples and <monospace>tumor = FALSE</monospace> on the PBMC samples. We ran EPIC with the <monospace>TRef</monospace> signature set on all tumor samples and with <monospace>BRef</monospace> on the PBMC samples. We ran xCell with the <monospace>cell.types.use</monospace> parameter to avoid overcompensation by the spillover correction. For simulated tumor data, cell.types.use was set to B, CAF, DC, Endo, Mac/Mono, NK, T CD4+ n.r., T CD8+, T reg. For the validation datasets, it was set to B, DC, Mono, NK, T CD4+, T CD8+, T. We disabled the mRNA scaling options of quanTIseq and EPIC for the single cell simulation benchmark using the <monospace>mRNAscale</monospace> and <monospace>mRNA_cell</monospace> options, respectively. Notably, this only has an effect on the absolute values, but not on the correlations used to compare all methods. For each of the datasets (simulated, Hoek, Schelker, Racle), we submitted all samples in a single run.</p>
    </sec>
    <sec>
      <title>5.7 Simulation benchmark</title>
      <p>We simulated bulk RNA-seq samples by calculating the average gene expression per gene of cells sampled from the single cell dataset. Independently for each sample, 500 cells were randomly selected as follows: (i) a fraction <italic>f</italic> of cancer cells was drawn from <inline-formula id="IE3"><mml:math id="IM3"><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0.33</mml:mn><mml:mo>,</mml:mo><mml:mn>0.3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, which is the empirical distribution of cancer cells in the melanoma and ascites samples in the single cell dataset. <italic>f</italic> was constrained to the interval <inline-formula id="IE4"><mml:math id="IM4"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0.99</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. (ii) Half of the samples use melanoma cancer cells, the other half ovarian cancer cells. (iii) The remaining fraction <inline-formula id="IE5"><mml:math id="IM5"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:math></inline-formula> was randomly assigned to immune cells, resulting in a fraction vector. (iv) The fraction vector was multiplied with 500 to obtain a cell count vector. (v) The corresponding number of cells was drawn with replacement from the single cell dataset. That implies that for cell populations with only a few cells available, the artificial bulk sample will contain the same single cell sample multiple times.</p>
      <p>Known fractions of simulated samples are compared to the predicted scores using Pearson’s correlation coefficient <italic>r</italic>. P-values and <italic>r</italic> have been computed using the <monospace>cor</monospace> function in R.</p>
    </sec>
    <sec>
      <title>5.8 Minimal detection fraction and background prediction levels</title>
      <p>We simulated bulk RNA-seq samples as follows: For each cell type <italic>c</italic>, we create five independent samples for each <inline-formula id="IE6"><mml:math id="IM6"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>50</mml:mn><mml:mo>,</mml:mo><mml:mn>60</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo><mml:mn>120</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>300</mml:mn><mml:mo>,</mml:mo><mml:mn>350</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>500</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. For each sample independently, we randomly sampled <italic>i</italic> cells of type <italic>c</italic> and a background of 1000 cells containing all cell types except <italic>c</italic> from the single cell dataset. The selected cells were aggregated by calculating the arithmetic mean for each gene. This results in five batches of 300 samples each (30 spike-in levels × 10 cell types). Each of the five batches was submitted to the methods independently in a single run.</p>
      <p>We quantify the background prediction level of cell type <italic>c</italic> as the predicted score of <italic>c</italic> in samples of type <italic>c</italic> with <italic>i </italic>=<italic> </italic>0, i.e. in samples with no cells of type <italic>c</italic> present. We quantify the minimal detection fraction as the minimal <italic>i</italic> at which the predicted score of <italic>c</italic> is significantly different from the background prediction level (one-sided t-test, alpha = 0.05).</p>
    </sec>
    <sec>
      <title>5.9 Spillover</title>
      <p>We refer to spillover as the erroneous prediction of another cell type due to a partial overlap of the signatures. We measured spillover on two datasets: (1) 44 true bulk RNA-seq samples of pure immune cells (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S3</xref>); (2) 45 simulated bulk RNA-seq samples of nine cell types. For each cell type <italic>c</italic>, we simulated five samples by independently aggregating 500 random cells of type <italic>c</italic> by taking the arithmetic mean. Each dataset was submitted to the methods independently in a single run. We visualized the results as chord diagrams (<xref ref-type="fig" rid="btz363-F3">Fig. 3</xref>) using the R package circlize (<xref rid="btz363-B14" ref-type="bibr">Gu <italic>et al.</italic>, 2014</xref>).</p>
    </sec>
    <sec>
      <title>5.10 Other tools</title>
      <p>We generated reproducible reports using bookdown 0.7. We use Snakemake 5.2.0 (<xref rid="btz363-B19" ref-type="bibr">Koster and Rahmann, 2012</xref>), conda and bioconda (<xref rid="btz363-B13" ref-type="bibr">Grüning <italic>et al.</italic>, 2018</xref>) to integrate our analyses in a reproducible pipeline.</p>
    </sec>
    <sec>
      <title>5.11 Code availability</title>
      <p>An R package providing a unified interface to the deconvolution methods is freely available from GitHub: <ext-link ext-link-type="uri" xlink:href="https://github.com/grst/immunedeconv">https://github.com/grst/immunedeconv</ext-link>. A ready-to-run Snakemake pipeline, including preprocessed data, to reproduce the results is available from <ext-link ext-link-type="uri" xlink:href="https://github.com/grst/immune_deconvolution_benchmark">https://github.com/grst/immune_deconvolution_benchmark</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btz363_Supplementary_Data</label>
      <media xlink:href="btz363_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We would like to thank Hubert Hackl for helpful discussions.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by Pieris Pharmaceuticals GmbH. FF was supported by the Austrian Cancer Aid/Tyrol (project No. 17003, “quanTIseq: dissecting the immune contexture of human cancers”) and by the Austrian Science Fund (FWF) (project No. T 974-B30).</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btz363-B1">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Aran</surname><given-names>D.</given-names></name></person-group> (<year>2018</year>) xcell repository on GitHub. <ext-link ext-link-type="uri" xlink:href="https://github.com/dviraran/xCell/blob/ce4d43121c4a161b1e72a50dc875e43d9cf89b0d/README.Md">https://github.com/dviraran/xCell/blob/ce4d43121c4a161b1e72a50dc875e43d9cf89b0d/README.Md</ext-link> (20 September 2018, date last accessed).</mixed-citation>
    </ref>
    <ref id="btz363-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Aran</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>xcell: digitally portraying the tissue cellular heterogeneity landscape</article-title>. <source>Genome Biol</source>., <volume>18</volume>, <fpage>220.</fpage><pub-id pub-id-type="pmid">29141660</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Avila Cobos</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Computational deconvolution of transcriptomics data from mixed cell populations</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>1969</fpage>–<lpage>1979</lpage>.<pub-id pub-id-type="pmid">29351586</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Azizi</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Single-cell map of diverse immune phenotypes in the breast tumor microenvironment</article-title>. <source>Cell</source>, <volume>174</volume>, <fpage>1293</fpage>–<lpage>1308</lpage>.<pub-id pub-id-type="pmid">29961579</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Becht</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Estimating the population abundance of tissue-infiltrating immune and stromal cell populations using gene expression</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>218.</fpage><pub-id pub-id-type="pmid">27765066</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Collin</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Human dendritic cell subsets</article-title>. <source>Immunology</source>, <volume>140</volume>, <fpage>22</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">23621371</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dobin</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>STAR: ultrafast universal RNA-seq aligner</article-title>. <source>Bioinformatics</source>, <volume>29</volume>, <fpage>15</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">23104886</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Edgar</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>LifeMap discovery: the embryonic development, stem cells, and regenerative medicine research portal</article-title>. <source>PLoS One</source>, <volume>8</volume>, <fpage>e66629.</fpage><pub-id pub-id-type="pmid">23874394</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Finotello</surname><given-names>F.</given-names></name>, <name name-style="western"><surname>Trajanoski</surname><given-names>Z.</given-names></name></person-group> (<year>2018</year>) 
<article-title>Quantifying tumor-infiltrating immune cells from transcriptomics data</article-title>. <source>Cancer Immunol. Immunother</source>, <volume>67</volume>, <fpage>1031</fpage>–<lpage>1040</lpage>.<pub-id pub-id-type="pmid">29541787</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B119">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Finotello</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Molecular and pharmacological modulators of the tumor immune contexture revealed by deconvolution of RNA-seq data</article-title>. <source>Genome Medicine</source> (in press).</mixed-citation>
    </ref>
    <ref id="btz363-B219">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fridman</surname><given-names>W.H.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>The immune contexture in human tumours: impact on clinical outcome</article-title>. <source>Nat. Rev. Cancer</source>, <volume>12</volume>, <fpage>298</fpage>–<lpage>306</lpage>.<pub-id pub-id-type="pmid">22419253</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Friedman</surname><given-names>A.A.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Precision medicine for cancer with next-generation functional diagnostics</article-title>. <source>Nat. Rev. Cancer</source>, <volume>15</volume>, <fpage>747</fpage>–<lpage>756</lpage>.<pub-id pub-id-type="pmid">26536825</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Grüning</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Bioconda: sustainable and comprehensive software distribution for the life sciences</article-title>. <source>Nat. Methods</source>, <volume>15</volume>, <fpage>475</fpage>–<lpage>476</lpage>.<pub-id pub-id-type="pmid">29967506</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gu</surname><given-names>Z.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Circlize implements and enhances circular visualization in R</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>2811</fpage>–<lpage>2812</lpage>.<pub-id pub-id-type="pmid">24930139</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Guo</surname><given-names>X.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Global characterization of T cells in non-small-cell lung cancer by single-cell sequencing</article-title>. <source>Nat. Med</source>., <volume>24</volume>, <fpage>978</fpage>–<lpage>985</lpage>.<pub-id pub-id-type="pmid">29942094</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hänzelmann</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>GSVA: gene set variation analysis for microarray and RNA-seq data</article-title>. <source>BMC Bioinformatics</source>, <volume>14</volume>, <fpage>7.</fpage><pub-id pub-id-type="pmid">23323831</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hoek</surname><given-names>K.L.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>A cell-based systems biology assessment of human blood to monitor immune responses after influenza vaccination</article-title>. <source>PLoS One</source>, <volume>10</volume>, <fpage>e0118528.</fpage><pub-id pub-id-type="pmid">25706537</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Johnson</surname><given-names>W.E.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>Adjusting batch effects in microarray expression data using empirical bayes methods</article-title>. <source>Biostatistics</source>, <volume>8</volume>, <fpage>118</fpage>–<lpage>127</lpage>.<pub-id pub-id-type="pmid">16632515</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Koster</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Rahmann</surname><given-names>S.</given-names></name></person-group> (<year>2012</year>) 
<article-title>Snakemake—a scalable bioinformatics workflow engine</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>2520</fpage>–<lpage>2522</lpage>.<pub-id pub-id-type="pmid">22908215</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lambrechts</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Phenotype molding of stromal cells in the lung tumor microenvironment</article-title>. <source>Nat. Med</source>., <volume>24</volume>, <fpage>1277</fpage>–<lpage>1289</lpage>.<pub-id pub-id-type="pmid">29988129</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Leinonen</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>The sequence read archive</article-title>. <source>Nucleic Acids Res</source>., <volume>39</volume>, <fpage>D19</fpage>–<lpage>D21</lpage>.<pub-id pub-id-type="pmid">21062823</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Dewey</surname><given-names>C.N.</given-names></name></person-group> (<year>2011</year>) 
<article-title>RSEM: accurate transcript quantification from RNA-Seq data with or without a reference genome</article-title>. <source>BMC Bioinformatics</source>, <volume>12</volume>, <fpage>323.</fpage><pub-id pub-id-type="pmid">21816040</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Comprehensive analyses of tumor immunity: implications for cancer immunotherapy</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>174.</fpage><pub-id pub-id-type="pmid">27549193</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Newman</surname><given-names>A.M.</given-names></name>, <name name-style="western"><surname>Alizadeh</surname><given-names>A.A.</given-names></name></person-group> (<year>2016</year>) 
<article-title>High-throughput genomic profiling of tumor-infiltrating leukocytes</article-title>. <source>Curr. Opin. Immunol</source>., <volume>41</volume>, <fpage>77</fpage>–<lpage>84</lpage>.<pub-id pub-id-type="pmid">27372732</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Newman</surname><given-names>A.M.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Robust enumeration of cell subsets from tissue expression profiles</article-title>. <source>Nat. Methods</source>, <volume>12</volume>, <fpage>453.</fpage><pub-id pub-id-type="pmid">25822800</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B26">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Newman</surname><given-names>A.M.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>). CIBERSORT website. <ext-link ext-link-type="uri" xlink:href="https://cibersort.stanford.edu/">https://cibersort.stanford.edu/</ext-link> (20 October 2018, date last accessed).</mixed-citation>
    </ref>
    <ref id="btz363-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Petitprez</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2018a</year>) 
<article-title>Quantitative analyses of the tumor microenvironment composition and orientation in the era of precision medicine</article-title>. <source>Front. Oncol</source>. <volume>8</volume>, <fpage>390</fpage>.<pub-id pub-id-type="pmid">30319963</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Petitprez</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2018b</year>) 
<article-title>Transcriptomic analysis of the tumor microenvironment to guide prognosis and immunotherapies</article-title>. <source>Cancer Immunol. Immunother</source>, <volume>67</volume>, <fpage>981</fpage>–<lpage>988</lpage>.<pub-id pub-id-type="pmid">28884365</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Racle</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Simultaneous enumeration of cancer and immune cell types from bulk tumor gene expression data</article-title>. <source>Elife</source>, <volume>6</volume>, <fpage>e26476</fpage>.<pub-id pub-id-type="pmid">29130882</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sade-Feldman</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Defining T cell states associated with response to checkpoint immunotherapy in melanoma</article-title>. <source>Cell</source>, <volume>175</volume>, <fpage>998</fpage>–<lpage>1013</lpage>.<pub-id pub-id-type="pmid">30388456</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schelker</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Estimation of immune cell content in tumour tissue using single-cell RNA-seq data</article-title>. <source>Nat. Commun</source>., <volume>8</volume>, <fpage>2032.</fpage><pub-id pub-id-type="pmid">29230012</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Smallwood</surname><given-names>S.A.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Single-cell genome-wide bisulfite sequencing for assessing epigenetic heterogeneity</article-title>. <source>Nat. Methods</source>, <volume>11</volume>, <fpage>817</fpage>–<lpage>820</lpage>.<pub-id pub-id-type="pmid">25042786</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Teschendorff</surname><given-names>A.E.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>A comparison of reference-based algorithms for correcting cell-type heterogeneity in epigenome-wide association studies</article-title>. <source>BMC Bioinformatics</source>, <volume>18</volume>, <fpage>105.</fpage><pub-id pub-id-type="pmid">28193155</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B34">
      <mixed-citation publication-type="journal">The, G.O.C. (<year>2017</year>) 
<article-title>Expansion of the gene ontology knowledgebase and resources</article-title>. <source>Nucleic Acids Res</source>., <volume>45</volume>, <fpage>D331</fpage>–<lpage>D338</lpage>.<pub-id pub-id-type="pmid">27899567</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Villani</surname><given-names>A.-C.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Single-cell RNA-seq reveals new types of human blood dendritic cells, monocytes, and progenitors</article-title>. <source>Science</source>, <volume>356</volume>, <fpage>4373</fpage></mixed-citation>
    </ref>
    <ref id="btz363-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>J.D.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Detect tissue heterogeneity in gene expression data with BioQC</article-title>. <source>BMC Genomics</source>, <volume>18</volume>, <fpage>277.</fpage><pub-id pub-id-type="pmid">28376718</pub-id></mixed-citation>
    </ref>
    <ref id="btz363-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zheng</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Landscape of infiltrating T cells in liver cancer revealed by single-cell sequencing</article-title>. <source>Cell</source>, <volume>169</volume>, <fpage>1342</fpage>–<lpage>1356</lpage>.<pub-id pub-id-type="pmid">28622514</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
