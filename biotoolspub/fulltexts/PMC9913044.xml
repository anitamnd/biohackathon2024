<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9913044</article-id>
    <article-id pub-id-type="pmid">36723167</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad066</article-id>
    <article-id pub-id-type="publisher-id">btad066</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Structural Bioinformatics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>NMRtist: an online platform for automated biomolecular NMR spectra analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Klukowski</surname>
          <given-names>Piotr</given-names>
        </name>
        <aff><institution>Laboratory of Physical Chemistry, ETH Zurich</institution>, 8093 Zurich, <country country="CH">Switzerland</country></aff>
        <xref rid="btad066-cor1" ref-type="corresp"/>
        <!--piotr.klukowski@phys.chem.ethz.ch-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Riek</surname>
          <given-names>Roland</given-names>
        </name>
        <aff><institution>Laboratory of Physical Chemistry, ETH Zurich</institution>, 8093 Zurich, <country country="CH">Switzerland</country></aff>
        <xref rid="btad066-cor1" ref-type="corresp"/>
        <!--roland.riek@phys.chem.ethz.ch-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2911-7574</contrib-id>
        <name>
          <surname>Güntert</surname>
          <given-names>Peter</given-names>
        </name>
        <aff><institution>Laboratory of Physical Chemistry, ETH Zurich</institution>, 8093 Zurich, <country country="CH">Switzerland</country></aff>
        <aff><institution>Institute of Biophysical Chemistry, Goethe University Frankfurt</institution>, 60438 Frankfurt am Main, <country country="DE">Germany</country></aff>
        <aff><institution>Department of Chemistry, Tokyo Metropolitan University</institution>, Hachioji, Tokyo 192-0397, <country country="JP">Japan</country></aff>
        <xref rid="btad066-cor1" ref-type="corresp"/>
        <!--peter.guentert@phys.chem.ethz.ch-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Cowen</surname>
          <given-names>Lenore</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad066-cor1">To whom correspondence should be addressed. <email>piotr.klukowski@phys.chem.ethz.ch</email> or <email>roland.riek@phys.chem.ethz.ch</email> or <email>peter.guentert@phys.chem.ethz.ch</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-02-01">
      <day>01</day>
      <month>2</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>01</day>
      <month>2</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>2</issue>
    <elocation-id>btad066</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>9</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>01</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>30</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>10</day>
        <month>2</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad066.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>We present NMRtist, an online platform that combines deep learning, large-scale optimization and cloud computing to automate protein NMR spectra analysis. Our website provides virtual storage for NMR spectra deposition together with a set of applications designed for automated peak picking, chemical shift assignment and protein structure determination. The system can be used by non-experts and allows protein assignments and structures to be determined within hours after the measurements, strictly without any human intervention.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>NMRtist is freely available to non-commercial users at <ext-link xlink:href="https://nmrtist.org" ext-link-type="uri">https://nmrtist.org</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Union</institution>
            <institution-id institution-id-type="DOI">10.13039/501100000780</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>891690</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Most nuclear magnetic resonance (NMR) studies of proteins remain substantial undertakings that require expert knowledge and weeks or months of manual analysis time. Obviating this complexity can facilitate investigations of protein structure, interactions and dynamics that are currently often deemed to be too demanding. Although there have been many approaches aiming at automating individual steps of NMR spectrum analysis (<xref rid="btad066-B7" ref-type="bibr">Würz <italic toggle="yes">et al.</italic>, 2017</xref>), a strictly automatic end-to-end method has been developed only recently with our ARTINA algorithm that includes peak picking, assignment and structure determination in completely unsupervised manner (<xref rid="btad066-B5" ref-type="bibr">Klukowski <italic toggle="yes">et al.</italic>, 2022</xref>). Here, we present NMRtist (<ext-link xlink:href="https://nmrtist.org" ext-link-type="uri">https://nmrtist.org</ext-link>), a web platform that offers virtual storage for protein NMR spectra, cloud computing resources and online hosting of applications for the analysis of multidimensional NMR data, in particular deep learning-based solutions implemented in ARTINA. NMRtist is accessed with a web browser and makes it possible to execute complex and computation-intensive spectra analysis methods in a user-friendly manner, such that (i) no expert knowledge (e.g. about high-performance computing or technical details of the algorithms) is required; (ii) no user-side hardware resources are necessary; (iii) on the server side, optimally selected hardware for machine learning and numerical optimization is available that scales to large numbers of users, projects, and application calls; (iv) the output is readily understandable and comprises the graphics and tables typically included in publications on protein NMR structure determinations.</p>
    <p>Apart from the immediate practical benefit of automating work-intensive data analysis tasks, NMRtist will allow, due to the acquisition of large-scale datasets from the users, the training of deep learning models for protein NMR spectroscopy at unprecedented scale. To date, most notable manuscripts published in the field refer to &lt;50 spectra in their experimental sections (e.g. in the well-known CASD-NMR competition, only NOESY spectra of 10 proteins were used). In contrast, over 2000 multidimensional NMR spectra were uploaded by the users to the NMRtist servers since the launch of the platform.</p>
  </sec>
  <sec>
    <title>2 Implementation</title>
    <p>The main logical unit of NMRtist is a <italic toggle="yes">project</italic>. Each project is bound to a single protein sequence and has private storage for experimental data deposition (<xref rid="btad066-F1" ref-type="fig">Fig. 1a</xref>). Within the project, the user uploads NMR data [currently, multidimensional NMR spectra in Bruker, XEASY, NMRPipe and UCSF (Sparky) binary formats are supported] and may specify contextual information related to the uploaded data, such as experiment types (currently, 26 types are supported), spectrum axis labels, types of signal folding, etc. Spectra stored in the project may be used as input for application calls (Section 3) that are executed on dedicated CPU/GPU machines (NMRtist computational nodes) in the system. This frees users from the necessity to maintain specialized IT infrastructure yet allowing them to perform advanced computation. The results of application calls are stored in the project storage and made available online to the user.</p>
    <fig position="float" id="btad066-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>NMRtist data analysis workflow. (<bold>a</bold>) A set of raw 2D/3D/4D NMR spectra and the protein sequence are uploaded to the project data storage. Experiment type and axis labels are specified for each uploaded spectrum. Optionally, additional tags can be provided to facilitate automated data analysis (e.g. @ALI for aliphatic and @POS for positive peaks only). Spectra in project storage are used as input for application calls, yielding outputs (<bold>b–d</bold>). (b) Example figure generated by the ARTINA peak picking application (Section 3). It presents CYANA F1 scores, calculated with the ‘peaks assignscore’ command of CYANA, of automated peak picking of the CcoNH, <sup>13</sup>C-HSQC and <sup>15</sup>N-HSQC spectra (red dots) in comparison with those of all spectra of the same type in a benchmark of 1329 spectra (box plot). (c) Example figure generated by the ARTINA chemical shift assignment application. Each column corresponds to a single amino acid with color-coded confidence of automatically assigned shift values (high/low confidence in dark/light shading, respectively). (d) Visualization of protein structures generated by the ARTINA structure determination application. The application outputs two overlaid structure candidates (orange and blue) resulting from two independent CYANA executions (<xref rid="btad066-B2" ref-type="bibr">Güntert and Buchner, 2015</xref>). Differences between structure candidates indicate either flexible regions or uncertainty in the structure determination</p>
      </caption>
      <graphic xlink:href="btad066f1" position="float"/>
    </fig>
    <p>The architecture of NMRtist has been designed such that the number of handled application calls scales linearly with the amount of hardware resources attached to the system. To assess NMRtist’s throughput capacity, we attached 10 Google Cloud machines to analyze over 1000 3D/4D NMR spectra within 24 h, which is about three orders of magnitude faster than their NMR acquisition time. Due to the scalability and high maximum throughput of the system, the amount of publicly available hardware resources can be adjusted dynamically to meet the demand from the platform users.</p>
  </sec>
  <sec>
    <title>3 Hosted applications</title>
    <p>The NMRtist platform is designed as a hub for disseminating new algorithms and standardized computational routines in computational NMR spectroscopy. Currently, the system contains three applications based on ARTINA models (<xref rid="btad066-B5" ref-type="bibr">Klukowski <italic toggle="yes">et al.</italic>, 2022</xref>).</p>
    <p><italic toggle="yes">ARTINA peak picking</italic> performs automated cross-peak detection and signal deconvolution using deep residual neural networks (<xref rid="btad066-B4" ref-type="bibr">He <italic toggle="yes">et al.</italic>, 2016</xref>), and peak list unfolding using kernel density estimation. Its output consists of lists of detected signal positions and intensities in multiple formats, together with quality metrics (<xref rid="btad066-F1" ref-type="fig">Fig. 1b</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>) that assess the uploaded data relative to over 1000 spectra stored in the ARTINA dataset. Additionally, the application performs spectra cross-referencing by detecting systematic shifts in the uploaded dataset (<xref rid="btad066-B1" ref-type="bibr">Buchner <italic toggle="yes">et al.</italic>, 2013</xref>).</p>
    <p><italic toggle="yes">ARTINA shift assignment</italic> assigns automatically chemical shifts in a set of protein NMR spectra. The application utilizes deep learning for visual spectrum analysis followed by automated assignment with the FLYA algorithm (<xref rid="btad066-B6" ref-type="bibr">Schmidt and Güntert, 2012</xref>) facilitated by graph neural network chemical shift predictions (<xref rid="btad066-B5" ref-type="bibr">Klukowski <italic toggle="yes">et al.</italic>, 2022</xref>). The application outputs a list of chemical shifts and their confidence (<xref rid="btad066-F1" ref-type="fig">Fig. 1c</xref>), as well as statistics on the use of each spectrum in the assignment process.</p>
    <p><italic toggle="yes">ARTINA structure determination</italic> performs protein structure determination using as input only NMR spectra and the protein sequence. The application performs, if needed, ARTINA peak picking and shift assignment before combined automated NOE assignment and structure calculation with torsion angle dynamics by CYANA (<xref rid="btad066-B2" ref-type="bibr">Güntert and Buchner, 2015</xref>). Apart from the protein structure in mmCIF and PDB formats, the method yields lists of restraints and chemical shifts in CYANA and NEF (<xref rid="btad066-B3" ref-type="bibr">Gutmanas <italic toggle="yes">et al.</italic>, 2015</xref>) format, allowing interpretability of its output.</p>
    <p>Each ARTINA-based application is available in two modes, <italic toggle="yes">standard</italic> mode corresponding to the original ARTINA implementation (<xref rid="btad066-B5" ref-type="bibr">Klukowski <italic toggle="yes">et al.</italic>, 2022</xref>) and <italic toggle="yes">test</italic> mode operating with minimal computational resources. The latter increases the usability of NMRtist by enabling short preliminary application calls that may precede the computation-intensive standard ARTINA method execution.</p>
  </sec>
  <sec>
    <title>4 Conclusions</title>
    <p>NMRtist is a versatile online platform that offers major technical advances in automating labor-intensive NMR data analysis, such as peak picking, chemical shift assignment and structure determination. NMRtist encapsulates the complexity of the ARTINA workflow, eliminates any intermediate data and format conversions by the user and employs different types of high-performance hardware as appropriate for each of the subtasks. With NMRtist, NMR data analysis can be completed within hours after the measurements by non-experts, without parameter setting by the user. We believe that the use of NMRtist by the research community will boost the throughput of structural biology research with NMR. In the near future, we plan to extend the set of applications in the NMRtist platform to automated NMR studies of protein–ligand complexes and RNA.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad066_Supplementary_Data</label>
      <media xlink:href="btad066_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Funding</title>
    <p>This work was supported by a Marie Skłodowska-Curie fellowship of the European Union [891690 to P.K.]; and a Grant-in-Aid for Scientific Research of the Japan Society for the Promotion of Science [20 K06508 to P.G.].</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data Availability</title>
    <p>The data underlying this article is available at <ext-link xlink:href="https://nmrtist.org" ext-link-type="uri">https://nmrtist.org</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad066-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buchner</surname><given-names>L.</given-names></string-name></person-group><etal>et al</etal> (<year>2013</year>) <article-title>Peakmatch: a simple and robust method for peak list matching</article-title>. <source>J. Biomol. NMR</source>, <volume>55</volume>, <fpage>267</fpage>–<lpage>277</lpage>.<pub-id pub-id-type="pmid">23329391</pub-id></mixed-citation>
    </ref>
    <ref id="btad066-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Güntert</surname><given-names>P.</given-names></string-name>, <string-name><surname>Buchner</surname><given-names>L.</given-names></string-name></person-group> (<year>2015</year>) <article-title>Combined automated NOE assignment and structure calculation with CYANA</article-title>. <source>J. Biomol. NMR</source>, <volume>62</volume>, <fpage>453</fpage>–<lpage>471</lpage>.<pub-id pub-id-type="pmid">25801209</pub-id></mixed-citation>
    </ref>
    <ref id="btad066-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gutmanas</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>NMR exchange format: a unified and open standard for representation of NMR restraint data</article-title>. <source>Nat. Struct. Mol. Biol</source>., <volume>22</volume>, <fpage>433</fpage>–<lpage>434</lpage>.<pub-id pub-id-type="pmid">26036565</pub-id></mixed-citation>
    </ref>
    <ref id="btad066-B4">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>He</surname><given-names>K.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) Deep residual learning for image recognition. In: <italic toggle="yes">Proceedings of the 2016 IEEE Conference on Computer Vision and Pattern Recognition, Las Vegas, Nevada, USA</italic>, pp. <fpage>770</fpage>–<lpage>778</lpage>.</mixed-citation>
    </ref>
    <ref id="btad066-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Klukowski</surname><given-names>P.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Rapid protein assignments and structures from raw NMR spectra with the deep learning technique ARTINA</article-title>. <source>Nat. Commun</source>., <volume>13</volume>, <fpage>6151</fpage>.<pub-id pub-id-type="pmid">36257955</pub-id></mixed-citation>
    </ref>
    <ref id="btad066-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schmidt</surname><given-names>E.</given-names></string-name>, <string-name><surname>Güntert</surname><given-names>P.</given-names></string-name></person-group> (<year>2012</year>) <article-title>A new algorithm for reliable and general NMR resonance assignment</article-title>. <source>J. Am. Chem. Soc</source>., <volume>134</volume>, <fpage>12817</fpage>–<lpage>12829</lpage>.<pub-id pub-id-type="pmid">22794163</pub-id></mixed-citation>
    </ref>
    <ref id="btad066-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Würz</surname><given-names>J.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>NMR-based automated protein structure determination</article-title>. <source>Arch. Biochem. Biophys</source>., <volume>628</volume>, <fpage>24</fpage>–<lpage>32</lpage>.<pub-id pub-id-type="pmid">28263718</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
