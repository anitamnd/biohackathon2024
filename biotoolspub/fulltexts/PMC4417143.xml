<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <?epub February-4-2015?>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="hwp">nar</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4417143</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkv054</article-id>
    <article-categories>
      <subj-group subj-group-type="hwp-journal-coll">
        <subject>9</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Methods Online</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>CAGEr</italic>: precise TSS data retrieval and high-resolution promoterome mining for integrative analyses</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Haberle</surname>
          <given-names>Vanja</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Forrest</surname>
          <given-names>Alistair R.R.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hayashizaki</surname>
          <given-names>Yoshihide</given-names>
        </name>
        <xref ref-type="aff" rid="AFF4">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Carninci</surname>
          <given-names>Piero</given-names>
        </name>
        <xref ref-type="aff" rid="AFF3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lenhard</surname>
          <given-names>Boris</given-names>
        </name>
        <xref ref-type="aff" rid="AFF2">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="AFF5">
          <sup>5</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
      <aff id="AFF1"><label>1</label>Department of Biology, University of Bergen, Thormøhlensgate 53 A &amp; B, N–5008 Bergen, Norway</aff>
      <aff id="AFF2"><label>2</label>Department of Molecular Sciences, Institute of Clinical Sciences, Faculty of Medicine, Imperial College London and MRC Clinical Sciences Centre, Hammersmith Hospital Campus, Du Cane Road, London W12 0NN, UK</aff>
      <aff id="AFF3"><label>3</label>RIKEN Center for Life Science Technologies, Division of Genomic Technologies (CLST DGT), RIKEN Yokohama Campus, 1-7-22 Suehiro-cho, Tsurumi-ku, Yokohama, Kanagawa 230-0045, Japan</aff>
      <aff id="AFF4"><label>4</label>RIKEN Preventive Medicine and Diagnosis Innovation Program (PMI), 2-1 Hirosawa, Wako-shi, Saitama 351-0198, Japan</aff>
      <aff id="AFF5"><label>5</label>Department of Informatics, University of Bergen, Høyteknologisenteret, Thormøhlensgate 55, N–5008 Bergen, Norway</aff>
    </contrib-group>
    <author-notes>
      <corresp id="COR1"><label>*</label>To whom correspondence should be addressed. Tel: +44 20 838 38353; Email: <email>b.lenhard@imperial.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>30</day>
      <month>4</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>04</day>
      <month>2</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>04</day>
      <month>2</month>
      <year>2015</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>43</volume>
    <issue>8</issue>
    <fpage>e51</fpage>
    <lpage>e51</lpage>
    <history>
      <date date-type="accepted">
        <day>15</day>
        <month>1</month>
        <year>2015</year>
      </date>
      <date date-type="received">
        <day>14</day>
        <month>1</month>
        <year>2015</year>
      </date>
      <date date-type="rev-recd">
        <day>16</day>
        <month>12</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2015. Published by Oxford University Press on behalf of Nucleic Acids Research.</copyright-statement>
      <copyright-year>2015</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:title="pdf" xlink:type="simple" xlink:href="gkv054.pdf"/>
    <abstract>
      <p>Cap analysis of gene expression (CAGE) is a high-throughput method for transcriptome analysis that provides a single base-pair resolution map of transcription start sites (TSS) and their relative usage. Despite their high resolution and functional significance, published CAGE data are still underused in promoter analysis due to the absence of tools that enable its efficient manipulation and integration with other genome data types. Here we present <italic>CAGEr</italic>, an R implementation of novel methods for the analysis of differential TSS usage and promoter dynamics, integrated with CAGE data processing and promoterome mining into a first comprehensive CAGE toolbox on a common analysis platform. Crucially, we provide collections of TSSs derived from most published CAGE datasets, as well as direct access to FANTOM5 resource of TSSs for numerous human and mouse cell/tissue types from within R, greatly increasing the accessibility of precise context-specific TSS data for integrative analyses. The <italic>CAGEr</italic> package is freely available from Bioconductor at <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/release/bioc/html/CAGEr.html">http://www.bioconductor.org/packages/release/bioc/html/CAGEr.html</ext-link>.</p>
    </abstract>
    <counts>
      <page-count count="11"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>cover-date</meta-name>
        <meta-value>30 April 2015</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>INTRODUCTION</title>
    <p>The transcription of protein-coding RNA (mRNA) and several classes of non-coding RNAs is initiated by RNA Polymerase II (RNAPII) complex at discrete loci known as RNAPII promoters (<xref rid="B1" ref-type="bibr">1</xref>). They are the sites of binding and positioning of the machinery that initiates transcription at individual nucleotides called transcription start sites (TSS). Mapping of 5′ ends of individual mRNAs by oligo-capping and genome-wide by cap analysis of gene expression (CAGE), revealed that the transcription can start at multiple closely spaced TSSs within a promoter (<xref rid="B2" ref-type="bibr">2</xref>,<xref rid="B3" ref-type="bibr">3</xref>) challenging the traditional view of a gene promoter and its precisely defined TSS.</p>
    <p>CAGE is a high-throughput method for transcriptome analysis that captures the 5′ end of the transcribed and capped mRNAs (<xref rid="B4" ref-type="bibr">4</xref>). Sequencing of short fragments from the very 5′ end yields a large number of CAGE tags that can be mapped back to the reference genome to infer the exact position of the TSSs of captured RNAs. The number of CAGE tags supporting each TSS reflects the relative frequency of its usage and can be used as a measure of expression from that specific TSS (<xref rid="B5" ref-type="bibr">5</xref>). Thus, CAGE provides information on two aspects of the capped transcriptome: (i) genome-wide single base-pair resolution map of TSSs and (ii) relative levels of transcripts initiated at each TSS (Figure <xref ref-type="fig" rid="F1">1a</xref>). This information can be used for various analyses, from studying promoter architecture (<xref rid="B2" ref-type="bibr">2</xref>,<xref rid="B6" ref-type="bibr">6</xref>) to 5′ end-centred expression profiling (<xref rid="B7" ref-type="bibr">7</xref>,<xref rid="B8" ref-type="bibr">8</xref>).</p>
    <fig id="F1" position="float">
      <label>Figure 1.</label>
      <caption>
        <p><italic>CAGEr</italic> workflow. (<bold>a</bold>) Schematic representation of CAGE data and explanation of key terms. (<bold>b</bold>) Flow chart of main steps in <italic>CAGEr</italic>. CTSS, CAGE detected TSS; TC, tag/TSS cluster.</p>
      </caption>
      <graphic xlink:href="gkv054fig1"/>
    </fig>
    <p>Mapping genome-wide TSSs by CAGE in a vast number of mouse and human cell and tissue types (<xref rid="B9" ref-type="bibr">9</xref>–<xref rid="B11" ref-type="bibr">11</xref>) led to the discovery of distinct classes of promoters with respect to TSS distribution. They differ in underlying sequence features and associated gene function (<xref rid="B2" ref-type="bibr">2</xref>), and are subject to distinct modes of regulation (reviewed in (<xref rid="B12" ref-type="bibr">12</xref>)). CAGE has also been used to identify key transcription factors binding at promoters, and to reconstruct the regulatory networks that drive the differentiation (<xref rid="B8" ref-type="bibr">8</xref>) and maintain cellular identity (<xref rid="B11" ref-type="bibr">11</xref>), as well as to construct an atlas of active enhancers across the whole human body (<xref rid="B13" ref-type="bibr">13</xref>). Thus, in addition to providing a valuable resource of genome-wide cell type-specific TSSs, as a more precise and context-sensitive alternative to TSS positions available in annotation databases, CAGE is also a powerful approach for studying various aspects of gene regulation.</p>
    <p>The initial studies of genome-wide CAGE datasets have introduced basic methods for processing sequenced and mapped CAGE tags dealing with removal of protocol specific G nucleotide addition bias (<xref rid="B2" ref-type="bibr">2</xref>) and precise TSS calling. Different clustering approaches have been used to reconstruct promoters, based either on the fixed distance between individual TSSs (<xref rid="B2" ref-type="bibr">2</xref>,<xref rid="B7" ref-type="bibr">7</xref>) or on the density of transcription initiation events (<xref rid="B14" ref-type="bibr">14</xref>). With the increase of sequencing depth, normalization approaches and noise modelling have also been introduced (<xref rid="B15" ref-type="bibr">15</xref>) to enable expression profiling from CAGE. On the other hand, the high-resolution positional information has been used to analyse the distribution of TSSs within promoters, with various measures devised to assess promoter width and shape (<xref rid="B2" ref-type="bibr">2</xref>,<xref rid="B6" ref-type="bibr">6</xref>,<xref rid="B14" ref-type="bibr">14</xref>). Furthermore, the first genome-wide investigation of differential TSS usage within individual promoters detected extensive positional and/or regional bias in TSS usage across multiple tissues (<xref rid="B16" ref-type="bibr">16</xref>) emphasizing the importance of context-specific TSS information. Despite various methods used for analysing CAGE data, and several recently published programs that address specific questions in CAGE data analysis (<xref rid="B17" ref-type="bibr">17</xref>,<xref rid="B18" ref-type="bibr">18</xref>), no software package has been published that would integrate a comprehensive CAGE workflow with an easy access to a growing resource of CAGE-detected TSSs on a commonly used analysis platform, allowing users to integrate high-resolution TSS data with other genome-wide data types. For that reason, the available CAGE data has been under-utilized relative to its power, resolution and the amount of precision it brings into the analysis of promoter structure and function, in favour of less precise annotation.</p>
    <p>Here we present <italic>CAGEr</italic>, a freely available R/Bioconductor package that implements various methods for CAGE data processing and promoterome mining and provides access to majority of published CAGE datasets in several organisms (<xref rid="B6" ref-type="bibr">6</xref>,<xref rid="B9" ref-type="bibr">9</xref>,<xref rid="B10" ref-type="bibr">10</xref>,<xref rid="B19" ref-type="bibr">19</xref>,<xref rid="B20" ref-type="bibr">20</xref>), including the recent FANTOM5 collection of TSSs for numerous human and mouse cell and tissue types (<xref rid="B11" ref-type="bibr">11</xref>). <italic>CAGEr</italic> further introduces methods for the analysis of differential TSS usage and detection of ‘shifting’ promoters, a novel concept addressing variability in the choice of TSSs within the same promoter between different contexts (<xref rid="B21" ref-type="bibr">21</xref>). To demonstrate the provided functionality and various outputs produced by <italic>CAGEr</italic>, we apply the workflow to a previously unanalysed set of eight CAGE datasets covering mouse testis development from embryonic day 13 to adulthood produced by the FANTOM5 Consortium (<xref rid="B11" ref-type="bibr">11</xref>), and we reveal extensive differential TSS usage within individual promoter region between early embryonic and adult testis.</p>
  </sec>
  <sec sec-type="materials|methods" id="SEC2">
    <title>MATERIALS AND METHODS</title>
    <sec id="SEC2-1">
      <title>The <italic>CAGEr</italic> package</title>
      <p><italic>CAGEr</italic> is a software package developed for the R computing and statistical environment (<xref rid="B22" ref-type="bibr">22</xref>) and is distributed within the Bioconductor project (<xref rid="B23" ref-type="bibr">23</xref>) at <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/release/bioc/html/CAGEr.html">http://www.bioconductor.org/packages/release/bioc/html/CAGEr.html</ext-link>. The source code of the package is also available from <ext-link ext-link-type="uri" xlink:href="http://promshift.genereg.net/CAGEr/PackageSource/">http://promshift.genereg.net/CAGEr/PackageSource/</ext-link>. The package provides functionality for processing and analysing CAGE data starting from different input formats, through a workflow consisting of successive, well-documented steps. Detailed description of each function and comprehensive user guide with example analysis are distributed with the package and are also provided here in Supplementary Methods. <italic>CAGEr</italic> starts from sequenced and mapped CAGE tags and performs quality filtering and removal of protocol-specific 5′ end G nucleotide addition bias to identify precise TSS positions and frequency of their usage. Alternatively, already called single base-pair resolution TSSs, provided by the user or retrieved from one of the available resources described below, can be used as input and included into the workflow. Several normalization methods of raw CAGE tag counts are supported and accompanied by graphical outputs that aid in selecting optimal parameters for normalization. <italic>CAGEr</italic> further constructs context-specific promoterome by clustering individual TSSs into tag clusters (TC) using one of the several supported clustering approaches. It manipulates multiple CAGE experiments at once, performs expression profiling across experiments, both at the level of individual TSSs and clusters of TSSs, and exports several different types of track files for visualization in the genome browser. Implementation of assessment of promoter width is provided, which uses interquantile width as a measure of width robust to expression level, which allows classification of promoters into sharp or broad class. <italic>CAGEr</italic> also introduces novel method for detection of differential TSS usage, addressing the variability in TSS choice and promoter shifting between different contexts. The context-specific promoterome with precise TSS positions and various additional layers of information constructed using <italic>CAGEr</italic> can be integrated into any promoter-centred analysis. To facilitate the reuse of available public CAGE data, <italic>CAGEr</italic> provides access to TSSs for numerous human and mouse samples from FANTOM5 collection, which are retrieved from the FANTOM5 online resource (<ext-link ext-link-type="uri" xlink:href="http://fantom.gsc.riken.jp/5/datafiles/latest/basic/">http://fantom.gsc.riken.jp/5/datafiles/latest/basic/</ext-link>) and are imported directly into the workflow in R. The list and short description of all human and mouse FANTOM5 samples is available in <italic>CAGEr</italic> and can be used to search and retrieve TSS data for selected samples (example code in Supplementary Methods).</p>
    </sec>
    <sec id="SEC2-2">
      <title>Mouse testis data</title>
      <p>To demonstrate the functionality of the package we used a previously uncharacterized time-course of eight mouse testis CAGE samples produced by the FANTOM5 consortium (<xref rid="B11" ref-type="bibr">11</xref>). These include testis samples from embryonic days 13, 15 and 17, neonate days 0, 10, 20 and 30, and from an adult mouse. Tab-separated flat files with genomic positions of CAGE-detected TSSs and associated tag counts mapped to the mm9 assembly of the mouse genome were obtained from the FANTOM5 web resource (<ext-link ext-link-type="uri" xlink:href="http://fantom.gsc.riken.jp/5/datafiles/latest/basic/mouse.tissue.hCAGE/">http://fantom.gsc.riken.jp/5/datafiles/latest/basic/mouse.tissue.hCAGE/</ext-link>) and were used as input for <italic>CAGEr</italic>. The TSS input data is available from <ext-link ext-link-type="uri" xlink:href="http://promshift.genereg.net/CAGEr/InputData/">http://promshift.genereg.net/CAGEr/InputData/</ext-link> and documented R code for processing these data with <italic>CAGEr</italic> and performing analyses presented in this paper is provided in Supplementary Methods.</p>
      <p>BioCap data for non-methylated regions in mouse testis produced by Long <italic>et al</italic>. (<xref rid="B24" ref-type="bibr">24</xref>) were obtained from GEO (accession code: GSM1064678) and coordinates of CpG islands for mm9 genome assembly were downloaded from the UCSC Genome Browser. Position weight matrix for TATA-box motif was downloaded from the Jaspar database (<xref rid="B25" ref-type="bibr">25</xref>) and used to score the region from −35 to −22 bp upstream of the dominant TSS in sharp and broad promoters. RefSeq gene annotation for mm9 genome assembly was obtained from the UCSC Genome Browser and was associated with the closest CAGE-derived TSS cluster falling within −1000 to +500 bp from the annotated TSS.</p>
    </sec>
    <sec id="SEC2-3">
      <title>R data packages containing FANTOM, ENCODE and zebrafish CAGE data</title>
      <p>We have collected publicly available CAGE datasets produced by the FANTOM consortium in the FANTOM3 and FANTOM4 projects (<xref rid="B8" ref-type="bibr">8</xref>–<xref rid="B10" ref-type="bibr">10</xref>) and organized the detected TSSs into <italic>FANTOM3and4CAGE</italic> R data package. The package contains data for various human and mouse tissues and several time-courses. Each dataset within the package provides genomic coordinates of TSSs detected by CAGE in a group of related samples, along with the number of supporting CAGE tags in each individual sample. This package is freely available through Bioconductor (<xref rid="B23" ref-type="bibr">23</xref>) at <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/release/data/experiment/html/FANTOM3and4CAGE.html">http://www.bioconductor.org/packages/release/data/experiment/html/FANTOM3and4CAGE.html</ext-link>.</p>
      <p>We provide an analogous R data package containing TSSs derived from ENCODE CAGE data (<xref rid="B19" ref-type="bibr">19</xref>) for various human cell lines. The format of CAGE data provided by ENCODE at UCSC includes only raw mapped CAGE tags, their coverage along the genome and the coordinates of the enriched genomic regions (peaks), which do not take advantage of the single base-pair resolution TSS information provided by CAGE. To address this, we have processed mapped CAGE tags with <italic>CAGEr</italic>, removed the 5′ end G nucleotide addition bias and derived single base-pair resolution TSSs, which were then collected into an R data package named <italic>ENCODEprojectCAGE</italic>. The package also includes modENCODE project CAGE dataset for fruit fly (<italic>Drosophila melanogaster</italic>) embryos (<xref rid="B6" ref-type="bibr">6</xref>). This data package is freely available for download from <ext-link ext-link-type="uri" xlink:href="http://promshift.genereg.net/CAGEr/PackageSource/">http://promshift.genereg.net/CAGEr/PackageSource/</ext-link> and is accompanied by a user manual explaining its content and usage.</p>
      <p>Our previously published CAGE data for 12 developmental stages of zebrafish (<xref rid="B20" ref-type="bibr">20</xref>) (<italic>Danio rerio</italic>) has also been collected into a data package that can be used with <italic>CAGEr</italic>. The <italic>ZebrafishDevelopmentalCAGE</italic> package and accompanying user manual are available for download from <ext-link ext-link-type="uri" xlink:href="http://promshift.genereg.net/CAGEr/PackageSource/">http://promshift.genereg.net/CAGEr/PackageSource/</ext-link>.</p>
      <p>Once any of the above mentioned R packages has been downloaded and installed, selected samples can be easily imported into <italic>CAGEr</italic> workflow as exemplified by the R code in Supplementary Methods. This allows users to easily obtain context-specific list of promoters with precise TSS positions and additional promoter information that can be used for integrative analyses.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>RESULTS</title>
    <sec id="SEC3-1">
      <title>CAGEr workflow overview</title>
      <p>The workflow provided by <italic>CAGEr</italic> package consists of successive steps of TSS data processing and more complex downstream analyses (Figure <xref ref-type="fig" rid="F1">1b</xref>), which enable users to obtain comprehensive list of promoters and various associated information by invoking only several well-documented commands (see Supplementary Methods for detailed user guide). Three different formats of input data are supported: (i) binary alignment files of CAGE tags mapped to a reference genome, (ii) table of genomic positions of CAGE-derived TSSs with counts of supporting tags in one or more samples as flat tab-separated file(s) and (iii) direct import of publicly available CAGE datasets from FANTOM5 web resource or from accompanying R data packages (Supplementary Figure S1a). Raw mapped CAGE tags require quality filtering before reliable TSS positions can be derived. In the CAGE experimental protocol an additional G nucleotide is often attached to the 5′ end of the tag by a template-free activity of the reverse transcriptase during cDNA preparation (<xref rid="B26" ref-type="bibr">26</xref>), which creates a bias that can be corrected only after mapping. <italic>CAGEr</italic> enables correction of this bias either by using a simple approach of removing the first nucleotide from the tag in case it is a G and does not map to the corresponding genomic sequence, or by applying a systematic probability-based correction algorithm (<xref rid="B2" ref-type="bibr">2</xref>). Once the exact 5′ ends of the CAGE tags are established, precise TSSs and supporting tag counts can be called. Individual TSSs and their relative usage can be visualized in the genomic context by exporting the strand-specific single-nucleotide resolution data to a track file format that can be used in any genome browser (Supplementary Figure S1b). A general overview of the datasets and the relationship between different samples can also be obtained by plotting correlation of tag counts per TSS (Supplementary Figure S1c). Various graphical outputs are produced at each step in the workflow, allowing quality checks and driving hypothesis generation. All functionality provided in <italic>CAGEr</italic> is demonstrated here by applying the workflow to eight CAGE samples of mouse testis development (<xref rid="B11" ref-type="bibr">11</xref>) (input TSS data available from <ext-link ext-link-type="uri" xlink:href="http://promshift.genereg.net/CAGEr/InputData/">http://promshift.genereg.net/CAGEr/InputData/</ext-link> and documented R code provided in Supplementary Methods). A detailed step-by-step user guide through the <italic>CAGEr</italic> workflow with accompanying code snippets is provided in the vignette (Supplementary Methods), which is distributed with the package.</p>
    </sec>
    <sec id="SEC3-2">
      <title>Tag count normalization</title>
      <p>To quantify the expression from each individual TSS and enable comparison between multiple samples, raw tag counts have to be normalized. Many studies performing expression profiling based on CAGE data used number of tags per million (tpm) (<xref rid="B7" ref-type="bibr">7</xref>,<xref rid="B19" ref-type="bibr">19</xref>,<xref rid="B27" ref-type="bibr">27</xref>), which is a simple normalized measure still widely used in many other high-throughput sequencing tag-based studies. However, a systematic investigation of multiple CAGE datasets has revealed that the reverse cumulative distribution of the number of tags per TSS follows a power-law distribution to a very good approximation. Thus, a normalization method that transforms CAGE tag counts in different samples to match a common reference power-law distribution was proposed (<xref rid="B15" ref-type="bibr">15</xref>). <italic>CAGEr</italic> supports both normalization methods and provides visualization of reverse cumulative distributions, which aids in deciding on the appropriate normalization approach and in choosing optimal parameters. Figure <xref ref-type="fig" rid="F2">2</xref> demonstrates output produced by <italic>CAGEr</italic> showing reverse cumulatives of CAGE signal for eight mouse testis samples (code in Supplementary Methods). The slopes of the power-laws fitted within a specified range of tag count values are reported for each sample and are used to calculate optimal parameters for normalization. The slope of the suggested reference distribution (alpha) is calculated as a median of slopes fitted to individual samples, and the total number of tags (T) is chosen to be the power of 10 closest to the median sequencing depth of the samples (typically 1 million to give normalized tags per million). After normalization, all samples follow the same reference power-law distribution across several orders of magnitude (Figure <xref ref-type="fig" rid="F2">2b</xref>). Normalized number of CAGE tags can be used to perform expression profiling of individual TSSs to obtain classes of TSSs with the same expression pattern across samples. Finally, the option of performing no normalization at the individual TSS level is also provided, which allows later normalization at the entire promoter level (<xref rid="B11" ref-type="bibr">11</xref>) by applying statistical approaches that require raw tag counts (e.g. DEseq (<xref rid="B28" ref-type="bibr">28</xref>); edgeR (<xref rid="B29" ref-type="bibr">29</xref>)). This enables integration of <italic>CAGEr</italic> workflow with other expression analysis methods available in R.</p>
      <fig id="F2" position="float">
        <label>Figure 2.</label>
        <caption>
          <p>Power-law based normalization (<bold>a</bold>) Reverse cumulative distribution of CAGE tag count per CTSS for eight mouse testis samples plotted with <italic>CAGEr</italic>. Slope of the power-law fitted within the range marked by the dotted lines is shown for each sample in the brackets next to the sample name. Suggested reference power-law distribution is shown as dashed grey line and the corresponding parameters for normalization are denoted in the lower left corner. alpha, absolute value of the reference slope on the log-log scale; T, total number of CAGE tags in the reference distribution. (<bold>b</bold>) Reverse cumulative distribution of CAGE signal per CTSS after normalization. E13 – E17, embryonic day 13–17; N0–N30, neonate day 0–30.</p>
        </caption>
        <graphic xlink:href="gkv054fig2"/>
      </fig>
    </sec>
    <sec id="SEC3-3">
      <title>TSS clustering and promoterome construction</title>
      <p>To reconstruct promoters, individual TSSs are clustered together along the genome. TCs were initially introduced to group together overlapping CAGE tags (<xref rid="B9" ref-type="bibr">9</xref>), which resulted in clustering neighbouring TSSs that are less than the length of one tag apart (Figure <xref ref-type="fig" rid="F1">1a</xref>). This simple distance-based approach was widely used in the following studies and, combined together with the multiple-level clustering, proved to be useful for roughly reconstructing individual gene promoters and analysing their properties (<xref rid="B2" ref-type="bibr">2</xref>). However, this approach sets an arbitrary cut-off on the maximal allowed distance between neighbouring TSSs and does not necessarily reflect the intrinsic clustering of the data. This was addressed by introducing a parametric clustering algorithm that attempts to find segments of the genome, which maximize the number of transcription initiation events per nucleotide (<xref rid="B14" ref-type="bibr">14</xref>). It finds nested clusters across all possible density values and addresses the hierarchical organization of transcription initiation along the genome (Supplementary Figure S2). In addition to these genome-wide data-driven clustering approaches, <italic>CAGEr</italic> allows TSSs to be distributed into a set of predefined genomic regions, e.g. user-defined windows flanking annotated TSSs. This option enables the refinement of annotation with precise context-specific TSSs. Main characteristics of described clustering approaches are summarized in Table <xref ref-type="table" rid="tbl1">1</xref>. They can all be run in <italic>CAGEr</italic> with a single command that results in a set of clusters per sample with denoted position of the dominant (most frequently used) TSS, signal supporting that TSS and total signal in the cluster. The obtained clusters reflect context-specific promoterome and can be used as reference positions for genome-wide promoter-centred analyses, as a more precise and functionally relevant alternative to annotation. Furthermore, the downstream analyses described below provide additional layers of information for each promoter, allowing their classification and correlation of promoter features with other genome-wide data. Together with direct access to TSSs for numerous human and mouse cell and tissue types from FANTOM5 resource that can be easily included into the <italic>CAGEr</italic> workflow, it is a very powerful tool that can improve the resolution of any TSS-centred analysis.</p>
      <table-wrap id="tbl1" position="float">
        <label>Table 1.</label>
        <caption>
          <title>Summary of TSS clustering methods supported in <italic>CAGEr</italic></title>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Method</th>
              <th align="left" rowspan="1" colspan="1">Main parameter</th>
              <th align="left" rowspan="1" colspan="1">Level of supervision</th>
              <th align="left" rowspan="1" colspan="1">Clusters</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">distclu</td>
              <td align="left" rowspan="1" colspan="1">distance between neighbouring TSSs</td>
              <td align="left" rowspan="1" colspan="1">semi data-driven</td>
              <td align="left" rowspan="1" colspan="1">non-overlapping</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">paraclu</td>
              <td align="left" rowspan="1" colspan="1">density of transcription initiation events</td>
              <td align="left" rowspan="1" colspan="1">data-driven</td>
              <td align="left" rowspan="1" colspan="1">overlapping (can be merged to non-overlapping)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">custom</td>
              <td align="left" rowspan="1" colspan="1">predefined genomic windows</td>
              <td align="left" rowspan="1" colspan="1">user-defined</td>
              <td align="left" rowspan="1" colspan="1">overlapping or non-overlapping</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec id="SEC3-4">
      <title>Promoter width</title>
      <p>Genome-wide mapping of TSSs with CAGE initially revealed two main types of promoters with respect to the number and distribution of TSSs: ‘sharp’ (also called ‘peaked’ or ‘focused’) promoters in which the majority of transcription starts at one clearly dominant TSS, and ‘broad’ (‘dispersed’) promoters with several commonly used TSS positions distributed along a wider region (<xref rid="B2" ref-type="bibr">2</xref>). This promoter feature is conserved across Metazoa and correlates with both underlying sequence and chromatin configuration as well as with function of the associated gene (reviewed in (<xref rid="B12" ref-type="bibr">12</xref>)). Thus, promoter width is a useful concept that can provide insight into the mode of gene regulation in a particular regulatory environment. For example, extensive use of sharp promoters might indicate that the transcription is directed by a factor bound at a fixed distance to the TSS, which poses spatial constraint on RNAPII positioning (<xref rid="B21" ref-type="bibr">21</xref>). In <italic>CAGEr</italic>, we provide a method for assessing promoter width based on cumulative distribution of CAGE signal along the promoter. Instead of using the full span of the TC, interquantile width is defined as spacing between the positions of the two quantiles of the total CAGE signal (q<sub>low</sub> and q<sub>up</sub>; Figure <xref ref-type="fig" rid="F3">3a</xref>). That way only the central region containing more than (q<sub>up</sub>–q<sub>low</sub>) × 100% of CAGE tags is considered, which gives a more robust estimate of promoter width with respect to expression level. To facilitate data exploration, <italic>CAGEr</italic> produces tracks for visualization of interquantile width of individual promoters in a transcript-like representation (Supplementary Figure S3a). As demonstrated for the adult mouse testis sample, full length of the cluster is largely dependent on the absolute expression and the depth of sequencing, and with the increasing depth of recent sequencing technologies does not show the expected bimodal distribution in case of highly expressed promoters, giving the impression that the majority of those promoters are fairly broad (Figure <xref ref-type="fig" rid="F3">3b</xref>). On the other hand, interquantile width reveals that a substantial proportion of those promoters are actually sharp, as expected for highly expressed TATA-box associated promoters (Figure <xref ref-type="fig" rid="F3">3c</xref>). Thus, interquantile width accounts for local level of noise and brings the distribution of promoter width across different magnitudes of expression to the same scale, allowing easier separation of sharp and broad promoters (Figure <xref ref-type="fig" rid="F3">3b</xref>). The underlying difference between these two promoter classes is clearly evident in their association with TATA-box, which is mainly found in sharp promoters, and CpG islands and non-methylated regions, which more often overlap with broad promoters (Figure <xref ref-type="fig" rid="F3">3c</xref>, <xref ref-type="fig" rid="F3">d</xref>). Thus, assessing interquantile width with <italic>CAGEr</italic> and plotting the distribution of promoter width in different samples gives and overview of the global usage of the different promoter types and hints at the predominant mode of regulation in a particular context (Supplementary Figure S3b). <italic>CAGEr</italic> workflow allows context-specific assignment of promoters into sharp or broad class by applying few simple commands (R code in Supplementary Methods), providing an additional layer of information that can be integrated into any promoter-centred analysis.</p>
      <fig id="F3" position="float">
        <label>Figure 3.</label>
        <caption>
          <p>Promoter width. (<bold>a</bold>) Schematic representation of promoter width assessment using quantile positions of CAGE signal along the promoter. (<bold>b</bold>) Distribution of promoter width in adult mouse testis for three groups of promoters divided by expression (normalized CAGE tpm). Left panel shows the distribution of the full width from the most 5′ TSS to the most 3′ TSS in the promoter and right panel shows the interquantile width (distance between the positions of the 10<sup>th</sup> and the 90<sup>th</sup> percentile). Interquantile width accounts for local level of noise and provides a more robust measure of promoter width, allowing separation of sharp and broad promoters (dashed line). (<bold>c</bold>) Distribution of match (%) to TATA-box motif in the region −35 to −22 bp upstream of the dominant TSS in sharp and broad promoters. <italic>P</italic>-value of two-tailed Wilcoxon rank-sum test is shown. (<bold>d</bold>) Percentage of sharp and broad promoters that overlap CpG islands (CGI) and non-methylated islands (NMI; data from (<xref rid="B24" ref-type="bibr">24</xref>)).</p>
        </caption>
        <graphic xlink:href="gkv054fig3"/>
      </fig>
    </sec>
    <sec id="SEC3-5">
      <title>Expression profiling</title>
      <p><italic>CAGEr</italic> manipulates multiple CAGE samples at once and can address promoter dynamics across different contexts. To perform expression profiling at promoter level, TSS clusters from individual samples are first aggregated into a single set of consensus clusters, as shown schematically in Supplementary Figure S4. This produces more robust boundaries of the promoter region and captures all transcription initiation associated with a single gene. Promoters are then distributed into expression classes by applying one of the two commonly used unsupervised clustering algorithms: <italic>k</italic>-means or self-organizing maps (<xref rid="B30" ref-type="bibr">30</xref>) (SOM), which are invoked with single command in <italic>CAGEr</italic> (R code in Supplementary Methods). The resulting expression profiles are visualized using beanplots (<xref rid="B31" ref-type="bibr">31</xref>) and in the case of SOM they are organized into a two-dimensional map with the neighbouring clusters being more similar than the distant ones. An example of 2 × 4 SOM trained on a set of promoter expression values across mouse testis development time-course is shown in Figure <xref ref-type="fig" rid="F4">4a</xref>, which clearly separates promoters specific for the mature adult testis from the promoters active only in the earlier developmental stages. Different expression clusters are enriched for different gene ontology terms, reflecting the biological functions relevant in different stages of testis development (Figure <xref ref-type="fig" rid="F4">4a</xref>; Supplementary Table S1). Expression dynamics of individual promoters adds another layer of information for integrative analyses and can also be exported for visualization in the genome browser by colouring promoters according to their expression cluster (Figure <xref ref-type="fig" rid="F4">4b</xref>; Supplementary Figure S5a).</p>
      <fig id="F4" position="float">
        <label>Figure 4.</label>
        <caption>
          <p>Promoter-centred expression profiling. (<bold>a</bold>) Self-organizing map clustering of promoter expression across eight mouse testis samples. Each box represents one cluster and the number of contained promoters is denoted above the box. Individual beanplots show distribution of scaled normalized expression for those promoters in different samples denoted on the x-axis. Gene ontology terms significantly enriched in selected clusters are shown in corresponding colours. (<bold>b</bold>) Example of a constitutively expressed promoter that contains TSSs with distinct expression dynamics. First track shows the span of the cluster (promoter) and is coloured according to its expression class (0_2) as shown in panel (a). Second track shows individual TSS positions with signal above 5 tpm, which are coloured according to their own expression class as shown in Supplementary Figure S5b.</p>
        </caption>
        <graphic xlink:href="gkv054fig4"/>
      </fig>
      <p>An analogous expression clustering can be performed on the level of individual TSS positions, which reveals similar expression profiles (Supplementary Figure S5b). Importantly, the expression patterns of individual TSSs within promoter region do not always correspond to the overall expression pattern of the promoter, suggesting dynamic changes in relative usage of TSSs across the time-course, as revealed by colouring them according to their expression profile (Figure <xref ref-type="fig" rid="F4">4b</xref>; Supplementary Figure S5c).</p>
    </sec>
    <sec id="SEC3-6">
      <title>Differential TSS usage and promoter shifting</title>
      <p>The discrepancy between the expression dynamics of the entire promoter and the contained individual TSSs indicates differential TSS usage across samples. This often results in spatial separation of TSS usage within a relatively narrow promoter region producing ‘shifting’ promoter patterns (<xref rid="B21" ref-type="bibr">21</xref>) (Figure <xref ref-type="fig" rid="F5">5c</xref>). <italic>CAGEr</italic> systematically detects such cases by comparing cumulative distributions of CAGE signal along the same consensus promoter region in two different (groups of) samples. Each individual promoter is scored for shifting as shown in Figure <xref ref-type="fig" rid="F5">5a</xref>. The resulting score can be interpreted as the proportion of transcription initiation in the sample with lower total expression that is shifted either upstream or downstream of the region used for initiation in the sample with the higher expression. For instance, the score of 0.4 means that at least 40% of the transcription in one sample is independent and happening outside of the region used to initiate transcription from the same promoter in the other sample. A set of promoters with shifting score above specified threshold between any two (groups of) samples can be easily obtained in <italic>CAGEr</italic> with only few simple commands (R code in Supplementary Methods) and can be further used to analyse features underlying differential TSS usage (<xref rid="B21" ref-type="bibr">21</xref>).</p>
      <fig id="F5" position="float">
        <label>Figure 5.</label>
        <caption>
          <p>Differential TSS usage. (<bold>a</bold>) Schematics of differential TSS usage assessment. Distribution of TSSs and cumulative distribution of CAGE signal (F<sub>1</sub> and F<sub>2</sub>) along single promoter in two different samples is shown in cyan and orange, respectively. Grey line shows the subtraction of the two cumulatives. The shifting score is calculated as a ratio of the maximal difference between the two cumulatives and the total CAGE signal at that promoter in the sample with lower signal (left panel). The cumulatives are scaled to the range between 0 and 1, and Kolmogorov–Smirnov (K–S) test is used to assess the significance of the difference between resulting empirical distribution functions (F<sub>1</sub>′ and F<sub>2</sub>′). Value of the K–S statistic (D) is illustrated by an arrow (right panel). (<bold>b</bold>) Number of promoters with significant differential TSS usage (K–S test, FDR ≤ 0.01) for all pair-wise comparisons of eight mouse testis samples. (<bold>c</bold>) Example of a shifting promoter detected using method shown in panel a, which demonstrates differential TSS usage between mouse embryonic (E13) and adult testis. Shifting score and corrected K–S <italic>P</italic>-value are denoted.</p>
        </caption>
        <graphic xlink:href="gkv054fig5"/>
      </fig>
      <p>Shifting score reflects the degree of spatial separation in TSS usage within a promoter. However, it does not show the statistical significance of the observed difference. To address this, <italic>CAGEr</italic> tests the significance of the difference between the two cumulatives of the CAGE signal along the promoter using the Kolmogorov–Smirnov (K–S) test. For each promoter, the maximal difference between the two empirical distribution functions describing cumulative CAGE signal in the two different samples corresponds to the K–S statistic (arrow in Figure <xref ref-type="fig" rid="F5">5a</xref>), which is used to derive the probability that the two CAGE signals at that promoter are drawn from the same distribution (<italic>P</italic>-value). In addition to capturing clear spatial separation characterized by a high shifting score (Figure <xref ref-type="fig" rid="F5">5c</xref>), significant <italic>P</italic>-value also identifies more complex patterns of differential TSS usage intertwined within the same region, such as partial TSS gain or loss that leads to narrowing or broadening of the promoter (Supplementary Figure S6). By combining shifting score with K–S <italic>P</italic>-value, different types of differential TSS usage can be distinguished.</p>
      <p>Applying this approach to a previously uncharacterized set of mouse testis CAGE samples revealed extensive promoter shifting detected mainly between early embryonic and adult testis (Figure <xref ref-type="fig" rid="F5">5b</xref>), and identified hundreds of promoters differentially used in the two regulatory environments (Supplementary Table S2). This switch in the promoter usage happened between the neonate days 10 and 20 (Figure <xref ref-type="fig" rid="F5">5b</xref>, Supplementary Figure S6) and corresponded to the transcriptional activation of a large set of genes involved in spermatogenesis (Figure <xref ref-type="fig" rid="F4">4a</xref>), suggesting major changes in the regulatory environment during spermatogenesis that might be driving promoter shifting. Once a reliable set of differentially used promoters is obtained, they can be further dissected and analysed to establish the underlying sequence and chromatin features directing TSS choice in different contexts (<xref rid="B21" ref-type="bibr">21</xref>).</p>
    </sec>
    <sec id="SEC3-7">
      <title>Resources of precise TSS data accessible through <italic>CAGEr</italic></title>
      <p>Several large collections of CAGE data have been published, including ENCODE data for multiple common human cell lines (<xref rid="B19" ref-type="bibr">19</xref>), and recent FANTOM5 collection covering vast majority of primary cells and tissues in human and mouse (<xref rid="B11" ref-type="bibr">11</xref>). Despite being a valuable resource of precise and context-specific TSSs, these data are not yet widely used, due to CAGE being less common than some other genome-wide experiments and due to a lack of comprehensive workflows that would integrate easy access to a user-friendly format of the data with methods for its processing and visualization. To address this, we have collected majority of previously published CAGE datasets into R data packages. These include numerous samples for common cell lines from ENCODE (<xref rid="B19" ref-type="bibr">19</xref>), for human and mouse tissues from previous FANTOM projects (<xref rid="B8" ref-type="bibr">8</xref>–<xref rid="B10" ref-type="bibr">10</xref>) and for zebrafish developmental time-course from our previous work (<xref rid="B20" ref-type="bibr">20</xref>) (Table <xref ref-type="table" rid="tbl2">2</xref>). The most recent FANTOM5 collection (<xref rid="B11" ref-type="bibr">11</xref>) is too vast to distribute as a data package, so we have implemented direct query and retrieval of individual TSS sets for selected samples from the FANTOM5 web resource. All these resources are easily accessible with only a few commands in <italic>CAGEr</italic> and can be included directly into the provided workflow (R code examples in Supplementary Methods), greatly increasing the accessibility of precise TSS data for integrative analyses in R.</p>
      <table-wrap id="tbl2" position="float">
        <label>Table 2.</label>
        <caption>
          <title>Resources of CAGE-detected TSSs accessible directly from within <italic>CAGEr</italic></title>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Resource</th>
              <th align="left" rowspan="1" colspan="1">Type</th>
              <th align="left" rowspan="1" colspan="1">Organism</th>
              <th align="left" rowspan="1" colspan="1">Sample type</th>
              <th align="left" rowspan="1" colspan="1">Nr. samples</th>
              <th align="left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">FANTOM5</td>
              <td align="left" rowspan="1" colspan="1">online resource</td>
              <td align="left" rowspan="1" colspan="1">human</td>
              <td align="left" rowspan="1" colspan="1">cell lines, primary cells, tissues</td>
              <td align="left" rowspan="1" colspan="1">988</td>
              <td align="left" rowspan="1" colspan="1">(<xref rid="B11" ref-type="bibr">11</xref>)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">mouse</td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">395</td>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">FANTOM3 and 4</td>
              <td align="left" rowspan="1" colspan="1">R data package</td>
              <td align="left" rowspan="1" colspan="1">human</td>
              <td align="left" rowspan="1" colspan="1">tissues, time-courses</td>
              <td align="left" rowspan="1" colspan="1">100</td>
              <td align="left" rowspan="1" colspan="1">(<xref rid="B8" ref-type="bibr">8</xref>–<xref rid="B10" ref-type="bibr">10</xref>)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">mouse</td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">83</td>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">ENCODE</td>
              <td align="left" rowspan="1" colspan="1">R data package</td>
              <td align="left" rowspan="1" colspan="1">human</td>
              <td align="left" rowspan="1" colspan="1">cell lines</td>
              <td align="left" rowspan="1" colspan="1">132</td>
              <td align="left" rowspan="1" colspan="1">(<xref rid="B19" ref-type="bibr">19</xref>)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">fruit fly</td>
              <td align="left" rowspan="1" colspan="1">whole embryo</td>
              <td align="left" rowspan="1" colspan="1">1</td>
              <td align="left" rowspan="1" colspan="1">(<xref rid="B6" ref-type="bibr">6</xref>)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Zebrafish development</td>
              <td align="left" rowspan="1" colspan="1">R data package</td>
              <td align="left" rowspan="1" colspan="1">zebrafish</td>
              <td align="left" rowspan="1" colspan="1">developmental time-course</td>
              <td align="left" rowspan="1" colspan="1">12</td>
              <td align="left" rowspan="1" colspan="1">(<xref rid="B20" ref-type="bibr">20</xref>)</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Unlike annotations from RefSeq and Ensembl, which are still the commonly used reference for various promoter-centred analyses, CAGE data provides more precise and context-specific TSS information. This data is both of superior resolution and often significantly different from annotated TSS sets (Figure <xref ref-type="fig" rid="F6">6a</xref>), and provides additional layers of information about promoter width and architecture that can be integrated into analysis (Figure <xref ref-type="fig" rid="F6">6b</xref>, <xref ref-type="fig" rid="F6">c</xref>). We believe that these precise and context-specific TSS data should be used instead of RefSeq and similar annotations wherever possible to increase the resolution and functional relevance of promoter-centred analyses. Precise TSSs can reveal spatial constraints and subtle patterns in sequence and chromatin features of promoters as demonstrated by the 10 bp periodicity in WW dinucleotide frequency starting ∼50 bp downstream of the dominant TSS in broad promoters in adult mouse testis and indicating intra-nucleosomal positioning signal (<xref rid="B32" ref-type="bibr">32</xref>), which is missed by using RefSeq annotation (Figure <xref ref-type="fig" rid="F6">6c</xref>).</p>
      <fig id="F6" position="float">
        <label>Figure 6.</label>
        <caption>
          <p>Comparison between annotated TSS and CAGE. (<bold>a</bold>) Distance between annotated RefSeq TSS and dominant TSS of the closest CAGE tag cluster in adult mouse testis. Promoters have been separated into sharp and broad class based on their interquantile width as shown in Figure <xref ref-type="fig" rid="F3">3b</xref>. (<bold>b</bold>) Non-methylated DNA signal (data from (<xref rid="B24" ref-type="bibr">24</xref>)) at promoters sorted by interquantile width and centred at CAGE dominant TSS. Broad promoters are associated with broader non-methylated regions and the level of non-methylation increases with promoter width. (<bold>c</bold>) Frequency of AA/AT/TA/TT dinucleotides around sharp and broad promoters centred at CAGE dominant TSS (top) or RefSeq annotated TSS (bottom). Magnified view of the signal in the region 50–200 bp downstream of the TSS is shown in the inset and demonstrates the 10 bp periodicity linked to nucleosome positioning (<xref rid="B32" ref-type="bibr">32</xref>) in broad promoters. Unlike RefSeq annotation, CAGE allows separation of sharp and broad promoters (Figure <xref ref-type="fig" rid="F3">3b</xref>) and adds precision into promoter-centred analysis revealing subtle sequence patterns in different classes of promoters.</p>
        </caption>
        <graphic xlink:href="gkv054fig6"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>DISCUSSION</title>
    <p>CAGE data represents resource of precise and context-specific TSSs widely applicable in various approaches, from computational genome-wide analyses to designing constructs for transgenesis. Here we introduced <italic>CAGEr</italic>, a comprehensive R/Bioconductor software package that implements various methods for CAGE data processing and promoterome mining and allows construction of a high-resolution, context-specific promoterome through a well-documented and user-friendly workflow. The package further introduces novel approaches for analysing promoter structure and dynamics, which provide additional layers of information, allowing classification of promoters and correlation of promoter features with other genome-wide data.</p>
    <p>One of the key functionalities implemented in <italic>CAGEr</italic> is the robust assessment of promoter width—a feature that distinguishes different functional classes of promoters (<xref rid="B2" ref-type="bibr">2</xref>,<xref rid="B6" ref-type="bibr">6</xref>,<xref rid="B12" ref-type="bibr">12</xref>). The application and functional relevance of promoter interquantile width has been corroborated in several recent studies, which revealed different sequence signature and nucleosome positioning associated with sharp and broad promoters across numerous human and mouse cell types (<xref rid="B11" ref-type="bibr">11</xref>), as well as differential usage of these promoter types during zebrafish embryonic development (<xref rid="B20" ref-type="bibr">20</xref>). Furthermore, we have shown recently that promoter width is not an inherent property of the genomic locus, but is rather dependent on the regulatory context that drives the expression in the given cell type or condition, as demonstrated by the global change in the architecture of ubiquitously expressed promoters during maternal to zygotic transition in zebrafish (<xref rid="B21" ref-type="bibr">21</xref>). This highlights the need for the context-specific promoter width assessment.</p>
    <p>Selection of individual TSSs within promoter region is context-dependent (<xref rid="B16" ref-type="bibr">16</xref>,<xref rid="B21" ref-type="bibr">21</xref>) and <italic>CAGEr</italic> can be used to detect differential promoter usage between different samples. In our recent study, we used the shifting score-based approach to successfully decouple two independent transcription initiation codes that overlap on thousands of core promoters and produce different readouts from the same promoter during maternal to zygotic transition in zebrafish (<xref rid="B21" ref-type="bibr">21</xref>). Here we introduce an implementation of this approach expanded with a method for assessing statistical significance and demonstrate its applicability to mouse testis developmental CAGE data revealing extensive differential TSS usage between mouse embryonic and adult testis. This enables further exploration of sequence, chromatin, transcription factor binding or any other feature that might be driving differential TSS choice.</p>
    <p>Most importantly, <italic>CAGEr</italic> and accompanying data packages provide easy access to majority of publicly available CAGE datasets for numerous samples from several organisms in the form that can be easily integrated with other genome-wide data. These include large TSS collections for human and mouse derived from ENCODE (<xref rid="B19" ref-type="bibr">19</xref>) and FANTOM (<xref rid="B11" ref-type="bibr">11</xref>) CAGE data, as well as smaller TSS datasets for zebrafish (<xref rid="B20" ref-type="bibr">20</xref>) and fruit fly (<xref rid="B6" ref-type="bibr">6</xref>). Direct access to these precise TSS data that can be easily included into the <italic>CAGEr</italic> workflow combined with the comprehensive promoter mining functionality provided in the package, present a very powerful tool that can improve the resolution of any TSS-centred analysis. Precise TSSs are crucial for investigating spatial constraints between transcription initiation and sequence motifs or epigenetic modifications in core promoters (<xref rid="B11" ref-type="bibr">11</xref>,<xref rid="B21" ref-type="bibr">21</xref>) and are particularly important when analysing high-resolution data such as bisulphite sequencing or single nucleotide polymorphisms.</p>
  </sec>
  <sec id="SEC5">
    <title>AVAILABILITY</title>
    <p><italic>CAGEr</italic> package is free open-source software distributed through Bioconductor and both source code and executables are available at <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/release/bioc/html/CAGEr.html">http://www.bioconductor.org/packages/release/bioc/html/CAGEr.html</ext-link>. <italic>FANTOM3and4</italic> data package is also distributed through Bioconductor at <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/release/data/experiment/html/FANTOM3and4CAGE.html">http://www.bioconductor.org/packages/release/data/experiment/html/FANTOM3and4CAGE.html</ext-link>. <italic>ENCODEprojectCAGE</italic> and <italic>ZebrafishDevelopmentalCAGE</italic> data packages are freely available from authors’ website at <ext-link ext-link-type="uri" xlink:href="http://promshift.genereg.net/CAGEr/PackageSource/">http://promshift.genereg.net/CAGEr/PackageSource/</ext-link>. All packages are fully documented and accompanied by detailed user guides available at <ext-link ext-link-type="uri" xlink:href="http://promshift.genereg.net/CAGEr/Vignettes/">http://promshift.genereg.net/CAGEr/Vignettes/</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material" id="SEC6">
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/lookup/suppl/doi:10.1093/nar/gkv054/-/DC1">Supplementary Data</ext-link> are available at NAR Online.</p>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>SUPPLEMENTARY DATA</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_43_8_e51__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_gkv054_nar-03623-met-k-2014-File008.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_gkv054_nar-03623-met-k-2014-File009.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="vnd.ms-excel" xlink:href="supp_gkv054_nar-03623-met-k-2014-File010.xlsx"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec id="SEC7">
    <title>FUNDING</title>
    <p>Norwegian Research Council (YFF); Bergen Research Foundation (BFS); European Union (EU) FP6 integrated project EuTRACC; FP7 integrated project ZF Health; Medical Research Council UK (to B.L); Research Grants from Ministry of Education, Culture, Sports, Science and Technology in Japan to RIKEN Center for Life Science Technologies and to RIKEN Preventive Medicine and Diagnosis Innovation Program (to Y.H., P.C. and A.R.R.F.). The open access publication charge for this paper has been waived by Oxford University Press—NAR Editorial Board members are entitled to one free paper per year in recognition of their work on behalf of the journal.</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smale</surname>
            <given-names>S.T.</given-names>
          </name>
          <name>
            <surname>Kadonaga</surname>
            <given-names>J.T.</given-names>
          </name>
        </person-group>
        <article-title>The RNA polymerase II core promoter</article-title>
        <source>Annu. Rev. Biochem.</source>
        <year>2003</year>
        <volume>72</volume>
        <fpage>449</fpage>
        <lpage>479</lpage>
        <pub-id pub-id-type="pmid">12651739</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carninci</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Sandelin</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Lenhard</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Katayama</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Shimokawa</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Ponjavic</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Semple</surname>
            <given-names>C.A.M.</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>M.S.</given-names>
          </name>
          <name>
            <surname>Engström</surname>
            <given-names>P.G.</given-names>
          </name>
          <name>
            <surname>Frith</surname>
            <given-names>M.C.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide analysis of mammalian promoter architecture and evolution</article-title>
        <source>Nat. Genet.</source>
        <year>2006</year>
        <volume>38</volume>
        <fpage>626</fpage>
        <lpage>635</lpage>
        <pub-id pub-id-type="pmid">16645617</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Suzuki</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Taira</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Tsunoda</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Mizushima-Sugano</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Sese</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Hata</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Ota</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Isogai</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Tanaka</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Morishita</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Diverse transcriptional initiation revealed by fine, large-scale mapping of mRNA start sites</article-title>
        <source>EMBO Rep.</source>
        <year>2001</year>
        <volume>2</volume>
        <fpage>388</fpage>
        <lpage>393</lpage>
        <pub-id pub-id-type="pmid">11375929</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shiraki</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Kondo</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Katayama</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Waki</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Kasukawa</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Kawaji</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Kodzius</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Watahiki</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Nakamura</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Arakawa</surname>
            <given-names>T.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cap analysis gene expression for high-throughput analysis of transcriptional starting point and identification of promoter usage</article-title>
        <source>Proc. Natl. Acad. Sci. U.S.A.</source>
        <year>2003</year>
        <volume>100</volume>
        <fpage>15776</fpage>
        <lpage>15781</lpage>
        <pub-id pub-id-type="pmid">14663149</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Hoon</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Hayashizaki</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>Deep cap analysis gene expression (CAGE): genome-wide identification of promoters, quantification of their expression, and network inference</article-title>
        <source>Biotechniques</source>
        <year>2008</year>
        <volume>44</volume>
        <fpage>627</fpage>
        <lpage>632</lpage>
        <pub-id pub-id-type="pmid">18474037</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoskins</surname>
            <given-names>R.A.</given-names>
          </name>
          <name>
            <surname>Landolin</surname>
            <given-names>J.M.</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>J.B.</given-names>
          </name>
          <name>
            <surname>Sandler</surname>
            <given-names>J.E.</given-names>
          </name>
          <name>
            <surname>Takahashi</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Lassmann</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Booth</surname>
            <given-names>B.W.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>K.H.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide analysis of promoter architecture in Drosophila melanogaster</article-title>
        <source>Genome Res.</source>
        <year>2011</year>
        <volume>21</volume>
        <fpage>182</fpage>
        <lpage>192</lpage>
        <pub-id pub-id-type="pmid">21177961</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Valen</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Pascarella</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Chalk</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Maeda</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Kojima</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Kawazu</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Murata</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Nishiyori</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Lazarevic</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Motti</surname>
            <given-names>D.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide detection and analysis of hippocampus core promoters using DeepCAGE</article-title>
        <source>Genome Res.</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>255</fpage>
        <lpage>265</lpage>
        <pub-id pub-id-type="pmid">19074369</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>FANTOM Consortium</collab>
          <name>
            <surname>Suzuki</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Forrest</surname>
            <given-names>A.R.R.</given-names>
          </name>
          <name>
            <surname>van Nimwegen</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Daub</surname>
            <given-names>C.O.</given-names>
          </name>
          <name>
            <surname>Balwierz</surname>
            <given-names>P.J.</given-names>
          </name>
          <name>
            <surname>Irvine</surname>
            <given-names>K.M.</given-names>
          </name>
          <name>
            <surname>Lassmann</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Ravasi</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Hasegawa</surname>
            <given-names>Y.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The transcriptional network that controls growth arrest and differentiation in a human myeloid leukemia cell line</article-title>
        <source>Nat. Genet.</source>
        <year>2009</year>
        <volume>41</volume>
        <fpage>553</fpage>
        <lpage>562</lpage>
        <pub-id pub-id-type="pmid">19377474</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <collab>The FANTOM Consortium and RIKEN Genome Exploration Research Group and Genome Science Group</collab>
        <article-title>The transcriptional landscape of the mammalian genome</article-title>
        <source>Science</source>
        <year>2005</year>
        <volume>309</volume>
        <fpage>1559</fpage>
        <lpage>1563</lpage>
        <pub-id pub-id-type="pmid">16141072</pub-id>
      </element-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Faulkner</surname>
            <given-names>G.J.</given-names>
          </name>
          <name>
            <surname>Kimura</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Daub</surname>
            <given-names>C.O.</given-names>
          </name>
          <name>
            <surname>Wani</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Plessy</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Irvine</surname>
            <given-names>K.M.</given-names>
          </name>
          <name>
            <surname>Schroder</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Cloonan</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Steptoe</surname>
            <given-names>A.L.</given-names>
          </name>
          <name>
            <surname>Lassmann</surname>
            <given-names>T.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The regulated retrotransposon transcriptome of mammalian cells</article-title>
        <source>Nat. Genet.</source>
        <year>2009</year>
        <volume>41</volume>
        <fpage>563</fpage>
        <lpage>571</lpage>
        <pub-id pub-id-type="pmid">19377475</pub-id>
      </element-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <collab>The FANTOM Consortium and the RIKEN PMI and CLST (DGT)</collab>
        <article-title>A promoter-level mammalian expression atlas</article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>507</volume>
        <fpage>462</fpage>
        <lpage>470</lpage>
        <pub-id pub-id-type="pmid">24670764</pub-id>
      </element-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lenhard</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Sandelin</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Carninci</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>Metazoan promoters: emerging characteristics and insights into transcriptional regulation</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>233</fpage>
        <lpage>245</lpage>
        <pub-id pub-id-type="pmid">22392219</pub-id>
      </element-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andersson</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Gebhard</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Miguel-Escalada</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Hoof</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Bornholdt</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Boyd</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Schmidl</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Suzuki</surname>
            <given-names>T.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An atlas of active enhancers across human cell types and tissues</article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>507</volume>
        <fpage>455</fpage>
        <lpage>461</lpage>
        <pub-id pub-id-type="pmid">24670763</pub-id>
      </element-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frith</surname>
            <given-names>M.C.</given-names>
          </name>
          <name>
            <surname>Valen</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Krogh</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Hayashizaki</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Carninci</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Sandelin</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>A code for transcription initiation in mammalian genomes</article-title>
        <source>Genome Res.</source>
        <year>2007</year>
        <volume>18</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="pmid">18032727</pub-id>
      </element-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Balwierz</surname>
            <given-names>P.J.</given-names>
          </name>
          <name>
            <surname>Carninci</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Daub</surname>
            <given-names>C.O.</given-names>
          </name>
          <name>
            <surname>Kawai</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Hayashizaki</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Van Belle</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Beisel</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>van Nimwegen</surname>
            <given-names>E.</given-names>
          </name>
        </person-group>
        <article-title>Methods for analyzing deep sequencing expression data: constructing the human and mouse promoterome with deepCAGE data</article-title>
        <source>Genome Biol.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R79</fpage>
        <pub-id pub-id-type="pmid">19624849</pub-id>
      </element-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kawaji</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Frith</surname>
            <given-names>M.C.</given-names>
          </name>
          <name>
            <surname>Katayama</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Sandelin</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Kai</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Kawai</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Carninci</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Hayashizaki</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>Dynamic usage of transcription start sites within core promoters</article-title>
        <source>Genome Biol.</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>R118</fpage>
        <pub-id pub-id-type="pmid">17156492</pub-id>
      </element-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dimont</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Ho Sui</surname>
            <given-names>S.J.</given-names>
          </name>
          <name>
            <surname>Forrest</surname>
            <given-names>A.R.R.</given-names>
          </name>
          <name>
            <surname>Kawaji</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Hide</surname>
            <given-names>W.</given-names>
          </name>
          <collab>the FANTOM Consortium</collab>
        </person-group>
        <article-title>CAGExploreR: an R package for the analysis and visualization of promoter dynamics across multiple experiments</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>1183</fpage>
        <lpage>1184</lpage>
      </element-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ohmiya</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Vitezic</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Frith</surname>
            <given-names>M.C.</given-names>
          </name>
          <name>
            <surname>Itoh</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Carninci</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Forrest</surname>
            <given-names>A.R.R.</given-names>
          </name>
          <name>
            <surname>Hayashizaki</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Lassmann</surname>
            <given-names>T.</given-names>
          </name>
          <collab>the FANTOM Consortium</collab>
        </person-group>
        <article-title>RECLU: a pipeline to discover reproducible transcriptional start sites and their alternative regulation using capped analysis of gene expression (CAGE)</article-title>
        <source>BMC Genomics</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>R269</fpage>
      </element-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Djebali</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>C.A.</given-names>
          </name>
          <name>
            <surname>Merkel</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Dobin</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Lassmann</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Mortazavi</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Tanzer</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Lagarde</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Schlesinger</surname>
            <given-names>F.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Landscape of transcription in human cells</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>488</volume>
        <fpage>101</fpage>
        <lpage>108</lpage>
        <pub-id pub-id-type="pmid">22955620</pub-id>
      </element-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nepal</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Hadzhiev</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Previti</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Haberle</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Takahashi</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Suzuki</surname>
            <given-names>A.M.M.</given-names>
          </name>
          <name>
            <surname>Sheng</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Abdelhamid</surname>
            <given-names>R.F.</given-names>
          </name>
          <name>
            <surname>Anand</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dynamic regulation of the transcription initiation landscape at single nucleotide resolution during vertebrate embryogenesis</article-title>
        <source>Genome Res.</source>
        <year>2013</year>
        <volume>23</volume>
        <fpage>1938</fpage>
        <lpage>1950</lpage>
        <pub-id pub-id-type="pmid">24002785</pub-id>
      </element-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haberle</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Hadzhiev</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Plessy</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Previti</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Nepal</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Gehrig</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Akalin</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Suzuki</surname>
            <given-names>A.M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Two independent transcription initiation codes overlap on vertebrate core promoters</article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>507</volume>
        <fpage>381</fpage>
        <lpage>385</lpage>
        <pub-id pub-id-type="pmid">24531765</pub-id>
      </element-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <element-citation publication-type="book">
        <collab>The R Development Core Team</collab>
        <source>R: A Language and Environment for Statistical Computing</source>
        <year>2014</year>
        <publisher-loc>Vienna</publisher-loc>
        <publisher-name>R foundation for statistical computing</publisher-name>
        <fpage>1</fpage>
        <lpage>3079</lpage>
      </element-citation>
    </ref>
    <ref id="B23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gentleman</surname>
            <given-names>R.C.</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>V.J.</given-names>
          </name>
          <name>
            <surname>Bates</surname>
            <given-names>D.M.</given-names>
          </name>
          <name>
            <surname>Bolstad</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Dettling</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Ellis</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Gautier</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Ge</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Gentry</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bioconductor: open software development for computational biology and bioinformatics</article-title>
        <source>Genome Biol.</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>R80</fpage>
        <pub-id pub-id-type="pmid">15461798</pub-id>
      </element-citation>
    </ref>
    <ref id="B24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Long</surname>
            <given-names>H.K.</given-names>
          </name>
          <name>
            <surname>Sims</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Heger</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Blackledge</surname>
            <given-names>N.P.</given-names>
          </name>
          <name>
            <surname>Kutter</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>M.L.</given-names>
          </name>
          <name>
            <surname>Grützner</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Odom</surname>
            <given-names>D.T.</given-names>
          </name>
          <name>
            <surname>Patient</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Ponting</surname>
            <given-names>C.P.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Epigenetic conservation at gene regulatory elements revealed by non-methylated DNA profiling in seven vertebrates</article-title>
        <source>Elife</source>
        <year>2013</year>
        <volume>2</volume>
        <fpage>e00348</fpage>
        <pub-id pub-id-type="pmid">23467541</pub-id>
      </element-citation>
    </ref>
    <ref id="B25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mathelier</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>A.W.</given-names>
          </name>
          <name>
            <surname>Parcy</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Worsley-Hunt</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Arenillas</surname>
            <given-names>D.J.</given-names>
          </name>
          <name>
            <surname>Buchman</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>C.-Y.</given-names>
          </name>
          <name>
            <surname>Chou</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Ienasescu</surname>
            <given-names>H.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>JASPAR 2014: an extensively expanded and updated open-access database of transcription factor binding profiles</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2014</year>
        <volume>42</volume>
        <fpage>D142</fpage>
        <lpage>D147</lpage>
        <pub-id pub-id-type="pmid">24194598</pub-id>
      </element-citation>
    </ref>
    <ref id="B26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harbers</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Carninci</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>Tag-based approaches for transcriptome research and genome annotation</article-title>
        <source>Nat. Methods</source>
        <year>2005</year>
        <volume>2</volume>
        <fpage>495</fpage>
        <lpage>502</lpage>
        <pub-id pub-id-type="pmid">15973418</pub-id>
      </element-citation>
    </ref>
    <ref id="B27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shimokawa</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Okamura-Oho</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Kurita</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Frith</surname>
            <given-names>M.C.</given-names>
          </name>
          <name>
            <surname>Kawai</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Carninci</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Hayashizaki</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>Large-scale clustering of CAGE tag expression data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>161</fpage>
        <pub-id pub-id-type="pmid">17517134</pub-id>
      </element-citation>
    </ref>
    <ref id="B28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W.</given-names>
          </name>
        </person-group>
        <article-title>Differential expression analysis for sequence count data</article-title>
        <source>Genome Biol.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R106</fpage>
        <pub-id pub-id-type="pmid">20979621</pub-id>
      </element-citation>
    </ref>
    <ref id="B29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>M.D.</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>D.J.</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>G.K.</given-names>
          </name>
        </person-group>
        <article-title>edgeR: a bioconductor package for differential expression analysis of digital gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>26</volume>
        <fpage>139</fpage>
        <lpage>140</lpage>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="B30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Toronen</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Kolehmainen</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Castren</surname>
            <given-names>E.</given-names>
          </name>
        </person-group>
        <article-title>Analysis of gene expression data using self-organizing maps</article-title>
        <source>FEBS Lett.</source>
        <year>1999</year>
        <volume>451</volume>
        <fpage>142</fpage>
        <lpage>146</lpage>
        <pub-id pub-id-type="pmid">10371154</pub-id>
      </element-citation>
    </ref>
    <ref id="B31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kampstra</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>Beanplot: a boxplot alternative for visual comparison of distributions</article-title>
        <source>J. Stat. Softw.</source>
        <year>2008</year>
        <volume>28</volume>
        <fpage>1</fpage>
        <lpage>9</lpage>
      </element-citation>
    </ref>
    <ref id="B32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segal</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Fondufe-Mittendorf</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Thåström</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Field</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>I.K.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J.-P.Z.</given-names>
          </name>
          <name>
            <surname>Widom</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>A genomic code for nucleosome positioning</article-title>
        <source>Nature</source>
        <year>2006</year>
        <volume>442</volume>
        <fpage>772</fpage>
        <lpage>778</lpage>
        <pub-id pub-id-type="pmid">16862119</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
