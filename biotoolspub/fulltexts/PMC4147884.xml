<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4147884</article-id>
    <article-id pub-id-type="pmid">24794932</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btu311</article-id>
    <article-id pub-id-type="publisher-id">btu311</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="heading">
          <subject>Data and Text Mining</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Bioclojure: a functional library for the manipulation of biological sequences</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Plieskatt</surname>
          <given-names>Jordan</given-names>
        </name>
        <xref ref-type="aff" rid="btu311-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btu311-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rinaldi</surname>
          <given-names>Gabriel</given-names>
        </name>
        <xref ref-type="aff" rid="btu311-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btu311-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Brindley</surname>
          <given-names>Paul J.</given-names>
        </name>
        <xref ref-type="aff" rid="btu311-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btu311-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jia</surname>
          <given-names>Xinying</given-names>
        </name>
        <xref ref-type="aff" rid="btu311-AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Potriquet</surname>
          <given-names>Jeremy</given-names>
        </name>
        <xref ref-type="aff" rid="btu311-AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bethony</surname>
          <given-names>Jeffrey</given-names>
        </name>
        <xref ref-type="aff" rid="btu311-AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mulvenna</surname>
          <given-names>Jason</given-names>
        </name>
        <xref ref-type="aff" rid="btu311-AFF1">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="btu311-AFF1">
          <sup>4</sup>
        </xref>
        <xref ref-type="corresp" rid="btu311-COR1">*</xref>
      </contrib>
      <aff id="btu311-AFF1"><sup>1</sup>Department of Microbiology, Immunology and Tropical Medicine, <sup>2</sup>Research Center for Neglected Diseases of Poverty, School of Medicine and Health Sciences, George Washington University, Washington, DC, 20052, USA, <sup>3</sup>QIMR Berghofer Medical Research Institute, Infectious Disease and Cancer and <sup>4</sup>The University of Queensland, School of Biomedical Sciences, Brisbane, Queensland, 4072, Australia</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btu311-COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="FN1">
        <p>Associate Editor: Jonathan Wren</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>9</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>02</day>
      <month>5</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>02</day>
      <month>5</month>
      <year>2014</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>30</volume>
    <issue>17</issue>
    <fpage>2537</fpage>
    <lpage>2539</lpage>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>1</month>
        <year>2014</year>
      </date>
      <date date-type="rev-recd">
        <day>4</day>
        <month>4</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>4</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2014. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/3.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/3.0/">http://creativecommons.org/licenses/by/3.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> BioClojure is an open-source library for the manipulation of biological sequence data written in the language Clojure. BioClojure aims to provide a functional framework for the processing of biological sequence data that provides simple mechanisms for concurrency and lazy evaluation of large datasets.</p>
      <p><bold>Results:</bold> BioClojure provides parsers and accessors for a range of biological sequence formats, including UniProtXML, Genbank XML, FASTA and FASTQ. In addition, it provides wrappers for key analysis programs, including BLAST, SignalP, TMHMM and InterProScan, and parsers for analyzing their output. All interfaces leverage Clojure’s functional style and emphasize laziness and composability, so that BioClojure, and user-defined, functions can be chained into simple pipelines that are thread-safe and seamlessly integrate lazy evaluation.</p>
      <p><bold>Availability and implementation:</bold> BioClojure is distributed under the Lesser GPL, and the source code is freely available from GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/s312569/clj-biosequence">https://github.com/s312569/clj-biosequence</ext-link>).</p>
      <p><bold>Contact:</bold><email>jason.mulvenna@qimrberghofer.edu.au</email> or <email>jason.mulvenna@qimr.edu.au</email></p>
    </abstract>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 INTRODUCTION</title>
    <p>Functional programming is a programming style that treats computation as the evaluation of mathematical functions (<xref rid="btu311-B5" ref-type="bibr">Hudak, 1989</xref>). In its purest form, functional programming removes the need for variable assignment by using immutable data structures that eliminate the use of state and side effects (<xref rid="btu311-B1" ref-type="bibr">Backus, 1978</xref>). This ensures that functions will always return the same value given the same input. This greatly simplifies debugging and testing, as individual functions can be assessed in isolation regardless of a global state. Immutability also greatly simplifies concurrency and facilitates leveraging of multi-core computing facilities with little or no modifications to functionally written code. Accordingly, as a programming style, functional programming offers advantages for software development, including (i) brevity, (ii) simple handling of concurrency and (iii) seamless integration of lazy evaluation, simplifying the handling of large datasets. Clojure is a Lisp variant that encourages a functional style of programming by providing immutable data structures, functions as first-class objects and uses recursive iteration as opposed to state-based looping (<xref rid="btu311-B4" ref-type="bibr">Hickey, 2008</xref>). Clojure is built on the Java virtual machine (JVM), and thus, applications developed using BioClojure can be compiled into Java byte code and ran on any platform that runs the JVM. Moreover, libraries constructed using Clojure can be called in Java programs and, conversely, Java classes and methods can be called from Clojure programs, making available a large number of third-party Java libraries. BioClojure aims to leverage the tools provided by Clojure to provide a functional interface with biological sequence data and associated programs. BioClojure is similar in intent to other bioinformatics packages such as BioPerl (<xref rid="btu311-B7" ref-type="bibr">Stajich <italic>et al.</italic>, 2002</xref>), BioPython (<xref rid="btu311-B2" ref-type="bibr">Cock <italic>et al.</italic>, 2009</xref>), Bio++ (<xref rid="btu311-B3" ref-type="bibr">Dutheil <italic>et al.</italic>, 2006</xref>) and BioJava (<xref rid="btu311-B6" ref-type="bibr">Prlić <italic>et al.</italic>, 2012</xref>) but differs from these bioinformatics software libraries in its embrace of the functional style. With the decreasing cost of biological analyses, for example, next-generation sequencing, biologists are dealing with greater amounts of data, and BioClojure is an attempt to provide tools, emphasizing concurrency and lazy evaluation, for manipulating these data.</p>
  </sec>
  <sec>
    <title>2 METHODS</title>
    <p>BioClojure source code and extensive documentation are available via GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/s312569/clj-biosequence">https://github.com/s312569/clj-biosequence</ext-link>). The library is available as a Java jar file from Clojars (<ext-link ext-link-type="uri" xlink:href="https://clojars.org/clj-biosequence">https://clojars.org/clj-biosequence</ext-link>) and can be easily incorporated into Clojure projects using lein (<ext-link ext-link-type="uri" xlink:href="http://leiningen.org/">http://leiningen.org/</ext-link>). BioClojure is organized into name-spaces (modules), each either providing access to a particular sequence format, providing a wrapper to key programs, BLAST and SignalP, or providing other functionality, for example, indexing and biological alphabets. When designing functions contained within BioClojure, efforts have been made to maintain laziness and composability. This, in combination with the Clojure threading macros, facilitates the construction of analysis pipelines that can process sizeable files using minimal memory.</p>
    <sec id="SEC2.1">
      <title>2.1 The core module</title>
      <p>The core module provides core functions such as DNA and protein alphabets as well as translation, key accessors and file functions. More importantly, it establishes a framework for parsing sequence files using the functions ‘bs-reader’ and ‘biosequence-seq’. Almost every module in BioClojure implements these functions to access its particular sequence format or type of data. When used in combination with the in-built Clojure macro ‘with-open’, these functions provide lazy access to on-disk data. For example, a simple pipeline to translate a file of nucleotide sequences in six-reading frames would use these functions in the following way:
<list list-type="simple"><list-item><p><monospace>user&gt; (with-open [r (bs-reader </monospace><monospace>fasta-file</monospace><monospace>)]</monospace></p></list-item><list-item><p><monospace> </monospace><monospace>    (-&gt;&gt; (biosequence-seq r)</monospace></p></list-item><list-item><p><monospace> </monospace><monospace> </monospace>  <monospace>    (mapcat #(six-frame-translation %))</monospace></p></list-item><list-item><p><monospace> </monospace><monospace> </monospace><monospace>      realized?))</monospace></p></list-item><list-item><p><monospace>false</monospace></p></list-item></list>
</p>
      <p>This code provides a lazy sequence of FASTA protein sequences representing the six-frame translation of nucleotide sequences from ‘FASTA-file’. The final call to ‘realized?’ merely illustrates the lazy nature of the calculation. The resulting sequences can be sent to the file using the BioClojure function ‘biosequence-&gt;file’ or further processed using BioClojure and/or user-defined functions. The use of immutable objects and stateless iteration can lead to simple and easily understandable code. A simple example of this is the following code, which returns counts for biological process GO terms from secreted proteins in the UniProt Human proteome dataset:
<list list-type="simple"><list-item><p><monospace>(with-open [r (bs-reader up-hs-proteome)]</monospace></p></list-item><list-item><p><monospace>  </monospace><monospace>(-&gt;&gt; (biosequence-seq r)</monospace></p></list-item><list-item><p><monospace> </monospace><monospace>   </monospace><monospace>(filter #(some (fn [x] (=</monospace><monospace> “</monospace><monospace>Secreted</monospace><monospace>”</monospace></p></list-item><list-item><p><monospace> </monospace><monospace> </monospace><monospace> </monospace><monospace> </monospace><monospace>               </monospace><monospace>(:text x)))</monospace></p></list-item><list-item><p><monospace> </monospace><monospace> </monospace><monospace> </monospace>       <monospace>(subcellular-location %)))</monospace></p></list-item><list-item><p><monospace> </monospace><monospace> </monospace>  <monospace>(mapcat bp-go-terms)</monospace></p></list-item><list-item><p><monospace> </monospace><monospace> </monospace><monospace>  frequencies))</monospace></p></list-item><list-item><p><monospace>{</monospace><monospace>“</monospace><monospace>neurotrophin TRK receptor signaling pathway</monospace><monospace>”</monospace></p></list-item><list-item><p><monospace> </monospace><monospace>36,</monospace><monospace>…</monospace><monospace>.</monospace></p></list-item></list>
</p>
      <p>The defined interfaces of BioClojure are designed to be lazy and composable in this way, and thus, more complex examples of these simple lazily evaluated pipelines can be developed.</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Sequence formats</title>
      <p>At present, BioClojure supports sequence data formatted as Uniprot XML, Genbank XML FASTA and FASTQ. For each format, apart from parsers, BioClojure provides accessors specific to that format (see <ext-link ext-link-type="uri" xlink:href="https://github.com/s312569/clj-biosequence">https://github.com/s312569/clj-biosequence</ext-link> for detailed documentation). BioClojure also provides functions for remote searching and sequence retrieval from UniProt and GenBank. For mapping of identification numbers, BioClojure provides the ‘id-convert’ function that uses the UniProt accession mapping service to convert accession numbers from one database format to another. Integration of diverse file formats with the structure provided by the core module is implemented using Clojure protocols; therefore, implementation of modules for new formats is facile, with additional formats, in particular GFF and GTF, expected to be supported in the near future.</p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 Application wrappers</title>
      <p>In addition to sequence data, BioClojure also provides wrappers for running BLAST, SignalP, THMHH and Interproscan as well as parsers for their output. Once again, integration of these tools with BioClojure emphasizes lazy evaluation and composability, which simplifies integration of the tools with other parts of BioClojure.</p>
    </sec>
    <sec id="SEC2.4">
      <title>2.4 Persistence</title>
      <p>The ‘index’ module provides functions for producing compressed and indexed files. An indexed file implements ‘biosequence-seq’ and thus can be used the same way as described above, but without the requirement for using ‘with-open’ or ‘bs-reader’. Indexed files also provide rapid random access to indexed sequences using the ‘get-biosequence’ function.</p>
    </sec>
    <sec id="SEC2.5">
      <title>2.5 Concurrency</title>
      <p>One of the primary motivations for using Clojure is the built-in support for concurrent operations. One simple example of this support is the ‘pmap’ function. The Clojure function ‘map’ serially applies a function to a list of inputs, returning a list of the outputs, and ‘pmap’ performs the same operations using multiple threads. If the computational cost of the applied function outweighs the coordination costs, significant performance gains are possible, as shown below using the SwissProt database:
<list list-type="simple"><list-item><p><monospace>user&gt; (time (with-open [r (bs-reader swissprot)]</monospace></p></list-item><list-item><p><monospace> </monospace><monospace> </monospace><monospace>   (last (map protein-charge</monospace></p></list-item><list-item><p><monospace> </monospace><monospace> </monospace><monospace> </monospace><monospace>        (biosequence-seq r)))))</monospace></p></list-item><list-item><p><monospace>“</monospace><monospace>Elapsed time: 101232.610534 msecs</monospace><monospace>”</monospace></p></list-item><list-item><p><monospace>5.778330187793381</monospace></p></list-item><list-item><p><monospace>user&gt; (time (with-open [r (bs-reader swissprot)]</monospace></p></list-item><list-item><p><monospace> </monospace><monospace> </monospace><monospace>   (last (pmap protein-charge</monospace></p></list-item><list-item><p><monospace> </monospace><monospace> </monospace><monospace> </monospace><monospace>        (biosequence-seq r)))))</monospace></p></list-item><list-item><p><monospace>“</monospace><monospace>Elapsed time: 30552.548286 msecs</monospace><monospace>”</monospace></p></list-item><list-item><p><monospace>5.778330187793381</monospace></p></list-item></list>
</p>
      <p>In practice, ‘pmap’ initiates a limited number of threads, based on the number of cores; therefore, for large datasets, or asynchronous calls, a finer-grained control over the number of threads and their behavior can be obtained using Clojure’s software transactional memory, agent and atom systems.</p>
    </sec>
  </sec>
  <sec>
    <title>3 CONCLUSION</title>
    <p>BioClojure is a functional software library specifically designed for parsing and processing biological sequence data. It provides a lazy and thread-safe framework for accessing and streaming these data while using minimal amounts of memory. Presently, we extensively use the library for the annotation of nucleotide and peptide sequences arising from next-generation sequencing and the proteomic analysis of complex protein mixtures. We plan to extend the functionality of the library by incorporating modules for phylogenetic and proteomic analyses, and we welcome contributions from the community.</p>
    <p><italic>Funding</italic>: <funding-source>National Health and Medical Research Council, Australia</funding-source> (grant number <award-id>1051627</award-id>), as well as award <award-id>R01CA155297</award-id> from the <funding-source>National Cancer Institute</funding-source>.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
</body>
<back>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="btu311-B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Backus</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Can programming be liberated from the von Neumann style?: a functional style and its algebra of programs</article-title>
        <source>Commun. ACM</source>
        <year>1978</year>
        <volume>21</volume>
        <fpage>613</fpage>
        <lpage>641</lpage>
      </element-citation>
    </ref>
    <ref id="btu311-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cock</surname>
            <given-names>PJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Biopython: freely available Python tools for computational molecular biology and bioinformatics</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1422</fpage>
        <lpage>1423</lpage>
        <pub-id pub-id-type="pmid">19304878</pub-id>
      </element-citation>
    </ref>
    <ref id="btu311-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dutheil</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bio++: a set of C++ libraries for sequence analysis, phylogenetics, molecular evolution and population genetics</article-title>
        <source>BMC Bioinformatics</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>188</fpage>
        <pub-id pub-id-type="pmid">16594991</pub-id>
      </element-citation>
    </ref>
    <ref id="btu311-B4">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Hickey</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>The clojure programming language</article-title>
        <source>Proceedings of the 2008 symposium on Dynamic languages</source>
        <year>2008</year>
        <comment>p.1. ACM, New York, NY</comment>
      </element-citation>
    </ref>
    <ref id="btu311-B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hudak</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Conception, evolution, and application of functional programming languages</article-title>
        <source>ACM Comput. Surv. (CSUR)</source>
        <year>1989</year>
        <volume>21</volume>
        <fpage>359</fpage>
        <lpage>411</lpage>
      </element-citation>
    </ref>
    <ref id="btu311-B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prlić</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Biojava: an open-source framework for bioinformatics in 2012</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>2693</fpage>
        <lpage>2695</lpage>
        <pub-id pub-id-type="pmid">22877863</pub-id>
      </element-citation>
    </ref>
    <ref id="btu311-B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stajich</surname>
            <given-names>JE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The bioperl toolkit: Perl modules for the life sciences</article-title>
        <source>Genome Res.</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>1611</fpage>
        <lpage>1618</lpage>
        <pub-id pub-id-type="pmid">12368254</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
