<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10081868</article-id>
    <article-id pub-id-type="pmid">37018136</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad160</article-id>
    <article-id pub-id-type="publisher-id">btad160</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>WAVES (Web-based tool for Analysis and Visualization of Environmental Samples)—a web application for visualization of wastewater pathogen sequencing results</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Triska</surname>
          <given-names>Petr</given-names>
        </name>
        <aff><institution>Institute for Hygiene and Applied Immunology, Center for Pathophysiology, Infectiology and Immunology, Medical University of Vienna</institution>, Vienna 1090, <country country="AT">Austria</country></aff>
        <aff><institution>CeMM Research Center for Molecular Medicine of the Austrian Academy of Sciences</institution>, Vienna 1090, <country country="AT">Austria</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Amman</surname>
          <given-names>Fabian</given-names>
        </name>
        <aff><institution>Institute for Hygiene and Applied Immunology, Center for Pathophysiology, Infectiology and Immunology, Medical University of Vienna</institution>, Vienna 1090, <country country="AT">Austria</country></aff>
        <aff><institution>CeMM Research Center for Molecular Medicine of the Austrian Academy of Sciences</institution>, Vienna 1090, <country country="AT">Austria</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Endler</surname>
          <given-names>Lukas</given-names>
        </name>
        <aff><institution>Institute for Hygiene and Applied Immunology, Center for Pathophysiology, Infectiology and Immunology, Medical University of Vienna</institution>, Vienna 1090, <country country="AT">Austria</country></aff>
        <aff><institution>CeMM Research Center for Molecular Medicine of the Austrian Academy of Sciences</institution>, Vienna 1090, <country country="AT">Austria</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0597-1976</contrib-id>
        <name>
          <surname>Bergthaler</surname>
          <given-names>Andreas</given-names>
        </name>
        <aff><institution>Institute for Hygiene and Applied Immunology, Center for Pathophysiology, Infectiology and Immunology, Medical University of Vienna</institution>, Vienna 1090, <country country="AT">Austria</country></aff>
        <aff><institution>CeMM Research Center for Molecular Medicine of the Austrian Academy of Sciences</institution>, Vienna 1090, <country country="AT">Austria</country></aff>
        <xref rid="btad160-cor1" ref-type="corresp"/>
        <!--andreas.bergthaler@meduniwien.ac.at-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Martelli</surname>
          <given-names>Pier Luigi</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad160-cor1">Corresponding author. Institute for Hygiene and Applied Immunology, Center for Pathophysiology, Infectiology and Immunology, Medical University of Vienna, Kinderspitalgasse 15, Vienna 1090, Austria. E-mail: <email>andreas.bergthaler@meduniwien.ac.at</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-04-05">
      <day>05</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>4</issue>
    <elocation-id>btad160</elocation-id>
    <history>
      <date date-type="received">
        <day>08</day>
        <month>6</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>27</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>05</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>07</day>
        <month>4</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad160.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Environmental monitoring of pathogens provides an accurate and timely source of information for public health authorities and policymakers. In the last 2 years, wastewater sequencing proved to be an effective way of detection and quantification of severe acute respiratory syndrome coronavirus 2 (SARS-CoV-2) variants circulating in population. Wastewater sequencing produces substantial amounts of geographical and genomic data. Proper visualization of spatial and temporal patterns in these data is crucial for the assessment of the epidemiological situation and forecasting. Here, we present a web-based dashboard application for the visualization and analysis of data obtained from sequencing of environmental samples. The dashboard provides multi-layered visualization of geographical and genomic data. It allows to display frequencies of detected pathogen variants as well as individual mutation frequencies. The features of WAVES (Web-based tool for Analysis and Visualization of Environmental Samples) for early tracking and detection of novel variants in the wastewater are demonstrated in an example of BA.1 variant and the signature Spike mutation S: E484A. WAVES dashboard is easily customized through the editable configuration file and can be used for different types of pathogens and environmental samples.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>WAVES source code is freely available at <ext-link xlink:href="https://github.com/ptriska/WavesDash" ext-link-type="uri">https://github.com/ptriska/WavesDash</ext-link> under MIT license. A demo version of this application can be accessed at: <ext-link xlink:href="https://wavesdashboard.azurewebsites.net/" ext-link-type="uri">https://wavesdashboard.azurewebsites.net/</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Austrian Science Fund</institution>
            <institution-id institution-id-type="DOI">10.13039/501100002428</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id># P34579</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Wastewater monitoring has been an effective method of pathogen surveillance during the SARS-CoV-2 pandemic. In countries with developed wastewater treatment infrastructure, wastewater monitoring can provide sensitive and large-scale pathogen monitoring on the population level (<xref rid="btad160-B1" ref-type="bibr">Amman et al. 2022</xref>). Pathogen sequencing from wastewater results in large amounts of spatial–temporal data that can be challenging to visualize and present to policymakers and the public. Here, we describe software designed for detailed visualization of the results of wastewater genome sequencing within the synoptical dashboard WAVES (Web-based tool for Analysis and Visualization of Environmental Samples). Spatial and temporal patterns in variant frequencies are particularly important for public health agencies as they help to identify introduction points of novel variants and to spot local outbreaks. Our visualization tool makes finding these patterns easier. We can illustrate this with the example of the initial spread of BA.1 variant in Austria in December 2021. While the BA.1 variant was not reliably detected (frequency &gt; 10%) in wastewater in Austria until 19th December 2021, the characteristic Spike mutation S: E484A was detected at a high frequency more than 2 weeks earlier in sample from Leoben (<xref rid="btad160-F1" ref-type="fig">Fig. 1</xref>, from raw data included in <xref rid="btad160-B1" ref-type="bibr">Amman et al. 2022</xref>).</p>
    <fig position="float" id="btad160-F1">
      <label>Figure 1</label>
      <caption>
        <p>Example of use of the multi-layered data visualization with the application WAVES. (A and B) The frequency of detected BA.1 variant (A) and the BA.1-characteristic mutation S: E484A (B) in the time period from the 1st to the 15th of December 2021 in Austria was shown. While the BA.1 variant was not reliably detected in this period, the signature mutation S: E484A was already detected in the wastewater treatment plant Leoben. Two weeks later (C), the Omicron variant is detected at a high level in Leoben. The detected mutation is shown in the allele frequency plot (D)</p>
      </caption>
      <graphic xlink:href="btad160f1" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>2 Application description</title>
    <sec>
      <title>2.1 Backend description</title>
      <p>WAVES dashboard works as a web application. It does not require a server deployment and can be run locally on any operating system which supports Docker. The application comes with the Docker container (<xref rid="btad160-B4" ref-type="bibr">Merkel 2014</xref>) and can be hosted on a local machine, or it can be easily deployed in cloud services such as Azure or Amazon Web Services. The application is written in Python 3.6. (<xref rid="btad160-B7" ref-type="bibr">Van Rossum and Drake 2009</xref>). The backend uses the pandas (<xref rid="btad160-B3" ref-type="bibr">McKinney 2011</xref>) and Datatable (<xref rid="btad160-B6" ref-type="bibr">Stetsenko et al. 2022</xref>, retrieved from <ext-link xlink:href="https://datatable.readthedocs.io/en/latest/index.html" ext-link-type="uri">https://datatable.readthedocs.io/en/latest/index.html</ext-link>) packages for parsing and processing the data. The frontend is based on Plotly and Plotly Dash (Plotly Technologies Inc. 2015, retrieved from <ext-link xlink:href="https://plot.ly" ext-link-type="uri">https://plot.ly</ext-link>.) packages for visualization of the data and for handling of user callbacks. The GitHub repository with the code can be accessed at <ext-link xlink:href="https://github.com/ptriska/WavesDash" ext-link-type="uri">https://github.com/ptriska/WavesDash</ext-link>. The application was used to produce interactive supplementary data for the recent paper by <xref rid="btad160-B1" ref-type="bibr">Amman et al. 2022</xref>: <ext-link xlink:href="http://www.sarscov2-Austria.org/cemm/Austrian-sars-cov-2-ww-dashboard/" ext-link-type="uri">http://www.sarscov2-Austria.org/cemm/Austrian-sars-cov-2-ww-dashboard/</ext-link>.</p>
      <p>WAVES integrates two types of data: frequencies of detected variants within individual samples, and the frequency of detected mutations within the sample. The application does not calculate either of those metrics and data must be supplied in the form of tab-separated files (tsv). Parsing of the tsv files is based on the Datatable package (<xref rid="btad160-B6" ref-type="bibr">Stetsenko et al. 2022</xref>). Detailed description of formatting of the input files in the readme manual located in the GitHub repository. The application parses the input files when the session is initiated. To make usage of the application smoother, the application generates precomputed data files during the first start-up. The precomputation performs a basic QC on the input files (removal of duplicates, indexing by sampling date, and sorting of the index). The update of data is done by simply removing the original data files, including the precomputed files, and replacing them with new files.</p>
    </sec>
    <sec>
      <title>2.2 Frontend description</title>
      <p>On the frontend side, WAVES consists of three vertical panels. On the left-hand side, a divide with an interactive two-layered map is located. The first layer is a CARTO background map (Carto Inc. 2022). The center point of the map and the zoom level is specified in the configuration file. The second layer consists of outlined sampling areas, which would correspond to the respective catchment areas of a given wastewater treatment plant and is defined in the user-supplied geojson file. The sampling areas are colored in choropleth style. This can be either on qualitatively (showing the most frequent variant), or quantitatively (showing the frequency of a variant or a mutation). Outlined sampling areas are interactive. When an area is selected by clicking, a plot with sequencing results for selected area will appear in the central divide. Alternatively, when a sampling area is selected from the drop-down menu in the filtering divide, the map will zoom in to show the selected area. The map also allows a time-lapse mode, in which the epidemiological situation on the map is displayed in steps corresponding to the sampling time points. The time-lapse mode requires considerable amount of memory, especially when displaying long time series. For large datasets, we recommend using geojson file with reduced resolution. Reduced geojson can be specified in the configuration file. The central divide contains two plots. The upper plot is a stacked plot showing relative frequency of each detected variant in a given sampling period. Upon selecting a sampling period by clicking at corresponding bar, a plot showing mutation frequency within a selected sample is loaded. The frequency of mutations is projected on the y-axis, while the x-axis is a genomic position of the mutation. The mutation frequency plot with the genome map can be expanded into a separate window for better readability. The right-hand panel allows for the subsetting and filtering of displayed data. Filtering is performed by selecting from drop-down menus. Filtering options contained in the drop-down forms are based on parsed data.</p>
      <p>Detailed information on data sources, authors, and contacts can be inserted into the respective links in the main menu customizable through the configuration file. The content will be displayed in a pop-up window.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Installation</title>
    <p>Before the application is started, the user must provide a configuration file (the template of the configuration file is present in the GitHub repository), input files in the tsv format, and a geojson file with geographic coordinates of sampling areas. The exact format of input files is described in the readme manual.</p>
    <p>The application uses a number of python packages that need to be installed on the system prior to the start of the application. In order to simplify the installation, we provide a requrements.txt file and a prebuilt Docker image containing the whole software stack. For those who prefer to build the Docker image by themselves, we provide a Docker file located in the GitHub repository. The application starts a Flask web server which is by default accessible at localhost port 8050. The port can be changed in the configuration file.</p>
  </sec>
</body>
<back>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the Austrian Science Fund [project # P34579].</p>
    <p>Conflict of Interest: none declared.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The data is available in the stated git repository.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad160-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Amman</surname><given-names>F</given-names></string-name></person-group><etal>et al</etal><article-title>Viral variant-resolved wastewater surveillance of SARS-CoV-2 at national scale</article-title>. <source>Nat Biotechnol</source><year>2022</year>;<volume>40.12</volume>:<fpage>1814</fpage>–<lpage>22</lpage>.<pub-id pub-id-type="pmid">35851376</pub-id></mixed-citation>
    </ref>
    <ref id="btad160-B2">
      <mixed-citation publication-type="other"><collab>Carto Inc</collab>. Basemaps. CARTO. <year>2022</year>. <ext-link xlink:href="https://carto.com/basemaps/" ext-link-type="uri">https://carto.com/basemaps/</ext-link> (1 June 2004, date last accessed).</mixed-citation>
    </ref>
    <ref id="btad160-B3">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>McKinney</surname><given-names>W.</given-names></string-name></person-group> pandas: a foundational Python library for data analysis and statistics. In: <italic toggle="yes">Python for High Performance and Scientific Computing</italic>, Seattle, WA, USA. Vol. 14.9. <fpage>1</fpage>–<lpage>9</lpage>. <year>2011</year>.</mixed-citation>
    </ref>
    <ref id="btad160-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Merkel</surname><given-names>D.</given-names></string-name></person-group><article-title>Docker: lightweight Linux containers for consistent development and deployment</article-title>. <source>Linux J</source><year>2014</year>;<volume>2014</volume>:<fpage>2</fpage>.</mixed-citation>
    </ref>
    <ref id="btad160-B5">
      <mixed-citation publication-type="book"><collab>Plotly Technologies Inc</collab>. <source>Collaborative Data Science</source>. <publisher-loc>Montreal, QC</publisher-loc>: <publisher-name>Plotly Technologies Inc.</publisher-name>, <year>2015</year>.</mixed-citation>
    </ref>
    <ref id="btad160-B6">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Stetsenko</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal> A Python package for manipulating 2-dimensional tabular data structures. <year>2022</year>. <ext-link xlink:href="https://github.com/h2oai/datatable" ext-link-type="uri">https://github.com/h2oai/datatable</ext-link>.</mixed-citation>
    </ref>
    <ref id="btad160-B7">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Van Rossum</surname><given-names>G</given-names></string-name>, <string-name><surname>Drake</surname><given-names>FL.</given-names></string-name></person-group><source>Python 3 Reference Manual</source>. <publisher-loc>Scotts Valley, CA</publisher-loc>: <publisher-name>CreateSpace</publisher-name>, <year>2009</year>.</mixed-citation>
    </ref>
  </ref-list>
</back>
