<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7750935</article-id>
    <article-id pub-id-type="pmid">32614393</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btaa602</article-id>
    <article-id pub-id-type="publisher-id">btaa602</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Systems Biology</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RSSALib: a library for stochastic simulation of complex biochemical reactions</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Thanh</surname>
          <given-names>Vo Hong</given-names>
        </name>
        <aff><institution>Department of Computer Science, Aalto University</institution>, <country country="FI">Finland</country></aff>
        <xref rid="btaa602-cor1" ref-type="corresp"/>
        <!--thanh.vo@aalto.fi-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Wren</surname>
          <given-names>Jonathan</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btaa602-cor1">To whom correspondence should be addressed. E-mail: <email>thanh.vo@aalto.fi</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>15</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-07-02">
      <day>02</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>02</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <volume>36</volume>
    <issue>18</issue>
    <fpage>4825</fpage>
    <lpage>4826</lpage>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>2</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>24</day>
        <month>4</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>6</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btaa602.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Stochastic chemical kinetics is an essential mathematical framework for investigating the dynamics of biological processes, especially when stochasticity plays a vital role in their development. Simulation is often the only option for the analysis of many practical models due to their analytical intractability.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present in this article, the simulation library RSSALib, implementing our recently developed rejection-based stochastic simulation algorithm (RSSA) and a wide range of its improvements, to accelerate the simulation and analysis of biochemical reactions. RSSALib supports reactions with complex kinetics and time delays, necessary to model complexities of reaction mechanisms. Our library provides both an application program interface and a graphic user interface to ease the set-up and visualization of the simulation results.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>RSSALib is freely available at: <ext-link xlink:href="https://github.com/vo-hong-thanh/rssalib" ext-link-type="uri">https://github.com/vo-hong-thanh/rssalib</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Academy of Finland</institution>
            <institution-id institution-id-type="DOI">10.13039/501100002341</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>311639</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Algorithmic Designs for Biomolecular Nanostructures (ALBION)</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Biochemical processes at the cellular level are intrinsically stochastic due to the discreteness of species and the randomness of reaction firings, leading to significant fluctuation in the cellular response. Stochastic chemical kinetics describes the stochastic dynamics of biochemical reactions through the chemical master equation. Stochastic simulation in many cases is the only approach to study the temporal dynamics of biological systems due to the high-dimensional state space (<xref rid="btaa602-B1" ref-type="bibr">Marchetti <italic toggle="yes">et al.</italic>, 2017</xref>). Stochastic simulation of biochemical reactions poses many computational challenges not only due to the size of networks but also due to complex reaction mechanisms. Reactions with non-linear rate laws, such as enzymatic kinetics, often applied to model biochemical reactions to better match the experiments. In addition, reactions always take a certain time, called <italic toggle="yes">delay</italic>, from their initiation to finish. For many biological processes, such as the transcription and translation, where their completion time is slow, it is necessary to consider time delays to accurately describe the system dynamics. Finally, due to the stochastic nature of the approach, many simulation runs must be performed to obtain a reasonable statistical estimation of the expected behaviour of the system dynamics.</p>
    <p>We present in this article, the simulation library RSSALib to offer the computational advantages of our recently developed rejection-based simulation algorithm (RSSA) (<xref rid="btaa602-B2" ref-type="bibr">Thanh <italic toggle="yes">et al.</italic>, 2014</xref>). We implement RSSA and a wide range of improvements to cope with different aspects of biological processes. RSSALib supports reactions with complex kinetics, including Michaelis–Menten and Hill kinetics. It also allows reactions with time delays required to model complicated biological phenomena. The biological network can be described in our reaction format or imported directly from an SBML model. Our simulation library provides both an application program interface (API) for stand-alone applications and a graphic user interface (GUI) to ease the set up of simulation and visualization of results. We validate our implementation and demonstrate its applications on real biological models (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> for more details) to highlight its applicabilities and computational improvements in simulation performance of our computational tool.</p>
  </sec>
  <sec>
    <title>2 RSSALib</title>
    <p>The simulation library RSSALib provides a full implementation of all known RSSA formulations to offer their computational advantages in dealing with varying complexities of biological networks.</p>
    <sec>
      <title>2.1 Theoretical background</title>
      <p>RSSA is an exact simulation (see <xref rid="btaa602-B2" ref-type="bibr">Thanh <italic toggle="yes">et al.</italic>, 2014</xref>, for a formal proof) that accelerates performance by reducing the average computations of reaction propensities. We consider a biological network consisting of <italic toggle="yes">N</italic> species <italic toggle="yes">S<sub>i</sub></italic>, <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>, interacting through <italic toggle="yes">M</italic> reactions <italic toggle="yes">R<sub>j</sub></italic>, <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula>. The populations of species constitute the state <italic toggle="yes">X</italic>(<italic toggle="yes">t</italic>). The probability that reaction <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mo>μ</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> fires in the infinitesimal time <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mo>τ</mml:mo><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo>τ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, given the state <italic toggle="yes">X</italic>(<italic toggle="yes">t</italic>), is <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>τ</mml:mo><mml:mo>,</mml:mo><mml:mo>μ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mo>τ</mml:mo></mml:mrow></mml:math></inline-formula> in which the probability density function (pdf) <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>τ</mml:mo><mml:mo>,</mml:mo><mml:mo>μ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mo>μ</mml:mo></mml:msub><mml:mo> </mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mo>{</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>τ</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> where <italic toggle="yes">a<sub>j</sub></italic> is called reaction <italic toggle="yes">propensity</italic> and <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. Instead of directly sampling pdf <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>τ</mml:mo><mml:mo>,</mml:mo><mml:mo>μ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> using the propensity <italic toggle="yes">a<sub>j</sub></italic>, RSSA uses the bounds <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:munder accentunder="true"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:munder><mml:mo>,</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> and the rejection-based technique. The selection of the next reaction firing in RSSA consists of two steps. First, a candidate reaction <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mo>μ</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> is selected with probability <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula> where <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula>. The candidate reaction <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mo>μ</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> then enters a rejection-based test for validation with success probability <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mo>μ</mml:mo></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>μ</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula>. RSSA avoids computing propensity <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mo>μ</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> in this step as much as possible using the fact that if <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mo>μ</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> is accepted with probability <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:munder accentunder="true"><mml:mi>a</mml:mi><mml:mo>¯</mml:mo></mml:munder><mml:mo>μ</mml:mo></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>μ</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula>, then it is also accepted with probability <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mo>μ</mml:mo></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>μ</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula>. If <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mo>μ</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> is accepted, its firing time is then computed. The firing time <italic toggle="yes">τ</italic> of the accepted reaction <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mo>μ</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> is chosen following an <italic toggle="yes">Erlang</italic> distribution to ensure exactness of the selection specified by pdf <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>τ</mml:mo><mml:mo>,</mml:mo><mml:mo>μ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>2.2 Usage and implementation</title>
      <p><xref rid="btaa602-F1" ref-type="fig">Figure 1</xref> shows the use of RSSALib’s GUI to simulate and visualize the simulation result. The GUI allows one to load the model and perform simulation with a click-and-run. RSSALib can also be used as a developer API for building stand-alone applications. For this usage, we manually load the model, and call the runSim() method of the simulator to execute the simulation. In the following, we briefly describe the simulation algorithms implemented in RSSALib and their time complexities.
</p>
      <fig position="float" id="btaa602-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>GUI of RSSALib for setting up simulation and visualization</p>
        </caption>
        <graphic xlink:href="btaa602f1" position="float"/>
      </fig>
      <list list-type="bullet">
        <list-item>
          <p>RSSA and its extension for reactions with time delays (DelayedRSSA) realize the candidate reaction <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mo>μ</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> by linearly accumulating propensity upper bounds until it finds the reaction. We also provide the cache-friendly search, which reuses the previously computed sum of propensities in the last step. The time complexity of the search is <italic toggle="yes">O</italic>(<italic toggle="yes">M</italic>).</p>
        </list-item>
        <list-item>
          <p>Partial-propensity RSSA (PRSSA) uses the factorization of the mass-action propensity to factorize the propensity bounds <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:munder accentunder="true"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:munder></mml:mrow></mml:math></inline-formula>/<inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> of reactions, which are then grouped by the common reactant species into the so-called partial propensity structure. The selection of candidate reaction in the PRSSA is performed in two consecutive steps in which the first search selects a group, and the second one locates the reaction in that group. The time complexity of the search in PRSSA is proportional to the number of species, i.e. <italic toggle="yes">O</italic>(<italic toggle="yes">N</italic>).</p>
        </list-item>
        <list-item>
          <p>RSSA with tree-based search (RSSA-Binary) uses the tree-based search to reduce the time complexity for selecting the candidate reaction. First, a tree is built in which its leave store propensities <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> of reactions and internal nodes store the sum value of their children. The search for the next reaction will travel from the root to a leaf to discover the next reaction. The search depth is equal to the height of the tree, which is <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, hence its time complexity.</p>
        </list-item>
        <list-item>
          <p>RSSA with composition–rejection search (RSSA-CR) implements the composition–rejection method to reduce the time complexity of the search for the candidate reaction to be independent with the number of reactions. Reactions are partitioned into <italic toggle="yes">L</italic> groups <italic toggle="yes">G<sub>i</sub></italic>, <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> so that a reaction <italic toggle="yes">R<sub>j</sub></italic> is put into a group <italic toggle="yes">G<sub>i</sub></italic> if its propensity <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> satisfies <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>≤</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>≤</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. The selection of the candidate reaction is made in two steps. First, a group <italic toggle="yes">G<sub>l</sub></italic> is selected proportional to the sum of propensity bounds of reactions in the group. Then, the reaction <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mo>μ</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> in the group <italic toggle="yes">G<sub>l</sub></italic> is located by applying the acceptance–rejection with hat function <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. The selection of the candidate by the composition–rejection search depends only on the number of groups, i.e. <italic toggle="yes">O</italic>(<italic toggle="yes">L</italic>).</p>
        </list-item>
        <list-item>
          <p>RSSA with table lookup search (RSSA-Lookup) reduces the time complexity of the search to be constant, i.e. <italic toggle="yes">O</italic>(1); however, it requires to build the lookup tables which take linear time <italic toggle="yes">O</italic>(<italic toggle="yes">M</italic>). The <italic toggle="yes">M</italic> probabilities <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula>, for <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula>, are partitioned into an equi-probable mixture of <italic toggle="yes">M</italic> two-point distributions and store these values in two tables, called <italic toggle="yes">cut-off table</italic>, storing the probability of the first values of the two-point mixtures, and <italic toggle="yes">alias table</italic>, containing the alias to the second parts of the mixtures. For the selection of the next reaction, a random number <italic toggle="yes">r</italic><sub>1</sub> is first used to lookup the position of the equi-probable mixture. It is then rescaled to select which part of the two-point.</p>
        </list-item>
      </list>
    </sec>
  </sec>
  <sec>
    <title>3 Conclusion</title>
    <p>We presented the simulation library RSSALib, providing the implementation of the RSSA and a wide range of its improvements, to accelerate the simulation and analysis of biochemical reactions. Our computational tool enables investigating large, complex biological systems.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>The research was supported by Academy of Finland [311639], ‘Algorithmic Designs for Biomolecular Nanostructures (ALBION)’.</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btaa602_supplementary_data</label>
      <media xlink:href="btaa602_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btaa602-B1">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Marchetti</surname><given-names>L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <source>Simulation Algorithms for Computational Systems Biology</source>. Springer International Publishing, AG.</mixed-citation>
    </ref>
    <ref id="btaa602-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Thanh</surname><given-names>V.H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) 
<article-title>Efficient rejection-based simulation of biochemical reactions with stochastic noise and delays</article-title>. <source>J. Chem. Phys</source>., <volume>141</volume>, <fpage>134116</fpage>.<pub-id pub-id-type="pmid">25296793</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
